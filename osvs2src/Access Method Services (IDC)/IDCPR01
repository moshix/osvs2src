         TITLE '************** IDCPR01: IDCAMS PRINT ROUTINE ***********00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCPR01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCPR01   77.067'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  DS    0H                                                  0002 00022000
         USING @PSTART,@12                                         0002 00023000
         L     @00,@SIZDATD                                        0002 00024000
         GETMAIN  R,LV=(0)                                              00025000
         LR    @11,@01                                             0002 00026000
         USING @DATD,@11                                           0002 00027000
         ST    @13,@SA00001+4                                      0002 00028000
         LM    @00,@01,20(@13)                                     0002 00029000
         ST    @11,8(,@13)                                         0002 00030000
         LR    @13,@11                                             0002 00031000
         MVC   @PC00001(12),0(@01)                                 0002 00032000
*                                                                  0185 00033000
*        /************************************************************/ 00034000
*        /*                                                          */ 00035000
*        /* ENTRY POINT TO IDCPR01 - THIS IS THE ONLY ENTRY POINT    */ 00036000
*        /*                                                          */ 00037000
*        /************************************************************/ 00038000
*                                                                  0186 00039000
*        OLDERID2 = NEWERID2;                                      0186 00040000
         L     @10,@PC00001                                        0186 00041000
         L     @05,GDTTR2(,@10)                                    0186 00042000
         MVC   @TS00001(95),NEWERID2(@05)                          0186 00043000
         MVC   OLDERID2(95,@05),@TS00001                           0186 00044000
*        NEWID2 = 'PR11';                                          0187 00045000
*                                                                  0187 00046000
         MVC   NEWID2(4,@05),@CC00731                              0187 00047000
*        /************************************************************/ 00048000
*        /*                                                          */ 00049000
*        /* CONTROL FLAG VALUES AND PARAMETER LIST PTRS ARE SET      */ 00050000
*        /*                                                          */ 00051000
*        /************************************************************/ 00052000
*                                                                  0188 00053000
*        CYCLEFLG= GO;                                             0188 00054000
         MVI   CYCLEFLG,X'00'                                      0188 00055000
*        STATFLG=NORMAL;                                           0189 00056000
         MVC   STATFLG(5),@CB00670                                 0189 00057000
*        DDSTRU=ADDR(DARGL);                                       0190 00058000
         LA    @05,DARGL                                           0190 00059000
         ST    @05,DDSTRU                                          0190 00060000
*        DARGL = ''B;                                              0191 00061000
         XC    DARGL(28),DARGL                                     0191 00062000
*        OPRTFILE = NULLPTR;                                       0192 00063000
         SLR   @05,@05                                             0192 00064000
         ST    @05,OPRTFILE                                        0192 00065000
*        RECDPRCS = 0;                                             0193 00066000
         ST    @05,RECDPRCS                                        0193 00067000
*        RPIOERR = 0;                                              0194 00068000
*                                                                  0194 00069000
         SLR   RPIOERR,RPIOERR                                     0194 00070000
*        IOCSPTR = NULLPTR;                                  /*YM6244*/ 00071000
         ST    @05,IOCSPTR                                         0195 00072000
*        IOCSALT = NULLPTR;                                  /*YM6244*/ 00073000
*                                                                  0196 00074000
         ST    @05,IOCSALT                                         0196 00075000
*      INPUTVAL = INDSVAL;                                 /*@YL026UA*/ 00076000
         L     @15,@PC00001+4                                      0197 00077000
         L     @15,FDTPTR+36(,@15)                                 0197 00078000
         MVC   INPUTVAL(44),INDSVAL(@15)                           0197 00079000
*      INPUTLEN = INDSLEN;                                 /*@YL026UA*/ 00080000
*                                                                  0198 00081000
         SLR   @14,@14                                             0198 00082000
         IC    @14,INDSLEN(,@15)                                   0198 00083000
         STH   @14,INPUTLEN                                        0198 00084000
*        /************************************************************/ 00085000
*        /*                                                  @YL026UA*/ 00086000
*        /*  IF THE ENTRY IS NOT FULLY QUALIFIED - ISSUE     @YL026UA*/ 00087000
*        /*  THE UQUAL MACRO TO OBTAIN THE TRAILING QUALIFIER        */ 00088000
*        /*                                                  @YL026UA*/ 00089000
*        /************************************************************/ 00090000
*                                                                  0199 00091000
*          IF INDSFUQ = ON & ADDR(INDS) ^= NULLPTR                 0199 00092000
*            THEN                                                  0199 00093000
         TM    INDSFUQ(@15),B'10000000'                            0199 00094000
         BNO   @RF00199                                            0199 00095000
         CR    @15,@05                                             0199 00096000
         BE    @RF00199                                            0199 00097000
*              DO;                                         /*@YL026UA*/ 00098000
*                QUALLIST = ''B;                           /*@YL026UA*/ 00099000
         XC    QUALLIST(12),QUALLIST                               0201 00100000
*                QUALADDR = ADDR(INPUTVAL);                /*@YL026UA*/ 00101000
*                                                                  0202 00102000
         LA    @05,INPUTVAL                                        0202 00103000
         ST    @05,QUALADDR                                        0202 00104000
*                CALL IDCSAQL0(GDTTBL,QUALADDR,INPUTLEN,QUALCAT,QUALPAS 00105000
*;                                                                 0203 00106000
         ST    @10,@AL00001                                        0203 00107000
         LA    @05,QUALADDR                                        0203 00108000
         ST    @05,@AL00001+4                                      0203 00109000
         LA    @05,INPUTLEN                                        0203 00110000
         ST    @05,@AL00001+8                                      0203 00111000
         LA    @05,QUALCAT                                         0203 00112000
         ST    @05,@AL00001+12                                     0203 00113000
         LA    @05,QUALPAS                                         0203 00114000
         ST    @05,@AL00001+16                                     0203 00115000
         MVI   @AL00001+16,X'80'                                   0203 00116000
         L     @15,GDTQAL(,@10)                                    0203 00117000
         LA    @01,@AL00001                                        0203 00118000
         BALR  @14,@15                                             0203 00119000
*                                                          /*@YL026UA*/ 00120000
*                RESPECIFY RTNREG RSTD;                            0204 00121000
*                TESTRC = RTNREG;                                  0205 00122000
         LR    TESTRC,RTNREG                                       0205 00123000
*                RESPECIFY RTNREG UNRSTD;                  /*@YL026UA*/ 00124000
*                IF TESTRC ^= 0                                    0207 00125000
*                  THEN                                            0207 00126000
         LTR   TESTRC,TESTRC                                       0207 00127000
         BZ    @RF00207                                            0207 00128000
*                    STATFLG = ABNTERM;                    /*@YL026UA*/ 00129000
         MVC   STATFLG(5),@CB00679                                 0208 00130000
*              END;                                        /*@YL026UA*/ 00131000
*                                                                  0209 00132000
@RF00207 DS    0H                                                  0210 00133000
*        IF STATFLG = NORMAL                                       0210 00134000
*          THEN                                                    0210 00135000
@RF00199 CLC   STATFLG(5),@CB00670                                 0210 00136000
         BNE   @RF00210                                            0210 00137000
*OPENS: DO;                                                /*@YL026UA*/ 00138000
*                                                                  0211 00139000
OPENS    DS    0H                                                  0212 00140000
*        /************************************************************/ 00141000
*        /*                                                          */ 00142000
*        /* THE  OPENAGL, FOR THE DATA SET TO BE LISTED,  IS         */ 00143000
*        /* CONSTRUCTED AT  THIS POINT THE IDCAMS I/O                */ 00144000
*        /* ADAPTER OPENS THE INPUT DATA SET.  THE UOPEN MACRO       */ 00145000
*        /* REQUESTS THIS SERVICE. THE OPNAGL PROVIDES INFORMATION   */ 00146000
*        /* ABOUT THE DATA SET TO THE I/O ADAPTER                    */ 00147000
*        /*                                                          */ 00148000
*        /************************************************************/ 00149000
*                                                                  0212 00150000
*        OPAGLST=''B;                  /* SET OPNAGL TO ZEROES       */ 00151000
         XC    OPAGLST(48),OPAGLST                                 0212 00152000
*        OPNPTR=ADDR(OPAGLST);         /* SET POINTER TO OPNAGL      */ 00153000
         LA    OPNPTR,OPAGLST                                      0213 00154000
*        OPNOPTIN=ON;                  /* OPEN FOR INPUT             */ 00155000
         OI    OPNOPTIN(OPNPTR),B'10000000'                        0214 00156000
*        OPNIOC=ADDR(IOCSPTR);         /* REFERENCE ADDR OF IOCSPTR  */ 00157000
*                                                                  0215 00158000
         LA    @10,IOCSPTR                                         0215 00159000
         ST    @10,OPNIOC(,OPNPTR)                                 0215 00160000
*        /************************************************************/ 00161000
*        /*                                                  @YL026UA*/ 00162000
*        /* IF THE DATA SET WAS ALLOCATED VIA JCL, THE JCL   @YL026UA*/ 00163000
*        /* STATEMENT DDNAME POINTER IS PLACED IN THE OPNAGL @YL026UA*/ 00164000
*        /* OTHERWISE THE ADDRESS OF THE DSNAME AND AN OPTIONAL      */ 00165000
*        /* PASSWORD ADDRESS ARE PLACED IN THE OPNAGL AND    @YL026UA*/ 00166000
*        /* DYNAMIC ALLOCATION FOR THE DATA SET IS PERFORMED @YL026UA*/ 00167000
*        /* BY THE UOPEN MACRO                               @YL026UA*/ 00168000
*        /*                                                  @YL026UA*/ 00169000
*        /************************************************************/ 00170000
*                                                                  0216 00171000
*        IF INPDDLEN ^= 0 & ADDR(INDN) ^= NULLPTR                  0216 00172000
*          THEN                                                    0216 00173000
         L     @10,@PC00001+4                                      0216 00174000
         L     @05,FDTPTR+32(,@10)                                 0216 00175000
         CLI   INPDDLEN(@05),0                                     0216 00176000
         BE    @RF00216                                            0216 00177000
         L     @10,FDTPTR(,@10)                                    0216 00178000
         LTR   @10,@10                                             0216 00179000
         BZ    @RF00216                                            0216 00180000
*            OPNDDN = ADDR(INPDDVAL);  /*JCL STATEMENT PTR   @YL026UA*/ 00181000
         LA    @10,INPDDVAL(,@05)                                  0217 00182000
         ST    @10,OPNDDN(,OPNPTR)                                 0217 00183000
*          ELSE                                                    0218 00184000
*            OPNDSN = ADDR(INPUTVAL);  /*OR DSNAME/PASS PTRS @YL026UA*/ 00185000
*                                                                  0218 00186000
         B     @RC00216                                            0218 00187000
@RF00216 LA    @10,INPUTVAL                                        0218 00188000
         ST    @10,OPNDSN(,OPNPTR)                                 0218 00189000
*        /************************************************************/ 00190000
*        /*                                                          */ 00191000
*        /* IDENTIFY KEY OR RECORD NUMBER DELIMITER -        @Y30SSJH*/ 00192000
*        /* UOPEN WILL VERIFY THAT THE DATA SET IS                   */ 00193000
*        /* CONSISTENT WITH THIS DELIMITER.                          */ 00194000
*        /*                                                          */ 00195000
*        /************************************************************/ 00196000
*                                                                  0219 00197000
*        IF (ADDR(FMKYC)  ^= NULLPTR  |                    /*@Y30SSJH*/ 00198000
*            ADDR(TOKYC)  ^= NULLPTR  |                    /*@Y30SSJH*/ 00199000
*            ADDR(FMNUM)  ^= NULLPTR  |                    /*@Y30SSJH*/ 00200000
*            ADDR(TONUM)  ^= NULLPTR   )                   /*@Y30SSJH*/ 00201000
*          THEN                                                    0219 00202000
@RC00216 SLR   @10,@10                                             0219 00203000
         L     @05,@PC00001+4                                      0219 00204000
         C     @10,FDTPTR+8(,@05)                                  0219 00205000
         BNE   @RT00219                                            0219 00206000
         C     @10,FDTPTR+20(,@05)                                 0219 00207000
         BNE   @RT00219                                            0219 00208000
         C     @10,FDTPTR+116(,@05)                                0219 00209000
         BNE   @RT00219                                            0219 00210000
         C     @10,FDTPTR+120(,@05)                                0219 00211000
         BE    @RF00219                                            0219 00212000
@RT00219 DS    0H                                                  0220 00213000
*            OPNOPTKS = ON;                                        0220 00214000
*                                                                  0220 00215000
         OI    OPNOPTKS(OPNPTR),B'00001000'                        0220 00216000
*        /************************************************************/ 00217000
*        /*                                                          */ 00218000
*        /* IDENTIFY RBA DELIMITER - UOPEN WILL VERIFY THAT THE DATA */ 00219000
*        /* SET IS CONSISTENT WITH THIS DELIMITER                    */ 00220000
*        /*                                                          */ 00221000
*        /************************************************************/ 00222000
*                                                                  0221 00223000
*        IF (ADDR(FMRBA)  ^= NULLPTR  |                    /*@Y30SSJH*/ 00224000
*            ADDR(TORBA)  ^= NULLPTR  )                    /*@Y30SSJH*/ 00225000
*          THEN                                                    0221 00226000
@RF00219 SLR   @10,@10                                             0221 00227000
         L     @05,@PC00001+4                                      0221 00228000
         C     @10,FDTPTR+12(,@05)                                 0221 00229000
         BNE   @RT00221                                            0221 00230000
         C     @10,FDTPTR+24(,@05)                                 0221 00231000
         BE    @RF00221                                            0221 00232000
@RT00221 DS    0H                                                  0222 00233000
*            OPNOPTCR = ON;                                        0222 00234000
*                                                                  0222 00235000
         OI    OPNOPTCR(OPNPTR),B'00000100'                        0222 00236000
*        /************************************************************/ 00237000
*        /*                                                          */ 00238000
*        /* THE PASSWORD OF THE INPUT DATA SET IS NOTED IN THE OPNAGL*/ 00239000
*        /*                                                          */ 00240000
*        /************************************************************/ 00241000
*                                                                  0223 00242000
*        IF ADDR(INPDD) ^= NULLPTR & INPDDPLN ^= 0                 0223 00243000
*          THEN                                                    0223 00244000
@RF00221 L     @10,@PC00001+4                                      0223 00245000
         L     @10,FDTPTR+32(,@10)                                 0223 00246000
         LTR   @10,@10                                             0223 00247000
         BZ    @RF00223                                            0223 00248000
         CLI   INPDDPLN(@10),0                                     0223 00249000
         BE    @RF00223                                            0223 00250000
*            OPNPWA = ADDR(INPDDPAS);                              0224 00251000
         LA    @10,INPDDPAS(,@10)                                  0224 00252000
         ST    @10,OPNPWA(,OPNPTR)                                 0224 00253000
*          ELSE                                                    0225 00254000
*            IF ADDR(INDS) ^= NULLPTR & INDSPLN ^= 0               0225 00255000
*              THEN                                                0225 00256000
         B     @RC00223                                            0225 00257000
@RF00223 L     @10,@PC00001+4                                      0225 00258000
         L     @10,FDTPTR+36(,@10)                                 0225 00259000
         LTR   @10,@10                                             0225 00260000
         BZ    @RF00225                                            0225 00261000
         CLI   INDSPLN(@10),0                                      0225 00262000
         BE    @RF00225                                            0225 00263000
*                OPNPWA = ADDR(INDSPAS);                   /*@YL026UA*/ 00264000
         LA    @10,INDSPAS(,@10)                                   0226 00265000
         ST    @10,OPNPWA(,OPNPTR)                                 0226 00266000
*                                                                  0227 00267000
*        /************************************************************/ 00268000
*        /*                                                          */ 00269000
*        /* SPECIFY THE ENVIRONMENT ATTRIBUTES IN THE OPNAGL         */ 00270000
*        /*                                                          */ 00271000
*        /************************************************************/ 00272000
*                                                                  0227 00273000
*        IF (ADDR(IENV)) ^= NULLPTR                                0227 00274000
*          THEN                                                    0227 00275000
@RF00225 DS    0H                                                  0227 00276000
@RC00223 L     @10,@PC00001+4                                      0227 00277000
         L     @10,FDTPTR+60(,@10)                                 0227 00278000
         LTR   @10,@10                                             0227 00279000
         BZ    @RF00227                                            0227 00280000
*INPUTENV:   DO;                                                   0228 00281000
*                                                                  0228 00282000
INPUTENV DS    0H                                                  0229 00283000
*            /********************************************************/ 00284000
*            /*                                                      */ 00285000
*            /* SET RECORD FORMAT INDICATORS                         */ 00286000
*            /*                                                      */ 00287000
*            /********************************************************/ 00288000
*            IF (ADDR(IRFMT)) ^= NULLPTR                           0229 00289000
*              THEN                                                0229 00290000
         L     @10,@PC00001+4                                      0229 00291000
         L     @10,FDTPTR+64(,@10)                                 0229 00292000
         LTR   @10,@10                                             0229 00293000
         BZ    @RF00229                                            0229 00294000
*INRECFMT:       DO;                                               0230 00295000
*                                                                  0230 00296000
INRECFMT DS    0H                                                  0231 00297000
*                /****************************************************/ 00298000
*                /*                                                  */ 00299000
*                /*  FIXED - UNBLOCKED                               */ 00300000
*                /*                                                  */ 00301000
*                /****************************************************/ 00302000
*                IF (ADDR(IFUNB)) ^= NULLPTR                       0231 00303000
*                  THEN                                            0231 00304000
         L     @10,@PC00001+4                                      0231 00305000
         L     @10,FDTPTR+88(,@10)                                 0231 00306000
         LTR   @10,@10                                             0231 00307000
         BZ    @RF00231                                            0231 00308000
*                    OPNRFMFX = ON;                                0232 00309000
*                                                                  0232 00310000
         OI    OPNRFMFX(OPNPTR),B'10000000'                        0232 00311000
*                  /**************************************************/ 00312000
*                  /*                                                */ 00313000
*                  /*  FIXED - BLOCKED                               */ 00314000
*                  /*                                                */ 00315000
*                  /**************************************************/ 00316000
*                  ELSE                                            0233 00317000
*                    IF (ADDR(IFBLK)) ^= NULLPTR                   0233 00318000
*                      THEN                                        0233 00319000
         B     @RC00231                                            0233 00320000
@RF00231 L     @10,@PC00001+4                                      0233 00321000
         L     @10,FDTPTR+92(,@10)                                 0233 00322000
         LTR   @10,@10                                             0233 00323000
         BZ    @RF00233                                            0233 00324000
*                        DO;                                       0234 00325000
*                                                                  0234 00326000
*                        OPNRFMFX = ON;                            0235 00327000
*                        OPNRFMBK = ON;                            0236 00328000
*                                                                  0236 00329000
         OI    OPNRFMFX(OPNPTR),B'10001000'                        0236 00330000
*                        END;                                      0237 00331000
*                                                                  0237 00332000
*                    /************************************************/ 00333000
*                    /*                                              */ 00334000
*                    /*  VARIABLE - UNBLOCKED                        */ 00335000
*                    /*                                              */ 00336000
*                    /************************************************/ 00337000
*                      ELSE                                        0238 00338000
*                        IF (ADDR(IVUNB)) ^= NULLPTR               0238 00339000
*                          THEN                                    0238 00340000
         B     @RC00233                                            0238 00341000
@RF00233 L     @10,@PC00001+4                                      0238 00342000
         L     @10,FDTPTR+96(,@10)                                 0238 00343000
         LTR   @10,@10                                             0238 00344000
         BZ    @RF00238                                            0238 00345000
*                            OPNRFMVR = ON;                        0239 00346000
*                                                                  0239 00347000
*                                                                  0239 00348000
*                                                                  0239 00349000
         OI    OPNRFMVR(OPNPTR),B'01000000'                        0239 00350000
*            /********************************************************/ 00351000
*            /*                                                      */ 00352000
*            /*  VARIABLE - BLOCKED                                  */ 00353000
*            /*                                                      */ 00354000
*            /********************************************************/ 00355000
*            ELSE                                                  0240 00356000
*              IF (ADDR(IVBLK)) ^= NULLPTR                         0240 00357000
*                THEN                                              0240 00358000
         B     @RC00238                                            0240 00359000
@RF00238 L     @10,@PC00001+4                                      0240 00360000
         L     @10,FDTPTR+100(,@10)                                0240 00361000
         LTR   @10,@10                                             0240 00362000
         BZ    @RF00240                                            0240 00363000
*                  DO;                                             0241 00364000
*                                                                  0241 00365000
*                  OPNRFMVR = ON;                                  0242 00366000
*                  OPNRFMBK = ON;                                  0243 00367000
*                                                                  0243 00368000
         OI    OPNRFMVR(OPNPTR),B'01001000'                        0243 00369000
*                  END;                                            0244 00370000
*                                                                  0244 00371000
*              /******************************************************/ 00372000
*              /*                                                    */ 00373000
*              /*  SPANNED - UNBLOCKED                               */ 00374000
*              /*                                                    */ 00375000
*              /******************************************************/ 00376000
*                ELSE                                              0245 00377000
*                  IF (ADDR(ISUNB)) ^= NULLPTR                     0245 00378000
*                    THEN                                          0245 00379000
         B     @RC00240                                            0245 00380000
@RF00240 L     @10,@PC00001+4                                      0245 00381000
         L     @10,FDTPTR+104(,@10)                                0245 00382000
         LTR   @10,@10                                             0245 00383000
         BZ    @RF00245                                            0245 00384000
*                      OPNRFMSF = ON;                              0246 00385000
*                                                                  0246 00386000
         OI    OPNRFMSF(OPNPTR),B'00010000'                        0246 00387000
*                    /************************************************/ 00388000
*                    /*                                              */ 00389000
*                    /*  SPANNED - BLOCKED                           */ 00390000
*                    /*                                              */ 00391000
*                    /************************************************/ 00392000
*                    ELSE                                          0247 00393000
*                      IF (ADDR(ISBLK)) ^= NULLPTR                 0247 00394000
*                        THEN                                      0247 00395000
         B     @RC00245                                            0247 00396000
@RF00245 L     @10,@PC00001+4                                      0247 00397000
         L     @10,FDTPTR+108(,@10)                                0247 00398000
         LTR   @10,@10                                             0247 00399000
         BZ    @RF00247                                            0247 00400000
*                          DO;                                     0248 00401000
*                                                                  0248 00402000
*                          OPNRFMSF = ON;                          0249 00403000
*                          OPNRFMBK = ON;                          0250 00404000
*                                                                  0250 00405000
         OI    OPNRFMSF(OPNPTR),B'00011000'                        0250 00406000
*                          END;                                    0251 00407000
*                                                                  0251 00408000
*                        /********************************************/ 00409000
*                        /*                                          */ 00410000
*                        /*       UNDEFINED                          */ 00411000
*                        /*                                          */ 00412000
*                        /********************************************/ 00413000
*                        ELSE                                      0252 00414000
*                          IF (ADDR(IUNDF)) ^= NULLPTR             0252 00415000
*                            THEN                                  0252 00416000
         B     @RC00247                                            0252 00417000
@RF00247 L     @10,@PC00001+4                                      0252 00418000
         L     @10,FDTPTR+112(,@10)                                0252 00419000
         LTR   @10,@10                                             0252 00420000
         BZ    @RF00252                                            0252 00421000
*                              OPNRFMUN = ON;                      0253 00422000
         OI    OPNRFMUN(OPNPTR),B'00100000'                        0253 00423000
*              END INRECFMT;                                       0254 00424000
@RF00252 DS    0H                                                  0254 00425000
@RC00247 DS    0H                                                  0254 00426000
@RC00245 DS    0H                                                  0254 00427000
@RC00240 DS    0H                                                  0254 00428000
@RC00238 DS    0H                                                  0254 00429000
@RC00233 DS    0H                                                  0254 00430000
@RC00231 DS    0H                                                  0255 00431000
*                                                                  0255 00432000
*              /******************************************************/ 00433000
*              /*                                                    */ 00434000
*              /* SET BLOCKSIZE                                      */ 00435000
*              /*                                                    */ 00436000
*              /******************************************************/ 00437000
*              IF (ADDR(IBKSZ)) ^= NULLPTR                         0255 00438000
*                THEN                                              0255 00439000
@RF00229 L     @10,@PC00001+4                                      0255 00440000
         L     @10,FDTPTR+68(,@10)                                 0255 00441000
         LTR   @10,@10                                             0255 00442000
         BZ    @RF00255                                            0255 00443000
*                  OPNBLK = IBKSZVAL;                              0256 00444000
*                                                                  0256 00445000
         L     @10,IBKSZVAL(,@10)                                  0256 00446000
         ST    @10,OPNBLK(,OPNPTR)                                 0256 00447000
*              /******************************************************/ 00448000
*              /*                                                    */ 00449000
*              /* SET RECORDSIZE                                     */ 00450000
*              /*                                                    */ 00451000
*              /******************************************************/ 00452000
*              IF (ADDR(IRCSZ)) ^= NULLPTR                         0257 00453000
*                THEN                                              0257 00454000
@RF00255 L     @10,@PC00001+4                                      0257 00455000
         L     @10,FDTPTR+72(,@10)                                 0257 00456000
         LTR   @10,@10                                             0257 00457000
         BZ    @RF00257                                            0257 00458000
*                  OPNREC = IRCSZVAL;                              0258 00459000
*                                                                  0258 00460000
         L     @10,IRCSZVAL(,@10)                                  0258 00461000
         ST    @10,OPNREC(,OPNPTR)                                 0258 00462000
*              /******************************************************/ 00463000
*              /*                                                    */ 00464000
*              /* SET DEVICE TYPE OF HIGHEST INDEX LEVEL             */ 00465000
*              /*                                                    */ 00466000
*              /******************************************************/ 00467000
*              IF (ADDR(IHDEV)) ^= NULLPTR                         0259 00468000
*                THEN                                              0259 00469000
@RF00257 L     @10,@PC00001+4                                      0259 00470000
         L     @10,FDTPTR+80(,@10)                                 0259 00471000
         LTR   @10,@10                                             0259 00472000
         BZ    @RF00259                                            0259 00473000
*                  OPNDEVIX = ADDR(IHDEVVAL);                      0260 00474000
*                                                                  0260 00475000
         LA    @10,IHDEVVAL(,@10)                                  0260 00476000
         ST    @10,OPNDEVIX(,OPNPTR)                               0260 00477000
*              /******************************************************/ 00478000
*              /*                                                    */ 00479000
*              /* SET DEVICE TYPE OF PRIME RECORD DATA SET           */ 00480000
*              /*                                                    */ 00481000
*              /******************************************************/ 00482000
*              IF (ADDR(IPDEV)) ^= NULLPTR                         0261 00483000
*                THEN                                              0261 00484000
@RF00259 L     @10,@PC00001+4                                      0261 00485000
         L     @10,FDTPTR+84(,@10)                                 0261 00486000
         LTR   @10,@10                                             0261 00487000
         BZ    @RF00261                                            0261 00488000
*                  OPNDEVDT = ADDR(IPDEVVAL);                      0262 00489000
*                                                                  0262 00490000
         LA    @10,IPDEVVAL(,@10)                                  0262 00491000
         ST    @10,OPNDEVDT(,OPNPTR)                               0262 00492000
*            END INPUTENV;                                         0263 00493000
@RF00261 DS    0H                                                  0264 00494000
*                                                                  0264 00495000
*        /************************************************************/ 00496000
*        /*                                                          */ 00497000
*        /* OPEN THE INPUT DATA SET                                  */ 00498000
*        /*                                                          */ 00499000
*        /************************************************************/ 00500000
*                                                                  0264 00501000
*        CALL IDCIOOP0(GDTTBL,OPNAGL);                             0264 00502000
@RF00227 L     @10,@PC00001                                        0264 00503000
         ST    @10,@AL00001                                        0264 00504000
         ST    OPNPTR,@AL00001+4                                   0264 00505000
         MVI   @AL00001+4,X'80'                                    0264 00506000
         L     @15,GDTOPN(,@10)                                    0264 00507000
         LA    @01,@AL00001                                        0264 00508000
         BALR  @14,@15                                             0264 00509000
*        RESPECIFY RTNREG RSTD;                                    0265 00510000
*        TESTRC = RTNREG;                                          0266 00511000
         LR    TESTRC,RTNREG                                       0266 00512000
*        RESPECIFY RTNREG UNRSTD;                                  0267 00513000
*                                                                  0267 00514000
*        IF TESTRC = 0                                             0268 00515000
*          THEN                                                    0268 00516000
         LTR   TESTRC,TESTRC                                       0268 00517000
         BNZ   @RF00268                                            0268 00518000
*            DO;                                                   0269 00519000
*                                                                  0269 00520000
*            /********************************************************/ 00521000
*            /*                                                      */ 00522000
*            /* INVOKE DELIMSET TO ESTABLISH THE DELIMITERS TO THE   */ 00523000
*            /* DATA SET -                                           */ 00524000
*            /*  FROM DELIMITERS ARE ESTABLISHED BY POSITIONING VIA  */ 00525000
*            /*    A UPOSIT OR SKIP ROUTINE                          */ 00526000
*            /*  TO DELIMITERS ARE INDICATED BY THE SETTINGS OF      */ 00527000
*            /*    DELIMFLG OR LOOPINCR                              */ 00528000
*            /*                                                      */ 00529000
*            /********************************************************/ 00530000
*            CALL DELIMSET(DELIMFLG,LOOPCNT,LOOPINCR);             0270 00531000
*                                                                  0270 00532000
         LA    @10,DELIMFLG                                        0270 00533000
         ST    @10,@AL00001                                        0270 00534000
         LA    @10,LOOPCNT                                         0270 00535000
         ST    @10,@AL00001+4                                      0270 00536000
         LA    @10,LOOPINCR                                        0270 00537000
         ST    @10,@AL00001+8                                      0270 00538000
         LA    @01,@AL00001                                        0270 00539000
         BAL   @14,DELIMSET                                        0270 00540000
*            END;                                                  0271 00541000
*                                                                  0271 00542000
*          /**********************************************************/ 00543000
*          /*                                                        */ 00544000
*          /* CANNOT OPEN - TERMINAL ERROR                           */ 00545000
*          /*                                                        */ 00546000
*          /**********************************************************/ 00547000
*                                                                  0272 00548000
*          ELSE                                                    0272 00549000
*            DO;                                           /*@Y30SSJH*/ 00550000
*                                                                  0272 00551000
         B     @RC00268                                            0272 00552000
@RF00268 DS    0H                                                  0273 00553000
*            STATFLG = ABNTERM;                                    0273 00554000
*                                                                  0273 00555000
         MVC   STATFLG(5),@CB00679                                 0273 00556000
*            END;                                                  0274 00557000
*        /************************************************************/ 00558000
*        /*                                                          */ 00559000
*        /* OPEN ALTERNATE PRINT FILE FOR LISTING OUTPUT. THE AMS    */ 00560000
*        /* I/O ADAPTER OPENS THE FILE VIA THE UOPEN MACRO. THE      */ 00561000
*        /* OPAGLST IS CONSTRUCTED BY IDCPR01 TO COMMUNICATE THE     */ 00562000
*        /* REQUEST TO THE I/O ADAPTER                               */ 00563000
*        /*                                                          */ 00564000
*        /************************************************************/ 00565000
*        IF (ADDR(OUTDD)) ^= NULLPTR                               0275 00566000
*          THEN                                                    0275 00567000
@RC00268 L     @10,@PC00001+4                                      0275 00568000
         L     @10,FDTPTR+4(,@10)                                  0275 00569000
         LTR   @10,@10                                             0275 00570000
         BZ    @RF00275                                            0275 00571000
*            DO;                                                   0276 00572000
*                                                                  0276 00573000
*            OPNPTR = ADDR(OPAGLST);   /* SET POINTER TO OPNAGL      */ 00574000
         LA    OPNPTR,OPAGLST                                      0277 00575000
*            OPNAGL = ''B;             /* SET OPNAGL TO ZEROES       */ 00576000
         XC    OPNAGL(48,OPNPTR),OPNAGL(OPNPTR)                    0278 00577000
*            OPNOPTOT = ON;            /* OPEN FOR OUTPUT            */ 00578000
         OI    OPNOPTOT(OPNPTR),B'01000000'                        0279 00579000
*            OPNMODAC = ON;            /* SET CARRIAGE CONTROL       */ 00580000
         OI    OPNMODAC(OPNPTR),B'01000000'                        0280 00581000
*            OPNDDN = ADDR(OUTDDVAL);  /* NAME OF OUTFILE JCL STATMNT*/ 00582000
         LA    @10,OUTDDVAL(,@10)                                  0281 00583000
         ST    @10,OPNDDN(,OPNPTR)                                 0281 00584000
*            OPNIOC = ADDR(IOCSALT);   /* ADDR OF IOCS POINTER       */ 00585000
*                                                                  0282 00586000
         LA    @10,IOCSALT                                         0282 00587000
         ST    @10,OPNIOC(,OPNPTR)                                 0282 00588000
*            CALL IDCIOOP0 (GDTTBL,OPNAGL);                        0283 00589000
         L     @10,@PC00001                                        0283 00590000
         ST    @10,@AL00001                                        0283 00591000
         ST    OPNPTR,@AL00001+4                                   0283 00592000
         MVI   @AL00001+4,X'80'                                    0283 00593000
         L     @15,GDTOPN(,@10)                                    0283 00594000
         LA    @01,@AL00001                                        0283 00595000
         BALR  @14,@15                                             0283 00596000
*            RESPECIFY RTNREG RSTD;                                0284 00597000
*            TESTRC = RTNREG;                                      0285 00598000
         LR    TESTRC,RTNREG                                       0285 00599000
*            RESPECIFY RTNREG UNRSTD;                              0286 00600000
*                                                                  0286 00601000
*            /********************************************************/ 00602000
*            /*                                                      */ 00603000
*            /* THE ALTERNATE FILE IS OPEN SET THE IOCS POINTER OF   */ 00604000
*            /* THE ALTERNATE FILE IN OPRTFILE FOR UPRINT INVOCATION */ 00605000
*            /*                                                      */ 00606000
*            /********************************************************/ 00607000
*                                                                  0287 00608000
*            IF TESTRC = 0                                         0287 00609000
*              THEN                                                0287 00610000
         LTR   TESTRC,TESTRC                                       0287 00611000
         BNZ   @RF00287                                            0287 00612000
*                OPRTFILE = IOCSALT;                               0288 00613000
*                                                                  0288 00614000
         L     @10,IOCSALT                                         0288 00615000
         ST    @10,OPRTFILE                                        0288 00616000
*              /******************************************************/ 00617000
*              /*                                                    */ 00618000
*              /* OPEN OF ALTERNATE OUTPUT FILE WAS UNSUCCESSFUL -   */ 00619000
*              /* SET STATFLG TO TERMINATE PROCESSING                */ 00620000
*              /*                                                    */ 00621000
*              /******************************************************/ 00622000
*                                                                  0289 00623000
*              ELSE                                                0289 00624000
*                STATFLG = ABNTERM;                                0289 00625000
*                                                                  0289 00626000
         B     @RC00287                                            0289 00627000
@RF00287 MVC   STATFLG(5),@CB00679                                 0289 00628000
*            END;                                                  0290 00629000
@RC00287 DS    0H                                                  0291 00630000
*      END OPENS;                                          /*@YL026UA*/ 00631000
*                                                                  0291 00632000
@RF00275 DS    0H                                                  0292 00633000
*        /************************************************************/ 00634000
*        /*                                                          */ 00635000
*        /* THE TEXT PROCESSOR PAGE LAYOUT AND RECORD LAYOUT IS      */ 00636000
*        /* ESTABLISHED AT THIS POINT                                */ 00637000
*        /* TEXTPSET ESTABLISHES THE PAGE LAYOUT AND BUILDS THE      */ 00638000
*        /* DARGLST FOR THE RECORD LAYOUT(EXCLUDING DYNAMIC PORTIONS)*/ 00639000
*        /*                                                          */ 00640000
*        /************************************************************/ 00641000
*                                                                  0292 00642000
*        IF STATFLG = NORMAL                                       0292 00643000
*          THEN                                                    0292 00644000
*                                                                  0292 00645000
@RF00210 CLC   STATFLG(5),@CB00670                                 0292 00646000
         BNE   @RF00292                                            0292 00647000
*            CALL TEXTPSET;                                        0293 00648000
*                                                                  0293 00649000
         BAL   @14,TEXTPSET                                        0293 00650000
*        /************************************************************/ 00651000
*        /*                                                          */ 00652000
*        /* THE RECORD RETRIEVAL - PRINT CYCLE ENSUES AT THIS POINT  */ 00653000
*        /*  RECORDS ARE RETRIEVED VIA UGET- DELIMITER BOUNDS ARE    */ 00654000
*        /*  CHECKED AND THEN THE RECORD IS PRINTED VIA THE UPRINT   */ 00655000
*        /*  MACRO INTERFACE                                         */ 00656000
*        /*                                                          */ 00657000
*        /************************************************************/ 00658000
*                                                                  0294 00659000
*        CYCLEFLG = GO;                                            0294 00660000
*                                                                  0294 00661000
@RF00292 MVI   CYCLEFLG,X'00'                                      0294 00662000
*        /************************************************************/ 00663000
*        /*                                                          */ 00664000
*        /* INITIALIZE KEY LENGTH USED IN DETERMINING THE ENDING     */ 00665000
*        /* SUBSET BOUNDARY - THE LENGTH MUST BE THE MINIMUM OF THE  */ 00666000
*        /* VALUES SPECIFIED BY THE USER VERSUS THAT IN THE IOCS     */ 00667000
*        /*                                                          */ 00668000
*        /************************************************************/ 00669000
*                                                                  0295 00670000
*        IF DELIMFLG = TOKYPOST                                    0295 00671000
*          THEN                                                    0295 00672000
         CLI   DELIMFLG,X'02'                                      0295 00673000
         BNE   @RF00295                                            0295 00674000
*            ENDKYLN = MIN(TOKYCLEN,IOCKYL);                       0296 00675000
*                                                                  0296 00676000
         L     @10,@PC00001+4                                      0296 00677000
         L     @10,FDTPTR+20(,@10)                                 0296 00678000
         SLR   @05,@05                                             0296 00679000
         IC    @05,TOKYCLEN(,@10)                                  0296 00680000
         L     @10,IOCSPTR                                         0296 00681000
         SLR   @15,@15                                             0296 00682000
         IC    @15,IOCKYL(,@10)                                    0296 00683000
         CR    @05,@15                                             0296 00684000
         BNH   *+6                                                      00685000
         LR    @05,@15                                             0296 00686000
         ST    @05,ENDKYLN                                         0296 00687000
*        /************************************************************/ 00688000
*        /*                                                  @Y30SSJH*/ 00689000
*        /* IF THE DATA SET IS RELATIVE RECORD,INITIALIZE    @Y30SSJH*/ 00690000
*        /* OLDREL TO POINT TO THE SLOT PRIOR TO WHERE       @Y30SSJH*/ 00691000
*        /* PRINTING IS TO START.                            @Y30SSJH*/ 00692000
*        /*                                                  @Y30SSJH*/ 00693000
*        /************************************************************/ 00694000
*                                                                  0297 00695000
*        IF ( IOCMACRR = ON  &                                     0297 00696000
*             ADDR(COUNT) ^= NULLPTR  )                            0297 00697000
*          THEN                                                    0297 00698000
@RF00295 L     @10,IOCSPTR                                         0297 00699000
         TM    IOCMACRR(@10),B'00100000'                           0297 00700000
         BNO   @RF00297                                            0297 00701000
         SLR   @10,@10                                             0297 00702000
         L     @05,@PC00001+4                                      0297 00703000
         C     @10,FDTPTR+28(,@05)                                 0297 00704000
         BE    @RF00297                                            0297 00705000
*            DO;                                           /*@Y30SSLO*/ 00706000
*                                                                  0298 00707000
*            IF ADDR(SKIP) ^= NULLPTR                              0299 00708000
*              THEN                                                0299 00709000
         L     @05,FDTPTR+16(,@05)                                 0299 00710000
         CR    @05,@10                                             0299 00711000
         BE    @RF00299                                            0299 00712000
*                OLDREL = SKIPVAL ;                        /*@Y30SSJH*/ 00713000
         L     @10,SKIPVAL(,@05)                                   0300 00714000
         ST    @10,OLDREL                                          0300 00715000
*              ELSE                                                0301 00716000
*                IF ADDR(FMNUM) ^= NULLPTR                         0301 00717000
*                  THEN                                            0301 00718000
         B     @RC00299                                            0301 00719000
@RF00299 L     @10,@PC00001+4                                      0301 00720000
         L     @10,FDTPTR+116(,@10)                                0301 00721000
         LTR   @10,@10                                             0301 00722000
         BZ    @RF00301                                            0301 00723000
*                    OLDREL = FMNUMVAL - 1;                /*@Y30SSJH*/ 00724000
         L     @10,FMNUMVAL(,@10)                                  0302 00725000
         BCTR  @10,0                                               0302 00726000
         ST    @10,OLDREL                                          0302 00727000
*                  ELSE                                            0303 00728000
*                    OLDREL = 0;                           /*@Y30SSJH*/ 00729000
*                                                                  0303 00730000
         B     @RC00301                                            0303 00731000
@RF00301 SLR   @10,@10                                             0303 00732000
         ST    @10,OLDREL                                          0303 00733000
*            END;                                          /*@Y30SSJH*/ 00734000
*                                                                  0304 00735000
@RC00301 DS    0H                                                  0304 00736000
@RC00299 DS    0H                                                  0305 00737000
*        IF STATFLG = NORMAL                                       0305 00738000
*          THEN                                                    0305 00739000
*                                                                  0305 00740000
@RF00297 CLC   STATFLG(5),@CB00670                                 0305 00741000
         BNE   @RF00305                                            0305 00742000
*            /********************************************************/ 00743000
*            /*                                                      */ 00744000
*            /* PRTLOOPA CONTROLS THE RETRIEVAL AND PRINTING OF RECDS*/ 00745000
*            /* . LOOPCNT AND LOOPINCR CONTROL THIS LOOP WHEN A      */ 00746000
*            /*   COUNT DELIMITER IS SPECIFIED.                      */ 00747000
*            /* . CYCLEFLG CONTROLS LOOP EXIT FOR ENDING RBA, KEY    */ 00748000
*            /*   AND END OF FILE DELIMITERS.                        */ 00749000
*            /*                                                      */ 00750000
*            /********************************************************/ 00751000
*                                                                  0306 00752000
* PRTLOOPA:  DO N = 1 TO LOOPCNT BY LOOPINCR                       0306 00753000
*               WHILE CYCLEFLG = GO;                               0306 00754000
*                                                                  0306 00755000
PRTLOOPA LA    N,1                                                 0306 00756000
         B     @DE00306                                            0306 00757000
@DL00306 CLI   CYCLEFLG,X'00'                                      0306 00758000
         BNE   @DC00306                                            0306 00759000
*            /********************************************************/ 00760000
*            /*                                                      */ 00761000
*            /*  RETRIEVE RECORD FROM INPUT DATA SET                 */ 00762000
*            /*                                                      */ 00763000
*            /********************************************************/ 00764000
*                                                                  0307 00765000
*            CALL IDCIOGT0 (GDTTBL,IOCSPTR);                       0307 00766000
         L     @10,@PC00001                                        0307 00767000
         ST    @10,@AL00001                                        0307 00768000
         LA    @05,IOCSPTR                                         0307 00769000
         ST    @05,@AL00001+4                                      0307 00770000
         MVI   @AL00001+4,X'80'                                    0307 00771000
         L     @15,GDTGET(,@10)                                    0307 00772000
         LA    @01,@AL00001                                        0307 00773000
         BALR  @14,@15                                             0307 00774000
*            RESPECIFY RTNREG RSTD;                                0308 00775000
*            TESTRC = RTNREG;                                      0309 00776000
         LR    TESTRC,RTNREG                                       0309 00777000
*            RESPECIFY RTNREG UNRSTD;                              0310 00778000
*                                                                  0310 00779000
*            IF TESTRC = 0                                         0311 00780000
*              THEN                                                0311 00781000
         LTR   TESTRC,TESTRC                                       0311 00782000
         BNZ   @RF00311                                            0311 00783000
* PRTLOOPB:      DO;                                               0312 00784000
*                                                                  0312 00785000
PRTLOOPB DS    0H                                                  0313 00786000
*                /****************************************************/ 00787000
*                /*                                                  */ 00788000
*                /* INSURE ENDING RBA DELIMITER HAS NOT BEEN EXCEEDED*/ 00789000
*                /*                                                  */ 00790000
*                /****************************************************/ 00791000
*                                                                  0313 00792000
*                IF DELIMFLG = TORBAPOS                            0313 00793000
*                  THEN                                            0313 00794000
         CLI   DELIMFLG,X'03'                                      0313 00795000
         BNE   @RF00313                                            0313 00796000
*                    DO;                                           0314 00797000
*                                                                  0314 00798000
*                    IF IOCRBA > TORBAVAL                          0315 00799000
*                      THEN                                        0315 00800000
         L     @10,@PC00001+4                                      0315 00801000
         L     @10,FDTPTR+24(,@10)                                 0315 00802000
         L     @05,IOCSPTR                                         0315 00803000
         L     @05,IOCRBA(,@05)                                    0315 00804000
         C     @05,TORBAVAL(,@10)                                  0315 00805000
         BNH   @RF00315                                            0315 00806000
*                        CYCLEFLG = STOP;                          0316 00807000
*                                                                  0316 00808000
         MVI   CYCLEFLG,X'0F'                                      0316 00809000
*                    END;                                          0317 00810000
*                                                                  0318 00811000
*                  /**************************************************/ 00812000
*                  /*                                                */ 00813000
*                  /* VERIFY THAT ENDING KEY DELIMITER HAS NOT BEEN  */ 00814000
*                  /* EXCEEDED                                       */ 00815000
*                  /*                                                */ 00816000
*                  /**************************************************/ 00817000
*                  ELSE                                            0318 00818000
*                    IF DELIMFLG = TOKYPOST                        0318 00819000
*                      THEN                                        0318 00820000
         B     @RC00313                                            0318 00821000
@RF00313 CLI   DELIMFLG,X'02'                                      0318 00822000
         BNE   @RF00318                                            0318 00823000
*                        DO;                                       0319 00824000
*                                                                  0319 00825000
*                        IF TOKYCVAL < RECDKEY(1 : ENDKYLN)        0320 00826000
*                          THEN                                    0320 00827000
         L     @10,@PC00001+4                                      0320 00828000
         L     @10,FDTPTR+20(,@10)                                 0320 00829000
         L     @05,IOCSPTR                                         0320 00830000
         L     @05,IOCKYA(,@05)                                    0320 00831000
         L     @02,ENDKYLN                                         0320 00832000
         BCTR  @02,0                                               0320 00833000
         EX    @02,@SC00814                                        0320 00834000
         BNL   @RF00320                                            0320 00835000
*                            CYCLEFLG = STOP;                      0321 00836000
*                                                                  0321 00837000
         MVI   CYCLEFLG,X'0F'                                      0321 00838000
*                        END;                                      0322 00839000
*                                                                  0322 00840000
*                    /************************************************/ 00841000
*                    /* VERIFY THAT ENDING RELATIVE          @Y30SSJH*/ 00842000
*                    /* RECORD NUMBER HAS NOT BEEN           @Y30SSJH*/ 00843000
*                    /* EXCEEDED.                            @Y30SSJH*/ 00844000
*                    /*                                      @Y30SSJH*/ 00845000
*                    /************************************************/ 00846000
*                    ELSE                                          0323 00847000
*                      IF DELIMFLG = TORRNPOS                      0323 00848000
*                        THEN                                      0323 00849000
         B     @RC00318                                            0323 00850000
@RF00318 CLI   DELIMFLG,X'04'                                      0323 00851000
         BNE   @RF00323                                            0323 00852000
*                          DO;                             /*@Y30SSJH*/ 00853000
*                                                                  0324 00854000
*                          IF IOCREL > TONUMVAL            /*@Y30SSJH*/ 00855000
*                            THEN                                  0325 00856000
         L     @10,@PC00001+4                                      0325 00857000
         L     @10,FDTPTR+120(,@10)                                0325 00858000
         L     @05,IOCSPTR                                         0325 00859000
         L     @05,IOCREL(,@05)                                    0325 00860000
         C     @05,TONUMVAL(,@10)                                  0325 00861000
         BNH   @RF00325                                            0325 00862000
*                              CYCLEFLG = STOP;            /*@Y30SSJH*/ 00863000
*                                                                  0326 00864000
         MVI   CYCLEFLG,X'0F'                                      0326 00865000
*                          END;                            /*@Y30SSJH*/ 00866000
*                                                                  0327 00867000
*                        /********************************************/ 00868000
*                        /*                                  @Y30SSJH*/ 00869000
*                        /* IF COUNT SPECIFIED WITH RELA-    @Y30SSJH*/ 00870000
*                        /* TIVE RECORD DATA SET, PRINTING   @Y30SSJH*/ 00871000
*                        /* STOPS WHEN THE NUMBER OF VALID   @Y30SSJH*/ 00872000
*                        /* RECORD SLOTS PRINTED PLUS THE    @Y30SSJH*/ 00873000
*                        /* NUMBER OF INVALID SLOTS BYPASSED @Y30SSJH*/ 00874000
*                        /* EXCEEDS COUNTVAL.                @Y30SSJH*/ 00875000
*                        /*                                  @Y30SSJH*/ 00876000
*                        /********************************************/ 00877000
*                        ELSE                                      0328 00878000
*                          IF IOCMACRR = ON   &                    0328 00879000
*                             ADDR(COUNT) ^=  NULLPTR              0328 00880000
*                            THEN                                  0328 00881000
         B     @RC00323                                            0328 00882000
@RF00323 L     @10,IOCSPTR                                         0328 00883000
         TM    IOCMACRR(@10),B'00100000'                           0328 00884000
         BNO   @RF00328                                            0328 00885000
         L     @05,@PC00001+4                                      0328 00886000
         L     @05,FDTPTR+28(,@05)                                 0328 00887000
         LTR   @05,@05                                             0328 00888000
         BZ    @RF00328                                            0328 00889000
*                              DO;                         /*@Y30SSJH*/ 00890000
*                                                                  0329 00891000
*                              N = N + IOCREL - OLDREL - 1;/*@Y30SSJH*/ 00892000
         L     @10,IOCREL(,@10)                                    0330 00893000
         LR    @05,N                                               0330 00894000
         ALR   @05,@10                                             0330 00895000
         SL    @05,OLDREL                                          0330 00896000
         BCTR  @05,0                                               0330 00897000
         LR    N,@05                                               0330 00898000
*                              OLDREL = IOCREL;            /*@Y30SSJH*/ 00899000
         ST    @10,OLDREL                                          0331 00900000
*                              IF N > LOOPCNT                      0332 00901000
*                                THEN                              0332 00902000
         C     N,LOOPCNT                                           0332 00903000
         BNH   @RF00332                                            0332 00904000
*                                  CYCLEFLG = STOP;        /*@Y30SSJH*/ 00905000
         MVI   CYCLEFLG,X'0F'                                      0333 00906000
*                                ELSE;                     /*@Y30SSJH*/ 00907000
*                                                                  0334 00908000
@RF00332 DS    0H                                                  0335 00909000
*                              END;                        /*@Y30SSJH*/ 00910000
*                /****************************************************/ 00911000
*                /*                                                  */ 00912000
*                /* PRINT THE RECORD - THE DARGLIST IS INITIALIZED   */ 00913000
*                /* TO REFERENCE THE ADDRESS(DARGDBP) AND LENGTH (IN */ 00914000
*                /* (DARGRETP) OF THE DATA TO BE PRINTED AND SET     */ 00915000
*                /* DDSTRU TO INDICATE DARGFULL LENGTH. DARGDTM IS   */ 00916000
*                /* SET TO THE ADDRESS OF THE DATA HEADER    @Y30SSJH*/ 00917000
*                /* KEY, RELATIVE RECORD NUMBER, OR RECORD   @Y30SSJH*/ 00918000
*                /* SEQUENCE NUMBER - THE KEY ADDRESS IS SET @Y30SSJH*/ 00919000
*                /* DYNAMICALLY IN THIS LOOP WHILE THE ADDRESS OF THE*/ 00920000
*                /* RELATIVE RECORD NUMBER AND RECORD        @Y30SSJH*/ 00921000
*                /* SEQUENCE NUMBER IS SET IN TEXTPSET.      @Y30SSJH*/ 00922000
*                /*                                                  */ 00923000
*                /****************************************************/ 00924000
*                                                                  0336 00925000
*                IF CYCLEFLG = GO                                  0336 00926000
*                  THEN                                            0336 00927000
@RF00328 DS    0H                                                  0336 00928000
@RC00323 DS    0H                                                  0336 00929000
@RC00318 DS    0H                                                  0336 00930000
@RC00313 CLI   CYCLEFLG,X'00'                                      0336 00931000
         BNE   @RF00336                                            0336 00932000
* PRTLOOPC:          DO;                                           0337 00933000
*                                                                  0337 00934000
PRTLOOPC DS    0H                                                  0338 00935000
*                    DARGDBP = IOCDAD;                             0338 00936000
         L     @10,DDSTRU                                          0338 00937000
         L     @05,IOCSPTR                                         0338 00938000
         L     @02,IOCDAD(,@05)                                    0338 00939000
         ST    @02,DARGDBP(,@10)                                   0338 00940000
*                    DARGRETP = IOCDLN;                    /*@OZ14818*/ 00941000
         L     @05,IOCDLN(,@05)                                    0339 00942000
         ST    @05,DARGRETP(,@10)                                  0339 00943000
*                    DARGFULL = ON;                        /*@OZ14818*/ 00944000
*                                                                  0340 00945000
         OI    DARGFULL(@10),B'10000000'                           0340 00946000
*                    /************************************************/ 00947000
*                    /*                                              */ 00948000
*                    /* THE ADDRESS OF THE RECORD KEY FOR THE DATA   */ 00949000
*                    /* HEADER IS SET DYNAMICALLY IN THE LOOP. THIS  */ 00950000
*                    /* INDICATES TO THE TEXT PROCESSOR THE KEY      */ 00951000
*                    /* LOCATION                                     */ 00952000
*                    /*                                              */ 00953000
*                    /************************************************/ 00954000
*                                                                  0341 00955000
*                    IF (DARGSENT = 6  |                   /*@Y30SSJH*/ 00956000
*                        DARGSENT = 2  |                           0341 00957000
*                        DARGSENT = 10 )                   /*@Y30SSJH*/ 00958000
*                      THEN                                        0341 00959000
         CLI   DARGSENT(@10),6                                     0341 00960000
         BE    @RT00341                                            0341 00961000
         CLI   DARGSENT(@10),2                                     0341 00962000
         BE    @RT00341                                            0341 00963000
         CLI   DARGSENT(@10),10                                    0341 00964000
         BNE   @RF00341                                            0341 00965000
@RT00341 DS    0H                                                  0342 00966000
*                        DARGDTM(1) = IOCKYA;                      0342 00967000
*                                                                  0342 00968000
         L     @10,IOCSPTR                                         0342 00969000
         L     @10,IOCKYA(,@10)                                    0342 00970000
         L     @05,DDSTRU                                          0342 00971000
         ST    @10,DARGDTM(,@05)                                   0342 00972000
*                    CALL AMSTP011 (GDTTBL,OPRTFILE,DDSTRU);       0343 00973000
@RF00341 L     @10,@PC00001                                        0343 00974000
         ST    @10,@AL00001                                        0343 00975000
         LA    @05,OPRTFILE                                        0343 00976000
         ST    @05,@AL00001+4                                      0343 00977000
         LA    @05,DDSTRU                                          0343 00978000
         ST    @05,@AL00001+8                                      0343 00979000
         MVI   @AL00001+8,X'80'                                    0343 00980000
         L     @15,GDTPRT(,@10)                                    0343 00981000
         LA    @01,@AL00001                                        0343 00982000
         BALR  @14,@15                                             0343 00983000
*                    RESPECIFY RTNREG RSTD;                        0344 00984000
*                    TESTRC = RTNREG;                              0345 00985000
         LR    TESTRC,RTNREG                                       0345 00986000
*                    RESPECIFY RTNREG UNRSTD;                      0346 00987000
*                                                                  0346 00988000
*                    /************************************************/ 00989000
*                    /*                                              */ 00990000
*                    /* TERMINAL UPRINT ERROR                        */ 00991000
*                    /*                                              */ 00992000
*                    /************************************************/ 00993000
*                                                                  0347 00994000
*                    IF TESTRC >= 12                               0347 00995000
*                      THEN                                        0347 00996000
         C     TESTRC,@CF00570                                     0347 00997000
         BL    @RF00347                                            0347 00998000
*                        DO;                                       0348 00999000
*                                                                  0348 01000000
*                        STATFLG = ABNTERM;                        0349 01001000
         MVC   STATFLG(5),@CB00679                                 0349 01002000
*                        CYCLEFLG = STOP;                          0350 01003000
*                                                                  0350 01004000
         MVI   CYCLEFLG,X'0F'                                      0350 01005000
*                        END;                                      0351 01006000
*                                                                  0352 01007000
*                      ELSE                                        0352 01008000
*                                                                  0352 01009000
*                        /********************************************/ 01010000
*                        /*                                          */ 01011000
*                        /* PRINT WAS SUCCESSFUL - BUMP COUNT OF     */ 01012000
*                        /* RECORDS PRINTED                          */ 01013000
*                        /*                                          */ 01014000
*                        /********************************************/ 01015000
*                                                                  0352 01016000
*                        IF TESTRC = 0                             0352 01017000
*                          THEN                                    0352 01018000
         B     @RC00347                                            0352 01019000
@RF00347 LTR   TESTRC,TESTRC                                       0352 01020000
         BNZ   @RF00352                                            0352 01021000
*                            RECDPRCS = RECDPRCS + 1;              0353 01022000
*                                                                  0353 01023000
         LA    @10,1                                               0353 01024000
         AL    @10,RECDPRCS                                        0353 01025000
         ST    @10,RECDPRCS                                        0353 01026000
*                          /******************************************/ 01027000
*                          /*                                        */ 01028000
*                          /* NON TERMINAL UPRINT ERROR - CONTINUE   */ 01029000
*                          /* PROCESSING                             */ 01030000
*                          /*                                        */ 01031000
*                          /******************************************/ 01032000
*                                                                  0354 01033000
*                          ELSE                                    0354 01034000
*                            DO;                                   0354 01035000
*                                                                  0354 01036000
         B     @RC00352                                            0354 01037000
@RF00352 DS    0H                                                  0355 01038000
*                            STATFLG = ABNEVENT;                   0355 01039000
         MVC   STATFLG(5),@CB00676                                 0355 01040000
*                            RECDPRCS = RECDPRCS + 1;              0356 01041000
*                                                                  0356 01042000
         LA    @10,1                                               0356 01043000
         AL    @10,RECDPRCS                                        0356 01044000
         ST    @10,RECDPRCS                                        0356 01045000
*                            END;                                  0357 01046000
*                                                                  0357 01047000
*                    END PRTLOOPC;                                 0358 01048000
*                                                                  0358 01049000
*                END PRTLOOPB;                                     0359 01050000
*                                                                  0359 01051000
*              /******************************************************/ 01052000
*              /*                                                    */ 01053000
*              /* INTERROGATE NON ZERO I/O ADAPTER RETURN CODES -    */ 01054000
*              /* AN RCFAIL CONDITION WITH IOCMSGOP TURNED ON ALLOWS */ 01055000
*              /* CONTINUATION OF PROCESSING                         */ 01056000
*              /* ON RCEODAD VERIFY THAT SPECIFIED ENDING POSITION   */ 01057000
*              /* WAS PROCESSED                                      */ 01058000
*              /* RESET DARGFULL INDICATORS                          */ 01059000
*              /*                                                    */ 01060000
*              /******************************************************/ 01061000
*              ELSE                                                0360 01062000
*                DO;                                               0360 01063000
*                                                                  0360 01064000
         B     @RC00311                                            0360 01065000
@RF00311 DS    0H                                                  0361 01066000
*                CYCLEFLG = STOP;                                  0361 01067000
         MVI   CYCLEFLG,X'0F'                                      0361 01068000
*                DARGFULL = OFF;                           /*@OZ14818*/ 01069000
         L     @10,DDSTRU                                          0362 01070000
         NI    DARGFULL(@10),B'01111111'                           0362 01071000
*                DARGRETP = NULLPTR;                       /*@OZ14818*/ 01072000
*                                                                  0363 01073000
         SLR   @05,@05                                             0363 01074000
         ST    @05,DARGRETP(,@10)                                  0363 01075000
*                /****************************************************/ 01076000
*                /*                                                  */ 01077000
*                /* ON RCEODAD VERIFY ENDING DELIMITER WAS PROCESSED */ 01078000
*                /* IF NOT PROCESSED INDICATE LASTCC = 4             */ 01079000
*                /*                                                  */ 01080000
*                /****************************************************/ 01081000
*                IF TESTRC = 16    &                               0364 01082000
*                  (DELIMFLG ^= '00'X   |                          0364 01083000
*                   LOOPINCR ^=  0      )                          0364 01084000
*                  THEN                                            0364 01085000
         C     TESTRC,@CF00474                                     0364 01086000
         BNE   @RF00364                                            0364 01087000
         CLI   DELIMFLG,X'00'                                      0364 01088000
         BNE   @RT00364                                            0364 01089000
         CH    @05,LOOPINCR                                        0364 01090000
         BE    @RF00364                                            0364 01091000
@RT00364 DS    0H                                                  0365 01092000
*                    DO;                                           0365 01093000
*                                                                  0365 01094000
*                    /************************************************/ 01095000
*                    /*                                              */ 01096000
*                    /* WAS END KEY POSITION BEYOND EOF              */ 01097000
*                    /*                                              */ 01098000
*                    /************************************************/ 01099000
*                    IF DELIMFLG = TOKYPOST                        0366 01100000
*                      THEN                                        0366 01101000
         CLI   DELIMFLG,X'02'                                      0366 01102000
         BNE   @RF00366                                            0366 01103000
*                        IF TOKYCVAL > RECDKEY(1:ENDKYLN)          0367 01104000
*                          THEN                                    0367 01105000
         L     @10,@PC00001+4                                      0367 01106000
         L     @10,FDTPTR+20(,@10)                                 0367 01107000
         L     @05,IOCSPTR                                         0367 01108000
         L     @05,IOCKYA(,@05)                                    0367 01109000
         L     @15,ENDKYLN                                         0367 01110000
         BCTR  @15,0                                               0367 01111000
         EX    @15,@SC00814                                        0367 01112000
         BNH   @RF00367                                            0367 01113000
*                            STATFLG = ABNCONDT;                   0368 01114000
         MVC   STATFLG(5),@CB00673                                 0368 01115000
*                          ELSE;                                   0369 01116000
*                                                                  0369 01117000
@RF00367 DS    0H                                                  0370 01118000
*                      /**********************************************/ 01119000
*                      /*                                            */ 01120000
*                      /* WAS ENDING RBA DELIMITER BEYOND EOF        */ 01121000
*                      /*                                            */ 01122000
*                      /**********************************************/ 01123000
*                      ELSE                                        0370 01124000
*                        IF DELIMFLG = TORBAPOS                    0370 01125000
*                          THEN                                    0370 01126000
         B     @RC00366                                            0370 01127000
@RF00366 CLI   DELIMFLG,X'03'                                      0370 01128000
         BNE   @RF00370                                            0370 01129000
*                            IF TORBAVAL > IOCRBA                  0371 01130000
*                            THEN                                  0371 01131000
         L     @10,@PC00001+4                                      0371 01132000
         L     @10,FDTPTR+24(,@10)                                 0371 01133000
         L     @10,TORBAVAL(,@10)                                  0371 01134000
         L     @05,IOCSPTR                                         0371 01135000
         C     @10,IOCRBA(,@05)                                    0371 01136000
         BNH   @RF00371                                            0371 01137000
*                              STATFLG = ABNCONDT;                 0372 01138000
*                                                                  0372 01139000
         MVC   STATFLG(5),@CB00673                                 0372 01140000
*                            ELSE;                                 0373 01141000
*                                                                  0373 01142000
@RF00371 DS    0H                                                  0374 01143000
*                          /******************************************/ 01144000
*                          /*                                @Y30SSJH*/ 01145000
*                          /* WAS END RECORD NUMBER BEYOND   @Y30SSJH*/ 01146000
*                          /* EOF.                           @Y30SSJH*/ 01147000
*                          /*                                @Y30SSJH*/ 01148000
*                          /******************************************/ 01149000
*                          ELSE                                    0374 01150000
*                            IF DELIMFLG = TORRNPOS                0374 01151000
*                              THEN                                0374 01152000
         B     @RC00370                                            0374 01153000
@RF00370 CLI   DELIMFLG,X'04'                                      0374 01154000
         BNE   @RF00374                                            0374 01155000
*                                IF TONUMVAL > IOCREL              0375 01156000
*                                  THEN                            0375 01157000
         L     @10,@PC00001+4                                      0375 01158000
         L     @10,FDTPTR+120(,@10)                                0375 01159000
         L     @10,TONUMVAL(,@10)                                  0375 01160000
         L     @05,IOCSPTR                                         0375 01161000
         C     @10,IOCREL(,@05)                                    0375 01162000
         BNH   @RF00375                                            0375 01163000
*                                    STATFLG = ABNCONDT;   /*@Y30SSJH*/ 01164000
         MVC   STATFLG(5),@CB00673                                 0376 01165000
*                                  ELSE;                   /*@Y30SSJH*/ 01166000
*                                                                  0377 01167000
*                                                                  0377 01168000
@RF00375 DS    0H                                                  0378 01169000
*                              /**************************************/ 01170000
*                              /*                                    */ 01171000
*                              /* IF COUNT WAS SPECIFIED AND         */ 01172000
*                              /* AN END OF FILE OCCURRED            */ 01173000
*                              /* SET STATFLG TO ABNCONDT            */ 01174000
*                              /*                                    */ 01175000
*                              /**************************************/ 01176000
*                              ELSE                                0378 01177000
*                                IF LOOPINCR ^= 0                  0378 01178000
*                                  THEN                            0378 01179000
         B     @RC00374                                            0378 01180000
@RF00374 LH    @10,LOOPINCR                                        0378 01181000
         LTR   @10,@10                                             0378 01182000
         BZ    @RF00378                                            0378 01183000
*                                    STATFLG = ABNCONDT;   /*@Y30SSJH*/ 01184000
*                                                                  0379 01185000
         MVC   STATFLG(5),@CB00673                                 0379 01186000
*                    END;                                          0380 01187000
@RF00378 DS    0H                                                  0380 01188000
@RC00374 DS    0H                                                  0380 01189000
@RC00370 DS    0H                                                  0380 01190000
@RC00366 DS    0H                                                  0381 01191000
*                                                                  0381 01192000
*                /****************************************************/ 01193000
*                /*                                                  */ 01194000
*                /* RCFAIL - SET SEVERITY AND SEE IF PROCESSING CAN  */ 01195000
*                /* CONTINUE                                         */ 01196000
*                /*                                                  */ 01197000
*                /****************************************************/ 01198000
*                IF TESTRC = 4                                     0381 01199000
*                  THEN                                            0381 01200000
@RF00364 C     TESTRC,@CF00039                                     0381 01201000
         BNE   @RF00381                                            0381 01202000
*                    IF IOCMSGOP = ON                              0382 01203000
*                      THEN                                        0382 01204000
         L     @10,IOCSPTR                                         0382 01205000
         TM    IOCMSGOP(@10),B'00100000'                           0382 01206000
         BNO   @RF00382                                            0382 01207000
*                        DO;                                       0383 01208000
*                                                                  0383 01209000
*                        /********************************************/ 01210000
*                        /*                                          */ 01211000
*                        /* PRINT WILL ONLY ALLOW CONTINUATION ON    */ 01212000
*                        /* THREE I/O ERRORS THE FOURTH WILL CAUSE   */ 01213000
*                        /* TERMINATION.                             */ 01214000
*                        /*                                          */ 01215000
*                        /********************************************/ 01216000
*                        RPIOERR = RPIOERR + 1;                    0384 01217000
*                                                                  0384 01218000
         AL    RPIOERR,@CF00216                                    0384 01219000
*                        IF RPIOERR > 3                            0385 01220000
*                          THEN                                    0385 01221000
         C     RPIOERR,@CF00159                                    0385 01222000
         BNH   @RF00385                                            0385 01223000
*                            STATFLG = ABNTERM;                    0386 01224000
*                                                                  0386 01225000
         MVC   STATFLG(5),@CB00679                                 0386 01226000
*                          ELSE                                    0387 01227000
*                            DO;                                   0387 01228000
*                                                                  0387 01229000
         B     @RC00385                                            0387 01230000
@RF00385 DS    0H                                                  0388 01231000
*                            CYCLEFLG = GO;                        0388 01232000
         MVI   CYCLEFLG,X'00'                                      0388 01233000
*                            STATFLG = ABNEVENT;                   0389 01234000
*                                                                  0389 01235000
         MVC   STATFLG(5),@CB00676                                 0389 01236000
*                            END;                                  0390 01237000
*                                                                  0390 01238000
*                        END;                                      0391 01239000
*                                                                  0391 01240000
*                      ELSE                                        0392 01241000
*                        STATFLG = ABNTERM;                        0392 01242000
*                                                                  0392 01243000
         B     @RC00382                                            0392 01244000
@RF00382 MVC   STATFLG(5),@CB00679                                 0392 01245000
*                END;                                              0393 01246000
*                                                                  0393 01247000
@RC00382 DS    0H                                                  0393 01248000
@RF00381 DS    0H                                                  0394 01249000
*          END PRTLOOPA;                                           0394 01250000
@RC00311 AH    N,LOOPINCR                                          0394 01251000
@DE00306 C     N,LOOPCNT                                           0394 01252000
         BNH   @DL00306                                            0394 01253000
@DC00306 DS    0H                                                  0395 01254000
*        /************************************************************/ 01255000
*        /*                                                          */ 01256000
*        /* IDCPR01 TERMINATION PROCESSING -                         */ 01257000
*        /*    . ISSUE MESSAGE GIVING NUMBER OF RECORDS PRINTED      */ 01258000
*        /*    . ISSUE ERROR/TERMINATION MESSAGE                     */ 01259000
*        /*    . CLOSE DATA SETS OPENED                              */ 01260000
*        /*    . RETURN TO INVOKED OF IDCPR01                        */ 01261000
*        /*                                                          */ 01262000
*        /************************************************************/ 01263000
*                                                                  0395 01264000
*        OLDERID2 = NEWERID2;                                      0395 01265000
@RF00305 L     @10,@PC00001                                        0395 01266000
         L     @15,GDTTR2(,@10)                                    0395 01267000
         MVC   @TS00001(95),NEWERID2(@15)                          0395 01268000
         MVC   OLDERID2(95,@15),@TS00001                           0395 01269000
*        NEWID2 = 'PR18';                                          0396 01270000
*                                                                  0396 01271000
         MVC   NEWID2(4,@15),@CC00749                              0396 01272000
*        /************************************************************/ 01273000
*        /*                                                          */ 01274000
*        /* ISSUE MESSAGE GIVING THE NUMBER OF RECORDS PRINTED       */ 01275000
*        /* . RECDPRCS CONTAINS THE COUNT OF RECORDS PRINTED         */ 01276000
*        /*                                                          */ 01277000
*        /************************************************************/ 01278000
*                                                                  0397 01279000
*        DARGL = ''B;                                      /*@Y30SSLO*/ 01280000
         XC    DARGL(28),DARGL                                     0397 01281000
*        DARGSMOD = 'UV0';                                         0398 01282000
         L     @15,DDSTRU                                          0398 01283000
         MVC   DARGSMOD(3,@15),@CC00750                            0398 01284000
*        DARGSENT = 5;                                             0399 01285000
         MVI   DARGSENT(@15),X'05'                                 0399 01286000
*        DARGDBP = ADDR(RECDPRCS);                                 0400 01287000
         LA    @14,RECDPRCS                                        0400 01288000
         ST    @14,DARGDBP(,@15)                                   0400 01289000
*        DARGILP  = LENGTH(RECDPRCS);                              0401 01290000
*                                                                  0401 01291000
         MVC   DARGILP(2,@15),@CH00039                             0401 01292000
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0402 01293000
*                                                                  0402 01294000
         ST    @10,@AL00001                                        0402 01295000
         LA    @15,@CF00112                                        0402 01296000
         ST    @15,@AL00001+4                                      0402 01297000
         LA    @15,DDSTRU                                          0402 01298000
         ST    @15,@AL00001+8                                      0402 01299000
         MVI   @AL00001+8,X'80'                                    0402 01300000
         L     @15,GDTPRT(,@10)                                    0402 01301000
         LA    @01,@AL00001                                        0402 01302000
         BALR  @14,@15                                             0402 01303000
*        /************************************************************/ 01304000
*        /*                                                          */ 01305000
*        /* CLOSE DATA SETS OPENED BY IDCPR01 - THE INPUT AND        */ 01306000
*        /* OPTIONALLY THE ALTERNATE LISTING DATA SET                */ 01307000
*        /*                                                          */ 01308000
*        /************************************************************/ 01309000
*        IF OPRTFILE = NULLPTR                                     0403 01310000
*          THEN                                                    0403 01311000
         L     @10,OPRTFILE                                        0403 01312000
         LTR   @10,@10                                             0403 01313000
         BNZ   @RF00403                                            0403 01314000
*            CALL IDCIOCL0 (GDTTBL,IOCSPTR);                       0404 01315000
         L     @10,@PC00001                                        0404 01316000
         ST    @10,@AL00001                                        0404 01317000
         LA    @15,IOCSPTR                                         0404 01318000
         ST    @15,@AL00001+4                                      0404 01319000
         MVI   @AL00001+4,X'80'                                    0404 01320000
         L     @15,GDTCLS(,@10)                                    0404 01321000
         LA    @01,@AL00001                                        0404 01322000
         BALR  @14,@15                                             0404 01323000
*          ELSE                                                    0405 01324000
*            CALL IDCIOCL0 (GDTTBL,IOCSALT,IOCSPTR);               0405 01325000
*                                                                  0405 01326000
         B     @RC00403                                            0405 01327000
@RF00403 L     @10,@PC00001                                        0405 01328000
         ST    @10,@AL00001                                        0405 01329000
         LA    @15,IOCSALT                                         0405 01330000
         ST    @15,@AL00001+4                                      0405 01331000
         LA    @15,IOCSPTR                                         0405 01332000
         ST    @15,@AL00001+8                                      0405 01333000
         MVI   @AL00001+8,X'80'                                    0405 01334000
         L     @15,GDTCLS(,@10)                                    0405 01335000
         LA    @01,@AL00001                                        0405 01336000
         BALR  @14,@15                                             0405 01337000
*        RESPECIFY RTNREG RSTD;                                    0406 01338000
@RC00403 DS    0H                                                  0407 01339000
*        TESTRC = RTNREG;                                          0407 01340000
         LR    TESTRC,RTNREG                                       0407 01341000
*        RESPECIFY RTNREG UNRSTD;                                  0408 01342000
*                                                                  0408 01343000
*        IF TESTRC ^= 0                                            0409 01344000
*          THEN                                                    0409 01345000
*                                                                  0409 01346000
         LTR   TESTRC,TESTRC                                       0409 01347000
         BZ    @RF00409                                            0409 01348000
*            /********************************************************/ 01349000
*            /*                                                      */ 01350000
*            /* CLOSE ERROR - SET STATFLG IF ABNTERM IS NOT INDICATED*/ 01351000
*            /*                                                      */ 01352000
*            /********************************************************/ 01353000
*            DO;                                                   0410 01354000
*                                                                  0410 01355000
*            IF STATFLG ^= ABNTERM   &                     /*@YA04557*/ 01356000
*               STATFLG ^= POSITERR                                0411 01357000
*              THEN                                                0411 01358000
         CLC   STATFLG(5),@CB00679                                 0411 01359000
         BE    @RF00411                                            0411 01360000
         CLC   STATFLG(5),@CB00682                                 0411 01361000
         BE    @RF00411                                            0411 01362000
*                STATFLG = ABNEVENT;                               0412 01363000
*                                                                  0412 01364000
         MVC   STATFLG(5),@CB00676                                 0412 01365000
*            END;                                                  0413 01366000
@RF00411 DS    0H                                                  0414 01367000
*                                                                  0414 01368000
*        /************************************************************/ 01369000
*        /*                                                          */ 01370000
*        /*  ISSUE TERMINATION MESSAGE                               */ 01371000
*        /* . STATFLG CONTAINS THE PROCESSING STATUS                 */ 01372000
*        /*                                                          */ 01373000
*        /************************************************************/ 01374000
*                                                                  0414 01375000
*        DARGL = ''B;                                      /*@Y30SSLO*/ 01376000
@RF00409 XC    DARGL(28),DARGL                                     0414 01377000
*        DARGSENT = STATFLG2;                                      0415 01378000
         L     @10,DDSTRU                                          0415 01379000
         IC    @15,STATFLG2                                        0415 01380000
         STC   @15,DARGSENT(,@10)                                  0415 01381000
*        DARGSMOD = STMODID;                                       0416 01382000
         MVC   DARGSMOD(3,@10),STMODID                             0416 01383000
*        DARGDBP  = ADDR(LASTCC);                                  0417 01384000
         L     @15,@PC00001+8                                      0417 01385000
         ST    @15,DARGDBP(,@10)                                   0417 01386000
*        DARGILP  = LENGTH(LASTCC);                                0418 01387000
         MVC   DARGILP(2,@10),@CH00150                             0418 01388000
*        LASTCC   = STATFLG1;                                      0419 01389000
         SLR   @14,@14                                             0419 01390000
         IC    @14,STATFLG1                                        0419 01391000
         STH   @14,LASTCC(,@15)                                    0419 01392000
*        IF GDTECT ^= 0 & LASTCC > 0                               0420 01393000
*          THEN                                                    0420 01394000
         SLR   @15,@15                                             0420 01395000
         L     @09,@PC00001                                        0420 01396000
         C     @15,GDTECT(,@09)                                    0420 01397000
         BE    @RF00420                                            0420 01398000
         CR    @14,@15                                             0420 01399000
         BNH   @RF00420                                            0420 01400000
*            DARGSENT = 15; /*ISSUE BRIEF MSG FOR TSO USER   @Y30SSEC*/ 01401000
*                                                                  0421 01402000
         MVI   DARGSENT(@10),X'0F'                                 0421 01403000
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0422 01404000
*                                                                  0422 01405000
@RF00420 L     @10,@PC00001                                        0422 01406000
         ST    @10,@AL00001                                        0422 01407000
         LA    @15,@CF00112                                        0422 01408000
         ST    @15,@AL00001+4                                      0422 01409000
         LA    @15,DDSTRU                                          0422 01410000
         ST    @15,@AL00001+8                                      0422 01411000
         MVI   @AL00001+8,X'80'                                    0422 01412000
         L     @15,GDTPRT(,@10)                                    0422 01413000
         LA    @01,@AL00001                                        0422 01414000
         BALR  @14,@15                                             0422 01415000
*        IF GDTDBG = NULLPTR                                       0423 01416000
*          THEN;                                                   0423 01417000
         L     @10,@PC00001                                        0423 01418000
         L     @10,GDTDBG(,@10)                                    0423 01419000
         LTR   @10,@10                                             0423 01420000
         BZ    @RT00423                                            0423 01421000
*          ELSE                                                    0425 01422000
*            CALL IDCDB010 (GDTTBL,'PR01');                        0425 01423000
*                                                                  0425 01424000
         L     @10,@PC00001                                        0425 01425000
         ST    @10,@AL00001                                        0425 01426000
         LA    @15,@CC00685                                        0425 01427000
         ST    @15,@AL00001+4                                      0425 01428000
         MVI   @AL00001+4,X'80'                                    0425 01429000
         L     @15,GDTDBG(,@10)                                    0425 01430000
         LA    @01,@AL00001                                        0425 01431000
         BALR  @14,@15                                             0425 01432000
*        /************************************************************/ 01433000
*        /*                                                          */ 01434000
*        /*       RETURN TO INVOKER OF IDCPR01                       */ 01435000
*        /*                                                          */ 01436000
*        /************************************************************/ 01437000
*                                                                  0426 01438000
*        CALL IDCSAEP0(GDTTBL,MODID);                              0426 01439000
@RT00423 L     @10,@PC00001                                        0426 01440000
         ST    @10,@AL00001                                        0426 01441000
         LA    @15,MODID                                           0426 01442000
         ST    @15,@AL00001+4                                      0426 01443000
         MVI   @AL00001+4,X'80'                                    0426 01444000
         L     @15,GDTEPL(,@10)                                    0426 01445000
         LA    @01,@AL00001                                        0426 01446000
         BALR  @14,@15                                             0426 01447000
*                                                                  0427 01448000
*/********************************************************************/ 01449000
*/*                                                                  */ 01450000
*/* PROCEDURE NAME - TEXTPSET                                        */ 01451000
*/*                                                                  */ 01452000
*/* FUNCTION - TEXTPSET COMMUNICATES THE PAGE LAYOUT AND RECORD      */ 01453000
*/*            LAYOUT FOR THE LISTING TO THE AMS TEXT PROCESSOR.     */ 01454000
*/*                                                                  */ 01455000
*/*            THE PAGE LAYOUT IS DEFINED USING THE DEFAULT VALUES   */ 01456000
*/*            OF THE PAGE CONTROL INTERFACE(PCARGLST) - EXCEPT FOR  */ 01457000
*/*            THE SUBTITLE LINE. THE STATIC PORTION OF THE SUBTITLE */ 01458000
*/*            LINE IS RETRIEVED FROM THE STATIC TEXT MODULE VIA THE */ 01459000
*/*            UPRINT MACRO, THE NAME OF THE INPUT DATA SET IS MOVED */ 01460000
*/*            INTO THIS LINE FROM THE LOCATION REFERENCED BY IOCDSN */ 01461000
*/*            IN THE IOCS.  THE REVISED SUBTITLE LINE AND PAGE      */ 01462000
*/*            CONTROL INFORMATION IS COMMUNICATED TO THE TEXT       */ 01463000
*/*            VIA THE UESTA MACRO.                                  */ 01464000
*/*                                                                  */ 01465000
*/*            THE RECORD LAYOUT IS COMPOSED OF TWO SECTIONS:        */ 01466000
*/*              . THE RECORD KEY , RELATIVE RECORD NUMBER   @Y30SSJH*/ 01467000
*/*                OR RECORD SEQUENCE NUMBER                 @Y30SSJH*/ 01468000
*/*              . THE DATA PORTION OF THE RECORD                    */ 01469000
*/*            THE DARGLST REFERENCES THE DYNAMIC DATA OF THESE TWO  */ 01470000
*/*            SECTIONS ON EACH INVOCATION OF THE UPRINT MACRO.  THE */ 01471000
*/*            OUTPUT FORMAT IS INCLUDED IN THE STATIC TEXT AS       */ 01472000
*/*            REFERENCED BY THE DARGSTID                            */ 01473000
*/*                                                                  */ 01474000
*/* INPUT -                                                          */ 01475000
*/*      TEXTPSET REFERENCES THE FOLLOWING ITEMS FROM                */ 01476000
*/*      THE DECLARATIONS IN THE MAIN PROCEDURE:                     */ 01477000
*/*       . DARGLIST - TEXT PROCESSOR DATA ARGUMENT LIST             */ 01478000
*/*        . PCARGLIST- PAGE CONTROL ARG LIST (TEXT PROCESSOR)       */ 01479000
*/*                                                                  */ 01480000
*/* OUTPUT -                                                         */ 01481000
*/*      . THE PAGE CONTROL IS ESTABLISHED                           */ 01482000
*/*      . THE DARGLIST IS CONSTRUCTED EXCLUSIVE OF DYNAMIC DATA     */ 01483000
*/*        SET IN THE UGET/UPRINT LOOP                               */ 01484000
*/*                                                                  */ 01485000
*/********************************************************************/ 01486000
*                                                                  0427 01487000
*TEXTPSET:                                                         0427 01488000
*        PROCEDURE;                                                0427 01489000
*                                                                  0427 01490000
@EL00001 L     @13,4(,@13)                                         0427 01491000
@EF00001 L     @00,@SIZDATD                                        0427 01492000
         LR    @01,@11                                             0427 01493000
         FREEMAIN R,LV=(0),A=(1)                                        01494000
@ER00001 LM    @14,@12,12(@13)                                     0427 01495000
         BR    @14                                                 0427 01496000
TEXTPSET STM   @14,@12,@SA00002                                    0427 01497000
*        /************************************************************/ 01498000
*        /*                                                          */ 01499000
*        /* NAME OF DATA SET BEING PRINTED SET UP BY UOPEN           */ 01500000
*        /*                                                          */ 01501000
*        /***********************************************************/  01502000
*        DCL                                                       0428 01503000
*          PRTDSNAM  CHAR(44) BASED(IOCDSN);                       0428 01504000
*                                                                  0428 01505000
*        /************************************************************/ 01506000
*        /*                                                          */ 01507000
*        /* AREA INTO WHICH THE SUBTITLE LINE IS CONSTRUCTED         */ 01508000
*        /*                                                          */ 01509000
*        /************************************************************/ 01510000
*        DCL                                                       0429 01511000
*          1 SUBTBUFF  CHAR(121),                                  0429 01512000
*            2 SUBTLHDR  CHAR(22),     /* SKELETON PORTION           */ 01513000
*            2 SUBTLDSN  CHAR(99);     /* DATA SET NAME PLUS PADDING */ 01514000
*                                                                  0429 01515000
*        /************************************************************/ 01516000
*        /*                                                          */ 01517000
*        /* ENTRY POINT TO TEXTPSET - THIS IS THE ONLY ENTRY POINT   */ 01518000
*        /*                                                          */ 01519000
*        /************************************************************/ 01520000
*                                                                  0430 01521000
*        OLDERID2 = NEWERID2;                                      0430 01522000
         L     @10,@PC00001                                        0430 01523000
         L     @03,GDTTR2(,@10)                                    0430 01524000
         MVC   @TS00001(95),NEWERID2(@03)                          0430 01525000
         MVC   OLDERID2(95,@03),@TS00001                           0430 01526000
*        NEWID2 = 'PR21';                                          0431 01527000
*                                                                  0431 01528000
         MVC   NEWID2(4,@03),@CC00760                              0431 01529000
*        /************************************************************/ 01530000
*        /*                                                          */ 01531000
*        /* THE PAGE LAYOUT FOR THE LISTING IS COMMUNICATED TO THE   */ 01532000
*        /* AMS TEXT PROCESSOR                                       */ 01533000
*        /*                                                          */ 01534000
*        /************************************************************/ 01535000
*                                                                  0432 01536000
*        DARGL = ''B;                                              0432 01537000
         XC    DARGL(28),DARGL                                     0432 01538000
*        DARGRETP= ADDR(SUBTBUFF);                                 0433 01539000
         L     @03,DDSTRU                                          0433 01540000
         LA    @15,SUBTBUFF                                        0433 01541000
         ST    @15,DARGRETP(,@03)                                  0433 01542000
*        DARGSMOD='PR0';                                           0434 01543000
         MVC   DARGSMOD(3,@03),@CC00761                            0434 01544000
*        DARGSENT = '01'X;                                         0435 01545000
         MVI   DARGSENT(@03),X'01'                                 0435 01546000
*        DARGRETL= LENGTH(SUBTBUFF);                       /*@Y30SSJH*/ 01547000
*                                                                  0436 01548000
         MVC   DARGRETL(2,@03),@CH00756                            0436 01549000
*        /************************************************************/ 01550000
*        /*                                                          */ 01551000
*        /* RETRIEVE THE STATIC TEXT SUBTITLE LINE SKELETON          */ 01552000
*        /*                                                          */ 01553000
*        /************************************************************/ 01554000
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0437 01555000
         ST    @10,@AL00001                                        0437 01556000
         LA    @03,@CF00112                                        0437 01557000
         ST    @03,@AL00001+4                                      0437 01558000
         LA    @03,DDSTRU                                          0437 01559000
         ST    @03,@AL00001+8                                      0437 01560000
         MVI   @AL00001+8,X'80'                                    0437 01561000
         L     @15,GDTPRT(,@10)                                    0437 01562000
         LA    @01,@AL00001                                        0437 01563000
         BALR  @14,@15                                             0437 01564000
*        RESPECIFY RTNREG RSTD;                                    0438 01565000
*        TESTRC = RTNREG;                                          0439 01566000
         LR    TESTRC,RTNREG                                       0439 01567000
*        RESPECIFY RTNREG UNRSTD;                                  0440 01568000
*                                                                  0440 01569000
*        IF TESTRC =< 4                                            0441 01570000
*          THEN                                                    0441 01571000
         C     TESTRC,@CF00039                                     0441 01572000
         BH    @RF00441                                            0441 01573000
*            DO;                                                   0442 01574000
*                                                                  0442 01575000
*            /********************************************************/ 01576000
*            /*                                                      */ 01577000
*            /* THE DATA SET NAME TO BE LISTED IS ADDED TO THE SUB-  */ 01578000
*            /* TITLE LINE. THE ADDRESS OF THE NAME IS IN THE IOCS   */ 01579000
*            /* WHICH IS BUILT AT UOPEN TIME.                        */ 01580000
*            /*                                                      */ 01581000
*            /********************************************************/ 01582000
*                                                                  0443 01583000
*            IF GDTECT = NULLPTR                                   0443 01584000
*              THEN                                                0443 01585000
         L     @10,@PC00001                                        0443 01586000
         L     @03,GDTECT(,@10)                                    0443 01587000
         LTR   @03,@03                                             0443 01588000
         BNZ   @RF00443                                            0443 01589000
*                DO;           /* CHECK FOR TSO ENVIRONMENT  @Y30SSEC*/ 01590000
*                   PCARGLST = ''B;                                0445 01591000
         XC    PCARGLST(34),PCARGLST                               0445 01592000
*                   PCSTLP = ADDR(SUBTBUFF);                       0446 01593000
         LA    @03,SUBTBUFF                                        0446 01594000
         ST    @03,PCSTLP                                          0446 01595000
*                   PCSTLC = 1;                                    0447 01596000
         MVC   PCSTLC(2),@CH00216                                  0447 01597000
*                   SUBTLDSN = PRTDSNAM;                           0448 01598000
*                                                                  0448 01599000
         MVI   SUBTLDSN+44,C' '                                    0448 01600000
         MVC   SUBTLDSN+45(54),SUBTLDSN+44                         0448 01601000
         L     @03,IOCSPTR                                         0448 01602000
         L     @03,IOCDSN(,@03)                                    0448 01603000
         MVC   SUBTLDSN(44),PRTDSNAM(@03)                          0448 01604000
*                   /*************************************************/ 01605000
*                   /*                                               */ 01606000
*                   /* UESTA COMMUNICATES THE, NOW COMPLETE, PAGE    */ 01607000
*                   /* LAYOUT TO THE AMS TEXT PROCESSOR              */ 01608000
*                   /*                                               */ 01609000
*                   /*************************************************/ 01610000
*                                                                  0449 01611000
*                   CALL AMSTP042 (GDTTBL,PRTFILE,PCARGLST);       0449 01612000
         ST    @10,@AL00001                                        0449 01613000
         LA    @03,@CF00112                                        0449 01614000
         ST    @03,@AL00001+4                                      0449 01615000
         LA    @03,PCARGLST                                        0449 01616000
         ST    @03,@AL00001+8                                      0449 01617000
         L     @15,GDTESA(,@10)                                    0449 01618000
         LA    @01,@AL00001                                        0449 01619000
         BALR  @14,@15                                             0449 01620000
*                   RESPECIFY RTNREG RSTD;                         0450 01621000
*                   TESTRC = RTNREG;                               0451 01622000
         LR    TESTRC,RTNREG                                       0451 01623000
*                   RESPECIFY RTNREG UNRSTD;                       0452 01624000
*                END;                                      /*@Y30SSEC*/ 01625000
*                                                                  0453 01626000
*            IF TESTRC =< 4                                        0454 01627000
*              THEN                                                0454 01628000
@RF00443 C     TESTRC,@CF00039                                     0454 01629000
         BH    @RF00454                                            0454 01630000
*                DO;                                               0455 01631000
*                                                                  0455 01632000
*                /****************************************************/ 01633000
*                /*                                                  */ 01634000
*                /* INITIALIZE THE DARGLIST                          */ 01635000
*                /*  THIS ARGUMENT LIST ESTABLISHES THE RECORD LAYOUT*/ 01636000
*                /*  BY SPECIFYING THE DATA HEADER AND DATA FORMAT   */ 01637000
*                /*                                                  */ 01638000
*                /****************************************************/ 01639000
*                                                                  0456 01640000
*                DARGL = ''B;                                      0456 01641000
         XC    DARGL(28),DARGL                                     0456 01642000
*                DARGCNT = 1;                                      0457 01643000
         L     @10,DDSTRU                                          0457 01644000
         MVC   DARGCNT(2,@10),@CH00216                             0457 01645000
*                DARGSMOD = 'PR0';                                 0458 01646000
*                                                                  0458 01647000
         MVC   DARGSMOD(3,@10),@CC00761                            0458 01648000
*                /****************************************************/ 01649000
*                /*                                                  */ 01650000
*                /* SET DARGSENT FOR A HEX LISTING                   */ 01651000
*                /*                                                  */ 01652000
*                /****************************************************/ 01653000
*                                                                  0459 01654000
*                IF (ADDR(FHEX)) ^= NULLPTR                /*@Y30SSJH*/ 01655000
*                  THEN                                            0459 01656000
         L     @03,@PC00001+4                                      0459 01657000
         L     @03,FDTPTR+44(,@03)                                 0459 01658000
         LTR   @03,@03                                             0459 01659000
         BZ    @RF00459                                            0459 01660000
*                    DARGSENT = 6;                         /*@Y30SSJH*/ 01661000
*                                                                  0460 01662000
         MVI   DARGSENT(@10),X'06'                                 0460 01663000
*                  /**************************************************/ 01664000
*                  /*                                                */ 01665000
*                  /* SET DARGSENT INDICATING A CHARACTER LISTING    */ 01666000
*                  /*                                                */ 01667000
*                  /**************************************************/ 01668000
*                                                                  0461 01669000
*                  ELSE                                            0461 01670000
*                    IF (ADDR(FCHAR)) ^= NULLPTR           /*@Y30SSJH*/ 01671000
*                      THEN                                        0461 01672000
         B     @RC00459                                            0461 01673000
@RF00459 L     @10,@PC00001+4                                      0461 01674000
         L     @10,FDTPTR+48(,@10)                                 0461 01675000
         LTR   @10,@10                                             0461 01676000
         BZ    @RF00461                                            0461 01677000
*                        DARGSENT = 2;                             0462 01678000
*                                                                  0462 01679000
         L     @10,DDSTRU                                          0462 01680000
         MVI   DARGSENT(@10),X'02'                                 0462 01681000
*                      /**********************************************/ 01682000
*                      /*                                            */ 01683000
*                      /* THE SETTING OF DARGSENT DEFAULTS TO DUMP   */ 01684000
*                      /*  LISTING                                   */ 01685000
*                      /*                                            */ 01686000
*                      /**********************************************/ 01687000
*                                                                  0463 01688000
*                      ELSE                                        0463 01689000
*                        DARGSENT = 10;                    /*@Y30SSJH*/ 01690000
*                                                                  0463 01691000
         B     @RC00461                                            0463 01692000
@RF00461 L     @10,DDSTRU                                          0463 01693000
         MVI   DARGSENT(@10),X'0A'                                 0463 01694000
*                /****************************************************/ 01695000
*                /*                                                  */ 01696000
*                /* INITIALIZE THE FORMAT INSERT STRUCTURE FOR THE   */ 01697000
*                /* DATA HEADER WHICH INDICATES THE KEY,     @Y30SSJH*/ 01698000
*                /* RELATIVE RECORD NUMBER OR THE RECORD     @Y30SSJH*/ 01699000
*                /* SEQUENCE NUMBER OF THE RECORD            @Y30SSJH*/ 01700000
*                /*                                                  */ 01701000
*                /****************************************************/ 01702000
*                                                                  0464 01703000
*                DARGINS(1) = 1;                                   0464 01704000
*                                                                  0464 01705000
@RC00461 DS    0H                                                  0464 01706000
@RC00459 L     @10,DDSTRU                                          0464 01707000
         MVC   DARGINS(2,@10),@CH00216                             0464 01708000
*                /****************************************************/ 01709000
*                /*                                          @Y30SSJH*/ 01710000
*                /* VSAM RELATIVE RECORD DATA SET            @Y30SSJH*/ 01711000
*                /*  . BUMP DARGSENT TO INDICATE APPROPRIATE @Y30SSJH*/ 01712000
*                /*    STID                                  @Y30SSJH*/ 01713000
*                /*  . SET LENGTH OF RELATIVE RECORD NUMBER  @Y30SSJH*/ 01714000
*                /*    AND ITS ADDRESS FOR THE INSERT        @Y30SSJH*/ 01715000
*                /*    STRUCTURE.                            @Y30SSJH*/ 01716000
*                /*   (IT SHOULD BE NOTED THAT THERE IS A    @Y30SSJH*/ 01717000
*                /*   DEPENDENCY HERE ON THE ORDER OF THE    @Y30SSJH*/ 01718000
*                /*   MESSAGES IN THE STATIC TEXT MODULE.)   @Y30SSJH*/ 01719000
*                /*                                          @Y30SSJH*/ 01720000
*                /****************************************************/ 01721000
*                                                                  0465 01722000
*                IF IOCMACRR = ON                                  0465 01723000
*                  THEN                                            0465 01724000
         L     @03,IOCSPTR                                         0465 01725000
         TM    IOCMACRR(@03),B'00100000'                           0465 01726000
         BNO   @RF00465                                            0465 01727000
*                    DO;                                   /*@Y30SSJH*/ 01728000
*                                                                  0466 01729000
*                    DARGSENT = DARGSENT + 3;              /*@Y30SSJH*/ 01730000
         LA    @15,3                                               0467 01731000
         SLR   @14,@14                                             0467 01732000
         IC    @14,DARGSENT(,@10)                                  0467 01733000
         ALR   @15,@14                                             0467 01734000
         STC   @15,DARGSENT(,@10)                                  0467 01735000
*                    DARGINL(1) = LENGTH(IOCREL);          /*@Y30SSJH*/ 01736000
         MVC   DARGINL(2,@10),@CH00039                             0468 01737000
*                    DARGDTM(1) = ADDR(IOCREL);            /*@Y30SSJH*/ 01738000
*                                                                  0469 01739000
         LA    @03,IOCREL(,@03)                                    0469 01740000
         ST    @03,DARGDTM(,@10)                                   0469 01741000
*                    END;                                  /*@Y30SSJH*/ 01742000
*                                                                  0470 01743000
*                  ELSE                                            0471 01744000
*                    /************************************************/ 01745000
*                    /*                                      @Y30SSJH*/ 01746000
*                    /* SET INPUT LENGTH TO KEY LENGTH FOR KEY DATA  */ 01747000
*                    /* SETS                                 @Y30SSJH*/ 01748000
*                    /*                                      @Y30SSJH*/ 01749000
*                    /************************************************/ 01750000
*                                                                  0471 01751000
*                    IF ( IOCDSOAM = ON  &                         0471 01752000
*                         IOCMACCR = OFF |                         0471 01753000
*                         IOCDSOIS = ON   )                        0471 01754000
*                      THEN                                        0471 01755000
         B     @RC00465                                            0471 01756000
@RF00465 L     @10,IOCSPTR                                         0471 01757000
         TM    IOCDSOAM(@10),B'10000000'                           0471 01758000
         BNO   @GL00017                                            0471 01759000
         TM    IOCMACCR(@10),B'00010000'                           0471 01760000
         BZ    @RT00471                                            0471 01761000
@GL00017 L     @10,IOCSPTR                                         0471 01762000
         TM    IOCDSOIS(@10),B'00100000'                           0471 01763000
         BNO   @RF00471                                            0471 01764000
@RT00471 DS    0H                                                  0472 01765000
*                        DARGINL(1) = IOCKYL;              /*@Y30SSJH*/ 01766000
*                                                                  0472 01767000
         L     @10,IOCSPTR                                         0472 01768000
         SLR   @03,@03                                             0472 01769000
         IC    @03,IOCKYL(,@10)                                    0472 01770000
         L     @10,DDSTRU                                          0472 01771000
         STH   @03,DARGINL(,@10)                                   0472 01772000
*                      ELSE                                        0473 01773000
*                        DO;                               /*@Y30SSJH*/ 01774000
*                                                                  0473 01775000
         B     @RC00471                                            0473 01776000
@RF00471 DS    0H                                                  0474 01777000
*                        /********************************************/ 01778000
*                        /*                                  @Y30SSJH*/ 01779000
*                        /* SEQUENTIAL NON VSAM DATA SET     @Y30SSJH*/ 01780000
*                        /*  . BUMP DARGSENT TO INDICATE APPROPRIATE */ 01781000
*                        /*     STID                         @Y30SSJH*/ 01782000
*                        /*  . SET LENGTH OF RECORD SEQUENCE @Y30SSJH*/ 01783000
*                        /*    COUNT AND ITS ADDRESS FOR THE @Y30SSJH*/ 01784000
*                        /*    INSERT STRUCTURE              @Y30SSJH*/ 01785000
*                        /*                                  @Y30SSJH*/ 01786000
*                        /********************************************/ 01787000
*                                                                  0474 01788000
*                        IF IOCDSOPS = ON                          0474 01789000
*                          THEN                                    0474 01790000
         L     @10,IOCSPTR                                         0474 01791000
         TM    IOCDSOPS(@10),B'01000000'                           0474 01792000
         BNO   @RF00474                                            0474 01793000
*                            DO;                           /*@Y30SSJH*/ 01794000
*                                                                  0475 01795000
*                            DARGSENT = DARGSENT + 1;      /*@Y30SSJH*/ 01796000
         L     @03,DDSTRU                                          0476 01797000
         LA    @15,1                                               0476 01798000
         SLR   @14,@14                                             0476 01799000
         IC    @14,DARGSENT(,@03)                                  0476 01800000
         ALR   @15,@14                                             0476 01801000
         STC   @15,DARGSENT(,@03)                                  0476 01802000
*                            DARGINL(1) = LENGTH(IOCRRN);  /*@Y30SSJH*/ 01803000
         MVC   DARGINL(2,@03),@CH00039                             0477 01804000
*                            DARGDTM(1) = ADDR(IOCRRN);    /*@Y30SSJH*/ 01805000
*                                                                  0478 01806000
         LA    @10,IOCRRN(,@10)                                    0478 01807000
         ST    @10,DARGDTM(,@03)                                   0478 01808000
*                            END;                          /*@Y30SSJH*/ 01809000
*                          /******************************************/ 01810000
*                          /*                                @Y30SSJH*/ 01811000
*                          /* SEQUENTIAL VSAM DATA SET (ESDS) Y30SSJH*/ 01812000
*                          /*  . BUMP DARGSENT TO INDICATE THE STID  */ 01813000
*                          /*  . SET LENGTH OF RBA AND ITS ADDRESS   */ 01814000
*                          /*    FOR THE INSERT STRUCTURE    @Y30SSJH*/ 01815000
*                          /*                                @Y30SSJH*/ 01816000
*                          /******************************************/ 01817000
*                                                                  0480 01818000
*                          ELSE                                    0480 01819000
*                            DO;                           /*@Y30SSJH*/ 01820000
*                                                                  0480 01821000
         B     @RC00474                                            0480 01822000
@RF00474 DS    0H                                                  0481 01823000
*                            DARGSENT = DARGSENT + 2;      /*@Y30SSJH*/ 01824000
         L     @10,DDSTRU                                          0481 01825000
         LA    @03,2                                               0481 01826000
         SLR   @15,@15                                             0481 01827000
         IC    @15,DARGSENT(,@10)                                  0481 01828000
         ALR   @03,@15                                             0481 01829000
         STC   @03,DARGSENT(,@10)                                  0481 01830000
*                            DARGINL(1) = 4;               /*@Y30SSJH*/ 01831000
         MVC   DARGINL(2,@10),@CH00039                             0482 01832000
*                            DARGDTM(1) = ADDR(IOCRBA);    /*@Y30SSJH*/ 01833000
*                                                                  0483 01834000
         L     @03,IOCSPTR                                         0483 01835000
         LA    @03,IOCRBA(,@03)                                    0483 01836000
         ST    @03,DARGDTM(,@10)                                   0483 01837000
*                            END;                          /*@Y30SSJH*/ 01838000
*                                                                  0484 01839000
*                          END;                            /*@Y30SSJH*/ 01840000
*                                                                  0485 01841000
@RC00474 DS    0H                                                  0486 01842000
*                  END;                                            0486 01843000
*                                                                  0486 01844000
@RC00471 DS    0H                                                  0486 01845000
@RC00465 DS    0H                                                  0487 01846000
*              END;                                                0487 01847000
@RF00454 DS    0H                                                  0488 01848000
*        /************************************************************/ 01849000
*        /*                                                          */ 01850000
*        /* RETURN TO INVOKING PROCEDURE - IDCPR01                   */ 01851000
*        /*                                                          */ 01852000
*        /************************************************************/ 01853000
*        IF TESTRC > 4                                             0488 01854000
*          THEN                                                    0488 01855000
@RF00441 C     TESTRC,@CF00039                                     0488 01856000
         BNH   @RF00488                                            0488 01857000
*            STATFLG = ABNTERM;                                    0489 01858000
*                                                                  0489 01859000
         MVC   STATFLG(5),@CB00679                                 0489 01860000
*        RETURN;                                                   0490 01861000
@EL00002 DS    0H                                                  0490 01862000
@EF00002 DS    0H                                                  0490 01863000
@ER00002 LM    @14,@12,@SA00002                                    0490 01864000
         BR    @14                                                 0490 01865000
*END TEXTPSET;                                                     0491 01866000
         B     @EL00002                                            0491 01867000
*                                                                  0492 01868000
*/********************************************************************/ 01869000
*/*                                                                  */ 01870000
*/* PROCEDURE NAME - DELIMSET                                        */ 01871000
*/*                                                                  */ 01872000
*/* FUNCTION - DELIMSET ESTABLISHES THE BOUNDARIES FOR PRINTING A    */ 01873000
*/*            SUBSET OF THE INPUT DATASET.                          */ 01874000
*/*            BEGINNING AND/OR ENDING DELIMITERS SERVE TO SUBSET    */ 01875000
*/*            THE DATA SET.  THESE DELIMITERS MAY BE IN THE FORM    */ 01876000
*/*            OF KEYS,RBA'S,RECORD NUMBERS OR A RECORD      @Y30SSJH*/ 01877000
*/*            COUNT                                         @Y30SSJH*/ 01878000
*/*                                                                  */ 01879000
*/*            BEGINNING DELIMITERS:                                 */ 01880000
*/*              FROMKEY - ISAM OR VSAM KEY AT WHICH LISTING BEGINS  */ 01881000
*/*                POSITIONING IS VIA THE IDCAMS UPOSIT MACRO.       */ 01882000
*/*              FROMADDRESS - RBA AT WHICH PRINTING IS TO BEGIN.    */ 01883000
*/*                POSITIONING IS VIA THE IDCAMS UPOSIT MACRO.       */ 01884000
*/*              FROMNUMBER - RELATIVE RECORD NUMBER AT      @Y30SSJH*/ 01885000
*/*                WHICH PRINTING IS TO BEGIN.               @Y30SSJH*/ 01886000
*/*                POSITIONING VIA THE IDCAMS UPOSIT MACRO.  @Y30SSJH*/ 01887000
*/*              SKIP - NUMBER OF LOGICAL RECORDS TO BE SKIPPED      */ 01888000
*/*                BEFORE PRINTING IS BEGUN. DELIMSET EXECUTES A     */ 01889000
*/*                LOOP OF UGET REQUESTS TO EFFECT POSITIONING       */ 01890000
*/*                OR ISSUES A UPOSIT IF THE DATA SET IS     @Y30SSJH*/ 01891000
*/*                RELATIVE RECORD.                          @Y30SSJH*/ 01892000
*/*                                                                  */ 01893000
*/*            ENDING DELIMITERS:                                    */ 01894000
*/*              TOKEY - KEY OF THE LAST RECORD TO BE PRINTED.       */ 01895000
*/*              TOADDRESS - THE RBA OF THE LAST VSAM RECORD TO BE   */ 01896000
*/*                PRINTED.                                          */ 01897000
*/*              TONUMBER - RELATIVE RECORD NUMBER OF THE    @Y30SSJH*/ 01898000
*/*                LAST RECORD TO BE PRINTED.                @Y30SSJH*/ 01899000
*/*              COUNT - NUMBER OF LOGICAL RECORDS TO BE PRINTED.    */ 01900000
*/*                LOOPCNT IS SET TO CONTROL THE UGET/UPRINT LOOP IN */ 01901000
*/*                IDCPR01.                                          */ 01902000
*/*                                                                  */ 01903000
*/* INPUT -                                                          */ 01904000
*/*      DELIMSET REFERENCES THE FDTTBL AND USES THE IOCS TO EFFECT  */ 01905000
*/*      'UPOSIT' POSITIONING.                                       */ 01906000
*/*                                                                  */ 01907000
*/* OUTPUT -                                                         */ 01908000
*/*      DELMFLG - INDICATES KEY,RBA OR RELATIVE RECORD      @Y30SSJH*/ 01909000
*/*                NUMBER DELIMITER                          @Y30SSJH*/ 01910000
*/*      DELMCNT - INDICATES NUMBER OF RECORDS TO BE PROCESSED       */ 01911000
*/*      DELMINCR - UGET/URINT LOOP INCREMENT WHEN AN EXPLICIT       */ 01912000
*/*                 NUMBER OF RECORDS ARE TO BE PRINTED              */ 01913000
*/*      STATFLG - INDICATES THE TERMINATION CONDITION OF DELIMSET   */ 01914000
*/*                                                                  */ 01915000
*/********************************************************************/ 01916000
*DELIMSET:                                                         0492 01917000
*        PROCEDURE (DELMFLG,DELMCNT,DELMINCR);                     0492 01918000
DELIMSET STM   @14,@12,@SA00003                                    0492 01919000
         MVC   @PC00003(12),0(@01)                                 0492 01920000
*                                                                  0493 01921000
*        /************************************************************/ 01922000
*        /*                                                          */ 01923000
*        /* ARGUMENTS OF INVOCATION                                  */ 01924000
*        /*                                                          */ 01925000
*        /************************************************************/ 01926000
*                                                                  0493 01927000
*        DCL                                                       0493 01928000
*          DELMFLG CHAR(1),                                        0493 01929000
*          DELMCNT FIXED(31),                                      0493 01930000
*          DELMINCR FIXED(15);                                     0493 01931000
*                                                                  0493 01932000
*        /************************************************************/ 01933000
*        /*                                                          */ 01934000
*        /* LOOP CONTROL VARIABLES TO SKIP TO BEGINNING SUBSET       */ 01935000
*        /* DELIMITER                                                */ 01936000
*        /*                                                          */ 01937000
*        /************************************************************/ 01938000
*                                                                  0494 01939000
*        DCL                                                       0494 01940000
*          SKIPFLAG  CHAR(1),                                      0494 01941000
*          SKIPLOOP  FIXED(31);                                    0494 01942000
*                                                                  0494 01943000
*        /************************************************************/ 01944000
*        /*                                                  @Y30SSJH*/ 01945000
*        /* VARIABLES FOR VALIDITY ERROR MESSAGE             @Y30SSJH*/ 01946000
*        /*                                                  @Y30SSJH*/ 01947000
*        /************************************************************/ 01948000
*        DCL                                                       0495 01949000
*          MSGARY(6)  CHAR(11)                                     0495 01950000
*            INIT('FROMKEY' , 'TOKEY', 'FROMADDRESS' ,             0495 01951000
*                 'TOADDRESS' , 'FROMNUMBER' , 'TONUMBER' ),       0495 01952000
*          MSGINDX    FIXED(31) ,                                  0495 01953000
*          MSGENTRY   PTR(8)      INIT( 17 );              /*@Y30SSLO*/ 01954000
*                                                                  0495 01955000
*        /************************************************************/ 01956000
*        /*                                                          */ 01957000
*        /* ENTRY POINT TO DELIMSET- INTERNAL PROCEDURE              */ 01958000
*        /*                                                          */ 01959000
*        /************************************************************/ 01960000
*        OLDERID2 = NEWERID2;                                      0496 01961000
         L     @10,@PC00001                                        0496 01962000
         L     @10,GDTTR2(,@10)                                    0496 01963000
         MVC   @TS00001(95),NEWERID2(@10)                          0496 01964000
         MVC   OLDERID2(95,@10),@TS00001                           0496 01965000
*        NEWID2 = 'PR31';                                          0497 01966000
         MVC   NEWID2(4,@10),@CC00787                              0497 01967000
*        DELMFLG = '00'X;                                          0498 01968000
         L     @10,@PC00003                                        0498 01969000
         MVI   DELMFLG(@10),X'00'                                  0498 01970000
*        SKIPFLAG = GO;                                            0499 01971000
         MVI   SKIPFLAG,X'00'                                      0499 01972000
*        TESTRC = 0;                                               0500 01973000
         SLR   TESTRC,TESTRC                                       0500 01974000
*        DELMINCR = 0;                                             0501 01975000
         SLR   @10,@10                                             0501 01976000
         L     @15,@PC00003+8                                      0501 01977000
         STH   @10,DELMINCR(,@15)                                  0501 01978000
*        DELMCNT = 2;                                              0502 01979000
         L     @15,@PC00003+4                                      0502 01980000
         MVC   DELMCNT(4,@15),@CF00150                             0502 01981000
*        MSGINDX = 0;                                      /*@Y30SSJH*/ 01982000
*                                                                  0503 01983000
         SLR   MSGINDX,MSGINDX                                     0503 01984000
*        /************************************************************/ 01985000
*        /*                                                  @Y30SSJH*/ 01986000
*        /* DATA TYPE VALIDITY CHECKING:                     @Y30SSJH*/ 01987000
*        /*   FMKEY/TOKEY INVALID WITH RRDS,                 @Y30SSJH*/ 01988000
*        /*   FMRBA/TORBA INVALID WITH RRDS,                 @Y30SSJH*/ 01989000
*        /*   FMNUM INVALID WITH KSDS,                       @Y30SSJH*/ 01990000
*        /*   TONUM VALID ONLY WITH RRDS.                    @Y30SSJH*/ 01991000
*        /*                                                  @Y30SSJH*/ 01992000
*        /************************************************************/ 01993000
*                                                                  0504 01994000
*        IF (ADDR(FMKYC) ^= NULLPTR &                              0504 01995000
*            IOCMACRR = ON )                                       0504 01996000
*          THEN                                                    0504 01997000
         L     @15,@PC00001+4                                      0504 01998000
         C     @10,FDTPTR+8(,@15)                                  0504 01999000
         BE    @RF00504                                            0504 02000000
         L     @10,IOCSPTR                                         0504 02001000
         TM    IOCMACRR(@10),B'00100000'                           0504 02002000
         BNO   @RF00504                                            0504 02003000
*            MSGINDX = 1;                                  /*@Y30SSJH*/ 02004000
         LA    MSGINDX,1                                           0505 02005000
*          ELSE                                                    0506 02006000
*            IF (ADDR(TOKYC) ^= NULLPTR &                          0506 02007000
*               IOCMACRR = ON)                                     0506 02008000
*              THEN                                                0506 02009000
         B     @RC00504                                            0506 02010000
@RF00504 L     @10,@PC00001+4                                      0506 02011000
         L     @10,FDTPTR+20(,@10)                                 0506 02012000
         LTR   @10,@10                                             0506 02013000
         BZ    @RF00506                                            0506 02014000
         L     @10,IOCSPTR                                         0506 02015000
         TM    IOCMACRR(@10),B'00100000'                           0506 02016000
         BNO   @RF00506                                            0506 02017000
*                MSGINDX = 2;                              /*@Y30SSJH*/ 02018000
         LA    MSGINDX,2                                           0507 02019000
*              ELSE                                                0508 02020000
*                IF (ADDR(FMRBA) ^= NULLPTR &                      0508 02021000
*                   IOCMACRR = ON)                                 0508 02022000
*                  THEN                                            0508 02023000
         B     @RC00506                                            0508 02024000
@RF00506 L     @10,@PC00001+4                                      0508 02025000
         L     @10,FDTPTR+12(,@10)                                 0508 02026000
         LTR   @10,@10                                             0508 02027000
         BZ    @RF00508                                            0508 02028000
         L     @10,IOCSPTR                                         0508 02029000
         TM    IOCMACRR(@10),B'00100000'                           0508 02030000
         BNO   @RF00508                                            0508 02031000
*                    MSGINDX = 3;                          /*@Y30SSJH*/ 02032000
         LA    MSGINDX,3                                           0509 02033000
*                  ELSE                                            0510 02034000
*                    IF (ADDR(TORBA) ^= NULLPTR &                  0510 02035000
*                        IOCMACRR = ON)                            0510 02036000
*                      THEN                                        0510 02037000
         B     @RC00508                                            0510 02038000
@RF00508 L     @10,@PC00001+4                                      0510 02039000
         L     @10,FDTPTR+24(,@10)                                 0510 02040000
         LTR   @10,@10                                             0510 02041000
         BZ    @RF00510                                            0510 02042000
         L     @10,IOCSPTR                                         0510 02043000
         TM    IOCMACRR(@10),B'00100000'                           0510 02044000
         BNO   @RF00510                                            0510 02045000
*                        MSGINDX = 4;                      /*@Y30SSJH*/ 02046000
         LA    MSGINDX,4                                           0511 02047000
*                      ELSE                                        0512 02048000
*                        IF (ADDR(FMNUM) ^= NULLPTR &              0512 02049000
*                            IOCMACRR = OFF)                       0512 02050000
*                          THEN                                    0512 02051000
         B     @RC00510                                            0512 02052000
@RF00510 L     @10,@PC00001+4                                      0512 02053000
         L     @10,FDTPTR+116(,@10)                                0512 02054000
         LTR   @10,@10                                             0512 02055000
         BZ    @RF00512                                            0512 02056000
         L     @10,IOCSPTR                                         0512 02057000
         TM    IOCMACRR(@10),B'00100000'                           0512 02058000
         BNZ   @RF00512                                            0512 02059000
*                            MSGINDX = 5;                  /*@Y30SSJH*/ 02060000
         LA    MSGINDX,5                                           0513 02061000
*                          ELSE                                    0514 02062000
*                            IF (ADDR(TONUM) ^= NULLPTR &          0514 02063000
*                                IOCMACRR = OFF )                  0514 02064000
*                              THEN                                0514 02065000
         B     @RC00512                                            0514 02066000
@RF00512 L     @10,@PC00001+4                                      0514 02067000
         L     @10,FDTPTR+120(,@10)                                0514 02068000
         LTR   @10,@10                                             0514 02069000
         BZ    @RF00514                                            0514 02070000
         L     @10,IOCSPTR                                         0514 02071000
         TM    IOCMACRR(@10),B'00100000'                           0514 02072000
         BNZ   @RF00514                                            0514 02073000
*                                MSGINDX = 6;              /*@Y30SSJH*/ 02074000
         LA    MSGINDX,6                                           0515 02075000
*                              ELSE;                       /*@Y30SSJH*/ 02076000
*                                                                  0516 02077000
@RF00514 DS    0H                                                  0517 02078000
*        /************************************************************/ 02079000
*        /*                                                  @Y30SSJH*/ 02080000
*        /* WRITE MESSAGE INDICATING INVALID USE             @Y30SSJH*/ 02081000
*        /* OF DELIMITERS                                    @Y30SSJH*/ 02082000
*        /*                                                  @Y30SSJH*/ 02083000
*        /************************************************************/ 02084000
*        IF MSGINDX ^= 0                                           0517 02085000
*          THEN                                                    0517 02086000
@RC00512 DS    0H                                                  0517 02087000
@RC00510 DS    0H                                                  0517 02088000
@RC00508 DS    0H                                                  0517 02089000
@RC00506 DS    0H                                                  0517 02090000
@RC00504 LTR   MSGINDX,MSGINDX                                     0517 02091000
         BZ    @RF00517                                            0517 02092000
*            DO;                                           /*@Y30SSJH*/ 02093000
*                                                                  0518 02094000
*              STATFLG = ABNTERM;                          /*@Y30SSJH*/ 02095000
         MVC   STATFLG(5),@CB00679                                 0519 02096000
*              DARGL = ''B;                                /*@Y30SSLO*/ 02097000
         XC    DARGL(28),DARGL                                     0520 02098000
*              DARGSENT = MSGENTRY;                        /*@Y30SSJH*/ 02099000
         L     @10,DDSTRU                                          0521 02100000
         IC    @15,MSGENTRY                                        0521 02101000
         STC   @15,DARGSENT(,@10)                                  0521 02102000
*              DARGSMOD ='PR0';                            /*@Y30SSJH*/ 02103000
         MVC   DARGSMOD(3,@10),@CC00761                            0522 02104000
*              DARGCNT = 1;                                /*@Y30SSJH*/ 02105000
         LA    @15,1                                               0523 02106000
         STH   @15,DARGCNT(,@10)                                   0523 02107000
*              DARGINS(1) = 1;                             /*@Y30SSLO*/ 02108000
         STH   @15,DARGINS(,@10)                                   0524 02109000
*              DARGINL(1) = LENGTH(MSGARY(1));             /*@Y30SSJH*/ 02110000
         LA    @15,11                                              0525 02111000
         STH   @15,DARGINL(,@10)                                   0525 02112000
*              DARGDTM(1) = ADDR(MSGARY(MSGINDX));         /*@Y30SSJH*/ 02113000
*                                                                  0526 02114000
         MR    @14,MSGINDX                                         0526 02115000
         LA    @15,MSGARY-11(@15)                                  0526 02116000
         ST    @15,DARGDTM(,@10)                                   0526 02117000
*              CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);      /*@Y30SSJH*/ 02118000
*                                                                  0527 02119000
         L     @10,@PC00001                                        0527 02120000
         ST    @10,@AL00001                                        0527 02121000
         LA    @15,@CF00112                                        0527 02122000
         ST    @15,@AL00001+4                                      0527 02123000
         LA    @15,DDSTRU                                          0527 02124000
         ST    @15,@AL00001+8                                      0527 02125000
         MVI   @AL00001+8,X'80'                                    0527 02126000
         L     @15,GDTPRT(,@10)                                    0527 02127000
         LA    @01,@AL00001                                        0527 02128000
         BALR  @14,@15                                             0527 02129000
*            END;                                          /*@Y30SSJH*/ 02130000
*                                                                  0528 02131000
*        /************************************************************/ 02132000
*        /*                                                          */ 02133000
*        /* POSITION TO THE BEGINNING OF THE SUBSET OF THE DATASET   */ 02134000
*        /*                                                          */ 02135000
*        /************************************************************/ 02136000
*                                                                  0529 02137000
*        IF ((ADDR(FMKYC)) ^= NULLPTR |                            0529 02138000
*            (ADDR(FMRBA)) ^= NULLPTR |                    /*@Y30SSJH*/ 02139000
*            (ADDR(FMNUM)) ^= NULLPTR )  &                 /*@Y30SSJH*/ 02140000
*            MSGINDX = 0                                   /*@Y30SSJH*/ 02141000
*                                                                  0529 02142000
*          /**********************************************************/ 02143000
*          /*                                                        */ 02144000
*          /* INITIALIZE THE I/O ADAPTER UPOSIT INTERFACE TO POSITION*/ 02145000
*          /* BY KEY OR RBA                                          */ 02146000
*          /*                                                        */ 02147000
*          /**********************************************************/ 02148000
*          THEN                                                    0529 02149000
@RF00517 SLR   @10,@10                                             0529 02150000
         L     @15,@PC00001+4                                      0529 02151000
         C     @10,FDTPTR+8(,@15)                                  0529 02152000
         BNE   @GL00025                                            0529 02153000
         C     @10,FDTPTR+12(,@15)                                 0529 02154000
         BNE   @GL00025                                            0529 02155000
         C     @10,FDTPTR+116(,@15)                                0529 02156000
         BE    @RF00529                                            0529 02157000
@GL00025 SLR   @10,@10                                             0529 02158000
         CR    MSGINDX,@10                                         0529 02159000
         BNE   @RF00529                                            0529 02160000
*            DO;                                                   0530 02161000
*                                                                  0530 02162000
*            IF (ADDR(FMKYC)) ^= NULLPTR                   /*@Y30SSJH*/ 02163000
*              THEN                                                0531 02164000
         L     @02,@PC00001+4                                      0531 02165000
         L     @02,FDTPTR+8(,@02)                                  0531 02166000
         CR    @02,@10                                             0531 02167000
         BE    @RF00531                                            0531 02168000
*                DO;                                               0532 02169000
*                                                                  0532 02170000
*                IOCKYA = ADDR(FMKYCVAL);                          0533 02171000
         L     @10,IOCSPTR                                         0533 02172000
         LA    @15,FMKYCVAL(,@02)                                  0533 02173000
         ST    @15,IOCKYA(,@10)                                    0533 02174000
*                IOCPTL = FMKYCLEN;                                0534 02175000
*                                                                  0534 02176000
         SLR   @15,@15                                             0534 02177000
         IC    @15,FMKYCLEN(,@02)                                  0534 02178000
         STH   @15,IOCPTL(,@10)                                    0534 02179000
*                END;                                              0535 02180000
*                                                                  0535 02181000
*              ELSE                                                0536 02182000
*                IF (ADDR(FMNUM)) ^= NULLPTR               /*@Y30SSJH*/ 02183000
*                  THEN                                            0536 02184000
         B     @RC00531                                            0536 02185000
@RF00531 L     @10,@PC00001+4                                      0536 02186000
         L     @10,FDTPTR+116(,@10)                                0536 02187000
         LTR   @10,@10                                             0536 02188000
         BZ    @RF00536                                            0536 02189000
*                    IOCREL = FMNUMVAL;                    /*@Y30SSJH*/ 02190000
*                                                                  0537 02191000
         L     @10,FMNUMVAL(,@10)                                  0537 02192000
         L     @02,IOCSPTR                                         0537 02193000
         ST    @10,IOCREL(,@02)                                    0537 02194000
*                  ELSE                                            0538 02195000
*                    IOCRBA = FMRBAVAL;                    /*@Y30SSJH*/ 02196000
*                                                                  0538 02197000
         B     @RC00536                                            0538 02198000
@RF00536 L     @10,@PC00001+4                                      0538 02199000
         L     @10,FDTPTR+12(,@10)                                 0538 02200000
         L     @10,FMRBAVAL(,@10)                                  0538 02201000
         L     @02,IOCSPTR                                         0538 02202000
         ST    @10,IOCRBA(,@02)                                    0538 02203000
*            /********************************************************/ 02204000
*            /*                                              @Y30SSJH*/ 02205000
*            /* ISSUE UPOSIT MACRO TO POSITION TO BEGINNING OF THE   */ 02206000
*            /* SUBSET                                       @Y30SSJH*/ 02207000
*            /*                                              @Y30SSJH*/ 02208000
*            /********************************************************/ 02209000
*                                                                  0539 02210000
*            CALL IDCIOPO0(GDTTBL,IOCSPTR);                /*@Y30SSJH*/ 02211000
@RC00536 DS    0H                                                  0539 02212000
@RC00531 L     @10,@PC00001                                        0539 02213000
         ST    @10,@AL00001                                        0539 02214000
         LA    @15,IOCSPTR                                         0539 02215000
         ST    @15,@AL00001+4                                      0539 02216000
         MVI   @AL00001+4,X'80'                                    0539 02217000
         L     @15,GDTPOS(,@10)                                    0539 02218000
         LA    @01,@AL00001                                        0539 02219000
         BALR  @14,@15                                             0539 02220000
*            RESPECIFY RTNREG RSTD;                                0540 02221000
*            TESTRC = RTNREG;                                      0541 02222000
         LR    TESTRC,RTNREG                                       0541 02223000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSJH*/ 02224000
*                                                                  0542 02225000
*            END;                                          /*@Y30SSJH*/ 02226000
*                                                                  0544 02227000
*          /**********************************************************/ 02228000
*          /*                                                        */ 02229000
*          /* POSITION BY SKIPPING TO BEGINNING OF SUBSET    @Y30SSJH*/ 02230000
*          /*                                                        */ 02231000
*          /**********************************************************/ 02232000
*          ELSE                                                    0544 02233000
*            IF MSGINDX = 0                                        0544 02234000
*              THEN                                                0544 02235000
         B     @RC00529                                            0544 02236000
@RF00529 SLR   @10,@10                                             0544 02237000
         CR    MSGINDX,@10                                         0544 02238000
         BNE   @RF00544                                            0544 02239000
*                DO;                                       /*@Y30SSJH*/ 02240000
*                IF (ADDR(SKIP)) ^= NULLPTR                        0546 02241000
*                  THEN                                            0546 02242000
         L     @15,@PC00001+4                                      0546 02243000
         L     @15,FDTPTR+16(,@15)                                 0546 02244000
         CR    @15,@10                                             0546 02245000
         BE    @RF00546                                            0546 02246000
*                    IF IOCMACRR = ON                              0547 02247000
*                      THEN                                        0547 02248000
         L     @10,IOCSPTR                                         0547 02249000
         TM    IOCMACRR(@10),B'00100000'                           0547 02250000
         BNO   @RF00547                                            0547 02251000
*                        DO;                               /*@Y30SSJH*/ 02252000
*                                                                  0548 02253000
*                        IOCREL = SKIPVAL + 1;             /*@Y30SSJH*/ 02254000
*                                                                  0549 02255000
         LA    @14,1                                               0549 02256000
         AL    @14,SKIPVAL(,@15)                                   0549 02257000
         ST    @14,IOCREL(,@10)                                    0549 02258000
*                        CALL IDCIOPO0(GDTTBL,IOCSPTR);    /*@Y30SSJH*/ 02259000
         L     @10,@PC00001                                        0550 02260000
         ST    @10,@AL00001                                        0550 02261000
         LA    @15,IOCSPTR                                         0550 02262000
         ST    @15,@AL00001+4                                      0550 02263000
         MVI   @AL00001+4,X'80'                                    0550 02264000
         L     @15,GDTPOS(,@10)                                    0550 02265000
         LA    @01,@AL00001                                        0550 02266000
         BALR  @14,@15                                             0550 02267000
*                        RESPECIFY RTNREG RSTD;                    0551 02268000
*                        TESTRC = RTNREG;                          0552 02269000
         LR    TESTRC,RTNREG                                       0552 02270000
*                        RESPECIFY RTNREG UNRSTD;          /*@Y30SSJH*/ 02271000
*                                                                  0553 02272000
*                        END;                              /*@Y30SSJH*/ 02273000
*                      ELSE                                        0555 02274000
*                        DO SKIPLOOP = 1 TO SKIPVAL                0555 02275000
*                          WHILE SKIPFLAG = GO;            /*@Y30SSJH*/ 02276000
*                                                                  0555 02277000
         B     @RC00547                                            0555 02278000
@RF00547 LA    SKIPLOOP,1                                          0555 02279000
         B     @DE00555                                            0555 02280000
@DL00555 CLI   SKIPFLAG,X'00'                                      0555 02281000
         BNE   @DC00555                                            0555 02282000
*                        CALL IDCIOGT0(GDTTBL,IOCSPTR);    /*@Y30SSJH*/ 02283000
         L     @10,@PC00001                                        0556 02284000
         ST    @10,@AL00001                                        0556 02285000
         LA    @05,IOCSPTR                                         0556 02286000
         ST    @05,@AL00001+4                                      0556 02287000
         MVI   @AL00001+4,X'80'                                    0556 02288000
         L     @15,GDTGET(,@10)                                    0556 02289000
         LA    @01,@AL00001                                        0556 02290000
         BALR  @14,@15                                             0556 02291000
*                        RESPECIFY RTNREG RSTD;                    0557 02292000
*                        TESTRC = RTNREG;                          0558 02293000
         LR    TESTRC,RTNREG                                       0558 02294000
*                        RESPECIFY RTNREG UNRSTD;          /*@Y30SSJH*/ 02295000
*                        IF TESTRC ^= 0                            0560 02296000
*                          THEN                                    0560 02297000
         LTR   TESTRC,TESTRC                                       0560 02298000
         BZ    @RF00560                                            0560 02299000
*                            SKIPFLAG = STOP;              /*@Y30SSJH*/ 02300000
*                                                                  0561 02301000
         MVI   SKIPFLAG,X'0F'                                      0561 02302000
*                        END;                              /*@Y30SSJH*/ 02303000
@RF00560 AL    SKIPLOOP,@CF00216                                   0562 02304000
@DE00555 L     @10,@PC00001+4                                      0562 02305000
         L     @10,FDTPTR+16(,@10)                                 0562 02306000
         C     SKIPLOOP,SKIPVAL(,@10)                              0562 02307000
         BNH   @DL00555                                            0562 02308000
@DC00555 DS    0H                                                  0563 02309000
*                END;                                      /*@Y30SSJH*/ 02310000
@RC00547 DS    0H                                                  0563 02311000
@RF00546 DS    0H                                                  0564 02312000
*        /************************************************************/ 02313000
*        /*                                                          */ 02314000
*        /* INSURE BEGINNING DELIMITER HAS BEEN SUCCESSFULLY SET     */ 02315000
*        /* BEFORE SETTING THE ENDING DELIMITER                      */ 02316000
*        /*                                                          */ 02317000
*        /************************************************************/ 02318000
*                                                                  0564 02319000
*        IF TESTRC = 0 &                                   /*@Y30SSJH*/ 02320000
*           MSGINDX = 0                                    /*@Y30SSJH*/ 02321000
*          THEN                                                    0564 02322000
@RF00544 DS    0H                                                  0564 02323000
@RC00529 SLR   @10,@10                                             0564 02324000
         CR    TESTRC,@10                                          0564 02325000
         BNE   @RF00564                                            0564 02326000
         CR    MSGINDX,@10                                         0564 02327000
         BNE   @RF00564                                            0564 02328000
*            DO;                                                   0565 02329000
*                                                                  0565 02330000
*            /********************************************************/ 02331000
*            /*                                                      */ 02332000
*            /* SET FLAG INDICATING ENDING KEY DELIMITER             */ 02333000
*            /*                                                      */ 02334000
*            /********************************************************/ 02335000
*                                                                  0566 02336000
*            IF (ADDR(TOKYC)) ^= NULLPTR                   /*@Y30SSJH*/ 02337000
*              THEN                                                0566 02338000
         L     @15,@PC00001+4                                      0566 02339000
         C     @10,FDTPTR+20(,@15)                                 0566 02340000
         BE    @RF00566                                            0566 02341000
*                DELMFLG = TOKYPOST;                               0567 02342000
*                                                                  0567 02343000
         L     @10,@PC00003                                        0567 02344000
         MVI   DELMFLG(@10),X'02'                                  0567 02345000
*              ELSE                                                0568 02346000
*                                                                  0568 02347000
*                /****************************************************/ 02348000
*                /*                                                  */ 02349000
*                /* SET FLAG INDICATING ENDING RBA DELIMITER         */ 02350000
*                /*                                                  */ 02351000
*                /****************************************************/ 02352000
*                                                                  0568 02353000
*                IF (ADDR(TORBA)) ^= NULLPTR               /*@Y30SSJH*/ 02354000
*                  THEN                                            0568 02355000
         B     @RC00566                                            0568 02356000
@RF00566 L     @10,@PC00001+4                                      0568 02357000
         L     @10,FDTPTR+24(,@10)                                 0568 02358000
         LTR   @10,@10                                             0568 02359000
         BZ    @RF00568                                            0568 02360000
*                    DELMFLG = TORBAPOS;                           0569 02361000
*                                                                  0569 02362000
         L     @10,@PC00003                                        0569 02363000
         MVI   DELMFLG(@10),X'03'                                  0569 02364000
*                  /**************************************************/ 02365000
*                  /*                                        @Y30SSJH*/ 02366000
*                  /* SET FLAG INDICATING ENDING RECORD      @Y30SSJH*/ 02367000
*                  /* NUMBER DELIMITER                       @Y30SSJH*/ 02368000
*                  /*                                        @Y30SSJH*/ 02369000
*                  /**************************************************/ 02370000
*                  ELSE                                            0570 02371000
*                    IF (ADDR(TONUM)) ^= NULLPTR                   0570 02372000
*                      THEN                                        0570 02373000
         B     @RC00568                                            0570 02374000
@RF00568 L     @10,@PC00001+4                                      0570 02375000
         L     @10,FDTPTR+120(,@10)                                0570 02376000
         LTR   @10,@10                                             0570 02377000
         BZ    @RF00570                                            0570 02378000
*                        DELMFLG = TORRNPOS;               /*@Y30SSJH*/ 02379000
         L     @10,@PC00003                                        0571 02380000
         MVI   DELMFLG(@10),X'04'                                  0571 02381000
*                      /**********************************************/ 02382000
*                      /*                                            */ 02383000
*                      /* SET LOOP CONTROL FOR PROCESSING            */ 02384000
*                      /* AN EXPLICIT NUMBER OF RECORDS              */ 02385000
*                      /*                                            */ 02386000
*                      /**********************************************/ 02387000
*                                                                  0572 02388000
*                      ELSE                                        0572 02389000
*                        IF (ADDR(COUNT)) ^= NULLPTR       /*@Y30SSJH*/ 02390000
*                          THEN                                    0572 02391000
         B     @RC00570                                            0572 02392000
@RF00570 L     @10,@PC00001+4                                      0572 02393000
         L     @10,FDTPTR+28(,@10)                                 0572 02394000
         LTR   @10,@10                                             0572 02395000
         BZ    @RF00572                                            0572 02396000
*                            DO;                                   0573 02397000
*                                                                  0573 02398000
*                            DELMCNT = COUNTVAL;                   0574 02399000
         L     @15,@PC00003+4                                      0574 02400000
         L     @10,COUNTVAL(,@10)                                  0574 02401000
         ST    @10,DELMCNT(,@15)                                   0574 02402000
*                            DELMINCR = 1;                         0575 02403000
*                                                                  0575 02404000
         L     @10,@PC00003+8                                      0575 02405000
         MVC   DELMINCR(2,@10),@CH00216                            0575 02406000
*                            END;                                  0576 02407000
*                                                                  0576 02408000
*                          ELSE;                                   0577 02409000
*                                                                  0577 02410000
@RF00572 DS    0H                                                  0578 02411000
*            END;                                                  0578 02412000
*                                                                  0579 02413000
*          /**********************************************************/ 02414000
*          /*                                                        */ 02415000
*          /* BEGINNING POSITIONING FAILED                           */ 02416000
*          /*                                                        */ 02417000
*          /**********************************************************/ 02418000
*                                                                  0579 02419000
*          ELSE                                                    0579 02420000
*            IF MSGINDX = 0                                /*@Y30SSJH*/ 02421000
*              THEN                                                0579 02422000
         B     @RC00564                                            0579 02423000
@RF00564 LTR   MSGINDX,MSGINDX                                     0579 02424000
         BNZ   @RF00579                                            0579 02425000
*                DO;                                               0580 02426000
*                                                                  0580 02427000
*                STATFLG = POSITERR;                               0581 02428000
*                                                                  0581 02429000
         MVC   STATFLG(5),@CB00682                                 0581 02430000
*                END;                                              0582 02431000
*                                                                  0582 02432000
*        /************************************************************/ 02433000
*        /*                                                          */ 02434000
*        /* RETURN TO INVOKER OF DELIMSET                            */ 02435000
*        /*                                                          */ 02436000
*        /************************************************************/ 02437000
*                                                                  0583 02438000
*        RETURN ;                                                  0583 02439000
@EL00003 DS    0H                                                  0583 02440000
@EF00003 DS    0H                                                  0583 02441000
@ER00003 LM    @14,@12,@SA00003                                    0583 02442000
         BR    @14                                                 0583 02443000
*END DELIMSET;                                                     0584 02444000
*                                                                  0584 02445000
         B     @EL00003                                            0584 02446000
*END IDCPR01                                                       0585 02447000
*                                                                  0585 02448000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 02449000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 02450000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 02451000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 02452000
*/*%INCLUDE SYSLIB  (IDCCSPR )                                        * 02453000
*;                                                                 0585 02454000
@DATA    DS    0H                                                       02455000
@CH00756 DC    H'121'                                                   02456000
@SC00814 CLC   TOKYCVAL(0,@10),RECDKEY(@05)                             02457000
@DATD    DSECT                                                          02458000
         DS    0F                                                       02459000
@SA00001 DS    18F                                                      02460000
@PC00001 DS    3F                                                       02461000
@SA00003 DS    15F                                                      02462000
@PC00003 DS    3F                                                       02463000
@SA00002 DS    15F                                                      02464000
@AL00001 DS    5A                                                       02465000
IDCPR01  CSECT                                                          02466000
         DS    0F                                                       02467000
@CF00112 DC    F'0'                                                     02468000
@CF00216 DC    F'1'                                                     02469000
@CH00216 EQU   @CF00216+2                                               02470000
@CF00150 DC    F'2'                                                     02471000
@CH00150 EQU   @CF00150+2                                               02472000
@CF00159 DC    F'3'                                                     02473000
@CF00039 DC    F'4'                                                     02474000
@CH00039 EQU   @CF00039+2                                               02475000
@CF00570 DC    F'12'                                                    02476000
@CF00474 DC    F'16'                                                    02477000
@DATD    DSECT                                                          02478000
         DS    0D                                                       02479000
LISTSCAN DS    A                                                        02480000
IOCSPTR  DS    A                                                        02481000
DDSTRU   DS    A                                                        02482000
FSADDR   DS    A                                                        02483000
ERCNVADR DS    A                                                        02484000
DMPINDEX DS    A                                                        02485000
OPRTFILE DS    A                                                        02486000
IOCSALT  DS    A                                                        02487000
RECDPRCS DS    F                                                        02488000
LOOPCNT  DS    F                                                        02489000
OLDREL   DS    F                                                        02490000
ENDKYLN  DS    F                                                        02491000
IOCSINP  DS    A                                                        02492000
LISTPTR  DS    A                                                        02493000
LOOPINCR DS    H                                                        02494000
INPUTLEN DS    H                                                        02495000
SETRC    DS    H                                                        02496000
LISTLN   DS    FL1                                                      02497000
@TS00001 DS    CL95                                                     02498000
         DS    CL2                                                      02499000
OPAGLST  DS    BL48                                                     02500000
DARGL    DS    CL28                                                     02501000
PCARGLST DS    CL34                                                     02502000
         ORG   PCARGLST                                                 02503000
PCMTLP   DS    AL4                                                      02504000
PCSTLP   DS    AL4                                                      02505000
PCFLP    DS    AL4                                                      02506000
PCPCP    DS    AL4                                                      02507000
PCPNL    DS    FL2                                                      02508000
PCPTL    DS    FL2                                                      02509000
PCPDL    DS    FL2                                                      02510000
PCMTLC   DS    FL2                                                      02511000
PCSTLC   DS    FL2                                                      02512000
PCFLC    DS    FL2                                                      02513000
PCLW     DS    FL2                                                      02514000
PCPD     DS    FL2                                                      02515000
PCDSC    DS    FL2                                                      02516000
         ORG   PCARGLST+34                                              02517000
         DS    CL2                                                      02518000
STATFLG  DS    CL5                                                      02519000
         ORG   STATFLG                                                  02520000
STMODID  DS    CL3                                                      02521000
STATFLG1 DS    AL1                                                      02522000
STATFLG2 DS    AL1                                                      02523000
         ORG   STATFLG+5                                                02524000
CYCLEFLG DS    CL1                                                      02525000
DELIMFLG DS    CL1                                                      02526000
         DS    CL1                                                      02527000
QUALLIST DS    CL12                                                     02528000
         ORG   QUALLIST                                                 02529000
QUALADDR DS    AL4                                                      02530000
QUALCAT  DS    AL4                                                      02531000
QUALPAS  DS    AL4                                                      02532000
         ORG   QUALLIST+12                                              02533000
INPUTVAL DS    CL44                                                     02534000
SUBTBUFF DS    CL121                                                    02535000
         ORG   SUBTBUFF                                                 02536000
SUBTLHDR DS    CL22                                                     02537000
SUBTLDSN DS    CL99                                                     02538000
         ORG   SUBTBUFF+121                                             02539000
SKIPFLAG DS    CL1                                                      02540000
         DS    CL2                                                      02541000
RCDADRTN DS    CL12                                                     02542000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02543000
@ENDDATD EQU   *                                                        02544000
IDCPR01  CSECT                                                          02545000
         DS    0F                                                       02546000
@SIZDATD DC    AL1(0)                                                   02547000
         DC    AL3(@ENDDATD-@DATD)                                      02548000
         DS    0D                                                       02549000
MSGENTRY DC    AL1(17)                                                  02550000
@CC00685 DC    C'PR01'                                                  02551000
@CC00731 DC    C'PR11'                                                  02552000
@CC00749 DC    C'PR18'                                                  02553000
@CC00760 DC    C'PR21'                                                  02554000
@CC00787 DC    C'PR31'                                                  02555000
@CC00750 DC    C'UV0'                                                   02556000
@CC00761 EQU   @CC00685                                                 02557000
@CB00670 DC    X'E4E5F00001'                                            02558000
@CB00673 DC    X'E4E5F00401'                                            02559000
@CB00676 DC    X'E4E5F00801'                                            02560000
@CB00679 DC    X'E4E5F00C03'                                            02561000
@CB00682 DC    X'E4E5F00C06'                                            02562000
ALL      DC    CL3'ALL'                                                 02563000
FORMAT   DC    CL4'FORM'                                                02564000
HSECOND  DC    CL4'HSEC'                                                02565000
CLOCK    DC    CL4'KLOK'                                                02566000
SETZERO  DC    CL4'ZERO'                                                02567000
SETBLANK DC    CL4'BLNK'                                                02568000
NOSET    DC    CL4'NSET'                                                02569000
OVERRIDE DC    CL4'OVRD'                                                02570000
ACQUIRE  DC    CL8'ACQUIRE '                                            02571000
RELINQ   DC    CL8'RELINQ  '                                            02572000
MOUNT    DC    CL8'MOUNT   '                                            02573000
DEMOUNT  DC    CL8'DEMOUNT '                                            02574000
DEFINE   DC    CL8'DEFINE  '                                            02575000
MOVE     DC    CL8'MOVE    '                                            02576000
TRACEQ   DC    CL8'TRACEQ  '                                            02577000
COPYTABL DC    CL8'COPYTABL'                                            02578000
COPYCRTG DC    CL8'COPYCRTG'                                            02579000
COPYVOL  DC    CL8'COPYVOL '                                            02580000
VVIC     DC    CL8'VVIC    '                                            02581000
TUNE     DC    CL8'TUNE    '                                            02582000
NAMES    DC    CL4'NAME'                                                02583000
UNIT     DC    CL4'UNIT'                                                02584000
SHR      DC    CL4'SHR '                                                02585000
EXCL     DC    CL4'EXCL'                                                02586000
NOWAIT   DC    CL4'NWAI'                                                02587000
WAIT     DC    CL4'WAIT'                                                02588000
MODID    DC    CL4'PR01'                                                02589000
FIXAREA  DS    CL256                                                    02590000
         ORG   FIXAREA                                                  02591000
@NM00037 DS    CL256                                                    02592000
         ORG   @NM00037                                                 02593000
@NM00038 DC    256X'00'                                                 02594000
         ORG   FIXAREA+256                                              02595000
MSGARY   DC    CL11'FROMKEY'                                            02596000
         DC    CL11'TOKEY'                                              02597000
         DC    CL11'FROMADDRESS'                                        02598000
         DC    CL11'TOADDRESS'                                          02599000
         DC    CL11'FROMNUMBER'                                         02600000
         DC    CL11'TONUMBER'                                           02601000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02602000
@01      EQU   01                                                       02603000
@02      EQU   02                                                       02604000
@03      EQU   03                                                       02605000
@04      EQU   04                                                       02606000
@05      EQU   05                                                       02607000
@06      EQU   06                                                       02608000
@07      EQU   07                                                       02609000
@08      EQU   08                                                       02610000
@09      EQU   09                                                       02611000
@10      EQU   10                                                       02612000
@11      EQU   11                                                       02613000
@12      EQU   12                                                       02614000
@13      EQU   13                                                       02615000
@14      EQU   14                                                       02616000
@15      EQU   15                                                       02617000
MSGINDX  EQU   @03                                                      02618000
SKIPLOOP EQU   @04                                                      02619000
N        EQU   @03                                                      02620000
RPIOERR  EQU   @04                                                      02621000
OPNPTR   EQU   @02                                                      02622000
TESTRC   EQU   @02                                                      02623000
RTNREG   EQU   @15                                                      02624000
REG0     EQU   @00                                                      02625000
REG1     EQU   @01                                                      02626000
REG10    EQU   @10                                                      02627000
REG11    EQU   @11                                                      02628000
REG12    EQU   @12                                                      02629000
REG13    EQU   @13                                                      02630000
REG14    EQU   @14                                                      02631000
REG15    EQU   @15                                                      02632000
REG2     EQU   @02                                                      02633000
REG3     EQU   @03                                                      02634000
REG4     EQU   @04                                                      02635000
REG5     EQU   @05                                                      02636000
REG6     EQU   @06                                                      02637000
REG7     EQU   @07                                                      02638000
REG8     EQU   @08                                                      02639000
REG9     EQU   @09                                                      02640000
IDCSAEP0 EQU   0                                                        02641000
IDCSAQL0 EQU   0                                                        02642000
TRACE1   EQU   0                                                        02643000
OLDERID1 EQU   TRACE1                                                   02644000
TRACE2   EQU   0                                                        02645000
OLDERID2 EQU   TRACE2                                                   02646000
NEWID2   EQU   TRACE2+95                                                02647000
NEWERID2 EQU   5                                                        02648000
CIRAGL   EQU   0                                                        02649000
CIRTYPE  EQU   CIRAGL                                                   02650000
ALLAGL   EQU   0                                                        02651000
ALLSTS   EQU   ALLAGL+24                                                02652000
ALLDSP   EQU   ALLAGL+25                                                02653000
ALLORG   EQU   ALLAGL+26                                                02654000
ALLOPT   EQU   ALLAGL+28                                                02655000
UNITABL  EQU   0                                                        02656000
UNITADR  EQU   UNITABL+4                                                02657000
@NM00010 EQU   UNITADR                                                  02658000
UNITSTAT EQU   UNITABL+6                                                02659000
IDCIOOP0 EQU   0                                                        02660000
IDCIOCL0 EQU   0                                                        02661000
IDCIOPO0 EQU   0                                                        02662000
IDCIOGT0 EQU   0                                                        02663000
IOCSTR   EQU   0                                                        02664000
IOCDAD   EQU   IOCSTR                                                   02665000
IOCDLN   EQU   IOCSTR+4                                                 02666000
IOCKYL   EQU   IOCSTR+12                                                02667000
IOCDSO   EQU   IOCSTR+16                                                02668000
IOCDSOAM EQU   IOCDSO                                                   02669000
IOCDSOPS EQU   IOCDSO                                                   02670000
IOCDSOIS EQU   IOCDSO                                                   02671000
IOCRFM   EQU   IOCSTR+17                                                02672000
IOCMAC   EQU   IOCSTR+18                                                02673000
IOCMACCR EQU   IOCMAC                                                   02674000
IOCMAC2  EQU   IOCSTR+19                                                02675000
IOCMACRR EQU   IOCMAC2                                                  02676000
IOCCHP   EQU   IOCSTR+20                                                02677000
IOCMSG   EQU   IOCSTR+21                                                02678000
IOCMSGOP EQU   IOCMSG                                                   02679000
IOCDSN   EQU   IOCSTR+32                                                02680000
IOCRBA   EQU   IOCSTR+40                                                02681000
IOCTTR   EQU   IOCRBA                                                   02682000
IOCMEM   EQU   IOCSTR+44                                                02683000
IOCKYA   EQU   IOCMEM                                                   02684000
IOCNWM   EQU   IOCSTR+48                                                02685000
IOCPTL   EQU   IOCNWM                                                   02686000
IOCRRN   EQU   IOCSTR+52                                                02687000
IOCREL   EQU   IOCSTR+60                                                02688000
OPNAGL   EQU   0                                                        02689000
OPNOPT   EQU   OPNAGL                                                   02690000
OPNOPTIN EQU   OPNOPT                                                   02691000
OPNOPTOT EQU   OPNOPT                                                   02692000
OPNOPTKS EQU   OPNOPT                                                   02693000
OPNOPTCR EQU   OPNOPT                                                   02694000
OPNRFM   EQU   OPNAGL+1                                                 02695000
OPNRFMFX EQU   OPNRFM                                                   02696000
OPNRFMVR EQU   OPNRFM                                                   02697000
OPNRFMUN EQU   OPNRFM                                                   02698000
OPNRFMSF EQU   OPNRFM                                                   02699000
OPNRFMBK EQU   OPNRFM                                                   02700000
OPNTYP   EQU   OPNAGL+2                                                 02701000
OPNMOD   EQU   OPNAGL+3                                                 02702000
OPNMODAC EQU   OPNMOD                                                   02703000
OPNIOC   EQU   OPNAGL+4                                                 02704000
OPNDDN   EQU   OPNAGL+8                                                 02705000
OPNPWA   EQU   OPNAGL+12                                                02706000
OPNDSN   EQU   OPNAGL+16                                                02707000
OPNDEV   EQU   OPNAGL+24                                                02708000
OPNDEVDT EQU   OPNDEV                                                   02709000
OPNDEVIX EQU   OPNDEV+4                                                 02710000
OPNREC   EQU   OPNAGL+32                                                02711000
OPNBLK   EQU   OPNAGL+36                                                02712000
OPNDSO   EQU   OPNAGL+41                                                02713000
OPNOPT2  EQU   OPNAGL+42                                                02714000
IOINFOPT EQU   0                                                        02715000
UVOLLIST EQU   0                                                        02716000
UVOLENT  EQU   UVOLLIST+2                                               02717000
AMSTP011 EQU   0                                                        02718000
AMSTP042 EQU   0                                                        02719000
DARGLIST EQU   0                                                        02720000
DARGDBP  EQU   DARGLIST                                                 02721000
DARGRETP EQU   DARGLIST+4                                               02722000
DARGSTID EQU   DARGLIST+8                                               02723000
DARGSMOD EQU   DARGSTID                                                 02724000
DARGSENT EQU   DARGSTID+3                                               02725000
DARGILP  EQU   DARGLIST+12                                              02726000
DARGCNT  EQU   DARGLIST+14                                              02727000
DARGRETL EQU   DARGLIST+16                                              02728000
DARGFLGS EQU   DARGLIST+19                                              02729000
DARGFULL EQU   DARGFLGS                                                 02730000
DARGARY  EQU   DARGLIST+20                                              02731000
DARGINS  EQU   DARGARY                                                  02732000
DARGINL  EQU   DARGARY+2                                                02733000
DARGDTM  EQU   DARGARY+4                                                02734000
FMTLIST  EQU   0                                                        02735000
FMTFLGS  EQU   FMTLIST                                                  02736000
FMTSPF   EQU   FMTLIST+2                                                02737000
FMTRFNO  EQU   FMTSPF                                                   02738000
FMTILEN  EQU   FMTRFNO                                                  02739000
FMTIOFF  EQU   FMTLIST+4                                                02740000
FMTTRBC  EQU   FMTIOFF                                                  02741000
FMTSTO   EQU   FMTTRBC                                                  02742000
FMTOCOL  EQU   FMTLIST+6                                                02743000
FMTCNVF  EQU   FMTLIST+10                                               02744000
ERCNVTAB EQU   0                                                        02745000
ERTYPE   EQU   ERCNVTAB                                                 02746000
EROPER   EQU   ERCNVTAB+1                                               02747000
EROSOPER EQU   ERCNVTAB+2                                               02748000
IDCDB010 EQU   0                                                        02749000
DMPITM   EQU   0                                                        02750000
DMPARY   EQU   0                                                        02751000
INDN     EQU   0                                                        02752000
OUTDD    EQU   0                                                        02753000
OUTDDVAL EQU   OUTDD+1                                                  02754000
FMKYC    EQU   0                                                        02755000
FMKYCLEN EQU   FMKYC                                                    02756000
FMKYCVAL EQU   FMKYC+1                                                  02757000
FMRBA    EQU   0                                                        02758000
FMRBAVAL EQU   FMRBA                                                    02759000
SKIP     EQU   0                                                        02760000
SKIPVAL  EQU   SKIP                                                     02761000
TOKYC    EQU   0                                                        02762000
TOKYCLEN EQU   TOKYC                                                    02763000
TOKYCVAL EQU   TOKYC+1                                                  02764000
TORBA    EQU   0                                                        02765000
TORBAVAL EQU   TORBA                                                    02766000
COUNT    EQU   0                                                        02767000
COUNTVAL EQU   COUNT                                                    02768000
INPDD    EQU   0                                                        02769000
INPDDPLN EQU   INPDD                                                    02770000
INPDDPAS EQU   INPDD+1                                                  02771000
INPDDLEN EQU   INPDD+9                                                  02772000
INPDDVAL EQU   INPDD+10                                                 02773000
INDS     EQU   0                                                        02774000
INDSPLN  EQU   INDS                                                     02775000
INDSPAS  EQU   INDS+1                                                   02776000
INDSFLG  EQU   INDS+10                                                  02777000
INDSFUQ  EQU   INDSFLG                                                  02778000
INDSLEN  EQU   INDS+20                                                  02779000
INDSVAL  EQU   INDS+21                                                  02780000
FHEX     EQU   0                                                        02781000
FCHAR    EQU   0                                                        02782000
IENV     EQU   0                                                        02783000
IRFMT    EQU   0                                                        02784000
IBKSZ    EQU   0                                                        02785000
IBKSZVAL EQU   IBKSZ                                                    02786000
IRCSZ    EQU   0                                                        02787000
IRCSZVAL EQU   IRCSZ                                                    02788000
IHDEV    EQU   0                                                        02789000
IHDEVVAL EQU   IHDEV+1                                                  02790000
IPDEV    EQU   0                                                        02791000
IPDEVVAL EQU   IPDEV+1                                                  02792000
IFUNB    EQU   0                                                        02793000
IFBLK    EQU   0                                                        02794000
IVUNB    EQU   0                                                        02795000
IVBLK    EQU   0                                                        02796000
ISUNB    EQU   0                                                        02797000
ISBLK    EQU   0                                                        02798000
IUNDF    EQU   0                                                        02799000
FMNUM    EQU   0                                                        02800000
FMNUMVAL EQU   FMNUM                                                    02801000
TONUM    EQU   0                                                        02802000
TONUMVAL EQU   TONUM                                                    02803000
RECDKEY  EQU   0                                                        02804000
PRTDSNAM EQU   0                                                        02805000
AMSTP041 EQU   0                                                        02806000
AMSTP043 EQU   0                                                        02807000
AMSTP044 EQU   0                                                        02808000
DMPTRM   EQU   0                                                        02809000
FDUMP    EQU   0                                                        02810000
IDCIOCO0 EQU   0                                                        02811000
IDCIOIT0 EQU   0                                                        02812000
IDCIOPT0 EQU   0                                                        02813000
IDCIOSI0 EQU   0                                                        02814000
IDCIOST0 EQU   0                                                        02815000
IDCIOTM0 EQU   0                                                        02816000
IDCIOVY0 EQU   0                                                        02817000
IDCIO050 EQU   0                                                        02818000
IDCSAAL0 EQU   0                                                        02819000
IDCSACA0 EQU   0                                                        02820000
IDCSACL0 EQU   0                                                        02821000
IDCSACR0 EQU   0                                                        02822000
IDCSADE0 EQU   0                                                        02823000
IDCSADL0 EQU   0                                                        02824000
IDCSADQ0 EQU   0                                                        02825000
IDCSAFP0 EQU   0                                                        02826000
IDCSAFS0 EQU   0                                                        02827000
IDCSAGP0 EQU   0                                                        02828000
IDCSAGS0 EQU   0                                                        02829000
IDCSAID0 EQU   0                                                        02830000
IDCSALC0 EQU   0                                                        02831000
IDCSALD0 EQU   0                                                        02832000
IDCSALK0 EQU   0                                                        02833000
IDCSANQ0 EQU   0                                                        02834000
IDCSAPR0 EQU   0                                                        02835000
IDCSAPT0 EQU   0                                                        02836000
IDCSARC0 EQU   0                                                        02837000
IDCSARV0 EQU   0                                                        02838000
IDCSASC0 EQU   0                                                        02839000
IDCSASI0 EQU   0                                                        02840000
IDCSASN0 EQU   0                                                        02841000
IDCSASS0 EQU   0                                                        02842000
IDCSAST0 EQU   0                                                        02843000
IDCSATI0 EQU   0                                                        02844000
IDCSAUC0 EQU   0                                                        02845000
IDCSAWO0 EQU   0                                                        02846000
IDCSA060 EQU   0                                                        02847000
IDCST010 EQU   0                                                        02848000
IDCTPER0 EQU   0                                                        02849000
LISTTEST EQU   0                                                        02850000
NEWERID1 EQU   5                                                        02851000
GDTTBL   EQU   0                                                        02852000
GDTTR1   EQU   GDTTBL+8                                                 02853000
GDTTR2   EQU   GDTTBL+12                                                02854000
GDTDBG   EQU   GDTTBL+40                                                02855000
GDTSTC   EQU   GDTTBL+44                                                02856000
GDTPRT   EQU   GDTTBL+48                                                02857000
GDTESS   EQU   GDTTBL+52                                                02858000
GDTESA   EQU   GDTTBL+56                                                02859000
GDTRST   EQU   GDTTBL+60                                                02860000
GDTRES   EQU   GDTTBL+64                                                02861000
GDTCAL   EQU   GDTTBL+68                                                02862000
GDTGSP   EQU   GDTTBL+72                                                02863000
GDTFSP   EQU   GDTTBL+76                                                02864000
GDTGPL   EQU   GDTTBL+80                                                02865000
GDTFPL   EQU   GDTTBL+84                                                02866000
GDTLOD   EQU   GDTTBL+88                                                02867000
GDTDEL   EQU   GDTTBL+92                                                02868000
GDTPRL   EQU   GDTTBL+96                                                02869000
GDTEPL   EQU   GDTTBL+100                                               02870000
GDTTIM   EQU   GDTTBL+104                                               02871000
GDTIIO   EQU   GDTTBL+108                                               02872000
GDTTIO   EQU   GDTTBL+112                                               02873000
GDTOPN   EQU   GDTTBL+124                                               02874000
GDTCLS   EQU   GDTTBL+128                                               02875000
GDTGET   EQU   GDTTBL+132                                               02876000
GDTPUT   EQU   GDTTBL+136                                               02877000
GDTPOS   EQU   GDTTBL+140                                               02878000
GDTCPY   EQU   GDTTBL+144                                               02879000
GDTCAT   EQU   GDTTBL+148                                               02880000
GDTSNP   EQU   GDTTBL+164                                               02881000
GDTVFY   EQU   GDTTBL+172                                               02882000
GDTECT   EQU   GDTTBL+188                                               02883000
GDTUID   EQU   GDTTBL+192                                               02884000
GDTPMT   EQU   GDTTBL+196                                               02885000
GDTCIR   EQU   GDTTBL+200                                               02886000
GDTLNK   EQU   GDTTBL+204                                               02887000
GDTALC   EQU   GDTTBL+208                                               02888000
GDTDLC   EQU   GDTTBL+212                                               02889000
GDTQAL   EQU   GDTTBL+216                                               02890000
GDTSTW   EQU   GDTTBL+220                                               02891000
GDTSSC   EQU   GDTTBL+224                                               02892000
GDTENQ   EQU   GDTTBL+228                                               02893000
GDTRSV   EQU   GDTTBL+232                                               02894000
GDTDEQ   EQU   GDTTBL+236                                               02895000
GDTSFO   EQU   GDTTBL+240                                               02896000
GDTWTO   EQU   GDTTBL+244                                               02897000
GDTSCR   EQU   GDTTBL+248                                               02898000
GDTUNT   EQU   GDTTBL+252                                               02899000
GDTRCT   EQU   GDTTBL+256                                               02900000
GDTIFO   EQU   GDTTBL+260                                               02901000
GDTEXP   EQU   GDTTBL+264                                               02902000
GDTSTA   EQU   GDTTBL+268                                               02903000
GDTERR   EQU   GDTTBL+272                                               02904000
GDTUNC   EQU   GDTTBL+276                                               02905000
GDTLOC   EQU   GDTTBL+280                                               02906000
FDTTBL   EQU   0                                                        02907000
FDTPTR   EQU   FDTTBL+8                                                 02908000
LASTCC   EQU   0                                                        02909000
DELMFLG  EQU   0                                                        02910000
DELMCNT  EQU   0                                                        02911000
DELMINCR EQU   0                                                        02912000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02913000
FDTVERB  EQU   FDTTBL                                                   02914000
GDTPSB   EQU   GDTTBL+184                                               02915000
GDTUPT   EQU   GDTTBL+180                                               02916000
GDTCMB   EQU   GDTTBL+176                                               02917000
GDTSPR   EQU   GDTTBL+168                                               02918000
@NM00001 EQU   GDTTBL+160                                               02919000
GDTABH   EQU   GDTTBL+156                                               02920000
GDTABT   EQU   GDTTBL+152                                               02921000
GDTTOH   EQU   GDTTBL+120                                               02922000
GDTRIP   EQU   GDTTBL+116                                               02923000
GDTIOH   EQU   GDTTBL+36                                                02924000
GDTSAH   EQU   GDTTBL+32                                                02925000
GDTTPH   EQU   GDTTBL+28                                                02926000
GDTRIH   EQU   GDTTBL+24                                                02927000
GDTSTH   EQU   GDTTBL+20                                                02928000
GDTDBH   EQU   GDTTBL+16                                                02929000
GDTPRM   EQU   GDTTBL+4                                                 02930000
GDTHDR   EQU   GDTTBL                                                   02931000
IPDEVLEN EQU   IPDEV                                                    02932000
IHDEVLEN EQU   IHDEV                                                    02933000
INDSMEM  EQU   INDS+12                                                  02934000
INDSMLN  EQU   INDS+11                                                  02935000
INDSPOS  EQU   INDS+9                                                   02936000
OUTDDLEN EQU   OUTDD                                                    02937000
@NM00036 EQU   DMPARY+15                                                02938000
DMPARYTP EQU   DMPARY+14                                                02939000
DMPARYEX EQU   DMPARY+12                                                02940000
DMPARYIC EQU   DMPARY+10                                                02941000
DMPARYSZ EQU   DMPARY+8                                                 02942000
DMPARYNM EQU   DMPARY                                                   02943000
@NM00035 EQU   DMPITM+15                                                02944000
DMPITMTP EQU   DMPITM+14                                                02945000
DMPITMLN EQU   DMPITM+12                                                02946000
DMPITMPT EQU   DMPITM+8                                                 02947000
DMPITMNM EQU   DMPITM                                                   02948000
@NM00034 EQU   ERCNVTAB+24                                              02949000
ERCPLPT  EQU   ERCNVTAB+20                                              02950000
ERCATRC  EQU   ERCNVTAB+16                                              02951000
ERDSNM   EQU   ERCNVTAB+12                                              02952000
@NM00033 EQU   ERCNVTAB+4                                               02953000
@NM00032 EQU   ERCNVTAB+3                                               02954000
@NM00031 EQU   EROSOPER                                                 02955000
EROSUCDX EQU   EROSOPER                                                 02956000
EROSCATL EQU   EROSOPER                                                 02957000
@NM00030 EQU   EROPER                                                   02958000
ERCATAL  EQU   EROPER                                                   02959000
ERCATDL  EQU   EROPER                                                   02960000
ERCATDE  EQU   EROPER                                                   02961000
ERCATLC  EQU   EROPER                                                   02962000
@NM00029 EQU   ERTYPE                                                   02963000
EROSCAT  EQU   ERTYPE                                                   02964000
ERCATLG  EQU   ERTYPE                                                   02965000
@NM00028 EQU   FMTCNVF+1                                                02966000
FMTAR    EQU   FMTCNVF+1                                                02967000
FMTBS    EQU   FMTCNVF+1                                                02968000
FMTSS    EQU   FMTCNVF+1                                                02969000
FMTAL    EQU   FMTCNVF+1                                                02970000
FMTZS    EQU   FMTCNVF+1                                                02971000
@NM00027 EQU   FMTCNVF                                                  02972000
FMTPU    EQU   FMTCNVF                                                  02973000
FMTBD    EQU   FMTCNVF                                                  02974000
FMTBHD   EQU   FMTCNVF                                                  02975000
FMTBHA   EQU   FMTCNVF                                                  02976000
FMTBH    EQU   FMTCNVF                                                  02977000
FMTOLEN  EQU   FMTLIST+8                                                02978000
FMTRIO   EQU   FMTOCOL                                                  02979000
FMTSPT   EQU   FMTSTO                                                   02980000
FMTSTL   EQU   FMTILEN                                                  02981000
@NM00026 EQU   FMTFLGS+1                                                02982000
FMTHDF   EQU   FMTFLGS                                                  02983000
FMTDFF   EQU   FMTFLGS                                                  02984000
FMTSTF   EQU   FMTFLGS                                                  02985000
FMTREPF  EQU   FMTFLGS                                                  02986000
FMTBDF   EQU   FMTFLGS                                                  02987000
FMTIDF   EQU   FMTFLGS                                                  02988000
FMTSCF   EQU   FMTFLGS                                                  02989000
FMTEOLF  EQU   FMTFLGS                                                  02990000
DARGPCT  EQU   DARGINL                                                  02991000
DARGREP  EQU   DARGINS                                                  02992000
@NM00025 EQU   DARGFLGS                                                 02993000
DARGIND  EQU   DARGLIST+18                                              02994000
UVOLVOL  EQU   UVOLENT+4                                                02995000
UVOLDEV  EQU   UVOLENT                                                  02996000
UVOLCNT  EQU   UVOLLIST                                                 02997000
@NM00024 EQU   IOINFOPT                                                 02998000
IOINFTMS EQU   IOINFOPT                                                 02999000
IOINFSUP EQU   IOINFOPT                                                 03000000
IOINFDSN EQU   IOINFOPT                                                 03001000
IOINFVOL EQU   IOINFOPT                                                 03002000
IOINFDVT EQU   IOINFOPT                                                 03003000
OPNVOL   EQU   OPNAGL+44                                                03004000
@NM00023 EQU   OPNAGL+43                                                03005000
@NM00022 EQU   OPNOPT2                                                  03006000
OPNOPTJM EQU   OPNOPT2                                                  03007000
OPNOPTNM EQU   OPNOPT2                                                  03008000
OPNOPTAS EQU   OPNOPT2                                                  03009000
@NM00021 EQU   OPNDSO                                                   03010000
OPNDSOPO EQU   OPNDSO                                                   03011000
OPNDSOIS EQU   OPNDSO                                                   03012000
OPNDSOPS EQU   OPNDSO                                                   03013000
OPNDSOAM EQU   OPNDSO                                                   03014000
OPNKYL   EQU   OPNAGL+40                                                03015000
OPNCBP   EQU   OPNAGL+20                                                03016000
OPNMODRP EQU   OPNMOD                                                   03017000
OPNMODUB EQU   OPNMOD                                                   03018000
OPNMODRS EQU   OPNMOD                                                   03019000
OPNMODAX EQU   OPNMOD                                                   03020000
OPNMODRR EQU   OPNMOD                                                   03021000
OPNMODRC EQU   OPNMOD                                                   03022000
OPNMODPD EQU   OPNMOD                                                   03023000
@NM00020 EQU   OPNTYP                                                   03024000
OPNTYPRV EQU   OPNTYP                                                   03025000
OPNTYPEX EQU   OPNTYP                                                   03026000
OPNTYPRA EQU   OPNTYP                                                   03027000
OPNTYPXM EQU   OPNTYP                                                   03028000
OPNTYPCI EQU   OPNTYP                                                   03029000
OPNTYPSO EQU   OPNTYP                                                   03030000
OPNTYPSI EQU   OPNTYP                                                   03031000
@NM00019 EQU   OPNRFM                                                   03032000
OPNOPTSK EQU   OPNOPT                                                   03033000
OPNOPTDR EQU   OPNOPT                                                   03034000
OPNOPTBK EQU   OPNOPT                                                   03035000
OPNOPTUP EQU   OPNOPT                                                   03036000
IOCEXT   EQU   IOCSTR+64                                                03037000
IOCWORK  EQU   IOCSTR+56                                                03038000
IOCPNM   EQU   IOCNWM+2                                                 03039000
IOCVRC   EQU   IOCTTR                                                   03040000
IOCCBP   EQU   IOCSTR+36                                                03041000
IOCHURBA EQU   IOCSTR+28                                                03042000
IOCVOLSR EQU   IOCSTR+22                                                03043000
@NM00018 EQU   IOCMSG                                                   03044000
IOCMSGAE EQU   IOCMSG                                                   03045000
IOCMSGCE EQU   IOCMSG                                                   03046000
IOCMSGOE EQU   IOCMSG                                                   03047000
@NM00017 EQU   IOCMSG                                                   03048000
IOCCHPSY EQU   IOCCHP                                                   03049000
IOCCHPAS EQU   IOCCHP                                                   03050000
IOCCHPBK EQU   IOCCHP                                                   03051000
IOCCHPCR EQU   IOCCHP                                                   03052000
IOCCHPKS EQU   IOCCHP                                                   03053000
IOCCHPSK EQU   IOCCHP                                                   03054000
IOCCHPDR EQU   IOCCHP                                                   03055000
IOCCHPSQ EQU   IOCCHP                                                   03056000
@NM00016 EQU   IOCMAC2                                                  03057000
IOCMACPA EQU   IOCMAC2                                                  03058000
@NM00015 EQU   IOCMAC2                                                  03059000
IOCMACCP EQU   IOCMAC2                                                  03060000
IOCMACAS EQU   IOCMAC2                                                  03061000
IOCMACSK EQU   IOCMAC2                                                  03062000
@NM00014 EQU   IOCMAC                                                   03063000
IOCMACCC EQU   IOCMAC                                                   03064000
IOCMACDR EQU   IOCMAC                                                   03065000
IOCMACBK EQU   IOCMAC                                                   03066000
IOCMACUP EQU   IOCMAC                                                   03067000
IOCMACOT EQU   IOCMAC                                                   03068000
IOCMACIN EQU   IOCMAC                                                   03069000
@NM00013 EQU   IOCRFM                                                   03070000
IOCRFMBK EQU   IOCRFM                                                   03071000
IOCRFMSF EQU   IOCRFM                                                   03072000
IOCRFMUN EQU   IOCRFM                                                   03073000
IOCRFMVR EQU   IOCRFM                                                   03074000
IOCRFMFX EQU   IOCRFM                                                   03075000
@NM00012 EQU   IOCDSO                                                   03076000
IOCDSOPO EQU   IOCDSO                                                   03077000
IOCRKP   EQU   IOCSTR+13                                                03078000
IOCTRN   EQU   IOCSTR+8                                                 03079000
UNITVTOC EQU   UNITABL+7                                                03080000
@NM00011 EQU   UNITSTAT                                                 03081000
UNITUSHR EQU   UNITSTAT                                                 03082000
UNITXSHR EQU   UNITSTAT                                                 03083000
UNITISHR EQU   UNITSTAT                                                 03084000
UNITUA   EQU   @NM00010+1                                               03085000
UNITCHA  EQU   @NM00010                                                 03086000
UNITUCB  EQU   UNITABL                                                  03087000
ALLUNCNT EQU   ALLAGL+30                                                03088000
ALLVLCNT EQU   ALLAGL+29                                                03089000
@NM00009 EQU   ALLOPT                                                   03090000
ALLOPTUN EQU   ALLOPT                                                   03091000
ALLOPTPV EQU   ALLOPT                                                   03092000
ALLOPTDS EQU   ALLOPT                                                   03093000
ALLOPTVL EQU   ALLOPT                                                   03094000
@NM00008 EQU   ALLORG+1                                                 03095000
ALLORGVS EQU   ALLORG+1                                                 03096000
@NM00007 EQU   ALLORG+1                                                 03097000
ALLORGGS EQU   ALLORG+1                                                 03098000
ALLORGUN EQU   ALLORG                                                   03099000
ALLORGPO EQU   ALLORG                                                   03100000
ALLORGMQ EQU   ALLORG                                                   03101000
ALLORGCQ EQU   ALLORG                                                   03102000
ALLORGCX EQU   ALLORG                                                   03103000
ALLORGDA EQU   ALLORG                                                   03104000
ALLORGPS EQU   ALLORG                                                   03105000
ALLORGIS EQU   ALLORG                                                   03106000
ALLDSPUN EQU   ALLDSP                                                   03107000
ALLDSPCG EQU   ALLDSP                                                   03108000
ALLDSPDE EQU   ALLDSP                                                   03109000
ALLDSPKP EQU   ALLDSP                                                   03110000
@NM00006 EQU   ALLDSP                                                   03111000
ALLSTSOD EQU   ALLSTS                                                   03112000
ALLSTSMD EQU   ALLSTS                                                   03113000
ALLSTSNW EQU   ALLSTS                                                   03114000
ALLSTSSR EQU   ALLSTS                                                   03115000
@NM00005 EQU   ALLSTS                                                   03116000
ALLPWD   EQU   ALLAGL+20                                                03117000
ALLVLP   EQU   ALLAGL+16                                                03118000
ALLULP   EQU   ALLAGL+12                                                03119000
ALLDDN   EQU   ALLAGL+4                                                 03120000
ALLDSN   EQU   ALLAGL                                                   03121000
CIRPID   EQU   CIRAGL+28                                                03122000
CIRPWD   EQU   CIRAGL+24                                                03123000
CIRCAT   EQU   CIRAGL+20                                                03124000
CIRWKP   EQU   CIRAGL+16                                                03125000
CIRTLR   EQU   CIRAGL+12                                                03126000
CIRHDR   EQU   CIRAGL+8                                                 03127000
CIRTLN   EQU   CIRAGL+6                                                 03128000
CIRHLN   EQU   CIRAGL+4                                                 03129000
@NM00004 EQU   CIRAGL+1                                                 03130000
@NM00003 EQU   CIRTYPE                                                  03131000
CIRTYPAQ EQU   CIRTYPE                                                  03132000
CIRTYP1Q EQU   CIRTYPE                                                  03133000
NEWID1   EQU   TRACE1+95                                                03134000
CALLID   EQU   OLDERID1+90                                              03135000
@NM00002 EQU   OLDERID1                                                 03136000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03137000
@RF00315 EQU   @RC00313                                                 03138000
@RF00320 EQU   @RC00318                                                 03139000
@RF00325 EQU   @RC00323                                                 03140000
@RF00336 EQU   @RC00311                                                 03141000
@RC00352 EQU   @RC00311                                                 03142000
@RC00347 EQU   @RC00311                                                 03143000
@RC00385 EQU   @RC00382                                                 03144000
@RF00488 EQU   @EL00002                                                 03145000
@RF00579 EQU   @EL00003                                                 03146000
@RC00564 EQU   @EL00003                                                 03147000
@PB00003 EQU   @EL00001                                                 03148000
@PB00002 EQU   @PB00003                                                 03149000
@RC00570 EQU   @RC00564                                                 03150000
@RC00568 EQU   @RC00564                                                 03151000
@RC00566 EQU   @RC00564                                                 03152000
@ENDDATA EQU   *                                                        03153000
         END   IDCPR01,(C'PLS2133',0701,77067)                          03154000
