         TITLE 'IDCRC01 - EXPORTRA FUNCTION DRIVER                     *00001000
                        '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCRC01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCRC01   77.332'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @09,0                                               0002 00021000
@PSTART  LA    @10,4095(,@09)                                      0002 00022000
         LA    @11,4095(,@10)                                      0002 00023000
         LA    @12,4095(,@11)                                      0002 00024000
         USING @PSTART,@09                                         0002 00025000
         USING @PSTART+4095,@10                                    0002 00026000
         USING @PSTART+8190,@11                                    0002 00027000
         USING @PSTART+12285,@12                                   0002 00028000
         L     @00,@SIZDATD                                        0002 00029000
         GETMAIN  R,LV=(0)                                              00030000
         LR    @08,@01                                             0002 00031000
         USING @DATD,@08                                           0002 00032000
         ST    @13,@SA00001+4                                      0002 00033000
         LM    @00,@01,20(@13)                                     0002 00034000
         ST    @08,8(,@13)                                         0002 00035000
         LR    @13,@08                                             0002 00036000
         MVC   @PC00001(12),0(@01)                                 0002 00037000
*                                                                  0327 00038000
*  /******************************************************************/ 00039000
*  /*                                                                */ 00040000
*  /*    HANDLE THE INITIALIZATION AND BUILDING OF THE CRV           */ 00041000
*  /*                                                                */ 00042000
*  /******************************************************************/ 00043000
*                                                                  0328 00044000
*  CALL INIT;                     /* INITIALIZE THE MODULE           */ 00045000
         BAL   @14,INIT                                            0328 00046000
*  CALL BUILDCRV;                 /* BUILD THE CRV REQUIRED FOR      */ 00047000
         BAL   @14,BUILDCRV                                        0329 00048000
*                                 /* THIS FUNCTION                   */ 00049000
*  IF REG15^=LASTCC12             /* IF NO ERRORS                    */ 00050000
*                                                                  0330 00051000
*    /****************************************************************/ 00052000
*    /*                                                              */ 00053000
*    /*    IF EVERYTHING IS OK, THEN LOOP THROUGH ALL THE CRA'S      */ 00054000
*    /*    TO PREPARE THEM FOR THE EXPORTING                         */ 00055000
*    /*                                                              */ 00056000
*    /****************************************************************/ 00057000
*                                                                  0330 00058000
*    THEN DO;                     /* THEN:                           */ 00059000
         CH    REG15,@CH00038                                      0330 00060000
         BE    @RF00330                                            0330 00061000
*      DO INX1=1 TO CRACNT;       /* LOOP THROUGH ALL CRA'S          */ 00062000
*                                                                  0332 00063000
         LA    @14,1                                               0332 00064000
         B     @DE00332                                            0332 00065000
@DL00332 DS    0H                                                  0333 00066000
*        /************************************************************/ 00067000
*        /*                                                          */ 00068000
*        /*    HANDLE THE OPENING OF THE CRA TO PROCESS              */ 00069000
*        /*                                                          */ 00070000
*        /************************************************************/ 00071000
*                                                                  0333 00072000
*        CALL OPENCRA (OPENFUNC,INX1,CRADS);                       0333 00073000
         MVC   @AL00001(12),@AL00333                               0333 00074000
         LA    @14,INX1                                            0333 00075000
         ST    @14,@AL00001+4                                      0333 00076000
         LA    @01,@AL00001                                        0333 00077000
         BAL   @14,OPENCRA                                         0333 00078000
*                                 /* OPEN THE NEXT CRA TO DO         */ 00079000
*        IF REG15=LASTCC12        /* IF THERE IS A CORE PROBLEM      */ 00080000
*          THEN DO;               /* THEN:                           */ 00081000
         LA    @14,12                                              0334 00082000
         CR    REG15,@14                                           0334 00083000
         BNE   @RF00334                                            0334 00084000
*            LASTCC=LASTCC12;     /* INDICATE A BAD PROBLEM          */ 00085000
         L     @04,@PC00001+8                                      0336 00086000
         STH   @14,LASTCC(,@04)                                    0336 00087000
*            CALL EXITTHE;        /* EXIT FROM THE MODULE            */ 00088000
         BAL   @14,EXITTHE                                         0337 00089000
*            END;                 /*                                 */ 00090000
*          ELSE DO;               /* ELSE:                           */ 00091000
         B     @RC00334                                            0339 00092000
@RF00334 DS    0H                                                  0340 00093000
*            IF LASTCC<REG15      /* IF LARGER RETURN CODE           */ 00094000
*              THEN LASTCC=REG15; /* THEN: SAVE NEW ONE              */ 00095000
         L     @14,@PC00001+8                                      0340 00096000
         CH    REG15,LASTCC(,@14)                                  0340 00097000
         BNH   @RF00340                                            0340 00098000
         STH   REG15,LASTCC(,@14)                                  0341 00099000
*              ELSE;              /* ELSE: CONTINUE                  */ 00100000
@RF00340 DS    0H                                                  0343 00101000
*            END;                 /*                                 */ 00102000
*        IF CRVBADVL=ON           /* IF THIS A BAD VOLUME            */ 00103000
*          THEN;                  /* THEN: CONTINUE                  */ 00104000
@RC00334 TM    CRVBADVL(CRVEBASE),B'10000000'                      0344 00105000
         BO    @RT00344                                            0344 00106000
*          /**********************************************************/ 00107000
*          /*                                                        */ 00108000
*          /*    IF THE CRA WAS OPEN'ED OK, THEN PROCESS THE         */ 00109000
*          /*    INFORMATION CONTAINED THEREIN                       */ 00110000
*          /*                                                        */ 00111000
*          /**********************************************************/ 00112000
*                                                                  0346 00113000
*          ELSE DO;               /* ELSE:                           */ 00114000
*            CALL CKNAMES(INX1);  /* CONDITION THE NAME CHAIN        */ 00115000
         LA    @14,INX1                                            0347 00116000
         ST    @14,@AL00001                                        0347 00117000
         LA    @01,@AL00001                                        0347 00118000
         BAL   @14,CKNAMES                                         0347 00119000
*            CALL DUPNAMCK;       /* EXCLUDE DUPLICATE NAMES         */ 00120000
         BAL   @14,DUPNAMCK                                        0348 00121000
*            CALL SYNCH(INX1);    /* CHECK SYNC ON DATA SETS         */ 00122000
         LA    @14,INX1                                            0349 00123000
         ST    @14,@AL00001                                        0349 00124000
         LA    @01,@AL00001                                        0349 00125000
         BAL   @14,SYNCH                                           0349 00126000
*            IF REG15=LASTCC12    /* IF THERE IS AN ERROR            */ 00127000
*              THEN DO;           /* THEN:                           */ 00128000
         LA    @14,12                                              0350 00129000
         CR    REG15,@14                                           0350 00130000
         BNE   @RF00350                                            0350 00131000
*                LASTCC=LASTCC12; /* INDICATE A BAD ERROR            */ 00132000
         L     @04,@PC00001+8                                      0352 00133000
         STH   @14,LASTCC(,@04)                                    0352 00134000
*                CALL EXITTHE;    /* EXIT FROM THE MODULE            */ 00135000
         BAL   @14,EXITTHE                                         0353 00136000
*                END;             /*                                 */ 00137000
*              ELSE;              /* ELSE: CONTINUE                  */ 00138000
@RF00350 DS    0H                                                  0356 00139000
*            CALL OPENCRA(CLOSFUNC,INX1);                          0356 00140000
         LA    @14,@CC00855                                        0356 00141000
         ST    @14,@AL00001                                        0356 00142000
         LA    @14,INX1                                            0356 00143000
         ST    @14,@AL00001+4                                      0356 00144000
         LA    @01,@AL00001                                        0356 00145000
         BAL   @14,OPENCRA                                         0356 00146000
*                                 /* CLOSE THE BASE CRA              */ 00147000
*            END;                 /*                                 */ 00148000
*        END;                     /*                                 */ 00149000
*                                                                  0358 00150000
@RT00344 LA    @14,1                                               0358 00151000
         AL    @14,INX1                                            0358 00152000
@DE00332 ST    @14,INX1                                            0358 00153000
         L     @04,@PC00001+4                                      0358 00154000
         LA    @04,FDTPTR+12(,@04)                                 0358 00155000
         C     @14,CRACNT(,@04)                                    0358 00156000
         BNH   @DL00332                                            0358 00157000
*      /**************************************************************/ 00158000
*      /*                                                            */ 00159000
*      /*    LOOP THROUGH TO EXPORT THE ENTRIES                      */ 00160000
*      /*                                                            */ 00161000
*      /**************************************************************/ 00162000
*                                                                  0359 00163000
*      DO INX1=1 TO CRACNT;       /* LOOP THROUGH ALL CRA'S          */ 00164000
         LA    @14,1                                               0359 00165000
         B     @DE00359                                            0359 00166000
@DL00359 DS    0H                                                  0360 00167000
*        CRVEBASE=ADDR(CRVENTRY(INX1));                            0360 00168000
         MH    @14,@CH00954                                        0360 00169000
         L     CRVEBASE,CRVBASE                                    0360 00170000
         LA    CRVEBASE,CRVENTRY-28(@14,CRVEBASE)                  0360 00171000
*                                 /* POINT AT THE CORRECT ENTRY      */ 00172000
*        IF CRVBADVL=ON           /* IF THIS IS A BAD VOL            */ 00173000
*          THEN;                  /* THEN: CONTINUE                  */ 00174000
         TM    CRVBADVL(CRVEBASE),B'10000000'                      0361 00175000
         BO    @RT00361                                            0361 00176000
*          ELSE DO;               /* ELSE:                           */ 00177000
*            CALL MESSAGE(0,MSGID14,VTTVOLSR(INX1),LENGTH(VTTVOLSR));   00178000
         MVC   @AL00001(16),@AL00364                               0364 00179000
         L     @14,INX1                                            0364 00180000
         MH    @14,@CH00763                                        0364 00181000
         L     @04,CRVBASE                                         0364 00182000
         L     @04,CRVCRAPL(,@04)                                  0364 00183000
         L     @04,ACCVOLTT(,@04)                                  0364 00184000
         AL    @04,@CF01391                                        0364 00185000
         LA    @14,VTTVOLSR-4(@14,@04)                             0364 00186000
         ST    @14,@AL00001+8                                      0364 00187000
         LA    @01,@AL00001                                        0364 00188000
         BAL   @14,MESSAGE                                         0364 00189000
*                                 /* INDICATE THE VOL TO EXPORT      */ 00190000
*            CALL EXPORTDR(INX1); /* EXPORT THE NAME CHAIN           */ 00191000
         LA    @14,INX1                                            0365 00192000
         ST    @14,@AL00001                                        0365 00193000
         LA    @01,@AL00001                                        0365 00194000
         BAL   @14,EXPORTDR                                        0365 00195000
*                                                          /*@OZ18993*/ 00196000
*            IF EXPORTED > LASTCC                          /*@OZ18993*/ 00197000
*              THEN               /*INDICATE THAT PORTABLE   @OZ18993*/ 00198000
         L     @14,@PC00001+8                                      0366 00199000
         LH    @14,LASTCC(,@14)                                    0366 00200000
         CR    EXPORTED,@14                                        0366 00201000
         BNH   @RF00366                                            0366 00202000
*                EXPORTED = LASTCC;/*DATASET IS GOOD         @OZ18993*/ 00203000
*                                                                  0367 00204000
         LR    EXPORTED,@14                                        0367 00205000
*            IF REG15>=LASTCC12   /* IF THERE IS AN ERROR            */ 00206000
*              THEN DO;           /* THEN:                           */ 00207000
@RF00366 CH    REG15,@CH00038                                      0368 00208000
         BL    @RF00368                                            0368 00209000
*                LASTCC=REG15;    /* INDICATE A BAD ERROR            */ 00210000
         L     @14,@PC00001+8                                      0370 00211000
         STH   REG15,LASTCC(,@14)                                  0370 00212000
*                CALL EXITTHE;    /* EXIT FROM THE MODULE            */ 00213000
         BAL   @14,EXITTHE                                         0371 00214000
*                END;             /*                                 */ 00215000
*              ELSE;              /* ELSE: CONTINUE                  */ 00216000
@RF00368 DS    0H                                                  0374 00217000
*            END;                 /*                                 */ 00218000
*        END;                     /*                                 */ 00219000
@RT00361 LA    @14,1                                               0375 00220000
         AL    @14,INX1                                            0375 00221000
@DE00359 ST    @14,INX1                                            0375 00222000
         L     @04,@PC00001+4                                      0375 00223000
         LA    @04,FDTPTR+12(,@04)                                 0375 00224000
         C     @14,CRACNT(,@04)                                    0375 00225000
         BNH   @DL00359                                            0375 00226000
*      /**************************************************************/ 00227000
*      /*                                                            */ 00228000
*      /*    HANDLE THE TERMINATION PROCESS                          */ 00229000
*      /*                                                            */ 00230000
*      /**************************************************************/ 00231000
*                                                                  0376 00232000
*      END;                       /*                                 */ 00233000
*    ELSE DO;                     /* ELSE:                           */ 00234000
         B     @RC00330                                            0377 00235000
@RF00330 DS    0H                                                  0378 00236000
*      LASTCC=LASTCC12;           /* INDICATE BAD RETURN             */ 00237000
         L     @14,@PC00001+8                                      0378 00238000
         MVC   LASTCC(2,@14),@CH00038                              0378 00239000
*      END;                       /*                                 */ 00240000
*  CALL EXITTHE;                  /* EXIT FROM THE MODULE            */ 00241000
*                                                                  0380 00242000
@RC00330 BAL   @14,EXITTHE                                         0380 00243000
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */ 00244000
*  GEN (EJECT);                                                    0382 00245000
         EJECT                                                          00246000
*  /******************************************************************/ 00247000
*  /*                                                                */ 00248000
*  /* PROCEDURE NAME:                                                */ 00249000
*  /*    BUILDCRV                                                    */ 00250000
*  /*                                                                */ 00251000
*  /* FUNCTION:                                                      */ 00252000
*  /*                                                                */ 00253000
*  /*    CONSTRUCT THE CRV THAT WILL BE REQUIRED TO HANDLE THE       */ 00254000
*  /*    DATA THAT WILL BE GENERATED AND USED DURING THE             */ 00255000
*  /*    FUNCTIONS TO BE PERFORMED                                   */ 00256000
*  /*                                                                */ 00257000
*  /* REQUIREMENTS:                                                  */ 00258000
*  /*                                                                */ 00259000
*  /*    NONE                                                        */ 00260000
*  /*                                                                */ 00261000
*  /******************************************************************/ 00262000
*                                                                  0383 00263000
*BUILDCRV: PROCEDURE;                                              0383 00264000
*                                                                  0383 00265000
         B     @PB00002                                            0383 00266000
BUILDCRV STM   @14,@12,@SA00002                                    0383 00267000
*  DCL BLDPTR        PTR(31);     /* POINTER TO SCAN IOINFO          */ 00268000
*                                 /* DATA AREA                       */ 00269000
*  DCL NOFNO1        FIXED(15) CONSTANT(2);                        0385 00270000
*                                 /* CONSTANT FOR NUMBER OF          */ 00271000
*                                 /* TYPES IN IOINFO AREA            */ 00272000
*  DCL BLDIX2        FIXED(31);   /* GENERAL COUNTER FOR ROUTIN      */ 00273000
*  DCL BLDIX1        FIXED(31);   /* GENERAL COUNTER FOR ROUTIN      */ 00274000
*  DCL CRVSIZE       FIXED(31);   /* SIZE OF THE CRV                 */ 00275000
*  DCL ACCSIZE       FIXED(31);   /* SIZE OF THE ACC                 */ 00276000
*  DCL VTTSIZE       FIXED(31);   /* SIZE OF THE VTT                 */ 00277000
*  DCL POOLSIZE      FIXED(31);   /* SIZE OF THE POOL                */ 00278000
*  DCL NOFBUFFS      FIXED(31) CONSTANT(6);                        0392 00279000
*                                 /* NUMBER OF BUFFERS IN POOL       */ 00280000
*  DCL MINLRECL      FIXED(31) CONSTANT(280);              /*@OZ17191*/ 00281000
*                                 /* MIMUM LRECL ALLOWABLE           */ 00282000
*                                                                  0394 00283000
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */ 00284000
*                                                                  0394 00285000
*  /******************************************************************/ 00286000
*  /*                                                                */ 00287000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 00288000
*  /*                                                                */ 00289000
*  /******************************************************************/ 00290000
*                                                                  0395 00291000
*  OLDERID2 = NEWERID2;                                            0395 00292000
         L     @14,@PC00001                                        0395 00293000
         L     @04,GDTTR2(,@14)                                    0395 00294000
         MVC   @TS00001(95),NEWERID2(@04)                          0395 00295000
         MVC   OLDERID2(95,@04),@TS00001                           0395 00296000
*  NEWID2='RC81';                                                  0396 00297000
         MVC   NEWID2(4,@04),@CC01102                              0396 00298000
*  IF GDTDBG = NULLPTR                                             0397 00299000
*    THEN;                                                         0397 00300000
         ICM   @04,15,GDTDBG(@14)                                  0397 00301000
         BZ    @RT00397                                            0397 00302000
*    ELSE                                                          0399 00303000
*      CALL IDCDB010 (GDTTBL,'RC81');                              0399 00304000
         L     @14,@PC00001                                        0399 00305000
         ST    @14,@AL00001                                        0399 00306000
         LA    @04,@CC01102                                        0399 00307000
         ST    @04,@AL00001+4                                      0399 00308000
         MVI   @AL00001+4,X'80'                                    0399 00309000
         L     @15,GDTDBG(,@14)                                    0399 00310000
         LA    @01,@AL00001                                        0399 00311000
         BALR  @14,@15                                             0399 00312000
*  /******************************************************************/ 00313000
*  /*                                                                */ 00314000
*  /*    CALCULATE THE SIZE OF THE CRV,ACC AND VTT.  ATTEMPT TO      */ 00315000
*  /*    OBTAIN THE SPACE TO ALLOCATE THE BLOCKS                     */ 00316000
*  /*                                                                */ 00317000
*  /******************************************************************/ 00318000
*                                                                  0400 00319000
*  BUFSIZE=((NOFBUFFS*LENGTH(BUFELM)+3)/4)*4;                      0400 00320000
@RT00397 LA    @14,3120                                            0400 00321000
         STH   @14,BUFSIZE(,BUFSPTR)                               0400 00322000
*                                 /* COMPUTE SIZE OF BUFFER          */ 00323000
*                                 /* POOL                            */ 00324000
*  VGOSIZE=((NOOFVGOS*LENGTH(VGOEXT)+LENGTH(VGOS)+3)/4)*4;         0401 00325000
         LA    @07,2464                                            0401 00326000
         ST    @07,VGOSIZE                                         0401 00327000
*                                 /* COMPUTE SIZE OF SPACE FOR       */ 00328000
*                                 /* THE VGO'S                       */ 00329000
*  CRVSIZE=((LENGTH(CRVENTRY)*CRACNT+LENGTH(CRV)+3)/4)*4;          0402 00330000
         LA    @06,4                                               0402 00331000
         L     @01,@PC00001+4                                      0402 00332000
         LA    @01,FDTPTR+12(,@01)                                 0402 00333000
         L     @01,CRACNT(,@01)                                    0402 00334000
         ST    @06,@TF00001                                        0402 00335000
         LR    @06,@01                                             0402 00336000
         MH    @06,@CH00954                                        0402 00337000
         AH    @06,@CH01374                                        0402 00338000
         SRDA  @06,32                                              0402 00339000
         D     @06,@TF00001                                        0402 00340000
         SLA   @07,2                                               0402 00341000
         LR    CRVSIZE,@07                                         0402 00342000
*                                 /* GET SIZE OF CRV IN WORDS        */ 00343000
*  ACCSIZE=((LENGTH(ACC)+3)/4)*4; /* GET SIZE OF ACC IN WORDS        */ 00344000
         LA    ACCSIZE,12                                          0403 00345000
*  VTTSIZE=((LENGTH(VTTENTRY)*CRACNT+LENGTH(VTT)+3)/4)*4;          0404 00346000
         LR    @06,@01                                             0404 00347000
         MH    @06,@CH00763                                        0404 00348000
         AH    @06,@CH00473                                        0404 00349000
         SRDA  @06,32                                              0404 00350000
         D     @06,@TF00001                                        0404 00351000
         SLA   @07,2                                               0404 00352000
         LR    VTTSIZE,@07                                         0404 00353000
*                                 /* GET SIZE OF VTT IN WORDS        */ 00354000
*  POOLSIZE=CRVSIZE+ACCSIZE+VTTSIZE+BUFSIZE+VGOSIZE;               0405 00355000
         L     @07,VGOSIZE                                         0405 00356000
         LR    @06,CRVSIZE                                         0405 00357000
         ALR   @06,ACCSIZE                                         0405 00358000
         ALR   @06,VTTSIZE                                         0405 00359000
         ALR   @06,@14                                             0405 00360000
         ALR   @06,@07                                             0405 00361000
         ST    @06,POOLSIZE                                        0405 00362000
*                                 /* GET SIZE OF TOTAL SPACE         */ 00363000
*  CALL IDCSAGP0 (GDTTBL,POOLSIZE,CRVBASE,COREID4,SETZERO);        0406 00364000
         L     @14,@PC00001                                        0406 00365000
         ST    @14,@AL00001                                        0406 00366000
         LA    @07,POOLSIZE                                        0406 00367000
         ST    @07,@AL00001+4                                      0406 00368000
         LA    @07,CRVBASE                                         0406 00369000
         ST    @07,@AL00001+8                                      0406 00370000
         LA    @07,@CC00835                                        0406 00371000
         ST    @07,@AL00001+12                                     0406 00372000
         LA    @07,SETZERO                                         0406 00373000
         ST    @07,@AL00001+16                                     0406 00374000
         MVI   @AL00001+16,X'80'                                   0406 00375000
         L     @15,GDTGPL(,@14)                                    0406 00376000
         LA    @01,@AL00001                                        0406 00377000
         BALR  @14,@15                                             0406 00378000
*                                 /* GET THE SPACE FOR CRV,          */ 00379000
*                                 /* ACC AND VTT                     */ 00380000
*                                                                  0407 00381000
*  /******************************************************************/ 00382000
*  /*                                                                */ 00383000
*  /*    IF THE SPACE WAS OBTAINED THEN SUBALLOCATE THE SPACE        */ 00384000
*  /*    TO THE OTHER BLOCKS                                         */ 00385000
*  /*                                                                */ 00386000
*  /******************************************************************/ 00387000
*                                                                  0407 00388000
*  IF REG15=LASTCC00              /* IF SPACE OBTAINED               */ 00389000
*    THEN DO;                     /* THEN:                           */ 00390000
         LTR   REG15,REG15                                         0407 00391000
         BNZ   @RF00407                                            0407 00392000
*      CRVCRAPL=CRVBASE+CRVSIZE;  /* SET UP ACC BASE ADDRESS         */ 00393000
         L     @14,CRVBASE                                         0409 00394000
         LR    @07,CRVSIZE                                         0409 00395000
         ALR   @07,@14                                             0409 00396000
         ST    @07,CRVCRAPL(,@14)                                  0409 00397000
*      ACCVOLTT=CRVCRAPL+ACCSIZE; /* SET UP VTT BASE ADDRESS         */ 00398000
         LR    @02,ACCSIZE                                         0410 00399000
         ALR   @02,@07                                             0410 00400000
         ST    @02,ACCVOLTT(,@07)                                  0410 00401000
*      BUFPOOL=ACCVOLTT+VTTSIZE;  /* ALLOCATE THE BUFFER POOL        */ 00402000
         LR    @03,VTTSIZE                                         0411 00403000
         ALR   @03,@02                                             0411 00404000
         ST    @03,BUFPOOL(,BUFSPTR)                               0411 00405000
*      VGOPTR=BUFPOOL+BUFSIZE;    /* ALLOCATE THE VGO SPACE          */ 00406000
         AH    @03,BUFSIZE(,BUFSPTR)                               0412 00407000
         ST    @03,VGOPTR                                          0412 00408000
*      CRVMAXLR=MINLRECL;         /* INITIALIZE MAXIMUM LRECL        */ 00409000
         MVC   CRVMAXLR(4,@14),@CF01101                            0413 00410000
*      VTTENTNO=CRACNT;           /* INITIALIZE NO. OF ENTRIES       */ 00411000
         L     @14,@PC00001+4                                      0414 00412000
         LA    @14,FDTPTR+12(,@14)                                 0414 00413000
         MVC   VTTENTNO(4,@02),CRACNT(@14)                         0414 00414000
*      /**************************************************************/ 00415000
*      /*                                                            */ 00416000
*      /*    PREPARE THE IOINFO CONTROL BYTE AND LOOP THROUGH        */ 00417000
*      /*    ALL OF THE CRA'S TO BUILD THE INFORMATION NEEDED        */ 00418000
*      /*                                                            */ 00419000
*      /**************************************************************/ 00420000
*                                                                  0415 00421000
*      BYTEPM1A=ADDR(BYTEPM1);    /* POINT AT THE OPTION BYTE        */ 00422000
         LA    BYTEPM1A,BYTEPM1                                    0415 00423000
*      BYTEPM1=0;                 /* CLEAR THE INDICATORS            */ 00424000
         MVI   BYTEPM1,X'00'                                       0416 00425000
*      IOINFVOL=ON;               /* INDICATE VOLSER'S DESIRED       */ 00426000
*      IOINFDVT=ON;               /* INDICATE DEVTYPE DESIRED        */ 00427000
         OI    IOINFVOL(BYTEPM1A),B'11000000'                      0418 00428000
*      TMSFLDLN=LENGTH(TMSAREA);  /* PLACE THE LENGTH OF AREA        */ 00429000
         MVC   TMSFLDLN(2),@CH01375                                0419 00430000
*      DO BLDIX1=1 TO CRACNT;     /* LOOP THROUGH ALL THE CRA'S      */ 00431000
         LA    BLDIX1,1                                            0420 00432000
         B     @DE00420                                            0420 00433000
@DL00420 DS    0H                                                  0421 00434000
*        CALL IDCIOSI0 (GDTTBL,BYTEPM1,ADDR(TMSAREA),              0421 00435000
*                 CRADDPTR(BLDIX1)->CRADDVAL);                     0421 00436000
         L     @14,@PC00001                                        0421 00437000
         ST    @14,@AL00001                                        0421 00438000
         LA    @04,BYTEPM1                                         0421 00439000
         ST    @04,@AL00001+4                                      0421 00440000
         LA    @04,TMSAREA                                         0421 00441000
         ST    @04,@AFTEMPS                                        0421 00442000
         LA    @04,@AFTEMPS                                        0421 00443000
         ST    @04,@AL00001+8                                      0421 00444000
         LR    @04,BLDIX1                                          0421 00445000
         SLA   @04,2                                               0421 00446000
         L     @07,@PC00001+4                                      0421 00447000
         L     @01,FDTPTR+16(,@07)                                 0421 00448000
         AL    @01,@CF01392                                        0421 00449000
         L     @04,CRADDPTR(@04,@01)                               0421 00450000
         LA    @04,CRADDVAL(,@04)                                  0421 00451000
         ST    @04,@AL00001+12                                     0421 00452000
         MVI   @AL00001+12,X'80'                                   0421 00453000
         L     @15,GDTIFO(,@14)                                    0421 00454000
         LA    @01,@AL00001                                        0421 00455000
         BALR  @14,@15                                             0421 00456000
*                                 /* GET THE VOLSER AND DEVTYPE      */ 00457000
*                                 /* FOR THE DNAME                   */ 00458000
*        CRVEBASE=ADDR(CRVENTRY(BLDIX1));                          0422 00459000
         LR    @14,BLDIX1                                          0422 00460000
         MH    @14,@CH00954                                        0422 00461000
         L     CRVEBASE,CRVBASE                                    0422 00462000
         LA    CRVEBASE,CRVENTRY-28(@14,CRVEBASE)                  0422 00463000
*                                 /* ESTABLISH BASE OF CRV           */ 00464000
*                                 /* ENTRY                           */ 00465000
*                                                                  0423 00466000
*        /************************************************************/ 00467000
*        /*                                                          */ 00468000
*        /*    IF THE INFORMATION WAS OBTAINED THEN BUILD THE        */ 00469000
*        /*    THE INFORMATION FOR THIS CRA ENTRY                    */ 00470000
*        /*                                                          */ 00471000
*        /************************************************************/ 00472000
*                                                                  0423 00473000
*        IF REG15=LASTCC00        /* IF DATA WAS RETURNED            */ 00474000
*          THEN DO;               /* THEN:                           */ 00475000
         LTR   REG15,REG15                                         0423 00476000
         BNZ   @RF00423                                            0423 00477000
*            BLDPTR=ADDR(TMSRETRN);                                0425 00478000
         LA    BLDPTR,TMSRETRN                                     0425 00479000
*                                 /* POINT AT THE RETURNED DATA      */ 00480000
*            DO BLDIX2=1 TO NOFNO1;                                0426 00481000
         LA    @14,1                                               0426 00482000
         ST    @14,BLDIX2                                          0426 00483000
@DL00426 DS    0H                                                  0427 00484000
*                                 /* LOOP THROUGH ALL FIELDS         */ 00485000
*                                 /* THAT ARE REQUESTED              */ 00486000
*              /******************************************************/ 00487000
*              /*                                                    */ 00488000
*              /*    HANDLE THE VOLUME SERIAL INFORMATION FOR        */ 00489000
*              /*    THIS CRA VOLUME                                 */ 00490000
*              /*                                                    */ 00491000
*              /******************************************************/ 00492000
*                                                                  0427 00493000
*              IF BLDPTR->TMSVSCD=TMSVSCDC                         0427 00494000
*                                 /* IF THE FIELD IS A VOLSER        */ 00495000
*                THEN IF BLDPTR->TMSVSLEN=TMSNOVOL                 0427 00496000
         CLC   TMSVSCD(2,BLDPTR),@CH00154                          0427 00497000
         BNE   @RF00427                                            0427 00498000
*                                 /* THEN: IF THERE IS ONLY ONE      */ 00499000
*                  THEN VTTVOLSR(BLDIX1)=BLDPTR->TMSVOLSR;         0428 00500000
         CLC   TMSVSLEN(2,BLDPTR),@CH00157                         0428 00501000
         BNE   @RF00428                                            0428 00502000
         LR    @14,BLDIX1                                          0429 00503000
         MH    @14,@CH00763                                        0429 00504000
         L     @01,CRVBASE                                         0429 00505000
         L     @01,CRVCRAPL(,@01)                                  0429 00506000
         L     @01,ACCVOLTT(,@01)                                  0429 00507000
         ALR   @01,@14                                             0429 00508000
         AL    @01,@CF01391                                        0429 00509000
         MVC   VTTVOLSR-4(6,@01),TMSVOLSR(BLDPTR)                  0429 00510000
*                                 /* PLACE THE VOLSER IN TABLE       */ 00511000
*                  ELSE DO;       /* ELSE:                           */ 00512000
         B     @RC00428                                            0430 00513000
@RF00428 DS    0H                                                  0431 00514000
*                    CALL MESSAGE(0,MSGID19,CRADDPTR(BLDIX1)->CRADDVAL, 00515000
*                                 LENGTH(CRADDVAL));               0431 00516000
         MVC   @AL00001(16),@AL00431                               0431 00517000
         LR    @14,BLDIX1                                          0431 00518000
         SLA   @14,2                                               0431 00519000
         L     @07,@PC00001+4                                      0431 00520000
         L     @01,FDTPTR+16(,@07)                                 0431 00521000
         AL    @01,@CF01392                                        0431 00522000
         L     @14,CRADDPTR(@14,@01)                               0431 00523000
         LA    @14,CRADDVAL(,@14)                                  0431 00524000
         ST    @14,@AL00001+8                                      0431 00525000
         LA    @01,@AL00001                                        0431 00526000
         BAL   @14,MESSAGE                                         0431 00527000
*                                 /* PRINT BAD JCL MESSAGE           */ 00528000
*                    CRVBADVL=ON; /* INDICATE THAT VOLUME BAD        */ 00529000
         OI    CRVBADVL(CRVEBASE),B'10000000'                      0432 00530000
*                    END;         /*                                 */ 00531000
*                ELSE;            /* ELSE: CONTINUE                  */ 00532000
*                                                                  0434 00533000
@RF00427 DS    0H                                                  0435 00534000
*              /******************************************************/ 00535000
*              /*                                                    */ 00536000
*              /*    HANDLE THE DEVICE TYPE INFORMATION FOR          */ 00537000
*              /*    THIS CRA VOLUME                                 */ 00538000
*              /*                                                    */ 00539000
*              /******************************************************/ 00540000
*                                                                  0435 00541000
*              IF BLDPTR->TMSDTCD=TMSDTCDC                         0435 00542000
*                                 /* IF THE FIELD IS DEVTYPE         */ 00543000
*                THEN CRVTKPCY=BLDPTR->TMSDTTPC;                   0435 00544000
@RC00427 CLC   TMSDTCD(2,BLDPTR),@CH00163                          0435 00545000
         BNE   @RF00435                                            0435 00546000
         MVC   CRVTKPCY(2,CRVEBASE),TMSDTTPC(BLDPTR)               0436 00547000
*                                 /* THEN: SAVE TRACKS PER CYL.      */ 00548000
*                ELSE;            /* ELSE: CONTINUE                  */ 00549000
@RF00435 DS    0H                                                  0438 00550000
*              BLDPTR=BLDPTR+BLDPTR->TMSVSLEN+LENGTH(TMSHDR);      0438 00551000
         LR    @14,BLDPTR                                          0438 00552000
         AH    @14,TMSVSLEN(,BLDPTR)                               0438 00553000
         AH    @14,@CH00043                                        0438 00554000
         LR    BLDPTR,@14                                          0438 00555000
*                                 /* POINT AT THE NEXT FIELD         */ 00556000
*              END;               /*                                 */ 00557000
         LA    @14,1                                               0439 00558000
         AL    @14,BLDIX2                                          0439 00559000
         ST    @14,BLDIX2                                          0439 00560000
         CH    @14,@CH00154                                        0439 00561000
         BNH   @DL00426                                            0439 00562000
*            /********************************************************/ 00563000
*            /*                                                      */ 00564000
*            /*    IF ENTRIES SPECIFIED FOR THIS CRA THEN            */ 00565000
*            /*    CONSTRUCT THE NAME CHAIN                          */ 00566000
*            /*                                                      */ 00567000
*            /********************************************************/ 00568000
*                                                                  0440 00569000
*            IF ENTREPTR(BLDIX1)=NULLPTR                           0440 00570000
*                                 /* IF ENTRIES NOT SPECIFIED        */ 00571000
*              THEN;              /* THEN: CONTINUE                  */ 00572000
         LR    @14,BLDIX1                                          0440 00573000
         SLA   @14,2                                               0440 00574000
         L     @04,@PC00001+4                                      0440 00575000
         L     @04,FDTPTR+28(,@04)                                 0440 00576000
         AL    @04,@CF01392                                        0440 00577000
         L     @14,ENTREPTR(@14,@04)                               0440 00578000
         LTR   @14,@14                                             0440 00579000
         BZ    @RT00440                                            0440 00580000
*              ELSE DO;           /* ELSE:                           */ 00581000
*                DO BLDIX2=1 TO ENTRECNT(BLDIX1);                  0443 00582000
         LA    @14,1                                               0443 00583000
         B     @DE00443                                            0443 00584000
@DL00443 DS    0H                                                  0444 00585000
*                                 /* LOOP TO BUILD ALL THE NAME      */ 00586000
*                                 /* BLOCKS FOR THIS CRA             */ 00587000
*                  CALL BUILDNAM(ENTNMPTR(BLDIX1,BLDIX2)->ENTNMVAL,     00588000
*                                BLDIX2);                          0444 00589000
         LR    @04,BLDIX1                                          0444 00590000
         MH    @04,@CH00762                                        0444 00591000
         ALR   @04,@14                                             0444 00592000
         SLA   @04,2                                               0444 00593000
         L     @14,@PC00001+4                                      0444 00594000
         L     @14,FDTPTR+52(,@14)                                 0444 00595000
         AL    @14,@CF01394                                        0444 00596000
         L     @14,ENTNMPTR(@04,@14)                               0444 00597000
         LA    @14,ENTNMVAL(,@14)                                  0444 00598000
         ST    @14,@AL00001                                        0444 00599000
         LA    @14,BLDIX2                                          0444 00600000
         ST    @14,@AL00001+4                                      0444 00601000
         LA    @01,@AL00001                                        0444 00602000
         BAL   @14,BUILDNAM                                        0444 00603000
*                                 /* GO TO BUILD A NAME BLOCK        */ 00604000
*                  END;           /*                                 */ 00605000
         LA    @14,1                                               0445 00606000
         AL    @14,BLDIX2                                          0445 00607000
@DE00443 ST    @14,BLDIX2                                          0445 00608000
         LR    @04,BLDIX1                                          0445 00609000
         SLA   @04,2                                               0445 00610000
         L     @07,@PC00001+4                                      0445 00611000
         L     @01,FDTPTR+28(,@07)                                 0445 00612000
         AL    @01,@CF01392                                        0445 00613000
         C     @14,ENTRECNT(@04,@01)                               0445 00614000
         BNH   @DL00443                                            0445 00615000
*                END;             /*                                 */ 00616000
*            END;                 /*                                 */ 00617000
*                                                                  0447 00618000
*          /**********************************************************/ 00619000
*          /*                                                        */ 00620000
*          /*    IF INFORMATION FOR THE VOLUME IS NOT OBTAINED       */ 00621000
*          /*    THEN MARK THE VOLUME BAD AND PRINT MESSAGE          */ 00622000
*          /*                                                        */ 00623000
*          /**********************************************************/ 00624000
*                                                                  0448 00625000
*          ELSE DO;               /* ELSE:                           */ 00626000
         B     @RC00423                                            0448 00627000
@RF00423 DS    0H                                                  0449 00628000
*            CALL MESSAGE(0,MSGID19,CRADDPTR(BLDIX1)->CRADDVAL,    0449 00629000
*                         LENGTH(CRADDVAL));                       0449 00630000
         MVC   @AL00001(16),@AL00449                               0449 00631000
         LR    @14,BLDIX1                                          0449 00632000
         SLA   @14,2                                               0449 00633000
         L     @04,@PC00001+4                                      0449 00634000
         L     @04,FDTPTR+16(,@04)                                 0449 00635000
         AL    @04,@CF01392                                        0449 00636000
         L     @14,CRADDPTR(@14,@04)                               0449 00637000
         LA    @14,CRADDVAL(,@14)                                  0449 00638000
         ST    @14,@AL00001+8                                      0449 00639000
         LA    @01,@AL00001                                        0449 00640000
         BAL   @14,MESSAGE                                         0449 00641000
*                                 /* PRINT BAD JCL MESSAGE           */ 00642000
*            CRVBADVL=ON;         /* INDICATE A BAD VOLUME           */ 00643000
         OI    CRVBADVL(CRVEBASE),B'10000000'                      0450 00644000
*            END;                 /*                                 */ 00645000
*        END;                     /*                                 */ 00646000
@RC00423 AH    BLDIX1,@CH00220                                     0452 00647000
@DE00420 L     @14,@PC00001+4                                      0452 00648000
         LA    @14,FDTPTR+12(,@14)                                 0452 00649000
         C     BLDIX1,CRACNT(,@14)                                 0452 00650000
         BNH   @DL00420                                            0452 00651000
*      REG15=LASTCC00;            /* INDICATE ALL IS GOOD            */ 00652000
         SLR   REG15,REG15                                         0453 00653000
*      END;                       /*                                 */ 00654000
*    /****************************************************************/ 00655000
*    /*                                                              */ 00656000
*    /*    IF THE SPACE FOR THE TABLES COUND NOT BE OBTAINED         */ 00657000
*    /*    THEN PRINT INSAFICIENT STORAGE MESSAGE                    */ 00658000
*    /*                                                              */ 00659000
*    /****************************************************************/ 00660000
*                                                                  0455 00661000
*    ELSE DO;                     /* ELSE:                           */ 00662000
         B     @RC00407                                            0455 00663000
@RF00407 DS    0H                                                  0456 00664000
*      REG15=LASTCC12;            /* INDICATE ERROR RETURN           */ 00665000
         LA    REG15,12                                            0456 00666000
*      CORE=BAD;                  /* INDICATE CORE MESSAGE           */ 00667000
         MVC   CORE(1),BAD                                         0457 00668000
*      END;                       /*                                 */ 00669000
*                                                                  0458 00670000
*  RETURN CODE(REG15);            /* RETURN RETURN CODE              */ 00671000
*                                                                  0459 00672000
@RC00407 L     @14,@SA00002                                        0459 00673000
         LM    @00,@12,@SA00002+8                                  0459 00674000
         BR    @14                                                 0459 00675000
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */ 00676000
*                                                                  0460 00677000
*  END BUILDCRV;                  /* END OF PRCOEDURE                */ 00678000
@PB00002 DS    0H                                                  0462 00679000
*  GEN (EJECT);                                                    0462 00680000
         EJECT                                                          00681000
*  /******************************************************************/ 00682000
*  /*                                                                */ 00683000
*  /* PROCEDURE NAME:                                                */ 00684000
*  /*    BUILDNAM                                                    */ 00685000
*  /*                                                                */ 00686000
*  /* FUNCTION:                                                      */ 00687000
*  /*                                                                */ 00688000
*  /*    CONSTRUCT A NAME CHAIN BLOCK FOR THE PROVIDED NAME          */ 00689000
*  /*                                                                */ 00690000
*  /* REQUIREMENTS:                                                  */ 00691000
*  /*                                                                */ 00692000
*  /*    NONE                                                        */ 00693000
*  /*                                                                */ 00694000
*  /******************************************************************/ 00695000
*                                                                  0463 00696000
*BUILDNAM: PROCEDURE (PARMNAM,PARMNOS);                            0463 00697000
*                                                                  0463 00698000
         B     @PB00003                                            0463 00699000
BUILDNAM STM   @14,@12,@SA00003                                    0463 00700000
         MVC   @PC00003(8),0(@01)                                  0463 00701000
*  /******************************************************************/ 00702000
*  /*                                                                */ 00703000
*  /*    INCOMING PARAMETERS FOR THIS ROUTINE                        */ 00704000
*  /*                                                                */ 00705000
*  /******************************************************************/ 00706000
*                                                                  0464 00707000
*  DCL PARMNOS     FIXED(31);     /* NUMBER IN THE ARRAY             */ 00708000
*  DCL PARMNAM     CHAR(*);       /* NAME TO COMPRESS                */ 00709000
*                                                                  0465 00710000
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */ 00711000
*                                                                  0466 00712000
*  /******************************************************************/ 00713000
*  /*                                                                */ 00714000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 00715000
*  /*                                                                */ 00716000
*  /******************************************************************/ 00717000
*                                                                  0467 00718000
*  OLDERID2 = NEWERID2;                                            0467 00719000
         L     @14,@PC00001                                        0467 00720000
         L     @02,GDTTR2(,@14)                                    0467 00721000
         MVC   @TS00001(95),NEWERID2(@02)                          0467 00722000
         MVC   OLDERID2(95,@02),@TS00001                           0467 00723000
*  NEWID2='RC86';                                                  0468 00724000
         MVC   NEWID2(4,@02),@CC01111                              0468 00725000
*  IF GDTDBG = NULLPTR                                             0469 00726000
*    THEN;                                                         0469 00727000
         ICM   @02,15,GDTDBG(@14)                                  0469 00728000
         BZ    @RT00469                                            0469 00729000
*    ELSE                                                          0471 00730000
*      CALL IDCDB010 (GDTTBL,'RC86');                              0471 00731000
         L     @14,@PC00001                                        0471 00732000
         ST    @14,@AL00001                                        0471 00733000
         LA    @02,@CC01111                                        0471 00734000
         ST    @02,@AL00001+4                                      0471 00735000
         MVI   @AL00001+4,X'80'                                    0471 00736000
         L     @15,GDTDBG(,@14)                                    0471 00737000
         LA    @01,@AL00001                                        0471 00738000
         BALR  @14,@15                                             0471 00739000
*  /******************************************************************/ 00740000
*  /*                                                                */ 00741000
*  /*    BUILD THE NAME BLOCK FOR THE NAME CHAIN                     */ 00742000
*  /*                                                                */ 00743000
*  /******************************************************************/ 00744000
*                                                                  0472 00745000
*  CALL SUBSP (GETTYPE,LENGTH(NBLK),NBLKPTR);                      0472 00746000
@RT00469 MVC   @AL00001(8),@AL00472                                0472 00747000
         LA    @14,NBLKPTR                                         0472 00748000
         ST    @14,@AL00001+8                                      0472 00749000
         LA    @01,@AL00001                                        0472 00750000
         BAL   @14,SUBSP                                           0472 00751000
*                                 /* GET SPACE FOR A NAME BLOCK      */ 00752000
*  IF REG15^=LASTCC00             /* IF THERE IS NO STORAGE          */ 00753000
*    THEN REG15=LASTCC12;         /* THEN: INDICATE NO STORAGE       */ 00754000
         LTR   REG15,REG15                                         0473 00755000
         BZ    @RF00473                                            0473 00756000
         LA    REG15,12                                            0474 00757000
*    ELSE DO;                     /* ELSE:                           */ 00758000
         B     @RC00473                                            0475 00759000
@RF00473 DS    0H                                                  0476 00760000
*      NBLKCHN=CRVNAMCH;          /* POINT BLOCK AT THE NAME         */ 00761000
         L     @14,NBLKPTR                                         0476 00762000
         MVC   NBLKCHN(4,@14),CRVNAMCH(CRVEBASE)                   0476 00763000
*                                 /* CHAIN                           */ 00764000
*      CRVNAMCH=NBLKPTR;          /* POINT CRV AT NEW CHAIN          */ 00765000
         ST    @14,CRVNAMCH(,CRVEBASE)                             0477 00766000
*      NBLKENTN=PARMNOS;          /* PLACE NUMBER IN ARRAY           */ 00767000
         L     @02,@PC00003+4                                      0478 00768000
         MVC   NBLKENTN(2,@14),PARMNOS+2(@02)                      0478 00769000
*      NBLKCI=INVALCI;            /* PLACE INVALID CI NUMBER         */ 00770000
         MVC   NBLKCI(3,@14),INVALCI                               0479 00771000
*      NBLKICI=INVALCI;           /* SET INDEX CI INVALID            */ 00772000
         MVC   NBLKICI(3,@14),INVALCI                              0480 00773000
*      NBLKDCI=INVALCI;           /* SET DATA CI INVALID             */ 00774000
         MVC   NBLKDCI(3,@14),INVALCI                              0481 00775000
*      CALL COMPNAME (PARMNAM,NBLKNAME);                           0482 00776000
         L     @02,@PC00003                                        0482 00777000
         ST    @02,@AL00001                                        0482 00778000
         LA    @14,NBLKNAME(,@14)                                  0482 00779000
         ST    @14,@AL00001+4                                      0482 00780000
         LA    @01,@AL00001                                        0482 00781000
         BAL   @14,COMPNAME                                        0482 00782000
*                                 /* PLACE THE NAME POINTER IN       */ 00783000
*                                 /* THE NAME BLOCK                  */ 00784000
*      IF REG15^=LASTCC00         /* IF THERE IS NO STORAGE          */ 00785000
*        THEN REG15=LASTCC12;     /* THEN: INDICATE NO STORAGE       */ 00786000
         LTR   REG15,REG15                                         0483 00787000
         BZ    @RF00483                                            0483 00788000
         LA    REG15,12                                            0484 00789000
*        ELSE;                    /* ELSE: CONTINUE                  */ 00790000
@RF00483 DS    0H                                                  0486 00791000
*      END;                       /*                                 */ 00792000
*                                                                  0486 00793000
*  RETURN CODE(REG15);            /* RETURN THE RETURN CODE          */ 00794000
*                                                                  0487 00795000
@RC00473 L     @14,@SA00003                                        0487 00796000
         LM    @00,@12,@SA00003+8                                  0487 00797000
         BR    @14                                                 0487 00798000
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */ 00799000
*                                                                  0488 00800000
*  END BUILDNAM;                  /* END OF PROCEDURE                */ 00801000
@PB00003 DS    0H                                                  0490 00802000
*  GEN (EJECT);                                                    0490 00803000
         EJECT                                                          00804000
*  /******************************************************************/ 00805000
*  /*                                                                */ 00806000
*  /* PROCEDURE NAME:                                                */ 00807000
*  /*    CKCATNM                                                     */ 00808000
*  /*                                                                */ 00809000
*  /* FUNCTION:                                                      */ 00810000
*  /*                                                                */ 00811000
*  /*    CHECK TO SEE THAT ANY CRA THAT IS OPEN'ED IS FOR THE        */ 00812000
*  /*    SAME CRA AS THE FIRST ONE OPEN'ED                           */ 00813000
*  /*                                                                */ 00814000
*  /* REQUIREMENTS:                                                  */ 00815000
*  /*                                                                */ 00816000
*  /*    1. THE CRV MUST BE BUILT                                    */ 00817000
*  /*                                                                */ 00818000
*  /*    2. THE CRA MUST BE OPEN'ED                                  */ 00819000
*  /*                                                                */ 00820000
*  /******************************************************************/ 00821000
*                                                                  0491 00822000
*CKCATNM: PROCEDURE (CPARM4);                                      0491 00823000
*                                                                  0491 00824000
         B     @PB00004                                            0491 00825000
CKCATNM  STM   @14,@01,@SA00004                                    0491 00826000
         STM   @03,@12,@SA00004+16                                 0491 00827000
         MVC   @PC00004(4),0(@01)                                  0491 00828000
*  DCL CPARM4   PTR(31);          /* INDEX INTO THE CRV              */ 00829000
*                                                                  0492 00830000
*  /******************************************************************/ 00831000
*  /*                                                                */ 00832000
*  /*    VARIABLIES USED IN THIS PROCEDURE                           */ 00833000
*  /*                                                                */ 00834000
*  /******************************************************************/ 00835000
*                                                                  0493 00836000
*  DCL UCBAREA     CHAR(LENGTH(UNITABL));                          0493 00837000
*                                 /* AREA FOR THE UCB ADDRESS        */ 00838000
*  DCL UCBAPTR     PTR(31);       /* ADDRESS OF AREA                 */ 00839000
*                                                                  0494 00840000
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */ 00841000
*                                                                  0495 00842000
*  /******************************************************************/ 00843000
*  /*                                                                */ 00844000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 00845000
*  /*                                                                */ 00846000
*  /******************************************************************/ 00847000
*                                                                  0496 00848000
*  OLDERID2 = NEWERID2;                                            0496 00849000
         L     @14,@PC00001                                        0496 00850000
         L     @07,GDTTR2(,@14)                                    0496 00851000
         MVC   @TS00001(95),NEWERID2(@07)                          0496 00852000
         MVC   OLDERID2(95,@07),@TS00001                           0496 00853000
*  NEWID2='RC93';                                                  0497 00854000
         MVC   NEWID2(4,@07),@CC01122                              0497 00855000
*  IF GDTDBG = NULLPTR                                             0498 00856000
*    THEN;                                                         0498 00857000
         ICM   @07,15,GDTDBG(@14)                                  0498 00858000
         BZ    @RT00498                                            0498 00859000
*    ELSE                                                          0500 00860000
*      CALL IDCDB010 (GDTTBL,'RC93');                              0500 00861000
         L     @14,@PC00001                                        0500 00862000
         ST    @14,@AL00001                                        0500 00863000
         LA    @07,@CC01122                                        0500 00864000
         ST    @07,@AL00001+4                                      0500 00865000
         MVI   @AL00001+4,X'80'                                    0500 00866000
         L     @15,GDTDBG(,@14)                                    0500 00867000
         LA    @01,@AL00001                                        0500 00868000
         BALR  @14,@15                                             0500 00869000
*  /******************************************************************/ 00870000
*  /*                                                                */ 00871000
*  /*    CHECK TO SEE IF THIS CRA HAS ALREADY HAD ITS OWNING         */ 00872000
*  /*    CATALOG CHECKED WITH THE MAJOR OWNING CATALOG               */ 00873000
*  /*                                                                */ 00874000
*  /******************************************************************/ 00875000
*                                                                  0501 00876000
*  IF CRVCATOK=ON                 /* THEN: IF THE CATALOG NAME       */ 00877000
*                                 /*       HAS BEEN CHECKED          */ 00878000
*    THEN;                        /* THEN: CONTINUE                  */ 00879000
*                                                                  0501 00880000
@RT00498 TM    CRVCATOK(CRVEBASE),B'01000000'                      0501 00881000
         BO    @RT00501                                            0501 00882000
*    /****************************************************************/ 00883000
*    /*                                                              */ 00884000
*    /*    READ IN A CRA RECORD SO THAT THE INFORMATION ABOUT        */ 00885000
*    /*    THE OWNING CATALOG CAN BE OBTAINED                        */ 00886000
*    /*                                                              */ 00887000
*    /****************************************************************/ 00888000
*                                                                  0503 00889000
*    ELSE DO;                     /* ELSE:                           */ 00890000
*      IOCRBA=CONCINO0;           /* PLACE RBA OF CI NUMBER 0        */ 00891000
         L     @14,IOCSPTR                                         0504 00892000
         SLR   @07,@07                                             0504 00893000
         ST    @07,IOCRBA(,@14)                                    0504 00894000
*      CALL IDCIOGT0 (GDTTBL,IOCSPTR);                             0505 00895000
         L     @14,@PC00001                                        0505 00896000
         ST    @14,@AL00001                                        0505 00897000
         LA    @07,IOCSPTR                                         0505 00898000
         ST    @07,@AL00001+4                                      0505 00899000
         MVI   @AL00001+4,X'80'                                    0505 00900000
         L     @15,GDTGET(,@14)                                    0505 00901000
         LA    @01,@AL00001                                        0505 00902000
         BALR  @14,@15                                             0505 00903000
*                                 /* GET THE DESIRED RECORD          */ 00904000
*      /**************************************************************/ 00905000
*      /*                                                            */ 00906000
*      /*    IF THERE WAS AN I/O ERROR THEN RETURN AN ERROR          */ 00907000
*      /*    CODE                                                    */ 00908000
*      /*                                                            */ 00909000
*      /**************************************************************/ 00910000
*                                                                  0506 00911000
*      IF REG15^=LASTCC00         /* IF THE WAS AN ERROR             */ 00912000
*        THEN DO;                 /* THEN:                           */ 00913000
         LTR   REG15,REG15                                         0506 00914000
         BZ    @RF00506                                            0506 00915000
*          RSNCD=RSNCD04;         /* SET THE REASON CODE             */ 00916000
         MVC   RSNCD(2),@CC00922                                   0508 00917000
*          ERRNO=ERCDIOER;        /* INDICATE THAT THERE WAS AN      */ 00918000
         LA    ERRNO,12                                            0509 00919000
*                                 /* I/O ERROR IN READING THE        */ 00920000
*                                 /* CRA                             */ 00921000
*          END;                   /*                                 */ 00922000
*        /************************************************************/ 00923000
*        /*                                                          */ 00924000
*        /*    IF THE I/O OPERATION WAS OK THEN CHECK IF THIS        */ 00925000
*        /*    IS TO BE THE OWNING CATALOG BECAUSE IT IS THE         */ 00926000
*        /*    FIRST ONE ENCOUNTERED                                 */ 00927000
*        /*                                                          */ 00928000
*        /************************************************************/ 00929000
*                                                                  0511 00930000
*        ELSE IF CRVCATNL=0       /* ELSE: IF NO OWNING CATALOG      */ 00931000
*                                 /*       NAME YET                  */ 00932000
*        /************************************************************/ 00933000
*        /*                                                          */ 00934000
*        /*    MAKE THIS THE OWNING CATALOG NAME, AND ENQ ON IT      */ 00935000
*        /*                                                          */ 00936000
*        /************************************************************/ 00937000
*                                                                  0511 00938000
*          THEN DO;               /* THEN:                           */ 00939000
         B     @RC00506                                            0511 00940000
@RF00506 L     @14,CRVBASE                                         0511 00941000
         CLI   CRVCATNL(@14),0                                     0511 00942000
         BNE   @RF00511                                            0511 00943000
*            CRVCATNC=RECNAME;    /* PLACE THE OWNING CATALOG        */ 00944000
         L     @01,IOCSPTR                                         0513 00945000
         L     @01,IOCDAD(,@01)                                    0513 00946000
         MVC   CRVCATNC(44,@14),RECNAME(@01)                       0513 00947000
*                                 /* NAME FOR LATTER USE             */ 00948000
*            IF CRVCATNC(21)=' ' /* IF THE NAME IS LESS THAN 21      */ 00949000
*              THEN CRVCATNL=20; /* THEN: SET LENGTH TO 20           */ 00950000
         CLI   CRVCATNC+20(@14),C' '                               0514 00951000
         BNE   @RF00514                                            0514 00952000
         MVI   CRVCATNL(@14),X'14'                                 0515 00953000
*                                /* ------------VS2-----------       */ 00954000
*              ELSE CRVCATNL=LENGTH(CRVCATNC);                     0516 00955000
         B     @RC00514                                            0516 00956000
@RF00514 L     @14,CRVBASE                                         0516 00957000
         MVI   CRVCATNL(@14),X'2C'                                 0516 00958000
*                                 /* ELSE: SET LENGTH OF CAT NAME    */ 00959000
*                                 /* -----------VS2-----------       */ 00960000
*            CRVMAJNM=SYSTEM;                                      0517 00961000
@RC00514 L     @14,CRVBASE                                         0517 00962000
         MVC   CRVMAJNM(8,@14),SYSTEM                              0517 00963000
*                                 /* PLACE 'SYSIGGV2'                */ 00964000
*                                 /* AS THE MAJOR NAME IN            */ 00965000
*                                 /* -----------VS2-----------       */ 00966000
*            UCBAPTR=ADDR(UCBAREA);                                0518 00967000
         LA    @14,UCBAREA                                         0518 00968000
         ST    @14,UCBAPTR                                         0518 00969000
*                                 /* POINT AT THE AREA               */ 00970000
*            CALL IDCSASI0(GDTTBL,UNIT,UCBAPTR,                    0519 00971000
*                     CRADDPTR(CPARM4)->CRADDVAL);                 0519 00972000
         L     @14,@PC00001                                        0519 00973000
         ST    @14,@AL00001                                        0519 00974000
         LA    @07,UNIT                                            0519 00975000
         ST    @07,@AL00001+4                                      0519 00976000
         LA    @07,UCBAPTR                                         0519 00977000
         ST    @07,@AL00001+8                                      0519 00978000
         L     @07,@PC00004                                        0519 00979000
         L     @07,CPARM4(,@07)                                    0519 00980000
         SLA   @07,2                                               0519 00981000
         L     @06,@PC00001+4                                      0519 00982000
         L     @01,FDTPTR+16(,@06)                                 0519 00983000
         AL    @01,@CF01392                                        0519 00984000
         L     @01,CRADDPTR(@07,@01)                               0519 00985000
         LA    @07,CRADDVAL(,@01)                                  0519 00986000
         ST    @07,@AL00001+12                                     0519 00987000
         MVI   @AL00001+12,X'80'                                   0519 00988000
         L     @15,GDTSFO(,@14)                                    0519 00989000
         LA    @01,@AL00001                                        0519 00990000
         BALR  @14,@15                                             0519 00991000
*                                 /* GET THE UCB ADDRESS             */ 00992000
*            IF REG15=LASTCC00    /* IF IT IS RETURNED               */ 00993000
*              THEN DO;           /* THEN:                           */ 00994000
         LTR   REG15,REG15                                         0520 00995000
         BNZ   @RF00520                                            0520 00996000
*                CALL IDCSARV0 (GDTTBL,SHR,WAIT,UCBAPTR->UNITUCB,  0522 00997000
*                          CRVMAJNM,CRVCATNM);                     0522 00998000
         L     @14,@PC00001                                        0522 00999000
         ST    @14,@AL00001                                        0522 01000000
         LA    @07,SHR                                             0522 01001000
         ST    @07,@AL00001+4                                      0522 01002000
         LA    @07,WAIT                                            0522 01003000
         ST    @07,@AL00001+8                                      0522 01004000
         L     @01,UCBAPTR                                         0522 01005000
         ST    @01,@AL00001+12                                     0522 01006000
         L     @07,CRVBASE                                         0522 01007000
         LA    @06,CRVMAJNM(,@07)                                  0522 01008000
         ST    @06,@AL00001+16                                     0522 01009000
         LA    @07,CRVCATNM(,@07)                                  0522 01010000
         ST    @07,@AL00001+20                                     0522 01011000
         MVI   @AL00001+20,X'80'                                   0522 01012000
         L     @15,GDTRSV(,@14)                                    0522 01013000
         LA    @01,@AL00001                                        0522 01014000
         BALR  @14,@15                                             0522 01015000
*                                 /* ENQ ON THE OWNING CATALOG       */ 01016000
*                                 /* ___________VS1___________       */ 01017000
*                END;             /*                                 */ 01018000
*              ELSE DO;           /* ELSE:                           */ 01019000
         B     @RC00520                                            0524 01020000
@RF00520 DS    0H                                                  0525 01021000
*                RSNCD=RSNCD09;   /* INDICATE UCB ERROR              */ 01022000
         MVC   RSNCD(2),@CC00932                                   0525 01023000
*                ERRNO=ERCDIOER;  /* INDICATE I/O ERROR              */ 01024000
         LA    ERRNO,12                                            0526 01025000
*                END;             /*                                 */ 01026000
*            CRVCATOK=ON;         /* INDICATE THAT THIS CRA          */ 01027000
@RC00520 OI    CRVCATOK(CRVEBASE),B'01000000'                      0528 01028000
*                                 /* HAS BEEN CHECKED                */ 01029000
*            END;                 /*                                 */ 01030000
*                                                                  0529 01031000
*          /**********************************************************/ 01032000
*          /*                                                        */ 01033000
*          /*    CHECK TO SEE THAT THIS NAME IS THE SAME AS          */ 01034000
*          /*    THE FIRST ONE ENCOUNTERED                           */ 01035000
*          /*                                                        */ 01036000
*          /**********************************************************/ 01037000
*                                                                  0530 01038000
*          ELSE IF CRVCATNC=RECNAME                                0530 01039000
*                                 /* ELSE: IF THE CATALOG NAME       */ 01040000
*                                 /*       MATCHES THE INUSE         */ 01041000
*            THEN CRVCATOK=ON;                                     0530 01042000
         B     @RC00511                                            0530 01043000
@RF00511 L     @14,IOCSPTR                                         0530 01044000
         L     @14,IOCDAD(,@14)                                    0530 01045000
         L     @01,CRVBASE                                         0530 01046000
         CLC   CRVCATNC(44,@01),RECNAME(@14)                       0530 01047000
         BNE   @RF00530                                            0530 01048000
         OI    CRVCATOK(CRVEBASE),B'01000000'                      0531 01049000
*                                 /* THEN: INDICATE THAT THIS        */ 01050000
*                                 /*       CRA IS OK                 */ 01051000
*            /********************************************************/ 01052000
*            /*                                                      */ 01053000
*            /*    IF THE NAME IS NOT THE SAME THEN PRINT THE        */ 01054000
*            /*    MESSAGES REQUIRED                                 */ 01055000
*            /*                                                      */ 01056000
*            /********************************************************/ 01057000
*                                                                  0532 01058000
*            ELSE DO;             /* ELSE:                           */ 01059000
         B     @RC00530                                            0532 01060000
@RF00530 DS    0H                                                  0533 01061000
*              ERRNO=ERCDCTNM;    /* INDICATE THAT THIS CRA IS       */ 01062000
         LA    ERRNO,16                                            0533 01063000
*                                 /* FOR A DIFFERENT CATALOG         */ 01064000
*              CALL MESSAGE (0,MSGID16,VTTVOLSR(CPARM4),           0534 01065000
*                                 LENGTH(VTTVOLSR));               0534 01066000
         MVC   @AL00001(16),@AL00534                               0534 01067000
         L     @14,@PC00004                                        0534 01068000
         L     @14,CPARM4(,@14)                                    0534 01069000
         MH    @14,@CH00763                                        0534 01070000
         L     @01,CRVBASE                                         0534 01071000
         L     @01,CRVCRAPL(,@01)                                  0534 01072000
         L     @01,ACCVOLTT(,@01)                                  0534 01073000
         AL    @01,@CF01391                                        0534 01074000
         LA    @14,VTTVOLSR-4(@14,@01)                             0534 01075000
         ST    @14,@AL00001+8                                      0534 01076000
         LA    @01,@AL00001                                        0534 01077000
         BAL   @14,MESSAGE                                         0534 01078000
*                                 /* PRINT CRA TO NOT DO             */ 01079000
*              CALL MESSAGE (0,MSGID17,CRVCATNM,                   0535 01080000
*                                 LENGTH(CRVCATNM));               0535 01081000
         MVC   @AL00001(16),@AL00535                               0535 01082000
         L     @14,CRVBASE                                         0535 01083000
         LA    @14,CRVCATNM(,@14)                                  0535 01084000
         ST    @14,@AL00001+8                                      0535 01085000
         LA    @01,@AL00001                                        0535 01086000
         BAL   @14,MESSAGE                                         0535 01087000
*                                 /* PRINT NAME OF CATALOG           */ 01088000
*                                 /* THAT IS BEING DONE              */ 01089000
*              CRVBADVL=ON;       /* INDICATE BAD VOLUME             */ 01090000
         OI    CRVBADVL(CRVEBASE),B'10000000'                      0536 01091000
*              END;               /*                                 */ 01092000
*      END;                       /*                                 */ 01093000
*                                                                  0538 01094000
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */ 01095000
*                                                                  0539 01096000
*  END CKCATNM;                   /* END OF PROCEDURE                */ 01097000
@EL00004 DS    0H                                                  0540 01098000
@EF00004 DS    0H                                                  0540 01099000
@ER00004 LM    @14,@01,@SA00004                                    0540 01100000
         LM    @03,@12,@SA00004+16                                 0540 01101000
         BR    @14                                                 0540 01102000
@PB00004 DS    0H                                                  0541 01103000
*  GEN (EJECT);                                                    0541 01104000
         EJECT                                                          01105000
*  /******************************************************************/ 01106000
*  /*                                                                */ 01107000
*  /* PROCEDURE NAME:                                                */ 01108000
*  /*    CKNAMES                                                     */ 01109000
*  /*                                                                */ 01110000
*  /* FUNCTION:                                                      */ 01111000
*  /*    THIS ROUTINE DOES THE FOLLOWING FUNCTIONS FOR EACH OF       */ 01112000
*  /*    THE NAMES ON THE CRV ENTRY SELECTED AT THE TIME OF THE      */ 01113000
*  /*    CALL-                                                       */ 01114000
*  /*                                                                */ 01115000
*  /*    FOR ALL VSAM OR ALTERNATE INDEXES                           */ 01116000
*  /*                                                                */ 01117000
*  /*    1. COLLECTS THE MASTER PASSWORD AND PLACES IT IN THE        */ 01118000
*  /*       NAME BLOCK.                                              */ 01119000
*  /*                                                                */ 01120000
*  /*    2. INSURES THAT THE NAME IS NOT THAT OF A PAGING DATA       */ 01121000
*  /*       SET.  IF IT IS AND IT WAS SELECTED BY AN 'ENTRIES'       */ 01122000
*  /*       KEYWORD A MESSAGE IS PRINTED TO INDICATE INPROPER        */ 01123000
*  /*       SELECTION, ELSE THE NAME IS SIMPLY BYPASSED.             */ 01124000
*  /*                                                                */ 01125000
*  /*    3. COLLECTS THE DATA AND INDEX ASSOCIATION POINTERS         */ 01126000
*  /*       FOR LATTER USE AND PLACES THEM IN THE NAME BLOCK.        */ 01127000
*  /*                                                                */ 01128000
*  /*    4. MAKES SURE THAT THE DATA LRECL IS SMALLER THAN ANY       */ 01129000
*  /*       PREVIOUS DATA LRECL.  IF IT IS NOT THAN THE DATA         */ 01130000
*  /*       LRECL IS USED AS THE NEW MAXIMUM.                        */ 01131000
*  /*                                                                */ 01132000
*  /*    FOR ALL NON-VSAM DATA SETS:                                 */ 01133000
*  /*                                                                */ 01134000
*  /*    1. INSURES THAT THE NAME IS NOT PART OF A GENERATION        */ 01135000
*  /*       DATA GROUP (GDG).  IF IT IS AND IT WAS SPECIFIED         */ 01136000
*  /*       BY AN 'ENTRIES' KEYWORD A MESSAGE IS PRINTED TO          */ 01137000
*  /*       INDICATE AN IMPROPER SELECTION, ELSE THE NAME IS         */ 01138000
*  /*       SIMPLY BYPASSED.                                         */ 01139000
*  /*                                                                */ 01140000
*  /* REQUIREMENTS:                                                  */ 01141000
*  /*                                                                */ 01142000
*  /*    1. A CRV ENTRY MUST BE SELECTED.                            */ 01143000
*  /*                                                                */ 01144000
*  /******************************************************************/ 01145000
*                                                                  0542 01146000
*CKNAMES: PROCEDURE (KPARM4);                                      0542 01147000
*                                                                  0542 01148000
         B     @PB00005                                            0542 01149000
CKNAMES  STM   @14,@12,@SA00005                                    0542 01150000
         MVC   @PC00005(4),0(@01)                                  0542 01151000
*  /******************************************************************/ 01152000
*  /*                                                                */ 01153000
*  /*    INCOMING PRPAMETER USED BY THIS ROUTINE                     */ 01154000
*  /*                                                                */ 01155000
*  /******************************************************************/ 01156000
*                                                                  0543 01157000
*  DCL KPARM4     FIXED(31);      /* INDEX INTO CRV                  */ 01158000
*  /******************************************************************/ 01159000
*  /*                                                                */ 01160000
*  /*    VARIABLIES USED IN THIS PROCEDURE                           */ 01161000
*  /*                                                                */ 01162000
*  /******************************************************************/ 01163000
*                                                                  0544 01164000
*  DCL KVALA      PTR(31);        /* ADDRESS OF DATA RETURNED        */ 01165000
*  DCL KVALL      FIXED(31);      /* LENGTH OF DATA RETURNED         */ 01166000
*                                                                  0545 01167000
*  DCL KVALD      FIXED(31) BASED(KVALA);                          0546 01168000
*                                 /* RETURNED 4 BYTE FIELD           */ 01169000
*                                                                  0547 01170000
*  DCL KPW        CHAR(8) BASED(KVALA);                            0547 01171000
*                                 /* MASTER PASSWORD FOR ENTRY       */ 01172000
*                                                                  0548 01173000
*  DCL 1 KCHAR    BIT(8) BASED(KVALA),                             0548 01174000
*                                 /* ASSOCIATION TYPE                */ 01175000
*        2 *      BIT(7),         /* UNREFERENCED BITS               */ 01176000
*        2 KPGDS  BIT(1);         /* INDICATES PAGE DATA SET         */ 01177000
*                                                                  0548 01178000
*  DCL KPWINVAL   BIT(64) STATIC INITIAL('FFFFFFFFFFFFFFFF'X);     0549 01179000
*                                 /* NOEXISTENT PASSWORD             */ 01180000
*                                                                  0550 01181000
*  DCL 1 KTYPE    BASED(KVALA),   /* USED FOR TYPE, CI NUMBER        */ 01182000
*        2 KCHART CHAR(1),        /* TYPE OF ASSOCIATION             */ 01183000
*        2 KCINO  FIXED(24);      /* ASSOCIATION'S CI NUMBER         */ 01184000
*                                                                  0550 01185000
*  DCL KRRHDL     FIXED(31) CONSTANT(8);                           0551 01186000
*                                 /* LENGTH OF HEADER        @OZ26756*/ 01187000
*  DCL RRDS       FIXED(15);      /* RRDS OVERHEAD FOR RECORD LENGTH */ 01188000
*                                                          /*@OZ26756*/ 01189000
*                                                                  0553 01190000
*  /******************************************************************/ 01191000
*  /*                                                                */ 01192000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 01193000
*  /*                                                                */ 01194000
*  /******************************************************************/ 01195000
*                                                                  0553 01196000
*  OLDERID2 = NEWERID2;                                            0553 01197000
         L     @04,@PC00001                                        0553 01198000
         L     @02,GDTTR2(,@04)                                    0553 01199000
         MVC   @TS00001(95),NEWERID2(@02)                          0553 01200000
         MVC   OLDERID2(95,@02),@TS00001                           0553 01201000
*  NEWID2='RC99';                                                  0554 01202000
         MVC   NEWID2(4,@02),@CC01143                              0554 01203000
*  IF GDTDBG = NULLPTR                                             0555 01204000
*    THEN;                                                         0555 01205000
         ICM   @02,15,GDTDBG(@04)                                  0555 01206000
         BZ    @RT00555                                            0555 01207000
*    ELSE                                                          0557 01208000
*      CALL IDCDB010 (GDTTBL,'RC99');                              0557 01209000
*                                                                  0557 01210000
         L     @04,@PC00001                                        0557 01211000
         ST    @04,@AL00001                                        0557 01212000
         LA    @02,@CC01143                                        0557 01213000
         ST    @02,@AL00001+4                                      0557 01214000
         MVI   @AL00001+4,X'80'                                    0557 01215000
         L     @15,GDTDBG(,@04)                                    0557 01216000
         LA    @01,@AL00001                                        0557 01217000
         BALR  @14,@15                                             0557 01218000
*  /******************************************************************/ 01219000
*  /*                                                                */ 01220000
*  /*    LOOP THROUGH ALL OF THE NAME BLOCKS ON THE LIST             */ 01221000
*  /*                                                                */ 01222000
*  /******************************************************************/ 01223000
*                                                                  0558 01224000
*  NBLKPTR=CRVNAMCH;              /* POINT AT START OF CHAIN         */ 01225000
@RT00555 MVC   NBLKPTR(4),CRVNAMCH(CRVEBASE)                       0558 01226000
*  DO WHILE NBLKPTR^=NULLPTR;     /* LOOP UNTIL CHAIN IS DONE        */ 01227000
         B     @DE00559                                            0559 01228000
@DL00559 DS    0H                                                  0560 01229000
*    /****************************************************************/ 01230000
*    /*                                                              */ 01231000
*    /*    DO THE FOLLOWING FOR ALL VSAM DATA SETS AND FOR ALL       */ 01232000
*    /*    ALTERNATE INDEXES                                         */ 01233000
*    /*                                                              */ 01234000
*    /****************************************************************/ 01235000
*                                                                  0560 01236000
*    IF NBLKTYPE=CLUSTYPE | NBLKTYPE=AIXTYPE                       0560 01237000
*                                 /* IF CLUSTER OR AIX               */ 01238000
*      THEN DO;                   /* THEN:                           */ 01239000
*                                                                  0560 01240000
         L     @04,NBLKPTR                                         0560 01241000
         CLI   NBLKTYPE(@04),C'C'                                  0560 01242000
         BE    @RT00560                                            0560 01243000
         CLI   NBLKTYPE(@04),C'G'                                  0560 01244000
         BNE   @RF00560                                            0560 01245000
@RT00560 DS    0H                                                  0561 01246000
*        /************************************************************/ 01247000
*        /*                                                          */ 01248000
*        /*    GATHER THE PASSWORDS FOR THE VSAM DATA SETS           */ 01249000
*        /*                                                          */ 01250000
*        /************************************************************/ 01251000
*                                                                  0562 01252000
*        CALL EXTRACT (0,NBLKCI,0,0,KVALA,KVALL,QPASWORD,0);       0562 01253000
         MVC   @AL00001(32),@AL00562                               0562 01254000
         L     @04,NBLKPTR                                         0562 01255000
         LA    @04,NBLKCI(,@04)                                    0562 01256000
         ST    @04,@AL00001+4                                      0562 01257000
         LA    @04,KVALA                                           0562 01258000
         ST    @04,@AL00001+16                                     0562 01259000
         LA    @04,KVALL                                           0562 01260000
         ST    @04,@AL00001+20                                     0562 01261000
         LA    @01,@AL00001                                        0562 01262000
         BAL   @14,EXTRACT                                         0562 01263000
*                                 /* GET THE MASTER PASSWORD         */ 01264000
*        IF KVALA^=NULLPTR & KPW^=KPWINVAL                         0563 01265000
*                                 /* IF PASSWORD RETURNED AND        */ 01266000
*                                 /* IT IS VALID                     */ 01267000
*          THEN DO;               /* THEN:                           */ 01268000
         L     @04,KVALA                                           0563 01269000
         LTR   @04,@04                                             0563 01270000
         BZ    @RF00563                                            0563 01271000
         CLC   KPW(8,@04),KPWINVAL                                 0563 01272000
         BE    @RF00563                                            0563 01273000
*            NBLKPW=KPW;          /* PLACE PASSWORD FOR LATTER       */ 01274000
         L     @02,NBLKPTR                                         0565 01275000
         MVC   NBLKPW(8,@02),KPW(@04)                              0565 01276000
*                                 /* USE                             */ 01277000
*            NBLKPWL=LENGTH(KPW); /* PLACE LENGTH OF PASSWORD        */ 01278000
         MVI   NBLKPWL(@02),X'08'                                  0566 01279000
*                                 /* TO INDICATE PRESENCE            */ 01280000
*            END;                 /*                                 */ 01281000
*          ELSE NBLKPWL=0;        /* ELSE: INDICATE NO PASSWORD      */ 01282000
         B     @RC00563                                            0568 01283000
@RF00563 L     @04,NBLKPTR                                         0568 01284000
         MVI   NBLKPWL(@04),X'00'                                  0568 01285000
*        /************************************************************/ 01286000
*        /*                                                          */ 01287000
*        /*    HANDLE THE FLAGGING OF THE PAGING DATA SETS           */ 01288000
*        /*                                                          */ 01289000
*        /************************************************************/ 01290000
*                                                                  0569 01291000
*        CALL EXTRACT (0,NBLKCI,0,0,KVALA,KVALL,QCATTR,0);         0569 01292000
@RC00563 MVC   @AL00001(32),@AL00569                               0569 01293000
         L     @04,NBLKPTR                                         0569 01294000
         LA    @04,NBLKCI(,@04)                                    0569 01295000
         ST    @04,@AL00001+4                                      0569 01296000
         LA    @04,KVALA                                           0569 01297000
         ST    @04,@AL00001+16                                     0569 01298000
         LA    @04,KVALL                                           0569 01299000
         ST    @04,@AL00001+20                                     0569 01300000
         LA    @01,@AL00001                                        0569 01301000
         BAL   @14,EXTRACT                                         0569 01302000
*                                 /* GET ATTRIBUTE BYTE              */ 01303000
*        IF KVALA^=NULLPTR & KCHAR^=KPWINVAL(1:8) & KPGDS=ON       0570 01304000
*                                 /* IF DATA RETURNED AND IT IS      */ 01305000
*                                 /* VALID DATA AND IT IS A          */ 01306000
*                                 /* PAGING DATA SET                 */ 01307000
*          THEN DO;               /* THEN:                           */ 01308000
         L     @04,KVALA                                           0570 01309000
         SLR   @02,@02                                             0570 01310000
         CR    @04,@02                                             0570 01311000
         BE    @RF00570                                            0570 01312000
         CLC   KCHAR(1,@04),KPWINVAL                               0570 01313000
         BE    @RF00570                                            0570 01314000
         TM    KPGDS(@04),B'00000001'                              0570 01315000
         BNO   @RF00570                                            0570 01316000
*            NBLKBE=ON;           /* INDICATE NO EXPORT              */ 01317000
         L     @04,NBLKPTR                                         0572 01318000
         OI    NBLKBE(@04),B'01000000'                             0572 01319000
*            IF ENTREPTR(KPARM4)=NULLPTR                           0573 01320000
*                                 /* IF NO ENTRIES FOR CRA           */ 01321000
*              THEN;              /* THEN: CONTINUE                  */ 01322000
         L     @04,@PC00005                                        0573 01323000
         L     @04,KPARM4(,@04)                                    0573 01324000
         SLA   @04,2                                               0573 01325000
         L     @15,@PC00001+4                                      0573 01326000
         L     @01,FDTPTR+28(,@15)                                 0573 01327000
         AL    @01,@CF01392                                        0573 01328000
         C     @02,ENTREPTR(@04,@01)                               0573 01329000
         BE    @RT00573                                            0573 01330000
*              ELSE DO;           /* ELSE:                           */ 01331000
*                CALL MESSAGE(0,MSGID3,0,0);                       0576 01332000
         LA    @01,@AL00576                                        0576 01333000
         BAL   @14,MESSAGE                                         0576 01334000
*                                 /* PRINT INVALID TYPE              */ 01335000
*                KVALL=NBLKNAME->DSNAMLEN;                         0577 01336000
         L     @04,NBLKPTR                                         0577 01337000
         L     @04,NBLKNAME(,@04)                                  0577 01338000
         LH    @02,DSNAMLEN(,@04)                                  0577 01339000
         ST    @02,KVALL                                           0577 01340000
*                                 /* GET THE NAME LENGTH             */ 01341000
*                CALL MESSAGE(0,MSGID20,NBLKNAME->DSNAM,KVALL);    0578 01342000
         LA    @02,@CF00116                                        0578 01343000
         ST    @02,@AL00001                                        0578 01344000
         LA    @02,@CH00885                                        0578 01345000
         ST    @02,@AL00001+4                                      0578 01346000
         LA    @04,DSNAM(,@04)                                     0578 01347000
         ST    @04,@AL00001+8                                      0578 01348000
         LA    @04,KVALL                                           0578 01349000
         ST    @04,@AL00001+12                                     0578 01350000
         LA    @01,@AL00001                                        0578 01351000
         BAL   @14,MESSAGE                                         0578 01352000
*                                 /* PRINT THE DSNAME                */ 01353000
*                END;             /*                                 */ 01354000
*            END;                 /*                                 */ 01355000
*          ELSE;                  /* ELSE: CONTINUE                  */ 01356000
@RF00570 DS    0H                                                  0582 01357000
*        /************************************************************/ 01358000
*        /*                                                          */ 01359000
*        /*    HANDLE THE COLLECTION OF THE ASSOCIATION CI           */ 01360000
*        /*    NUMBERS FOR THE VSAM DATA SETS                        */ 01361000
*        /*                                                          */ 01362000
*        /************************************************************/ 01363000
*                                                                  0582 01364000
*        CALL EXTRACT (0,NBLKCI,0,0,KVALA,KVALL,QNAMEDS,0);        0582 01365000
@RC00570 MVC   @AL00001(32),@AL00582                               0582 01366000
         L     @04,NBLKPTR                                         0582 01367000
         LA    @04,NBLKCI(,@04)                                    0582 01368000
         ST    @04,@AL00001+4                                      0582 01369000
         LA    @04,KVALA                                           0582 01370000
         ST    @04,@AL00001+16                                     0582 01371000
         LA    @04,KVALL                                           0582 01372000
         ST    @04,@AL00001+20                                     0582 01373000
         LA    @01,@AL00001                                        0582 01374000
         BAL   @14,EXTRACT                                         0582 01375000
*                                 /* GET THE ASSOCIATIONS            */ 01376000
*        IF KVALA^=NULLPTR        /* IF DATA RETURNED                */ 01377000
*          THEN DO;               /* THEN:                           */ 01378000
         ICM   @04,15,KVALA                                        0583 01379000
         BZ    @RF00583                                            0583 01380000
*            DO WHILE KVALL>0;    /* LOOP THROUGH ALL DATA           */ 01381000
         B     @DE00585                                            0585 01382000
@DL00585 DS    0H                                                  0586 01383000
*              IF KCHART=INDEXTYP /* IF INDEX CI NUMBER              */ 01384000
*                THEN NBLKICI=KCINO;                               0586 01385000
         L     @04,KVALA                                           0586 01386000
         CLI   KCHART(@04),C'I'                                    0586 01387000
         BNE   @RF00586                                            0586 01388000
         L     @02,NBLKPTR                                         0587 01389000
         MVC   NBLKICI(3,@02),KCINO(@04)                           0587 01390000
*                                 /* THEN: SAVE INDEX CI NUMBER      */ 01391000
*                ELSE;            /* ELSE: CONTINUE                  */ 01392000
@RF00586 DS    0H                                                  0589 01393000
*              IF KCHART=DATATYP  /* IF DATA CI NUMBER               */ 01394000
*                THEN NBLKDCI=KCINO;                               0589 01395000
         L     @04,KVALA                                           0589 01396000
         CLI   KCHART(@04),C'D'                                    0589 01397000
         BNE   @RF00589                                            0589 01398000
         L     @02,NBLKPTR                                         0590 01399000
         MVC   NBLKDCI(3,@02),KCINO(@04)                           0590 01400000
*                                 /* THEN: SAVE DATA CI NUMBER       */ 01401000
*                ELSE;            /* ELSE: CONTINUE                  */ 01402000
@RF00589 DS    0H                                                  0592 01403000
*              KVALA=KVALA+LENGTH(KTYPE);                          0592 01404000
         LA    @04,4                                               0592 01405000
         L     @02,KVALA                                           0592 01406000
         ALR   @02,@04                                             0592 01407000
         ST    @02,KVALA                                           0592 01408000
*                                 /* POINT AT NEXT ASSOCIATION       */ 01409000
*              KVALL=KVALL-LENGTH(KTYPE);                          0593 01410000
         LCR   @04,@04                                             0593 01411000
         AL    @04,KVALL                                           0593 01412000
         ST    @04,KVALL                                           0593 01413000
*                                 /* COMPUTE REMAINDER OF SPACE      */ 01414000
*              END;               /*                                 */ 01415000
*                                                                  0594 01416000
@DE00585 ICM   @04,15,KVALL                                        0594 01417000
         BP    @DL00585                                            0594 01418000
*            /********************************************************/ 01419000
*            /*                                                      */ 01420000
*            /*    DETERMINE IF DATA SET IS RRDS TYPE AND IF SO      */ 01421000
*            /*    PUT 4 IN FOR ADDITIONAL RRDS OVERHEAD     @OZ26756*/ 01422000
*            /*                                                      */ 01423000
*            /********************************************************/ 01424000
*                                                                  0595 01425000
*            CALL EXTRACT (0,NBLKDCI,0,0,KVALA,KVALL,QMAMDSB,0);   0595 01426000
         MVC   @AL00001(32),@AL00595                               0595 01427000
         L     @04,NBLKPTR                                         0595 01428000
         LA    @04,NBLKDCI(,@04)                                   0595 01429000
         ST    @04,@AL00001+4                                      0595 01430000
         LA    @04,KVALA                                           0595 01431000
         ST    @04,@AL00001+16                                     0595 01432000
         LA    @04,KVALL                                           0595 01433000
         ST    @04,@AL00001+20                                     0595 01434000
         LA    @01,@AL00001                                        0595 01435000
         BAL   @14,EXTRACT                                         0595 01436000
*                                 /* GET THE AMDSB TO CHECK FOR RRDS */ 01437000
*                                                          /*@OZ26756*/ 01438000
*            IF AMDRRDS = ON                               /*@OZ26756*/ 01439000
*              THEN                                        /*@OZ26756*/ 01440000
         L     @04,KVALA                                           0596 01441000
         TM    AMDRRDS(@04),B'00000010'                            0596 01442000
         BNO   @RF00596                                            0596 01443000
*                RRDS = 4;                                 /*@OZ26756*/ 01444000
         LA    RRDS,4                                              0597 01445000
*              ELSE                                        /*@OZ26756*/ 01446000
*                RRDS = 0;                                 /*@OZ26756*/ 01447000
*                                                                  0598 01448000
         B     @RC00596                                            0598 01449000
@RF00596 SLR   RRDS,RRDS                                           0598 01450000
*            /********************************************************/ 01451000
*            /*                                                      */ 01452000
*            /*    HANDLE THE DETERMINATION OF THE LARGEST           */ 01453000
*            /*    LRECL FOR THESE DATA SETS                         */ 01454000
*            /*                                                      */ 01455000
*            /********************************************************/ 01456000
*                                                                  0599 01457000
*            CALL EXTRACT (0,NBLKDCI,0,0,KVALA,KVALL,QMXLRECL,0);  0599 01458000
@RC00596 MVC   @AL00001(32),@AL00599                               0599 01459000
         L     @04,NBLKPTR                                         0599 01460000
         LA    @04,NBLKDCI(,@04)                                   0599 01461000
         ST    @04,@AL00001+4                                      0599 01462000
         LA    @04,KVALA                                           0599 01463000
         ST    @04,@AL00001+16                                     0599 01464000
         LA    @04,KVALL                                           0599 01465000
         ST    @04,@AL00001+20                                     0599 01466000
         LA    @01,@AL00001                                        0599 01467000
         BAL   @14,EXTRACT                                         0599 01468000
*                                 /* GET THE LRECL FOR THE DATA      */ 01469000
*                                 /* ASSOCIATION                     */ 01470000
*            IF KVALA ^= NULLPTR & (KVALD + KRRHDL + RRDS) > CRVMAXLR   01471000
*                                 /* IF DATA IS RETURNED AND         */ 01472000
*                                 /* IT IS LARGER LRECL      @OZ26756*/ 01473000
*              THEN CRVMAXLR=KVALD + KRRHDL + RRDS;        /*@OZ26756*/ 01474000
         L     @04,KVALA                                           0600 01475000
         LTR   @04,@04                                             0600 01476000
         BZ    @RF00600                                            0600 01477000
         LA    @15,8                                               0600 01478000
         AL    @15,KVALD(,@04)                                     0600 01479000
         ALR   @15,RRDS                                            0600 01480000
         L     @04,CRVBASE                                         0600 01481000
         C     @15,CRVMAXLR(,@04)                                  0600 01482000
         BNH   @RF00600                                            0600 01483000
         ST    @15,CRVMAXLR(,@04)                                  0601 01484000
*                                 /* THEN: PLACE NEW LRECL           */ 01485000
*              ELSE;              /* ELSE: CONTINUE                  */ 01486000
@RF00600 DS    0H                                                  0603 01487000
*            /********************************************************/ 01488000
*            /*                                                      */ 01489000
*            /*    GET THE EMPTY DATA SET INDICATOR                  */ 01490000
*            /*                                                      */ 01491000
*            /********************************************************/ 01492000
*                                                                  0603 01493000
*            CALL EXTRACT(0,NBLKDCI,0,0,KVALA,KVALL,QHURBA,0);     0603 01494000
         MVC   @AL00001(32),@AL00603                               0603 01495000
         L     @04,NBLKPTR                                         0603 01496000
         LA    @04,NBLKDCI(,@04)                                   0603 01497000
         ST    @04,@AL00001+4                                      0603 01498000
         LA    @04,KVALA                                           0603 01499000
         ST    @04,@AL00001+16                                     0603 01500000
         LA    @04,KVALL                                           0603 01501000
         ST    @04,@AL00001+20                                     0603 01502000
         LA    @01,@AL00001                                        0603 01503000
         BAL   @14,EXTRACT                                         0603 01504000
*                                 /* GET THE HIGH USED RBA           */ 01505000
*            IF KVALA^=NULLPTR & KVALD=0                           0604 01506000
*                                 /* IF THERE IS A VALUE AND         */ 01507000
*                                 /* IT IS ZERO                      */ 01508000
*              THEN NBLKMT=ON;    /* THEN: INDICATE EMPTY D.S.       */ 01509000
         L     @04,KVALA                                           0604 01510000
         SLR   @02,@02                                             0604 01511000
         CR    @04,@02                                             0604 01512000
         BE    @RF00604                                            0604 01513000
         C     @02,KVALD(,@04)                                     0604 01514000
         BNE   @RF00604                                            0604 01515000
         L     @04,NBLKPTR                                         0605 01516000
         OI    NBLKMT(@04),B'00010000'                             0605 01517000
*              ELSE;              /* ELSE: CONTINUE                  */ 01518000
@RF00604 DS    0H                                                  0607 01519000
*            END;                 /*                                 */ 01520000
*          ELSE;                  /* ELSE: CONTINUE                  */ 01521000
@RF00583 DS    0H                                                  0609 01522000
*        END;                     /*                                 */ 01523000
*      ELSE;                      /* ELSE: CONTINUE                  */ 01524000
@RF00560 DS    0H                                                  0611 01525000
*    /****************************************************************/ 01526000
*    /*                                                              */ 01527000
*    /*    HANDLE ALL OF THE NON-VSAM NAMES                          */ 01528000
*    /*                                                              */ 01529000
*    /****************************************************************/ 01530000
*                                                                  0611 01531000
*    IF NBLKTYPE=NONVTYPE         /* IF NON-VSAM ENTRY               */ 01532000
*      THEN DO;                   /* THEN:                           */ 01533000
*                                                                  0611 01534000
         L     @04,NBLKPTR                                         0611 01535000
         CLI   NBLKTYPE(@04),C'A'                                  0611 01536000
         BNE   @RF00611                                            0611 01537000
*        /************************************************************/ 01538000
*        /*                                                          */ 01539000
*        /*    HANDLE THE CHECKING OF GDG BASES                      */ 01540000
*        /*                                                          */ 01541000
*        /************************************************************/ 01542000
*                                                                  0613 01543000
*        CALL EXTRACT (1,NBLKCI,0,0,KVALA,KVALL,QTYPE,0,           0613 01544000
*                      QTYPE,EQUAL,0,ADDR(GDGBTYPE),               0613 01545000
*                      LENGTH(GDGBTYPE));                          0613 01546000
         MVC   @AL00001(52),@AL00613                               0613 01547000
         LA    @04,NBLKCI(,@04)                                    0613 01548000
         ST    @04,@AL00001+4                                      0613 01549000
         LA    @04,KVALA                                           0613 01550000
         ST    @04,@AL00001+16                                     0613 01551000
         LA    @04,KVALL                                           0613 01552000
         ST    @04,@AL00001+20                                     0613 01553000
         LA    @04,@CC00860                                        0613 01554000
         ST    @04,@AFTEMPS+4                                      0613 01555000
         LA    @04,@AFTEMPS+4                                      0613 01556000
         ST    @04,@AL00001+44                                     0613 01557000
         LA    @01,@AL00001                                        0613 01558000
         BAL   @14,EXTRACT                                         0613 01559000
*                                 /* GET THE GDG ASSOCIATION IF      */ 01560000
*                                 /* THERE IS ONE                    */ 01561000
*        IF KVALA^=NULLPTR & KCHAR=GDGBTYPE                        0614 01562000
*                                 /* IF DATA RETURNED AND IT         */ 01563000
*                                 /* IS FOR A GDGBASE                */ 01564000
*          THEN DO;               /* THEN:                           */ 01565000
         L     @04,KVALA                                           0614 01566000
         SLR   @02,@02                                             0614 01567000
         CR    @04,@02                                             0614 01568000
         BE    @RF00614                                            0614 01569000
         CLI   KCHAR(@04),C'B'                                     0614 01570000
         BNE   @RF00614                                            0614 01571000
*            NBLKBE=ON;           /* INDICATE NO EXPORT              */ 01572000
         L     @04,NBLKPTR                                         0616 01573000
         OI    NBLKBE(@04),B'01000000'                             0616 01574000
*            IF ENTREPTR(KPARM4)=NULLPTR                           0617 01575000
*                                 /* IF ENTRIES FOR THIS CRA         */ 01576000
*              THEN;              /* THEN: CONTINUE                  */ 01577000
         L     @04,@PC00005                                        0617 01578000
         L     @04,KPARM4(,@04)                                    0617 01579000
         SLA   @04,2                                               0617 01580000
         L     @15,@PC00001+4                                      0617 01581000
         L     @01,FDTPTR+28(,@15)                                 0617 01582000
         AL    @01,@CF01392                                        0617 01583000
         C     @02,ENTREPTR(@04,@01)                               0617 01584000
         BE    @RT00617                                            0617 01585000
*              ELSE DO;           /* ELSE:                           */ 01586000
*                CALL MESSAGE(0,MSGID3,0,0);                       0620 01587000
         LA    @01,@AL00620                                        0620 01588000
         BAL   @14,MESSAGE                                         0620 01589000
*                                 /* PRINT INVALID TYPE              */ 01590000
*                KVALL=NBLKNAME->DSNAMLEN;                         0621 01591000
         L     @04,NBLKPTR                                         0621 01592000
         L     @04,NBLKNAME(,@04)                                  0621 01593000
         LH    @02,DSNAMLEN(,@04)                                  0621 01594000
         ST    @02,KVALL                                           0621 01595000
*                                 /* GET THE NAME LENGTH             */ 01596000
*                CALL MESSAGE(0,MSGID20,NBLKNAME->DSNAM,KVALL);    0622 01597000
         LA    @02,@CF00116                                        0622 01598000
         ST    @02,@AL00001                                        0622 01599000
         LA    @02,@CH00885                                        0622 01600000
         ST    @02,@AL00001+4                                      0622 01601000
         LA    @04,DSNAM(,@04)                                     0622 01602000
         ST    @04,@AL00001+8                                      0622 01603000
         LA    @04,KVALL                                           0622 01604000
         ST    @04,@AL00001+12                                     0622 01605000
         LA    @01,@AL00001                                        0622 01606000
         BAL   @14,MESSAGE                                         0622 01607000
*                                 /* PRINT THE DSNAME                */ 01608000
*                END;             /*                                 */ 01609000
*            END;                 /*                                 */ 01610000
*          ELSE;                  /* ELSE: CONTINUE                  */ 01611000
@RF00614 DS    0H                                                  0626 01612000
*        END;                     /*                                 */ 01613000
*      ELSE;                      /* ELSE: CONTINUE                  */ 01614000
*                                                                  0627 01615000
@RF00611 DS    0H                                                  0628 01616000
*    NBLKPTR=NBLKCHN;             /* POINT AT THE NEXT ENTRY         */ 01617000
@RC00611 L     @04,NBLKPTR                                         0628 01618000
         L     @04,NBLKCHN(,@04)                                   0628 01619000
         ST    @04,NBLKPTR                                         0628 01620000
*    END;                         /*                                 */ 01621000
@DE00559 ICM   @04,15,NBLKPTR                                      0629 01622000
         BNZ   @DL00559                                            0629 01623000
*  END CKNAMES;                   /* END OF PROCEDURE                */ 01624000
@EL00005 DS    0H                                                  0630 01625000
@EF00005 DS    0H                                                  0630 01626000
@ER00005 LM    @14,@12,@SA00005                                    0630 01627000
         BR    @14                                                 0630 01628000
@PB00005 DS    0H                                                  0631 01629000
*  GEN (EJECT);                                                    0631 01630000
         EJECT                                                          01631000
*  /******************************************************************/ 01632000
*  /*                                                                */ 01633000
*  /* PROCEDURE NAME:                                                */ 01634000
*  /*    COMPNAME                                                    */ 01635000
*  /*                                                                */ 01636000
*  /* FUNCTION:                                                      */ 01637000
*  /*                                                                */ 01638000
*  /*    COMPRESSS THE NAME PROVIDED FROM THE 44 CHARACTERS          */ 01639000
*  /*    WITH TRAILING BLANKS TO SOMETHING LESS WITH NO TRAIL-       */ 01640000
*  /*    ING BLANKS                                                  */ 01641000
*  /*                                                                */ 01642000
*  /* REQUIREMENTS:                                                  */ 01643000
*  /*                                                                */ 01644000
*  /*    NONE                                                        */ 01645000
*  /*                                                                */ 01646000
*  /******************************************************************/ 01647000
*                                                                  0632 01648000
*COMPNAME: PROCEDURE (PARMDSN,DSNAMPTR);                           0632 01649000
*                                                                  0632 01650000
         B     @PB00006                                            0632 01651000
COMPNAME STM   @14,@12,@SA00006                                    0632 01652000
         MVC   @PC00006(8),0(@01)                                  0632 01653000
*  DCL PARMDSN        CHAR(44);   /* INPUT UNCOMPRESSED NAME         */ 01654000
*  DCL DSNAMPTR       PTR(31);    /* ADDRESS OF COMPRESSED NAME      */ 01655000
*                                 /* BLOCK                           */ 01656000
*                                                                  0635 01657000
*  DCL INDEX1         FIXED(31);  /* COUNTER FOR THE COMPRESSOR      */ 01658000
*  DCL INDEX2         FIXED(31);  /* LENGTH OF COMPRESSED NAME       */ 01659000
*                                                                  0636 01660000
*  RFY REG15 RSTD;                /* RSTRICT THE REGISTER            */ 01661000
*                                                                  0637 01662000
*  /******************************************************************/ 01663000
*  /*                                                                */ 01664000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 01665000
*  /*                                                                */ 01666000
*  /******************************************************************/ 01667000
*                                                                  0638 01668000
*  OLDERID2 = NEWERID2;                                            0638 01669000
         L     @14,@PC00001                                        0638 01670000
         L     @07,GDTTR2(,@14)                                    0638 01671000
         MVC   @TS00001(95),NEWERID2(@07)                          0638 01672000
         MVC   OLDERID2(95,@07),@TS00001                           0638 01673000
*  NEWID2='RC87';                                                  0639 01674000
         MVC   NEWID2(4,@07),@CC01154                              0639 01675000
*  IF GDTDBG = NULLPTR                                             0640 01676000
*    THEN;                                                         0640 01677000
         ICM   @07,15,GDTDBG(@14)                                  0640 01678000
         BZ    @RT00640                                            0640 01679000
*    ELSE                                                          0642 01680000
*      CALL IDCDB010 (GDTTBL,'RC87');                              0642 01681000
         L     @14,@PC00001                                        0642 01682000
         ST    @14,@AL00001                                        0642 01683000
         LA    @07,@CC01154                                        0642 01684000
         ST    @07,@AL00001+4                                      0642 01685000
         MVI   @AL00001+4,X'80'                                    0642 01686000
         L     @15,GDTDBG(,@14)                                    0642 01687000
         LA    @01,@AL00001                                        0642 01688000
         BALR  @14,@15                                             0642 01689000
*  /******************************************************************/ 01690000
*  /*                                                                */ 01691000
*  /*    COMPRESS THE BLANKS FROM THE RIGHT OF THE NAME AND          */ 01692000
*  /*    OBTAIN SPACE TO HOLD THE COMPRESSED NAME                    */ 01693000
*  /*                                                                */ 01694000
*  /******************************************************************/ 01695000
*                                                                  0643 01696000
*  INDEX2=LENGTH(PARMDSN);        /* SET INDEX TO LAST CHAR-         */ 01697000
@RT00640 LA    INDEX2,44                                           0643 01698000
*                                 /* ACTER OF THE NAME               */ 01699000
*  DO INDEX1=1 TO (LENGTH(PARMDSN)-1) WHILE PARMDSN(INDEX2)=' ';   0644 01700000
         LA    INDEX1,1                                            0644 01701000
@DL00644 L     @14,@PC00006                                        0644 01702000
         ALR   @14,INDEX2                                          0644 01703000
         BCTR  @14,0                                               0644 01704000
         CLI   PARMDSN(@14),C' '                                   0644 01705000
         BNE   @DC00644                                            0644 01706000
*                                 /* LOOP UNTIL RIGHTMOST NON-       */ 01707000
*                                 /* BLANK IS FOUND                  */ 01708000
*    INDEX2=INDEX2-1;             /* DECREMENT TO THE NEXT           */ 01709000
         BCTR  INDEX2,0                                            0645 01710000
*                                 /* CHARACTER LEFT                  */ 01711000
*    END;                         /*                                 */ 01712000
         AL    INDEX1,@CF00220                                     0646 01713000
         CH    INDEX1,@CH01379                                     0646 01714000
         BNH   @DL00644                                            0646 01715000
@DC00644 DS    0H                                                  0647 01716000
*  CALL SUBSP(GETTYPE,INDEX2+LENGTH(DSNAMLEN),DSNAMPTR);           0647 01717000
         LA    @14,@CC00849                                        0647 01718000
         ST    @14,@AL00001                                        0647 01719000
         LA    @14,2                                               0647 01720000
         ALR   @14,INDEX2                                          0647 01721000
         ST    @14,@AFTEMPS+8                                      0647 01722000
         LA    @14,@AFTEMPS+8                                      0647 01723000
         ST    @14,@AL00001+4                                      0647 01724000
         L     @14,@PC00006+4                                      0647 01725000
         ST    @14,@AL00001+8                                      0647 01726000
         LA    @01,@AL00001                                        0647 01727000
         BAL   @14,SUBSP                                           0647 01728000
*                                 /* GET THE SPACE FOR THE NAME      */ 01729000
*                                                                  0648 01730000
*  /******************************************************************/ 01731000
*  /*                                                                */ 01732000
*  /*    IF EVERY THING IS OK, PLACE THE COMPRESSED NAME IN          */ 01733000
*  /*    THE SPACE OBTAINED FOR IT                                   */ 01734000
*  /*                                                                */ 01735000
*  /******************************************************************/ 01736000
*                                                                  0648 01737000
*  IF REG15^=LASTCC00             /* IF THERE IS NO SPACE            */ 01738000
*    THEN REG15=LASTCC12;         /* THEN: SET RETURN CODE           */ 01739000
         LTR   REG15,REG15                                         0648 01740000
         BZ    @RF00648                                            0648 01741000
         LA    REG15,12                                            0649 01742000
*    ELSE DO;                     /* ELSE:                           */ 01743000
         B     @RC00648                                            0650 01744000
@RF00648 DS    0H                                                  0651 01745000
*      DSNAMPTR->DSNAM(1:INDEX2)=PARMDSN(1:INDEX2);                0651 01746000
         L     @14,@PC00006+4                                      0651 01747000
         L     @14,DSNAMPTR(,@14)                                  0651 01748000
         LR    @03,INDEX2                                          0651 01749000
         BCTR  @03,0                                               0651 01750000
         L     @07,@PC00006                                        0651 01751000
         EX    @03,@SM01397                                        0651 01752000
*                                 /* PLACE THE NAME IN THE AREA      */ 01753000
*                                 /* PROVIDED                        */ 01754000
*      DSNAMPTR->DSNAMLEN=INDEX2; /* SAVE THE LENGTH OF THE          */ 01755000
         STH   INDEX2,DSNAMLEN(,@14)                               0652 01756000
*                                 /* COMPRESSED NAME                 */ 01757000
*      END;                       /*                                 */ 01758000
*                                                                  0653 01759000
*  RETURN CODE(REG15);            /* PASS THE RETURN CODE            */ 01760000
*                                                                  0654 01761000
@RC00648 L     @14,@SA00006                                        0654 01762000
         LM    @00,@12,@SA00006+8                                  0654 01763000
         BR    @14                                                 0654 01764000
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */ 01765000
*                                                                  0655 01766000
*  END COMPNAME;                  /* END OF PROCEDURE                */ 01767000
@PB00006 DS    0H                                                  0657 01768000
*  GEN (EJECT);                                                    0657 01769000
         EJECT                                                          01770000
*  /******************************************************************/ 01771000
*  /*                                                                */ 01772000
*  /* PROCEDURE NAME:                                                */ 01773000
*  /*    DIRECT                                                      */ 01774000
*  /*                                                                */ 01775000
*  /* FUNCTION:                                                      */ 01776000
*  /*    THIS ROUTINE OBTAINS SPACE FOR THE DIRECTORY INFOR-         */ 01777000
*  /*    MATION FROM THIS CRA.                                       */ 01778000
*  /*                                                                */ 01779000
*  /* REQUIREMENTS:                                                  */ 01780000
*  /*                                                                */ 01781000
*  /*    THE CORRECT CRV ENTRY MUST BE POINTED AT PREVIOUS TO        */ 01782000
*  /*    THE CALL.                                                   */ 01783000
*  /*                                                                */ 01784000
*  /******************************************************************/ 01785000
*                                                                  0658 01786000
*DIRECT: PROCEDURE;                                                0658 01787000
*                                                                  0658 01788000
         B     @PB00007                                            0658 01789000
DIRECT   STM   @14,@01,@SA00007                                    0658 01790000
         STM   @03,@12,@SA00007+16                                 0658 01791000
*  /******************************************************************/ 01792000
*  /*                                                                */ 01793000
*  /*    VARIABLIES USED IN THIS PROCEDURE                           */ 01794000
*  /*                                                                */ 01795000
*  /******************************************************************/ 01796000
*                                                                  0659 01797000
*  DCL OUTAD         PTR(31);     /* ADDRESS OF DATA RECIEVED        */ 01798000
*                                                                  0659 01799000
*  DCL OUTLNG        FIXED(31);   /* LENGTH OF DATA RECIEVED         */ 01800000
*                                                                  0660 01801000
*  DCL GRPCD8        BIT(8) CONSTANT('08'X);                       0661 01802000
*                                 /* DIRECTORY ENTRY GROUP CODE      */ 01803000
*                                                                  0662 01804000
*  DCL DIRCNT        FIXED(15) BASED(OUTAD);                       0662 01805000
*                                 /* HIGHEST SEQUENCE NUMBER         */ 01806000
*                                 /* FOR DIRECTORY ENTRYS            */ 01807000
*                                                                  0663 01808000
*  DCL DIRSIZE       FIXED(31);   /* SIZE OF DIRECTORY TO GET        */ 01809000
*                                                                  0663 01810000
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */ 01811000
*                                                                  0664 01812000
*  /******************************************************************/ 01813000
*  /*                                                                */ 01814000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 01815000
*  /*                                                                */ 01816000
*  /******************************************************************/ 01817000
*                                                                  0665 01818000
*  OLDERID2 = NEWERID2;                                            0665 01819000
         L     @14,@PC00001                                        0665 01820000
         L     @04,GDTTR2(,@14)                                    0665 01821000
         MVC   @TS00001(95),NEWERID2(@04)                          0665 01822000
         MVC   OLDERID2(95,@04),@TS00001                           0665 01823000
*  NEWID2='RC98';                                                  0666 01824000
         MVC   NEWID2(4,@04),@CC01165                              0666 01825000
*  IF GDTDBG = NULLPTR                                             0667 01826000
*    THEN;                                                         0667 01827000
         ICM   @04,15,GDTDBG(@14)                                  0667 01828000
         BZ    @RT00667                                            0667 01829000
*    ELSE                                                          0669 01830000
*      CALL IDCDB010 (GDTTBL,'RC98');                              0669 01831000
         L     @14,@PC00001                                        0669 01832000
         ST    @14,@AL00001                                        0669 01833000
         LA    @04,@CC01165                                        0669 01834000
         ST    @04,@AL00001+4                                      0669 01835000
         MVI   @AL00001+4,X'80'                                    0669 01836000
         L     @15,GDTDBG(,@14)                                    0669 01837000
         LA    @01,@AL00001                                        0669 01838000
         BALR  @14,@15                                             0669 01839000
*  /******************************************************************/ 01840000
*  /*                                                                */ 01841000
*  /*    IF THERE IS NO PREVIOUS ERROR OR THE DIRECTORY HAS          */ 01842000
*  /*    NOT BEEN PREVIOUSLY BEEN CONSTRUCTED, CONSTRUCT THE         */ 01843000
*  /*    DIRECTORY FOR THIS CRV ENTRY                                */ 01844000
*  /*                                                                */ 01845000
*  /******************************************************************/ 01846000
*                                                                  0670 01847000
*  IF ERRNO=ERCDNRML & CRVDIREC=NULLPTR                            0670 01848000
*                                 /* IF THERE IS NO ERROR AND        */ 01849000
*                                 /* THE DIRECTORY HAS NOT BEEN      */ 01850000
*                                 /* BEFORE                          */ 01851000
*                                                                  0670 01852000
*    /****************************************************************/ 01853000
*    /*                                                              */ 01854000
*    /*    FIND THE NUMBER OF DIRECTORY ENTRIES                      */ 01855000
*    /*                                                              */ 01856000
*    /****************************************************************/ 01857000
*                                                                  0670 01858000
*    THEN DO;                     /* THEN:                           */ 01859000
@RT00667 SLR   @14,@14                                             0670 01860000
         CR    ERRNO,@14                                           0670 01861000
         BNE   @RF00670                                            0670 01862000
         C     @14,CRVDIREC(,CRVEBASE)                             0670 01863000
         BNE   @RF00670                                            0670 01864000
*      CALL EXTRACT(0,CTTCATCI(VOLRECCI-BEGINCI+1),0,0,            0672 01865000
*                   OUTAD,OUTLNG,QREPNO,GRPCD8);                   0672 01866000
         MVC   @AL00001(32),@AL00672                               0672 01867000
         L     @14,CRVADCTT(,CRVEBASE)                             0672 01868000
         LA    @14,CTTCATCI(,@14)                                  0672 01869000
         ST    @14,@AL00001+4                                      0672 01870000
         LA    @14,OUTAD                                           0672 01871000
         ST    @14,@AL00001+16                                     0672 01872000
         LA    @14,OUTLNG                                          0672 01873000
         ST    @14,@AL00001+20                                     0672 01874000
         LA    @01,@AL00001                                        0672 01875000
         BAL   @14,EXTRACT                                         0672 01876000
*                                 /* GET THE HIGHEST SEQUENCE        */ 01877000
*                                 /* NUMBER OF THE DIRECTORY         */ 01878000
*      IF OUTAD^=NULLPTR & DIRCNT^=0                               0673 01879000
*                                 /* IF DATA RETURNED AND IT IS      */ 01880000
*                                 /* A REAL VALUE                    */ 01881000
*        THEN DO;                 /* THEN:                           */ 01882000
         L     @14,OUTAD                                           0673 01883000
         SLR   @04,@04                                             0673 01884000
         CR    @14,@04                                             0673 01885000
         BE    @RF00673                                            0673 01886000
         LH    @14,DIRCNT(,@14)                                    0673 01887000
         CR    @14,@04                                             0673 01888000
         BE    @RF00673                                            0673 01889000
*          DIRSIZE=LENGTH(DIRECTY)*(DIRCNT)+LENGTH(DIRLENU);       0675 01890000
         LR    @04,@14                                             0675 01891000
         MH    @04,@CH00038                                        0675 01892000
         AH    @04,@CH00154                                        0675 01893000
         ST    @04,DIRSIZE                                         0675 01894000
*                                 /* COUMPUT THE SIZE OF BLOCK       */ 01895000
*                                 /* PLUS OVERHEAD                   */ 01896000
*          CRVHIREP=DIRCNT;       /* SAVE THE NUMBER IF              */ 01897000
         STH   @14,CRVHIREP(,CRVEBASE)                             0676 01898000
*                                 /* DIRECTORY ENTRIES               */ 01899000
*                                                                  0677 01900000
*          /**********************************************************/ 01901000
*          /*                                                        */ 01902000
*          /*    GET THE DIRECTORY ENTRIES                           */ 01903000
*          /*                                                        */ 01904000
*          /**********************************************************/ 01905000
*                                                                  0677 01906000
*          CALL IDCSAGP0(GDTTBL,DIRSIZE,CRVDIREC,COREID3,SETZERO); 0677 01907000
         L     @14,@PC00001                                        0677 01908000
         ST    @14,@AL00001                                        0677 01909000
         LA    @04,DIRSIZE                                         0677 01910000
         ST    @04,@AL00001+4                                      0677 01911000
         LA    @04,CRVDIREC(,CRVEBASE)                             0677 01912000
         ST    @04,@AL00001+8                                      0677 01913000
         LA    @04,@CC00833                                        0677 01914000
         ST    @04,@AL00001+12                                     0677 01915000
         LA    @04,SETZERO                                         0677 01916000
         ST    @04,@AL00001+16                                     0677 01917000
         MVI   @AL00001+16,X'80'                                   0677 01918000
         L     @15,GDTGPL(,@14)                                    0677 01919000
         LA    @01,@AL00001                                        0677 01920000
         BALR  @14,@15                                             0677 01921000
*                                 /* GET THE SPACE FOR THE           */ 01922000
*                                 /* DIRECTORY                       */ 01923000
*          IF REG15=LASTCC00      /* IF THERE IS NO ERROR            */ 01924000
*            THEN DO;             /* THEN:                           */ 01925000
         LTR   REG15,REG15                                         0678 01926000
         BNZ   @RF00678                                            0678 01927000
*              CALL EXTRACT(0,CTTCATCI(VOLRECCI-BEGINCI+1),        0680 01928000
*                           CRVDIREC,DIRSIZE,                      0680 01929000
*                           CRVDIREC,OUTLNG,QDSDRRPM,0);   /*@OZ25037*/ 01930000
         LA    @14,@CF00116                                        0680 01931000
         ST    @14,@AL00001                                        0680 01932000
         L     @14,CRVADCTT(,CRVEBASE)                             0680 01933000
         LA    @14,CTTCATCI(,@14)                                  0680 01934000
         ST    @14,@AL00001+4                                      0680 01935000
         LA    @14,CRVDIREC(,CRVEBASE)                             0680 01936000
         ST    @14,@AL00001+8                                      0680 01937000
         LA    @14,DIRSIZE                                         0680 01938000
         ST    @14,@AL00001+12                                     0680 01939000
         LA    @14,CRVDIREC(,CRVEBASE)                             0680 01940000
         ST    @14,@AL00001+16                                     0680 01941000
         LA    @14,OUTLNG                                          0680 01942000
         ST    @14,@AL00001+20                                     0680 01943000
         LA    @14,QDSDRRPM                                        0680 01944000
         ST    @14,@AL00001+24                                     0680 01945000
         LA    @14,@CF00116                                        0680 01946000
         ST    @14,@AL00001+28                                     0680 01947000
         LA    @01,@AL00001                                        0680 01948000
         BAL   @14,EXTRACT                                         0680 01949000
*                                 /* BRING IN THE DIRECTORY          */ 01950000
*              /******************************************************/ 01951000
*              /*                                                    */ 01952000
*              /*    HANDLE THE REASON CODE FOR THE ERROR IF         */ 01953000
*              /*    THERE WAS AN ERROR                              */ 01954000
*              /*                                                    */ 01955000
*              /******************************************************/ 01956000
*                                                                  0681 01957000
*              IF CRVDIREC=NULLPTR/* IF NO DATA RETURNED             */ 01958000
*                THEN DO;         /* THEN:                           */ 01959000
         SLR   @14,@14                                             0681 01960000
         C     @14,CRVDIREC(,CRVEBASE)                             0681 01961000
         BNE   @RF00681                                            0681 01962000
*                  IF FRC^=NULLPTR/* IF FORCE SPECIFIED              */ 01963000
*                    THEN;        /* THEN: CONTINUE                  */ 01964000
         L     @07,@PC00001+4                                      0683 01965000
         L     @01,FDTPTR(,@07)                                    0683 01966000
         C     @14,FRC(,@01)                                       0683 01967000
         BNE   @RT00683                                            0683 01968000
*                    ELSE DO;     /* ELSE:                           */ 01969000
*                      RSNCD=RSNCD08;                              0686 01970000
         MVC   RSNCD(2),@CC00930                                   0686 01971000
*                                 /* INDICATE THE ERROR TYPE         */ 01972000
*                      CRVDIRER=ON;                                0687 01973000
         OI    CRVDIRER(CRVEBASE),B'00001000'                      0687 01974000
*                                 /* INDICATE DIRECTORY ERROR        */ 01975000
*                      ERRNO=ERCDFMDT;                             0688 01976000
         LA    ERRNO,32                                            0688 01977000
*                                 /* INDICATE NO DATA FOUND          */ 01978000
*                      END;       /*                                 */ 01979000
*                  END;           /*                                 */ 01980000
*                ELSE;            /* ELSE: CONTINUE                  */ 01981000
@RF00681 DS    0H                                                  0692 01982000
*              END;               /*                                 */ 01983000
*            ELSE DO;             /* ELSE:                           */ 01984000
         B     @RC00678                                            0693 01985000
@RF00678 DS    0H                                                  0694 01986000
*              ERRNO=ERCDNSTR;    /* INDICATE NO STORAGE             */ 01987000
         LA    ERRNO,28                                            0694 01988000
*              CORE=BAD;          /* INDICATE CORE MESSAGE           */ 01989000
         MVC   CORE(1),BAD                                         0695 01990000
*              END;               /*                                 */ 01991000
*          END;                   /*                                 */ 01992000
*                                                                  0697 01993000
*        /************************************************************/ 01994000
*        /*                                                          */ 01995000
*        /*    HANDLE THE REASON CODE FOR NO NUMBER OF DIREC-        */ 01996000
*        /*    TORY ENTRIES                                          */ 01997000
*        /*                                                          */ 01998000
*        /************************************************************/ 01999000
*                                                                  0698 02000000
*        ELSE DO;                 /* ELSE:                           */ 02001000
         B     @RC00673                                            0698 02002000
@RF00673 DS    0H                                                  0699 02003000
*          IF FRC^=NULLPTR        /* IF FORCE SPECIFIED              */ 02004000
*            THEN;                /* THEN: CONTINUE                  */ 02005000
         L     @14,@PC00001+4                                      0699 02006000
         L     @14,FDTPTR(,@14)                                    0699 02007000
         ICM   @07,15,FRC(@14)                                     0699 02008000
         BNZ   @RT00699                                            0699 02009000
*            ELSE DO;             /* ELSE:                           */ 02010000
*              RSNCD=RSNCD07;     /* INDICATE THE ERROR TYPE         */ 02011000
         MVC   RSNCD(2),@CC00928                                   0702 02012000
*              CRVDIRER=ON;       /* INDICATE DIRECTORY ERROR        */ 02013000
         OI    CRVDIRER(CRVEBASE),B'00001000'                      0703 02014000
*              ERRNO=ERCDFMDT;    /* INDICATE NO DATA FOUND          */ 02015000
         LA    ERRNO,32                                            0704 02016000
*              END;               /*                                 */ 02017000
*          END;                   /*                                 */ 02018000
*      END;                       /*                                 */ 02019000
*    ELSE;                        /* ELSE: CONTINUE                  */ 02020000
*                                                                  0708 02021000
@RF00670 DS    0H                                                  0709 02022000
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */ 02023000
*                                                                  0709 02024000
*  END DIRECT;                    /* END OF PROCEDURE                */ 02025000
@EL00007 DS    0H                                                  0710 02026000
@EF00007 DS    0H                                                  0710 02027000
@ER00007 LM    @14,@01,@SA00007                                    0710 02028000
         LM    @03,@12,@SA00007+16                                 0710 02029000
         BR    @14                                                 0710 02030000
@PB00007 DS    0H                                                  0711 02031000
*  GEN (EJECT);                                                    0711 02032000
         EJECT                                                          02033000
*  /******************************************************************/ 02034000
*  /*                                                                */ 02035000
*  /* PROCEDURE NAME:                                                */ 02036000
*  /*    DUPNAMCK                                                    */ 02037000
*  /*                                                                */ 02038000
*  /* FUNCTION:                                                      */ 02039000
*  /*                                                                */ 02040000
*  /*    INSURE THAT ANY NAMES SKIPPED BECAUSE THEY ARE DUPLI-       */ 02041000
*  /*    CATIONS OF SOME OTHER NAMES ARE PRINTED TO INFORM           */ 02042000
*  /*    THE USER                                                    */ 02043000
*  /*                                                                */ 02044000
*  /* REQUIREMENTS:                                                  */ 02045000
*  /*                                                                */ 02046000
*  /*    1. THE NAME TABLES OF ALL CRA'S PREVIOUS IN THE FDT         */ 02047000
*  /*       MUST HAVE BEEN CONSTRUCTED                               */ 02048000
*  /*                                                                */ 02049000
*  /******************************************************************/ 02050000
*                                                                  0712 02051000
*DUPNAMCK: PROCEDURE (DPARM4);                                     0712 02052000
*                                                                  0712 02053000
         B     @PB00008                                            0712 02054000
DUPNAMCK STM   @14,@12,@SA00008                                    0712 02055000
         MVC   @PC00008(4),0(@01)                                  0712 02056000
*  DCL DPARM4        FIXED(31);   /* INDEX INTO CRV                  */ 02057000
*  DCL DUPIX         FIXED(31);   /* CCRV INDEX NUMBER TO SCAN       */ 02058000
*  DCL DUPPTR        PTR(31);     /* REFERENCE CHAIN POINTER         */ 02059000
*  DCL DUPIXL        FIXED(31);   /* GENERAL COUNTER                 */ 02060000
*                                                                  0716 02061000
*  /******************************************************************/ 02062000
*  /*                                                                */ 02063000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 02064000
*  /*                                                                */ 02065000
*  /******************************************************************/ 02066000
*                                                                  0717 02067000
*  OLDERID2 = NEWERID2;                                            0717 02068000
         L     @02,@PC00001                                        0717 02069000
         L     @15,GDTTR2(,@02)                                    0717 02070000
         MVC   @TS00001(95),NEWERID2(@15)                          0717 02071000
         MVC   OLDERID2(95,@15),@TS00001                           0717 02072000
*  NEWID2='RC85';                                                  0718 02073000
         MVC   NEWID2(4,@15),@CC01174                              0718 02074000
*  IF GDTDBG = NULLPTR                                             0719 02075000
*    THEN;                                                         0719 02076000
         ICM   @15,15,GDTDBG(@02)                                  0719 02077000
         BZ    @RT00719                                            0719 02078000
*    ELSE                                                          0721 02079000
*      CALL IDCDB010 (GDTTBL,'RC85');                              0721 02080000
*                                                                  0721 02081000
         L     @02,@PC00001                                        0721 02082000
         ST    @02,@AL00001                                        0721 02083000
         LA    @15,@CC01174                                        0721 02084000
         ST    @15,@AL00001+4                                      0721 02085000
         MVI   @AL00001+4,X'80'                                    0721 02086000
         L     @15,GDTDBG(,@02)                                    0721 02087000
         LA    @01,@AL00001                                        0721 02088000
         BALR  @14,@15                                             0721 02089000
*  /******************************************************************/ 02090000
*  /*                                                                */ 02091000
*  /*    POINT AT THE NAME CHAIN TO CHECK FOR DUPLICATES AND         */ 02092000
*  /*    LOOP THROUGH ALL OF THE ENTRIES                             */ 02093000
*  /*                                                                */ 02094000
*  /******************************************************************/ 02095000
*                                                                  0722 02096000
*  NBLKPTR=CRVNAMCH;              /* POINT AT NAME CHAIN TO          */ 02097000
@RT00719 MVC   NBLKPTR(4),CRVNAMCH(CRVEBASE)                       0722 02098000
*                                 /* SCAN FOR DUPLICATES             */ 02099000
*  DO WHILE NBLKPTR^=NULLPTR;     /* LOOP THROUGH ALL THE NAMES      */ 02100000
         B     @DE00723                                            0723 02101000
@DL00723 DS    0H                                                  0724 02102000
*    /****************************************************************/ 02103000
*    /*                                                              */ 02104000
*    /*    LOOP THROUGH ALL CRA'A THAT ARE PREVIOUS TO THE CRA       */ 02105000
*    /*    BEING CHECKED                                             */ 02106000
*    /*                                                              */ 02107000
*    /****************************************************************/ 02108000
*                                                                  0724 02109000
*    DO DUPIX=1 TO DPARM4 WHILE DUPIX<DPARM4;                      0724 02110000
         LA    DUPIX,1                                             0724 02111000
         B     @DE00724                                            0724 02112000
@DL00724 L     @05,@PC00008                                        0724 02113000
         C     DUPIX,DPARM4(,@05)                                  0724 02114000
         BNL   @DC00724                                            0724 02115000
*                                 /* LOOP THROUGH PREVIOUS CRA       */ 02116000
*                                 /* NAME CHAIN'S                    */ 02117000
*                                                                  0725 02118000
*      /**************************************************************/ 02119000
*      /*                                                            */ 02120000
*      /*    POINT AT THE NAME CHAIN AND PROCESS ALL OF THE          */ 02121000
*      /*    ENTRIES IN THE CHAIN                                    */ 02122000
*      /*                                                            */ 02123000
*      /**************************************************************/ 02124000
*                                                                  0725 02125000
*      DUPPTR=ADDR(CRVENTRY(DUPIX))->CRVNAMCH;                     0725 02126000
         LR    @05,DUPIX                                           0725 02127000
         MH    @05,@CH00954                                        0725 02128000
         L     @01,CRVBASE                                         0725 02129000
         LA    @05,CRVENTRY-28(@05,@01)                            0725 02130000
         L     DUPPTR,CRVNAMCH(,@05)                               0725 02131000
*                                 /* POINT AT NAME CHAIN FOR         */ 02132000
*                                 /* THIS CRV ENTRY                  */ 02133000
*      DO WHILE DUPPTR^=NULLPTR;  /* LOOP THROUGH THE WHOLE          */ 02134000
         B     @DE00726                                            0726 02135000
@DL00726 DS    0H                                                  0727 02136000
*                                 /* NAME CHAIN                      */ 02137000
*                                                                  0727 02138000
*        /************************************************************/ 02139000
*        /*                                                          */ 02140000
*        /*    CHECK THE LENGTH TO SEE IF IT IS THE SAME, AND        */ 02141000
*        /*    THEN CHECK THE ENTRY NAME                             */ 02142000
*        /*                                                          */ 02143000
*        /************************************************************/ 02144000
*                                                                  0727 02145000
*        IF DUPPTR->NBLKNAME->DSNAMLEN=NBLKNAME->DSNAMLEN          0727 02146000
*                                 /* DO THE LENGTH'S OF THE          */ 02147000
*                                 /* NAMES MATCH                     */ 02148000
*          THEN IF DUPPTR->NBLKNAME->DSNAM(1:NBLKNAME->DSNAMLEN)=  0727 02149000
         L     @05,NBLKNAME(,DUPPTR)                               0727 02150000
         L     @15,NBLKPTR                                         0727 02151000
         L     @14,NBLKNAME(,@15)                                  0727 02152000
         LH    @07,DSNAMLEN(,@14)                                  0727 02153000
         CH    @07,DSNAMLEN(,@05)                                  0727 02154000
         BNE   @RF00727                                            0727 02155000
*                          NBLKNAME->DSNAM(1:NBLKNAME->DSNAMLEN)   0728 02156000
*                                 /* THEN: IF THE NAMES MATCH        */ 02157000
*            /********************************************************/ 02158000
*            /*                                                      */ 02159000
*            /*    IF THE ENTRY NAMES ARE EQUAL, THEN HANDLE THE     */ 02160000
*            /*    MESSAGES AND SWITCHES FOR THE DUPLICATE NAME      */ 02161000
*            /*                                                      */ 02162000
*            /********************************************************/ 02163000
*                                                                  0728 02164000
*            THEN DO;             /* THEN:                           */ 02165000
         BCTR  @07,0                                               0728 02166000
         EX    @07,@SC01400                                        0728 02167000
         BNE   @RF00728                                            0728 02168000
*              NBLKBE=ON;         /* INDICATE NAME NOT TO BE         */ 02169000
         OI    NBLKBE(@15),B'01000000'                             0730 02170000
*                                 /* EXPORTED                        */ 02171000
*              CALL MESSAGE (0,MSGID21,CRADDPTR(DPARM4)->CRADDVAL, 0731 02172000
*                            LENGTH(CRADDVAL));                    0731 02173000
         MVC   @AL00001(16),@AL00731                               0731 02174000
         L     @05,@PC00008                                        0731 02175000
         L     @05,DPARM4(,@05)                                    0731 02176000
         SLA   @05,2                                               0731 02177000
         L     @15,@PC00001+4                                      0731 02178000
         L     @01,FDTPTR+16(,@15)                                 0731 02179000
         AL    @01,@CF01392                                        0731 02180000
         L     @05,CRADDPTR(@05,@01)                               0731 02181000
         LA    @05,CRADDVAL(,@05)                                  0731 02182000
         ST    @05,@AL00001+8                                      0731 02183000
         LA    @01,@AL00001                                        0731 02184000
         BAL   @14,MESSAGE                                         0731 02185000
*                                 /* PRINT DUPLICATE NAME            */ 02186000
*                                 /* MESSAGE                         */ 02187000
*              DUPIXL=NBLKNAME->DSNAMLEN;                          0732 02188000
         L     @05,NBLKPTR                                         0732 02189000
         L     @05,NBLKNAME(,@05)                                  0732 02190000
         LH    @15,DSNAMLEN(,@05)                                  0732 02191000
         ST    @15,DUPIXL                                          0732 02192000
*                                 /* GET THE NAME LENGTH             */ 02193000
*              CALL MESSAGE (0,MSGID20,NBLKNAME->DSNAM,DUPIXL);    0733 02194000
         LA    @15,@CF00116                                        0733 02195000
         ST    @15,@AL00001                                        0733 02196000
         LA    @15,@CH00885                                        0733 02197000
         ST    @15,@AL00001+4                                      0733 02198000
         LA    @05,DSNAM(,@05)                                     0733 02199000
         ST    @05,@AL00001+8                                      0733 02200000
         LA    @05,DUPIXL                                          0733 02201000
         ST    @05,@AL00001+12                                     0733 02202000
         LA    @01,@AL00001                                        0733 02203000
         BAL   @14,MESSAGE                                         0733 02204000
*                                 /* PRINT DSNAME                    */ 02205000
*              END;               /*                                 */ 02206000
*            ELSE;                /* ELSE: CONTINUE                  */ 02207000
*                                                                  0735 02208000
@RF00728 DS    0H                                                  0736 02209000
*          ELSE;                  /* ELSE: CONTINUE                  */ 02210000
*                                                                  0736 02211000
@RF00727 DS    0H                                                  0737 02212000
*        DUPPTR=DUPPTR->NBLKCHN;  /* POINT AT NEXT NAME ENTRY        */ 02213000
         L     DUPPTR,NBLKCHN(,DUPPTR)                             0737 02214000
*        END;                     /*                                 */ 02215000
@DE00726 LTR   DUPPTR,DUPPTR                                       0738 02216000
         BNZ   @DL00726                                            0738 02217000
*      END;                       /*                                 */ 02218000
*                                                                  0739 02219000
         AL    DUPIX,@CF00220                                      0739 02220000
@DE00724 L     @05,@PC00008                                        0739 02221000
         C     DUPIX,DPARM4(,@05)                                  0739 02222000
         BNH   @DL00724                                            0739 02223000
@DC00724 DS    0H                                                  0740 02224000
*    NBLKPTR=NBLKCHN;             /* POINT AT THE NEXT NAME          */ 02225000
         L     @02,NBLKPTR                                         0740 02226000
         L     @02,NBLKCHN(,@02)                                   0740 02227000
         ST    @02,NBLKPTR                                         0740 02228000
*    END;                         /*                                 */ 02229000
*                                                                  0741 02230000
@DE00723 ICM   @02,15,NBLKPTR                                      0741 02231000
         BNZ   @DL00723                                            0741 02232000
*  END DUPNAMCK;                  /* END OF PROCEDURE                */ 02233000
@EL00008 DS    0H                                                  0742 02234000
@EF00008 DS    0H                                                  0742 02235000
@ER00008 LM    @14,@12,@SA00008                                    0742 02236000
         BR    @14                                                 0742 02237000
@PB00008 DS    0H                                                  0743 02238000
*  GEN (EJECT);                                                    0743 02239000
         EJECT                                                          02240000
*  /******************************************************************/ 02241000
*  /*                                                                */ 02242000
*  /* PROCEDURE NAME:                                                */ 02243000
*  /*    ERRCK                                                       */ 02244000
*  /*                                                                */ 02245000
*  /* FUNCTION:                                                      */ 02246000
*  /*                                                                */ 02247000
*  /*    HANDLE THE COMMON PROCESSING THAT MUST BE DONE AT THE       */ 02248000
*  /*    COMPLETION OF OPEN'ING A CRA (E.G. ERROR RETURN CODES,      */ 02249000
*  /*    OR ERROR MESSAGES)                                          */ 02250000
*  /*                                                                */ 02251000
*  /* REQUIREMENTS:                                                  */ 02252000
*  /*                                                                */ 02253000
*  /*    NONE                                                        */ 02254000
*  /*                                                                */ 02255000
*  /******************************************************************/ 02256000
*                                                                  0744 02257000
*ERRCK: PROCEDURE (EPARM4);                                        0744 02258000
*                                                                  0744 02259000
         B     @PB00009                                            0744 02260000
ERRCK    STM   @14,@01,@SA00009                                    0744 02261000
         STM   @03,@12,@SA00009+16                                 0744 02262000
         MVC   @PC00009(4),0(@01)                                  0744 02263000
*  DCL EPARM4      FIXED(31);     /* INDEX INTO CRV                  */ 02264000
*                                                                  0745 02265000
*  /******************************************************************/ 02266000
*  /*                                                                */ 02267000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 02268000
*  /*                                                                */ 02269000
*  /******************************************************************/ 02270000
*                                                                  0746 02271000
*  OLDERID2 = NEWERID2;                                            0746 02272000
         L     @15,@PC00001                                        0746 02273000
         L     @14,GDTTR2(,@15)                                    0746 02274000
         MVC   @TS00001(95),NEWERID2(@14)                          0746 02275000
         MVC   OLDERID2(95,@14),@TS00001                           0746 02276000
*  NEWID2='RC96';                                                  0747 02277000
         MVC   NEWID2(4,@14),@CC01181                              0747 02278000
*  IF GDTDBG = NULLPTR                                             0748 02279000
*    THEN;                                                         0748 02280000
         ICM   @14,15,GDTDBG(@15)                                  0748 02281000
         BZ    @RT00748                                            0748 02282000
*    ELSE                                                          0750 02283000
*      CALL IDCDB010 (GDTTBL,'RC96');                              0750 02284000
*                                                                  0750 02285000
         L     @15,@PC00001                                        0750 02286000
         ST    @15,@AL00001                                        0750 02287000
         LA    @14,@CC01181                                        0750 02288000
         ST    @14,@AL00001+4                                      0750 02289000
         MVI   @AL00001+4,X'80'                                    0750 02290000
         L     @15,GDTDBG(,@15)                                    0750 02291000
         LA    @01,@AL00001                                        0750 02292000
         BALR  @14,@15                                             0750 02293000
*  /******************************************************************/ 02294000
*  /*                                                                */ 02295000
*  /*    HANDLE THE NORMAL RETURN                                    */ 02296000
*  /*                                                                */ 02297000
*  /******************************************************************/ 02298000
*                                                                  0751 02299000
*  IF ERRNO=ERCDNRML              /* IF NO ERROR WAS DETECTED        */ 02300000
*    THEN ERRNO=LASTCC00;         /* THEN: SET ZERO RETURN CODE      */ 02301000
@RT00748 LTR   ERRNO,ERRNO                                         0751 02302000
         BNZ   @RF00751                                            0751 02303000
         SLR   ERRNO,ERRNO                                         0752 02304000
*    /****************************************************************/ 02305000
*    /*                                                              */ 02306000
*    /*    HANDLE CLOSING THE CRA IF IT WAS OPENED                   */ 02307000
*    /*                                                              */ 02308000
*    /****************************************************************/ 02309000
*                                                                  0753 02310000
*    ELSE DO;                     /* ELSE:                           */ 02311000
         B     @RC00751                                            0753 02312000
@RF00751 DS    0H                                                  0754 02313000
*      IF ERRNO=ERCDCNTO | ERRNO=ERCDNSTR                          0754 02314000
*                                 /* IF BAD VOLUME OR NO CORE        */ 02315000
*        THEN;                    /* THEN: CONTINUE                  */ 02316000
         CH    ERRNO,@CH00043                                      0754 02317000
         BE    @RT00754                                            0754 02318000
         CH    ERRNO,@CH00954                                      0754 02319000
         BE    @RT00754                                            0754 02320000
*        ELSE CALL IDCIOCL0 (GDTTBL,IOCSPTR);                      0756 02321000
         L     @15,@PC00001                                        0756 02322000
         ST    @15,@AL00001                                        0756 02323000
         LA    @14,IOCSPTR                                         0756 02324000
         ST    @14,@AL00001+4                                      0756 02325000
         MVI   @AL00001+4,X'80'                                    0756 02326000
         L     @15,GDTCLS(,@15)                                    0756 02327000
         LA    @01,@AL00001                                        0756 02328000
         BALR  @14,@15                                             0756 02329000
*                                 /* ELSE: CLOSE THE DATA SET        */ 02330000
*                                                                  0757 02331000
*      /**************************************************************/ 02332000
*      /*                                                            */ 02333000
*      /*    HANDLE PRINTING THE MESSAGE IF REQUIRED                 */ 02334000
*      /*                                                            */ 02335000
*      /**************************************************************/ 02336000
*                                                                  0757 02337000
*      IF ERRNO=ERCDCNTO | ERRNO=ERCDNSTR | ERRNO=ERCDCTNM         0757 02338000
*                                 /* IF BAD VOLUME, NO CORE OR       */ 02339000
*                                 /* WRONG CATALOG NAME              */ 02340000
*        THEN;                    /* THEN: CONTINUE                  */ 02341000
@RT00754 CH    ERRNO,@CH00043                                      0757 02342000
         BE    @RT00757                                            0757 02343000
         CH    ERRNO,@CH00954                                      0757 02344000
         BE    @RT00757                                            0757 02345000
         CH    ERRNO,@CH00483                                      0757 02346000
         BE    @RT00757                                            0757 02347000
*        ELSE DO;                 /* ELSE:                           */ 02348000
*          CRVBADVL=ON;           /* INDICATE A BAD VOLUME           */ 02349000
         OI    CRVBADVL(CRVEBASE),B'10000000'                      0760 02350000
*          CALL MESSAGE(2,MSGID18,VTTVOLSR(EPARM4),LENGTH(VTTVOLSR),    02351000
*                       RSNCD,LENGTH(RSNCD));                      0761 02352000
         MVC   @AL00001(24),@AL00761                               0761 02353000
         L     @15,@PC00009                                        0761 02354000
         L     @15,EPARM4(,@15)                                    0761 02355000
         MH    @15,@CH00763                                        0761 02356000
         L     @01,CRVBASE                                         0761 02357000
         L     @01,CRVCRAPL(,@01)                                  0761 02358000
         L     @01,ACCVOLTT(,@01)                                  0761 02359000
         AL    @01,@CF01391                                        0761 02360000
         LA    @15,VTTVOLSR-4(@15,@01)                             0761 02361000
         ST    @15,@AL00001+8                                      0761 02362000
         LA    @15,RSNCD                                           0761 02363000
         ST    @15,@AL00001+16                                     0761 02364000
         LA    @01,@AL00001                                        0761 02365000
         BAL   @14,MESSAGE                                         0761 02366000
*                                 /* PRINT BAD VOLUME MESSAGE        */ 02367000
*          END;                   /*                                 */ 02368000
*                                                                  0762 02369000
*      /**************************************************************/ 02370000
*      /*                                                            */ 02371000
*      /*    HANDLE THE RETURN CODE                                  */ 02372000
*      /*                                                            */ 02373000
*      /**************************************************************/ 02374000
*                                                                  0763 02375000
*      IF ERRNO=ERCDNSTR & RSNCD=RSNCD09                           0763 02376000
*                                 /* IF NO STORAGE OR NO UCB         */ 02377000
*        THEN ERRNO=LASTCC12;     /* THEN: INDICATE BAD ERROR        */ 02378000
@RT00757 CH    ERRNO,@CH00954                                      0763 02379000
         BNE   @RF00763                                            0763 02380000
         CLC   RSNCD(2),@CC00932                                   0763 02381000
         BNE   @RF00763                                            0763 02382000
         LA    ERRNO,12                                            0764 02383000
*        ELSE ERRNO=LASTCC08;     /* ELSE: INDICATE CONTINUE         */ 02384000
         B     @RC00763                                            0765 02385000
@RF00763 LA    ERRNO,8                                             0765 02386000
*                                 /*       ERROR                     */ 02387000
*      END;                       /*                                 */ 02388000
*                                                                  0766 02389000
*  END ERRCK;                     /* END OF PROCEDURE                */ 02390000
@EL00009 DS    0H                                                  0767 02391000
@EF00009 DS    0H                                                  0767 02392000
@ER00009 LM    @14,@01,@SA00009                                    0767 02393000
         LM    @03,@12,@SA00009+16                                 0767 02394000
         BR    @14                                                 0767 02395000
@PB00009 DS    0H                                                  0768 02396000
*  GEN (EJECT);                                                    0768 02397000
         EJECT                                                          02398000
*  /******************************************************************/ 02399000
*  /*                                                                */ 02400000
*  /* PROCEDURE NAME:                                                */ 02401000
*  /*    EXITTHE                                                     */ 02402000
*  /*                                                                */ 02403000
*  /* FUNCTION:                                                      */ 02404000
*  /*                                                                */ 02405000
*  /*    PRINT THE COMPLETION MESSAGE AND EXIT FROM THE MODULE.      */ 02406000
*  /*                                                                */ 02407000
*  /* REQUIREMENTS:                                                  */ 02408000
*  /*                                                                */ 02409000
*  /*    1. LASTCC MUST CONTAIN THE CONDITION CODE.                  */ 02410000
*  /*                                                                */ 02411000
*  /******************************************************************/ 02412000
*                                                                  0769 02413000
*  EXITTHE: PROCEDURE;                                             0769 02414000
*                                                                  0769 02415000
         B     @PB00010                                            0769 02416000
EXITTHE  STM   @14,@12,@SA00010                                    0769 02417000
*  /******************************************************************/ 02418000
*  /*                                                                */ 02419000
*  /*    HANDLE THE CORE MESSAGE                                     */ 02420000
*  /*                                                                */ 02421000
*  /******************************************************************/ 02422000
*                                                                  0770 02423000
*  IF CORE=BAD                    /* IF THE MESSAGE MUST BE          */ 02424000
*                                 /* PRINTED                         */ 02425000
*    THEN CALL MESSAGE(0,MSGID54,0,0);                             0770 02426000
         CLC   CORE(1),BAD                                         0770 02427000
         BNE   @RF00770                                            0770 02428000
         LA    @01,@AL00771                                        0771 02429000
         BAL   @14,MESSAGE                                         0771 02430000
*                                 /* THEN: PRINT IT                  */ 02431000
*    ELSE;                        /* ELSE: CONTINUE                  */ 02432000
*                                                                  0772 02433000
@RF00770 DS    0H                                                  0773 02434000
*  /******************************************************************* 02435000
*  /*                                                                 * 02436000
*  /*    HANDLE THE TERMINATION                                       * 02437000
*  /*                                                                 * 02438000
*  /******************************************************************* 02439000
*                                                                  0773 02440000
*  CALL TERM;                      /* EXECUTE TERMINATION ROUTINE     * 02441000
*                                                                  0773 02442000
         BAL   @14,TERM                                            0773 02443000
*  /******************************************************************* 02444000
*  /*                                                                 * 02445000
*  /*    HANDLE THE SPECIAL RETURN CODE (TERMINAL AND NOT STORAGE)    * 02446000
*  /*                                                                 * 02447000
*  /******************************************************************* 02448000
*                                                                  0774 02449000
*  IF LASTCC=LASTCC16              /* IF SPECIAL RETURN CODE          * 02450000
*    THEN LASTCC=LASTCC12;         /* THEN: CONVERT TO TERMINAL       * 02451000
         L     @15,@PC00001+8                                      0774 02452000
         CLC   LASTCC(2,@15),@CH00483                              0774 02453000
         BNE   @RF00774                                            0774 02454000
         MVC   LASTCC(2,@15),@CH00038                              0775 02455000
*    ELSE;                         /* ELSE: CONTINUE                  * 02456000
@RF00774 DS    0H                                                  0777 02457000
*  /******************************************************************/ 02458000
*  /*                                                                */ 02459000
*  /*    HANDLE THE COMPLETION MESSAGE                               */ 02460000
*  /*                                                                */ 02461000
*  /******************************************************************/ 02462000
*                                                                  0777 02463000
*  IF GDTECT^=NULLPTR &           /* IS THIS THE TSO ENVIORNMENT     */ 02464000
*     LASTCC^=LASTCC00            /* AND THE RETURN CODE IS NOT ZERO */ 02465000
*    THEN CALL MESSAGE(0,MSGID65,LASTCC,LENGTH(LASTCC));           0777 02466000
         SLR   @15,@15                                             0777 02467000
         L     @14,@PC00001                                        0777 02468000
         C     @15,GDTECT(,@14)                                    0777 02469000
         BE    @RF00777                                            0777 02470000
         L     @14,@PC00001+8                                      0777 02471000
         CH    @15,LASTCC(,@14)                                    0777 02472000
         BE    @RF00777                                            0777 02473000
         MVC   @AL00001(16),@AL00778                               0778 02474000
         ST    @14,@AL00001+8                                      0778 02475000
         LA    @01,@AL00001                                        0778 02476000
         BAL   @14,MESSAGE                                         0778 02477000
*                                 /* THEN: PRINT SPECIAL TSO MESSAGE */ 02478000
*                                 /* ------------VS2-------------    */ 02479000
*    ELSE IF LASTCC=LASTCC12      /* ELSE: IF FUNCTION FAILURE       */ 02480000
*      THEN CALL MESSAGE(0,MSGID53,LASTCC,LENGTH(LASTCC));         0779 02481000
         B     @RC00777                                            0779 02482000
@RF00777 L     @15,@PC00001+8                                      0779 02483000
         CLC   LASTCC(2,@15),@CH00038                              0779 02484000
         BNE   @RF00779                                            0779 02485000
         MVC   @AL00001(16),@AL00780                               0780 02486000
         ST    @15,@AL00001+8                                      0780 02487000
         LA    @01,@AL00001                                        0780 02488000
         BAL   @14,MESSAGE                                         0780 02489000
*                                 /* THEN: PRINT FAILURE MESSAGE     */ 02490000
*      ELSE CALL MESSAGE(0,MSGID51,LASTCC,LENGTH(LASTCC));         0781 02491000
         B     @RC00779                                            0781 02492000
@RF00779 MVC   @AL00001(16),@AL00781                               0781 02493000
         L     @15,@PC00001+8                                      0781 02494000
         ST    @15,@AL00001+8                                      0781 02495000
         LA    @01,@AL00001                                        0781 02496000
         BAL   @14,MESSAGE                                         0781 02497000
*                                 /* ELSE: PRINT SUCCESS MESSAGE     */ 02498000
*                                                                  0782 02499000
*  /******************************************************************/ 02500000
*  /*                                                                */ 02501000
*  /*    EXIT FROM THE MODULE                                        */ 02502000
*  /*                                                                */ 02503000
*  /******************************************************************/ 02504000
*                                                                  0782 02505000
*  CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                             0782 02506000
@RC00779 DS    0H                                                  0782 02507000
@RC00777 L     @15,@PC00001                                        0782 02508000
         ST    @15,@AL00001                                        0782 02509000
         LA    @14,MODID                                           0782 02510000
         ST    @14,@AL00001+4                                      0782 02511000
         L     @14,@PC00001+8                                      0782 02512000
         ST    @14,@AL00001+8                                      0782 02513000
         MVI   @AL00001+8,X'80'                                    0782 02514000
         L     @15,GDTEPL(,@15)                                    0782 02515000
         LA    @01,@AL00001                                        0782 02516000
         BALR  @14,@15                                             0782 02517000
*                                 /* EXIT FROM THE MODULE            */ 02518000
*  END EXITTHE;                   /* END OF PROCEDURE                */ 02519000
@EL00010 DS    0H                                                  0783 02520000
@EF00010 DS    0H                                                  0783 02521000
@ER00010 LM    @14,@12,@SA00010                                    0783 02522000
         BR    @14                                                 0783 02523000
@PB00010 DS    0H                                                  0784 02524000
*  GEN (EJECT);                                                    0784 02525000
         EJECT                                                          02526000
*  /******************************************************************/ 02527000
*  /*                                                                */ 02528000
*  /* PROCEDURE NAME:                                                */ 02529000
*  /*    EXPORTDR                                                    */ 02530000
*  /*                                                                */ 02531000
*  /* FUNCTION:                                                      */ 02532000
*  /*                                                                */ 02533000
*  /*    ACTIVATE THE EXPORT MODULE TO CONSTRUCT THE PORT-           */ 02534000
*  /*    ABILITY DATA SET IN THE CORRECT ORDER AND WITH THE          */ 02535000
*  /*    THINGS DESIRED (E.G. PASSWORDS AND LRECL)                   */ 02536000
*  /*                                                                */ 02537000
*  /* REQUIREMENTS:                                                  */ 02538000
*  /*                                                                */ 02539000
*  /*    1. ALL PROCESSING NECESSARY TO DECIDE THAT THE ENTRY        */ 02540000
*  /*       CAN BE EXPORTED MUST BE DONE                             */ 02541000
*  /*                                                                */ 02542000
*  /******************************************************************/ 02543000
*                                                                  0785 02544000
*EXPORTDR: PROCEDURE (PPARM4);                                     0785 02545000
*                                                                  0785 02546000
         B     @PB00011                                            0785 02547000
EXPORTDR STM   @14,@12,@SA00011                                    0785 02548000
         MVC   @PC00011(4),0(@01)                                  0785 02549000
*  DCL PPARM4      FIXED(31);     /* INDEX INTO CRV                  */ 02550000
*  DCL EXPTOTL     FIXED(15) CONSTANT(5);                          0787 02551000
*                                 /* NUMBER OF ENTRIES TO DO         */ 02552000
*  DCL INPTBLA(5)      PTR(31);   /* EXPORT TABLE AREA               */ 02553000
*  DCL ENTOBJA     CHAR(LENGTH(ENTOBJ)) BDY(WORD);                 0789 02554000
*                                 /* ENTRY DATA AREA                 */ 02555000
*  DCL OUTDATA     CHAR(LENGTH(OUTDAT)) BDY(WORD);                 0790 02556000
*                                 /* CONTROL INFO AREA               */ 02557000
*  DCL EXPTIX1     FIXED(31);     /* LOOP COUNTER TO PROCESSING      */ 02558000
*  DCL EXPTIX2     FIXED(31);     /* GENERAL COUNTER FOR USE         */ 02559000
*  DCL DEFBKSZ     FIXED(31) CONSTANT(2048);                       0793 02560000
*                                 /* DEFAULT BLOCK SIZE FOR THE      */ 02561000
*                                 /* EXPORT PROCESS                  */ 02562000
*  DCL RECSTYPE(EXPTOTL) CHAR(1)  /* RECORD TYPES IN THE ORDER       */ 02563000
*    INITIAL('C','G','A','B','U');/* THAT NEED PROCESSING            */ 02564000
*                                                                  0794 02565000
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */ 02566000
*                                                                  0795 02567000
*  /******************************************************************/ 02568000
*  /*                                                                */ 02569000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 02570000
*  /*                                                                */ 02571000
*  /******************************************************************/ 02572000
*                                                                  0796 02573000
*  OLDERID2 = NEWERID2;                                            0796 02574000
         L     @14,@PC00001                                        0796 02575000
         L     @04,GDTTR2(,@14)                                    0796 02576000
         MVC   @TS00001(95),NEWERID2(@04)                          0796 02577000
         MVC   OLDERID2(95,@04),@TS00001                           0796 02578000
*  NEWID2='RC82';                                                  0797 02579000
         MVC   NEWID2(4,@04),@CC01200                              0797 02580000
*  IF GDTDBG = NULLPTR                                             0798 02581000
*    THEN;                                                         0798 02582000
         ICM   @04,15,GDTDBG(@14)                                  0798 02583000
         BZ    @RT00798                                            0798 02584000
*    ELSE                                                          0800 02585000
*      CALL IDCDB010 (GDTTBL,'RC82');                              0800 02586000
         L     @14,@PC00001                                        0800 02587000
         ST    @14,@AL00001                                        0800 02588000
         LA    @04,@CC01200                                        0800 02589000
         ST    @04,@AL00001+4                                      0800 02590000
         MVI   @AL00001+4,X'80'                                    0800 02591000
         L     @15,GDTDBG(,@14)                                    0800 02592000
         LA    @01,@AL00001                                        0800 02593000
         BALR  @14,@15                                             0800 02594000
*  /******************************************************************/ 02595000
*  /*                                                                */ 02596000
*  /*    OPEN CRA AS A SIMULATED CATALOG SO THAT EXPORT CAN          */ 02597000
*  /*    BE DONE                                                     */ 02598000
*  /*                                                                */ 02599000
*  /******************************************************************/ 02600000
*                                                                  0801 02601000
*  CALL OPENCRA(OPENFUNC,PPARM4,CRACAT);                           0801 02602000
@RT00798 MVC   @AL00001(12),@AL00801                               0801 02603000
         L     @14,@PC00011                                        0801 02604000
         ST    @14,@AL00001+4                                      0801 02605000
         LA    @01,@AL00001                                        0801 02606000
         BAL   @14,OPENCRA                                         0801 02607000
*                                 /* OPEN CRA AS CATALOG             */ 02608000
*                                                                  0802 02609000
*  /******************************************************************/ 02610000
*  /*                                                                */ 02611000
*  /*    LOOP THROUGH ALL OF THE TYPES THAT ARE TO BE HANDLED        */ 02612000
*  /*    SO THAT THE ORDER CAN BE MAINTAINED                         */ 02613000
*  /*                                                                */ 02614000
*  /******************************************************************/ 02615000
*                                                                  0802 02616000
*  DO EXPTIX1=1 TO EXPTOTL;       /* LOOP TO EXPORT ALL THE          */ 02617000
         LA    EXPTIX1,1                                           0802 02618000
@DL00802 DS    0H                                                  0803 02619000
*                                 /* RECORD TYPES HANDLED            */ 02620000
*                                                                  0803 02621000
*    /****************************************************************/ 02622000
*    /*                                                              */ 02623000
*    /*    POINT AT THE HEAD OF THE NAME CHAIN AND LOOP THROUGH      */ 02624000
*    /*    ALL OF THE NAME BLOCKS ON THE CHAIN                       */ 02625000
*    /*                                                              */ 02626000
*    /****************************************************************/ 02627000
*                                                                  0803 02628000
*    NBLKPTR=CRVNAMCH;            /* POINT AT THE START OF THE       */ 02629000
         MVC   NBLKPTR(4),CRVNAMCH(CRVEBASE)                       0803 02630000
*                                 /* NAME CHAIN ON THIS CRA          */ 02631000
*    DO WHILE NBLKPTR^=NULLPTR;   /* LOOP TO THE END OF THE          */ 02632000
         B     @DE00804                                            0804 02633000
@DL00804 DS    0H                                                  0805 02634000
*                                 /* NAME CHAIN                      */ 02635000
*      /**************************************************************/ 02636000
*      /*                                                            */ 02637000
*      /*    HANDLE ALL OF THE NAMES OF THE TYPE BEING PROCESSED     */ 02638000
*      /*    ON THIS LOOP THROUGH THE NAMES                          */ 02639000
*      /*                                                            */ 02640000
*      /**************************************************************/ 02641000
*                                                                  0805 02642000
*      IF NBLKBE=ON | RECSTYPE(EXPTIX1)^=NBLKTYPE                  0805 02643000
*                                 /* IF THIS IS A BAD ENTRY          */ 02644000
*                                 /* OR THE TYPE IS WRONG FOR        */ 02645000
*                                 /* THIS PASS                       */ 02646000
*        THEN;                    /* THEN: CONTINUE                  */ 02647000
         L     @14,NBLKPTR                                         0805 02648000
         TM    NBLKBE(@14),B'01000000'                             0805 02649000
         BO    @RT00805                                            0805 02650000
         LA    @04,RECSTYPE-1(EXPTIX1)                             0805 02651000
         CLC   0(1,@04),NBLKTYPE(@14)                              0805 02652000
         BNE   @RT00805                                            0805 02653000
*        ELSE IF ENTREPTR(PPARM4)^=NULLPTR & NBLKMH=OFF            0807 02654000
*                                 /* IF ENTRIES ARE SPECIFIED        */ 02655000
*                                 /* AND THIS ON  DOSEN'T MATCH      */ 02656000
*          THEN;                  /* THEN: CONTINUE                  */ 02657000
         L     @14,@PC00011                                        0807 02658000
         L     @14,PPARM4(,@14)                                    0807 02659000
         SLA   @14,2                                               0807 02660000
         L     @04,@PC00001+4                                      0807 02661000
         L     @04,FDTPTR+28(,@04)                                 0807 02662000
         AL    @04,@CF01392                                        0807 02663000
         L     @14,ENTREPTR(@14,@04)                               0807 02664000
         LTR   @14,@14                                             0807 02665000
         BZ    @RF00807                                            0807 02666000
         L     @14,NBLKPTR                                         0807 02667000
         TM    NBLKMH(@14),B'10000000'                             0807 02668000
         BZ    @RT00807                                            0807 02669000
*          ELSE DO;               /* ELSE:                           */ 02670000
@RF00807 DS    0H                                                  0810 02671000
*            IF NBLKSC=ON & FRC=NULLPTR                            0810 02672000
*                                 /* IF DATA SET OUT-OF-SYNCH        */ 02673000
*                                 /* AND THERE IS NO FORCE           */ 02674000
*              THEN REG15=LASTCC08;                                0810 02675000
         L     @14,NBLKPTR                                         0810 02676000
         TM    NBLKSC(@14),B'00100000'                             0810 02677000
         BNO   @RF00810                                            0810 02678000
         L     @14,@PC00001+4                                      0810 02679000
         L     @14,FDTPTR(,@14)                                    0810 02680000
         ICM   @04,15,FRC(@14)                                     0810 02681000
         BNZ   @RF00810                                            0810 02682000
         LA    REG15,8                                             0811 02683000
*                                 /* THEN: INDICATE NOT DONE         */ 02684000
*              ELSE DO;           /* ELSE:                           */ 02685000
*                                                                  0812 02686000
         B     @RC00810                                            0812 02687000
@RF00810 DS    0H                                                  0813 02688000
*                /****************************************************/ 02689000
*                /*                                                  */ 02690000
*                /*    INITIALIZE THE AREAS THE FIRST TIME           */ 02691000
*                /*    THROUGH THIS CODE                             */ 02692000
*                /*                                                  */ 02693000
*                /****************************************************/ 02694000
*                                                                  0813 02695000
*                IF INPPTR=NULLPTR/* IF THIS IS FIRST TIME           */ 02696000
*                  THEN DO;       /* THEN:                           */ 02697000
         ICM   @14,15,INPPTR                                       0813 02698000
         BNZ   @RF00813                                            0813 02699000
*                    ENTOBJA=''B; /* CLEAR ENTRY INFO                */ 02700000
         XC    ENTOBJA(17),ENTOBJA                                 0815 02701000
*                    OUTDATA=''B; /* CLEAR CONTROL INFO              */ 02702000
         XC    OUTDATA(17),OUTDATA                                 0816 02703000
*                    END;         /*                                 */ 02704000
*                  ELSE;          /* ELSE: CONTINUE                  */ 02705000
@RF00813 DS    0H                                                  0819 02706000
*                /****************************************************/ 02707000
*                /*                                                  */ 02708000
*                /*    PREPARE THE PARAMETER LIST FOR EXPORT         */ 02709000
*                /*    AND GO TO GET IT DONE                         */ 02710000
*                /*                                                  */ 02711000
*                /****************************************************/ 02712000
*                                                                  0819 02713000
*                INPPTR=ADDR(INPTBLA);                             0819 02714000
         LA    @14,INPTBLA                                         0819 02715000
         ST    @14,INPPTR                                          0819 02716000
*                                 /* POINT AT EXPORT TABLE           */ 02717000
*                INPTBL(1)=ADDR(ENTOBJA);                          0820 02718000
         LA    @04,ENTOBJA                                         0820 02719000
         ST    @04,INPTBL(,@14)                                    0820 02720000
*                                 /* POINT AT ENTRY TABLE            */ 02721000
*                OBJTYP=NBLKTYPE; /* PLACE ENTRY TYPE                */ 02722000
         L     @07,NBLKPTR                                         0821 02723000
         MVC   OBJTYP(1,@04),NBLKTYPE(@07)                         0821 02724000
*                OBJVAL=NBLKCI;   /* PLACE CI NUMBER                 */ 02725000
         MVC   OBJVAL(3,@04),NBLKCI(@07)                           0822 02726000
*                OBJPLN=NBLKPWL;  /* PLACE PASSWORD LENGTH           */ 02727000
         MVC   OBJPLN(1,@04),NBLKPWL(@07)                          0823 02728000
*                OBJPAS=NBLKPW;   /* PLACE PASSWORD                  */ 02729000
         MVC   OBJPAS(8,@04),NBLKPW(@07)                           0824 02730000
*                INPTBL(2)=ADDR(OUTDATA);                          0825 02731000
         LA    @04,OUTDATA                                         0825 02732000
         ST    @04,INPTBL+4(,@14)                                  0825 02733000
*                                 /* POINT AT CONTROL INFO           */ 02734000
*                OUTLEN=CRVMAXLR; /* PLACE MAXIMUM LRECL             */ 02735000
         L     @01,CRVBASE                                         0826 02736000
         MVC   OUTLEN(4,@04),CRVMAXLR(@01)                         0826 02737000
*                INPTBL(4)=ADDR(OUTDDVAL);                         0827 02738000
         L     @04,@PC00001+4                                      0827 02739000
         L     @01,FDTPTR+48(,@04)                                 0827 02740000
         LA    @07,OUTDDVAL(,@01)                                  0827 02741000
         ST    @07,INPTBL+12(,@14)                                 0827 02742000
*                                 /* POINT AT OUTPUT DNAME           */ 02743000
*                IF ADDR(PDEV)=NULLPTR                             0828 02744000
*                                 /* IF THERE IS NO PDEV             */ 02745000
*                  THEN INPTBL(5)=NULLPTR;                         0828 02746000
         SLR   @07,@07                                             0828 02747000
         C     @07,FDTPTR+44(,@04)                                 0828 02748000
         BNE   @RF00828                                            0828 02749000
         ST    @07,INPTBL+16(,@14)                                 0829 02750000
*                                 /* THEN: GIVE NULL POINTER         */ 02751000
*                  ELSE INPTBL(5)=ADDR(PDEVVAL);                   0830 02752000
         B     @RC00828                                            0830 02753000
@RF00828 L     @14,@PC00001+4                                      0830 02754000
         L     @14,FDTPTR+44(,@14)                                 0830 02755000
         LA    @14,PDEVVAL(,@14)                                   0830 02756000
         L     @04,INPPTR                                          0830 02757000
         ST    @14,INPTBL+16(,@04)                                 0830 02758000
*                                 /* ELSE: POINT AT THE              */ 02759000
*                                 /*       ENVIORNMENT DATA          */ 02760000
*                ACCTRANT=CRVADCTT;                                0831 02761000
@RC00828 L     @14,CRVBASE                                         0831 02762000
         L     @14,CRVCRAPL(,@14)                                  0831 02763000
         MVC   ACCTRANT(4,@14),CRVADCTT(CRVEBASE)                  0831 02764000
*                                 /* POINT AT TRANSLATE TABLE        */ 02765000
*                ACCDSNCI=NBLKCI; /* PLACE THE CI NUMBER             */ 02766000
         L     @04,NBLKPTR                                         0832 02767000
         MVC   ACCDSNCI(3,@14),NBLKCI(@04)                         0832 02768000
*                IF NBLKMT=ON     /* IF DATA SET EMPTY               */ 02769000
*                  THEN EMPTYDS=ON;                                0833 02770000
         TM    NBLKMT(@04),B'00010000'                             0833 02771000
         BNO   @RF00833                                            0833 02772000
         L     @14,INPPTR                                          0834 02773000
         L     @14,INPTBL+4(,@14)                                  0834 02774000
         OI    EMPTYDS(@14),B'00100000'                            0834 02775000
*                                 /* THEN: INDICATE EMPTY D.S.       */ 02776000
*                  ELSE EMPTYDS=OFF;                               0835 02777000
         B     @RC00833                                            0835 02778000
@RF00833 L     @14,INPPTR                                          0835 02779000
         L     @14,INPTBL+4(,@14)                                  0835 02780000
         NI    EMPTYDS(@14),B'11011111'                            0835 02781000
*                                 /* ELSE: INDICATE D.S. NOT         */ 02782000
*                                 /*       EMPTY                     */ 02783000
*                IF ADDR(BLKSZ)=NULLPTR                            0836 02784000
*                                 /* IF NO BLOCK SIZE SPECIFIED      */ 02785000
*                  THEN USBKSZ=DEFBKSZ;                            0836 02786000
@RC00833 L     @14,@PC00001+4                                      0836 02787000
         ICM   @04,15,FDTPTR+60(@14)                               0836 02788000
         BNZ   @RF00836                                            0836 02789000
         L     @14,INPPTR                                          0837 02790000
         L     @14,INPTBL+4(,@14)                                  0837 02791000
         MVC   USBKSZ(4,@14),@CF01198                              0837 02792000
*                                 /* THEN: SET DEFAULT BLOCK         */ 02793000
*                                 /*       SIZE                      */ 02794000
*                  ELSE USBKSZ=BLKSZVAL;                           0838 02795000
         B     @RC00836                                            0838 02796000
@RF00836 L     @14,INPPTR                                          0838 02797000
         L     @14,INPTBL+4(,@14)                                  0838 02798000
         L     @04,@PC00001+4                                      0838 02799000
         L     @04,FDTPTR+60(,@04)                                 0838 02800000
         MVC   USBKSZ(4,@14),BLKSZVAL(@04)                         0838 02801000
*                                 /* ELSE: PASS USER VALUE           */ 02802000
*                /****************************************************/ 02803000
*                /*                                                  */ 02804000
*                /*    HANDLE THE SELECTION OF THE DNAME TO          */ 02805000
*                /*    PASS TO THE EXPORT MODULE                     */ 02806000
*                /*                                                  */ 02807000
*                /****************************************************/ 02808000
*                                                                  0839 02809000
*                INPTBL(3)=ADDR(CRADDPTR(PPARM4)->CRADDVAL);       0839 02810000
@RC00836 L     @14,@PC00011                                        0839 02811000
         L     @14,PPARM4(,@14)                                    0839 02812000
         SLA   @14,2                                               0839 02813000
         L     @04,@PC00001+4                                      0839 02814000
         L     @01,FDTPTR+16(,@04)                                 0839 02815000
         AL    @01,@CF01392                                        0839 02816000
         L     @01,CRADDPTR(@14,@01)                               0839 02817000
         LA    @07,CRADDVAL(,@01)                                  0839 02818000
         L     @06,INPPTR                                          0839 02819000
         ST    @07,INPTBL+8(,@06)                                  0839 02820000
*                                 /* DEFAULT THE DNAME TO CRADD      */ 02821000
*                IF ALLNTPTR(PPARM4)^=NULLPTR                      0840 02822000
*                                 /* IF ALL IS SPECIFIED             */ 02823000
*                  THEN IF IFILEPTR(PPARM4)=NULLPTR                0840 02824000
         SLR   @07,@07                                             0840 02825000
         L     @01,FDTPTR+20(,@04)                                 0840 02826000
         AL    @01,@CF01392                                        0840 02827000
         C     @07,ALLNTPTR(@14,@01)                               0840 02828000
         BE    @RF00840                                            0840 02829000
*                                 /* THEN: IF AN INFILE IS           */ 02830000
*                                 /*       SPECIFIED                 */ 02831000
*                    THEN;        /* THEN: CONTINUE                  */ 02832000
         L     @04,FDTPTR+32(,@04)                                 0841 02833000
         AL    @04,@CF01392                                        0841 02834000
         C     @07,IFILEPTR(@14,@04)                               0841 02835000
         BE    @RT00841                                            0841 02836000
*                    ELSE INPTBL(3)=ADDR(IFILEPTR(PPARM4)->IFILEVAL);   02837000
         L     @14,@PC00011                                        0843 02838000
         L     @14,PPARM4(,@14)                                    0843 02839000
         SLA   @14,2                                               0843 02840000
         L     @04,@PC00001+4                                      0843 02841000
         L     @04,FDTPTR+32(,@04)                                 0843 02842000
         AL    @04,@CF01392                                        0843 02843000
         L     @14,IFILEPTR(@14,@04)                               0843 02844000
         LA    @14,IFILEVAL(,@14)                                  0843 02845000
         L     @04,INPPTR                                          0843 02846000
         ST    @14,INPTBL+8(,@04)                                  0843 02847000
*                                 /* ELSE: SUPPLY INFILE NAME        */ 02848000
*                  ELSE;          /* ELSE: CONTINUE                  */ 02849000
@RF00840 DS    0H                                                  0845 02850000
*                IF ENTREPTR(PPARM4)^=NULLPTR                      0845 02851000
*                                 /* IF ENTRIES IS SPECIFIED         */ 02852000
*                  THEN IF ENTDNPTR(PPARM4,NBLKENTN)=NULLPTR       0845 02853000
@RC00840 SLR   @14,@14                                             0845 02854000
         L     @04,@PC00011                                        0845 02855000
         L     @04,PPARM4(,@04)                                    0845 02856000
         LR    @07,@04                                             0845 02857000
         SLA   @07,2                                               0845 02858000
         L     @06,@PC00001+4                                      0845 02859000
         L     @01,FDTPTR+28(,@06)                                 0845 02860000
         AL    @01,@CF01392                                        0845 02861000
         C     @14,ENTREPTR(@07,@01)                               0845 02862000
         BE    @RF00845                                            0845 02863000
*                                 /* THEN: IF THERE IS NO DNAME      */ 02864000
*                    THEN;        /* THEN: CONTINUE                  */ 02865000
         MH    @04,@CH00762                                        0846 02866000
         L     @01,NBLKPTR                                         0846 02867000
         AH    @04,NBLKENTN(,@01)                                  0846 02868000
         SLA   @04,2                                               0846 02869000
         L     @01,FDTPTR+56(,@06)                                 0846 02870000
         AL    @01,@CF01394                                        0846 02871000
         C     @14,ENTDNPTR(@04,@01)                               0846 02872000
         BE    @RT00846                                            0846 02873000
*                    ELSE INPTBL(3)=ADDR(ENTDNPTR(PPARM4,NBLKENTN)->    02874000
*                                   ENTDNVAL);                     0848 02875000
         L     @14,@PC00011                                        0848 02876000
         L     @14,PPARM4(,@14)                                    0848 02877000
         MH    @14,@CH00762                                        0848 02878000
         L     @04,NBLKPTR                                         0848 02879000
         AH    @14,NBLKENTN(,@04)                                  0848 02880000
         SLA   @14,2                                               0848 02881000
         L     @04,@PC00001+4                                      0848 02882000
         L     @04,FDTPTR+56(,@04)                                 0848 02883000
         AL    @04,@CF01394                                        0848 02884000
         L     @14,ENTDNPTR(@14,@04)                               0848 02885000
         LA    @14,ENTDNVAL(,@14)                                  0848 02886000
         L     @04,INPPTR                                          0848 02887000
         ST    @14,INPTBL+8(,@04)                                  0848 02888000
*                  ELSE;          /* ELSE: CONTINUE                  */ 02889000
*                                                                  0849 02890000
@RF00845 DS    0H                                                  0850 02891000
*                /****************************************************/ 02892000
*                /*                                                  */ 02893000
*                /*    CALL THE EXPORT MODULE TO MAKE THE            */ 02894000
*                /*    OBJECT PORTABLE                               */ 02895000
*                /*                                                  */ 02896000
*                /****************************************************/ 02897000
*                                                                  0850 02898000
*                CALL IDCRC02 (GDTTBL,INPPTR);                     0850 02899000
@RC00845 L     @14,@PC00001                                        0850 02900000
         ST    @14,@AL00001                                        0850 02901000
         LA    @14,INPPTR                                          0850 02902000
         ST    @14,@AL00001+4                                      0850 02903000
         L     @15,@CV00913                                        0850 02904000
         LA    @01,@AL00001                                        0850 02905000
         BALR  @14,@15                                             0850 02906000
*                                 /* GO TO EXPORT THIS ENTRY         */ 02907000
*                END;             /*                                 */ 02908000
*            /********************************************************/ 02909000
*            /*                                                      */ 02910000
*            /*    HANDLE PRINTING THE MESSAGE AFTER EXPORT          */ 02911000
*            /*                                                      */ 02912000
*            /********************************************************/ 02913000
*                                                                  0852 02914000
*            IF REG15=LASTCC00    /* IF NO ERRORS                    */ 02915000
*              THEN DO;           /* THEN:                           */ 02916000
@RC00810 LTR   REG15,REG15                                         0852 02917000
         BNZ   @RF00852                                            0852 02918000
*                IF NBLKSC=ON     /* IF OUT-OF-SYNCH                 */ 02919000
*                  THEN CALL MESSAGE(0,MSGID6,0,0);                0854 02920000
         L     @14,NBLKPTR                                         0854 02921000
         TM    NBLKSC(@14),B'00100000'                             0854 02922000
         BNO   @RF00854                                            0854 02923000
         LA    @01,@AL00855                                        0855 02924000
         BAL   @14,MESSAGE                                         0855 02925000
*                                 /* THEN: PRINT O-F-S EXPORTED      */ 02926000
*                  ELSE CALL MESSAGE(0,MSGID15,0,0);               0856 02927000
         B     @RC00854                                            0856 02928000
@RF00854 LA    @01,@AL00856                                        0856 02929000
         BAL   @14,MESSAGE                                         0856 02930000
*                                 /* ELSE: PRINT EXPORTED            */ 02931000
*                END;             /*                                 */ 02932000
*              ELSE IF REG15=LASTCC04                              0858 02933000
*                                 /* ELSE: IF THE WAS A MINOR        */ 02934000
*                                 /*       ERROR                     */ 02935000
*                THEN DO;         /* THEN:                           */ 02936000
         B     @RC00852                                            0858 02937000
@RF00852 LA    @14,4                                               0858 02938000
         CR    REG15,@14                                           0858 02939000
         BNE   @RF00858                                            0858 02940000
*                  IF LASTCC<LASTCC04                              0860 02941000
*                                 /* IF THIS IS A NEW HIGH           */ 02942000
*                    THEN LASTCC=LASTCC04;                         0860 02943000
         L     @04,@PC00001+8                                      0860 02944000
         CH    @14,LASTCC(,@04)                                    0860 02945000
         BNH   @RF00860                                            0860 02946000
         STH   @14,LASTCC(,@04)                                    0861 02947000
*                                 /* THEN: SAVE THE NEW VALUE        */ 02948000
*                    ELSE;        /* ELSE: CONTINUE                  */ 02949000
@RF00860 DS    0H                                                  0863 02950000
*                  IF NBLKSC=ON   /* THEN: IF OUT-OF-SYNCH           */ 02951000
*                    THEN CALL MESSAGE(0,MSGID3,0,0);              0863 02952000
         L     @14,NBLKPTR                                         0863 02953000
         TM    NBLKSC(@14),B'00100000'                             0863 02954000
         BNO   @RF00863                                            0863 02955000
         LA    @01,@AL00864                                        0864 02956000
         BAL   @14,MESSAGE                                         0864 02957000
*                                 /* THEN: PRINT O-O-S WITH          */ 02958000
*                                 /*       MINOR ERRORS              */ 02959000
*                    ELSE CALL MESSAGE(0,MSGID2,0,0);              0865 02960000
         B     @RC00863                                            0865 02961000
@RF00863 LA    @01,@AL00865                                        0865 02962000
         BAL   @14,MESSAGE                                         0865 02963000
*                                 /* THEN: PRINT WITH MINOR          */ 02964000
*                                 /*       ERRORS                    */ 02965000
*                  END;           /*                                 */ 02966000
*                ELSE IF REG15=LASTCC08                            0867 02967000
*                                 /* ELSE: IF DATA SET NOT           */ 02968000
*                                 /*       EXPORTED                  */ 02969000
*                  THEN DO;       /* THEN:                           */ 02970000
         B     @RC00858                                            0867 02971000
@RF00858 LA    @14,8                                               0867 02972000
         CR    REG15,@14                                           0867 02973000
         BNE   @RF00867                                            0867 02974000
*                    IF LASTCC<LASTCC08                            0869 02975000
*                                 /* IF THIS IS A NEW HIGH           */ 02976000
*                      THEN LASTCC=LASTCC08;                       0869 02977000
         L     @04,@PC00001+8                                      0869 02978000
         CH    @14,LASTCC(,@04)                                    0869 02979000
         BNH   @RF00869                                            0869 02980000
         STH   @14,LASTCC(,@04)                                    0870 02981000
*                                 /* THEN: SAVE NEW VALUE            */ 02982000
*                      ELSE;      /* ELSE: CONTINUE                  */ 02983000
@RF00869 DS    0H                                                  0872 02984000
*                    IF NBLKSC=ON /* IF OUT-OF-SYNCH                 */ 02985000
*                      THEN CALL MESSAGE(0,MSGID7,0,0);            0872 02986000
         L     @14,NBLKPTR                                         0872 02987000
         TM    NBLKSC(@14),B'00100000'                             0872 02988000
         BNO   @RF00872                                            0872 02989000
         LA    @01,@AL00873                                        0873 02990000
         BAL   @14,MESSAGE                                         0873 02991000
*                                 /* THEN: PRINT O-O-S NOT           */ 02992000
*                                 /*       EXPORTED                  */ 02993000
*                      ELSE CALL MESSAGE(0,MSGID1,0,0);            0874 02994000
         B     @RC00872                                            0874 02995000
@RF00872 LA    @01,@AL00874                                        0874 02996000
         BAL   @14,MESSAGE                                         0874 02997000
*                                 /* ELSE: PRINT NOT EXPORTED        */ 02998000
*                    END;         /*                                 */ 02999000
*                  /**************************************************/ 03000000
*                  /*                                                */ 03001000
*                  /*    HANDLE THE TERMINAL ERRORS FROM EXPORT      */ 03002000
*                  /*                                                */ 03003000
*                  /**************************************************/ 03004000
*                                                                  0876 03005000
*                  ELSE DO;       /* ELSE:                           */ 03006000
         B     @RC00867                                            0876 03007000
@RF00867 DS    0H                                                  0877 03008000
*                    IF REG15=LASTCC12                             0877 03009000
*                                 /* IF THIS ERROR REQUIRES NAME     */ 03010000
*                      THEN DO;   /* THEN:                           */ 03011000
         CH    REG15,@CH00038                                      0877 03012000
         BNE   @RF00877                                            0877 03013000
*                        EXPTIX2=NBLKNAME->DSNAMLEN;               0879 03014000
         L     @14,NBLKPTR                                         0879 03015000
         L     @14,NBLKNAME(,@14)                                  0879 03016000
         LH    @04,DSNAMLEN(,@14)                                  0879 03017000
         ST    @04,EXPTIX2                                         0879 03018000
*                                 /* PICK UP THE LENGTH              */ 03019000
*                        CALL MESSAGE(0,MSGID20,NBLKNAME->DSNAM,   0880 03020000
*                                     EXPTIX2);                    0880 03021000
         LA    @04,@CF00116                                        0880 03022000
         ST    @04,@AL00001                                        0880 03023000
         LA    @04,@CH00885                                        0880 03024000
         ST    @04,@AL00001+4                                      0880 03025000
         LA    @14,DSNAM(,@14)                                     0880 03026000
         ST    @14,@AL00001+8                                      0880 03027000
         LA    @14,EXPTIX2                                         0880 03028000
         ST    @14,@AL00001+12                                     0880 03029000
         LA    @01,@AL00001                                        0880 03030000
         BAL   @14,MESSAGE                                         0880 03031000
*                                 /* PRINT THE ENTRY NAME            */ 03032000
*                        END;     /*                                 */ 03033000
*                      ELSE;                                       0882 03034000
@RF00877 DS    0H                                                  0883 03035000
*                    CALL OPENCRA(CLOSFUNC,PPARM4);                0883 03036000
         LA    @14,@CC00855                                        0883 03037000
         ST    @14,@AL00001                                        0883 03038000
         L     @14,@PC00011                                        0883 03039000
         ST    @14,@AL00001+4                                      0883 03040000
         LA    @01,@AL00001                                        0883 03041000
         BAL   @14,OPENCRA                                         0883 03042000
*                                 /* CLOSE THE CRA                   */ 03043000
*                    RETURN CODE(LASTCC16);                        0884 03044000
         LA    @15,16                                              0884 03045000
         L     @14,@SA00011                                        0884 03046000
         LM    @00,@12,@SA00011+8                                  0884 03047000
         BR    @14                                                 0884 03048000
*                                 /* RETURN WITH ERROR               */ 03049000
*                    END;         /*                                 */ 03050000
*            /********************************************************/ 03051000
*            /*                                                      */ 03052000
*            /*    HANDLE THE MESSAGES THAT RELATE REGARDLESS        */ 03053000
*            /*    OF THE RETURN CODE                                */ 03054000
*            /*                                                      */ 03055000
*            /********************************************************/ 03056000
*                                                                  0886 03057000
*            EXPTIX2=NBLKNAME->DSNAMLEN;                           0886 03058000
@RC00867 DS    0H                                                  0886 03059000
@RC00858 DS    0H                                                  0886 03060000
@RC00852 L     @14,NBLKPTR                                         0886 03061000
         L     @14,NBLKNAME(,@14)                                  0886 03062000
         LH    @04,DSNAMLEN(,@14)                                  0886 03063000
         ST    @04,EXPTIX2                                         0886 03064000
*                                 /* FORMAT LENGTH OF NAME           */ 03065000
*            CALL MESSAGE(0,MSGID20,NBLKNAME->DSNAM,EXPTIX2);      0887 03066000
         LA    @04,@CF00116                                        0887 03067000
         ST    @04,@AL00001                                        0887 03068000
         LA    @04,@CH00885                                        0887 03069000
         ST    @04,@AL00001+4                                      0887 03070000
         LA    @14,DSNAM(,@14)                                     0887 03071000
         ST    @14,@AL00001+8                                      0887 03072000
         LA    @14,EXPTIX2                                         0887 03073000
         ST    @14,@AL00001+12                                     0887 03074000
         LA    @01,@AL00001                                        0887 03075000
         BAL   @14,MESSAGE                                         0887 03076000
*                                 /* PRINT THE DSNAME                */ 03077000
*            IF NBLKMT=ON         /* IF DATA SET EMPTY               */ 03078000
*              THEN CALL MESSAGE(0,MSGID23,0,0);                   0888 03079000
         L     @14,NBLKPTR                                         0888 03080000
         TM    NBLKMT(@14),B'00010000'                             0888 03081000
         BNO   @RF00888                                            0888 03082000
         LA    @01,@AL00889                                        0889 03083000
         BAL   @14,MESSAGE                                         0889 03084000
*                                 /* THEN: PRINT MESSAGE             */ 03085000
*              ELSE;              /* ELSE: CONTINUE                  */ 03086000
@RF00888 DS    0H                                                  0891 03087000
*            END;                 /*                                 */ 03088000
*      NBLKPTR=NBLKCHN;           /* POINT AT THE NEXT BLOCK         */ 03089000
@RT00807 DS    0H                                                  0892 03090000
@RT00805 L     @14,NBLKPTR                                         0892 03091000
         L     @14,NBLKCHN(,@14)                                   0892 03092000
         ST    @14,NBLKPTR                                         0892 03093000
*      END;                       /*                                 */ 03094000
@DE00804 ICM   @14,15,NBLKPTR                                      0893 03095000
         BNZ   @DL00804                                            0893 03096000
*    END;                         /*                                 */ 03097000
*                                                                  0894 03098000
         AL    EXPTIX1,@CF00220                                    0894 03099000
         CH    EXPTIX1,@CH00287                                    0894 03100000
         BNH   @DL00802                                            0894 03101000
*  /******************************************************************/ 03102000
*  /*                                                                */ 03103000
*  /*    CLOSE THE CRA AS A CATALOG AND HANDLE THE RETURN CODE       */ 03104000
*  /*                                                                */ 03105000
*  /******************************************************************/ 03106000
*                                                                  0895 03107000
*  CALL OPENCRA(CLOSFUNC,PPARM4); /* CLOSE THE CRA AS CATALOG        */ 03108000
*                                                                  0895 03109000
         LA    @14,@CC00855                                        0895 03110000
         ST    @14,@AL00001                                        0895 03111000
         L     @14,@PC00011                                        0895 03112000
         ST    @14,@AL00001+4                                      0895 03113000
         LA    @01,@AL00001                                        0895 03114000
         BAL   @14,OPENCRA                                         0895 03115000
*  RETURN CODE(LASTCC00);         /* RETURN TO CALLER                */ 03116000
*                                                                  0896 03117000
         SLR   @15,@15                                             0896 03118000
         L     @14,@SA00011                                        0896 03119000
         LM    @00,@12,@SA00011+8                                  0896 03120000
         BR    @14                                                 0896 03121000
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */ 03122000
*                                                                  0897 03123000
*  END EXPORTDR;                  /* END OF PROCEDURE                */ 03124000
@PB00011 DS    0H                                                  0899 03125000
*  GEN (EJECT);                                                    0899 03126000
         EJECT                                                          03127000
*  /******************************************************************/ 03128000
*  /*                                                                */ 03129000
*  /* PROCEDURE NAME:                                                */ 03130000
*  /*    EXTRACT                                                     */ 03131000
*  /*                                                                */ 03132000
*  /* FUNCTION:                                                      */ 03133000
*  /*    THIS ROUTINE PROVIDES THE INTERFACE WITH AMS'S FIELD        */ 03134000
*  /*    MANAGEMENT ROUTINES (IDCRC04) TO GET INFORMATION FROM       */ 03135000
*  /*    THE CATALOG RECORDS                                         */ 03136000
*  /*                                                                */ 03137000
*  /* REQUIREMENTS:                                                  */ 03138000
*  /*                                                                */ 03139000
*  /*    1. IDCRC03 IS REQUIRED TO DO THE NECESSARY I/O FOR THE      */ 03140000
*  /*       RECORDS IN THE CRA                                       */ 03141000
*  /*                                                                */ 03142000
*  /******************************************************************/ 03143000
*                                                                  0900 03144000
*EXTRACT: PROCEDURE(FLDNO,FLD0,FLDI1,FLDI2,FLD01,FLD02,FLD1,       0900 03145000
*                   FLD1A,FLD2,FLD3,FLD3A,FLD4,FLD5);              0900 03146000
*                                                                  0900 03147000
         B     @PB00012                                            0900 03148000
EXTRACT  STM   @14,@12,@SA00012                                    0900 03149000
         MVC   @PC00012(52),0(@01)                                 0900 03150000
*  /******************************************************************/ 03151000
*  /*                                                                */ 03152000
*  /*    THIS IS A DESCRIPTION OF THE PARAMETERS                     */ 03153000
*  /*                                                                */ 03154000
*  /******************************************************************/ 03155000
*                                                                  0901 03156000
*  DCL FLDNO    PTR(31);          /* NUMBER OF TESTS PRESENT         */ 03157000
*  DCL FLD0     PTR(24);          /* BEGINING CI NUMBER              */ 03158000
*  DCL FLDI1    PTR(31);          /* ADDRESS OF AREA TO USE          */ 03159000
*  DCL FLDI2    FIXED(31);        /* LENGTH OF AREA TO USE           */ 03160000
*  DCL FLD01    PTR(31);          /* ADDRESS OF THE DATA             */ 03161000
*  DCL FLD02    PTR(31);          /* LENGTH OF STRING OF DATA        */ 03162000
*  DCL FLD1     CHAR(8);          /* FUNCTION DESIRED                */ 03163000
*  DCL FLD1A    BIT(8);           /* BASE GROUP CODE                 */ 03164000
*  DCL FLD2     CHAR(8);          /* TEST FUNCTION 1 DESIRED         */ 03165000
*  DCL FLD3     FIXED(8);         /* TEST CONDITION 1                */ 03166000
*  DCL FLD3A    BIT(8);           /* TEST GROUP CODE                 */ 03167000
*  DCL FLD4     PTR(31);          /* ADDRESS OF TEST DATA            */ 03168000
*  DCL FLD5     FIXED(31);        /* LENGTH OF TEST DATA             */ 03169000
*  /******************************************************************/ 03170000
*  /*                                                                */ 03171000
*  /*    THESE ARE THE FMPL, FMFL'S AND WORK AREAS                   */ 03172000
*  /*                                                                */ 03173000
*  /******************************************************************/ 03174000
*                                                                  0914 03175000
*  DCL FMPLAR   CHAR(LENGTH(FMPL)+LENGTH(FMPLFMFL));               0914 03176000
*                                 /* AREA FOR THE FMPL               */ 03177000
*  DCL 1 FMFLAR1     BDY(WORD),   /* AREA FOR FIRST FMFL             */ 03178000
*        2 *         CHAR(LENGTH(FMFL)),                           0915 03179000
*        2 *         CHAR(LENGTH(FMFLDATA));                       0915 03180000
*                                                                  0915 03181000
*  DCL 1 FMFLAR2     BDY(WORD),   /* AREA FOR SECOND FMFL            */ 03182000
*        2 *         CHAR(LENGTH(FMFL)),                           0916 03183000
*        2 *         CHAR(LENGTH(FMFLDATA));                       0916 03184000
*                                                                  0916 03185000
*  DCL OARA     CHAR(256) BDY(WORD);                               0917 03186000
*                                 /* OUTPUT AREA                     */ 03187000
*  DCL WKA256   CHAR(256) BDY(WORD);                               0918 03188000
*                                 /* FIELD MANAGEMENT WORK AREA      */ 03189000
*  DCL FMFLCUR  PTR(31);          /* BASE FOR FMFL STRUCTERS         */ 03190000
*  DCL FMPLAD   PTR(31);          /* BASE FOR FMPL STRUCTERS         */ 03191000
*                                                                  0920 03192000
*  /******************************************************************/ 03193000
*  /*                                                                */ 03194000
*  /*    EXTERNAL ROUTINES NEEDED TO DO FIELD MANAGEMENT             */ 03195000
*  /*                                                                */ 03196000
*  /******************************************************************/ 03197000
*                                                                  0921 03198000
*  DCL IDCRC03  EXTERNAL ENTRY;   /* I/O ROUTINE TO GET RECORDS      */ 03199000
*  DCL IDCRC04  EXTERNAL ENTRY;   /* FIELD MANAGEMENT ROUTINES       */ 03200000
*                                                                  0922 03201000
*  /******************************************************************/ 03202000
*  /*                                                                */ 03203000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 03204000
*  /*                                                                */ 03205000
*  /******************************************************************/ 03206000
*                                                                  0923 03207000
*  OLDERID2 = NEWERID2;                                            0923 03208000
         L     @04,@PC00001                                        0923 03209000
         L     @02,GDTTR2(,@04)                                    0923 03210000
         MVC   @TS00001(95),NEWERID2(@02)                          0923 03211000
         MVC   OLDERID2(95,@02),@TS00001                           0923 03212000
*  NEWID2='RC90';                                                  0924 03213000
         MVC   NEWID2(4,@02),@CC01243                              0924 03214000
*  IF GDTDBG = NULLPTR                                             0925 03215000
*    THEN;                                                         0925 03216000
         ICM   @02,15,GDTDBG(@04)                                  0925 03217000
         BZ    @RT00925                                            0925 03218000
*    ELSE                                                          0927 03219000
*      CALL IDCDB010 (GDTTBL,'RC90');                              0927 03220000
         L     @04,@PC00001                                        0927 03221000
         ST    @04,@AL00001                                        0927 03222000
         LA    @02,@CC01243                                        0927 03223000
         ST    @02,@AL00001+4                                      0927 03224000
         MVI   @AL00001+4,X'80'                                    0927 03225000
         L     @15,GDTDBG(,@04)                                    0927 03226000
         LA    @01,@AL00001                                        0927 03227000
         BALR  @14,@15                                             0927 03228000
*  /******************************************************************/ 03229000
*  /*                                                                */ 03230000
*  /*    INITIALIZE THE FMPL                                         */ 03231000
*  /*                                                                */ 03232000
*  /******************************************************************/ 03233000
*                                                                  0928 03234000
*  FMPLAD=ADDR(FMPLAR);           /* POINT AT FMPL                   */ 03235000
@RT00925 LA    FMPLAD,FMPLAR                                       0928 03236000
*  FMPLFLNO=1;                    /* INITIALIZE NUMBER OF FMFLS      */ 03237000
         MVI   FMPLFLNO(FMPLAD),X'01'                              0929 03238000
*  FMPLBCIN=FLD0;                 /* PLACE THE CI NUMBER             */ 03239000
         L     @02,@PC00012+4                                      0930 03240000
         MVC   FMPLBCIN(3,FMPLAD),FLD0(@02)                        0930 03241000
*  FMPLGRTN=ADDR(IDCRC03);        /* POINT AT I/O ROUTINE            */ 03242000
         L     @02,@CV01241                                        0931 03243000
         ST    @02,FMPLGRTN(,FMPLAD)                               0931 03244000
*  FMPLWKAR=ADDR(WKA256);         /* POINT AT THE WORK AREA          */ 03245000
         LA    @02,WKA256                                          0932 03246000
         ST    @02,FMPLWKAR(,FMPLAD)                               0932 03247000
*  FMPLUPTR=ADDR(BUFS);           /* PASS THE BUFFER POOL            */ 03248000
         ST    BUFSPTR,FMPLUPTR(,FMPLAD)                           0933 03249000
*  FMPLFMFL(1)=ADDR(FMFLAR1);     /* POINT AT THE FMFL TO USE        */ 03250000
         LA    @02,FMFLAR1                                         0934 03251000
         ST    @02,FMPLFMFL(,FMPLAD)                               0934 03252000
*  IF FLDI1=NULLPTR               /* IF THERE IS NONE SUPPLIED       */ 03253000
*    THEN DO;                     /* THEN:                           */ 03254000
         L     @02,@PC00012+8                                      0935 03255000
         ICM   @15,15,FLDI1(@02)                                   0935 03256000
         BNZ   @RF00935                                            0935 03257000
*      FMPLENTH=LENGTH(OARA);     /* PLACE OUTPUT AREA LENGTH        */ 03258000
         MVC   FMPLENTH(2,FMPLAD),@CH01239                         0937 03259000
*      FMPLOAR=ADDR(OARA);        /* POINT AT THE OUTPUT AREA        */ 03260000
         LA    @02,OARA                                            0938 03261000
         ST    @02,FMPLOAR(,FMPLAD)                                0938 03262000
*      END;                       /*                                 */ 03263000
*    ELSE DO;                     /* ELSE:                           */ 03264000
         B     @RC00935                                            0940 03265000
@RF00935 DS    0H                                                  0941 03266000
*      FMPLOAR=FLDI1;             /* PLACE AREA ADDRESS              */ 03267000
         L     @02,@PC00012+8                                      0941 03268000
         MVC   FMPLOAR(4,FMPLAD),FLDI1(@02)                        0941 03269000
*      FMPLENTH=FLDI2;            /* PLACE AREA LENGTH               */ 03270000
         L     @02,@PC00012+12                                     0942 03271000
         MVC   FMPLENTH(2,FMPLAD),FLDI2+2(@02)                     0942 03272000
*      END;                       /*                                 */ 03273000
*                                                                  0943 03274000
*  /******************************************************************/ 03275000
*  /*                                                                */ 03276000
*  /*    SET UP INFORMATION FOR IDCRC03                              */ 03277000
*  /*                                                                */ 03278000
*  /******************************************************************/ 03279000
*                                                                  0944 03280000
*  BUFIOCS=CRVIOSTR;              /* POINT AT THE IOCSTR FOR         */ 03281000
@RC00935 MVC   BUFIOCS(4,BUFSPTR),CRVIOSTR(CRVEBASE)               0944 03282000
*                                 /* THIS REQUEST                    */ 03283000
*  BUFCTT=CRVADCTT;               /* POINT AT THE TRANSLATE          */ 03284000
         MVC   BUFCTT(4,BUFSPTR),CRVADCTT(CRVEBASE)                0945 03285000
*                                 /* TABLE FOR THIS REQUEST          */ 03286000
*  /******************************************************************/ 03287000
*  /*                                                                */ 03288000
*  /*    INITIALIZE THE BASE FMFL                                    */ 03289000
*  /*                                                                */ 03290000
*  /******************************************************************/ 03291000
*                                                                  0946 03292000
*  FMFLCUR=ADDR(FMFLAR1);         /* POINT AT FIRST FMFL             */ 03293000
         LA    FMFLCUR,FMFLAR1                                     0946 03294000
*  FMFLDLNO=0;                    /* ZERO THE NUMBER OF FIELDS       */ 03295000
         MVI   FMFLDLNO(FMFLCUR),X'00'                             0947 03296000
*  FMFLTSTC=0;                    /* ZERO THE TEST CONDITION         */ 03297000
         MVI   FMFLTSTC(FMFLCUR),X'00'                             0948 03298000
*  FMFLGRPC=FLD1A;                /* ZERO THE GROUP CODE             */ 03299000
         L     @15,@PC00012+28                                     0949 03300000
         MVC   FMFLGRPC(1,FMFLCUR),FLD1A(@15)                      0949 03301000
*  FMFLINDS=0;                    /* ZERO THE INDICATORS             */ 03302000
         MVI   FMFLINDS(FMFLCUR),X'00'                             0950 03303000
*  FMFLDNAM=ADDR(FLD1);           /* POINT AT THE FIELD NAME         */ 03304000
         L     @15,@PC00012+24                                     0951 03305000
         ST    @15,FMFLDNAM(,FMFLCUR)                              0951 03306000
*  FMFLTCHN=NULLPTR;              /* INDICATE NO TEST FMFL           */ 03307000
         SLR   @15,@15                                             0952 03308000
         ST    @15,FMFLTCHN(,FMFLCUR)                              0952 03309000
*  /******************************************************************/ 03310000
*  /*                                                                */ 03311000
*  /*    HANDLE A TEST FMFL IF IT IS NECESSARY                       */ 03312000
*  /*                                                                */ 03313000
*  /******************************************************************/ 03314000
*                                                                  0953 03315000
*  IF FLDNO=0                     /* IF THERE IS NO TEST FMFL        */ 03316000
*    THEN;                        /* THEN: CONTINUE                  */ 03317000
         L     @14,@PC00012                                        0953 03318000
         C     @15,FLDNO(,@14)                                     0953 03319000
         BE    @RT00953                                            0953 03320000
*    ELSE DO;                     /* ELSE:                           */ 03321000
*      FMFLTCHN=ADDR(FMFLAR2);    /* ADD FMFL TO TEST CHAIN          */ 03322000
         LA    @15,FMFLAR2                                         0956 03323000
         ST    @15,FMFLTCHN(,FMFLCUR)                              0956 03324000
*      FMFLCUR=ADDR(FMFLAR2);     /* SET BASE TO TEST FMFL           */ 03325000
         LR    FMFLCUR,@15                                         0957 03326000
*      FMFLDLNO=1;                /* SET NUMBER OF FIELDS            */ 03327000
         MVI   FMFLDLNO(FMFLCUR),X'01'                             0958 03328000
*      FMFLTSTC=FLD3;             /* PLACE TEST CONDITION            */ 03329000
         L     @15,@PC00012+36                                     0959 03330000
         MVC   FMFLTSTC(1,FMFLCUR),FLD3(@15)                       0959 03331000
*      FMFLGRPC=FLD3A;            /* ZERO THE GROUP CODE             */ 03332000
         L     @15,@PC00012+40                                     0960 03333000
         MVC   FMFLGRPC(1,FMFLCUR),FLD3A(@15)                      0960 03334000
*      FMFLINDS=0;                /* ZERO THE INDICATORS             */ 03335000
         MVI   FMFLINDS(FMFLCUR),X'00'                             0961 03336000
*      FMFLDNAM=ADDR(FLD2);       /* POINT AT FIELD NAME             */ 03337000
         L     @15,@PC00012+32                                     0962 03338000
         ST    @15,FMFLDNAM(,FMFLCUR)                              0962 03339000
*      FMFLTCHN=NULLPTR;          /* INDICATE END OF CHAIN           */ 03340000
         SLR   @15,@15                                             0963 03341000
         ST    @15,FMFLTCHN(,FMFLCUR)                              0963 03342000
*      FMFLENTH(1)=FLD5;          /* PLACE LENGTH OF DATA            */ 03343000
         L     @15,@PC00012+48                                     0964 03344000
         MVC   FMFLENTH(4,FMFLCUR),FLD5(@15)                       0964 03345000
*      FMFLADDR(1)=FLD4;          /* POINT AT THE DATA               */ 03346000
         L     @15,@PC00012+44                                     0965 03347000
         MVC   FMFLADDR(4,FMFLCUR),FLD4(@15)                       0965 03348000
*      END;                       /*                                 */ 03349000
*                                                                  0966 03350000
*  /******************************************************************/ 03351000
*  /*                                                                */ 03352000
*  /*    GO TO FIELD MANAGEMENT TO GET THE DATA                      */ 03353000
*  /*                                                                */ 03354000
*  /******************************************************************/ 03355000
*                                                                  0967 03356000
*  RFY REG1 RSTD;                 /* RESTRICT THE REGISTER           */ 03357000
@RT00953 DS    0H                                                  0968 03358000
*  REG1=ADDR(FMPLAR);             /* POINT AT THE FMPL               */ 03359000
         LA    REG1,FMPLAR                                         0968 03360000
*  CALL IDCRC04;                  /* GO TO FIELD MANAGEMENT          */ 03361000
         L     @15,@CV01242                                        0969 03362000
         BALR  @14,@15                                             0969 03363000
*  RFY REG1 UNRSTD;               /* RELEASE THE REGISTER            */ 03364000
*                                                                  0970 03365000
*  /******************************************************************/ 03366000
*  /*                                                                */ 03367000
*  /*    RETURN THE INFORMATION TO THE CALLER                        */ 03368000
*  /*                                                                */ 03369000
*  /******************************************************************/ 03370000
*                                                                  0971 03371000
*  FMFLCUR=ADDR(FMFLAR1);         /* POINT AT THE FMFL               */ 03372000
         LA    FMFLCUR,FMFLAR1                                     0971 03373000
*  FLD02=FMFLENTH(1);             /* RETURN THE DATA LENGTH          */ 03374000
         L     @15,@PC00012+20                                     0972 03375000
         MVC   FLD02(4,@15),FMFLENTH(FMFLCUR)                      0972 03376000
*  FLD01=FMFLADDR(1);             /* RETURN THE DATA ADDRESS         */ 03377000
*                                                                  0973 03378000
         L     @15,@PC00012+16                                     0973 03379000
         MVC   FLD01(4,@15),FMFLADDR(FMFLCUR)                      0973 03380000
*  RETURN CODE(FMPLRTCD);         /* RETURN ERROR CODE IF ANY        */ 03381000
*                                                                  0974 03382000
         SLR   @15,@15                                             0974 03383000
         IC    @15,FMPLRTCD(,FMPLAD)                               0974 03384000
         L     @14,@SA00012                                        0974 03385000
         LM    @00,@12,@SA00012+8                                  0974 03386000
         BR    @14                                                 0974 03387000
*  END EXTRACT;                   /* END OF PROCEDURE                */ 03388000
@PB00012 DS    0H                                                  0976 03389000
*  GEN (EJECT);                                                    0976 03390000
         EJECT                                                          03391000
*  /******************************************************************/ 03392000
*  /*                                                                */ 03393000
*  /* PROCEDURE NAME:                                                */ 03394000
*  /*    INIT                                                        */ 03395000
*  /*                                                                */ 03396000
*  /* FUNCTION:                                                      */ 03397000
*  /*    THIS ROUTINE PROVIDES THE FOLLOWING FUNCTIONS               */ 03398000
*  /*                                                                */ 03399000
*  /*    1. INITIALIZES THE RETURN CODE.                             */ 03400000
*  /*                                                                */ 03401000
*  /*    2. INITIALIZES THE 'SUBSP' PROCEDURE SO IT CAN HANDLE       */ 03402000
*  /*       THE SUBALLOCATION OF SPACE.                              */ 03403000
*  /*                                                                */ 03404000
*  /*    3. INITIALIZES THE DATA IN THE FMPL THAT HAS TO DO          */ 03405000
*  /*       WITH THE BUFFER POOL AND WORK AREA USED BY IDCRC03       */ 03406000
*  /*       TO HANDLE FIELD MANAGEMENT REQUESTS.                     */ 03407000
*  /*                                                                */ 03408000
*  /*    4. ENQUEUE ON THE PROGRAM NAME TO ENSURE THAT THERE         */ 03409000
*  /*       IS ONLY ONE COPY IN THE SYSTEM ACTIVE AT ONE TIME.       */ 03410000
*  /*                                                                */ 03411000
*  /*    5. INITIALIZE POINTER TO PARAMETER LIST OF IDCRC02.         */ 03412000
*  /*                                                                */ 03413000
*  /* REQUIREMENTS:                                                  */ 03414000
*  /*                                                                */ 03415000
*  /******************************************************************/ 03416000
*                                                                  0977 03417000
*INIT: PROCEDURE;                                                  0977 03418000
*                                                                  0977 03419000
         B     @PB00013                                            0977 03420000
INIT     STM   @14,@01,@SA00013                                    0977 03421000
         STM   @03,@04,@SA00013+16                                 0977 03422000
         STM   @06,@12,@SA00013+24                                 0977 03423000
*  /******************************************************************/ 03424000
*  /*                                                                */ 03425000
*  /*    DECLARATIONS TO INITIALIZE THE BUFFER POOL TO USE           */ 03426000
*  /*    THE FIELD MANAGEMENT ROUTINES                               */ 03427000
*  /*                                                                */ 03428000
*  /******************************************************************/ 03429000
*                                                                  0978 03430000
*  DCL BUFSAR        CHAR(LENGTH(BUFS))   BDY(WORD);               0978 03431000
*  DCL BUFWKAR1      CHAR(256) BDY(WORD);                          0979 03432000
*                                                                  0979 03433000
*  /******************************************************************/ 03434000
*  /*                                                                */ 03435000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 03436000
*  /*                                                                */ 03437000
*  /******************************************************************/ 03438000
*                                                                  0980 03439000
*  OLDERID2 = NEWERID2;                                            0980 03440000
         L     @15,@PC00001                                        0980 03441000
         L     @14,GDTTR2(,@15)                                    0980 03442000
         MVC   @TS00001(95),NEWERID2(@14)                          0980 03443000
         MVC   OLDERID2(95,@14),@TS00001                           0980 03444000
*  NEWID2='RC80';                                                  0981 03445000
         MVC   NEWID2(4,@14),@CC01249                              0981 03446000
*  IF GDTDBG = NULLPTR                                             0982 03447000
*    THEN;                                                         0982 03448000
         ICM   @14,15,GDTDBG(@15)                                  0982 03449000
         BZ    @RT00982                                            0982 03450000
*    ELSE                                                          0984 03451000
*      CALL IDCDB010 (GDTTBL,'RC80');                              0984 03452000
         L     @15,@PC00001                                        0984 03453000
         ST    @15,@AL00001                                        0984 03454000
         LA    @14,@CC01249                                        0984 03455000
         ST    @14,@AL00001+4                                      0984 03456000
         MVI   @AL00001+4,X'80'                                    0984 03457000
         L     @15,GDTDBG(,@15)                                    0984 03458000
         LA    @01,@AL00001                                        0984 03459000
         BALR  @14,@15                                             0984 03460000
*  /******************************************************************/ 03461000
*  /*                                                                */ 03462000
*  /*    INITIALIZE THE RETURN CODE                                  */ 03463000
*  /*                                                                */ 03464000
*  /******************************************************************/ 03465000
*                                                                  0985 03466000
*  LASTCC=LASTCC00;               /* INITIALIZE NORMAL RETURN        */ 03467000
@RT00982 L     @15,@PC00001+8                                      0985 03468000
         SLR   @14,@14                                             0985 03469000
         STH   @14,LASTCC(,@15)                                    0985 03470000
*                                 /* CODE                            */ 03471000
*                                                                  0986 03472000
*  /******************************************************************/ 03473000
*  /*                                                                */ 03474000
*  /*    INITIALIZE THE SUPSP FUNCTION                               */ 03475000
*  /*                                                                */ 03476000
*  /******************************************************************/ 03477000
*                                                                  0986 03478000
*  CALL SUBSP (INITYPE);          /* GO TO INITIALIZE ROUTINE        */ 03479000
*                                                                  0986 03480000
         LA    @01,@AL00986                                        0986 03481000
         BAL   @14,SUBSP                                           0986 03482000
*  /******************************************************************/ 03483000
*  /*                                                                */ 03484000
*  /*    INITIALIZE THE BUFFER POOL FOR FIELD MANAGEMENT             */ 03485000
*  /*                                                                */ 03486000
*  /******************************************************************/ 03487000
*                                                                  0987 03488000
*  BUFSPTR=ADDR(BUFSAR);          /* POINT AT THE I/O VECTOR         */ 03489000
         LA    BUFSPTR,BUFSAR                                      0987 03490000
*  BUFGDT=ADDR(GDTTBL);           /* POINT AT THE GDT                */ 03491000
         L     @04,@PC00001                                        0988 03492000
         ST    @04,BUFGDT(,BUFSPTR)                                0988 03493000
*  BUFWKARA=ADDR(BUFWKAR1);       /* POINT AT WORK AREA              */ 03494000
         LA    @03,BUFWKAR1                                        0989 03495000
         ST    @03,BUFWKARA(,BUFSPTR)                              0989 03496000
*  BUFSWS=''B;                    /* ZERO SWITCHES                   */ 03497000
*                                                                  0990 03498000
         XC    BUFSWS(2,BUFSPTR),BUFSWS(BUFSPTR)                   0990 03499000
*  /******************************************************************/ 03500000
*  /*                                                                */ 03501000
*  /*    ENQUEUE ON THE PROGRAM RESOURSE SO THAT ONLY ONE            */ 03502000
*  /*    COPY OF EXPORTRA CAN BE RUNNING AT A TIME                   */ 03503000
*  /*                                                                */ 03504000
*  /******************************************************************/ 03505000
*                                                                  0991 03506000
*  CALL IDCSANQ0 (GDTTBL,EXCL,WAIT,SYSTEM,PROGRAM);                0991 03507000
         MVC   @AL00001+4(16),@AL00991                             0991 03508000
         ST    @04,@AL00001                                        0991 03509000
         L     @15,GDTENQ(,@04)                                    0991 03510000
         LA    @01,@AL00001                                        0991 03511000
         BALR  @14,@15                                             0991 03512000
*                                 /* ENQUEUE ON THIS PROGRAM         */ 03513000
*                                                                  0992 03514000
*  /******************************************************************/ 03515000
*  /*                                                                */ 03516000
*  /*    INITIALIZE THE POINTER TO THE PARAMETER LIST FOR THE        */ 03517000
*  /*    CALL TO IDCRC02                                             */ 03518000
*  /*                                                                */ 03519000
*  /******************************************************************/ 03520000
*                                                                  0992 03521000
*  INPPTR=NULLPTR;                /* CLEAR THE POINTER               */ 03522000
*                                                                  0992 03523000
         SLR   @04,@04                                             0992 03524000
         ST    @04,INPPTR                                          0992 03525000
*  /******************************************************************/ 03526000
*  /*                                                                */ 03527000
*  /*    INITIALIZE THE CORE MESSAGE INDICATOR AND DATASET   @OZ18993*/ 03528000
*  /*    EXPORTED INDICATOR.                                 @OZ18993*/ 03529000
*  /*                                                                */ 03530000
*  /******************************************************************/ 03531000
*                                                                  0993 03532000
*  CORE=GOOD;                     /* SET TO GOOD VALUE               */ 03533000
         MVC   CORE(1),GOOD                                        0993 03534000
*  EXPORTED = 8;                  /* NOTHING EXPORTED        @OZ18993*/ 03535000
*                                                                  0994 03536000
         LA    EXPORTED,8                                          0994 03537000
*  END INIT;                      /* END OF PROCEDURE                */ 03538000
@EL00013 DS    0H                                                  0995 03539000
@EF00013 DS    0H                                                  0995 03540000
@ER00013 LM    @14,@01,@SA00013                                    0995 03541000
         LM    @03,@04,@SA00013+16                                 0995 03542000
         LM    @06,@12,@SA00013+24                                 0995 03543000
         BR    @14                                                 0995 03544000
@PB00013 DS    0H                                                  0996 03545000
*  GEN (EJECT);                                                    0996 03546000
         EJECT                                                          03547000
*  /******************************************************************/ 03548000
*  /*                                                                */ 03549000
*  /* PROCEDURE NAME:                                                */ 03550000
*  /*    MESSAGE                                                     */ 03551000
*  /*                                                                */ 03552000
*  /* FUNCTION:                                                      */ 03553000
*  /*                                                                */ 03554000
*  /*    THIS ROUTINE INTERFACES WITH THE TEXT PROCESSOR FOR         */ 03555000
*  /*    AMS TO BUILD THE DARGLIST                                   */ 03556000
*  /*                                                                */ 03557000
*  /* REQUIREMENTS:                                                  */ 03558000
*  /*                                                                */ 03559000
*  /*    NONE                                                        */ 03560000
*  /*                                                                */ 03561000
*  /******************************************************************/ 03562000
*                                                                  0997 03563000
*MESSAGE: PROCEDURE (MESSAGE0,MESSAGE1,MESSAGE2,MESSAGE3,          0997 03564000
*                    MESSAGE4,MESSAGE5);                           0997 03565000
*                                                                  0997 03566000
         B     @PB00014                                            0997 03567000
MESSAGE  STM   @14,@12,@SA00014                                    0997 03568000
         MVC   @PC00014(24),0(@01)                                 0997 03569000
*  DCL MESSAGE0  FIXED(31);       /* TYPE OF FORMATED BLOCK          */ 03570000
*  DCL MESSAGE1  FIXED(15);       /* TEXT ID NUMBER                  */ 03571000
*  DCL MESSAGE2  CHAR(*);         /* ADDRESS OF THE DATA BLOCK       */ 03572000
*  DCL MESSAGE3  FIXED(31);       /* LENGTH OF THE DATA BLOCK        */ 03573000
*  DCL MESSAGE4  CHAR(*);         /* ADDRESS OF THE DATA BLOCK       */ 03574000
*  DCL MESSAGE5  FIXED(31);       /* LENGTH OF THE DATA BLOCK        */ 03575000
*  DCL DDSTRU1   CHAR(LENGTH(DARGLIST)+2*LENGTH(DARGARY)) BDY(WORD);    03576000
*                                 /* INTERFACE BLOCK TO MESSAGE      */ 03577000
*                                 /* ROUTINES                        */ 03578000
*                                                                  1005 03579000
*  /******************************************************************/ 03580000
*  /*                                                                */ 03581000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 03582000
*  /*                                                                */ 03583000
*  /******************************************************************/ 03584000
*                                                                  1005 03585000
*  OLDERID2 = NEWERID2;                                            1005 03586000
         L     @15,@PC00001                                        1005 03587000
         L     @14,GDTTR2(,@15)                                    1005 03588000
         MVC   @TS00001(95),NEWERID2(@14)                          1005 03589000
         MVC   OLDERID2(95,@14),@TS00001                           1005 03590000
*  NEWID2='RC89';                                                  1006 03591000
         MVC   NEWID2(4,@14),@CC01266                              1006 03592000
*  IF GDTDBG = NULLPTR                                             1007 03593000
*    THEN;                                                         1007 03594000
         ICM   @14,15,GDTDBG(@15)                                  1007 03595000
         BZ    @RT01007                                            1007 03596000
*    ELSE                                                          1009 03597000
*      CALL IDCDB010 (GDTTBL,'RC89');                              1009 03598000
         L     @15,@PC00001                                        1009 03599000
         ST    @15,@AL00001                                        1009 03600000
         LA    @14,@CC01266                                        1009 03601000
         ST    @14,@AL00001+4                                      1009 03602000
         MVI   @AL00001+4,X'80'                                    1009 03603000
         L     @15,GDTDBG(,@15)                                    1009 03604000
         LA    @01,@AL00001                                        1009 03605000
         BALR  @14,@15                                             1009 03606000
*  /******************************************************************/ 03607000
*  /*                                                                */ 03608000
*  /*    POINT AT AND INITIALIZE THE UNUSED PORTION OF THE           */ 03609000
*  /*    BLOCK TO COMMUNICATE ABOUT THE MESSAGE TO PRINT             */ 03610000
*  /*                                                                */ 03611000
*  /******************************************************************/ 03612000
*                                                                  1010 03613000
*  DDSTRU=ADDR(DDSTRU1);          /* SET UP THE BASE ADDRESS         */ 03614000
*                                                                  1010 03615000
@RT01007 LA    @15,DDSTRU1                                         1010 03616000
         ST    @15,DDSTRU                                          1010 03617000
*  DARGRETP=0;                    /* INITIALIZE TO ZERO              */ 03618000
         SLR   @14,@14                                             1011 03619000
         ST    @14,DARGRETP(,@15)                                  1011 03620000
*  DARGCNT=0;                     /* INITIALIZE TO ZERO              */ 03621000
         STH   @14,DARGCNT(,@15)                                   1012 03622000
*  DARGRETL=0;                    /* INITIALIZE TO ZERO              */ 03623000
         STH   @14,DARGRETL(,@15)                                  1013 03624000
*  DARGIND=0;                     /* INITIALIZE TO ZERO              */ 03625000
         MVI   DARGIND(@15),X'00'                                  1014 03626000
*  DARGDBP=0;                     /* INITIALIZE TO ZERO              */ 03627000
         ST    @14,DARGDBP(,@15)                                   1015 03628000
*  DARGILP=0;                     /* INITIALIZE TO ZERO              */ 03629000
*                                                                  1016 03630000
         STH   @14,DARGILP(,@15)                                   1016 03631000
*  /******************************************************************/ 03632000
*  /*                                                                */ 03633000
*  /*    FILL IN THE MESSAGE ID AND THE MODULE ID                    */ 03634000
*  /*                                                                */ 03635000
*  /******************************************************************/ 03636000
*                                                                  1017 03637000
*  IF MESSAGE1>UV0IDNO            /* IF NOT EXPORTRA MESSAGE         */ 03638000
*    THEN IF MESSAGE1>XP0IDNO     /* THEN: IF EXPORT MESSAGE         */ 03639000
         L     @14,@PC00014+4                                      1017 03640000
         LH    @14,MESSAGE1(,@14)                                  1017 03641000
         CH    @14,@CH00898                                        1017 03642000
         BNH   @RF01017                                            1017 03643000
*      THEN DO;                   /* THEN:                           */ 03644000
         LA    @07,100                                             1018 03645000
         CR    @14,@07                                             1018 03646000
         BNH   @RF01018                                            1018 03647000
*        DARGSMOD=XP0MODID;       /* PLACE MODULE ID                 */ 03648000
         MVC   DARGSMOD(3,@15),@CC00908                            1020 03649000
*        DARGSENT=MESSAGE1-XP0IDNO;                                1021 03650000
         SLR   @14,@07                                             1021 03651000
         STC   @14,DARGSENT(,@15)                                  1021 03652000
*                                 /* PLACE MESSAGE NUMBER            */ 03653000
*        END;                     /*                                 */ 03654000
*      ELSE DO;                   /* ELSE:                           */ 03655000
         B     @RC01018                                            1023 03656000
@RF01018 DS    0H                                                  1024 03657000
*        DARGSMOD=UV0MODID;       /* PLACE MODULE ID                 */ 03658000
         L     @15,DDSTRU                                          1024 03659000
         MVC   DARGSMOD(3,@15),UV0MODID                            1024 03660000
*        DARGSENT=MESSAGE1-UV0IDNO;                                1025 03661000
         L     @14,@PC00014+4                                      1025 03662000
         LH    @14,MESSAGE1(,@14)                                  1025 03663000
         SH    @14,@CH00898                                        1025 03664000
         STC   @14,DARGSENT(,@15)                                  1025 03665000
*                                 /* PLACE MESSAGE NUMBER            */ 03666000
*        END;                     /*                                 */ 03667000
*    ELSE DO;                     /* ELSE:                           */ 03668000
         B     @RC01017                                            1027 03669000
@RF01017 DS    0H                                                  1028 03670000
*      DARGSMOD=MODID(1:3);       /* PLACE THE TEXT MODULE ID        */ 03671000
         L     @15,DDSTRU                                          1028 03672000
         MVC   DARGSMOD(3,@15),MODID                               1028 03673000
*      DARGSENT=MESSAGE1;         /* PLACE THE TEXT ID               */ 03674000
         L     @14,@PC00014+4                                      1029 03675000
         MVC   DARGSENT(1,@15),MESSAGE1+1(@14)                     1029 03676000
*      END;                       /*                                 */ 03677000
*  /******************************************************************/ 03678000
*  /*                                                                */ 03679000
*  /*    FILL IN THE SINGLE DATA BLOCK FORMAT OF THE CALL            */ 03680000
*  /*                                                                */ 03681000
*  /******************************************************************/ 03682000
*                                                                  1031 03683000
*  IF MESSAGE0<2                  /* IF SINGLE BLOCK DATA            */ 03684000
*    THEN DO;                     /* THEN:                           */ 03685000
@RC01017 L     @15,@PC00014                                        1031 03686000
         L     @15,MESSAGE0(,@15)                                  1031 03687000
         CH    @15,@CH00154                                        1031 03688000
         BNL   @RF01031                                            1031 03689000
*      IF MESSAGE3=0              /* IF NO MESSAGE PASSED            */ 03690000
*        THEN DARGDBP=NULLPTR;    /* THEN: PLACE NULL POINTER        */ 03691000
         SLR   @15,@15                                             1033 03692000
         L     @14,@PC00014+12                                     1033 03693000
         C     @15,MESSAGE3(,@14)                                  1033 03694000
         BNE   @RF01033                                            1033 03695000
         L     @14,DDSTRU                                          1034 03696000
         ST    @15,DARGDBP(,@14)                                   1034 03697000
*        ELSE DARGDBP=ADDR(MESSAGE2);                              1035 03698000
         B     @RC01033                                            1035 03699000
@RF01033 L     @15,@PC00014+8                                      1035 03700000
         L     @14,DDSTRU                                          1035 03701000
         ST    @15,DARGDBP(,@14)                                   1035 03702000
*                                 /* ELSE: POINT AT DATA             */ 03703000
*      DARGILP=MESSAGE3;          /* PLACE DATA LENGTH               */ 03704000
@RC01033 L     @15,@PC00014+12                                     1036 03705000
         L     @01,DDSTRU                                          1036 03706000
         MVC   DARGILP(2,@01),MESSAGE3+2(@15)                      1036 03707000
*      END;                       /*                                 */ 03708000
*                                                                  1037 03709000
*    /****************************************************************/ 03710000
*    /*                                                              */ 03711000
*    /*    FILL IN THE MULTI DATA FORMAT OF THE MESSAGE              */ 03712000
*    /*                                                              */ 03713000
*    /****************************************************************/ 03714000
*                                                                  1038 03715000
*    ELSE DO;                     /* ELSE:                           */ 03716000
         B     @RC01031                                            1038 03717000
@RF01031 DS    0H                                                  1039 03718000
*      DARGCNT=MESSAGE0;          /* PLACE DATA COUNT                */ 03719000
         L     @15,DDSTRU                                          1039 03720000
         L     @14,@PC00014                                        1039 03721000
         MVC   DARGCNT(2,@15),MESSAGE0+2(@14)                      1039 03722000
*      DARGINS(1)=1;              /* INITIALIZE INSERT POINT         */ 03723000
         MVC   DARGINS(2,@15),@CH00220                             1040 03724000
*      DARGINL(1)=MESSAGE3;       /* PLACE DATA LENGTH               */ 03725000
         L     @14,@PC00014+12                                     1041 03726000
         MVC   DARGINL(2,@15),MESSAGE3+2(@14)                      1041 03727000
*      DARGDTM(1)=ADDR(MESSAGE2); /* PLACE DATA ADDRESS              */ 03728000
         L     @14,@PC00014+8                                      1042 03729000
         ST    @14,DARGDTM(,@15)                                   1042 03730000
*      DARGINS(2)=2;              /* INITIALIZE INSERT POINT         */ 03731000
         MVC   DARGINS+8(2,@15),@CH00154                           1043 03732000
*      DARGINL(2)=MESSAGE5;       /* PLACE DATA LENGTH               */ 03733000
         L     @14,@PC00014+20                                     1044 03734000
         MVC   DARGINL+8(2,@15),MESSAGE5+2(@14)                    1044 03735000
*      DARGDTM(2)=ADDR(MESSAGE4); /* PLACE DATA ADDRESS              */ 03736000
         L     @14,@PC00014+16                                     1045 03737000
         ST    @14,DARGDTM+8(,@15)                                 1045 03738000
*      END;                       /*                                 */ 03739000
*                                                                  1046 03740000
*  /******************************************************************/ 03741000
*  /*                                                                */ 03742000
*  /*    INTERFACE WITH THE ROUTINE THAT PRINTS THE MESSAGE          */ 03743000
*  /*                                                                */ 03744000
*  /******************************************************************/ 03745000
*                                                                  1047 03746000
*  CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                          1047 03747000
@RC01031 L     @15,@PC00001                                        1047 03748000
         ST    @15,@AL00001                                        1047 03749000
         LA    @14,@CF00116                                        1047 03750000
         ST    @14,@AL00001+4                                      1047 03751000
         LA    @14,DDSTRU                                          1047 03752000
         ST    @14,@AL00001+8                                      1047 03753000
         MVI   @AL00001+8,X'80'                                    1047 03754000
         L     @15,GDTPRT(,@15)                                    1047 03755000
         LA    @01,@AL00001                                        1047 03756000
         BALR  @14,@15                                             1047 03757000
*                                 /* PRINT THE MESSAGE               */ 03758000
*  END MESSAGE;                   /* END OF PROCEDURE                */ 03759000
@EL00014 DS    0H                                                  1048 03760000
@EF00014 DS    0H                                                  1048 03761000
@ER00014 LM    @14,@12,@SA00014                                    1048 03762000
         BR    @14                                                 1048 03763000
@PB00014 DS    0H                                                  1049 03764000
*  GEN (EJECT);                                                    1049 03765000
         EJECT                                                          03766000
*  /******************************************************************/ 03767000
*  /*                                                                */ 03768000
*  /* PROCEDURE NAME:                                                */ 03769000
*  /*    NAMETABL                                                    */ 03770000
*  /*                                                                */ 03771000
*  /* FUNCTION:                                                      */ 03772000
*  /*    THIS ROUTINE DOES ALL OF THE FOLLOWING FOR EACH OF          */ 03773000
*  /*    THE TYPES THAT ARE PROCESSED (CLUSTER, ALTERNATE INDEX      */ 03774000
*  /*    ,NON-VSAM, GENERATION DATA GROUP BASES, AND CATALOG         */ 03775000
*  /*    CONECTORS).                                                 */ 03776000
*  /*                                                                */ 03777000
*  /*    IF 'ALL' WAS SPECIFIED:                                     */ 03778000
*  /*                                                                */ 03779000
*  /*    1. BUILD AND FILL IN THE NAME BLOCK WITH ALL THE DATA       */ 03780000
*  /*       THAT IS KNOWN TODATE.                                    */ 03781000
*  /*                                                                */ 03782000
*  /*    IF 'ENTRIES' WAS SPECIFIED:                                 */ 03783000
*  /*                                                                */ 03784000
*  /*    1. SCAN THE NAME BLOCK CHAIN AND MARK THE NAME FOUND        */ 03785000
*  /*       AND FILL IN ANY NEW DATA FOUND.                          */ 03786000
*  /*                                                                */ 03787000
*  /* REQUIREMENTS:                                                  */ 03788000
*  /*                                                                */ 03789000
*  /*    1. CRV ENTRY MUST BE SELECTED BEFOR THE CALL.               */ 03790000
*  /*                                                                */ 03791000
*  /*    2. CATALOG RECORD MUST BE RECORD1.                          */ 03792000
*  /*                                                                */ 03793000
*  /******************************************************************/ 03794000
*                                                                  1050 03795000
*NAMETABL: PROCEDURE (NPARM4);                                     1050 03796000
*                                                                  1050 03797000
         B     @PB00015                                            1050 03798000
NAMETABL STM   @14,@01,@SA00015                                    1050 03799000
         STM   @03,@12,@SA00015+16                                 1050 03800000
         MVC   @PC00015(4),0(@01)                                  1050 03801000
*  DCL NPARM4      FIXED(31);     /*INDEX INTO CRV                   */ 03802000
*                                                                  1051 03803000
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */ 03804000
*                                                                  1052 03805000
*  /******************************************************************/ 03806000
*  /*                                                                */ 03807000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 03808000
*  /*                                                                */ 03809000
*  /******************************************************************/ 03810000
*                                                                  1053 03811000
*  OLDERID2 = NEWERID2;                                            1053 03812000
         L     @14,@PC00001                                        1053 03813000
         L     @07,GDTTR2(,@14)                                    1053 03814000
         MVC   @TS00001(95),NEWERID2(@07)                          1053 03815000
         MVC   OLDERID2(95,@07),@TS00001                           1053 03816000
*  NEWID2='RC97';                                                  1054 03817000
         MVC   NEWID2(4,@07),@CC01273                              1054 03818000
*  IF GDTDBG = NULLPTR                                             1055 03819000
*    THEN;                                                         1055 03820000
         ICM   @07,15,GDTDBG(@14)                                  1055 03821000
         BZ    @RT01055                                            1055 03822000
*    ELSE                                                          1057 03823000
*      CALL IDCDB010 (GDTTBL,'RC97');                              1057 03824000
         L     @14,@PC00001                                        1057 03825000
         ST    @14,@AL00001                                        1057 03826000
         LA    @07,@CC01273                                        1057 03827000
         ST    @07,@AL00001+4                                      1057 03828000
         MVI   @AL00001+4,X'80'                                    1057 03829000
         L     @15,GDTDBG(,@14)                                    1057 03830000
         LA    @01,@AL00001                                        1057 03831000
         BALR  @14,@15                                             1057 03832000
*  /******************************************************************/ 03833000
*  /*                                                                */ 03834000
*  /*    HANDLE THE NAME ON THIS RECORD ONLY IF IT IS ONE THAT       */ 03835000
*  /*    IS TO BE PROCESSED                                          */ 03836000
*  /*                                                                */ 03837000
*  /******************************************************************/ 03838000
*                                                                  1058 03839000
*  IF RECTYPE=CLUSTYPE |          /* IS THIS A CLUSTER               */ 03840000
*     RECTYPE=AIXTYPE  |          /* OR AN AIX                       */ 03841000
*     RECTYPE=NONVTYPE |          /* OR A NON-VSAM                   */ 03842000
*     RECTYPE=GDGBTYPE |          /* OR A GDG BASE                   */ 03843000
*     RECTYPE=CATCTYPE            /* OR A CATALOG CONECTOR           */ 03844000
*    THEN DO;                     /* THEN:                           */ 03845000
@RT01055 L     @14,IOCSPTR                                         1058 03846000
         L     @14,IOCDAD(,@14)                                    1058 03847000
         CLI   RECTYPE(@14),C'C'                                   1058 03848000
         BE    @RT01058                                            1058 03849000
         CLI   RECTYPE(@14),C'G'                                   1058 03850000
         BE    @RT01058                                            1058 03851000
         CLI   RECTYPE(@14),C'A'                                   1058 03852000
         BE    @RT01058                                            1058 03853000
         CLI   RECTYPE(@14),C'B'                                   1058 03854000
         BE    @RT01058                                            1058 03855000
         CLI   RECTYPE(@14),C'U'                                   1058 03856000
         BNE   @RF01058                                            1058 03857000
@RT01058 DS    0H                                                  1059 03858000
*      /**************************************************************/ 03859000
*      /*                                                            */ 03860000
*      /*    IF 'ALL' WAS SPECIFIED THEN THE NAME TABLE MUST BE      */ 03861000
*      /*    BUILT AS THE LIST IS SCANED                             */ 03862000
*      /*                                                            */ 03863000
*      /**************************************************************/ 03864000
*                                                                  1060 03865000
*      IF ALLNTPTR(NPARM4)^=NULLPTR                                1060 03866000
*                                 /* IF ALL WAS SPECIFIED            */ 03867000
*        THEN DO;                 /* THEN:                           */ 03868000
         L     @14,@PC00015                                        1060 03869000
         L     @14,NPARM4(,@14)                                    1060 03870000
         SLA   @14,2                                               1060 03871000
         L     @07,@PC00001+4                                      1060 03872000
         L     @01,FDTPTR+20(,@07)                                 1060 03873000
         AL    @01,@CF01392                                        1060 03874000
         L     @14,ALLNTPTR(@14,@01)                               1060 03875000
         LTR   @14,@14                                             1060 03876000
         BZ    @RF01060                                            1060 03877000
*          CALL SUBSP (GETTYPE,LENGTH(NBLK),NBLKPTR);              1062 03878000
         MVC   @AL00001(8),@AL01062                                1062 03879000
         LA    @14,NBLKPTR                                         1062 03880000
         ST    @14,@AL00001+8                                      1062 03881000
         LA    @01,@AL00001                                        1062 03882000
         BAL   @14,SUBSP                                           1062 03883000
*                                 /* GET SPACE FOR A NAME BLOCK      */ 03884000
*          IF REG15^=LASTCC00     /* IF THERE IS NO STORAGE          */ 03885000
*            THEN ERRNO=ERCDNSTR; /* THEN: INDICATE NO STORAGE       */ 03886000
         LTR   REG15,REG15                                         1063 03887000
         BZ    @RF01063                                            1063 03888000
         LA    ERRNO,28                                            1064 03889000
*            ELSE DO;             /* ELSE:                           */ 03890000
         B     @RC01063                                            1065 03891000
@RF01063 DS    0H                                                  1066 03892000
*              NBLKCHN=CRVNAMCH;  /* POINT BLOCK AT THE NAME         */ 03893000
         L     @14,NBLKPTR                                         1066 03894000
         MVC   NBLKCHN(4,@14),CRVNAMCH(CRVEBASE)                   1066 03895000
*                                 /* CHAIN                           */ 03896000
*              CRVNAMCH=NBLKPTR;  /* POINT CRV AT NEW CHAIN          */ 03897000
         ST    @14,CRVNAMCH(,CRVEBASE)                             1067 03898000
*              NBLKTYPE=RECTYPE;  /* PLACE TYPE IN NAME BLOCK        */ 03899000
         L     @01,IOCSPTR                                         1068 03900000
         L     @07,IOCDAD(,@01)                                    1068 03901000
         MVC   NBLKTYPE(1,@14),RECTYPE(@07)                        1068 03902000
*              NBLKCI=RECCI;      /* PLACE CATALOG CI IN THE         */ 03903000
         MVC   NBLKCI(3,@14),RECCI(@07)                            1069 03904000
*                                 /* NAME BLOCK                      */ 03905000
*              NBLKICI=INVALCI;   /* SET INDEX CI INVALID            */ 03906000
         MVC   NBLKICI(3,@14),INVALCI                              1070 03907000
*              NBLKDCI=INVALCI;   /* SET DATA CI INVALID             */ 03908000
         MVC   NBLKDCI(3,@14),INVALCI                              1071 03909000
*              CALL COMPNAME (RECNAME,NBLKNAME);                   1072 03910000
         LA    @07,RECNAME(,@07)                                   1072 03911000
         ST    @07,@AL00001                                        1072 03912000
         LA    @14,NBLKNAME(,@14)                                  1072 03913000
         ST    @14,@AL00001+4                                      1072 03914000
         LA    @01,@AL00001                                        1072 03915000
         BAL   @14,COMPNAME                                        1072 03916000
*                                 /* PLACE THE NAME POINTER IN       */ 03917000
*                                 /* THE NAME BLOCK                  */ 03918000
*              IF REG15^=LASTCC00 /* IF THERE IS NO STORAGE          */ 03919000
*                THEN ERRNO=ERCDNSTR;                              1073 03920000
         LTR   REG15,REG15                                         1073 03921000
         BZ    @RF01073                                            1073 03922000
         LA    ERRNO,28                                            1074 03923000
*                                 /* THEN: INDICATE NO STORAGE       */ 03924000
*                ELSE;            /* ELSE: CONTINUE                  */ 03925000
@RF01073 DS    0H                                                  1076 03926000
*              END;               /*                                 */ 03927000
*          END;                   /*                                 */ 03928000
*        ELSE;                    /* ELSE: CONTINUE                  */ 03929000
@RF01060 DS    0H                                                  1079 03930000
*      /**************************************************************/ 03931000
*      /*                                                            */ 03932000
*      /*    MATCH THE NAMES ON THE CHAIN IF ENTRIES WAS             */ 03933000
*      /*    SPECIFIED FOR THIS CRA                                  */ 03934000
*      /*                                                            */ 03935000
*      /**************************************************************/ 03936000
*                                                                  1079 03937000
*      IF ENTREPTR(NPARM4)^=NULLPTR                                1079 03938000
*                                 /* IF ENTRIES ARE SPECIFIED        */ 03939000
*        THEN DO;                 /* THEN:                           */ 03940000
@RC01060 L     @14,@PC00015                                        1079 03941000
         L     @14,NPARM4(,@14)                                    1079 03942000
         SLA   @14,2                                               1079 03943000
         L     @07,@PC00001+4                                      1079 03944000
         L     @01,FDTPTR+28(,@07)                                 1079 03945000
         AL    @01,@CF01392                                        1079 03946000
         L     @14,ENTREPTR(@14,@01)                               1079 03947000
         LTR   @14,@14                                             1079 03948000
         BZ    @RF01079                                            1079 03949000
*          CALL COMPNAME(RECNAME,DSNPTR);                          1081 03950000
         L     @14,IOCSPTR                                         1081 03951000
         L     @14,IOCDAD(,@14)                                    1081 03952000
         LA    @14,RECNAME(,@14)                                   1081 03953000
         ST    @14,@AL00001                                        1081 03954000
         LA    @14,DSNPTR                                          1081 03955000
         ST    @14,@AL00001+4                                      1081 03956000
         LA    @01,@AL00001                                        1081 03957000
         BAL   @14,COMPNAME                                        1081 03958000
*                                 /* GET A COMPRESSED COPY OF        */ 03959000
*                                 /* THE NAME                        */ 03960000
*          IF REG15^=LASTCC00     /* IF THERE IS NO SPACE            */ 03961000
*            THEN ERRNO=ERCDNSTR; /* THEN: INDICATE NO STORAGE       */ 03962000
         LTR   REG15,REG15                                         1082 03963000
         BZ    @RF01082                                            1082 03964000
         LA    ERRNO,28                                            1083 03965000
*            ELSE DO;             /* ELSE:                           */ 03966000
         B     @RC01082                                            1084 03967000
@RF01082 DS    0H                                                  1085 03968000
*              CALL SUBSP (RETTYPE);                               1085 03969000
         LA    @01,@AL01085                                        1085 03970000
         BAL   @14,SUBSP                                           1085 03971000
*                                 /* RETURN THE SPACE TO POOL        */ 03972000
*              NBLKPTR=CRVNAMCH;  /* POINT TO START SEARCH OF        */ 03973000
         MVC   NBLKPTR(4),CRVNAMCH(CRVEBASE)                       1086 03974000
*                                 /* THE NAME CHAIN                  */ 03975000
*              DO WHILE NBLKPTR^=NULLPTR;                          1087 03976000
         B     @DE01087                                            1087 03977000
@DL01087 DS    0H                                                  1088 03978000
*                                 /* LOOP TO SEARCH THE WHOLE        */ 03979000
*                                 /* NAME CHAIN                      */ 03980000
*                IF NBLKNAME->DSNAMLEN=DSNAMLEN                    1088 03981000
*                                 /* IF THE LENGTH'S MATCH THEN      */ 03982000
*                  THEN IF NBLKNAME->DSNAM(1:DSNAMLEN)=            1088 03983000
         L     @14,NBLKPTR                                         1088 03984000
         L     @07,NBLKNAME(,@14)                                  1088 03985000
         L     @06,DSNPTR                                          1088 03986000
         LH    @05,DSNAMLEN(,@06)                                  1088 03987000
         CH    @05,DSNAMLEN(,@07)                                  1088 03988000
         BNE   @RF01088                                            1088 03989000
*                                    DSNAM(1:DSNAMLEN)             1089 03990000
*                    THEN DO;     /* THEN:                           */ 03991000
         BCTR  @05,0                                               1089 03992000
         EX    @05,@SC01404                                        1089 03993000
         BNE   @RF01089                                            1089 03994000
*                      NBLKMH=ON;                                  1091 03995000
         OI    NBLKMH(@14),B'10000000'                             1091 03996000
*                                 /* INDICATE A MATCH                */ 03997000
*                      NBLKTYPE=RECTYPE;                           1092 03998000
         L     @01,IOCSPTR                                         1092 03999000
         L     @07,IOCDAD(,@01)                                    1092 04000000
         MVC   NBLKTYPE(1,@14),RECTYPE(@07)                        1092 04001000
*                                 /* PLACE RECORD TYPE               */ 04002000
*                      NBLKCI=RECCI;                               1093 04003000
         MVC   NBLKCI(3,@14),RECCI(@07)                            1093 04004000
*                                 /* PLACE THE BASE CI NUMBER        */ 04005000
*                      NBLKPTR=NULLPTR;                            1094 04006000
         SLR   @14,@14                                             1094 04007000
         ST    @14,NBLKPTR                                         1094 04008000
*                                 /* INDICATE END OF SEARCH          */ 04009000
*                      END;       /*                                 */ 04010000
*                    ELSE;        /* ELSE: CONTINUE                  */ 04011000
@RF01089 DS    0H                                                  1097 04012000
*                  ELSE;          /* ELSE: CONTINUE                  */ 04013000
@RF01088 DS    0H                                                  1098 04014000
*                IF NBLKPTR=NULLPTR                                1098 04015000
*                                 /* IF AT END OF CHAIN              */ 04016000
*                  THEN;          /* THEN: CONTINUE                  */ 04017000
         ICM   @14,15,NBLKPTR                                      1098 04018000
         BZ    @RT01098                                            1098 04019000
*                  ELSE NBLKPTR=NBLKCHN;                           1100 04020000
         L     @14,NBLKPTR                                         1100 04021000
         L     @14,NBLKCHN(,@14)                                   1100 04022000
         ST    @14,NBLKPTR                                         1100 04023000
*                                 /* ELSE: POINT AT THE NEXT         */ 04024000
*                                 /*       NAME ON THE CHAIN         */ 04025000
*                END;             /*                                 */ 04026000
@RT01098 DS    0H                                                  1101 04027000
@DE01087 ICM   @14,15,NBLKPTR                                      1101 04028000
         BNZ   @DL01087                                            1101 04029000
*              END;               /*                                 */ 04030000
*          END;                   /*                                 */ 04031000
*        ELSE;                    /* ELSE: CONTINUE                  */ 04032000
@RF01079 DS    0H                                                  1105 04033000
*      END;                       /*                                 */ 04034000
*    ELSE;                        /* ELSE: CONTINUE                  */ 04035000
*                                                                  1106 04036000
@RF01058 DS    0H                                                  1107 04037000
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */ 04038000
*                                                                  1107 04039000
*  END NAMETABL;                  /* END OF PROCEDURE                */ 04040000
@EL00015 DS    0H                                                  1108 04041000
@EF00015 DS    0H                                                  1108 04042000
@ER00015 LM    @14,@01,@SA00015                                    1108 04043000
         LM    @03,@12,@SA00015+16                                 1108 04044000
         BR    @14                                                 1108 04045000
@PB00015 DS    0H                                                  1109 04046000
*  GEN (EJECT);                                                    1109 04047000
         EJECT                                                          04048000
*  /******************************************************************/ 04049000
*  /*                                                                */ 04050000
*  /* PROCEDURE NAME:                                                */ 04051000
*  /*    OBJVOLCK                                                    */ 04052000
*  /*                                                                */ 04053000
*  /* FUNCTION:                                                      */ 04054000
*  /*                                                                */ 04055000
*  /*    CHECK THE DIRECTORY ENTRIES AND SUMTT TO INSURE THAT        */ 04056000
*  /*    THE ENTRY COMPONENT IS IN SYNCRONIZATION ACROSS THE         */ 04057000
*  /*    VOLUMES ON WHICH IT RESIDES                                 */ 04058000
*  /*                                                                */ 04059000
*  /* REQUIREMENTS:                                                  */ 04060000
*  /*                                                                */ 04061000
*  /*    NONE                                                        */ 04062000
*  /*                                                                */ 04063000
*  /******************************************************************/ 04064000
*                                                                  1110 04065000
*OBJVOLCK: PROCEDURE (OBJCI,OBJVOLSR);                             1110 04066000
*                                                                  1110 04067000
         B     @PB00016                                            1110 04068000
OBJVOLCK STM   @14,@02,@SA00016                                    1110 04069000
         STM   @04,@12,@SA00016+20                                 1110 04070000
         MVC   @PC00016(8),0(@01)                                  1110 04071000
*  /******************************************************************/ 04072000
*  /*                                                                */ 04073000
*  /*    THE INCOMING PARAMTERES FOR THIS ROUTINE                    */ 04074000
*  /*                                                                */ 04075000
*  /******************************************************************/ 04076000
*                                                                  1111 04077000
*  DCL OBJCI      FIXED(24);      /* CI NUMBER TO CHECK              */ 04078000
*  DCL OBJVOLSR   CHAR(6);        /* VOLSER OF THE CRA               */ 04079000
*                                                                  1112 04080000
*  /******************************************************************/ 04081000
*  /*                                                                */ 04082000
*  /*    VARIABLES USED IN THIS ROUTINE                              */ 04083000
*  /*                                                                */ 04084000
*  /******************************************************************/ 04085000
*                                                                  1113 04086000
*  DCL OBJSUMTT   FIXED(31);      /* COMPUTED SUMTT                  */ 04087000
*  DCL OBJVOL2    CHAR(6);        /* WORK FIELD FOR VOLSER   @OZ14812*/ 04088000
*  DCL OBJIX1     FIXED(31);      /* GENERAL COUNTER                 */ 04089000
*  DCL OBJIX2     PTR(31);        /* GENERAL COUNTER                 */ 04090000
*  DCL OBJIX3     FIXED(31);      /* GENERAL COUNTER                 */ 04091000
*  DCL OBJIX4     PTR(31);        /* GENERAL COUNTER         @OZ14812*/ 04092000
*  DCL OBJIX5     FIXED(31);      /* GENERAL COUNTER                 */ 04093000
*  DCL OBJIX6     FIXED(31);      /* GENERAL COUNTER                 */ 04094000
*  DCL OBJIX7     FIXED(31);      /* GENERAL COUNTER         @OZ14812*/ 04095000
*  DCL OBJIX8     FIXED(31);      /* GENERAL COUNTER                 */ 04096000
*  DCL OBJIX9     FIXED(31);      /* GENERAL COUNTER                 */ 04097000
*  DCL OBJIX99    FIXED(31) BASED(OBJIX2);                         1124 04098000
*                                 /* USED TO MOVE DATA               */ 04099000
*  DCL SSWTHDTA   BIT(8) CONSTANT('80'X);                          1125 04100000
*                                 /* SEQUENCE SET WITH DATA FLG      */ 04101000
*                                                                  1126 04102000
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */ 04103000
*  /******************************************************************/ 04104000
*  /*                                                                */ 04105000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 04106000
*  /*                                                                */ 04107000
*  /******************************************************************/ 04108000
*                                                                  1127 04109000
*  OLDERID2 = NEWERID2;                                            1127 04110000
         L     @14,@PC00001                                        1127 04111000
         L     @04,GDTTR2(,@14)                                    1127 04112000
         MVC   @TS00001(95),NEWERID2(@04)                          1127 04113000
         MVC   OLDERID2(95,@04),@TS00001                           1127 04114000
*  NEWID2='RC84';                                                  1128 04115000
         MVC   NEWID2(4,@04),@CC01295                              1128 04116000
*  IF GDTDBG = NULLPTR                                             1129 04117000
*    THEN;                                                         1129 04118000
         ICM   @04,15,GDTDBG(@14)                                  1129 04119000
         BZ    @RT01129                                            1129 04120000
*    ELSE                                                          1131 04121000
*      CALL IDCDB010 (GDTTBL,'RC84');                              1131 04122000
*                                                                  1131 04123000
         L     @14,@PC00001                                        1131 04124000
         ST    @14,@AL00001                                        1131 04125000
         LA    @04,@CC01295                                        1131 04126000
         ST    @04,@AL00001+4                                      1131 04127000
         MVI   @AL00001+4,X'80'                                    1131 04128000
         L     @15,GDTDBG(,@14)                                    1131 04129000
         LA    @01,@AL00001                                        1131 04130000
         BALR  @14,@15                                             1131 04131000
*  /******************************************************************/ 04132000
*  /*                                                                */ 04133000
*  /*    IF THE DIRECTORY IS NOT IN STORAGE AND THE USER DID         */ 04134000
*  /*    SPECIFY FORCE THEN THERE IS NO NEED TO CHECK THE SUMTT      */ 04135000
*  /*    SO JUST RETURN TO THE CALLER                                */ 04136000
*  /*                                                                */ 04137000
*  /******************************************************************/ 04138000
*                                                                  1132 04139000
*  IF CRVDIRER=ON & FRC^=NULLPTR  /* IF DIRECTORY NOT IN CORE        */ 04140000
*    THEN RETURN CODE(LASTCC00);  /* THEN: RETURN WITH ZERO          */ 04141000
@RT01129 TM    CRVDIRER(CRVEBASE),B'00001000'                      1132 04142000
         BNO   @RF01132                                            1132 04143000
         SLR   @14,@14                                             1132 04144000
         L     @04,@PC00001+4                                      1132 04145000
         L     @04,FDTPTR(,@04)                                    1132 04146000
         C     @14,FRC(,@04)                                       1132 04147000
         BE    @RF01132                                            1132 04148000
         LR    @15,@14                                             1133 04149000
         L     @14,@SA00016                                        1133 04150000
         LM    @00,@02,@SA00016+8                                  1133 04151000
         LM    @04,@12,@SA00016+20                                 1133 04152000
         BR    @14                                                 1133 04153000
*    ELSE;                        /* ELSE: CONTINUE                  */ 04154000
*                                                                  1134 04155000
@RF01132 DS    0H                                                  1135 04156000
*  /******************************************************************/ 04157000
*  /*                                                                */ 04158000
*  /*    OBTAIN THE DATA NECESSARY TO CHECK THE SYNCHRONIZATION      */ 04159000
*  /*    OF THIS DATA SET                                            */ 04160000
*  /*                                                                */ 04161000
*  /******************************************************************/ 04162000
*                                                                  1135 04163000
*  CALL EXTRACT(0,OBJCI,0,0,OBJIX2,OBJIX1,QCRADITS,0);             1135 04164000
         MVC   @AL00001(32),@AL01135                               1135 04165000
         L     @14,@PC00016                                        1135 04166000
         ST    @14,@AL00001+4                                      1135 04167000
         LA    @14,OBJIX2                                          1135 04168000
         ST    @14,@AL00001+16                                     1135 04169000
         LA    @14,OBJIX1                                          1135 04170000
         ST    @14,@AL00001+20                                     1135 04171000
         LA    @01,@AL00001                                        1135 04172000
         BAL   @14,EXTRACT                                         1135 04173000
*                                 /* OBTAIN THE CREATION TS          */ 04174000
*  IF OBJIX2=NULLPTR              /* IF NO DATA RETURNED             */ 04175000
*    THEN VGOCRATS=0;             /* THEN: SET TO ZERO               */ 04176000
         SLR   @14,@14                                             1136 04177000
         C     @14,OBJIX2                                          1136 04178000
         BNE   @RF01136                                            1136 04179000
         ST    @14,VGOCRATS                                        1137 04180000
*    ELSE VGOCRATS=OBJIX99;       /* ELSE: SET RETURNED TS           */ 04181000
         B     @RC01136                                            1138 04182000
@RF01136 L     @14,OBJIX2                                          1138 04183000
         MVC   VGOCRATS(4),OBJIX99(@14)                            1138 04184000
*  CALL EXTRACT(1,OBJCI,VGOPTR,VGOSIZE,OBJIX2,OBJIX1,QEXTDATA,0,   1139 04185000
*               QITYPEXT,EQUAL,0,ADDR(SSWTHDTA),(LENGTH(SSWTHDTA)/8));  04186000
@RC01136 LA    @14,@CF00220                                        1139 04187000
         ST    @14,@AL00001                                        1139 04188000
         L     @14,@PC00016                                        1139 04189000
         ST    @14,@AL00001+4                                      1139 04190000
         LA    @14,VGOPTR                                          1139 04191000
         ST    @14,@AL00001+8                                      1139 04192000
         LA    @14,VGOSIZE                                         1139 04193000
         ST    @14,@AL00001+12                                     1139 04194000
         LA    @14,OBJIX2                                          1139 04195000
         ST    @14,@AL00001+16                                     1139 04196000
         LA    @14,OBJIX1                                          1139 04197000
         ST    @14,@AL00001+20                                     1139 04198000
         LA    @14,QEXTDATA                                        1139 04199000
         ST    @14,@AL00001+24                                     1139 04200000
         LA    @14,@CF00116                                        1139 04201000
         ST    @14,@AL00001+28                                     1139 04202000
         LA    @14,QITYPEXT                                        1139 04203000
         ST    @14,@AL00001+32                                     1139 04204000
         LA    @14,@CB00934                                        1139 04205000
         ST    @14,@AL00001+36                                     1139 04206000
         LA    @14,@CF00116                                        1139 04207000
         ST    @14,@AL00001+40                                     1139 04208000
         LA    @14,@CB00934                                        1139 04209000
         ST    @14,@AFTEMPS+12                                     1139 04210000
         LA    @14,@AFTEMPS+12                                     1139 04211000
         ST    @14,@AL00001+44                                     1139 04212000
         LA    @14,1                                               1139 04213000
         ST    @14,@AFTEMPS+16                                     1139 04214000
         LA    @14,@AFTEMPS+16                                     1139 04215000
         ST    @14,@AL00001+48                                     1139 04216000
         LA    @01,@AL00001                                        1139 04217000
         BAL   @14,EXTRACT                                         1139 04218000
*                                 /* GET THE VGO'S FOR THIS          */ 04219000
*                                 /* ENTRY                           */ 04220000
*                                                                  1140 04221000
*  /******************************************************************/ 04222000
*  /*                                                                */ 04223000
*  /*    CHECK THE SUMTT'S ON ALL THE VOLUMES REQUIRED FOR           */ 04224000
*  /*    THIS ENTRY                                                  */ 04225000
*  /*                                                                */ 04226000
*  /******************************************************************/ 04227000
*                                                                  1140 04228000
*  VGOPTR1=ADDR(VGOENTYS(1));     /* POINT AT START OF VGO'S         */ 04229000
         L     VGOPTR1,VGOPTR                                      1140 04230000
         LA    VGOPTR1,VGOENTYS(,VGOPTR1)                          1140 04231000
*  DO WHILE OBJIX1>0;             /* LOOP THROUGH ALL THE VGO'S      */ 04232000
         B     @DE01141                                            1141 04233000
@DL01141 DS    0H                                                  1142 04234000
*    /****************************************************************/ 04235000
*    /*                                                              */ 04236000
*    /*    FIND THE VOLSER ENTRY NUMBER IN THE VTT (THAT IS          */ 04237000
*    /*    INDEX INTO THE CRV)                                       */ 04238000
*    /*                                                              */ 04239000
*    /****************************************************************/ 04240000
*                                                                  1142 04241000
*    OBJIX3=0;                    /* INITIALIZE INDICATOR            */ 04242000
         SLR   @14,@14                                             1142 04243000
         ST    @14,OBJIX3                                          1142 04244000
*    DO OBJIX2=1 TO CRACNT;       /* LOOP THROUGH VTT FOR            */ 04245000
         LA    @14,1                                               1143 04246000
         B     @DE01143                                            1143 04247000
@DL01143 DS    0H                                                  1144 04248000
*                                 /* VOLUME SERIAL NUMBER            */ 04249000
*      IF VTTVOLSR(OBJIX2)=VGOVOLSR                                1144 04250000
*                                 /* IF A MATCH IS FOUND             */ 04251000
*        THEN DO;                 /* THEN:                           */ 04252000
         LR    @04,@14                                             1144 04253000
         MH    @04,@CH00763                                        1144 04254000
         L     @01,CRVBASE                                         1144 04255000
         L     @01,CRVCRAPL(,@01)                                  1144 04256000
         L     @01,ACCVOLTT(,@01)                                  1144 04257000
         ALR   @01,@04                                             1144 04258000
         AL    @01,@CF01391                                        1144 04259000
         CLC   VTTVOLSR-4(6,@01),VGOVOLSR(VGOPTR1)                 1144 04260000
         BNE   @RF01144                                            1144 04261000
*          OBJIX3=OBJIX2;         /* SAVE THE FOUND INDEX            */ 04262000
         ST    @14,OBJIX3                                          1146 04263000
*          OBJIX2=CRACNT;         /* INDICATE SEARCH COMPLETE        */ 04264000
         L     @14,@PC00001+4                                      1147 04265000
         LA    @14,FDTPTR+12(,@14)                                 1147 04266000
         MVC   OBJIX2(4),CRACNT(@14)                               1147 04267000
*          END;                   /*                                 */ 04268000
*        ELSE;                    /* ELSE: CONTINUE                  */ 04269000
@RF01144 DS    0H                                                  1150 04270000
*      END;                       /*                                 */ 04271000
*                                                                  1150 04272000
         LA    @14,1                                               1150 04273000
         AL    @14,OBJIX2                                          1150 04274000
@DE01143 ST    @14,OBJIX2                                          1150 04275000
         L     @04,@PC00001+4                                      1150 04276000
         LA    @04,FDTPTR+12(,@04)                                 1150 04277000
         C     @14,CRACNT(,@04)                                    1150 04278000
         BNH   @DL01143                                            1150 04279000
*    /****************************************************************/ 04280000
*    /*                                                              */ 04281000
*    /*    PRINT THE NECESSARY MESSAGES IF THE VOLSER NOT            */ 04282000
*    /*    FOUND IN THE VTT                                          */ 04283000
*    /*                                                              */ 04284000
*    /****************************************************************/ 04285000
*                                                                  1151 04286000
*    IF OBJIX3=0                  /* IF THE VOLUME SERIAL IS         */ 04287000
*                                 /* NOT FOUND                       */ 04288000
*      THEN DO;                   /* THEN:                           */ 04289000
         ICM   @14,15,OBJIX3                                       1151 04290000
         BNZ   @RF01151                                            1151 04291000
*        NBLKBE=ON;               /* INDICATE ENTRY IS BAD           */ 04292000
         L     @14,NBLKPTR                                         1153 04293000
         OI    NBLKBE(@14),B'01000000'                             1153 04294000
*        CALL MESSAGE(0,MSGID13,VGOVOLSR,LENGTH(VGOVOLSR));        1154 04295000
         MVC   @AL00001(16),@AL01154                               1154 04296000
         ST    VGOPTR1,@AL00001+8                                  1154 04297000
         LA    @01,@AL00001                                        1154 04298000
         BAL   @14,MESSAGE                                         1154 04299000
*                                 /* PRINT REQUIRED VOLUME           */ 04300000
*        OBJIX9=NBLKNAME->DSNAMLEN;                                1155 04301000
         L     @14,NBLKPTR                                         1155 04302000
         L     @14,NBLKNAME(,@14)                                  1155 04303000
         LH    @04,DSNAMLEN(,@14)                                  1155 04304000
         ST    @04,OBJIX9                                          1155 04305000
*                                 /* GET LENGTH OF NAME              */ 04306000
*        CALL MESSAGE(0,MSGID20,NBLKNAME->DSNAM,OBJIX9);           1156 04307000
         LA    @04,@CF00116                                        1156 04308000
         ST    @04,@AL00001                                        1156 04309000
         LA    @04,@CH00885                                        1156 04310000
         ST    @04,@AL00001+4                                      1156 04311000
         LA    @14,DSNAM(,@14)                                     1156 04312000
         ST    @14,@AL00001+8                                      1156 04313000
         LA    @14,OBJIX9                                          1156 04314000
         ST    @14,@AL00001+12                                     1156 04315000
         LA    @01,@AL00001                                        1156 04316000
         BAL   @14,MESSAGE                                         1156 04317000
*                                 /* PRINT THE DSNAME                */ 04318000
*        END;                     /*                                 */ 04319000
*      /**************************************************************/ 04320000
*      /*                                                            */ 04321000
*      /*    HANDLE THE VOLSER IF IT IS FOUND                        */ 04322000
*      /*                                                            */ 04323000
*      /**************************************************************/ 04324000
*                                                                  1158 04325000
*      ELSE DO;                   /* ELSE:                           */ 04326000
         B     @RC01151                                            1158 04327000
@RF01151 DS    0H                                                  1159 04328000
*        OBJIX8=CRVEBASE;         /* SAVE THE OLD BASE               */ 04329000
         ST    CRVEBASE,OBJIX8                                     1159 04330000
*        CRVEBASE=ADDR(CRVENTRY(OBJIX3));                          1160 04331000
         L     @14,OBJIX3                                          1160 04332000
         MH    @14,@CH00954                                        1160 04333000
         L     CRVEBASE,CRVBASE                                    1160 04334000
         LA    CRVEBASE,CRVENTRY-28(@14,CRVEBASE)                  1160 04335000
*                                 /* POINT AT THE NEW ENTRY          */ 04336000
*        IF CRVOPNAG=NULLPTR & CRVBADVL=OFF                        1161 04337000
*                                 /* IF VOLUME NOT OPENED AND        */ 04338000
*                                 /* MAY BE OK                       */ 04339000
*          THEN DO;               /* THEN:                           */ 04340000
         ICM   @14,15,CRVOPNAG(CRVEBASE)                           1161 04341000
         BNZ   @RF01161                                            1161 04342000
         TM    CRVBADVL(CRVEBASE),B'10000000'                      1161 04343000
         BNZ   @RF01161                                            1161 04344000
*            CALL OPENCRA(OPENFUNC,OBJIX3,CRADS);                  1163 04345000
         MVC   @AL00001(12),@AL01163                               1163 04346000
         LA    @14,OBJIX3                                          1163 04347000
         ST    @14,@AL00001+4                                      1163 04348000
         LA    @01,@AL00001                                        1163 04349000
         BAL   @14,OPENCRA                                         1163 04350000
*                                 /* OPEN TO BUILD THE TABLES        */ 04351000
*            IF REG15=LASTCC12    /* IF THERE IS NO STORAGE          */ 04352000
*              THEN RETURN CODE(LASTCC12);                         1164 04353000
         LA    @14,12                                              1164 04354000
         CR    REG15,@14                                           1164 04355000
         BNE   @RF01164                                            1164 04356000
         LR    @15,@14                                             1165 04357000
         L     @14,@SA00016                                        1165 04358000
         LM    @00,@02,@SA00016+8                                  1165 04359000
         LM    @04,@12,@SA00016+20                                 1165 04360000
         BR    @14                                                 1165 04361000
*                                 /* THEN: RETURN ERROR              */ 04362000
*              ELSE;              /* ELSE: CONTINUE                  */ 04363000
@RF01164 DS    0H                                                  1167 04364000
*            CALL OPENCRA(CLOSFUNC,OBJIX3);                        1167 04365000
         LA    @14,@CC00855                                        1167 04366000
         ST    @14,@AL00001                                        1167 04367000
         LA    @14,OBJIX3                                          1167 04368000
         ST    @14,@AL00001+4                                      1167 04369000
         LA    @01,@AL00001                                        1167 04370000
         BAL   @14,OPENCRA                                         1167 04371000
*                                 /* CLOSE BECAUSE NOT NEEDED        */ 04372000
*            END;                 /*                                 */ 04373000
*          ELSE;                  /* ELSE: CONTINUE                  */ 04374000
*                                                                  1169 04375000
@RF01161 DS    0H                                                  1170 04376000
*        /************************************************************/ 04377000
*        /*                                                          */ 04378000
*        /*    PRINT THE MESSAGES IF THE VOLUME CAN NOT BE           */ 04379000
*        /*    OPENED UP                                             */ 04380000
*        /*                                                          */ 04381000
*        /************************************************************/ 04382000
*                                                                  1170 04383000
*        IF CRVBADVL=ON           /* IF THE VOLUME IS NO GOOD        */ 04384000
*          THEN NBLKSC=ON;        /* THEN: INDICATE OU-OF-SYNCH      */ 04385000
         TM    CRVBADVL(CRVEBASE),B'10000000'                      1170 04386000
         BNO   @RF01170                                            1170 04387000
         L     @14,NBLKPTR                                         1171 04388000
         OI    NBLKSC(@14),B'00100000'                             1171 04389000
*          /**********************************************************/ 04390000
*          /*                                                        */ 04391000
*          /*    CHECK THE SUMTT IF THE VOLUME IS NOT THE            */ 04392000
*          /*    SAME AS THE VOLUME BEING CHECKED                    */ 04393000
*          /*                                                        */ 04394000
*          /**********************************************************/ 04395000
*                                                                  1172 04396000
*          ELSE DO;               /* ELSE:                           */ 04397000
         B     @RC01170                                            1172 04398000
@RF01170 DS    0H                                                  1173 04399000
*            IF VGOVOLSR=OBJVOLSR /* IF CHECKING THE SAME            */ 04400000
*                                 /* VOLUME AS THE CRA VOLUME,       */ 04401000
*              | VGOSKIP(1)='FF'X /* OR ENTRY HAS ALREADY    @OZ14812*/ 04402000
*                                 /* BEEN PROCESSED,         @OZ14812*/ 04403000
*                                 /* THERE IS NO NEED        @OZ14812*/ 04404000
*              THEN;              /* THEN: CONTINUE                  */ 04405000
         L     @14,@PC00016+4                                      1173 04406000
         CLC   VGOVOLSR(6,VGOPTR1),OBJVOLSR(@14)                   1173 04407000
         BE    @RT01173                                            1173 04408000
         CLI   VGOSKIP(VGOPTR1),X'FF'                              1173 04409000
         BE    @RT01173                                            1173 04410000
*              ELSE                                                1175 04411000
*INLOOP1:        DO;                                       /*@OZ25037*/ 04412000
INLOOP1  DS    0H                                                  1176 04413000
*                IF VGODIRSN ^=0                           /*@OZ25037*/ 04414000
*                  THEN                                    /*@OZ25037*/ 04415000
         ICM   @14,3,VGODIRSN(VGOPTR1)                             1176 04416000
         BZ    @RF01176                                            1176 04417000
*INLOOP2:            DO;                                   /*@OZ25037*/ 04418000
INLOOP2  DS    0H                                                  1178 04419000
*                    I = VGODIRSN;                         /*@OZ25037*/ 04420000
         LH    I,VGODIRSN(,VGOPTR1)                                1178 04421000
*                    PDELERR = OFF;                        /*@OZ25037*/ 04422000
*                                                                  1179 04423000
         NI    PDELERR,B'01111111'                                 1179 04424000
*                   /*************************************************/ 04425000
*                   /* NOW LOOP THRU THE ENTRIES TO FIND     @OZ25037*/ 04426000
*                   /* RELREPNO THATS THE SAME.THE EXTRACT   @OZ25037*/ 04427000
*                   /* WILL NOT BRING IN DELETED ENTRIES.    @OZ25037*/ 04428000
*                   /*************************************************/ 04429000
*                                                                  1180 04430000
*                    DO WHILE DIRELPNO(I) ^= VGODIRSN              1180 04431000
*                      & PDELERR = OFF;                    /*@OZ25037*/ 04432000
         B     @DE01180                                            1180 04433000
@DL01180 DS    0H                                                  1181 04434000
*                      IF DIRELPNO(I) > VGODIRSN | I > 1   /*@OZ25037*/ 04435000
*                        THEN                              /*@OZ25037*/ 04436000
         LR    @14,I                                               1181 04437000
         MH    @14,@CH00038                                        1181 04438000
         L     @01,CRVDIREC(,CRVEBASE)                             1181 04439000
         ALR   @01,@14                                             1181 04440000
         BCTR  @01,0                                               1181 04441000
         BCTR  @01,0                                               1181 04442000
         SLR   @14,@14                                             1181 04443000
         ICM   @14,3,DIRELPNO-10(@01)                              1181 04444000
         CH    @14,VGODIRSN(,VGOPTR1)                              1181 04445000
         BH    @RT01181                                            1181 04446000
         CH    I,@CH00220                                          1181 04447000
         BNH   @RF01181                                            1181 04448000
@RT01181 DS    0H                                                  1182 04449000
*                          I = I - 1;                      /*@OZ25037*/ 04450000
         BCTR  I,0                                                 1182 04451000
*                        ELSE                              /*@OZ25037*/ 04452000
*                                                                  1183 04453000
*                        /********************************************/ 04454000
*                        /* THERE IS NO MATCH IN THE TABLE.  @OZ25036*/ 04455000
*                        /* THE ENTRY IN VGO IS THERE        @OZ25036*/ 04456000
*                        /* BUT NOT IN DIRECTORY.            @OZ25036*/ 04457000
*                        /********************************************/ 04458000
*                                                                  1183 04459000
*                          DO;                             /*@OZ25036*/ 04460000
         B     @RC01181                                            1183 04461000
@RF01181 DS    0H                                                  1184 04462000
*                            PDELERR = ON;                 /*@OZ25036*/ 04463000
         OI    PDELERR,B'10000000'                                 1184 04464000
*                            CALL MESSAGE(1,MSGID25,VGOVOLSR,      1185 04465000
*                            LENGTH(VGOVOLSR));            /*@OZ25036*/ 04466000
         MVC   @AL00001(16),@AL01185                               1185 04467000
         ST    VGOPTR1,@AL00001+8                                  1185 04468000
         LA    @01,@AL00001                                        1185 04469000
         BAL   @14,MESSAGE                                         1185 04470000
*                            NBLKBE=ON;   /* MARK ENTRY BAD  @OZ25036*/ 04471000
         L     @14,NBLKPTR                                         1186 04472000
         OI    NBLKBE(@14),B'01000000'                             1186 04473000
*                            OBJIX6=NBLKNAME->DSNAMLEN;    /*@OZ25036*/ 04474000
         L     @14,NBLKNAME(,@14)                                  1187 04475000
         LH    @07,DSNAMLEN(,@14)                                  1187 04476000
         ST    @07,OBJIX6                                          1187 04477000
*                                         /* GET THE NAME LENGTH     */ 04478000
*                            CALL MESSAGE(0,MSGID20,NBLKNAME->DSNAM,    04479000
*                             OBJIX6); /* PRINT DATA SET NAME@OZ25036*/ 04480000
         LA    @07,@CF00116                                        1188 04481000
         ST    @07,@AL00001                                        1188 04482000
         LA    @07,@CH00885                                        1188 04483000
         ST    @07,@AL00001+4                                      1188 04484000
         LA    @14,DSNAM(,@14)                                     1188 04485000
         ST    @14,@AL00001+8                                      1188 04486000
         LA    @14,OBJIX6                                          1188 04487000
         ST    @14,@AL00001+12                                     1188 04488000
         LA    @01,@AL00001                                        1188 04489000
         BAL   @14,MESSAGE                                         1188 04490000
*                          END;                            /*@OZ25036*/ 04491000
*                    END;                                  /*@OZ25036*/ 04492000
@RC01181 DS    0H                                                  1190 04493000
@DE01180 LR    @14,I                                               1190 04494000
         MH    @14,@CH00038                                        1190 04495000
         L     @01,CRVDIREC(,CRVEBASE)                             1190 04496000
         ALR   @01,@14                                             1190 04497000
         BCTR  @01,0                                               1190 04498000
         BCTR  @01,0                                               1190 04499000
         SLR   @14,@14                                             1190 04500000
         ICM   @14,3,DIRELPNO-10(@01)                              1190 04501000
         CH    @14,VGODIRSN(,VGOPTR1)                              1190 04502000
         BE    @DC01180                                            1190 04503000
         TM    PDELERR,B'10000000'                                 1190 04504000
         BZ    @DL01180                                            1190 04505000
@DC01180 DS    0H                                                  1191 04506000
*                    IF PDELERR = ON                       /*@OZ25036*/ 04507000
*                      THEN;                               /*@OZ25037*/ 04508000
         TM    PDELERR,B'10000000'                                 1191 04509000
         BO    @RT01191                                            1191 04510000
*                      ELSE                                /*@OZ25037*/ 04511000
*                      IF (DIRCI(I)=OBJCI & (DIRTS(I)=VGOCRATS     1193 04512000
*                         | DIRTS(I)='FFFFFFFF'X))         /*@OZ25037*/ 04513000
*                                 /* IF THE CI AND TIMESTAMP         */ 04514000
*                                 /* MATCHES                         */ 04515000
*                  THEN DO;       /* THEN:                           */ 04516000
         LR    @14,I                                               1193 04517000
         MH    @14,@CH00038                                        1193 04518000
         L     @07,CRVDIREC(,CRVEBASE)                             1193 04519000
         L     @06,@PC00016                                        1193 04520000
         ST    @14,@TF00001                                        1193 04521000
         ALR   @14,@07                                             1193 04522000
         AL    @14,@CF01407                                        1193 04523000
         CLC   DIRCI(3,@14),OBJCI(@06)                             1193 04524000
         BNE   @RF01193                                            1193 04525000
         LR    @14,@07                                             1193 04526000
         AL    @14,@TF00001                                        1193 04527000
         AL    @14,@CF01408                                        1193 04528000
         CLC   DIRTS-3(4,@14),VGOCRATS                             1193 04529000
         BE    @RT01193                                            1193 04530000
         AL    @07,@TF00001                                        1193 04531000
         AL    @07,@CF01408                                        1193 04532000
         CLC   DIRTS-3(4,@07),@CB01300                             1193 04533000
         BNE   @RF01193                                            1193 04534000
@RT01193 DS    0H                                                  1194 04535000
*                    OBJSUMTT=0;  /* ZERO THE SUMTT FIELD            */ 04536000
         SLR   @14,@14                                             1195 04537000
         ST    @14,OBJSUMTT                                        1195 04538000
*                    /************************************************/ 04539000
*                    /* SAVE THE POINTER TO THE CURRENT      @OZ14812*/ 04540000
*                    /* ENTRY, THE LOOP COUNTER, AND THE     @OZ14812*/ 04541000
*                    /* CURRENT VOLSER FOR NEXT LOOP:        @OZ14812*/ 04542000
*                    /************************************************/ 04543000
*                    OBJIX4=VGOPTR1;                       /*@OZ14812*/ 04544000
         ST    VGOPTR1,OBJIX4                                      1196 04545000
*                    OBJIX7=OBJIX1;                        /*@OZ14812*/ 04546000
         L     OBJIX7,OBJIX1                                       1197 04547000
*                    OBJVOL2=VGOVOLSR;                     /*@OZ14812*/ 04548000
         MVC   OBJVOL2(6),VGOVOLSR(VGOPTR1)                        1198 04549000
*                    /************************************************/ 04550000
*                    /* NOW LOOP THROUGH THE REST OF THE     @OZ14812*/ 04551000
*                    /* VGO TABLE, LOOKING FOR ENTRIES       @OZ14812*/ 04552000
*                    /* HAVING THE SAME VOLSER (NOTE THAT    @OZ14812*/ 04553000
*                    /* FIRST TIME WE FIND CURRENT ENTRY):   @OZ14812*/ 04554000
*                    /************************************************/ 04555000
*                    DO WHILE OBJIX7>0;                    /*@OZ14812*/ 04556000
         B     @DE01199                                            1199 04557000
@DL01199 DS    0H                                                  1200 04558000
*                      IF VGOVOLSR=OBJVOL2 & VGOEXLEN>0    /*@OZ14812*/ 04559000
*                        THEN                              /*@OZ14812*/ 04560000
         CLC   VGOVOLSR(6,VGOPTR1),OBJVOL2                         1200 04561000
         BNE   @RF01200                                            1200 04562000
         LH    @14,VGOEXLEN(,VGOPTR1)                              1200 04563000
         LTR   @14,@14                                             1200 04564000
         BNP   @RF01200                                            1200 04565000
*                          DO;                             /*@OZ14812*/ 04566000
*                            /* SET SWITCH TO IGNORE THIS    @OZ14812*/ 04567000
*                            /* ENTRY NEXT TIME:             @OZ14812*/ 04568000
*                            VGOSKIP(1)='FF'X;             /*@OZ14812*/ 04569000
         MVI   VGOSKIP(VGOPTR1),X'FF'                              1202 04570000
*                            /* ACCCUMULATE THE SUMTT        @OZ14812*/ 04571000
*                            OBJIX5=VGOEXLEN/LENGTH(VGOEXT);       1203 04572000
         LR    @00,@14                                             1203 04573000
         SRDA  @00,32                                              1203 04574000
         D     @00,@CF00885                                        1203 04575000
         ST    @01,OBJIX5                                          1203 04576000
*                            DO OBJIX6=1 TO OBJIX5;        /*@OZ14812*/ 04577000
         LA    @14,1                                               1204 04578000
         B     @DE01204                                            1204 04579000
@DL01204 DS    0H                                                  1205 04580000
*                              OBJSUMTT=OBJSUMTT+VGOHH(OBJIX6)+    1205 04581000
*                                       VGOCC(OBJIX6)*CRVTKPCY;    1205 04582000
         LR    @07,@14                                             1205 04583000
         MH    @07,@CH00885                                        1205 04584000
         LR    @01,VGOPTR1                                         1205 04585000
         AL    @01,@CF01409                                        1205 04586000
         LH    @01,VGOHH-14(@07,@01)                               1205 04587000
         AL    @01,OBJSUMTT                                        1205 04588000
         AL    @07,@CF01384                                        1205 04589000
         LH    @07,VGOCC-12(@07,VGOPTR1)                           1205 04590000
         MH    @07,CRVTKPCY(,CRVEBASE)                             1205 04591000
         ALR   @01,@07                                             1205 04592000
         ST    @01,OBJSUMTT                                        1205 04593000
*                            END;                          /*@OZ14812*/ 04594000
         AL    @14,@CF00220                                        1206 04595000
@DE01204 ST    @14,OBJIX6                                          1206 04596000
         C     @14,OBJIX5                                          1206 04597000
         BNH   @DL01204                                            1206 04598000
*                          END;                            /*@OZ14812*/ 04599000
*                      /* BUMP TO NEXT VGO ENTRY             @OZ14812*/ 04600000
*                      VGOPTR1=VGOPTR1+VGOEXLEN            /*@OZ14812*/ 04601000
*                              +LENGTH(VGOENT);            /*@OZ14812*/ 04602000
@RF01200 LA    @14,10                                              1208 04603000
         LR    @07,VGOPTR1                                         1208 04604000
         AH    @07,VGOEXLEN(,VGOPTR1)                              1208 04605000
         ALR   @07,@14                                             1208 04606000
         LR    VGOPTR1,@07                                         1208 04607000
*                      OBJIX7=OBJIX7-VGOEXLEN              /*@OZ14812*/ 04608000
*                             -LENGTH(VGOENT);             /*@OZ14812*/ 04609000
         LR    @07,OBJIX7                                          1209 04610000
         SH    @07,VGOEXLEN(,VGOPTR1)                              1209 04611000
         SLR   @07,@14                                             1209 04612000
         LR    OBJIX7,@07                                          1209 04613000
*                    END;                                  /*@OZ14812*/ 04614000
@DE01199 LTR   OBJIX7,OBJIX7                                       1210 04615000
         BP    @DL01199                                            1210 04616000
*                    /* RESTORE PTR TO CURRENT ENTRY         @OZ14812*/ 04617000
*                    VGOPTR1=OBJIX4;                       /*@OZ14812*/ 04618000
         L     VGOPTR1,OBJIX4                                      1211 04619000
*                    IF OBJSUMTT=DIRSUMTT(I) |             /*@OZ25037*/ 04620000
*                       DIRSUMTT(I)='FFFFFF'X              /*@OZ25037*/ 04621000
*                                 /* IF THE SUMS MATCH               */ 04622000
*                      THEN;      /* THEN: CONTINUE                  */ 04623000
         LR    @14,I                                               1212 04624000
         MH    @14,@CH00038                                        1212 04625000
         L     @07,CRVDIREC(,CRVEBASE)                             1212 04626000
         L     @06,OBJSUMTT                                        1212 04627000
         LA    @01,0(@14,@07)                                      1212 04628000
         AL    @01,@CF01409                                        1212 04629000
         L     @01,DIRSUMTT-7(,@01)                                1212 04630000
         LA    @01,0(,@01)                                         1212 04631000
         CR    @06,@01                                             1212 04632000
         BE    @RT01212                                            1212 04633000
         ALR   @07,@14                                             1212 04634000
         AL    @07,@CF01410                                        1212 04635000
         CLC   DIRSUMTT-7(3,@07),@CB00655                          1212 04636000
         BE    @RT01212                                            1212 04637000
*                      ELSE NBLKSC=ON;                             1214 04638000
         L     @14,NBLKPTR                                         1214 04639000
         OI    NBLKSC(@14),B'00100000'                             1214 04640000
*                                 /* ELSE: INDICATE OUT-OF-SYNC      */ 04641000
*                    END;         /*                                 */ 04642000
*                  /**************************************************/ 04643000
*                  /*                                                */ 04644000
*                  /*    HANDLE PRINTING THE VOLUME OUT-OF-SYNC      */ 04645000
*                  /*    MESSAGE                                     */ 04646000
*                  /*                                                */ 04647000
*                  /**************************************************/ 04648000
*                                                                  1216 04649000
*                  ELSE           /* ELSE:                           */ 04650000
*                    DO;                                           1216 04651000
         B     @RC01193                                            1216 04652000
@RF01193 DS    0H                                                  1217 04653000
*                      IF VGOCRATS>DIRTS(I)                /*@OZ25037*/ 04654000
*                             /* IF OBJECT VOLUME IS LATER           */ 04655000
*                             /* VOLUME                              */ 04656000
*                        THEN CALL MESSAGE(2,MSGID12,              1217 04657000
         LR    @14,I                                               1217 04658000
         MH    @14,@CH00038                                        1217 04659000
         L     @01,CRVDIREC(,CRVEBASE)                             1217 04660000
         ALR   @01,@14                                             1217 04661000
         AL    @01,@CF01408                                        1217 04662000
         CLC   VGOCRATS(4),DIRTS-3(@01)                            1217 04663000
         BNH   @RF01217                                            1217 04664000
*                                  OBJVOLSR,LENGTH(OBJVOLSR),      1218 04665000
*                                  VGOVOLSR,LENGTH(VGOVOLSR));     1218 04666000
         MVC   @AL00001(24),@AL01218                               1218 04667000
         L     @14,@PC00016+4                                      1218 04668000
         ST    @14,@AL00001+8                                      1218 04669000
         ST    VGOPTR1,@AL00001+16                                 1218 04670000
         LA    @01,@AL00001                                        1218 04671000
         BAL   @14,MESSAGE                                         1218 04672000
*                        ELSE CALL MESSAGE(2,MSGID12,              1219 04673000
*                                  VGOVOLSR,LENGTH(VGOVOLSR),      1219 04674000
*                                  OBJVOLSR,LENGTH(OBJVOLSR));     1219 04675000
         B     @RC01217                                            1219 04676000
@RF01217 MVC   @AL00001(24),@AL01219                               1219 04677000
         ST    VGOPTR1,@AL00001+8                                  1219 04678000
         L     @14,@PC00016+4                                      1219 04679000
         ST    @14,@AL00001+16                                     1219 04680000
         LA    @01,@AL00001                                        1219 04681000
         BAL   @14,MESSAGE                                         1219 04682000
*                      NBLKBE=ON;   /* MARK AS BAD ENTRY             */ 04683000
@RC01217 L     @14,NBLKPTR                                         1220 04684000
         OI    NBLKBE(@14),B'01000000'                             1220 04685000
*                      OBJIX6=NBLKNAME->DSNAMLEN;                  1221 04686000
         L     @14,NBLKNAME(,@14)                                  1221 04687000
         LH    @04,DSNAMLEN(,@14)                                  1221 04688000
         ST    @04,OBJIX6                                          1221 04689000
*                                   /* GET THE NAME LENGTH           */ 04690000
*                      CALL MESSAGE(0,MSGID20,NBLKNAME->DSNAM,OBJIX6);  04691000
         LA    @04,@CF00116                                        1222 04692000
         ST    @04,@AL00001                                        1222 04693000
         LA    @04,@CH00885                                        1222 04694000
         ST    @04,@AL00001+4                                      1222 04695000
         LA    @14,DSNAM(,@14)                                     1222 04696000
         ST    @14,@AL00001+8                                      1222 04697000
         LA    @14,OBJIX6                                          1222 04698000
         ST    @14,@AL00001+12                                     1222 04699000
         LA    @01,@AL00001                                        1222 04700000
         BAL   @14,MESSAGE                                         1222 04701000
*                                   /* PRINT THE DATA SET NAME       */ 04702000
*                    END;           /*                               */ 04703000
*                END INLOOP2;       /*                       @OZ25036*/ 04704000
*                                                                  1224 04705000
*                /****************************************************/ 04706000
*                /*                                                  */ 04707000
*                /*  HANDLE PRINTING THE UNUSEABLE MESSAGE   @OZ25036*/ 04708000
*                /*  (THE VGODIRSN IS ZERO) AND DATA SET NAME@OZ25036*/ 04709000
*                /*                                                  */ 04710000
*                /****************************************************/ 04711000
*                                                                  1225 04712000
*              ELSE                                        /*@OZ25036*/ 04713000
*                DO;                                       /*@OZ25036*/ 04714000
         B     @RC01176                                            1225 04715000
@RF01176 DS    0H                                                  1226 04716000
*                  CALL MESSAGE(0,MSGID24,0,0);            /*@OZ25036*/ 04717000
         LA    @01,@AL01226                                        1226 04718000
         BAL   @14,MESSAGE                                         1226 04719000
*                  OBJIX6=NBLKNAME->DSNAMLEN;                      1227 04720000
         L     @14,NBLKPTR                                         1227 04721000
         L     @14,NBLKNAME(,@14)                                  1227 04722000
         LH    @04,DSNAMLEN(,@14)                                  1227 04723000
         ST    @04,OBJIX6                                          1227 04724000
*                                   /* GET THE NAME LENGTH   @OZ25036*/ 04725000
*                  CALL MESSAGE(0,MSGID20,NBLKNAME->DSNAM,OBJIX6); 1228 04726000
         LA    @04,@CF00116                                        1228 04727000
         ST    @04,@AL00001                                        1228 04728000
         LA    @04,@CH00885                                        1228 04729000
         ST    @04,@AL00001+4                                      1228 04730000
         LA    @14,DSNAM(,@14)                                     1228 04731000
         ST    @14,@AL00001+8                                      1228 04732000
         LA    @14,OBJIX6                                          1228 04733000
         ST    @14,@AL00001+12                                     1228 04734000
         LA    @01,@AL00001                                        1228 04735000
         BAL   @14,MESSAGE                                         1228 04736000
*                                   /* PRINT DATA SET NAME   @OZ25036*/ 04737000
*                  NBLKBE = ON;                            /*@OZ25036*/ 04738000
         L     @14,NBLKPTR                                         1229 04739000
         OI    NBLKBE(@14),B'01000000'                             1229 04740000
*                END;                                      /*@OZ25036*/ 04741000
*            END INLOOP1;                                  /*@OZ25037*/ 04742000
@RC01176 DS    0H                                                  1232 04743000
*          END;                                            /*@OZ25037*/ 04744000
@RT01173 DS    0H                                                  1233 04745000
*        CRVEBASE=OBJIX8;         /* RESTORE THE ORIGINAL BASE       */ 04746000
@RC01170 L     CRVEBASE,OBJIX8                                     1233 04747000
*        END;                     /*                                 */ 04748000
*                                                                  1234 04749000
*    /****************************************************************/ 04750000
*    /*                                                              */ 04751000
*    /*    CONTINUE TO HANDLE THE NEXT VOLUME OF THE DATA SET        */ 04752000
*    /*                                                              */ 04753000
*    /****************************************************************/ 04754000
*                                                                  1235 04755000
*    OBJIX1=OBJIX1-VGOEXLEN-LENGTH(VGOENT);                        1235 04756000
@RC01151 LA    @14,10                                              1235 04757000
         LH    @04,VGOEXLEN(,VGOPTR1)                              1235 04758000
         L     @07,OBJIX1                                          1235 04759000
         SLR   @07,@04                                             1235 04760000
         SLR   @07,@14                                             1235 04761000
         ST    @07,OBJIX1                                          1235 04762000
*                                 /* DECREMENT BY LENGTH             */ 04763000
*                                 /* PROCESSED                       */ 04764000
*    VGOPTR1=VGOPTR1+VGOEXLEN+LENGTH(VGOENT);                      1236 04765000
         ALR   @04,VGOPTR1                                         1236 04766000
         ALR   @04,@14                                             1236 04767000
         LR    VGOPTR1,@04                                         1236 04768000
*                                 /* POINT TO NEXT VOLSER            */ 04769000
*    END;                         /*                                 */ 04770000
*                                                                  1237 04771000
@DE01141 SLR   @14,@14                                             1237 04772000
         C     @14,OBJIX1                                          1237 04773000
         BL    @DL01141                                            1237 04774000
*  RETURN CODE(LASTCC00);         /* RETURN ZERO RETURN CODE         */ 04775000
*                                                                  1238 04776000
         LR    @15,@14                                             1238 04777000
         L     @14,@SA00016                                        1238 04778000
         LM    @00,@02,@SA00016+8                                  1238 04779000
         LM    @04,@12,@SA00016+20                                 1238 04780000
         BR    @14                                                 1238 04781000
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */ 04782000
*                                                                  1239 04783000
*  END OBJVOLCK;                  /* END OF PROCEDURE                */ 04784000
@PB00016 DS    0H                                                  1241 04785000
*  GEN (EJECT);                                                    1241 04786000
         EJECT                                                          04787000
*  /******************************************************************/ 04788000
*  /*                                                                */ 04789000
*  /* PROCEDURE NAME:                                                */ 04790000
*  /*    OPEN                                                        */ 04791000
*  /*                                                                */ 04792000
*  /* FUNCTION:                                                      */ 04793000
*  /*                                                                */ 04794000
*  /*    THIS ROUTINE ACTS AS A DRIVER FOR ALL OF THE ROUTINES       */ 04795000
*  /*    THAT ARE REQUIRED TO OPEN A CRA                             */ 04796000
*  /*                                                                */ 04797000
*  /* REQUIREMENTS:                                                  */ 04798000
*  /*                                                                */ 04799000
*  /*    1. THE CRV MUST BE CONSTRUCTED                              */ 04800000
*  /*                                                                */ 04801000
*  /******************************************************************/ 04802000
*                                                                  1242 04803000
*OPEN: PROCEDURE (OPARM4,OPARM5);                                  1242 04804000
*                                                                  1242 04805000
         B     @PB00017                                            1242 04806000
OPEN     STM   @14,@01,@SA00017                                    1242 04807000
         STM   @03,@12,@SA00017+16                                 1242 04808000
         MVC   @PC00017(8),0(@01)                                  1242 04809000
*  DCL OPARM4     FIXED(31);      /* INDEX INTO CRV                  */ 04810000
*  DCL OPARM5     CHAR(1);        /* CRA OPEN TYPE                   */ 04811000
*                                                                  1244 04812000
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */ 04813000
*                                                                  1245 04814000
*  /******************************************************************/ 04815000
*  /*                                                                */ 04816000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 04817000
*  /*                                                                */ 04818000
*  /******************************************************************/ 04819000
*                                                                  1246 04820000
*  OLDERID2 = NEWERID2;                                            1246 04821000
         L     @14,@PC00001                                        1246 04822000
         L     @07,GDTTR2(,@14)                                    1246 04823000
         MVC   @TS00001(95),NEWERID2(@07)                          1246 04824000
         MVC   OLDERID2(95,@07),@TS00001                           1246 04825000
*  NEWID2='RC92';                                                  1247 04826000
         MVC   NEWID2(4,@07),@CC01309                              1247 04827000
*  IF GDTDBG = NULLPTR                                             1248 04828000
*    THEN;                                                         1248 04829000
         ICM   @07,15,GDTDBG(@14)                                  1248 04830000
         BZ    @RT01248                                            1248 04831000
*    ELSE                                                          1250 04832000
*      CALL IDCDB010 (GDTTBL,'RC92');                              1250 04833000
*                                                                  1250 04834000
         L     @14,@PC00001                                        1250 04835000
         ST    @14,@AL00001                                        1250 04836000
         LA    @07,@CC01309                                        1250 04837000
         ST    @07,@AL00001+4                                      1250 04838000
         MVI   @AL00001+4,X'80'                                    1250 04839000
         L     @15,GDTDBG(,@14)                                    1250 04840000
         LA    @01,@AL00001                                        1250 04841000
         BALR  @14,@15                                             1250 04842000
*  /******************************************************************/ 04843000
*  /*                                                                */ 04844000
*  /*    RETURN AN ERROR MESSAGE IF THIS CRA HAS BEEN DEFINED        */ 04845000
*  /*    AS BAD AND CAN NOT BE OPENED OR USED                        */ 04846000
*  /*                                                                */ 04847000
*  /******************************************************************/ 04848000
*                                                                  1251 04849000
*  IF CRVBADVL=ON                 /* IF THIS IS A BAD CRA            */ 04850000
*    THEN ERRNO=ERCDCNTO;         /* THEN: INDICATE NOT OPEN-        */ 04851000
@RT01248 TM    CRVBADVL(CRVEBASE),B'10000000'                      1251 04852000
         BNO   @RF01251                                            1251 04853000
         LA    ERRNO,4                                             1252 04854000
*                                 /*       ABLE ERROR CODE           */ 04855000
*    /****************************************************************/ 04856000
*    /*                                                              */ 04857000
*    /*    ATTEMPT TO OPEN THE CRA DESIRED                           */ 04858000
*    /*                                                              */ 04859000
*    /****************************************************************/ 04860000
*                                                                  1253 04861000
*    ELSE DO;                     /* ELSE:                           */ 04862000
*                                                                  1253 04863000
         B     @RC01251                                            1253 04864000
@RF01251 DS    0H                                                  1254 04865000
*      /**************************************************************/ 04866000
*      /*                                                            */ 04867000
*      /*    OBTAIN AN OPEN OPNAGL TO DO THE OPEN WITH               */ 04868000
*      /*                                                            */ 04869000
*      /**************************************************************/ 04870000
*                                                                  1254 04871000
*      IF CRVOPNAG=NULLPTR        /* IF THERE IS NO OPNAGL           */ 04872000
*                                                                  1254 04873000
*        /************************************************************/ 04874000
*        /*                                                          */ 04875000
*        /*    THERE IS NO OPNAGL SO A NEW ONE MUST BE OBTAINED      */ 04876000
*        /*    AND INITIALIZED                                       */ 04877000
*        /*                                                          */ 04878000
*        /************************************************************/ 04879000
*                                                                  1254 04880000
*        THEN DO;                 /* THEN:                           */ 04881000
         ICM   @14,15,CRVOPNAG(CRVEBASE)                           1254 04882000
         BNZ   @RF01254                                            1254 04883000
*          CALL IDCSAGP0 (GDTTBL,LENGTH(OPNAGL),OPNPTR,COREID1,SETZERO) 04884000
         MVC   @AL00001+4(16),@AL01256                             1256 04885000
         L     @14,@PC00001                                        1256 04886000
         ST    @14,@AL00001                                        1256 04887000
         LA    @07,OPNPTR                                          1256 04888000
         ST    @07,@AL00001+8                                      1256 04889000
         L     @15,GDTGPL(,@14)                                    1256 04890000
         LA    @01,@AL00001                                        1256 04891000
         BALR  @14,@15                                             1256 04892000
*                                 /* OBTAIN SPACE FOR THE            */ 04893000
*                                 /* OPNAGL                          */ 04894000
*          IF REG15^=LASTCC00     /* IF THERE IS NO STORAGE          */ 04895000
*            THEN DO;             /* THEN:                           */ 04896000
         LTR   REG15,REG15                                         1257 04897000
         BZ    @RF01257                                            1257 04898000
*              ERRNO=ERCDNSTR;    /* INDICATE NO STORAGE             */ 04899000
         LA    ERRNO,28                                            1259 04900000
*              CORE=BAD;          /* INDICATE CORE MESSAGE           */ 04901000
         MVC   CORE(1),BAD                                         1260 04902000
*              END;               /*                                 */ 04903000
*            ELSE DO;             /* ELSE:                           */ 04904000
         B     @RC01257                                            1262 04905000
@RF01257 DS    0H                                                  1263 04906000
*              CRVOPNAG=OPNPTR;   /* SAVE THE ADDRESS OF THE         */ 04907000
         L     @14,OPNPTR                                          1263 04908000
         ST    @14,CRVOPNAG(,CRVEBASE)                             1263 04909000
*                                 /* OPNAGL                          */ 04910000
*              OPNOPTIN=ON;       /* INDICATE - INPUT FILE           */ 04911000
*              OPNOPTBK=ON;       /* INDICATE - CI PROCESSING        */ 04912000
*              OPNOPTCR=ON;       /* INDICATE - ADDRESSED            */ 04913000
*                                 /*            PROCESSING           */ 04914000
*              OPNOPTDR=ON;       /* INDICATE - DIRECT               */ 04915000
         OI    OPNOPTIN(@14),B'10010110'                           1267 04916000
*                                 /*            PROCESSING           */ 04917000
*              OPNTYPRA=ON;       /* INDICATE CRA DATA SET           */ 04918000
         OI    OPNTYPRA(@14),B'00001000'                           1268 04919000
*              OPNDSOAM=ON;       /* INDICATE DATA SET IS VSAM       */ 04920000
         OI    OPNDSOAM(@14),B'10000000'                           1269 04921000
*              END;               /*                                 */ 04922000
*          END;                   /*                                 */ 04923000
*                                                                  1271 04924000
*        /************************************************************/ 04925000
*        /*                                                          */ 04926000
*        /*    POINT AT THE OLD OPNAGL USED LAST TIME SO IT          */ 04927000
*        /*    CAN BE REUSED                                         */ 04928000
*        /*                                                          */ 04929000
*        /************************************************************/ 04930000
*                                                                  1272 04931000
*        ELSE OPNPTR=CRVOPNAG;    /* POINT AT THE OLD OPNAGL         */ 04932000
         B     @RC01254                                            1272 04933000
@RF01254 MVC   OPNPTR(4),CRVOPNAG(CRVEBASE)                        1272 04934000
*      /**************************************************************/ 04935000
*      /*                                                            */ 04936000
*      /*    CHECK TO SEE IF THERE HAS BEEN AN ERROR TO NOW          */ 04937000
*      /*                                                            */ 04938000
*      /**************************************************************/ 04939000
*                                                                  1273 04940000
*      IF ERRNO^=ERCDNRML         /* IF THERE IS AN ERROR            */ 04941000
*        THEN;                    /* THEN: CONTINUE                  */ 04942000
*                                                                  1273 04943000
@RC01254 LTR   ERRNO,ERRNO                                         1273 04944000
         BNZ   @RT01273                                            1273 04945000
*        /************************************************************/ 04946000
*        /*                                                          */ 04947000
*        /*    FILL IN THE VALUES PASSED BY THE CALLER               */ 04948000
*        /*                                                          */ 04949000
*        /************************************************************/ 04950000
*                                                                  1275 04951000
*        ELSE DO;                 /* ELSE:                           */ 04952000
*          OPNIOC=ADDR(IOCSPTR);  /* SET UP ADDRESSABILITY TO        */ 04953000
         L     @14,OPNPTR                                          1276 04954000
         LA    @07,IOCSPTR                                         1276 04955000
         ST    @07,OPNIOC(,@14)                                    1276 04956000
*                                 /* THE IOCSTR                      */ 04957000
*          OPNDDN=ADDR(CRADDPTR(OPARM4)->CRADDVAL);                1277 04958000
         L     @07,@PC00017                                        1277 04959000
         L     @07,OPARM4(,@07)                                    1277 04960000
         SLA   @07,2                                               1277 04961000
         L     @06,@PC00001+4                                      1277 04962000
         L     @01,FDTPTR+16(,@06)                                 1277 04963000
         AL    @01,@CF01392                                        1277 04964000
         L     @01,CRADDPTR(@07,@01)                               1277 04965000
         LA    @07,CRADDVAL(,@01)                                  1277 04966000
         ST    @07,OPNDDN(,@14)                                    1277 04967000
*                                 /* POINT AT DDNAME                 */ 04968000
*          IF ADDR(MRPW)=NULLPTR  /* IF NO PASSWORD PROVIDED         */ 04969000
*            THEN OPNPWA=NULLPTR; /* THEN: SET NO PASSWORD           */ 04970000
         SLR   @07,@07                                             1278 04971000
         C     @07,FDTPTR+36(,@06)                                 1278 04972000
         BNE   @RF01278                                            1278 04973000
         ST    @07,OPNPWA(,@14)                                    1279 04974000
*            ELSE OPNPWA=ADDR(MRPWVAL);                            1280 04975000
         B     @RC01278                                            1280 04976000
@RF01278 L     @14,@PC00001+4                                      1280 04977000
         L     @14,FDTPTR+36(,@14)                                 1280 04978000
         LA    @14,MRPWVAL(,@14)                                   1280 04979000
         L     @01,OPNPTR                                          1280 04980000
         ST    @14,OPNPWA(,@01)                                    1280 04981000
*                                 /* ELSE: POINT AT PASS WORD        */ 04982000
*                                                                  1281 04983000
*          /**********************************************************/ 04984000
*          /*                                                        */ 04985000
*          /*    DO THE DESIRED OPEN FUNCTION FOR THIS CRA           */ 04986000
*          /*                                                        */ 04987000
*          /**********************************************************/ 04988000
*                                                                  1281 04989000
*          IF OPARM5=CRADS        /* IF OPEN AS DATA SET             */ 04990000
*            THEN CALL IDCIOOP0 (GDTTBL,OPNAGL,0);                 1281 04991000
@RC01278 L     @14,@PC00017+4                                      1281 04992000
         CLC   OPARM5(1,@14),CRADS                                 1281 04993000
         BNE   @RF01281                                            1281 04994000
         L     @14,@PC00001                                        1282 04995000
         ST    @14,@AL00001                                        1282 04996000
         L     @01,OPNPTR                                          1282 04997000
         ST    @01,@AL00001+4                                      1282 04998000
         LA    @07,@CF00116                                        1282 04999000
         ST    @07,@AL00001+8                                      1282 05000000
         MVI   @AL00001+8,X'80'                                    1282 05001000
         L     @15,GDTOPN(,@14)                                    1282 05002000
         LA    @01,@AL00001                                        1282 05003000
         BALR  @14,@15                                             1282 05004000
*                                 /* THEN: OPEN AS DATA SET          */ 05005000
*            ELSE CALL IDCIOOP0 (GDTTBL,OPNAGL,CRVCRAPL);          1283 05006000
         B     @RC01281                                            1283 05007000
@RF01281 L     @14,@PC00001                                        1283 05008000
         ST    @14,@AL00001                                        1283 05009000
         L     @01,OPNPTR                                          1283 05010000
         ST    @01,@AL00001+4                                      1283 05011000
         L     @01,CRVBASE                                         1283 05012000
         LA    @07,CRVCRAPL(,@01)                                  1283 05013000
         ST    @07,@AL00001+8                                      1283 05014000
         MVI   @AL00001+8,X'80'                                    1283 05015000
         L     @15,GDTOPN(,@14)                                    1283 05016000
         LA    @01,@AL00001                                        1283 05017000
         BALR  @14,@15                                             1283 05018000
*                                 /* ELSE: OPEN AS CATALOG           */ 05019000
*          CRVIOSTR=IOCSPTR;      /* SAVE ADDRESS OF THE IOCSTR      */ 05020000
@RC01281 L     @14,IOCSPTR                                         1284 05021000
         ST    @14,CRVIOSTR(,CRVEBASE)                             1284 05022000
*                                 /* FOR LATTER USE                  */ 05023000
*          /**********************************************************/ 05024000
*          /*                                                        */ 05025000
*          /*    CHECK TO SEE IF THE CRA WAS SUCCESSFULLY            */ 05026000
*          /*    OPENED                                              */ 05027000
*          /*                                                        */ 05028000
*          /**********************************************************/ 05029000
*                                                                  1285 05030000
*          IF  IOCMSGOP=ON        /* IF THE DATA SET IS OPENED       */ 05031000
*                                                                  1285 05032000
*            /********************************************************/ 05033000
*            /*                                                      */ 05034000
*            /*    CHECK TO SEE IF THE OWNING CATALOG IS             */ 05035000
*            /*    CORRECT                                           */ 05036000
*            /*                                                      */ 05037000
*            /********************************************************/ 05038000
*                                                                  1285 05039000
*            THEN DO;             /* THEN:                           */ 05040000
         TM    IOCMSGOP(@14),B'00100000'                           1285 05041000
         BNO   @RF01285                                            1285 05042000
*              CALL IDCIOVY0 (GDTTBL,IOCSPTR);                     1287 05043000
         L     @14,@PC00001                                        1287 05044000
         ST    @14,@AL00001                                        1287 05045000
         LA    @07,IOCSPTR                                         1287 05046000
         ST    @07,@AL00001+4                                      1287 05047000
         MVI   @AL00001+4,X'80'                                    1287 05048000
         L     @15,GDTVFY(,@14)                                    1287 05049000
         LA    @01,@AL00001                                        1287 05050000
         BALR  @14,@15                                             1287 05051000
*                                 /* VERIFY THE CRA                  */ 05052000
*              IF REG15=LASTCC00  /* IF THE VERIFY IS CORRECT        */ 05053000
*                THEN CALL CKCATNM (OPARM4);                       1288 05054000
         LTR   REG15,REG15                                         1288 05055000
         BNZ   @RF01288                                            1288 05056000
         L     @14,@PC00017                                        1289 05057000
         ST    @14,@AL00001                                        1289 05058000
         LA    @01,@AL00001                                        1289 05059000
         BAL   @14,CKCATNM                                         1289 05060000
*                                 /* THEN: CHECK TO SEE IF THE       */ 05061000
*                                 /*       OWNING CATALOG IS         */ 05062000
*                                 /*       CORRECT                   */ 05063000
*                ELSE DO;         /* ELSE:                           */ 05064000
         B     @RC01288                                            1290 05065000
@RF01288 DS    0H                                                  1291 05066000
*                  RSNCD=RSNCD01; /* SET THE REASON CODE             */ 05067000
         MVC   RSNCD(2),@CC00916                                   1291 05068000
*                  ERRNO=ERCDIOER;/* INDICATE VERIFY WAS NOT         */ 05069000
         LA    ERRNO,12                                            1292 05070000
*                                 /* SUCCESSFUL                      */ 05071000
*                  END;           /*                                 */ 05072000
*              END;               /*                                 */ 05073000
*                                                                  1294 05074000
*            /********************************************************/ 05075000
*            /*                                                      */ 05076000
*            /*    INDICATE THAT THE OPEN DID NOT TAKE PLACE AS      */ 05077000
*            /*    WAS DESIRED                                       */ 05078000
*            /*                                                      */ 05079000
*            /********************************************************/ 05080000
*                                                                  1295 05081000
*            ELSE DO;             /* ELSE:                           */ 05082000
         B     @RC01285                                            1295 05083000
@RF01285 DS    0H                                                  1296 05084000
*              RSNCD=RSNCD02;     /* SET THE REASON CODE             */ 05085000
         MVC   RSNCD(2),@CC00918                                   1296 05086000
*              ERRNO=ERCDDNTO;    /* INDICATE THAT THE OPEN WAS      */ 05087000
         LA    ERRNO,8                                             1297 05088000
*                                 /* UNSUCCESSFUL                    */ 05089000
*              END;               /*                                 */ 05090000
*          END;                   /*                                 */ 05091000
*      END;                       /*                                 */ 05092000
*                                                                  1300 05093000
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */ 05094000
*                                                                  1301 05095000
*  END OPEN;                      /* END OF PROCEDURE                */ 05096000
@EL00017 DS    0H                                                  1302 05097000
@EF00017 DS    0H                                                  1302 05098000
@ER00017 LM    @14,@01,@SA00017                                    1302 05099000
         LM    @03,@12,@SA00017+16                                 1302 05100000
         BR    @14                                                 1302 05101000
@PB00017 DS    0H                                                  1303 05102000
*  GEN (EJECT);                                                    1303 05103000
         EJECT                                                          05104000
*  /******************************************************************/ 05105000
*  /*                                                                */ 05106000
*  /* PROCEDURE NAME:                                                */ 05107000
*  /*    OPENCRA                                                     */ 05108000
*  /*                                                                */ 05109000
*  /* FUNCTION:                                                      */ 05110000
*  /*    THIS IS THE DRIVER TO OPEN THE CRA AND CONSTRUCT THE        */ 05111000
*  /*    TABLES THAT ARE REQUIRED. THE FOLLOWING TABLES AREA         */ 05112000
*  /*    CONSTRUCTED BY ROUTINES THAT ARE CALLED:                    */ 05113000
*  /*        OPNAGL                                                  */ 05114000
*  /*        IOCSTR                                                  */ 05115000
*  /*        VTT                                                     */ 05116000
*  /*        CTT                                                     */ 05117000
*  /*        DIREC                                                   */ 05118000
*  /*                                                                */ 05119000
*  /* REQUIREMENTS:                                                  */ 05120000
*  /*                                                                */ 05121000
*  /*    1. THE CRV MUST BE CONSTRUCTED.                             */ 05122000
*  /*                                                                */ 05123000
*  /******************************************************************/ 05124000
*                                                                  1304 05125000
*OPENCRA: PROCEDURE (PARM2,PARM4,PARM5);                           1304 05126000
*                                                                  1304 05127000
         B     @PB00018                                            1304 05128000
OPENCRA  STM   @14,@02,@SA00018                                    1304 05129000
         STM   @04,@12,@SA00018+20                                 1304 05130000
         MVC   @PC00018(12),0(@01)                                 1304 05131000
*  /******************************************************************/ 05132000
*  /*                                                                */ 05133000
*  /*     THIS IS THE DESCRIPTION OF THE INCOMING PARAMETERS         */ 05134000
*  /*                                                                */ 05135000
*  /******************************************************************/ 05136000
*                                                                  1305 05137000
*  DCL PARM2    CHAR(1);          /* O=OPEN SPECIFIED CRV            */ 05138000
*                                 /* C=CLOSE SPECIFIED CRV           */ 05139000
*  DCL PARM4    FIXED(31);        /* INDEX INTO THE CRV FOR THE      */ 05140000
*  DCL PARM5    CHAR(1);          /* CRA OPEN TYPE                   */ 05141000
*                                                                  1307 05142000
*  /******************************************************************/ 05143000
*  /*                                                                */ 05144000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 05145000
*  /*                                                                */ 05146000
*  /******************************************************************/ 05147000
*                                                                  1308 05148000
*  OLDERID2 = NEWERID2;                                            1308 05149000
         L     @04,@PC00001                                        1308 05150000
         L     @15,GDTTR2(,@04)                                    1308 05151000
         MVC   @TS00001(95),NEWERID2(@15)                          1308 05152000
         MVC   OLDERID2(95,@15),@TS00001                           1308 05153000
*  NEWID2='RC91';                                                  1309 05154000
         MVC   NEWID2(4,@15),@CC01319                              1309 05155000
*  IF GDTDBG = NULLPTR                                             1310 05156000
*    THEN;                                                         1310 05157000
         ICM   @15,15,GDTDBG(@04)                                  1310 05158000
         BZ    @RT01310                                            1310 05159000
*    ELSE                                                          1312 05160000
*      CALL IDCDB010 (GDTTBL,'RC91');                              1312 05161000
         L     @04,@PC00001                                        1312 05162000
         ST    @04,@AL00001                                        1312 05163000
         LA    @15,@CC01319                                        1312 05164000
         ST    @15,@AL00001+4                                      1312 05165000
         MVI   @AL00001+4,X'80'                                    1312 05166000
         L     @15,GDTDBG(,@04)                                    1312 05167000
         LA    @01,@AL00001                                        1312 05168000
         BALR  @14,@15                                             1312 05169000
*  /******************************************************************/ 05170000
*  /*                                                                */ 05171000
*  /*    INITIALIZE THE RETURN CODE FOR FUNCTION                     */ 05172000
*  /*                                                                */ 05173000
*  /******************************************************************/ 05174000
*                                                                  1313 05175000
*  ERRNO=ERCDNRML;                /* INITIALIZE INTERNAL ERROR       */ 05176000
@RT01310 SLR   ERRNO,ERRNO                                         1313 05177000
*                                 /* CODE                            */ 05178000
*                                                                  1314 05179000
*  /******************************************************************/ 05180000
*  /*                                                                */ 05181000
*  /*    SET UP THE ADDRESSABILITY TO THE CORRECT ENTRY              */ 05182000
*  /*                                                                */ 05183000
*  /******************************************************************/ 05184000
*                                                                  1314 05185000
*  CRVEBASE=ADDR(CRVENTRY(PARM4));/* POINT AT THE CORRECT ENTRY      */ 05186000
*                                                                  1314 05187000
         L     @04,@PC00018+4                                      1314 05188000
         L     @15,PARM4(,@04)                                     1314 05189000
         MH    @15,@CH00954                                        1314 05190000
         L     CRVEBASE,CRVBASE                                    1314 05191000
         LA    CRVEBASE,CRVENTRY-28(@15,CRVEBASE)                  1314 05192000
*  /******************************************************************/ 05193000
*  /*                                                                */ 05194000
*  /*    INDICATE THE BUFFER POOL FOR FIELD MANAGEMENT NEEDS TO      */ 05195000
*  /*    BE REFORMATED BEFORE USE                                    */ 05196000
*  /*                                                                */ 05197000
*  /******************************************************************/ 05198000
*                                                                  1315 05199000
*  BUFORMAT=OFF;                  /* INDICATE BUFFER POOL NEEDS      */ 05200000
         NI    BUFORMAT(BUFSPTR),B'01111111'                       1315 05201000
*                                 /* TO BE FORMATED                  */ 05202000
*  /******************************************************************/ 05203000
*  /*                                                                */ 05204000
*  /*    HANDLE THE OPEN FUNCTION IF REQUESTED                       */ 05205000
*  /*                                                                */ 05206000
*  /******************************************************************/ 05207000
*                                                                  1316 05208000
*  IF PARM2=OPENFUNC              /* IF OPEN FUNCTION REQUESTED      */ 05209000
*    THEN DO;                     /* THEN:                           */ 05210000
         L     @15,@PC00018                                        1316 05211000
         CLI   PARM2(@15),C'O'                                     1316 05212000
         BNE   @RF01316                                            1316 05213000
*      CALL OPEN(PARM4,PARM5);    /* ATTEMPT TO OPEN THE CRA         */ 05214000
         ST    @04,@AL00001                                        1318 05215000
         L     @04,@PC00018+8                                      1318 05216000
         ST    @04,@AL00001+4                                      1318 05217000
         LA    @01,@AL00001                                        1318 05218000
         BAL   @14,OPEN                                            1318 05219000
*                                 /* AND CHECK CATALOG NAME          */ 05220000
*      CALL TIMESTMP(PARM4);      /* PLACE TIMESTAMP FOR VOLUME      */ 05221000
         L     @04,@PC00018+4                                      1319 05222000
         ST    @04,@AL00001                                        1319 05223000
         LA    @01,@AL00001                                        1319 05224000
         BAL   @14,TIMESTMP                                        1319 05225000
*                                 /* IN THE TABLE                    */ 05226000
*      CALL SCANCRA(PARM4);       /* BUILD THE NAME TABLE            */ 05227000
         L     @04,@PC00018+4                                      1320 05228000
         ST    @04,@AL00001                                        1320 05229000
         LA    @01,@AL00001                                        1320 05230000
         BAL   @14,SCANCRA                                         1320 05231000
*      CALL DIRECT;               /* BUILD THE DIRECTORY ENTRY       */ 05232000
         BAL   @14,DIRECT                                          1321 05233000
*      CALL ERRCK(PARM4);         /* PROCESS ANY ERRORS              */ 05234000
         L     @04,@PC00018+4                                      1322 05235000
         ST    @04,@AL00001                                        1322 05236000
         LA    @01,@AL00001                                        1322 05237000
         BAL   @14,ERRCK                                           1322 05238000
*      END;                       /*                                 */ 05239000
*    ELSE;                        /* ELSE: CONTINUE                  */ 05240000
@RF01316 DS    0H                                                  1325 05241000
*  /*****************************************************************/  05242000
*  /*                                                                */ 05243000
*  /*    HANDLE THE CLOSE FUNCTION IF REQUESTED                      */ 05244000
*  /*                                                                */ 05245000
*  /******************************************************************/ 05246000
*                                                                  1325 05247000
*  IF PARM2=CLOSFUNC              /* IF CLOSE FUNCTION IS            */ 05248000
*                                 /* REQUESTED                       */ 05249000
*    THEN DO;                     /* THEN:                           */ 05250000
         L     @04,@PC00018                                        1325 05251000
         CLI   PARM2(@04),C'C'                                     1325 05252000
         BNE   @RF01325                                            1325 05253000
*      CALL IDCIOCL0 (GDTTBL,CRVIOSTR);/*                          1327 05254000
*                                    CLOSE THE DESIRED ACB           */ 05255000
         L     @04,@PC00001                                        1327 05256000
         ST    @04,@AL00001                                        1327 05257000
         LA    @15,CRVIOSTR(,CRVEBASE)                             1327 05258000
         ST    @15,@AL00001+4                                      1327 05259000
         MVI   @AL00001+4,X'80'                                    1327 05260000
         L     @15,GDTCLS(,@04)                                    1327 05261000
         LA    @01,@AL00001                                        1327 05262000
         BALR  @14,@15                                             1327 05263000
*      END;                       /*                                 */ 05264000
*    ELSE;                        /* ELSE: CONTINUE                  */ 05265000
*                                                                  1329 05266000
@RF01325 DS    0H                                                  1330 05267000
*  /******************************************************************/ 05268000
*  /*                                                                */ 05269000
*  /*    EXIT FROM THIS ROUTINE                                      */ 05270000
*  /*                                                                */ 05271000
*  /******************************************************************/ 05272000
*                                                                  1330 05273000
*  RETURN CODE(ERRNO);            /* RETURN THE ERROR CODE           */ 05274000
*                                                                  1330 05275000
         LR    @15,ERRNO                                           1330 05276000
         L     @14,@SA00018                                        1330 05277000
         LM    @00,@02,@SA00018+8                                  1330 05278000
         LM    @04,@12,@SA00018+20                                 1330 05279000
         BR    @14                                                 1330 05280000
*  END OPENCRA;                   /* END OF PROCEDURE                */ 05281000
@PB00018 DS    0H                                                  1332 05282000
*  GEN (EJECT);                                                    1332 05283000
         EJECT                                                          05284000
*  /******************************************************************/ 05285000
*  /*                                                                */ 05286000
*  /* PROCEDURE NAME:                                                */ 05287000
*  /*    SCANCRA                                                     */ 05288000
*  /*                                                                */ 05289000
*  /* FUNCTION:                                                      */ 05290000
*  /*    SCAN THE CRA AND CONSTRUCT THE CTT.  IF ALL IS              */ 05291000
*  /*    SPECIFIED THEN CONSTRUCT THE NAME CHAIN.  IF ENTRIES        */ 05292000
*  /*    IS SPECIFIED THEN MARK THE NAME CHAIN FOUND SO THAT         */ 05293000
*  /*    IT IS KNOW IF THE NAME IS PRESENT.                          */ 05294000
*  /*                                                                */ 05295000
*  /* REQUIREMENTS:                                                  */ 05296000
*  /*                                                                */ 05297000
*  /*    1. CRV MUST BE CONSTRUCTED.                                 */ 05298000
*  /*                                                                */ 05299000
*  /*    2. CRA MUST BE OPENED.                                      */ 05300000
*  /*                                                                */ 05301000
*  /******************************************************************/ 05302000
*                                                                  1333 05303000
*SCANCRA: PROCEDURE (SPARM4);                                      1333 05304000
*                                                                  1333 05305000
         B     @PB00019                                            1333 05306000
SCANCRA  STM   @14,@01,@SA00019                                    1333 05307000
         STM   @03,@12,@SA00019+16                                 1333 05308000
         MVC   @PC00019(4),0(@01)                                  1333 05309000
*  DCL SPARM4      FIXED(31);     /* INDEX INTO CRV                  */ 05310000
*  DCL SIZE        FIXED(31);     /* SIZE OF CTT TO GET              */ 05311000
*  DCL INDEX       FIXED(31);     /* INDEX COUNTER TO SCAN CRA       */ 05312000
*                                                                  1336 05313000
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */ 05314000
*                                                                  1337 05315000
*  /******************************************************************/ 05316000
*  /*                                                                */ 05317000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 05318000
*  /*                                                                */ 05319000
*  /******************************************************************/ 05320000
*                                                                  1338 05321000
*  OLDERID2 = NEWERID2;                                            1338 05322000
         L     @14,@PC00001                                        1338 05323000
         L     @07,GDTTR2(,@14)                                    1338 05324000
         MVC   @TS00001(95),NEWERID2(@07)                          1338 05325000
         MVC   OLDERID2(95,@07),@TS00001                           1338 05326000
*  NEWID2='RC95';                                                  1339 05327000
         MVC   NEWID2(4,@07),@CC01329                              1339 05328000
*  IF GDTDBG = NULLPTR                                             1340 05329000
*    THEN;                                                         1340 05330000
         ICM   @07,15,GDTDBG(@14)                                  1340 05331000
         BZ    @RT01340                                            1340 05332000
*    ELSE                                                          1342 05333000
*      CALL IDCDB010 (GDTTBL,'RC95');                              1342 05334000
*                                                                  1342 05335000
         L     @14,@PC00001                                        1342 05336000
         ST    @14,@AL00001                                        1342 05337000
         LA    @07,@CC01329                                        1342 05338000
         ST    @07,@AL00001+4                                      1342 05339000
         MVI   @AL00001+4,X'80'                                    1342 05340000
         L     @15,GDTDBG(,@14)                                    1342 05341000
         LA    @01,@AL00001                                        1342 05342000
         BALR  @14,@15                                             1342 05343000
*  /******************************************************************/ 05344000
*  /*                                                                */ 05345000
*  /*    CHECK TO SEE IF THERE IS ANY NEED TO SCAN THE CRA           */ 05346000
*  /*                                                                */ 05347000
*  /******************************************************************/ 05348000
*                                                                  1343 05349000
*  IF ERRNO=ERCDNRML & CRVNAME=OFF/* IF THERE HAS BEEN NO ERROR      */ 05350000
*                                 /* AND NAMES HAVE NOT BEEN         */ 05351000
*                                 /* PROCESSED FOR THIS CRA          */ 05352000
*                                                                  1343 05353000
*    /****************************************************************/ 05354000
*    /*                                                              */ 05355000
*    /*    SCAN THE CRA BECAUSE IT HAS NOT BEEN DONE BEFORE          */ 05356000
*    /*    AND CONSTRUCT A CTT FOR IT                                */ 05357000
*    /*                                                              */ 05358000
*    /****************************************************************/ 05359000
*                                                                  1343 05360000
*    THEN DO;                     /* THEN:                           */ 05361000
@RT01340 LTR   ERRNO,ERRNO                                         1343 05362000
         BNZ   @RF01343                                            1343 05363000
         TM    CRVNAME(CRVEBASE),B'00100000'                       1343 05364000
         BNZ   @RF01343                                            1343 05365000
*      IOCRBA=CONCINO3;           /* PLACE RBA OF CI NUMBER 3        */ 05366000
         L     @14,IOCSPTR                                         1345 05367000
         MVC   IOCRBA(4,@14),@CF01068                              1345 05368000
*      CALL IDCIOGT0 (GDTTBL,CRVIOSTR);                            1346 05369000
         L     @14,@PC00001                                        1346 05370000
         ST    @14,@AL00001                                        1346 05371000
         LA    @07,CRVIOSTR(,CRVEBASE)                             1346 05372000
         ST    @07,@AL00001+4                                      1346 05373000
         MVI   @AL00001+4,X'80'                                    1346 05374000
         L     @15,GDTGET(,@14)                                    1346 05375000
         LA    @01,@AL00001                                        1346 05376000
         BALR  @14,@15                                             1346 05377000
*                                 /* READ THE DESIRED RECORD         */ 05378000
*      IF REG15=LASTCC00          /* IF THE RECORD WAS OBTAINED      */ 05379000
*        THEN DO;                 /* THEN:                           */ 05380000
         LTR   REG15,REG15                                         1347 05381000
         BNZ   @RF01347                                            1347 05382000
*          SIZE=RECNEXCI*LENGTH(CTTENTRY)+LENGTH(CTT);             1349 05383000
         L     @14,IOCSPTR                                         1349 05384000
         L     @14,IOCDAD(,@14)                                    1349 05385000
         SLR   @07,@07                                             1349 05386000
         ICM   @07,7,RECNEXCI(@14)                                 1349 05387000
         SLA   @07,2                                               1349 05388000
         AH    @07,@CH00043                                        1349 05389000
         ST    @07,SIZE                                            1349 05390000
*                                 /* CALCULATE THE SIZE OF THE       */ 05391000
*                                 /* TRANSLATE TABLE NEEDED          */ 05392000
*          CALL IDCSAGP0(GDTTBL,SIZE,CRVADCTT,COREID5,SETZERO);    1350 05393000
         L     @14,@PC00001                                        1350 05394000
         ST    @14,@AL00001                                        1350 05395000
         LA    @07,SIZE                                            1350 05396000
         ST    @07,@AL00001+4                                      1350 05397000
         LA    @07,CRVADCTT(,CRVEBASE)                             1350 05398000
         ST    @07,@AL00001+8                                      1350 05399000
         LA    @07,@CC00837                                        1350 05400000
         ST    @07,@AL00001+12                                     1350 05401000
         LA    @07,SETZERO                                         1350 05402000
         ST    @07,@AL00001+16                                     1350 05403000
         MVI   @AL00001+16,X'80'                                   1350 05404000
         L     @15,GDTGPL(,@14)                                    1350 05405000
         LA    @01,@AL00001                                        1350 05406000
         BALR  @14,@15                                             1350 05407000
*                                 /* GET SPACE FOR THE CTT           */ 05408000
*          IF REG15=LASTCC00      /* IF THERE IS NO ERROR            */ 05409000
*            THEN DO;             /* THEN:                           */ 05410000
*                                                                  1351 05411000
         LTR   REG15,REG15                                         1351 05412000
         BNZ   @RF01351                                            1351 05413000
*              /******************************************************/ 05414000
*              /*                                                    */ 05415000
*              /*    PREPARE THE IOCSTR TO ALLOW SCANNING OF THE     */ 05416000
*              /*    CRA                                             */ 05417000
*              /*                                                    */ 05418000
*              /******************************************************/ 05419000
*                                                                  1353 05420000
*              CTTENTNO=RECNEXCI-BEGINCI;                          1353 05421000
         L     @14,CRVADCTT(,CRVEBASE)                             1353 05422000
         L     @04,IOCSPTR                                         1353 05423000
         L     @01,IOCDAD(,@04)                                    1353 05424000
         SLR   @07,@07                                             1353 05425000
         ICM   @07,7,RECNEXCI(@01)                                 1353 05426000
         LR    @06,@07                                             1353 05427000
         SH    @06,@CH00035                                        1353 05428000
         ST    @06,CTTENTNO(,@14)                                  1353 05429000
*                                 /* INITIALIZE NUMBER OF            */ 05430000
*                                 /* ENTRIES IN TABLE                */ 05431000
*              COUNT=RECNEXCI-1;  /* PICK UP THE NUMBER OF CI'S      */ 05432000
         BCTR  @07,0                                               1354 05433000
         LR    COUNT,@07                                           1354 05434000
*                                 /* THAT MUST BE SCANED             */ 05435000
*              IOCRBA=CONCINO9;   /* SET CI NUMBER TO 9              */ 05436000
         MVC   IOCRBA(4,@04),@CF01070                              1355 05437000
*              CALL IDCIOPO0 (GDTTBL,CRVIOSTR);                    1356 05438000
         L     @14,@PC00001                                        1356 05439000
         ST    @14,@AL00001                                        1356 05440000
         LA    @04,CRVIOSTR(,CRVEBASE)                             1356 05441000
         ST    @04,@AL00001+4                                      1356 05442000
         MVI   @AL00001+4,X'80'                                    1356 05443000
         L     @15,GDTPOS(,@14)                                    1356 05444000
         LA    @01,@AL00001                                        1356 05445000
         BALR  @14,@15                                             1356 05446000
*                                 /* POINT AT CI NUMBER 9            */ 05447000
*              IOCCHPDR=OFF;      /* INSURE THAT BOTH BITS ARE       */ 05448000
*                                 /* NOT ON                          */ 05449000
*              IOCCHPSQ=ON;       /* INDICATE THAT A CHANGE          */ 05450000
         L     @14,IOCSPTR                                         1358 05451000
         OI    IOCCHPSQ(@14),B'10000000'                           1358 05452000
         NI    IOCCHPDR(@14),B'10111111'                           1358 05453000
*                                 /* FROM DIRECT TO SEQUENTIAL       */ 05454000
*                                 /* PROCESSING IS REQUIRED          */ 05455000
*              /******************************************************/ 05456000
*              /*                                                    */ 05457000
*              /*    READ ALL OF THE CRA CI'S TO GET THE CRA TO      */ 05458000
*              /*    CATALOG TRANSLATION VALUES                      */ 05459000
*              /*                                                    */ 05460000
*              /******************************************************/ 05461000
*                                                                  1359 05462000
*              DO INDEX=BEGINCI TO COUNT WHILE ERRNO=ERCDNRML;     1359 05463000
         LA    INDEX,9                                             1359 05464000
         B     @DE01359                                            1359 05465000
@DL01359 LTR   ERRNO,ERRNO                                         1359 05466000
         BNZ   @DC01359                                            1359 05467000
*                                 /* LOOP THROUGH ALL THE CRA        */ 05468000
*                                 /* RECORDS TO GET THE CATALOG      */ 05469000
*                                 /* CI NUMBER                       */ 05470000
*                CALL IDCIOGT0 (GDTTBL,CRVIOSTR);                  1360 05471000
         L     @14,@PC00001                                        1360 05472000
         ST    @14,@AL00001                                        1360 05473000
         LA    @07,CRVIOSTR(,CRVEBASE)                             1360 05474000
         ST    @07,@AL00001+4                                      1360 05475000
         MVI   @AL00001+4,X'80'                                    1360 05476000
         L     @15,GDTGET(,@14)                                    1360 05477000
         LA    @01,@AL00001                                        1360 05478000
         BALR  @14,@15                                             1360 05479000
*                                 /* GET THE NEXT RECORD             */ 05480000
*                IF REG15=LASTCC00/* IF THE RECORD WAS OBTAINED      */ 05481000
*                                                                  1361 05482000
*                  /**************************************************/ 05483000
*                  /*                                                */ 05484000
*                  /*    HANDLE CONSTRUCTION OF THE TABLE FOR A      */ 05485000
*                  /*    CI THAT IS OK                               */ 05486000
*                  /*                                                */ 05487000
*                  /**************************************************/ 05488000
*                                                                  1361 05489000
*                  THEN DO;       /* THEN:                           */ 05490000
         LTR   REG15,REG15                                         1361 05491000
         BNZ   @RF01361                                            1361 05492000
*                    IF RECTYPE=FREETYPE                           1363 05493000
*                                 /* IF THIS IS A FREE RECORD        */ 05494000
*                      THEN CTTCATCI(INDEX-BEGINCI+1)=INVALCI;     1363 05495000
         L     @14,IOCSPTR                                         1363 05496000
         L     @14,IOCDAD(,@14)                                    1363 05497000
         CLI   RECTYPE(@14),C'F'                                   1363 05498000
         BNE   @RF01363                                            1363 05499000
         LR    @14,INDEX                                           1364 05500000
         SLA   @14,2                                               1364 05501000
         L     @01,CRVADCTT(,CRVEBASE)                             1364 05502000
         ALR   @01,@14                                             1364 05503000
         AL    @01,@CF01411                                        1364 05504000
         MVC   CTTCATCI-5(3,@01),INVALCI                           1364 05505000
*                                 /* THEN: INVALIDATE THE CI         */ 05506000
*                                 /*       NUMBER                    */ 05507000
*                      ELSE CTTCATCI(INDEX-BEGINCI+1)=RECCI;       1365 05508000
         B     @RC01363                                            1365 05509000
@RF01363 LR    @14,INDEX                                           1365 05510000
         SLA   @14,2                                               1365 05511000
         L     @01,CRVADCTT(,CRVEBASE)                             1365 05512000
         L     @07,IOCSPTR                                         1365 05513000
         L     @07,IOCDAD(,@07)                                    1365 05514000
         ALR   @01,@14                                             1365 05515000
         AL    @01,@CF01411                                        1365 05516000
         MVC   CTTCATCI-5(3,@01),RECCI(@07)                        1365 05517000
*                                 /* ELSE: PLACE THE CATALOG         */ 05518000
*                                 /*       CI NUMBER                 */ 05519000
*                    CTTENTYP(INDEX-BEGINCI+1)=RECTYPE;            1366 05520000
@RC01363 LR    @14,INDEX                                           1366 05521000
         SLA   @14,2                                               1366 05522000
         L     @01,CRVADCTT(,CRVEBASE)                             1366 05523000
         ALR   @01,@14                                             1366 05524000
         AL    @01,@CF01412                                        1366 05525000
         L     @14,IOCSPTR                                         1366 05526000
         L     @14,IOCDAD(,@14)                                    1366 05527000
         MVC   CTTENTYP-4(1,@01),RECTYPE(@14)                      1366 05528000
*                                 /* PLACE THE RECORD TYPE           */ 05529000
*                    CALL NAMETABL (SPARM4);                       1367 05530000
         L     @14,@PC00019                                        1367 05531000
         ST    @14,@AL00001                                        1367 05532000
         LA    @01,@AL00001                                        1367 05533000
         BAL   @14,NAMETABL                                        1367 05534000
*                                 /* GO TO BUILD THE NAME TABLE      */ 05535000
*                    END;         /*                                 */ 05536000
*                                                                  1368 05537000
*                  /**************************************************/ 05538000
*                  /*                                                */ 05539000
*                  /*    HANDLE CONSTRUCTION OF THE TABLE FOR A      */ 05540000
*                  /*    CI THAT PRODUCED AN I/O ERROR               */ 05541000
*                  /*                                                */ 05542000
*                  /**************************************************/ 05543000
*                                                                  1369 05544000
*                  ELSE DO;       /* ELSE:                           */ 05545000
         B     @RC01361                                            1369 05546000
@RF01361 DS    0H                                                  1370 05547000
*                    RSNCD=RSNCD06;                                1370 05548000
         MVC   RSNCD(2),@CC00926                                   1370 05549000
*                                 /* INDICATE THE ERROR TYPE         */ 05550000
*                    IF CRVCTTER=ON                                1371 05551000
*                                 /* IF ERROR HAS BEEN PRINTED       */ 05552000
*                      THEN;      /* THEN: CONTINUE                  */ 05553000
         TM    CRVCTTER(CRVEBASE),B'00000100'                      1371 05554000
         BO    @RT01371                                            1371 05555000
*                      ELSE DO;   /* ELSE:                           */ 05556000
*                        CALL MESSAGE(2,MSGID22,VTTVOLSR(SPARM4),  1374 05557000
*                                     LENGTH(VTTVOLSR),RSNCD,      1374 05558000
*                                     LENGTH(RSNCD));              1374 05559000
         MVC   @AL00001(24),@AL01374                               1374 05560000
         L     @14,@PC00019                                        1374 05561000
         L     @14,SPARM4(,@14)                                    1374 05562000
         MH    @14,@CH00763                                        1374 05563000
         L     @01,CRVBASE                                         1374 05564000
         L     @01,CRVCRAPL(,@01)                                  1374 05565000
         L     @01,ACCVOLTT(,@01)                                  1374 05566000
         AL    @01,@CF01391                                        1374 05567000
         LA    @14,VTTVOLSR-4(@14,@01)                             1374 05568000
         ST    @14,@AL00001+8                                      1374 05569000
         LA    @14,RSNCD                                           1374 05570000
         ST    @14,@AL00001+16                                     1374 05571000
         LA    @01,@AL00001                                        1374 05572000
         BAL   @14,MESSAGE                                         1374 05573000
*                                 /* PRINT CTT I/O ERROR             */ 05574000
*                        CTTCATCI(INDEX-BEGINCI+1)=INVALCI;        1375 05575000
         LR    @14,INDEX                                           1375 05576000
         SLA   @14,2                                               1375 05577000
         L     @07,CRVADCTT(,CRVEBASE)                             1375 05578000
         ST    @14,@TF00001                                        1375 05579000
         ALR   @14,@07                                             1375 05580000
         AL    @14,@CF01411                                        1375 05581000
         MVC   CTTCATCI-5(3,@14),INVALCI                           1375 05582000
*                                 /* SET INVALID CI NUMBER           */ 05583000
*                        CTTENTYP(INDEX-BEGINCI+1)=FREETYPE;       1376 05584000
         AL    @07,@TF00001                                        1376 05585000
         AL    @07,@CF01412                                        1376 05586000
         MVI   CTTENTYP-4(@07),C'F'                                1376 05587000
*                                 /* SET RECORD TYPE                 */ 05588000
*                        END;     /*                                 */ 05589000
*                    END;         /*                                 */ 05590000
@RT01371 DS    0H                                                  1379 05591000
*                END;             /*                                 */ 05592000
@RC01361 AL    INDEX,@CF00220                                      1379 05593000
@DE01359 CR    INDEX,COUNT                                         1379 05594000
         BNH   @DL01359                                            1379 05595000
@DC01359 DS    0H                                                  1380 05596000
*              /******************************************************/ 05597000
*              /*                                                    */ 05598000
*              /*    RETURN THE IOCSTR TO DIRECT MODE FOR ALL        */ 05599000
*              /*    OTHER PROCESSING                                */ 05600000
*              /*                                                    */ 05601000
*              /******************************************************/ 05602000
*                                                                  1380 05603000
*              IOCCHPDR=ON;       /* RETURN THE IOCSTR TO THE        */ 05604000
         L     @14,IOCSPTR                                         1380 05605000
         OI    IOCCHPDR(@14),B'01000000'                           1380 05606000
*                                 /* DIRECT MODE                     */ 05607000
*              END;               /*                                 */ 05608000
*                                                                  1381 05609000
*            /********************************************************/ 05610000
*            /*                                                      */ 05611000
*            /*    HANDLE NOT BEING ABLE TO GET STORAGE FOR          */ 05612000
*            /*    THE CTT                                           */ 05613000
*            /*                                                      */ 05614000
*            /********************************************************/ 05615000
*                                                                  1382 05616000
*            ELSE DO;             /* ELSE:                           */ 05617000
         B     @RC01351                                            1382 05618000
@RF01351 DS    0H                                                  1383 05619000
*              ERRNO=ERCDNSTR;    /* INDICATE NO CORE                */ 05620000
         LA    ERRNO,28                                            1383 05621000
*              CORE=BAD;          /* INDICATE CORE MESSAGE           */ 05622000
         MVC   CORE(1),BAD                                         1384 05623000
*              END;               /*                                 */ 05624000
*          END;                   /*                                 */ 05625000
*                                                                  1386 05626000
*        /************************************************************/ 05627000
*        /*                                                          */ 05628000
*        /*    HANDLE NOT BEING ABLE TO DETURMINE THE SIZE OF        */ 05629000
*        /*    THE CTT TO BUILD                                      */ 05630000
*        /*                                                          */ 05631000
*        /************************************************************/ 05632000
*                                                                  1387 05633000
*        ELSE DO;                 /* ELSE:                           */ 05634000
         B     @RC01347                                            1387 05635000
@RF01347 DS    0H                                                  1388 05636000
*          RSNCD=RSNCD05;         /* INDICATE THE ERROR TYPE         */ 05637000
         MVC   RSNCD(2),@CC00924                                   1388 05638000
*          ERRNO=ERCDIOER;        /* INDICATE AN I/O ERROR           */ 05639000
         LA    ERRNO,12                                            1389 05640000
*          END;                   /*                                 */ 05641000
*      CRVNAME=ON;                /* INDICATE NAMES HAVE BEEN        */ 05642000
@RC01347 OI    CRVNAME(CRVEBASE),B'00100000'                       1391 05643000
*                                 /* PROCESSED FOR THIS CRA          */ 05644000
*      END;                       /*                                 */ 05645000
*    ELSE;                        /* ELSE: CONTINUE                  */ 05646000
*                                                                  1393 05647000
*                                                                  1393 05648000
@RF01343 DS    0H                                                  1394 05649000
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */ 05650000
*                                                                  1394 05651000
*  END SCANCRA;                   /* END OF PROCEDURE                */ 05652000
@EL00019 DS    0H                                                  1395 05653000
@EF00019 DS    0H                                                  1395 05654000
@ER00019 LM    @14,@01,@SA00019                                    1395 05655000
         LM    @03,@12,@SA00019+16                                 1395 05656000
         BR    @14                                                 1395 05657000
@PB00019 DS    0H                                                  1396 05658000
*  GEN (EJECT);                                                    1396 05659000
         EJECT                                                          05660000
*  /******************************************************************/ 05661000
*  /*                                                                */ 05662000
*  /* PROCEDURE NAME:                                                */ 05663000
*  /*    SUBSP                                                       */ 05664000
*  /*                                                                */ 05665000
*  /* FUNCTION:                                                      */ 05666000
*  /*    PROVIDES SMALL PIECES OF STORAGE (SMALLER THAN 2000         */ 05667000
*  /*    BYTES) TO AVOID MANY CALLS TO STORAGE ALLOCATION.           */ 05668000
*  /*                                                                */ 05669000
*  /* REQUIREMENTS:                                                  */ 05670000
*  /*                                                                */ 05671000
*  /*    1. MUST DO INITIALIZATION CALL BEFORE OTHER FUNCTIONS       */ 05672000
*  /*       ARE USED.                                                */ 05673000
*  /*                                                                */ 05674000
*  /******************************************************************/ 05675000
*                                                                  1397 05676000
*SUBSP: PROCEDURE (SPCTYPE,SPSIZ,SPADR);                           1397 05677000
*                                                                  1397 05678000
         B     @PB00020                                            1397 05679000
SUBSP    STM   @14,@12,@SA00020                                    1397 05680000
         MVC   @PC00020(12),0(@01)                                 1397 05681000
*  DCL SPCTYPE  CHAR(1);          /* TYPE OF REQUEST                 */ 05682000
*  DCL SPSIZ    PTR(31);          /* SIZE OF AREA DESIRED            */ 05683000
*  DCL SPADR    PTR(31);          /* ADDRESS OF AREA ALLOCATED       */ 05684000
*                                                                  1400 05685000
*  DCL SPCSIZE      FIXED(31);    /* SIZE OF THE PRESENT AREA        */ 05686000
*  DCL SPCSIZE1     FIXED(31);    /* SIZE OF PREVIOUS AREA           */ 05687000
*  DCL SPCPTR       PTR(31);      /* ADDRESS OF PRESENT AREA         */ 05688000
*  DCL SPCPTR1      PTR(31);      /* ADDRESS OF PREVIOUS AREA        */ 05689000
*  DCL SPCAREA      CHAR(2032) BASED;                              1405 05690000
*                                 /* SHAPE OF THE AREA               */ 05691000
*                                                                  1406 05692000
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */ 05693000
*                                                                  1406 05694000
*  /******************************************************************/ 05695000
*  /*                                                                */ 05696000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 05697000
*  /*                                                                */ 05698000
*  /******************************************************************/ 05699000
*                                                                  1407 05700000
*  OLDERID2 = NEWERID2;                                            1407 05701000
         L     @14,@PC00001                                        1407 05702000
         L     @07,GDTTR2(,@14)                                    1407 05703000
         MVC   @TS00001(95),NEWERID2(@07)                          1407 05704000
         MVC   OLDERID2(95,@07),@TS00001                           1407 05705000
*  NEWID2='RC88';                                                  1408 05706000
         MVC   NEWID2(4,@07),@CC01345                              1408 05707000
*  IF GDTDBG = NULLPTR                                             1409 05708000
*    THEN;                                                         1409 05709000
         ICM   @07,15,GDTDBG(@14)                                  1409 05710000
         BZ    @RT01409                                            1409 05711000
*    ELSE                                                          1411 05712000
*      CALL IDCDB010 (GDTTBL,'RC88');                              1411 05713000
*                                                                  1411 05714000
         L     @14,@PC00001                                        1411 05715000
         ST    @14,@AL00001                                        1411 05716000
         LA    @07,@CC01345                                        1411 05717000
         ST    @07,@AL00001+4                                      1411 05718000
         MVI   @AL00001+4,X'80'                                    1411 05719000
         L     @15,GDTDBG(,@14)                                    1411 05720000
         LA    @01,@AL00001                                        1411 05721000
         BALR  @14,@15                                             1411 05722000
*  /******************************************************************/ 05723000
*  /*                                                                */ 05724000
*  /*    INITIALIZE TO PREFORM THE FUNCTION DESIRED                  */ 05725000
*  /*                                                                */ 05726000
*  /******************************************************************/ 05727000
*                                                                  1412 05728000
*  REG15=LASTCC00;                /* SET OK SPACE RETURN CODE        */ 05729000
@RT01409 SLR   REG15,REG15                                         1412 05730000
*  /******************************************************************/ 05731000
*  /*                                                                */ 05732000
*  /*    HANDLE THE ALLOCATION OF SMALL PIECES OF STORAGE            */ 05733000
*  /*    ASSOCIATED WITH THE NAME TABLE                              */ 05734000
*  /*                                                                */ 05735000
*  /******************************************************************/ 05736000
*                                                                  1413 05737000
*  IF SPCTYPE=GETTYPE             /* IF SPACE DESIRED                */ 05738000
*    THEN DO;                     /* THEN:                           */ 05739000
         L     @14,@PC00020                                        1413 05740000
         CLI   SPCTYPE(@14),C'G'                                   1413 05741000
         BNE   @RF01413                                            1413 05742000
*      IF SPCSIZE>=SPSIZ          /* IF THERE IS ENOUGH SPACE        */ 05743000
*        THEN;                    /* THEN: CONTINUE                  */ 05744000
         L     @14,@PC00020+4                                      1415 05745000
         L     @07,SPCSIZE                                         1415 05746000
         C     @07,SPSIZ(,@14)                                     1415 05747000
         BNL   @RT01415                                            1415 05748000
*        ELSE DO;                 /* ELSE:                           */ 05749000
*          SPCSIZE=LENGTH(SPCAREA);                                1418 05750000
         MVC   SPCSIZE(4),@CF01344                                 1418 05751000
*                                 /* SET THE NEW SIZE                */ 05752000
*          CALL IDCSAGP0 (GDTTBL,SPCSIZE,SPCPTR,COREID2,SETZERO);  1419 05753000
         L     @14,@PC00001                                        1419 05754000
         ST    @14,@AL00001                                        1419 05755000
         LA    @07,SPCSIZE                                         1419 05756000
         ST    @07,@AL00001+4                                      1419 05757000
         LA    @07,SPCPTR                                          1419 05758000
         ST    @07,@AL00001+8                                      1419 05759000
         LA    @07,@CC00831                                        1419 05760000
         ST    @07,@AL00001+12                                     1419 05761000
         LA    @07,SETZERO                                         1419 05762000
         ST    @07,@AL00001+16                                     1419 05763000
         MVI   @AL00001+16,X'80'                                   1419 05764000
         L     @15,GDTGPL(,@14)                                    1419 05765000
         LA    @01,@AL00001                                        1419 05766000
         BALR  @14,@15                                             1419 05767000
*                                 /* GET A NEW POOL OF SPACE         */ 05768000
*          END;                   /*                                 */ 05769000
*                                                                  1420 05770000
*      IF REG15^=LASTCC00         /* IF THERE IS NO SPACE            */ 05771000
*        THEN CORE=BAD;           /* THEN: INDICATE CORE MESSAGE     */ 05772000
@RT01415 LTR   REG15,REG15                                         1421 05773000
         BZ    @RF01421                                            1421 05774000
         MVC   CORE(1),BAD                                         1422 05775000
*        ELSE DO;                 /* ELSE:                           */ 05776000
         B     @RC01421                                            1423 05777000
@RF01421 DS    0H                                                  1424 05778000
*          SPCPTR1=SPCPTR;        /* SAVE THE ADDRESS                */ 05779000
         L     @14,SPCPTR                                          1424 05780000
         ST    @14,SPCPTR1                                         1424 05781000
*          SPCSIZE1=SPCSIZE;      /* SAVE THE SIZE                   */ 05782000
         L     @07,SPCSIZE                                         1425 05783000
         ST    @07,SPCSIZE1                                        1425 05784000
*          SPADR=SPCPTR;          /* POINT AT NEXT AREA              */ 05785000
         L     @06,@PC00020+8                                      1426 05786000
         ST    @14,SPADR(,@06)                                     1426 05787000
*          SPCPTR=SPCPTR+((SPSIZ+3)/4)*4;                          1427 05788000
         L     @06,@PC00020+4                                      1427 05789000
         LA    @00,3                                               1427 05790000
         AL    @00,SPSIZ(,@06)                                     1427 05791000
         SRDA  @00,32                                              1427 05792000
         D     @00,@CF00043                                        1427 05793000
         SLA   @01,2                                               1427 05794000
         ALR   @14,@01                                             1427 05795000
         ST    @14,SPCPTR                                          1427 05796000
*                                 /* POINT PAST THE AREA             */ 05797000
*          SPCSIZE=SPCSIZE-((SPSIZ+3)/4)*4;                        1428 05798000
         SLR   @07,@01                                             1428 05799000
         ST    @07,SPCSIZE                                         1428 05800000
*                                 /* DECREMENT AREA SIZE             */ 05801000
*          END;                   /*                                 */ 05802000
*      END;                       /*                                 */ 05803000
*    ELSE;                        /* ELSE: CONTINUE                  */ 05804000
*                                                                  1431 05805000
@RF01413 DS    0H                                                  1432 05806000
*  /******************************************************************/ 05807000
*  /*                                                                */ 05808000
*  /*    HANDLE THE RETURNING OF THE LAST USED BLOCK ONLY            */ 05809000
*  /*                                                                */ 05810000
*  /******************************************************************/ 05811000
*                                                                  1432 05812000
*  IF SPCTYPE=RETTYPE             /* IF RETURN SPECIFIED             */ 05813000
*    THEN DO;                     /* THEN:                           */ 05814000
@RC01413 L     @14,@PC00020                                        1432 05815000
         CLI   SPCTYPE(@14),C'R'                                   1432 05816000
         BNE   @RF01432                                            1432 05817000
*      SPCPTR=SPCPTR1;            /* RETURN ADDRESS                  */ 05818000
         MVC   SPCPTR(4),SPCPTR1                                   1434 05819000
*      SPCSIZE=SPCSIZE1;          /* RETURN SIZE                     */ 05820000
         MVC   SPCSIZE(4),SPCSIZE1                                 1435 05821000
*      END;                       /*                                 */ 05822000
*    ELSE;                        /* ELSE: CONTINUE                  */ 05823000
@RF01432 DS    0H                                                  1438 05824000
*  /******************************************************************/ 05825000
*  /*                                                                */ 05826000
*  /*    HANDLE THE INITIALIZATION OF THE SUBSP FUNCTION             */ 05827000
*  /*                                                                */ 05828000
*  /******************************************************************/ 05829000
*                                                                  1438 05830000
*  IF SPCTYPE=INITYPE             /* IF INITIALIZE SPECIFIED         */ 05831000
*    THEN SPCSIZE=0;              /* THEN: INITIALIZE THE SIZE       */ 05832000
         L     @14,@PC00020                                        1438 05833000
         CLI   SPCTYPE(@14),C'I'                                   1438 05834000
         BNE   @RF01438                                            1438 05835000
         SLR   @14,@14                                             1439 05836000
         ST    @14,SPCSIZE                                         1439 05837000
*                                 /*       HELD VALUE                */ 05838000
*    ELSE;                        /* ELSE: CONTINUE                  */ 05839000
*                                                                  1440 05840000
@RF01438 DS    0H                                                  1441 05841000
*  RETURN CODE(REG15);            /* RETURN POSSIBLE ERROR CODE      */ 05842000
*                                                                  1441 05843000
         L     @14,@SA00020                                        1441 05844000
         LM    @00,@12,@SA00020+8                                  1441 05845000
         BR    @14                                                 1441 05846000
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */ 05847000
*                                                                  1442 05848000
*  END SUBSP;                     /* END OF PROCEDURE                */ 05849000
@PB00020 DS    0H                                                  1444 05850000
*  GEN (EJECT);                                                    1444 05851000
         EJECT                                                          05852000
*  /******************************************************************/ 05853000
*  /*                                                                */ 05854000
*  /* PROCEDURE NAME:                                                */ 05855000
*  /*    SYNCH                                                       */ 05856000
*  /*                                                                */ 05857000
*  /* FUNCTION:                                                      */ 05858000
*  /*    CHECK TO SEE THAT THE NAME CHAIN THAT IS PRESENT FOR        */ 05859000
*  /*    THIS CRV ENTRY CONTAINS ONLY ENTRIES THAT SHOULD            */ 05860000
*  /*    BE EXPORTED IS FORCE IS NOT SUPPLIED.                       */ 05861000
*  /*                                                                */ 05862000
*  /* REQUIREMENTS:                                                  */ 05863000
*  /*                                                                */ 05864000
*  /*    1. CRV NEEDS TO BE CONSTRUCTED.                             */ 05865000
*  /*                                                                */ 05866000
*  /*    2. NAMCE CHAIN NEEDS TO BE CONSTRUCTED.                     */ 05867000
*  /*                                                                */ 05868000
*  /*    3. CI NUMBERS NEED TO BE FILLED IN IF THE ENTRY IS          */ 05869000
*  /*       TO BE EXPORTED.                                          */ 05870000
*  /*                                                                */ 05871000
*  /******************************************************************/ 05872000
*                                                                  1445 05873000
*SYNCH: PROCEDURE (YPARM4);                                        1445 05874000
*                                                                  1445 05875000
         B     @PB00021                                            1445 05876000
SYNCH    STM   @14,@12,@SA00021                                    1445 05877000
         MVC   @PC00021(4),0(@01)                                  1445 05878000
*  /******************************************************************/ 05879000
*  /*                                                                */ 05880000
*  /*    INCOMING PARAMETERS FOR THIS ROUTINE                        */ 05881000
*  /*                                                                */ 05882000
*  /******************************************************************/ 05883000
*                                                                  1446 05884000
*  DCL YPARM4     FIXED(31);      /* INDEX INTO CRV                  */ 05885000
*                                                                  1446 05886000
*  /******************************************************************/ 05887000
*  /*                                                                */ 05888000
*  /*    VARIABLES USED IN THIS ROUTINE                              */ 05889000
*  /*                                                                */ 05890000
*  /******************************************************************/ 05891000
*                                                                  1447 05892000
*  DCL SYIX1      FIXED(31);      /* GENERAL COUNTER                 */ 05893000
*                                                                  1447 05894000
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */ 05895000
*                                                                  1448 05896000
*  /******************************************************************/ 05897000
*  /*                                                                */ 05898000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 05899000
*  /*                                                                */ 05900000
*  /******************************************************************/ 05901000
*                                                                  1449 05902000
*  OLDERID2 = NEWERID2;                                            1449 05903000
         L     @14,@PC00001                                        1449 05904000
         L     @04,GDTTR2(,@14)                                    1449 05905000
         MVC   @TS00001(95),NEWERID2(@04)                          1449 05906000
         MVC   OLDERID2(95,@04),@TS00001                           1449 05907000
*  NEWID2='RC83';                                                  1450 05908000
         MVC   NEWID2(4,@04),@CC01352                              1450 05909000
*  IF GDTDBG = NULLPTR                                             1451 05910000
*    THEN;                                                         1451 05911000
         ICM   @04,15,GDTDBG(@14)                                  1451 05912000
         BZ    @RT01451                                            1451 05913000
*    ELSE                                                          1453 05914000
*      CALL IDCDB010 (GDTTBL,'RC83');                              1453 05915000
         L     @14,@PC00001                                        1453 05916000
         ST    @14,@AL00001                                        1453 05917000
         LA    @04,@CC01352                                        1453 05918000
         ST    @04,@AL00001+4                                      1453 05919000
         MVI   @AL00001+4,X'80'                                    1453 05920000
         L     @15,GDTDBG(,@14)                                    1453 05921000
         LA    @01,@AL00001                                        1453 05922000
         BALR  @14,@15                                             1453 05923000
*  /******************************************************************/ 05924000
*  /*                                                                */ 05925000
*  /*    POINT AT THE NAME CHAIN AND LOOP THROUGH ALL OF THE         */ 05926000
*  /*    ENTRIES TO CHECK FOR VALIDITY                               */ 05927000
*  /*                                                                */ 05928000
*  /******************************************************************/ 05929000
*                                                                  1454 05930000
*  NBLKPTR=CRVNAMCH;              /* POINT AT THE START OF THE       */ 05931000
@RT01451 MVC   NBLKPTR(4),CRVNAMCH(CRVEBASE)                       1454 05932000
*                                 /* NAME CHAIN                      */ 05933000
*  DO WHILE NBLKPTR^=NULLPTR;     /* LOOP THROUGH THE WHOLE          */ 05934000
         B     @DE01455                                            1455 05935000
@DL01455 DS    0H                                                  1456 05936000
*                                 /* NAME CHAINE                     */ 05937000
*                                                                  1456 05938000
*    /****************************************************************/ 05939000
*    /*                                                              */ 05940000
*    /*    IF THIS NAME CAME FROM AN ENTRY, INSURE THAT IT WAS       */ 05941000
*    /*    FOUND IN THE DESIRED CRA                                  */ 05942000
*    /*                                                              */ 05943000
*    /****************************************************************/ 05944000
*                                                                  1456 05945000
*    IF ENTREPTR(YPARM4)=NULLPTR & NBLKBE=OFF                      1456 05946000
*                                 /* IF ENTRIES NOT SPECIFIED        */ 05947000
*                                 /* AND THIS NAME BLOCK IS OK       */ 05948000
*      THEN;                      /* THEN: CONTINUE                  */ 05949000
         L     @14,@PC00021                                        1456 05950000
         L     @14,YPARM4(,@14)                                    1456 05951000
         SLA   @14,2                                               1456 05952000
         L     @04,@PC00001+4                                      1456 05953000
         L     @04,FDTPTR+28(,@04)                                 1456 05954000
         AL    @04,@CF01392                                        1456 05955000
         L     @14,ENTREPTR(@14,@04)                               1456 05956000
         LTR   @14,@14                                             1456 05957000
         BNZ   @RF01456                                            1456 05958000
         L     @14,NBLKPTR                                         1456 05959000
         TM    NBLKBE(@14),B'01000000'                             1456 05960000
         BZ    @RT01456                                            1456 05961000
*      ELSE DO;                   /* ELSE:                           */ 05962000
@RF01456 DS    0H                                                  1459 05963000
*        IF NBLKCI=INVALCI        /* IF THE CI WAS NOT FILED IN      */ 05964000
*          THEN DO;               /* THEN:                           */ 05965000
         L     @14,NBLKPTR                                         1459 05966000
         CLC   NBLKCI(3,@14),INVALCI                               1459 05967000
         BNE   @RF01459                                            1459 05968000
*            NBLKBE=ON;           /* INDICATE A BAD ENTRY            */ 05969000
         OI    NBLKBE(@14),B'01000000'                             1461 05970000
*            CALL MESSAGE (0,MSGID11,CRADDPTR(YPARM4)->CRADDVAL,   1462 05971000
*                          LENGTH(CRADDVAL));                      1462 05972000
         MVC   @AL00001(16),@AL01462                               1462 05973000
         L     @14,@PC00021                                        1462 05974000
         L     @14,YPARM4(,@14)                                    1462 05975000
         SLA   @14,2                                               1462 05976000
         L     @04,@PC00001+4                                      1462 05977000
         L     @04,FDTPTR+16(,@04)                                 1462 05978000
         AL    @04,@CF01392                                        1462 05979000
         L     @14,CRADDPTR(@14,@04)                               1462 05980000
         LA    @14,CRADDVAL(,@14)                                  1462 05981000
         ST    @14,@AL00001+8                                      1462 05982000
         LA    @01,@AL00001                                        1462 05983000
         BAL   @14,MESSAGE                                         1462 05984000
*                                 /* PRINT CRA ENTRY MISMATCH        */ 05985000
*            SYIX1=NBLKNAME->DSNAMLEN;                             1463 05986000
         L     @14,NBLKPTR                                         1463 05987000
         L     @14,NBLKNAME(,@14)                                  1463 05988000
         LH    @04,DSNAMLEN(,@14)                                  1463 05989000
         ST    @04,SYIX1                                           1463 05990000
*                                 /* PICK UP LENGTH OF NAME          */ 05991000
*            CALL MESSAGE (0,MSGID20,NBLKNAME->DSNAM,SYIX1);       1464 05992000
         LA    @04,@CF00116                                        1464 05993000
         ST    @04,@AL00001                                        1464 05994000
         LA    @04,@CH00885                                        1464 05995000
         ST    @04,@AL00001+4                                      1464 05996000
         LA    @14,DSNAM(,@14)                                     1464 05997000
         ST    @14,@AL00001+8                                      1464 05998000
         LA    @14,SYIX1                                           1464 05999000
         ST    @14,@AL00001+12                                     1464 06000000
         LA    @01,@AL00001                                        1464 06001000
         BAL   @14,MESSAGE                                         1464 06002000
*                                 /* PRINT DSNAME                    */ 06003000
*            IF LASTCC<LASTCC08   /* IF THIS IS A NEW HIGH           */ 06004000
*              THEN LASTCC=LASTCC08;                               1465 06005000
         LA    @14,8                                               1465 06006000
         L     @04,@PC00001+8                                      1465 06007000
         CH    @14,LASTCC(,@04)                                    1465 06008000
         BNH   @RF01465                                            1465 06009000
         STH   @14,LASTCC(,@04)                                    1466 06010000
*                                 /* THEN: SAVE THE NEW VALUE        */ 06011000
*              ELSE;              /* ELSE: CONTINUE                  */ 06012000
@RF01465 DS    0H                                                  1468 06013000
*            END;                 /*                                 */ 06014000
*          ELSE;                  /* ELSE: CONTINUE                  */ 06015000
@RF01459 DS    0H                                                  1470 06016000
*        END;                     /*                                 */ 06017000
*    /****************************************************************/ 06018000
*    /*                                                              */ 06019000
*    /*    HANDLE THE CHECKING FOR SYNCHRONIZATION OF A CLUSTER      */ 06020000
*    /*    OR AN ALTERNATE INDEX ENTRY                               */ 06021000
*    /*                                                              */ 06022000
*    /****************************************************************/ 06023000
*                                                                  1471 06024000
*    IF (NBLKTYPE=CLUSTYPE | NBLKTYPE=AIXTYPE) & NBLKBE=OFF        1471 06025000
*                                 /* IF VSAM DATA SET AND            */ 06026000
*                                 /* NAME BLOCK IS VALID             */ 06027000
*      THEN DO;                   /* THEN:                           */ 06028000
*                                                                  1471 06029000
@RT01456 L     @14,NBLKPTR                                         1471 06030000
         CLI   NBLKTYPE(@14),C'C'                                  1471 06031000
         BE    @GL00033                                            1471 06032000
         CLI   NBLKTYPE(@14),C'G'                                  1471 06033000
         BNE   @RF01471                                            1471 06034000
@GL00033 L     @14,NBLKPTR                                         1471 06035000
         TM    NBLKBE(@14),B'01000000'                             1471 06036000
         BNZ   @RF01471                                            1471 06037000
*        /************************************************************/ 06038000
*        /*                                                          */ 06039000
*        /*    HANDLE THE CHECKING FOR THE SYNCHRONIZATION OF        */ 06040000
*        /*    THE DATA COMPONENT                                    */ 06041000
*        /*                                                          */ 06042000
*        /************************************************************/ 06043000
*                                                                  1473 06044000
*        IF NBLKDCI=INVALCI       /* IF THERE IS NO DATA ENTRY       */ 06045000
*          THEN DO;               /* THEN:                           */ 06046000
         CLC   NBLKDCI(3,@14),INVALCI                              1473 06047000
         BNE   @RF01473                                            1473 06048000
*            NBLKBE=ON;           /* INDICATE BAD ENTRY              */ 06049000
         OI    NBLKBE(@14),B'01000000'                             1475 06050000
*            CALL MESSAGE (0,MSGID104,0,0);                        1476 06051000
         LA    @01,@AL01476                                        1476 06052000
         BAL   @14,MESSAGE                                         1476 06053000
*                                 /* PRINT ERROR IS ASSOCIATION      */ 06054000
*            SYIX1=NBLKNAME->DSNAMLEN;                             1477 06055000
         L     @14,NBLKPTR                                         1477 06056000
         L     @14,NBLKNAME(,@14)                                  1477 06057000
         LH    @04,DSNAMLEN(,@14)                                  1477 06058000
         ST    @04,SYIX1                                           1477 06059000
*                                 /* PICK UP LENGTH OF NAME          */ 06060000
*            CALL MESSAGE (0,MSGID20,NBLKNAME->DSNAM,SYIX1);       1478 06061000
         LA    @04,@CF00116                                        1478 06062000
         ST    @04,@AL00001                                        1478 06063000
         LA    @04,@CH00885                                        1478 06064000
         ST    @04,@AL00001+4                                      1478 06065000
         LA    @14,DSNAM(,@14)                                     1478 06066000
         ST    @14,@AL00001+8                                      1478 06067000
         LA    @14,SYIX1                                           1478 06068000
         ST    @14,@AL00001+12                                     1478 06069000
         LA    @01,@AL00001                                        1478 06070000
         BAL   @14,MESSAGE                                         1478 06071000
*                                 /* PRINT DATA SET NAME             */ 06072000
*            END;                 /*                                 */ 06073000
*          ELSE DO;               /* ELSE:                           */ 06074000
         B     @RC01473                                            1480 06075000
@RF01473 DS    0H                                                  1481 06076000
*            CALL OBJVOLCK (NBLKDCI,VTTVOLSR(YPARM4));             1481 06077000
         L     @14,NBLKPTR                                         1481 06078000
         LA    @14,NBLKDCI(,@14)                                   1481 06079000
         ST    @14,@AL00001                                        1481 06080000
         L     @14,@PC00021                                        1481 06081000
         L     @14,YPARM4(,@14)                                    1481 06082000
         MH    @14,@CH00763                                        1481 06083000
         L     @04,CRVBASE                                         1481 06084000
         L     @04,CRVCRAPL(,@04)                                  1481 06085000
         L     @04,ACCVOLTT(,@04)                                  1481 06086000
         AL    @04,@CF01391                                        1481 06087000
         LA    @14,VTTVOLSR-4(@14,@04)                             1481 06088000
         ST    @14,@AL00001+4                                      1481 06089000
         LA    @01,@AL00001                                        1481 06090000
         BAL   @14,OBJVOLCK                                        1481 06091000
*                                 /* CHECK THE DATA VOLUME           */ 06092000
*            IF REG15=LASTCC12    /* IF OUT OF STORAGE               */ 06093000
*              THEN RETURN CODE(LASTCC12);                         1482 06094000
         LA    @14,12                                              1482 06095000
         CR    REG15,@14                                           1482 06096000
         BNE   @RF01482                                            1482 06097000
         LR    @15,@14                                             1483 06098000
         L     @14,@SA00021                                        1483 06099000
         LM    @00,@12,@SA00021+8                                  1483 06100000
         BR    @14                                                 1483 06101000
*                                 /* THEN: RETURN ERROR              */ 06102000
*              ELSE;              /* ELSE: CONTINUE                  */ 06103000
@RF01482 DS    0H                                                  1485 06104000
*            END;                 /*                                 */ 06105000
*        /************************************************************/ 06106000
*        /*                                                          */ 06107000
*        /*    IF THERE IS AN INDEX COMPONENT THEN CHECK TO          */ 06108000
*        /*    SEE IF THE COMPONENT IS IN SYNCHRONIZATION.           */ 06109000
*        /*                                                          */ 06110000
*        /************************************************************/ 06111000
*                                                                  1486 06112000
*        IF NBLKICI=INVALCI & NBLKBE=OFF & NBLKSC=OFF              1486 06113000
*                                 /* IF THERE IS NO VALID INDEX      */ 06114000
*                                 /* ENTRY                           */ 06115000
*          THEN;                  /* THEN: CONTINUE                  */ 06116000
@RC01473 L     @14,NBLKPTR                                         1486 06117000
         CLC   NBLKICI(3,@14),INVALCI                              1486 06118000
         BNE   @RF01486                                            1486 06119000
         TM    NBLKBE(@14),B'01100000'                             1486 06120000
         BZ    @RT01486                                            1486 06121000
*          ELSE DO;               /* ELSE:                           */ 06122000
@RF01486 DS    0H                                                  1489 06123000
*            CALL OBJVOLCK (NBLKICI,VTTVOLSR(YPARM4));             1489 06124000
         L     @14,NBLKPTR                                         1489 06125000
         LA    @14,NBLKICI(,@14)                                   1489 06126000
         ST    @14,@AL00001                                        1489 06127000
         L     @14,@PC00021                                        1489 06128000
         L     @14,YPARM4(,@14)                                    1489 06129000
         MH    @14,@CH00763                                        1489 06130000
         L     @04,CRVBASE                                         1489 06131000
         L     @04,CRVCRAPL(,@04)                                  1489 06132000
         L     @04,ACCVOLTT(,@04)                                  1489 06133000
         AL    @04,@CF01391                                        1489 06134000
         LA    @14,VTTVOLSR-4(@14,@04)                             1489 06135000
         ST    @14,@AL00001+4                                      1489 06136000
         LA    @01,@AL00001                                        1489 06137000
         BAL   @14,OBJVOLCK                                        1489 06138000
*                                 /* CHECK THE INDEX PORTION         */ 06139000
*            IF REG15=LASTCC12    /* IF OUT OF STORAGE               */ 06140000
*              THEN RETURN CODE(LASTCC12);                         1490 06141000
         LA    @14,12                                              1490 06142000
         CR    REG15,@14                                           1490 06143000
         BNE   @RF01490                                            1490 06144000
         LR    @15,@14                                             1491 06145000
         L     @14,@SA00021                                        1491 06146000
         LM    @00,@12,@SA00021+8                                  1491 06147000
         BR    @14                                                 1491 06148000
*                                 /* THEN: RETURN ERROR              */ 06149000
*              ELSE;              /* ELSE: CONTINUE                  */ 06150000
@RF01490 DS    0H                                                  1493 06151000
*            END;                 /*                                 */ 06152000
*        END;                     /*                                 */ 06153000
*      ELSE;                      /* ELSE: CONTINUE                  */ 06154000
@RF01471 DS    0H                                                  1496 06155000
*    NBLKPTR=NBLKCHN;             /* POINT AT NEXT BLOCK             */ 06156000
@RC01471 L     @14,NBLKPTR                                         1496 06157000
         L     @14,NBLKCHN(,@14)                                   1496 06158000
         ST    @14,NBLKPTR                                         1496 06159000
*    END;                         /*                                 */ 06160000
*                                                                  1497 06161000
@DE01455 SLR   @14,@14                                             1497 06162000
         C     @14,NBLKPTR                                         1497 06163000
         BNE   @DL01455                                            1497 06164000
*  RETURN CODE(LASTCC00);         /* RETURN ZERO RETURN CODE         */ 06165000
*                                                                  1498 06166000
         LR    @15,@14                                             1498 06167000
         L     @14,@SA00021                                        1498 06168000
         LM    @00,@12,@SA00021+8                                  1498 06169000
         BR    @14                                                 1498 06170000
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */ 06171000
*                                                                  1499 06172000
*  END SYNCH;                     /* END OF PROCEDURE                */ 06173000
@PB00021 DS    0H                                                  1501 06174000
*  GEN (EJECT);                                                    1501 06175000
         EJECT                                                          06176000
*  /******************************************************************/ 06177000
*  /*                                                                */ 06178000
*  /* PROCEDURE NAME:                                                */ 06179000
*  /*    TERM                                                        */ 06180000
*  /*                                                                */ 06181000
*  /* FUNCTION:                                                      */ 06182000
*  /*    THIS ROUTINE PERFORMS THE FOLLOWING FUNCTIONS IN THE        */ 06183000
*  /*    TERMINATION PROCESS                                         */ 06184000
*  /*                                                                */ 06185000
*  /*    1. DEQUEUE THE CATALOG NAME THAT IS BEING HELD UP           */ 06186000
*  /*       FOR THERE IS NO FURTHER NEED FOR IT.                     */ 06187000
*  /*                                                                */ 06188000
*  /*    2. DEQUEUE THE PROGRAM NAME SO THAT EXPORTRA CAN RUN        */ 06189000
*  /*       IN ANOTHER PARTITION.                                    */ 06190000
*  /*                                                                */ 06191000
*  /*    3. IF THERE WAS A CALL TO IDCRC02, THEN THE PORT-           */ 06192000
*  /*       ABILITY DATA SET MUST BE CLOSED.  A CALL IS MADE         */ 06193000
*  /*       TO IDCRC02 TO CLOSE IT AND THE OK MESSAGE IS             */ 06194000
*  /*       PRINTED IF ALL IS OK.                                    */ 06195000
*  /*                                                                */ 06196000
*  /*    4. ALL OF THE STORAGE OBTAINED BY THIS MODULE IS FREED      */ 06197000
*  /*       SO THAT ALL THINGS ARE CLEAN.                            */ 06198000
*  /*                                                                */ 06199000
*  /* REQUIREMENTS:                                                  */ 06200000
*  /*                                                                */ 06201000
*  /*    THE CRV MUST BE CONSTRUCTED, AS THE CATALOG NAME IS         */ 06202000
*  /*    NEEDED.                                                     */ 06203000
*  /*                                                                */ 06204000
*  /******************************************************************/ 06205000
*                                                                  1502 06206000
*TERM: PROCEDURE;                                                  1502 06207000
*                                                                  1502 06208000
         B     @PB00022                                            1502 06209000
TERM     STM   @14,@12,@SA00022                                    1502 06210000
*  /******************************************************************/ 06211000
*  /*                                                                */ 06212000
*  /*    VARIABLIES USED IN THIS PROCEDURE                           */ 06213000
*  /*                                                                */ 06214000
*  /******************************************************************/ 06215000
*                                                                  1503 06216000
*  DCL TERMTIME    CHAR(8);       /* TIME FROM UTIME ROUTINE         */ 06217000
*  DCL TERMDATE    CHAR(8);       /* DATE FROM UTIME ROUTINE         */ 06218000
*                                                                  1504 06219000
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */ 06220000
*                                                                  1505 06221000
*  /******************************************************************/ 06222000
*  /*                                                                */ 06223000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 06224000
*  /*                                                                */ 06225000
*  /******************************************************************/ 06226000
*                                                                  1506 06227000
*  OLDERID2 = NEWERID2;                                            1506 06228000
         L     @14,@PC00001                                        1506 06229000
         L     @03,GDTTR2(,@14)                                    1506 06230000
         MVC   @TS00001(95),NEWERID2(@03)                          1506 06231000
         MVC   OLDERID2(95,@03),@TS00001                           1506 06232000
*  NEWID2='RC79';                                                  1507 06233000
         MVC   NEWID2(4,@03),@CC01358                              1507 06234000
*  IF GDTDBG = NULLPTR                                             1508 06235000
*    THEN;                                                         1508 06236000
         ICM   @03,15,GDTDBG(@14)                                  1508 06237000
         BZ    @RT01508                                            1508 06238000
*    ELSE                                                          1510 06239000
*      CALL IDCDB010 (GDTTBL,'RC79');                              1510 06240000
*                                                                  1510 06241000
         L     @14,@PC00001                                        1510 06242000
         ST    @14,@AL00001                                        1510 06243000
         LA    @03,@CC01358                                        1510 06244000
         ST    @03,@AL00001+4                                      1510 06245000
         MVI   @AL00001+4,X'80'                                    1510 06246000
         L     @15,GDTDBG(,@14)                                    1510 06247000
         LA    @01,@AL00001                                        1510 06248000
         BALR  @14,@15                                             1510 06249000
*  /******************************************************************/ 06250000
*  /*                                                                */ 06251000
*  /*    DEQUEUE THE OWNING CATALOG SO THAT IT MAY BE USED           */ 06252000
*  /*                                                                */ 06253000
*  /******************************************************************/ 06254000
*                                                                  1511 06255000
*  IF CRVBASE=NULLPTR | CRVCATNL=0                                 1511 06256000
*                                 /* IF THERE IS NO NAME             */ 06257000
*    THEN;                        /* THEN: CONTINUE                  */ 06258000
@RT01508 L     @14,CRVBASE                                         1511 06259000
         LTR   @14,@14                                             1511 06260000
         BZ    @RT01511                                            1511 06261000
         CLI   CRVCATNL(@14),0                                     1511 06262000
         BE    @RT01511                                            1511 06263000
*    ELSE DO;                     /* ELSE:                           */ 06264000
*      CALL IDCSADQ0 (GDTTBL,CRVMAJNM,CRVCATNM);                   1514 06265000
         L     @14,@PC00001                                        1514 06266000
         ST    @14,@AL00001                                        1514 06267000
         L     @03,CRVBASE                                         1514 06268000
         LA    @07,CRVMAJNM(,@03)                                  1514 06269000
         ST    @07,@AL00001+4                                      1514 06270000
         LA    @03,CRVCATNM(,@03)                                  1514 06271000
         ST    @03,@AL00001+8                                      1514 06272000
         MVI   @AL00001+8,X'80'                                    1514 06273000
         L     @15,GDTDEQ(,@14)                                    1514 06274000
         LA    @01,@AL00001                                        1514 06275000
         BALR  @14,@15                                             1514 06276000
*                                 /* RELEASE CONTROL OF THE          */ 06277000
*                                 /* OWNING CATALOG                  */ 06278000
*      END;                       /*                                 */ 06279000
*                                                                  1515 06280000
*  /******************************************************************/ 06281000
*  /*                                                                */ 06282000
*  /*    DEQUEUE ON THE EXPORTRA MODULE                              */ 06283000
*  /*                                                                */ 06284000
*  /******************************************************************/ 06285000
*                                                                  1516 06286000
*  CALL IDCSADQ0 (GDTTBL,SYSTEM,PROGRAM);                          1516 06287000
@RT01511 MVC   @AL00001+4(8),@AL01516                              1516 06288000
         L     @14,@PC00001                                        1516 06289000
         ST    @14,@AL00001                                        1516 06290000
         L     @15,GDTDEQ(,@14)                                    1516 06291000
         LA    @01,@AL00001                                        1516 06292000
         BALR  @14,@15                                             1516 06293000
*                                 /* RELEASE CONTROL OF THE          */ 06294000
*                                 /* PROGRAM SO IT CAN RUN IN        */ 06295000
*                                 /* OTHER PARTITIONS                */ 06296000
*                                                                  1517 06297000
*  /******************************************************************/ 06298000
*  /*                                                                */ 06299000
*  /*    CAUSE EXPORT TO CLOSE THE PORTABILITY DATA SET              */ 06300000
*  /*                                                                */ 06301000
*  /******************************************************************/ 06302000
*                                                                  1517 06303000
*  IF INPPTR=NULLPTR | LASTCC>LASTCC08                             1517 06304000
*                                 /* IF THERE HAVE BEEN NO           */ 06305000
*                                 /* EXPORTS OR FUNCTION TERMINATED  */ 06306000
*    THEN;                        /* THEN: CONTINUE                  */ 06307000
         ICM   @14,15,INPPTR                                       1517 06308000
         BZ    @RT01517                                            1517 06309000
         L     @14,@PC00001+8                                      1517 06310000
         LH    @14,LASTCC(,@14)                                    1517 06311000
         CH    @14,@CH00180                                        1517 06312000
         BH    @RT01517                                            1517 06313000
*    ELSE DO;                     /* ELSE:                           */ 06314000
*      ENDFLG=ON;                 /* INDICATE END OF EXPORT          */ 06315000
         L     @14,INPPTR                                          1520 06316000
         L     @14,INPTBL+4(,@14)                                  1520 06317000
         OI    ENDFLG(@14),B'01000000'                             1520 06318000
*      CALL IDCRC02(GDTTBL,INPPTR);                                1521 06319000
         L     @14,@PC00001                                        1521 06320000
         ST    @14,@AL00001                                        1521 06321000
         LA    @14,INPPTR                                          1521 06322000
         ST    @14,@AL00001+4                                      1521 06323000
         L     @15,@CV00913                                        1521 06324000
         LA    @01,@AL00001                                        1521 06325000
         BALR  @14,@15                                             1521 06326000
*                                 /* CAUSE CLOSE OF DATA SET         */ 06327000
*      IF REG15=LASTCC00 & EXPORTED < 8 /* IF ANY DATASETS   @OZ18993*/ 06328000
*                                 /* WERE EXPORTED SUCCESSFULLY      */ 06329000
*        THEN DO;                 /* THEN:                           */ 06330000
         LTR   REG15,REG15                                         1522 06331000
         BNZ   @RF01522                                            1522 06332000
         CH    EXPORTED,@CH00180                                   1522 06333000
         BNL   @RF01522                                            1522 06334000
*          CALL IDCSATI0 (GDTTBL,TERMTIME,TERMDATE,FORMAT);        1524 06335000
         L     @14,@PC00001                                        1524 06336000
         ST    @14,@AL00001                                        1524 06337000
         LA    @07,TERMTIME                                        1524 06338000
         ST    @07,@AL00001+4                                      1524 06339000
         LA    @07,TERMDATE                                        1524 06340000
         ST    @07,@AL00001+8                                      1524 06341000
         LA    @07,FORMAT                                          1524 06342000
         ST    @07,@AL00001+12                                     1524 06343000
         MVI   @AL00001+12,X'80'                                   1524 06344000
         L     @15,GDTTIM(,@14)                                    1524 06345000
         LA    @01,@AL00001                                        1524 06346000
         BALR  @14,@15                                             1524 06347000
*                                 /* GET TIME AND DATE FOR THE       */ 06348000
*                                 /* COMPLETION MESSAGE              */ 06349000
*          CALL MESSAGE(2,MSGID5,TERMDATE,LENGTH(TERMDATE),        1525 06350000
*                       TERMTIME,LENGTH(TERMTIME));                1525 06351000
         MVC   @AL00001(24),@AL01525                               1525 06352000
         LA    @14,TERMDATE                                        1525 06353000
         ST    @14,@AL00001+8                                      1525 06354000
         LA    @14,TERMTIME                                        1525 06355000
         ST    @14,@AL00001+16                                     1525 06356000
         LA    @01,@AL00001                                        1525 06357000
         BAL   @14,MESSAGE                                         1525 06358000
*                                 /* PRINT DATA SET OK               */ 06359000
*          END;                   /*                                 */ 06360000
*        ELSE LASTCC=LASTCC12;    /* ELSE: SET UP THE RETURN CODE    */ 06361000
         B     @RC01522                                            1527 06362000
@RF01522 L     @14,@PC00001+8                                      1527 06363000
         MVC   LASTCC(2,@14),@CH00038                              1527 06364000
*      END;                       /*                                 */ 06365000
@RC01522 DS    0H                                                  1529 06366000
*  /******************************************************************/ 06367000
*  /*                                                                */ 06368000
*  /*    RELEASE ALL THE OBTAINED STORAGE ON EXIT                    */ 06369000
*  /*                                                                */ 06370000
*  /******************************************************************/ 06371000
*                                                                  1529 06372000
*  CALL IDCSAFP0 (GDTTBL,COREID1,ALL);                             1529 06373000
@RT01517 MVC   @AL00001+4(8),@AL01529                              1529 06374000
         L     @14,@PC00001                                        1529 06375000
         ST    @14,@AL00001                                        1529 06376000
         L     @15,GDTFPL(,@14)                                    1529 06377000
         LA    @01,@AL00001                                        1529 06378000
         BALR  @14,@15                                             1529 06379000
*                                 /* FREE ALL STORAGE OBTAINED       */ 06380000
*                                                                  1530 06381000
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */ 06382000
*                                                                  1530 06383000
*  END TERM;                      /* END OF PRCOEDURE                */ 06384000
@EL00022 DS    0H                                                  1531 06385000
@EF00022 DS    0H                                                  1531 06386000
@ER00022 LM    @14,@12,@SA00022                                    1531 06387000
         BR    @14                                                 1531 06388000
@PB00022 DS    0H                                                  1532 06389000
*  GEN (EJECT);                                                    1532 06390000
         EJECT                                                          06391000
*  /******************************************************************/ 06392000
*  /*                                                                */ 06393000
*  /* PROCEDURE NAME:                                                */ 06394000
*  /*    TIMESTMP                                                    */ 06395000
*  /*                                                                */ 06396000
*  /* FUNCTION:                                                      */ 06397000
*  /*    OBTAIN THE FORMAT 4 DSCB NEW VSAM TIMESTAMP FOR THE         */ 06398000
*  /*    VOLUME WHILE IT IS MOUNTED.                                 */ 06399000
*  /*                                                                */ 06400000
*  /* REQUIREMENTS:                                                  */ 06401000
*  /*                                                                */ 06402000
*  /*    1. THE CORRECT CRV ENTRY MUST BE SELECTED BEFOR THIS        */ 06403000
*  /*       ROUTINE IS CALLED.                                       */ 06404000
*  /*                                                                */ 06405000
*  /*    2. THE VTT TABLE MUST BE BUILT SO IT MAY BE FILLED          */ 06406000
*  /*       IN.                                                      */ 06407000
*  /*                                                                */ 06408000
*  /******************************************************************/ 06409000
*                                                                  1533 06410000
*TIMESTMP: PROCEDURE (TPARM4);                                     1533 06411000
*                                                                  1533 06412000
         B     @PB00023                                            1533 06413000
TIMESTMP STM   @14,@12,@SA00023                                    1533 06414000
         MVC   @PC00023(4),0(@01)                                  1533 06415000
*  /******************************************************************/ 06416000
*  /*                                                                */ 06417000
*  /*    INCOMING PARAMETERS FOR THIS ROUTINE                        */ 06418000
*  /*                                                                */ 06419000
*  /******************************************************************/ 06420000
*                                                                  1534 06421000
*  DCL TPARM4   PTR(31);          /* INDEX INTO THE CRV              */ 06422000
*                                                                  1534 06423000
*  RFY REG15 RSTD;                /* RESTRICT THE REGISTER           */ 06424000
*                                                                  1535 06425000
*  /******************************************************************/ 06426000
*  /*                                                                */ 06427000
*  /*    TRACE AND DUMP POINT FOR THIS ROUTINE                       */ 06428000
*  /*                                                                */ 06429000
*  /******************************************************************/ 06430000
*                                                                  1536 06431000
*  OLDERID2 = NEWERID2;                                            1536 06432000
         L     @14,@PC00001                                        1536 06433000
         L     @07,GDTTR2(,@14)                                    1536 06434000
         MVC   @TS00001(95),NEWERID2(@07)                          1536 06435000
         MVC   OLDERID2(95,@07),@TS00001                           1536 06436000
*  NEWID2='RC94';                                                  1537 06437000
         MVC   NEWID2(4,@07),@CC01364                              1537 06438000
*  IF GDTDBG = NULLPTR                                             1538 06439000
*    THEN;                                                         1538 06440000
         ICM   @07,15,GDTDBG(@14)                                  1538 06441000
         BZ    @RT01538                                            1538 06442000
*    ELSE                                                          1540 06443000
*      CALL IDCDB010 (GDTTBL,'RC94');                              1540 06444000
*                                                                  1540 06445000
         L     @14,@PC00001                                        1540 06446000
         ST    @14,@AL00001                                        1540 06447000
         LA    @07,@CC01364                                        1540 06448000
         ST    @07,@AL00001+4                                      1540 06449000
         MVI   @AL00001+4,X'80'                                    1540 06450000
         L     @15,GDTDBG(,@14)                                    1540 06451000
         LA    @01,@AL00001                                        1540 06452000
         BALR  @14,@15                                             1540 06453000
*  /******************************************************************/ 06454000
*  /*                                                                */ 06455000
*  /*    IF THERE IS AN ERROR ALREADY FOUND THEN THERE IS NO         */ 06456000
*  /*    NEED TO SPEND THE TIME TO GET THE TIMESTAMP                 */ 06457000
*  /*                                                                */ 06458000
*  /*    CHECK TO SEE IT THERE IS AN ERROR ALREADY                   */ 06459000
*  /*                                                                */ 06460000
*  /******************************************************************/ 06461000
*                                                                  1541 06462000
*  IF ERRNO=ERCDNRML              /* IF THERE IS NO ERROR YET        */ 06463000
*                                                                  1541 06464000
*    THEN DO;                     /* THEN:                           */ 06465000
@RT01538 LTR   ERRNO,ERRNO                                         1541 06466000
         BNZ   @RF01541                                            1541 06467000
*      /**************************************************************/ 06468000
*      /*                                                            */ 06469000
*      /*    CHECK TO SEE IF THE TIMESTAMP IS ALREADY FILLED         */ 06470000
*      /*                                                            */ 06471000
*      /**************************************************************/ 06472000
*                                                                  1543 06473000
*      IF VTTTMSTP(TPARM4)=NULLCHAR(1:LENGTH(VTTTMSTP))            1543 06474000
*                                 /* IF THERE IS NO TIMESTAMP        */ 06475000
*                                 /* ALREADY                         */ 06476000
*        /************************************************************/ 06477000
*        /*                                                          */ 06478000
*        /*    WITH THE ENTRY NOT BEING ALREADY FILLED IN,           */ 06479000
*        /*    OBTAIN THE TIMESTAMP FOR THE TABLE                    */ 06480000
*        /*                                                          */ 06481000
*        /************************************************************/ 06482000
*                                                                  1543 06483000
*        THEN DO;                 /* THEN:                           */ 06484000
         L     @14,@PC00023                                        1543 06485000
         L     @14,TPARM4(,@14)                                    1543 06486000
         LR    @07,@14                                             1543 06487000
         MH    @07,@CH00763                                        1543 06488000
         L     @01,CRVBASE                                         1543 06489000
         L     @01,CRVCRAPL(,@01)                                  1543 06490000
         L     @01,ACCVOLTT(,@01)                                  1543 06491000
         ALR   @01,@07                                             1543 06492000
         AL    @01,@CF01392                                        1543 06493000
         CLC   VTTTMSTP-10(8,@01),NULLCHAR                         1543 06494000
         BNE   @RF01543                                            1543 06495000
*          BYTEPM1A=ADDR(BYTEPM1);/* POINT AT THE OPTION BYTE        */ 06496000
         LA    BYTEPM1A,BYTEPM1                                    1545 06497000
*          BYTEPM1=0;             /* ZERO THE BYTE                   */ 06498000
         MVI   BYTEPM1,X'00'                                       1546 06499000
*          IOINFTMS=ON;           /* INDICATE THAT THE TIME-         */ 06500000
         OI    IOINFTMS(BYTEPM1A),B'00001000'                      1547 06501000
*                                 /* STAMPS ARE DESIRED              */ 06502000
*          TMSFLDLN=LENGTH(TMSAREA);                               1548 06503000
         MVC   TMSFLDLN(2),@CH01375                                1548 06504000
*                                 /* PLACE THE LENGTH IN THE         */ 06505000
*                                 /* AREA PROVIDED                   */ 06506000
*          CALL IDCIOSI0 (GDTTBL,BYTEPM1,ADDR(TMSAREA),            1549 06507000
*                   CRADDPTR(TPARM4)->CRADDVAL);                   1549 06508000
         L     @07,@PC00001                                        1549 06509000
         ST    @07,@AL00001                                        1549 06510000
         LA    @06,BYTEPM1                                         1549 06511000
         ST    @06,@AL00001+4                                      1549 06512000
         LA    @06,TMSAREA                                         1549 06513000
         ST    @06,@AFTEMPS+20                                     1549 06514000
         LA    @06,@AFTEMPS+20                                     1549 06515000
         ST    @06,@AL00001+8                                      1549 06516000
         SLA   @14,2                                               1549 06517000
         L     @06,@PC00001+4                                      1549 06518000
         L     @01,FDTPTR+16(,@06)                                 1549 06519000
         AL    @01,@CF01392                                        1549 06520000
         L     @14,CRADDPTR(@14,@01)                               1549 06521000
         LA    @14,CRADDVAL(,@14)                                  1549 06522000
         ST    @14,@AL00001+12                                     1549 06523000
         MVI   @AL00001+12,X'80'                                   1549 06524000
         L     @15,GDTIFO(,@07)                                    1549 06525000
         LA    @01,@AL00001                                        1549 06526000
         BALR  @14,@15                                             1549 06527000
*                                 /* GET THE TWO TIMESTAMPS          */ 06528000
*                                                                  1550 06529000
*          /**********************************************************/ 06530000
*          /*                                                        */ 06531000
*          /*    SET UP AN ERROR CODE IF THE TIMESTAMP WAS           */ 06532000
*          /*    NOT OBTAINED CORRECTLY                              */ 06533000
*          /*                                                        */ 06534000
*          /**********************************************************/ 06535000
*                                                                  1550 06536000
*          IF REG15^=LASTCC00     /* IF DATA NOT RETURNED            */ 06537000
*            THEN DO;             /* THEN:                           */ 06538000
         LTR   REG15,REG15                                         1550 06539000
         BZ    @RF01550                                            1550 06540000
*              RSNCD=RSNCD03;     /* INDICATE THE ERROR TYPE         */ 06541000
         MVC   RSNCD(2),@CC00920                                   1552 06542000
*              IF CRVBTSER=ON     /* IF ERROR HAS BEEN PRINTED       */ 06543000
*                THEN;            /* THEN: CONTINUE                  */ 06544000
         TM    CRVBTSER(CRVEBASE),B'00000010'                      1553 06545000
         BO    @RT01553                                            1553 06546000
*                ELSE DO;         /* ELSE:                           */ 06547000
*                  CALL MESSAGE(2,MSGID22,VTTVOLSR(TPARM4),        1556 06548000
*                               LENGTH(VTTVOLSR),RSNCD,LENGTH(RSNCD));  06549000
         MVC   @AL00001(24),@AL01556                               1556 06550000
         L     @14,@PC00023                                        1556 06551000
         L     @14,TPARM4(,@14)                                    1556 06552000
         MH    @14,@CH00763                                        1556 06553000
         L     @01,CRVBASE                                         1556 06554000
         L     @01,CRVCRAPL(,@01)                                  1556 06555000
         L     @01,ACCVOLTT(,@01)                                  1556 06556000
         AL    @01,@CF01391                                        1556 06557000
         LA    @14,VTTVOLSR-4(@14,@01)                             1556 06558000
         ST    @14,@AL00001+8                                      1556 06559000
         LA    @14,RSNCD                                           1556 06560000
         ST    @14,@AL00001+16                                     1556 06561000
         LA    @01,@AL00001                                        1556 06562000
         BAL   @14,MESSAGE                                         1556 06563000
*                  END;           /*                                 */ 06564000
*              END;               /*                                 */ 06565000
*            /********************************************************/ 06566000
*            /*                                                      */ 06567000
*            /*    IF THE TIMESTAMP WAS OBTAINED, PLACE IT IN        */ 06568000
*            /*    THE VOLUME TIMESTAMP TABLE (VTT)                  */ 06569000
*            /*                                                      */ 06570000
*            /********************************************************/ 06571000
*                                                                  1559 06572000
*            ELSE VTTTMSTP(TPARM4)=ADDR(TMSRETRN)->TMSNEWTS;       1559 06573000
         B     @RC01550                                            1559 06574000
@RF01550 L     @14,@PC00023                                        1559 06575000
         L     @14,TPARM4(,@14)                                    1559 06576000
         MH    @14,@CH00763                                        1559 06577000
         L     @01,CRVBASE                                         1559 06578000
         L     @01,CRVCRAPL(,@01)                                  1559 06579000
         L     @01,ACCVOLTT(,@01)                                  1559 06580000
         ALR   @01,@14                                             1559 06581000
         AL    @01,@CF01392                                        1559 06582000
         LA    @14,TMSRETRN                                        1559 06583000
         MVC   VTTTMSTP-10(8,@01),TMSNEWTS(@14)                    1559 06584000
*                                 /* ELSE: PLACE TIMESTAMP IN        */ 06585000
*                                 /*       THE TABLE                 */ 06586000
*          END;                   /*                                 */ 06587000
*        ELSE;                    /* ELSE: CONTINUE                  */ 06588000
@RF01543 DS    0H                                                  1562 06589000
*      END;                       /*                                 */ 06590000
*    ELSE;                        /* ELSE: CONTINUE                  */ 06591000
*                                                                  1563 06592000
@RF01541 DS    0H                                                  1564 06593000
*  RFY REG15 UNRSTD;              /* RELEASE THE REGISTER            */ 06594000
*                                                                  1564 06595000
*  END TIMESTMP;                  /* END OF PROCEDURE                */ 06596000
@EL00023 DS    0H                                                  1565 06597000
@EF00023 DS    0H                                                  1565 06598000
@ER00023 LM    @14,@12,@SA00023                                    1565 06599000
         BR    @14                                                 1565 06600000
*  END IDCRC01                    /* END OF PROCEDURE                */ 06601000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 06602000
*/*@INCLUDE SYSLIB  (AMSDF01 )                                        * 06603000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 06604000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 06605000
*/*@INCLUDE SYSLIB  (IDCDF60 )                                        * 06606000
*/*@INCLUDE SYSLIB  (IDCDF61 )                                        * 06607000
*/*@INCLUDE SYSLIB  (IDCDF62 )                                        * 06608000
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        * 06609000
*/*@INCLUDE SYSLIB  (IDCDF63 )                                        * 06610000
*/*%INCLUDE SYSLIB  (IDCCSRC )                                        * 06611000
*;                                                                 1566 06612000
@EL00001 L     @13,4(,@13)                                         1566 06613000
@EF00001 L     @00,@SIZDATD                                        1566 06614000
         LR    @01,@08                                             1566 06615000
         FREEMAIN R,LV=(0),A=(1)                                        06616000
@ER00001 LM    @14,@12,12(@13)                                     1566 06617000
         BR    @14                                                 1566 06618000
@DATA    DS    0H                                                       06619000
@CH00163 DC    H'3'                                                     06620000
@CH00287 DC    H'5'                                                     06621000
@CH00473 DC    H'7'                                                     06622000
@CH00035 DC    H'9'                                                     06623000
@CH00037 DC    H'11'                                                    06624000
@CH00038 DC    H'12'                                                    06625000
@CH00758 DC    H'13'                                                    06626000
@CH00763 DC    H'14'                                                    06627000
@CH00229 DC    H'15'                                                    06628000
@CH00483 DC    H'16'                                                    06629000
@CH00879 DC    H'17'                                                    06630000
@CH00881 DC    H'18'                                                    06631000
@CH00883 DC    H'19'                                                    06632000
@CH00887 DC    H'21'                                                    06633000
@CH00889 DC    H'22'                                                    06634000
@CH00891 DC    H'23'                                                    06635000
@CH00311 DC    H'24'                                                    06636000
@CH00894 DC    H'25'                                                    06637000
@CH00954 DC    H'28'                                                    06638000
@CH01379 DC    H'43'                                                    06639000
@CH00898 DC    H'50'                                                    06640000
@CH00900 DC    H'51'                                                    06641000
@CH00902 DC    H'53'                                                    06642000
@CH00904 DC    H'54'                                                    06643000
@CH00906 DC    H'65'                                                    06644000
@CH01374 DC    H'67'                                                    06645000
@CH01375 DC    H'96'                                                    06646000
@CH00911 DC    H'104'                                                   06647000
@CH00762 DC    H'255'                                                   06648000
@CH01239 DC    H'256'                                                   06649000
@SM01397 MVC   DSNAM(0,@14),PARMDSN(@07)                                06650000
@SC01400 CLC   DSNAM(0,@05),DSNAM(@14)                                  06651000
@SC01404 CLC   DSNAM(0,@07),DSNAM(@06)                                  06652000
         DS    0F                                                       06653000
@AL00333 EQU   *                       LIST WITH   3 ARGUMENT(S)        06654000
@AL01163 DC    A(@CC00942)             LIST WITH   3 ARGUMENT(S)        06655000
         DC    A(@CC00853)                                              06656000
         DC    A(CRADS)                                                 06657000
@AL00364 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06658000
         DC    A(@CH00763)                                              06659000
         DC    A(@CC00851)                                              06660000
         DC    A(@CF00157)                                              06661000
@AL00431 EQU   *                       LIST WITH   4 ARGUMENT(S)        06662000
@AL00449 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06663000
         DC    A(@CH00883)                                              06664000
         DC    A(@CC00853)                                              06665000
         DC    A(@CF00180)                                              06666000
@AL00534 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06667000
         DC    A(@CH00483)                                              06668000
         DC    A(@CC00851)                                              06669000
         DC    A(@CF00157)                                              06670000
@AL00535 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06671000
         DC    A(@CH00879)                                              06672000
@AL00562 DC    A(@CF00116)             LIST WITH   8 ARGUMENT(S)        06673000
         DC    A(@CF01378)                                              06674000
         DC    A(@CF00116)                                              06675000
         DC    A(@CF00116)                                              06676000
         DC    A(@CF00116)                                              06677000
         DC    A(@CF00116)                                              06678000
         DC    A(QPASWORD)                                              06679000
         DC    A(@CF00116)                                              06680000
@AL00569 EQU   *                       LIST WITH   8 ARGUMENT(S)        06681000
@AL00576 EQU   *                       LIST WITH   4 ARGUMENT(S)        06682000
@AL00620 EQU   *                       LIST WITH   4 ARGUMENT(S)        06683000
@AL00864 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06684000
         DC    A(@CH00163)                                              06685000
         DC    A(@CF00116)                                              06686000
         DC    A(@CF00116)                                              06687000
         DC    A(SYSTEM)                                                06688000
         DC    AL1(X'80')                                               06689000
         DC    AL3(PROGRAM)                                             06690000
         DC    A(QCATTR)                                                06691000
         DC    A(@CF00116)                                              06692000
@AL00582 EQU   *                       LIST WITH   8 ARGUMENT(S)        06693000
@AL00771 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06694000
         DC    A(@CH00904)                                              06695000
         DC    A(@CF00116)                                              06696000
         DC    A(@CF00116)                                              06697000
         DC    A(@CC00829)                                              06698000
         DC    AL1(X'80')                                               06699000
         DC    AL3(ALL)                                                 06700000
         DC    A(QNAMEDS)                                               06701000
         DC    A(@CF00116)                                              06702000
@AL00595 EQU   *                       LIST WITH   8 ARGUMENT(S)        06703000
@AL00855 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06704000
         DC    A(@CF00157+2)                                            06705000
         DC    A(@CF00116)                                              06706000
         DC    A(@CF00116)                                              06707000
         DC    A(@CC00853)                                              06708000
         DC    A(@CC00851)                                              06709000
         DC    A(QMAMDSB)                                               06710000
         DC    A(@CF00116)                                              06711000
@AL00599 EQU   *                       LIST WITH   8 ARGUMENT(S)        06712000
@AL00856 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06713000
         DC    A(@CH00229)                                              06714000
         DC    A(@CF00116)                                              06715000
         DC    A(@CF00116)                                              06716000
         DC    A(@CC00849)                                              06717000
         DC    A(@CF00222)                                              06718000
         DC    A(QMXLRECL)                                              06719000
         DC    A(@CF00116)                                              06720000
@AL00603 EQU   *                       LIST WITH   8 ARGUMENT(S)        06721000
@AL00865 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06722000
         DC    A(@CF00154+2)                                            06723000
         DC    A(@CF00116)                                              06724000
         DC    A(@CF00116)                                              06725000
         DC    A(SYSTEM)                                                06726000
         DC    AL1(X'80')                                               06727000
         DC    AL3(PROGRAM)                                             06728000
         DC    A(QHURBA)                                                06729000
         DC    A(@CF00116)                                              06730000
@AL00613 DC    A(@CF00220)             LIST WITH  13 ARGUMENT(S)        06731000
         DC    A(@CC00853)                                              06732000
         DC    A(@CF00116)                                              06733000
         DC    A(@CF00116)                                              06734000
@AL01529 DC    A(@CC00829)             LIST WITH   2 ARGUMENT(S)        06735000
         DC    AL1(X'80')                                               06736000
         DC    AL3(ALL)                                                 06737000
         DC    A(QTYPE)                                                 06738000
         DC    A(@CF00116)                                              06739000
         DC    A(QTYPE)                                                 06740000
         DC    A(@CB00934)                                              06741000
         DC    A(@CF00116)                                              06742000
@AL00672 DC    A(@CF00116)             LIST WITH   8 ARGUMENT(S)        06743000
         DC    A(@CF00220)                                              06744000
         DC    A(@CF00116)                                              06745000
         DC    A(@CF00116)                                              06746000
         DC    A(@CF00116)                                              06747000
         DC    A(@CF00116)                                              06748000
         DC    A(QREPNO)                                                06749000
         DC    A(@CB01162)                                              06750000
@AL00731 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06751000
         DC    A(@CH00887)                                              06752000
         DC    A(@CC00851)                                              06753000
         DC    A(@CF00180)                                              06754000
@AL00761 DC    A(@CF00154)             LIST WITH   6 ARGUMENT(S)        06755000
         DC    A(@CH00881)                                              06756000
         DC    A(@CC00942)                                              06757000
         DC    A(@CF00157)                                              06758000
         DC    A(CRACAT)                                                06759000
         DC    A(@CF00154)                                              06760000
@AL00778 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06761000
         DC    A(@CH00906)                                              06762000
         DC    A(@CC00853)                                              06763000
         DC    A(@CF00154)                                              06764000
@AL00780 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06765000
         DC    A(@CH00902)                                              06766000
         DC    A(@CC00851)                                              06767000
         DC    A(@CF00154)                                              06768000
@AL00781 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06769000
         DC    A(@CH00900)                                              06770000
         DC    A(@CC00853)                                              06771000
         DC    A(@CF00154)                                              06772000
@AL00873 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06773000
         DC    A(@CH00473)                                              06774000
         DC    A(@CF00116)                                              06775000
         DC    A(@CF00116)                                              06776000
@AL00874 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06777000
         DC    A(@CF00220+2)                                            06778000
         DC    A(@CF00116)                                              06779000
         DC    A(@CF00116)                                              06780000
@AL00889 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06781000
         DC    A(@CH00891)                                              06782000
         DC    A(@CF00116)                                              06783000
         DC    A(@CF00116)                                              06784000
@AL00991 DC    A(EXCL)                 LIST WITH   4 ARGUMENT(S)        06785000
         DC    A(WAIT)                                                  06786000
@AL01516 DC    A(SYSTEM)               LIST WITH   2 ARGUMENT(S)        06787000
         DC    AL1(X'80')                                               06788000
         DC    AL3(PROGRAM)                                             06789000
@AL01135 EQU   *                       LIST WITH   8 ARGUMENT(S)        06790000
@AL01226 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06791000
         DC    A(@CH00311)                                              06792000
         DC    A(@CF00116)                                              06793000
         DC    A(@CF00116)                                              06794000
@AL00472 EQU   *                       LIST WITH   2 ARGUMENT(S)        06795000
@AL01062 DC    A(@CC00849)             LIST WITH   2 ARGUMENT(S)        06796000
         DC    A(@CF00222)                                              06797000
         DC    A(QCRADITS)                                              06798000
         DC    A(@CF00116)                                              06799000
@AL01154 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06800000
         DC    A(@CH00758)                                              06801000
         DC    A(@CC00851)                                              06802000
         DC    A(@CF00157)                                              06803000
@AL01185 DC    A(@CF00220)             LIST WITH   4 ARGUMENT(S)        06804000
         DC    A(@CH00894)                                              06805000
         DC    A(@CC00853)                                              06806000
         DC    A(@CF00157)                                              06807000
@AL01218 EQU   *                       LIST WITH   6 ARGUMENT(S)        06808000
@AL01219 DC    A(@CF00154)             LIST WITH   6 ARGUMENT(S)        06809000
         DC    A(@CH00038)                                              06810000
@AL00801 DC    A(@CC00942)             LIST WITH   3 ARGUMENT(S)        06811000
         DC    A(@CF00157)                                              06812000
         DC    A(CRACAT)                                                06813000
         DC    A(@CF00157)                                              06814000
@AL01256 DC    A(@CF00381)             LIST WITH   4 ARGUMENT(S)        06815000
         DC    A(@CC00851)                                              06816000
         DC    A(@CC00829)                                              06817000
         DC    AL1(X'80')                                               06818000
         DC    AL3(SETZERO)                                             06819000
@AL01374 EQU   *                       LIST WITH   6 ARGUMENT(S)        06820000
@AL01556 DC    A(@CF00154)             LIST WITH   6 ARGUMENT(S)        06821000
         DC    A(@CH00889)                                              06822000
         DC    A(@CC00853)                                              06823000
         DC    A(@CF00157)                                              06824000
         DC    A(@CC00851)                                              06825000
         DC    A(@CF00154)                                              06826000
@AL01462 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06827000
         DC    A(@CH00037)                                              06828000
         DC    A(@CC00853)                                              06829000
         DC    A(@CF00180)                                              06830000
@AL01476 DC    A(@CF00116)             LIST WITH   4 ARGUMENT(S)        06831000
         DC    A(@CH00911)                                              06832000
         DC    A(@CF00116)                                              06833000
         DC    A(@CF00116)                                              06834000
@AL01525 DC    A(@CF00154)             LIST WITH   6 ARGUMENT(S)        06835000
         DC    A(@CH00287)                                              06836000
@AL01085 DC    A(@CC00851)             LIST WITH   1 ARGUMENT(S)        06837000
         DC    A(@CF00180)                                              06838000
@AL00986 DC    A(@CC00853)             LIST WITH   1 ARGUMENT(S)        06839000
         DC    A(@CF00180)                                              06840000
@DATD    DSECT                                                          06841000
         DS    0F                                                       06842000
@SA00001 DS    18F                                                      06843000
@PC00001 DS    3F                                                       06844000
@SA00013 DS    13F                                                      06845000
@SA00002 DS    15F                                                      06846000
@SA00018 DS    14F                                                      06847000
@PC00018 DS    3F                                                       06848000
@SA00010 DS    15F                                                      06849000
@SA00005 DS    15F                                                      06850000
@PC00005 DS    1F                                                       06851000
@SA00008 DS    15F                                                      06852000
@PC00008 DS    1F                                                       06853000
@SA00021 DS    15F                                                      06854000
@PC00021 DS    1F                                                       06855000
@SA00014 DS    15F                                                      06856000
@PC00014 DS    6F                                                       06857000
@SA00011 DS    15F                                                      06858000
@PC00011 DS    1F                                                       06859000
@SA00003 DS    15F                                                      06860000
@PC00003 DS    2F                                                       06861000
@SA00020 DS    15F                                                      06862000
@PC00020 DS    3F                                                       06863000
@SA00006 DS    15F                                                      06864000
@PC00006 DS    2F                                                       06865000
@SA00004 DS    14F                                                      06866000
@PC00004 DS    1F                                                       06867000
@SA00012 DS    15F                                                      06868000
@PC00012 DS    13F                                                      06869000
@SA00007 DS    14F                                                      06870000
@SA00009 DS    14F                                                      06871000
@PC00009 DS    1F                                                       06872000
@SA00022 DS    15F                                                      06873000
@SA00015 DS    14F                                                      06874000
@PC00015 DS    1F                                                       06875000
@SA00016 DS    14F                                                      06876000
@PC00016 DS    2F                                                       06877000
@SA00017 DS    14F                                                      06878000
@PC00017 DS    2F                                                       06879000
@SA00023 DS    15F                                                      06880000
@PC00023 DS    1F                                                       06881000
@SA00019 DS    14F                                                      06882000
@PC00019 DS    1F                                                       06883000
@AL00001 DS    13A                                                      06884000
@TF00001 DS    F                                                        06885000
@AFTEMPS DS    6F                                                       06886000
IDCRC01  CSECT                                                          06887000
         DS    0F                                                       06888000
@CF00116 DC    F'0'                                                     06889000
@CF00220 DC    F'1'                                                     06890000
@CH00220 EQU   @CF00220+2                                               06891000
@CF00154 DC    F'2'                                                     06892000
@CH00154 EQU   @CF00154+2                                               06893000
@CF00043 DC    F'4'                                                     06894000
@CH00043 EQU   @CF00043+2                                               06895000
@CF00157 DC    F'6'                                                     06896000
@CH00157 EQU   @CF00157+2                                               06897000
@CF00180 DC    F'8'                                                     06898000
@CH00180 EQU   @CF00180+2                                               06899000
@CF00885 DC    F'20'                                                    06900000
@CH00885 EQU   @CF00885+2                                               06901000
@CF00222 DC    F'32'                                                    06902000
@CF01378 DC    F'45'                                                    06903000
@CF01101 DC    F'280'                                                   06904000
@CF00381 DC    F'384'                                                   06905000
@CF01068 DC    F'1536'                                                  06906000
@CF01344 DC    F'2032'                                                  06907000
@CF01198 DC    F'2048'                                                  06908000
@CF01070 DC    F'4608'                                                  06909000
@CF01394 DC    F'-1024'                                                 06910000
@CF01412 DC    F'-32'                                                   06911000
@CF01411 DC    F'-31'                                                   06912000
@CF01407 DC    F'-12'                                                   06913000
@CF01391 DC    F'-10'                                                   06914000
@CF01408 DC    F'-9'                                                    06915000
@CF01384 DC    F'-8'                                                    06916000
@CF01409 DC    F'-6'                                                    06917000
@CF01410 DC    F'-5'                                                    06918000
@CF01392 DC    F'-4'                                                    06919000
@DATD    DSECT                                                          06920000
         DS    0D                                                       06921000
LISTSCAN DS    A                                                        06922000
IOCSPTR  DS    A                                                        06923000
OPNPTR   DS    A                                                        06924000
DDSTRU   DS    A                                                        06925000
FSADDR   DS    A                                                        06926000
ERCNVADR DS    A                                                        06927000
DMPINDEX DS    A                                                        06928000
CHAIN2   DS    A                                                        06929000
INPPTR   DS    A                                                        06930000
CRVBASE  DS    A                                                        06931000
VGOPTR   DS    A                                                        06932000
VGOSIZE  DS    F                                                        06933000
DSNPTR   DS    A                                                        06934000
NBLKPTR  DS    A                                                        06935000
INX1     DS    F                                                        06936000
KVALA    DS    A                                                        06937000
BLDIX2   DS    F                                                        06938000
POOLSIZE DS    F                                                        06939000
UCBAPTR  DS    A                                                        06940000
KVALL    DS    F                                                        06941000
OUTAD    DS    A                                                        06942000
OUTLNG   DS    F                                                        06943000
DIRSIZE  DS    F                                                        06944000
DUPIXL   DS    F                                                        06945000
EXPTIX2  DS    F                                                        06946000
OBJSUMTT DS    F                                                        06947000
OBJIX1   DS    F                                                        06948000
OBJIX2   DS    A                                                        06949000
OBJIX3   DS    F                                                        06950000
OBJIX4   DS    A                                                        06951000
OBJIX5   DS    F                                                        06952000
OBJIX6   DS    F                                                        06953000
OBJIX8   DS    F                                                        06954000
OBJIX9   DS    F                                                        06955000
SIZE     DS    F                                                        06956000
SPCSIZE  DS    F                                                        06957000
SPCSIZE1 DS    F                                                        06958000
SPCPTR   DS    A                                                        06959000
SPCPTR1  DS    A                                                        06960000
SYIX1    DS    F                                                        06961000
LISTPTR  DS    A                                                        06962000
SETRC    DS    H                                                        06963000
TESTRC   DS    H                                                        06964000
LISTLN   DS    FL1                                                      06965000
@TS00001 DS    CL95                                                     06966000
VGOCRATS DS    CL4                                                      06967000
RSNCD    DS    CL2                                                      06968000
CORE     DS    CL1                                                      06969000
BYTEPM1  DS    BL1                                                      06970000
TMSAREA  DS    CL96                                                     06971000
         ORG   TMSAREA                                                  06972000
TMSFLDLN DS    FL2                                                      06973000
TMSFLDUS DS    FL2                                                      06974000
TMSRETRN DS    FL2                                                      06975000
@NM00044 DS    CL90                                                     06976000
         ORG   TMSAREA+96                                               06977000
@NM00058 DS    CL1                                                      06978000
         ORG   @NM00058                                                 06979000
PDELERR  DS    BL1                                                      06980000
         ORG   @NM00058+1                                               06981000
UCBAREA  DS    CL11                                                     06982000
ENTOBJA  DS    CL17                                                     06983000
         DS    CL3                                                      06984000
OUTDATA  DS    CL17                                                     06985000
FMPLAR   DS    CL28                                                     06986000
         DS    CL3                                                      06987000
FMFLAR1  DS    CL24                                                     06988000
         ORG   FMFLAR1                                                  06989000
@NM00060 DS    CL16                                                     06990000
@NM00061 DS    CL8                                                      06991000
         ORG   FMFLAR1+24                                               06992000
FMFLAR2  DS    CL24                                                     06993000
         ORG   FMFLAR2                                                  06994000
@NM00062 DS    CL16                                                     06995000
@NM00063 DS    CL8                                                      06996000
         ORG   FMFLAR2+24                                               06997000
OARA     DS    CL256                                                    06998000
WKA256   DS    CL256                                                    06999000
BUFSAR   DS    CL28                                                     07000000
BUFWKAR1 DS    CL256                                                    07001000
DDSTRU1  DS    CL36                                                     07002000
OBJVOL2  DS    CL6                                                      07003000
TERMTIME DS    CL8                                                      07004000
TERMDATE DS    CL8                                                      07005000
         DS    CL2                                                      07006000
INPTBLA  DS    5A                                                       07007000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                07008000
@ENDDATD EQU   *                                                        07009000
IDCRC01  CSECT                                                          07010000
         DS    0F                                                       07011000
@SIZDATD DC    AL1(0)                                                   07012000
         DC    AL3(@ENDDATD-@DATD)                                      07013000
@CV00913 DC    V(IDCRC02)                                               07014000
@CV01241 DC    V(IDCRC03)                                               07015000
@CV01242 DC    V(IDCRC04)                                               07016000
         DS    0D                                                       07017000
         DS    CL1                                                      07018000
INVALCI  DC    XL3'FFFFFF'                                              07019000
@CC00829 DC    C'RC50'                                                  07020000
@CC00831 DC    C'RC51'                                                  07021000
@CC00833 DC    C'RC52'                                                  07022000
@CC00835 DC    C'RC53'                                                  07023000
@CC00837 DC    C'RC54'                                                  07024000
@CC01102 DC    C'RC81'                                                  07025000
@CC01111 DC    C'RC86'                                                  07026000
@CC01122 DC    C'RC93'                                                  07027000
@CC01143 DC    C'RC99'                                                  07028000
@CC01154 DC    C'RC87'                                                  07029000
@CC01165 DC    C'RC98'                                                  07030000
@CC01174 DC    C'RC85'                                                  07031000
@CC01181 DC    C'RC96'                                                  07032000
@CC01200 DC    C'RC82'                                                  07033000
@CC01243 DC    C'RC90'                                                  07034000
@CC01249 DC    C'RC80'                                                  07035000
@CC01266 DC    C'RC89'                                                  07036000
@CC01273 DC    C'RC97'                                                  07037000
@CC01295 DC    C'RC84'                                                  07038000
@CC01309 DC    C'RC92'                                                  07039000
@CC01319 DC    C'RC91'                                                  07040000
@CC01329 DC    C'RC95'                                                  07041000
@CC01345 DC    C'RC88'                                                  07042000
@CC01352 DC    C'RC83'                                                  07043000
@CC01358 DC    C'RC79'                                                  07044000
@CC01364 DC    C'RC94'                                                  07045000
@CC00908 DC    C'XP0'                                                   07046000
@CC00916 DC    C'01'                                                    07047000
@CC00918 DC    C'02'                                                    07048000
@CC00920 DC    C'03'                                                    07049000
@CC00922 DC    C'04'                                                    07050000
@CC00924 DC    C'05'                                                    07051000
@CC00926 DC    C'06'                                                    07052000
@CC00928 DC    C'07'                                                    07053000
@CC00930 DC    C'08'                                                    07054000
@CC00932 DC    C'09'                                                    07055000
@CC00849 DC    C'G'                                                     07056000
@CC00851 EQU   @CC00829                                                 07057000
@CC00853 DC    C'I'                                                     07058000
@CC00855 DC    C'C'                                                     07059000
@CC00860 DC    C'B'                                                     07060000
@CC00942 DC    C'O'                                                     07061000
@CB01300 DC    X'FFFFFFFF'                                              07062000
@CB00655 EQU   @CB01300                                                 07063000
@CB00934 DC    X'80'                                                    07064000
@CB01162 DC    X'08'                                                    07065000
ALL      DC    CL3'ALL'                                                 07066000
FORMAT   DC    CL4'FORM'                                                07067000
HSECOND  DC    CL4'HSEC'                                                07068000
CLOCK    DC    CL4'KLOK'                                                07069000
SETZERO  DC    CL4'ZERO'                                                07070000
SETBLANK DC    CL4'BLNK'                                                07071000
NOSET    DC    CL4'NSET'                                                07072000
OVERRIDE DC    CL4'OVRD'                                                07073000
ACQUIRE  DC    CL8'ACQUIRE '                                            07074000
RELINQ   DC    CL8'RELINQ  '                                            07075000
MOUNT    DC    CL8'MOUNT   '                                            07076000
DEMOUNT  DC    CL8'DEMOUNT '                                            07077000
DEFINE   DC    CL8'DEFINE  '                                            07078000
MOVE     DC    CL8'MOVE    '                                            07079000
TRACEQ   DC    CL8'TRACEQ  '                                            07080000
COPYTABL DC    CL8'COPYTABL'                                            07081000
COPYCRTG DC    CL8'COPYCRTG'                                            07082000
COPYVOL  DC    CL8'COPYVOL '                                            07083000
VVIC     DC    CL8'VVIC    '                                            07084000
TUNE     DC    CL8'TUNE    '                                            07085000
NAMES    DC    CL4'NAME'                                                07086000
UNIT     DC    CL4'UNIT'                                                07087000
SHR      DC    CL4'SHR '                                                07088000
EXCL     DC    CL4'EXCL'                                                07089000
NOWAIT   DC    CL4'NWAI'                                                07090000
WAIT     DC    CL4'WAIT'                                                07091000
UV0MODID DC    CL3'UV0'                                                 07092000
GOOD     DC    CL1'G'                                                   07093000
BAD      DC    CL1'B'                                                   07094000
CRACAT   DC    CL1'C'                                                   07095000
CRADS    DC    CL1'D'                                                   07096000
QDSDIREC DC    CL8'$DSDIREC'                                            07097000
QDSDRRPM DC    CL8'$DSDRIRN'                                            07098000
QEXTDATA DC    CL8'$EXTDATA'                                            07099000
QMXLRECL DC    CL8'$MXLRECL'                                            07100000
QMAMDSB  DC    CL8'AMDSBCAT'                                            07101000
QCATTR   DC    CL8'CATTR   '                                            07102000
QCRADITS DC    CL8'CRADITS '                                            07103000
QHURBA   DC    CL8'HURBA   '                                            07104000
QITYPEXT DC    CL8'ITYPEXT '                                            07105000
QNAMEDS  DC    CL8'NAMEDS  '                                            07106000
QPASWORD DC    CL8'PASSWORD'                                            07107000
QREPNO   DC    CL8'REPNO   '                                            07108000
QTYPE    DC    CL8'TYPE    '                                            07109000
NULLCHAR DS    CL8                                                      07110000
         ORG   NULLCHAR                                                 07111000
@NM00055 DC    X'0000000000000000'                                      07112000
         ORG   NULLCHAR+8                                               07113000
SYSTEM   DC    CL8'SYSIGGV2'                                            07114000
PROGRAM  DS    CL9                                                      07115000
         ORG   PROGRAM                                                  07116000
@NM00056 DC    AL1(8)                                                   07117000
@NM00057 DC    X'D9EEEEEEEEEEEE00'                                      07118000
         ORG   PROGRAM+9                                                07119000
MODID    DC    CL4'RC01'                                                07120000
KPWINVAL DC    X'FFFFFFFFFFFFFFFF'                                      07121000
         DS    CL1                                                      07122000
PATCH    DC    125A(0)                                                  07123000
RECSTYPE DC    CL1'C'                                                   07124000
         DC    CL1'G'                                                   07125000
         DC    CL1'A'                                                   07126000
         DC    CL1'B'                                                   07127000
         DC    CL1'U'                                                   07128000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07129000
@01      EQU   01                                                       07130000
@02      EQU   02                                                       07131000
@03      EQU   03                                                       07132000
@04      EQU   04                                                       07133000
@05      EQU   05                                                       07134000
@06      EQU   06                                                       07135000
@07      EQU   07                                                       07136000
@08      EQU   08                                                       07137000
@09      EQU   09                                                       07138000
@10      EQU   10                                                       07139000
@11      EQU   11                                                       07140000
@12      EQU   12                                                       07141000
@13      EQU   13                                                       07142000
@14      EQU   14                                                       07143000
@15      EQU   15                                                       07144000
INDEX    EQU   @04                                                      07145000
OBJIX7   EQU   @06                                                      07146000
EXPTIX1  EQU   @02                                                      07147000
DUPPTR   EQU   @02                                                      07148000
DUPIX    EQU   @04                                                      07149000
INDEX2   EQU   @02                                                      07150000
INDEX1   EQU   @03                                                      07151000
RRDS     EQU   @02                                                      07152000
VTTSIZE  EQU   @04                                                      07153000
ACCSIZE  EQU   @03                                                      07154000
CRVSIZE  EQU   @02                                                      07155000
BLDIX1   EQU   @02                                                      07156000
BLDPTR   EQU   @04                                                      07157000
I        EQU   @04                                                      07158000
ERRNO    EQU   @02                                                      07159000
COUNT    EQU   @05                                                      07160000
BYTEPM1A EQU   @04                                                      07161000
EXPORTED EQU   @02                                                      07162000
VGOPTR1  EQU   @02                                                      07163000
CRVEBASE EQU   @03                                                      07164000
BUFSPTR  EQU   @05                                                      07165000
FMFLCUR  EQU   @02                                                      07166000
FMPLAD   EQU   @04                                                      07167000
REG1     EQU   @01                                                      07168000
REG15    EQU   @15                                                      07169000
REG0     EQU   @00                                                      07170000
REG10    EQU   @10                                                      07171000
REG11    EQU   @11                                                      07172000
REG12    EQU   @12                                                      07173000
REG13    EQU   @13                                                      07174000
REG14    EQU   @14                                                      07175000
REG2     EQU   @02                                                      07176000
REG3     EQU   @03                                                      07177000
REG4     EQU   @04                                                      07178000
REG5     EQU   @05                                                      07179000
REG6     EQU   @06                                                      07180000
REG7     EQU   @07                                                      07181000
REG8     EQU   @08                                                      07182000
REG9     EQU   @09                                                      07183000
RTNREG   EQU   @15                                                      07184000
IDCSAEP0 EQU   0                                                        07185000
IDCSAGP0 EQU   0                                                        07186000
IDCSAFP0 EQU   0                                                        07187000
IDCSATI0 EQU   0                                                        07188000
IDCSANQ0 EQU   0                                                        07189000
IDCSARV0 EQU   0                                                        07190000
IDCSADQ0 EQU   0                                                        07191000
IDCSASI0 EQU   0                                                        07192000
TRACE1   EQU   0                                                        07193000
OLDERID1 EQU   TRACE1                                                   07194000
TRACE2   EQU   0                                                        07195000
OLDERID2 EQU   TRACE2                                                   07196000
NEWID2   EQU   TRACE2+95                                                07197000
NEWERID2 EQU   5                                                        07198000
CIRAGL   EQU   0                                                        07199000
CIRTYPE  EQU   CIRAGL                                                   07200000
ALLAGL   EQU   0                                                        07201000
ALLSTS   EQU   ALLAGL+24                                                07202000
ALLDSP   EQU   ALLAGL+25                                                07203000
ALLORG   EQU   ALLAGL+26                                                07204000
ALLOPT   EQU   ALLAGL+28                                                07205000
UNITABL  EQU   0                                                        07206000
UNITUCB  EQU   UNITABL                                                  07207000
UNITADR  EQU   UNITABL+4                                                07208000
@NM00010 EQU   UNITADR                                                  07209000
UNITSTAT EQU   UNITABL+6                                                07210000
IDCIOOP0 EQU   0                                                        07211000
IDCIOCL0 EQU   0                                                        07212000
IDCIOPO0 EQU   0                                                        07213000
IDCIOGT0 EQU   0                                                        07214000
IDCIOVY0 EQU   0                                                        07215000
IDCIOSI0 EQU   0                                                        07216000
IOCSTR   EQU   0                                                        07217000
IOCDAD   EQU   IOCSTR                                                   07218000
IOCDSO   EQU   IOCSTR+16                                                07219000
IOCRFM   EQU   IOCSTR+17                                                07220000
IOCMAC   EQU   IOCSTR+18                                                07221000
IOCMAC2  EQU   IOCSTR+19                                                07222000
IOCCHP   EQU   IOCSTR+20                                                07223000
IOCCHPSQ EQU   IOCCHP                                                   07224000
IOCCHPDR EQU   IOCCHP                                                   07225000
IOCMSG   EQU   IOCSTR+21                                                07226000
IOCMSGOP EQU   IOCMSG                                                   07227000
IOCRBA   EQU   IOCSTR+40                                                07228000
IOCTTR   EQU   IOCRBA                                                   07229000
IOCMEM   EQU   IOCSTR+44                                                07230000
IOCNWM   EQU   IOCSTR+48                                                07231000
IOCREL   EQU   IOCSTR+60                                                07232000
OPNAGL   EQU   0                                                        07233000
OPNOPT   EQU   OPNAGL                                                   07234000
OPNOPTIN EQU   OPNOPT                                                   07235000
OPNOPTBK EQU   OPNOPT                                                   07236000
OPNOPTCR EQU   OPNOPT                                                   07237000
OPNOPTDR EQU   OPNOPT                                                   07238000
OPNRFM   EQU   OPNAGL+1                                                 07239000
OPNTYP   EQU   OPNAGL+2                                                 07240000
OPNTYPRA EQU   OPNTYP                                                   07241000
OPNMOD   EQU   OPNAGL+3                                                 07242000
OPNIOC   EQU   OPNAGL+4                                                 07243000
OPNDDN   EQU   OPNAGL+8                                                 07244000
OPNPWA   EQU   OPNAGL+12                                                07245000
OPNDEV   EQU   OPNAGL+24                                                07246000
OPNDSO   EQU   OPNAGL+41                                                07247000
OPNDSOAM EQU   OPNDSO                                                   07248000
OPNOPT2  EQU   OPNAGL+42                                                07249000
IOINFOPT EQU   0                                                        07250000
IOINFDVT EQU   IOINFOPT                                                 07251000
IOINFVOL EQU   IOINFOPT                                                 07252000
IOINFTMS EQU   IOINFOPT                                                 07253000
UVOLLIST EQU   0                                                        07254000
UVOLENT  EQU   UVOLLIST+2                                               07255000
AMSTP011 EQU   0                                                        07256000
DARGLIST EQU   0                                                        07257000
DARGDBP  EQU   DARGLIST                                                 07258000
DARGRETP EQU   DARGLIST+4                                               07259000
DARGSTID EQU   DARGLIST+8                                               07260000
DARGSMOD EQU   DARGSTID                                                 07261000
DARGSENT EQU   DARGSTID+3                                               07262000
DARGILP  EQU   DARGLIST+12                                              07263000
DARGCNT  EQU   DARGLIST+14                                              07264000
DARGRETL EQU   DARGLIST+16                                              07265000
DARGIND  EQU   DARGLIST+18                                              07266000
DARGFLGS EQU   DARGLIST+19                                              07267000
DARGARY  EQU   DARGLIST+20                                              07268000
DARGINS  EQU   DARGARY                                                  07269000
DARGINL  EQU   DARGARY+2                                                07270000
DARGDTM  EQU   DARGARY+4                                                07271000
FMTLIST  EQU   0                                                        07272000
FMTFLGS  EQU   FMTLIST                                                  07273000
FMTSPF   EQU   FMTLIST+2                                                07274000
FMTRFNO  EQU   FMTSPF                                                   07275000
FMTILEN  EQU   FMTRFNO                                                  07276000
FMTIOFF  EQU   FMTLIST+4                                                07277000
FMTTRBC  EQU   FMTIOFF                                                  07278000
FMTSTO   EQU   FMTTRBC                                                  07279000
FMTOCOL  EQU   FMTLIST+6                                                07280000
FMTCNVF  EQU   FMTLIST+10                                               07281000
ERCNVTAB EQU   0                                                        07282000
ERTYPE   EQU   ERCNVTAB                                                 07283000
EROPER   EQU   ERCNVTAB+1                                               07284000
EROSOPER EQU   ERCNVTAB+2                                               07285000
ERCATRC  EQU   ERCNVTAB+16                                              07286000
ERCPLPT  EQU   ERCNVTAB+20                                              07287000
IDCDB010 EQU   0                                                        07288000
DMPITM   EQU   0                                                        07289000
DMPARY   EQU   0                                                        07290000
ACC      EQU   0                                                        07291000
ACCTRANT EQU   ACC                                                      07292000
ACCDSNCI EQU   ACC+5                                                    07293000
ACCVOLTT EQU   ACC+8                                                    07294000
CTT      EQU   0                                                        07295000
CTTENTNO EQU   CTT                                                      07296000
CTTENTRY EQU   CTT+4                                                    07297000
CTTENTYP EQU   CTTENTRY                                                 07298000
CTTCATCI EQU   CTTENTRY+1                                               07299000
VTT      EQU   0                                                        07300000
VTTENTNO EQU   VTT                                                      07301000
VTTENTRY EQU   VTT+4                                                    07302000
VTTVOLSR EQU   VTTENTRY                                                 07303000
VTTTMSTP EQU   VTTENTRY+6                                               07304000
FMPL     EQU   0                                                        07305000
FMPLFLNO EQU   FMPL                                                     07306000
FMPLBCIN EQU   FMPL+1                                                   07307000
FMPLGRTN EQU   FMPL+4                                                   07308000
FMPLWKAR EQU   FMPL+8                                                   07309000
FMPLUPTR EQU   FMPL+12                                                  07310000
FMPLRTCD EQU   FMPL+16                                                  07311000
FMPLENTH EQU   FMPL+18                                                  07312000
FMPLOAR  EQU   FMPL+20                                                  07313000
FMPLFMFL EQU   FMPL+24                                                  07314000
FMFL     EQU   0                                                        07315000
FMFLDLNO EQU   FMFL                                                     07316000
FMFLTSTC EQU   FMFL+1                                                   07317000
FMFLGRPC EQU   FMFL+2                                                   07318000
FMFLINDS EQU   FMFL+3                                                   07319000
FMFLDNAM EQU   FMFL+8                                                   07320000
FMFLTCHN EQU   FMFL+12                                                  07321000
FMFLDATA EQU   FMFL+16                                                  07322000
FMFLENTH EQU   FMFLDATA                                                 07323000
FMFLADDR EQU   FMFLDATA+4                                               07324000
BUFS     EQU   0                                                        07325000
BUFPOOL  EQU   BUFS                                                     07326000
BUFIOCS  EQU   BUFS+8                                                   07327000
BUFGDT   EQU   BUFS+12                                                  07328000
BUFCTT   EQU   BUFS+16                                                  07329000
BUFWKARA EQU   BUFS+20                                                  07330000
BUFSIZE  EQU   BUFS+24                                                  07331000
BUFSWS   EQU   BUFS+26                                                  07332000
BUFORMAT EQU   BUFSWS                                                   07333000
BUFELM   EQU   0                                                        07334000
IDAAMDSB EQU   0                                                        07335000
AMDATTR  EQU   IDAAMDSB+1                                               07336000
AMDRRDS  EQU   AMDATTR                                                  07337000
AMDNEST  EQU   IDAAMDSB+4                                               07338000
AMDHLRBA EQU   IDAAMDSB+28                                              07339000
AMDSSRBA EQU   IDAAMDSB+32                                              07340000
AMDATTR3 EQU   IDAAMDSB+40                                              07341000
AMDSTAT  EQU   IDAAMDSB+48                                              07342000
INPTBL   EQU   0                                                        07343000
ENTOBJ   EQU   0                                                        07344000
OBJTYP   EQU   ENTOBJ                                                   07345000
OBJVAL   EQU   ENTOBJ+1                                                 07346000
OBJPLN   EQU   ENTOBJ+8                                                 07347000
OBJPAS   EQU   ENTOBJ+9                                                 07348000
OUTDAT   EQU   0                                                        07349000
OUTLEN   EQU   OUTDAT                                                   07350000
USBKSZ   EQU   OUTDAT+8                                                 07351000
OUTFLGS  EQU   OUTDAT+16                                                07352000
ENDFLG   EQU   OUTFLGS                                                  07353000
EMPTYDS  EQU   OUTFLGS                                                  07354000
FRC      EQU   0                                                        07355000
CRACNT   EQU   0                                                        07356000
CRADDPTR EQU   0                                                        07357000
CRADD    EQU   0                                                        07358000
CRADDVAL EQU   CRADD+1                                                  07359000
ALLNTPTR EQU   0                                                        07360000
ENTREPTR EQU   0                                                        07361000
ENTRECNT EQU   0                                                        07362000
IFILEPTR EQU   0                                                        07363000
IFILE    EQU   0                                                        07364000
IFILEVAL EQU   IFILE+1                                                  07365000
MRPW     EQU   0                                                        07366000
MRPWVAL  EQU   MRPW+1                                                   07367000
PDEV     EQU   0                                                        07368000
PDEVVAL  EQU   PDEV+1                                                   07369000
OUTDD    EQU   0                                                        07370000
OUTDDVAL EQU   OUTDD+1                                                  07371000
ENTNMPTR EQU   0                                                        07372000
ENTNM    EQU   0                                                        07373000
ENTNMFLG EQU   ENTNM+10                                                 07374000
ENTNMVAL EQU   ENTNM+21                                                 07375000
ENTDNPTR EQU   0                                                        07376000
ENTDN    EQU   0                                                        07377000
ENTDNVAL EQU   ENTDN+1                                                  07378000
BLKSZ    EQU   0                                                        07379000
BLKSZVAL EQU   BLKSZ                                                    07380000
CRVENTY  EQU   0                                                        07381000
CRVOPNAG EQU   CRVENTY                                                  07382000
CRVIOSTR EQU   CRVENTY+4                                                07383000
CRVDIREC EQU   CRVENTY+8                                                07384000
CRVADCTT EQU   CRVENTY+12                                               07385000
CRVNAMCH EQU   CRVENTY+16                                               07386000
CRVIND   EQU   CRVENTY+20                                               07387000
CRVBADVL EQU   CRVIND                                                   07388000
CRVCATOK EQU   CRVIND                                                   07389000
CRVNAME  EQU   CRVIND                                                   07390000
CRVDIRER EQU   CRVIND                                                   07391000
CRVCTTER EQU   CRVIND                                                   07392000
CRVBTSER EQU   CRVIND                                                   07393000
CRVTKPCY EQU   CRVENTY+22                                               07394000
CRVHIREP EQU   CRVENTY+26                                               07395000
CRV      EQU   0                                                        07396000
CRVMAXLR EQU   CRV                                                      07397000
CRVCRAPL EQU   CRV+4                                                    07398000
CRVCATNM EQU   CRV+8                                                    07399000
CRVCATNL EQU   CRVCATNM                                                 07400000
CRVCATNC EQU   CRVCATNM+1                                               07401000
CRVMAJNM EQU   CRV+53                                                   07402000
CRVENTRY EQU   CRV+64                                                   07403000
VGOENT   EQU   0                                                        07404000
VGOVOLSR EQU   VGOENT                                                   07405000
VGODIRSN EQU   VGOENT+6                                                 07406000
VGOEXLEN EQU   VGOENT+8                                                 07407000
VGOEXT   EQU   VGOENT+10                                                07408000
VGOSKIP  EQU   VGOEXT                                                   07409000
VGOCC    EQU   VGOEXT+2                                                 07410000
VGOHH    EQU   VGOEXT+4                                                 07411000
VGOS     EQU   0                                                        07412000
VGOENTYS EQU   VGOS+2                                                   07413000
DSNAME   EQU   0                                                        07414000
DSNAMLEN EQU   DSNAME                                                   07415000
DSNAM    EQU   DSNAME+2                                                 07416000
DIRECTY  EQU   0                                                        07417000
DIRCI    EQU   DIRECTY                                                  07418000
DIRTS    EQU   DIRECTY+3                                                07419000
DIRSUMTT EQU   DIRECTY+7                                                07420000
DIRELPNO EQU   DIRECTY+10                                               07421000
DIRLENU  EQU   0                                                        07422000
TMSTS    EQU   0                                                        07423000
TMSHDR   EQU   TMSTS                                                    07424000
TMSNEWTS EQU   TMSTS+12                                                 07425000
TMSDT    EQU   0                                                        07426000
TMSDTCD  EQU   TMSDT                                                    07427000
TMSDTTPC EQU   TMSDT+14                                                 07428000
TMSVS    EQU   0                                                        07429000
TMSVSCD  EQU   TMSVS                                                    07430000
TMSVSLEN EQU   TMSVS+2                                                  07431000
TMSVOLSR EQU   TMSVS+4                                                  07432000
NBLK     EQU   0                                                        07433000
NBLKCHN  EQU   NBLK                                                     07434000
NBLKTYPE EQU   NBLK+4                                                   07435000
NBLKCI   EQU   NBLK+5                                                   07436000
@NM00048 EQU   NBLK+8                                                   07437000
NBLKMH   EQU   @NM00048                                                 07438000
NBLKBE   EQU   @NM00048                                                 07439000
NBLKSC   EQU   @NM00048                                                 07440000
NBLKMT   EQU   @NM00048                                                 07441000
NBLKDCI  EQU   NBLK+9                                                   07442000
NBLKPWL  EQU   NBLK+12                                                  07443000
NBLKICI  EQU   NBLK+13                                                  07444000
NBLKNAME EQU   NBLK+16                                                  07445000
NBLKENTN EQU   NBLK+20                                                  07446000
NBLKPW   EQU   NBLK+24                                                  07447000
RECORD1  EQU   0                                                        07448000
RECCI    EQU   RECORD1+1                                                07449000
RECTYPE  EQU   RECORD1+44                                               07450000
RECNEXCI EQU   RECORD1+48                                               07451000
RECNAME  EQU   RECNEXCI+1                                               07452000
KVALD    EQU   0                                                        07453000
KPW      EQU   0                                                        07454000
KCHAR    EQU   0                                                        07455000
KPGDS    EQU   KCHAR                                                    07456000
KTYPE    EQU   0                                                        07457000
KCHART   EQU   KTYPE                                                    07458000
KCINO    EQU   KTYPE+1                                                  07459000
DIRCNT   EQU   0                                                        07460000
OBJIX99  EQU   0                                                        07461000
SPCAREA  EQU   0                                                        07462000
ALLNT    EQU   0                                                        07463000
AMSTP041 EQU   0                                                        07464000
AMSTP042 EQU   0                                                        07465000
AMSTP043 EQU   0                                                        07466000
AMSTP044 EQU   0                                                        07467000
CRA      EQU   0                                                        07468000
DMPTRM   EQU   0                                                        07469000
ENTRE    EQU   0                                                        07470000
ENVIR    EQU   0                                                        07471000
FMFLCNTR EQU   0                                                        07472000
FMFLNAME EQU   0                                                        07473000
IDCIOCO0 EQU   0                                                        07474000
IDCIOIT0 EQU   0                                                        07475000
IDCIOPT0 EQU   0                                                        07476000
IDCIOST0 EQU   0                                                        07477000
IDCIOTM0 EQU   0                                                        07478000
IDCIO050 EQU   0                                                        07479000
IDCSAAL0 EQU   0                                                        07480000
IDCSACA0 EQU   0                                                        07481000
IDCSACL0 EQU   0                                                        07482000
IDCSACR0 EQU   0                                                        07483000
IDCSADE0 EQU   0                                                        07484000
IDCSADL0 EQU   0                                                        07485000
IDCSAFS0 EQU   0                                                        07486000
IDCSAGS0 EQU   0                                                        07487000
IDCSAID0 EQU   0                                                        07488000
IDCSALC0 EQU   0                                                        07489000
IDCSALD0 EQU   0                                                        07490000
IDCSALK0 EQU   0                                                        07491000
IDCSAPR0 EQU   0                                                        07492000
IDCSAPT0 EQU   0                                                        07493000
IDCSAQL0 EQU   0                                                        07494000
IDCSARC0 EQU   0                                                        07495000
IDCSASC0 EQU   0                                                        07496000
IDCSASN0 EQU   0                                                        07497000
IDCSASS0 EQU   0                                                        07498000
IDCSAST0 EQU   0                                                        07499000
IDCSAUC0 EQU   0                                                        07500000
IDCSAWO0 EQU   0                                                        07501000
IDCSA060 EQU   0                                                        07502000
IDCST010 EQU   0                                                        07503000
IDCTPER0 EQU   0                                                        07504000
INDDNM   EQU   0                                                        07505000
LISTTEST EQU   0                                                        07506000
NEWERID1 EQU   5                                                        07507000
NFRC     EQU   0                                                        07508000
NONE     EQU   0                                                        07509000
NONEPTR  EQU   0                                                        07510000
OUT      EQU   0                                                        07511000
OUTDDNM  EQU   0                                                        07512000
PDEVNM   EQU   0                                                        07513000
GDTTBL   EQU   0                                                        07514000
GDTTR1   EQU   GDTTBL+8                                                 07515000
GDTTR2   EQU   GDTTBL+12                                                07516000
GDTDBG   EQU   GDTTBL+40                                                07517000
GDTSTC   EQU   GDTTBL+44                                                07518000
GDTPRT   EQU   GDTTBL+48                                                07519000
GDTESS   EQU   GDTTBL+52                                                07520000
GDTESA   EQU   GDTTBL+56                                                07521000
GDTRST   EQU   GDTTBL+60                                                07522000
GDTRES   EQU   GDTTBL+64                                                07523000
GDTCAL   EQU   GDTTBL+68                                                07524000
GDTGSP   EQU   GDTTBL+72                                                07525000
GDTFSP   EQU   GDTTBL+76                                                07526000
GDTGPL   EQU   GDTTBL+80                                                07527000
GDTFPL   EQU   GDTTBL+84                                                07528000
GDTLOD   EQU   GDTTBL+88                                                07529000
GDTDEL   EQU   GDTTBL+92                                                07530000
GDTPRL   EQU   GDTTBL+96                                                07531000
GDTEPL   EQU   GDTTBL+100                                               07532000
GDTTIM   EQU   GDTTBL+104                                               07533000
GDTIIO   EQU   GDTTBL+108                                               07534000
GDTTIO   EQU   GDTTBL+112                                               07535000
GDTOPN   EQU   GDTTBL+124                                               07536000
GDTCLS   EQU   GDTTBL+128                                               07537000
GDTGET   EQU   GDTTBL+132                                               07538000
GDTPUT   EQU   GDTTBL+136                                               07539000
GDTPOS   EQU   GDTTBL+140                                               07540000
GDTCPY   EQU   GDTTBL+144                                               07541000
GDTCAT   EQU   GDTTBL+148                                               07542000
GDTSNP   EQU   GDTTBL+164                                               07543000
GDTVFY   EQU   GDTTBL+172                                               07544000
GDTECT   EQU   GDTTBL+188                                               07545000
GDTUID   EQU   GDTTBL+192                                               07546000
GDTPMT   EQU   GDTTBL+196                                               07547000
GDTCIR   EQU   GDTTBL+200                                               07548000
GDTLNK   EQU   GDTTBL+204                                               07549000
GDTALC   EQU   GDTTBL+208                                               07550000
GDTDLC   EQU   GDTTBL+212                                               07551000
GDTQAL   EQU   GDTTBL+216                                               07552000
GDTSTW   EQU   GDTTBL+220                                               07553000
GDTSSC   EQU   GDTTBL+224                                               07554000
GDTENQ   EQU   GDTTBL+228                                               07555000
GDTRSV   EQU   GDTTBL+232                                               07556000
GDTDEQ   EQU   GDTTBL+236                                               07557000
GDTSFO   EQU   GDTTBL+240                                               07558000
GDTWTO   EQU   GDTTBL+244                                               07559000
GDTSCR   EQU   GDTTBL+248                                               07560000
GDTUNT   EQU   GDTTBL+252                                               07561000
GDTRCT   EQU   GDTTBL+256                                               07562000
GDTIFO   EQU   GDTTBL+260                                               07563000
GDTEXP   EQU   GDTTBL+264                                               07564000
GDTSTA   EQU   GDTTBL+268                                               07565000
GDTERR   EQU   GDTTBL+272                                               07566000
GDTUNC   EQU   GDTTBL+276                                               07567000
GDTLOC   EQU   GDTTBL+280                                               07568000
FDTTBL   EQU   0                                                        07569000
FDTPTR   EQU   FDTTBL+8                                                 07570000
LASTCC   EQU   0                                                        07571000
PARMNAM  EQU   0                                                        07572000
PARMNOS  EQU   0                                                        07573000
CPARM4   EQU   0                                                        07574000
KPARM4   EQU   0                                                        07575000
PARMDSN  EQU   0                                                        07576000
DSNAMPTR EQU   0                                                        07577000
DPARM4   EQU   0                                                        07578000
EPARM4   EQU   0                                                        07579000
PPARM4   EQU   0                                                        07580000
FLDNO    EQU   0                                                        07581000
FLD0     EQU   0                                                        07582000
FLDI1    EQU   0                                                        07583000
FLDI2    EQU   0                                                        07584000
FLD01    EQU   0                                                        07585000
FLD02    EQU   0                                                        07586000
FLD1     EQU   0                                                        07587000
FLD1A    EQU   0                                                        07588000
FLD2     EQU   0                                                        07589000
FLD3     EQU   0                                                        07590000
FLD3A    EQU   0                                                        07591000
FLD4     EQU   0                                                        07592000
FLD5     EQU   0                                                        07593000
MESSAGE0 EQU   0                                                        07594000
MESSAGE1 EQU   0                                                        07595000
MESSAGE2 EQU   0                                                        07596000
MESSAGE3 EQU   0                                                        07597000
MESSAGE4 EQU   0                                                        07598000
MESSAGE5 EQU   0                                                        07599000
NPARM4   EQU   0                                                        07600000
OBJCI    EQU   0                                                        07601000
OBJVOLSR EQU   0                                                        07602000
OPARM4   EQU   0                                                        07603000
OPARM5   EQU   0                                                        07604000
PARM2    EQU   0                                                        07605000
PARM4    EQU   0                                                        07606000
PARM5    EQU   0                                                        07607000
SPARM4   EQU   0                                                        07608000
SPCTYPE  EQU   0                                                        07609000
SPSIZ    EQU   0                                                        07610000
SPADR    EQU   0                                                        07611000
YPARM4   EQU   0                                                        07612000
TPARM4   EQU   0                                                        07613000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    07614000
FDTVERB  EQU   FDTTBL                                                   07615000
GDTPSB   EQU   GDTTBL+184                                               07616000
GDTUPT   EQU   GDTTBL+180                                               07617000
GDTCMB   EQU   GDTTBL+176                                               07618000
GDTSPR   EQU   GDTTBL+168                                               07619000
@NM00001 EQU   GDTTBL+160                                               07620000
GDTABH   EQU   GDTTBL+156                                               07621000
GDTABT   EQU   GDTTBL+152                                               07622000
GDTTOH   EQU   GDTTBL+120                                               07623000
GDTRIP   EQU   GDTTBL+116                                               07624000
GDTIOH   EQU   GDTTBL+36                                                07625000
GDTSAH   EQU   GDTTBL+32                                                07626000
GDTTPH   EQU   GDTTBL+28                                                07627000
GDTRIH   EQU   GDTTBL+24                                                07628000
GDTSTH   EQU   GDTTBL+20                                                07629000
GDTDBH   EQU   GDTTBL+16                                                07630000
GDTPRM   EQU   GDTTBL+4                                                 07631000
GDTHDR   EQU   GDTTBL                                                   07632000
@NM00059 EQU   KCHAR                                                    07633000
@NM00054 EQU   RECNEXCI                                                 07634000
@NM00053 EQU   RECORD1+45                                               07635000
@NM00052 EQU   RECORD1+11                                               07636000
RECVOLSR EQU   RECORD1+5                                                07637000
@NM00051 EQU   RECORD1+4                                                07638000
@NM00050 EQU   RECORD1                                                  07639000
@NM00049 EQU   NBLK+22                                                  07640000
@NM00047 EQU   TMSDT+4                                                  07641000
@NM00046 EQU   TMSDT+2                                                  07642000
TMSOLDTS EQU   TMSTS+4                                                  07643000
@NM00045 EQU   TMSHDR+2                                                 07644000
TMSTSCD  EQU   TMSHDR                                                   07645000
VGOAREAU EQU   VGOS                                                     07646000
@NM00043 EQU   VGOEXT+6                                                 07647000
@NM00042 EQU   VGOEXT+1                                                 07648000
@NM00041 EQU   CRVENTY+24                                               07649000
@NM00040 EQU   CRVENTY+21                                               07650000
CRVSYCHK EQU   CRVIND                                                   07651000
ENTDNLEN EQU   ENTDN                                                    07652000
ENTNMLEN EQU   ENTNM+20                                                 07653000
ENTNMMEM EQU   ENTNM+12                                                 07654000
ENTNMMLN EQU   ENTNM+11                                                 07655000
ENTNMFUQ EQU   ENTNMFLG                                                 07656000
ENTNMPOS EQU   ENTNM+9                                                  07657000
ENTNMPAS EQU   ENTNM+1                                                  07658000
ENTNMPLN EQU   ENTNM                                                    07659000
OUTDDLEN EQU   OUTDD                                                    07660000
PDEVLEN  EQU   PDEV                                                     07661000
MRPWLEN  EQU   MRPW                                                     07662000
IFILELEN EQU   IFILE                                                    07663000
CRADDLEN EQU   CRADD                                                    07664000
@NM00039 EQU   OUTFLGS                                                  07665000
OPNFLG   EQU   OUTFLGS                                                  07666000
RESOUTP  EQU   OUTDAT+12                                                07667000
SAVOIOCS EQU   OUTDAT+4                                                 07668000
RESINP   EQU   ENTOBJ+4                                                 07669000
AMDEXCP  EQU   AMDSTAT+44                                               07670000
AMDNCAS  EQU   AMDSTAT+40                                               07671000
AMDNCIS  EQU   AMDSTAT+36                                               07672000
AMDASPA  EQU   AMDSTAT+32                                               07673000
AMDRETR  EQU   AMDSTAT+28                                               07674000
AMDUPR   EQU   AMDSTAT+24                                               07675000
AMDIREC  EQU   AMDSTAT+20                                               07676000
AMDDELR  EQU   AMDSTAT+16                                               07677000
AMDNLR   EQU   AMDSTAT+12                                               07678000
AMDNEXT  EQU   AMDSTAT+10                                               07679000
AMDNIL   EQU   AMDSTAT+8                                                07680000
AMDSTSP  EQU   AMDSTAT                                                  07681000
@NM00038 EQU   IDAAMDSB+41                                              07682000
@NM00037 EQU   AMDATTR3                                                 07683000
AMDLM    EQU   AMDATTR3                                                 07684000
AMDWAIT  EQU   AMDATTR3                                                 07685000
AMDBIND  EQU   AMDATTR3                                                 07686000
AMDFAULT EQU   AMDATTR3                                                 07687000
AMDUNQ   EQU   AMDATTR3                                                 07688000
AMDPARDB EQU   IDAAMDSB+36                                              07689000
AMDMAXRR EQU   AMDSSRBA                                                 07690000
AMDNSLOT EQU   AMDHLRBA                                                 07691000
AMDLRECL EQU   IDAAMDSB+24                                              07692000
AMDCINV  EQU   IDAAMDSB+20                                              07693000
AMDFSCI  EQU   IDAAMDSB+16                                              07694000
AMDFSCA  EQU   IDAAMDSB+14                                              07695000
AMDCIPCA EQU   IDAAMDSB+12                                              07696000
AMDPCTCI EQU   IDAAMDSB+11                                              07697000
AMDPCTCA EQU   IDAAMDSB+10                                              07698000
AMDKEYLN EQU   IDAAMDSB+8                                               07699000
AMDRKP   EQU   IDAAMDSB+6                                               07700000
AMDAXRKP EQU   AMDNEST                                                  07701000
AMDLEN   EQU   IDAAMDSB+2                                               07702000
AMDSPAN  EQU   AMDATTR                                                  07703000
AMDRANGE EQU   AMDATTR                                                  07704000
AMDORDER EQU   AMDATTR                                                  07705000
AMDREPL  EQU   AMDATTR                                                  07706000
AMDSDT   EQU   AMDATTR                                                  07707000
AMDWCK   EQU   AMDATTR                                                  07708000
AMDDST   EQU   AMDATTR                                                  07709000
AMDSBID  EQU   IDAAMDSB                                                 07710000
BUFAREA  EQU   BUFELM+8                                                 07711000
BUFNEXT  EQU   BUFELM+4                                                 07712000
BUFCI    EQU   BUFELM+1                                                 07713000
@NM00036 EQU   BUFELM                                                   07714000
@NM00035 EQU   BUFSWS                                                   07715000
BUFPL    EQU   BUFS+4                                                   07716000
FMFLWKAR EQU   FMFL+4                                                   07717000
FMFLSUCC EQU   FMFLINDS                                                 07718000
@NM00034 EQU   FMFLINDS                                                 07719000
@NM00033 EQU   FMPL+17                                                  07720000
@NM00032 EQU   ACC+4                                                    07721000
@NM00031 EQU   DMPARY+15                                                07722000
DMPARYTP EQU   DMPARY+14                                                07723000
DMPARYEX EQU   DMPARY+12                                                07724000
DMPARYIC EQU   DMPARY+10                                                07725000
DMPARYSZ EQU   DMPARY+8                                                 07726000
DMPARYNM EQU   DMPARY                                                   07727000
@NM00030 EQU   DMPITM+15                                                07728000
DMPITMTP EQU   DMPITM+14                                                07729000
DMPITMLN EQU   DMPITM+12                                                07730000
DMPITMPT EQU   DMPITM+8                                                 07731000
DMPITMNM EQU   DMPITM                                                   07732000
@NM00029 EQU   ERCNVTAB+24                                              07733000
ERDARBPT EQU   ERCPLPT                                                  07734000
ERDYNRC  EQU   ERCATRC                                                  07735000
ERDSNM   EQU   ERCNVTAB+12                                              07736000
@NM00028 EQU   ERCNVTAB+4                                               07737000
@NM00027 EQU   ERCNVTAB+3                                               07738000
@NM00026 EQU   EROSOPER                                                 07739000
EROSUCDX EQU   EROSOPER                                                 07740000
EROSCATL EQU   EROSOPER                                                 07741000
@NM00025 EQU   EROPER                                                   07742000
ERCATAL  EQU   EROPER                                                   07743000
ERCATDL  EQU   EROPER                                                   07744000
ERCATDE  EQU   EROPER                                                   07745000
ERCATLC  EQU   EROPER                                                   07746000
@NM00024 EQU   ERTYPE                                                   07747000
ERDYNAL  EQU   ERTYPE                                                   07748000
EROSCAT  EQU   ERTYPE                                                   07749000
ERCATLG  EQU   ERTYPE                                                   07750000
@NM00023 EQU   FMTCNVF+1                                                07751000
FMTAR    EQU   FMTCNVF+1                                                07752000
FMTBS    EQU   FMTCNVF+1                                                07753000
FMTSS    EQU   FMTCNVF+1                                                07754000
FMTAL    EQU   FMTCNVF+1                                                07755000
FMTZS    EQU   FMTCNVF+1                                                07756000
@NM00022 EQU   FMTCNVF                                                  07757000
FMTPU    EQU   FMTCNVF                                                  07758000
FMTBD    EQU   FMTCNVF                                                  07759000
FMTBHD   EQU   FMTCNVF                                                  07760000
FMTBHA   EQU   FMTCNVF                                                  07761000
FMTBH    EQU   FMTCNVF                                                  07762000
FMTOLEN  EQU   FMTLIST+8                                                07763000
FMTRIO   EQU   FMTOCOL                                                  07764000
FMTSPT   EQU   FMTSTO                                                   07765000
FMTSTL   EQU   FMTILEN                                                  07766000
@NM00021 EQU   FMTFLGS+1                                                07767000
FMTSMSG  EQU   FMTFLGS+1                                                07768000
FMTHDF   EQU   FMTFLGS                                                  07769000
FMTDFF   EQU   FMTFLGS                                                  07770000
FMTSTF   EQU   FMTFLGS                                                  07771000
FMTREPF  EQU   FMTFLGS                                                  07772000
FMTBDF   EQU   FMTFLGS                                                  07773000
FMTIDF   EQU   FMTFLGS                                                  07774000
FMTSCF   EQU   FMTFLGS                                                  07775000
FMTEOLF  EQU   FMTFLGS                                                  07776000
DARGPCT  EQU   DARGINL                                                  07777000
DARGREP  EQU   DARGINS                                                  07778000
@NM00020 EQU   DARGFLGS                                                 07779000
DARGFULL EQU   DARGFLGS                                                 07780000
UVOLVOL  EQU   UVOLENT+4                                                07781000
UVOLDEV  EQU   UVOLENT                                                  07782000
UVOLCNT  EQU   UVOLLIST                                                 07783000
@NM00019 EQU   IOINFOPT                                                 07784000
IOINFLUB EQU   IOINFOPT                                                 07785000
IOINFSUP EQU   IOINFOPT                                                 07786000
IOINFDSN EQU   IOINFOPT                                                 07787000
OPNVOL   EQU   OPNAGL+44                                                07788000
OPNSTRNO EQU   OPNAGL+43                                                07789000
@NM00018 EQU   OPNOPT2                                                  07790000
OPNOPTJM EQU   OPNOPT2                                                  07791000
OPNOPTNM EQU   OPNOPT2                                                  07792000
OPNOPTAS EQU   OPNOPT2                                                  07793000
@NM00017 EQU   OPNDSO                                                   07794000
OPNDSOPO EQU   OPNDSO                                                   07795000
OPNDSOIS EQU   OPNDSO                                                   07796000
OPNDSOPS EQU   OPNDSO                                                   07797000
OPNKYL   EQU   OPNAGL+40                                                07798000
OPNBLK   EQU   OPNAGL+36                                                07799000
OPNREC   EQU   OPNAGL+32                                                07800000
OPNDEVIX EQU   OPNDEV+4                                                 07801000
OPNDEVDT EQU   OPNDEV                                                   07802000
OPNCBP   EQU   OPNAGL+20                                                07803000
OPNDSN   EQU   OPNAGL+16                                                07804000
OPNMODRP EQU   OPNMOD                                                   07805000
OPNMODUB EQU   OPNMOD                                                   07806000
OPNMODRS EQU   OPNMOD                                                   07807000
OPNMODAX EQU   OPNMOD                                                   07808000
OPNMODRR EQU   OPNMOD                                                   07809000
OPNMODRC EQU   OPNMOD                                                   07810000
OPNMODAC EQU   OPNMOD                                                   07811000
OPNMODPD EQU   OPNMOD                                                   07812000
OPNTYPSY EQU   OPNTYP                                                   07813000
OPNTYPRV EQU   OPNTYP                                                   07814000
OPNTYPEX EQU   OPNTYP                                                   07815000
OPNTYPXM EQU   OPNTYP                                                   07816000
OPNTYPCI EQU   OPNTYP                                                   07817000
OPNTYPSO EQU   OPNTYP                                                   07818000
OPNTYPSI EQU   OPNTYP                                                   07819000
@NM00016 EQU   OPNRFM                                                   07820000
OPNRFMBK EQU   OPNRFM                                                   07821000
OPNRFMSF EQU   OPNRFM                                                   07822000
OPNRFMUN EQU   OPNRFM                                                   07823000
OPNRFMVR EQU   OPNRFM                                                   07824000
OPNRFMFX EQU   OPNRFM                                                   07825000
OPNOPTSK EQU   OPNOPT                                                   07826000
OPNOPTKS EQU   OPNOPT                                                   07827000
OPNOPTUP EQU   OPNOPT                                                   07828000
OPNOPTOT EQU   OPNOPT                                                   07829000
IOCEXT   EQU   IOCSTR+64                                                07830000
IOCTSML  EQU   IOCREL+2                                                 07831000
IOCTPML  EQU   IOCREL                                                   07832000
IOCWORK  EQU   IOCSTR+56                                                07833000
IOCRRN   EQU   IOCSTR+52                                                07834000
IOCPNM   EQU   IOCNWM+2                                                 07835000
IOCPTL   EQU   IOCNWM                                                   07836000
IOCKYA   EQU   IOCMEM                                                   07837000
IOCVRC   EQU   IOCTTR                                                   07838000
IOCCBP   EQU   IOCSTR+36                                                07839000
IOCDSN   EQU   IOCSTR+32                                                07840000
IOCHURBA EQU   IOCSTR+28                                                07841000
IOCVOLSR EQU   IOCSTR+22                                                07842000
@NM00015 EQU   IOCMSG                                                   07843000
IOCMSGSM EQU   IOCMSG                                                   07844000
IOCMSGAE EQU   IOCMSG                                                   07845000
IOCMSGCE EQU   IOCMSG                                                   07846000
IOCMSGOE EQU   IOCMSG                                                   07847000
IOCCHPKG EQU   IOCMSG                                                   07848000
IOCCHPKE EQU   IOCMSG                                                   07849000
IOCCHPNU EQU   IOCCHP                                                   07850000
IOCCHPUP EQU   IOCCHP                                                   07851000
IOCCHPBK EQU   IOCCHP                                                   07852000
IOCCHPCR EQU   IOCCHP                                                   07853000
IOCCHPKS EQU   IOCCHP                                                   07854000
IOCCHPSK EQU   IOCCHP                                                   07855000
IOCMACNT EQU   IOCMAC2                                                  07856000
IOCMACER EQU   IOCMAC2                                                  07857000
IOCMACPA EQU   IOCMAC2                                                  07858000
IOCMACEN EQU   IOCMAC2                                                  07859000
IOCMACCP EQU   IOCMAC2                                                  07860000
IOCMACRR EQU   IOCMAC2                                                  07861000
IOCMACAS EQU   IOCMAC2                                                  07862000
IOCMACSK EQU   IOCMAC2                                                  07863000
@NM00014 EQU   IOCMAC                                                   07864000
IOCMACCC EQU   IOCMAC                                                   07865000
IOCMACDR EQU   IOCMAC                                                   07866000
IOCMACBK EQU   IOCMAC                                                   07867000
IOCMACCR EQU   IOCMAC                                                   07868000
IOCMACUP EQU   IOCMAC                                                   07869000
IOCMACOT EQU   IOCMAC                                                   07870000
IOCMACIN EQU   IOCMAC                                                   07871000
@NM00013 EQU   IOCRFM                                                   07872000
IOCRFMBK EQU   IOCRFM                                                   07873000
IOCRFMSF EQU   IOCRFM                                                   07874000
IOCRFMUN EQU   IOCRFM                                                   07875000
IOCRFMVR EQU   IOCRFM                                                   07876000
IOCRFMFX EQU   IOCRFM                                                   07877000
@NM00012 EQU   IOCDSO                                                   07878000
IOCDSOPO EQU   IOCDSO                                                   07879000
IOCDSOIS EQU   IOCDSO                                                   07880000
IOCDSOPS EQU   IOCDSO                                                   07881000
IOCDSOAM EQU   IOCDSO                                                   07882000
IOCRKP   EQU   IOCSTR+13                                                07883000
IOCKYL   EQU   IOCSTR+12                                                07884000
IOCTRN   EQU   IOCSTR+8                                                 07885000
IOCDLN   EQU   IOCSTR+4                                                 07886000
UNITVTOC EQU   UNITABL+7                                                07887000
@NM00011 EQU   UNITSTAT                                                 07888000
UNITUSHR EQU   UNITSTAT                                                 07889000
UNITXSHR EQU   UNITSTAT                                                 07890000
UNITISHR EQU   UNITSTAT                                                 07891000
UNITUA   EQU   @NM00010+1                                               07892000
UNITCHA  EQU   @NM00010                                                 07893000
ALLUNCNT EQU   ALLAGL+30                                                07894000
ALLVLCNT EQU   ALLAGL+29                                                07895000
@NM00009 EQU   ALLOPT                                                   07896000
ALLOPTUN EQU   ALLOPT                                                   07897000
ALLOPTPV EQU   ALLOPT                                                   07898000
ALLOPTDS EQU   ALLOPT                                                   07899000
ALLOPTVL EQU   ALLOPT                                                   07900000
@NM00008 EQU   ALLORG+1                                                 07901000
ALLORGVS EQU   ALLORG+1                                                 07902000
@NM00007 EQU   ALLORG+1                                                 07903000
ALLORGGS EQU   ALLORG+1                                                 07904000
ALLORGUN EQU   ALLORG                                                   07905000
ALLORGPO EQU   ALLORG                                                   07906000
ALLORGMQ EQU   ALLORG                                                   07907000
ALLORGCQ EQU   ALLORG                                                   07908000
ALLORGCX EQU   ALLORG                                                   07909000
ALLORGDA EQU   ALLORG                                                   07910000
ALLORGPS EQU   ALLORG                                                   07911000
ALLORGIS EQU   ALLORG                                                   07912000
ALLDSPUN EQU   ALLDSP                                                   07913000
ALLDSPCG EQU   ALLDSP                                                   07914000
ALLDSPDE EQU   ALLDSP                                                   07915000
ALLDSPKP EQU   ALLDSP                                                   07916000
@NM00006 EQU   ALLDSP                                                   07917000
ALLSTSOD EQU   ALLSTS                                                   07918000
ALLSTSMD EQU   ALLSTS                                                   07919000
ALLSTSNW EQU   ALLSTS                                                   07920000
ALLSTSSR EQU   ALLSTS                                                   07921000
@NM00005 EQU   ALLSTS                                                   07922000
ALLPWD   EQU   ALLAGL+20                                                07923000
ALLVLP   EQU   ALLAGL+16                                                07924000
ALLULP   EQU   ALLAGL+12                                                07925000
ALLDDN   EQU   ALLAGL+4                                                 07926000
ALLDSN   EQU   ALLAGL                                                   07927000
CIRPID   EQU   CIRAGL+28                                                07928000
CIRPWD   EQU   CIRAGL+24                                                07929000
CIRCAT   EQU   CIRAGL+20                                                07930000
CIRWKP   EQU   CIRAGL+16                                                07931000
CIRTLR   EQU   CIRAGL+12                                                07932000
CIRHDR   EQU   CIRAGL+8                                                 07933000
CIRTLN   EQU   CIRAGL+6                                                 07934000
CIRHLN   EQU   CIRAGL+4                                                 07935000
@NM00004 EQU   CIRAGL+1                                                 07936000
@NM00003 EQU   CIRTYPE                                                  07937000
CIRTYPAQ EQU   CIRTYPE                                                  07938000
CIRTYP1Q EQU   CIRTYPE                                                  07939000
NEWID1   EQU   TRACE1+95                                                07940000
CALLID   EQU   OLDERID1+90                                              07941000
@NM00002 EQU   OLDERID1                                                 07942000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      07943000
@RC00428 EQU   @RC00427                                                 07944000
@RT00440 EQU   @RC00423                                                 07945000
@RT00501 EQU   @EL00004                                                 07946000
@RC00530 EQU   @EL00004                                                 07947000
@RC00511 EQU   @EL00004                                                 07948000
@RC00506 EQU   @EL00004                                                 07949000
@RT00573 EQU   @RC00570                                                 07950000
@RC00614 EQU   @RC00611                                                 07951000
@RC00670 EQU   @EL00007                                                 07952000
@RC00751 EQU   @EL00009                                                 07953000
@RC00763 EQU   @EL00009                                                 07954000
@RT00841 EQU   @RC00840                                                 07955000
@RT00846 EQU   @RC00845                                                 07956000
@RC00854 EQU   @RC00852                                                 07957000
@RC00863 EQU   @RC00858                                                 07958000
@RC00872 EQU   @RC00867                                                 07959000
@RC01018 EQU   @RC01017                                                 07960000
@RC01063 EQU   @RC01060                                                 07961000
@RC01058 EQU   @EL00015                                                 07962000
@RC01193 EQU   @RC01176                                                 07963000
@RT01191 EQU   @RC01176                                                 07964000
@RC01257 EQU   @RC01254                                                 07965000
@RC01251 EQU   @EL00017                                                 07966000
@RT01273 EQU   @EL00017                                                 07967000
@RC01285 EQU   @EL00017                                                 07968000
@RC01351 EQU   @RC01347                                                 07969000
@RC01421 EQU   @RC01413                                                 07970000
@RT01486 EQU   @RC01471                                                 07971000
@RC01541 EQU   @EL00023                                                 07972000
@PB00023 EQU   @EL00001                                                 07973000
@RT00617 EQU   @RC00614                                                 07974000
@RC00673 EQU   @RC00670                                                 07975000
@RT00699 EQU   @RC00670                                                 07976000
@RC01079 EQU   @RC01058                                                 07977000
@RT01212 EQU   @RC01193                                                 07978000
@RC01288 EQU   @RC01285                                                 07979000
@RC01543 EQU   @RC01541                                                 07980000
@RC00678 EQU   @RC00673                                                 07981000
@RC01082 EQU   @RC01079                                                 07982000
@RC01550 EQU   @RC01543                                                 07983000
@RC00681 EQU   @RC00678                                                 07984000
@RT01553 EQU   @RC01550                                                 07985000
@RT00683 EQU   @RC00681                                                 07986000
@ENDDATA EQU   *                                                        07987000
         END   IDCRC01,(C'PLS1314',0701,77332)                          07988000
