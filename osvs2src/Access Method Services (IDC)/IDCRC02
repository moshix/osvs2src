         TITLE '****** IDCRC02: EXPORTRA/EXPORT FUNCTION SUPPORT ROUTIN*00001000
               NE ******'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCRC02  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCRC02   77.235'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @11,4095(,@12)                                      0002 00022000
         LA    @10,4095(,@11)                                      0002 00023000
         LA    @09,4095(,@10)                                      0002 00024000
         USING @PSTART,@12                                         0002 00025000
         USING @PSTART+4095,@11                                    0002 00026000
         USING @PSTART+8190,@10                                    0002 00027000
         USING @PSTART+12285,@09                                   0002 00028000
         L     @00,@SIZDATD                                        0002 00029000
         GETMAIN  R,LV=(0)                                              00030000
         LR    @08,@01                                             0002 00031000
         USING @DATD,@08                                           0002 00032000
         ST    @13,@SA00001+4                                      0002 00033000
         LM    @00,@01,20(@13)                                     0002 00034000
         ST    @08,8(,@13)                                         0002 00035000
         LR    @13,@08                                             0002 00036000
         MVC   @PC00001(8),0(@01)                                  0002 00037000
*                                                                  0260 00038000
*                                                                  0260 00039000
*        /************************************************************/ 00040000
*        /*                                                          */ 00041000
*        /*   THIS IS THE HIGHEST LEVEL OF PROCESSING FOR THE        */ 00042000
*        /*   EXPORT ROUTINE.  THIS SECTION DETERMINES WHETHER A     */ 00043000
*        /*   NON VSAM OR A GDG OR A CLUSTER OR AIX IS TO BE EXPORTED*/ 00044000
*        /*   AND CALLS THE CORRESPONDING OBJECT PROCESSOR.          */ 00045000
*        /*   TERMINATION PROCESSING IS ALSO HANDLED IN THIS SECTION,*/ 00046000
*        /*                                                          */ 00047000
*        /************************************************************/ 00048000
*                                                                  0260 00049000
*        OLDERID2 = NEWERID2;                                      0260 00050000
         L     @15,@PC00001                                        0260 00051000
         L     @14,GDTTR2(,@15)                                    0260 00052000
         MVC   @TS00001(95),NEWERID2(@14)                          0260 00053000
         MVC   OLDERID2(95,@14),@TS00001                           0260 00054000
*        NEWID2 = 'RC01';                                          0261 00055000
*                                                                  0261 00056000
         MVC   NEWID2(4,@14),@CC01043                              0261 00057000
*        IF GDTDBG = NULLPTR                                       0262 00058000
*          THEN;                                                   0262 00059000
         L     @15,GDTDBG(,@15)                                    0262 00060000
         LTR   @15,@15                                             0262 00061000
         BZ    @RT00262                                            0262 00062000
*          ELSE                                                    0264 00063000
*            CALL IDCDB010 (GDTTBL,'RC02');                        0264 00064000
*                                                                  0264 00065000
         L     @15,@PC00001                                        0264 00066000
         ST    @15,@AL00001                                        0264 00067000
         LA    @14,@CC00814                                        0264 00068000
         ST    @14,@AL00001+4                                      0264 00069000
         MVI   @AL00001+4,X'80'                                    0264 00070000
         L     @15,GDTDBG(,@15)                                    0264 00071000
         LA    @01,@AL00001                                        0264 00072000
         BALR  @14,@15                                             0264 00073000
*        SETRC = 0;                                                0265 00074000
*                                                                  0265 00075000
@RT00262 SLR   SETRC,SETRC                                         0265 00076000
*        /************************************************************/ 00077000
*        /*                                                          */ 00078000
*        /*  INITIALIZE STORAGE AREA FOR UPRINT ARGUMENT LISTS       */ 00079000
*        /*                                                          */ 00080000
*        /************************************************************/ 00081000
*                                                                  0266 00082000
*        DO I= 1 TO 9;                                             0266 00083000
         LA    I,1                                                 0266 00084000
@DL00266 DS    0H                                                  0267 00085000
*          PRINTTAB(I) = NULLPTR;                                  0267 00086000
         LR    @05,I                                               0267 00087000
         SLA   @05,2                                               0267 00088000
         SLR   @02,@02                                             0267 00089000
         ST    @02,PRINTTAB-4(@05)                                 0267 00090000
*        END;                                                      0268 00091000
*                                                                  0268 00092000
         AL    I,@CF00218                                          0268 00093000
         C     I,@CF00037                                          0268 00094000
         BNH   @DL00266                                            0268 00095000
*        DDSTRU = ADDR(PRINTTAB);                                  0269 00096000
         LA    @02,PRINTTAB                                        0269 00097000
         ST    @02,DDSTRU                                          0269 00098000
*        DARGLIST = ''B;                                           0270 00099000
*                                                                  0270 00100000
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0270 00101000
*        /************************************************************/ 00102000
*        /*                                                          */ 00103000
*        /* INITIALIZE THE MAXIMUM RECORDSIZE AND INPUT IOCS POINTER */ 00104000
*        /*                                                          */ 00105000
*        /************************************************************/ 00106000
*                                                                  0271 00107000
*        RECSZ = OUTLEN;                                           0271 00108000
         L     @02,@PC00001+4                                      0271 00109000
         L     @02,INPPTR(,@02)                                    0271 00110000
         L     @02,INPTBL+4(,@02)                                  0271 00111000
         L     @15,OUTLEN(,@02)                                    0271 00112000
         ST    @15,RECSZ                                           0271 00113000
*        PINIOCS = NULLPTR;                                        0272 00114000
*                                                                  0272 00115000
         SLR   @15,@15                                             0272 00116000
         ST    @15,PINIOCS                                         0272 00117000
*        /************************************************************/ 00118000
*        /*                                                          */ 00119000
*        /*  DETERMINE IF FIRST REQUEST.                             */ 00120000
*        /*  OPEN OUTPUT DATA SET ON FIRST REQUEST ONLY,             */ 00121000
*        /*   AND INITIALIZE OUTPUT BLOCKSIZE                        */ 00122000
*        /*                                                          */ 00123000
*        /************************************************************/ 00124000
*                                                                  0273 00125000
*        IF OPNFLG = OFF                                           0273 00126000
*          THEN                                                    0273 00127000
         TM    OPNFLG(@02),B'10000000'                             0273 00128000
         BNZ   @RF00273                                            0273 00129000
*FSTREQ:     DO;                                                   0274 00130000
*                                                                  0274 00131000
FSTREQ   DS    0H                                                  0275 00132000
*            POUTIOCS = NULLPTR;                                   0275 00133000
         SLR   @02,@02                                             0275 00134000
         ST    @02,POUTIOCS                                        0275 00135000
*            BLKSZ = USBKSZ;                                       0276 00136000
*                                                                  0276 00137000
         L     @02,@PC00001+4                                      0276 00138000
         L     @02,INPPTR(,@02)                                    0276 00139000
         L     @01,INPTBL+4(,@02)                                  0276 00140000
         L     @15,USBKSZ(,@01)                                    0276 00141000
         ST    @15,BLKSZ                                           0276 00142000
*            /********************************************************/ 00143000
*            /*                                                      */ 00144000
*            /*  OPEN OUTPUT DATA SET - THE PORTABILITY DATA SET     */ 00145000
*            /*                                                      */ 00146000
*            /********************************************************/ 00147000
*                                                                  0277 00148000
*            CALL OPENPROC('O',ADDR(OUTDDNM),NULLPARM,RECSZ,BLKSZ, 0277 00149000
*             ADDR(POUTIOCS));                                     0277 00150000
*                                                                  0277 00151000
         LA    @15,@CC01048                                        0277 00152000
         ST    @15,@AL00001                                        0277 00153000
         LA    @02,INPTBL+12(,@02)                                 0277 00154000
         ST    @02,@AL00001+4                                      0277 00155000
         LA    @02,NULLPARM                                        0277 00156000
         ST    @02,@AL00001+8                                      0277 00157000
         LA    @02,RECSZ                                           0277 00158000
         ST    @02,@AL00001+12                                     0277 00159000
         LA    @02,BLKSZ                                           0277 00160000
         ST    @02,@AL00001+16                                     0277 00161000
         LA    @02,POUTIOCS                                        0277 00162000
         ST    @02,@AFTEMPS+16                                     0277 00163000
         LA    @02,@AFTEMPS+16                                     0277 00164000
         ST    @02,@AL00001+20                                     0277 00165000
         LA    @01,@AL00001                                        0277 00166000
         BAL   @14,OPENPROC                                        0277 00167000
*            /********************************************************/ 00168000
*            /*                                                      */ 00169000
*            /* TEST FOR SUCCESSFUL OPEN.  IF OPEN UNSUCCESSFUL      */ 00170000
*            /* RETURN TO CALLING PROCESSOR WITH ERROR INDICATED     */ 00171000
*            /*                                                      */ 00172000
*            /********************************************************/ 00173000
*                                                                  0278 00174000
*            RESPECIFY RTNREG RSTD;                                0278 00175000
*            TESTRC = RTNREG;                                      0279 00176000
         LR    TESTRC,RTNREG                                       0279 00177000
*            RESPECIFY RTNREG UNRSTD;                              0280 00178000
*            IF TESTRC ^= 0                                        0281 00179000
*              THEN                                                0281 00180000
         LTR   TESTRC,TESTRC                                       0281 00181000
         BZ    @RF00281                                            0281 00182000
*                SETRC = LASTCC16;                                 0282 00183000
         LA    SETRC,16                                            0282 00184000
*              ELSE                                                0283 00185000
*                DO;                                               0283 00186000
*                                                                  0283 00187000
         B     @RC00281                                            0283 00188000
@RF00281 DS    0H                                                  0284 00189000
*                /****************************************************/ 00190000
*                /*                                                  */ 00191000
*                /* SAVE POINTER TO IOCS FOR THE OUTPUT DATA SET     */ 00192000
*                /*                                                  */ 00193000
*                /****************************************************/ 00194000
*                                                                  0284 00195000
*                SAVOIOCS = POUTIOCS;                              0284 00196000
*                                                                  0284 00197000
         L     @15,@PC00001+4                                      0284 00198000
         L     @01,INPPTR(,@15)                                    0284 00199000
         L     @01,INPTBL+4(,@01)                                  0284 00200000
         L     @00,POUTIOCS                                        0284 00201000
         ST    @00,SAVOIOCS(,@01)                                  0284 00202000
*                /****************************************************/ 00203000
*                /*                                                  */ 00204000
*                /* WRITE SPECIAL HEADER CONTAINING RECORDSIZE       */ 00205000
*                /*                                                  */ 00206000
*                /****************************************************/ 00207000
*                                                                  0285 00208000
*                /****************************************************/ 00209000
*                /*                                                  */ 00210000
*                /*GET AN AREA FOR THE CONTROL RECORD OUTPUT BUFFER  */ 00211000
*                /* IF CORE NOT OBTAINED, RETURN TO CALLING PROCESSOR*/ 00212000
*                /*                                                  */ 00213000
*                /****************************************************/ 00214000
*                                                                  0285 00215000
*                CALL IDCSAGP0 (GDTTBL,LENGTH(HEADER),CONRCPTR,GPID,    00216000
*                  SETZERO);                                       0285 00217000
*                                                                  0285 00218000
         MVC   @AL00001+4(16),@AL00285                             0285 00219000
         L     @15,@PC00001                                        0285 00220000
         ST    @15,@AL00001                                        0285 00221000
         LA    @14,CONRCPTR                                        0285 00222000
         ST    @14,@AL00001+8                                      0285 00223000
         L     @15,GDTGPL(,@15)                                    0285 00224000
         LA    @01,@AL00001                                        0285 00225000
         BALR  @14,@15                                             0285 00226000
*                RESPECIFY RTNREG RSTD;                            0286 00227000
*                TESTRC = RTNREG;                                  0287 00228000
         LR    TESTRC,RTNREG                                       0287 00229000
*                RESPECIFY RTNREG UNRSTD;                          0288 00230000
*                IF TESTRC ^= 0                                    0289 00231000
*                  THEN                                            0289 00232000
         LTR   TESTRC,TESTRC                                       0289 00233000
         BZ    @RF00289                                            0289 00234000
*                    DO;                                           0290 00235000
*                    DARGSMOD = UNIVMSG;                           0291 00236000
         L     @02,DDSTRU                                          0291 00237000
         MVC   DARGSMOD(3,@02),@CC00847                            0291 00238000
*                    DARGSENT = NOSTORAG;                          0292 00239000
         MVI   DARGSENT(@02),X'04'                                 0292 00240000
*                    SETRC = LASTCC16;                             0293 00241000
         LA    SETRC,16                                            0293 00242000
*                    END;                                          0294 00243000
*                                                                  0294 00244000
*                  ELSE                                            0295 00245000
*                    DO;                                           0295 00246000
         B     @RC00289                                            0295 00247000
@RF00289 DS    0H                                                  0296 00248000
*                    HEADLN = LENGTH(HEADER);                      0296 00249000
         L     @02,CONRCPTR                                        0296 00250000
         LA    @15,8                                               0296 00251000
         STH   @15,HEADLN(,@02)                                    0296 00252000
*                    HEADFLG1 = HDFL1HED;                          0297 00253000
         MVI   HEADFLG1(@02),X'03'                                 0297 00254000
*                    HEADFLG2 = HDFL2HED;                          0298 00255000
         MVI   HEADFLG2(@02),X'FF'                                 0298 00256000
*                    RECORDSZ = OUTLEN;                            0299 00257000
         L     @14,@PC00001+4                                      0299 00258000
         L     @01,INPPTR(,@14)                                    0299 00259000
         L     @01,INPTBL+4(,@01)                                  0299 00260000
         L     @14,OUTLEN(,@01)                                    0299 00261000
         ST    @14,RECORDSZ(,@02)                                  0299 00262000
*                    TOTLEN = HEADLN;                              0300 00263000
*                                                                  0300 00264000
         ST    @15,TOTLEN                                          0300 00265000
*                    CALL  PUTPROC(TOTLEN,CONRCPTR);               0301 00266000
*                                                                  0301 00267000
         LA    @02,TOTLEN                                          0301 00268000
         ST    @02,@AL00001                                        0301 00269000
         LA    @02,CONRCPTR                                        0301 00270000
         ST    @02,@AL00001+4                                      0301 00271000
         LA    @01,@AL00001                                        0301 00272000
         BAL   @14,PUTPROC                                         0301 00273000
*                    RESPECIFY RTNREG RSTD;                        0302 00274000
*                    TESTRC = RTNREG;                              0303 00275000
         LR    TESTRC,RTNREG                                       0303 00276000
*                    RESPECIFY RTNREG UNRSTD;                      0304 00277000
*                    IF TESTRC ^= 0                                0305 00278000
*                      THEN                                        0305 00279000
         LTR   TESTRC,TESTRC                                       0305 00280000
         BZ    @RF00305                                            0305 00281000
*                        SETRC = LASTCC16;                         0306 00282000
         LA    SETRC,16                                            0306 00283000
*                      ELSE                                        0307 00284000
*                        OPNFLG = ON;  /* OPEN PROCESSING FOR OUTPUT */ 00285000
         B     @RC00305                                            0307 00286000
@RF00305 L     @02,@PC00001+4                                      0307 00287000
         L     @02,INPPTR(,@02)                                    0307 00288000
         L     @02,INPTBL+4(,@02)                                  0307 00289000
         OI    OPNFLG(@02),B'10000000'                             0307 00290000
*                                      /* NOT REQUIRED AFTER FIRST   */ 00291000
*                                      /* CALL.                      */ 00292000
*                    END;                                          0308 00293000
@RC00305 DS    0H                                                  0309 00294000
*                END;                                              0309 00295000
@RC00289 DS    0H                                                  0310 00296000
*            END  FSTREQ;                                          0310 00297000
@RC00281 DS    0H                                                  0311 00298000
*                                                                  0311 00299000
*        /************************************************************/ 00300000
*        /*                                                          */ 00301000
*        /*  CHECK FOR SUCCESSFUL OPENING OF OUTPUT DATA SET AND     */ 00302000
*        /*  LAST REQUEST FLAG                                       */ 00303000
*        /*                                                          */ 00304000
*        /************************************************************/ 00305000
*                                                                  0311 00306000
*        IF SETRC = 0 & ENDFLG = OFF                               0311 00307000
*          THEN                                                    0311 00308000
@RF00273 LTR   SETRC,SETRC                                         0311 00309000
         BNZ   @RF00311                                            0311 00310000
         L     @02,@PC00001+4                                      0311 00311000
         L     @02,INPPTR(,@02)                                    0311 00312000
         L     @02,INPTBL+4(,@02)                                  0311 00313000
         TM    ENDFLG(@02),B'01000000'                             0311 00314000
         BNZ   @RF00311                                            0311 00315000
*            DO;                                                   0312 00316000
*                                                                  0312 00317000
*            /********************************************************/ 00318000
*            /*                                                      */ 00319000
*            /*  INITIALIZE POINTERS TO CPL'S YET TO BE CONSTRUCTED  */ 00320000
*            /*                                                      */ 00321000
*            /********************************************************/ 00322000
*                                                                  0313 00323000
*            DO I = 1 TO 5;                                        0313 00324000
         LA    I,1                                                 0313 00325000
@DL00313 DS    0H                                                  0314 00326000
*              PTRCPL(I) = NULLPTR;                                0314 00327000
         LR    @05,I                                               0314 00328000
         SLA   @05,2                                               0314 00329000
         SLR   @15,@15                                             0314 00330000
         ST    @15,PTRCPL-4(@05)                                   0314 00331000
*            END;                                                  0315 00332000
*                                                                  0315 00333000
         AL    I,@CF00218                                          0315 00334000
         C     I,@CF00285                                          0315 00335000
         BNH   @DL00313                                            0315 00336000
*            /********************************************************/ 00337000
*            /*                                                      */ 00338000
*            /*  INITIALIZE CATALOG ACB POINTER,                     */ 00339000
*            /*  PROCESSING FLAGS,                                   */ 00340000
*            /*  RESET POINTER TO IOCS FOR OUTPUT                    */ 00341000
*            /*                                                      */ 00342000
*            /********************************************************/ 00343000
*                                                                  0316 00344000
*            FLGTWO = FLGOFF;                                      0316 00345000
         IC    @05,FLGOFF                                          0316 00346000
         STC   @05,FLGTWO                                          0316 00347000
*            FLGS = FLGOFF;                                        0317 00348000
         IC    @05,FLGOFF                                          0317 00349000
         STC   @05,FLGS                                            0317 00350000
*            PTRCTACB = NULLPTR;                                   0318 00351000
         SLR   @05,@05                                             0318 00352000
         ST    @05,PTRCTACB                                        0318 00353000
*            POUTIOCS = SAVOIOCS;                                  0319 00354000
*                                                                  0319 00355000
         L     @05,@PC00001+4                                      0319 00356000
         L     @05,INPPTR(,@05)                                    0319 00357000
         L     @01,INPTBL+4(,@05)                                  0319 00358000
         L     @15,SAVOIOCS(,@01)                                  0319 00359000
         ST    @15,POUTIOCS                                        0319 00360000
*            /********************************************************/ 00361000
*            /*                                                      */ 00362000
*            /*  DETERMINE TYPE OF OBJECT TO BE PROCESSED            */ 00363000
*            /*                                                      */ 00364000
*            /********************************************************/ 00365000
*                                                                  0320 00366000
*            IF OBJTYP = CTGTCL | OBJTYP = CTGTAIX                 0320 00367000
*              THEN                                                0320 00368000
         L     @05,INPTBL(,@05)                                    0320 00369000
         CLI   OBJTYP(@05),C'C'                                    0320 00370000
         BE    @RT00320                                            0320 00371000
         CLI   OBJTYP(@05),C'G'                                    0320 00372000
         BNE   @RF00320                                            0320 00373000
@RT00320 DS    0H                                                  0321 00374000
*                DO;                                               0321 00375000
*                /****************************************************/ 00376000
*                /*                                                  */ 00377000
*                /*  PROCESS EXPORTATION OF VSAM OBJECT              */ 00378000
*                /*                                                  */ 00379000
*                /****************************************************/ 00380000
*                                                                  0322 00381000
*                CALL CLUSPROC;                                    0322 00382000
*                                                                  0322 00383000
         BAL   @14,CLUSPROC                                        0322 00384000
*                RESPECIFY RTNREG RSTD;                            0323 00385000
*                TESTRC = RTNREG;                                  0324 00386000
         LR    TESTRC,RTNREG                                       0324 00387000
*                RESPECIFY RTNREG UNRSTD;                          0325 00388000
*                SETRC = TESTRC;                                   0326 00389000
         LR    SETRC,TESTRC                                        0326 00390000
*                END;                                              0327 00391000
*                                                                  0327 00392000
*              ELSE                                                0328 00393000
*                DO;                                               0328 00394000
         B     @RC00320                                            0328 00395000
@RF00320 DS    0H                                                  0329 00396000
*                /****************************************************/ 00397000
*                /*                                                  */ 00398000
*                /*  DETERMINE TYPE OF NON VSAM OBJECT               */ 00399000
*                /*                                                  */ 00400000
*                /****************************************************/ 00401000
*                                                                  0329 00402000
*                IF OBJTYP = CTGTALIN | OBJTYP = CTGTUCAT          0329 00403000
*                  THEN                                            0329 00404000
         L     @05,@PC00001+4                                      0329 00405000
         L     @05,INPPTR(,@05)                                    0329 00406000
         L     @05,INPTBL(,@05)                                    0329 00407000
         CLI   OBJTYP(@05),C'A'                                    0329 00408000
         BE    @RT00329                                            0329 00409000
         CLI   OBJTYP(@05),C'U'                                    0329 00410000
         BNE   @RF00329                                            0329 00411000
@RT00329 DS    0H                                                  0330 00412000
*                    DO;                                           0330 00413000
*                    /************************************************/ 00414000
*                    /*                                              */ 00415000
*                    /* PROCESS EXPORTATION OF A NON VSAM OBJECT     */ 00416000
*                    /*                                              */ 00417000
*                    /************************************************/ 00418000
*                                                                  0331 00419000
*                    CALL NVSMPROC;                                0331 00420000
*                                                                  0331 00421000
         BAL   @14,NVSMPROC                                        0331 00422000
*                    RESPECIFY RTNREG RSTD;                        0332 00423000
*                    TESTRC = RTNREG;                              0333 00424000
         LR    TESTRC,RTNREG                                       0333 00425000
*                    RESPECIFY RTNREG UNRSTD;                      0334 00426000
*                    SETRC = TESTRC;                               0335 00427000
         LR    SETRC,TESTRC                                        0335 00428000
*                    END;                                          0336 00429000
*                                                                  0336 00430000
*                  ELSE                                            0337 00431000
*                    DO;                                           0337 00432000
         B     @RC00329                                            0337 00433000
@RF00329 DS    0H                                                  0338 00434000
*                    /************************************************/ 00435000
*                    /*                                              */ 00436000
*                    /*PROCESS EXPORTATION OF A GENERATION DATA GROUP*/ 00437000
*                    /*                                              */ 00438000
*                    /************************************************/ 00439000
*                                                                  0338 00440000
*                    CALL GDGPROC;                                 0338 00441000
*                                                                  0338 00442000
         BAL   @14,GDGPROC                                         0338 00443000
*                    RESPECIFY RTNREG RSTD;                        0339 00444000
*                    TESTRC = RTNREG;                              0340 00445000
         LR    TESTRC,RTNREG                                       0340 00446000
*                    RESPECIFY RTNREG UNRSTD;                      0341 00447000
*                    SETRC = TESTRC;                               0342 00448000
         LR    SETRC,TESTRC                                        0342 00449000
*                    END;                                          0343 00450000
*                END;                                              0344 00451000
@RC00329 DS    0H                                                  0345 00452000
*            END;                                                  0345 00453000
@RC00320 DS    0H                                                  0346 00454000
*                                                                  0346 00455000
*        OLDERID2 = NEWERID2;                                      0346 00456000
@RF00311 L     @02,@PC00001                                        0346 00457000
         L     @15,GDTTR2(,@02)                                    0346 00458000
         MVC   @TS00001(95),NEWERID2(@15)                          0346 00459000
         MVC   OLDERID2(95,@15),@TS00001                           0346 00460000
*        NEWID2 = 'RC03';                                          0347 00461000
         MVC   NEWID2(4,@15),@CC01053                              0347 00462000
*        IF GDTDBG = NULLPTR                                       0348 00463000
*          THEN;                                                   0348 00464000
         L     @02,GDTDBG(,@02)                                    0348 00465000
         LTR   @02,@02                                             0348 00466000
         BZ    @RT00348                                            0348 00467000
*          ELSE                                                    0350 00468000
*            CALL IDCDB010 (GDTTBL,'RC04');                        0350 00469000
*                                                                  0350 00470000
         L     @02,@PC00001                                        0350 00471000
         ST    @02,@AL00001                                        0350 00472000
         LA    @15,@CC01054                                        0350 00473000
         ST    @15,@AL00001+4                                      0350 00474000
         MVI   @AL00001+4,X'80'                                    0350 00475000
         L     @15,GDTDBG(,@02)                                    0350 00476000
         LA    @01,@AL00001                                        0350 00477000
         BALR  @14,@15                                             0350 00478000
*        /************************************************************/ 00479000
*        /*                                                          */ 00480000
*        /*           CHECK FOR ANY MESSAGE TO PRINT                 */ 00481000
*        /*                                                          */ 00482000
*        /************************************************************/ 00483000
*                                                                  0351 00484000
*        IF DARGSENT ^= NORMSTAT                                   0351 00485000
*          THEN                                                    0351 00486000
*                                                                  0351 00487000
@RT00348 L     @02,DDSTRU                                          0351 00488000
         CLI   DARGSENT(@02),0                                     0351 00489000
         BE    @RF00351                                            0351 00490000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0352 00491000
*                                                                  0352 00492000
         L     @02,@PC00001                                        0352 00493000
         ST    @02,@AL00001                                        0352 00494000
         LA    @15,@CF00114                                        0352 00495000
         ST    @15,@AL00001+4                                      0352 00496000
         LA    @15,DDSTRU                                          0352 00497000
         ST    @15,@AL00001+8                                      0352 00498000
         MVI   @AL00001+8,X'80'                                    0352 00499000
         L     @15,GDTPRT(,@02)                                    0352 00500000
         LA    @01,@AL00001                                        0352 00501000
         BALR  @14,@15                                             0352 00502000
*        /************************************************************/ 00503000
*        /*                                                          */ 00504000
*        /*IF THIS WAS THE LAST REQUEST, CLOSE THE OUTPUT DATA SET   */ 00505000
*        /*  CLOSE THE OUTPUT DATA SET.                              */ 00506000
*        /*                                                          */ 00507000
*        /************************************************************/ 00508000
*                                                                  0353 00509000
*        IF ENDFLG = ON                                            0353 00510000
*          THEN                                                    0353 00511000
@RF00351 L     @02,@PC00001+4                                      0353 00512000
         L     @02,INPPTR(,@02)                                    0353 00513000
         L     @02,INPTBL+4(,@02)                                  0353 00514000
         TM    ENDFLG(@02),B'01000000'                             0353 00515000
         BNO   @RF00353                                            0353 00516000
*            DO;                                                   0354 00517000
*                                                                  0354 00518000
         ST    @02,@TF00001                                        0354 00519000
*            POUTIOCS = SAVOIOCS;                                  0355 00520000
*                                                                  0355 00521000
         L     @01,@TF00001                                        0355 00522000
         L     @15,SAVOIOCS(,@01)                                  0355 00523000
         ST    @15,POUTIOCS                                        0355 00524000
*            CALL IDCIOCL0(GDTTBL,POUTIOCS);                       0356 00525000
*                                                                  0356 00526000
         L     @15,@PC00001                                        0356 00527000
         ST    @15,@AL00001                                        0356 00528000
         LA    @14,POUTIOCS                                        0356 00529000
         ST    @14,@AL00001+4                                      0356 00530000
         MVI   @AL00001+4,X'80'                                    0356 00531000
         L     @15,GDTCLS(,@15)                                    0356 00532000
         LA    @01,@AL00001                                        0356 00533000
         BALR  @14,@15                                             0356 00534000
*            RESPECIFY RTNREG RSTD;                                0357 00535000
*            TESTRC = RTNREG;                                      0358 00536000
         LR    TESTRC,RTNREG                                       0358 00537000
*            RESPECIFY RTNREG UNRSTD;                              0359 00538000
*                                                                  0359 00539000
*            IF TESTRC ^= 0                                        0360 00540000
*              THEN                                                0360 00541000
         LTR   TESTRC,TESTRC                                       0360 00542000
         BZ    @RF00360                                            0360 00543000
*                SETRC = LASTCC16;                                 0361 00544000
*                                                                  0361 00545000
         LA    SETRC,16                                            0361 00546000
*            END;                                                  0362 00547000
*                                                                  0362 00548000
@RF00360 DS    0H                                                  0363 00549000
*        /************************************************************/ 00550000
*        /*                                                          */ 00551000
*        /* RETURN COMPLETION CODE AND FREE CORE FOR THIS REQUEST    */ 00552000
*        /*                                                          */ 00553000
*        /************************************************************/ 00554000
*                                                                  0363 00555000
*                                                                  0363 00556000
*        CALL  IDCSAFP0 (GDTTBL,GPID);                             0363 00557000
*                                                                  0363 00558000
@RF00353 L     @02,@PC00001                                        0363 00559000
         ST    @02,@AL00001                                        0363 00560000
         LA    @15,GPID                                            0363 00561000
         ST    @15,@AL00001+4                                      0363 00562000
         MVI   @AL00001+4,X'80'                                    0363 00563000
         L     @15,GDTFPL(,@02)                                    0363 00564000
         LA    @01,@AL00001                                        0363 00565000
         BALR  @14,@15                                             0363 00566000
*        /************************************************************/ 00567000
*        /*                                                          */ 00568000
*        /* CLOSE THE INPUT DATA SET IF IT'S STILL OPEN              */ 00569000
*        /*                                                          */ 00570000
*        /************************************************************/ 00571000
*                                                                  0364 00572000
*        IF PINIOCS ^= NULLPTR                                     0364 00573000
*          THEN                                                    0364 00574000
*                                                                  0364 00575000
         L     @02,PINIOCS                                         0364 00576000
         LTR   @02,@02                                             0364 00577000
         BZ    @RF00364                                            0364 00578000
*            CALL IDCIOCL0 (GDTTBL,PINIOCS);                       0365 00579000
*                                                                  0365 00580000
         L     @02,@PC00001                                        0365 00581000
         ST    @02,@AL00001                                        0365 00582000
         LA    @15,PINIOCS                                         0365 00583000
         ST    @15,@AL00001+4                                      0365 00584000
         MVI   @AL00001+4,X'80'                                    0365 00585000
         L     @15,GDTCLS(,@02)                                    0365 00586000
         LA    @01,@AL00001                                        0365 00587000
         BALR  @14,@15                                             0365 00588000
*        /************************************************************/ 00589000
*        /*                                                          */ 00590000
*        /*CHECK FOR SUCCESSFUL PROCESSING OF OBJECT AND ASSOCIATIONS*/ 00591000
*        /* IF ALL PATHS OR ALIAS'S NOT PROCESSED THEN ERROR FLAG SET*/ 00592000
*        /*                                                          */ 00593000
*        /************************************************************/ 00594000
*                                                                  0366 00595000
*        IF ERRSAVFL = ON & SETRC = 0                              0366 00596000
*          THEN                                                    0366 00597000
@RF00364 TM    ERRSAVFL,B'00100000'                                0366 00598000
         BNO   @RF00366                                            0366 00599000
         LTR   SETRC,SETRC                                         0366 00600000
         BNZ   @RF00366                                            0366 00601000
*            LASTCC = LASTCC04;                                    0367 00602000
*                                                                  0367 00603000
         MVC   LASTCC(2),@CH00041                                  0367 00604000
*          ELSE                                                    0368 00605000
*            LASTCC = SETRC;                                       0368 00606000
*                                                                  0368 00607000
         B     @RC00366                                            0368 00608000
@RF00366 STH   SETRC,LASTCC                                        0368 00609000
*        CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                       0369 00610000
*                                                                  0369 00611000
@RC00366 L     @15,@PC00001                                        0369 00612000
         ST    @15,@AL00001                                        0369 00613000
         LA    @14,MODID                                           0369 00614000
         ST    @14,@AL00001+4                                      0369 00615000
         LA    @14,LASTCC                                          0369 00616000
         ST    @14,@AL00001+8                                      0369 00617000
         MVI   @AL00001+8,X'80'                                    0369 00618000
         L     @15,GDTEPL(,@15)                                    0369 00619000
         LA    @01,@AL00001                                        0369 00620000
         BALR  @14,@15                                             0369 00621000
*        /************************************************************/ 00622000
*        /*                                                          */ 00623000
*        /*  PROCEDURE NAME - CLUSPROC                               */ 00624000
*        /*                                                          */ 00625000
*        /*  FUNCTION - OBTAINS CATALOG INFORMATION ABOUT            */ 00626000
*        /*  THE OBJECT BEING EXPORTED AND ANY PATHS DEFINED         */ 00627000
*        /*  OVER IT.  BUILDS CONTROL AND DATA RECORDS, AND          */ 00628000
*        /*  WRITES OUT THE HEADER RECORDS OF THE                    */ 00629000
*        /*  PORTABILITY DATA SET.  CALLS LOWER LEVEL                */ 00630000
*        /*  PROCEDURES TO WRITE THE RECORDS OF THE DATA             */ 00631000
*        /*  SET BEING EXPORTED TO THE PORTABILITY DATA              */ 00632000
*        /*  SET.                                                    */ 00633000
*        /*                                                          */ 00634000
*        /* INPUT - INPUT PARAMETER LIST                             */ 00635000
*        /*                                                          */ 00636000
*        /*  OUTPUT - PORTABILITY DATA SET THAT CAN BE EMPLOYED BY   */ 00637000
*        /*  THE IMPORT FSR TO RECONSTRUCT THE VSAM OBJECT ON THE    */ 00638000
*        /*  SAME SYSTEM OR ON A DIFFERENT SYSTEM.                   */ 00639000
*        /*                                                          */ 00640000
*        /************************************************************/ 00641000
*                                                                  0370 00642000
*CLUSPROC: PROCEDURE;                                              0370 00643000
*                                                                  0370 00644000
@EL00001 L     @13,4(,@13)                                         0370 00645000
@EF00001 L     @00,@SIZDATD                                        0370 00646000
         LR    @01,@08                                             0370 00647000
         FREEMAIN R,LV=(0),A=(1)                                        00648000
@ER00001 LM    @14,@12,12(@13)                                     0370 00649000
         BR    @14                                                 0370 00650000
CLUSPROC STM   @14,@12,@SA00002                                    0370 00651000
*        OLDERID2 = NEWERID2;                                      0371 00652000
         L     @15,@PC00001                                        0371 00653000
         L     @14,GDTTR2(,@15)                                    0371 00654000
         MVC   @TS00001(95),NEWERID2(@14)                          0371 00655000
         MVC   OLDERID2(95,@14),@TS00001                           0371 00656000
*        NEWID2 = 'RC05';                                          0372 00657000
         MVC   NEWID2(4,@14),@CC01058                              0372 00658000
*        IF GDTDBG = NULLPTR                                       0373 00659000
*          THEN;                                                   0373 00660000
         L     @15,GDTDBG(,@15)                                    0373 00661000
         LTR   @15,@15                                             0373 00662000
         BZ    @RT00373                                            0373 00663000
*          ELSE                                                    0375 00664000
*            CALL IDCDB010 (GDTTBL,'RC06');                        0375 00665000
*                                                                  0375 00666000
         L     @15,@PC00001                                        0375 00667000
         ST    @15,@AL00001                                        0375 00668000
         LA    @14,@CC01059                                        0375 00669000
         ST    @14,@AL00001+4                                      0375 00670000
         MVI   @AL00001+4,X'80'                                    0375 00671000
         L     @15,GDTDBG(,@15)                                    0375 00672000
         LA    @01,@AL00001                                        0375 00673000
         BALR  @14,@15                                             0375 00674000
*        /************************************************************/ 00675000
*        /*                                                          */ 00676000
*        /* INITIALIZE NUMBER OF FIELDS FOR CATALOG LOCATE           */ 00677000
*        /*                                                          */ 00678000
*        /************************************************************/ 00679000
*                                                                  0376 00680000
*        CNUM = (DIM(FIELDLST));       /*FIELD LIST FOR FIRST LOCATE */ 00681000
@RT00373 MVI   CNUM,X'17'                                          0376 00682000
*        ONUM = (DIM(FIELDLST)-2);     /*FIELD LIST FOR LOCATES WITH */ 00683000
         MVI   ONUM,X'15'                                          0377 00684000
*                                      /*NO CATACB AND NAMEDS FIELD  */ 00685000
*                                                                  0378 00686000
*        /************************************************************/ 00687000
*        /*                                                          */ 00688000
*        /*  PERFORM LOCATE ON THE CLUSTER OR AIX NAME.              */ 00689000
*        /*  CALL LOCPROC TO BUILD THE NECESSARY CPL AND FPLS.       */ 00690000
*        /*  CALL CTLGPROC TO INVOKE CATALOG MANAGEMENT FOR LOCATE   */ 00691000
*        /*                                                          */ 00692000
*        /************************************************************/ 00693000
*                                                                  0378 00694000
*        CALL LOCPROC(OBJVAL,NULLPARM,FIELDLST,CNUM,PTRCPL(1));    0378 00695000
*                                                                  0378 00696000
         L     @15,@PC00001+4                                      0378 00697000
         L     @01,INPPTR(,@15)                                    0378 00698000
         L     @01,INPTBL(,@01)                                    0378 00699000
         LA    @15,OBJVAL(,@01)                                    0378 00700000
         ST    @15,@AL00001                                        0378 00701000
         LA    @15,NULLPARM                                        0378 00702000
         ST    @15,@AL00001+4                                      0378 00703000
         LA    @15,FIELDLST                                        0378 00704000
         ST    @15,@AL00001+8                                      0378 00705000
         LA    @15,CNUM                                            0378 00706000
         ST    @15,@AL00001+12                                     0378 00707000
         LA    @15,PTRCPL                                          0378 00708000
         ST    @15,@AL00001+16                                     0378 00709000
         LA    @01,@AL00001                                        0378 00710000
         BAL   @14,LOCPROC                                         0378 00711000
*        /************************************************************/ 00712000
*        /*                                                          */ 00713000
*        /* IF LOCPROC FAILS TO BUILD CPL'S AND FPL'S -TERMINATE     */ 00714000
*        /*                                                          */ 00715000
*        /************************************************************/ 00716000
*                                                                  0379 00717000
*        RESPECIFY RTNREG RSTD;                                    0379 00718000
*        TESTRC = RTNREG;                                          0380 00719000
         LR    TESTRC,RTNREG                                       0380 00720000
*        RESPECIFY RTNREG UNRSTD;                                  0381 00721000
*        IF TESTRC ^= 0                                            0382 00722000
*          THEN                                                    0382 00723000
         LTR   TESTRC,TESTRC                                       0382 00724000
         BZ    @RF00382                                            0382 00725000
*            RETURN CODE(LASTCC16);                                0383 00726000
*                                                                  0383 00727000
         LA    @15,16                                              0383 00728000
         L     @14,@SA00002                                        0383 00729000
         LM    @00,@12,@SA00002+8                                  0383 00730000
         BR    @14                                                 0383 00731000
*        CALL CTLGPROC(PTRCPL(1));                                 0384 00732000
*                                                                  0384 00733000
@RF00382 LA    @15,PTRCPL                                          0384 00734000
         ST    @15,@AL00001                                        0384 00735000
         LA    @01,@AL00001                                        0384 00736000
         BAL   @14,CTLGPROC                                        0384 00737000
*        /************************************************************/ 00738000
*        /*                                                          */ 00739000
*        /* IF CTLGPROC FAILS TO PERFORM THE LOCATES - TERMINATE     */ 00740000
*        /* THIS REQUEST                                             */ 00741000
*        /*                                                          */ 00742000
*        /************************************************************/ 00743000
*                                                                  0385 00744000
*        RESPECIFY RTNREG RSTD;                                    0385 00745000
*        TESTRC = RTNREG;                                          0386 00746000
         LR    TESTRC,RTNREG                                       0386 00747000
*        RESPECIFY RTNREG UNRSTD;                                  0387 00748000
*        IF TESTRC ^= 0                                            0388 00749000
*          THEN                                                    0388 00750000
         LTR   TESTRC,TESTRC                                       0388 00751000
         BZ    @RF00388                                            0388 00752000
*            /********************************************************/ 00753000
*            /*                                                      */ 00754000
*            /* IF SEVERE ERROR RETURN IS WITH TERMINATION CODE ELSE */ 00755000
*            /*  RETURN INDICATES THIS REQUEST COULD NOT BE PROCESSED*/ 00756000
*            /*                                                      */ 00757000
*            /********************************************************/ 00758000
*            IF TESTRC = LASTCC16                                  0389 00759000
*              THEN                                                0389 00760000
         LA    @03,16                                              0389 00761000
         CR    TESTRC,@03                                          0389 00762000
         BNE   @RF00389                                            0389 00763000
*                RETURN CODE(LASTCC16);                            0390 00764000
         LR    @15,@03                                             0390 00765000
         L     @14,@SA00002                                        0390 00766000
         LM    @00,@12,@SA00002+8                                  0390 00767000
         BR    @14                                                 0390 00768000
*              ELSE                                                0391 00769000
*                RETURN CODE(LASTCC08);                            0391 00770000
@RF00389 LA    @15,8                                               0391 00771000
         L     @14,@SA00002                                        0391 00772000
         LM    @00,@12,@SA00002+8                                  0391 00773000
         BR    @14                                                 0391 00774000
*          ELSE;                                                   0392 00775000
@RF00388 DS    0H                                                  0393 00776000
*        /************************************************************/ 00777000
*        /*                                                          */ 00778000
*        /*  GET ENTYPE FPL AND EXAMINE RETURNED FIELD INFORMATION   */ 00779000
*        /*  TO INSURE THAT ENTRYVAL WAS INDEED A CLUSTER OR AIX     */ 00780000
*        /*  NAME                                                    */ 00781000
*        /*                                                          */ 00782000
*        /************************************************************/ 00783000
*                                                                  0393 00784000
*        CTGPLPTR = PTRCPL(1);                                     0393 00785000
         L     @03,PTRCPL                                          0393 00786000
         ST    @03,CTGPLPTR                                        0393 00787000
*        CTGFLPTR = CTGFIELD(IENTYPE);                             0394 00788000
         L     CTGFLPTR,CTGFIELD(,@03)                             0394 00789000
*        IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= 0                      0395 00790000
*          THEN                                                    0395 00791000
         SLR   @03,@03                                             0395 00792000
         C     @03,CTGFLNG(,CTGFLPTR)                              0395 00793000
         BE    @RF00395                                            0395 00794000
         L     @15,CTGFLPT(,CTGFLPTR)                              0395 00795000
         CR    @15,@03                                             0395 00796000
         BE    @RF00395                                            0395 00797000
*            IF FENTYPE = CTGTAIX                                  0396 00798000
*              THEN                                                0396 00799000
*                                                                  0396 00800000
         CLI   FENTYPE(@15),C'G'                                   0396 00801000
         BNE   @RF00396                                            0396 00802000
*                /****************************************************/ 00803000
*                /*                                                  */ 00804000
*                /*  HAVE AN AIX.  SET AIXFLAG TO ON.                */ 00805000
*                /*                                                  */ 00806000
*                /****************************************************/ 00807000
*                                                                  0397 00808000
*                AIXFLAG = ON;                                     0397 00809000
*                                                                  0397 00810000
         OI    AIXFLAG,B'10000000'                                 0397 00811000
*              ELSE                                                0398 00812000
*                                                                  0398 00813000
*                IF FENTYPE ^= CTGTCL                              0398 00814000
*                    THEN                                          0398 00815000
         B     @RC00396                                            0398 00816000
@RF00396 L     @03,CTGFLPT(,CTGFLPTR)                              0398 00817000
         CLI   FENTYPE(@03),C'C'                                   0398 00818000
         BE    @RF00398                                            0398 00819000
*                      DO;                                         0399 00820000
*                      DARGSMOD = EXPMSG;                          0400 00821000
         L     @15,DDSTRU                                          0400 00822000
         MVC   DARGSMOD(3,@15),@CC00834                            0400 00823000
*                      DARGSENT = NOVALOBJ;                        0401 00824000
         MVI   DARGSENT(@15),X'03'                                 0401 00825000
*                      RETURN CODE(LASTCC08);                      0402 00826000
         LA    @15,8                                               0402 00827000
         L     @14,@SA00002                                        0402 00828000
         LM    @00,@12,@SA00002+8                                  0402 00829000
         BR    @14                                                 0402 00830000
*                      END;                                        0403 00831000
*                    ELSE;                                         0404 00832000
@RF00398 DS    0H                                                  0405 00833000
*          ELSE                                                    0405 00834000
*            /********************************************************/ 00835000
*            /*                                                      */ 00836000
*            /*  NO ENTYPE FIELD -IMPOSSIBLE - TERMINATE             */ 00837000
*            /*                                                      */ 00838000
*            /********************************************************/ 00839000
*            DO;                                                   0405 00840000
         B     @RC00395                                            0405 00841000
@RF00395 DS    0H                                                  0406 00842000
*            DARGSMOD = CEXPMSG;                                   0406 00843000
         L     @15,DDSTRU                                          0406 00844000
         MVC   DARGSMOD(3,@15),@CC00836                            0406 00845000
*            DARGSENT = NOCTFLD;                                   0407 00846000
         MVI   DARGSENT(@15),X'04'                                 0407 00847000
*            RETURN CODE(LASTCC08);                                0408 00848000
         LA    @15,8                                               0408 00849000
         L     @14,@SA00002                                        0408 00850000
         LM    @00,@12,@SA00002+8                                  0408 00851000
         BR    @14                                                 0408 00852000
*            END;                                                  0409 00853000
*                                                                  0409 00854000
*        /************************************************************/ 00855000
*        /*                                                          */ 00856000
*        /*  GET CATALOG ACB FIELD IF RETURNED IN FPL FOR CATACB     */ 00857000
*        /*                                                          */ 00858000
*        /************************************************************/ 00859000
*                                                                  0410 00860000
*        CTGFLPTR = CTGFIELD(ICATACB);                             0410 00861000
@RC00395 L     @15,CTGPLPTR                                        0410 00862000
         L     CTGFLPTR,CTGFIELD+88(,@15)                          0410 00863000
*        PTRCTACB = FCATACB;                                       0411 00864000
*                                                                  0411 00865000
*                                                                  0411 00866000
*                                                                  0411 00867000
*                                                                  0411 00868000
         L     @03,CTGFLPT(,CTGFLPTR)                              0411 00869000
         L     @03,FCATACB(,@03)                                   0411 00870000
         ST    @03,PTRCTACB                                        0411 00871000
*        /************************************************************/ 00872000
*        /*                                                          */ 00873000
*        /*  GET NAMEDS FPL FOR DATA AND POSSIBLY INDEX.             */ 00874000
*        /*  CALL LOCPROC TO BUILD CPL AND FPLS AND ISSUE A          */ 00875000
*        /*  LOCATE.                                                 */ 00876000
*        /*                                                          */ 00877000
*        /************************************************************/ 00878000
*                                                                  0412 00879000
*        CTGFLPTR = CTGFIELD(INAMEDS);                             0412 00880000
*                                                                  0412 00881000
*                                                                  0412 00882000
*                                                                  0412 00883000
         L     CTGFLPTR,CTGFIELD+84(,@15)                          0412 00884000
*        /************************************************************/ 00885000
*        /*                                                          */ 00886000
*        /*TEST FOR DATA AND INDEX COMPONENT                         */ 00887000
*        /*RETURN IF UNAVAILABLE                                     */ 00888000
*        /*  THE STRUCTURE OF THE NAMEDS AREA RETURNED BY            */ 00889000
*        /*  CATALOG MANAGEMENT IS USED EXPLICITLY IN ALL            */ 00890000
*        /*  OF THE CODE IN THIS MODULE THAT REFERENCES              */ 00891000
*        /*  NAMEDS.  FOR A CLUSTER OBJECT THE STRUCTURE             */ 00892000
*        /*  IS DATA, INDEX (IF EXISTANT), AND A MIXTURE OF          */ 00893000
*        /*  PATHS AND ALTERNATE INDEXES.  IN THE CASE OF            */ 00894000
*        /*  AN AIX, THE ORDER OF ASSOCIATED OBJECTS IS              */ 00895000
*        /*  DATA, INDEX, BASE CLUSTER, AND ANY PATHS.  FOR          */ 00896000
*        /*  PATHS IDCRC02 ASSUMES ONLY THAT THE PATHENTRY           */ 00897000
*        /*  OBJECT APPEARS FIRST IN THE NAMEDS AREA.                */ 00898000
*        /*                                                          */ 00899000
*        /************************************************************/ 00900000
*                                                                  0413 00901000
*        IF CTGFLNG(1) = 0                                         0413 00902000
*          THEN                                                    0413 00903000
         L     @03,CTGFLNG(,CTGFLPTR)                              0413 00904000
         LTR   @03,@03                                             0413 00905000
         BNZ   @RF00413                                            0413 00906000
*            DO;                                                   0414 00907000
*            DARGSMOD = CEXPMSG;                                   0415 00908000
         L     @15,DDSTRU                                          0415 00909000
         MVC   DARGSMOD(3,@15),@CC00836                            0415 00910000
*            DARGSENT = NOCTFLD;                                   0416 00911000
         MVI   DARGSENT(@15),X'04'                                 0416 00912000
*            RETURN CODE(LASTCC08);                                0417 00913000
         LA    @15,8                                               0417 00914000
         L     @14,@SA00002                                        0417 00915000
         LM    @00,@12,@SA00002+8                                  0417 00916000
         BR    @14                                                 0417 00917000
*            END;                                                  0418 00918000
*                                                                  0418 00919000
*                                                                  0418 00920000
*        /************************************************************/ 00921000
*        /*                                                          */ 00922000
*        /*  ISSUE LOCATES FOR EITHER DATA AND INDEX OR JUST         */ 00923000
*        /*  DATA.  THE INFORMATION RETURNED BY CATALOG WILL         */ 00924000
*        /*  BE WRITTEN TO THE PORTABILITY DATA SET.                 */ 00925000
*        /*                                                          */ 00926000
*        /************************************************************/ 00927000
*                                                                  0419 00928000
*        FNMPTR = CTGFLPT(1);                                      0419 00929000
@RF00413 L     @04,CTGFLPT(,CTGFLPTR)                              0419 00930000
         ST    @04,FNMPTR                                          0419 00931000
*        NUMOBJ = CTGFLNG(1) / LNAMEDS;                            0420 00932000
         L     @00,CTGFLNG(,CTGFLPTR)                              0420 00933000
         SRDA  @00,32                                              0420 00934000
         D     @00,@CF00041                                        0420 00935000
         LR    NUMOBJ,@01                                          0420 00936000
*        NUMOBJCT = NUMOBJ;                                        0421 00937000
         LR    NUMOBJCT,NUMOBJ                                     0421 00938000
*        NUMASSOC = NUMOBJ;                                        0422 00939000
*                                                                  0422 00940000
         STH   NUMOBJ,NUMASSOC                                     0422 00941000
*ASSOCLP: DO I = 1 TO NUMOBJ;                                      0423 00942000
*                                                                  0423 00943000
ASSOCLP  LA    I,1                                                 0423 00944000
         B     @DE00423                                            0423 00945000
@DL00423 DS    0H                                                  0424 00946000
*          OLDERID2 = NEWERID2;                                    0424 00947000
         L     @02,@PC00001                                        0424 00948000
         L     @02,GDTTR2(,@02)                                    0424 00949000
         MVC   @TS00001(95),NEWERID2(@02)                          0424 00950000
         MVC   OLDERID2(95,@02),@TS00001                           0424 00951000
*          NEWID2 = 'RC07';                                        0425 00952000
*                                                                  0425 00953000
         MVC   NEWID2(4,@02),@CC01065                              0425 00954000
*          /**********************************************************/ 00955000
*          /*                                                        */ 00956000
*          /*  IF DATA OR INDEX, CALL LOCPROC TO BUILD CPL,          */ 00957000
*          /*  FPL'S.  THEN CALL CTLGPROC TO ISSUE A UCATLG.         */ 00958000
*          /*  IF EITHER PROCEDURE SHOULD FAIL, RETURN.              */ 00959000
*          /*                                                        */ 00960000
*          /**********************************************************/ 00961000
*                                                                  0426 00962000
*          IF FTYPE = CTGTINDX | FTYPE = CTGTDATA                  0426 00963000
*             | (FTYPE = CTGTCL & AIXFLAG = ON)                    0426 00964000
*            THEN                                                  0426 00965000
         L     @02,FNMPTR                                          0426 00966000
         CLI   FTYPE(@02),C'I'                                     0426 00967000
         BE    @RT00426                                            0426 00968000
         CLI   FTYPE(@02),C'D'                                     0426 00969000
         BE    @RT00426                                            0426 00970000
         CLI   FTYPE(@02),C'C'                                     0426 00971000
         BNE   @RF00426                                            0426 00972000
         TM    AIXFLAG,B'10000000'                                 0426 00973000
         BNO   @RF00426                                            0426 00974000
@RT00426 DS    0H                                                  0427 00975000
*LOCCOMP:      DO;                                                 0427 00976000
*                                                                  0427 00977000
LOCCOMP  DS    0H                                                  0428 00978000
*              CALL LOCPROC(FNAME,PTRCTACB,FIELDLST,ONUM,PTRCPL(I+1));  00979000
*                                                                  0428 00980000
         L     @02,FNMPTR                                          0428 00981000
         LA    @02,FNAME(,@02)                                     0428 00982000
         ST    @02,@AL00001                                        0428 00983000
         LA    @02,PTRCTACB                                        0428 00984000
         ST    @02,@AL00001+4                                      0428 00985000
         LA    @02,FIELDLST                                        0428 00986000
         ST    @02,@AL00001+8                                      0428 00987000
         LA    @02,ONUM                                            0428 00988000
         ST    @02,@AL00001+12                                     0428 00989000
         LR    @02,I                                               0428 00990000
         SLA   @02,2                                               0428 00991000
         LA    @02,PTRCPL(@02)                                     0428 00992000
         ST    @02,@AL00001+16                                     0428 00993000
         LA    @01,@AL00001                                        0428 00994000
         BAL   @14,LOCPROC                                         0428 00995000
*              /******************************************************/ 00996000
*              /*                                                    */ 00997000
*              /*  IF LOCPROC FAILS TO BUILD CPL'S AND FPL'S -       */ 00998000
*              /*  TERMINATE                                         */ 00999000
*              /*                                                    */ 01000000
*              /******************************************************/ 01001000
*                                                                  0429 01002000
*              RESPECIFY RTNREG RSTD;                              0429 01003000
*              TESTRC = RTNREG;                                    0430 01004000
         LR    TESTRC,RTNREG                                       0430 01005000
*              RESPECIFY RTNREG UNRSTD;                            0431 01006000
*                                                                  0431 01007000
*              IF TESTRC ^= 0                                      0432 01008000
*                THEN                                              0432 01009000
         LTR   TESTRC,TESTRC                                       0432 01010000
         BZ    @RF00432                                            0432 01011000
*                  RETURN CODE(LASTCC16);                          0433 01012000
*                                                                  0433 01013000
         LA    @15,16                                              0433 01014000
         L     @14,@SA00002                                        0433 01015000
         LM    @00,@12,@SA00002+8                                  0433 01016000
         BR    @14                                                 0433 01017000
*              /******************************************************/ 01018000
*              /*                                                    */ 01019000
*              /*  INVOKE CATALOG MANAGEMENT TO LOCATE RELATED       */ 01020000
*              /*  CLUSTER OR AIX OBJECT.                            */ 01021000
*              /*  TERMINATE IF LOCATE UNSUCCESSFUL                  */ 01022000
*              /*                                                    */ 01023000
*              /******************************************************/ 01024000
*                                                                  0434 01025000
*                                                                  0434 01026000
*              CALL CTLGPROC(PTRCPL(I+1));                         0434 01027000
*                                                                  0434 01028000
*                                                                  0434 01029000
@RF00432 LR    @02,I                                               0434 01030000
         SLA   @02,2                                               0434 01031000
         LA    @02,PTRCPL(@02)                                     0434 01032000
         ST    @02,@AL00001                                        0434 01033000
         LA    @01,@AL00001                                        0434 01034000
         BAL   @14,CTLGPROC                                        0434 01035000
*              RESPECIFY RTNREG RSTD;                              0435 01036000
*              TESTRC = RTNREG;                                    0436 01037000
         LR    TESTRC,RTNREG                                       0436 01038000
*              RESPECIFY RTNREG UNRSTD;                            0437 01039000
*                                                                  0437 01040000
*                                                                  0437 01041000
*              IF TESTRC ^= 0                                      0438 01042000
*                                                                  0438 01043000
*                THEN                                              0438 01044000
*                                                                  0438 01045000
         LTR   TESTRC,TESTRC                                       0438 01046000
         BZ    @RF00438                                            0438 01047000
*                  /**************************************************/ 01048000
*                  /*                                                */ 01049000
*                  /*IF SEVERE ERROR RETURN IS WITH TERMINATION CODE */ 01050000
*                  /*ELSE RETURN INDICATES THIS REQUEST COULD NOT BE */ 01051000
*                  /*PROCESSED                                       */ 01052000
*                  /*                                                */ 01053000
*                  /**************************************************/ 01054000
*                                                                  0439 01055000
*                  IF TESTRC = LASTCC16                            0439 01056000
*                    THEN                                          0439 01057000
         LA    @03,16                                              0439 01058000
         CR    TESTRC,@03                                          0439 01059000
         BNE   @RF00439                                            0439 01060000
*                      RETURN CODE(LASTCC16);                      0440 01061000
*                                                                  0440 01062000
         LR    @15,@03                                             0440 01063000
         L     @14,@SA00002                                        0440 01064000
         LM    @00,@12,@SA00002+8                                  0440 01065000
         BR    @14                                                 0440 01066000
*                    ELSE                                          0441 01067000
*                      RETURN CODE(LASTCC08);                      0441 01068000
*                                                                  0441 01069000
*                                                                  0441 01070000
@RF00439 LA    @15,8                                               0441 01071000
         L     @14,@SA00002                                        0441 01072000
         LM    @00,@12,@SA00002+8                                  0441 01073000
         BR    @14                                                 0441 01074000
*                ELSE;                                             0442 01075000
*                                                                  0442 01076000
@RF00438 DS    0H                                                  0443 01077000
*              CTGPLPTR = PTRCPL(I+1);                             0443 01078000
*                                                                  0443 01079000
         LR    @02,I                                               0443 01080000
         SLA   @02,2                                               0443 01081000
         L     @02,PTRCPL(@02)                                     0443 01082000
         ST    @02,CTGPLPTR                                        0443 01083000
*              /******************************************************/ 01084000
*              /*                                                    */ 01085000
*              /*  IF WE ARE LOCATING A CLUSTER ASSOCIATED           */ 01086000
*              /*  OBJECT FOR AN AIX, SAVE THE NAME OF THE           */ 01087000
*              /*  CLUSTER.  ALSO DECREMENT THE NUMBER OF            */ 01088000
*              /*  THINGS TO BE EXPORTED.                            */ 01089000
*              /*                                                    */ 01090000
*              /******************************************************/ 01091000
*                                                                  0444 01092000
*              IF FTYPE = CTGTCL & AIXFLAG = ON                    0444 01093000
*                THEN                                              0444 01094000
         L     @01,FNMPTR                                          0444 01095000
         CLI   FTYPE(@01),C'C'                                     0444 01096000
         BNE   @RF00444                                            0444 01097000
         TM    AIXFLAG,B'10000000'                                 0444 01098000
         BNO   @RF00444                                            0444 01099000
*                  DO;                                             0445 01100000
*                  CTGFLPTR = CTGFIELD(IENTNAME);                  0446 01101000
         L     @15,CTGPLPTR                                        0446 01102000
         L     CTGFLPTR,CTGFIELD+4(,@15)                           0446 01103000
*                  RELNAME = FENTNAME;                             0447 01104000
         L     @01,CTGFLPT(,CTGFLPTR)                              0447 01105000
         MVC   RELNAME(44),FENTNAME(@01)                           0447 01106000
*                  NUMOBJCT = NUMOBJCT - 1;                        0448 01107000
         BCTR  NUMOBJCT,0                                          0448 01108000
*                  END;                                            0449 01109000
*                                                                  0449 01110000
*              /******************************************************/ 01111000
*              /*                                                    */ 01112000
*              /*  TEST TO BE CERTAIN THAT AN ENTYPE FIELD           */ 01113000
*              /*  HAS BEEN LOCATED.                                 */ 01114000
*              /*                                                    */ 01115000
*              /******************************************************/ 01116000
*                                                                  0450 01117000
*              CTGFLPTR = CTGFIELD(IENTYPE);                       0450 01118000
@RF00444 L     @01,CTGPLPTR                                        0450 01119000
         L     CTGFLPTR,CTGFIELD(,@01)                             0450 01120000
*              IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= 0                0451 01121000
*                THEN                                              0451 01122000
*                                                                  0451 01123000
         SLR   @15,@15                                             0451 01124000
         C     @15,CTGFLNG(,CTGFLPTR)                              0451 01125000
         BE    @RF00451                                            0451 01126000
         L     @14,CTGFLPT(,CTGFLPTR)                              0451 01127000
         CR    @14,@15                                             0451 01128000
         BE    @RF00451                                            0451 01129000
*                  /**************************************************/ 01130000
*                  /*                                                */ 01131000
*                  /*  TEST FOR THE PRESENCE OF AN INDEX             */ 01132000
*                  /*  COMPONENT.  IF THIS IS ONE, THEN              */ 01133000
*                  /*  SET THE KSDSFLAG TO ON.                       */ 01134000
*                  /*                                                */ 01135000
*                  /**************************************************/ 01136000
*                                                                  0452 01137000
*                  IF FENTYPE = CTGTINDX                           0452 01138000
*                    THEN                                          0452 01139000
         CLI   FENTYPE(@14),C'I'                                   0452 01140000
         BNE   @RF00452                                            0452 01141000
*                      KSDSFLAG = ON;                              0453 01142000
         OI    KSDSFLAG,B'01000000'                                0453 01143000
*                    ELSE ;                                        0454 01144000
*                                                                  0454 01145000
@RF00452 DS    0H                                                  0455 01146000
*              END LOCCOMP;                                        0455 01147000
*                                                                  0455 01148000
*            ELSE                                                  0456 01149000
*                                                                  0456 01150000
*            /********************************************************/ 01151000
*            /*                                                      */ 01152000
*            /*  TEST TO SEE IF THE ENTRY TYPE IS PATH.  IF          */ 01153000
*            /*  SO, SET A FLAG INDICATING PATH ASSOCIATIONS         */ 01154000
*            /*  OTHERWISE TEST FOR AN AIX.  IF ONE IS               */ 01155000
*            /*  PRESENT, SUBTRACT ONE FROM THE TOTAL                */ 01156000
*            /*  NUMBER OF THINGS TO BE EXPORTED.                    */ 01157000
*            /*  AIX'S OVER CLUSTERS DO NOT GET EXPORTED.            */ 01158000
*            /*                                                      */ 01159000
*            /********************************************************/ 01160000
*                                                                  0456 01161000
*              IF FTYPE = CTGTPTH                                  0456 01162000
*                THEN                                              0456 01163000
         B     @RC00426                                            0456 01164000
@RF00426 L     @02,FNMPTR                                          0456 01165000
         CLI   FTYPE(@02),C'R'                                     0456 01166000
         BNE   @RF00456                                            0456 01167000
*                  PATHFLAG = ON;                                  0457 01168000
         OI    PATHFLAG,B'00100000'                                0457 01169000
*                ELSE                                              0458 01170000
*                  IF FTYPE = CTGTAIX                              0458 01171000
*                    THEN                                          0458 01172000
         B     @RC00456                                            0458 01173000
@RF00456 L     @02,FNMPTR                                          0458 01174000
         CLI   FTYPE(@02),C'G'                                     0458 01175000
         BNE   @RF00458                                            0458 01176000
*                      NUMOBJCT = NUMOBJCT - 1;                    0459 01177000
         BCTR  NUMOBJCT,0                                          0459 01178000
*                    ELSE ;                                        0460 01179000
*                                                                  0460 01180000
@RF00458 DS    0H                                                  0461 01181000
*          FNMPTR = FNMPTR + LNAMEDS;                              0461 01182000
@RC00456 DS    0H                                                  0461 01183000
@RC00426 LA    @02,4                                               0461 01184000
         AL    @02,FNMPTR                                          0461 01185000
         ST    @02,FNMPTR                                          0461 01186000
*        END ASSOCLP;                                              0462 01187000
         AL    I,@CF00218                                          0462 01188000
@DE00423 CR    I,NUMOBJ                                            0462 01189000
         BNH   @DL00423                                            0462 01190000
*                                                                  0463 01191000
*        /************************************************************/ 01192000
*        /*                                                          */ 01193000
*        /*  SET THE NUMBER OF OBJECTS TO BE EXPORTED TO BE          */ 01194000
*        /*  THE NUMBER OF OBJECTS ASSOCIATED WITH THE ENTRY         */ 01195000
*        /*  MINUS THE NUMBER OF AIX'S ASSOCIATED.                   */ 01196000
*        /*                                                          */ 01197000
*        /************************************************************/ 01198000
*                                                                  0463 01199000
*        NUMOBJ = NUMOBJCT;                                        0463 01200000
*                                                                  0463 01201000
         LR    NUMOBJ,NUMOBJCT                                     0463 01202000
*        /************************************************************/ 01203000
*        /*                                                          */ 01204000
*        /*  INDICATE HOW MANY CPL'S HAVE BEEN BUILT AND             */ 01205000
*        /*  ARE TO BE WRITTEN TO THE PORTABILITY DATA               */ 01206000
*        /*  SET.                                                    */ 01207000
*        /*                                                          */ 01208000
*        /************************************************************/ 01209000
*                                                                  0464 01210000
*        IF KSDSFLAG = ON                                          0464 01211000
*          THEN                                                    0464 01212000
         TM    KSDSFLAG,B'01000000'                                0464 01213000
         BNO   @RF00464                                            0464 01214000
*            NUMCPL = 3;                                           0465 01215000
         LA    NUMCPL,3                                            0465 01216000
*          ELSE                                                    0466 01217000
*            NUMCPL = 2;                                           0466 01218000
         B     @RC00464                                            0466 01219000
@RF00464 LA    NUMCPL,2                                            0466 01220000
*        /************************************************************/ 01221000
*        /*                                                          */ 01222000
*        /*  WRITE CATALOG INFORMATION TO THE PORTABILITY DATA SET   */ 01223000
*        /*  CATALOG INFORMATION WILL BE CONTAINED IN TWO TYPES OF   */ 01224000
*        /*  RECORDS- CONTROL RECORDS CONTAINING A DICTIONARY        */ 01225000
*        /*  INDEXING EACH CATALOG FIELD IN THE WORK AREA RETURNED   */ 01226000
*        /*  BY VSAM AND DATA RECORDS CONTAINING THE ENTIRE WORK     */ 01227000
*        /*  AREA RETURNED BY LOCATE                                 */ 01228000
*        /*                                                          */ 01229000
*        /************************************************************/ 01230000
*                                                                  0467 01231000
*        OLDERID2 = NEWERID2;                                      0467 01232000
@RC00464 L     @04,@PC00001                                        0467 01233000
         L     @15,GDTTR2(,@04)                                    0467 01234000
         MVC   @TS00001(95),NEWERID2(@15)                          0467 01235000
         MVC   OLDERID2(95,@15),@TS00001                           0467 01236000
*        NEWID2 = 'RC09';                                          0468 01237000
*                                                                  0468 01238000
*                                                                  0468 01239000
         MVC   NEWID2(4,@15),@CC01068                              0468 01240000
*        /************************************************************/ 01241000
*        /*                                                          */ 01242000
*        /*  GET AN AREA FOR THE CONTROL RECORD OUTPUT BUFFER        */ 01243000
*        /*  IF CORE NOT OBTAINED, RETURN TO CALLING PROCESSOR       */ 01244000
*        /*                                                          */ 01245000
*        /************************************************************/ 01246000
*                                                                  0469 01247000
*        CALL IDCSAGP0 (GDTTBL,LENGTH(CONREC),CONRCPTR,GPID,SETZERO);   01248000
*                                                                  0469 01249000
         MVC   @AL00001+4(16),@AL00469                             0469 01250000
         ST    @04,@AL00001                                        0469 01251000
         LA    @15,CONRCPTR                                        0469 01252000
         ST    @15,@AL00001+8                                      0469 01253000
         L     @15,GDTGPL(,@04)                                    0469 01254000
         LA    @01,@AL00001                                        0469 01255000
         BALR  @14,@15                                             0469 01256000
*        RESPECIFY RTNREG RSTD;                                    0470 01257000
*        TESTRC = RTNREG;                                          0471 01258000
         LR    TESTRC,RTNREG                                       0471 01259000
*        RESPECIFY RTNREG UNRSTD;                                  0472 01260000
*        IF TESTRC ^= 0                                            0473 01261000
*          THEN                                                    0473 01262000
         LTR   TESTRC,TESTRC                                       0473 01263000
         BZ    @RF00473                                            0473 01264000
*            DO;                                                   0474 01265000
*            DARGSMOD = UNIVMSG;                                   0475 01266000
         L     @15,DDSTRU                                          0475 01267000
         MVC   DARGSMOD(3,@15),@CC00847                            0475 01268000
*            DARGSENT = NOSTORAG;                                  0476 01269000
         MVI   DARGSENT(@15),X'04'                                 0476 01270000
*            RETURN CODE(LASTCC16);                                0477 01271000
         LA    @15,16                                              0477 01272000
         L     @14,@SA00002                                        0477 01273000
         LM    @00,@12,@SA00002+8                                  0477 01274000
         BR    @14                                                 0477 01275000
*            END;                                                  0478 01276000
*                                                                  0478 01277000
*        CALL IDCSATI0 (GDTTBL,TIMEODAY,TIMEDATE,FORMAT);          0479 01278000
@RF00473 L     @04,@PC00001                                        0479 01279000
         ST    @04,@AL00001                                        0479 01280000
         LA    @02,8                                               0479 01281000
         AL    @02,CONRCPTR                                        0479 01282000
         LA    @15,TIMEODAY(,@02)                                  0479 01283000
         ST    @15,@AL00001+4                                      0479 01284000
         LA    @02,TIMEDATE(,@02)                                  0479 01285000
         ST    @02,@AL00001+8                                      0479 01286000
         LA    @02,FORMAT                                          0479 01287000
         ST    @02,@AL00001+12                                     0479 01288000
         MVI   @AL00001+12,X'80'                                   0479 01289000
         L     @15,GDTTIM(,@04)                                    0479 01290000
         LA    @01,@AL00001                                        0479 01291000
         BALR  @14,@15                                             0479 01292000
*        HEADLN = LENGTH(HEADER) + LENGTH(TIMESTMP);               0480 01293000
         L     @04,CONRCPTR                                        0480 01294000
         MVC   HEADLN(2,@04),@CH01286                              0480 01295000
*        HEADFLG1 = HDFL1CAT;                                      0481 01296000
         MVI   HEADFLG1(@04),X'FF'                                 0481 01297000
*        HEADFLG2 = HDFL2TSP;                                      0482 01298000
*                                                                  0482 01299000
         MVI   HEADFLG2(@04),X'FF'                                 0482 01300000
*        NUMOBJ = NUMOBJ + 1;          /* ADD CLUSTER TO COUNT       */ 01301000
         AL    NUMOBJ,@CF00218                                     0483 01302000
*        TEXOJCT = NUMOBJ;             /* SET COUNT IN TIMESTAMP     */ 01303000
*                                                                  0484 01304000
         AL    @04,@CF00178                                        0484 01305000
         STC   NUMOBJ,TEXOJCT(,@04)                                0484 01306000
*        /************************************************************/ 01307000
*        /*                                                          */ 01308000
*        /*  IF THE PATHFLAG IS ON, SET THE TEXASSOC BIT, AND        */ 01309000
*        /*  TEST THE KSDSFLAG.  IF THAT FLAG IS ALSO ON,            */ 01310000
*        /*  SET THE TEXBASE BIT.                                    */ 01311000
*        /*                                                          */ 01312000
*        /************************************************************/ 01313000
*                                                                  0485 01314000
*        IF PATHFLAG = ON                                          0485 01315000
*          THEN                                                    0485 01316000
         TM    PATHFLAG,B'00100000'                                0485 01317000
         BNO   @RF00485                                            0485 01318000
*            DO;                                                   0486 01319000
*            TEXASSOC = ON;                                        0487 01320000
         OI    TEXASSOC(@04),B'00100000'                           0487 01321000
*            IF KSDSFLAG = ON                                      0488 01322000
*              THEN                                                0488 01323000
         TM    KSDSFLAG,B'01000000'                                0488 01324000
         BNO   @RF00488                                            0488 01325000
*                TEXBASE = ON;                                     0489 01326000
         OI    TEXBASE(@04),B'00010000'                            0489 01327000
*            END;                                                  0490 01328000
*                                                                  0490 01329000
@RF00488 DS    0H                                                  0491 01330000
*        TEXFLG2 = EXPTYPE1;                                       0491 01331000
@RF00485 L     @04,CONRCPTR                                        0491 01332000
         LA    @15,8                                               0491 01333000
         ALR   @15,@04                                             0491 01334000
         MVC   TEXFLG2(1,@15),EXPTYPE1                             0491 01335000
*        TEXRCVY = ON;                                             0492 01336000
         OI    TEXRCVY(@15),B'00001000'                            0492 01337000
*        SAVLEN = HEADLN;                                          0493 01338000
*                                                                  0493 01339000
         LH    @04,HEADLN(,@04)                                    0493 01340000
         STH   @04,SAVLEN                                          0493 01341000
*        /************************************************************/ 01342000
*        /*                                                          */ 01343000
*        /*  WRITE THE TIME STAMP RECORD TO PORTABILITY DATA SET.    */ 01344000
*        /*  IF AN ERROR IS ENCOUNTERED, RETURN TO THE CALLING       */ 01345000
*        /*  PROCESSOR.                                              */ 01346000
*        /*                                                          */ 01347000
*        /************************************************************/ 01348000
*                                                                  0494 01349000
*        CALL SAVEPROC(SAVLEN,CONRCPTR,'H');                       0494 01350000
*                                                                  0494 01351000
         LA    @04,SAVLEN                                          0494 01352000
         ST    @04,@AL00001                                        0494 01353000
         LA    @04,CONRCPTR                                        0494 01354000
         ST    @04,@AL00001+4                                      0494 01355000
         LA    @04,@CC01070                                        0494 01356000
         ST    @04,@AL00001+8                                      0494 01357000
         LA    @01,@AL00001                                        0494 01358000
         BAL   @14,SAVEPROC                                        0494 01359000
*        RESPECIFY RTNREG RSTD;                                    0495 01360000
*        TESTRC = RTNREG;                                          0496 01361000
         LR    TESTRC,RTNREG                                       0496 01362000
*        RESPECIFY RTNREG UNRSTD;                                  0497 01363000
*        IF TESTRC ^= 0                                            0498 01364000
*          THEN                                                    0498 01365000
         LTR   TESTRC,TESTRC                                       0498 01366000
         BZ    @RF00498                                            0498 01367000
*            RETURN CODE(LASTCC16);                                0499 01368000
         LA    @15,16                                              0499 01369000
         L     @14,@SA00002                                        0499 01370000
         LM    @00,@12,@SA00002+8                                  0499 01371000
         BR    @14                                                 0499 01372000
*                                                                  0500 01373000
*        /************************************************************/ 01374000
*        /*                                                          */ 01375000
*        /*  NOW SELECT EACH CPL AND INTERROGATE FPL'S FOR FIELD     */ 01376000
*        /*  INFORMATION                                             */ 01377000
*        /*                                                          */ 01378000
*        /************************************************************/ 01379000
*        DO INDXCPL = 1 TO NUMCPL;                                 0500 01380000
*                                                                  0500 01381000
@RF00498 LA    @04,1                                               0500 01382000
         B     @DE00500                                            0500 01383000
@DL00500 DS    0H                                                  0501 01384000
*          /**********************************************************/ 01385000
*          /*                                                        */ 01386000
*          /*  IF WE ARE PROCESSING AN AIX CONTROL RECORD,           */ 01387000
*          /*  CALL CONTRBL WITH TYPE 'G' SPECIFIED.                 */ 01388000
*          /*  OTHERWISE, CALL CONTRBL WITH TYPE 'N' AS AN           */ 01389000
*          /*  ARGUMENT.  ('N' STANDS FOR NEUTRAL--A TYPE            */ 01390000
*          /*  OTHER THAN PATH OR AIX.)  CONTRBL ACTUALLY            */ 01391000
*          /*  BUILDS THE CONTROL RECORD TO BE WRITTEN TO            */ 01392000
*          /*  THE PORTABILITY DATA SET.                             */ 01393000
*          /*                                                        */ 01394000
*          /**********************************************************/ 01395000
*                                                                  0501 01396000
*          IF AIXFLAG = ON & INDXCPL =1                            0501 01397000
*            THEN                                                  0501 01398000
         TM    AIXFLAG,B'10000000'                                 0501 01399000
         BNO   @RF00501                                            0501 01400000
         C     @04,@CF00218                                        0501 01401000
         BNE   @RF00501                                            0501 01402000
*              DO;                                                 0502 01403000
*                                                                  0502 01404000
*              CALL CONTRBL(INDXCPL,CTGTAIX);                      0503 01405000
*                                                                  0503 01406000
         LA    @04,INDXCPL                                         0503 01407000
         ST    @04,@AL00001                                        0503 01408000
         LA    @04,@CC00685                                        0503 01409000
         ST    @04,@AL00001+4                                      0503 01410000
         LA    @01,@AL00001                                        0503 01411000
         BAL   @14,CONTRBL                                         0503 01412000
*              RESPECIFY RTNREG RSTD;                              0504 01413000
*              TESTRC = RTNREG;                                    0505 01414000
         LR    TESTRC,RTNREG                                       0505 01415000
*              RESPECIFY RTNREG UNRSTD;                            0506 01416000
*                                                                  0506 01417000
*              IF TESTRC ^= 0                                      0507 01418000
*               THEN                                               0507 01419000
         LTR   TESTRC,TESTRC                                       0507 01420000
         BZ    @RF00507                                            0507 01421000
*                 /***************************************************/ 01422000
*                 /*                                                 */ 01423000
*                 /*IF SEVERE ERROR RETURN IS WITH TERMINATION CODE  */ 01424000
*                 /*ELSE RETURN INDICATES THIS REQUEST COULD NOT BE  */ 01425000
*                 /*PROCESSED                                        */ 01426000
*                 /*                                                 */ 01427000
*                 /***************************************************/ 01428000
*                 IF TESTRC = LASTCC16                             0508 01429000
*                   THEN                                           0508 01430000
         LA    @03,16                                              0508 01431000
         CR    TESTRC,@03                                          0508 01432000
         BNE   @RF00508                                            0508 01433000
*                     RETURN CODE(LASTCC16);                       0509 01434000
         LR    @15,@03                                             0509 01435000
         L     @14,@SA00002                                        0509 01436000
         LM    @00,@12,@SA00002+8                                  0509 01437000
         BR    @14                                                 0509 01438000
*                   ELSE                                           0510 01439000
*                     RETURN CODE(LASTCC08);                       0510 01440000
@RF00508 LA    @15,8                                               0510 01441000
         L     @14,@SA00002                                        0510 01442000
         LM    @00,@12,@SA00002+8                                  0510 01443000
         BR    @14                                                 0510 01444000
*               ELSE;                                              0511 01445000
*                                                                  0511 01446000
@RF00507 DS    0H                                                  0512 01447000
*              END;                                                0512 01448000
*                                                                  0512 01449000
*            ELSE                                                  0513 01450000
*              DO;                                                 0513 01451000
*                                                                  0513 01452000
         B     @RC00501                                            0513 01453000
@RF00501 DS    0H                                                  0514 01454000
*              CALL CONTRBL(INDXCPL,'N');                          0514 01455000
*                                                                  0514 01456000
         LA    @04,INDXCPL                                         0514 01457000
         ST    @04,@AL00001                                        0514 01458000
         LA    @04,@CC01072                                        0514 01459000
         ST    @04,@AL00001+4                                      0514 01460000
         LA    @01,@AL00001                                        0514 01461000
         BAL   @14,CONTRBL                                         0514 01462000
*              RESPECIFY RTNREG RSTD;                              0515 01463000
*              TESTRC = RTNREG;                                    0516 01464000
         LR    TESTRC,RTNREG                                       0516 01465000
*              RESPECIFY RTNREG UNRSTD;                            0517 01466000
*                                                                  0517 01467000
*              IF TESTRC ^= 0                                      0518 01468000
*                THEN                                              0518 01469000
         LTR   TESTRC,TESTRC                                       0518 01470000
         BZ    @RF00518                                            0518 01471000
*                  /**************************************************/ 01472000
*                  /*                                                */ 01473000
*                  /*IF SEVERE ERROR RETURN IS WITH TERMINATION CODE */ 01474000
*                  /*ELSE RETURN INDICATES THIS REQUEST COULD NOT BE */ 01475000
*                  /*PROCESSED                                       */ 01476000
*                  /*                                                */ 01477000
*                  /**************************************************/ 01478000
*                  IF TESTRC = LASTCC16                            0519 01479000
*                    THEN                                          0519 01480000
         LA    @03,16                                              0519 01481000
         CR    TESTRC,@03                                          0519 01482000
         BNE   @RF00519                                            0519 01483000
*                      RETURN CODE(LASTCC16);                      0520 01484000
         LR    @15,@03                                             0520 01485000
         L     @14,@SA00002                                        0520 01486000
         LM    @00,@12,@SA00002+8                                  0520 01487000
         BR    @14                                                 0520 01488000
*                    ELSE                                          0521 01489000
*                      RETURN CODE(LASTCC08);                      0521 01490000
@RF00519 LA    @15,8                                               0521 01491000
         L     @14,@SA00002                                        0521 01492000
         LM    @00,@12,@SA00002+8                                  0521 01493000
         BR    @14                                                 0521 01494000
*                ELSE;                                             0522 01495000
*                                                                  0522 01496000
@RF00518 DS    0H                                                  0523 01497000
*              END;                                                0523 01498000
*                                                                  0523 01499000
*        END;                                                      0524 01500000
*                                                                  0524 01501000
@RC00501 LA    @04,1                                               0524 01502000
         AL    @04,INDXCPL                                         0524 01503000
@DE00500 ST    @04,INDXCPL                                         0524 01504000
         CR    @04,NUMCPL                                          0524 01505000
         BNH   @DL00500                                            0524 01506000
*                                                                  0525 01507000
*        /************************************************************/ 01508000
*        /*                                                          */ 01509000
*        /*  TEST TO DETERMINE IF THERE ARE PATH                     */ 01510000
*        /*  ASSOCIATIONS PRESENT.  IF SO LOOP, DOING                */ 01511000
*        /*  LOCATES FOR THE PATHS, AND WRITING OUT THE              */ 01512000
*        /*  CATALOG INFORMATION TO THE PORTABILITY                  */ 01513000
*        /*  DATA SET.                                               */ 01514000
*        /*                                                          */ 01515000
*        /************************************************************/ 01516000
*                                                                  0525 01517000
*        IF PATHFLAG = ON                                          0525 01518000
*          THEN                                                    0525 01519000
         TM    PATHFLAG,B'00100000'                                0525 01520000
         BNO   @RF00525                                            0525 01521000
*PTHDEF:     DO;                                                   0526 01522000
*                                                                  0526 01523000
PTHDEF   DS    0H                                                  0527 01524000
*            /********************************************************/ 01525000
*            /*                                                      */ 01526000
*            /*  SET A FLAG TO INDICATE THAT WE ARE PROCESS-         */ 01527000
*            /*  ING THE FIRST PATH.  LOOP THROUGH THE PATHS         */ 01528000
*            /*  DOING LOCATES AND WRITING CATALOG                   */ 01529000
*            /*  INFORMATION TO THE PORTABILITY DATA SET.            */ 01530000
*            /*                                                      */ 01531000
*            /********************************************************/ 01532000
*                                                                  0527 01533000
*            OLDERID2 = NEWERID2;                                  0527 01534000
         L     @04,@PC00001                                        0527 01535000
         L     @04,GDTTR2(,@04)                                    0527 01536000
         MVC   @TS00001(95),NEWERID2(@04)                          0527 01537000
         MVC   OLDERID2(95,@04),@TS00001                           0527 01538000
*            NEWID2 = 'RC11';                                      0528 01539000
*                                                                  0528 01540000
         MVC   NEWID2(4,@04),@CC01075                              0528 01541000
*            FIRFLAG = ON;                                         0529 01542000
*                                                                  0529 01543000
         OI    FIRFLAG,B'00001000'                                 0529 01544000
*PATHREC:    DO I = NUMCPL+1 TO NUMASSOC+1;                        0530 01545000
PATHREC  LA    I,1                                                 0530 01546000
         ALR   I,NUMCPL                                            0530 01547000
         B     @DE00530                                            0530 01548000
@DL00530 DS    0H                                                  0531 01549000
*              CTGPLPTR = PTRCPL(1);                               0531 01550000
         L     @03,PTRCPL                                          0531 01551000
         ST    @03,CTGPLPTR                                        0531 01552000
*              CTGFLPTR = CTGFIELD(INAMEDS);                       0532 01553000
         L     CTGFLPTR,CTGFIELD+84(,@03)                          0532 01554000
*              FNMPTR = CTGFLPT(1) + LNAMEDS * (I - 2);            0533 01555000
*                                                                  0533 01556000
         LR    @03,I                                               0533 01557000
         BCTR  @03,0                                               0533 01558000
         BCTR  @03,0                                               0533 01559000
         SLA   @03,2                                               0533 01560000
         AL    @03,CTGFLPT(,CTGFLPTR)                              0533 01561000
         ST    @03,FNMPTR                                          0533 01562000
*              /******************************************************/ 01563000
*              /*                                                    */ 01564000
*              /*  TEST TO DETERMINE IF THE ASSOCIATED               */ 01565000
*              /*  OBJECT IS A PATH.                                 */ 01566000
*              /*                                                    */ 01567000
*              /******************************************************/ 01568000
*                                                                  0534 01569000
*              IF FTYPE = CTGTPTH                                  0534 01570000
*                THEN                                              0534 01571000
*                                                                  0534 01572000
         CLI   FTYPE(@03),C'R'                                     0534 01573000
         BNE   @RF00534                                            0534 01574000
*                  /**************************************************/ 01575000
*                  /*                                                */ 01576000
*                  /*  TEST TO DETERMINE WHETHER THIS IS THE         */ 01577000
*                  /*  FIRST PATH TO BE PROCESSED.                   */ 01578000
*                  /*                                                */ 01579000
*                  /**************************************************/ 01580000
*                                                                  0535 01581000
*                  IF FIRFLAG = ON                                 0535 01582000
*                    THEN                                          0535 01583000
         TM    FIRFLAG,B'00001000'                                 0535 01584000
         BNO   @RF00535                                            0535 01585000
*FIRPATH:              DO;                                         0536 01586000
*                                                                  0536 01587000
FIRPATH  DS    0H                                                  0537 01588000
*                      FIRFLAG = OFF;                              0537 01589000
*                                                                  0537 01590000
         NI    FIRFLAG,B'11110111'                                 0537 01591000
*                      /**********************************************/ 01592000
*                      /*                                            */ 01593000
*                      /*  IF THIS IS THE FIRST PATH TO BE           */ 01594000
*                      /*  PROCESSED CALL LOCPROC TO BUILD           */ 01595000
*                      /*  THE CPL AND FPL'S.                        */ 01596000
*                      /*                                            */ 01597000
*                      /**********************************************/ 01598000
*                                                                  0538 01599000
*                      CALL LOCPROC(FNAME,PTRCTACB,                0538 01600000
*                        FIELDLST,ONUM,PTRCPL(PTHCPLNO));          0538 01601000
*                                                                  0538 01602000
         L     @01,FNMPTR                                          0538 01603000
         LA    @15,FNAME(,@01)                                     0538 01604000
         ST    @15,@AL00001                                        0538 01605000
         LA    @15,PTRCTACB                                        0538 01606000
         ST    @15,@AL00001+4                                      0538 01607000
         LA    @15,FIELDLST                                        0538 01608000
         ST    @15,@AL00001+8                                      0538 01609000
         LA    @15,ONUM                                            0538 01610000
         ST    @15,@AL00001+12                                     0538 01611000
         LA    @15,PTRCPL+16                                       0538 01612000
         ST    @15,@AL00001+16                                     0538 01613000
         LA    @01,@AL00001                                        0538 01614000
         BAL   @14,LOCPROC                                         0538 01615000
*                      RESPECIFY RTNREG RSTD;                      0539 01616000
*                      TESTRC = RTNREG;                            0540 01617000
         LR    TESTRC,RTNREG                                       0540 01618000
*                      RESPECIFY RTNREG UNRSTD;                    0541 01619000
*                                                                  0541 01620000
*                      IF TESTRC ^= 0                              0542 01621000
*                        THEN                                      0542 01622000
         LTR   TESTRC,TESTRC                                       0542 01623000
         BZ    @RF00542                                            0542 01624000
*                          RETURN CODE(LASTCC16);                  0543 01625000
*                                                                  0543 01626000
         LA    @15,16                                              0543 01627000
         L     @14,@SA00002                                        0543 01628000
         LM    @00,@12,@SA00002+8                                  0543 01629000
         BR    @14                                                 0543 01630000
*                      /**********************************************/ 01631000
*                      /*                                            */ 01632000
*                      /*  SAVE THE CPL AND FPL'S JUST               */ 01633000
*                      /*  CONSTRUCTED FOR USE WITH OTHER            */ 01634000
*                      /*  PATHS.                                    */ 01635000
*                      /*                                            */ 01636000
*                      /**********************************************/ 01637000
*                                                                  0544 01638000
*                      SAPLLEN = LENGTH(SAVEPL);                   0544 01639000
*                                                                  0544 01640000
@RF00542 MVC   SAPLLEN(2),@CH01287                                 0544 01641000
*                      CALL MVDAPROC(SAPLLEN,PTRCPL(PTHCPLNO),     0545 01642000
*                        ADDR(SAVEPL),NULLPARM);                   0545 01643000
*                                                                  0545 01644000
         LA    @15,SAPLLEN                                         0545 01645000
         ST    @15,@AL00001                                        0545 01646000
         LA    @15,PTRCPL+16                                       0545 01647000
         ST    @15,@AL00001+4                                      0545 01648000
         LA    @15,SAVEPL                                          0545 01649000
         ST    @15,@AFTEMPS                                        0545 01650000
         LA    @15,@AFTEMPS                                        0545 01651000
         ST    @15,@AL00001+8                                      0545 01652000
         LA    @15,NULLPARM                                        0545 01653000
         ST    @15,@AL00001+12                                     0545 01654000
         LA    @01,@AL00001                                        0545 01655000
         BAL   @14,MVDAPROC                                        0545 01656000
*                      /**********************************************/ 01657000
*                      /*                                            */ 01658000
*                      /*  CALL CTLGPROC TO ISSUE A UCATLG           */ 01659000
*                      /*  TO DO THE ACTUAL LOCATE.                  */ 01660000
*                      /*                                            */ 01661000
*                      /**********************************************/ 01662000
*                                                                  0546 01663000
*                      CALL CTLGPROC(PTRCPL(PTHCPLNO));            0546 01664000
*                                                                  0546 01665000
         LA    @15,PTRCPL+16                                       0546 01666000
         ST    @15,@AL00001                                        0546 01667000
         LA    @01,@AL00001                                        0546 01668000
         BAL   @14,CTLGPROC                                        0546 01669000
*                      RESPECIFY RTNREG RSTD;                      0547 01670000
*                      TESTRC = RTNREG;                            0548 01671000
         LR    TESTRC,RTNREG                                       0548 01672000
*                      RESPECIFY RTNREG UNRSTD;                    0549 01673000
*                                                                  0549 01674000
*                      IF TESTRC ^= 0                              0550 01675000
*                        THEN                                      0550 01676000
         LTR   TESTRC,TESTRC                                       0550 01677000
         BZ    @RF00550                                            0550 01678000
*                          DO;                                     0551 01679000
*                          /******************************************/ 01680000
*                          /*                                        */ 01681000
*                          /*IF SEVERE ERROR RETURNS WITH TERMINATION*/ 01682000
*                          /*CODE ELSE THIS PATH IS BYPASSED AND     */ 01683000
*                          /*AND PROCESSING CONTINUES AFTER PRINTING */ 01684000
*                          /*WARNING MESSAGE AND SETTING ERROR FLAG  */ 01685000
*                          /*                                        */ 01686000
*                          /******************************************/ 01687000
*                          IF TESTRC = LASTCC16                    0552 01688000
*                            THEN                                  0552 01689000
         LA    @04,16                                              0552 01690000
         CR    TESTRC,@04                                          0552 01691000
         BNE   @RF00552                                            0552 01692000
*                              RETURN CODE(LASTCC16);              0553 01693000
         LR    @15,@04                                             0553 01694000
         L     @14,@SA00002                                        0553 01695000
         LM    @00,@12,@SA00002+8                                  0553 01696000
         BR    @14                                                 0553 01697000
*                            ELSE                                  0554 01698000
*                              DO;                                 0554 01699000
@RF00552 DS    0H                                                  0555 01700000
*                              ERRSAVFL = ON;                      0555 01701000
*                                                                  0555 01702000
         OI    ERRSAVFL,B'00100000'                                0555 01703000
*                              CALL  PRNTPROC(WARNMSG1,PTHCPLMG);  0556 01704000
*                                                                  0556 01705000
         LA    @01,@AL00556                                        0556 01706000
         BAL   @14,PRNTPROC                                        0556 01707000
*                              END;                                0557 01708000
*                          END;                                    0558 01709000
*                                                                  0558 01710000
*                                                                  0558 01711000
*                        ELSE                                      0559 01712000
*                          DO;                                     0559 01713000
         B     @RC00550                                            0559 01714000
@RF00550 DS    0H                                                  0560 01715000
*                          /******************************************/ 01716000
*                          /*                                        */ 01717000
*                          /*  CALL CONTRBL TO BUILD THE CONTROL     */ 01718000
*                          /*  RECORD FOR THE CURRENT PATH AND       */ 01719000
*                          /*  TO WRITE IT AND THE CATALOG WORK      */ 01720000
*                          /*  AREA OUT THE PORTABILITY DATA SET     */ 01721000
*                          /*                                        */ 01722000
*                          /******************************************/ 01723000
*                                                                  0560 01724000
*                          CALL CONTRBL(PTHCPLNO,CTGTPTH);         0560 01725000
*                                                                  0560 01726000
*                                                                  0560 01727000
         LA    @01,@AL00560                                        0560 01728000
         BAL   @14,CONTRBL                                         0560 01729000
*                          RESPECIFY RTNREG RSTD;                  0561 01730000
*                          TESTRC = RTNREG;                        0562 01731000
         LR    TESTRC,RTNREG                                       0562 01732000
*                          RESPECIFY RTNREG UNRSTD;                0563 01733000
*                                                                  0563 01734000
*                          IF TESTRC ^= 0                          0564 01735000
*                            THEN                                  0564 01736000
         LTR   TESTRC,TESTRC                                       0564 01737000
         BZ    @RF00564                                            0564 01738000
*                              DO;                                 0565 01739000
*                              /**************************************/ 01740000
*                              /*                                    */ 01741000
*                              /* IF SEVERE ERROR RETURNS WITH       */ 01742000
*                              /* TERMINATION CODE ELSE BYPASSES     */ 01743000
*                              /* THIS PATH AND PRINTS WARNING       */ 01744000
*                              /* MESSAGE                            */ 01745000
*                              /*                                    */ 01746000
*                              /**************************************/ 01747000
*                              IF TESTRC = LASTCC16                0566 01748000
*                                THEN                              0566 01749000
         LA    @04,16                                              0566 01750000
         CR    TESTRC,@04                                          0566 01751000
         BNE   @RF00566                                            0566 01752000
*                                  RETURN CODE(LASTCC16);          0567 01753000
         LR    @15,@04                                             0567 01754000
         L     @14,@SA00002                                        0567 01755000
         LM    @00,@12,@SA00002+8                                  0567 01756000
         BR    @14                                                 0567 01757000
*                                ELSE                              0568 01758000
*                                  DO;                             0568 01759000
@RF00566 DS    0H                                                  0569 01760000
*                                  ERRSAVFL = ON;                  0569 01761000
*                                                                  0569 01762000
         OI    ERRSAVFL,B'00100000'                                0569 01763000
*                                  CALL  PRNTPROC(WARNMSG1,PTHCPLMG);   01764000
*                                                                  0570 01765000
         LA    @01,@AL00570                                        0570 01766000
         BAL   @14,PRNTPROC                                        0570 01767000
*                                  END;                            0571 01768000
*                              END;                                0572 01769000
*                           END;                                   0573 01770000
*                      END FIRPATH;                                0574 01771000
*                    ELSE                                          0575 01772000
*                      /**********************************************/ 01773000
*                      /*                                            */ 01774000
*                      /*  THIS IS NOT THE FIRST PATH TO BE          */ 01775000
*                      /*  PROCESSED.  RESTORE THE CPL AND           */ 01776000
*                      /*  FPL'S, MODIFY THE CPL TO DO A             */ 01777000
*                      /*  LOCATE ON THE APPROPRIATE PATH            */ 01778000
*                      /*  AND CALL CATALOG.                         */ 01779000
*                      /*                                            */ 01780000
*                      /**********************************************/ 01781000
*NFIRPATH:             DO;                                         0575 01782000
         B     @RC00535                                            0575 01783000
@RF00535 DS    0H                                                  0575 01784000
NFIRPATH DS    0H                                                  0576 01785000
*                      CTGPLPTR = PTRCPL(PTHCPLNO);                0576 01786000
*                                                                  0576 01787000
         L     @15,PTRCPL+16                                       0576 01788000
         ST    @15,CTGPLPTR                                        0576 01789000
*                      CALL MVDAPROC(SAPLLEN,ADDR(SAVEPL),         0577 01790000
*                        PTRCPL(PTHCPLNO),NULLPARM);               0577 01791000
*                                                                  0577 01792000
         LA    @15,SAPLLEN                                         0577 01793000
         ST    @15,@AL00001                                        0577 01794000
         LA    @15,SAVEPL                                          0577 01795000
         ST    @15,@AFTEMPS                                        0577 01796000
         LA    @15,@AFTEMPS                                        0577 01797000
         ST    @15,@AL00001+4                                      0577 01798000
         LA    @15,PTRCPL+16                                       0577 01799000
         ST    @15,@AL00001+8                                      0577 01800000
         LA    @15,NULLPARM                                        0577 01801000
         ST    @15,@AL00001+12                                     0577 01802000
         LA    @01,@AL00001                                        0577 01803000
         BAL   @14,MVDAPROC                                        0577 01804000
*                      CALL MVDAPROC(WKAREALN+LENGTH(PATHREL),     0578 01805000
*                        NULLPARM,CTGWKA,SETZERO);                 0578 01806000
*                                                                  0578 01807000
         MVC   @AL00001(16),@AL00578                               0578 01808000
         L     @01,CTGPLPTR                                        0578 01809000
         LA    @15,CTGWKA(,@01)                                    0578 01810000
         ST    @15,@AL00001+8                                      0578 01811000
         LA    @01,@AL00001                                        0578 01812000
         BAL   @14,MVDAPROC                                        0578 01813000
*                      AREALN = WKAREALN;                          0579 01814000
         L     @15,CTGPLPTR                                        0579 01815000
         L     @01,CTGWKA(,@15)                                    0579 01816000
         MVC   AREALN(2,@01),@CH00812                              0579 01817000
*                      CTGENT = ADDR(FNAME);                       0580 01818000
*                                                                  0580 01819000
         L     @01,FNMPTR                                          0580 01820000
         LA    @14,FNAME(,@01)                                     0580 01821000
         ST    @14,CTGENT(,@15)                                    0580 01822000
*                      /**********************************************/ 01823000
*                      /*                                            */ 01824000
*                      /*  CLEAR THE FPL POINTERS SET BY             */ 01825000
*                      /*  THE PREVIOUS LOCATE.                      */ 01826000
*                      /*                                            */ 01827000
*                      /**********************************************/ 01828000
*                                                                  0581 01829000
*                      DO CLRFDCTR = 1 TO ONUM;                    0581 01830000
         LA    CLRFDCTR,1                                          0581 01831000
         B     @DE00581                                            0581 01832000
@DL00581 DS    0H                                                  0582 01833000
*                        CTGFLPTR = CTGFIELD(CLRFDCTR);            0582 01834000
         LR    @15,CLRFDCTR                                        0582 01835000
         SLA   @15,2                                               0582 01836000
         L     @01,CTGPLPTR                                        0582 01837000
         L     CTGFLPTR,CTGFIELD-4(@15,@01)                        0582 01838000
*                        CTGFLNG(1) = 0;                           0583 01839000
         SLR   @15,@15                                             0583 01840000
         ST    @15,CTGFLNG(,CTGFLPTR)                              0583 01841000
*                        CTGFLPT(1) = NULLPTR;                     0584 01842000
         ST    @15,CTGFLPT(,CTGFLPTR)                              0584 01843000
*                      END;                                        0585 01844000
*                                                                  0585 01845000
         AL    CLRFDCTR,@CF00218                                   0585 01846000
@DE00581 SLR   @02,@02                                             0585 01847000
         IC    @02,ONUM                                            0585 01848000
         CR    CLRFDCTR,@02                                        0585 01849000
         BNH   @DL00581                                            0585 01850000
*                      /**********************************************/ 01851000
*                      /*                                            */ 01852000
*                      /*  CALL CTLGPROC TO ISSUE A UCATLG           */ 01853000
*                      /*  TO DO THE ACTUAL LOCATE.                  */ 01854000
*                      /*                                            */ 01855000
*                      /**********************************************/ 01856000
*                                                                  0586 01857000
*                      CALL CTLGPROC(PTRCPL(PTHCPLNO));            0586 01858000
*                                                                  0586 01859000
         LA    @15,PTRCPL+16                                       0586 01860000
         ST    @15,@AL00001                                        0586 01861000
         LA    @01,@AL00001                                        0586 01862000
         BAL   @14,CTLGPROC                                        0586 01863000
*                      RESPECIFY RTNREG RSTD;                      0587 01864000
*                      TESTRC = RTNREG;                            0588 01865000
         LR    TESTRC,RTNREG                                       0588 01866000
*                      RESPECIFY RTNREG UNRSTD;                    0589 01867000
*                                                                  0589 01868000
*                      IF TESTRC ^= 0                              0590 01869000
*                        THEN                                      0590 01870000
         LTR   TESTRC,TESTRC                                       0590 01871000
         BZ    @RF00590                                            0590 01872000
*                          DO;                                     0591 01873000
*                          /******************************************/ 01874000
*                          /*                                        */ 01875000
*                          /*IF SEVERE ERROR RETURNS WITH TERMINATION*/ 01876000
*                          /*ELSE BYPASSES THIS PATH AND PRINTS      */ 01877000
*                          /*WARNING MESSAGE                         */ 01878000
*                          /*                                        */ 01879000
*                          /******************************************/ 01880000
*                          IF TESTRC = LASTCC16                    0592 01881000
*                            THEN                                  0592 01882000
         LA    @04,16                                              0592 01883000
         CR    TESTRC,@04                                          0592 01884000
         BNE   @RF00592                                            0592 01885000
*                              RETURN CODE(LASTCC16);              0593 01886000
         LR    @15,@04                                             0593 01887000
         L     @14,@SA00002                                        0593 01888000
         LM    @00,@12,@SA00002+8                                  0593 01889000
         BR    @14                                                 0593 01890000
*                            ELSE                                  0594 01891000
*                              DO;                                 0594 01892000
@RF00592 DS    0H                                                  0595 01893000
*                              ERRSAVFL = ON;                      0595 01894000
*                                                                  0595 01895000
         OI    ERRSAVFL,B'00100000'                                0595 01896000
*                              CALL  PRNTPROC(WARNMSG1,PTHCPLMG);  0596 01897000
*                                                                  0596 01898000
         LA    @01,@AL00596                                        0596 01899000
         BAL   @14,PRNTPROC                                        0596 01900000
*                              END;                                0597 01901000
*                          END;                                    0598 01902000
*                        ELSE                                      0599 01903000
*                          DO;                                     0599 01904000
         B     @RC00590                                            0599 01905000
@RF00590 DS    0H                                                  0600 01906000
*                          /******************************************/ 01907000
*                          /*                                        */ 01908000
*                          /*  CALL CONTRBL TO BUILD THE CONTROL     */ 01909000
*                          /*  RECORD FOR THE CURRENT PATH AND       */ 01910000
*                          /*  TO WRITE IT AND THE CATALOG WORK      */ 01911000
*                          /*  AREA OUT THE PORTABILITY DATA SET     */ 01912000
*                          /*                                        */ 01913000
*                          /******************************************/ 01914000
*                                                                  0600 01915000
*                          CALL CONTRBL(PTHCPLNO,CTGTPTH);         0600 01916000
*                                                                  0600 01917000
         LA    @01,@AL00600                                        0600 01918000
         BAL   @14,CONTRBL                                         0600 01919000
*                          RESPECIFY RTNREG RSTD;                  0601 01920000
*                          TESTRC = RTNREG;                        0602 01921000
         LR    TESTRC,RTNREG                                       0602 01922000
*                          RESPECIFY RTNREG UNRSTD;                0603 01923000
*                                                                  0603 01924000
*                          IF TESTRC ^= 0                          0604 01925000
*                            THEN                                  0604 01926000
         LTR   TESTRC,TESTRC                                       0604 01927000
         BZ    @RF00604                                            0604 01928000
*                              DO;                                 0605 01929000
*                              /**************************************/ 01930000
*                              /*                                    */ 01931000
*                              /* IF SEVERE ERROR RETURNS WITH       */ 01932000
*                              /* TERMINATION CODE ELSE BYPASSES     */ 01933000
*                              /* THIS PATH AND PRINTS MESSAGE TO    */ 01934000
*                              /* INDICATE THE ERROR                 */ 01935000
*                              /*                                    */ 01936000
*                              /**************************************/ 01937000
*                              IF TESTRC = LASTCC16                0606 01938000
*                                THEN                              0606 01939000
         LA    @04,16                                              0606 01940000
         CR    TESTRC,@04                                          0606 01941000
         BNE   @RF00606                                            0606 01942000
*                                  RETURN CODE(LASTCC16);          0607 01943000
         LR    @15,@04                                             0607 01944000
         L     @14,@SA00002                                        0607 01945000
         LM    @00,@12,@SA00002+8                                  0607 01946000
         BR    @14                                                 0607 01947000
*                                ELSE                              0608 01948000
*                                  DO;                             0608 01949000
@RF00606 DS    0H                                                  0609 01950000
*                                  ERRSAVFL = ON;                  0609 01951000
*                                                                  0609 01952000
         OI    ERRSAVFL,B'00100000'                                0609 01953000
*                                  CALL  PRNTPROC(WARNMSG1,PTHCPLMG);   01954000
*                                                                  0610 01955000
         LA    @01,@AL00610                                        0610 01956000
         BAL   @14,PRNTPROC                                        0610 01957000
*                                  END;                            0611 01958000
*                              END;                                0612 01959000
*                          END;                                    0613 01960000
*                                                                  0613 01961000
*                      END NFIRPATH;                               0614 01962000
*                                                                  0614 01963000
*                ELSE ;                                            0615 01964000
*                                                                  0615 01965000
@RF00534 DS    0H                                                  0616 01966000
*            END PATHREC;                                          0616 01967000
*                                                                  0616 01968000
@RC00534 AL    I,@CF00218                                          0616 01969000
@DE00530 LA    @15,1                                               0616 01970000
         AH    @15,NUMASSOC                                        0616 01971000
         CR    I,@15                                               0616 01972000
         BNH   @DL00530                                            0616 01973000
*          END PTHDEF;                                             0617 01974000
*                                                                  0617 01975000
*          ELSE  ;                                                 0618 01976000
*                                                                  0618 01977000
@RF00525 DS    0H                                                  0619 01978000
*        /************************************************************/ 01979000
*        /*                                                          */ 01980000
*        /*  CALL OPENPROC TO OPEN THE VSAM CLUSTER FOR INPUT.       */ 01981000
*        /*  IF THE OPEN FAILS, RETURN TO THE CALLING PROCESSOR WITH */ 01982000
*        /*  FAILURE INDICATED                                       */ 01983000
*        /*  IF THE VSAM CLUSTER CONTAINS NO DATA RECORDS BYPASS OPEN*/ 01984000
*        /*                                                          */ 01985000
*        /************************************************************/ 01986000
*                                                                  0619 01987000
*        IF EMPTYDS = OFF                                          0619 01988000
*          THEN                                                    0619 01989000
         L     @15,@PC00001+4                                      0619 01990000
         L     @15,INPPTR(,@15)                                    0619 01991000
         L     @01,INPTBL+4(,@15)                                  0619 01992000
         TM    EMPTYDS(@01),B'00100000'                            0619 01993000
         BNZ   @RF00619                                            0619 01994000
*            DO;                                                   0620 01995000
*                                                                  0620 01996000
*            CALL OPENPROC('I',ADDR(INDDNM),NULLPARM,0,0,          0621 01997000
*              ADDR(PINIOCS));                                     0621 01998000
*                                                                  0621 01999000
         MVC   @AL00001(20),@AL00621                               0621 02000000
         LA    @15,INPTBL+8(,@15)                                  0621 02001000
         ST    @15,@AL00001+4                                      0621 02002000
         LA    @15,PINIOCS                                         0621 02003000
         ST    @15,@AFTEMPS                                        0621 02004000
         LA    @15,@AFTEMPS                                        0621 02005000
         ST    @15,@AL00001+20                                     0621 02006000
         LA    @01,@AL00001                                        0621 02007000
         BAL   @14,OPENPROC                                        0621 02008000
*        RESPECIFY RTNREG RSTD;                                    0622 02009000
*        TESTRC = RTNREG;                                          0623 02010000
         LR    TESTRC,RTNREG                                       0623 02011000
*        RESPECIFY RTNREG UNRSTD;                          /*@OZ05916*/ 02012000
*        IF TESTRC ^= 0                                            0625 02013000
*          THEN                                                    0625 02014000
         LTR   TESTRC,TESTRC                                       0625 02015000
         BZ    @RF00625                                            0625 02016000
*            RETURN CODE(LASTCC08);                                0626 02017000
         LA    @15,8                                               0626 02018000
         L     @14,@SA00002                                        0626 02019000
         LM    @00,@12,@SA00002+8                                  0626 02020000
         BR    @14                                                 0626 02021000
*            END;                                                  0627 02022000
*                                                                  0627 02023000
@RF00625 DS    0H                                                  0628 02024000
*        /************************************************************/ 02025000
*        /*                                                          */ 02026000
*        /*  CALL SAVEPROC TO WRITE THE CONTROL RECORDS TO THE       */ 02027000
*        /*  PORTABILITY DATA SET, RECORD BY RECORD                  */ 02028000
*        /*  IF AN ERROR IS ENCOUNTERED, CONTROL IS RETURNED TO THE  */ 02029000
*        /*  CALLING PROCESSOR.                                      */ 02030000
*        /*                                                          */ 02031000
*        /************************************************************/ 02032000
*                                                                  0628 02033000
*        CALL SAVEPROC(NULLPARM,NULLPARM,'W');                     0628 02034000
*                                                                  0628 02035000
@RF00619 LA    @01,@AL00628                                        0628 02036000
         BAL   @14,SAVEPROC                                        0628 02037000
*        RESPECIFY RTNREG RSTD;                                    0629 02038000
*        TESTRC = RTNREG;                                          0630 02039000
         LR    TESTRC,RTNREG                                       0630 02040000
*        RESPECIFY RTNREG UNRSTD;                                  0631 02041000
*        IF TESTRC ^= 0                                            0632 02042000
*          THEN                                                    0632 02043000
         LTR   TESTRC,TESTRC                                       0632 02044000
         BZ    @RF00632                                            0632 02045000
*            RETURN CODE(LASTCC16);                                0633 02046000
*                                                                  0633 02047000
         LA    @15,16                                              0633 02048000
         L     @14,@SA00002                                        0633 02049000
         LM    @00,@12,@SA00002+8                                  0633 02050000
         BR    @14                                                 0633 02051000
*        /************************************************************/ 02052000
*        /*                                                          */ 02053000
*        /*  CALL RECPROC TO COPY THE CLUSTER DATA SET TO THE        */ 02054000
*        /*  PORTABILITY DATA SET, RECORD BY RECORD                  */ 02055000
*        /*  IF AN ERROR IS ENCOUNTERED, CONTROL IS RETURNED TO THE  */ 02056000
*        /*  CALLING PROCESSOR.                                      */ 02057000
*        /*                                                          */ 02058000
*        /************************************************************/ 02059000
*                                                                  0634 02060000
*        CALL RECPROC;                                             0634 02061000
*                                                                  0634 02062000
@RF00632 BAL   @14,RECPROC                                         0634 02063000
*        RESPECIFY RTNREG RSTD;                                    0635 02064000
*        TESTRC = RTNREG;                                          0636 02065000
         LR    TESTRC,RTNREG                                       0636 02066000
*        RESPECIFY RTNREG UNRSTD;                                  0637 02067000
*        IF TESTRC ^= 0                                            0638 02068000
*          THEN                                                    0638 02069000
         LTR   TESTRC,TESTRC                                       0638 02070000
         BZ    @RF00638                                            0638 02071000
*            /********************************************************/ 02072000
*            /*                                                      */ 02073000
*            /* IF SEVERE ERROR RETURNS WITH TERMINATION CODE        */ 02074000
*            /*                                                      */ 02075000
*            /********************************************************/ 02076000
*            IF TESTRC ^= LASTCC08                                 0639 02077000
*              THEN                                                0639 02078000
         C     TESTRC,@CF00178                                     0639 02079000
         BE    @RF00639                                            0639 02080000
*                IF TESTRC = LASTCC12                              0640 02081000
*                  THEN                                            0640 02082000
         LA    @03,12                                              0640 02083000
         CR    TESTRC,@03                                          0640 02084000
         BNE   @RF00640                                            0640 02085000
*                    RETURN CODE(LASTCC12);                        0641 02086000
         LR    @15,@03                                             0641 02087000
         L     @14,@SA00002                                        0641 02088000
         LM    @00,@12,@SA00002+8                                  0641 02089000
         BR    @14                                                 0641 02090000
*                  ELSE                                            0642 02091000
*                    RETURN CODE(LASTCC16);                        0642 02092000
@RF00640 LA    @15,16                                              0642 02093000
         L     @14,@SA00002                                        0642 02094000
         LM    @00,@12,@SA00002+8                                  0642 02095000
         BR    @14                                                 0642 02096000
*              ELSE                                                0643 02097000
*                /****************************************************/ 02098000
*                /*                                                  */ 02099000
*                /* ERROR CLOSING INPUT DATA SET -- CONTINUE         */ 02100000
*                /*                                                  */ 02101000
*                /****************************************************/ 02102000
*                ERRSAVFL = ON;                                    0643 02103000
*                                                                  0643 02104000
@RF00639 OI    ERRSAVFL,B'00100000'                                0643 02105000
*        /************************************************************/ 02106000
*        /*                                                          */ 02107000
*        /*WRITE A SOFTWARE END OF FILE ON THE PORTABILITY DATA SET  */ 02108000
*        /*                                                          */ 02109000
*        /************************************************************/ 02110000
*                                                                  0644 02111000
*        CALL  PUTPROC(NULLPARM,NULLPARM);                         0644 02112000
*                                                                  0644 02113000
@RF00638 LA    @01,@AL00644                                        0644 02114000
         BAL   @14,PUTPROC                                         0644 02115000
*        RESPECIFY RTNREG RSTD;                                    0645 02116000
*        TESTRC = RTNREG;                                          0646 02117000
         LR    TESTRC,RTNREG                                       0646 02118000
*        RESPECIFY RTNREG UNRSTD;                                  0647 02119000
*        IF TESTRC ^= 0                                            0648 02120000
*          THEN                                                    0648 02121000
         LTR   TESTRC,TESTRC                                       0648 02122000
         BZ    @RF00648                                            0648 02123000
*            RETURN CODE(LASTCC16);                                0649 02124000
*                                                                  0649 02125000
         LA    @15,16                                              0649 02126000
         L     @14,@SA00002                                        0649 02127000
         LM    @00,@12,@SA00002+8                                  0649 02128000
         BR    @14                                                 0649 02129000
*        /************************************************************/ 02130000
*        /*                                                          */ 02131000
*        /*  RETURN TO MAIN PROCEDURE WITH SUCCESS INDICATED         */ 02132000
*        /*                                                          */ 02133000
*        /************************************************************/ 02134000
*        RETURN CODE(0);                                           0650 02135000
*                                                                  0650 02136000
@RF00648 SLR   @15,@15                                             0650 02137000
         L     @14,@SA00002                                        0650 02138000
         LM    @00,@12,@SA00002+8                                  0650 02139000
         BR    @14                                                 0650 02140000
*END CLUSPROC;                                                     0651 02141000
*        /************************************************************/ 02142000
*        /*                                                          */ 02143000
*        /* PROCEDURE NAME - LOCPROC                                 */ 02144000
*        /*                                                          */ 02145000
*        /*  FUNCTION - BUILD A CPL AND A MULTITUDE OF FPL'S FOR     */ 02146000
*        /*  USE BY CATALOG LOCATE                                   */ 02147000
*        /*                                                          */ 02148000
*        /*  INPUT -                                                 */ 02149000
*        /*    . LCINUM - CONTROL INTERVAL NUMBER (LOCATE BY         */ 02150000
*        /*      CONTROL INTERVAL)                                   */ 02151000
*        /*    . LCATACB - CATALOG ACB ADDRESS                       */ 02152000
*        /*    . LFLDLST - LIST OF CATALOG FIELD NAMES. AN FPL IS    */ 02153000
*        /*      CONSTRUCTED FOR EACH ONE.                           */ 02154000
*        /*    . LFLDNUM - NUMBER OF NAMES IN FIELD LIST             */ 02155000
*        /*    . LCPLPTR - RETURN CELL FOR CPL ADDRESS               */ 02156000
*        /*    . IVOLSER - INDEX TO VOLUME SERIAL FPL                */ 02157000
*        /*                                                          */ 02158000
*        /*  OUTPUT- CPL ADDRESS                                     */ 02159000
*        /*                                                          */ 02160000
*        /************************************************************/ 02161000
*                                                                  0652 02162000
*LOCPROC:  PROCEDURE(LCINUM,           /*CONTROL INTERVAL NUMBER     */ 02163000
*                    LCATACB,          /*CATALOG ACB ADDRESS         */ 02164000
*                    LFLDLST,          /*LIST OF CATALOG FIELD NAMES */ 02165000
*                    LFLDNUM,          /*NUMBER OF FIELDS IN LIST    */ 02166000
*                    LCPLPTR);         /*RETURN CELL FOR CPL POINTER */ 02167000
*                                                                  0652 02168000
LOCPROC  STM   @14,@12,@SA00003                                    0652 02169000
         MVC   @PC00003(20),0(@01)                                 0652 02170000
*        /************************************************************/ 02171000
*        /*                                                          */ 02172000
*        /*  ARGUMENTS OF INVOCATION                                 */ 02173000
*        /*                                                          */ 02174000
*        /************************************************************/ 02175000
*                                                                  0653 02176000
*        DCL                                                       0653 02177000
*          LCINUM     FIXED(24),                                   0653 02178000
*          LCATACB    PTR(31),                                     0653 02179000
*          LFLDLST(*) CHAR(8),                                     0653 02180000
*          LFLDNUM    PTR(8),                                      0653 02181000
*          LCPLPTR    PTR(31);                                     0653 02182000
*                                                                  0653 02183000
*        /************************************************************/ 02184000
*        /*                                                          */ 02185000
*        /* LOCAL DECLARATIONS                                       */ 02186000
*        /*                                                          */ 02187000
*        /************************************************************/ 02188000
*                                                                  0654 02189000
*        DCL CITYPEXT CHAR(8) INIT('ITYPEXT ');                    0654 02190000
*        DCL SSFLAG   CHAR(1) INIT('80'X);                         0655 02191000
*                                                                  0655 02192000
*        /************************************************************/ 02193000
*        /*                                                          */ 02194000
*        /*  COMPUTE HOW MUCH CORE NECESSARY FOR ONE CPL AND THE     */ 02195000
*        /*  NUMBER OF FPL'S SPECIFIED BY FLDNUM, AND GET A CHUNK    */ 02196000
*        /*  OF CORE.  GET A SEPARATE CHUNK OF CORE FOR THE WORK AREA*/ 02197000
*        /*  IF CORE IS NOT OBTAINED, CONTROL IS RETURNED TO THE     */ 02198000
*        /*  CALLING PROCESSOR WITH FAILURE INDICATED                */ 02199000
*        /*                                                          */ 02200000
*        /************************************************************/ 02201000
*                                                                  0656 02202000
*        OLDERID2 = NEWERID2;                                      0656 02203000
         L     @03,@PC00001                                        0656 02204000
         L     @15,GDTTR2(,@03)                                    0656 02205000
         MVC   @TS00001(95),NEWERID2(@15)                          0656 02206000
         MVC   OLDERID2(95,@15),@TS00001                           0656 02207000
*        NEWID2 = 'RC13';                                          0657 02208000
*                                                                  0657 02209000
         MVC   NEWID2(4,@15),@CC01102                              0657 02210000
*        TOTLEN = LENGTH(CTGPL) + LFLDNUM*4                        0658 02211000
*                  + (LENGTH(CTGFL) + 8) * (LFLDNUM + 1);          0658 02212000
*                                                                  0658 02213000
         L     @15,@PC00003+12                                     0658 02214000
         SLR   @14,@14                                             0658 02215000
         IC    @14,LFLDNUM(,@15)                                   0658 02216000
         LR    @15,@14                                             0658 02217000
         SLA   @15,2                                               0658 02218000
         AL    @15,@CF01286                                        0658 02219000
         AL    @14,@CF00218                                        0658 02220000
         MH    @14,@CH00309                                        0658 02221000
         ALR   @15,@14                                             0658 02222000
         ST    @15,TOTLEN                                          0658 02223000
*        CALL IDCSAGP0 (GDTTBL,TOTLEN,LCPLPTR,GPID,SETZERO);       0659 02224000
*                                                                  0659 02225000
         ST    @03,@AL00001                                        0659 02226000
         LA    @15,TOTLEN                                          0659 02227000
         ST    @15,@AL00001+4                                      0659 02228000
         L     @15,@PC00003+16                                     0659 02229000
         ST    @15,@AL00001+8                                      0659 02230000
         LA    @15,GPID                                            0659 02231000
         ST    @15,@AL00001+12                                     0659 02232000
         LA    @15,SETZERO                                         0659 02233000
         ST    @15,@AL00001+16                                     0659 02234000
         MVI   @AL00001+16,X'80'                                   0659 02235000
         L     @15,GDTGPL(,@03)                                    0659 02236000
         LA    @01,@AL00001                                        0659 02237000
         BALR  @14,@15                                             0659 02238000
*        RESPECIFY RTNREG RSTD;                                    0660 02239000
*        TESTRC = RTNREG;                                          0661 02240000
         LR    TESTRC,RTNREG                                       0661 02241000
*        RESPECIFY RTNREG UNRSTD;                                  0662 02242000
*        IF TESTRC ^= 0                                            0663 02243000
*          THEN                                                    0663 02244000
         LTR   TESTRC,TESTRC                                       0663 02245000
         BZ    @RF00663                                            0663 02246000
*            DO;                                                   0664 02247000
*            DARGSMOD = UNIVMSG;                                   0665 02248000
         L     @15,DDSTRU                                          0665 02249000
         MVC   DARGSMOD(3,@15),@CC00847                            0665 02250000
*            DARGSENT = NOSTORAG;                                  0666 02251000
         MVI   DARGSENT(@15),X'04'                                 0666 02252000
*            RETURN CODE(LASTCC16);                                0667 02253000
         LA    @15,16                                              0667 02254000
         L     @14,@SA00003                                        0667 02255000
         LM    @00,@12,@SA00003+8                                  0667 02256000
         BR    @14                                                 0667 02257000
*            END;                                                  0668 02258000
*                                                                  0668 02259000
*        CTGPLPTR = LCPLPTR;                                       0669 02260000
*                                                                  0669 02261000
@RF00663 L     @03,@PC00003+16                                     0669 02262000
         L     @03,LCPLPTR(,@03)                                   0669 02263000
         ST    @03,CTGPLPTR                                        0669 02264000
*        /************************************************************/ 02265000
*        /*                                                          */ 02266000
*        /*  GET WORK AREA CORE FOR CATALOG MANAGEMENT LOCATE        */ 02267000
*        /*  IF CORE NOT OBTAINED - TERMINATE                        */ 02268000
*        /*                                                          */ 02269000
*        /************************************************************/ 02270000
*                                                                  0670 02271000
*        CALL IDCSAGP0 (GDTTBL,WKAREALN+LENGTH(PATHREL),           0670 02272000
*          CTGWKA,GPID,SETZERO);                                   0670 02273000
*                                                                  0670 02274000
         MVC   @AL00001+4(16),@AL00670                             0670 02275000
         L     @15,@PC00001                                        0670 02276000
         ST    @15,@AL00001                                        0670 02277000
         LA    @03,CTGWKA(,@03)                                    0670 02278000
         ST    @03,@AL00001+8                                      0670 02279000
         L     @15,GDTGPL(,@15)                                    0670 02280000
         LA    @01,@AL00001                                        0670 02281000
         BALR  @14,@15                                             0670 02282000
*        RESPECIFY RTNREG RSTD;                                    0671 02283000
*        TESTRC = RTNREG;                                          0672 02284000
         LR    TESTRC,RTNREG                                       0672 02285000
*        RESPECIFY RTNREG UNRSTD;                                  0673 02286000
*                                                                  0673 02287000
*        IF TESTRC ^= 0                                            0674 02288000
*          THEN                                                    0674 02289000
         LTR   TESTRC,TESTRC                                       0674 02290000
         BZ    @RF00674                                            0674 02291000
*            DO;                                                   0675 02292000
*            DARGSMOD = UNIVMSG;                                   0676 02293000
         L     @15,DDSTRU                                          0676 02294000
         MVC   DARGSMOD(3,@15),@CC00847                            0676 02295000
*            DARGSENT = NOSTORAG;                                  0677 02296000
         MVI   DARGSENT(@15),X'04'                                 0677 02297000
*            RETURN CODE(LASTCC16);                                0678 02298000
         LA    @15,16                                              0678 02299000
         L     @14,@SA00003                                        0678 02300000
         LM    @00,@12,@SA00003+8                                  0678 02301000
         BR    @14                                                 0678 02302000
*            END;                                                  0679 02303000
*                                                                  0679 02304000
*        AREALN = WKAREALN;                                        0680 02305000
*                                                                  0680 02306000
@RF00674 L     @15,CTGPLPTR                                        0680 02307000
         L     @01,CTGWKA(,@15)                                    0680 02308000
         MVC   AREALN(2,@01),@CH00812                              0680 02309000
*        /************************************************************/ 02310000
*        /*                                                          */ 02311000
*        /*  INITIALIZE CPL POINTER TO CATALOG NAME OR ACB PTR OR 0  */ 02312000
*        /*                                                          */ 02313000
*        /************************************************************/ 02314000
*                                                                  0681 02315000
*        IF LCATACB ^= NULLPTR                                     0681 02316000
*          THEN                                                    0681 02317000
         L     @14,@PC00003+4                                      0681 02318000
         L     @07,LCATACB(,@14)                                   0681 02319000
         LTR   @07,@07                                             0681 02320000
         BZ    @RF00681                                            0681 02321000
*            CTGCAT = ADDR(LCATACB);                               0682 02322000
         ST    @14,CTGCAT(,@15)                                    0682 02323000
*          ELSE                                                    0683 02324000
*            CTGCNAME = ON;                                        0683 02325000
*                                                                  0683 02326000
         B     @RC00681                                            0683 02327000
@RF00681 L     @01,CTGPLPTR                                        0683 02328000
         OI    CTGCNAME(@01),B'00000010'                           0683 02329000
*        /************************************************************/ 02330000
*        /*                                                          */ 02331000
*        /*  SET OPTIONS FLAGS IN CPL FOR LOCATE                     */ 02332000
*        /*                                                          */ 02333000
*        /************************************************************/ 02334000
*                                                                  0684 02335000
*        CTGAM0 = ON;                                              0684 02336000
@RC00681 DS    0H                                                  0685 02337000
*        CTGNUM = ON;                                              0685 02338000
         L     @15,CTGPLPTR                                        0685 02339000
         OI    CTGAM0(@15),B'00000011'                             0685 02340000
*        CTGFUNC = CTGLOC;                                         0686 02341000
         NI    CTGFUNC(@15),B'00111111'                            0686 02342000
         OI    CTGFUNC(@15),B'00100000'                            0686 02343000
*        CTGENT = ADDR(LCINUM);                                    0687 02344000
*                                                                  0687 02345000
         L     @14,@PC00003                                        0687 02346000
         ST    @14,CTGENT(,@15)                                    0687 02347000
*        /************************************************************/ 02348000
*        /*                                                          */ 02349000
*        /*  SET PASSWORD IF SPECIFIED IN AMS COMMAND                */ 02350000
*        /*                                                          */ 02351000
*        /************************************************************/ 02352000
*                                                                  0688 02353000
*        IF OBJPLN > 0                                             0688 02354000
*          THEN                                                    0688 02355000
         L     @14,@PC00001+4                                      0688 02356000
         L     @01,INPPTR(,@14)                                    0688 02357000
         L     @14,INPTBL(,@01)                                    0688 02358000
         CLI   OBJPLN(@14),0                                       0688 02359000
         BNH   @RF00688                                            0688 02360000
*            CTGPSWD = ADDR(OBJPAS);                               0689 02361000
         LA    @14,OBJPAS(,@14)                                    0689 02362000
         ST    @14,CTGPSWD(,@15)                                   0689 02363000
*        /************************************************************/ 02364000
*        /*                                                          */ 02365000
*        /*  BUILD A FPL FOR EACH CATALOG FIELD NAME IN THE FIELD    */ 02366000
*        /*  LIST.  THE FPLS WILL BE BUILT FOLLOWING THE CPL         */ 02367000
*        /*                                                          */ 02368000
*        /************************************************************/ 02369000
*                                                                  0690 02370000
*        CTGFLPTR = CTGPLPTR + LENGTH(CTGPL) + LFLDNUM*4;          0690 02371000
@RF00688 L     @15,CTGPLPTR                                        0690 02372000
         LA    CTGFLPTR,28                                         0690 02373000
         ALR   CTGFLPTR,@15                                        0690 02374000
         L     @03,@PC00003+12                                     0690 02375000
         SLR   @14,@14                                             0690 02376000
         IC    @14,LFLDNUM(,@03)                                   0690 02377000
         LR    @03,@14                                             0690 02378000
         SLA   @03,2                                               0690 02379000
         ALR   CTGFLPTR,@03                                        0690 02380000
*        CTGNOFLD = LFLDNUM;                                       0691 02381000
*                                                                  0691 02382000
         STC   @14,CTGNOFLD(,@15)                                  0691 02383000
*          /**********************************************************/ 02384000
*          /*                                                        */ 02385000
*          /*  LFLDNUM CONTAINS THE NUMBER OF FIELDNAMES, HENCE      */ 02386000
*          /*  THE NUMBER OF FPLS TO BE CONSTRUCTED.  THE CPL        */ 02387000
*          /*  CONTAINS A POINTER TO EACH FPL IN THE ARRAY CTGFIELD  */ 02388000
*          /*                                                        */ 02389000
*          /**********************************************************/ 02390000
*                                                                  0692 02391000
*        DO INDX = 1 TO LFLDNUM;                                   0692 02392000
         LA    INDX,1                                              0692 02393000
         B     @DE00692                                            0692 02394000
@DL00692 DS    0H                                                  0693 02395000
*          CTGFIELD(INDX) = CTGFLPTR;                              0693 02396000
         LR    @05,INDX                                            0693 02397000
         SLA   @05,2                                               0693 02398000
         L     @03,CTGPLPTR                                        0693 02399000
         ST    CTGFLPTR,CTGFIELD-4(@05,@03)                        0693 02400000
*          CTGFLDNO = '00000001'B;                                 0694 02401000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0694 02402000
*          CTGFLDNM = ADDR(LFLDLST(INDX));                         0695 02403000
         LR    @05,INDX                                            0695 02404000
         SLA   @05,3                                               0695 02405000
         L     @03,@PC00003+8                                      0695 02406000
         AL    @03,@CF01313                                        0695 02407000
         LA    @05,LFLDLST(@05,@03)                                0695 02408000
         ST    @05,CTGFLDNM(,CTGFLPTR)                             0695 02409000
*          CTGFLPTR = CTGFLPTR + LENGTH(CTGFL) + 8;                0696 02410000
*                                                                  0696 02411000
         LA    @05,24                                              0696 02412000
         ALR   CTGFLPTR,@05                                        0696 02413000
*          /**********************************************************/ 02414000
*          /*                                                        */ 02415000
*          /*  IF CONSTRUCTING A VOLSER FPL, CONSTRUCT AN ADDITIONAL */ 02416000
*          /*  FPL TO BE CHAINED TO THE VOLSER FPL FOR THE TEST      */ 02417000
*          /*  SO THAT CATALOG MANAGEMENT WILL NOT RETURN SEQUENCE   */ 02418000
*          /*  SET VOLUMES(IMBED FEATURE)                            */ 02419000
*          /*                                                        */ 02420000
*          /**********************************************************/ 02421000
*                                                                  0697 02422000
*          IF INDX = IVOLSR                                        0697 02423000
*            THEN                                                  0697 02424000
         C     INDX,@CF00893                                       0697 02425000
         BNE   @RF00697                                            0697 02426000
*              DO;                                                 0698 02427000
*              CTGFIELD(INDX) -> CTGFLCHN = CTGFLPTR;              0699 02428000
         LR    @03,INDX                                            0699 02429000
         SLA   @03,2                                               0699 02430000
         L     @01,CTGPLPTR                                        0699 02431000
         L     @03,CTGFIELD-4(@03,@01)                             0699 02432000
         ST    CTGFLPTR,CTGFLCHN(,@03)                             0699 02433000
*              CTGFLDNO = '00000001'B;                             0700 02434000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0700 02435000
*              CTGFLDCD = CTGFLDZ;                                 0701 02436000
         MVI   CTGFLDCD(CTGFLPTR),X'80'                            0701 02437000
*              CTGFLDNM = ADDR(CITYPEXT);                          0702 02438000
         LA    @03,CITYPEXT                                        0702 02439000
         ST    @03,CTGFLDNM(,CTGFLPTR)                             0702 02440000
*              CTGFLNG(1) = 1;                                     0703 02441000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00218                        0703 02442000
*              CTGFLPT(1) = ADDR(SSFLAG);                          0704 02443000
         LA    @03,SSFLAG                                          0704 02444000
         ST    @03,CTGFLPT(,CTGFLPTR)                              0704 02445000
*              CTGFLPTR = CTGFLPTR + LENGTH(CTGFL) + 8;            0705 02446000
         ALR   CTGFLPTR,@05                                        0705 02447000
*              END;                                                0706 02448000
*        END;                                                      0707 02449000
*                                                                  0707 02450000
@RF00697 AL    INDX,@CF00218                                       0707 02451000
@DE00692 L     @05,@PC00003+12                                     0707 02452000
         SLR   @03,@03                                             0707 02453000
         IC    @03,LFLDNUM(,@05)                                   0707 02454000
         CR    INDX,@03                                            0707 02455000
         BNH   @DL00692                                            0707 02456000
*        /************************************************************/ 02457000
*        /*                                                          */ 02458000
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */ 02459000
*        /*                                                          */ 02460000
*        /************************************************************/ 02461000
*                                                                  0708 02462000
*        RETURN CODE(0);                                           0708 02463000
*                                                                  0708 02464000
         SLR   @15,@15                                             0708 02465000
         L     @14,@SA00003                                        0708 02466000
         LM    @00,@12,@SA00003+8                                  0708 02467000
         BR    @14                                                 0708 02468000
*END LOCPROC;                                                      0709 02469000
*        /************************************************************/ 02470000
*        /*                                                          */ 02471000
*        /* PROCEDURE NAME - CTLGPROC                                */ 02472000
*        /*                                                          */ 02473000
*        /*  FUNCTION - INVOKE THE VSAM CATALOG MANAGEMENT TO PERFORM*/ 02474000
*        /*  THE OPERATION INDICATED IN THE CPL (LOCATE)             */ 02475000
*        /*  EXAMINE THE RETURN CODE FROM CATALOG MANAGEMENT,GET MORE*/ 02476000
*        /*  CATALOG WORK AREA IF REQUIRED, SET UP APPROPRIATE ERROR */ 02477000
*        /*  INDICATORS                                              */ 02478000
*        /*                                                          */ 02479000
*        /*  INPUT - CATALOG PARAMETER LIST(CPL)                     */ 02480000
*        /*                                                          */ 02481000
*        /*  OUTPUT - RETURN CODE IS SET TO INDICATE SUCCESS OR      */ 02482000
*        /*  FAILURE.                                                */ 02483000
*        /*                                                          */ 02484000
*        /************************************************************/ 02485000
*                                                                  0710 02486000
*CTLGPROC:  PROCEDURE(SCPLPTR);         /*CPL POINTER                */ 02487000
*                                                                  0710 02488000
CTLGPROC STM   @14,@12,@SA00004                                    0710 02489000
         MVC   @PC00004(4),0(@01)                                  0710 02490000
*        /************************************************************/ 02491000
*        /*                                                          */ 02492000
*        /*  ARGUMENTS OF INVOCATION                                 */ 02493000
*        /*                                                          */ 02494000
*        /************************************************************/ 02495000
*                                                                  0711 02496000
*        DCL SCPLPTR PTR(31);                                      0711 02497000
*                                                                  0711 02498000
*        /************************************************************/ 02499000
*        /*                                                          */ 02500000
*        /* LOCAL DECLARATIONS                                       */ 02501000
*        /*                                                          */ 02502000
*        /************************************************************/ 02503000
*                                                                  0712 02504000
*        DCL WSIZE   FIXED(31);        /*SIZE OF WORK AREA NEEDED BY */ 02505000
*                                      /*VSAM CATALOG MANAGEMENT     */ 02506000
*                                                                  0713 02507000
*        /************************************************************/ 02508000
*        /*                                                          */ 02509000
*        /*  INVOKE CATALOG MANAGEMENT                               */ 02510000
*        /*                                                          */ 02511000
*        /************************************************************/ 02512000
*                                                                  0713 02513000
*        OLDERID2 = NEWERID2;                                      0713 02514000
         L     @15,@PC00001                                        0713 02515000
         L     @14,GDTTR2(,@15)                                    0713 02516000
         MVC   @TS00001(95),NEWERID2(@14)                          0713 02517000
         MVC   OLDERID2(95,@14),@TS00001                           0713 02518000
*        NEWID2 = 'RC15';                                          0714 02519000
         MVC   NEWID2(4,@14),@CC01110                              0714 02520000
*        IF GDTDBG = NULLPTR                                       0715 02521000
*          THEN;                                                   0715 02522000
         L     @15,GDTDBG(,@15)                                    0715 02523000
         LTR   @15,@15                                             0715 02524000
         BZ    @RT00715                                            0715 02525000
*          ELSE                                                    0717 02526000
*            CALL IDCDB010 (GDTTBL,'RC16');                        0717 02527000
*                                                                  0717 02528000
         L     @15,@PC00001                                        0717 02529000
         ST    @15,@AL00001                                        0717 02530000
         LA    @14,@CC01111                                        0717 02531000
         ST    @14,@AL00001+4                                      0717 02532000
         MVI   @AL00001+4,X'80'                                    0717 02533000
         L     @15,GDTDBG(,@15)                                    0717 02534000
         LA    @01,@AL00001                                        0717 02535000
         BALR  @14,@15                                             0717 02536000
*        CATRTNID = 'CATLGRTN';                                    0718 02537000
*                                                                  0718 02538000
@RT00715 MVC   CATRTNID(8),@CC01112                                0718 02539000
*        CALL IDCSACA0 (GDTTBL,SCPLPTR);                           0719 02540000
*                                                                  0719 02541000
         L     @15,@PC00001                                        0719 02542000
         ST    @15,@AL00001                                        0719 02543000
         L     @14,@PC00004                                        0719 02544000
         ST    @14,@AL00001+4                                      0719 02545000
         L     @15,GDTCAT(,@15)                                    0719 02546000
         LA    @01,@AL00001                                        0719 02547000
         BALR  @14,@15                                             0719 02548000
*        RESPECIFY REG15 RSTD;                                     0720 02549000
*        CATLGRC = REG15;                                          0721 02550000
         STH   REG15,CATLGRC                                       0721 02551000
*        RESPECIFY REG15 UNRSTD;                                   0722 02552000
*        /************************************************************/ 02553000
*        /*                                                          */ 02554000
*        /*  IF THE RETURN CODE INDICATES AN ERROR, TEST FOR WORK    */ 02555000
*        /*  AREA TOO SMALL.  IF IT IS, GET A NEW WORK AREA AFTER    */ 02556000
*        /*  FREEING THE OLD ONE.  RE-INVOKE CATALOG MANAGEMENT      */ 02557000
*        /*                                                          */ 02558000
*        /************************************************************/ 02559000
*                                                                  0723 02560000
*        IF CATLGRC ^= 0                                           0723 02561000
*          THEN                                                    0723 02562000
         LH    @15,CATLGRC                                         0723 02563000
         LTR   @15,@15                                             0723 02564000
         BZ    @RF00723                                            0723 02565000
*            IF CATLGRC = 40                                       0724 02566000
*              THEN                                                0724 02567000
         C     @15,@CF01113                                        0724 02568000
         BNE   @RF00724                                            0724 02569000
*                DO;                                               0725 02570000
*                                                                  0725 02571000
*                /****************************************************/ 02572000
*                /*                                                  */ 02573000
*                /*  GET NEEDED SIZE FROM CATALOG WORKARE AT OFFSET  */ 02574000
*                /*  AND OBTAIN CORE.  IF SIZE NOT RETURNED OR       */ 02575000
*                /*  CORE NOT OBTAINED - TERMINATE                   */ 02576000
*                /*                                                  */ 02577000
*                /****************************************************/ 02578000
*                                                                  0726 02579000
*                CTGPLPTR = SCPLPTR;                               0726 02580000
         L     @15,@PC00004                                        0726 02581000
         L     @15,SCPLPTR(,@15)                                   0726 02582000
         ST    @15,CTGPLPTR                                        0726 02583000
*                WSIZE = RETURNLN;                                 0727 02584000
*                                                                  0727 02585000
         L     @01,CTGWKA(,@15)                                    0727 02586000
         LH    WSIZE,RETURNLN(,@01)                                0727 02587000
*                CALL IDCSAFS0 (GDTTBL,CTGWKA);                    0728 02588000
*                                                                  0728 02589000
         L     @14,@PC00001                                        0728 02590000
         ST    @14,@AL00001                                        0728 02591000
         LA    @15,CTGWKA(,@15)                                    0728 02592000
         ST    @15,@AL00001+4                                      0728 02593000
         L     @15,GDTFSP(,@14)                                    0728 02594000
         LA    @01,@AL00001                                        0728 02595000
         BALR  @14,@15                                             0728 02596000
*                CALL IDCSAGP0 (GDTTBL,WSIZE + LENGTH(PATHREL),    0729 02597000
*                  CTGWKA,GPID,SETZERO);                           0729 02598000
         L     @15,@PC00001                                        0729 02599000
         ST    @15,@AL00001                                        0729 02600000
         LA    @14,52                                              0729 02601000
         ALR   @14,WSIZE                                           0729 02602000
         ST    @14,@AFTEMPS+4                                      0729 02603000
         LA    @14,@AFTEMPS+4                                      0729 02604000
         ST    @14,@AL00001+4                                      0729 02605000
         L     @01,CTGPLPTR                                        0729 02606000
         LA    @14,CTGWKA(,@01)                                    0729 02607000
         ST    @14,@AL00001+8                                      0729 02608000
         LA    @14,GPID                                            0729 02609000
         ST    @14,@AL00001+12                                     0729 02610000
         LA    @14,SETZERO                                         0729 02611000
         ST    @14,@AL00001+16                                     0729 02612000
         MVI   @AL00001+16,X'80'                                   0729 02613000
         L     @15,GDTGPL(,@15)                                    0729 02614000
         LA    @01,@AL00001                                        0729 02615000
         BALR  @14,@15                                             0729 02616000
*                RESPECIFY RTNREG RSTD;                            0730 02617000
*                TESTRC = RTNREG;                                  0731 02618000
         LR    TESTRC,RTNREG                                       0731 02619000
*                RESPECIFY RTNREG UNRSTD;                          0732 02620000
*                IF TESTRC ^= 0                                    0733 02621000
*                  THEN                                            0733 02622000
         LTR   TESTRC,TESTRC                                       0733 02623000
         BZ    @RF00733                                            0733 02624000
*                    DO;                                           0734 02625000
*                    DARGSMOD = UNIVMSG;                           0735 02626000
         L     @15,DDSTRU                                          0735 02627000
         MVC   DARGSMOD(3,@15),@CC00847                            0735 02628000
*                    DARGSENT = NOSTORAG;                          0736 02629000
         MVI   DARGSENT(@15),X'04'                                 0736 02630000
*                    RETURN CODE(LASTCC16);                        0737 02631000
         LA    @15,16                                              0737 02632000
         L     @14,@SA00004                                        0737 02633000
         LM    @00,@12,@SA00004+8                                  0737 02634000
         BR    @14                                                 0737 02635000
*                    END;                                          0738 02636000
*                                                                  0738 02637000
*                AREALN = WSIZE;                                   0739 02638000
*                                                                  0739 02639000
@RF00733 L     @02,CTGPLPTR                                        0739 02640000
         L     @02,CTGWKA(,@02)                                    0739 02641000
         STH   WSIZE,AREALN(,@02)                                  0739 02642000
*                /****************************************************/ 02643000
*                /*                                                  */ 02644000
*                /*  RE- INVOKE CATALOG MANAGEMENT                   */ 02645000
*                /*                                                  */ 02646000
*                /****************************************************/ 02647000
*                                                                  0740 02648000
*                CALL IDCSACA0 (GDTTBL,SCPLPTR);                   0740 02649000
*                                                                  0740 02650000
         L     @15,@PC00001                                        0740 02651000
         ST    @15,@AL00001                                        0740 02652000
         L     @14,@PC00004                                        0740 02653000
         ST    @14,@AL00001+4                                      0740 02654000
         L     @15,GDTCAT(,@15)                                    0740 02655000
         LA    @01,@AL00001                                        0740 02656000
         BALR  @14,@15                                             0740 02657000
*                RESPECIFY REG15 RSTD;                             0741 02658000
*                CATLGRC = REG15;                                  0742 02659000
         STH   REG15,CATLGRC                                       0742 02660000
*                RESPECIFY REG15 UNRSTD;                           0743 02661000
*                                                                  0743 02662000
*                END;                                              0744 02663000
*        IF CATLGRC ^= 0                                           0745 02664000
*          THEN                                                    0745 02665000
@RF00724 DS    0H                                                  0745 02666000
@RF00723 LH    @15,CATLGRC                                         0745 02667000
         LTR   @15,@15                                             0745 02668000
         BZ    @RF00745                                            0745 02669000
*            IF CTGFDBK ^= 0                                       0746 02670000
*              THEN                                                0746 02671000
*                                                                  0746 02672000
         L     @15,CTGPLPTR                                        0746 02673000
         LH    @14,CTGFDBK(,@15)                                   0746 02674000
         N     @14,@CF01314                                        0746 02675000
         LTR   @14,@14                                             0746 02676000
         BZ    @RF00746                                            0746 02677000
*                /****************************************************/ 02678000
*                /*                                                  */ 02679000
*                /*  CATALOG MANAGEMENT HAS SET THE                  */ 02680000
*                /*  PROBLEM DETERMINATION FIELDS.                   */ 02681000
*                /*                                                  */ 02682000
*                /****************************************************/ 02683000
*                                                                  0747 02684000
*                DO;                                               0747 02685000
*                DARGSENT = PROBMSG;                               0748 02686000
         L     @14,DDSTRU                                          0748 02687000
         MVI   DARGSENT(@14),X'0A'                                 0748 02688000
*                DARGSMOD = UNIVMSG;                               0749 02689000
         MVC   DARGSMOD(3,@14),@CC00847                            0749 02690000
*                DARGCNT = 3;                                      0750 02691000
         LA    @07,3                                               0750 02692000
         STH   @07,DARGCNT(,@14)                                   0750 02693000
*                DARGINS(1) = 1;                                   0751 02694000
         MVC   DARGINS(2,@14),@CH00218                             0751 02695000
*                DARGINL(1) = 2;                                   0752 02696000
         LA    @06,2                                               0752 02697000
         STH   @06,DARGINL(,@14)                                   0752 02698000
*                DARGDTM(1) = ADDR(CATLGRC);                       0753 02699000
         LA    @05,CATLGRC                                         0753 02700000
         ST    @05,DARGDTM(,@14)                                   0753 02701000
*                DARGINS(2) = 2;                                   0754 02702000
         STH   @06,DARGINS+8(,@14)                                 0754 02703000
*                DARGINL(2) = 2;                                   0755 02704000
         STH   @06,DARGINL+8(,@14)                                 0755 02705000
*                DARGDTM(2) = ADDR(CTGFDBK);                       0756 02706000
         LA    @05,CTGFDBK(,@15)                                   0756 02707000
         ST    @05,DARGDTM+8(,@14)                                 0756 02708000
*                DARGINS(3) = 3;                                   0757 02709000
         STH   @07,DARGINS+16(,@14)                                0757 02710000
*                DARGINL(3) = 2;                                   0758 02711000
         STH   @06,DARGINL+16(,@14)                                0758 02712000
*                DARGDTM(3) = ADDR(CTGFBFLG);                      0759 02713000
         LA    @15,CTGFBFLG(,@15)                                  0759 02714000
         ST    @15,DARGDTM+16(,@14)                                0759 02715000
*                RETURN CODE(LASTCC08);                            0760 02716000
         LA    @15,8                                               0760 02717000
         L     @14,@SA00004                                        0760 02718000
         LM    @00,@12,@SA00004+8                                  0760 02719000
         BR    @14                                                 0760 02720000
*                END;                                              0761 02721000
*                                                                  0761 02722000
*              ELSE                                                0762 02723000
*                                                                  0762 02724000
*                /****************************************************/ 02725000
*                /*                                                  */ 02726000
*                /*  PROBLEM DETERMINATION FIELDS NOT SET            */ 02727000
*                /*                                                  */ 02728000
*                /****************************************************/ 02729000
*                                                                  0762 02730000
*                DO;                                               0762 02731000
@RF00746 DS    0H                                                  0763 02732000
*                DARGSENT = CATLGMSG;                              0763 02733000
         L     @15,DDSTRU                                          0763 02734000
         MVI   DARGSENT(@15),X'07'                                 0763 02735000
*                DARGSMOD = UNIVMSG;                               0764 02736000
         MVC   DARGSMOD(3,@15),@CC00847                            0764 02737000
*                DARGDBP = ADDR(CATLGRC);                          0765 02738000
         LA    @14,CATLGRC                                         0765 02739000
         ST    @14,DARGDBP(,@15)                                   0765 02740000
*                DARGILP = 2;                                      0766 02741000
         MVC   DARGILP(2,@15),@CH00152                             0766 02742000
*                RETURN CODE(LASTCC08);                            0767 02743000
         LA    @15,8                                               0767 02744000
         L     @14,@SA00004                                        0767 02745000
         LM    @00,@12,@SA00004+8                                  0767 02746000
         BR    @14                                                 0767 02747000
*                END;                                              0768 02748000
*                                                                  0768 02749000
*        /************************************************************/ 02750000
*        /*                                                          */ 02751000
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */ 02752000
*        /*                                                          */ 02753000
*        /************************************************************/ 02754000
*                                                                  0769 02755000
*        RETURN CODE(0);                                           0769 02756000
*                                                                  0769 02757000
@RF00745 SLR   @15,@15                                             0769 02758000
         L     @14,@SA00004                                        0769 02759000
         LM    @00,@12,@SA00004+8                                  0769 02760000
         BR    @14                                                 0769 02761000
*END CTLGPROC;                                                     0770 02762000
*                                                                  0771 02763000
*        /************************************************************/ 02764000
*        /*                                                          */ 02765000
*        /*  PROCEDURE NAME - OPENPROC                               */ 02766000
*        /*                                                          */ 02767000
*        /*  FUNCTION - PERFORMS ALL OPENS REQUIRED FOR OPENING AN   */ 02768000
*        /*  VSAM COMPONENT FOR INPUT, OR OPENING THE PORTABILITY    */ 02769000
*        /*  DATA SET FOR OUTPUT.                                    */ 02770000
*        /*  WHEN OPENING THE VSAM OBJECT FOR INPUT, SETS            */ 02771000
*        /*  THE EXPORT/IMPORT FLAG IN THE OPNAGL.                   */ 02772000
*        /*                                                          */ 02773000
*        /*  INPUT -                                                 */ 02774000
*        /*    .OTYPE - I INDICATES INPUT, O INDICATES OUTPUT        */ 02775000
*        /*    .ODD - 8-BYTE JCL STATEMENT NAME FOR DATA SET TO BE   */ 02776000
*        /*           OPENED                                         */ 02777000
*        /*    .ODSN - NAME OF VSAM COMPONENT                        */ 02778000
*        /*    .OREC - LRECL SIZE FOR OUTPUT DATA SET                */ 02779000
*        /*    .OBLK - BLKSIZE FOR OUTPUT DATA SET                   */ 02780000
*        /*                                                          */ 02781000
*        /*  OUTPUT - POINTER TO IOCS FOR OPEN DATA SET              */ 02782000
*        /*                                                          */ 02783000
*        /************************************************************/ 02784000
*                                                                  0771 02785000
*OPENPROC:  PROCEDURE(OTYPE,           /*OPEN FOR INPUT OR OUTPUT    */ 02786000
*                     ODD,             /*8-BYTE JCL STATEMENT NAME   */ 02787000
*                     ODSN,            /*ENTRYNAME OF OBJECT RELATED */ 02788000
*                                      /*TO CLUSTER                  */ 02789000
*                     OREC,            /*LRECL FOR OUTPUT DATA SET   */ 02790000
*                     OBLK,            /*BLKSIZE FOR OUTPUT DATA SET */ 02791000
*                     OIOCS);          /*RETURN CELL FOR IOCS        */ 02792000
*                                                                  0771 02793000
OPENPROC STM   @14,@12,@SA00005                                    0771 02794000
         MVC   @PC00005(24),0(@01)                                 0771 02795000
*        /************************************************************/ 02796000
*        /*                                                          */ 02797000
*        /*  ARGUMENTS OF INVOCATION                                 */ 02798000
*        /*                                                          */ 02799000
*        /************************************************************/ 02800000
*                                                                  0772 02801000
*        DCL                                                       0772 02802000
*          OTYPE CHAR(1),                                          0772 02803000
*          ODD   PTR(31),                                          0772 02804000
*          ODSN  PTR(31),                                          0772 02805000
*          OREC,                                                   0772 02806000
*          OBLK,                                                   0772 02807000
*          OIOCS PTR(31);                                          0772 02808000
*                                                                  0772 02809000
*        /************************************************************/ 02810000
*        /*                                                          */ 02811000
*        /*  LOCAL DECLARATIONS                                      */ 02812000
*        /*                                                          */ 02813000
*        /************************************************************/ 02814000
*                                                                  0773 02815000
*        DCL OPENLIST BIT(LENGTH(OPNAGL)) BDY(WORD);               0773 02816000
*                                      /* STORAGE FOR OPEN ARGUMENT  */ 02817000
*                                      /* LIST                       */ 02818000
*        DCL OIOCSPTR PTR(31) BASED(OIOCS);                        0774 02819000
*                                      /*PTR TO IOCS RETURNED BY OPEN*/ 02820000
*                                                                  0775 02821000
*        /************************************************************/ 02822000
*        /*                                                          */ 02823000
*        /*  CONSTRUCT OPNAGL SETTING DIFFERENT OPTIONS FOR INPUT    */ 02824000
*        /*  VERSUS AN OUTPUT DATA SET                               */ 02825000
*        /*                                                          */ 02826000
*        /************************************************************/ 02827000
*                                                                  0775 02828000
*        OLDERID2 = NEWERID2;                                      0775 02829000
         L     @02,@PC00001                                        0775 02830000
         L     @02,GDTTR2(,@02)                                    0775 02831000
         MVC   @TS00001(95),NEWERID2(@02)                          0775 02832000
         MVC   OLDERID2(95,@02),@TS00001                           0775 02833000
*        NEWID2 = 'RC17';                                          0776 02834000
         MVC   NEWID2(4,@02),@CC01131                              0776 02835000
*        OPENLIST = ''B;                                           0777 02836000
         XC    OPENLIST(48),OPENLIST                               0777 02837000
*        OPNPTR = ADDR(OPENLIST);                                  0778 02838000
*                                                                  0778 02839000
         LA    OPNPTR,OPENLIST                                     0778 02840000
*        /************************************************************/ 02841000
*        /*                                                          */ 02842000
*        /*  SET FIELDS IN OPNAGL THAT ARE COMMON FOR OUTPUT AND     */ 02843000
*        /*  INPUT                                                   */ 02844000
*        /*                                                          */ 02845000
*        /************************************************************/ 02846000
*                                                                  0779 02847000
*        OPNIOC = OIOCS;                                   /*@OZ10867*/ 02848000
         L     @02,@PC00005+20                                     0779 02849000
         L     @02,OIOCS(,@02)                                     0779 02850000
         ST    @02,OPNIOC(,OPNPTR)                                 0779 02851000
*        OPNDDN = ODD;                                     /*@OZ10867*/ 02852000
*                                                                  0780 02853000
         L     @02,@PC00005+4                                      0780 02854000
         L     @02,ODD(,@02)                                       0780 02855000
         ST    @02,OPNDDN(,OPNPTR)                                 0780 02856000
*        IF OTYPE = 'O'                                            0781 02857000
*          THEN                                                    0781 02858000
         L     @02,@PC00005                                        0781 02859000
         CLI   OTYPE(@02),C'O'                                     0781 02860000
         BNE   @RF00781                                            0781 02861000
*            /********************************************************/ 02862000
*            /*                                                      */ 02863000
*            /*  OPEN FOR OUTPUT SPECIFIED - SET VBS  FORMAT         */ 02864000
*            /*                                                      */ 02865000
*            /********************************************************/ 02866000
*                                                                  0782 02867000
*            DO;                                                   0782 02868000
*            OPNTYPRV = ON;                                        0783 02869000
         OI    OPNTYPRV(OPNPTR),B'00000010'                        0783 02870000
*            OPNOPTOT = ON;                                        0784 02871000
         OI    OPNOPTOT(OPNPTR),B'01000000'                        0784 02872000
*            OPNRFMSF = ON;                                        0785 02873000
*            OPNRFMBK = ON;                                        0786 02874000
         OI    OPNRFMSF(OPNPTR),B'00011000'                        0786 02875000
*            OPNBLK = OBLK;                                        0787 02876000
         L     @02,@PC00005+16                                     0787 02877000
         L     @02,OBLK(,@02)                                      0787 02878000
         ST    @02,OPNBLK(,OPNPTR)                                 0787 02879000
*            OPNREC = OREC;                                        0788 02880000
*                                                                  0788 02881000
         L     @02,@PC00005+12                                     0788 02882000
         L     @02,OREC(,@02)                                      0788 02883000
         ST    @02,OPNREC(,OPNPTR)                                 0788 02884000
*            /********************************************************/ 02885000
*            /*                                                      */ 02886000
*            /*  PROCESS ENVIRONMENT PARAMETER FOR DOS TO SPECIFY    */ 02887000
*            /*  DEVICE TYPES ON EXPORT COMMAND                      */ 02888000
*            /*                                                      */ 02889000
*            /********************************************************/ 02890000
*                                                                  0789 02891000
*            IF ADDR(PDEVNM) ^= NULLPTR                            0789 02892000
*              THEN                                                0789 02893000
         L     @02,@PC00001+4                                      0789 02894000
         L     @02,INPPTR(,@02)                                    0789 02895000
         L     @02,INPTBL+16(,@02)                                 0789 02896000
         LTR   @02,@02                                             0789 02897000
         BZ    @RF00789                                            0789 02898000
*                OPNDEVDT = ADDR(PDEVNM);                          0790 02899000
         ST    @02,OPNDEVDT(,OPNPTR)                               0790 02900000
*            END;                                                  0791 02901000
*                                                                  0791 02902000
@RF00789 DS    0H                                                  0792 02903000
*        IF OTYPE = 'I'                                            0792 02904000
*          THEN                                                    0792 02905000
@RF00781 L     @02,@PC00005                                        0792 02906000
         CLI   OTYPE(@02),C'I'                                     0792 02907000
         BNE   @RF00792                                            0792 02908000
*            DO;                                                   0793 02909000
*            /********************************************************/ 02910000
*            /*                                                      */ 02911000
*            /* INITIALIZE THE OPENAGL SO THAT THE DATASET WILL      */ 02912000
*            /* OPENED FOR CI PROCESSING FPR VERIFY.                 */ 02913000
*            /* SET IMPORT/EXPORT FLAG,OPTIONAL NAME FLAG    @OZ12941*/ 02914000
*            /* AND DSNAME POINTER                           @OZ12941*/ 02915000
*            /*                                                      */ 02916000
*            /********************************************************/ 02917000
*                                                                  0794 02918000
*            OPNOPTIN = OFF;                               /*@OZ10867*/ 02919000
*            OPNOPTOT = ON;                                /*@OZ10867*/ 02920000
*            OPNOPTBK = ON;                                /*@OZ10867*/ 02921000
*            OPNOPTCR = ON;                                /*@OZ10867*/ 02922000
         OI    OPNOPTOT(OPNPTR),B'01010100'                        0797 02923000
         NI    OPNOPTIN(OPNPTR),B'01111111'                        0797 02924000
*            OPNTYPXM=ON;                                  /*@OZ12941*/ 02925000
         OI    OPNTYPXM(OPNPTR),B'00010000'                        0798 02926000
*            OPNOPTNM=ON;                                  /*@OZ12941*/ 02927000
         OI    OPNOPTNM(OPNPTR),B'01000000'                        0799 02928000
*            OPNDSN=ADDR(PTRCPL(1)->CTGFIELD(IENTNAME)->   /*@OZ12941*/ 02929000
*                   CTGFLPT(1)->FENTNAME);                 /*@OZ12941*/ 02930000
*                                                                  0800 02931000
         L     @01,PTRCPL                                          0800 02932000
         L     @01,CTGFIELD+4(,@01)                                0800 02933000
         L     @15,CTGFLPT(,@01)                                   0800 02934000
         ST    @15,OPNDSN(,OPNPTR)                                 0800 02935000
*            /********************************************************/ 02936000
*            /*                                                      */ 02937000
*            /* OPEN FOR CI PROCESSING                               */ 02938000
*            /*                                                      */ 02939000
*            /********************************************************/ 02940000
*                                                                  0801 02941000
*            CALL IDCIOOP0 (GDTTBL,OPNAGL);                /*@OZ10867*/ 02942000
         L     @15,@PC00001                                        0801 02943000
         ST    @15,@AL00001                                        0801 02944000
         ST    OPNPTR,@AL00001+4                                   0801 02945000
         MVI   @AL00001+4,X'80'                                    0801 02946000
         L     @15,GDTOPN(,@15)                                    0801 02947000
         LA    @01,@AL00001                                        0801 02948000
         BALR  @14,@15                                             0801 02949000
*            RESPECIFY RTNREG RSTD;                                0802 02950000
*            TESTRC = RTNREG;                                      0803 02951000
         LR    TESTRC,RTNREG                                       0803 02952000
*            RESPECIFY RTNREG UNRSTD;                      /*@OZ10867*/ 02953000
*                                                                  0804 02954000
*            IF TESTRC ^= 0                                /*@OZ10867*/ 02955000
*              THEN                                        /*@OZ10867*/ 02956000
         LTR   TESTRC,TESTRC                                       0805 02957000
         BZ    @RF00805                                            0805 02958000
*                RETURN CODE(LASTCC08);                    /*@OZ10867*/ 02959000
*                                                                  0806 02960000
         LA    @15,8                                               0806 02961000
         L     @14,@SA00005                                        0806 02962000
         LM    @00,@12,@SA00005+8                                  0806 02963000
         BR    @14                                                 0806 02964000
*            /********************************************************/ 02965000
*            /*                                                      */ 02966000
*            /* VERIFY THE THE DATASET TO PREVENT LOSS OF DATA       */ 02967000
*            /* (DATASETS LEFT OPEN AFTER SYSTEM FAILURE)            */ 02968000
*            /*                                                      */ 02969000
*            /********************************************************/ 02970000
*                                                                  0807 02971000
*            CALL IDCIOVY0 (GDTTBL,OIOCSPTR);              /*@OZ10867*/ 02972000
@RF00805 L     @15,@PC00001                                        0807 02973000
         ST    @15,@AL00001                                        0807 02974000
         L     @14,@PC00005+20                                     0807 02975000
         L     @01,OIOCS(,@14)                                     0807 02976000
         ST    @01,@AL00001+4                                      0807 02977000
         MVI   @AL00001+4,X'80'                                    0807 02978000
         L     @15,GDTVFY(,@15)                                    0807 02979000
         LA    @01,@AL00001                                        0807 02980000
         BALR  @14,@15                                             0807 02981000
*            RESPECIFY RTNREG RSTD;                                0808 02982000
*            TESTRC = RTNREG;                                      0809 02983000
         LR    TESTRC,RTNREG                                       0809 02984000
*            RESPECIFY RTNREG UNRSTD;                      /*@OZ10867*/ 02985000
*                                                                  0810 02986000
*            IF TESTRC ^= 0                                /*@OZ10867*/ 02987000
*              THEN                                        /*@OZ10867*/ 02988000
         LTR   TESTRC,TESTRC                                       0811 02989000
         BZ    @RF00811                                            0811 02990000
*                RETURN CODE(LASTCC08);                    /*@OZ10867*/ 02991000
*                                                                  0812 02992000
         LA    @15,8                                               0812 02993000
         L     @14,@SA00005                                        0812 02994000
         LM    @00,@12,@SA00005+8                                  0812 02995000
         BR    @14                                                 0812 02996000
*            /********************************************************/ 02997000
*            /*                                                      */ 02998000
*            /* CLOSE AND RESET THE OPEN OPTIONS                     */ 02999000
*            /*                                                      */ 03000000
*            /********************************************************/ 03001000
*                                                                  0813 03002000
*            CALL IDCIOCL0 (GDTTBL,OIOCSPTR);              /*@OZ10867*/ 03003000
@RF00811 L     @15,@PC00001                                        0813 03004000
         ST    @15,@AL00001                                        0813 03005000
         L     @14,@PC00005+20                                     0813 03006000
         L     @01,OIOCS(,@14)                                     0813 03007000
         ST    @01,@AL00001+4                                      0813 03008000
         MVI   @AL00001+4,X'80'                                    0813 03009000
         L     @15,GDTCLS(,@15)                                    0813 03010000
         LA    @01,@AL00001                                        0813 03011000
         BALR  @14,@15                                             0813 03012000
*            OPNOPTOT = OFF;                               /*@OZ10867*/ 03013000
*            OPNOPTCR = OFF;                               /*@OZ10867*/ 03014000
*            OPNOPTBK = OFF;                               /*@OZ10867*/ 03015000
*                                                          /*@OZ10867*/ 03016000
*            /********************************************************/ 03017000
*            /*                                                      */ 03018000
*            /*  OPEN VSAM CLUSTER FOR INPUT AND RECORD PROCESSING,  */ 03019000
*            /*  AND SET THE EXPORT/IMPORT FLAG AND OPTIONAL NAME    */ 03020000
*            /*  FLAG AND DSNAME POINTER                     @OZ12941*/ 03021000
*            /*                                                      */ 03022000
*            /********************************************************/ 03023000
*                                                                  0817 03024000
*            OPNOPTIN = ON;                                        0817 03025000
         OI    OPNOPTIN(OPNPTR),B'10000000'                        0817 03026000
         NI    OPNOPTOT(OPNPTR),B'10101011'                        0817 03027000
*            OPNTYPXM = ON;                                        0818 03028000
         OI    OPNTYPXM(OPNPTR),B'00010000'                        0818 03029000
*            OPNOPTNM=ON;                                  /*@OZ12941*/ 03030000
         OI    OPNOPTNM(OPNPTR),B'01000000'                        0819 03031000
*            OPNDSN=ADDR(PTRCPL(1)->CTGFIELD(IENTNAME)->   /*@OZ12941*/ 03032000
*                   CTGFLPT(1)->FENTNAME);                 /*@OZ12941*/ 03033000
*                                                                  0820 03034000
         L     @15,PTRCPL                                          0820 03035000
         L     @01,CTGFIELD+4(,@15)                                0820 03036000
         L     @14,CTGFLPT(,@01)                                   0820 03037000
         ST    @14,OPNDSN(,OPNPTR)                                 0820 03038000
*            CTGFLPTR = PTRCPL(1) -> CTGFIELD(IPASSWOR);           0821 03039000
         L     CTGFLPTR,CTGFIELD+36(,@15)                          0821 03040000
*            IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= NULLPTR            0822 03041000
*              THEN                                                0822 03042000
         SLR   @15,@15                                             0822 03043000
         C     @15,CTGFLNG(,CTGFLPTR)                              0822 03044000
         BE    @RF00822                                            0822 03045000
         L     @14,CTGFLPT(,CTGFLPTR)                              0822 03046000
         CR    @14,@15                                             0822 03047000
         BE    @RF00822                                            0822 03048000
*                OPNPWA = CTGFLPT(1);                              0823 03049000
         ST    @14,OPNPWA(,OPNPTR)                                 0823 03050000
*              ELSE                                                0824 03051000
*                IF OBJPLN > 0                                     0824 03052000
*                  THEN                                            0824 03053000
         B     @RC00822                                            0824 03054000
@RF00822 L     @02,@PC00001+4                                      0824 03055000
         L     @02,INPPTR(,@02)                                    0824 03056000
         L     @02,INPTBL(,@02)                                    0824 03057000
         CLI   OBJPLN(@02),0                                       0824 03058000
         BNH   @RF00824                                            0824 03059000
*                    OPNPWA = ADDR(OBJPAS);                        0825 03060000
         LA    @02,OBJPAS(,@02)                                    0825 03061000
         ST    @02,OPNPWA(,OPNPTR)                                 0825 03062000
*            END;                                                  0826 03063000
*                                                                  0826 03064000
*                                                                  0826 03065000
@RF00824 DS    0H                                                  0826 03066000
@RC00822 DS    0H                                                  0827 03067000
*        /************************************************************/ 03068000
*        /*                                                          */ 03069000
*        /*  ISSUE THE UOPEN MACRO TO OPEN INPUT OR OUTPUT DATA SET  */ 03070000
*        /*                                                          */ 03071000
*        /************************************************************/ 03072000
*                                                                  0827 03073000
*        CALL IDCIOOP0 (GDTTBL,OPNAGL);                            0827 03074000
*                                                                  0827 03075000
@RF00792 L     @15,@PC00001                                        0827 03076000
         ST    @15,@AL00001                                        0827 03077000
         ST    OPNPTR,@AL00001+4                                   0827 03078000
         MVI   @AL00001+4,X'80'                                    0827 03079000
         L     @15,GDTOPN(,@15)                                    0827 03080000
         LA    @01,@AL00001                                        0827 03081000
         BALR  @14,@15                                             0827 03082000
*        RESPECIFY RTNREG RSTD;                                    0828 03083000
*        TESTRC = RTNREG;                                          0829 03084000
         LR    TESTRC,RTNREG                                       0829 03085000
*        RESPECIFY RTNREG UNRSTD;                                  0830 03086000
*                                                                  0830 03087000
*        /************************************************************/ 03088000
*        /*                                                          */ 03089000
*        /*  TEST RETURN CODE FROM OPEN.  IF INPUT DATA SET CHECK    */ 03090000
*        /*  FOR EMPTY DATA SET RETURN CODE OR DATA SET ALREADY OPEN */ 03091000
*        /*  CONTINUE PROCESSING IF THESE CONDITIONS EXIST.          */ 03092000
*        /* IF OUTPUT RETURN WITH TERMINATION CODE.                  */ 03093000
*        /*                                                          */ 03094000
*        /************************************************************/ 03095000
*                                                                  0831 03096000
*        IF TESTRC ^= 0                                            0831 03097000
*          THEN                                                    0831 03098000
         LTR   TESTRC,TESTRC                                       0831 03099000
         BZ    @RF00831                                            0831 03100000
*            IF OTYPE = 'I'                                        0832 03101000
*              THEN                                                0832 03102000
         L     @15,@PC00005                                        0832 03103000
         CLI   OTYPE(@15),C'I'                                     0832 03104000
         BNE   @RF00832                                            0832 03105000
*                IF OIOCSPTR -> IOCMSGOP = ON  |                   0833 03106000
*                   OIOCSPTR -> IOCVRC(4:4) = EMPDSRTN             0833 03107000
*                                                                  0833 03108000
*                  THEN                                            0833 03109000
         L     @15,@PC00005+20                                     0833 03110000
         L     @01,OIOCS(,@15)                                     0833 03111000
         L     @15,OIOCSPTR(,@01)                                  0833 03112000
         TM    IOCMSGOP(@15),B'00100000'                           0833 03113000
         BO    @RT00833                                            0833 03114000
         CLC   IOCVRC+3(1,@15),EMPDSRTN                            0833 03115000
         BNE   @RF00833                                            0833 03116000
@RT00833 DS    0H                                                  0834 03117000
*                    RETURN CODE(0);                               0834 03118000
*                                                                  0834 03119000
         SLR   @15,@15                                             0834 03120000
         L     @14,@SA00005                                        0834 03121000
         LM    @00,@12,@SA00005+8                                  0834 03122000
         BR    @14                                                 0834 03123000
*                  ELSE                                            0835 03124000
*                    DO;                                           0835 03125000
@RF00833 DS    0H                                                  0836 03126000
*                    IF OIOCSPTR -> IOCMSGOP = ON          /*@OZ10866*/ 03127000
*                      THEN                                /*@OZ10866*/ 03128000
*                                                                  0836 03129000
         L     @15,@PC00005+20                                     0836 03130000
         L     @15,OIOCS(,@15)                                     0836 03131000
         L     @01,OIOCSPTR(,@15)                                  0836 03132000
         TM    IOCMSGOP(@01),B'00100000'                           0836 03133000
         BNO   @RF00836                                            0836 03134000
*                         CALL IDCIOCL0 (GDTTBL,OIOCSPTR);         0837 03135000
*                                                                  0837 03136000
         L     @14,@PC00001                                        0837 03137000
         ST    @14,@AL00001                                        0837 03138000
         ST    @15,@AL00001+4                                      0837 03139000
         MVI   @AL00001+4,X'80'                                    0837 03140000
         L     @15,GDTCLS(,@14)                                    0837 03141000
         LA    @01,@AL00001                                        0837 03142000
         BALR  @14,@15                                             0837 03143000
*                    OIOCSPTR = NULLPTR;                           0838 03144000
@RF00836 L     @15,@PC00005+20                                     0838 03145000
         L     @01,OIOCS(,@15)                                     0838 03146000
         SLR   @00,@00                                             0838 03147000
         ST    @00,OIOCSPTR(,@01)                                  0838 03148000
*                    RETURN CODE(LASTCC08);                        0839 03149000
         LA    @15,8                                               0839 03150000
         L     @14,@SA00005                                        0839 03151000
         LM    @00,@12,@SA00005+8                                  0839 03152000
         BR    @14                                                 0839 03153000
*                    END;                                          0840 03154000
*                                                                  0840 03155000
*              ELSE                                                0841 03156000
*                RETURN CODE(LASTCC16);                            0841 03157000
*                                                                  0841 03158000
@RF00832 LA    @15,16                                              0841 03159000
         L     @14,@SA00005                                        0841 03160000
         LM    @00,@12,@SA00005+8                                  0841 03161000
         BR    @14                                                 0841 03162000
*          ELSE                                                    0842 03163000
*                                                                  0842 03164000
*            /********************************************************/ 03165000
*            /*                                                      */ 03166000
*            /*  RETURN TO CALLER INDICATING SUCCESSFUL COMPLETION   */ 03167000
*            /*  OF OPEN                                             */ 03168000
*            /*                                                      */ 03169000
*            /********************************************************/ 03170000
*                                                                  0842 03171000
*            RETURN CODE(0);                                       0842 03172000
*                                                                  0842 03173000
@RF00831 SLR   @15,@15                                             0842 03174000
         L     @14,@SA00005                                        0842 03175000
         LM    @00,@12,@SA00005+8                                  0842 03176000
         BR    @14                                                 0842 03177000
*END OPENPROC;                                                     0843 03178000
*        /************************************************************/ 03179000
*        /*                                                          */ 03180000
*        /*  PROCEDURE NAME - PUTPROC                                */ 03181000
*        /*                                                          */ 03182000
*        /*  FUNCTION - OUTPUT A RECORD TO THE PORTABILITY DATA SET  */ 03183000
*        /*                                                          */ 03184000
*        /*  INPUT - LENGTH AND ADDRESS OF RECORD TO BE OUTPUTTED    */ 03185000
*        /*                                                          */ 03186000
*        /*  OUTPUT - RECORD WILL BE WRITTEN TO PORTABILITY DATA SET */ 03187000
*        /*                                                          */ 03188000
*        /************************************************************/ 03189000
*                                                                  0844 03190000
*                                                                  0844 03191000
*PUTPROC:  PROCEDURE(PLNINIT,          /*LENGTH OF RECORD            */ 03192000
*                    PADINIT);         /*ADDRESS OF RECORD           */ 03193000
*                                                                  0844 03194000
*                                                                  0844 03195000
PUTPROC  STM   @14,@12,@SA00006                                    0844 03196000
         MVC   @PC00006(8),0(@01)                                  0844 03197000
*        /************************************************************/ 03198000
*        /*                                                          */ 03199000
*        /*  ARGUMENTS OF INVOCATION                                 */ 03200000
*        /*                                                          */ 03201000
*        /************************************************************/ 03202000
*                                                                  0845 03203000
*        DCL PLNINIT FIXED(31),                                    0845 03204000
*            PADINIT PTR(31);                                      0845 03205000
*                                                                  0845 03206000
*        /************************************************************/ 03207000
*        /*                                                          */ 03208000
*        /*  LOCAL DECLARATIONS                                      */ 03209000
*        /*                                                          */ 03210000
*        /************************************************************/ 03211000
*                                                                  0846 03212000
*        DCL PLN FIXED(31);            /*LENGTH OF DATA YET TO OUTPUT*/ 03213000
*        DCL PAD PTR(31);              /*ADDRESS OF DATA TO OUTPUT   */ 03214000
*                                                                  0847 03215000
*        /************************************************************/ 03216000
*        /*                                                          */ 03217000
*        /*  SET UP IOCS FOR OUTPUT OF RECORD                        */ 03218000
*        /*                                                          */ 03219000
*        /************************************************************/ 03220000
*                                                                  0848 03221000
*        OLDERID2 = NEWERID2;                                      0848 03222000
         L     @02,@PC00001                                        0848 03223000
         L     @02,GDTTR2(,@02)                                    0848 03224000
         MVC   @TS00001(95),NEWERID2(@02)                          0848 03225000
         MVC   OLDERID2(95,@02),@TS00001                           0848 03226000
*        NEWID2 = 'RC19';                                          0849 03227000
         MVC   NEWID2(4,@02),@CC01141                              0849 03228000
*        IOCSPTR = POUTIOCS;                                       0850 03229000
         L     IOCSPTR,POUTIOCS                                    0850 03230000
*        PAD = PADINIT;                                            0851 03231000
         L     @02,@PC00006+4                                      0851 03232000
         L     PAD,PADINIT(,@02)                                   0851 03233000
*        PLN = PLNINIT;                                            0852 03234000
*                                                                  0852 03235000
         L     @02,@PC00006                                        0852 03236000
         L     PLN,PLNINIT(,@02)                                   0852 03237000
*        /************************************************************/ 03238000
*        /*                                                          */ 03239000
*        /*  SPLIT RECORD INTO SEGMENTS IF LARGER THAN OUTPUT        */ 03240000
*        /*  LRECL LENGTH                                            */ 03241000
*        /*                                                          */ 03242000
*        /************************************************************/ 03243000
*                                                                  0853 03244000
*        DOCNTRL = ON;                                             0853 03245000
         OI    DOCNTRL,B'10000000'                                 0853 03246000
*PUTLP:  DO WHILE (DOCNTRL= ON);                                   0854 03247000
PUTLP    B     @DE00854                                            0854 03248000
@DL00854 DS    0H                                                  0855 03249000
*          IF PLN > IOCTRN                                         0855 03250000
*            THEN                                                  0855 03251000
         L     @02,IOCTRN(,IOCSPTR)                                0855 03252000
         CR    PLN,@02                                             0855 03253000
         BNH   @RF00855                                            0855 03254000
*              DO;                                                 0856 03255000
*              IOCDLN = IOCTRN;                                    0857 03256000
         ST    @02,IOCDLN(,IOCSPTR)                                0857 03257000
*              IOCDAD = PAD;                                       0858 03258000
         ST    PAD,IOCDAD(,IOCSPTR)                                0858 03259000
*              PAD = PAD + IOCTRN;                                 0859 03260000
         ALR   PAD,@02                                             0859 03261000
*              PLN = PLN - IOCTRN;                                 0860 03262000
         SLR   PLN,@02                                             0860 03263000
*              END;                                                0861 03264000
*            ELSE                                                  0862 03265000
*              DO;                                                 0862 03266000
         B     @RC00855                                            0862 03267000
@RF00855 DS    0H                                                  0863 03268000
*              IOCDLN = PLN;                                       0863 03269000
         ST    PLN,IOCDLN(,IOCSPTR)                                0863 03270000
*              IOCDAD = PAD;                                       0864 03271000
         ST    PAD,IOCDAD(,IOCSPTR)                                0864 03272000
*              DOCNTRL = OFF;                                      0865 03273000
         NI    DOCNTRL,B'01111111'                                 0865 03274000
*              END;                                                0866 03275000
*                                                                  0866 03276000
*                                                                  0866 03277000
*        /************************************************************/ 03278000
*        /*                                                          */ 03279000
*        /*  OUTPUT RECORD BY ISSUANCE OF THE UGET I/O ADAPTER       */ 03280000
*        /*  INTERFACE.  IF AN ERROR OCCURS, THE RETURN CODE WILL    */ 03281000
*        /*  BE SET TO INDICATE FAILURE. OTHERWISE, A GOOD RETURN    */ 03282000
*        /*  CODE WILL BE SET AND CONTROL WILL RETURN TO THE CALLING */ 03283000
*        /*  PROCESSOR.                                              */ 03284000
*        /*                                                          */ 03285000
*        /************************************************************/ 03286000
*                                                                  0867 03287000
*        CALL IDCIOPT0 (GDTTBL,POUTIOCS);                          0867 03288000
*                                                                  0867 03289000
@RC00855 L     @15,@PC00001                                        0867 03290000
         ST    @15,@AL00001                                        0867 03291000
         LA    @14,POUTIOCS                                        0867 03292000
         ST    @14,@AL00001+4                                      0867 03293000
         MVI   @AL00001+4,X'80'                                    0867 03294000
         L     @15,GDTPUT(,@15)                                    0867 03295000
         LA    @01,@AL00001                                        0867 03296000
         BALR  @14,@15                                             0867 03297000
*        RESPECIFY RTNREG RSTD;                                    0868 03298000
*        TESTRC = RTNREG;                                          0869 03299000
         LR    TESTRC,RTNREG                                       0869 03300000
*        RESPECIFY RTNREG UNRSTD;                                  0870 03301000
*        IF TESTRC ^= 0                                            0871 03302000
*          THEN                                                    0871 03303000
         LTR   TESTRC,TESTRC                                       0871 03304000
         BZ    @RF00871                                            0871 03305000
*            IF IOCMSGOP = OFF                                     0872 03306000
*              THEN                                                0872 03307000
         TM    IOCMSGOP(IOCSPTR),B'00100000'                       0872 03308000
         BNZ   @RF00872                                            0872 03309000
*                RETURN CODE(LASTCC16);                            0873 03310000
*                                                                  0873 03311000
         LA    @15,16                                              0873 03312000
         L     @14,@SA00006                                        0873 03313000
         LM    @00,@12,@SA00006+8                                  0873 03314000
         BR    @14                                                 0873 03315000
*        END PUTLP;                                                0874 03316000
*                                                                  0874 03317000
@RF00872 DS    0H                                                  0874 03318000
@RF00871 DS    0H                                                  0874 03319000
@DE00854 TM    DOCNTRL,B'10000000'                                 0874 03320000
         BO    @DL00854                                            0874 03321000
*        /************************************************************/ 03322000
*        /*                                                          */ 03323000
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */ 03324000
*        /*                                                          */ 03325000
*        /************************************************************/ 03326000
*                                                                  0875 03327000
*        RETURN CODE(0);                                           0875 03328000
*                                                                  0875 03329000
         SLR   @15,@15                                             0875 03330000
         L     @14,@SA00006                                        0875 03331000
         LM    @00,@12,@SA00006+8                                  0875 03332000
         BR    @14                                                 0875 03333000
*END PUTPROC;                                                      0876 03334000
*        /************************************************************/ 03335000
*        /*                                                          */ 03336000
*        /*  PROCEDURE NAME - RECPROC                                */ 03337000
*        /*                                                          */ 03338000
*        /*  FUNCTION - COPY THE DATA FROM THE DATA SET TO BE        */ 03339000
*        /*  EXPORTED TO THE PORTABILITY DATA SET, RECORD BY         */ 03340000
*        /*  RECORD.  THE VSAM CLUSTER IS OPENED BY OPENPROC,        */ 03341000
*        /*  THE UCOPY MACRO IS EMPLOYED TO PERFORM THE COPY, THEN   */ 03342000
*        /*  THE CLUSTER DATA SET IS CLOSED THROUGH ISSUANCE OF THE  */ 03343000
*        /*  UCLOSE MACRO.                                           */ 03344000
*        /*                                                          */ 03345000
*        /*  INPUT - NONE                                            */ 03346000
*        /*                                                          */ 03347000
*        /*  OUTPUT - THE PORTABILITY DATA SET WILL CONTAIN THE      */ 03348000
*        /*  RECORDS THAT COMPRISE THE EXPORTED DATA SET             */ 03349000
*        /*                                                          */ 03350000
*        /************************************************************/ 03351000
*                                                                  0877 03352000
*RECPROC:  PROCEDURE;                                              0877 03353000
*                                                                  0877 03354000
*                                                                  0877 03355000
RECPROC  STM   @14,@12,@SA00007                                    0877 03356000
*        OLDERID2 = NEWERID2;                                      0878 03357000
         L     @15,@PC00001                                        0878 03358000
         L     @15,GDTTR2(,@15)                                    0878 03359000
         MVC   @TS00001(95),NEWERID2(@15)                          0878 03360000
         MVC   OLDERID2(95,@15),@TS00001                           0878 03361000
*        NEWID2 = 'RC21';                                          0879 03362000
*                                                                  0879 03363000
*                                                                  0879 03364000
         MVC   NEWID2(4,@15),@CC01147                              0879 03365000
*        /************************************************************/ 03366000
*        /*                                                          */ 03367000
*        /*  WRITE OUT CONTROL RECORD IDENTIFYING TYPE OF EXPORT     */ 03368000
*        /*  REORGANIZE OPTION, WHERE THE LOGICAL RECORDS            */ 03369000
*        /*  COMPRISING THE CLUSTER ARE COPIED TO THE PORTABILITY    */ 03370000
*        /*  DATA SET      ZERO FIELDS NOT USED                      */ 03371000
*        /*                                                          */ 03372000
*        /************************************************************/ 03373000
*                                                                  0880 03374000
*        HEADFLG2 = '00'X;                                         0880 03375000
         L     @15,CONRCPTR                                        0880 03376000
         MVI   HEADFLG2(@15),X'00'                                 0880 03377000
*        ASSRECLN = 0;                                             0881 03378000
         SLR   @14,@14                                             0881 03379000
         STH   @14,ASSRECLN(,@15)                                  0881 03380000
*        ASSRECNM = 0;                                             0882 03381000
         STH   @14,ASSRECNM(,@15)                                  0882 03382000
*        HEADLN = LENGTH(HEADER);                                  0883 03383000
         LA    @14,8                                               0883 03384000
         STH   @14,HEADLN(,@15)                                    0883 03385000
*        HEADFLG1 = HDFL1REO;                                      0884 03386000
         MVI   HEADFLG1(@15),X'01'                                 0884 03387000
*        TOTLEN = HEADLN;                                          0885 03388000
*                                                                  0885 03389000
         ST    @14,TOTLEN                                          0885 03390000
*        CALL PUTPROC(TOTLEN,CONRCPTR);                            0886 03391000
*                                                                  0886 03392000
         LA    @15,TOTLEN                                          0886 03393000
         ST    @15,@AL00001                                        0886 03394000
         LA    @15,CONRCPTR                                        0886 03395000
         ST    @15,@AL00001+4                                      0886 03396000
         LA    @01,@AL00001                                        0886 03397000
         BAL   @14,PUTPROC                                         0886 03398000
*        RESPECIFY RTNREG RSTD;                                    0887 03399000
*        TESTRC = RTNREG;                                          0888 03400000
         LR    TESTRC,RTNREG                                       0888 03401000
*        RESPECIFY RTNREG UNRSTD;                                  0889 03402000
*        IF TESTRC ^= 0                                            0890 03403000
*          THEN                                                    0890 03404000
         LTR   TESTRC,TESTRC                                       0890 03405000
         BZ    @RF00890                                            0890 03406000
*            RETURN CODE(LASTCC16);                                0891 03407000
*                                                                  0891 03408000
         LA    @15,16                                              0891 03409000
         L     @14,@SA00007                                        0891 03410000
         LM    @00,@12,@SA00007+8                                  0891 03411000
         BR    @14                                                 0891 03412000
*        /************************************************************/ 03413000
*        /*                                                          */ 03414000
*        /*  CHECK OPEN RETURN CODE, IF EMPTY DATA SET BYPASS COPY,  */ 03415000
*        /*  IF CALLER INDICATED EMPTY DATA SET BYPASS COPY          */ 03416000
*        /*                                                          */ 03417000
*        /************************************************************/ 03418000
*                                                                  0892 03419000
*        RESPECIFY (RTNREG) RSTD;                                  0892 03420000
*                                                                  0892 03421000
@RF00890 DS    0H                                                  0893 03422000
*        IF PINIOCS -> IOCVRC(4:4) ^= EMPDSRTN  &                  0893 03423000
*           EMPTYDS = OFF                                          0893 03424000
*                                                                  0893 03425000
*          THEN                                                    0893 03426000
*                                                                  0893 03427000
         L     @14,PINIOCS                                         0893 03428000
         CLC   IOCVRC+3(1,@14),EMPDSRTN                            0893 03429000
         BE    @RF00893                                            0893 03430000
         L     @14,@PC00001+4                                      0893 03431000
         L     @14,INPPTR(,@14)                                    0893 03432000
         L     @14,INPTBL+4(,@14)                                  0893 03433000
         TM    EMPTYDS(@14),B'00100000'                            0893 03434000
         BNZ   @RF00893                                            0893 03435000
*            /********************************************************/ 03436000
*            /*                                                      */ 03437000
*            /*  COPY DATA BY RECORD FROM THE CLUSTER TO THE         */ 03438000
*            /*  PORTABILITY DATA SET.  IF ANY ERRORS ARE ENCOUNTERED*/ 03439000
*            /*  RETURN TO THE CALLING PROCESSOR WITH ERROR INDICATED*/ 03440000
*            /*                                                      */ 03441000
*            /********************************************************/ 03442000
*                                                                  0894 03443000
*            CALL IDCIOCO0 (GDTTBL,PINIOCS,POUTIOCS);              0894 03444000
*                                                                  0894 03445000
         L     @14,@PC00001                                        0894 03446000
         ST    @14,@AL00001                                        0894 03447000
         LA    @07,PINIOCS                                         0894 03448000
         ST    @07,@AL00001+4                                      0894 03449000
         LA    @07,POUTIOCS                                        0894 03450000
         ST    @07,@AL00001+8                                      0894 03451000
         MVI   @AL00001+8,X'80'                                    0894 03452000
         L     @15,GDTCPY(,@14)                                    0894 03453000
         LA    @01,@AL00001                                        0894 03454000
         BALR  @14,@15                                             0894 03455000
*        RESPECIFY (RTNREG) UNRSTD;                                0895 03456000
*                                                                  0895 03457000
@RF00893 DS    0H                                                  0896 03458000
*        RESPECIFY RTNREG RSTD;                                    0896 03459000
*        TESTRC = RTNREG;                                          0897 03460000
         LR    TESTRC,RTNREG                                       0897 03461000
*        RESPECIFY RTNREG UNRSTD;                                  0898 03462000
*        IF TESTRC ^= 0                                            0899 03463000
*          THEN                                                    0899 03464000
         LTR   TESTRC,TESTRC                                       0899 03465000
         BZ    @RF00899                                            0899 03466000
*            RETURN CODE(LASTCC12);                                0900 03467000
*                                                                  0900 03468000
         LA    @15,12                                              0900 03469000
         L     @14,@SA00007                                        0900 03470000
         LM    @00,@12,@SA00007+8                                  0900 03471000
         BR    @14                                                 0900 03472000
*        /************************************************************/ 03473000
*        /*                                                          */ 03474000
*        /*  CLOSE THE INPUT DATA SET (THE VSAM CLUSTER).  IF THE    */ 03475000
*        /*  CLOSE FAILS, RETURN TO THE CALLING PROCESSOR WITH ERROR */ 03476000
*        /*  INDICATED.                                              */ 03477000
*        /*                                                          */ 03478000
*        /************************************************************/ 03479000
*                                                                  0901 03480000
*        CALL IDCIOCL0 (GDTTBL,PINIOCS);                           0901 03481000
*                                                                  0901 03482000
@RF00899 L     @03,@PC00001                                        0901 03483000
         ST    @03,@AL00001                                        0901 03484000
         LA    @15,PINIOCS                                         0901 03485000
         ST    @15,@AL00001+4                                      0901 03486000
         MVI   @AL00001+4,X'80'                                    0901 03487000
         L     @15,GDTCLS(,@03)                                    0901 03488000
         LA    @01,@AL00001                                        0901 03489000
         BALR  @14,@15                                             0901 03490000
*        RESPECIFY RTNREG RSTD;                                    0902 03491000
*        TESTRC = RTNREG;                                          0903 03492000
         LR    TESTRC,RTNREG                                       0903 03493000
*        RESPECIFY RTNREG UNRSTD;                                  0904 03494000
*        PINIOCS = NULLPTR;                                        0905 03495000
         SLR   @03,@03                                             0905 03496000
         ST    @03,PINIOCS                                         0905 03497000
*        IF TESTRC ^= 0                                            0906 03498000
*          THEN                                                    0906 03499000
         CR    TESTRC,@03                                          0906 03500000
         BE    @RF00906                                            0906 03501000
*            RETURN CODE(LASTCC08);                                0907 03502000
*                                                                  0907 03503000
         LA    @15,8                                               0907 03504000
         L     @14,@SA00007                                        0907 03505000
         LM    @00,@12,@SA00007+8                                  0907 03506000
         BR    @14                                                 0907 03507000
*        /************************************************************/ 03508000
*        /*                                                          */ 03509000
*        /*  RETURN TO THE CALLING PROCESSOR WITH SUCCESSFUL         */ 03510000
*        /*  COMPLETION INDICATED                                    */ 03511000
*        /*                                                          */ 03512000
*        /************************************************************/ 03513000
*                                                                  0908 03514000
*        RETURN CODE(0);                                           0908 03515000
@RF00906 SLR   @15,@15                                             0908 03516000
         L     @14,@SA00007                                        0908 03517000
         LM    @00,@12,@SA00007+8                                  0908 03518000
         BR    @14                                                 0908 03519000
*END RECPROC;                                                      0909 03520000
*        /************************************************************/ 03521000
*        /*                                                          */ 03522000
*        /*  PROCEDURE NAME - MVDAPROC                               */ 03523000
*        /*                                                          */ 03524000
*        /*  FUNCTION - MOVES DATA FROM ONE LOCATION IN CORE         */ 03525000
*        /*  TO ANOTHER AS SPECIFIED BY INPUT ARGUMENTS,             */ 03526000
*        /*  OR ZEROS OUT AN AREA OF CORE IF SPECIFIED BY            */ 03527000
*        /*  ITS ARGUMENTS.                                          */ 03528000
*        /*                                                          */ 03529000
*        /*  INPUT -                                                 */ 03530000
*        /*    .MSIZE - LENGTH OF DATA TO BE MOVED                   */ 03531000
*        /*    .MF1PTR- FROM LOCATION                                */ 03532000
*        /*    .MT1PTR- TO LOCATION                                  */ 03533000
*        /*    .ZEROOUT - FLAG TO INDICATE WHETHER MDVAPROC          */ 03534000
*        /*        IS TO ZERO OUT CORE                               */ 03535000
*        /*                                                          */ 03536000
*        /*  OUTPUT - DATA WILL BE MOVED TO LOCATION INDICATED BY    */ 03537000
*        /*  THE "TO" AGRUMENT (MPTR) IF IT IS SPECIFIED.            */ 03538000
*        /*  IF ZEROOUT IS SET TO A NONZERO VALUE, THEN              */ 03539000
*        /*  THE AREA OF CORE STARTING AT MF1PTR AND                 */ 03540000
*        /*  EXTENDING A LENGTH OF MSIZE IS ZEROED OUT.              */ 03541000
*        /*                                                          */ 03542000
*        /************************************************************/ 03543000
*                                                                  0910 03544000
*MVDAPROC: PROCEDURE(MSIZE,            /*SIZE OF DATA TO BE MOVED    */ 03545000
*                    MF1PTR,           /*LOCATION TO MOVE FROM       */ 03546000
*                    MT1PTR,           /*LOCATION TO MOVE DATA INTO  */ 03547000
*                    ZEROOUT);         /*FLAG INDICATING THAT        */ 03548000
MVDAPROC STM   @14,@12,12(@13)                                     0910 03549000
         MVC   @PC00008(16),0(@01)                                 0910 03550000
*                                      /*THIS IS A REQUEST           */ 03551000
*                                      /*ZERO OUT CORE               */ 03552000
*                                                                  0911 03553000
*        /************************************************************/ 03554000
*        /*                                                          */ 03555000
*        /*  ARGUMENTS OF INVOCATION                                 */ 03556000
*        /*                                                          */ 03557000
*        /************************************************************/ 03558000
*                                                                  0911 03559000
*        DCL MSIZE    FIXED(15),                                   0911 03560000
*            MF1PTR   PTR(31),                                     0911 03561000
*            MT1PTR   PTR(31),                                     0911 03562000
*            ZEROOUT CHAR(4);                                      0911 03563000
*                                                                  0911 03564000
*        /************************************************************/ 03565000
*        /*                                                          */ 03566000
*        /*  LOCAL DECLARATIONS                                      */ 03567000
*        /*                                                          */ 03568000
*        /************************************************************/ 03569000
*                                                                  0912 03570000
*        DCL MFPTR PTR(31);                                        0912 03571000
*        DCL MTPTR PTR(31);                                        0913 03572000
*        DCL FROMAREA CHAR(*) BASED(MFPTR);                        0914 03573000
*        DCL TOAREA   CHAR(*) BASED(MTPTR);                        0915 03574000
*        DCL M1SIZE FIXED(15);                                     0916 03575000
*        DCL CNTRL  BIT(1);                                        0917 03576000
*        DCL ZERO CHAR(256) INIT('00'X);                           0918 03577000
*                                      /*ZEROS USED TO ZERO          */ 03578000
*                                      /*OUT AN AREA                 */ 03579000
*                                                                  0919 03580000
*        /************************************************************/ 03581000
*        /*                                                          */ 03582000
*        /*  TEST TO SEE IF SETZERO HAS BEEN SPECIFIED AS            */ 03583000
*        /*  LAST ARGUMENT.  IF SO, ZERO OUT THE TARGET              */ 03584000
*        /*  AREA.                                                   */ 03585000
*        /*                                                          */ 03586000
*        /************************************************************/ 03587000
*        OLDERID2 = NEWERID2;                                      0919 03588000
         L     @15,@PC00001                                        0919 03589000
         L     @15,GDTTR2(,@15)                                    0919 03590000
         MVC   @TS00001(95),NEWERID2(@15)                          0919 03591000
         MVC   OLDERID2(95,@15),@TS00001                           0919 03592000
*        NEWID2 = 'RC23';                                          0920 03593000
*                                                                  0920 03594000
         MVC   NEWID2(4,@15),@CC01166                              0920 03595000
*        IF ZEROOUT = SETZERO                                      0921 03596000
*          THEN                                                    0921 03597000
         L     @15,@PC00008+12                                     0921 03598000
         CLC   ZEROOUT(4,@15),SETZERO                              0921 03599000
         BNE   @RF00921                                            0921 03600000
*            DO;                                                   0922 03601000
*                                                                  0922 03602000
*            /********************************************************/ 03603000
*            /*                                                      */ 03604000
*            /*  SET MTPTR TO MT1PTR AND M1SIZE TO MSIZE.            */ 03605000
*            /*  SET CNTRL TO ON AND LOOP.                           */ 03606000
*            /*                                                      */ 03607000
*            /********************************************************/ 03608000
*                                                                  0923 03609000
*            MTPTR = MT1PTR;                                       0923 03610000
         L     @15,@PC00008+8                                      0923 03611000
         L     MTPTR,MT1PTR(,@15)                                  0923 03612000
*            M1SIZE = MSIZE;                                       0924 03613000
         L     @15,@PC00008                                        0924 03614000
         LH    M1SIZE,MSIZE(,@15)                                  0924 03615000
*            CNTRL = ON;                                           0925 03616000
         OI    CNTRL,B'10000000'                                   0925 03617000
*            DO WHILE (CNTRL = ON);                                0926 03618000
*                                                                  0926 03619000
         B     @DE00926                                            0926 03620000
@DL00926 DS    0H                                                  0927 03621000
*              /******************************************************/ 03622000
*              /*                                                    */ 03623000
*              /*  TEST M1SIZE AGAINST 256.  IF M1SIZE > 256         */ 03624000
*              /*  THEN MOVE 256 BYTES OF ZEROS, AND LOOP            */ 03625000
*              /*  AGAIN.  OTHERWISE, ZERO THE REMAINING             */ 03626000
*              /*  AND SET CNTRL TO OFF.                             */ 03627000
*              /*                                                    */ 03628000
*              /******************************************************/ 03629000
*                                                                  0927 03630000
*              IF M1SIZE > 256                                     0927 03631000
*                THEN                                              0927 03632000
         LA    @15,256                                             0927 03633000
         CR    M1SIZE,@15                                          0927 03634000
         BNH   @RF00927                                            0927 03635000
*                  DO;                                             0928 03636000
*                  TOAREA(1:256) = ZERO(1:256);                    0929 03637000
         MVC   TOAREA(256,MTPTR),ZERO                              0929 03638000
*                  M1SIZE = M1SIZE - 256;                          0930 03639000
         SLR   M1SIZE,@15                                          0930 03640000
*                  MTPTR = MTPTR + 256;                            0931 03641000
         ALR   MTPTR,@15                                           0931 03642000
*                  END;                                            0932 03643000
*                ELSE                                              0933 03644000
*                  DO;                                             0933 03645000
         B     @RC00927                                            0933 03646000
@RF00927 DS    0H                                                  0934 03647000
*                  TOAREA(1:M1SIZE) = ZERO(1:M1SIZE);              0934 03648000
         LR    @15,M1SIZE                                          0934 03649000
         BCTR  @15,0                                               0934 03650000
         EX    @15,@SM01316                                        0934 03651000
*                  CNTRL = OFF;                                    0935 03652000
         NI    CNTRL,B'01111111'                                   0935 03653000
*                  END;                                            0936 03654000
*            END;                                                  0937 03655000
@RC00927 DS    0H                                                  0937 03656000
@DE00926 TM    CNTRL,B'10000000'                                   0937 03657000
         BO    @DL00926                                            0937 03658000
*            END;                                                  0938 03659000
*          ELSE                                                    0939 03660000
*                                                                  0939 03661000
*            /********************************************************/ 03662000
*            /*                                                      */ 03663000
*            /*  LOOP MOVING 256 BYTES AT A TIME                     */ 03664000
*            /*                                                      */ 03665000
*            /********************************************************/ 03666000
*            DO;                                                   0939 03667000
         B     @RC00921                                            0939 03668000
@RF00921 DS    0H                                                  0940 03669000
*            MFPTR = MF1PTR;                                       0940 03670000
         L     @15,@PC00008+4                                      0940 03671000
         L     MFPTR,MF1PTR(,@15)                                  0940 03672000
*            MTPTR = MT1PTR;                                       0941 03673000
         L     @05,@PC00008+8                                      0941 03674000
         L     MTPTR,MT1PTR(,@05)                                  0941 03675000
*            M1SIZE = MSIZE;                                       0942 03676000
         L     @05,@PC00008                                        0942 03677000
         LH    M1SIZE,MSIZE(,@05)                                  0942 03678000
*            DOCNTRL = ON;                                         0943 03679000
         OI    DOCNTRL,B'10000000'                                 0943 03680000
*            DO WHILE (DOCNTRL = ON);                              0944 03681000
*                                                                  0944 03682000
         B     @DE00944                                            0944 03683000
@DL00944 DS    0H                                                  0945 03684000
*              /******************************************************/ 03685000
*              /*                                                    */ 03686000
*              /*  CHECK FOR MORE THAN 256 BYTES TO MOVE             */ 03687000
*              /*                                                    */ 03688000
*              /******************************************************/ 03689000
*                                                                  0945 03690000
*              IF M1SIZE > 256                                     0945 03691000
*                THEN                                              0945 03692000
         LA    @05,256                                             0945 03693000
         CR    M1SIZE,@05                                          0945 03694000
         BNH   @RF00945                                            0945 03695000
*                  DO;                                             0946 03696000
*                  /**************************************************/ 03697000
*                  /*                                                */ 03698000
*                  /*  MOVE 256 BYTES AT A TIME AND UPDATE SIZE AND  */ 03699000
*                  /*  POINTER VARIABLES FOR NEXT ITERATION          */ 03700000
*                  /*                                                */ 03701000
*                  /**************************************************/ 03702000
*                                                                  0947 03703000
*                  TOAREA(1:256) = FROMAREA(1:256);                0947 03704000
         MVC   TOAREA(256,MTPTR),FROMAREA(MFPTR)                   0947 03705000
*                  M1SIZE = M1SIZE - 256;                          0948 03706000
         SLR   M1SIZE,@05                                          0948 03707000
*                  MTPTR = MTPTR +256;                             0949 03708000
         ALR   MTPTR,@05                                           0949 03709000
*                  MFPTR = MFPTR + 256;                            0950 03710000
         ALR   MFPTR,@05                                           0950 03711000
*                  END;                                            0951 03712000
*                                                                  0951 03713000
*                ELSE                                              0952 03714000
*                  DO;                                             0952 03715000
         B     @RC00945                                            0952 03716000
@RF00945 DS    0H                                                  0953 03717000
*                  /**************************************************/ 03718000
*                  /*                                                */ 03719000
*                  /*  MOVE NUMBER OF BYTES INDICATED                */ 03720000
*                  /*                                                */ 03721000
*                  /**************************************************/ 03722000
*                                                                  0953 03723000
*                  TOAREA(1:M1SIZE) = FROMAREA(1:M1SIZE);          0953 03724000
         LR    @05,M1SIZE                                          0953 03725000
         BCTR  @05,0                                               0953 03726000
         EX    @05,@SM01318                                        0953 03727000
*                  DOCNTRL = OFF;                                  0954 03728000
         NI    DOCNTRL,B'01111111'                                 0954 03729000
*                  END;                                            0955 03730000
*              END;                                                0956 03731000
@RC00945 DS    0H                                                  0956 03732000
@DE00944 TM    DOCNTRL,B'10000000'                                 0956 03733000
         BO    @DL00944                                            0956 03734000
*            END;                                                  0957 03735000
*        /************************************************************/ 03736000
*        /*                                                          */ 03737000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 03738000
*        /*                                                          */ 03739000
*        /************************************************************/ 03740000
*                                                                  0958 03741000
*        RETURN CODE(0);                                           0958 03742000
@RC00921 SLR   @15,@15                                             0958 03743000
         L     @14,12(,@13)                                        0958 03744000
         LM    @00,@12,20(@13)                                     0958 03745000
         BR    @14                                                 0958 03746000
*END MVDAPROC;                                                     0959 03747000
*        /************************************************************/ 03748000
*        /*                                                          */ 03749000
*        /*  PROCEDURE NAME - CONTRBL                                */ 03750000
*        /*                                                          */ 03751000
*        /*  FUNCTION - BUILD A DICTIONARY CONTROL RECORD            */ 03752000
*        /*  AND WRITE IT AND THE APPROPRIATE CATALOG                */ 03753000
*        /*  WORK AREA OUT THE PORTABILITY DATA SET.                 */ 03754000
*        /*                                                          */ 03755000
*        /*  INPUT - POINTER TO THE CPL USED TO LOCATE THE           */ 03756000
*        /*  INFORMATION TO BE WRITTEN OUT AND A FLAG                */ 03757000
*        /*  INDICATING WHETHER OR NOT THE OBJECT IS A PATH          */ 03758000
*        /*                                                          */ 03759000
*        /*  OUTPUT - THE PORTABILITY DATA SET WILL HAVE             */ 03760000
*        /*  A CATALOG DICTIONARY AND A CATALOG WORK AREA            */ 03761000
*        /*  ADDED TO ITS HEADING.                                   */ 03762000
*        /*                                                          */ 03763000
*        /************************************************************/ 03764000
*                                                                  0960 03765000
*CONTRBL: PROCEDURE(INDCTGPL,TYPE);                                0960 03766000
*                                                                  0960 03767000
CONTRBL  STM   @14,@12,@SA00009                                    0960 03768000
         MVC   @PC00009(8),0(@01)                                  0960 03769000
*        /************************************************************/ 03770000
*        /*                                                          */ 03771000
*        /*  ARGUMENTS OF INVOCATION                                 */ 03772000
*        /*                                                          */ 03773000
*        /************************************************************/ 03774000
*                                                                  0961 03775000
*        DCL INDCTGPL FIXED(31); /*INDEX TO A CPL                    */ 03776000
*        DCL TYPE CHAR(1);    /*TYPE OF CONTROL RECORD               */ 03777000
*                                                                  0962 03778000
*        DCL ICONTRBL FIXED(31);   /*INDEX FOR CLEARING              */ 03779000
*                                  /*DICTIONARY AREAS                */ 03780000
*                                                                  0964 03781000
*        DCL INDEXLIM FIXED(15);   /*LOOP CONTROL FOR DICTBLD@OZ12893*/ 03782000
*                                                                  0964 03783000
*        OLDERID2 = NEWERID2;                                      0965 03784000
         L     @15,@PC00001                                        0965 03785000
         L     @15,GDTTR2(,@15)                                    0965 03786000
         MVC   @TS00001(95),NEWERID2(@15)                          0965 03787000
         MVC   OLDERID2(95,@15),@TS00001                           0965 03788000
*        NEWID2 = 'RC25';                                          0966 03789000
*                                                                  0966 03790000
         MVC   NEWID2(4,@15),@CC01176                              0966 03791000
*        /************************************************************/ 03792000
*        /*                                                          */ 03793000
*        /*  CLEAR THE CONTROL RECORD BUFFER AND INITIALIZE          */ 03794000
*        /*  POINTERS.                                               */ 03795000
*        /*                                                          */ 03796000
*        /************************************************************/ 03797000
*                                                                  0967 03798000
*        CALL MVDAPROC(LENGTH(CONREC),NULLPARM,CONRCPTR,           0967 03799000
*           SETZERO);                                              0967 03800000
*                                                                  0967 03801000
         MVC   @AL00001(16),@AL00967                               0967 03802000
         LA    @15,CONRCPTR                                        0967 03803000
         ST    @15,@AL00001+8                                      0967 03804000
         LA    @01,@AL00001                                        0967 03805000
         BAL   @14,MVDAPROC                                        0967 03806000
*        CTGPLPTR = PTRCPL(INDCTGPL);                              0968 03807000
*                                                                  0968 03808000
         L     @03,@PC00009                                        0968 03809000
         L     @03,INDCTGPL(,@03)                                  0968 03810000
         SLA   @03,2                                               0968 03811000
         L     @03,PTRCPL-4(@03)                                   0968 03812000
         ST    @03,CTGPLPTR                                        0968 03813000
*        /************************************************************/ 03814000
*        /*                                                          */ 03815000
*        /*  SET HEADER FLAGS IN CONTROL RECORD TO INDICATE          */ 03816000
*        /*  A CATALOG RECORD AND ENTYPE                             */ 03817000
*        /*  ALSO SET LENGTH OF ASSOCIATED CATALOG RECORD            */ 03818000
*        /*  IF NO INFORMATION AVAILABLE ON THE ENTYPE - TERMINATE   */ 03819000
*        /*                                                          */ 03820000
*        /************************************************************/ 03821000
*                                                                  0969 03822000
*        HEADLN = LENGTH(CONREC);                                  0969 03823000
         L     @15,CONRCPTR                                        0969 03824000
         MVC   HEADLN(2,@15),@CH01285                              0969 03825000
*        HEADFLG1 = HDFL1CAT;                                      0970 03826000
         MVI   HEADFLG1(@15),X'FF'                                 0970 03827000
*        CTGFLPTR = CTGFIELD(IENTYPE);                             0971 03828000
         L     CTGFLPTR,CTGFIELD(,@03)                             0971 03829000
*        IF CTGFLPT(1) = NULLPTR                                   0972 03830000
*          THEN                                                    0972 03831000
         L     @03,CTGFLPT(,CTGFLPTR)                              0972 03832000
         LTR   @03,@03                                             0972 03833000
         BNZ   @RF00972                                            0972 03834000
*            DO;                                                   0973 03835000
*            DARGSMOD = CEXPMSG;                                   0974 03836000
         L     @15,DDSTRU                                          0974 03837000
         MVC   DARGSMOD(3,@15),@CC00836                            0974 03838000
*            DARGSENT = NOCTFLD;                                   0975 03839000
         MVI   DARGSENT(@15),X'04'                                 0975 03840000
*            RETURN CODE(LASTCC08);                                0976 03841000
         LA    @15,8                                               0976 03842000
         L     @14,@SA00009                                        0976 03843000
         LM    @00,@12,@SA00009+8                                  0976 03844000
         BR    @14                                                 0976 03845000
*            END;                                                  0977 03846000
*                                                                  0977 03847000
*        HEADFLG2 = FENTYPE;                                       0978 03848000
*                                                                  0978 03849000
@RF00972 L     @15,CONRCPTR                                        0978 03850000
         L     @01,CTGFLPT(,CTGFLPTR)                              0978 03851000
         MVC   HEADFLG2(1,@15),FENTYPE(@01)                        0978 03852000
*        ASSRECLN = RETURNLN + LENGTH(PATHREL);                    0979 03853000
         L     @01,CTGPLPTR                                        0979 03854000
         L     @01,CTGWKA(,@01)                                    0979 03855000
         LA    @14,52                                              0979 03856000
         AH    @14,RETURNLN(,@01)                                  0979 03857000
         STH   @14,ASSRECLN(,@15)                                  0979 03858000
*        ASSRECNM = ASSRECLN / RECSZ;                              0980 03859000
         L     @07,RECSZ                                           0980 03860000
         LR    @00,@14                                             0980 03861000
         SRDA  @00,32                                              0980 03862000
         DR    @00,@07                                             0980 03863000
         STH   @01,ASSRECNM(,@15)                                  0980 03864000
*        ASSREMD = ASSRECLN // RECSZ;                              0981 03865000
         SRDA  @14,32                                              0981 03866000
         DR    @14,@07                                             0981 03867000
         LR    ASSREMD,@14                                         0981 03868000
*        IF ASSREMD > 0                                            0982 03869000
*          THEN                                                    0982 03870000
         LTR   ASSREMD,ASSREMD                                     0982 03871000
         BNP   @RF00982                                            0982 03872000
*            ASSRECNM = ASSRECNM + 1;                              0983 03873000
*                                                                  0983 03874000
         L     @03,CONRCPTR                                        0983 03875000
         AL    @01,@CF00218                                        0983 03876000
         STH   @01,ASSRECNM(,@03)                                  0983 03877000
*        /************************************************************/ 03878000
*        /*                                                          */ 03879000
*        /*  SET THE NUMBER OF DICTIONARY ENTRIES IN THE CONTROL     */ 03880000
*        /*  RECORD                                                  */ 03881000
*        /*  RGATTR WILL BE THE LAST ENTRY PROCESSED BY THE  @Z40RSSA*/ 03882000
*        /*  DICTBLD PROCEDURE.                              @Z40RSSA*/ 03883000
*        /*                                                  @Z40RSSA*/ 03884000
*        /************************************************************/ 03885000
*                                                                  0984 03886000
*        IF FENTYPE = CTGTALIN | FENTYPE = CTGTUCAT                0984 03887000
*          THEN                                                    0984 03888000
@RF00982 L     @03,CTGFLPT(,CTGFLPTR)                              0984 03889000
         CLI   FENTYPE(@03),C'A'                                   0984 03890000
         BE    @RT00984                                            0984 03891000
         CLI   FENTYPE(@03),C'U'                                   0984 03892000
         BNE   @RF00984                                            0984 03893000
@RT00984 DS    0H                                                  0985 03894000
*            DICTNM = (DIM(NVSMFLST) - 2) + 11 ;                   0985 03895000
         L     @01,CONRCPTR                                        0985 03896000
         MVC   DICTNM+8(4,@01),@CF01291                            0985 03897000
*          ELSE                                                    0986 03898000
*            DO;                                                   0986 03899000
         B     @RC00984                                            0986 03900000
@RF00984 DS    0H                                                  0987 03901000
*            IF FENTYPE =  'B'                                     0987 03902000
*              THEN                                                0987 03903000
         L     @03,CTGFLPT(,CTGFLPTR)                              0987 03904000
         CLI   FENTYPE(@03),C'B'                                   0987 03905000
         BNE   @RF00987                                            0987 03906000
*                DICTNM = (DIM(GDGFLIST) - 2) + 11;                0988 03907000
         L     @01,CONRCPTR                                        0988 03908000
         MVC   DICTNM+8(4,@01),@CF00891                            0988 03909000
*              ELSE                                                0989 03910000
*                DO;                                               0989 03911000
         B     @RC00987                                            0989 03912000
@RF00987 DS    0H                                                  0990 03913000
*                IF FENTYPE = 'X'                                  0990 03914000
*                  THEN                                            0990 03915000
         L     @03,CTGFLPT(,CTGFLPTR)                              0990 03916000
         CLI   FENTYPE(@03),C'X'                                   0990 03917000
         BNE   @RF00990                                            0990 03918000
*                    DICTNM = (DIM(ALSFLIST) - 1) + 11;            0991 03919000
         L     @01,CONRCPTR                                        0991 03920000
         MVC   DICTNM+8(4,@01),@CF01292                            0991 03921000
*                  ELSE                                            0992 03922000
*                    DICTNM = (DIM(FIELDLST) - 2) + 11;            0992 03923000
         B     @RC00990                                            0992 03924000
@RF00990 L     @01,CONRCPTR                                        0992 03925000
         MVC   DICTNM+8(4,@01),@CF00220                            0992 03926000
*                END;                                              0993 03927000
@RC00990 DS    0H                                                  0994 03928000
*            END;                                                  0994 03929000
*                                                                  0994 03930000
@RC00987 DS    0H                                                  0995 03931000
*        /************************************************************/ 03932000
*        /*                                                          */ 03933000
*        /*  INTERROGATE FPL FIELDS SETTING UP THE                   */ 03934000
*        /*  DICTIONARY FOR EACH COMPONENT.                          */ 03935000
*        /*                                                          */ 03936000
*        /************************************************************/ 03937000
*                                                                  0995 03938000
*        DINDX = 1;                                                0995 03939000
@RC00984 LA    DINDX,1                                             0995 03940000
*         IF IRGATTR>ONUM                                  /*@OZ12893*/ 03941000
*            THEN INDEXLIM=ONUM;                           /*@OZ12893*/ 03942000
         CLI   ONUM,20                                             0996 03943000
         BNL   @RF00996                                            0996 03944000
         SLR   @02,@02                                             0997 03945000
         IC    @02,ONUM                                            0997 03946000
         STH   @02,INDEXLIM                                        0997 03947000
*            ELSE INDEXLIM=IRGATTR;                        /*@OZ12893*/ 03948000
         B     @RC00996                                            0998 03949000
@RF00996 MVC   INDEXLIM(2),@CH00895                                0998 03950000
*DICTBLD: DO INDX = 1 TO INDEXLIM;                         /*@OZ12893*/ 03951000
@RC00996 DS    0H                                                  0999 03952000
DICTBLD  LA    INDX,1                                              0999 03953000
         B     @DE00999                                            0999 03954000
@DL00999 DS    0H                                                  1000 03955000
*          CTGFLPTR = CTGFIELD(INDX);                              1000 03956000
         LR    @15,INDX                                            1000 03957000
         SLA   @15,2                                               1000 03958000
         L     @01,CTGPLPTR                                        1000 03959000
         L     CTGFLPTR,CTGFIELD-4(@15,@01)                        1000 03960000
*          LGNFLD  = CTGFLNG(1);                                   1001 03961000
*                                                                  1001 03962000
*                                                                  1001 03963000
         L     LGNFLD,CTGFLNG(,CTGFLPTR)                           1001 03964000
*          /**********************************************************/ 03965000
*          /*                                                        */ 03966000
*          /*  TEST FOR NON EXISTANT OR NON-INITIALIZED FIELDS       */ 03967000
*          /*                                                        */ 03968000
*          /**********************************************************/ 03969000
*                                                                  1002 03970000
*                                                                  1002 03971000
*                                                                  1002 03972000
*                                                                  1002 03973000
*          /**********************************************************/ 03974000
*          /*                                                        */ 03975000
*          /*  IF A VARIABLE LENGTH CATALOG FIELD SUCH AS LOKEYV     */ 03976000
*          /*  IS BEING INTERROGATED, THE FIRST TWO BYTES OF THE     */ 03977000
*          /*  THE FIELD IS A LENGTH                                 */ 03978000
*          /*  VARIABLE LENGTH CATALOG FIELDS ARE USERAREC,          */ 03979000
*          /*  LOKEYV, AND HIKEYV                                    */ 03980000
*          /*                                                        */ 03981000
*          /**********************************************************/ 03982000
*                                                                  1002 03983000
*          IF (INDX = IUSRAREC |                                   1002 03984000
*              INDX = ILOKEYV |                                    1002 03985000
*              INDX = IHIKEYV)                                     1002 03986000
*            THEN                                                  1002 03987000
         C     INDX,@CF00887                                       1002 03988000
         BE    @RT01002                                            1002 03989000
         C     INDX,@CF00227                                       1002 03990000
         BE    @RT01002                                            1002 03991000
         C     INDX,@CF00481                                       1002 03992000
         BNE   @RF01002                                            1002 03993000
@RT01002 DS    0H                                                  1003 03994000
*              IF LGNFLD = 0 | FIELDLN = 0                         1003 03995000
*                THEN                                              1003 03996000
         SLR   @15,@15                                             1003 03997000
         CR    LGNFLD,@15                                          1003 03998000
         BE    @RT01003                                            1003 03999000
         L     @01,CTGFLPT(,CTGFLPTR)                              1003 04000000
         CH    @15,FIELDLN(,@01)                                   1003 04001000
         BNE   @RF01003                                            1003 04002000
@RT01003 DS    0H                                                  1004 04003000
*                  DO;                                             1004 04004000
*                                                                  1004 04005000
*                  /**************************************************/ 04006000
*                  /*                                                */ 04007000
*                  /*  IF A VARIABLE LENGTH FIELD IS NOT             */ 04008000
*                  /*  INITIALIZED OR NON-EXISTANT, THE LENGTH       */ 04009000
*                  /*  FIELD WITHIN THE DATA RETURNED BY LOCATE      */ 04010000
*                  /*  IS ZERO.  SET THE DICTIONARY LENGTH AND       */ 04011000
*                  /*  DISPLACEMENT TO ZERO.                         */ 04012000
*                  /*                                                */ 04013000
*                  /**************************************************/ 04014000
*                                                                  1005 04015000
*                  DICTLN(DINDX) = 0;                              1005 04016000
         SLR   @05,@05                                             1005 04017000
         LR    @02,DINDX                                           1005 04018000
         SLA   @02,3                                               1005 04019000
         LA    @15,8                                               1005 04020000
         AL    @15,CONRCPTR                                        1005 04021000
         LA    @01,0(@02,@15)                                      1005 04022000
         AL    @01,@CF01320                                        1005 04023000
         ST    @05,DICTLN-4(,@01)                                  1005 04024000
*                  DICTDL(DINDX) = NULLPTR;                        1006 04025000
         ST    @05,DICTDL-8(@02,@15)                               1006 04026000
*                  END;                                            1007 04027000
*                                                                  1007 04028000
*                ELSE                                              1008 04029000
*                  DO;                                             1008 04030000
         B     @RC01003                                            1008 04031000
@RF01003 DS    0H                                                  1009 04032000
*                  DICTLN(DINDX) = CTGFLNG(1);                     1009 04033000
         LR    @05,DINDX                                           1009 04034000
         SLA   @05,3                                               1009 04035000
         LA    @15,8                                               1009 04036000
         AL    @15,CONRCPTR                                        1009 04037000
         L     @14,CTGFLNG(,CTGFLPTR)                              1009 04038000
         LA    @01,0(@05,@15)                                      1009 04039000
         AL    @01,@CF01320                                        1009 04040000
         ST    @14,DICTLN-4(,@01)                                  1009 04041000
*                  DICTDL(DINDX) = CTGFLPT(1) - CTGWKA;            1010 04042000
         L     @14,CTGFLPT(,CTGFLPTR)                              1010 04043000
         L     @01,CTGPLPTR                                        1010 04044000
         SL    @14,CTGWKA(,@01)                                    1010 04045000
         ST    @14,DICTDL-8(@05,@15)                               1010 04046000
*                  END;                                            1011 04047000
*                                                                  1011 04048000
*            /********************************************************/ 04049000
*            /*                                                      */ 04050000
*            /*  FIELDS EXAMINED HERE ARE FIXED LENGTH FIELDS.       */ 04051000
*            /*  IF THE FIELDS IS NON-EXISTANT OR NOT INITIALIZED    */ 04052000
*            /*  THE ENTIRE FIELD WILL HAVE BEEN SET TO BINARY FF'S  */ 04053000
*            /*  BY LOCATE.  SET DICTIONARY LENGTH AND DISPLACEMENT  */ 04054000
*            /*  TO ZERO FOR SUCH FIELDS                             */ 04055000
*            /*                                                      */ 04056000
*            /********************************************************/ 04057000
*                                                                  1012 04058000
*            ELSE                                                  1012 04059000
*              DO;                                                 1012 04060000
         B     @RC01002                                            1012 04061000
@RF01002 DS    0H                                                  1013 04062000
*              IF (CTGFLNG(1) = 0 |                                1013 04063000
*                  CTGFLPT(1) = NULLPTR |                          1013 04064000
*                  FIELD(1:LGNFLD) = NOTINIT(1:LGNFLD))            1013 04065000
*                THEN                                              1013 04066000
         SLR   @15,@15                                             1013 04067000
         C     @15,CTGFLNG(,CTGFLPTR)                              1013 04068000
         BE    @RT01013                                            1013 04069000
         L     @14,CTGFLPT(,CTGFLPTR)                              1013 04070000
         CR    @14,@15                                             1013 04071000
         BE    @RT01013                                            1013 04072000
         LR    @15,LGNFLD                                          1013 04073000
         BCTR  @15,0                                               1013 04074000
         EX    @15,@SC01321                                        1013 04075000
         BNE   @RF01013                                            1013 04076000
@RT01013 DS    0H                                                  1014 04077000
*                  DO;                                             1014 04078000
*                  DICTLN(DINDX) = 0;                              1015 04079000
         SLR   @05,@05                                             1015 04080000
         LR    @02,DINDX                                           1015 04081000
         SLA   @02,3                                               1015 04082000
         LA    @15,8                                               1015 04083000
         AL    @15,CONRCPTR                                        1015 04084000
         LA    @01,0(@02,@15)                                      1015 04085000
         AL    @01,@CF01320                                        1015 04086000
         ST    @05,DICTLN-4(,@01)                                  1015 04087000
*                  DICTDL(DINDX) = NULLPTR;                        1016 04088000
         ST    @05,DICTDL-8(@02,@15)                               1016 04089000
*                  END;                                            1017 04090000
*                ELSE                                              1018 04091000
*                  DO;                                             1018 04092000
         B     @RC01013                                            1018 04093000
@RF01013 DS    0H                                                  1019 04094000
*                  DICTLN(DINDX) = CTGFLNG(1);                     1019 04095000
         LR    @05,DINDX                                           1019 04096000
         SLA   @05,3                                               1019 04097000
         LA    @15,8                                               1019 04098000
         AL    @15,CONRCPTR                                        1019 04099000
         L     @14,CTGFLNG(,CTGFLPTR)                              1019 04100000
         LA    @01,0(@05,@15)                                      1019 04101000
         AL    @01,@CF01320                                        1019 04102000
         ST    @14,DICTLN-4(,@01)                                  1019 04103000
*                  DICTDL(DINDX) = CTGFLPT(1) - CTGWKA;            1020 04104000
         L     @14,CTGFLPT(,CTGFLPTR)                              1020 04105000
         L     @01,CTGPLPTR                                        1020 04106000
         SL    @14,CTGWKA(,@01)                                    1020 04107000
         ST    @14,DICTDL-8(@05,@15)                               1020 04108000
*                  END;                                            1021 04109000
*                                                                  1021 04110000
*              /******************************************************/ 04111000
*              /*                                                    */ 04112000
*              /*  SPECIAL HANDLING IS REQUIRED FOR AMDSBCAT FIELD   */ 04113000
*              /*  FIELDS NORMALLY DEFINED (VIA CATALOG DEFINE) ARE  */ 04114000
*              /*  EXTRACTED AND A DICTIONARY ENTRY IS BUILT FOR     */ 04115000
*              /*  EACH FIELD.                                       */ 04116000
*              /*  IF NO INFORMATION IS RETURNED OR THE FIELDS ARE   */ 04117000
*              /*  INITIALIZED(SET TO ALL X'FF') THEN THE            */ 04118000
*              /*  DICTIONARY ENTRIES ARE SET TO ZERO                */ 04119000
*              /*                                                    */ 04120000
*              /******************************************************/ 04121000
*                                                                  1022 04122000
*              IF INDX = IAMDSB                                    1022 04123000
*                THEN                                              1022 04124000
@RC01013 C     INDX,@CF00891                                       1022 04125000
         BNE   @RF01022                                            1022 04126000
*                  DO;                                             1023 04127000
*                  CTGFLPTR = CTGFIELD(INDX);                      1024 04128000
         L     @07,CTGPLPTR                                        1024 04129000
         LR    @15,INDX                                            1024 04130000
         SLA   @15,2                                               1024 04131000
         L     CTGFLPTR,CTGFIELD-4(@15,@07)                        1024 04132000
*                  DSCCATPT = CTGFLPT(1);                          1025 04133000
         L     @15,CTGFLPT(,CTGFLPTR)                              1025 04134000
         LR    DSCCATPT,@15                                        1025 04135000
*                  RESPECIFY IDAAMDSB BASED(DSCCATPT);             1026 04136000
*                                                                  1026 04137000
*                  LGNFLD = CTGFLNG(1);                            1027 04138000
         L     @14,CTGFLNG(,CTGFLPTR)                              1027 04139000
         LR    LGNFLD,@14                                          1027 04140000
*                  IF (CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= NULLPTR  &  1028 04141000
*                      FIELD(1:LGNFLD) ^= NOTINIT(1:LGNFLD))       1028 04142000
*                    THEN                                          1028 04143000
         SLR   @01,@01                                             1028 04144000
         CR    @14,@01                                             1028 04145000
         BE    @RF01028                                            1028 04146000
         CR    @15,@01                                             1028 04147000
         BE    @RF01028                                            1028 04148000
         LR    @14,LGNFLD                                          1028 04149000
         BCTR  @14,0                                               1028 04150000
         EX    @14,@SC01323                                        1028 04151000
         BE    @RF01028                                            1028 04152000
*                      DO;                                         1029 04153000
*                      DICTLN(DINDX+1) = LENGTH(AMDATTR);          1030 04154000
         LA    @05,1                                               1030 04155000
         LR    @02,DINDX                                           1030 04156000
         SLA   @02,3                                               1030 04157000
         LA    @15,8                                               1030 04158000
         L     @14,CONRCPTR                                        1030 04159000
         ALR   @14,@15                                             1030 04160000
         ST    @05,DICTLN(@02,@14)                                 1030 04161000
*                      DICTDL(DINDX+1) = ADDR(AMDATTR) - CTGWKA;   1031 04162000
         LA    @01,AMDATTR(,DSCCATPT)                              1031 04163000
         L     @07,CTGWKA(,@07)                                    1031 04164000
         SLR   @01,@07                                             1031 04165000
         ST    @01,DICTDL(@02,@14)                                 1031 04166000
*                      DICTLN(DINDX+2) = LENGTH(AMDRKP);           1032 04167000
         LA    @01,2                                               1032 04168000
         ST    @01,DICTLN+8(@02,@14)                               1032 04169000
*                      DICTDL(DINDX+2) = ADDR(AMDRKP) - CTGWKA;    1033 04170000
         LA    @00,AMDRKP(,DSCCATPT)                               1033 04171000
         SLR   @00,@07                                             1033 04172000
         ST    @00,DICTDL+8(@02,@14)                               1033 04173000
*                      DICTLN(DINDX+3) = LENGTH(AMDKEYLN);         1034 04174000
         ST    @01,DICTLN+16(@02,@14)                              1034 04175000
*                      DICTDL(DINDX+3) = ADDR(AMDKEYLN)-CTGWKA;    1035 04176000
         LA    @00,AMDKEYLN(,DSCCATPT)                             1035 04177000
         SLR   @00,@07                                             1035 04178000
         ST    @00,DICTDL+16(@02,@14)                              1035 04179000
*                      DICTLN(DINDX+4) = LENGTH(AMDCINV);          1036 04180000
         LA    @00,4                                               1036 04181000
         ST    @00,DICTLN+24(@02,@14)                              1036 04182000
*                      DICTDL(DINDX+4) = ADDR(AMDCINV) - CTGWKA;   1037 04183000
         LA    @07,AMDCINV(,DSCCATPT)                              1037 04184000
         L     @05,CTGPLPTR                                        1037 04185000
         L     @05,CTGWKA(,@05)                                    1037 04186000
         SLR   @07,@05                                             1037 04187000
         ST    @07,DICTDL+24(@02,@14)                              1037 04188000
*                      DICTLN(DINDX+5) = LENGTH(AMDLRECL);         1038 04189000
         ST    @00,DICTLN+32(@02,@14)                              1038 04190000
*                      DICTDL(DINDX+5) = ADDR(AMDLRECL) - CTGWKA;  1039 04191000
         LA    @07,AMDLRECL(,DSCCATPT)                             1039 04192000
         SLR   @07,@05                                             1039 04193000
         ST    @07,DICTDL+32(@02,@14)                              1039 04194000
*                      DICTLN(DINDX+6) = LENGTH(AMDPCTCA);         1040 04195000
         LA    @07,1                                               1040 04196000
         ST    @07,DICTLN+40(@02,@14)                              1040 04197000
*                      DICTDL(DINDX+6) = ADDR(AMDPCTCA) - CTGWKA;  1041 04198000
         LA    @00,AMDPCTCA(,DSCCATPT)                             1041 04199000
         SLR   @00,@05                                             1041 04200000
         ST    @00,DICTDL+40(@02,@14)                              1041 04201000
*                      DICTLN(DINDX+7) = LENGTH(AMDPCTCI);         1042 04202000
         ST    @07,DICTLN+48(@02,@14)                              1042 04203000
*                      DICTDL(DINDX+7) = ADDR(AMDPCTCI) - CTGWKA;  1043 04204000
         LA    @07,AMDPCTCI(,DSCCATPT)                             1043 04205000
         SLR   @07,@05                                             1043 04206000
         ST    @07,DICTDL+48(@02,@14)                              1043 04207000
*                      DICTLN(DINDX+8) = LENGTH(AMDATTR3);         1044 04208000
         ST    @15,DICTLN+56(@02,@14)                              1044 04209000
*                      DICTDL(DINDX+8) = ADDR(AMDATTR3)-CTGWKA;    1045 04210000
         LA    @07,AMDATTR3(,DSCCATPT)                             1045 04211000
         SLR   @07,@05                                             1045 04212000
         ST    @07,DICTDL+56(@02,@14)                              1045 04213000
*                      DICTLN(DINDX+9) = LENGTH(AMDAXRKP);         1046 04214000
         ST    @01,DICTLN+64(@02,@14)                              1046 04215000
*                      DICTDL(DINDX+9) = ADDR(AMDAXRKP)-CTGWKA;    1047 04216000
         LA    @07,AMDAXRKP(,DSCCATPT)                             1047 04217000
         SLR   @07,@05                                             1047 04218000
         ST    @07,DICTDL+64(@02,@14)                              1047 04219000
*                      END;                                        1048 04220000
*                    ELSE                                          1049 04221000
*                      DO ICONTRBL = 1 TO 9;                       1049 04222000
         B     @RC01028                                            1049 04223000
@RF01028 LA    ICONTRBL,1                                          1049 04224000
@DL01049 DS    0H                                                  1050 04225000
*                        DICTLN(DINDX+ICONTRBL) = 0;               1050 04226000
         SLR   @05,@05                                             1050 04227000
         LR    @15,DINDX                                           1050 04228000
         ALR   @15,ICONTRBL                                        1050 04229000
         SLA   @15,3                                               1050 04230000
         LA    @14,8                                               1050 04231000
         AL    @14,CONRCPTR                                        1050 04232000
         LA    @01,0(@15,@14)                                      1050 04233000
         AL    @01,@CF01320                                        1050 04234000
         ST    @05,DICTLN-4(,@01)                                  1050 04235000
*                        DICTDL(DINDX+ICONTRBL) = NULLPTR;         1051 04236000
         ST    @05,DICTDL-8(@15,@14)                               1051 04237000
*                      END;                                        1052 04238000
*                                                                  1052 04239000
         AL    ICONTRBL,@CF00218                                   1052 04240000
         C     ICONTRBL,@CF00037                                   1052 04241000
         BNH   @DL01049                                            1052 04242000
*                  DINDX = DINDX + 9;                              1053 04243000
*                                                                  1053 04244000
@RC01028 AL    DINDX,@CF00037                                      1053 04245000
*                  END;                                            1054 04246000
*                                                                  1054 04247000
*               END;                                               1055 04248000
*                                                                  1055 04249000
*                                                                  1055 04250000
@RF01022 DS    0H                                                  1056 04251000
*        /************************************************************/ 04252000
*        /*                                                          */ 04253000
*        /*  INCREMENT INDEX INTO DICTIONARY                         */ 04254000
*        /*                                                          */ 04255000
*        /************************************************************/ 04256000
*                                                                  1056 04257000
*          DINDX = DINDX + 1;                                      1056 04258000
@RC01002 AL    DINDX,@CF00218                                      1056 04259000
*        END DICTBLD;                                              1057 04260000
*                                                                  1057 04261000
*                                                                  1057 04262000
         AL    INDX,@CF00218                                       1057 04263000
@DE00999 CH    INDX,INDEXLIM                                       1057 04264000
         BNH   @DL00999                                            1057 04265000
*        /************************************************************/ 04266000
*        /*                                                          */ 04267000
*        /*  IF EXPORTING AN AIX, WRITE OUT THE RELATED              */ 04268000
*        /*  NAME.                                                   */ 04269000
*        /*                                                          */ 04270000
*        /************************************************************/ 04271000
*                                                                  1058 04272000
*        IF TYPE = CTGTAIX                                         1058 04273000
*                                                                  1058 04274000
*          THEN                                                    1058 04275000
         L     @02,@PC00009+4                                      1058 04276000
         CLI   TYPE(@02),C'G'                                      1058 04277000
         BNE   @RF01058                                            1058 04278000
*            DO;                                                   1059 04279000
*            DICTLN(DINDX) = RELLEN;                               1060 04280000
         LR    @02,DINDX                                           1060 04281000
         SLA   @02,3                                               1060 04282000
         LA    @15,8                                               1060 04283000
         AL    @15,CONRCPTR                                        1060 04284000
         LA    @14,44                                              1060 04285000
         LA    @01,0(@02,@15)                                      1060 04286000
         AL    @01,@CF01320                                        1060 04287000
         ST    @14,DICTLN-4(,@01)                                  1060 04288000
*            DICTDL(DINDX) = ADDR(RELATE) - CTGWKA;                1061 04289000
         L     @01,CTGPLPTR                                        1061 04290000
         L     @14,CTGWKA(,@01)                                    1061 04291000
         LH    @07,RETURNLN(,@14)                                  1061 04292000
         ALR   @07,@14                                             1061 04293000
         LCR   @14,@14                                             1061 04294000
         ALR   @14,@07                                             1061 04295000
         ST    @14,DICTDL-8(@02,@15)                               1061 04296000
*            RELATE = RELNAME;                                     1062 04297000
         MVC   RELATE(44,@07),RELNAME                              1062 04298000
*            DICTLN(DINDX+1) = 0;                                  1063 04299000
         SLR   @14,@14                                             1063 04300000
         ST    @14,DICTLN(@02,@15)                                 1063 04301000
*            DICTDL(DINDX+1) = NULLPTR;                            1064 04302000
         ST    @14,DICTDL(@02,@15)                                 1064 04303000
*            END;                                                  1065 04304000
*                                                                  1065 04305000
*                                                                  1065 04306000
*                                                                  1065 04307000
*                                                                  1065 04308000
*          ELSE                                                    1066 04309000
*                                                                  1066 04310000
*          /**********************************************************/ 04311000
*          /*                                                        */ 04312000
*          /*  IF WRITING OUT A PATH RECORD, WRITE OUT THE           */ 04313000
*          /*  NAME AND PASSWORD OF THE DATA SET BEING               */ 04314000
*          /*  EXPORTED AS THE PATHENTRY AND PATHPASS                */ 04315000
*          /*  ENTRIES IN THE DICTIONARY.                            */ 04316000
*          /*                                                        */ 04317000
*          /**********************************************************/ 04318000
*                                                                  1066 04319000
*            IF TYPE = CTGTPTH                                     1066 04320000
*              THEN                                                1066 04321000
         B     @RC01058                                            1066 04322000
@RF01058 L     @02,@PC00009+4                                      1066 04323000
         CLI   TYPE(@02),C'R'                                      1066 04324000
         BNE   @RF01066                                            1066 04325000
*                DO;                                               1067 04326000
*                DICTLN(DINDX) = LENGTH(PATHENT);                  1068 04327000
         LR    @02,DINDX                                           1068 04328000
         SLA   @02,3                                               1068 04329000
         LA    @15,8                                               1068 04330000
         L     @14,CONRCPTR                                        1068 04331000
         ALR   @14,@15                                             1068 04332000
         LA    @07,44                                              1068 04333000
         LA    @06,0(@02,@14)                                      1068 04334000
         AL    @06,@CF01320                                        1068 04335000
         ST    @07,DICTLN-4(,@06)                                  1068 04336000
*                DICTDL(DINDX) = ADDR(PATHENT) - CTGWKA;           1069 04337000
         L     @01,CTGPLPTR                                        1069 04338000
         L     @07,CTGWKA(,@01)                                    1069 04339000
         LH    @06,RETURNLN(,@07)                                  1069 04340000
         ALR   @06,@07                                             1069 04341000
         LR    @05,@06                                             1069 04342000
         SLR   @05,@07                                             1069 04343000
         ST    @05,DICTDL-8(@02,@14)                               1069 04344000
*                PATHENT = PTRCPL(1) ->                            1070 04345000
*                   CTGFIELD(IENTNAME) -> CTGFLPT(1)               1070 04346000
*                   -> FENTNAME;                                   1070 04347000
         L     @05,PTRCPL                                          1070 04348000
         L     @01,CTGFIELD+4(,@05)                                1070 04349000
         L     @01,CTGFLPT(,@01)                                   1070 04350000
         MVC   PATHENT(44,@06),FENTNAME(@01)                       1070 04351000
*                IF (PTRCPL(1)->CTGFIELD(IPASSWOR)->CTGFLPT(1)     1071 04352000
*                  ^= NULLPTR) &                                   1071 04353000
*                  (PTRCPL(1)->CTGFIELD(IPASSWOR)->CTGFLNG(1)      1071 04354000
*                  ^= 0) &                                         1071 04355000
*                  (PTRCPL(1)->CTGFIELD(IPASSWOR)->CTGFLPT(1)      1071 04356000
*                  ->FPASSMWR) ^= NOTINIT(1:8)                     1071 04357000
*                  THEN                                            1071 04358000
         SLR   @04,@04                                             1071 04359000
         L     @05,CTGFIELD+36(,@05)                               1071 04360000
         L     @01,CTGFLPT(,@05)                                   1071 04361000
         CR    @01,@04                                             1071 04362000
         BE    @RF01071                                            1071 04363000
         C     @04,CTGFLNG(,@05)                                   1071 04364000
         BE    @RF01071                                            1071 04365000
         CLC   FPASSMWR(8,@01),NOTINIT                             1071 04366000
         BE    @RF01071                                            1071 04367000
*                    DO;                                           1072 04368000
*                    DICTLN(DINDX+1) = LENGTH(PATHPASS);           1073 04369000
         ST    @15,DICTLN(@02,@14)                                 1073 04370000
*                    DICTDL(DINDX+1) = ADDR(PATHPASS)              1074 04371000
*                       - CTGWKA;                                  1074 04372000
         LA    @15,PATHPASS(,@06)                                  1074 04373000
         SLR   @15,@07                                             1074 04374000
         ST    @15,DICTDL(@02,@14)                                 1074 04375000
*                    PATHPASS = PTRCPL(1) ->                       1075 04376000
*                       CTGFIELD(IPASSWOR) ->                      1075 04377000
*                       CTGFLPT(1) -> FPASSMWR;                    1075 04378000
         MVC   PATHPASS(8,@06),FPASSMWR(@01)                       1075 04379000
*                    END;                                          1076 04380000
*                END;                                              1077 04381000
*                                                                  1077 04382000
*              ELSE                                                1078 04383000
*                                                                  1078 04384000
*              /******************************************************/ 04385000
*              /*                                                    */ 04386000
*              /*  THE COMPONENT IS NEITHER AIX NOR PATH             */ 04387000
*              /*  ZERO OUT THE NEXT TWO FIELDS IN THE       @Z40RSSA*/ 04388000
*              /*  DICTIONARY.                                       */ 04389000
*              /*                                                    */ 04390000
*              /******************************************************/ 04391000
*                                                                  1078 04392000
*                DO;                                               1078 04393000
         B     @RC01066                                            1078 04394000
@RF01066 DS    0H                                                  1079 04395000
*                DICTLN(DINDX) = 0;                                1079 04396000
         SLR   @02,@02                                             1079 04397000
         LR    @15,DINDX                                           1079 04398000
         SLA   @15,3                                               1079 04399000
         LA    @14,8                                               1079 04400000
         AL    @14,CONRCPTR                                        1079 04401000
         LA    @01,0(@15,@14)                                      1079 04402000
         AL    @01,@CF01320                                        1079 04403000
         ST    @02,DICTLN-4(,@01)                                  1079 04404000
*                DICTDL(DINDX) = NULLPTR;                          1080 04405000
         ST    @02,DICTDL-8(@15,@14)                               1080 04406000
*                DICTLN(DINDX+1) = 0;                              1081 04407000
         ST    @02,DICTLN(@15,@14)                                 1081 04408000
*                DICTDL(DINDX+1) = NULLPTR;                        1082 04409000
         ST    @02,DICTDL(@15,@14)                                 1082 04410000
*                END;                                              1083 04411000
*                                                                  1083 04412000
*        DINDX = DINDX + 2;                                        1084 04413000
*                                                                  1084 04414000
@RC01066 DS    0H                                                  1084 04415000
@RC01058 AL    DINDX,@CF00152                                      1084 04416000
*        /*  INSERT THE REMAINING ENTRIES INTO THE DICTIONARY.     1085 04417000
*          THESE ENTRIES WERE MADE AFTER RELEASE 2 OF VSAM.        1085 04418000
*          NOTE, THAT THE DICTIONARY ENTIRES FOLLOW THE            1085 04419000
*          PASSREL ENTRY WHILE THE WORK AREAS POINTED TO           1085 04420000
*          BY THE DICT ENTRY PRECEDE THE RELATE OR PATHENTRY @Z40RSSA*/ 04421000
*MORBILD: DO INDX =  ISECFLGS TO ONUM;                     /*@Z40RSSA*/ 04422000
MORBILD  LA    INDX,21                                             1085 04423000
         B     @DE01085                                            1085 04424000
@DL01085 DS    0H                                                  1086 04425000
*           CTGFLPTR = CTGFIELD(INDX);                     /*@Z40RSSA*/ 04426000
         LR    @15,INDX                                            1086 04427000
         SLA   @15,2                                               1086 04428000
         L     @01,CTGPLPTR                                        1086 04429000
         L     CTGFLPTR,CTGFIELD-4(@15,@01)                        1086 04430000
*           LGNFLD = CTGFLNG(1);                           /*@Z40RSSA*/ 04431000
         L     @15,CTGFLNG(,CTGFLPTR)                              1087 04432000
         LR    LGNFLD,@15                                          1087 04433000
*           IF (CTGFLNG(1) = 0 |                           /*@Z40RSSA*/ 04434000
*               CTGFLPT(1) = NULLPTR |                     /*@Z40RSSA*/ 04435000
*               FIELD(1:LGNFLD) = NOTINIT(1:LGNFLD))       /*@Z40RSSA*/ 04436000
*            THEN                                          /*@Z40RSSA*/ 04437000
         SLR   @14,@14                                             1088 04438000
         CR    @15,@14                                             1088 04439000
         BE    @RT01088                                            1088 04440000
         L     @15,CTGFLPT(,CTGFLPTR)                              1088 04441000
         CR    @15,@14                                             1088 04442000
         BE    @RT01088                                            1088 04443000
         LR    @14,LGNFLD                                          1088 04444000
         BCTR  @14,0                                               1088 04445000
         EX    @14,@SC01323                                        1088 04446000
         BNE   @RF01088                                            1088 04447000
@RT01088 DS    0H                                                  1089 04448000
*              DO;                                         /*@Z40RSSA*/ 04449000
*              DICTLN(DINDX) = 0;                          /*@Z40RSSA*/ 04450000
         SLR   @05,@05                                             1090 04451000
         LR    @02,DINDX                                           1090 04452000
         SLA   @02,3                                               1090 04453000
         LA    @15,8                                               1090 04454000
         AL    @15,CONRCPTR                                        1090 04455000
         LA    @01,0(@02,@15)                                      1090 04456000
         AL    @01,@CF01320                                        1090 04457000
         ST    @05,DICTLN-4(,@01)                                  1090 04458000
*              DICTDL(DINDX) = NULLPTR;                    /*@Z40RSSA*/ 04459000
         ST    @05,DICTDL-8(@02,@15)                               1091 04460000
*              END;                                        /*@Z40RSSA*/ 04461000
*            ELSE                                          /*@Z40RSSA*/ 04462000
*              DO;                                         /*@Z40RSSA*/ 04463000
         B     @RC01088                                            1093 04464000
@RF01088 DS    0H                                                  1094 04465000
*              DICTLN(DINDX) = CTGFLNG(1);                 /*@Z40RSSA*/ 04466000
         LR    @05,DINDX                                           1094 04467000
         SLA   @05,3                                               1094 04468000
         LA    @15,8                                               1094 04469000
         AL    @15,CONRCPTR                                        1094 04470000
         L     @14,CTGFLNG(,CTGFLPTR)                              1094 04471000
         LA    @01,0(@05,@15)                                      1094 04472000
         AL    @01,@CF01320                                        1094 04473000
         ST    @14,DICTLN-4(,@01)                                  1094 04474000
*              DICTDL(DINDX) = CTGFLPT(1) - CTGWKA;        /*@Z40RSSA*/ 04475000
         L     @14,CTGFLPT(,CTGFLPTR)                              1095 04476000
         L     @01,CTGPLPTR                                        1095 04477000
         SL    @14,CTGWKA(,@01)                                    1095 04478000
         ST    @14,DICTDL-8(@05,@15)                               1095 04479000
*              END;                                        /*@Z40RSSA*/ 04480000
*              DINDX = DINDX + 1;                          /*@Z40RSSA*/ 04481000
@RC01088 AL    DINDX,@CF00218                                      1097 04482000
*        END   MORBILD;                                    /*@Z40RSSA*/ 04483000
         AL    INDX,@CF00218                                       1098 04484000
@DE01085 SLR   @05,@05                                             1098 04485000
         IC    @05,ONUM                                            1098 04486000
         CR    INDX,@05                                            1098 04487000
         BNH   @DL01085                                            1098 04488000
*        /************************************************************/ 04489000
*        /*                                                          */ 04490000
*        /*  WRITE CONTROL RECORD OUT TO PORTABILITY DATA SET        */ 04491000
*        /*  THEN WRITE OUT THE WORK AREA AS A SEPARATE RECORD       */ 04492000
*        /*  IF AN ERROR IS ENCOUNTERED, CONTROL IS RETURNED TO THE  */ 04493000
*        /*  CALLING PROCESSOR                                       */ 04494000
*        /*                                                          */ 04495000
*        /************************************************************/ 04496000
*                                                                  1099 04497000
*        SAVLEN = HEADLN;                                          1099 04498000
*                                                                  1099 04499000
         L     @01,CONRCPTR                                        1099 04500000
         LH    @15,HEADLN(,@01)                                    1099 04501000
         STH   @15,SAVLEN                                          1099 04502000
*        CALL SAVEPROC(SAVLEN,CONRCPTR,'H');                       1100 04503000
*                                                                  1100 04504000
         LA    @15,SAVLEN                                          1100 04505000
         ST    @15,@AL00001                                        1100 04506000
         LA    @15,CONRCPTR                                        1100 04507000
         ST    @15,@AL00001+4                                      1100 04508000
         LA    @15,@CC01070                                        1100 04509000
         ST    @15,@AL00001+8                                      1100 04510000
         LA    @01,@AL00001                                        1100 04511000
         BAL   @14,SAVEPROC                                        1100 04512000
*        RESPECIFY RTNREG RSTD;                                    1101 04513000
*        TESTRC = RTNREG;                                          1102 04514000
         LR    TESTRC,RTNREG                                       1102 04515000
*        RESPECIFY RTNREG UNRSTD;                                  1103 04516000
*        IF TESTRC ^= 0                                            1104 04517000
*          THEN                                                    1104 04518000
         LTR   TESTRC,TESTRC                                       1104 04519000
         BZ    @RF01104                                            1104 04520000
*            RETURN CODE(LASTCC16);                                1105 04521000
*                                                                  1105 04522000
         LA    @15,16                                              1105 04523000
         L     @14,@SA00009                                        1105 04524000
         LM    @00,@12,@SA00009+8                                  1105 04525000
         BR    @14                                                 1105 04526000
*        SAVLEN = RETURNLN + LENGTH(PATHREL);                      1106 04527000
*                                                                  1106 04528000
@RF01104 L     @15,CTGPLPTR                                        1106 04529000
         L     @01,CTGWKA(,@15)                                    1106 04530000
         LH    @01,RETURNLN(,@01)                                  1106 04531000
         LA    @01,52(,@01)                                        1106 04532000
         STH   @01,SAVLEN                                          1106 04533000
*        CALL SAVEPROC(SAVLEN,CTGWKA,'H');                         1107 04534000
*                                                                  1107 04535000
         LA    @14,SAVLEN                                          1107 04536000
         ST    @14,@AL00001                                        1107 04537000
         LA    @15,CTGWKA(,@15)                                    1107 04538000
         ST    @15,@AL00001+4                                      1107 04539000
         LA    @15,@CC01070                                        1107 04540000
         ST    @15,@AL00001+8                                      1107 04541000
         LA    @01,@AL00001                                        1107 04542000
         BAL   @14,SAVEPROC                                        1107 04543000
*        RESPECIFY RTNREG RSTD;                                    1108 04544000
*        TESTRC = RTNREG;                                          1109 04545000
         LR    TESTRC,RTNREG                                       1109 04546000
*        RESPECIFY RTNREG UNRSTD;                                  1110 04547000
*        IF TESTRC ^= 0                                            1111 04548000
*          THEN                                                    1111 04549000
         LTR   TESTRC,TESTRC                                       1111 04550000
         BZ    @RF01111                                            1111 04551000
*            RETURN CODE(LASTCC16);                                1112 04552000
*                                                                  1112 04553000
         LA    @15,16                                              1112 04554000
         L     @14,@SA00009                                        1112 04555000
         LM    @00,@12,@SA00009+8                                  1112 04556000
         BR    @14                                                 1112 04557000
*        /************************************************************/ 04558000
*        /*                                                          */ 04559000
*        /*  RETURN TO THE CALLING PROCESSOR INDICATING              */ 04560000
*        /*  SUCCESS.                                                */ 04561000
*        /*                                                          */ 04562000
*        /************************************************************/ 04563000
*                                                                  1113 04564000
*        RETURN CODE(0);                                           1113 04565000
*                                                                  1113 04566000
@RF01111 SLR   @15,@15                                             1113 04567000
         L     @14,@SA00009                                        1113 04568000
         LM    @00,@12,@SA00009+8                                  1113 04569000
         BR    @14                                                 1113 04570000
*END CONTRBL;                                                      1114 04571000
*        /************************************************************/ 04572000
*        /*                                                          */ 04573000
*        /*  PROCEDURE NAME - NVSMPROC                               */ 04574000
*        /*                                                          */ 04575000
*        /*  FUNCTION - OBTAINS CATALOG INFORMATION ABOUT            */ 04576000
*        /*  THE OBJECT BEING EXPORTED AND ANY ALIAS'S DEFINED       */ 04577000
*        /*  OVER IT.  BUILDS CONTROL  RECORDS, AND                  */ 04578000
*        /*  WRITES OUT THE HEADER RECORDS OF THE                    */ 04579000
*        /*  PORTABILITY DATA SET.  CALLS LOWER LEVEL                */ 04580000
*        /*  PROCEDURES TO WRITE THE CATALOG RECORDS OF THE DATA     */ 04581000
*        /*  SET BEING EXPORTED TO THE PORTABILITY DATA              */ 04582000
*        /*  SET.                                                    */ 04583000
*        /*                                                          */ 04584000
*        /* INPUT - FDT                                              */ 04585000
*        /*                                                          */ 04586000
*        /*  OUTPUT - PORTABILITY DATA SET THAT CAN BE EMPLOYED BY   */ 04587000
*        /*  THE IMPORT FSR TO RECONSTRUCT THE NON VSAM OBJECT ON THE*/ 04588000
*        /*  SAME SYSTEM OR ON A DIFFERENT SYSTEM.                   */ 04589000
*        /*                                                          */ 04590000
*        /************************************************************/ 04591000
*                                                                  1115 04592000
*NVSMPROC: PROCEDURE;                                              1115 04593000
*                                                                  1115 04594000
NVSMPROC STM   @14,@12,@SA00010                                    1115 04595000
*        OLDERID2 = NEWERID2;                                      1116 04596000
         L     @05,@PC00001                                        1116 04597000
         L     @15,GDTTR2(,@05)                                    1116 04598000
         MVC   @TS00001(95),NEWERID2(@15)                          1116 04599000
         MVC   OLDERID2(95,@15),@TS00001                           1116 04600000
*        NEWID2 = 'RC27';                                          1117 04601000
         MVC   NEWID2(4,@15),@CC01185                              1117 04602000
*        IF GDTDBG = NULLPTR                                       1118 04603000
*          THEN;                                                   1118 04604000
         L     @05,GDTDBG(,@05)                                    1118 04605000
         LTR   @05,@05                                             1118 04606000
         BZ    @RT01118                                            1118 04607000
*          ELSE                                                    1120 04608000
*            CALL IDCDB010 (GDTTBL,'RC28');                        1120 04609000
*                                                                  1120 04610000
         L     @05,@PC00001                                        1120 04611000
         ST    @05,@AL00001                                        1120 04612000
         LA    @15,@CC01186                                        1120 04613000
         ST    @15,@AL00001+4                                      1120 04614000
         MVI   @AL00001+4,X'80'                                    1120 04615000
         L     @15,GDTDBG(,@05)                                    1120 04616000
         LA    @01,@AL00001                                        1120 04617000
         BALR  @14,@15                                             1120 04618000
*        /************************************************************/ 04619000
*        /*                                                          */ 04620000
*        /*  BUILD CPL AND FPL'S FOR CATALOG LOCATE FUNCTION         */ 04621000
*        /*                                                          */ 04622000
*        /************************************************************/ 04623000
*                                                                  1121 04624000
*        CNUM = (DIM(NVSMFLST));       /*FIELD LIST FOR FIRST LOCATE */ 04625000
@RT01118 MVI   CNUM,X'0A'                                          1121 04626000
*        ONUM = (DIM(NVSMFLST) -2);    /*FIELD LIST WITHOUT FPL'S FOR*/ 04627000
         MVI   ONUM,X'08'                                          1122 04628000
*                                      /*CATACB AND NAMEDS.          */ 04629000
*                                                                  1123 04630000
*        /************************************************************/ 04631000
*        /*                                                          */ 04632000
*        /*  PERFORM LOCATE ON THE NON VSAM OBJECT'S CI NUMBER       */ 04633000
*        /*  CALL LOCPROC TO BUILD THE NECESSARY CPL AND FPLS.       */ 04634000
*        /*  CALL CTLGPROC TO INVOKE CATALOG MANAGEMENT FOR LOCATE   */ 04635000
*        /*                                                          */ 04636000
*        /************************************************************/ 04637000
*                                                                  1123 04638000
*        CALL LOCPROC(OBJVAL,NULLPARM,NVSMFLST,CNUM,PTRCPL(NVMCPLNO));  04639000
*                                                                  1123 04640000
         L     @05,@PC00001+4                                      1123 04641000
         L     @05,INPPTR(,@05)                                    1123 04642000
         L     @05,INPTBL(,@05)                                    1123 04643000
         LA    @05,OBJVAL(,@05)                                    1123 04644000
         ST    @05,@AL00001                                        1123 04645000
         LA    @05,NULLPARM                                        1123 04646000
         ST    @05,@AL00001+4                                      1123 04647000
         LA    @05,NVSMFLST                                        1123 04648000
         ST    @05,@AL00001+8                                      1123 04649000
         LA    @05,CNUM                                            1123 04650000
         ST    @05,@AL00001+12                                     1123 04651000
         LA    @05,PTRCPL+4                                        1123 04652000
         ST    @05,@AL00001+16                                     1123 04653000
         LA    @01,@AL00001                                        1123 04654000
         BAL   @14,LOCPROC                                         1123 04655000
*        /************************************************************/ 04656000
*        /*                                                          */ 04657000
*        /* IF LOCPROC FAILS TO BUILD CPL'S AND FPL'S -TERMINATE     */ 04658000
*        /*                                                          */ 04659000
*        /************************************************************/ 04660000
*                                                                  1124 04661000
*        RESPECIFY RTNREG RSTD;                                    1124 04662000
*        TESTRC = RTNREG;                                          1125 04663000
         LR    TESTRC,RTNREG                                       1125 04664000
*        RESPECIFY RTNREG UNRSTD;                                  1126 04665000
*        IF TESTRC ^= 0                                            1127 04666000
*          THEN                                                    1127 04667000
         LTR   TESTRC,TESTRC                                       1127 04668000
         BZ    @RF01127                                            1127 04669000
*            RETURN CODE(LASTCC16);                                1128 04670000
*                                                                  1128 04671000
         LA    @15,16                                              1128 04672000
         L     @14,@SA00010                                        1128 04673000
         LM    @00,@12,@SA00010+8                                  1128 04674000
         BR    @14                                                 1128 04675000
*        CALL CTLGPROC(PTRCPL(NVMCPLNO));                          1129 04676000
*                                                                  1129 04677000
@RF01127 LA    @05,PTRCPL+4                                        1129 04678000
         ST    @05,@AL00001                                        1129 04679000
         LA    @01,@AL00001                                        1129 04680000
         BAL   @14,CTLGPROC                                        1129 04681000
*        /************************************************************/ 04682000
*        /*                                                          */ 04683000
*        /* IF CTLGPROC FAILS TO PERFORM THE LOCATES - TERMINATE     */ 04684000
*        /*                                                          */ 04685000
*        /************************************************************/ 04686000
*                                                                  1130 04687000
*        RESPECIFY RTNREG RSTD;                                    1130 04688000
*        TESTRC = RTNREG;                                          1131 04689000
         LR    TESTRC,RTNREG                                       1131 04690000
*        RESPECIFY RTNREG UNRSTD;                                  1132 04691000
*                                                                  1132 04692000
*        IF TESTRC ^= 0                                            1133 04693000
*          THEN                                                    1133 04694000
*                                                                  1133 04695000
         LTR   TESTRC,TESTRC                                       1133 04696000
         BZ    @RF01133                                            1133 04697000
*            /********************************************************/ 04698000
*            /*                                                      */ 04699000
*            /* IF SEVERE ERROR RETURN WITH TERMINATION CODE ELSE    */ 04700000
*            /*  RETURN INDICATES THIS REQUEST COULD NOT BE PROCESSED*/ 04701000
*            /*                                                      */ 04702000
*            /********************************************************/ 04703000
*            IF TESTRC = LASTCC16                                  1134 04704000
*              THEN                                                1134 04705000
         LA    @03,16                                              1134 04706000
         CR    TESTRC,@03                                          1134 04707000
         BNE   @RF01134                                            1134 04708000
*                RETURN CODE(LASTCC16);                            1135 04709000
         LR    @15,@03                                             1135 04710000
         L     @14,@SA00010                                        1135 04711000
         LM    @00,@12,@SA00010+8                                  1135 04712000
         BR    @14                                                 1135 04713000
*              ELSE                                                1136 04714000
*                RETURN CODE(LASTCC08);                            1136 04715000
*                                                                  1136 04716000
@RF01134 LA    @15,8                                               1136 04717000
         L     @14,@SA00010                                        1136 04718000
         LM    @00,@12,@SA00010+8                                  1136 04719000
         BR    @14                                                 1136 04720000
*          ELSE;                                                   1137 04721000
*                                                                  1137 04722000
@RF01133 DS    0H                                                  1138 04723000
*        /************************************************************/ 04724000
*        /*                                                          */ 04725000
*        /*  GET ENTYPE FPL AND EXAMINE RETURNED FIELD INFORMATION   */ 04726000
*        /*  TO INSURE THAT ENTRYVAL WAS INDEED A NON VSAM OBJECT    */ 04727000
*        /*  OR USER CATALOG                                         */ 04728000
*        /*                                                          */ 04729000
*        /************************************************************/ 04730000
*                                                                  1138 04731000
*        CTGPLPTR = PTRCPL(NVMCPLNO);                              1138 04732000
         L     @05,PTRCPL+4                                        1138 04733000
         ST    @05,CTGPLPTR                                        1138 04734000
*        CTGFLPTR = CTGFIELD(IENTYPE);                             1139 04735000
         L     CTGFLPTR,CTGFIELD(,@05)                             1139 04736000
*        IF CTGFLNG(1) = 0 & CTGFLPT(1) = 0                        1140 04737000
*          THEN                                                    1140 04738000
         SLR   @05,@05                                             1140 04739000
         C     @05,CTGFLNG(,CTGFLPTR)                              1140 04740000
         BNE   @RF01140                                            1140 04741000
         C     @05,CTGFLPT(,CTGFLPTR)                              1140 04742000
         BNE   @RF01140                                            1140 04743000
*            DO;                                                   1141 04744000
*            DARGSMOD = CEXPMSG;                                   1142 04745000
         L     @15,DDSTRU                                          1142 04746000
         MVC   DARGSMOD(3,@15),@CC00836                            1142 04747000
*            DARGSENT = NOCTFLD;                                   1143 04748000
         MVI   DARGSENT(@15),X'04'                                 1143 04749000
*            RETURN CODE(LASTCC08);                                1144 04750000
         LA    @15,8                                               1144 04751000
         L     @14,@SA00010                                        1144 04752000
         LM    @00,@12,@SA00010+8                                  1144 04753000
         BR    @14                                                 1144 04754000
*            END;                                                  1145 04755000
*                                                                  1145 04756000
*          ELSE                                                    1146 04757000
*            IF FENTYPE ^= CTGTALIN & FENTYPE ^= CTGTUCAT          1146 04758000
*              THEN                                                1146 04759000
@RF01140 L     @05,CTGFLPT(,CTGFLPTR)                              1146 04760000
         CLI   FENTYPE(@05),C'A'                                   1146 04761000
         BE    @RF01146                                            1146 04762000
         CLI   FENTYPE(@05),C'U'                                   1146 04763000
         BE    @RF01146                                            1146 04764000
*                DO;                                               1147 04765000
*                DARGSMOD = EXPMSG;                                1148 04766000
         L     @15,DDSTRU                                          1148 04767000
         MVC   DARGSMOD(3,@15),@CC00834                            1148 04768000
*                DARGSENT = NOVALOBJ;                              1149 04769000
         MVI   DARGSENT(@15),X'03'                                 1149 04770000
*                RETURN CODE(LASTCC08);                            1150 04771000
         LA    @15,8                                               1150 04772000
         L     @14,@SA00010                                        1150 04773000
         LM    @00,@12,@SA00010+8                                  1150 04774000
         BR    @14                                                 1150 04775000
*                END;                                              1151 04776000
*                                                                  1151 04777000
*              ELSE;                                               1152 04778000
*                                                                  1152 04779000
@RF01146 DS    0H                                                  1153 04780000
*        /************************************************************/ 04781000
*        /*                                                          */ 04782000
*        /*  GET CATALOG ACB FIELD IF RETURNED IN FPL FOR CATACB     */ 04783000
*        /*                                                          */ 04784000
*        /************************************************************/ 04785000
*                                                                  1153 04786000
*        CTGFLPTR = CTGFIELD(NCATACB);                             1153 04787000
         L     @05,CTGPLPTR                                        1153 04788000
         L     CTGFLPTR,CTGFIELD+36(,@05)                          1153 04789000
*        PTRCTACB = FCATACB;                                       1154 04790000
*                                                                  1154 04791000
         L     @03,CTGFLPT(,CTGFLPTR)                              1154 04792000
         L     @03,FCATACB(,@03)                                   1154 04793000
         ST    @03,PTRCTACB                                        1154 04794000
*        /************************************************************/ 04795000
*        /*                                                          */ 04796000
*        /*  GET NAMEDS FPL FOR NUMBER OF ASSOCIATIONS               */ 04797000
*        /*                                                          */ 04798000
*        /************************************************************/ 04799000
*                                                                  1155 04800000
*        CTGFLPTR = CTGFIELD(NNAMEDS);                             1155 04801000
         L     CTGFLPTR,CTGFIELD+32(,@05)                          1155 04802000
*        IF CTGFLNG(1) = 0                                         1156 04803000
*          THEN                                                    1156 04804000
         SLR   @05,@05                                             1156 04805000
         C     @05,CTGFLNG(,CTGFLPTR)                              1156 04806000
         BNE   @RF01156                                            1156 04807000
*            NUMASSOC = 0;                                         1157 04808000
         STH   @05,NUMASSOC                                        1157 04809000
*          ELSE                                                    1158 04810000
*            DO;                                                   1158 04811000
         B     @RC01156                                            1158 04812000
@RF01156 DS    0H                                                  1159 04813000
*            FNMPTR = CTGFLPT(1);                                  1159 04814000
         L     @05,CTGFLPT(,CTGFLPTR)                              1159 04815000
         ST    @05,FNMPTR                                          1159 04816000
*            NUMASSOC = CTGFLNG(1) / LNAMEDS;                      1160 04817000
         L     @00,CTGFLNG(,CTGFLPTR)                              1160 04818000
         SRDA  @00,32                                              1160 04819000
         D     @00,@CF00041                                        1160 04820000
         STH   @01,NUMASSOC                                        1160 04821000
*            NVSMALS = ON;                                         1161 04822000
         OI    NVSMALS,B'00000010'                                 1161 04823000
*            END;                                                  1162 04824000
*                                                                  1162 04825000
*        /************************************************************/ 04826000
*        /*                                                          */ 04827000
*        /*  WRITE CATALOG INFORMATION TO THE PORTABILITY DATA SET   */ 04828000
*        /*  CATALOG INFORMATION WILL BE CONTAINED IN TWO TYPES OF   */ 04829000
*        /*  RECORDS- CONTROL RECORDS CONTAINING A DICTIONARY        */ 04830000
*        /*  INDEXING EACH CATALOG FIELD IN THE WORK AREA RETURNED   */ 04831000
*        /*  BY VSAM AND DATA RECORDS CONTAINING THE ENTIRE WORK     */ 04832000
*        /*  AREA RETURNED BY LOCATE                                 */ 04833000
*        /*                                                          */ 04834000
*        /************************************************************/ 04835000
*                                                                  1163 04836000
*        OLDERID2 = NEWERID2;                                      1163 04837000
@RC01156 L     @05,@PC00001                                        1163 04838000
         L     @03,GDTTR2(,@05)                                    1163 04839000
         MVC   @TS00001(95),NEWERID2(@03)                          1163 04840000
         MVC   OLDERID2(95,@03),@TS00001                           1163 04841000
*        NEWID2 = 'RC29';                                          1164 04842000
*                                                                  1164 04843000
         MVC   NEWID2(4,@03),@CC01187                              1164 04844000
*        /************************************************************/ 04845000
*        /*                                                          */ 04846000
*        /*  GET AN AREA FOR THE CONTROL RECORD OUTPUT BUFFER        */ 04847000
*        /*  IF CORE NOT OBTAINED, RETURN TO CALLING PROCESSOR       */ 04848000
*        /*                                                          */ 04849000
*        /************************************************************/ 04850000
*                                                                  1165 04851000
*        CALL IDCSAGP0 (GDTTBL,LENGTH(CONREC),CONRCPTR,GPID,SETZERO);   04852000
*                                                                  1165 04853000
         MVC   @AL00001+4(16),@AL01165                             1165 04854000
         ST    @05,@AL00001                                        1165 04855000
         LA    @03,CONRCPTR                                        1165 04856000
         ST    @03,@AL00001+8                                      1165 04857000
         L     @15,GDTGPL(,@05)                                    1165 04858000
         LA    @01,@AL00001                                        1165 04859000
         BALR  @14,@15                                             1165 04860000
*        RESPECIFY RTNREG RSTD;                                    1166 04861000
*        TESTRC = RTNREG;                                          1167 04862000
         LR    TESTRC,RTNREG                                       1167 04863000
*        RESPECIFY RTNREG UNRSTD;                                  1168 04864000
*        IF TESTRC ^= 0                                            1169 04865000
*          THEN                                                    1169 04866000
         LTR   TESTRC,TESTRC                                       1169 04867000
         BZ    @RF01169                                            1169 04868000
*            DO;                                                   1170 04869000
*            DARGSMOD = UNIVMSG;                                   1171 04870000
         L     @15,DDSTRU                                          1171 04871000
         MVC   DARGSMOD(3,@15),@CC00847                            1171 04872000
*            DARGSENT = NOSTORAG;                                  1172 04873000
         MVI   DARGSENT(@15),X'04'                                 1172 04874000
*            RETURN CODE(LASTCC16);                                1173 04875000
         LA    @15,16                                              1173 04876000
         L     @14,@SA00010                                        1173 04877000
         LM    @00,@12,@SA00010+8                                  1173 04878000
         BR    @14                                                 1173 04879000
*            END;                                                  1174 04880000
*                                                                  1174 04881000
*        CALL IDCSATI0 (GDTTBL,TIMEODAY,TIMEDATE,FORMAT);          1175 04882000
*                                                                  1175 04883000
*                                                                  1175 04884000
@RF01169 L     @05,@PC00001                                        1175 04885000
         ST    @05,@AL00001                                        1175 04886000
         LA    @15,8                                               1175 04887000
         AL    @15,CONRCPTR                                        1175 04888000
         LA    @14,TIMEODAY(,@15)                                  1175 04889000
         ST    @14,@AL00001+4                                      1175 04890000
         LA    @15,TIMEDATE(,@15)                                  1175 04891000
         ST    @15,@AL00001+8                                      1175 04892000
         LA    @15,FORMAT                                          1175 04893000
         ST    @15,@AL00001+12                                     1175 04894000
         MVI   @AL00001+12,X'80'                                   1175 04895000
         L     @15,GDTTIM(,@05)                                    1175 04896000
         LA    @01,@AL00001                                        1175 04897000
         BALR  @14,@15                                             1175 04898000
*        HEADLN = LENGTH(HEADER) + LENGTH(TIMESTMP);               1176 04899000
         L     @05,CONRCPTR                                        1176 04900000
         MVC   HEADLN(2,@05),@CH01286                              1176 04901000
*        HEADFLG1 = HDFL1CAT;                                      1177 04902000
         MVI   HEADFLG1(@05),X'FF'                                 1177 04903000
*        HEADFLG2 = HDFL2TSP;                                      1178 04904000
*                                                                  1178 04905000
         MVI   HEADFLG2(@05),X'FF'                                 1178 04906000
*        IF OBJTYP = CTGTUCAT                                      1179 04907000
*          THEN                                                    1179 04908000
         L     @15,@PC00001+4                                      1179 04909000
         L     @01,INPPTR(,@15)                                    1179 04910000
         L     @01,INPTBL(,@01)                                    1179 04911000
         CLI   OBJTYP(@01),C'U'                                    1179 04912000
         BNE   @RF01179                                            1179 04913000
*            TEXUCT = ON;                                          1180 04914000
         OI    TEXUCT+8(@05),B'00000001'                           1180 04915000
*          ELSE                                                    1181 04916000
*            TEXNVS = ON;                                          1181 04917000
         B     @RC01179                                            1181 04918000
@RF01179 L     @05,CONRCPTR                                        1181 04919000
         OI    TEXNVS+8(@05),B'00000100'                           1181 04920000
*        TEXRCVY = ON;                                             1182 04921000
@RC01179 L     @05,CONRCPTR                                        1182 04922000
         LA    @15,8                                               1182 04923000
         ALR   @15,@05                                             1182 04924000
         OI    TEXRCVY(@15),B'00001000'                            1182 04925000
*        TEXOJCT = NUMASSOC + 1;                                   1183 04926000
         LA    @14,1                                               1183 04927000
         AH    @14,NUMASSOC                                        1183 04928000
         STC   @14,TEXOJCT(,@15)                                   1183 04929000
*        TEXFLG2 = EXPTYPE1;                                       1184 04930000
*                                                                  1184 04931000
         MVC   TEXFLG2(1,@15),EXPTYPE1                             1184 04932000
*        SAVLEN = HEADLN;                                          1185 04933000
*                                                                  1185 04934000
*                                                                  1185 04935000
         LH    @05,HEADLN(,@05)                                    1185 04936000
         STH   @05,SAVLEN                                          1185 04937000
*        /************************************************************/ 04938000
*        /*                                                          */ 04939000
*        /*  WRITE THE TIME STAMP RECORD TO PORTABILITY DATA SET.    */ 04940000
*        /*                                                          */ 04941000
*        /************************************************************/ 04942000
*                                                                  1186 04943000
*        CALL  SAVEPROC(SAVLEN,CONRCPTR,'H');                      1186 04944000
*                                                                  1186 04945000
         LA    @05,SAVLEN                                          1186 04946000
         ST    @05,@AL00001                                        1186 04947000
         LA    @05,CONRCPTR                                        1186 04948000
         ST    @05,@AL00001+4                                      1186 04949000
         LA    @05,@CC01070                                        1186 04950000
         ST    @05,@AL00001+8                                      1186 04951000
         LA    @01,@AL00001                                        1186 04952000
         BAL   @14,SAVEPROC                                        1186 04953000
*        RESPECIFY RTNREG RSTD;                                    1187 04954000
*        TESTRC = RTNREG;                                          1188 04955000
         LR    TESTRC,RTNREG                                       1188 04956000
*        RESPECIFY RTNREG UNRSTD;                                  1189 04957000
*        IF TESTRC ^= 0                                            1190 04958000
*          THEN                                                    1190 04959000
         LTR   TESTRC,TESTRC                                       1190 04960000
         BZ    @RF01190                                            1190 04961000
*            RETURN CODE(LASTCC16);                                1191 04962000
         LA    @15,16                                              1191 04963000
         L     @14,@SA00010                                        1191 04964000
         LM    @00,@12,@SA00010+8                                  1191 04965000
         BR    @14                                                 1191 04966000
*                                                                  1192 04967000
*        /************************************************************/ 04968000
*        /*                                                          */ 04969000
*        /*  BUILD AND WRITE THE CONTROL RECORD FOR THIS OBJECT      */ 04970000
*        /*                                                          */ 04971000
*        /************************************************************/ 04972000
*                                                                  1192 04973000
*        INDXCPL = NVMCPLNO ;           /*INDEX TO CPL FOR CONTRBL   */ 04974000
*                                                                  1192 04975000
@RF01190 MVC   INDXCPL(4),@CF00152                                 1192 04976000
*        /************************************************************/ 04977000
*        /*                                                          */ 04978000
*        /*  IF WE ARE PROCESSING AN AIX CONTROL RECORD,             */ 04979000
*        /*  CALL CONTRBL WITH TYPE 'G' SPECIFIED.                   */ 04980000
*        /*  OTHERWISE, CALL CONTRBL WITH TYPE 'N' AS AN             */ 04981000
*        /*  ARGUMENT.  ('N' STANDS FOR NEUTRAL--A TYPE              */ 04982000
*        /*  OTHER THAN PATH OR AIX.)  CONTRBL ACTUALLY              */ 04983000
*        /*  BUILDS THE CONTROL RECORD TO BE WRITTEN TO              */ 04984000
*        /*  THE PORTABILITY DATA SET.                               */ 04985000
*        /*                                                          */ 04986000
*        /************************************************************/ 04987000
*                                                                  1193 04988000
*        CALL CONTRBL(INDXCPL,'N');                                1193 04989000
*                                                                  1193 04990000
         LA    @05,INDXCPL                                         1193 04991000
         ST    @05,@AL00001                                        1193 04992000
         LA    @05,@CC01072                                        1193 04993000
         ST    @05,@AL00001+4                                      1193 04994000
         LA    @01,@AL00001                                        1193 04995000
         BAL   @14,CONTRBL                                         1193 04996000
*        RESPECIFY RTNREG RSTD;                                    1194 04997000
*        TESTRC = RTNREG;                                          1195 04998000
         LR    TESTRC,RTNREG                                       1195 04999000
*        RESPECIFY RTNREG UNRSTD;                                  1196 05000000
*                                                                  1196 05001000
*        IF TESTRC ^= 0                                            1197 05002000
*          THEN                                                    1197 05003000
         LTR   TESTRC,TESTRC                                       1197 05004000
         BZ    @RF01197                                            1197 05005000
*            IF TESTRC = LASTCC16                                  1198 05006000
*              THEN                                                1198 05007000
         LA    @03,16                                              1198 05008000
         CR    TESTRC,@03                                          1198 05009000
         BNE   @RF01198                                            1198 05010000
*                RETURN CODE(LASTCC16);                            1199 05011000
         LR    @15,@03                                             1199 05012000
         L     @14,@SA00010                                        1199 05013000
         LM    @00,@12,@SA00010+8                                  1199 05014000
         BR    @14                                                 1199 05015000
*              ELSE                                                1200 05016000
*                RETURN CODE(LASTCC08);                            1200 05017000
@RF01198 LA    @15,8                                               1200 05018000
         L     @14,@SA00010                                        1200 05019000
         LM    @00,@12,@SA00010+8                                  1200 05020000
         BR    @14                                                 1200 05021000
*          ELSE;                                                   1201 05022000
*                                                                  1201 05023000
@RF01197 DS    0H                                                  1202 05024000
*        /************************************************************/ 05025000
*        /*                                                          */ 05026000
*        /*  TEST TO DETERMINE IF THERE ARE ALIAS'S                  */ 05027000
*        /*  ASSOCIATIONS PRESENT.  IF SO LOOP, DOING                */ 05028000
*        /*  LOCATES FOR THE ALIAS'S, AND WRITING OUT THE            */ 05029000
*        /*  CATALOG INFORMATION TO THE PORTABILITY                  */ 05030000
*        /*  DATA SET.                                               */ 05031000
*        /*                                                          */ 05032000
*        /************************************************************/ 05033000
*        IF NVSMALS = ON                                           1202 05034000
*          THEN                                                    1202 05035000
         TM    NVSMALS,B'00000010'                                 1202 05036000
         BNO   @RF01202                                            1202 05037000
*ALSDEF:     DO;                                                   1203 05038000
*                                                                  1203 05039000
ALSDEF   DS    0H                                                  1204 05040000
*            /********************************************************/ 05041000
*            /*                                                      */ 05042000
*            /*  CALL ALSPROC TO PROCESS THE ASSOCIATED ALIAS'S      */ 05043000
*            /*                                                      */ 05044000
*            /********************************************************/ 05045000
*                                                                  1204 05046000
*                                                                  1204 05047000
*            CALL  ALSPROC(FNMPTR);                                1204 05048000
*                                                                  1204 05049000
         LA    @05,FNMPTR                                          1204 05050000
         ST    @05,@AL00001                                        1204 05051000
         LA    @01,@AL00001                                        1204 05052000
         BAL   @14,ALSPROC                                         1204 05053000
*            /********************************************************/ 05054000
*            /*                                                      */ 05055000
*            /*  TEST RETURN FROM ALSPROC, IF RETURN CODE OF 16 THEN */ 05056000
*            /*  TERMINATE THIS REQUEST -- NO CORE AVAILABLE         */ 05057000
*            /*                                                      */ 05058000
*            /********************************************************/ 05059000
*                                                                  1205 05060000
*                                                                  1205 05061000
*            RESPECIFY RTNREG RSTD;                                1205 05062000
*            TESTRC = RTNREG;                                      1206 05063000
         LR    TESTRC,RTNREG                                       1206 05064000
*            RESPECIFY RTNREG UNRSTD;                              1207 05065000
*                                                                  1207 05066000
*            IF TESTRC = LASTCC16                                  1208 05067000
*              THEN                                                1208 05068000
         LA    @03,16                                              1208 05069000
         CR    TESTRC,@03                                          1208 05070000
         BNE   @RF01208                                            1208 05071000
*                RETURN CODE(LASTCC16);                            1209 05072000
*                                                                  1209 05073000
*                                                                  1209 05074000
         LR    @15,@03                                             1209 05075000
         L     @14,@SA00010                                        1209 05076000
         LM    @00,@12,@SA00010+8                                  1209 05077000
         BR    @14                                                 1209 05078000
*            END ALSDEF;                                           1210 05079000
*                                                                  1210 05080000
*          ELSE  ;                                                 1211 05081000
*                                                                  1211 05082000
*                                                                  1211 05083000
@RF01202 DS    0H                                                  1212 05084000
*        /************************************************************/ 05085000
*        /*                                                          */ 05086000
*        /*CALL SAVEPROC TO WRITE THE CONTROL AND CATALOG RECORDS    */ 05087000
*        /*FOR THIS NON VSAM DATA SET TO THE PORTABILITY DATA SET    */ 05088000
*        /*                                                          */ 05089000
*        /************************************************************/ 05090000
*                                                                  1212 05091000
*        CALL  SAVEPROC(NULLPARM,NULLPARM,'W');                    1212 05092000
*                                                                  1212 05093000
*                                                                  1212 05094000
@RC01202 LA    @01,@AL01212                                        1212 05095000
         BAL   @14,SAVEPROC                                        1212 05096000
*        /************************************************************/ 05097000
*        /*                                                          */ 05098000
*        /* CHECK FOR SUCCESSFUL PROCESSING AND WRITE SOFTWARE END OF*/ 05099000
*        /* FILE ON THE PORTABILITY DATA SET.                        */ 05100000
*        /* IF PROCESSING FOR ALIAS'S INCOMPLETE THEN A FLAG HAS     */ 05101000
*        /* BEEN SET AND A WARNING MESSAGE PRINTED.                  */ 05102000
*        /*                                                          */ 05103000
*        /************************************************************/ 05104000
*                                                                  1213 05105000
*        RESPECIFY RTNREG RSTD;                                    1213 05106000
*        TESTRC = RTNREG;                                          1214 05107000
         LR    TESTRC,RTNREG                                       1214 05108000
*        RESPECIFY RTNREG UNRSTD;                                  1215 05109000
*        IF TESTRC ^= 0                                            1216 05110000
*          THEN                                                    1216 05111000
         LTR   TESTRC,TESTRC                                       1216 05112000
         BZ    @RF01216                                            1216 05113000
*            RETURN CODE(LASTCC16);                                1217 05114000
*                                                                  1217 05115000
         LA    @15,16                                              1217 05116000
         L     @14,@SA00010                                        1217 05117000
         LM    @00,@12,@SA00010+8                                  1217 05118000
         BR    @14                                                 1217 05119000
*        CALL  PUTPROC(NULLPARM,NULLPARM);                         1218 05120000
*                                                                  1218 05121000
@RF01216 LA    @01,@AL01218                                        1218 05122000
         BAL   @14,PUTPROC                                         1218 05123000
*        RESPECIFY RTNREG RSTD;                                    1219 05124000
*        TESTRC = RTNREG;                                          1220 05125000
         LR    TESTRC,RTNREG                                       1220 05126000
*        RESPECIFY RTNREG UNRSTD;                                  1221 05127000
*        IF TESTRC ^= 0                                            1222 05128000
*          THEN                                                    1222 05129000
         LTR   TESTRC,TESTRC                                       1222 05130000
         BZ    @RF01222                                            1222 05131000
*            RETURN CODE(LASTCC16);                                1223 05132000
*                                                                  1223 05133000
         LA    @15,16                                              1223 05134000
         L     @14,@SA00010                                        1223 05135000
         LM    @00,@12,@SA00010+8                                  1223 05136000
         BR    @14                                                 1223 05137000
*        /************************************************************/ 05138000
*        /*                                                          */ 05139000
*        /* RETURN TO CALLER WITH SUCCESS INDICATED                  */ 05140000
*        /*                                                          */ 05141000
*        /************************************************************/ 05142000
*                                                                  1224 05143000
*       RETURN CODE(0);                                            1224 05144000
*                                                                  1224 05145000
@RF01222 SLR   @15,@15                                             1224 05146000
         L     @14,@SA00010                                        1224 05147000
         LM    @00,@12,@SA00010+8                                  1224 05148000
         BR    @14                                                 1224 05149000
*END NVSMPROC;                                                     1225 05150000
*                                                                  1226 05151000
*        /************************************************************/ 05152000
*        /*                                                          */ 05153000
*        /*  PROCEDURE NAME - SAVEPROC                               */ 05154000
*        /*                                                          */ 05155000
*        /*  FUNCTION - THIS PROCEDURE SAVES ALL THE OUTPUT CONTROL  */ 05156000
*        /*             RECORDS FOR EACH OBJECT AND THEN WRITES THEM */ 05157000
*        /*             TO THE PORTABILITY DATA SET WHEN PROCESSING  */ 05158000
*        /*             OF CATALOG INFORMATION HAS BEEN COMPLETED.   */ 05159000
*        /*                                                          */ 05160000
*        /*  INPUT - LENGTH AND ADDRESS OF RECORD TO BE OUTPUTTED    */ 05161000
*        /*                                                          */ 05162000
*        /*  OUTPUT - RECORD WILL BE WRITTEN TO PORTABILITY DATA SET */ 05163000
*        /*                                                          */ 05164000
*        /************************************************************/ 05165000
*                                                                  1226 05166000
*SAVEPROC: PROCEDURE(IRECLEN,          /*LENGTH OF RECORD            */ 05167000
*                    IRECPTR,          /*ADDRESS OF RECORD           */ 05168000
*                    IREQTPE);         /*TYPE OF REQUEST             */ 05169000
*                                                                  1226 05170000
SAVEPROC STM   @14,@12,@SA00011                                    1226 05171000
         MVC   @PC00011(12),0(@01)                                 1226 05172000
*        /************************************************************/ 05173000
*        /*                                                          */ 05174000
*        /*  ARGUMENTS OF INVOCATION                                 */ 05175000
*        /*                                                          */ 05176000
*        /************************************************************/ 05177000
*                                                                  1227 05178000
*        DCL IRECLEN FIXED(15),                                    1227 05179000
*            IRECPTR PTR(31),                                      1227 05180000
*            IREQTPE CHAR(1);                                      1227 05181000
*                                                                  1227 05182000
*        /************************************************************/ 05183000
*        /*                                                          */ 05184000
*        /*  LOCAL DECLARATIONS                                      */ 05185000
*        /*                                                          */ 05186000
*        /************************************************************/ 05187000
*                                                                  1228 05188000
*        DCL REQLEN   FIXED(31);       /*LENGTH OF CORE REQUIRED     */ 05189000
*        DCL STRTCHN  FIXED(31);       /*START OF OUTPUT BUFFER CHAIN*/ 05190000
*        DCL REQPTR   PTR(31);         /*RETURN AREA FROM UGPOOL     */ 05191000
*        DCL CURPTR   PTR(31);         /*CURRENT OUTPUT BUFFER CHAIN */ 05192000
*        /*  POINTERS TO SAVE AREA WHERE RECORDS ARE HELD            */ 05193000
*        DCL 1  BUFCHN  BDY(WORD)  BASED(CURPTR), /*                 */ 05194000
*                                      /*BUFFER CHAIN FOR SAVE AREA  */ 05195000
*             2  BHRECLEN  FIXED(31),  /*LENGTH OF RECORD TO OUTPUT  */ 05196000
*                3 *       FIXED(15) , /* FULLWORD NEED FOR PUTPROC  */ 05197000
*                3 BRECLEN FIXED(15),  /* LENGTH SAVED               */ 05198000
*             2  BRECPTR  PTR(31),     /*AREA WHERE RECORD SAVED     */ 05199000
*             2  BNXTCHN  FIXED(31);   /*NEXT RECORD AREA            */ 05200000
*                                                                  1232 05201000
*        DCL DOWRITE BIT(1);           /* WRITE OUTPUT CONTROL       */ 05202000
*                                                                  1233 05203000
*                                                                  1233 05204000
*        OLDERID2 = NEWERID2;                                      1234 05205000
         L     @15,@PC00001                                        1234 05206000
         L     @14,GDTTR2(,@15)                                    1234 05207000
         MVC   @TS00001(95),NEWERID2(@14)                          1234 05208000
         MVC   OLDERID2(95,@14),@TS00001                           1234 05209000
*        NEWID2 = 'RC31';                                          1235 05210000
         MVC   NEWID2(4,@14),@CC01211                              1235 05211000
*        IF GDTDBG = NULLPTR                                       1236 05212000
*          THEN;                                                   1236 05213000
         L     @15,GDTDBG(,@15)                                    1236 05214000
         LTR   @15,@15                                             1236 05215000
         BZ    @RT01236                                            1236 05216000
*          ELSE                                                    1238 05217000
*            CALL IDCDB010 (GDTTBL,'RC32');                        1238 05218000
*                                                                  1238 05219000
*                                                                  1238 05220000
         L     @15,@PC00001                                        1238 05221000
         ST    @15,@AL00001                                        1238 05222000
         LA    @14,@CC01212                                        1238 05223000
         ST    @14,@AL00001+4                                      1238 05224000
         MVI   @AL00001+4,X'80'                                    1238 05225000
         L     @15,GDTDBG(,@15)                                    1238 05226000
         LA    @01,@AL00001                                        1238 05227000
         BALR  @14,@15                                             1238 05228000
*        /************************************************************/ 05229000
*        /*                                                          */ 05230000
*        /*  CHECK TYPE OF REQUEST, IF SAVE REQUEST THEN GET CORE AND*/ 05231000
*        /*  MOVE THE INPUT RECORD INTO IT, IF WRITE REQUEST THEN    */ 05232000
*        /*  WRITE ALL THE SAVED RECORDS TO THE PORTABILITY DATA SET.*/ 05233000
*        /*                                                          */ 05234000
*        /************************************************************/ 05235000
*        IF IREQTPE = 'H'                                          1239 05236000
*          THEN                                                    1239 05237000
@RT01236 L     @15,@PC00011+8                                      1239 05238000
         CLI   IREQTPE(@15),C'H'                                   1239 05239000
         BNE   @RF01239                                            1239 05240000
*SAVR:       DO;                                                   1240 05241000
SAVR     DS    0H                                                  1241 05242000
*            IF FRSTSAV = OFF                                      1241 05243000
*              THEN                                                1241 05244000
         TM    FRSTSAV,B'01000000'                                 1241 05245000
         BNZ   @RF01241                                            1241 05246000
*                DO;                                               1242 05247000
*                /****************************************************/ 05248000
*                /*                                                  */ 05249000
*                /* GET CORE AND SAVE POINTER TO START OF CHAIN      */ 05250000
*                /* IF REQUEST FAILS RETURN WITH TERMINATION CODE.   */ 05251000
*                /*                                                  */ 05252000
*                /****************************************************/ 05253000
*                                                                  1243 05254000
*                CALL IDCSAGP0 (GDTTBL,LENGTH(BUFCHN),REQPTR,GPID, 1243 05255000
*                  SETZERO);                                       1243 05256000
*                                                                  1243 05257000
         MVC   @AL00001+4(16),@AL01243                             1243 05258000
         L     @03,@PC00001                                        1243 05259000
         ST    @03,@AL00001                                        1243 05260000
         LA    @15,REQPTR                                          1243 05261000
         ST    @15,@AL00001+8                                      1243 05262000
         L     @15,GDTGPL(,@03)                                    1243 05263000
         LA    @01,@AL00001                                        1243 05264000
         BALR  @14,@15                                             1243 05265000
*                RESPECIFY RTNREG RSTD;                            1244 05266000
*                TESTRC = RTNREG;                                  1245 05267000
         LR    TESTRC,RTNREG                                       1245 05268000
*                RESPECIFY RTNREG UNRSTD;                          1246 05269000
*                IF TESTRC ^= 0                                    1247 05270000
*                  THEN                                            1247 05271000
         LTR   TESTRC,TESTRC                                       1247 05272000
         BZ    @RF01247                                            1247 05273000
*                    DO;                                           1248 05274000
*                    DARGSMOD = UNIVMSG;                           1249 05275000
         L     @15,DDSTRU                                          1249 05276000
         MVC   DARGSMOD(3,@15),@CC00847                            1249 05277000
*                    DARGSENT = NOSTORAG;                          1250 05278000
         MVI   DARGSENT(@15),X'04'                                 1250 05279000
*                    RETURN  CODE(LASTCC16);                       1251 05280000
         LA    @15,16                                              1251 05281000
         L     @14,@SA00011                                        1251 05282000
         LM    @00,@12,@SA00011+8                                  1251 05283000
         BR    @14                                                 1251 05284000
*                    END;                                          1252 05285000
*                                                                  1252 05286000
*                /****************************************************/ 05287000
*                /*                                                  */ 05288000
*                /* SAVE POINTER TO START OF OUTPUT BUFFER CHAIN     */ 05289000
*                /*                                                  */ 05290000
*                /****************************************************/ 05291000
*                STRTCHN = REQPTR;     /* START OF BUFFER CHAIN      */ 05292000
@RF01247 L     @15,REQPTR                                          1253 05293000
         ST    @15,STRTCHN                                         1253 05294000
*                CURPTR = REQPTR;      /* POINTER TO CURRENT CHAIN   */ 05295000
         ST    @15,CURPTR                                          1254 05296000
*                FRSTSAV = ON;         /* SAVE POINTER TO START OF   */ 05297000
         OI    FRSTSAV,B'01000000'                                 1255 05298000
*                                      /* CHAIN FIRST TIME ONLY.     */ 05299000
*                END;                                              1256 05300000
*                                                                  1256 05301000
*              ELSE                                                1257 05302000
*                /****************************************************/ 05303000
*                /*                                                  */ 05304000
*                /* NOT FIRST REQUEST GET ANOTHER AREA OF CORE AND   */ 05305000
*                /* CHAIN PREVIOUS AREA TO IT.                       */ 05306000
*                /*                                                  */ 05307000
*                /****************************************************/ 05308000
*                DO;                                               1257 05309000
*                                                                  1257 05310000
         B     @RC01241                                            1257 05311000
@RF01241 DS    0H                                                  1258 05312000
*                CALL IDCSAGP0 (GDTTBL,LENGTH(BUFCHN),REQPTR,GPID, 1258 05313000
*                  SETZERO);                                       1258 05314000
*                                                                  1258 05315000
*                                                                  1258 05316000
*                                                                  1258 05317000
         MVC   @AL00001+4(16),@AL01258                             1258 05318000
         L     @03,@PC00001                                        1258 05319000
         ST    @03,@AL00001                                        1258 05320000
         LA    @15,REQPTR                                          1258 05321000
         ST    @15,@AL00001+8                                      1258 05322000
         L     @15,GDTGPL(,@03)                                    1258 05323000
         LA    @01,@AL00001                                        1258 05324000
         BALR  @14,@15                                             1258 05325000
*                RESPECIFY RTNREG RSTD;                            1259 05326000
*                TESTRC = RTNREG;                                  1260 05327000
         LR    TESTRC,RTNREG                                       1260 05328000
*                RESPECIFY RTNREG UNRSTD;                          1261 05329000
*                IF TESTRC ^= 0                                    1262 05330000
*                  THEN                                            1262 05331000
         LTR   TESTRC,TESTRC                                       1262 05332000
         BZ    @RF01262                                            1262 05333000
*                    DO;                                           1263 05334000
*                    DARGSMOD = UNIVMSG;                           1264 05335000
         L     @15,DDSTRU                                          1264 05336000
         MVC   DARGSMOD(3,@15),@CC00847                            1264 05337000
*                    DARGSENT = NOSTORAG;                          1265 05338000
         MVI   DARGSENT(@15),X'04'                                 1265 05339000
*                    RETURN  CODE(LASTCC16);                       1266 05340000
         LA    @15,16                                              1266 05341000
         L     @14,@SA00011                                        1266 05342000
         LM    @00,@12,@SA00011+8                                  1266 05343000
         BR    @14                                                 1266 05344000
*                    END;                                          1267 05345000
*                                                                  1267 05346000
*                                                                  1267 05347000
*                /****************************************************/ 05348000
*                /*                                                  */ 05349000
*                /* SAVE POINTERS TO PREVIOUS AND NEW CHAINS         */ 05350000
*                /*                                                  */ 05351000
*                /****************************************************/ 05352000
*                                                                  1268 05353000
*                BNXTCHN = REQPTR;     /* POINTER TO NEXT CHAIN      */ 05354000
@RF01262 L     @15,REQPTR                                          1268 05355000
         L     @14,CURPTR                                          1268 05356000
         ST    @15,BNXTCHN(,@14)                                   1268 05357000
*                CURPTR = REQPTR;      /* POINTER TO CURRENT CHAIN   */ 05358000
*                                                                  1269 05359000
         ST    @15,CURPTR                                          1269 05360000
*                END;                                              1270 05361000
*                                                                  1270 05362000
*            /********************************************************/ 05363000
*            /*                                                      */ 05364000
*            /* GET AN AREA OF CORE AND MOVE THE INPUT RECORD INTO IT*/ 05365000
*            /*  IF REQUEST FAILS TERMINATE                          */ 05366000
*            /*                                                      */ 05367000
*            /********************************************************/ 05368000
*                                                                  1271 05369000
*            REQLEN = IRECLEN;       /* LENGTH IN FULLWORD FOR UGPOOL*/ 05370000
*                                                                  1271 05371000
@RC01241 L     @03,@PC00011                                        1271 05372000
         LH    @03,IRECLEN(,@03)                                   1271 05373000
         ST    @03,REQLEN                                          1271 05374000
*            CALL IDCSAGP0  (GDTTBL,REQLEN,REQPTR,GPID,SETZERO);   1272 05375000
*                                                                  1272 05376000
         L     @03,@PC00001                                        1272 05377000
         ST    @03,@AL00001                                        1272 05378000
         LA    @15,REQLEN                                          1272 05379000
         ST    @15,@AL00001+4                                      1272 05380000
         LA    @15,REQPTR                                          1272 05381000
         ST    @15,@AL00001+8                                      1272 05382000
         LA    @15,GPID                                            1272 05383000
         ST    @15,@AL00001+12                                     1272 05384000
         LA    @15,SETZERO                                         1272 05385000
         ST    @15,@AL00001+16                                     1272 05386000
         MVI   @AL00001+16,X'80'                                   1272 05387000
         L     @15,GDTGPL(,@03)                                    1272 05388000
         LA    @01,@AL00001                                        1272 05389000
         BALR  @14,@15                                             1272 05390000
*            RESPECIFY RTNREG RSTD;                                1273 05391000
*            TESTRC = RTNREG;                                      1274 05392000
         LR    TESTRC,RTNREG                                       1274 05393000
*            RESPECIFY RTNREG UNRSTD;                              1275 05394000
*            IF TESTRC ^= 0                                        1276 05395000
*              THEN                                                1276 05396000
         LTR   TESTRC,TESTRC                                       1276 05397000
         BZ    @RF01276                                            1276 05398000
*                DO;                                               1277 05399000
*                DARGSMOD = UNIVMSG;                               1278 05400000
         L     @15,DDSTRU                                          1278 05401000
         MVC   DARGSMOD(3,@15),@CC00847                            1278 05402000
*                DARGSENT = NOSTORAG;                              1279 05403000
         MVI   DARGSENT(@15),X'04'                                 1279 05404000
*                RETURN  CODE(LASTCC16);                           1280 05405000
         LA    @15,16                                              1280 05406000
         L     @14,@SA00011                                        1280 05407000
         LM    @00,@12,@SA00011+8                                  1280 05408000
         BR    @14                                                 1280 05409000
*                END;                                              1281 05410000
*                                                                  1281 05411000
*                                                                  1281 05412000
*                                                                  1281 05413000
*                                                                  1281 05414000
*            /********************************************************/ 05415000
*            /*                                                      */ 05416000
*            /* MOVE THE INPUT RECORD TO THE SAVE AREA               */ 05417000
*            /*                                                      */ 05418000
*            /********************************************************/ 05419000
*                                                                  1282 05420000
*            CALL  MVDAPROC  (IRECLEN,IRECPTR,REQPTR,NULLPARM);    1282 05421000
*                                                                  1282 05422000
*                                                                  1282 05423000
@RF01276 L     @15,@PC00011                                        1282 05424000
         ST    @15,@AL00001                                        1282 05425000
         L     @15,@PC00011+4                                      1282 05426000
         ST    @15,@AL00001+4                                      1282 05427000
         LA    @15,REQPTR                                          1282 05428000
         ST    @15,@AL00001+8                                      1282 05429000
         LA    @15,NULLPARM                                        1282 05430000
         ST    @15,@AL00001+12                                     1282 05431000
         LA    @01,@AL00001                                        1282 05432000
         BAL   @14,MVDAPROC                                        1282 05433000
*            /********************************************************/ 05434000
*            /*                                                      */ 05435000
*            /* SAVE THE INPUT RECORD LENGTH AND LOCATION IN THE     */ 05436000
*            /* BUFFER CHAIN.                                        */ 05437000
*            /*                                                      */ 05438000
*            /********************************************************/ 05439000
*                                                                  1283 05440000
*            BRECPTR = REQPTR;        /* POINTER TO RECORD SAVED     */ 05441000
         L     @15,CURPTR                                          1283 05442000
         L     @14,REQPTR                                          1283 05443000
         ST    @14,BRECPTR(,@15)                                   1283 05444000
*            BRECLEN = IRECLEN;       /* LENGTH OF RECORD SAVED      */ 05445000
*                                                                  1284 05446000
         L     @14,@PC00011                                        1284 05447000
         LH    @14,IRECLEN(,@14)                                   1284 05448000
         STH   @14,BRECLEN(,@15)                                   1284 05449000
*            END   SAVR;              /* END OF LOOP TO SAVE RECORDS */ 05450000
*                                                                  1285 05451000
*          ELSE                                                    1286 05452000
*WRITR:      DO;                                                   1286 05453000
         B     @RC01239                                            1286 05454000
@RF01239 DS    0H                                                  1286 05455000
WRITR    DS    0H                                                  1287 05456000
*            /********************************************************/ 05457000
*            /*                                                      */ 05458000
*            /*  WRITE THE SAVED CONTROL RECORDS TO THE PORTABILITY  */ 05459000
*            /*   DATA SET.                                          */ 05460000
*            /*   CALL PUTPROC TO DO THE ACTUALL WRITING, IF ERROR   */ 05461000
*            /*   OCCURS RETURN WITH TERMINATION CODE.               */ 05462000
*            /*                                                      */ 05463000
*            /********************************************************/ 05464000
*                                                                  1287 05465000
*            CURPTR = STRTCHN;         /* START OF BUFFER CHAIN      */ 05466000
         L     @15,STRTCHN                                         1287 05467000
         ST    @15,CURPTR                                          1287 05468000
*            DOWRITE = ON;             /* SET WRITE LOOP ON          */ 05469000
         OI    DOWRITE,B'10000000'                                 1288 05470000
*WRITL:      DO WHILE (DOWRITE = ON);  /* START WRITE LOOP           */ 05471000
*                                                                  1289 05472000
WRITL    B     @DE01289                                            1289 05473000
@DL01289 DS    0H                                                  1290 05474000
*            CALL  PUTPROC (BHRECLEN,BRECPTR);                     1290 05475000
*                                                                  1290 05476000
         L     @15,CURPTR                                          1290 05477000
         ST    @15,@AL00001                                        1290 05478000
         LA    @15,BRECPTR(,@15)                                   1290 05479000
         ST    @15,@AL00001+4                                      1290 05480000
         LA    @01,@AL00001                                        1290 05481000
         BAL   @14,PUTPROC                                         1290 05482000
*            RESPECIFY RTNREG RSTD;                                1291 05483000
*            TESTRC = RTNREG;                                      1292 05484000
         LR    TESTRC,RTNREG                                       1292 05485000
*            RESPECIFY RTNREG UNRSTD;                              1293 05486000
*            IF TESTRC ^= 0                                        1294 05487000
*              THEN                                                1294 05488000
         LTR   TESTRC,TESTRC                                       1294 05489000
         BZ    @RF01294                                            1294 05490000
*                RETURN CODE(LASTCC16);                            1295 05491000
*                                                                  1295 05492000
         LA    @15,16                                              1295 05493000
         L     @14,@SA00011                                        1295 05494000
         LM    @00,@12,@SA00011+8                                  1295 05495000
         BR    @14                                                 1295 05496000
*            /********************************************************/ 05497000
*            /*                                                      */ 05498000
*            /* CHECK FOR LAST RECORD , IF END TURN LOOP OFF, ELSE   */ 05499000
*            /* SET POINTER TO NEXT RECORD.                          */ 05500000
*            /*                                                      */ 05501000
*            /********************************************************/ 05502000
*                                                                  1296 05503000
*            IF BNXTCHN = NULLPTR                                  1296 05504000
*              THEN                                                1296 05505000
@RF01294 L     @01,CURPTR                                          1296 05506000
         L     @15,BNXTCHN(,@01)                                   1296 05507000
         LTR   @15,@15                                             1296 05508000
         BNZ   @RF01296                                            1296 05509000
*                DOWRITE = OFF;                                    1297 05510000
         NI    DOWRITE,B'01111111'                                 1297 05511000
*              ELSE                                                1298 05512000
*                CURPTR = BNXTCHN;                                 1298 05513000
*                                                                  1298 05514000
         B     @RC01296                                            1298 05515000
@RF01296 L     @01,CURPTR                                          1298 05516000
         L     @15,BNXTCHN(,@01)                                   1298 05517000
         ST    @15,CURPTR                                          1298 05518000
*            END   WRITL;              /* END WRITE LOOP             */ 05519000
@RC01296 DS    0H                                                  1299 05520000
@DE01289 TM    DOWRITE,B'10000000'                                 1299 05521000
         BO    @DL01289                                            1299 05522000
*            END   WRITR;              /* END WRITE PROCEDURE        */ 05523000
*                                                                  1300 05524000
*        /************************************************************/ 05525000
*        /*                                                          */ 05526000
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */ 05527000
*        /*                                                          */ 05528000
*        /************************************************************/ 05529000
*                                                                  1301 05530000
*        RETURN CODE(0);                                           1301 05531000
*                                                                  1301 05532000
@RC01239 SLR   @15,@15                                             1301 05533000
         L     @14,@SA00011                                        1301 05534000
         LM    @00,@12,@SA00011+8                                  1301 05535000
         BR    @14                                                 1301 05536000
*END SAVEPROC;                         /* END OF WRITE AND SAVE PROC */ 05537000
*                                                                  1302 05538000
*        /************************************************************/ 05539000
*        /*                                                          */ 05540000
*        /*  PROCEDURE NAME -  ALSPROC                               */ 05541000
*        /*                                                          */ 05542000
*        /*  FUNCTION - OBTAINS CATALOG INFORMATION FOR ALIAS        */ 05543000
*        /*   ASSOCIATIONS OF NON VSAM DATA SETS.                    */ 05544000
*        /*   BUILDS CONTROL AND DATA RECORDS FOR THE ASSOCIATIONS   */ 05545000
*        /*   WRITES THEM TO THE PORTABILITY DATA SET.               */ 05546000
*        /*                                                          */ 05547000
*        /* INPUT - POINTER TO THE NAMEDS FPL FOR THE NON VSAM DATA  */ 05548000
*        /*         SET.                                             */ 05549000
*        /*                                                          */ 05550000
*        /* OUTPUT - CONTROL AND CATALOG INFORMATION RECORDS WRITTEN */ 05551000
*        /*           TO THE PORTABILITY DATA SET.                   */ 05552000
*        /*                                                          */ 05553000
*        /************************************************************/ 05554000
*                                                                  1303 05555000
*ALSPROC: PROCEDURE(ALSNMPTR);         /* NAMEDS FIELD POINTER       */ 05556000
*                                                                  1303 05557000
*                                                                  1303 05558000
ALSPROC  STM   @14,@03,@SA00012                                    1303 05559000
         STM   @05,@12,@SA00012+24                                 1303 05560000
         MVC   @PC00012(4),0(@01)                                  1303 05561000
*        /************************************************************/ 05562000
*        /*                                                          */ 05563000
*        /*  ARGUMENTS OF INVOCATION                                 */ 05564000
*        /*                                                          */ 05565000
*        /************************************************************/ 05566000
*                                                                  1304 05567000
*        DCL  ALSNMPTR  PTR(31);       /* FPL POINTER TO NAMEDS FIELD*/ 05568000
*                                      /* FOR NON VSAM LOCATES       */ 05569000
*                                                                  1305 05570000
*        DCL 1 NMDSPTR CHAR(4) BDY(WORD)  BASED(ALSNMPTR), /*        */ 05571000
*                                      /*  NAMEDS STRUCTURE          */ 05572000
*              2  NMDSTYPE  CHAR(1),   /* ENTRY TYPE                 */ 05573000
*              2  NMDSNAME  CHAR(3);   /* ENTRY NAME                 */ 05574000
*                                                                  1305 05575000
*        /************************************************************/ 05576000
*        /*                                                          */ 05577000
*        /*             DECLARATIONS                                 */ 05578000
*        /*                                                          */ 05579000
*        /************************************************************/ 05580000
*                                                                  1306 05581000
*        DCL  NALSMPTR  PTR(31);       /* FPL POINTER TO NAMEDS FIELD*/ 05582000
*                                      /* FOR ALIAS LOCATES          */ 05583000
*                                                                  1307 05584000
*        DCL 1 ALSCHN CHAR(12) BDY(WORD)  BASED(NALSMPTR),         1307 05585000
*                                      /*  NAMEDS STRUCTURE ALIAS'S  */ 05586000
*              2  GDSASOC  CHAR(4),    /* NON VSAM ASSOCIATION       */ 05587000
*                                                                  1307 05588000
*              2  NXTALIS  CHAR(4),    /*NEXT ALIAS IN CHAIN         */ 05589000
*                 3  NXTTPE  CHAR(1),  /*ALIAS TYPE ID               */ 05590000
*                 3  NXTNAM  CHAR(3),  /*NEXT ALIAS IN CHAIN         */ 05591000
*                                                                  1307 05592000
*              2  PREVALS  CHAR(4);    /* PREVIOUS ALIAS             */ 05593000
*                                                                  1307 05594000
*        DCL  NXTCHN  FIXED(24);       /*NEXT ALIAS ASSOCIATION      */ 05595000
*                                                                  1308 05596000
*        DCL  DOALIS  BIT(1);         /* DO LOOP FOR ALIAS PROCESSING*/ 05597000
*                                                          /*@OZ10598*/ 05598000
*        DCL 1 CPLFPLEN,                                   /*@OZ10598*/ 05599000
*              2 *    FIXED(15),                           /*@OZ10598*/ 05600000
*              2 ALSCPLEN FIXED(15);                       /*@OZ10598*/ 05601000
*                                                                  1310 05602000
*        /************************************************************/ 05603000
*        /*                                                          */ 05604000
*        /*  LOOP THROUGH THE ALIAS'S DOING                          */ 05605000
*        /*  LOCATES AND WRITING CATALOG INFORMATION TO THE          */ 05606000
*        /*  PORTABILITY DATA SET.                                   */ 05607000
*        /*                                                          */ 05608000
*        /************************************************************/ 05609000
*                                                                  1311 05610000
*        OLDERID2 = NEWERID2;                                      1311 05611000
         L     @05,@PC00001                                        1311 05612000
         L     @05,GDTTR2(,@05)                                    1311 05613000
         MVC   @TS00001(95),NEWERID2(@05)                          1311 05614000
         MVC   OLDERID2(95,@05),@TS00001                           1311 05615000
*        NEWID2 = 'RC33';                                          1312 05616000
         MVC   NEWID2(4,@05),@CC01239                              1312 05617000
*        DOALIS = OFF;                                             1313 05618000
*                                                                  1313 05619000
         NI    DOALIS,B'01111111'                                  1313 05620000
*        /************************************************************/ 05621000
*        /*                                                          */ 05622000
*        /* INITIALIZE NUMBER OF FIELD LISTS FOR LOCATES             */ 05623000
*        /*                                                          */ 05624000
*        /************************************************************/ 05625000
*                                                                  1314 05626000
*        CNUM = (DIM(ALSFLIST));                                   1314 05627000
         MVI   CNUM,X'03'                                          1314 05628000
*        ONUM = (DIM(ALSFLIST)-1);                                 1315 05629000
*                                                                  1315 05630000
         MVI   ONUM,X'02'                                          1315 05631000
*        /************************************************************/ 05632000
*        /*                                                          */ 05633000
*        /* TEST TO DETERMINE IF THE ASSOCIATED OBJECT IS A GDG      */ 05634000
*        /*                                                          */ 05635000
*        /************************************************************/ 05636000
*        IF NMDSTYPE = 'B'                                         1316 05637000
*          THEN                                                    1316 05638000
*                                                                  1316 05639000
         L     @05,@PC00012                                        1316 05640000
         L     @15,ALSNMPTR(,@05)                                  1316 05641000
         CLI   NMDSTYPE(@15),C'B'                                  1316 05642000
         BNE   @RF01316                                            1316 05643000
*            /********************************************************/ 05644000
*            /*                                                      */ 05645000
*            /* SET POINTER TO NEXT NON VSAM IN NAMEDS AREA          */ 05646000
*            /*                                                      */ 05647000
*            /********************************************************/ 05648000
*                                                                  1317 05649000
*            ALSNMPTR = ALSNMPTR + LNAMEDS;                        1317 05650000
*                                                                  1317 05651000
         AL    @15,@CF00041                                        1317 05652000
         ST    @15,ALSNMPTR(,@05)                                  1317 05653000
*            IF NMDSTYPE = 'X'                                     1318 05654000
*              THEN                                                1318 05655000
@RF01316 L     @05,@PC00012                                        1318 05656000
         L     @05,ALSNMPTR(,@05)                                  1318 05657000
         CLI   NMDSTYPE(@05),C'X'                                  1318 05658000
         BNE   @RF01318                                            1318 05659000
*ALSREC:         DO;                                               1319 05660000
ALSREC   DS    0H                                                  1320 05661000
*                /****************************************************/ 05662000
*                /*                                                  */ 05663000
*                /*  IF THIS IS THE FIRST ALIAS TO BE PROCESSED      */ 05664000
*                /*  CALL LOCPROC TO BUILD THE CPL AND FPL'S         */ 05665000
*                /*                                                  */ 05666000
*                /****************************************************/ 05667000
*                                                                  1320 05668000
*                  CALL LOCPROC(NMDSNAME,PTRCTACB,ALSFLIST,        1320 05669000
*                    CNUM,PTRCPL(PTHCPLNO));                       1320 05670000
*                                                                  1320 05671000
         L     @05,@PC00012                                        1320 05672000
         L     @05,ALSNMPTR(,@05)                                  1320 05673000
         LA    @05,NMDSNAME(,@05)                                  1320 05674000
         ST    @05,@AL00001                                        1320 05675000
         LA    @05,PTRCTACB                                        1320 05676000
         ST    @05,@AL00001+4                                      1320 05677000
         LA    @05,ALSFLIST                                        1320 05678000
         ST    @05,@AL00001+8                                      1320 05679000
         LA    @05,CNUM                                            1320 05680000
         ST    @05,@AL00001+12                                     1320 05681000
         LA    @05,PTRCPL+16                                       1320 05682000
         ST    @05,@AL00001+16                                     1320 05683000
         LA    @01,@AL00001                                        1320 05684000
         BAL   @14,LOCPROC                                         1320 05685000
*                  RESPECIFY RTNREG RSTD;                          1321 05686000
*                  TESTRC = RTNREG;                                1322 05687000
         LR    TESTRC,RTNREG                                       1322 05688000
*                  RESPECIFY RTNREG UNRSTD;                        1323 05689000
*                                                                  1323 05690000
*                  IF TESTRC ^= 0                                  1324 05691000
*                    THEN                                          1324 05692000
         LTR   TESTRC,TESTRC                                       1324 05693000
         BZ    @RF01324                                            1324 05694000
*                      RETURN CODE(LASTCC16);                      1325 05695000
         LA    @15,16                                              1325 05696000
         L     @14,@SA00012                                        1325 05697000
         LM    @00,@03,@SA00012+8                                  1325 05698000
         LM    @05,@12,@SA00012+24                                 1325 05699000
         BR    @14                                                 1325 05700000
*                                                          /*@OZ10598*/ 05701000
*                  CPLFPLEN = TOTLEN;                      /*@OZ10598*/ 05702000
@RF01324 MVC   CPLFPLEN(4),TOTLEN                                  1326 05703000
*                                                          /*@OZ10598*/ 05704000
*                  /**************************************************/ 05705000
*                  /*                                                */ 05706000
*                  /*  SAVE THE CPL AND FPL'S JUST                   */ 05707000
*                  /*  CONSTRUCTED FOR USE WITH OTHER ALIAS'S        */ 05708000
*                  /*                                                */ 05709000
*                  /**************************************************/ 05710000
*                                                                  1327 05711000
*                  SAPLLEN = LENGTH(SAVEPL);                       1327 05712000
*                                                                  1327 05713000
         MVC   SAPLLEN(2),@CH01287                                 1327 05714000
*                  CALL MVDAPROC(ALSCPLEN,PTRCPL(PTHCPLNO),/*@OZ10598*/ 05715000
*                    ADDR(SAVEPL),NULLPARM);                       1328 05716000
*                                                                  1328 05717000
*                                                                  1328 05718000
*                                                                  1328 05719000
         LA    @05,ALSCPLEN                                        1328 05720000
         ST    @05,@AL00001                                        1328 05721000
         LA    @05,PTRCPL+16                                       1328 05722000
         ST    @05,@AL00001+4                                      1328 05723000
         LA    @05,SAVEPL                                          1328 05724000
         ST    @05,@AFTEMPS+8                                      1328 05725000
         LA    @05,@AFTEMPS+8                                      1328 05726000
         ST    @05,@AL00001+8                                      1328 05727000
         LA    @05,NULLPARM                                        1328 05728000
         ST    @05,@AL00001+12                                     1328 05729000
         LA    @01,@AL00001                                        1328 05730000
         BAL   @14,MVDAPROC                                        1328 05731000
*                  /**************************************************/ 05732000
*                  /*                                                */ 05733000
*                  /* CALL CTLGPROC TO ISSUE A UCATLG TO DO THE      */ 05734000
*                  /* ACTUAL LOCATE.                                 */ 05735000
*                  /*                                                */ 05736000
*                  /**************************************************/ 05737000
*                                                                  1329 05738000
*                  CALL CTLGPROC(PTRCPL(PTHCPLNO));                1329 05739000
*                                                                  1329 05740000
         LA    @05,PTRCPL+16                                       1329 05741000
         ST    @05,@AL00001                                        1329 05742000
         LA    @01,@AL00001                                        1329 05743000
         BAL   @14,CTLGPROC                                        1329 05744000
*                  RESPECIFY RTNREG RSTD;                          1330 05745000
*                  TESTRC = RTNREG;                                1331 05746000
         LR    TESTRC,RTNREG                                       1331 05747000
*                  RESPECIFY RTNREG UNRSTD;                        1332 05748000
*                  IF TESTRC ^= 0                                  1333 05749000
*                    THEN                                          1333 05750000
         LTR   TESTRC,TESTRC                                       1333 05751000
         BZ    @RF01333                                            1333 05752000
*                      DO;                                         1334 05753000
*                      /**********************************************/ 05754000
*                      /*                                            */ 05755000
*                      /* IF SEVERE ERROR RETURNS WITH TERMINATION   */ 05756000
*                      /* ELSE BYPASSES THIS ALIAS AND PRINTS        */ 05757000
*                      /* MESSAGE TO INDICATE THE ERROR              */ 05758000
*                      /*                                            */ 05759000
*                      /**********************************************/ 05760000
*                      IF TESTRC = LASTCC16                        1335 05761000
*                        THEN                                      1335 05762000
         LA    @05,16                                              1335 05763000
         CR    TESTRC,@05                                          1335 05764000
         BNE   @RF01335                                            1335 05765000
*                          RETURN CODE(LASTCC16);                  1336 05766000
         LR    @15,@05                                             1336 05767000
         L     @14,@SA00012                                        1336 05768000
         LM    @00,@03,@SA00012+8                                  1336 05769000
         LM    @05,@12,@SA00012+24                                 1336 05770000
         BR    @14                                                 1336 05771000
*                        ELSE                                      1337 05772000
*                          DO;                                     1337 05773000
@RF01335 DS    0H                                                  1338 05774000
*                          ERRSAVFL = ON;                          1338 05775000
*                                                                  1338 05776000
         OI    ERRSAVFL,B'00100000'                                1338 05777000
*                          CALL  PRNTPROC(WARNMSG1,ASCCPLMG);      1339 05778000
*                                                                  1339 05779000
         LA    @01,@AL01339                                        1339 05780000
         BAL   @14,PRNTPROC                                        1339 05781000
*                          END;                                    1340 05782000
*                                                                  1340 05783000
*                      END;                                        1341 05784000
*                                                                  1341 05785000
*                                                                  1341 05786000
*                    ELSE                                          1342 05787000
*                      DO;                                         1342 05788000
         B     @RC01333                                            1342 05789000
@RF01333 DS    0H                                                  1343 05790000
*                      /**********************************************/ 05791000
*                      /*                                            */ 05792000
*                      /*  CHECK ALIAS CHAIN FOR ADDITIONAL ALIAS'S  */ 05793000
*                      /*                                            */ 05794000
*                      /**********************************************/ 05795000
*                                                                  1343 05796000
*                      CTGPLPTR = PTRCPL(PTHCPLNO);                1343 05797000
         L     @05,PTRCPL+16                                       1343 05798000
         ST    @05,CTGPLPTR                                        1343 05799000
*                      CTGFLPTR = CTGFIELD(IALNMDS);               1344 05800000
         L     CTGFLPTR,CTGFIELD+8(,@05)                           1344 05801000
*                      NALSMPTR = CTGFLPT(1);                      1345 05802000
         L     NALSMPTR,CTGFLPT(,CTGFLPTR)                         1345 05803000
*                      NXTCHN = NXTNAM;                            1346 05804000
         L     @05,NXTNAM-1(,NALSMPTR)                             1346 05805000
         LA    @05,0(,@05)                                         1346 05806000
         STCM  @05,7,NXTCHN                                        1346 05807000
*                      IF NXTCHN = 0                               1347 05808000
*                        THEN;                                     1347 05809000
         LTR   @05,@05                                             1347 05810000
         BZ    @RT01347                                            1347 05811000
*                        ELSE                                      1349 05812000
*                          DOALIS = ON ;                           1349 05813000
*                                                                  1349 05814000
         OI    DOALIS,B'10000000'                                  1349 05815000
*                      /**********************************************/ 05816000
*                      /*                                            */ 05817000
*                      /*  CALL CONTRBL TO BUILD THE CONTROL RECORD  */ 05818000
*                      /*  AND TO WRITE IT AND THE CATALOG WORK AREA */ 05819000
*                      /*  OUT THE PORTABILITY DATA SET              */ 05820000
*                      /*                                            */ 05821000
*                      /**********************************************/ 05822000
*                                                                  1350 05823000
*                      CALL CONTRBL(PTHCPLNO,'N');                 1350 05824000
*                                                                  1350 05825000
@RT01347 LA    @01,@AL01350                                        1350 05826000
         BAL   @14,CONTRBL                                         1350 05827000
*                      RESPECIFY RTNREG RSTD;                      1351 05828000
*                      TESTRC = RTNREG;                            1352 05829000
         LR    TESTRC,RTNREG                                       1352 05830000
*                      RESPECIFY RTNREG UNRSTD;                    1353 05831000
*                                                                  1353 05832000
*                      IF TESTRC ^= 0                              1354 05833000
*                        THEN                                      1354 05834000
         LTR   TESTRC,TESTRC                                       1354 05835000
         BZ    @RF01354                                            1354 05836000
*                          DO;                                     1355 05837000
*                          /******************************************/ 05838000
*                          /*                                        */ 05839000
*                          /* IF SEVERE ERROR RETURNS WITH           */ 05840000
*                          /* TERMINATION CODE ELSE BYPASSES ALIAS'S */ 05841000
*                          /* AND PRINTS MESSAGE TO INDICATE         */ 05842000
*                          /* THE ERROR                              */ 05843000
*                          /*                                        */ 05844000
*                          /******************************************/ 05845000
*                          IF TESTRC = LASTCC16                    1356 05846000
*                            THEN                                  1356 05847000
         LA    @05,16                                              1356 05848000
         CR    TESTRC,@05                                          1356 05849000
         BNE   @RF01356                                            1356 05850000
*                              RETURN CODE(LASTCC16);              1357 05851000
         LR    @15,@05                                             1357 05852000
         L     @14,@SA00012                                        1357 05853000
         LM    @00,@03,@SA00012+8                                  1357 05854000
         LM    @05,@12,@SA00012+24                                 1357 05855000
         BR    @14                                                 1357 05856000
*                            ELSE                                  1358 05857000
*                              DO;                                 1358 05858000
@RF01356 DS    0H                                                  1359 05859000
*                              ERRSAVFL = ON;                      1359 05860000
         OI    ERRSAVFL,B'00100000'                                1359 05861000
*                              DOALIS = OFF;                       1360 05862000
*                                                                  1360 05863000
         NI    DOALIS,B'01111111'                                  1360 05864000
*                              CALL  PRNTPROC(WARNMSG1,ASCCPLMG);  1361 05865000
*                                                                  1361 05866000
         LA    @01,@AL01361                                        1361 05867000
         BAL   @14,PRNTPROC                                        1361 05868000
*                              END;                                1362 05869000
*                          END;                                    1363 05870000
*                       END;                                       1364 05871000
*                                                                  1364 05872000
*                END ALSREC;                                       1365 05873000
*                                                                  1365 05874000
*              ELSE                                                1366 05875000
*                DO;                                               1366 05876000
         B     @RC01318                                            1366 05877000
@RF01318 DS    0H                                                  1367 05878000
*                /****************************************************/ 05879000
*                /*                                                  */ 05880000
*                /* NOT ALIAS ASSOCIATION, PRINT WARNING MESSAGE     */ 05881000
*                /*                                                  */ 05882000
*                /****************************************************/ 05883000
*                                                                  1367 05884000
*                ERRSAVFL = ON;                                    1367 05885000
*                                                                  1367 05886000
         OI    ERRSAVFL,B'00100000'                                1367 05887000
*                CALL  PRNTPROC(WARNMSG1,ASCCPLMG);                1368 05888000
*                                                                  1368 05889000
         LA    @01,@AL01368                                        1368 05890000
         BAL   @14,PRNTPROC                                        1368 05891000
*                END;                                              1369 05892000
*                                                                  1369 05893000
*                                                                  1369 05894000
*                  /**************************************************/ 05895000
*                  /*                                                */ 05896000
*                  /*  IF THERE ARE ADDITIONAL ALIAS TO BE PROCESSED */ 05897000
*                  /*  RESTORE THE CPL AND FPL'S MODIFY THE CPL TO   */ 05898000
*                  /*  DO A LOCATE ON THE APPROPRIATE ALIAS          */ 05899000
*                  /*                                                */ 05900000
*                  /**************************************************/ 05901000
*NFIRALS:          DO WHILE ( DOALIS = ON );                       1370 05902000
*                                                                  1370 05903000
@RC01318 DS    0H                                                  1370 05904000
NFIRALS  B     @DE01370                                            1370 05905000
@DL01370 DS    0H                                                  1371 05906000
*                  CTGPLPTR = PTRCPL(PTHCPLNO);                    1371 05907000
*                                                                  1371 05908000
         L     @05,PTRCPL+16                                       1371 05909000
         ST    @05,CTGPLPTR                                        1371 05910000
*                  CALL MVDAPROC(ALSCPLEN,ADDR(SAVEPL),    /*@OZ10598*/ 05911000
*                    PTRCPL(PTHCPLNO),NULLPARM);                   1372 05912000
*                                                                  1372 05913000
         LA    @05,ALSCPLEN                                        1372 05914000
         ST    @05,@AL00001                                        1372 05915000
         LA    @05,SAVEPL                                          1372 05916000
         ST    @05,@AFTEMPS+8                                      1372 05917000
         LA    @05,@AFTEMPS+8                                      1372 05918000
         ST    @05,@AL00001+4                                      1372 05919000
         LA    @05,PTRCPL+16                                       1372 05920000
         ST    @05,@AL00001+8                                      1372 05921000
         LA    @05,NULLPARM                                        1372 05922000
         ST    @05,@AL00001+12                                     1372 05923000
         LA    @01,@AL00001                                        1372 05924000
         BAL   @14,MVDAPROC                                        1372 05925000
*                  CALL MVDAPROC(WKAREALN+LENGTH(PATHREL),         1373 05926000
*                    NULLPARM,CTGWKA,SETZERO);                     1373 05927000
*                                                                  1373 05928000
         MVC   @AL00001(16),@AL01373                               1373 05929000
         L     @05,CTGPLPTR                                        1373 05930000
         LA    @05,CTGWKA(,@05)                                    1373 05931000
         ST    @05,@AL00001+8                                      1373 05932000
         LA    @01,@AL00001                                        1373 05933000
         BAL   @14,MVDAPROC                                        1373 05934000
*                  AREALN = WKAREALN;                              1374 05935000
         L     @05,CTGPLPTR                                        1374 05936000
         L     @01,CTGWKA(,@05)                                    1374 05937000
         MVC   AREALN(2,@01),@CH00812                              1374 05938000
*                  CTGENT = ADDR(NXTCHN);                          1375 05939000
*                                                                  1375 05940000
         LA    @15,NXTCHN                                          1375 05941000
         ST    @15,CTGENT(,@05)                                    1375 05942000
*                  /**************************************************/ 05943000
*                  /*                                                */ 05944000
*                  /* CLEAR THE FPL POINTERS SET BY PREVIOUS LOCATE  */ 05945000
*                  /*                                                */ 05946000
*                  /**************************************************/ 05947000
*                                                                  1376 05948000
*                  DO CLRFDCTR = 1 TO CNUM;                        1376 05949000
         LA    CLRFDCTR,1                                          1376 05950000
         B     @DE01376                                            1376 05951000
@DL01376 DS    0H                                                  1377 05952000
*                    CTGFLPTR = CTGFIELD(CLRFDCTR);                1377 05953000
         LR    @05,CLRFDCTR                                        1377 05954000
         SLA   @05,2                                               1377 05955000
         L     @01,CTGPLPTR                                        1377 05956000
         L     CTGFLPTR,CTGFIELD-4(@05,@01)                        1377 05957000
*                    CTGFLNG(1) = 0;                               1378 05958000
         SLR   @05,@05                                             1378 05959000
         ST    @05,CTGFLNG(,CTGFLPTR)                              1378 05960000
*                    CTGFLPT(1) = NULLPTR;                         1379 05961000
         ST    @05,CTGFLPT(,CTGFLPTR)                              1379 05962000
*                  END;                                            1380 05963000
*                                                                  1380 05964000
         AL    CLRFDCTR,@CF00218                                   1380 05965000
@DE01376 SLR   @05,@05                                             1380 05966000
         IC    @05,CNUM                                            1380 05967000
         CR    CLRFDCTR,@05                                        1380 05968000
         BNH   @DL01376                                            1380 05969000
*                  /**************************************************/ 05970000
*                  /*                                                */ 05971000
*                  /* CALL CTLGPROC TO ISSUE A UCATLG TO DO LOCATE   */ 05972000
*                  /*                                                */ 05973000
*                  /**************************************************/ 05974000
*                                                                  1381 05975000
*                  CALL CTLGPROC(PTRCPL(PTHCPLNO));                1381 05976000
*                                                                  1381 05977000
         LA    @05,PTRCPL+16                                       1381 05978000
         ST    @05,@AL00001                                        1381 05979000
         LA    @01,@AL00001                                        1381 05980000
         BAL   @14,CTLGPROC                                        1381 05981000
*                  RESPECIFY RTNREG RSTD;                          1382 05982000
*                  TESTRC = RTNREG;                                1383 05983000
         LR    TESTRC,RTNREG                                       1383 05984000
*                  RESPECIFY RTNREG UNRSTD;                        1384 05985000
*                                                                  1384 05986000
*                  IF TESTRC ^= 0                                  1385 05987000
*                    THEN                                          1385 05988000
         LTR   TESTRC,TESTRC                                       1385 05989000
         BZ    @RF01385                                            1385 05990000
*                      DO;                                         1386 05991000
*                      /**********************************************/ 05992000
*                      /*                                            */ 05993000
*                      /*IF SEVERE ERROR RETURNS WITH TERMINATION    */ 05994000
*                      /*ELSE BYPASSES ALIAS'S AND PRINTS MESSAGE    */ 05995000
*                      /*TO INDICATE THE ERROR                       */ 05996000
*                      /*                                            */ 05997000
*                      /**********************************************/ 05998000
*                      IF TESTRC = LASTCC16                        1387 05999000
*                        THEN                                      1387 06000000
         LA    @05,16                                              1387 06001000
         CR    TESTRC,@05                                          1387 06002000
         BNE   @RF01387                                            1387 06003000
*                          RETURN CODE(LASTCC16);                  1388 06004000
         LR    @15,@05                                             1388 06005000
         L     @14,@SA00012                                        1388 06006000
         LM    @00,@03,@SA00012+8                                  1388 06007000
         LM    @05,@12,@SA00012+24                                 1388 06008000
         BR    @14                                                 1388 06009000
*                        ELSE                                      1389 06010000
*                          DO;                                     1389 06011000
@RF01387 DS    0H                                                  1390 06012000
*                          ERRSAVFL = ON;                          1390 06013000
         OI    ERRSAVFL,B'00100000'                                1390 06014000
*                          DOALIS = OFF;                           1391 06015000
*                                                                  1391 06016000
         NI    DOALIS,B'01111111'                                  1391 06017000
*                          CALL  PRNTPROC(WARNMSG1,ASCCPLMG);      1392 06018000
*                                                                  1392 06019000
         LA    @01,@AL01392                                        1392 06020000
         BAL   @14,PRNTPROC                                        1392 06021000
*                          END;                                    1393 06022000
*                      END;                                        1394 06023000
*                    ELSE                                          1395 06024000
*                      DO;                                         1395 06025000
         B     @RC01385                                            1395 06026000
@RF01385 DS    0H                                                  1396 06027000
*                      /**********************************************/ 06028000
*                      /*                                            */ 06029000
*                      /*  CHECK ALIAS CHAIN FOR ADDITIONAL ALIAS'S  */ 06030000
*                      /*                                            */ 06031000
*                      /**********************************************/ 06032000
*                                                                  1396 06033000
*                      CTGPLPTR = PTRCPL(PTHCPLNO);                1396 06034000
         L     @05,PTRCPL+16                                       1396 06035000
         ST    @05,CTGPLPTR                                        1396 06036000
*                      CTGFLPTR = CTGFIELD(IALNMDS);               1397 06037000
         L     CTGFLPTR,CTGFIELD+8(,@05)                           1397 06038000
*                      NALSMPTR = CTGFLPT(1);                      1398 06039000
         L     NALSMPTR,CTGFLPT(,CTGFLPTR)                         1398 06040000
*                      NXTCHN = NXTNAM;                            1399 06041000
         L     @05,NXTNAM-1(,NALSMPTR)                             1399 06042000
         LA    @05,0(,@05)                                         1399 06043000
         STCM  @05,7,NXTCHN                                        1399 06044000
*                      IF NXTCHN = 0                               1400 06045000
*                        THEN                                      1400 06046000
         LTR   @05,@05                                             1400 06047000
         BNZ   @RF01400                                            1400 06048000
*                          DOALIS = OFF ;                          1401 06049000
*                                                                  1401 06050000
         NI    DOALIS,B'01111111'                                  1401 06051000
*                      /**********************************************/ 06052000
*                      /*                                            */ 06053000
*                      /*  CALL CONTRBL TO BUILD THE CONTROL         */ 06054000
*                      /*  RECORD FOR THE CURRENT ALIAS AND          */ 06055000
*                      /*  TO WRITE IT AND THE CATALOG WORK          */ 06056000
*                      /*  AREA OUT THE PORTABILITY DATA SET         */ 06057000
*                      /*                                            */ 06058000
*                      /**********************************************/ 06059000
*                                                                  1402 06060000
*                      CALL CONTRBL(PTHCPLNO,'N');                 1402 06061000
*                                                                  1402 06062000
@RF01400 LA    @01,@AL01402                                        1402 06063000
         BAL   @14,CONTRBL                                         1402 06064000
*                      RESPECIFY RTNREG RSTD;                      1403 06065000
*                      TESTRC = RTNREG;                            1404 06066000
         LR    TESTRC,RTNREG                                       1404 06067000
*                      RESPECIFY RTNREG UNRSTD;                    1405 06068000
*                                                                  1405 06069000
*                      IF TESTRC ^= 0                              1406 06070000
*                        THEN                                      1406 06071000
         LTR   TESTRC,TESTRC                                       1406 06072000
         BZ    @RF01406                                            1406 06073000
*                          DO;                                     1407 06074000
*                          /******************************************/ 06075000
*                          /*                                        */ 06076000
*                          /* IF SEVERE ERROR RETURNS WITH           */ 06077000
*                          /* TERMINATION CODE ELSE BYPASSES         */ 06078000
*                          /* ALIAS'S AND PRINTS MESSAGE TO          */ 06079000
*                          /* INDICATE THE ERROR                     */ 06080000
*                          /*                                        */ 06081000
*                          /******************************************/ 06082000
*                          IF TESTRC = LASTCC16                    1408 06083000
*                            THEN                                  1408 06084000
         LA    @05,16                                              1408 06085000
         CR    TESTRC,@05                                          1408 06086000
         BNE   @RF01408                                            1408 06087000
*                              RETURN CODE(LASTCC16);              1409 06088000
         LR    @15,@05                                             1409 06089000
         L     @14,@SA00012                                        1409 06090000
         LM    @00,@03,@SA00012+8                                  1409 06091000
         LM    @05,@12,@SA00012+24                                 1409 06092000
         BR    @14                                                 1409 06093000
*                            ELSE                                  1410 06094000
*                              DO;                                 1410 06095000
@RF01408 DS    0H                                                  1411 06096000
*                              ERRSAVFL = ON;                      1411 06097000
         OI    ERRSAVFL,B'00100000'                                1411 06098000
*                              DOALIS = OFF;                       1412 06099000
*                                                                  1412 06100000
         NI    DOALIS,B'01111111'                                  1412 06101000
*                              CALL  PRNTPROC(WARNMSG1,ASCCPLMG);  1413 06102000
*                                                                  1413 06103000
         LA    @01,@AL01413                                        1413 06104000
         BAL   @14,PRNTPROC                                        1413 06105000
*                              END;                                1414 06106000
*                          END;                                    1415 06107000
*                      END;                                        1416 06108000
*                                                                  1416 06109000
@RF01406 DS    0H                                                  1417 06110000
*                  END NFIRALS;                                    1417 06111000
*                                                                  1417 06112000
@RC01385 DS    0H                                                  1417 06113000
@DE01370 TM    DOALIS,B'10000000'                                  1417 06114000
         BO    @DL01370                                            1417 06115000
*        /************************************************************/ 06116000
*        /*                                                          */ 06117000
*        /* RETURN TO CALLER WITH SUCCESS INDICATED                  */ 06118000
*        /*  IF ALL ALIAS'S NOT PROCESSED THEN ERROR FLAG SET        */ 06119000
*        /*                                                          */ 06120000
*        /************************************************************/ 06121000
*                                                                  1418 06122000
*        RETURN CODE(0);                                           1418 06123000
*                                                                  1418 06124000
         SLR   @15,@15                                             1418 06125000
         L     @14,@SA00012                                        1418 06126000
         LM    @00,@03,@SA00012+8                                  1418 06127000
         LM    @05,@12,@SA00012+24                                 1418 06128000
         BR    @14                                                 1418 06129000
*END   ALSPROC;                                                    1419 06130000
*        /************************************************************/ 06131000
*        /*                                                          */ 06132000
*        /*  PROCEDURE NAME - GDGPROC                                */ 06133000
*        /*                                                          */ 06134000
*        /*  FUNCTION - OBTAINS CATALOG INFORMATION ABOUT            */ 06135000
*        /*  THE OBJECT BEING EXPORTED AND ANY ASSOCIATIONS TO THE   */ 06136000
*        /*  OBJECT.  BUILDS CONTROL AND DATA RECORDS, AND           */ 06137000
*        /*  WRITES OUT THE HEADER RECORDS OF THE                    */ 06138000
*        /*  PORTABILITY DATA SET.  CALLS LOWER LEVEL                */ 06139000
*        /*  PROCEDURES TO PROCESS ASSOCIATIONS.                     */ 06140000
*        /*                                                          */ 06141000
*        /*  INPUT - INPUT PARAMETER LIST                            */ 06142000
*        /*                                                          */ 06143000
*        /*  OUTPUT - PORTABILITY DATA SET THAT CAN BE EMPLOYED BY   */ 06144000
*        /*  THE IMPORT FSR TO RECONSTRUCT THE NON VSAM OBJECT ON THE*/ 06145000
*        /*  SAME SYSTEM OR ON A DIFFERENT SYSTEM.                   */ 06146000
*        /*                                                          */ 06147000
*        /************************************************************/ 06148000
*                                                                  1420 06149000
*GDGPROC: PROCEDURE;                                               1420 06150000
*                                                                  1420 06151000
GDGPROC  STM   @14,@12,@SA00013                                    1420 06152000
*        OLDERID2 = NEWERID2;                                      1421 06153000
         L     @15,@PC00001                                        1421 06154000
         L     @14,GDTTR2(,@15)                                    1421 06155000
         MVC   @TS00001(95),NEWERID2(@14)                          1421 06156000
         MVC   OLDERID2(95,@14),@TS00001                           1421 06157000
*        NEWID2 = 'RC35';                                          1422 06158000
         MVC   NEWID2(4,@14),@CC01247                              1422 06159000
*        IF GDTDBG = NULLPTR                                       1423 06160000
*          THEN;                                                   1423 06161000
         L     @15,GDTDBG(,@15)                                    1423 06162000
         LTR   @15,@15                                             1423 06163000
         BZ    @RT01423                                            1423 06164000
*          ELSE                                                    1425 06165000
*            CALL IDCDB010 (GDTTBL,'RC36');                        1425 06166000
*                                                                  1425 06167000
         L     @15,@PC00001                                        1425 06168000
         ST    @15,@AL00001                                        1425 06169000
         LA    @14,@CC01248                                        1425 06170000
         ST    @14,@AL00001+4                                      1425 06171000
         MVI   @AL00001+4,X'80'                                    1425 06172000
         L     @15,GDTDBG(,@15)                                    1425 06173000
         LA    @01,@AL00001                                        1425 06174000
         BALR  @14,@15                                             1425 06175000
*        /************************************************************/ 06176000
*        /*                                                          */ 06177000
*        /*  INITIALIZE NUMBER OF FIELDS FOR CATALOG LOCATE          */ 06178000
*        /*                                                          */ 06179000
*        /************************************************************/ 06180000
*                                                                  1426 06181000
*        CNUM = (DIM(GDGFLIST));       /*FIELD LIST FOR FIRST LOCATE */ 06182000
@RT01423 MVI   CNUM,X'09'                                          1426 06183000
*        ONUM = (DIM(GDGFLIST) -2);    /*FIELD WITHOUT CATACB AND    */ 06184000
         MVI   ONUM,X'07'                                          1427 06185000
*                                      /*NAMEDS FPL'S.               */ 06186000
*                                                                  1428 06187000
*        /************************************************************/ 06188000
*        /*                                                          */ 06189000
*        /*  PERFORM LOCATE ON THE GDG CI NUMBER                     */ 06190000
*        /*  CALL LOCPROC TO BUILD THE NECESSARY CPL AND FPLS.       */ 06191000
*        /*  CALL CTLGPROC TO INVOKE CATALOG MANAGEMENT FOR LOCATE   */ 06192000
*        /*                                                          */ 06193000
*        /************************************************************/ 06194000
*                                                                  1428 06195000
*        CALL LOCPROC(OBJVAL,NULLPARM,GDGFLIST,CNUM,PTRCPL(1));    1428 06196000
*                                                                  1428 06197000
         L     @15,@PC00001+4                                      1428 06198000
         L     @01,INPPTR(,@15)                                    1428 06199000
         L     @01,INPTBL(,@01)                                    1428 06200000
         LA    @15,OBJVAL(,@01)                                    1428 06201000
         ST    @15,@AL00001                                        1428 06202000
         LA    @15,NULLPARM                                        1428 06203000
         ST    @15,@AL00001+4                                      1428 06204000
         LA    @15,GDGFLIST                                        1428 06205000
         ST    @15,@AL00001+8                                      1428 06206000
         LA    @15,CNUM                                            1428 06207000
         ST    @15,@AL00001+12                                     1428 06208000
         LA    @15,PTRCPL                                          1428 06209000
         ST    @15,@AL00001+16                                     1428 06210000
         LA    @01,@AL00001                                        1428 06211000
         BAL   @14,LOCPROC                                         1428 06212000
*        /************************************************************/ 06213000
*        /*                                                          */ 06214000
*        /* IF LOCPROC FAILS TO BUILD CPL'S AND FPL'S -TERMINATE     */ 06215000
*        /*                                                          */ 06216000
*        /************************************************************/ 06217000
*                                                                  1429 06218000
*        RESPECIFY RTNREG RSTD;                                    1429 06219000
*        TESTRC = RTNREG;                                          1430 06220000
         LR    TESTRC,RTNREG                                       1430 06221000
*        RESPECIFY RTNREG UNRSTD;                                  1431 06222000
*        IF TESTRC ^= 0                                            1432 06223000
*          THEN                                                    1432 06224000
         LTR   TESTRC,TESTRC                                       1432 06225000
         BZ    @RF01432                                            1432 06226000
*            RETURN CODE(LASTCC16);                                1433 06227000
*                                                                  1433 06228000
         LA    @15,16                                              1433 06229000
         L     @14,@SA00013                                        1433 06230000
         LM    @00,@12,@SA00013+8                                  1433 06231000
         BR    @14                                                 1433 06232000
*        CALL CTLGPROC(PTRCPL(1));                                 1434 06233000
*                                                                  1434 06234000
@RF01432 LA    @15,PTRCPL                                          1434 06235000
         ST    @15,@AL00001                                        1434 06236000
         LA    @01,@AL00001                                        1434 06237000
         BAL   @14,CTLGPROC                                        1434 06238000
*        /************************************************************/ 06239000
*        /*                                                          */ 06240000
*        /* IF CTLGPROC FAILS TO PERFORM THE LOCATES - TERMINATE     */ 06241000
*        /* THIS REQUEST                                             */ 06242000
*        /*                                                          */ 06243000
*        /************************************************************/ 06244000
*                                                                  1435 06245000
*        RESPECIFY RTNREG RSTD;                                    1435 06246000
*        TESTRC = RTNREG;                                          1436 06247000
         LR    TESTRC,RTNREG                                       1436 06248000
*        RESPECIFY RTNREG UNRSTD;                                  1437 06249000
*                                                                  1437 06250000
*        IF TESTRC ^= 0                                            1438 06251000
*          THEN                                                    1438 06252000
         LTR   TESTRC,TESTRC                                       1438 06253000
         BZ    @RF01438                                            1438 06254000
*            DO;                                                   1439 06255000
*                                                                  1439 06256000
*            /********************************************************/ 06257000
*            /*                                                      */ 06258000
*            /* IF SEVERE ERROR RETURN IS WITH TERMINATION CODE ELSE */ 06259000
*            /*  RETURN INDICATES THIS REQUEST COULD NOT BE PROCESSED*/ 06260000
*            /*                                                      */ 06261000
*            /********************************************************/ 06262000
*                                                                  1440 06263000
*            IF TESTRC = LASTCC16                                  1440 06264000
*              THEN                                                1440 06265000
         LA    @03,16                                              1440 06266000
         CR    TESTRC,@03                                          1440 06267000
         BNE   @RF01440                                            1440 06268000
*                RETURN CODE(LASTCC16);                            1441 06269000
         LR    @15,@03                                             1441 06270000
         L     @14,@SA00013                                        1441 06271000
         LM    @00,@12,@SA00013+8                                  1441 06272000
         BR    @14                                                 1441 06273000
*              ELSE                                                1442 06274000
*                RETURN CODE(LASTCC08);                            1442 06275000
@RF01440 LA    @15,8                                               1442 06276000
         L     @14,@SA00013                                        1442 06277000
         LM    @00,@12,@SA00013+8                                  1442 06278000
         BR    @14                                                 1442 06279000
*            END;                                                  1443 06280000
*                                                                  1443 06281000
*        /************************************************************/ 06282000
*        /*                                                          */ 06283000
*        /*  GET ENTYPE FPL AND EXAMINE RETURNED FIELD INFORMATION   */ 06284000
*        /*  TO INSURE THAT ENTRYVAL WAS INDEED A GDG OBJECT         */ 06285000
*        /*                                                          */ 06286000
*        /************************************************************/ 06287000
*                                                                  1444 06288000
*        CTGPLPTR = PTRCPL(1);                                     1444 06289000
@RF01438 L     @03,PTRCPL                                          1444 06290000
         ST    @03,CTGPLPTR                                        1444 06291000
*        CTGFLPTR = CTGFIELD(IENTYPE);                             1445 06292000
*                                                                  1445 06293000
         L     CTGFLPTR,CTGFIELD(,@03)                             1445 06294000
*        IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= 0                      1446 06295000
*          THEN                                                    1446 06296000
         SLR   @03,@03                                             1446 06297000
         C     @03,CTGFLNG(,CTGFLPTR)                              1446 06298000
         BE    @RF01446                                            1446 06299000
         L     @15,CTGFLPT(,CTGFLPTR)                              1446 06300000
         CR    @15,@03                                             1446 06301000
         BE    @RF01446                                            1446 06302000
*            IF FENTYPE ^= 'B'                                     1447 06303000
*              THEN                                                1447 06304000
         CLI   FENTYPE(@15),C'B'                                   1447 06305000
         BE    @RF01447                                            1447 06306000
*                DO;                                               1448 06307000
*                DARGSMOD = EXPMSG;                                1449 06308000
         L     @15,DDSTRU                                          1449 06309000
         MVC   DARGSMOD(3,@15),@CC00834                            1449 06310000
*                DARGSENT = NOVALOBJ;                              1450 06311000
         MVI   DARGSENT(@15),X'03'                                 1450 06312000
*                RETURN CODE(LASTCC08);                            1451 06313000
         LA    @15,8                                               1451 06314000
         L     @14,@SA00013                                        1451 06315000
         LM    @00,@12,@SA00013+8                                  1451 06316000
         BR    @14                                                 1451 06317000
*                END;                                              1452 06318000
*              ELSE;                                               1453 06319000
@RF01447 DS    0H                                                  1454 06320000
*          ELSE                                                    1454 06321000
*            /********************************************************/ 06322000
*            /*                                                      */ 06323000
*            /*  NO ENTYPE FIELD -IMPOSSIBLE - TERMINATE             */ 06324000
*            /*                                                      */ 06325000
*            /********************************************************/ 06326000
*            DO;                                                   1454 06327000
         B     @RC01446                                            1454 06328000
@RF01446 DS    0H                                                  1455 06329000
*            DARGSMOD = EXPMSG;                                    1455 06330000
         L     @15,DDSTRU                                          1455 06331000
         MVC   DARGSMOD(3,@15),@CC00834                            1455 06332000
*            DARGSENT = NOCTFLD;                                   1456 06333000
         MVI   DARGSENT(@15),X'04'                                 1456 06334000
*            RETURN CODE(LASTCC08);                                1457 06335000
         LA    @15,8                                               1457 06336000
         L     @14,@SA00013                                        1457 06337000
         LM    @00,@12,@SA00013+8                                  1457 06338000
         BR    @14                                                 1457 06339000
*            END;                                                  1458 06340000
*                                                                  1458 06341000
*                                                                  1458 06342000
*        /************************************************************/ 06343000
*        /*                                                          */ 06344000
*        /*  GET CATALOG ACB FIELD IF RETURNED IN FPL FOR CATACB     */ 06345000
*        /*                                                          */ 06346000
*        /************************************************************/ 06347000
*                                                                  1459 06348000
*        CTGFLPTR = CTGFIELD(GCATACB);                             1459 06349000
@RC01446 L     @15,CTGPLPTR                                        1459 06350000
         L     CTGFLPTR,CTGFIELD+32(,@15)                          1459 06351000
*        PTRCTACB = FCATACB;                                       1460 06352000
*                                                                  1460 06353000
         L     @03,CTGFLPT(,CTGFLPTR)                              1460 06354000
         L     @03,FCATACB(,@03)                                   1460 06355000
         ST    @03,PTRCTACB                                        1460 06356000
*        /************************************************************/ 06357000
*        /*                                                          */ 06358000
*        /*  GET NAMEDS FPL FOR GDS ASSOCIATIONS                     */ 06359000
*        /*                                                          */ 06360000
*        /************************************************************/ 06361000
*                                                                  1461 06362000
*        CTGFLPTR = CTGFIELD(GNAMEDS);                             1461 06363000
*                                                                  1461 06364000
         L     CTGFLPTR,CTGFIELD+28(,@15)                          1461 06365000
*        /************************************************************/ 06366000
*        /*                                                          */ 06367000
*        /*TEST FOR ASSOCIATIONS, IF ANY SET NUMBER OF OBJECTS TO BE */ 06368000
*        /* EXPORTED                                                 */ 06369000
*        /*                                                          */ 06370000
*        /************************************************************/ 06371000
*                                                                  1462 06372000
*        IF CTGFLNG(1) = 0                                         1462 06373000
*          THEN                                                    1462 06374000
         SLR   @03,@03                                             1462 06375000
         C     @03,CTGFLNG(,CTGFLPTR)                              1462 06376000
         BNE   @RF01462                                            1462 06377000
*            NUMASSOC = 0;                                         1463 06378000
         STH   @03,NUMASSOC                                        1463 06379000
*          ELSE                                                    1464 06380000
*            DO;                                                   1464 06381000
         B     @RC01462                                            1464 06382000
@RF01462 DS    0H                                                  1465 06383000
*            FNMPTR = CTGFLPT(1);                                  1465 06384000
         L     @03,CTGFLPT(,CTGFLPTR)                              1465 06385000
         ST    @03,FNMPTR                                          1465 06386000
*            NUMASSOC = CTGFLNG(1) / LNAMEDS;                      1466 06387000
         L     @00,CTGFLNG(,CTGFLPTR)                              1466 06388000
         SRDA  @00,32                                              1466 06389000
         D     @00,@CF00041                                        1466 06390000
         STH   @01,NUMASSOC                                        1466 06391000
*            ASSOCFLG = ON;                                        1467 06392000
         OI    ASSOCFLG,B'00000001'                                1467 06393000
*            END;                                                  1468 06394000
*                                                                  1468 06395000
*        /************************************************************/ 06396000
*        /*                                                          */ 06397000
*        /*  WRITE CATALOG INFORMATION TO THE PORTABILITY DATA SET   */ 06398000
*        /*  CATALOG INFORMATION WILL BE CONTAINED IN TWO TYPES OF   */ 06399000
*        /*  RECORDS- CONTROL RECORDS CONTAINING A DICTIONARY        */ 06400000
*        /*  INDEXING EACH CATALOG FIELD IN THE WORK AREA RETURNED   */ 06401000
*        /*  BY VSAM AND DATA RECORDS CONTAINING THE ENTIRE WORK     */ 06402000
*        /*  AREA RETURNED BY LOCATE                                 */ 06403000
*        /*                                                          */ 06404000
*        /************************************************************/ 06405000
*                                                                  1469 06406000
*        OLDERID2 = NEWERID2;                                      1469 06407000
@RC01462 L     @03,@PC00001                                        1469 06408000
         L     @15,GDTTR2(,@03)                                    1469 06409000
         MVC   @TS00001(95),NEWERID2(@15)                          1469 06410000
         MVC   OLDERID2(95,@15),@TS00001                           1469 06411000
*        NEWID2 = 'RC37';                                          1470 06412000
*                                                                  1470 06413000
         MVC   NEWID2(4,@15),@CC01249                              1470 06414000
*        /************************************************************/ 06415000
*        /*                                                          */ 06416000
*        /*  GET AN AREA FOR THE CONTROL RECORD OUTPUT BUFFER        */ 06417000
*        /*  IF CORE NOT OBTAINED, RETURN TO CALLING PROCESSOR       */ 06418000
*        /*                                                          */ 06419000
*        /************************************************************/ 06420000
*                                                                  1471 06421000
*        CALL IDCSAGP0 (GDTTBL,LENGTH(CONREC),CONRCPTR,GPID,SETZERO);   06422000
*                                                                  1471 06423000
         MVC   @AL00001+4(16),@AL01471                             1471 06424000
         ST    @03,@AL00001                                        1471 06425000
         LA    @15,CONRCPTR                                        1471 06426000
         ST    @15,@AL00001+8                                      1471 06427000
         L     @15,GDTGPL(,@03)                                    1471 06428000
         LA    @01,@AL00001                                        1471 06429000
         BALR  @14,@15                                             1471 06430000
*        RESPECIFY RTNREG RSTD;                                    1472 06431000
*        TESTRC = RTNREG;                                          1473 06432000
         LR    TESTRC,RTNREG                                       1473 06433000
*        RESPECIFY RTNREG UNRSTD;                                  1474 06434000
*        IF TESTRC ^= 0                                            1475 06435000
*          THEN                                                    1475 06436000
         LTR   TESTRC,TESTRC                                       1475 06437000
         BZ    @RF01475                                            1475 06438000
*            DO;                                                   1476 06439000
*            DARGSMOD = UNIVMSG;                                   1477 06440000
         L     @15,DDSTRU                                          1477 06441000
         MVC   DARGSMOD(3,@15),@CC00847                            1477 06442000
*            DARGSENT = NOSTORAG;                                  1478 06443000
         MVI   DARGSENT(@15),X'04'                                 1478 06444000
*            RETURN CODE(LASTCC16);                                1479 06445000
         LA    @15,16                                              1479 06446000
         L     @14,@SA00013                                        1479 06447000
         LM    @00,@12,@SA00013+8                                  1479 06448000
         BR    @14                                                 1479 06449000
*            END;                                                  1480 06450000
*                                                                  1480 06451000
*        CALL IDCSATI0 (GDTTBL,TIMEODAY,TIMEDATE,FORMAT);          1481 06452000
*                                                                  1481 06453000
@RF01475 L     @15,@PC00001                                        1481 06454000
         ST    @15,@AL00001                                        1481 06455000
         LA    @14,8                                               1481 06456000
         AL    @14,CONRCPTR                                        1481 06457000
         LA    @07,TIMEODAY(,@14)                                  1481 06458000
         ST    @07,@AL00001+4                                      1481 06459000
         LA    @14,TIMEDATE(,@14)                                  1481 06460000
         ST    @14,@AL00001+8                                      1481 06461000
         LA    @14,FORMAT                                          1481 06462000
         ST    @14,@AL00001+12                                     1481 06463000
         MVI   @AL00001+12,X'80'                                   1481 06464000
         L     @15,GDTTIM(,@15)                                    1481 06465000
         LA    @01,@AL00001                                        1481 06466000
         BALR  @14,@15                                             1481 06467000
*        HEADLN = LENGTH(HEADER) + LENGTH(TIMESTMP);               1482 06468000
         L     @15,CONRCPTR                                        1482 06469000
         LA    @14,28                                              1482 06470000
         STH   @14,HEADLN(,@15)                                    1482 06471000
*        HEADFLG1 = HDFL1CAT;                                      1483 06472000
         MVI   HEADFLG1(@15),X'FF'                                 1483 06473000
*        HEADFLG2 = HDFL2TSP;                                      1484 06474000
*                                                                  1484 06475000
         MVI   HEADFLG2(@15),X'FF'                                 1484 06476000
*        TEXGDG = ON;                                              1485 06477000
*        TEXRCVY = ON;                                             1486 06478000
         AL    @15,@CF00178                                        1486 06479000
         OI    TEXGDG(@15),B'00001010'                             1486 06480000
*        TEXOJCT = NUMASSOC + 1;       /* ADD OBJECT TO THE COUNT    */ 06481000
         LA    @07,1                                               1487 06482000
         AH    @07,NUMASSOC                                        1487 06483000
         STC   @07,TEXOJCT(,@15)                                   1487 06484000
*        TEXFLG2 = EXPTYPE1;                                       1488 06485000
*                                                                  1488 06486000
         MVC   TEXFLG2(1,@15),EXPTYPE1                             1488 06487000
*        SAVLEN = HEADLN;                                          1489 06488000
*                                                                  1489 06489000
         STH   @14,SAVLEN                                          1489 06490000
*        /************************************************************/ 06491000
*        /*                                                          */ 06492000
*        /*  WRITE THE TIME STAMP RECORD TO PORTABILITY DATA SET.    */ 06493000
*        /*                                                          */ 06494000
*        /************************************************************/ 06495000
*                                                                  1490 06496000
*        CALL  SAVEPROC(SAVLEN,CONRCPTR,'H');                      1490 06497000
*                                                                  1490 06498000
         LA    @15,SAVLEN                                          1490 06499000
         ST    @15,@AL00001                                        1490 06500000
         LA    @15,CONRCPTR                                        1490 06501000
         ST    @15,@AL00001+4                                      1490 06502000
         LA    @15,@CC01070                                        1490 06503000
         ST    @15,@AL00001+8                                      1490 06504000
         LA    @01,@AL00001                                        1490 06505000
         BAL   @14,SAVEPROC                                        1490 06506000
*        RESPECIFY RTNREG RSTD;                                    1491 06507000
*        TESTRC = RTNREG;                                          1492 06508000
         LR    TESTRC,RTNREG                                       1492 06509000
*        RESPECIFY RTNREG UNRSTD;                                  1493 06510000
*        IF TESTRC ^= 0                                            1494 06511000
*          THEN                                                    1494 06512000
         LTR   TESTRC,TESTRC                                       1494 06513000
         BZ    @RF01494                                            1494 06514000
*            RETURN CODE(LASTCC16);                                1495 06515000
         LA    @15,16                                              1495 06516000
         L     @14,@SA00013                                        1495 06517000
         LM    @00,@12,@SA00013+8                                  1495 06518000
         BR    @14                                                 1495 06519000
*        /************************************************************/ 06520000
*        /*                                                          */ 06521000
*        /*  BUILD AND WRITE THE CONTROL RECORD FOR THIS OBJECT      */ 06522000
*        /*                                                          */ 06523000
*        /************************************************************/ 06524000
*                                                                  1496 06525000
*        INDXCPL = 1;                     /*INDEX TO CPL FOR CONTRBL */ 06526000
*                                                                  1496 06527000
@RF01494 MVC   INDXCPL(4),@CF00218                                 1496 06528000
*        /************************************************************/ 06529000
*        /*                                                          */ 06530000
*        /*  IF WE ARE PROCESSING AN AIX CONTROL RECORD,             */ 06531000
*        /*  CALL CONTRBL WITH TYPE 'G' SPECIFIED.                   */ 06532000
*        /*  OTHERWISE, CALL CONTRBL WITH TYPE 'N' AS AN             */ 06533000
*        /*  ARGUMENT.  ('N' STANDS FOR NEUTRAL--A TYPE              */ 06534000
*        /*  OTHER THAN PATH OR AIX.)  CONTRBL ACTUALLY              */ 06535000
*        /*  BUILDS THE CONTROL RECORD TO BE WRITTEN TO              */ 06536000
*        /*  THE PORTABILITY DATA SET.                               */ 06537000
*        /*                                                          */ 06538000
*        /************************************************************/ 06539000
*                                                                  1497 06540000
*        CALL CONTRBL(INDXCPL,'N');                                1497 06541000
*                                                                  1497 06542000
         LA    @15,INDXCPL                                         1497 06543000
         ST    @15,@AL00001                                        1497 06544000
         LA    @15,@CC01072                                        1497 06545000
         ST    @15,@AL00001+4                                      1497 06546000
         LA    @01,@AL00001                                        1497 06547000
         BAL   @14,CONTRBL                                         1497 06548000
*        RESPECIFY RTNREG RSTD;                                    1498 06549000
*        TESTRC = RTNREG;                                          1499 06550000
         LR    TESTRC,RTNREG                                       1499 06551000
*        RESPECIFY RTNREG UNRSTD;                                  1500 06552000
*                                                                  1500 06553000
*        IF TESTRC ^= 0                                            1501 06554000
*          THEN                                                    1501 06555000
         LTR   TESTRC,TESTRC                                       1501 06556000
         BZ    @RF01501                                            1501 06557000
*            IF TESTRC = LASTCC16                                  1502 06558000
*              THEN                                                1502 06559000
         LA    @03,16                                              1502 06560000
         CR    TESTRC,@03                                          1502 06561000
         BNE   @RF01502                                            1502 06562000
*                RETURN CODE(LASTCC16);                            1503 06563000
         LR    @15,@03                                             1503 06564000
         L     @14,@SA00013                                        1503 06565000
         LM    @00,@12,@SA00013+8                                  1503 06566000
         BR    @14                                                 1503 06567000
*              ELSE                                                1504 06568000
*                RETURN CODE(LASTCC08);                            1504 06569000
@RF01502 LA    @15,8                                               1504 06570000
         L     @14,@SA00013                                        1504 06571000
         LM    @00,@12,@SA00013+8                                  1504 06572000
         BR    @14                                                 1504 06573000
*          ELSE;                                                   1505 06574000
@RF01501 DS    0H                                                  1506 06575000
*        /************************************************************/ 06576000
*        /*                                                          */ 06577000
*        /*  TEST TO DETERMINE IF THERE ARE NON VSAM                 */ 06578000
*        /*  ASSOCIATIONS PRESENT.  IF SO LOOP, DOING                */ 06579000
*        /*  LOCATES FOR THE ASSOCIATIONS, AND WRITING OUT THE       */ 06580000
*        /*  CATALOG INFORMATION TO THE PORTABILITY                  */ 06581000
*        /*  DATA SET.                                               */ 06582000
*        /*                                                          */ 06583000
*        /************************************************************/ 06584000
*        IF ASSOCFLG = ON                                          1506 06585000
*          THEN                                                    1506 06586000
         TM    ASSOCFLG,B'00000001'                                1506 06587000
         BNO   @RF01506                                            1506 06588000
*            DO;                                                   1507 06589000
*                                                                  1507 06590000
*            /********************************************************/ 06591000
*            /*                                                      */ 06592000
*            /*  CALL ASOCPROC TO PROCESS THE ASSOCIATIONS.          */ 06593000
*            /*  ASOCPROC WILL WRITE THE CONTROL RECORDS FOR NON VSAM*/ 06594000
*            /*  GENERATION DATA SETS AND THEIR ASSOCIATIONS.        */ 06595000
*            /*                                                      */ 06596000
*            /********************************************************/ 06597000
*                                                                  1508 06598000
*                                                                  1508 06599000
*            CALL  ASOCPROC(FNMPTR,NUMASSOC);                      1508 06600000
*                                                                  1508 06601000
         LA    @15,FNMPTR                                          1508 06602000
         ST    @15,@AL00001                                        1508 06603000
         LA    @15,NUMASSOC                                        1508 06604000
         ST    @15,@AL00001+4                                      1508 06605000
         LA    @01,@AL00001                                        1508 06606000
         BAL   @14,ASOCPROC                                        1508 06607000
*            RESPECIFY RTNREG RSTD;                                1509 06608000
*            TESTRC = RTNREG;                                      1510 06609000
         LR    TESTRC,RTNREG                                       1510 06610000
*            RESPECIFY RTNREG UNRSTD;                              1511 06611000
*            /********************************************************/ 06612000
*            /*                                                      */ 06613000
*            /* CHECK RETURN FROM ASOCPROC, IF RETURN CODE OF 12     */ 06614000
*            /* TERMINATE THIS REQUEST- NO CORE AVAILABLE.           */ 06615000
*            /* IF A NON VSAM ASSOCIATION OR ALIAS COULD NOT BE      */ 06616000
*            /* PROCESSED THEN A MESSAGE HAS BEEN PRINTED TO         */ 06617000
*            /* INDICATE THE FAILURE                                 */ 06618000
*            /*                                                      */ 06619000
*            /********************************************************/ 06620000
*                                                                  1512 06621000
*                                                                  1512 06622000
*            IF TESTRC = LASTCC16                                  1512 06623000
*              THEN                                                1512 06624000
         LA    @03,16                                              1512 06625000
         CR    TESTRC,@03                                          1512 06626000
         BNE   @RF01512                                            1512 06627000
*                RETURN CODE(LASTCC16);                            1513 06628000
         LR    @15,@03                                             1513 06629000
         L     @14,@SA00013                                        1513 06630000
         LM    @00,@12,@SA00013+8                                  1513 06631000
         BR    @14                                                 1513 06632000
*            END;                                                  1514 06633000
*          ELSE;                                                   1515 06634000
*                                                                  1515 06635000
@RF01506 DS    0H                                                  1516 06636000
*        /************************************************************/ 06637000
*        /*                                                          */ 06638000
*        /*CALL SAVEPROC TO WRITE THE CONTROL AND CATALOG RECORDS    */ 06639000
*        /*FOR THIS GENERATION DATA GROUP TO THE PORTABILITY DATA SET*/ 06640000
*        /*                                                          */ 06641000
*        /************************************************************/ 06642000
*                                                                  1516 06643000
*        CALL  SAVEPROC(NULLPARM,NULLPARM,'W');                    1516 06644000
*                                                                  1516 06645000
@RC01506 LA    @01,@AL01516                                        1516 06646000
         BAL   @14,SAVEPROC                                        1516 06647000
*        RESPECIFY RTNREG RSTD;                                    1517 06648000
*        TESTRC = RTNREG;                                          1518 06649000
         LR    TESTRC,RTNREG                                       1518 06650000
*        RESPECIFY RTNREG UNRSTD;                                  1519 06651000
*        IF TESTRC ^= 0                                            1520 06652000
*          THEN                                                    1520 06653000
         LTR   TESTRC,TESTRC                                       1520 06654000
         BZ    @RF01520                                            1520 06655000
*            RETURN CODE(LASTCC16);                                1521 06656000
*                                                                  1521 06657000
*                                                                  1521 06658000
         LA    @15,16                                              1521 06659000
         L     @14,@SA00013                                        1521 06660000
         LM    @00,@12,@SA00013+8                                  1521 06661000
         BR    @14                                                 1521 06662000
*        /************************************************************/ 06663000
*        /*                                                          */ 06664000
*        /*CALL PUTPROC TO WRITE THE SOFTWARE END OF FILE TO THE     */ 06665000
*        /* PORTABILITY DATA SET                                     */ 06666000
*        /*                                                          */ 06667000
*        /************************************************************/ 06668000
*                                                                  1522 06669000
*        CALL  PUTPROC(NULLPARM,NULLPARM);                         1522 06670000
*                                                                  1522 06671000
@RF01520 LA    @01,@AL01522                                        1522 06672000
         BAL   @14,PUTPROC                                         1522 06673000
*        RESPECIFY RTNREG RSTD;                                    1523 06674000
*        TESTRC = RTNREG;                                          1524 06675000
         LR    TESTRC,RTNREG                                       1524 06676000
*        RESPECIFY RTNREG UNRSTD;                                  1525 06677000
*        IF TESTRC ^= 0                                            1526 06678000
*          THEN                                                    1526 06679000
         LTR   TESTRC,TESTRC                                       1526 06680000
         BZ    @RF01526                                            1526 06681000
*            RETURN CODE(LASTCC16);                                1527 06682000
*                                                                  1527 06683000
*                                                                  1527 06684000
         LA    @15,16                                              1527 06685000
         L     @14,@SA00013                                        1527 06686000
         LM    @00,@12,@SA00013+8                                  1527 06687000
         BR    @14                                                 1527 06688000
*        /************************************************************/ 06689000
*        /*                                                          */ 06690000
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */ 06691000
*        /*   IF PROCESSING FOR ASSOCIATIONS AND ALIAS'S INCOMPLETE  */ 06692000
*        /*   THEN ERROR FLAG HAS BEEN SET                           */ 06693000
*        /*                                                          */ 06694000
*        /************************************************************/ 06695000
*                                                                  1528 06696000
*        RETURN CODE(0);                                           1528 06697000
*                                                                  1528 06698000
@RF01526 SLR   @15,@15                                             1528 06699000
         L     @14,@SA00013                                        1528 06700000
         LM    @00,@12,@SA00013+8                                  1528 06701000
         BR    @14                                                 1528 06702000
*END  GDGPROC;                                                     1529 06703000
*                                                                  1530 06704000
*        /************************************************************/ 06705000
*        /*                                                          */ 06706000
*        /*  PROCEDURE NAME - ASOCPROC                               */ 06707000
*        /*                                                          */ 06708000
*        /*  FUNCTION - OBTAINS CATALOG INFORMATION ABOUT            */ 06709000
*        /*  THE OBJECT BEING EXPORTED AND ANY ALIAS'S DEFINED       */ 06710000
*        /*  OVER IT.  BUILDS CONTROL  RECORDS, AND                  */ 06711000
*        /*  WRITES OUT THE HEADER RECORDS OF THE                    */ 06712000
*        /*  PORTABILITY DATA SET.  CALLS LOWER LEVEL                */ 06713000
*        /*  PROCEDURES TO WRITE THE CATALOG RECORDS OF THE DATA     */ 06714000
*        /*  SET BEING EXPORTED TO THE PORTABILITY DATA              */ 06715000
*        /*  SET.                                                    */ 06716000
*        /*                                                          */ 06717000
*        /*  INPUT - POINTER TO NAMEDS FPL FOR ASSOCIATIONS AND      */ 06718000
*        /*          THE NUMBER OF ASSOCIATIONS TO PROCESS.          */ 06719000
*        /*                                                          */ 06720000
*        /*  OUTPUT - CATALOG INFORMATION FOR GENERATION DATA SETS   */ 06721000
*        /*           AND THEIR ALIAS'S WRITTEN TO THE PORTABILITY   */ 06722000
*        /*           DATA SET.                                      */ 06723000
*        /*                                                          */ 06724000
*        /************************************************************/ 06725000
*                                                                  1530 06726000
*ASOCPROC: PROCEDURE(PFLNMDS,          /* NAMEDS FIELD POINTER       */ 06727000
*                    NUMASOC);         /* NUMBER OF FIELDS IN NAMEDS */ 06728000
*                                                                  1530 06729000
ASOCPROC STM   @14,@12,@SA00014                                    1530 06730000
         MVC   @PC00014(8),0(@01)                                  1530 06731000
*        /************************************************************/ 06732000
*        /*                                                          */ 06733000
*        /*    ARGUMENTS OF INVOCATION                               */ 06734000
*        /*                                                          */ 06735000
*        /************************************************************/ 06736000
*                                                                  1531 06737000
*                                                                  1531 06738000
*        DCL PFLNMDS PTR(31);          /* NAMEDS REPEATING FIELD     */ 06739000
*                                                                  1531 06740000
*                                                                  1531 06741000
*        DCL NUMASOC FIXED(15);        /* NUMBER OF ASSOCIATIONS     */ 06742000
*                                      /* IN NAMEDS FIELD            */ 06743000
*        /* ASSOCIATION FIELD RETURNED BY CATALOG                    */ 06744000
*        DCL 1  ANAMEDS  CHAR(4)  BDY(WORD)  BASED(PFLNMDS), /*      */ 06745000
*                                      /*  NAMEDS STRUCTURE          */ 06746000
*               2 ATYPE  CHAR(1),      /* ENTRY TYPE                 */ 06747000
*               2 ANAME  CHAR(3);      /* ENTRY NAME                 */ 06748000
*                                                                  1533 06749000
*                                                                  1533 06750000
*        OLDERID2 = NEWERID2;                                      1534 06751000
         L     @15,@PC00001                                        1534 06752000
         L     @14,GDTTR2(,@15)                                    1534 06753000
         MVC   @TS00001(95),NEWERID2(@14)                          1534 06754000
         MVC   OLDERID2(95,@14),@TS00001                           1534 06755000
*        NEWID2 = 'RC39';                                          1535 06756000
*                                                                  1535 06757000
         MVC   NEWID2(4,@14),@CC01261                              1535 06758000
*          IF GDTDBG = NULLPTR                                     1536 06759000
*            THEN;                                                 1536 06760000
         L     @15,GDTDBG(,@15)                                    1536 06761000
         LTR   @15,@15                                             1536 06762000
         BZ    @RT01536                                            1536 06763000
*            ELSE                                                  1538 06764000
*              CALL IDCDB010 (GDTTBL,'RC40');                      1538 06765000
*                                                                  1538 06766000
*                                                                  1538 06767000
         L     @15,@PC00001                                        1538 06768000
         ST    @15,@AL00001                                        1538 06769000
         LA    @14,@CC01262                                        1538 06770000
         ST    @14,@AL00001+4                                      1538 06771000
         MVI   @AL00001+4,X'80'                                    1538 06772000
         L     @15,GDTDBG(,@15)                                    1538 06773000
         LA    @01,@AL00001                                        1538 06774000
         BALR  @14,@15                                             1538 06775000
*          /**********************************************************/ 06776000
*          /*                                                        */ 06777000
*          /* SET FLAG TO INDICATE PROCESSING FIRST ASSOCIATION      */ 06778000
*          /*                                                        */ 06779000
*          /**********************************************************/ 06780000
*                                                                  1539 06781000
*          FRSTASOC = ON;                                          1539 06782000
*                                                                  1539 06783000
@RT01536 OI    FRSTASOC,B'10000000'                                1539 06784000
*          /**********************************************************/ 06785000
*          /*                                                        */ 06786000
*          /* LOOP ON NUMBER OF ASSOCIATIONS TO PROCESS              */ 06787000
*          /*                                                        */ 06788000
*          /**********************************************************/ 06789000
*                                                                  1540 06790000
*ASOCLP:   DO I = 1 TO NUMASOC;                                    1540 06791000
*                                                                  1540 06792000
ASOCLP   LA    I,1                                                 1540 06793000
         B     @DE01540                                            1540 06794000
@DL01540 DS    0H                                                  1541 06795000
*            /********************************************************/ 06796000
*            /*                                                      */ 06797000
*            /* SET NUMBER OF FIELDS FOR CATALOG LOCATE              */ 06798000
*            /*                                                      */ 06799000
*            /********************************************************/ 06800000
*                                                                  1541 06801000
*            CNUM = ( DIM (NVSMFLST) -1 );                         1541 06802000
         MVI   CNUM,X'09'                                          1541 06803000
*            ONUM = ( DIM (NVSMFLST) -2 );                         1542 06804000
*                                                                  1542 06805000
         MVI   ONUM,X'08'                                          1542 06806000
*            NUMALS = 0;               /* RESET NUMBER OF ALIAS'S    */ 06807000
*                                                                  1543 06808000
         SLR   NUMALS,NUMALS                                       1543 06809000
*            /********************************************************/ 06810000
*            /*                                                      */ 06811000
*            /*    TEST TO DETERMINE IF THE ASSOCIATED               */ 06812000
*            /*    OBJECT IS A GENERATION DATA SET.                  */ 06813000
*            /*                                                      */ 06814000
*            /********************************************************/ 06815000
*                                                                  1544 06816000
*            IF ATYPE = CTGTALIN                                   1544 06817000
*              THEN                                                1544 06818000
         L     @15,@PC00014                                        1544 06819000
         L     @01,PFLNMDS(,@15)                                   1544 06820000
         CLI   ATYPE(@01),C'A'                                     1544 06821000
         BNE   @RF01544                                            1544 06822000
*ASOCREC:        DO;                                               1545 06823000
ASOCREC  DS    0H                                                  1546 06824000
*                IF FRSTASOC = ON                                  1546 06825000
*                  THEN                                            1546 06826000
         TM    FRSTASOC,B'10000000'                                1546 06827000
         BNO   @RF01546                                            1546 06828000
*FRSTASC:            DO;                                           1547 06829000
*                                                                  1547 06830000
FRSTASC  DS    0H                                                  1548 06831000
*                    FRSTASOC = OFF;                               1548 06832000
*                                                                  1548 06833000
         NI    FRSTASOC,B'01111111'                                1548 06834000
*                    /************************************************/ 06835000
*                    /*                                              */ 06836000
*                    /*  IF THIS IS THE FIRST ASSOCIATION TO BE      */ 06837000
*                    /*  PROCESSED CALL LOCPROC TO BUILD             */ 06838000
*                    /*  THE CPL AND FPL'S.                          */ 06839000
*                    /*                                              */ 06840000
*                    /************************************************/ 06841000
*                                                                  1549 06842000
*                    CALL LOCPROC(ANAME,PTRCTACB,                  1549 06843000
*                       NVSMFLST,CNUM,PTRCPL(ASCCPLNO));           1549 06844000
*                                                                  1549 06845000
         L     @15,@PC00014                                        1549 06846000
         L     @01,PFLNMDS(,@15)                                   1549 06847000
         LA    @15,ANAME(,@01)                                     1549 06848000
         ST    @15,@AL00001                                        1549 06849000
         LA    @15,PTRCTACB                                        1549 06850000
         ST    @15,@AL00001+4                                      1549 06851000
         LA    @15,NVSMFLST                                        1549 06852000
         ST    @15,@AL00001+8                                      1549 06853000
         LA    @15,CNUM                                            1549 06854000
         ST    @15,@AL00001+12                                     1549 06855000
         LA    @15,PTRCPL+4                                        1549 06856000
         ST    @15,@AL00001+16                                     1549 06857000
         LA    @01,@AL00001                                        1549 06858000
         BAL   @14,LOCPROC                                         1549 06859000
*                    RESPECIFY RTNREG RSTD;                        1550 06860000
*                    TESTRC = RTNREG;                              1551 06861000
         LR    TESTRC,RTNREG                                       1551 06862000
*                    RESPECIFY RTNREG UNRSTD;                      1552 06863000
*                                                                  1552 06864000
*                    IF TESTRC ^= 0                                1553 06865000
*                      THEN                                        1553 06866000
         LTR   TESTRC,TESTRC                                       1553 06867000
         BZ    @RF01553                                            1553 06868000
*                        RETURN CODE(LASTCC16);                    1554 06869000
*                                                                  1554 06870000
         LA    @15,16                                              1554 06871000
         L     @14,@SA00014                                        1554 06872000
         LM    @00,@12,@SA00014+8                                  1554 06873000
         BR    @14                                                 1554 06874000
*                    /************************************************/ 06875000
*                    /*                                              */ 06876000
*                    /*  SAVE THE CPL AND FPL'S JUST                 */ 06877000
*                    /*  CONSTRUCTED FOR USE WITH OTHER              */ 06878000
*                    /*  ASSOCIATIONS                                */ 06879000
*                    /*                                              */ 06880000
*                    /************************************************/ 06881000
*                                                                  1555 06882000
*                    SAPLASC = LENGTH(SAVEPL2);                    1555 06883000
*                                                                  1555 06884000
@RF01553 MVC   SAPLASC(2),@CH01287                                 1555 06885000
*                    CALL MVDAPROC(SAPLASC,PTRCPL(ASCCPLNO),       1556 06886000
*                      ADDR(SAVEPL2),NULLPARM);                    1556 06887000
*                                                                  1556 06888000
         LA    @15,SAPLASC                                         1556 06889000
         ST    @15,@AL00001                                        1556 06890000
         LA    @15,PTRCPL+4                                        1556 06891000
         ST    @15,@AL00001+4                                      1556 06892000
         LA    @15,SAVEPL2                                         1556 06893000
         ST    @15,@AFTEMPS+12                                     1556 06894000
         LA    @15,@AFTEMPS+12                                     1556 06895000
         ST    @15,@AL00001+8                                      1556 06896000
         LA    @15,NULLPARM                                        1556 06897000
         ST    @15,@AL00001+12                                     1556 06898000
         LA    @01,@AL00001                                        1556 06899000
         BAL   @14,MVDAPROC                                        1556 06900000
*                    /************************************************/ 06901000
*                    /*                                              */ 06902000
*                    /*  CALL CTLGPROC TO ISSUE A UCATLG             */ 06903000
*                    /*  TO DO THE ACTUAL LOCATE.                    */ 06904000
*                    /*                                              */ 06905000
*                    /************************************************/ 06906000
*                                                                  1557 06907000
*                    CALL CTLGPROC(PTRCPL(ASCCPLNO));              1557 06908000
*                                                                  1557 06909000
         LA    @15,PTRCPL+4                                        1557 06910000
         ST    @15,@AL00001                                        1557 06911000
         LA    @01,@AL00001                                        1557 06912000
         BAL   @14,CTLGPROC                                        1557 06913000
*                    RESPECIFY RTNREG RSTD;                        1558 06914000
*                    TESTRC = RTNREG;                              1559 06915000
         LR    TESTRC,RTNREG                                       1559 06916000
*                    RESPECIFY RTNREG UNRSTD;                      1560 06917000
*                                                                  1560 06918000
*                    IF TESTRC ^= 0                                1561 06919000
*                      THEN                                        1561 06920000
         LTR   TESTRC,TESTRC                                       1561 06921000
         BZ    @RF01561                                            1561 06922000
*                        DO;                                       1562 06923000
*                        /********************************************/ 06924000
*                        /*                                          */ 06925000
*                        /* IF SEVERE ERROR RETURNS WITH TERMINATION */ 06926000
*                        /* CODE ELSE THIS ASSOCIATION IS BYPASSED   */ 06927000
*                        /* AND PROCESSING CONTINUES AFTER PRINTING  */ 06928000
*                        /* WARNING MESSAGE AND SETTING ERROR FLAG   */ 06929000
*                        /*                                          */ 06930000
*                        /********************************************/ 06931000
*                        IF TESTRC = LASTCC16                      1563 06932000
*                          THEN                                    1563 06933000
         LA    @04,16                                              1563 06934000
         CR    TESTRC,@04                                          1563 06935000
         BNE   @RF01563                                            1563 06936000
*                            RETURN CODE(LASTCC16);                1564 06937000
         LR    @15,@04                                             1564 06938000
         L     @14,@SA00014                                        1564 06939000
         LM    @00,@12,@SA00014+8                                  1564 06940000
         BR    @14                                                 1564 06941000
*                          ELSE                                    1565 06942000
*                            DO;                                   1565 06943000
@RF01563 DS    0H                                                  1566 06944000
*                            ERRSAVFL = ON;                        1566 06945000
*                                                                  1566 06946000
         OI    ERRSAVFL,B'00100000'                                1566 06947000
*                            CALL  PRNTPROC(WARNMSG1,GDGCPLMG);    1567 06948000
*                                                                  1567 06949000
         LA    @01,@AL01567                                        1567 06950000
         BAL   @14,PRNTPROC                                        1567 06951000
*                            END;                                  1568 06952000
*                        END;                                      1569 06953000
*                                                                  1569 06954000
*                                                                  1569 06955000
*                                                                  1569 06956000
*                      ELSE                                        1570 06957000
*WRITEFST:               DO;                                       1570 06958000
         B     @RC01561                                            1570 06959000
@RF01561 DS    0H                                                  1570 06960000
WRITEFST DS    0H                                                  1571 06961000
*                        /********************************************/ 06962000
*                        /*                                          */ 06963000
*                        /* CHECK FOR ALIAS'S FOR THIS GENERATION    */ 06964000
*                        /* DATA SET. IF ANY, SET POINTER TO NAMEDS  */ 06965000
*                        /* FPL AND NUMBER OF ALIAS'S TO PROCESS.    */ 06966000
*                        /*                                          */ 06967000
*                        /********************************************/ 06968000
*                                                                  1571 06969000
*                        CTGFLPTR = CTGFIELD(NNAMEDS);             1571 06970000
         L     @01,CTGPLPTR                                        1571 06971000
         L     CTGFLPTR,CTGFIELD+32(,@01)                          1571 06972000
*                        IF CTGFLNG(1) = 0                         1572 06973000
*                          THEN                                    1572 06974000
         L     @03,CTGFLNG(,CTGFLPTR)                              1572 06975000
         LTR   @03,@03                                             1572 06976000
         BNZ   @RF01572                                            1572 06977000
*                            DO;                                   1573 06978000
*                            /****************************************/ 06979000
*                            /*                                      */ 06980000
*                            /* ERROR -- NO ASSOCIATION TO GDG       */ 06981000
*                            /*                                      */ 06982000
*                            /****************************************/ 06983000
*                                                                  1574 06984000
*                            ERRSAVFL = ON;                        1574 06985000
*                                                                  1574 06986000
         OI    ERRSAVFL,B'00100000'                                1574 06987000
*                            CALL  PRNTPROC(WARNMSG2,GDGCPLMG);    1575 06988000
*                                                                  1575 06989000
         LA    @01,@AL01575                                        1575 06990000
         BAL   @14,PRNTPROC                                        1575 06991000
*                            END;                                  1576 06992000
*                                                                  1576 06993000
*                          ELSE                                    1577 06994000
*                            DO;                                   1577 06995000
         B     @RC01572                                            1577 06996000
@RF01572 DS    0H                                                  1578 06997000
*                            NUMALS = CTGFLNG(1) / LNAMEDS;        1578 06998000
         L     @00,CTGFLNG(,CTGFLPTR)                              1578 06999000
         SRDA  @00,32                                              1578 07000000
         D     @00,@CF00041                                        1578 07001000
         LR    NUMALS,@01                                          1578 07002000
*                            AFNMPTR = CTGFLPT(1);                 1579 07003000
         L     @03,CTGFLPT(,CTGFLPTR)                              1579 07004000
         ST    @03,AFNMPTR                                         1579 07005000
*                            /****************************************/ 07006000
*                            /*                                      */ 07007000
*                            /* CALL CONTRBL TO BUILD THE CONTROL    */ 07008000
*                            /* RECORD FOR THE CURRENT ASSOCIATION   */ 07009000
*                            /* AND TO WRITE IT AND THE CATALOG WORK */ 07010000
*                            /* AREA TO THE PORTABILITY DATA SET.    */ 07011000
*                            /*                                      */ 07012000
*                            /****************************************/ 07013000
*                                                                  1580 07014000
*                            CALL CONTRBL(ASCCPLNO,'N');           1580 07015000
*                                                                  1580 07016000
         LA    @01,@AL01580                                        1580 07017000
         BAL   @14,CONTRBL                                         1580 07018000
*                            RESPECIFY RTNREG RSTD;                1581 07019000
*                            TESTRC = RTNREG;                      1582 07020000
         LR    TESTRC,RTNREG                                       1582 07021000
*                            RESPECIFY RTNREG UNRSTD;              1583 07022000
*                                                                  1583 07023000
*                            IF TESTRC ^= 0                        1584 07024000
*                              THEN                                1584 07025000
         LTR   TESTRC,TESTRC                                       1584 07026000
         BZ    @RF01584                                            1584 07027000
*                                DO;                               1585 07028000
*                                /************************************/ 07029000
*                                /*                                  */ 07030000
*                                /* IF SEVERE ERROR RETURNS WITH     */ 07031000
*                                /* TERMINATION CODE ELSE BYPASSES   */ 07032000
*                                /* THIS ASSOCIATION AND PRINTS      */ 07033000
*                                /* WARNING MESSAGE.                 */ 07034000
*                                /*                                  */ 07035000
*                                /************************************/ 07036000
*                                                                  1586 07037000
*                                IF TESTRC = LASTCC16              1586 07038000
*                                  THEN                            1586 07039000
         LA    @04,16                                              1586 07040000
         CR    TESTRC,@04                                          1586 07041000
         BNE   @RF01586                                            1586 07042000
*                                    RETURN CODE(LASTCC16);        1587 07043000
         LR    @15,@04                                             1587 07044000
         L     @14,@SA00014                                        1587 07045000
         LM    @00,@12,@SA00014+8                                  1587 07046000
         BR    @14                                                 1587 07047000
*                                  ELSE                            1588 07048000
*                                    DO;                           1588 07049000
*                                                                  1588 07050000
@RF01586 DS    0H                                                  1589 07051000
*                                    ERRSAVFL = ON;                1589 07052000
*                                                                  1589 07053000
         OI    ERRSAVFL,B'00100000'                                1589 07054000
*                                    CALL  PRNTPROC(WARNMSG1,GDGCPLMG); 07055000
*                                                                  1590 07056000
         LA    @01,@AL01590                                        1590 07057000
         BAL   @14,PRNTPROC                                        1590 07058000
*                                    END;                          1591 07059000
*                                END;                              1592 07060000
*                            END;                                  1593 07061000
*                        END WRITEFST;                             1594 07062000
*                    END FRSTASC;                                  1595 07063000
*                  ELSE                                            1596 07064000
*NFRSTASC:           DO;                                           1596 07065000
         B     @RC01546                                            1596 07066000
@RF01546 DS    0H                                                  1596 07067000
NFRSTASC DS    0H                                                  1597 07068000
*                    /************************************************/ 07069000
*                    /*                                              */ 07070000
*                    /*THIS IS NOT THE FIRST ASSOCIATION TO BE       */ 07071000
*                    /*PROCESSED RESTORE THE CPL AND FPL'S MODIFY    */ 07072000
*                    /*THE CPL TO DO A LOCATE ON THE APPROPRIATE     */ 07073000
*                    /*ASSOCIATION                                   */ 07074000
*                    /*                                              */ 07075000
*                    /************************************************/ 07076000
*                                                                  1597 07077000
*                    CTGPLPTR = PTRCPL(ASCCPLNO);                  1597 07078000
*                                                                  1597 07079000
         L     @15,PTRCPL+4                                        1597 07080000
         ST    @15,CTGPLPTR                                        1597 07081000
*                    CALL MVDAPROC(SAPLASC,ADDR(SAVEPL2),          1598 07082000
*                      PTRCPL(ASCCPLNO),NULLPARM);                 1598 07083000
*                                                                  1598 07084000
         LA    @15,SAPLASC                                         1598 07085000
         ST    @15,@AL00001                                        1598 07086000
         LA    @15,SAVEPL2                                         1598 07087000
         ST    @15,@AFTEMPS+12                                     1598 07088000
         LA    @15,@AFTEMPS+12                                     1598 07089000
         ST    @15,@AL00001+4                                      1598 07090000
         LA    @15,PTRCPL+4                                        1598 07091000
         ST    @15,@AL00001+8                                      1598 07092000
         LA    @15,NULLPARM                                        1598 07093000
         ST    @15,@AL00001+12                                     1598 07094000
         LA    @01,@AL00001                                        1598 07095000
         BAL   @14,MVDAPROC                                        1598 07096000
*                    CALL MVDAPROC(WKAREALN+LENGTH(PATHREL),       1599 07097000
*                      NULLPARM,CTGWKA,SETZERO);                   1599 07098000
*                                                                  1599 07099000
         MVC   @AL00001(16),@AL01599                               1599 07100000
         L     @01,CTGPLPTR                                        1599 07101000
         LA    @15,CTGWKA(,@01)                                    1599 07102000
         ST    @15,@AL00001+8                                      1599 07103000
         LA    @01,@AL00001                                        1599 07104000
         BAL   @14,MVDAPROC                                        1599 07105000
*                    AREALN = WKAREALN;                            1600 07106000
         L     @15,CTGPLPTR                                        1600 07107000
         L     @01,CTGWKA(,@15)                                    1600 07108000
         MVC   AREALN(2,@01),@CH00812                              1600 07109000
*                    CTGENT = ADDR(ANAME);                         1601 07110000
*                                                                  1601 07111000
         L     @14,@PC00014                                        1601 07112000
         L     @01,PFLNMDS(,@14)                                   1601 07113000
         LA    @14,ANAME(,@01)                                     1601 07114000
         ST    @14,CTGENT(,@15)                                    1601 07115000
*                    /************************************************/ 07116000
*                    /*                                              */ 07117000
*                    /*CLEAR THE FPL POINTERS SET BY PREVIOUS LOCATE */ 07118000
*                    /*                                              */ 07119000
*                    /************************************************/ 07120000
*                                                                  1602 07121000
*                    DO CLRFDCTR = 1 TO CNUM;                      1602 07122000
         LA    CLRFDCTR,1                                          1602 07123000
         B     @DE01602                                            1602 07124000
@DL01602 DS    0H                                                  1603 07125000
*                      CTGFLPTR = CTGFIELD(CLRFDCTR);              1603 07126000
         LR    @15,CLRFDCTR                                        1603 07127000
         SLA   @15,2                                               1603 07128000
         L     @01,CTGPLPTR                                        1603 07129000
         L     CTGFLPTR,CTGFIELD-4(@15,@01)                        1603 07130000
*                      CTGFLNG(1) = 0;                             1604 07131000
         SLR   @15,@15                                             1604 07132000
         ST    @15,CTGFLNG(,CTGFLPTR)                              1604 07133000
*                      CTGFLPT(1) = NULLPTR;                       1605 07134000
         ST    @15,CTGFLPT(,CTGFLPTR)                              1605 07135000
*                    END;                                          1606 07136000
*                                                                  1606 07137000
         AL    CLRFDCTR,@CF00218                                   1606 07138000
@DE01602 SLR   @02,@02                                             1606 07139000
         IC    @02,CNUM                                            1606 07140000
         CR    CLRFDCTR,@02                                        1606 07141000
         BNH   @DL01602                                            1606 07142000
*                    /************************************************/ 07143000
*                    /*                                              */ 07144000
*                    /* CALL CTLGPROC TO ISSUE A UCATLG TO DO LOCATE */ 07145000
*                    /*                                              */ 07146000
*                    /************************************************/ 07147000
*                                                                  1607 07148000
*                    CALL CTLGPROC(PTRCPL(ASCCPLNO));              1607 07149000
*                                                                  1607 07150000
         LA    @15,PTRCPL+4                                        1607 07151000
         ST    @15,@AL00001                                        1607 07152000
         LA    @01,@AL00001                                        1607 07153000
         BAL   @14,CTLGPROC                                        1607 07154000
*                    RESPECIFY RTNREG RSTD;                        1608 07155000
*                    TESTRC = RTNREG;                              1609 07156000
         LR    TESTRC,RTNREG                                       1609 07157000
*                    RESPECIFY RTNREG UNRSTD;                      1610 07158000
*                                                                  1610 07159000
*                    IF TESTRC ^= 0                                1611 07160000
*                      THEN                                        1611 07161000
         LTR   TESTRC,TESTRC                                       1611 07162000
         BZ    @RF01611                                            1611 07163000
*                        DO;                                       1612 07164000
*                        /********************************************/ 07165000
*                        /*                                          */ 07166000
*                        /*IF SEVERE ERROR RETURNS WITH TERMINATION  */ 07167000
*                        /*ELSE BYPASSES THIS ASSOCIATION AND PRINTS */ 07168000
*                        /*MESSAGE TO INDICATE THE ERROR             */ 07169000
*                        /*                                          */ 07170000
*                        /********************************************/ 07171000
*                        IF TESTRC = LASTCC16                      1613 07172000
*                          THEN                                    1613 07173000
         LA    @04,16                                              1613 07174000
         CR    TESTRC,@04                                          1613 07175000
         BNE   @RF01613                                            1613 07176000
*                            RETURN CODE(LASTCC16);                1614 07177000
         LR    @15,@04                                             1614 07178000
         L     @14,@SA00014                                        1614 07179000
         LM    @00,@12,@SA00014+8                                  1614 07180000
         BR    @14                                                 1614 07181000
*                          ELSE                                    1615 07182000
*                            DO;                                   1615 07183000
@RF01613 DS    0H                                                  1616 07184000
*                            ERRSAVFL = ON;                        1616 07185000
*                                                                  1616 07186000
         OI    ERRSAVFL,B'00100000'                                1616 07187000
*                            CALL  PRNTPROC(WARNMSG1,GDGCPLMG);    1617 07188000
*                                                                  1617 07189000
         LA    @01,@AL01617                                        1617 07190000
         BAL   @14,PRNTPROC                                        1617 07191000
*                            END;                                  1618 07192000
*                        END;                                      1619 07193000
*                      ELSE                                        1620 07194000
*WRITEOTH:               DO;                                       1620 07195000
         B     @RC01611                                            1620 07196000
@RF01611 DS    0H                                                  1620 07197000
WRITEOTH DS    0H                                                  1621 07198000
*                        /********************************************/ 07199000
*                        /*                                          */ 07200000
*                        /*  CHECK FOR ALIAS'S FOR THIS GENERATION   */ 07201000
*                        /*  DATA SET. IF ANY, SET POINTER TO        */ 07202000
*                        /*  NAMEDS FPL AND NUMBER OF ALIAS'S        */ 07203000
*                        /*                                          */ 07204000
*                        /********************************************/ 07205000
*                                                                  1621 07206000
*                        CTGFLPTR = CTGFIELD(NNAMEDS);             1621 07207000
         L     @01,CTGPLPTR                                        1621 07208000
         L     CTGFLPTR,CTGFIELD+32(,@01)                          1621 07209000
*                        IF CTGFLNG(1) = 0                         1622 07210000
*                        THEN                                      1622 07211000
         L     @03,CTGFLNG(,CTGFLPTR)                              1622 07212000
         LTR   @03,@03                                             1622 07213000
         BNZ   @RF01622                                            1622 07214000
*                          DO;                                     1623 07215000
*                          /******************************************/ 07216000
*                          /*                                        */ 07217000
*                          /* ERROR  -- NO ASSOCIATION TO GDG        */ 07218000
*                          /*                                        */ 07219000
*                          /******************************************/ 07220000
*                                                                  1624 07221000
*                          ERRSAVFL = ON;                          1624 07222000
*                                                                  1624 07223000
         OI    ERRSAVFL,B'00100000'                                1624 07224000
*                          CALL  PRNTPROC(WARNMSG2,GDGCPLMG);      1625 07225000
*                                                                  1625 07226000
         LA    @01,@AL01625                                        1625 07227000
         BAL   @14,PRNTPROC                                        1625 07228000
*                          END;                                    1626 07229000
*                                                                  1626 07230000
*                        ELSE                                      1627 07231000
*                          DO;                                     1627 07232000
*                                                                  1627 07233000
         B     @RC01622                                            1627 07234000
@RF01622 DS    0H                                                  1628 07235000
*                          NUMALS = CTGFLNG(1) / LNAMEDS;          1628 07236000
         L     @00,CTGFLNG(,CTGFLPTR)                              1628 07237000
         SRDA  @00,32                                              1628 07238000
         D     @00,@CF00041                                        1628 07239000
         LR    NUMALS,@01                                          1628 07240000
*                          AFNMPTR = CTGFLPT(1);                   1629 07241000
*                                                                  1629 07242000
         L     @03,CTGFLPT(,CTGFLPTR)                              1629 07243000
         ST    @03,AFNMPTR                                         1629 07244000
*                          /******************************************/ 07245000
*                          /*                                        */ 07246000
*                          /*CALL CONTRBL TO BUILD THE CONTROL       */ 07247000
*                          /*RECORD FOR THE CURRENT ASSOCIATION AND  */ 07248000
*                          /*TO WRITE IT AND THE CATALOG WORK        */ 07249000
*                          /*AREA TO THE PORTABILITY DATA SET        */ 07250000
*                          /*                                        */ 07251000
*                          /******************************************/ 07252000
*                                                                  1630 07253000
*                          CALL CONTRBL(ASCCPLNO,'N');             1630 07254000
*                                                                  1630 07255000
         LA    @01,@AL01630                                        1630 07256000
         BAL   @14,CONTRBL                                         1630 07257000
*                          RESPECIFY RTNREG RSTD;                  1631 07258000
*                          TESTRC = RTNREG;                        1632 07259000
         LR    TESTRC,RTNREG                                       1632 07260000
*                          RESPECIFY RTNREG UNRSTD;                1633 07261000
*                                                                  1633 07262000
*                          IF TESTRC ^= 0                          1634 07263000
*                            THEN                                  1634 07264000
         LTR   TESTRC,TESTRC                                       1634 07265000
         BZ    @RF01634                                            1634 07266000
*                              DO;                                 1635 07267000
*                              /**************************************/ 07268000
*                              /*                                    */ 07269000
*                              /* IF SEVERE ERROR RETURNS WITH       */ 07270000
*                              /* TERMINATION CODE ELSE BYPASSES     */ 07271000
*                              /* THIS ASSOCIATION AND PRINTS WARNING*/ 07272000
*                              /* MESSAGE.                           */ 07273000
*                              /*                                    */ 07274000
*                              /**************************************/ 07275000
*                              IF TESTRC = LASTCC16                1636 07276000
*                                THEN                              1636 07277000
         LA    @04,16                                              1636 07278000
         CR    TESTRC,@04                                          1636 07279000
         BNE   @RF01636                                            1636 07280000
*                                  RETURN CODE(LASTCC16);          1637 07281000
         LR    @15,@04                                             1637 07282000
         L     @14,@SA00014                                        1637 07283000
         LM    @00,@12,@SA00014+8                                  1637 07284000
         BR    @14                                                 1637 07285000
*                                ELSE                              1638 07286000
*                                  DO;                             1638 07287000
@RF01636 DS    0H                                                  1639 07288000
*                                  ERRSAVFL = ON;                  1639 07289000
*                                                                  1639 07290000
         OI    ERRSAVFL,B'00100000'                                1639 07291000
*                                  CALL  PRNTPROC(WARNMSG1,GDGCPLMG);   07292000
*                                                                  1640 07293000
         LA    @01,@AL01640                                        1640 07294000
         BAL   @14,PRNTPROC                                        1640 07295000
*                                  END;                            1641 07296000
*                              END;                                1642 07297000
*                          END;                                    1643 07298000
@RF01634 DS    0H                                                  1644 07299000
*                        END  WRITEOTH;                            1644 07300000
@RC01622 DS    0H                                                  1645 07301000
*                    END  NFRSTASC;                                1645 07302000
@RC01611 DS    0H                                                  1646 07303000
*                /****************************************************/ 07304000
*                /*                                                  */ 07305000
*                /* CHECK IF ALIAS ASSOCIATIONS FOR THIS NON VSAM    */ 07306000
*                /*                                                  */ 07307000
*                /****************************************************/ 07308000
*                                                                  1646 07309000
*                IF NUMALS > MINASOC                               1646 07310000
*                 THEN                                             1646 07311000
@RC01546 C     NUMALS,@CF00218                                     1646 07312000
         BNH   @RF01646                                            1646 07313000
*                   DO;                                            1647 07314000
*                   /*************************************************/ 07315000
*                   /*                                               */ 07316000
*                   /* CALL ALSPROC TO PROCESS THE ALIAS'S           */ 07317000
*                   /*                                               */ 07318000
*                   /*************************************************/ 07319000
*                                                                  1648 07320000
*                   CALL  ALSPROC(AFNMPTR);                        1648 07321000
*                                                                  1648 07322000
         LA    @05,AFNMPTR                                         1648 07323000
         ST    @05,@AL00001                                        1648 07324000
         LA    @01,@AL00001                                        1648 07325000
         BAL   @14,ALSPROC                                         1648 07326000
*                   RESPECIFY RTNREG RSTD;                         1649 07327000
*                   TESTRC = RTNREG;                               1650 07328000
         LR    TESTRC,RTNREG                                       1650 07329000
*                   RESPECIFY RTNREG UNRSTD;                       1651 07330000
*                                                                  1651 07331000
*                   /*************************************************/ 07332000
*                   /*                                               */ 07333000
*                   /* CHECK RETURN CODE FROM ALSPROC                */ 07334000
*                   /* IF RETURN CODE IS TWELVE THEN TERMINATE       */ 07335000
*                   /*  THIS REQUEST -- CORE FAILURE                 */ 07336000
*                   /* IF ALIAS NOT PROCESSED THEN A FLAG HAS BEEN   */ 07337000
*                   /* SET                                           */ 07338000
*                   /*************************************************/ 07339000
*                                                                  1652 07340000
*                   IF TESTRC = LASTCC16                           1652 07341000
*                     THEN                                         1652 07342000
         LA    @05,16                                              1652 07343000
         CR    TESTRC,@05                                          1652 07344000
         BNE   @RF01652                                            1652 07345000
*                       RETURN CODE(LASTCC16);                     1653 07346000
         LR    @15,@05                                             1653 07347000
         L     @14,@SA00014                                        1653 07348000
         LM    @00,@12,@SA00014+8                                  1653 07349000
         BR    @14                                                 1653 07350000
*                   END;                                           1654 07351000
*                                                                  1654 07352000
*                                                                  1654 07353000
*                END  ASOCREC;                                     1655 07354000
*              ELSE                                                1656 07355000
*                DO;                                               1656 07356000
         B     @RC01544                                            1656 07357000
@RF01544 DS    0H                                                  1657 07358000
*                /****************************************************/ 07359000
*                /*                                                  */ 07360000
*                /* ASSOCIATION TYPE NOT GENERATION DATA SET         */ 07361000
*                /*                                                  */ 07362000
*                /****************************************************/ 07363000
*                                                                  1657 07364000
*                ERRSAVFL = ON;                                    1657 07365000
*                                                                  1657 07366000
         OI    ERRSAVFL,B'00100000'                                1657 07367000
*                CALL  PRNTPROC(WARNMSG2,GDGCPLMG);                1658 07368000
*                                                                  1658 07369000
         LA    @01,@AL01658                                        1658 07370000
         BAL   @14,PRNTPROC                                        1658 07371000
*                END;                                              1659 07372000
*                                                                  1659 07373000
*          /**********************************************************/ 07374000
*          /*                                                        */ 07375000
*          /* SET NAMEDS POINTER TO NEXT ASSOCIATION                 */ 07376000
*          /*                                                        */ 07377000
*          /**********************************************************/ 07378000
*                                                                  1660 07379000
*          PFLNMDS = PFLNMDS + LNAMEDS;                            1660 07380000
*                                                                  1660 07381000
@RC01544 L     @05,@PC00014                                        1660 07382000
         LA    @15,4                                               1660 07383000
         AL    @15,PFLNMDS(,@05)                                   1660 07384000
         ST    @15,PFLNMDS(,@05)                                   1660 07385000
*          END  ASOCLP;                                            1661 07386000
*                                                                  1661 07387000
*                                                                  1661 07388000
         AL    I,@CF00218                                          1661 07389000
@DE01540 L     @05,@PC00014+4                                      1661 07390000
         CH    I,NUMASOC(,@05)                                     1661 07391000
         BNH   @DL01540                                            1661 07392000
*        /************************************************************/ 07393000
*        /*                                                          */ 07394000
*        /* RETURN TO CALLER WITH SUCCESS INDICATED                  */ 07395000
*        /* IF ANY ASSOCIATION OR ALIAS FAILURE THEN A FLAG HAS BEEN */ 07396000
*        /* SET AND A WARNING MESSAGE PRINTED                        */ 07397000
*        /*                                                          */ 07398000
*        /************************************************************/ 07399000
*                                                                  1662 07400000
*        RETURN CODE(0);                                           1662 07401000
*                                                                  1662 07402000
         SLR   @15,@15                                             1662 07403000
         L     @14,@SA00014                                        1662 07404000
         LM    @00,@12,@SA00014+8                                  1662 07405000
         BR    @14                                                 1662 07406000
*END ASOCPROC;                                                     1663 07407000
*        /************************************************************/ 07408000
*        /*                                                          */ 07409000
*        /*  PROCEDURE NAME - PRNTPROC                               */ 07410000
*        /*                                                          */ 07411000
*        /*  FUNCTION - THIS PROCEDURE PRINTS WARNING MESSAGES       */ 07412000
*        /*             WHENEVER AN ERROR IS DETECTED WHILE          */ 07413000
*        /*             PROCESSING PATHS, ALIAS'S, AND ASSOCIATIONS  */ 07414000
*        /*             FOR GDG'S.                                   */ 07415000
*        /*                                                          */ 07416000
*        /*  INPUT - TYPE OF MESSAGE TO PRINT                        */ 07417000
*        /*          INDEX TO CPL                                    */ 07418000
*        /*                                                          */ 07419000
*        /*  OUTPUT - WARNING MESSAGE INDICATING THE ERROR           */ 07420000
*        /*                                                          */ 07421000
*        /************************************************************/ 07422000
*                                                                  1664 07423000
*PRNTPROC: PROCEDURE(PRNTMSG,          /*  MESSAGE TYPE              */ 07424000
*                    ICPL);            /*  INDEX TO CPL              */ 07425000
*                                                                  1664 07426000
PRNTPROC STM   @14,@03,@SA00015                                    1664 07427000
         STM   @05,@12,@SA00015+24                                 1664 07428000
         MVC   @PC00015(8),0(@01)                                  1664 07429000
*        /************************************************************/ 07430000
*        /*                                                          */ 07431000
*        /*  ARGUMENTS OF INVOCATION                                 */ 07432000
*        /*                                                          */ 07433000
*        /************************************************************/ 07434000
*                                                                  1665 07435000
*        DCL PRNTMSG FIXED(8);         /* MESSAGE TO PRINT           */ 07436000
*        DCL ICPL    FIXED(8);         /* CPL FOR NAME OF OBJECT     */ 07437000
*                                                                  1666 07438000
*        OLDERID2 = NEWERID2;                                      1667 07439000
         L     @03,@PC00001                                        1667 07440000
         L     @03,GDTTR2(,@03)                                    1667 07441000
         MVC   @TS00001(95),NEWERID2(@03)                          1667 07442000
         MVC   OLDERID2(95,@03),@TS00001                           1667 07443000
*        NEWID2 = 'RC42';                                          1668 07444000
*                                                                  1668 07445000
*                                                                  1668 07446000
         MVC   NEWID2(4,@03),@CC01282                              1668 07447000
*        /************************************************************/ 07448000
*        /*                                                          */ 07449000
*        /*  GET NAME OF RELATED OBJECT TO PRINT.                    */ 07450000
*        /*  IF PATH OR GDS THEN THE NAME OF RELATED OBJECT          */ 07451000
*        /*   IS OBTAINED USING THE FIRST CPL                        */ 07452000
*        /*  IF ALIAS FOR NON VSAM THEN THE SECOND CPL IS USED       */ 07453000
*        /*                                                          */ 07454000
*        /************************************************************/ 07455000
*                                                                  1669 07456000
*        CTGPLPTR = PTRCPL(ICPL);                                  1669 07457000
         L     @03,@PC00015+4                                      1669 07458000
         SLR   @15,@15                                             1669 07459000
         IC    @15,ICPL(,@03)                                      1669 07460000
         SLA   @15,2                                               1669 07461000
         L     @03,PTRCPL-4(@15)                                   1669 07462000
         ST    @03,CTGPLPTR                                        1669 07463000
*        CTGFLPTR = CTGFIELD(IENTNAME);                            1670 07464000
         L     CTGFLPTR,CTGFIELD+4(,@03)                           1670 07465000
*        RELNAME = FENTNAME;                                       1671 07466000
*                                                                  1671 07467000
         L     @03,CTGFLPT(,CTGFLPTR)                              1671 07468000
         MVC   RELNAME(44),FENTNAME(@03)                           1671 07469000
*        /************************************************************/ 07470000
*        /*                                                          */ 07471000
*        /*    SET UP UPRINT ARGUMENTS AND PRINT WARNING MESSAGE     */ 07472000
*        /*                                                          */ 07473000
*        /************************************************************/ 07474000
*                                                                  1672 07475000
*        IF PRNTMSG = WARNMSG1                                     1672 07476000
*          THEN                                                    1672 07477000
         L     @15,@PC00015                                        1672 07478000
         CLI   PRNTMSG(@15),0                                      1672 07479000
         BNE   @RF01672                                            1672 07480000
*            DARGSENT = ASOCERR;                                   1673 07481000
         L     @01,DDSTRU                                          1673 07482000
         MVI   DARGSENT(@01),X'08'                                 1673 07483000
*          ELSE                                                    1674 07484000
*            DARGSENT = NONASOC;                                   1674 07485000
*                                                                  1674 07486000
*                                                                  1674 07487000
         B     @RC01672                                            1674 07488000
@RF01672 L     @01,DDSTRU                                          1674 07489000
         MVI   DARGSENT(@01),X'09'                                 1674 07490000
*        DARGSMOD = EXPMSG;                                        1675 07491000
@RC01672 L     @15,DDSTRU                                          1675 07492000
         MVC   DARGSMOD(3,@15),@CC00834                            1675 07493000
*        DARGDBP = ADDR(RELNAME);                                  1676 07494000
         LA    @14,RELNAME                                         1676 07495000
         ST    @14,DARGDBP(,@15)                                   1676 07496000
*        DARGILP = LENGTH(RELNAME);                                1677 07497000
*                                                                  1677 07498000
         MVC   DARGILP(2,@15),@CH00907                             1677 07499000
*        CALL AMSTP011  (GDTTBL,PRTFILE,DDSTRU);                   1678 07500000
*                                                                  1678 07501000
*                                                                  1678 07502000
         L     @15,@PC00001                                        1678 07503000
         ST    @15,@AL00001                                        1678 07504000
         LA    @14,@CF00114                                        1678 07505000
         ST    @14,@AL00001+4                                      1678 07506000
         LA    @14,DDSTRU                                          1678 07507000
         ST    @14,@AL00001+8                                      1678 07508000
         MVI   @AL00001+8,X'80'                                    1678 07509000
         L     @15,GDTPRT(,@15)                                    1678 07510000
         LA    @01,@AL00001                                        1678 07511000
         BALR  @14,@15                                             1678 07512000
*        /************************************************************/ 07513000
*        /*                                                          */ 07514000
*        /*    CLEAR WORK AREA FOR UPRINT ARGUMENT LISTS             */ 07515000
*        /*                                                          */ 07516000
*        /************************************************************/ 07517000
*                                                                  1679 07518000
*        DO I = 1 TO 9;                                            1679 07519000
         LA    I,1                                                 1679 07520000
@DL01679 DS    0H                                                  1680 07521000
*          PRINTTAB(I) = NULLPTR;                                  1680 07522000
         LR    @05,I                                               1680 07523000
         SLA   @05,2                                               1680 07524000
         SLR   @15,@15                                             1680 07525000
         ST    @15,PRINTTAB-4(@05)                                 1680 07526000
*        END;                                                      1681 07527000
*                                                                  1681 07528000
         AL    I,@CF00218                                          1681 07529000
         C     I,@CF00037                                          1681 07530000
         BNH   @DL01679                                            1681 07531000
*        /************************************************************/ 07532000
*        /*                                                          */ 07533000
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */ 07534000
*        /*                                                          */ 07535000
*        /************************************************************/ 07536000
*                                                                  1682 07537000
*        RETURN CODE(0);                                           1682 07538000
*                                                                  1682 07539000
         SLR   @15,@15                                             1682 07540000
         L     @14,@SA00015                                        1682 07541000
         LM    @00,@03,@SA00015+8                                  1682 07542000
         LM    @05,@12,@SA00015+24                                 1682 07543000
         BR    @14                                                 1682 07544000
*END PRNTPROC;                                                     1683 07545000
*END IDCRC02                                                       1684 07546000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 07547000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 07548000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 07549000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 07550000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        * 07551000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        * 07552000
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        * 07553000
*/*%INCLUDE SYSLIB  (IDCDF63 )                                        * 07554000
*;                                                                 1684 07555000
@DATA    DS    0H                                                       07556000
@CH00895 DC    H'20'                                                    07557000
@CH00309 DC    H'24'                                                    07558000
@CH00907 DC    H'44'                                                    07559000
@CH01287 DC    H'588'                                                   07560000
@CH00812 DC    H'1000'                                                  07561000
@SM01316 MVC   TOAREA(0,MTPTR),ZERO                                     07562000
@SM01318 MVC   TOAREA(0,MTPTR),FROMAREA(MFPTR)                          07563000
@SC01321 CLC   FIELD(0,@14),NOTINIT                                     07564000
@SC01323 CLC   FIELD(0,@15),NOTINIT                                     07565000
         DS    0F                                                       07566000
@AL00285 DC    A(@CF00178)             LIST WITH   4 ARGUMENT(S)        07567000
         DS    F                                                        07568000
         DC    A(GPID)                                                  07569000
         DC    AL1(X'80')                                               07570000
         DC    AL3(SETZERO)                                             07571000
@AL00469 EQU   *                       LIST WITH   4 ARGUMENT(S)        07572000
@AL01165 EQU   *                       LIST WITH   4 ARGUMENT(S)        07573000
@AL01471 DC    A(@CF01285)             LIST WITH   4 ARGUMENT(S)        07574000
         DS    F                                                        07575000
         DC    A(GPID)                                                  07576000
         DC    AL1(X'80')                                               07577000
         DC    AL3(SETZERO)                                             07578000
@AL00556 EQU   *                       LIST WITH   2 ARGUMENT(S)        07579000
@AL00570 EQU   *                       LIST WITH   2 ARGUMENT(S)        07580000
@AL00596 EQU   *                       LIST WITH   2 ARGUMENT(S)        07581000
@AL00610 EQU   *                       LIST WITH   2 ARGUMENT(S)        07582000
@AL01567 EQU   *                       LIST WITH   2 ARGUMENT(S)        07583000
@AL01590 EQU   *                       LIST WITH   2 ARGUMENT(S)        07584000
@AL01617 EQU   *                       LIST WITH   2 ARGUMENT(S)        07585000
@AL01640 DC    A(@CF00114+3)           LIST WITH   2 ARGUMENT(S)        07586000
         DC    A(@CF00218+3)                                            07587000
@AL00560 EQU   *                       LIST WITH   2 ARGUMENT(S)        07588000
@AL00600 DC    A(@CF00285)             LIST WITH   2 ARGUMENT(S)        07589000
         DC    A(@CC00687)                                              07590000
@AL00578 EQU   *                       LIST WITH   4 ARGUMENT(S)        07591000
@AL01373 EQU   *                       LIST WITH   4 ARGUMENT(S)        07592000
@AL01599 DC    A(@CF01289)             LIST WITH   4 ARGUMENT(S)        07593000
         DC    A(NULLPARM)                                              07594000
         DC    A(NULLPARM)                                              07595000
         DC    A(SETZERO)                                               07596000
@AL00621 DC    A(@CC00675)             LIST WITH   5 ARGUMENT(S)        07597000
         DC    A(NULLPARM)                                              07598000
         DC    A(NULLPARM)                                              07599000
         DC    A(@CF00114)                                              07600000
         DC    A(@CF00114)                                              07601000
@AL00628 EQU   *                       LIST WITH   3 ARGUMENT(S)        07602000
@AL01212 EQU   *                       LIST WITH   3 ARGUMENT(S)        07603000
@AL01516 DC    A(NULLPARM)             LIST WITH   3 ARGUMENT(S)        07604000
         DC    A(NULLPARM)                                              07605000
         DC    A(@CC01084)                                              07606000
@AL00670 DC    A(@CF01289)             LIST WITH   4 ARGUMENT(S)        07607000
         DS    F                                                        07608000
         DC    A(GPID)                                                  07609000
         DC    AL1(X'80')                                               07610000
         DC    AL3(SETZERO)                                             07611000
@AL00967 DC    A(@CF01285)             LIST WITH   4 ARGUMENT(S)        07612000
@AL00644 EQU   *                       LIST WITH   2 ARGUMENT(S)        07613000
@AL01218 EQU   *                       LIST WITH   2 ARGUMENT(S)        07614000
@AL01522 DC    A(NULLPARM)             LIST WITH   2 ARGUMENT(S)        07615000
         DC    A(NULLPARM)                                              07616000
         DC    A(SETZERO)                                               07617000
@AL01243 EQU   *                       LIST WITH   4 ARGUMENT(S)        07618000
@AL01258 DC    A(@CF00034)             LIST WITH   4 ARGUMENT(S)        07619000
         DS    F                                                        07620000
         DC    A(GPID)                                                  07621000
         DC    AL1(X'80')                                               07622000
         DC    AL3(SETZERO)                                             07623000
@AL01339 EQU   *                       LIST WITH   2 ARGUMENT(S)        07624000
@AL01361 EQU   *                       LIST WITH   2 ARGUMENT(S)        07625000
@AL01368 EQU   *                       LIST WITH   2 ARGUMENT(S)        07626000
@AL01392 EQU   *                       LIST WITH   2 ARGUMENT(S)        07627000
@AL01413 DC    A(@CF00114+3)           LIST WITH   2 ARGUMENT(S)        07628000
         DC    A(@CF00152+3)                                            07629000
@AL01350 EQU   *                       LIST WITH   2 ARGUMENT(S)        07630000
@AL01402 DC    A(@CF00285)             LIST WITH   2 ARGUMENT(S)        07631000
         DC    A(@CC01072)                                              07632000
@AL01575 EQU   *                       LIST WITH   2 ARGUMENT(S)        07633000
@AL01625 EQU   *                       LIST WITH   2 ARGUMENT(S)        07634000
@AL01658 DC    A(@CF00218+3)           LIST WITH   2 ARGUMENT(S)        07635000
         DC    A(@CF00218+3)                                            07636000
@AL01580 EQU   *                       LIST WITH   2 ARGUMENT(S)        07637000
@AL01630 DC    A(@CF00152)             LIST WITH   2 ARGUMENT(S)        07638000
         DC    A(@CC01072)                                              07639000
@DATD    DSECT                                                          07640000
         DS    0F                                                       07641000
@SA00001 DS    18F                                                      07642000
@PC00001 DS    2F                                                       07643000
@SA00005 DS    15F                                                      07644000
@PC00005 DS    6F                                                       07645000
@SA00006 DS    15F                                                      07646000
@PC00006 DS    2F                                                       07647000
@SA00002 DS    15F                                                      07648000
@SA00010 DS    15F                                                      07649000
@SA00013 DS    15F                                                      07650000
@SA00003 DS    15F                                                      07651000
@PC00003 DS    5F                                                       07652000
@SA00004 DS    15F                                                      07653000
@PC00004 DS    1F                                                       07654000
@SA00011 DS    15F                                                      07655000
@PC00011 DS    3F                                                       07656000
@SA00009 DS    15F                                                      07657000
@PC00009 DS    2F                                                       07658000
@PC00008 DS    4F                                                       07659000
@SA00015 DS    14F                                                      07660000
@PC00015 DS    2F                                                       07661000
@SA00007 DS    15F                                                      07662000
@SA00012 DS    14F                                                      07663000
@PC00012 DS    1F                                                       07664000
@SA00014 DS    15F                                                      07665000
@PC00014 DS    2F                                                       07666000
@AL00001 DS    6A                                                       07667000
@TF00001 DS    F                                                        07668000
@AFTEMPS DS    5F                                                       07669000
IDCRC02  CSECT                                                          07670000
         DS    0F                                                       07671000
@CF00114 DC    F'0'                                                     07672000
@CF00218 DC    F'1'                                                     07673000
@CH00218 EQU   @CF00218+2                                               07674000
@CF00152 DC    F'2'                                                     07675000
@CH00152 EQU   @CF00152+2                                               07676000
@CF00041 DC    F'4'                                                     07677000
@CH00041 EQU   @CF00041+2                                               07678000
@CF00285 DC    F'5'                                                     07679000
@CF00178 DC    F'8'                                                     07680000
@CF00037 DC    F'9'                                                     07681000
@CF00034 DC    F'12'                                                    07682000
@CF01292 DC    F'13'                                                    07683000
@CF00887 DC    F'14'                                                    07684000
@CF00227 DC    F'15'                                                    07685000
@CF00481 DC    F'16'                                                    07686000
@CF00893 DC    F'17'                                                    07687000
@CF00891 DC    F'18'                                                    07688000
@CF01291 DC    F'19'                                                    07689000
@CF01286 DC    F'28'                                                    07690000
@CH01286 EQU   @CF01286+2                                               07691000
@CF00220 DC    F'32'                                                    07692000
@CF01113 DC    F'40'                                                    07693000
@CF01285 DC    F'268'                                                   07694000
@CH01285 EQU   @CF01285+2                                               07695000
@CF01289 DC    F'1052'                                                  07696000
@CF01313 DC    F'-8'                                                    07697000
@CF01320 DC    F'-4'                                                    07698000
@CF01314 DC    XL4'0000FFFF'                                            07699000
@DATD    DSECT                                                          07700000
         DS    0D                                                       07701000
LISTSCAN DS    A                                                        07702000
DDSTRU   DS    A                                                        07703000
FSADDR   DS    A                                                        07704000
ERCNVADR DS    A                                                        07705000
DMPINDEX DS    A                                                        07706000
CTGPLPTR DS    A                                                        07707000
RECSZ    DS    F                                                        07708000
BLKSZ    DS    F                                                        07709000
TOTLEN   DS    F                                                        07710000
FNMPTR   DS    A                                                        07711000
AFNMPTR  DS    A                                                        07712000
PINIOCS  DS    A                                                        07713000
POUTIOCS DS    A                                                        07714000
PTRCTACB DS    A                                                        07715000
CONRCPTR DS    A                                                        07716000
INDXCPL  DS    F                                                        07717000
REQLEN   DS    F                                                        07718000
STRTCHN  DS    F                                                        07719000
REQPTR   DS    A                                                        07720000
CURPTR   DS    A                                                        07721000
LISTPTR  DS    A                                                        07722000
LASTCC   DS    H                                                        07723000
SAVLEN   DS    H                                                        07724000
NUMASSOC DS    H                                                        07725000
SAPLLEN  DS    H                                                        07726000
SAPLASC  DS    H                                                        07727000
INDEXLIM DS    H                                                        07728000
CNUM     DS    FL1                                                      07729000
ONUM     DS    FL1                                                      07730000
         DS    CL3                                                      07731000
NXTCHN   DS    FL3                                                      07732000
LISTLN   DS    FL1                                                      07733000
@TS00001 DS    CL95                                                     07734000
@NM00045 DS    CL10                                                     07735000
         ORG   @NM00045                                                 07736000
CATRTNID DS    CL8                                                      07737000
CATLGRC  DS    FL2                                                      07738000
         ORG   @NM00045+10                                              07739000
RELNAME  DS    CL44                                                     07740000
SAVEPL   DS    CL588                                                    07741000
         ORG   SAVEPL                                                   07742000
@NM00050 DS    CL28                                                     07743000
@NM00051 DS    20CL4                                                    07744000
@NM00052 DS    20CL24                                                   07745000
         ORG   SAVEPL+588                                               07746000
SAVEPL2  DS    CL588                                                    07747000
         ORG   SAVEPL2                                                  07748000
@NM00053 DS    CL28                                                     07749000
@NM00054 DS    20CL4                                                    07750000
@NM00055 DS    20CL24                                                   07751000
         ORG   SAVEPL2+588                                              07752000
DOCNTRL  DS    BL1                                                      07753000
FLGS     DS    CL1                                                      07754000
         ORG   FLGS                                                     07755000
AIXFLAG  DS    BL1                                                      07756000
KSDSFLAG EQU   FLGS+0                                                   07757000
PATHFLAG EQU   FLGS+0                                                   07758000
RRDSFLAG EQU   FLGS+0                                                   07759000
FIRFLAG  EQU   FLGS+0                                                   07760000
FRSTALS  EQU   FLGS+0                                                   07761000
NVSMALS  EQU   FLGS+0                                                   07762000
ASSOCFLG EQU   FLGS+0                                                   07763000
         ORG   FLGS+1                                                   07764000
FLGTWO   DS    CL1                                                      07765000
         ORG   FLGTWO                                                   07766000
FRSTASOC DS    BL1                                                      07767000
FRSTSAV  EQU   FLGTWO+0                                                 07768000
ERRSAVFL EQU   FLGTWO+0                                                 07769000
@NM00057 EQU   FLGTWO+0                                                 07770000
         ORG   FLGTWO+1                                                 07771000
         DS    CL3                                                      07772000
OPENLIST DS    BL48                                                     07773000
CNTRL    DS    BL1                                                      07774000
DOWRITE  DS    BL1                                                      07775000
DOALIS   DS    BL1                                                      07776000
         DS    CL1                                                      07777000
CPLFPLEN DS    CL4                                                      07778000
         ORG   CPLFPLEN                                                 07779000
@NM00059 DS    FL2                                                      07780000
ALSCPLEN DS    FL2                                                      07781000
         ORG   CPLFPLEN+4                                               07782000
PRINTTAB DS    9F                                                       07783000
PTRCPL   DS    5A                                                       07784000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                07785000
@ENDDATD EQU   *                                                        07786000
IDCRC02  CSECT                                                          07787000
         DS    0F                                                       07788000
@SIZDATD DC    AL1(0)                                                   07789000
         DC    AL3(@ENDDATD-@DATD)                                      07790000
         DS    0D                                                       07791000
NULLPARM DC    A(0)                                                     07792000
FLGOFF   DC    XL1'00'                                                  07793000
@CC01112 DC    C'CATLGRTN'                                              07794000
@CC00814 DC    C'RC02'                                                  07795000
@CC01043 DC    C'RC01'                                                  07796000
@CC01053 DC    C'RC03'                                                  07797000
@CC01054 DC    C'RC04'                                                  07798000
@CC01058 DC    C'RC05'                                                  07799000
@CC01059 DC    C'RC06'                                                  07800000
@CC01065 DC    C'RC07'                                                  07801000
@CC01068 DC    C'RC09'                                                  07802000
@CC01075 DC    C'RC11'                                                  07803000
@CC01102 DC    C'RC13'                                                  07804000
@CC01110 DC    C'RC15'                                                  07805000
@CC01111 DC    C'RC16'                                                  07806000
@CC01131 DC    C'RC17'                                                  07807000
@CC01141 DC    C'RC19'                                                  07808000
@CC01147 DC    C'RC21'                                                  07809000
@CC01166 DC    C'RC23'                                                  07810000
@CC01176 DC    C'RC25'                                                  07811000
@CC01185 DC    C'RC27'                                                  07812000
@CC01186 DC    C'RC28'                                                  07813000
@CC01187 DC    C'RC29'                                                  07814000
@CC01211 DC    C'RC31'                                                  07815000
@CC01212 DC    C'RC32'                                                  07816000
@CC01239 DC    C'RC33'                                                  07817000
@CC01247 DC    C'RC35'                                                  07818000
@CC01248 DC    C'RC36'                                                  07819000
@CC01249 DC    C'RC37'                                                  07820000
@CC01261 DC    C'RC39'                                                  07821000
@CC01262 DC    C'RC40'                                                  07822000
@CC01282 DC    C'RC42'                                                  07823000
@CC00834 EQU   @CC00814                                                 07824000
@CC00836 DC    C'XP0'                                                   07825000
@CC00847 DC    C'UV0'                                                   07826000
@CC00675 DC    C'I'                                                     07827000
@CC00685 DC    C'G'                                                     07828000
@CC00687 EQU   @CC00814                                                 07829000
@CC01048 DC    C'O'                                                     07830000
@CC01070 DC    C'H'                                                     07831000
@CC01072 DC    C'N'                                                     07832000
@CC01084 DC    C'W'                                                     07833000
ALL      DC    CL3'ALL'                                                 07834000
FORMAT   DC    CL4'FORM'                                                07835000
HSECOND  DC    CL4'HSEC'                                                07836000
CLOCK    DC    CL4'KLOK'                                                07837000
SETZERO  DC    CL4'ZERO'                                                07838000
SETBLANK DC    CL4'BLNK'                                                07839000
NOSET    DC    CL4'NSET'                                                07840000
OVERRIDE DC    CL4'OVRD'                                                07841000
ACQUIRE  DC    CL8'ACQUIRE '                                            07842000
RELINQ   DC    CL8'RELINQ  '                                            07843000
MOUNT    DC    CL8'MOUNT   '                                            07844000
DEMOUNT  DC    CL8'DEMOUNT '                                            07845000
DEFINE   DC    CL8'DEFINE  '                                            07846000
MOVE     DC    CL8'MOVE    '                                            07847000
TRACEQ   DC    CL8'TRACEQ  '                                            07848000
COPYTABL DC    CL8'COPYTABL'                                            07849000
COPYCRTG DC    CL8'COPYCRTG'                                            07850000
COPYVOL  DC    CL8'COPYVOL '                                            07851000
VVIC     DC    CL8'VVIC    '                                            07852000
TUNE     DC    CL8'TUNE    '                                            07853000
NAMES    DC    CL4'NAME'                                                07854000
UNIT     DC    CL4'UNIT'                                                07855000
SHR      DC    CL4'SHR '                                                07856000
EXCL     DC    CL4'EXCL'                                                07857000
NOWAIT   DC    CL4'NWAI'                                                07858000
WAIT     DC    CL4'WAIT'                                                07859000
MODID    DC    CL4'RC02'                                                07860000
GPID     DC    CL4'RC02'                                                07861000
FIXAREA  DS    CL400                                                    07862000
         ORG   FIXAREA                                                  07863000
@NM00041 DS    CL256                                                    07864000
         ORG   @NM00041                                                 07865000
@NM00042 DC    256X'00'                                                 07866000
         ORG   FIXAREA+256                                              07867000
@NM00043 DS    CL144                                                    07868000
         ORG   @NM00043                                                 07869000
@NM00044 DC    144X'00'                                                 07870000
         ORG   FIXAREA+400                                              07871000
NOTINIT  DS    CL255                                                    07872000
         ORG   NOTINIT                                                  07873000
@NM00048 DC    255X'FF'                                                 07874000
         ORG   NOTINIT+255                                              07875000
EMPDSRTN DC    X'6E'                                                    07876000
EXPTYPE1 DC    X'F2'                                                    07877000
CITYPEXT DC    CL8'ITYPEXT '                                            07878000
SSFLAG   DC    X'80'                                                    07879000
ZERO     DC    X'00'                                                    07880000
         DC    XL255'0'                                                 07881000
FIELDLST DC    CL8'ENTYPE  '                                            07882000
         DC    CL8'ENTNAME '                                            07883000
         DC    CL8'DSATTR  '                                            07884000
         DC    CL8'OWNERID '                                            07885000
         DC    CL8'DSETCRDT'                                            07886000
         DC    CL8'DSETEXDT'                                            07887000
         DC    CL8'BUFSIZE '                                            07888000
         DC    CL8'LRECL   '                                            07889000
         DC    CL8'SPACPARM'                                            07890000
         DC    CL8'PASSWORD'                                            07891000
         DC    CL8'PASSPRMT'                                            07892000
         DC    CL8'PASSATMP'                                            07893000
         DC    CL8'USVRMDUL'                                            07894000
         DC    CL8'USERAREC'                                            07895000
         DC    CL8'LOKEYV  '                                            07896000
         DC    CL8'HIKEYV  '                                            07897000
         DC    CL8'VOLSER  '                                            07898000
         DC    CL8'AMDSBCAT'                                            07899000
         DC    CL8'EXCPEXIT'                                            07900000
         DC    CL8'RGATTR  '                                            07901000
         DC    CL8'SECFLAGS'                                            07902000
         DC    CL8'NAMEDS  '                                            07903000
         DC    CL8'CATACB  '                                            07904000
NVSMFLST DC    CL8'ENTYPE  '                                            07905000
         DC    CL8'ENTNAME '                                            07906000
         DC    CL8'VOLSER  '                                            07907000
         DC    CL8'DEVTYP  '                                            07908000
         DC    CL8'FILESEQ '                                            07909000
         DC    CL8'OWNERID '                                            07910000
         DC    CL8'DSETCRDT'                                            07911000
         DC    CL8'DSETEXDT'                                            07912000
         DC    CL8'NAMEDS  '                                            07913000
         DC    CL8'CATACB  '                                            07914000
GDGFLIST DC    CL8'ENTYPE  '                                            07915000
         DC    CL8'ENTNAME '                                            07916000
         DC    CL8'GDGLIMIT'                                            07917000
         DC    CL8'GDGATTR '                                            07918000
         DC    CL8'OWNERID '                                            07919000
         DC    CL8'DSETCRDT'                                            07920000
         DC    CL8'DSETEXDT'                                            07921000
         DC    CL8'NAMEDS  '                                            07922000
         DC    CL8'CATACB  '                                            07923000
ALSFLIST DC    CL8'ENTYPE  '                                            07924000
         DC    CL8'ENTNAME '                                            07925000
         DC    CL8'NAMEDS  '                                            07926000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07927000
@01      EQU   01                                                       07928000
@02      EQU   02                                                       07929000
@03      EQU   03                                                       07930000
@04      EQU   04                                                       07931000
@05      EQU   05                                                       07932000
@06      EQU   06                                                       07933000
@07      EQU   07                                                       07934000
@08      EQU   08                                                       07935000
@09      EQU   09                                                       07936000
@10      EQU   10                                                       07937000
@11      EQU   11                                                       07938000
@12      EQU   12                                                       07939000
@13      EQU   13                                                       07940000
@14      EQU   14                                                       07941000
@15      EQU   15                                                       07942000
NALSMPTR EQU   @03                                                      07943000
ICONTRBL EQU   @02                                                      07944000
M1SIZE   EQU   @02                                                      07945000
MTPTR    EQU   @03                                                      07946000
MFPTR    EQU   @04                                                      07947000
PAD      EQU   @05                                                      07948000
PLN      EQU   @04                                                      07949000
WSIZE    EQU   @03                                                      07950000
LGNFLD   EQU   @05                                                      07951000
DINDX    EQU   @03                                                      07952000
INDX     EQU   @04                                                      07953000
I        EQU   @04                                                      07954000
ASSREMD  EQU   @03                                                      07955000
CLRFDCTR EQU   @03                                                      07956000
NUMALS   EQU   @05                                                      07957000
NUMOBJCT EQU   @05                                                      07958000
NUMOBJ   EQU   @03                                                      07959000
NUMCPL   EQU   @05                                                      07960000
DSCCATPT EQU   @06                                                      07961000
CTGFLPTR EQU   @02                                                      07962000
OPNPTR   EQU   @03                                                      07963000
IOCSPTR  EQU   @03                                                      07964000
TESTRC   EQU   @02                                                      07965000
SETRC    EQU   @03                                                      07966000
RTNREG   EQU   @15                                                      07967000
REG15    EQU   @15                                                      07968000
REG0     EQU   @00                                                      07969000
REG1     EQU   @01                                                      07970000
REG10    EQU   @10                                                      07971000
REG11    EQU   @11                                                      07972000
REG12    EQU   @12                                                      07973000
REG13    EQU   @13                                                      07974000
REG14    EQU   @14                                                      07975000
REG2     EQU   @02                                                      07976000
REG3     EQU   @03                                                      07977000
REG4     EQU   @04                                                      07978000
REG5     EQU   @05                                                      07979000
REG6     EQU   @06                                                      07980000
REG7     EQU   @07                                                      07981000
REG8     EQU   @08                                                      07982000
REG9     EQU   @09                                                      07983000
IDCSAEP0 EQU   0                                                        07984000
IDCSAFS0 EQU   0                                                        07985000
IDCSAGP0 EQU   0                                                        07986000
IDCSAFP0 EQU   0                                                        07987000
IDCSATI0 EQU   0                                                        07988000
IDCSACA0 EQU   0                                                        07989000
TRACE1   EQU   0                                                        07990000
OLDERID1 EQU   TRACE1                                                   07991000
TRACE2   EQU   0                                                        07992000
OLDERID2 EQU   TRACE2                                                   07993000
NEWID2   EQU   TRACE2+95                                                07994000
NEWERID2 EQU   5                                                        07995000
CIRAGL   EQU   0                                                        07996000
CIRTYPE  EQU   CIRAGL                                                   07997000
ALLAGL   EQU   0                                                        07998000
ALLSTS   EQU   ALLAGL+24                                                07999000
ALLDSP   EQU   ALLAGL+25                                                08000000
ALLORG   EQU   ALLAGL+26                                                08001000
ALLOPT   EQU   ALLAGL+28                                                08002000
UNITABL  EQU   0                                                        08003000
UNITADR  EQU   UNITABL+4                                                08004000
@NM00010 EQU   UNITADR                                                  08005000
UNITSTAT EQU   UNITABL+6                                                08006000
IDCIOOP0 EQU   0                                                        08007000
IDCIOCL0 EQU   0                                                        08008000
IDCIOPT0 EQU   0                                                        08009000
IDCIOCO0 EQU   0                                                        08010000
IDCIOVY0 EQU   0                                                        08011000
IOCSTR   EQU   0                                                        08012000
IOCDAD   EQU   IOCSTR                                                   08013000
IOCDLN   EQU   IOCSTR+4                                                 08014000
IOCTRN   EQU   IOCSTR+8                                                 08015000
IOCDSO   EQU   IOCSTR+16                                                08016000
IOCRFM   EQU   IOCSTR+17                                                08017000
IOCMAC   EQU   IOCSTR+18                                                08018000
IOCMAC2  EQU   IOCSTR+19                                                08019000
IOCCHP   EQU   IOCSTR+20                                                08020000
IOCMSG   EQU   IOCSTR+21                                                08021000
IOCMSGOP EQU   IOCMSG                                                   08022000
IOCRBA   EQU   IOCSTR+40                                                08023000
IOCTTR   EQU   IOCRBA                                                   08024000
IOCVRC   EQU   IOCTTR                                                   08025000
IOCMEM   EQU   IOCSTR+44                                                08026000
IOCNWM   EQU   IOCSTR+48                                                08027000
IOCREL   EQU   IOCSTR+60                                                08028000
OPNAGL   EQU   0                                                        08029000
OPNOPT   EQU   OPNAGL                                                   08030000
OPNOPTIN EQU   OPNOPT                                                   08031000
OPNOPTOT EQU   OPNOPT                                                   08032000
OPNOPTBK EQU   OPNOPT                                                   08033000
OPNOPTCR EQU   OPNOPT                                                   08034000
OPNRFM   EQU   OPNAGL+1                                                 08035000
OPNRFMSF EQU   OPNRFM                                                   08036000
OPNRFMBK EQU   OPNRFM                                                   08037000
OPNTYP   EQU   OPNAGL+2                                                 08038000
OPNTYPXM EQU   OPNTYP                                                   08039000
OPNTYPRV EQU   OPNTYP                                                   08040000
OPNMOD   EQU   OPNAGL+3                                                 08041000
OPNIOC   EQU   OPNAGL+4                                                 08042000
OPNDDN   EQU   OPNAGL+8                                                 08043000
OPNPWA   EQU   OPNAGL+12                                                08044000
OPNDSN   EQU   OPNAGL+16                                                08045000
OPNDEV   EQU   OPNAGL+24                                                08046000
OPNDEVDT EQU   OPNDEV                                                   08047000
OPNREC   EQU   OPNAGL+32                                                08048000
OPNBLK   EQU   OPNAGL+36                                                08049000
OPNDSO   EQU   OPNAGL+41                                                08050000
OPNOPT2  EQU   OPNAGL+42                                                08051000
OPNOPTNM EQU   OPNOPT2                                                  08052000
IOINFOPT EQU   0                                                        08053000
UVOLLIST EQU   0                                                        08054000
UVOLENT  EQU   UVOLLIST+2                                               08055000
AMSTP011 EQU   0                                                        08056000
DARGLIST EQU   0                                                        08057000
DARGDBP  EQU   DARGLIST                                                 08058000
DARGSTID EQU   DARGLIST+8                                               08059000
DARGSMOD EQU   DARGSTID                                                 08060000
DARGSENT EQU   DARGSTID+3                                               08061000
DARGILP  EQU   DARGLIST+12                                              08062000
DARGCNT  EQU   DARGLIST+14                                              08063000
DARGFLGS EQU   DARGLIST+19                                              08064000
DARGARY  EQU   DARGLIST+20                                              08065000
DARGINS  EQU   DARGARY                                                  08066000
DARGINL  EQU   DARGARY+2                                                08067000
DARGDTM  EQU   DARGARY+4                                                08068000
FMTLIST  EQU   0                                                        08069000
FMTFLGS  EQU   FMTLIST                                                  08070000
FMTSPF   EQU   FMTLIST+2                                                08071000
FMTRFNO  EQU   FMTSPF                                                   08072000
FMTILEN  EQU   FMTRFNO                                                  08073000
FMTIOFF  EQU   FMTLIST+4                                                08074000
FMTTRBC  EQU   FMTIOFF                                                  08075000
FMTSTO   EQU   FMTTRBC                                                  08076000
FMTOCOL  EQU   FMTLIST+6                                                08077000
FMTCNVF  EQU   FMTLIST+10                                               08078000
ERCNVTAB EQU   0                                                        08079000
ERTYPE   EQU   ERCNVTAB                                                 08080000
EROPER   EQU   ERCNVTAB+1                                               08081000
EROSOPER EQU   ERCNVTAB+2                                               08082000
ERCATRC  EQU   ERCNVTAB+16                                              08083000
ERCPLPT  EQU   ERCNVTAB+20                                              08084000
IDCDB010 EQU   0                                                        08085000
DMPITM   EQU   0                                                        08086000
DMPARY   EQU   0                                                        08087000
CTGPL    EQU   0                                                        08088000
CTGOPTN1 EQU   CTGPL                                                    08089000
CTGCNAME EQU   CTGOPTN1                                                 08090000
CTGOPTN2 EQU   CTGPL+1                                                  08091000
CTGEXT   EQU   CTGOPTN2                                                 08092000
CTGERASE EQU   CTGOPTN2                                                 08093000
CTGSMF   EQU   CTGERASE                                                 08094000
CTGREL   EQU   CTGSMF                                                   08095000
CTGPURG  EQU   CTGOPTN2                                                 08096000
CTGVMNT  EQU   CTGPURG                                                  08097000
CTGRCATN EQU   CTGVMNT                                                  08098000
CTGOPTN3 EQU   CTGPL+2                                                  08099000
CTGFUNC  EQU   CTGOPTN3                                                 08100000
CTGNUM   EQU   CTGOPTN3                                                 08101000
CTGAM0   EQU   CTGOPTN3                                                 08102000
CTGOPTN4 EQU   CTGPL+3                                                  08103000
CTGENT   EQU   CTGPL+4                                                  08104000
CTGCAT   EQU   CTGPL+8                                                  08105000
CTGWKA   EQU   CTGPL+12                                                 08106000
CTGDSORG EQU   CTGPL+16                                                 08107000
CTGNOFLD EQU   CTGPL+19                                                 08108000
CTGDDNM  EQU   CTGPL+20                                                 08109000
CTGNEWNM EQU   CTGDDNM                                                  08110000
CTGFDBK  EQU   CTGNEWNM                                                 08111000
CTGFBFLG EQU   CTGNEWNM+2                                               08112000
CTGJSCB  EQU   CTGPL+24                                                 08113000
CTGPSWD  EQU   CTGJSCB                                                  08114000
CTGFIELD EQU   CTGPL+28                                                 08115000
CTGFL    EQU   0                                                        08116000
CTGFLDNO EQU   CTGFL                                                    08117000
CTGFLDCD EQU   CTGFL+1                                                  08118000
CTGFLDRE EQU   CTGFL+3                                                  08119000
CTGFLDNM EQU   CTGFL+8                                                  08120000
CTGFLCHN EQU   CTGFL+12                                                 08121000
CTGFLDAT EQU   CTGFL+16                                                 08122000
CTGFLNG  EQU   CTGFLDAT                                                 08123000
CTGFLPT  EQU   CTGFLDAT+4                                               08124000
IDAAMDSB EQU   0                                                        08125000
AMDATTR  EQU   IDAAMDSB+1                                               08126000
AMDNEST  EQU   IDAAMDSB+4                                               08127000
AMDAXRKP EQU   AMDNEST                                                  08128000
AMDRKP   EQU   IDAAMDSB+6                                               08129000
AMDKEYLN EQU   IDAAMDSB+8                                               08130000
AMDPCTCA EQU   IDAAMDSB+10                                              08131000
AMDPCTCI EQU   IDAAMDSB+11                                              08132000
AMDCINV  EQU   IDAAMDSB+20                                              08133000
AMDLRECL EQU   IDAAMDSB+24                                              08134000
AMDHLRBA EQU   IDAAMDSB+28                                              08135000
AMDSSRBA EQU   IDAAMDSB+32                                              08136000
AMDATTR3 EQU   IDAAMDSB+40                                              08137000
AMDSTAT  EQU   IDAAMDSB+48                                              08138000
INPTBL   EQU   0                                                        08139000
ENTOBJ   EQU   0                                                        08140000
OBJTYP   EQU   ENTOBJ                                                   08141000
OBJVAL   EQU   ENTOBJ+1                                                 08142000
OBJPLN   EQU   ENTOBJ+8                                                 08143000
OBJPAS   EQU   ENTOBJ+9                                                 08144000
OUTDAT   EQU   0                                                        08145000
OUTLEN   EQU   OUTDAT                                                   08146000
SAVOIOCS EQU   OUTDAT+4                                                 08147000
USBKSZ   EQU   OUTDAT+8                                                 08148000
OUTFLGS  EQU   OUTDAT+16                                                08149000
OPNFLG   EQU   OUTFLGS                                                  08150000
ENDFLG   EQU   OUTFLGS                                                  08151000
EMPTYDS  EQU   OUTFLGS                                                  08152000
INDDNM   EQU   0                                                        08153000
OUTDDNM  EQU   0                                                        08154000
PDEVNM   EQU   0                                                        08155000
FENTYPE  EQU   0                                                        08156000
FENTNAME EQU   0                                                        08157000
FNAMEDS  EQU   0                                                        08158000
FTYPE    EQU   FNAMEDS                                                  08159000
FNAME    EQU   FNAMEDS+1                                                08160000
FCATACB  EQU   0                                                        08161000
FDSATTR  EQU   0                                                        08162000
FPASSMWR EQU   0                                                        08163000
FIELD    EQU   0                                                        08164000
FIELDLN  EQU   FIELD                                                    08165000
WORKAREA EQU   0                                                        08166000
AREALN   EQU   WORKAREA                                                 08167000
RETURNLN EQU   WORKAREA+2                                               08168000
ENTLIST  EQU   WORKAREA+4                                               08169000
ENTITEM  EQU   ENTLIST                                                  08170000
PATHREL  EQU   0                                                        08171000
RELATE   EQU   PATHREL                                                  08172000
PATHENT  EQU   RELATE                                                   08173000
@NM00049 EQU   PATHREL+44                                               08174000
PATHPASS EQU   @NM00049                                                 08175000
CONREC   EQU   0                                                        08176000
HEADER   EQU   CONREC                                                   08177000
HEADLN   EQU   HEADER                                                   08178000
HEADFLG1 EQU   HEADER+2                                                 08179000
HEADFLG2 EQU   HEADER+3                                                 08180000
RECORDSZ EQU   HEADER+4                                                 08181000
ASSRECLN EQU   RECORDSZ                                                 08182000
ASSRECNM EQU   RECORDSZ+2                                               08183000
VARDATA  EQU   CONREC+8                                                 08184000
DICT     EQU   0                                                        08185000
DICTNM   EQU   DICT                                                     08186000
DICTEN   EQU   DICT+4                                                   08187000
DICTLN   EQU   DICTEN                                                   08188000
DICTDL   EQU   DICTEN+4                                                 08189000
TIMESTMP EQU   0                                                        08190000
TEXOJCT  EQU   TIMESTMP                                                 08191000
TEXFLG   EQU   TIMESTMP+1                                               08192000
TEXASSOC EQU   TEXFLG                                                   08193000
TEXBASE  EQU   TEXFLG                                                   08194000
TEXRCVY  EQU   TEXFLG                                                   08195000
TEXNVS   EQU   TEXFLG                                                   08196000
TEXGDG   EQU   TEXFLG                                                   08197000
TEXUCT   EQU   TEXFLG                                                   08198000
TEXFLG2  EQU   TIMESTMP+2                                               08199000
TIMEODAY EQU   TIMESTMP+4                                               08200000
TIMEDATE EQU   TIMESTMP+12                                              08201000
OIOCSPTR EQU   0                                                        08202000
FROMAREA EQU   0                                                        08203000
TOAREA   EQU   0                                                        08204000
BUFCHN   EQU   0                                                        08205000
BHRECLEN EQU   BUFCHN                                                   08206000
BRECLEN  EQU   BHRECLEN+2                                               08207000
BRECPTR  EQU   BUFCHN+4                                                 08208000
BNXTCHN  EQU   BUFCHN+8                                                 08209000
NMDSPTR  EQU   0                                                        08210000
NMDSTYPE EQU   NMDSPTR                                                  08211000
NMDSNAME EQU   NMDSPTR+1                                                08212000
ALSCHN   EQU   0                                                        08213000
NXTALIS  EQU   ALSCHN+4                                                 08214000
NXTNAM   EQU   NXTALIS+1                                                08215000
ANAMEDS  EQU   0                                                        08216000
ATYPE    EQU   ANAMEDS                                                  08217000
ANAME    EQU   ANAMEDS+1                                                08218000
AMSTP041 EQU   0                                                        08219000
AMSTP042 EQU   0                                                        08220000
AMSTP043 EQU   0                                                        08221000
AMSTP044 EQU   0                                                        08222000
DMPTRM   EQU   0                                                        08223000
IDCIOGT0 EQU   0                                                        08224000
IDCIOIT0 EQU   0                                                        08225000
IDCIOPO0 EQU   0                                                        08226000
IDCIOSI0 EQU   0                                                        08227000
IDCIOST0 EQU   0                                                        08228000
IDCIOTM0 EQU   0                                                        08229000
IDCIO050 EQU   0                                                        08230000
IDCSAAL0 EQU   0                                                        08231000
IDCSACL0 EQU   0                                                        08232000
IDCSACR0 EQU   0                                                        08233000
IDCSADE0 EQU   0                                                        08234000
IDCSADL0 EQU   0                                                        08235000
IDCSADQ0 EQU   0                                                        08236000
IDCSAGS0 EQU   0                                                        08237000
IDCSAID0 EQU   0                                                        08238000
IDCSALC0 EQU   0                                                        08239000
IDCSALD0 EQU   0                                                        08240000
IDCSALK0 EQU   0                                                        08241000
IDCSANQ0 EQU   0                                                        08242000
IDCSAPR0 EQU   0                                                        08243000
IDCSAPT0 EQU   0                                                        08244000
IDCSAQL0 EQU   0                                                        08245000
IDCSARC0 EQU   0                                                        08246000
IDCSARV0 EQU   0                                                        08247000
IDCSASC0 EQU   0                                                        08248000
IDCSASI0 EQU   0                                                        08249000
IDCSASN0 EQU   0                                                        08250000
IDCSASS0 EQU   0                                                        08251000
IDCSAST0 EQU   0                                                        08252000
IDCSAUC0 EQU   0                                                        08253000
IDCSAWO0 EQU   0                                                        08254000
IDCSA060 EQU   0                                                        08255000
IDCST010 EQU   0                                                        08256000
IDCTPER0 EQU   0                                                        08257000
LISTTEST EQU   0                                                        08258000
NEWERID1 EQU   5                                                        08259000
GDTTBL   EQU   0                                                        08260000
GDTTR1   EQU   GDTTBL+8                                                 08261000
GDTTR2   EQU   GDTTBL+12                                                08262000
GDTDBG   EQU   GDTTBL+40                                                08263000
GDTSTC   EQU   GDTTBL+44                                                08264000
GDTPRT   EQU   GDTTBL+48                                                08265000
GDTESS   EQU   GDTTBL+52                                                08266000
GDTESA   EQU   GDTTBL+56                                                08267000
GDTRST   EQU   GDTTBL+60                                                08268000
GDTRES   EQU   GDTTBL+64                                                08269000
GDTCAL   EQU   GDTTBL+68                                                08270000
GDTGSP   EQU   GDTTBL+72                                                08271000
GDTFSP   EQU   GDTTBL+76                                                08272000
GDTGPL   EQU   GDTTBL+80                                                08273000
GDTFPL   EQU   GDTTBL+84                                                08274000
GDTLOD   EQU   GDTTBL+88                                                08275000
GDTDEL   EQU   GDTTBL+92                                                08276000
GDTPRL   EQU   GDTTBL+96                                                08277000
GDTEPL   EQU   GDTTBL+100                                               08278000
GDTTIM   EQU   GDTTBL+104                                               08279000
GDTIIO   EQU   GDTTBL+108                                               08280000
GDTTIO   EQU   GDTTBL+112                                               08281000
GDTOPN   EQU   GDTTBL+124                                               08282000
GDTCLS   EQU   GDTTBL+128                                               08283000
GDTGET   EQU   GDTTBL+132                                               08284000
GDTPUT   EQU   GDTTBL+136                                               08285000
GDTPOS   EQU   GDTTBL+140                                               08286000
GDTCPY   EQU   GDTTBL+144                                               08287000
GDTCAT   EQU   GDTTBL+148                                               08288000
GDTSNP   EQU   GDTTBL+164                                               08289000
GDTVFY   EQU   GDTTBL+172                                               08290000
GDTUID   EQU   GDTTBL+192                                               08291000
GDTPMT   EQU   GDTTBL+196                                               08292000
GDTCIR   EQU   GDTTBL+200                                               08293000
GDTLNK   EQU   GDTTBL+204                                               08294000
GDTALC   EQU   GDTTBL+208                                               08295000
GDTDLC   EQU   GDTTBL+212                                               08296000
GDTQAL   EQU   GDTTBL+216                                               08297000
GDTSTW   EQU   GDTTBL+220                                               08298000
GDTSSC   EQU   GDTTBL+224                                               08299000
GDTENQ   EQU   GDTTBL+228                                               08300000
GDTRSV   EQU   GDTTBL+232                                               08301000
GDTDEQ   EQU   GDTTBL+236                                               08302000
GDTSFO   EQU   GDTTBL+240                                               08303000
GDTWTO   EQU   GDTTBL+244                                               08304000
GDTSCR   EQU   GDTTBL+248                                               08305000
GDTUNT   EQU   GDTTBL+252                                               08306000
GDTRCT   EQU   GDTTBL+256                                               08307000
GDTIFO   EQU   GDTTBL+260                                               08308000
GDTEXP   EQU   GDTTBL+264                                               08309000
GDTSTA   EQU   GDTTBL+268                                               08310000
GDTERR   EQU   GDTTBL+272                                               08311000
GDTUNC   EQU   GDTTBL+276                                               08312000
GDTLOC   EQU   GDTTBL+280                                               08313000
INPPTR   EQU   0                                                        08314000
LCINUM   EQU   0                                                        08315000
LCATACB  EQU   0                                                        08316000
LFLDLST  EQU   0                                                        08317000
LFLDNUM  EQU   0                                                        08318000
LCPLPTR  EQU   0                                                        08319000
SCPLPTR  EQU   0                                                        08320000
OTYPE    EQU   0                                                        08321000
ODD      EQU   0                                                        08322000
ODSN     EQU   0                                                        08323000
OREC     EQU   0                                                        08324000
OBLK     EQU   0                                                        08325000
OIOCS    EQU   0                                                        08326000
PLNINIT  EQU   0                                                        08327000
PADINIT  EQU   0                                                        08328000
MSIZE    EQU   0                                                        08329000
MF1PTR   EQU   0                                                        08330000
MT1PTR   EQU   0                                                        08331000
ZEROOUT  EQU   0                                                        08332000
INDCTGPL EQU   0                                                        08333000
TYPE     EQU   0                                                        08334000
IRECLEN  EQU   0                                                        08335000
IRECPTR  EQU   0                                                        08336000
IREQTPE  EQU   0                                                        08337000
ALSNMPTR EQU   0                                                        08338000
PFLNMDS  EQU   0                                                        08339000
NUMASOC  EQU   0                                                        08340000
PRNTMSG  EQU   0                                                        08341000
ICPL     EQU   0                                                        08342000
@NM00036 EQU   CTGDDNM                                                  08343000
CTGPROB  EQU   @NM00036                                                 08344000
CTGREASN EQU   CTGPROB+2                                                08345000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    08346000
CTGREAS2 EQU   CTGREASN+1                                               08347000
CTGREAS1 EQU   CTGREASN                                                 08348000
CTGMODID EQU   CTGPROB                                                  08349000
GDTECT   EQU   GDTTBL+188                                               08350000
GDTPSB   EQU   GDTTBL+184                                               08351000
GDTUPT   EQU   GDTTBL+180                                               08352000
GDTCMB   EQU   GDTTBL+176                                               08353000
GDTSPR   EQU   GDTTBL+168                                               08354000
@NM00001 EQU   GDTTBL+160                                               08355000
GDTABH   EQU   GDTTBL+156                                               08356000
GDTABT   EQU   GDTTBL+152                                               08357000
GDTTOH   EQU   GDTTBL+120                                               08358000
GDTRIP   EQU   GDTTBL+116                                               08359000
GDTIOH   EQU   GDTTBL+36                                                08360000
GDTSAH   EQU   GDTTBL+32                                                08361000
GDTTPH   EQU   GDTTBL+28                                                08362000
GDTRIH   EQU   GDTTBL+24                                                08363000
GDTSTH   EQU   GDTTBL+20                                                08364000
GDTDBH   EQU   GDTTBL+16                                                08365000
GDTPRM   EQU   GDTTBL+4                                                 08366000
GDTHDR   EQU   GDTTBL                                                   08367000
PREVALS  EQU   ALSCHN+8                                                 08368000
NXTTPE   EQU   NXTALIS                                                  08369000
GDSASOC  EQU   ALSCHN                                                   08370000
@NM00058 EQU   BHRECLEN                                                 08371000
TEXRESV  EQU   TIMESTMP+3                                               08372000
TEXINHTG EQU   TEXFLG                                                   08373000
@NM00056 EQU   TEXFLG                                                   08374000
ENTRYNM  EQU   ENTITEM+1                                                08375000
ENTRYTYP EQU   ENTITEM                                                  08376000
FIELDCT  EQU   FIELD+2                                                  08377000
FDSNTUSE EQU   FDSATTR+1                                                08378000
@NM00047 EQU   FDSATTR+1                                                08379000
@NM00046 EQU   FDSATTR                                                  08380000
FDSTMPEX EQU   FDSATTR                                                  08381000
FDSINHUP EQU   FDSATTR                                                  08382000
FDSOTHER EQU   FDSATTR                                                  08383000
@NM00040 EQU   OUTFLGS                                                  08384000
RESOUTP  EQU   OUTDAT+12                                                08385000
RESINP   EQU   ENTOBJ+4                                                 08386000
AMDEXCP  EQU   AMDSTAT+44                                               08387000
AMDNCAS  EQU   AMDSTAT+40                                               08388000
AMDNCIS  EQU   AMDSTAT+36                                               08389000
AMDASPA  EQU   AMDSTAT+32                                               08390000
AMDRETR  EQU   AMDSTAT+28                                               08391000
AMDUPR   EQU   AMDSTAT+24                                               08392000
AMDIREC  EQU   AMDSTAT+20                                               08393000
AMDDELR  EQU   AMDSTAT+16                                               08394000
AMDNLR   EQU   AMDSTAT+12                                               08395000
AMDNEXT  EQU   AMDSTAT+10                                               08396000
AMDNIL   EQU   AMDSTAT+8                                                08397000
AMDSTSP  EQU   AMDSTAT                                                  08398000
@NM00039 EQU   IDAAMDSB+41                                              08399000
@NM00038 EQU   AMDATTR3                                                 08400000
AMDLM    EQU   AMDATTR3                                                 08401000
AMDWAIT  EQU   AMDATTR3                                                 08402000
AMDBIND  EQU   AMDATTR3                                                 08403000
AMDFAULT EQU   AMDATTR3                                                 08404000
AMDUNQ   EQU   AMDATTR3                                                 08405000
AMDPARDB EQU   IDAAMDSB+36                                              08406000
AMDMAXRR EQU   AMDSSRBA                                                 08407000
AMDNSLOT EQU   AMDHLRBA                                                 08408000
AMDFSCI  EQU   IDAAMDSB+16                                              08409000
AMDFSCA  EQU   IDAAMDSB+14                                              08410000
AMDCIPCA EQU   IDAAMDSB+12                                              08411000
AMDLEN   EQU   IDAAMDSB+2                                               08412000
AMDSPAN  EQU   AMDATTR                                                  08413000
AMDRRDS  EQU   AMDATTR                                                  08414000
AMDRANGE EQU   AMDATTR                                                  08415000
AMDORDER EQU   AMDATTR                                                  08416000
AMDREPL  EQU   AMDATTR                                                  08417000
AMDSDT   EQU   AMDATTR                                                  08418000
AMDWCK   EQU   AMDATTR                                                  08419000
AMDDST   EQU   AMDATTR                                                  08420000
AMDSBID  EQU   IDAAMDSB                                                 08421000
CTGFLDWA EQU   CTGFL+4                                                  08422000
CTGFLDTS EQU   CTGFLDRE                                                 08423000
@NM00037 EQU   CTGFLDRE                                                 08424000
CTGFLDGC EQU   CTGFL+2                                                  08425000
@NM00035 EQU   CTGFBFLG                                                 08426000
CTGNGDSN EQU   CTGFBFLG                                                 08427000
CTGGDGB  EQU   CTGFBFLG                                                 08428000
CTGKEEP  EQU   CTGFBFLG                                                 08429000
CTGPAR   EQU   CTGFBFLG                                                 08430000
CTGTYPE  EQU   CTGPL+18                                                 08431000
@NM00034 EQU   CTGDSORG                                                 08432000
CTGOPTNS EQU   CTGDSORG                                                 08433000
CTGCVOL  EQU   CTGCAT                                                   08434000
CTGFVT   EQU   CTGENT                                                   08435000
@NM00033 EQU   CTGOPTN4                                                 08436000
CTGTIOT  EQU   CTGOPTN4                                                 08437000
CTGBYPMT EQU   CTGOPTN4                                                 08438000
CTGCOIN  EQU   CTGOPTN4                                                 08439000
CTGNPROF EQU   CTGOPTN4                                                 08440000
CTGDOCAT EQU   CTGOPTN4                                                 08441000
CTGLBASE EQU   CTGOPTN4                                                 08442000
CTGSRH   EQU   CTGOPTN3                                                 08443000
CTGGDGL  EQU   CTGOPTN3                                                 08444000
CTGSUPLT EQU   CTGOPTN3                                                 08445000
@NM00032 EQU   CTGOPTN2                                                 08446000
CTGSCR   EQU   CTGOPTN2                                                 08447000
CTGOVRID EQU   CTGOPTN2                                                 08448000
CTGDISC  EQU   CTGOPTN2                                                 08449000
CTGGTNXT EQU   CTGOPTN2                                                 08450000
CTGSWAP  EQU   CTGRCATN                                                 08451000
CTGGTALL EQU   CTGREL                                                   08452000
CTGNSVS  EQU   CTGEXT                                                   08453000
CTGGENLD EQU   CTGOPTN1                                                 08454000
CTGNAME  EQU   CTGOPTN1                                                 08455000
CTGREAD  EQU   CTGOPTN1                                                 08456000
CTGUPD   EQU   CTGOPTN1                                                 08457000
CTGCI    EQU   CTGOPTN1                                                 08458000
CTGMAST  EQU   CTGOPTN1                                                 08459000
CTGBYPSS EQU   CTGOPTN1                                                 08460000
@NM00031 EQU   DMPARY+15                                                08461000
DMPARYTP EQU   DMPARY+14                                                08462000
DMPARYEX EQU   DMPARY+12                                                08463000
DMPARYIC EQU   DMPARY+10                                                08464000
DMPARYSZ EQU   DMPARY+8                                                 08465000
DMPARYNM EQU   DMPARY                                                   08466000
@NM00030 EQU   DMPITM+15                                                08467000
DMPITMTP EQU   DMPITM+14                                                08468000
DMPITMLN EQU   DMPITM+12                                                08469000
DMPITMPT EQU   DMPITM+8                                                 08470000
DMPITMNM EQU   DMPITM                                                   08471000
@NM00029 EQU   ERCNVTAB+24                                              08472000
ERDARBPT EQU   ERCPLPT                                                  08473000
ERDYNRC  EQU   ERCATRC                                                  08474000
ERDSNM   EQU   ERCNVTAB+12                                              08475000
@NM00028 EQU   ERCNVTAB+4                                               08476000
@NM00027 EQU   ERCNVTAB+3                                               08477000
@NM00026 EQU   EROSOPER                                                 08478000
EROSUCDX EQU   EROSOPER                                                 08479000
EROSCATL EQU   EROSOPER                                                 08480000
@NM00025 EQU   EROPER                                                   08481000
ERCATAL  EQU   EROPER                                                   08482000
ERCATDL  EQU   EROPER                                                   08483000
ERCATDE  EQU   EROPER                                                   08484000
ERCATLC  EQU   EROPER                                                   08485000
@NM00024 EQU   ERTYPE                                                   08486000
ERDYNAL  EQU   ERTYPE                                                   08487000
EROSCAT  EQU   ERTYPE                                                   08488000
ERCATLG  EQU   ERTYPE                                                   08489000
@NM00023 EQU   FMTCNVF+1                                                08490000
FMTAR    EQU   FMTCNVF+1                                                08491000
FMTBS    EQU   FMTCNVF+1                                                08492000
FMTSS    EQU   FMTCNVF+1                                                08493000
FMTAL    EQU   FMTCNVF+1                                                08494000
FMTZS    EQU   FMTCNVF+1                                                08495000
@NM00022 EQU   FMTCNVF                                                  08496000
FMTPU    EQU   FMTCNVF                                                  08497000
FMTBD    EQU   FMTCNVF                                                  08498000
FMTBHD   EQU   FMTCNVF                                                  08499000
FMTBHA   EQU   FMTCNVF                                                  08500000
FMTBH    EQU   FMTCNVF                                                  08501000
FMTOLEN  EQU   FMTLIST+8                                                08502000
FMTRIO   EQU   FMTOCOL                                                  08503000
FMTSPT   EQU   FMTSTO                                                   08504000
FMTSTL   EQU   FMTILEN                                                  08505000
@NM00021 EQU   FMTFLGS+1                                                08506000
FMTSMSG  EQU   FMTFLGS+1                                                08507000
FMTHDF   EQU   FMTFLGS                                                  08508000
FMTDFF   EQU   FMTFLGS                                                  08509000
FMTSTF   EQU   FMTFLGS                                                  08510000
FMTREPF  EQU   FMTFLGS                                                  08511000
FMTBDF   EQU   FMTFLGS                                                  08512000
FMTIDF   EQU   FMTFLGS                                                  08513000
FMTSCF   EQU   FMTFLGS                                                  08514000
FMTEOLF  EQU   FMTFLGS                                                  08515000
DARGPCT  EQU   DARGINL                                                  08516000
DARGREP  EQU   DARGINS                                                  08517000
@NM00020 EQU   DARGFLGS                                                 08518000
DARGFULL EQU   DARGFLGS                                                 08519000
DARGIND  EQU   DARGLIST+18                                              08520000
DARGRETL EQU   DARGLIST+16                                              08521000
DARGRETP EQU   DARGLIST+4                                               08522000
UVOLVOL  EQU   UVOLENT+4                                                08523000
UVOLDEV  EQU   UVOLENT                                                  08524000
UVOLCNT  EQU   UVOLLIST                                                 08525000
@NM00019 EQU   IOINFOPT                                                 08526000
IOINFLUB EQU   IOINFOPT                                                 08527000
IOINFTMS EQU   IOINFOPT                                                 08528000
IOINFSUP EQU   IOINFOPT                                                 08529000
IOINFDSN EQU   IOINFOPT                                                 08530000
IOINFVOL EQU   IOINFOPT                                                 08531000
IOINFDVT EQU   IOINFOPT                                                 08532000
OPNVOL   EQU   OPNAGL+44                                                08533000
OPNSTRNO EQU   OPNAGL+43                                                08534000
@NM00018 EQU   OPNOPT2                                                  08535000
OPNOPTJM EQU   OPNOPT2                                                  08536000
OPNOPTAS EQU   OPNOPT2                                                  08537000
@NM00017 EQU   OPNDSO                                                   08538000
OPNDSOPO EQU   OPNDSO                                                   08539000
OPNDSOIS EQU   OPNDSO                                                   08540000
OPNDSOPS EQU   OPNDSO                                                   08541000
OPNDSOAM EQU   OPNDSO                                                   08542000
OPNKYL   EQU   OPNAGL+40                                                08543000
OPNDEVIX EQU   OPNDEV+4                                                 08544000
OPNCBP   EQU   OPNAGL+20                                                08545000
OPNMODRP EQU   OPNMOD                                                   08546000
OPNMODUB EQU   OPNMOD                                                   08547000
OPNMODRS EQU   OPNMOD                                                   08548000
OPNMODAX EQU   OPNMOD                                                   08549000
OPNMODRR EQU   OPNMOD                                                   08550000
OPNMODRC EQU   OPNMOD                                                   08551000
OPNMODAC EQU   OPNMOD                                                   08552000
OPNMODPD EQU   OPNMOD                                                   08553000
OPNTYPSY EQU   OPNTYP                                                   08554000
OPNTYPEX EQU   OPNTYP                                                   08555000
OPNTYPRA EQU   OPNTYP                                                   08556000
OPNTYPCI EQU   OPNTYP                                                   08557000
OPNTYPSO EQU   OPNTYP                                                   08558000
OPNTYPSI EQU   OPNTYP                                                   08559000
@NM00016 EQU   OPNRFM                                                   08560000
OPNRFMUN EQU   OPNRFM                                                   08561000
OPNRFMVR EQU   OPNRFM                                                   08562000
OPNRFMFX EQU   OPNRFM                                                   08563000
OPNOPTSK EQU   OPNOPT                                                   08564000
OPNOPTDR EQU   OPNOPT                                                   08565000
OPNOPTKS EQU   OPNOPT                                                   08566000
OPNOPTUP EQU   OPNOPT                                                   08567000
IOCEXT   EQU   IOCSTR+64                                                08568000
IOCTSML  EQU   IOCREL+2                                                 08569000
IOCTPML  EQU   IOCREL                                                   08570000
IOCWORK  EQU   IOCSTR+56                                                08571000
IOCRRN   EQU   IOCSTR+52                                                08572000
IOCPNM   EQU   IOCNWM+2                                                 08573000
IOCPTL   EQU   IOCNWM                                                   08574000
IOCKYA   EQU   IOCMEM                                                   08575000
IOCCBP   EQU   IOCSTR+36                                                08576000
IOCDSN   EQU   IOCSTR+32                                                08577000
IOCHURBA EQU   IOCSTR+28                                                08578000
IOCVOLSR EQU   IOCSTR+22                                                08579000
@NM00015 EQU   IOCMSG                                                   08580000
IOCMSGSM EQU   IOCMSG                                                   08581000
IOCMSGAE EQU   IOCMSG                                                   08582000
IOCMSGCE EQU   IOCMSG                                                   08583000
IOCMSGOE EQU   IOCMSG                                                   08584000
IOCCHPKG EQU   IOCMSG                                                   08585000
IOCCHPKE EQU   IOCMSG                                                   08586000
IOCCHPNU EQU   IOCCHP                                                   08587000
IOCCHPUP EQU   IOCCHP                                                   08588000
IOCCHPBK EQU   IOCCHP                                                   08589000
IOCCHPCR EQU   IOCCHP                                                   08590000
IOCCHPKS EQU   IOCCHP                                                   08591000
IOCCHPSK EQU   IOCCHP                                                   08592000
IOCCHPDR EQU   IOCCHP                                                   08593000
IOCCHPSQ EQU   IOCCHP                                                   08594000
IOCMACNT EQU   IOCMAC2                                                  08595000
IOCMACER EQU   IOCMAC2                                                  08596000
IOCMACPA EQU   IOCMAC2                                                  08597000
IOCMACEN EQU   IOCMAC2                                                  08598000
IOCMACCP EQU   IOCMAC2                                                  08599000
IOCMACRR EQU   IOCMAC2                                                  08600000
IOCMACAS EQU   IOCMAC2                                                  08601000
IOCMACSK EQU   IOCMAC2                                                  08602000
@NM00014 EQU   IOCMAC                                                   08603000
IOCMACCC EQU   IOCMAC                                                   08604000
IOCMACDR EQU   IOCMAC                                                   08605000
IOCMACBK EQU   IOCMAC                                                   08606000
IOCMACCR EQU   IOCMAC                                                   08607000
IOCMACUP EQU   IOCMAC                                                   08608000
IOCMACOT EQU   IOCMAC                                                   08609000
IOCMACIN EQU   IOCMAC                                                   08610000
@NM00013 EQU   IOCRFM                                                   08611000
IOCRFMBK EQU   IOCRFM                                                   08612000
IOCRFMSF EQU   IOCRFM                                                   08613000
IOCRFMUN EQU   IOCRFM                                                   08614000
IOCRFMVR EQU   IOCRFM                                                   08615000
IOCRFMFX EQU   IOCRFM                                                   08616000
@NM00012 EQU   IOCDSO                                                   08617000
IOCDSOPO EQU   IOCDSO                                                   08618000
IOCDSOIS EQU   IOCDSO                                                   08619000
IOCDSOPS EQU   IOCDSO                                                   08620000
IOCDSOAM EQU   IOCDSO                                                   08621000
IOCRKP   EQU   IOCSTR+13                                                08622000
IOCKYL   EQU   IOCSTR+12                                                08623000
UNITVTOC EQU   UNITABL+7                                                08624000
@NM00011 EQU   UNITSTAT                                                 08625000
UNITUSHR EQU   UNITSTAT                                                 08626000
UNITXSHR EQU   UNITSTAT                                                 08627000
UNITISHR EQU   UNITSTAT                                                 08628000
UNITUA   EQU   @NM00010+1                                               08629000
UNITCHA  EQU   @NM00010                                                 08630000
UNITUCB  EQU   UNITABL                                                  08631000
ALLUNCNT EQU   ALLAGL+30                                                08632000
ALLVLCNT EQU   ALLAGL+29                                                08633000
@NM00009 EQU   ALLOPT                                                   08634000
ALLOPTUN EQU   ALLOPT                                                   08635000
ALLOPTPV EQU   ALLOPT                                                   08636000
ALLOPTDS EQU   ALLOPT                                                   08637000
ALLOPTVL EQU   ALLOPT                                                   08638000
@NM00008 EQU   ALLORG+1                                                 08639000
ALLORGVS EQU   ALLORG+1                                                 08640000
@NM00007 EQU   ALLORG+1                                                 08641000
ALLORGGS EQU   ALLORG+1                                                 08642000
ALLORGUN EQU   ALLORG                                                   08643000
ALLORGPO EQU   ALLORG                                                   08644000
ALLORGMQ EQU   ALLORG                                                   08645000
ALLORGCQ EQU   ALLORG                                                   08646000
ALLORGCX EQU   ALLORG                                                   08647000
ALLORGDA EQU   ALLORG                                                   08648000
ALLORGPS EQU   ALLORG                                                   08649000
ALLORGIS EQU   ALLORG                                                   08650000
ALLDSPUN EQU   ALLDSP                                                   08651000
ALLDSPCG EQU   ALLDSP                                                   08652000
ALLDSPDE EQU   ALLDSP                                                   08653000
ALLDSPKP EQU   ALLDSP                                                   08654000
@NM00006 EQU   ALLDSP                                                   08655000
ALLSTSOD EQU   ALLSTS                                                   08656000
ALLSTSMD EQU   ALLSTS                                                   08657000
ALLSTSNW EQU   ALLSTS                                                   08658000
ALLSTSSR EQU   ALLSTS                                                   08659000
@NM00005 EQU   ALLSTS                                                   08660000
ALLPWD   EQU   ALLAGL+20                                                08661000
ALLVLP   EQU   ALLAGL+16                                                08662000
ALLULP   EQU   ALLAGL+12                                                08663000
ALLDDN   EQU   ALLAGL+4                                                 08664000
ALLDSN   EQU   ALLAGL                                                   08665000
CIRPID   EQU   CIRAGL+28                                                08666000
CIRPWD   EQU   CIRAGL+24                                                08667000
CIRCAT   EQU   CIRAGL+20                                                08668000
CIRWKP   EQU   CIRAGL+16                                                08669000
CIRTLR   EQU   CIRAGL+12                                                08670000
CIRHDR   EQU   CIRAGL+8                                                 08671000
CIRTLN   EQU   CIRAGL+6                                                 08672000
CIRHLN   EQU   CIRAGL+4                                                 08673000
@NM00004 EQU   CIRAGL+1                                                 08674000
@NM00003 EQU   CIRTYPE                                                  08675000
CIRTYPAQ EQU   CIRTYPE                                                  08676000
CIRTYP1Q EQU   CIRTYPE                                                  08677000
NEWID1   EQU   TRACE1+95                                                08678000
CALLID   EQU   OLDERID1+90                                              08679000
@NM00002 EQU   OLDERID1                                                 08680000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      08681000
@RC00396 EQU   @RC00395                                                 08682000
@RF00451 EQU   @RC00426                                                 08683000
@RC00535 EQU   @RC00534                                                 08684000
@RC00590 EQU   @RC00534                                                 08685000
@RF00604 EQU   @RC00534                                                 08686000
@RC01003 EQU   @RC01002                                                 08687000
@RF01071 EQU   @RC01066                                                 08688000
@RF01208 EQU   @RC01202                                                 08689000
@RC01333 EQU   @RC01318                                                 08690000
@RF01354 EQU   @RC01318                                                 08691000
@RF01512 EQU   @RC01506                                                 08692000
@RC01561 EQU   @RC01546                                                 08693000
@RC01572 EQU   @RC01546                                                 08694000
@RF01584 EQU   @RC01546                                                 08695000
@RF01646 EQU   @RC01544                                                 08696000
@RF01652 EQU   @RC01544                                                 08697000
@PB00015 EQU   @EL00001                                                 08698000
@RC00550 EQU   @RC00535                                                 08699000
@RF00564 EQU   @RC00535                                                 08700000
@PB00014 EQU   @PB00015                                                 08701000
@PB00013 EQU   @PB00014                                                 08702000
@PB00012 EQU   @PB00013                                                 08703000
@PB00011 EQU   @PB00012                                                 08704000
@PB00010 EQU   @PB00011                                                 08705000
@PB00009 EQU   @PB00010                                                 08706000
@PB00008 EQU   @PB00009                                                 08707000
@PB00007 EQU   @PB00008                                                 08708000
@PB00006 EQU   @PB00007                                                 08709000
@PB00005 EQU   @PB00006                                                 08710000
@PB00004 EQU   @PB00005                                                 08711000
@PB00003 EQU   @PB00004                                                 08712000
@PB00002 EQU   @PB00003                                                 08713000
@ENDDATA EQU   *                                                        08714000
         END   IDCRC02,(C'PLS2252',0701,77235)                          08715000
