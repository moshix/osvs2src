         TITLE 'IDCRD04: DEBLOCK REPAIRV FUNCTION                      *00001000
                        '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCRD04  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCRD04   77.300'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @09,0                                               0002 00021000
@PSTART  LA    @10,4095(,@09)                                      0002 00022000
         LA    @11,4095(,@10)                                      0002 00023000
         LA    @12,4095(,@11)                                      0002 00024000
         USING @PSTART,@09                                         0002 00025000
         USING @PSTART+4095,@10                                    0002 00026000
         USING @PSTART+8190,@11                                    0002 00027000
         USING @PSTART+12285,@12                                   0002 00028000
         L     @00,@SIZDATD                                        0002 00029000
         GETMAIN  R,LV=(0)                                              00030000
         LR    @06,@01                                             0002 00031000
         LA    @07,4095(,@06)                                      0002 00032000
         USING @DATD,@06                                           0002 00033000
         USING @DATD+4095,@07                                      0002 00034000
         ST    @13,@SA00001+4                                      0002 00035000
         LM    @00,@01,20(@13)                                     0002 00036000
         ST    @06,8(,@13)                                         0002 00037000
         LR    @13,@06                                             0002 00038000
         MVC   @PC00001(12),0(@01)                                 0002 00039000
*                                                                  0329 00040000
*   /*****************************************************************/ 00041000
*   /*                                                               */ 00042000
*   /* SET TRACE AND DUMP POINT                                      */ 00043000
*   /*                                                               */ 00044000
*   /*****************************************************************/ 00045000
*                                                                  0330 00046000
*   IF GDTDBG=NULLPTR THEN                                         0330 00047000
         L     @15,@PC00001                                        0330 00048000
         L     @15,GDTDBG(,@15)                                    0330 00049000
         LTR   @15,@15                                             0330 00050000
         BZ    @RT00330                                            0330 00051000
*     ;                                                            0331 00052000
*   ELSE                                                           0332 00053000
*     CALL IDCDB010(GDTTBL,'RD40');                                0332 00054000
         L     @15,@PC00001                                        0332 00055000
         ST    @15,@AL00001                                        0332 00056000
         LA    @15,@CC01480                                        0332 00057000
         ST    @15,@AL00001+4                                      0332 00058000
         MVI   @AL00001+4,X'80'                                    0332 00059000
         L     @14,@PC00001                                        0332 00060000
         L     @15,GDTDBG(,@14)                                    0332 00061000
         LA    @01,@AL00001                                        0332 00062000
         BALR  @14,@15                                             0332 00063000
*   OLDERID2=NEWERID2;                                             0333 00064000
@RT00330 L     @15,@PC00001                                        0333 00065000
         L     @01,GDTTR2(,@15)                                    0333 00066000
         L     @15,@PC00001                                        0333 00067000
         L     @15,GDTTR2(,@15)                                    0333 00068000
         MVC   @TS00001(95),NEWERID2(@15)                          0333 00069000
         MVC   OLDERID2(95,@01),@TS00001                           0333 00070000
*   NEWID2='RD41';                                                 0334 00071000
*                                                                  0334 00072000
         L     @15,@PC00001                                        0334 00073000
         L     @01,GDTTR2(,@15)                                    0334 00074000
         MVC   NEWID2(4,@01),@CC01481                              0334 00075000
*   /*****************************************************************/ 00076000
*   /*                                                               */ 00077000
*   /* CALL DEBLOCK ROUTINE                                          */ 00078000
*   /*                                                               */ 00079000
*   /*****************************************************************/ 00080000
*                                                                  0335 00081000
*   CALL IDCRD040;                                                 0335 00082000
*                                                                  0335 00083000
         BAL   @14,IDCRD040                                        0335 00084000
*   /*****************************************************************/ 00085000
*   /*                                                               */ 00086000
*   /* SAVE RETURN CODE FROM DEBLOCK ROUTINE                         */ 00087000
*   /*                                                               */ 00088000
*   /*****************************************************************/ 00089000
*                                                                  0336 00090000
*   RESPECIFY                                                      0336 00091000
*     RTNREG RSTD;                                                 0336 00092000
*   TESTRC=RTNREG;                                                 0337 00093000
         STH   RTNREG,TESTRC                                       0337 00094000
*   RESPECIFY                                                      0338 00095000
*     RTNREG UNRSTD;                                               0338 00096000
*                                                                  0338 00097000
*   /*****************************************************************/ 00098000
*   /*                                                               */ 00099000
*   /* SET DEBLOCK RETURN CODE IN LASTCC                             */ 00100000
*   /*                                                               */ 00101000
*   /*****************************************************************/ 00102000
*                                                                  0339 00103000
*   LASTCC=TESTRC;                                                 0339 00104000
         LH    @15,TESTRC                                          0339 00105000
         STH   @15,LASTCC                                          0339 00106000
*   IF REPRC=4 THEN                                                0340 00107000
         L     @15,@PC00001+8                                      0340 00108000
         CLC   REPRC(2,@15),@CH00045                               0340 00109000
         BNE   @RF00340                                            0340 00110000
*     LASTCC=4;                                                    0341 00111000
         MVC   LASTCC(2),@CH00045                                  0341 00112000
*   ELSE                                                           0342 00113000
*     ;                                                            0342 00114000
@RF00340 DS    0H                                                  0343 00115000
*   DO;                                                            0343 00116000
*     CKREQ=CKREQ&&CKREQ;                                          0344 00117000
         L     @15,@PC00001+8                                      0344 00118000
         XC    CKREQ(44,@15),CKREQ(@15)                            0344 00119000
*     CKRERN=MSG92;                                                0345 00120000
         L     @15,@PC00001+8                                      0345 00121000
         MVC   CKRERN(2,@15),@CH00864                              0345 00122000
*     CKRMVAR(1)=ADDR(REPRCDCT);                                   0346 00123000
         L     @15,@PC00001+8                                      0346 00124000
         L     @14,@PC00001+8                                      0346 00125000
         LA    @14,REPRCDCT(,@14)                                  0346 00126000
         ST    @14,CKRMVAR(,@15)                                   0346 00127000
*     CALL IDCRDER;                                                0347 00128000
         L     @15,@CV01407                                        0347 00129000
         BALR  @14,@15                                             0347 00130000
*   END;                                                           0348 00131000
*                                                                  0348 00132000
*   /*****************************************************************/ 00133000
*   /*                                                               */ 00134000
*   /* ISSUE UEPIL TO FREE STORAGE AND RETURN TO IDCRD01             */ 00135000
*   /*                                                               */ 00136000
*   /*****************************************************************/ 00137000
*                                                                  0349 00138000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                            0349 00139000
         L     @15,@PC00001                                        0349 00140000
         ST    @15,@AL00001                                        0349 00141000
         LA    @15,MODID                                           0349 00142000
         ST    @15,@AL00001+4                                      0349 00143000
         LA    @15,LASTCC                                          0349 00144000
         ST    @15,@AL00001+8                                      0349 00145000
         MVI   @AL00001+8,X'80'                                    0349 00146000
         L     @14,@PC00001                                        0349 00147000
         L     @15,GDTEPL(,@14)                                    0349 00148000
         LA    @01,@AL00001                                        0349 00149000
         BALR  @14,@15                                             0349 00150000
*IDCRD040:                                                         0350 00151000
*   PROCEDURE;                                                     0350 00152000
*                                                                  0350 00153000
@EL00001 L     @13,4(,@13)                                         0350 00154000
@EF00001 L     @00,@SIZDATD                                        0350 00155000
         LR    @01,@06                                             0350 00156000
         FREEMAIN R,LV=(0),A=(1)                                        00157000
@ER00001 LM    @14,@12,12(@13)                                     0350 00158000
         BR    @14                                                 0350 00159000
IDCRD040 STM   @14,@12,@SA00002                                    0350 00160000
*   /*****************************************************************/ 00161000
*   /*                                                               */ 00162000
*   /* CALL IDCRDRF TO OPEN THE REPAIR WORKFILE, READ THE HEADER     */ 00163000
*   /* RECORD AND GET CORE FOR RECORD 0 AND RECORD 1                 */ 00164000
*   /*                                                               */ 00165000
*   /*****************************************************************/ 00166000
*                                                                  0351 00167000
*   CALL IDCRDRF(OUT);                                             0351 00168000
         L     @15,@CV01406                                        0351 00169000
         LA    @01,@AL00351                                        0351 00170000
         BALR  @14,@15                                             0351 00171000
*   RESPECIFY                                                      0352 00172000
*     RTNREG RSTD;                                                 0352 00173000
*   TESTRC=RTNREG;                                                 0353 00174000
         STH   RTNREG,TESTRC                                       0353 00175000
*   RESPECIFY                                                      0354 00176000
*     RTNREG UNRSTD;                                               0354 00177000
*   REPRCDCT=0;                                                    0355 00178000
         L     @15,@PC00001+8                                      0355 00179000
         SLR   @14,@14                                             0355 00180000
         ST    @14,REPRCDCT(,@15)                                  0355 00181000
*   REPRC=0;                                                       0356 00182000
         L     @15,@PC00001+8                                      0356 00183000
         SLR   @14,@14                                             0356 00184000
         STH   @14,REPRC(,@15)                                     0356 00185000
*   IF TESTRC^=0 THEN                                              0357 00186000
*                                                                  0357 00187000
         LH    @15,TESTRC                                          0357 00188000
         LTR   @15,@15                                             0357 00189000
         BZ    @RF00357                                            0357 00190000
*     /***************************************************************/ 00191000
*     /*                                                             */ 00192000
*     /* NON-ZERO RETURN CODE - MESSAGE ALREADY ISSUED               */ 00193000
*     /*                                                             */ 00194000
*     /***************************************************************/ 00195000
*                                                                  0358 00196000
*     RETURN CODE(TESTRC);                                         0358 00197000
*                                                                  0358 00198000
         LH    @15,TESTRC                                          0358 00199000
         L     @14,@SA00002                                        0358 00200000
         LM    @00,@12,@SA00002+8                                  0358 00201000
         BR    @14                                                 0358 00202000
*   /*****************************************************************/ 00203000
*   /*                                                               */ 00204000
*   /* RETURN CODE OK                                                */ 00205000
*   /*                                                               */ 00206000
*   /*****************************************************************/ 00207000
*                                                                  0359 00208000
*   ELSE                                                           0359 00209000
*     ;                                                            0359 00210000
*                                                                  0359 00211000
@RF00357 DS    0H                                                  0360 00212000
*   /*****************************************************************/ 00213000
*   /*                                                               */ 00214000
*   /* ZERO OUT DBLTBL                                               */ 00215000
*   /*                                                               */ 00216000
*   /*****************************************************************/ 00217000
*                                                                  0360 00218000
*   DO ICNT1=1 TO DIM(DBLTBL);                                     0360 00219000
         LA    @15,1                                               0360 00220000
         STH   @15,ICNT1                                           0360 00221000
@DL00360 DS    0H                                                  0361 00222000
*     DBLTBL(ICNT1)=''B;                                           0361 00223000
         LH    @15,ICNT1                                           0361 00224000
         SLA   @15,3                                               0361 00225000
         LA    @14,DBLTBL-8(@15)                                   0361 00226000
         XC    0(8,@14),0(@14)                                     0361 00227000
*   END;                                                           0362 00228000
*                                                                  0362 00229000
         LA    @15,1                                               0362 00230000
         AH    @15,ICNT1                                           0362 00231000
         STH   @15,ICNT1                                           0362 00232000
         C     @15,@CF01269                                        0362 00233000
         BNH   @DL00360                                            0362 00234000
*   /*****************************************************************/ 00235000
*   /*                                                               */ 00236000
*   /* RWF HAS BEEN OPENED, SPACE ACQUIRED AND REPCB PTRS SET SET THE*/ 00237000
*   /* REPAIR WORKFILE DSNAME IN RWFDANA BUILD THE FIRST KEY IN THE  */ 00238000
*   /* RANGE FROM FDT IN CRNTKEY KEY CONSISTS OF VOLUME SERIAL       */ 00239000
*   /* NUMBER, CYLINDER AND AND HEAD ADDRESS AND RECORD NUMBER       */ 00240000
*   /* RESPECTIVELY SAVE THE BEGINNING TO REPBUFF0 AND REPBUFF1 IN   */ 00241000
*   /* CASE WE ARE DEBLOCKING MULTIPLE TRACKS                        */ 00242000
*   /*                                                               */ 00243000
*   /*****************************************************************/ 00244000
*                                                                  0363 00245000
*   RWFPTR1=REPORWIO->IOCDSN;                                      0363 00246000
         L     @15,@PC00001+8                                      0363 00247000
         L     @01,REPORWIO(,@15)                                  0363 00248000
         L     @15,IOCDSN(,@01)                                    0363 00249000
         ST    @15,RWFPTR1                                         0363 00250000
*   CRNVOLS=DBVOLVAL;                                              0364 00251000
         L     @15,@PC00001+4                                      0364 00252000
         L     @01,FDTPTR+296(,@15)                                0364 00253000
         MVC   CRNVOLS(6),DBVOLVAL(@01)                            0364 00254000
*   CRNCCHH=DBCCHVAL;                                              0365 00255000
         L     @15,@PC00001+4                                      0365 00256000
         L     @01,FDTPTR+300(,@15)                                0365 00257000
         MVC   CRNCCHH(4),DBCCHVAL(@01)                            0365 00258000
*   CRNR=ZERO;                                                     0366 00259000
         MVC   CRNR(1),ZERO+1                                      0366 00260000
*   SAVEBF0=REPBUFF0;                                              0367 00261000
         L     @15,@PC00001+8                                      0367 00262000
         L     @15,REPBUFF0(,@15)                                  0367 00263000
         ST    @15,SAVEBF0                                         0367 00264000
*   SAVEBF1=REPBUFF1;                                              0368 00265000
*                                                                  0368 00266000
         L     @15,@PC00001+8                                      0368 00267000
         L     @15,REPBUFF1(,@15)                                  0368 00268000
         ST    @15,SAVEBF1                                         0368 00269000
*   /*****************************************************************/ 00270000
*   /*                                                               */ 00271000
*   /* CHECK TO SEE IF ENDING TRACK ADDRESS HAS BEEN SUPPLIED -- IF  */ 00272000
*   /* IT IS THEN SET THAT TRACK ADDRESS IN THE LASTKEY IF IT IS     */ 00273000
*   /* VALID                                                         */ 00274000
*   /*                                                               */ 00275000
*   /*****************************************************************/ 00276000
*                                                                  0369 00277000
*   IF ADDR(DBHHH)^=NULLPTR THEN                                   0369 00278000
         L     @15,@PC00001+4                                      0369 00279000
         L     @15,FDTPTR+304(,@15)                                0369 00280000
         LTR   @15,@15                                             0369 00281000
         BZ    @RF00369                                            0369 00282000
*     DO;                                                          0370 00283000
*                                                                  0370 00284000
*       /*************************************************************/ 00285000
*       /*                                                           */ 00286000
*       /* ENDING TRACK SUPPLIED - CHECK TO SEE IF VALID             */ 00287000
*       /*                                                           */ 00288000
*       /*************************************************************/ 00289000
*                                                                  0371 00290000
*       IF DBHHHVAL<CHVAL THEN                                     0371 00291000
         L     @15,@PC00001+4                                      0371 00292000
         L     @01,FDTPTR+304(,@15)                                0371 00293000
         L     @15,@PC00001+4                                      0371 00294000
         L     @15,FDTPTR+300(,@15)                                0371 00295000
         CLC   DBHHHVAL(2,@01),CHVAL(@15)                          0371 00296000
         BNL   @RF00371                                            0371 00297000
*         DO;                                                      0372 00298000
*                                                                  0372 00299000
*           /*********************************************************/ 00300000
*           /*                                                       */ 00301000
*           /* ENDING TRACK BEFORE BEGINNING TRACK ISSUE ERROR       */ 00302000
*           /* MESSAGE, CLOSE REPAIR WORKFILE FREE GOTTEN SPACE, AND */ 00303000
*           /* RETURN CODE 12                                        */ 00304000
*           /*                                                       */ 00305000
*           /*********************************************************/ 00306000
*                                                                  0373 00307000
*           DO;                                                    0373 00308000
*             CKREQ=CKREQ&&CKREQ;                                  0374 00309000
         L     @15,@PC00001+8                                      0374 00310000
         XC    CKREQ(44,@15),CKREQ(@15)                            0374 00311000
*             CKRERN=MSG13;                                        0375 00312000
         L     @15,@PC00001+8                                      0375 00313000
         MVC   CKRERN(2,@15),@CH00611                              0375 00314000
*             CKRMVAR(1)=ADDR(CHVAL);                              0376 00315000
         L     @15,@PC00001+8                                      0376 00316000
         L     @14,@PC00001+4                                      0376 00317000
         L     @01,FDTPTR+300(,@14)                                0376 00318000
         LA    @14,CHVAL(,@01)                                     0376 00319000
         ST    @14,CKRMVAR(,@15)                                   0376 00320000
*             CKRMVAR(2)=ADDR(DBHHHVAL);                           0377 00321000
         L     @15,@PC00001+8                                      0377 00322000
         L     @14,@PC00001+4                                      0377 00323000
         L     @01,FDTPTR+304(,@14)                                0377 00324000
         LA    @14,DBHHHVAL(,@01)                                  0377 00325000
         ST    @14,CKRMVAR+4(,@15)                                 0377 00326000
*             CKRMVAR(3)=ADDR(RANGELIT);                           0378 00327000
         L     @15,@PC00001+8                                      0378 00328000
         LA    @14,RANGELIT                                        0378 00329000
         ST    @14,CKRMVAR+8(,@15)                                 0378 00330000
*             CKRMVAR(4)=ADDR(RWFDANA);                            0379 00331000
         L     @15,@PC00001+8                                      0379 00332000
         L     @14,RWFPTR1                                         0379 00333000
         ST    @14,CKRMVAR+12(,@15)                                0379 00334000
*             CALL IDCRDER;                                        0380 00335000
         L     @15,@CV01407                                        0380 00336000
         BALR  @14,@15                                             0380 00337000
*           END;                                                   0381 00338000
*           CALL IDCIOCL0(GDTTBL,REPORWIO);                        0382 00339000
         L     @15,@PC00001                                        0382 00340000
         ST    @15,@AL00001                                        0382 00341000
         L     @15,@PC00001+8                                      0382 00342000
         LA    @15,REPORWIO(,@15)                                  0382 00343000
         ST    @15,@AL00001+4                                      0382 00344000
         MVI   @AL00001+4,X'80'                                    0382 00345000
         L     @14,@PC00001                                        0382 00346000
         L     @15,GDTCLS(,@14)                                    0382 00347000
         LA    @01,@AL00001                                        0382 00348000
         BALR  @14,@15                                             0382 00349000
*           CALL IDCSAFP0(GDTTBL,POOLRD01,ALL);                    0383 00350000
         MVC   @AL00001+4(8),@AL00383                              0383 00351000
         L     @15,@PC00001                                        0383 00352000
         ST    @15,@AL00001                                        0383 00353000
         L     @14,@PC00001                                        0383 00354000
         L     @15,GDTFPL(,@14)                                    0383 00355000
         LA    @01,@AL00001                                        0383 00356000
         BALR  @14,@15                                             0383 00357000
*           RETURN CODE(LASTCC12);                                 0384 00358000
         LA    @15,12                                              0384 00359000
         L     @14,@SA00002                                        0384 00360000
         LM    @00,@12,@SA00002+8                                  0384 00361000
         BR    @14                                                 0384 00362000
*         END;                                                     0385 00363000
*                                                                  0385 00364000
*       /*************************************************************/ 00365000
*       /*                                                           */ 00366000
*       /* END TRACK VALID                                           */ 00367000
*       /*                                                           */ 00368000
*       /*************************************************************/ 00369000
*                                                                  0386 00370000
*       ELSE                                                       0386 00371000
*         DO;                                                      0386 00372000
*                                                                  0386 00373000
@RF00371 DS    0H                                                  0387 00374000
*           /*********************************************************/ 00375000
*           /*                                                       */ 00376000
*           /* SET LAST KEY TO SUPPLIED ENDING TRACK                 */ 00377000
*           /*                                                       */ 00378000
*           /*********************************************************/ 00379000
*                                                                  0387 00380000
*           LASTKEY=CRNTKEY;                                       0387 00381000
         MVC   LASTKEY(11),CRNTKEY                                 0387 00382000
*           LASTHH=DBHHHVAL;                                       0388 00383000
         L     @15,@PC00001+4                                      0388 00384000
         L     @01,FDTPTR+304(,@15)                                0388 00385000
         MVC   LASTHH(2),DBHHHVAL(@01)                             0388 00386000
*         END;                                                     0389 00387000
*                                                                  0389 00388000
*       /*************************************************************/ 00389000
*       /*                                                           */ 00390000
*       /* END OF NON-ZERO ENDING TRACK                              */ 00391000
*       /*                                                           */ 00392000
*       /*************************************************************/ 00393000
*                                                                  0390 00394000
*     END;                                                         0390 00395000
*                                                                  0390 00396000
*   /*****************************************************************/ 00397000
*   /*                                                               */ 00398000
*   /* ONLY ONE TRACK TO PROCESS SET LAST KEY TO SAME AS FIRST KEY   */ 00399000
*   /*                                                               */ 00400000
*   /*****************************************************************/ 00401000
*                                                                  0391 00402000
*   ELSE                                                           0391 00403000
*     LASTKEY=CRNTKEY;                                             0391 00404000
*                                                                  0391 00405000
         B     @RC00369                                            0391 00406000
@RF00369 MVC   LASTKEY(11),CRNTKEY                                 0391 00407000
*   /*****************************************************************/ 00408000
*   /*                                                               */ 00409000
*   /* NOW POSITION FOR FIRST RECORD ZERO                            */ 00410000
*   /*                                                               */ 00411000
*   /*****************************************************************/ 00412000
*                                                                  0392 00413000
*   WFIOKYA=ADDR(CRNTKEY);                                         0392 00414000
@RC00369 L     @15,@PC00001+8                                      0392 00415000
         LA    @14,CRNTKEY                                         0392 00416000
         ST    @14,WFIOKYA(,@15)                                   0392 00417000
*   DO;                                                            0393 00418000
*     WFREQ=''B;                                                   0394 00419000
         L     @15,@PC00001+8                                      0394 00420000
         XC    WFREQ(2,@15),WFREQ(@15)                             0394 00421000
*     WFRPOS=ON;                    /* POSRCD                        */ 00422000
         L     @15,@PC00001+8                                      0395 00423000
         OI    WFRPOS(@15),B'00001000'                             0395 00424000
*     CALL IDCRDIO;                                                0396 00425000
         L     @15,@CV01408                                        0396 00426000
         BALR  @14,@15                                             0396 00427000
*     RFY                                                          0397 00428000
*       RTNREG RSTD;                                               0397 00429000
*     TESTRC=RTNREG;                                               0398 00430000
         STH   RTNREG,TESTRC                                       0398 00431000
*     RFY                                                          0399 00432000
*       RTNREG UNRSTD;                                             0399 00433000
*   END;                                                           0400 00434000
*                                                                  0400 00435000
*   /*****************************************************************/ 00436000
*   /*                                                               */ 00437000
*   /* CHECK FOR RETURN CODE FROM POSITION                           */ 00438000
*   /*                                                               */ 00439000
*   /*****************************************************************/ 00440000
*                                                                  0401 00441000
*   IF TESTRC^=0 THEN                                              0401 00442000
         LH    @15,TESTRC                                          0401 00443000
         LTR   @15,@15                                             0401 00444000
         BZ    @RF00401                                            0401 00445000
*     DO;                                                          0402 00446000
*                                                                  0402 00447000
*       /*************************************************************/ 00448000
*       /*                                                           */ 00449000
*       /* IF RC=8 THEN ISSUE MESSAGE RECORD NOT FOUND               */ 00450000
*       /*                                                           */ 00451000
*       /*************************************************************/ 00452000
*                                                                  0403 00453000
*       IF TESTRC=8 THEN                                           0403 00454000
         CLC   TESTRC(2),@CH00181                                  0403 00455000
         BNE   @RF00403                                            0403 00456000
*         DO;                                                      0404 00457000
*           CKREQ=CKREQ&&CKREQ;                                    0405 00458000
         L     @15,@PC00001+8                                      0405 00459000
         XC    CKREQ(44,@15),CKREQ(@15)                            0405 00460000
*           CKRERN=MSG14;                                          0406 00461000
         L     @15,@PC00001+8                                      0406 00462000
         MVC   CKRERN(2,@15),@CH00617                              0406 00463000
*           CKRMVAR(1)=ADDR(CRNVOLS);                              0407 00464000
         L     @15,@PC00001+8                                      0407 00465000
         LA    @14,CRNVOLS                                         0407 00466000
         ST    @14,CKRMVAR(,@15)                                   0407 00467000
*           CKRMVAR(2)=ADDR(CRNCCHH);                              0408 00468000
         L     @15,@PC00001+8                                      0408 00469000
         LA    @14,CRNCCHH                                         0408 00470000
         ST    @14,CKRMVAR+4(,@15)                                 0408 00471000
*           CKRMVAR(3)=ADDR(RWFDANA);                              0409 00472000
         L     @15,@PC00001+8                                      0409 00473000
         L     @14,RWFPTR1                                         0409 00474000
         ST    @14,CKRMVAR+8(,@15)                                 0409 00475000
*           CALL IDCRDER;                                          0410 00476000
         L     @15,@CV01407                                        0410 00477000
         BALR  @14,@15                                             0410 00478000
*         END;                                                     0411 00479000
*                                                                  0411 00480000
*       /*************************************************************/ 00481000
*       /*                                                           */ 00482000
*       /* MESSAGE ALREADY ISSUED                                    */ 00483000
*       /*                                                           */ 00484000
*       /*************************************************************/ 00485000
*                                                                  0412 00486000
*       ELSE                                                       0412 00487000
*         ;                                                        0412 00488000
*                                                                  0412 00489000
@RF00403 DS    0H                                                  0413 00490000
*       /*************************************************************/ 00491000
*       /*                                                           */ 00492000
*       /* RETURN CODE NOT ZERO - CLOSE REPAIR WORKFILE FREE BUFFER  */ 00493000
*       /* SPACE AND RETURN CODE 12                                  */ 00494000
*       /*                                                           */ 00495000
*       /*************************************************************/ 00496000
*                                                                  0413 00497000
*       CALL IDCIOCL0(GDTTBL,REPORWIO);                            0413 00498000
         L     @15,@PC00001                                        0413 00499000
         ST    @15,@AL00001                                        0413 00500000
         L     @15,@PC00001+8                                      0413 00501000
         LA    @15,REPORWIO(,@15)                                  0413 00502000
         ST    @15,@AL00001+4                                      0413 00503000
         MVI   @AL00001+4,X'80'                                    0413 00504000
         L     @14,@PC00001                                        0413 00505000
         L     @15,GDTCLS(,@14)                                    0413 00506000
         LA    @01,@AL00001                                        0413 00507000
         BALR  @14,@15                                             0413 00508000
*       CALL IDCSAFP0(GDTTBL,POOLRD01,ALL);                        0414 00509000
         MVC   @AL00001+4(8),@AL00414                              0414 00510000
         L     @15,@PC00001                                        0414 00511000
         ST    @15,@AL00001                                        0414 00512000
         L     @14,@PC00001                                        0414 00513000
         L     @15,GDTFPL(,@14)                                    0414 00514000
         LA    @01,@AL00001                                        0414 00515000
         BALR  @14,@15                                             0414 00516000
*       RETURN CODE(LASTCC12);                                     0415 00517000
         LA    @15,12                                              0415 00518000
         L     @14,@SA00002                                        0415 00519000
         LM    @00,@12,@SA00002+8                                  0415 00520000
         BR    @14                                                 0415 00521000
*     END;                                                         0416 00522000
*   ELSE                                                           0417 00523000
*     ;                                                            0417 00524000
*                                                                  0417 00525000
@RF00401 DS    0H                                                  0418 00526000
*   /*****************************************************************/ 00527000
*   /*                                                               */ 00528000
*   /* RECORD ZERO FOR THE FIRST TRACK EXISTS LOOP UNTIL LAST TRACK  */ 00529000
*   /* HAS BEEN PROCESSED WE ARE POSITIONED TO THE RECORD ZERO RECORD*/ 00530000
*   /* IN THE TRACK AND WILL PROCESS EACH RECORD ZERO/RECORD ONE PAIR*/ 00531000
*   /* SEQUENTIALLY UNTIL THE LAST REQUESTED TRACK HAS BEEN PROCESSED*/ 00532000
*   /* FIRST INITIALIZE RETURN CODE                                  */ 00533000
*   /*                                                               */ 00534000
*   /*****************************************************************/ 00535000
*                                                                  0418 00536000
*   REPRC=0;                                                       0418 00537000
         L     @15,@PC00001+8                                      0418 00538000
         SLR   @14,@14                                             0418 00539000
         STH   @14,REPRC(,@15)                                     0418 00540000
*   DO WHILE(LASTKEY>=CRNTKEY);                                    0419 00541000
*                                                                  0419 00542000
         B     @DE00419                                            0419 00543000
@DL00419 DS    0H                                                  0420 00544000
*     /***************************************************************/ 00545000
*     /*                                                             */ 00546000
*     /* GET RECORD ZERO                                             */ 00547000
*     /*                                                             */ 00548000
*     /***************************************************************/ 00549000
*                                                                  0420 00550000
*     DO;                                                          0420 00551000
*       WFREQ=''B;                                                 0421 00552000
         L     @15,@PC00001+8                                      0421 00553000
         XC    WFREQ(2,@15),WFREQ(@15)                             0421 00554000
*       WFRGET=ON;                  /* GETRCD                        */ 00555000
         L     @15,@PC00001+8                                      0422 00556000
         OI    WFRGET(@15),B'00100000'                             0422 00557000
*       CALL IDCRDIO;                                              0423 00558000
         L     @15,@CV01408                                        0423 00559000
         BALR  @14,@15                                             0423 00560000
*       RFY                                                        0424 00561000
*         RTNREG RSTD;                                             0424 00562000
*       TESTRC=RTNREG;                                             0425 00563000
         STH   RTNREG,TESTRC                                       0425 00564000
*       RFY                                                        0426 00565000
*         RTNREG UNRSTD;                                           0426 00566000
*     END;                                                         0427 00567000
*                                                                  0427 00568000
*     /***************************************************************/ 00569000
*     /*                                                             */ 00570000
*     /* CHECK RETURN CODE FROM GET                                  */ 00571000
*     /*                                                             */ 00572000
*     /***************************************************************/ 00573000
*                                                                  0428 00574000
*     IF TESTRC^=0 THEN                                            0428 00575000
         LH    @15,TESTRC                                          0428 00576000
         LTR   @15,@15                                             0428 00577000
         BZ    @RF00428                                            0428 00578000
*       DO;                                                        0429 00579000
*                                                                  0429 00580000
*         /***********************************************************/ 00581000
*         /*                                                         */ 00582000
*         /* IF RC ^= 0, THEN BYPASS THIS R0/R1 PAIR IF RC=16 THEN   */ 00583000
*         /* ISSUE MESSAGE - R0 NOT FOUND IF RC ^= 0 & RC ^= 16, THEN*/ 00584000
*         /* MESSAGE ALREADY ISSUED                                  */ 00585000
*         /*                                                         */ 00586000
*         /***********************************************************/ 00587000
*                                                                  0430 00588000
*         IF TESTRC=16 THEN                                        0430 00589000
         CLC   TESTRC(2),@CH00475                                  0430 00590000
         BNE   @RF00430                                            0430 00591000
*           DO;                                                    0431 00592000
*             ZECCHH=CRNHH;                                        0432 00593000
         SLR   @15,@15                                             0432 00594000
         ICM   @15,3,CRNHH                                         0432 00595000
         ST    @15,ZECCHH                                          0432 00596000
*             ZERR=0;                                              0433 00597000
         MVI   ZERR,X'00'                                          0433 00598000
*             DO;                                                  0434 00599000
*               CKREQ=CKREQ&&CKREQ;                                0435 00600000
         L     @15,@PC00001+8                                      0435 00601000
         XC    CKREQ(44,@15),CKREQ(@15)                            0435 00602000
*               CKRERN=MSG16;                                      0436 00603000
         L     @15,@PC00001+8                                      0436 00604000
         MVC   CKRERN(2,@15),@CH00475                              0436 00605000
*               CKRMVAR(1)=ADDR(CRNVOLS);                          0437 00606000
         L     @15,@PC00001+8                                      0437 00607000
         LA    @14,CRNVOLS                                         0437 00608000
         ST    @14,CKRMVAR(,@15)                                   0437 00609000
*               CKRMVAR(2)=ADDR(ZEROCCHH);                         0438 00610000
         L     @15,@PC00001+8                                      0438 00611000
         LA    @14,ZEROCCHH                                        0438 00612000
         ST    @14,CKRMVAR+4(,@15)                                 0438 00613000
*               CKRMVAR(3)=ADDR(RWFDANA);                          0439 00614000
         L     @15,@PC00001+8                                      0439 00615000
         L     @14,RWFPTR1                                         0439 00616000
         ST    @14,CKRMVAR+8(,@15)                                 0439 00617000
*               CALL IDCRDER;                                      0440 00618000
         L     @15,@CV01407                                        0440 00619000
         BALR  @14,@15                                             0440 00620000
*             END;                                                 0441 00621000
*           END;                                                   0442 00622000
*         ELSE                                                     0443 00623000
*           ;                                                      0443 00624000
@RF00430 DS    0H                                                  0444 00625000
*         REPRC=4;                                                 0444 00626000
         L     @15,@PC00001+8                                      0444 00627000
         MVC   REPRC(2,@15),@CH00045                               0444 00628000
*       END;                                                       0445 00629000
*     ELSE                                                         0446 00630000
*                                                                  0446 00631000
*       /*************************************************************/ 00632000
*       /*                                                           */ 00633000
*       /* RETURN CODE OK                                            */ 00634000
*       /*                                                           */ 00635000
*       /*************************************************************/ 00636000
*                                                                  0446 00637000
*       DO;                                                        0446 00638000
*                                                                  0446 00639000
         B     @RC00428                                            0446 00640000
@RF00428 DS    0H                                                  0447 00641000
*         /***********************************************************/ 00642000
*         /*                                                         */ 00643000
*         /* RECORD ZERO GOTTEN OK - SAVE R0 IN AREA POINTED TO BY   */ 00644000
*         /* REPBUFF0                                                */ 00645000
*         /*                                                         */ 00646000
*         /***********************************************************/ 00647000
*                                                                  0447 00648000
*         RFY                                                      0447 00649000
*          (REG2,                                                  0447 00650000
*           REG3,                                                  0447 00651000
*           REG4,                                                  0447 00652000
*           REG5) RSTD;                                            0447 00653000
*         REG2=REPBUFF0;                                           0448 00654000
         L     @15,@PC00001+8                                      0448 00655000
         L     REG2,REPBUFF0(,@15)                                 0448 00656000
*         REG3=WFIODLN;                                            0449 00657000
         L     @15,@PC00001+8                                      0449 00658000
         L     REG3,WFIODLN(,@15)                                  0449 00659000
*         REG4=WFIODAD;                                            0450 00660000
         L     @15,@PC00001+8                                      0450 00661000
         L     REG4,WFIODAD(,@15)                                  0450 00662000
*         REG5=WFIODLN;                                            0451 00663000
         L     @15,@PC00001+8                                      0451 00664000
         L     REG5,WFIODLN(,@15)                                  0451 00665000
*         MVCL(REG2,REG4);                                         0452 00666000
         MVCL  REG2,REG4                                           0452 00667000
*         RFY                                                      0453 00668000
*          (REG2,                                                  0453 00669000
*           REG3,                                                  0453 00670000
*           REG4,                                                  0453 00671000
*           REG5) UNRSTD;                                          0453 00672000
*                                                                  0453 00673000
*         /***********************************************************/ 00674000
*         /*                                                         */ 00675000
*         /* SAVE RECORD ZERO LENGTH                                 */ 00676000
*         /*                                                         */ 00677000
*         /***********************************************************/ 00678000
*                                                                  0454 00679000
*         REPR0LN=WFIODLN;                                         0454 00680000
*                                                                  0454 00681000
         L     @15,@PC00001+8                                      0454 00682000
         L     @14,@PC00001+8                                      0454 00683000
         L     @14,WFIODLN(,@14)                                   0454 00684000
         STH   @14,REPR0LN(,@15)                                   0454 00685000
*         /***********************************************************/ 00686000
*         /*                                                         */ 00687000
*         /* NEXT SEQUENTIAL GET WILL GET RECORD ONE                 */ 00688000
*         /*                                                         */ 00689000
*         /***********************************************************/ 00690000
*                                                                  0455 00691000
*         DO;                                                      0455 00692000
*           WFREQ=''B;                                             0456 00693000
         L     @15,@PC00001+8                                      0456 00694000
         XC    WFREQ(2,@15),WFREQ(@15)                             0456 00695000
*           WFRGET=ON;              /* GETRCD                        */ 00696000
         L     @15,@PC00001+8                                      0457 00697000
         OI    WFRGET(@15),B'00100000'                             0457 00698000
*           CALL IDCRDIO;                                          0458 00699000
         L     @15,@CV01408                                        0458 00700000
         BALR  @14,@15                                             0458 00701000
*           RFY                                                    0459 00702000
*             RTNREG RSTD;                                         0459 00703000
*           TESTRC=RTNREG;                                         0460 00704000
         STH   RTNREG,TESTRC                                       0460 00705000
*           RFY                                                    0461 00706000
*             RTNREG UNRSTD;                                       0461 00707000
*         END;                                                     0462 00708000
*                                                                  0462 00709000
*         /***********************************************************/ 00710000
*         /*                                                         */ 00711000
*         /* TEST RETURN CODE FROM GET                               */ 00712000
*         /*                                                         */ 00713000
*         /***********************************************************/ 00714000
*                                                                  0463 00715000
*         IF TESTRC^=0 THEN                                        0463 00716000
         LH    @15,TESTRC                                          0463 00717000
         LTR   @15,@15                                             0463 00718000
         BZ    @RF00463                                            0463 00719000
*           DO;                                                    0464 00720000
*                                                                  0464 00721000
*             /*******************************************************/ 00722000
*             /*                                                     */ 00723000
*             /* IF RC ^= 0, THEN BYPASS THIS R0/R1 RECORD PAIR IF   */ 00724000
*             /* RC=16 THEN ISSUE MESSAGE IF RC ^=0 & RC ^= 16, THEN */ 00725000
*             /* MESSAGE ALREADY ISSUED                              */ 00726000
*             /*                                                     */ 00727000
*             /*******************************************************/ 00728000
*                                                                  0465 00729000
*             IF TESTRC=16 THEN                                    0465 00730000
         CLC   TESTRC(2),@CH00475                                  0465 00731000
         BNE   @RF00465                                            0465 00732000
*               DO;                                                0466 00733000
*                 ONCCHH=CRNHH;                                    0467 00734000
         SLR   @15,@15                                             0467 00735000
         ICM   @15,3,CRNHH                                         0467 00736000
         ST    @15,ONCCHH                                          0467 00737000
*                 ONER=1;                                          0468 00738000
         MVI   ONER,X'01'                                          0468 00739000
*                 DO;                                              0469 00740000
*                   CKREQ=CKREQ&&CKREQ;                            0470 00741000
         L     @15,@PC00001+8                                      0470 00742000
         XC    CKREQ(44,@15),CKREQ(@15)                            0470 00743000
*                   CKRERN=MSG17;                                  0471 00744000
         L     @15,@PC00001+8                                      0471 00745000
         MVC   CKRERN(2,@15),@CH00630                              0471 00746000
*                   CKRMVAR(1)=ADDR(CRNVOLS);                      0472 00747000
         L     @15,@PC00001+8                                      0472 00748000
         LA    @14,CRNVOLS                                         0472 00749000
         ST    @14,CKRMVAR(,@15)                                   0472 00750000
*                   CKRMVAR(2)=ADDR(ONECCHH);                      0473 00751000
         L     @15,@PC00001+8                                      0473 00752000
         LA    @14,ONECCHH                                         0473 00753000
         ST    @14,CKRMVAR+4(,@15)                                 0473 00754000
*                   CKRMVAR(3)=ADDR(RWFDANA);                      0474 00755000
         L     @15,@PC00001+8                                      0474 00756000
         L     @14,RWFPTR1                                         0474 00757000
         ST    @14,CKRMVAR+8(,@15)                                 0474 00758000
*                   CALL IDCRDER;                                  0475 00759000
         L     @15,@CV01407                                        0475 00760000
         BALR  @14,@15                                             0475 00761000
*                 END;                                             0476 00762000
*               END;                                               0477 00763000
*             ELSE                                                 0478 00764000
*               ;                                                  0478 00765000
@RF00465 DS    0H                                                  0479 00766000
*             REPRC=4;                                             0479 00767000
         L     @15,@PC00001+8                                      0479 00768000
         MVC   REPRC(2,@15),@CH00045                               0479 00769000
*           END;                                                   0480 00770000
*         ELSE                                                     0481 00771000
*           DO;                                                    0481 00772000
*                                                                  0481 00773000
         B     @RC00463                                            0481 00774000
@RF00463 DS    0H                                                  0482 00775000
*             /*******************************************************/ 00776000
*             /*                                                     */ 00777000
*             /* RECORD ONE GOTTEN OK SAVE R1 IN AREA POINTED BY     */ 00778000
*             /* REPBUFF1 USING MVCL FUNCTION                        */ 00779000
*             /*                                                     */ 00780000
*             /*******************************************************/ 00781000
*                                                                  0482 00782000
*             RFY                                                  0482 00783000
*              (REG2,                                              0482 00784000
*               REG3,                                              0482 00785000
*               REG4,                                              0482 00786000
*               REG5) RSTD;                                        0482 00787000
*             REG2=REPBUFF1;                                       0483 00788000
         L     @15,@PC00001+8                                      0483 00789000
         L     REG2,REPBUFF1(,@15)                                 0483 00790000
*             REG3=WFIODLN;                                        0484 00791000
         L     @15,@PC00001+8                                      0484 00792000
         L     REG3,WFIODLN(,@15)                                  0484 00793000
*             REG4=WFIODAD;                                        0485 00794000
         L     @15,@PC00001+8                                      0485 00795000
         L     REG4,WFIODAD(,@15)                                  0485 00796000
*             REG5=WFIODLN;                                        0486 00797000
         L     @15,@PC00001+8                                      0486 00798000
         L     REG5,WFIODLN(,@15)                                  0486 00799000
*             MVCL(REG2,REG4);                                     0487 00800000
         MVCL  REG2,REG4                                           0487 00801000
*             RFY                                                  0488 00802000
*              (REG2,                                              0488 00803000
*               REG3,                                              0488 00804000
*               REG4,                                              0488 00805000
*               REG5) UNRSTD;                                      0488 00806000
*                                                                  0488 00807000
*             /*******************************************************/ 00808000
*             /*                                                     */ 00809000
*             /* SAVE R1 LENGTH                                      */ 00810000
*             /*                                                     */ 00811000
*             /*******************************************************/ 00812000
*                                                                  0489 00813000
*             REPR1LN=WFIODLN;                                     0489 00814000
*                                                                  0489 00815000
         L     @15,@PC00001+8                                      0489 00816000
         L     @14,@PC00001+8                                      0489 00817000
         L     @14,WFIODLN(,@14)                                   0489 00818000
         STH   @14,REPR1LN(,@15)                                   0489 00819000
*             /*******************************************************/ 00820000
*             /*                                                     */ 00821000
*             /* CALL DBLKER TO DO THE DEBLOCKING                    */ 00822000
*             /*                                                     */ 00823000
*             /*******************************************************/ 00824000
*                                                                  0490 00825000
*             CALL DBLKER;                                         0490 00826000
         BAL   @14,DBLKER                                          0490 00827000
*             RESPECIFY                                            0491 00828000
*               RTNREG RSTD;                                       0491 00829000
*             TESTRC=RTNREG;                                       0492 00830000
         STH   RTNREG,TESTRC                                       0492 00831000
*             RESPECIFY                                            0493 00832000
*               RTNREG UNRSTD;                                     0493 00833000
*                                                                  0493 00834000
*             /*******************************************************/ 00835000
*             /*                                                     */ 00836000
*             /* CHECK RETURN CODE FROM DBLKER                       */ 00837000
*             /*                                                     */ 00838000
*             /*******************************************************/ 00839000
*                                                                  0494 00840000
*             IF TESTRC=0 THEN                                     0494 00841000
         LH    @15,TESTRC                                          0494 00842000
         LTR   @15,@15                                             0494 00843000
         BNZ   @RF00494                                            0494 00844000
*               DO;                                                0495 00845000
*                                                                  0495 00846000
*                 /***************************************************/ 00847000
*                 /*                                                 */ 00848000
*                 /* RETURNED OK ISSUE MESSAGE OF HOW MANY RECDS     */ 00849000
*                 /* DEBLOCKED                                       */ 00850000
*                 /*                                                 */ 00851000
*                 /***************************************************/ 00852000
*                                                                  0496 00853000
*                 DO;                                              0496 00854000
*                   CKREQ=CKREQ&&CKREQ;                            0497 00855000
         L     @15,@PC00001+8                                      0497 00856000
         XC    CKREQ(44,@15),CKREQ(@15)                            0497 00857000
*                   CKRERN=MSG36;                                  0498 00858000
         L     @15,@PC00001+8                                      0498 00859000
         MVC   CKRERN(2,@15),@CH00711                              0498 00860000
*                   CKRMVAR(1)=ADDR(CRNCCHH);                      0499 00861000
         L     @15,@PC00001+8                                      0499 00862000
         LA    @14,CRNCCHH                                         0499 00863000
         ST    @14,CKRMVAR(,@15)                                   0499 00864000
*                   CKRMVAR(2)=ADDR(OUTCNT);                       0500 00865000
         L     @15,@PC00001+8                                      0500 00866000
         LA    @14,OUTCNT                                          0500 00867000
         ST    @14,CKRMVAR+4(,@15)                                 0500 00868000
*                   CALL IDCRDER;                                  0501 00869000
         L     @15,@CV01407                                        0501 00870000
         BALR  @14,@15                                             0501 00871000
*                 END;                                             0502 00872000
*                 REPRCDCT=REPRCDCT+OUTCNT;                        0503 00873000
         L     @15,@PC00001+8                                      0503 00874000
         L     @14,@PC00001+8                                      0503 00875000
         LH    @05,OUTCNT                                          0503 00876000
         N     @05,@CF01511                                        0503 00877000
         AL    @05,REPRCDCT(,@14)                                  0503 00878000
         ST    @05,REPRCDCT(,@15)                                  0503 00879000
*               END;                                               0504 00880000
*             ELSE                                                 0505 00881000
*               IF TESTRC=12 THEN                                  0505 00882000
         B     @RC00494                                            0505 00883000
@RF00494 CLC   TESTRC(2),@CH00038                                  0505 00884000
         BNE   @RF00505                                            0505 00885000
*                 DO;                                              0506 00886000
*                   CALL IDCIOCL0(GDTTBL,REPORWIO);                0507 00887000
         L     @15,@PC00001                                        0507 00888000
         ST    @15,@AL00001                                        0507 00889000
         L     @15,@PC00001+8                                      0507 00890000
         LA    @15,REPORWIO(,@15)                                  0507 00891000
         ST    @15,@AL00001+4                                      0507 00892000
         MVI   @AL00001+4,X'80'                                    0507 00893000
         L     @14,@PC00001                                        0507 00894000
         L     @15,GDTCLS(,@14)                                    0507 00895000
         LA    @01,@AL00001                                        0507 00896000
         BALR  @14,@15                                             0507 00897000
*                   CALL IDCSAFP0(GDTTBL,POOLRD01);                0508 00898000
         L     @15,@PC00001                                        0508 00899000
         ST    @15,@AL00001                                        0508 00900000
         LA    @15,POOLRD01                                        0508 00901000
         ST    @15,@AL00001+4                                      0508 00902000
         MVI   @AL00001+4,X'80'                                    0508 00903000
         L     @14,@PC00001                                        0508 00904000
         L     @15,GDTFPL(,@14)                                    0508 00905000
         LA    @01,@AL00001                                        0508 00906000
         BALR  @14,@15                                             0508 00907000
*                   RETURN CODE(LASTCC12);                         0509 00908000
         LA    @15,12                                              0509 00909000
         L     @14,@SA00002                                        0509 00910000
         LM    @00,@12,@SA00002+8                                  0509 00911000
         BR    @14                                                 0509 00912000
*                 END;                                             0510 00913000
*                                                                  0510 00914000
*             /*******************************************************/ 00915000
*             /*                                                     */ 00916000
*             /* END OF READ RECORD ZERO AND RECORD ONE              */ 00917000
*             /*                                                     */ 00918000
*             /*******************************************************/ 00919000
*                                                                  0511 00920000
*           END;                                                   0511 00921000
*                                                                  0511 00922000
@RF00505 DS    0H                                                  0511 00923000
@RC00494 DS    0H                                                  0512 00924000
*         /***********************************************************/ 00925000
*         /*                                                         */ 00926000
*         /* END OF READ RECORD ZERO OK                              */ 00927000
*         /*                                                         */ 00928000
*         /***********************************************************/ 00929000
*                                                                  0512 00930000
*       END;                                                       0512 00931000
*                                                                  0512 00932000
@RC00463 DS    0H                                                  0513 00933000
*     /***************************************************************/ 00934000
*     /*                                                             */ 00935000
*     /* INCREMENT TRACK NUMBER FOR LOOP CONTROL NEXT SEQUENTIAL     */ 00936000
*     /* RECORD WILL BE NEXT R0 RESET POINTERS TO BEGINNING OF       */ 00937000
*     /* BUFFERS                                                     */ 00938000
*     /*                                                             */ 00939000
*     /***************************************************************/ 00940000
*                                                                  0513 00941000
*     CRNHH=CRNHH+1;                                               0513 00942000
@RC00428 LA    @15,1                                               0513 00943000
         SLR   @14,@14                                             0513 00944000
         ICM   @14,3,CRNHH                                         0513 00945000
         ALR   @15,@14                                             0513 00946000
         STCM  @15,3,CRNHH                                         0513 00947000
*     REPBUFF0=SAVEBF0;                                            0514 00948000
         L     @15,@PC00001+8                                      0514 00949000
         L     @14,SAVEBF0                                         0514 00950000
         ST    @14,REPBUFF0(,@15)                                  0514 00951000
*     REPBUFF1=SAVEBF1;                                            0515 00952000
*                                                                  0515 00953000
         L     @15,@PC00001+8                                      0515 00954000
         L     @14,SAVEBF1                                         0515 00955000
         ST    @14,REPBUFF1(,@15)                                  0515 00956000
*     /***************************************************************/ 00957000
*     /*                                                             */ 00958000
*     /* THE FOLLOWING CODE IS USED TO POSITION TO THE NEXT TRACK TO */ 00959000
*     /* DEBLOCK IF IT EXISTS IF THE NEXT TRACK ISNT THERE-A MESSAGE */ 00960000
*     /* WILL BE ISSUED REPRC WILL BE SET TO 4 AND THAT TRACK WILL BE*/ 00961000
*     /* BYPASS                                                      */ 00962000
*     /*                                                             */ 00963000
*     /***************************************************************/ 00964000
*                                                                  0516 00965000
*     IF CRNTKEY<=LASTKEY THEN                                     0516 00966000
         CLC   CRNTKEY(11),LASTKEY                                 0516 00967000
         BH    @RF00516                                            0516 00968000
*       DO UNTIL TESTRC=0|CRNTKEY>LASTKEY;                         0517 00969000
*                                                                  0517 00970000
@DL00517 DS    0H                                                  0518 00971000
*         /***********************************************************/ 00972000
*         /*                                                         */ 00973000
*         /* ISSUE A POSRCD TO LOCATE R0 FOR THIS TRACK              */ 00974000
*         /*                                                         */ 00975000
*         /***********************************************************/ 00976000
*                                                                  0518 00977000
*         WFIOKYA=ADDR(CRNTKEY);                                   0518 00978000
         L     @15,@PC00001+8                                      0518 00979000
         LA    @14,CRNTKEY                                         0518 00980000
         ST    @14,WFIOKYA(,@15)                                   0518 00981000
*         DO;                                                      0519 00982000
*           WFREQ=''B;                                             0520 00983000
         L     @15,@PC00001+8                                      0520 00984000
         XC    WFREQ(2,@15),WFREQ(@15)                             0520 00985000
*           WFRPOS=ON;              /* POSRCD                        */ 00986000
         L     @15,@PC00001+8                                      0521 00987000
         OI    WFRPOS(@15),B'00001000'                             0521 00988000
*           CALL IDCRDIO;                                          0522 00989000
         L     @15,@CV01408                                        0522 00990000
         BALR  @14,@15                                             0522 00991000
*           RFY                                                    0523 00992000
*             RTNREG RSTD;                                         0523 00993000
*           TESTRC=RTNREG;                                         0524 00994000
         STH   RTNREG,TESTRC                                       0524 00995000
*           RFY                                                    0525 00996000
*             RTNREG UNRSTD;                                       0525 00997000
*         END;                                                     0526 00998000
*                                                                  0526 00999000
*         /***********************************************************/ 01000000
*         /*                                                         */ 01001000
*         /* CHECK FOR RETURN CODE FROM POSITION                     */ 01002000
*         /*                                                         */ 01003000
*         /***********************************************************/ 01004000
*                                                                  0527 01005000
*         IF TESTRC^=0 THEN                                        0527 01006000
         LH    @15,TESTRC                                          0527 01007000
         LTR   @15,@15                                             0527 01008000
         BZ    @RF00527                                            0527 01009000
*           DO;                                                    0528 01010000
*                                                                  0528 01011000
*             /*******************************************************/ 01012000
*             /*                                                     */ 01013000
*             /* IF RC = 8 ISSUE MESSAGE THAT THIS R0/R1 PAIR NOT    */ 01014000
*             /* FOUND                                               */ 01015000
*             /*                                                     */ 01016000
*             /*******************************************************/ 01017000
*                                                                  0529 01018000
*             IF TESTRC=8 THEN                                     0529 01019000
         CLC   TESTRC(2),@CH00181                                  0529 01020000
         BNE   @RF00529                                            0529 01021000
*               DO;                                                0530 01022000
*                 ZECCHH=CRNHH;                                    0531 01023000
         SLR   @15,@15                                             0531 01024000
         ICM   @15,3,CRNHH                                         0531 01025000
         ST    @15,ZECCHH                                          0531 01026000
*                 ZERR=0;                                          0532 01027000
         MVI   ZERR,X'00'                                          0532 01028000
*                 DO;                                              0533 01029000
*                   CKREQ=CKREQ&&CKREQ;                            0534 01030000
         L     @15,@PC00001+8                                      0534 01031000
         XC    CKREQ(44,@15),CKREQ(@15)                            0534 01032000
*                   CKRERN=MSG16;                                  0535 01033000
         L     @15,@PC00001+8                                      0535 01034000
         MVC   CKRERN(2,@15),@CH00475                              0535 01035000
*                   CKRMVAR(1)=ADDR(CRNVOLS);                      0536 01036000
         L     @15,@PC00001+8                                      0536 01037000
         LA    @14,CRNVOLS                                         0536 01038000
         ST    @14,CKRMVAR(,@15)                                   0536 01039000
*                   CKRMVAR(2)=ADDR(ZEROCCHH);                     0537 01040000
         L     @15,@PC00001+8                                      0537 01041000
         LA    @14,ZEROCCHH                                        0537 01042000
         ST    @14,CKRMVAR+4(,@15)                                 0537 01043000
*                   CKRMVAR(3)=ADDR(RWFDANA);                      0538 01044000
         L     @15,@PC00001+8                                      0538 01045000
         L     @14,RWFPTR1                                         0538 01046000
         ST    @14,CKRMVAR+8(,@15)                                 0538 01047000
*                   CALL IDCRDER;                                  0539 01048000
         L     @15,@CV01407                                        0539 01049000
         BALR  @14,@15                                             0539 01050000
*                 END;                                             0540 01051000
*               END;                                               0541 01052000
*                                                                  0541 01053000
*             /*******************************************************/ 01054000
*             /*                                                     */ 01055000
*             /* MESSAGE ALREADY ISSUED                              */ 01056000
*             /*                                                     */ 01057000
*             /*******************************************************/ 01058000
*                                                                  0542 01059000
*             ELSE                                                 0542 01060000
*               ;                                                  0542 01061000
*                                                                  0542 01062000
@RF00529 DS    0H                                                  0543 01063000
*             /*******************************************************/ 01064000
*             /*                                                     */ 01065000
*             /* SET FUTURE RETURN CODE TO 4 AND BYPASS THIS R0/R1   */ 01066000
*             /* PAIR                                                */ 01067000
*             /*                                                     */ 01068000
*             /*******************************************************/ 01069000
*                                                                  0543 01070000
*             REPRC=4;                                             0543 01071000
         L     @15,@PC00001+8                                      0543 01072000
         MVC   REPRC(2,@15),@CH00045                               0543 01073000
*             CRNHH=CRNHH+1;                                       0544 01074000
         LA    @15,1                                               0544 01075000
         SLR   @14,@14                                             0544 01076000
         ICM   @14,3,CRNHH                                         0544 01077000
         ALR   @15,@14                                             0544 01078000
         STCM  @15,3,CRNHH                                         0544 01079000
*           END;                                                   0545 01080000
*                                                                  0545 01081000
*         /***********************************************************/ 01082000
*         /*                                                         */ 01083000
*         /* RETURN CODE ZERO FROM POSRCD                            */ 01084000
*         /*                                                         */ 01085000
*         /***********************************************************/ 01086000
*                                                                  0546 01087000
*         ELSE                                                     0546 01088000
*           ;                                                      0546 01089000
*                                                                  0546 01090000
@RF00527 DS    0H                                                  0547 01091000
*         /***********************************************************/ 01092000
*         /*                                                         */ 01093000
*         /* END DO UNTIL                                            */ 01094000
*         /*                                                         */ 01095000
*         /***********************************************************/ 01096000
*                                                                  0547 01097000
*       END;                                                       0547 01098000
*                                                                  0547 01099000
@DE00517 LH    @15,TESTRC                                          0547 01100000
         LTR   @15,@15                                             0547 01101000
         BZ    @DC00517                                            0547 01102000
         CLC   CRNTKEY(11),LASTKEY                                 0547 01103000
         BNH   @DL00517                                            0547 01104000
@DC00517 DS    0H                                                  0548 01105000
*     /***************************************************************/ 01106000
*     /*                                                             */ 01107000
*     /* NO MORE TRACKS TO DEBLOCK                                   */ 01108000
*     /*                                                             */ 01109000
*     /***************************************************************/ 01110000
*                                                                  0548 01111000
*     ELSE                                                         0548 01112000
*       ;                                                          0548 01113000
*                                                                  0548 01114000
@RF00516 DS    0H                                                  0549 01115000
*     /***************************************************************/ 01116000
*     /*                                                             */ 01117000
*     /* END OF DO WHILE                                             */ 01118000
*     /*                                                             */ 01119000
*     /***************************************************************/ 01120000
*                                                                  0549 01121000
*   END;                                                           0549 01122000
*                                                                  0549 01123000
@DE00419 CLC   LASTKEY(11),CRNTKEY                                 0549 01124000
         BNL   @DL00419                                            0549 01125000
*   /*****************************************************************/ 01126000
*   /*                                                               */ 01127000
*   /* ALL RECORDS HAVE BEEN DEBLOCKED CLOSE THE REPAIRWORKFILE, FREE*/ 01128000
*   /* THE BUFFER SPACE AND RETURN WITH EVERYTHING OK                */ 01129000
*   /*                                                               */ 01130000
*   /*****************************************************************/ 01131000
*                                                                  0550 01132000
*   CALL IDCIOCL0(GDTTBL,REPORWIO);                                0550 01133000
         L     @15,@PC00001                                        0550 01134000
         ST    @15,@AL00001                                        0550 01135000
         L     @15,@PC00001+8                                      0550 01136000
         LA    @15,REPORWIO(,@15)                                  0550 01137000
         ST    @15,@AL00001+4                                      0550 01138000
         MVI   @AL00001+4,X'80'                                    0550 01139000
         L     @14,@PC00001                                        0550 01140000
         L     @15,GDTCLS(,@14)                                    0550 01141000
         LA    @01,@AL00001                                        0550 01142000
         BALR  @14,@15                                             0550 01143000
*   CALL IDCSAFP0(GDTTBL,POOLRD01);                                0551 01144000
         L     @15,@PC00001                                        0551 01145000
         ST    @15,@AL00001                                        0551 01146000
         LA    @15,POOLRD01                                        0551 01147000
         ST    @15,@AL00001+4                                      0551 01148000
         MVI   @AL00001+4,X'80'                                    0551 01149000
         L     @14,@PC00001                                        0551 01150000
         L     @15,GDTFPL(,@14)                                    0551 01151000
         LA    @01,@AL00001                                        0551 01152000
         BALR  @14,@15                                             0551 01153000
*   TESTRC=0;                                                      0552 01154000
         SLR   @15,@15                                             0552 01155000
         STH   @15,TESTRC                                          0552 01156000
*   RETURN CODE(TESTRC);                                           0553 01157000
         LH    @15,TESTRC                                          0553 01158000
         L     @14,@SA00002                                        0553 01159000
         LM    @00,@12,@SA00002+8                                  0553 01160000
         BR    @14                                                 0553 01161000
*                                                                  0554 01162000
*/********************************************************************/ 01163000
*/*                                                                  */ 01164000
*/*  PROCEDURE NAME - DBLKER                                         */ 01165000
*/*                                                                  */ 01166000
*/*  FUNCTION - TO DEBLOCK AN R'0/R'1 PAIR OF STAGE ERROR            */ 01167000
*/*      RECORDS INTO THEIR R'0 TO R'N RECORDS                       */ 01168000
*/*                                                                  */ 01169000
*/*                                                                  */ 01170000
*/*                                                                  */ 01171000
*/*  MESSAGES - ISSUES THE FOLLOWING ERROR MESSAGES                  */ 01172000
*/*                                                                  */ 01173000
*/*     IDC11218I- THE RECORD HAS ALREADY BEEN MODIFIED- OR IF       */ 01174000
*/*                IT IS NOT A STAGE ERROR RECORD                    */ 01175000
*/*                                                                  */ 01176000
*/*     IDC11217I- THE R'1 RECORD WAS NOT FOUND                      */ 01177000
*/*                                                                  */ 01178000
*/*                                                                  */ 01179000
*/*     IDC11219I- THE DEBLOCKED RECORDS WILL NOT FIT ON THE TRACK   */ 01180000
*/*                                                                  */ 01181000
*/*     IDC11244I- STAGE ERROR IN A CYLINDER                         */ 01182000
*/*                                                                  */ 01183000
*/*     IDC31237I- BAD LENGTH PARAMETER                              */ 01184000
*/*                                                                  */ 01185000
*/*  MACROS/SVCS                                                     */ 01186000
*/*                                                                  */ 01187000
*/*     ?CALLCKER - TO PRINT A MESSAGE                               */ 01188000
*/*                                                                  */ 01189000
*/*     ?UPDRCD = TO WRITE DEBLOCKED RECORDS TO THE REPAIR WORKFILE  */ 01190000
*/*                                                                  */ 01191000
*/*  INPUT -                                                         */ 01192000
*/*         REPTBL - INCLUDING THE REPCB AND THE LENGTHS OF          */ 01193000
*/*                  R'0 AND R'1                                     */ 01194000
*/*                                                                  */ 01195000
*/*                                                                  */ 01196000
*/*  OUTPUT - DEBLOCKED RECORDS IN THE REPAIR WORK FILE              */ 01197000
*/*                                                                  */ 01198000
*/********************************************************************/ 01199000
*                                                                  0554 01200000
*DBLKER:                                                           0554 01201000
*   PROC;                                                          0554 01202000
*                                                                  0554 01203000
DBLKER   STM   @14,@12,@SA00003                                    0554 01204000
*   /*****************************************************************/ 01205000
*   /*                                                               */ 01206000
*   /* SET UP ADDRESSABILITY                                         */ 01207000
*   /*                                                               */ 01208000
*   /*****************************************************************/ 01209000
*                                                                  0555 01210000
*   RFY                                                            0555 01211000
*     RB0 BASED(REPBUFF0);                                         0555 01212000
*   RFY                                                            0556 01213000
*     RB1 BASED(REPBUFF1);                                         0556 01214000
*   IF GDTDBG=NULLPTR THEN                                         0557 01215000
         L     @15,@PC00001                                        0557 01216000
         L     @15,GDTDBG(,@15)                                    0557 01217000
         LTR   @15,@15                                             0557 01218000
         BZ    @RT00557                                            0557 01219000
*     ;                                                            0558 01220000
*   ELSE                                                           0559 01221000
*     CALL IDCDB010(GDTTBL,'RD42');                                0559 01222000
         L     @15,@PC00001                                        0559 01223000
         ST    @15,@AL00001                                        0559 01224000
         LA    @15,@CC01495                                        0559 01225000
         ST    @15,@AL00001+4                                      0559 01226000
         MVI   @AL00001+4,X'80'                                    0559 01227000
         L     @14,@PC00001                                        0559 01228000
         L     @15,GDTDBG(,@14)                                    0559 01229000
         LA    @01,@AL00001                                        0559 01230000
         BALR  @14,@15                                             0559 01231000
*   OLDERID2=NEWERID2;                                             0560 01232000
@RT00557 L     @15,@PC00001                                        0560 01233000
         L     @01,GDTTR2(,@15)                                    0560 01234000
         L     @15,@PC00001                                        0560 01235000
         L     @15,GDTTR2(,@15)                                    0560 01236000
         MVC   @TS00001(95),NEWERID2(@15)                          0560 01237000
         MVC   OLDERID2(95,@01),@TS00001                           0560 01238000
*   NEWID2='RD43';                                                 0561 01239000
*                                                                  0561 01240000
         L     @15,@PC00001                                        0561 01241000
         L     @01,GDTTR2(,@15)                                    0561 01242000
         MVC   NEWID2(4,@01),@CC01496                              0561 01243000
*   /*****************************************************************/ 01244000
*   /*                                                               */ 01245000
*   /* CHECK THAT THE SECOND RECORD READ IS THE R'1 RECORD           */ 01246000
*   /* CORRESPONDING TO THE R'0 RECORD PREVIOUSLY READ               */ 01247000
*   /*                                                               */ 01248000
*   /*****************************************************************/ 01249000
*                                                                  0562 01250000
*   IF RB1KR^=1|RB1KVCH^=RB0KVCH THEN                              0562 01251000
         L     @15,@PC00001+8                                      0562 01252000
         L     @01,REPBUFF1(,@15)                                  0562 01253000
         CLI   RB1KR(@01),1                                        0562 01254000
         BNE   @RT00562                                            0562 01255000
         L     @15,@PC00001+8                                      0562 01256000
         L     @01,REPBUFF1(,@15)                                  0562 01257000
         L     @15,@PC00001+8                                      0562 01258000
         L     @15,REPBUFF0(,@15)                                  0562 01259000
         CLC   RB1KVCH(10,@01),RB0KVCH(@15)                        0562 01260000
         BE    @RF00562                                            0562 01261000
@RT00562 DS    0H                                                  0563 01262000
*     DO;                                                          0563 01263000
*       ONCCHH=CRNHH;                                              0564 01264000
         SLR   @15,@15                                             0564 01265000
         ICM   @15,3,CRNHH                                         0564 01266000
         ST    @15,ONCCHH                                          0564 01267000
*       ONER=1;                                                    0565 01268000
         MVI   ONER,X'01'                                          0565 01269000
*       DO;                                                        0566 01270000
*         CKREQ=CKREQ&&CKREQ;                                      0567 01271000
         L     @15,@PC00001+8                                      0567 01272000
         XC    CKREQ(44,@15),CKREQ(@15)                            0567 01273000
*         CKRERN=MSG17;                                            0568 01274000
         L     @15,@PC00001+8                                      0568 01275000
         MVC   CKRERN(2,@15),@CH00630                              0568 01276000
*         CKRMVAR(1)=ADDR(CRNVOLS);                                0569 01277000
         L     @15,@PC00001+8                                      0569 01278000
         LA    @14,CRNVOLS                                         0569 01279000
         ST    @14,CKRMVAR(,@15)                                   0569 01280000
*         CKRMVAR(2)=ADDR(ONECCHH);                                0570 01281000
         L     @15,@PC00001+8                                      0570 01282000
         LA    @14,ONECCHH                                         0570 01283000
         ST    @14,CKRMVAR+4(,@15)                                 0570 01284000
*         CKRMVAR(3)=ADDR(RWFDANA);                                0571 01285000
         L     @15,@PC00001+8                                      0571 01286000
         L     @14,RWFPTR1                                         0571 01287000
         ST    @14,CKRMVAR+8(,@15)                                 0571 01288000
*         CALL IDCRDER;                                            0572 01289000
         L     @15,@CV01407                                        0572 01290000
         BALR  @14,@15                                             0572 01291000
*       END;                                                       0573 01292000
*       REPRC=4;                                                   0574 01293000
         L     @15,@PC00001+8                                      0574 01294000
         MVC   REPRC(2,@15),@CH00045                               0574 01295000
*       RETURN CODE(LASTCC04);                                     0575 01296000
         LA    @15,4                                               0575 01297000
         L     @14,@SA00003                                        0575 01298000
         LM    @00,@12,@SA00003+8                                  0575 01299000
         BR    @14                                                 0575 01300000
*     END;                                                         0576 01301000
*   ELSE                                                           0577 01302000
*     ;                                                            0577 01303000
*                                                                  0577 01304000
@RF00562 DS    0H                                                  0578 01305000
*   /*****************************************************************/ 01306000
*   /*                                                               */ 01307000
*   /* ENSURE R0 & R1 ARE STAGE ERROR RECORDS                        */ 01308000
*   /*                                                               */ 01309000
*   /*****************************************************************/ 01310000
*                                                                  0578 01311000
*   IF RB0FMOD=2|RB0FMOD=3|RB1FMOD=2|RB1FMOD=3|RB0FERR^=5|(RB1FERR^=9&  01312000
*       RB1FERR^=10) THEN                                          0578 01313000
         L     @15,@PC00001+8                                      0578 01314000
         L     @01,REPBUFF0(,@15)                                  0578 01315000
         CLI   RB0FMOD(@01),2                                      0578 01316000
         BE    @RT00578                                            0578 01317000
         L     @15,@PC00001+8                                      0578 01318000
         L     @01,REPBUFF0(,@15)                                  0578 01319000
         CLI   RB0FMOD(@01),3                                      0578 01320000
         BE    @RT00578                                            0578 01321000
         L     @15,@PC00001+8                                      0578 01322000
         L     @01,REPBUFF1(,@15)                                  0578 01323000
         CLI   RB1FMOD(@01),2                                      0578 01324000
         BE    @RT00578                                            0578 01325000
         L     @15,@PC00001+8                                      0578 01326000
         L     @01,REPBUFF1(,@15)                                  0578 01327000
         CLI   RB1FMOD(@01),3                                      0578 01328000
         BE    @RT00578                                            0578 01329000
         L     @15,@PC00001+8                                      0578 01330000
         L     @01,REPBUFF0(,@15)                                  0578 01331000
         CLC   RB0FERR(2,@01),@CH00288                             0578 01332000
         BNE   @RT00578                                            0578 01333000
         L     @15,@PC00001+8                                      0578 01334000
         L     @01,REPBUFF1(,@15)                                  0578 01335000
         CLC   RB1FERR(2,@01),@CH00035                             0578 01336000
         BE    @RF00578                                            0578 01337000
         L     @15,@PC00001+8                                      0578 01338000
         L     @01,REPBUFF1(,@15)                                  0578 01339000
         CLC   RB1FERR(2,@01),@CH00036                             0578 01340000
         BE    @RF00578                                            0578 01341000
@RT00578 DS    0H                                                  0579 01342000
*     DO;                                                          0579 01343000
*                                                                  0579 01344000
*       /*************************************************************/ 01345000
*       /*                                                           */ 01346000
*       /* R'0 AND R'1 ARE NOT STAGE ERROR RECORDS. THIS PAIR IS     */ 01347000
*       /* BYPASSED ISSUE MESSAGE AND RETURN CODE 04                 */ 01348000
*       /*                                                           */ 01349000
*       /*************************************************************/ 01350000
*                                                                  0580 01351000
*       DO;                                                        0580 01352000
*         CKREQ=CKREQ&&CKREQ;                                      0581 01353000
         L     @15,@PC00001+8                                      0581 01354000
         XC    CKREQ(44,@15),CKREQ(@15)                            0581 01355000
*         CKRERN=MSG18;                                            0582 01356000
         L     @15,@PC00001+8                                      0582 01357000
         MVC   CKRERN(2,@15),@CH00632                              0582 01358000
*         CKRMVAR(1)=ADDR(CRNTKEY);                                0583 01359000
         L     @15,@PC00001+8                                      0583 01360000
         LA    @14,CRNTKEY                                         0583 01361000
         ST    @14,CKRMVAR(,@15)                                   0583 01362000
*         CKRMVAR(2)=ADDR(CRNCCHH);                                0584 01363000
         L     @15,@PC00001+8                                      0584 01364000
         LA    @14,CRNCCHH                                         0584 01365000
         ST    @14,CKRMVAR+4(,@15)                                 0584 01366000
*         CKRMVAR(3)=ADDR(RWFDANA);                                0585 01367000
         L     @15,@PC00001+8                                      0585 01368000
         L     @14,RWFPTR1                                         0585 01369000
         ST    @14,CKRMVAR+8(,@15)                                 0585 01370000
*         CALL IDCRDER;                                            0586 01371000
         L     @15,@CV01407                                        0586 01372000
         BALR  @14,@15                                             0586 01373000
*       END;                                                       0587 01374000
*       REPRC=4;                                                   0588 01375000
         L     @15,@PC00001+8                                      0588 01376000
         MVC   REPRC(2,@15),@CH00045                               0588 01377000
*       RETURN CODE(LASTCC04);                                     0589 01378000
         LA    @15,4                                               0589 01379000
         L     @14,@SA00003                                        0589 01380000
         LM    @00,@12,@SA00003+8                                  0589 01381000
         BR    @14                                                 0589 01382000
*     END;                                                         0590 01383000
*   ELSE                                                           0591 01384000
*     ;                                                            0591 01385000
*                                                                  0591 01386000
@RF00578 DS    0H                                                  0592 01387000
*   /*****************************************************************/ 01388000
*   /*                                                               */ 01389000
*   /* CK IF R'1 DATA FIELD LENGTH IS ONE OR IF THE          @ZA25908*/ 01390000
*   /* ORIGINAL RECORD 1 LENGTH IS ZERO, IF IT IS,           @ZA25908*/ 01391000
*   /* GET OUT. BAD CYLINDER CREATED BY STAGING PROCESS      @ZA25908*/ 01392000
*   /* OR THE SA WAS NOT ABLE TO READ THE DATA FROM THE      @ZA25908*/ 01393000
*   /* DATA SET LEAVING THE DATA RECORD DATA ALL ZEROES.@ZA25908     */ 01394000
*   /*                                                               */ 01395000
*   /*****************************************************************/ 01396000
*                                                                  0592 01397000
*   IF RB1CDL=1|RB00DKDL=0 THEN     /*                       @ZA25908*/ 01398000
         L     @15,@PC00001+8                                      0592 01399000
         L     @01,REPBUFF1(,@15)                                  0592 01400000
         CLC   RB1CDL(2,@01),@CH00221                              0592 01401000
         BE    @RT00592                                            0592 01402000
         L     @15,@PC00001+8                                      0592 01403000
         L     @01,REPBUFF0(,@15)                                  0592 01404000
         ICM   @00,3,RB00DKDL(@01)                                 0592 01405000
         BNZ   @RF00592                                            0592 01406000
@RT00592 DS    0H                                                  0593 01407000
*     DO;                                                          0593 01408000
*       DO;                                                        0594 01409000
*         CKREQ=CKREQ&&CKREQ;                                      0595 01410000
         L     @15,@PC00001+8                                      0595 01411000
         XC    CKREQ(44,@15),CKREQ(@15)                            0595 01412000
*         CKRERN=MSG44;                                            0596 01413000
         L     @15,@PC00001+8                                      0596 01414000
         MVC   CKRERN(2,@15),@CH00600                              0596 01415000
*         CKRMVAR(1)=ADDR(RB1CCHH);                                0597 01416000
         L     @15,@PC00001+8                                      0597 01417000
         L     @14,@PC00001+8                                      0597 01418000
         L     @01,REPBUFF1(,@14)                                  0597 01419000
         LA    @14,RB1CCHH(,@01)                                   0597 01420000
         ST    @14,CKRMVAR(,@15)                                   0597 01421000
*         CALL IDCRDER;                                            0598 01422000
         L     @15,@CV01407                                        0598 01423000
         BALR  @14,@15                                             0598 01424000
*       END;                                                       0599 01425000
*       REPRC=4;                                                   0600 01426000
         L     @15,@PC00001+8                                      0600 01427000
         MVC   REPRC(2,@15),@CH00045                               0600 01428000
*       RETURN CODE(LASTCC04);                                     0601 01429000
         LA    @15,4                                               0601 01430000
         L     @14,@SA00003                                        0601 01431000
         LM    @00,@12,@SA00003+8                                  0601 01432000
         BR    @14                                                 0601 01433000
*     END;                                                         0602 01434000
*   ELSE                                                           0603 01435000
*     ;                                                            0603 01436000
*                                                                  0603 01437000
@RF00592 DS    0H                                                  0604 01438000
*   /*****************************************************************/ 01439000
*   /*                                                               */ 01440000
*   /* START DEBLOCKING RECORD 1 SAVE VSAM KEY OF RECORD ZERO        */ 01441000
*   /*                                                               */ 01442000
*   /*****************************************************************/ 01443000
*                                                                  0604 01444000
*   SAVEKEY=RB0K;                                                  0604 01445000
*                                                                  0604 01446000
         L     @15,@PC00001+8                                      0604 01447000
         L     @01,REPBUFF0(,@15)                                  0604 01448000
         MVC   SAVEKEY(11),RB0K(@01)                               0604 01449000
*   /*****************************************************************/ 01450000
*   /*                                                               */ 01451000
*   /* SAVE LENGTH OF RECORD ONE BUFFER                              */ 01452000
*   /*                                                               */ 01453000
*   /*****************************************************************/ 01454000
*                                                                  0605 01455000
*   SAVER1DL=RB1CDL;                                               0605 01456000
*                                                                  0605 01457000
         L     @15,@PC00001+8                                      0605 01458000
         L     @01,REPBUFF1(,@15)                                  0605 01459000
         MVC   SAVER1DL(2),RB1CDL(@01)                             0605 01460000
*   /*****************************************************************/ 01461000
*   /*                                                               */ 01462000
*   /* CHECK IF NEW TRACK DOES NOT BEGIN AT RECORD 1--IF IT DOES NOT */ 01463000
*   /* BEGIN AT RECORD 1 THEN WRITE A MESSAGE TO             @ZA27389*/ 01464000
*   /* THE USER NOTIFYING HIM OF THIS PROBLEM.               @ZA27389*/ 01465000
*   /*                                                               */ 01466000
*   /*****************************************************************/ 01467000
*                                                                  0606 01468000
*   IF RB00DKRN^=1 THEN                                            0606 01469000
         L     @15,@PC00001+8                                      0606 01470000
         L     @01,REPBUFF0(,@15)                                  0606 01471000
         CLI   RB00DKRN(@01),1                                     0606 01472000
         BE    @RF00606                                            0606 01473000
*     DO;                           /*                       @ZA27389*/ 01474000
*       DO;                                                        0608 01475000
*         CKREQ=CKREQ&&CKREQ;                                      0609 01476000
         L     @15,@PC00001+8                                      0609 01477000
         XC    CKREQ(44,@15),CKREQ(@15)                            0609 01478000
*         CKRERN=MSG47;                                            0610 01479000
         L     @15,@PC00001+8                                      0610 01480000
         MVC   CKRERN(2,@15),@CH00781                              0610 01481000
*         CALL IDCRDER;                                            0611 01482000
         L     @15,@CV01407                                        0611 01483000
         BALR  @14,@15                                             0611 01484000
*       END;                        /*                       @ZA27389*/ 01485000
*       REPRC=4;                    /*                       @ZA27389*/ 01486000
         L     @15,@PC00001+8                                      0613 01487000
         MVC   REPRC(2,@15),@CH00045                               0613 01488000
*       RETURN CODE(LASTCC04);      /*                       @ZA27389*/ 01489000
         LA    @15,4                                               0614 01490000
         L     @14,@SA00003                                        0614 01491000
         LM    @00,@12,@SA00003+8                                  0614 01492000
         BR    @14                                                 0614 01493000
*     END;                          /*                       @ZA27389*/ 01494000
*   ELSE                                                           0616 01495000
*     ;                             /*                       @ZA27389*/ 01496000
*                                                                  0616 01497000
@RF00606 DS    0H                                                  0617 01498000
*   /*****************************************************************/ 01499000
*   /*                                                               */ 01500000
*   /* SET ORIGINAL R1 RECORD NUMBER FROM R0                         */ 01501000
*   /*                                                               */ 01502000
*   /*****************************************************************/ 01503000
*                                                                  0617 01504000
*   RB1CR=RB00DKRN;                                                0617 01505000
*                                                                  0617 01506000
         L     @15,@PC00001+8                                      0617 01507000
         L     @01,REPBUFF1(,@15)                                  0617 01508000
         L     @15,@PC00001+8                                      0617 01509000
         L     @15,REPBUFF0(,@15)                                  0617 01510000
         MVC   RB1CR(1,@01),RB00DKRN(@15)                          0617 01511000
*   /*****************************************************************/ 01512000
*   /*                                                               */ 01513000
*   /* SET ORIGINAL R1 KEY LEN AND DATA LEN FROM R0 AND SET THE      */ 01514000
*   /* ORIGINAL CCHH IN THE FIRST 4 BYTES OF THE R0 DATA FIELD       */ 01515000
*   /*                                                               */ 01516000
*   /*****************************************************************/ 01517000
*                                                                  0618 01518000
*   RB1CKL=RB00DKKL;                                               0618 01519000
         L     @15,@PC00001+8                                      0618 01520000
         L     @01,REPBUFF1(,@15)                                  0618 01521000
         L     @15,@PC00001+8                                      0618 01522000
         L     @15,REPBUFF0(,@15)                                  0618 01523000
         MVC   RB1CKL(1,@01),RB00DKKL(@15)                         0618 01524000
*   RB1CDL=RB00DKDL;                                               0619 01525000
         L     @15,@PC00001+8                                      0619 01526000
         L     @01,REPBUFF1(,@15)                                  0619 01527000
         L     @15,@PC00001+8                                      0619 01528000
         L     @15,REPBUFF0(,@15)                                  0619 01529000
         MVC   RB1CDL(2,@01),RB00DKDL(@15)                         0619 01530000
*   RB00DK=RB1CCHH;                                                0620 01531000
*                                                                  0620 01532000
         L     @15,@PC00001+8                                      0620 01533000
         L     @01,REPBUFF0(,@15)                                  0620 01534000
         L     @15,@PC00001+8                                      0620 01535000
         L     @15,REPBUFF1(,@15)                                  0620 01536000
         MVC   RB00DK(4,@01),RB1CCHH(@15)                          0620 01537000
*   /*****************************************************************/ 01538000
*   /*                                                               */ 01539000
*   /* SET "REC HAS BEEN DEBLOCKED INDICATOR" IN R0 AND SAVE R0 FLAG */ 01540000
*   /* BYTES NOTE THAT IF THE R'0 OR R'1 RECORD HAD BEEN PREVIOUSLY  */ 01541000
*   /* MODIFIED, THEIR MODIFICATION INDICATOR WILL BE OVERLAID BY THE*/ 01542000
*   /* DEBLOCK INDICATOR                                             */ 01543000
*   /*                                                               */ 01544000
*   /*****************************************************************/ 01545000
*                                                                  0621 01546000
*   RB0FMOD=DBLKFLG;                                               0621 01547000
         L     @15,@PC00001+8                                      0621 01548000
         L     @01,REPBUFF0(,@15)                                  0621 01549000
         MVC   RB0FMOD(1,@01),DBLKFLG                              0621 01550000
*   RB1FMOD=DBLKFLG;                                               0622 01551000
         L     @15,@PC00001+8                                      0622 01552000
         L     @01,REPBUFF1(,@15)                                  0622 01553000
         MVC   RB1FMOD(1,@01),DBLKFLG                              0622 01554000
*   SAVEFL=RB1F;                                                   0623 01555000
*                                                                  0623 01556000
         L     @15,@PC00001+8                                      0623 01557000
         L     @01,REPBUFF1(,@15)                                  0623 01558000
         MVC   SAVEFL(5),RB1F(@01)                                 0623 01559000
*   /*****************************************************************/ 01560000
*   /*                                                               */ 01561000
*   /* SAVE HEAD NUMBER OF ORIGINAL TRACK TO COMPARISON LATER        */ 01562000
*   /*                                                               */ 01563000
*   /*****************************************************************/ 01564000
*                                                                  0624 01565000
*   SAVEHH=RB0CHH;                                                 0624 01566000
*                                                                  0624 01567000
         L     @15,@PC00001+8                                      0624 01568000
         L     @01,REPBUFF0(,@15)                                  0624 01569000
         MVC   SAVEHH(2),RB0CHH(@01)                               0624 01570000
*   /*****************************************************************/ 01571000
*   /*                                                               */ 01572000
*   /* INITIALIZE ERROR COUNT                                        */ 01573000
*   /*                                                               */ 01574000
*   /*****************************************************************/ 01575000
*                                                                  0625 01576000
*   ERRCNT=ZERO;                                                   0625 01577000
*                                                                  0625 01578000
         MVC   ERRCNT(1),ZERO+1                                    0625 01579000
*   /*****************************************************************/ 01580000
*   /*                                                               */ 01581000
*   /* INITIALIZE INDEX INTO DBLTBL (DEBLOCK TABLE) INDEX WILL ALWAYS*/ 01582000
*   /* BE ONE GREATER THAN THE RECORD NUMBER TO ALLOW FOR AN ENTRY   */ 01583000
*   /* FOR RECORD ZERO                                               */ 01584000
*   /*                                                               */ 01585000
*   /*****************************************************************/ 01586000
*                                                                  0626 01587000
*   OUTCNT=1;                                                      0626 01588000
*                                                                  0626 01589000
         MVC   OUTCNT(2),@CH00221                                  0626 01590000
*   /*****************************************************************/ 01591000
*   /*                                                               */ 01592000
*   /* INITIALIZE KEY PADDING FACTOR TO ZERO                         */ 01593000
*   /*                                                               */ 01594000
*   /*****************************************************************/ 01595000
*                                                                  0627 01596000
*   PK=ZERO;                                                       0627 01597000
*                                                                  0627 01598000
         MVC   PK(1),ZERO+1                                        0627 01599000
*   /*****************************************************************/ 01600000
*   /*                                                               */ 01601000
*   /* THE BUFFER POINTED TO BY REPBUFF0 WILL HAVE THE DEBLOCKED     */ 01602000
*   /* RECORDS SET R0 ENTRY IN DEBLOCK TABLE (DBLTBL) CNT KEYLEN IS  */ 01603000
*   /* ZERO, DATA LEN IS VSAM KEY LEN + FLAG BYTES + THE SIXTEEN     */ 01604000
*   /* BYTES OF R0 COUNT AND DATA                                    */ 01605000
*   /*                                                               */ 01606000
*   /*****************************************************************/ 01607000
*                                                                  0628 01608000
*   DBLTCKLN(1)=ZERO;                                              0628 01609000
         LH    @15,ZERO                                            0628 01610000
         STH   @15,DBLTCKLN                                        0628 01611000
*   DBLTRPTR(1)=REPBUFF0;                                          0629 01612000
         L     @15,@PC00001+8                                      0629 01613000
         L     @15,REPBUFF0(,@15)                                  0629 01614000
         ST    @15,DBLTRPTR                                        0629 01615000
*   RB0LEN=LENGTH(RB0K)+LENGTH(RB0F)+R0CDLEN;                      0630 01616000
         LA    @15,16                                              0630 01617000
         AH    @15,R0CDLEN                                         0630 01618000
         STH   @15,RB0LEN                                          0630 01619000
*   DBLTRLN(1)=RB0LEN;                                             0631 01620000
*                                                                  0631 01621000
         LH    @15,RB0LEN                                          0631 01622000
         STH   @15,DBLTRLN                                         0631 01623000
*   /*****************************************************************/ 01624000
*   /*                                                               */ 01625000
*   /* SAVE BEGINNING ADDRESS OF R1 BUFFER                           */ 01626000
*   /*                                                               */ 01627000
*   /*****************************************************************/ 01628000
*                                                                  0632 01629000
*   SAVER1BF=REPBUFF1;                                             0632 01630000
*                                                                  0632 01631000
         L     @15,@PC00001+8                                      0632 01632000
         L     @15,REPBUFF1(,@15)                                  0632 01633000
         ST    @15,SAVER1BF                                        0632 01634000
*   /*****************************************************************/ 01635000
*   /*                                                               */ 01636000
*   /* INCREMENT REBUILD BUFFER AREA TO NEXT RECORD                  */ 01637000
*   /*                                                               */ 01638000
*   /*****************************************************************/ 01639000
*                                                                  0633 01640000
*   REPBUFF0=REPBUFF0+RB0LEN;                                      0633 01641000
*                                                                  0633 01642000
         L     @15,@PC00001+8                                      0633 01643000
         L     @14,@PC00001+8                                      0633 01644000
         LH    @05,RB0LEN                                          0633 01645000
         AL    @05,REPBUFF0(,@14)                                  0633 01646000
         ST    @05,REPBUFF0(,@15)                                  0633 01647000
*   /*****************************************************************/ 01648000
*   /*                                                               */ 01649000
*   /* INCREMENT RECORD1 BUFFER TO BYPASS THE VSAM KEY               */ 01650000
*   /*                                                               */ 01651000
*   /*****************************************************************/ 01652000
*                                                                  0634 01653000
*   REPBUFF1=REPBUFF1+LENGTH(RB1K)+1;                              0634 01654000
*                                                                  0634 01655000
         L     @15,@PC00001+8                                      0634 01656000
         L     @14,@PC00001+8                                      0634 01657000
         LA    @05,12                                              0634 01658000
         AL    @05,REPBUFF1(,@14)                                  0634 01659000
         ST    @05,REPBUFF1(,@15)                                  0634 01660000
*   /*****************************************************************/ 01661000
*   /*                                                               */ 01662000
*   /* REPBUFF1 POINTS TO NEXT COUNT MINUS THE FLAG BYTES CK IF      */ 01663000
*   /* HEADER INDICATES FIXED LENGTH                                 */ 01664000
*   /*                                                               */ 01665000
*   /*****************************************************************/ 01666000
*                                                                  0635 01667000
*   IF RWFHFT=FIXIND THEN                                          0635 01668000
*                                                                  0635 01669000
         L     @15,@PC00001+8                                      0635 01670000
         L     @01,REPRWHDO(,@15)                                  0635 01671000
         CLC   RWFHFT(1,@01),FIXIND                                0635 01672000
         BNE   @RF00635                                            0635 01673000
*     /***************************************************************/ 01674000
*     /*                                                             */ 01675000
*     /* FIXED LEN RECORDS-COMPUTE PADDING FACTOR FOR DATA           */ 01676000
*     /*                                                             */ 01677000
*     /***************************************************************/ 01678000
*                                                                  0636 01679000
*     PD=BTSPERWD-(RWFHDLN//BTSPERWD);                             0636 01680000
         L     @15,@PC00001+8                                      0636 01681000
         L     @01,REPRWHDO(,@15)                                  0636 01682000
         LH    @01,RWFHDLN(,@01)                                   0636 01683000
         N     @01,@CF01511                                        0636 01684000
         SLR   @00,@00                                             0636 01685000
         LH    @15,BTSPERWD                                        0636 01686000
         DR    @00,@15                                             0636 01687000
         LCR   @00,@00                                             0636 01688000
         AH    @00,BTSPERWD                                        0636 01689000
         STC   @00,PD                                              0636 01690000
*   ELSE                                                           0637 01691000
*     ;                                                            0637 01692000
*                                                                  0637 01693000
@RF00635 DS    0H                                                  0638 01694000
*   /*****************************************************************/ 01695000
*   /*                                                               */ 01696000
*   /* RESET ADDRESSABLITY TO RECORD ONE BUFFER AREA VSAM KEY FIELD  */ 01697000
*   /* NO LONGER PRESENT                                             */ 01698000
*   /*                                                               */ 01699000
*   /*****************************************************************/ 01700000
*                                                                  0638 01701000
*   RFY                                                            0638 01702000
*     RBIN BASED(REPBUFF1);                                        0638 01703000
*                                                                  0638 01704000
*   /*****************************************************************/ 01705000
*   /*                                                               */ 01706000
*   /* INITIALIZE FORCE INDICATOR                                    */ 01707000
*   /*                                                               */ 01708000
*   /*****************************************************************/ 01709000
*                                                                  0639 01710000
*   FORCE=ZERO;                                                    0639 01711000
*                                                                  0639 01712000
         MVC   FORCE(1),ZERO+1                                     0639 01713000
*   /*****************************************************************/ 01714000
*   /*                                                               */ 01715000
*   /* CHECK IF USER SPECIFIED KEY AND DATA LENGTHS                  */ 01716000
*   /*                                                               */ 01717000
*   /*****************************************************************/ 01718000
*                                                                  0640 01719000
*   IF ADDR(DBLST)^=NULLPTR THEN                                   0640 01720000
*                                                                  0640 01721000
         L     @15,@PC00001+4                                      0640 01722000
         L     @15,FDTPTR+292(,@15)                                0640 01723000
         LTR   @15,@15                                             0640 01724000
         BZ    @RF00640                                            0640 01725000
*     /***************************************************************/ 01726000
*     /*                                                             */ 01727000
*     /* LENGTHS SUPPLIED-SET THE LENGTHS IN THE R'1 DATA FIELD      */ 01728000
*     /*                                                             */ 01729000
*     /***************************************************************/ 01730000
*                                                                  0641 01731000
*     DO;                                                          0641 01732000
*                                                                  0641 01733000
*       /*************************************************************/ 01734000
*       /*                                                           */ 01735000
*       /* LOOP FOR NUMBER OF LENGTH FIELDS SUPPLIED                 */ 01736000
*       /*                                                           */ 01737000
*       /*************************************************************/ 01738000
*                                                                  0642 01739000
*       DO ICNT1=1 TO DBLSTCNT;                                    0642 01740000
*                                                                  0642 01741000
         LA    @15,1                                               0642 01742000
         B     @DE00642                                            0642 01743000
@DL00642 DS    0H                                                  0643 01744000
*         /***********************************************************/ 01745000
*         /*                                                         */ 01746000
*         /* SET KEY LENGTH AND DATA LEN IN ORIG RECORD ONE TO KEY   */ 01747000
*         /* LEN AND DATA LEN SUPPLIED BY USER                       */ 01748000
*         /*                                                         */ 01749000
*         /***********************************************************/ 01750000
*                                                                  0643 01751000
*         RBICKL=DBKEYPTR(ICNT1)->DBKEYVAL;                        0643 01752000
         L     @15,@PC00001+8                                      0643 01753000
         L     @01,REPBUFF1(,@15)                                  0643 01754000
         LH    @15,ICNT1                                           0643 01755000
         SLA   @15,2                                               0643 01756000
         L     @14,@PC00001+4                                      0643 01757000
         L     @14,FDTPTR+312(,@14)                                0643 01758000
         AL    @14,@CF01512                                        0643 01759000
         L     @15,DBKEYPTR(@15,@14)                               0643 01760000
         MVC   RBICKL(1,@01),DBKEYVAL+3(@15)                       0643 01761000
*         RBICDL=DBDATPTR(ICNT1)->DBDATVAL;                        0644 01762000
*                                                                  0644 01763000
         L     @15,@PC00001+8                                      0644 01764000
         L     @01,REPBUFF1(,@15)                                  0644 01765000
         LH    @15,ICNT1                                           0644 01766000
         SLA   @15,2                                               0644 01767000
         L     @14,@PC00001+4                                      0644 01768000
         L     @14,FDTPTR+316(,@14)                                0644 01769000
         AL    @14,@CF01512                                        0644 01770000
         L     @15,DBDATPTR(@15,@14)                               0644 01771000
         MVC   RBICDL(2,@01),DBDATVAL+2(@15)                       0644 01772000
*         /***********************************************************/ 01773000
*         /*                                                         */ 01774000
*         /* COMPUTE KEY PADDING                                     */ 01775000
*         /*                                                         */ 01776000
*         /***********************************************************/ 01777000
*                                                                  0645 01778000
*         IF RBICKL^=ZERO THEN                                     0645 01779000
*                                                                  0645 01780000
         L     @15,@PC00001+8                                      0645 01781000
         L     @01,REPBUFF1(,@15)                                  0645 01782000
         SLR   @00,@00                                             0645 01783000
         IC    @00,RBICKL(,@01)                                    0645 01784000
         CH    @00,ZERO                                            0645 01785000
         BE    @RF00645                                            0645 01786000
*           /*********************************************************/ 01787000
*           /*                                                       */ 01788000
*           /* KEY EXISTS-COMPUTE PADDING FACTOR                     */ 01789000
*           /*                                                       */ 01790000
*           /*********************************************************/ 01791000
*                                                                  0646 01792000
*           PK=BTSPERWD-(RBICKL//BTSPERWD);                        0646 01793000
         L     @15,@PC00001+8                                      0646 01794000
         L     @01,REPBUFF1(,@15)                                  0646 01795000
         SLR   @02,@02                                             0646 01796000
         IC    @02,RBICKL(,@01)                                    0646 01797000
         SRDA  @02,32                                              0646 01798000
         LH    @15,BTSPERWD                                        0646 01799000
         DR    @02,@15                                             0646 01800000
         LCR   @02,@02                                             0646 01801000
         AH    @02,BTSPERWD                                        0646 01802000
         STC   @02,PK                                              0646 01803000
*         ELSE                                                     0647 01804000
*                                                                  0647 01805000
*           /*********************************************************/ 01806000
*           /*                                                       */ 01807000
*           /* KEY LEN ZERO-NO KEY PADDING FACTOR REQUIRED           */ 01808000
*           /*                                                       */ 01809000
*           /*********************************************************/ 01810000
*                                                                  0647 01811000
*           PK=ZERO;                                               0647 01812000
*                                                                  0647 01813000
         B     @RC00645                                            0647 01814000
@RF00645 MVC   PK(1),ZERO+1                                        0647 01815000
*         /***********************************************************/ 01816000
*         /*                                                         */ 01817000
*         /* COMPUTE DATA PADDING                                    */ 01818000
*         /*                                                         */ 01819000
*         /***********************************************************/ 01820000
*                                                                  0648 01821000
*         PD=BTSPERWD-(RBICDL//BTSPERWD);                          0648 01822000
*                                                                  0648 01823000
@RC00645 L     @15,@PC00001+8                                      0648 01824000
         L     @01,REPBUFF1(,@15)                                  0648 01825000
         SLR   @03,@03                                             0648 01826000
         ICM   @03,3,RBICDL(@01)                                   0648 01827000
         SLR   @02,@02                                             0648 01828000
         LH    @15,BTSPERWD                                        0648 01829000
         DR    @02,@15                                             0648 01830000
         LCR   @02,@02                                             0648 01831000
         AH    @02,BTSPERWD                                        0648 01832000
         STC   @02,PD                                              0648 01833000
*         /***********************************************************/ 01834000
*         /*                                                         */ 01835000
*         /* INCREMENT TO NEXT COUNT FIELD IN RECORD 1 BUFFER        */ 01836000
*         /*                                                         */ 01837000
*         /***********************************************************/ 01838000
*                                                                  0649 01839000
*         REPBUFF1=REPBUFF1+PK+PD+RBICKL+RBICDL+LENGTH(RBI4)+COUNTLEN;  01840000
*                                                                  0649 01841000
         L     @15,@PC00001+8                                      0649 01842000
         L     @14,@PC00001+8                                      0649 01843000
         SLR   @05,@05                                             0649 01844000
         IC    @05,PK                                              0649 01845000
         AL    @05,REPBUFF1(,@14)                                  0649 01846000
         SLR   @04,@04                                             0649 01847000
         IC    @04,PD                                              0649 01848000
         ALR   @05,@04                                             0649 01849000
         L     @14,@PC00001+8                                      0649 01850000
         L     @01,REPBUFF1(,@14)                                  0649 01851000
         SLR   @04,@04                                             0649 01852000
         IC    @04,RBICKL(,@01)                                    0649 01853000
         ALR   @05,@04                                             0649 01854000
         L     @14,@PC00001+8                                      0649 01855000
         L     @01,REPBUFF1(,@14)                                  0649 01856000
         SLR   @04,@04                                             0649 01857000
         ICM   @04,3,RBICDL(@01)                                   0649 01858000
         ALR   @05,@04                                             0649 01859000
         AL    @05,@CF00045                                        0649 01860000
         AH    @05,COUNTLEN                                        0649 01861000
         ST    @05,REPBUFF1(,@15)                                  0649 01862000
*         /***********************************************************/ 01863000
*         /*                                                         */ 01864000
*         /* CHECK IF REPBUFF1 GETS OUTSIDE THE R'1 DATA FIELD AND IF*/ 01865000
*         /* IT DOES, GET OUT OF LOOP                                */ 01866000
*         /*                                                         */ 01867000
*         /***********************************************************/ 01868000
*                                                                  0650 01869000
*         IF(REPBUFF1-SAVER1BF-24)>SAVER1DL THEN                   0650 01870000
         L     @15,@PC00001+8                                      0650 01871000
         L     @15,REPBUFF1(,@15)                                  0650 01872000
         SL    @15,SAVER1BF                                        0650 01873000
         SL    @15,@CF00312                                        0650 01874000
         LH    @14,SAVER1DL                                        0650 01875000
         N     @14,@CF01511                                        0650 01876000
         CR    @15,@14                                             0650 01877000
         BNH   @RF00650                                            0650 01878000
*           ICNT1=DBLSTCNT;                                        0651 01879000
         L     @15,@PC00001+4                                      0651 01880000
         LA    @15,FDTPTR+292(,@15)                                0651 01881000
         L     @15,DBLSTCNT(,@15)                                  0651 01882000
         STH   @15,ICNT1                                           0651 01883000
*         ELSE                                                     0652 01884000
*           ;                                                      0652 01885000
@RF00650 DS    0H                                                  0653 01886000
*       END;                                                       0653 01887000
*                                                                  0653 01888000
         LA    @15,1                                               0653 01889000
         AH    @15,ICNT1                                           0653 01890000
@DE00642 STH   @15,ICNT1                                           0653 01891000
         L     @14,@PC00001+4                                      0653 01892000
         LA    @14,FDTPTR+292(,@14)                                0653 01893000
         C     @15,DBLSTCNT(,@14)                                  0653 01894000
         BNH   @DL00642                                            0653 01895000
*       /*************************************************************/ 01896000
*       /*                                                           */ 01897000
*       /* OUT OF DO LOOP - ALL COUNT FIELDS NOW HAVE NEW LENGTH CK  */ 01898000
*       /* IF THE LENGTHS GIVEN GET US TO THE END OF THE BUFF        */ 01899000
*       /*                                                           */ 01900000
*       /*************************************************************/ 01901000
*                                                                  0654 01902000
*       IF(REPBUFF1-SAVER1BF-24)>SAVER1DL THEN                     0654 01903000
*                                                                  0654 01904000
         L     @15,@PC00001+8                                      0654 01905000
         L     @15,REPBUFF1(,@15)                                  0654 01906000
         SL    @15,SAVER1BF                                        0654 01907000
         SL    @15,@CF00312                                        0654 01908000
         LH    @14,SAVER1DL                                        0654 01909000
         N     @14,@CF01511                                        0654 01910000
         CR    @15,@14                                             0654 01911000
         BNH   @RF00654                                            0654 01912000
*         /***********************************************************/ 01913000
*         /*                                                         */ 01914000
*         /* TOO MANY BYTES                                          */ 01915000
*         /*                                                         */ 01916000
*         /***********************************************************/ 01917000
*                                                                  0655 01918000
*         DO;                                                      0655 01919000
*           DO;                                                    0656 01920000
*             CKREQ=CKREQ&&CKREQ;                                  0657 01921000
         L     @15,@PC00001+8                                      0657 01922000
         XC    CKREQ(44,@15),CKREQ(@15)                            0657 01923000
*             CKRERN=MSG37;                                        0658 01924000
         L     @15,@PC00001+8                                      0658 01925000
         MVC   CKRERN(2,@15),@CH00717                              0658 01926000
*             CKRMVAR(1)=ADDR(LARGE);                              0659 01927000
         L     @15,@PC00001+8                                      0659 01928000
         LA    @14,LARGE                                           0659 01929000
         ST    @14,CKRMVAR(,@15)                                   0659 01930000
*             CALL IDCRDER;                                        0660 01931000
         L     @15,@CV01407                                        0660 01932000
         BALR  @14,@15                                             0660 01933000
*           END;                                                   0661 01934000
*           REPRC=12;                                              0662 01935000
         L     @15,@PC00001+8                                      0662 01936000
         MVC   REPRC(2,@15),@CH00038                               0662 01937000
*           RETURN CODE(LASTCC12);                                 0663 01938000
         LA    @15,12                                              0663 01939000
         L     @14,@SA00003                                        0663 01940000
         LM    @00,@12,@SA00003+8                                  0663 01941000
         BR    @14                                                 0663 01942000
*         END;                                                     0664 01943000
*       ELSE                                                       0665 01944000
*         ;                                                        0665 01945000
@RF00654 DS    0H                                                  0666 01946000
*       IF(REPBUFF1-SAVER1BF-24)<SAVER1DL THEN                     0666 01947000
*                                                                  0666 01948000
         L     @15,@PC00001+8                                      0666 01949000
         L     @15,REPBUFF1(,@15)                                  0666 01950000
         SL    @15,SAVER1BF                                        0666 01951000
         SL    @15,@CF00312                                        0666 01952000
         LH    @14,SAVER1DL                                        0666 01953000
         N     @14,@CF01511                                        0666 01954000
         CR    @15,@14                                             0666 01955000
         BNL   @RF00666                                            0666 01956000
*         /***********************************************************/ 01957000
*         /*                                                         */ 01958000
*         /* NOT ENOUGH BYTES                                        */ 01959000
*         /*                                                         */ 01960000
*         /***********************************************************/ 01961000
*                                                                  0667 01962000
*         DO;                                                      0667 01963000
*           DO;                                                    0668 01964000
*             CKREQ=CKREQ&&CKREQ;                                  0669 01965000
         L     @15,@PC00001+8                                      0669 01966000
         XC    CKREQ(44,@15),CKREQ(@15)                            0669 01967000
*             CKRERN=MSG37;                                        0670 01968000
         L     @15,@PC00001+8                                      0670 01969000
         MVC   CKRERN(2,@15),@CH00717                              0670 01970000
*             CKRMVAR(1)=ADDR(SMALL);                              0671 01971000
         L     @15,@PC00001+8                                      0671 01972000
         LA    @14,SMALL                                           0671 01973000
         ST    @14,CKRMVAR(,@15)                                   0671 01974000
*             CALL IDCRDER;                                        0672 01975000
         L     @15,@CV01407                                        0672 01976000
         BALR  @14,@15                                             0672 01977000
*           END;                                                   0673 01978000
*           REPRC=12;                                              0674 01979000
         L     @15,@PC00001+8                                      0674 01980000
         MVC   REPRC(2,@15),@CH00038                               0674 01981000
*           RETURN CODE(LASTCC12);                                 0675 01982000
         LA    @15,12                                              0675 01983000
         L     @14,@SA00003                                        0675 01984000
         LM    @00,@12,@SA00003+8                                  0675 01985000
         BR    @14                                                 0675 01986000
*         END;                                                     0676 01987000
*       ELSE                                                       0677 01988000
*         ;                                                        0677 01989000
*                                                                  0677 01990000
@RF00666 DS    0H                                                  0678 01991000
*       /*************************************************************/ 01992000
*       /*                                                           */ 01993000
*       /* GOOD LENGTH INFORMATION - FORCE DEBLOCK TO CONT           */ 01994000
*       /*                                                           */ 01995000
*       /*************************************************************/ 01996000
*                                                                  0678 01997000
*       FORCE=NONZERO;                                             0678 01998000
*                                                                  0678 01999000
         MVC   FORCE(1),NONZERO                                    0678 02000000
*       /*************************************************************/ 02001000
*       /*                                                           */ 02002000
*       /* RESET REPBUFF1 TO POINT TO FIRST COUNT AGAIN              */ 02003000
*       /*                                                           */ 02004000
*       /*************************************************************/ 02005000
*                                                                  0679 02006000
*       REPBUFF1=SAVER1BF+LENGTH(RB1K)+1;                          0679 02007000
         L     @15,@PC00001+8                                      0679 02008000
         LA    @14,12                                              0679 02009000
         AL    @14,SAVER1BF                                        0679 02010000
         ST    @14,REPBUFF1(,@15)                                  0679 02011000
*     END;                                                         0680 02012000
*                                                                  0680 02013000
*   /*****************************************************************/ 02014000
*   /*                                                               */ 02015000
*   /* LENGTHS NOT SUPPLIED - JUST CONTINUE                          */ 02016000
*   /*                                                               */ 02017000
*   /*****************************************************************/ 02018000
*                                                                  0681 02019000
*   ELSE                                                           0681 02020000
*     ;                                                            0681 02021000
*                                                                  0681 02022000
@RF00640 DS    0H                                                  0682 02023000
*   /*****************************************************************/ 02024000
*   /*                                                               */ 02025000
*   /* LOOP FOR SIZE OF BUFFER-REBUILDING RECORDS AND SETTING UP THE */ 02026000
*   /* DEBLOCK TABLE SET UTRACE                                      */ 02027000
*   /*                                                               */ 02028000
*   /*****************************************************************/ 02029000
*                                                                  0682 02030000
*   OLDERID2=NEWERID2;                                             0682 02031000
         L     @15,@PC00001                                        0682 02032000
         L     @01,GDTTR2(,@15)                                    0682 02033000
         L     @15,@PC00001                                        0682 02034000
         L     @15,GDTTR2(,@15)                                    0682 02035000
         MVC   @TS00001(95),NEWERID2(@15)                          0682 02036000
         MVC   OLDERID2(95,@01),@TS00001                           0682 02037000
*   NEWID2='RD44';                                                 0683 02038000
         L     @15,@PC00001                                        0683 02039000
         L     @01,GDTTR2(,@15)                                    0683 02040000
         MVC   NEWID2(4,@01),@CC01499                              0683 02041000
*   DO WHILE REPR1LN>(REPBUFF1-SAVER1BF);                          0684 02042000
*                                                                  0684 02043000
         B     @DE00684                                            0684 02044000
@DL00684 DS    0H                                                  0685 02045000
*     /***************************************************************/ 02046000
*     /*                                                             */ 02047000
*     /* INCREMENT DBLTBL INDEX                                      */ 02048000
*     /*                                                             */ 02049000
*     /***************************************************************/ 02050000
*                                                                  0685 02051000
*     OUTCNT=OUTCNT+1;                                             0685 02052000
*                                                                  0685 02053000
         LA    @15,1                                               0685 02054000
         LH    @14,OUTCNT                                          0685 02055000
         N     @14,@CF01511                                        0685 02056000
         ALR   @15,@14                                             0685 02057000
         STH   @15,OUTCNT                                          0685 02058000
*     /***************************************************************/ 02059000
*     /*                                                             */ 02060000
*     /* SET RECORD NUMBER BEING DEBLOCKED INTO VSAM KEY             */ 02061000
*     /*                                                             */ 02062000
*     /***************************************************************/ 02063000
*                                                                  0686 02064000
*     SAVEKEYR=RBICR;                                              0686 02065000
*                                                                  0686 02066000
         L     @15,@PC00001+8                                      0686 02067000
         L     @01,REPBUFF1(,@15)                                  0686 02068000
         MVC   SAVEKEYR(1),RBICR(@01)                              0686 02069000
*     /***************************************************************/ 02070000
*     /*                                                             */ 02071000
*     /* SET VSAM KEY IN DEBLOCKED RECORD                            */ 02072000
*     /*                                                             */ 02073000
*     /***************************************************************/ 02074000
*                                                                  0687 02075000
*     RB0K=SAVEKEY;                                                0687 02076000
*                                                                  0687 02077000
         L     @15,@PC00001+8                                      0687 02078000
         L     @01,REPBUFF0(,@15)                                  0687 02079000
         MVC   RB0K(11,@01),SAVEKEY                                0687 02080000
*     /***************************************************************/ 02081000
*     /*                                                             */ 02082000
*     /* SET FLAG BYTES IN DEBLOCKED RECORD                          */ 02083000
*     /*                                                             */ 02084000
*     /***************************************************************/ 02085000
*                                                                  0688 02086000
*     RB0F=SAVEFL;                                                 0688 02087000
*                                                                  0688 02088000
         L     @15,@PC00001+8                                      0688 02089000
         L     @01,REPBUFF0(,@15)                                  0688 02090000
         MVC   RB0F(5,@01),SAVEFL                                  0688 02091000
*     /***************************************************************/ 02092000
*     /*                                                             */ 02093000
*     /* SET COUNT FIELD IN DEBLOCKED RECORD TO COUNT FIELD OF       */ 02094000
*     /* ORIGINAL RECORD                                             */ 02095000
*     /*                                                             */ 02096000
*     /***************************************************************/ 02097000
*                                                                  0689 02098000
*     RB0C=RBIC;                                                   0689 02099000
*                                                                  0689 02100000
         L     @15,@PC00001+8                                      0689 02101000
         L     @01,REPBUFF0(,@15)                                  0689 02102000
         L     @15,@PC00001+8                                      0689 02103000
         L     @15,REPBUFF1(,@15)                                  0689 02104000
         MVC   RB0C(8,@01),RBIC(@15)                               0689 02105000
*     /***************************************************************/ 02106000
*     /*                                                             */ 02107000
*     /* CK IF KEY PRESENT                                           */ 02108000
*     /*                                                             */ 02109000
*     /***************************************************************/ 02110000
*                                                                  0690 02111000
*     IF RBICKL^=ZERO THEN                                         0690 02112000
*                                                                  0690 02113000
         L     @15,@PC00001+8                                      0690 02114000
         L     @01,REPBUFF1(,@15)                                  0690 02115000
         SLR   @00,@00                                             0690 02116000
         IC    @00,RBICKL(,@01)                                    0690 02117000
         CH    @00,ZERO                                            0690 02118000
         BE    @RF00690                                            0690 02119000
*       /*************************************************************/ 02120000
*       /*                                                           */ 02121000
*       /* KEY EXISTS - SET KEY LEN IN DEBLOCK TABLE                 */ 02122000
*       /*                                                           */ 02123000
*       /*************************************************************/ 02124000
*                                                                  0691 02125000
*       DO;                                                        0691 02126000
*         DBLTCKLN(OUTCNT)=RBICKL;                                 0692 02127000
*                                                                  0692 02128000
         LH    @15,OUTCNT                                          0692 02129000
         N     @15,@CF01511                                        0692 02130000
         SLA   @15,3                                               0692 02131000
         L     @14,@PC00001+8                                      0692 02132000
         L     @01,REPBUFF1(,@14)                                  0692 02133000
         SLR   @00,@00                                             0692 02134000
         IC    @00,RBICKL(,@01)                                    0692 02135000
         STH   @00,DBLTCKLN-8(@15)                                 0692 02136000
*         /***********************************************************/ 02137000
*         /*                                                         */ 02138000
*         /* COMPUTE PADDING FACTOR FOR KEY                          */ 02139000
*         /*                                                         */ 02140000
*         /***********************************************************/ 02141000
*                                                                  0693 02142000
*         PK=BTSPERWD-(RBICKL//BTSPERWD);                          0693 02143000
*                                                                  0693 02144000
         L     @15,@PC00001+8                                      0693 02145000
         L     @01,REPBUFF1(,@15)                                  0693 02146000
         SLR   @02,@02                                             0693 02147000
         IC    @02,RBICKL(,@01)                                    0693 02148000
         SRDA  @02,32                                              0693 02149000
         LH    @15,BTSPERWD                                        0693 02150000
         DR    @02,@15                                             0693 02151000
         LCR   @02,@02                                             0693 02152000
         AH    @02,BTSPERWD                                        0693 02153000
         STC   @02,PK                                              0693 02154000
*         /***********************************************************/ 02155000
*         /*                                                         */ 02156000
*         /* CHECK IF THE KEY LENGTH WILL EXCEED THE R'1 RECORD      */ 02157000
*         /* LENGTH                                                  */ 02158000
*         /*                                                         */ 02159000
*         /***********************************************************/ 02160000
*                                                                  0694 02161000
*         IF REPR1LN-12<REPBUFF1-SAVER1BF+RBICKL+PK THEN           0694 02162000
         L     @15,@PC00001+8                                      0694 02163000
         LH    @15,REPR1LN(,@15)                                   0694 02164000
         N     @15,@CF01511                                        0694 02165000
         SL    @15,@CF00038                                        0694 02166000
         L     @14,@PC00001+8                                      0694 02167000
         L     @14,REPBUFF1(,@14)                                  0694 02168000
         SL    @14,SAVER1BF                                        0694 02169000
         L     @05,@PC00001+8                                      0694 02170000
         L     @01,REPBUFF1(,@05)                                  0694 02171000
         SLR   @00,@00                                             0694 02172000
         IC    @00,RBICKL(,@01)                                    0694 02173000
         ALR   @14,@00                                             0694 02174000
         SLR   @05,@05                                             0694 02175000
         IC    @05,PK                                              0694 02176000
         ALR   @14,@05                                             0694 02177000
         CR    @15,@14                                             0694 02178000
         BNL   @RF00694                                            0694 02179000
*           SWLENKEY=1;                                            0695 02180000
         MVI   SWLENKEY,X'01'                                      0695 02181000
*         ELSE                                                     0696 02182000
*           DO;                                                    0696 02183000
*                                                                  0696 02184000
         B     @RC00694                                            0696 02185000
@RF00694 DS    0H                                                  0697 02186000
*             /*******************************************************/ 02187000
*             /*                                                     */ 02188000
*             /* MOVE KEY TO DEBLOCKED REC FROM ORIG REC + PADDING   */ 02189000
*             /* AND TURN OFF "KEY OUTSIDE R'1 INDICATOR"            */ 02190000
*             /*                                                     */ 02191000
*             /*******************************************************/ 02192000
*                                                                  0697 02193000
*             RB0DK(1:RBICKL)=RBIDK(PK+1:(PK+RBICKL));             0697 02194000
         L     @15,@PC00001+8                                      0697 02195000
         L     @01,REPBUFF0(,@15)                                  0697 02196000
         L     @15,@PC00001+8                                      0697 02197000
         L     @15,REPBUFF1(,@15)                                  0697 02198000
         SLR   @14,@14                                             0697 02199000
         IC    @14,RBICKL(,@15)                                    0697 02200000
         BCTR  @14,0                                               0697 02201000
         SLR   @15,@15                                             0697 02202000
         IC    @15,PK                                              0697 02203000
         L     @05,@PC00001+8                                      0697 02204000
         L     @05,REPBUFF1(,@05)                                  0697 02205000
         ALR   @05,@15                                             0697 02206000
         EX    @14,@SM01513                                        0697 02207000
*             SWLENKEY=0;                                          0698 02208000
         MVI   SWLENKEY,X'00'                                      0698 02209000
*           END;                                                   0699 02210000
*       END;                                                       0700 02211000
*                                                                  0700 02212000
*     /***************************************************************/ 02213000
*     /*                                                             */ 02214000
*     /* NO KEY-ENSURE PADDING FACTOR IS ZERO                        */ 02215000
*     /*                                                             */ 02216000
*     /***************************************************************/ 02217000
*                                                                  0701 02218000
*     ELSE                                                         0701 02219000
*       PK=ZERO;                                                   0701 02220000
*                                                                  0701 02221000
         B     @RC00690                                            0701 02222000
@RF00690 MVC   PK(1),ZERO+1                                        0701 02223000
*     /***************************************************************/ 02224000
*     /*                                                             */ 02225000
*     /* CHECK FOR EOF RECORD                                        */ 02226000
*     /*                                                             */ 02227000
*     /***************************************************************/ 02228000
*                                                                  0702 02229000
*     IF RBICDL=ZERO THEN                                          0702 02230000
@RC00690 L     @15,@PC00001+8                                      0702 02231000
         L     @01,REPBUFF1(,@15)                                  0702 02232000
         SLR   @00,@00                                             0702 02233000
         ICM   @00,3,RBICDL(@01)                                   0702 02234000
         CH    @00,ZERO                                            0702 02235000
         BNE   @RF00702                                            0702 02236000
*       RBICDL=1;                                                  0703 02237000
         L     @15,@PC00001+8                                      0703 02238000
         L     @01,REPBUFF1(,@15)                                  0703 02239000
         MVC   RBICDL(2,@01),@CH00221                              0703 02240000
*     ELSE                                                         0704 02241000
*       ;                                                          0704 02242000
*                                                                  0704 02243000
@RF00702 DS    0H                                                  0705 02244000
*     /***************************************************************/ 02245000
*     /*                                                             */ 02246000
*     /* IF THE ORIGINAL DATA SET HAD FBS (FIXED BLOCKED STANDARD    */ 02247000
*     /* RECORDS AND THE FORCE FIELD IS ZERO AND THE CURRENT RECORD  */ 02248000
*     /* BEING DEBLOCKED IS NOT AN EOF RECORD, THEN THE RECORD LENGTH*/ 02249000
*     /* PROVIDED IN THE RWF HEADER WILL BE USED AND THE PADDING     */ 02250000
*     /* FACTOR WAS ALREADY COMPUTED NOTE THAT THE LAST RECORD COULD */ 02251000
*     /* BE LESS THAN FBS LENGTH IN WHICH CASE THE BUFFER WILL GET   */ 02252000
*     /* OUT OF THE R'1 DATA FIELD AND IT WILL BE FIXED AT A LATER   */ 02253000
*     /* TIME                                                        */ 02254000
*     /*                                                             */ 02255000
*     /***************************************************************/ 02256000
*                                                                  0705 02257000
*     IF RWFHFT=FIXIND&FORCE=ZERO&RB0CDL^=0 THEN                   0705 02258000
         L     @15,@PC00001+8                                      0705 02259000
         L     @01,REPRWHDO(,@15)                                  0705 02260000
         CLC   RWFHFT(1,@01),FIXIND                                0705 02261000
         BNE   @RF00705                                            0705 02262000
         SLR   @15,@15                                             0705 02263000
         IC    @15,FORCE                                           0705 02264000
         CH    @15,ZERO                                            0705 02265000
         BNE   @RF00705                                            0705 02266000
         L     @15,@PC00001+8                                      0705 02267000
         L     @01,REPBUFF0(,@15)                                  0705 02268000
         ICM   @00,3,RB0CDL(@01)                                   0705 02269000
         BZ    @RF00705                                            0705 02270000
*       DO;                                                        0706 02271000
*         SAVFIXDL=RBICDL;                                         0707 02272000
         L     @15,@PC00001+8                                      0707 02273000
         L     @01,REPBUFF1(,@15)                                  0707 02274000
         MVC   SAVFIXDL(2),RBICDL(@01)                             0707 02275000
*         RBICDL=RWFHDLN;                                          0708 02276000
         L     @15,@PC00001+8                                      0708 02277000
         L     @01,REPBUFF1(,@15)                                  0708 02278000
         L     @15,@PC00001+8                                      0708 02279000
         L     @15,REPRWHDO(,@15)                                  0708 02280000
         MVC   RBICDL(2,@01),RWFHDLN(@15)                          0708 02281000
*         RB0CDL=RWFHDLN;                                          0709 02282000
         L     @15,@PC00001+8                                      0709 02283000
         L     @01,REPBUFF0(,@15)                                  0709 02284000
         L     @15,@PC00001+8                                      0709 02285000
         L     @15,REPRWHDO(,@15)                                  0709 02286000
         MVC   RB0CDL(2,@01),RWFHDLN(@15)                          0709 02287000
*         SWFIX=1;                                                 0710 02288000
         MVI   SWFIX,X'01'                                         0710 02289000
*       END;                                                       0711 02290000
*     ELSE                                                         0712 02291000
*                                                                  0712 02292000
*       /*************************************************************/ 02293000
*       /*                                                           */ 02294000
*       /* NOT FBS RECORD - COMPUTE PADDING FACTOR FOR DATA          */ 02295000
*       /*                                                           */ 02296000
*       /*************************************************************/ 02297000
*                                                                  0712 02298000
*       DO;                                                        0712 02299000
         B     @RC00705                                            0712 02300000
@RF00705 DS    0H                                                  0713 02301000
*         PD=BTSPERWD-(RBICDL//BTSPERWD);                          0713 02302000
         L     @15,@PC00001+8                                      0713 02303000
         L     @01,REPBUFF1(,@15)                                  0713 02304000
         SLR   @03,@03                                             0713 02305000
         ICM   @03,3,RBICDL(@01)                                   0713 02306000
         SLR   @02,@02                                             0713 02307000
         LH    @15,BTSPERWD                                        0713 02308000
         DR    @02,@15                                             0713 02309000
         LCR   @02,@02                                             0713 02310000
         AH    @02,BTSPERWD                                        0713 02311000
         STC   @02,PD                                              0713 02312000
*         SWFIX=0;                                                 0714 02313000
         MVI   SWFIX,X'00'                                         0714 02314000
*       END;                                                       0715 02315000
*                                                                  0715 02316000
*     /***************************************************************/ 02317000
*     /*                                                             */ 02318000
*     /* ENSURE THE DATA LENGTH DOES NOT EXCEED R'1 RECORD LENGTH    */ 02319000
*     /*                                                             */ 02320000
*     /***************************************************************/ 02321000
*                                                                  0716 02322000
*     IF REPR1LN-12<REPBUFF1-SAVER1BF+RBICKL+RBICDL+PD+PK THEN     0716 02323000
@RC00705 L     @15,@PC00001+8                                      0716 02324000
         LH    @15,REPR1LN(,@15)                                   0716 02325000
         N     @15,@CF01511                                        0716 02326000
         SL    @15,@CF00038                                        0716 02327000
         L     @14,@PC00001+8                                      0716 02328000
         L     @14,REPBUFF1(,@14)                                  0716 02329000
         SL    @14,SAVER1BF                                        0716 02330000
         L     @05,@PC00001+8                                      0716 02331000
         L     @01,REPBUFF1(,@05)                                  0716 02332000
         SLR   @00,@00                                             0716 02333000
         IC    @00,RBICKL(,@01)                                    0716 02334000
         ALR   @14,@00                                             0716 02335000
         L     @05,@PC00001+8                                      0716 02336000
         L     @01,REPBUFF1(,@05)                                  0716 02337000
         SLR   @00,@00                                             0716 02338000
         ICM   @00,3,RBICDL(@01)                                   0716 02339000
         ALR   @14,@00                                             0716 02340000
         SLR   @05,@05                                             0716 02341000
         IC    @05,PD                                              0716 02342000
         ALR   @14,@05                                             0716 02343000
         SLR   @05,@05                                             0716 02344000
         IC    @05,PK                                              0716 02345000
         ALR   @14,@05                                             0716 02346000
         CR    @15,@14                                             0716 02347000
         BNL   @RF00716                                            0716 02348000
*       DO;                                                        0717 02349000
*                                                                  0717 02350000
*         /***********************************************************/ 02351000
*         /*                                                         */ 02352000
*         /* THE CURRENT DATA LENGTH WILL EXCEED THE R'1 RECORD      */ 02353000
*         /* LENGTH, WHICH IS AN ERROR. THE ONLY EXCEPTION IS THE    */ 02354000
*         /* LAST RECORD IN A FBS( FIXED BLOCK STANDARD)             */ 02355000
*         /*                                                         */ 02356000
*         /***********************************************************/ 02357000
*                                                                  0718 02358000
*         IF SWFIX=1 THEN                                          0718 02359000
         CLI   SWFIX,1                                             0718 02360000
         BNE   @RF00718                                            0718 02361000
*           DO;                                                    0719 02362000
*                                                                  0719 02363000
*             /*******************************************************/ 02364000
*             /*                                                     */ 02365000
*             /* THE DEBLOCKING FAILED IN A FBS RECORD - A CHECK WILL*/ 02366000
*             /* BE MADE USING THE ACTUAL DATA LENGTH OF THE ORIGINAL*/ 02367000
*             /* RECORD SAVED IN SAVFIXDL - THIS IS DONE BECAUSE THE */ 02368000
*             /* LAST RECORD MAY BE A SHORT RECORD                   */ 02369000
*             /*                                                     */ 02370000
*             /*******************************************************/ 02371000
*                                                                  0720 02372000
*             RBICDL=SAVFIXDL;                                     0720 02373000
         L     @15,@PC00001+8                                      0720 02374000
         L     @01,REPBUFF1(,@15)                                  0720 02375000
         MVC   RBICDL(2,@01),SAVFIXDL                              0720 02376000
*             RB0CDL=SAVFIXDL;                                     0721 02377000
         L     @15,@PC00001+8                                      0721 02378000
         L     @01,REPBUFF0(,@15)                                  0721 02379000
         MVC   RB0CDL(2,@01),SAVFIXDL                              0721 02380000
*             PD=BTSPERWD-(RBICDL//BTSPERWD);                      0722 02381000
*                                                                  0722 02382000
         L     @15,@PC00001+8                                      0722 02383000
         L     @01,REPBUFF1(,@15)                                  0722 02384000
         SLR   @03,@03                                             0722 02385000
         ICM   @03,3,RBICDL(@01)                                   0722 02386000
         SLR   @02,@02                                             0722 02387000
         LH    @15,BTSPERWD                                        0722 02388000
         DR    @02,@15                                             0722 02389000
         LCR   @02,@02                                             0722 02390000
         AH    @02,BTSPERWD                                        0722 02391000
         STC   @02,PD                                              0722 02392000
*             /*******************************************************/ 02393000
*             /*                                                     */ 02394000
*             /* CHECK THAT THE LAST DEBLOCKED RECORD WILL END       */ 02395000
*             /* EXACTLY AT THE END OF R'1                           */ 02396000
*             /*                                                     */ 02397000
*             /*******************************************************/ 02398000
*                                                                  0723 02399000
*             IF REPR1LN-12=REPBUFF1-SAVER1BF+RBICKL+RBICDL+PD+PK THEN  02400000
         L     @15,@PC00001+8                                      0723 02401000
         LH    @15,REPR1LN(,@15)                                   0723 02402000
         N     @15,@CF01511                                        0723 02403000
         SL    @15,@CF00038                                        0723 02404000
         L     @14,@PC00001+8                                      0723 02405000
         L     @14,REPBUFF1(,@14)                                  0723 02406000
         SL    @14,SAVER1BF                                        0723 02407000
         L     @05,@PC00001+8                                      0723 02408000
         L     @01,REPBUFF1(,@05)                                  0723 02409000
         SLR   @00,@00                                             0723 02410000
         IC    @00,RBICKL(,@01)                                    0723 02411000
         ALR   @14,@00                                             0723 02412000
         L     @05,@PC00001+8                                      0723 02413000
         L     @01,REPBUFF1(,@05)                                  0723 02414000
         SLR   @00,@00                                             0723 02415000
         ICM   @00,3,RBICDL(@01)                                   0723 02416000
         ALR   @14,@00                                             0723 02417000
         SLR   @05,@05                                             0723 02418000
         IC    @05,PD                                              0723 02419000
         ALR   @14,@05                                             0723 02420000
         SLR   @05,@05                                             0723 02421000
         IC    @05,PK                                              0723 02422000
         ALR   @14,@05                                             0723 02423000
         CR    @15,@14                                             0723 02424000
         BNE   @RF00723                                            0723 02425000
*               DO;                                                0724 02426000
*                                                                  0724 02427000
*                 /***************************************************/ 02428000
*                 /*                                                 */ 02429000
*                 /* THE LAST RECORD DATA LENGTH OK MOVE RECORD      */ 02430000
*                 /*                                                 */ 02431000
*                 /***************************************************/ 02432000
*                                                                  0725 02433000
*                 SWLENDAT=0;                                      0725 02434000
         MVI   SWLENDAT,X'00'                                      0725 02435000
*                 TARPTR=ADDR(RB0DK)+RBICKL;                       0726 02436000
         L     @15,@PC00001+8                                      0726 02437000
         L     @01,REPBUFF0(,@15)                                  0726 02438000
         LA    @15,RB0DK(,@01)                                     0726 02439000
         L     @14,@PC00001+8                                      0726 02440000
         L     @01,REPBUFF1(,@14)                                  0726 02441000
         SLR   @14,@14                                             0726 02442000
         IC    @14,RBICKL(,@01)                                    0726 02443000
         ALR   @15,@14                                             0726 02444000
         ST    @15,TARPTR                                          0726 02445000
*                 SOURPTR=ADDR(RBIDK)+RBICKL+PD+PK;                0727 02446000
         L     @15,@PC00001+8                                      0727 02447000
         L     @01,REPBUFF1(,@15)                                  0727 02448000
         LA    @15,RBIDK(,@01)                                     0727 02449000
         L     @14,@PC00001+8                                      0727 02450000
         L     @01,REPBUFF1(,@14)                                  0727 02451000
         SLR   @14,@14                                             0727 02452000
         IC    @14,RBICKL(,@01)                                    0727 02453000
         ALR   @15,@14                                             0727 02454000
         SLR   @14,@14                                             0727 02455000
         IC    @14,PD                                              0727 02456000
         ALR   @15,@14                                             0727 02457000
         SLR   @14,@14                                             0727 02458000
         IC    @14,PK                                              0727 02459000
         ALR   @15,@14                                             0727 02460000
         ST    @15,SOURPTR                                         0727 02461000
*                 RFY                                              0728 02462000
*                  (REG2,                                          0728 02463000
*                   REG3,                                          0728 02464000
*                   REG4,                                          0728 02465000
*                   REG5) RSTD;                                    0728 02466000
*                 REG2=TARPTR;                                     0729 02467000
         L     REG2,TARPTR                                         0729 02468000
*                 REG3=RBICDL;                                     0730 02469000
         L     @15,@PC00001+8                                      0730 02470000
         L     @01,REPBUFF1(,@15)                                  0730 02471000
         SLR   REG3,REG3                                           0730 02472000
         ICM   REG3,3,RBICDL(@01)                                  0730 02473000
*                 REG4=SOURPTR;                                    0731 02474000
         L     REG4,SOURPTR                                        0731 02475000
*                 REG5=RBICDL;                                     0732 02476000
         L     @15,@PC00001+8                                      0732 02477000
         L     @01,REPBUFF1(,@15)                                  0732 02478000
         SLR   REG5,REG5                                           0732 02479000
         ICM   REG5,3,RBICDL(@01)                                  0732 02480000
*                 MVCL(REG2,REG4);                                 0733 02481000
         MVCL  REG2,REG4                                           0733 02482000
*                 RFY                                              0734 02483000
*                  (REG2,                                          0734 02484000
*                   REG3,                                          0734 02485000
*                   REG4,                                          0734 02486000
*                   REG5) UNRSTD;                                  0734 02487000
*               END;                                               0735 02488000
*             ELSE                                                 0736 02489000
*               SWLENDAT=1;                                        0736 02490000
         B     @RC00723                                            0736 02491000
@RF00723 MVI   SWLENDAT,X'01'                                      0736 02492000
*           END;                                                   0737 02493000
*         ELSE                                                     0738 02494000
*           SWLENDAT=1;                                            0738 02495000
         B     @RC00718                                            0738 02496000
@RF00718 MVI   SWLENDAT,X'01'                                      0738 02497000
*       END;                                                       0739 02498000
*     ELSE                                                         0740 02499000
*       DO;                                                        0740 02500000
*                                                                  0740 02501000
         B     @RC00716                                            0740 02502000
@RF00716 DS    0H                                                  0741 02503000
*         /***********************************************************/ 02504000
*         /*                                                         */ 02505000
*         /* MOVE DATA TO REBUILD AREA DATA STARTS AT END OF KEY AND */ 02506000
*         /* KEY PADDING AND DATA PAD AND GETS MOVED TO LOCATION PAST*/ 02507000
*         /* REBUILT KEY                                             */ 02508000
*         /*                                                         */ 02509000
*         /***********************************************************/ 02510000
*                                                                  0741 02511000
*         SWLENDAT=0;                                              0741 02512000
         MVI   SWLENDAT,X'00'                                      0741 02513000
*         TARPTR=ADDR(RB0DK)+RBICKL;                               0742 02514000
         L     @15,@PC00001+8                                      0742 02515000
         L     @01,REPBUFF0(,@15)                                  0742 02516000
         LA    @15,RB0DK(,@01)                                     0742 02517000
         L     @14,@PC00001+8                                      0742 02518000
         L     @01,REPBUFF1(,@14)                                  0742 02519000
         SLR   @14,@14                                             0742 02520000
         IC    @14,RBICKL(,@01)                                    0742 02521000
         ALR   @15,@14                                             0742 02522000
         ST    @15,TARPTR                                          0742 02523000
*         SOURPTR=ADDR(RBIDK)+RBICKL+PD+PK;                        0743 02524000
         L     @15,@PC00001+8                                      0743 02525000
         L     @01,REPBUFF1(,@15)                                  0743 02526000
         LA    @15,RBIDK(,@01)                                     0743 02527000
         L     @14,@PC00001+8                                      0743 02528000
         L     @01,REPBUFF1(,@14)                                  0743 02529000
         SLR   @14,@14                                             0743 02530000
         IC    @14,RBICKL(,@01)                                    0743 02531000
         ALR   @15,@14                                             0743 02532000
         SLR   @14,@14                                             0743 02533000
         IC    @14,PD                                              0743 02534000
         ALR   @15,@14                                             0743 02535000
         SLR   @14,@14                                             0743 02536000
         IC    @14,PK                                              0743 02537000
         ALR   @15,@14                                             0743 02538000
         ST    @15,SOURPTR                                         0743 02539000
*         RFY                                                      0744 02540000
*          (REG2,                                                  0744 02541000
*           REG3,                                                  0744 02542000
*           REG4,                                                  0744 02543000
*           REG5) RSTD;                                            0744 02544000
*         REG2=TARPTR;                                             0745 02545000
         L     REG2,TARPTR                                         0745 02546000
*         REG3=RBICDL;                                             0746 02547000
         L     @15,@PC00001+8                                      0746 02548000
         L     @01,REPBUFF1(,@15)                                  0746 02549000
         SLR   REG3,REG3                                           0746 02550000
         ICM   REG3,3,RBICDL(@01)                                  0746 02551000
*         REG4=SOURPTR;                                            0747 02552000
         L     REG4,SOURPTR                                        0747 02553000
*         REG5=RBICDL;                                             0748 02554000
         L     @15,@PC00001+8                                      0748 02555000
         L     @01,REPBUFF1(,@15)                                  0748 02556000
         SLR   REG5,REG5                                           0748 02557000
         ICM   REG5,3,RBICDL(@01)                                  0748 02558000
*         MVCL(REG2,REG4);                                         0749 02559000
         MVCL  REG2,REG4                                           0749 02560000
*         RFY                                                      0750 02561000
*          (REG2,                                                  0750 02562000
*           REG3,                                                  0750 02563000
*           REG4,                                                  0750 02564000
*           REG5) UNRSTD;                                          0750 02565000
*       END;                                                       0751 02566000
*                                                                  0751 02567000
*     /***************************************************************/ 02568000
*     /*                                                             */ 02569000
*     /* SAVE PAD INFO OF ORIG REC IN CASE OF OVERFLW AND SET DBLTBL */ 02570000
*     /* ENTRIES                                                     */ 02571000
*     /*                                                             */ 02572000
*     /***************************************************************/ 02573000
*                                                                  0752 02574000
*     SAVE4=RBI4;                                                  0752 02575000
@RC00716 L     @15,@PC00001+8                                      0752 02576000
         L     @01,REPBUFF1(,@15)                                  0752 02577000
         MVC   SAVE4(4),RBI4(@01)                                  0752 02578000
*     DBLTRPTR(OUTCNT)=REPBUFF0;                                   0753 02579000
         LH    @15,OUTCNT                                          0753 02580000
         N     @15,@CF01511                                        0753 02581000
         SLA   @15,3                                               0753 02582000
         L     @14,@PC00001+8                                      0753 02583000
         L     @14,REPBUFF0(,@14)                                  0753 02584000
         ST    @14,DBLTRPTR-8(@15)                                 0753 02585000
*     DBLTRLN(OUTCNT)=DBLTCKLN(OUTCNT)+RBICDL+LENGTH(RB0F)+LENGTH(RB0K) 02586000
*         +COUNTLEN;                                               0754 02587000
*                                                                  0754 02588000
         LH    @15,OUTCNT                                          0754 02589000
         N     @15,@CF01511                                        0754 02590000
         SLA   @15,3                                               0754 02591000
         LH    @14,OUTCNT                                          0754 02592000
         N     @14,@CF01511                                        0754 02593000
         SLA   @14,3                                               0754 02594000
         L     @05,@PC00001+8                                      0754 02595000
         L     @01,REPBUFF1(,@05)                                  0754 02596000
         LH    @14,DBLTCKLN-8(@14)                                 0754 02597000
         N     @14,@CF01511                                        0754 02598000
         SLR   @00,@00                                             0754 02599000
         ICM   @00,3,RBICDL(@01)                                   0754 02600000
         ALR   @14,@00                                             0754 02601000
         AL    @14,@CF00475                                        0754 02602000
         AH    @14,COUNTLEN                                        0754 02603000
         STH   @14,DBLTRLN-8(@15)                                  0754 02604000
*     /***************************************************************/ 02605000
*     /*                                                             */ 02606000
*     /* CK IF CURRENT RECORD GOES OUT OF R'1 RECORD                 */ 02607000
*     /*                                                             */ 02608000
*     /***************************************************************/ 02609000
*                                                                  0755 02610000
*     IF SWLENKEY=1|SWLENDAT=1 THEN                                0755 02611000
*                                                                  0755 02612000
         CLI   SWLENKEY,1                                          0755 02613000
         BE    @RT00755                                            0755 02614000
         CLI   SWLENDAT,1                                          0755 02615000
         BNE   @RF00755                                            0755 02616000
@RT00755 DS    0H                                                  0756 02617000
*       /*************************************************************/ 02618000
*       /*                                                           */ 02619000
*       /* CURRENT RECORD GOES OUT OF R'1 ISSUE MESSAGE              */ 02620000
*       /*                                                           */ 02621000
*       /*************************************************************/ 02622000
*                                                                  0756 02623000
*       DO;                                                        0756 02624000
*                                                                  0756 02625000
*         /***********************************************************/ 02626000
*         /*                                                         */ 02627000
*         /* SET REPBUFF1 TO END OF BUFF TO GET OUT OF DO WHILE      */ 02628000
*         /*                                                         */ 02629000
*         /***********************************************************/ 02630000
*                                                                  0757 02631000
*         REPBUFF1=SAVER1BF+REPR1LN+1;                             0757 02632000
*                                                                  0757 02633000
         L     @15,@PC00001+8                                      0757 02634000
         L     @14,@PC00001+8                                      0757 02635000
         LH    @14,REPR1LN(,@14)                                   0757 02636000
         N     @14,@CF01511                                        0757 02637000
         AL    @14,SAVER1BF                                        0757 02638000
         AL    @14,@CF00221                                        0757 02639000
         ST    @14,REPBUFF1(,@15)                                  0757 02640000
*         /***********************************************************/ 02641000
*         /*                                                         */ 02642000
*         /* ISSUE MESSAGE AND UPDATE ERROR COUNT TO GET OUT         */ 02643000
*         /*                                                         */ 02644000
*         /***********************************************************/ 02645000
*                                                                  0758 02646000
*         DO;                                                      0758 02647000
*           CKREQ=CKREQ&&CKREQ;                                    0759 02648000
         L     @15,@PC00001+8                                      0759 02649000
         XC    CKREQ(44,@15),CKREQ(@15)                            0759 02650000
*           CKRERN=MSG19;                                          0760 02651000
         L     @15,@PC00001+8                                      0760 02652000
         MVC   CKRERN(2,@15),@CH00643                              0760 02653000
*           CKRMVAR(1)=ADDR(SAVKEY6);                              0761 02654000
         L     @15,@PC00001+8                                      0761 02655000
         LA    @14,SAVKEY6                                         0761 02656000
         ST    @14,CKRMVAR(,@15)                                   0761 02657000
*           CKRMVAR(2)=ADDR(SAVEKEY4);                             0762 02658000
         L     @15,@PC00001+8                                      0762 02659000
         LA    @14,SAVEKEY4                                        0762 02660000
         ST    @14,CKRMVAR+4(,@15)                                 0762 02661000
*           CKRMVAR(3)=ADDR(RWFDANA);                              0763 02662000
         L     @15,@PC00001+8                                      0763 02663000
         L     @14,RWFPTR1                                         0763 02664000
         ST    @14,CKRMVAR+8(,@15)                                 0763 02665000
*           CALL IDCRDER;                                          0764 02666000
         L     @15,@CV01407                                        0764 02667000
         BALR  @14,@15                                             0764 02668000
*         END;                                                     0765 02669000
*         ERRCNT=3;                                                0766 02670000
         MVI   ERRCNT,X'03'                                        0766 02671000
*       END;                                                       0767 02672000
*                                                                  0767 02673000
*     /***************************************************************/ 02674000
*     /*                                                             */ 02675000
*     /* NO MESSAGE NEEDS TO BE ISSUED                               */ 02676000
*     /*                                                             */ 02677000
*     /***************************************************************/ 02678000
*                                                                  0768 02679000
*     ELSE                                                         0768 02680000
*                                                                  0768 02681000
*       /*************************************************************/ 02682000
*       /*                                                           */ 02683000
*       /* CHECK IF TRACKS DONT AGREE, NO FORCE AND NO ERRORS YET    */ 02684000
*       /*                                                           */ 02685000
*       /*************************************************************/ 02686000
*                                                                  0768 02687000
*       DO;                                                        0768 02688000
         B     @RC00755                                            0768 02689000
@RF00755 DS    0H                                                  0769 02690000
*         IF SAVEHH^=RBICHH&FORCE=ZERO                             0769 02691000
*                                                                  0769 02692000
*         /***********************************************************/ 02693000
*         /*                                                         */ 02694000
*         /* JUST INCREMENT ERROR COUNTER SO WILL END NEXT TIME      */ 02695000
*         /*                                                         */ 02696000
*         /***********************************************************/ 02697000
*                                                                  0769 02698000
*           THEN                                                   0769 02699000
         L     @15,@PC00001+8                                      0769 02700000
         L     @01,REPBUFF1(,@15)                                  0769 02701000
         CLC   SAVEHH(2),RBICHH(@01)                               0769 02702000
         BE    @RF00769                                            0769 02703000
         SLR   @15,@15                                             0769 02704000
         IC    @15,FORCE                                           0769 02705000
         CH    @15,ZERO                                            0769 02706000
         BNE   @RF00769                                            0769 02707000
*           ERRCNT=ERRCNT+1;                                       0770 02708000
         LA    @15,1                                               0770 02709000
         SLR   @14,@14                                             0770 02710000
         IC    @14,ERRCNT                                          0770 02711000
         ALR   @15,@14                                             0770 02712000
         STC   @15,ERRCNT                                          0770 02713000
*         ELSE                                                     0771 02714000
*           ;                                                      0771 02715000
*                                                                  0771 02716000
@RF00769 DS    0H                                                  0772 02717000
*         /***********************************************************/ 02718000
*         /*                                                         */ 02719000
*         /* INCREMNT BUFFERS TO NEXT RECORD DESTINATION AND LOC     */ 02720000
*         /*                                                         */ 02721000
*         /***********************************************************/ 02722000
*                                                                  0772 02723000
*         REPBUFF0=REPBUFF0+RBICKL+RBICDL+LENGTH(RB0K)+LENGTH(RB0F)+    02724000
*             COUNTLEN;                                            0772 02725000
         L     @15,@PC00001+8                                      0772 02726000
         L     @14,@PC00001+8                                      0772 02727000
         L     @05,@PC00001+8                                      0772 02728000
         L     @01,REPBUFF1(,@05)                                  0772 02729000
         SLR   @00,@00                                             0772 02730000
         IC    @00,RBICKL(,@01)                                    0772 02731000
         AL    @00,REPBUFF0(,@14)                                  0772 02732000
         L     @14,@PC00001+8                                      0772 02733000
         L     @01,REPBUFF1(,@14)                                  0772 02734000
         SLR   @14,@14                                             0772 02735000
         ICM   @14,3,RBICDL(@01)                                   0772 02736000
         ALR   @00,@14                                             0772 02737000
         AL    @00,@CF00475                                        0772 02738000
         AH    @00,COUNTLEN                                        0772 02739000
         ST    @00,REPBUFF0(,@15)                                  0772 02740000
*         REPBUFF1=REPBUFF1+RBICKL+RBICDL+PK+PD+LENGTH(RBI4)+COUNTLEN;  02741000
         L     @15,@PC00001+8                                      0773 02742000
         L     @14,@PC00001+8                                      0773 02743000
         L     @05,@PC00001+8                                      0773 02744000
         L     @01,REPBUFF1(,@05)                                  0773 02745000
         SLR   @00,@00                                             0773 02746000
         IC    @00,RBICKL(,@01)                                    0773 02747000
         AL    @00,REPBUFF1(,@14)                                  0773 02748000
         L     @14,@PC00001+8                                      0773 02749000
         L     @01,REPBUFF1(,@14)                                  0773 02750000
         SLR   @14,@14                                             0773 02751000
         ICM   @14,3,RBICDL(@01)                                   0773 02752000
         ALR   @00,@14                                             0773 02753000
         SLR   @01,@01                                             0773 02754000
         IC    @01,PK                                              0773 02755000
         ALR   @00,@01                                             0773 02756000
         SLR   @01,@01                                             0773 02757000
         IC    @01,PD                                              0773 02758000
         ALR   @00,@01                                             0773 02759000
         AL    @00,@CF00045                                        0773 02760000
         AH    @00,COUNTLEN                                        0773 02761000
         ST    @00,REPBUFF1(,@15)                                  0773 02762000
*       END;                                                       0774 02763000
*                                                                  0774 02764000
*     /***************************************************************/ 02765000
*     /*                                                             */ 02766000
*     /* END OF DO WHILE                                             */ 02767000
*     /*                                                             */ 02768000
*     /***************************************************************/ 02769000
*                                                                  0775 02770000
*   END;                                                           0775 02771000
*                                                                  0775 02772000
@RC00755 DS    0H                                                  0775 02773000
@DE00684 L     @15,@PC00001+8                                      0775 02774000
         L     @14,@PC00001+8                                      0775 02775000
         L     @14,REPBUFF1(,@14)                                  0775 02776000
         SL    @14,SAVER1BF                                        0775 02777000
         LH    @15,REPR1LN(,@15)                                   0775 02778000
         N     @15,@CF01511                                        0775 02779000
         CR    @14,@15                                             0775 02780000
         BL    @DL00684                                            0775 02781000
*   /*****************************************************************/ 02782000
*   /*                                                               */ 02783000
*   /* SET UDUMP                                                     */ 02784000
*   /*                                                               */ 02785000
*   /*****************************************************************/ 02786000
*                                                                  0776 02787000
*   IF GDTDBG=NULLPTR THEN                                         0776 02788000
         L     @15,@PC00001                                        0776 02789000
         L     @15,GDTDBG(,@15)                                    0776 02790000
         LTR   @15,@15                                             0776 02791000
         BZ    @RT00776                                            0776 02792000
*     ;                                                            0777 02793000
*   ELSE                                                           0778 02794000
*     CALL IDCDB010(GDTTBL,'RD45');                                0778 02795000
         L     @15,@PC00001                                        0778 02796000
         ST    @15,@AL00001                                        0778 02797000
         LA    @15,@CC01500                                        0778 02798000
         ST    @15,@AL00001+4                                      0778 02799000
         MVI   @AL00001+4,X'80'                                    0778 02800000
         L     @14,@PC00001                                        0778 02801000
         L     @15,GDTDBG(,@14)                                    0778 02802000
         LA    @01,@AL00001                                        0778 02803000
         BALR  @14,@15                                             0778 02804000
*   IF ERRCNT>1 THEN                                               0779 02805000
@RT00776 CLI   ERRCNT,1                                            0779 02806000
         BNH   @RF00779                                            0779 02807000
*     DO;                                                          0780 02808000
*                                                                  0780 02809000
*       /*************************************************************/ 02810000
*       /*                                                           */ 02811000
*       /* RETURN - DONT ISSUE ANY MESSAGES                          */ 02812000
*       /*                                                           */ 02813000
*       /*************************************************************/ 02814000
*                                                                  0781 02815000
*       REPRC=4;                                                   0781 02816000
         L     @15,@PC00001+8                                      0781 02817000
         MVC   REPRC(2,@15),@CH00045                               0781 02818000
*       RETURN CODE(LASTCC04);                                     0782 02819000
         LA    @15,4                                               0782 02820000
         L     @14,@SA00003                                        0782 02821000
         LM    @00,@12,@SA00003+8                                  0782 02822000
         BR    @14                                                 0782 02823000
*     END;                                                         0783 02824000
*   ELSE                                                           0784 02825000
*     ;                                                            0784 02826000
*                                                                  0784 02827000
@RF00779 DS    0H                                                  0785 02828000
*   /*****************************************************************/ 02829000
*   /*                                                               */ 02830000
*   /* CHECK IF LAST RECORD WAS AN OVERFLOW RECORD                   */ 02831000
*   /*                                                               */ 02832000
*   /*****************************************************************/ 02833000
*                                                                  0785 02834000
*   IF SAVE50VF=ON THEN                                            0785 02835000
         TM    SAVE50VF,B'00010000'                                0785 02836000
         BNO   @RF00785                                            0785 02837000
*     DO;                                                          0786 02838000
*                                                                  0786 02839000
*       /*************************************************************/ 02840000
*       /*                                                           */ 02841000
*       /* LAST REC OVERFLOW - SET OVERFLOW BIT ON AND SET THE NEW   */ 02842000
*       /* ERROR FLAG TO EITHER 11 OR 12 TO INDICATE THE OVERFLOW    */ 02843000
*       /* CONDITION                                                 */ 02844000
*       /*                                                           */ 02845000
*       /*************************************************************/ 02846000
*                                                                  0787 02847000
*       RFY                                                        0787 02848000
*         RB0 BASED(DBLTRPTR(OUTCNT));                             0787 02849000
*       RB0FOVF=1;                                                 0788 02850000
         LH    @15,OUTCNT                                          0788 02851000
         N     @15,@CF01511                                        0788 02852000
         SLA   @15,3                                               0788 02853000
         L     @01,DBLTRPTR-8(@15)                                 0788 02854000
         MVI   RB0FOVF(@01),X'01'                                  0788 02855000
*       RB0FERR=RB0FERR+2;                                         0789 02856000
         LH    @15,OUTCNT                                          0789 02857000
         N     @15,@CF01511                                        0789 02858000
         SLA   @15,3                                               0789 02859000
         L     @01,DBLTRPTR-8(@15)                                 0789 02860000
         LH    @15,OUTCNT                                          0789 02861000
         N     @15,@CF01511                                        0789 02862000
         SLA   @15,3                                               0789 02863000
         L     @15,DBLTRPTR-8(@15)                                 0789 02864000
         LA    @14,2                                               0789 02865000
         SLR   @00,@00                                             0789 02866000
         ICM   @00,3,RB0FERR(@15)                                  0789 02867000
         ALR   @14,@00                                             0789 02868000
         STCM  @14,3,RB0FERR(@01)                                  0789 02869000
*     END;                                                         0790 02870000
*   ELSE                                                           0791 02871000
*     ;                                                            0791 02872000
*                                                                  0791 02873000
@RF00785 DS    0H                                                  0792 02874000
*   /*****************************************************************/ 02875000
*   /*                                                               */ 02876000
*   /* REWRITE DEBLOCKED RECORDS                                     */ 02877000
*   /*                                                               */ 02878000
*   /*****************************************************************/ 02879000
*                                                                  0792 02880000
*   DO ICNT2=1 TO OUTCNT;                                          0792 02881000
         LA    @15,1                                               0792 02882000
         B     @DE00792                                            0792 02883000
@DL00792 DS    0H                                                  0793 02884000
*     WFIODAD=DBLTRPTR(ICNT2);                                     0793 02885000
         L     @15,@PC00001+8                                      0793 02886000
         LH    @14,ICNT2                                           0793 02887000
         SLA   @14,3                                               0793 02888000
         L     @14,DBLTRPTR-8(@14)                                 0793 02889000
         ST    @14,WFIODAD(,@15)                                   0793 02890000
*     WFIODLN=DBLTRLN(ICNT2);                                      0794 02891000
         L     @15,@PC00001+8                                      0794 02892000
         LH    @14,ICNT2                                           0794 02893000
         SLA   @14,3                                               0794 02894000
         LH    @14,DBLTRLN-8(@14)                                  0794 02895000
         N     @14,@CF01511                                        0794 02896000
         ST    @14,WFIODLN(,@15)                                   0794 02897000
*     DO;                                                          0795 02898000
*       WFREQ=''B;                                                 0796 02899000
         L     @15,@PC00001+8                                      0796 02900000
         XC    WFREQ(2,@15),WFREQ(@15)                             0796 02901000
*       WFRUPD=ON;                  /* UPDRCD                        */ 02902000
         L     @15,@PC00001+8                                      0797 02903000
         OI    WFRUPD(@15),B'00010000'                             0797 02904000
*       WFRUP=ON;                   /* UPDATE                        */ 02905000
         L     @15,@PC00001+8                                      0798 02906000
         OI    WFRUP(@15),B'01000000'                              0798 02907000
*       CALL IDCRDIO;                                              0799 02908000
         L     @15,@CV01408                                        0799 02909000
         BALR  @14,@15                                             0799 02910000
*       RFY                                                        0800 02911000
*         RTNREG RSTD;                                             0800 02912000
*       TESTRC=RTNREG;                                             0801 02913000
         STH   RTNREG,TESTRC                                       0801 02914000
*       RFY                                                        0802 02915000
*         RTNREG UNRSTD;                                           0802 02916000
*     END;                                                         0803 02917000
*     IF TESTRC^=0 THEN                                            0804 02918000
         LH    @15,TESTRC                                          0804 02919000
         LTR   @15,@15                                             0804 02920000
         BZ    @RF00804                                            0804 02921000
*       DO;                                                        0805 02922000
*         DO;                                                      0806 02923000
*           CKREQ=CKREQ&&CKREQ;                                    0807 02924000
         L     @15,@PC00001+8                                      0807 02925000
         XC    CKREQ(44,@15),CKREQ(@15)                            0807 02926000
*           CKRERN=MSG19;                                          0808 02927000
         L     @15,@PC00001+8                                      0808 02928000
         MVC   CKRERN(2,@15),@CH00643                              0808 02929000
*           CKRMVAR(1)=ADDR(SAVKEY6);                              0809 02930000
         L     @15,@PC00001+8                                      0809 02931000
         LA    @14,SAVKEY6                                         0809 02932000
         ST    @14,CKRMVAR(,@15)                                   0809 02933000
*           CKRMVAR(2)=ADDR(SAVEKEY4);                             0810 02934000
         L     @15,@PC00001+8                                      0810 02935000
         LA    @14,SAVEKEY4                                        0810 02936000
         ST    @14,CKRMVAR+4(,@15)                                 0810 02937000
*           CKRMVAR(3)=ADDR(RWFDANA);                              0811 02938000
         L     @15,@PC00001+8                                      0811 02939000
         L     @14,RWFPTR1                                         0811 02940000
         ST    @14,CKRMVAR+8(,@15)                                 0811 02941000
*           CALL IDCRDER;                                          0812 02942000
         L     @15,@CV01407                                        0812 02943000
         BALR  @14,@15                                             0812 02944000
*         END;                                                     0813 02945000
*         REPRC=12;                                                0814 02946000
         L     @15,@PC00001+8                                      0814 02947000
         MVC   REPRC(2,@15),@CH00038                               0814 02948000
*         RETURN CODE(LASTCC12);                                   0815 02949000
         LA    @15,12                                              0815 02950000
         L     @14,@SA00003                                        0815 02951000
         LM    @00,@12,@SA00003+8                                  0815 02952000
         BR    @14                                                 0815 02953000
*       END;                                                       0816 02954000
*   END;                                                           0817 02955000
*                                                                  0817 02956000
@RF00804 LA    @15,1                                               0817 02957000
         AH    @15,ICNT2                                           0817 02958000
@DE00792 STH   @15,ICNT2                                           0817 02959000
         LH    @14,OUTCNT                                          0817 02960000
         N     @14,@CF01511                                        0817 02961000
         CR    @15,@14                                             0817 02962000
         BNH   @DL00792                                            0817 02963000
*   /*****************************************************************/ 02964000
*   /*                                                               */ 02965000
*   /* RETURN WITH RC FROM REWRITE                                   */ 02966000
*   /*                                                               */ 02967000
*   /*****************************************************************/ 02968000
*                                                                  0818 02969000
*   RETURN CODE(LASTCC00);                                         0818 02970000
         SLR   @15,@15                                             0818 02971000
         L     @14,@SA00003                                        0818 02972000
         LM    @00,@12,@SA00003+8                                  0818 02973000
         BR    @14                                                 0818 02974000
*   END DBLKER;                                                    0819 02975000
*   END IDCRD040;                                                  0820 02976000
*   END IDCRD04                                                    0821 02977000
*                                                                  0821 02978000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02979000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 02980000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 02981000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 02982000
*/*%INCLUDE SYSLIB  (IDCCSRD )                                       */ 02983000
*/*%INCLUDE SYSLIB  (IDCDF65 )                                       */ 02984000
*/*%INCLUDE SYSLIB  (IDCDF66 )                                       */ 02985000
*                                                                  0821 02986000
*       ;                                                          0821 02987000
@DATA    DS    0H                                                       02988000
@CH00288 DC    H'5'                                                     02989000
@CH00181 DC    H'8'                                                     02990000
@CH00035 DC    H'9'                                                     02991000
@CH00036 DC    H'10'                                                    02992000
@CH00611 DC    H'13'                                                    02993000
@CH00617 DC    H'14'                                                    02994000
@CH00630 DC    H'17'                                                    02995000
@CH00632 DC    H'18'                                                    02996000
@CH00643 DC    H'19'                                                    02997000
@CH00711 DC    H'36'                                                    02998000
@CH00717 DC    H'37'                                                    02999000
@CH00600 DC    H'44'                                                    03000000
@CH00781 DC    H'47'                                                    03001000
@CH00864 DC    H'92'                                                    03002000
@SM01513 MVC   RB0DK(0,@01),RBIDK(@05)                                  03003000
         DS    0F                                                       03004000
@AL00351 DC    A(OUT)                  LIST WITH   1 ARGUMENT(S)        03005000
@AL00383 EQU   *                       LIST WITH   2 ARGUMENT(S)        03006000
@AL00414 DC    A(POOLRD01)             LIST WITH   2 ARGUMENT(S)        03007000
         DC    AL1(X'80')                                               03008000
         DC    AL3(ALL)                                                 03009000
@DATD    DSECT                                                          03010000
         DS    0F                                                       03011000
@SA00001 DS    18F                                                      03012000
@PC00001 DS    3F                                                       03013000
@SA00002 DS    15F                                                      03014000
@SA00003 DS    15F                                                      03015000
@AL00001 DS    3A                                                       03016000
IDCRD04  CSECT                                                          03017000
         DS    0F                                                       03018000
@CF00221 DC    F'1'                                                     03019000
@CH00221 EQU   @CF00221+2                                               03020000
@CF00045 DC    F'4'                                                     03021000
@CH00045 EQU   @CF00045+2                                               03022000
@CF00038 DC    F'12'                                                    03023000
@CH00038 EQU   @CF00038+2                                               03024000
@CF00475 DC    F'16'                                                    03025000
@CH00475 EQU   @CF00475+2                                               03026000
@CF00312 DC    F'24'                                                    03027000
@CF01269 DC    F'125'                                                   03028000
@CF01512 DC    F'-4'                                                    03029000
@CF01511 DC    XL4'0000FFFF'                                            03030000
@DATD    DSECT                                                          03031000
         DS    0D                                                       03032000
LISTSCAN DS    A                                                        03033000
IOCSPTR  DS    A                                                        03034000
OPNPTR   DS    A                                                        03035000
DDSTRU   DS    A                                                        03036000
FSADDR   DS    A                                                        03037000
ERCNVADR DS    A                                                        03038000
DMPINDEX DS    A                                                        03039000
SAVEBF0  DS    A                                                        03040000
SAVEBF1  DS    A                                                        03041000
SAVER1BF DS    A                                                        03042000
TARPTR   DS    A                                                        03043000
SOURPTR  DS    A                                                        03044000
RWFPTR1  DS    A                                                        03045000
LISTPTR  DS    A                                                        03046000
TESTRC   DS    H                                                        03047000
RB0LEN   DS    H                                                        03048000
OUTCNT   DS    H                                                        03049000
ICNT1    DS    H                                                        03050000
ICNT2    DS    H                                                        03051000
LASTCC   DS    H                                                        03052000
SAVEHH   DS    H                                                        03053000
SAVER1DL DS    H                                                        03054000
SETRC    DS    H                                                        03055000
ERRCNT   DS    FL1                                                      03056000
SWFIX    DS    FL1                                                      03057000
SWLENKEY DS    FL1                                                      03058000
SWLENDAT DS    FL1                                                      03059000
PK       DS    FL1                                                      03060000
PD       DS    FL1                                                      03061000
FORCE    DS    FL1                                                      03062000
LISTLN   DS    FL1                                                      03063000
@TS00001 DS    CL95                                                     03064000
CRNTKEY  DS    CL11                                                     03065000
         ORG   CRNTKEY                                                  03066000
CRNVOLS  DS    CL6                                                      03067000
CRNCCHH  DS    CL4                                                      03068000
         ORG   CRNCCHH                                                  03069000
CRNCC    DS    CL2                                                      03070000
CRNHH    DS    CL2                                                      03071000
         ORG   CRNTKEY+10                                               03072000
CRNR     DS    FL1                                                      03073000
         ORG   CRNTKEY+11                                               03074000
LASTKEY  DS    CL11                                                     03075000
         ORG   LASTKEY                                                  03076000
LASVOLS  DS    CL6                                                      03077000
LASCC    DS    CL4                                                      03078000
         ORG   LASCC                                                    03079000
LASTC    DS    CL2                                                      03080000
LASTHH   DS    CL2                                                      03081000
         ORG   LASTKEY+10                                               03082000
LASR     DS    FL1                                                      03083000
         ORG   LASTKEY+11                                               03084000
SAVFIXDL DS    CL2                                                      03085000
SAVEKEY  DS    CL11                                                     03086000
         ORG   SAVEKEY                                                  03087000
SAVKEY6  DS    CL6                                                      03088000
SAVEKEY4 DS    CL4                                                      03089000
SAVEKEYR DS    CL1                                                      03090000
         ORG   SAVEKEY+11                                               03091000
SAVEFL   DS    CL5                                                      03092000
         ORG   SAVEFL                                                   03093000
SAVEFLMD DS    FL1                                                      03094000
SAVFLER  DS    CL2                                                      03095000
SAVFLOV  DS    FL1                                                      03096000
@NM00078 DS    CL1                                                      03097000
         ORG   SAVEFL+5                                                 03098000
SAVE4    DS    CL4                                                      03099000
         ORG   SAVE4                                                    03100000
@NM00079 DS    CL3                                                      03101000
SAVE5CF  DS    CL1                                                      03102000
         ORG   SAVE5CF                                                  03103000
@NM00080 DS    BL1                                                      03104000
SAVE50VF EQU   SAVE5CF+0                                                03105000
@NM00081 EQU   SAVE5CF+0                                                03106000
         ORG   SAVE4+4                                                  03107000
         DS    CL3                                                      03108000
ZEROCCHH DS    CL5                                                      03109000
         ORG   ZEROCCHH                                                 03110000
ZECCHH   DS    FL4                                                      03111000
ZERR     DS    FL1                                                      03112000
         ORG   ZEROCCHH+5                                               03113000
         DS    CL3                                                      03114000
ONECCHH  DS    CL5                                                      03115000
         ORG   ONECCHH                                                  03116000
ONCCHH   DS    FL4                                                      03117000
ONER     DS    FL1                                                      03118000
         ORG   ONECCHH+5                                                03119000
         DS    CL3                                                      03120000
DBLTBL   DS    CL8                                                      03121000
         ORG   DBLTBL+0                                                 03122000
DBLTCKLN DS    FL2                                                      03123000
DBLTRLN  DS    FL2                                                      03124000
DBLTRPTR DS    AL4                                                      03125000
         ORG   DBLTBL+1000                                              03126000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                03127000
@ENDDATD EQU   *                                                        03128000
IDCRD04  CSECT                                                          03129000
         DS    0F                                                       03130000
@SIZDATD DC    AL1(0)                                                   03131000
         DC    AL3(@ENDDATD-@DATD)                                      03132000
@CV01406 DC    V(IDCRDRF)                                               03133000
@CV01407 DC    V(IDCRDER)                                               03134000
@CV01408 DC    V(IDCRDIO)                                               03135000
         DS    0D                                                       03136000
BTSPERWD DC    H'4'                                                     03137000
ZERO     DC    H'0'                                                     03138000
R0CDLEN  DC    H'16'                                                    03139000
COUNTLEN DC    H'8'                                                     03140000
DBLKFLG  DC    AL1(2)                                                   03141000
NONZERO  DC    AL1(1)                                                   03142000
@CC01480 DC    C'RD40'                                                  03143000
@CC01481 DC    C'RD41'                                                  03144000
@CC01495 DC    C'RD42'                                                  03145000
@CC01496 DC    C'RD43'                                                  03146000
@CC01499 DC    C'RD44'                                                  03147000
@CC01500 DC    C'RD45'                                                  03148000
ALL      DC    CL3'ALL'                                                 03149000
FORMAT   DC    CL4'FORM'                                                03150000
HSECOND  DC    CL4'HSEC'                                                03151000
CLOCK    DC    CL4'KLOK'                                                03152000
SETZERO  DC    CL4'ZERO'                                                03153000
SETBLANK DC    CL4'BLNK'                                                03154000
NOSET    DC    CL4'NSET'                                                03155000
OVERRIDE DC    CL4'OVRD'                                                03156000
ACQUIRE  DC    CL8'ACQUIRE '                                            03157000
RELINQ   DC    CL8'RELINQ  '                                            03158000
MOUNT    DC    CL8'MOUNT   '                                            03159000
DEMOUNT  DC    CL8'DEMOUNT '                                            03160000
DEFINE   DC    CL8'DEFINE  '                                            03161000
MOVE     DC    CL8'MOVE    '                                            03162000
TRACEQ   DC    CL8'TRACEQ  '                                            03163000
COPYTABL DC    CL8'COPYTABL'                                            03164000
COPYCRTG DC    CL8'COPYCRTG'                                            03165000
COPYVOL  DC    CL8'COPYVOL '                                            03166000
VVIC     DC    CL8'VVIC    '                                            03167000
TUNE     DC    CL8'TUNE    '                                            03168000
NAMES    DC    CL4'NAME'                                                03169000
UNIT     DC    CL4'UNIT'                                                03170000
SHR      DC    CL4'SHR '                                                03171000
EXCL     DC    CL4'EXCL'                                                03172000
NOWAIT   DC    CL4'NWAI'                                                03173000
WAIT     DC    CL4'WAIT'                                                03174000
OUT      DC    CL1'O'                                                   03175000
FIXIND   DC    CL1'F'                                                   03176000
POOLRD01 DC    CL8'RD01'                                                03177000
LARGE    DC    CL5'LARGE'                                               03178000
SMALL    DC    CL5'SMALL'                                               03179000
MODID    DC    CL4'RD04'                                                03180000
RANGELIT DC    CL13'RANGE        '                                      03181000
UPATCHIT DS    CL1024                                                   03182000
         ORG   UPATCHIT                                                 03183000
@NM00082 DC    256X'00'                                                 03184000
@NM00083 DC    256X'00'                                                 03185000
@NM00084 DC    256X'00'                                                 03186000
@NM00085 DC    256X'00'                                                 03187000
         ORG   UPATCHIT+1024                                            03188000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03189000
@01      EQU   01                                                       03190000
@02      EQU   02                                                       03191000
@03      EQU   03                                                       03192000
@04      EQU   04                                                       03193000
@05      EQU   05                                                       03194000
@06      EQU   06                                                       03195000
@07      EQU   07                                                       03196000
@08      EQU   08                                                       03197000
@09      EQU   09                                                       03198000
@10      EQU   10                                                       03199000
@11      EQU   11                                                       03200000
@12      EQU   12                                                       03201000
@13      EQU   13                                                       03202000
@14      EQU   14                                                       03203000
@15      EQU   15                                                       03204000
RTNREG   EQU   @15                                                      03205000
REG2     EQU   @02                                                      03206000
REG3     EQU   @03                                                      03207000
REG4     EQU   @04                                                      03208000
REG5     EQU   @05                                                      03209000
REG7     EQU   @07                                                      03210000
REG8     EQU   @08                                                      03211000
REG0     EQU   @00                                                      03212000
REG1     EQU   @01                                                      03213000
REG10    EQU   @10                                                      03214000
REG11    EQU   @11                                                      03215000
REG12    EQU   @12                                                      03216000
REG13    EQU   @13                                                      03217000
REG14    EQU   @14                                                      03218000
REG15    EQU   @15                                                      03219000
REG6     EQU   @06                                                      03220000
REG9     EQU   @09                                                      03221000
IDCSAEP0 EQU   0                                                        03222000
IDCSAFP0 EQU   0                                                        03223000
TRACE1   EQU   0                                                        03224000
OLDERID1 EQU   TRACE1                                                   03225000
TRACE2   EQU   0                                                        03226000
OLDERID2 EQU   TRACE2                                                   03227000
NEWID2   EQU   TRACE2+95                                                03228000
NEWERID2 EQU   5                                                        03229000
CIRAGL   EQU   0                                                        03230000
CIRTYPE  EQU   CIRAGL                                                   03231000
ALLAGL   EQU   0                                                        03232000
ALLSTS   EQU   ALLAGL+24                                                03233000
ALLDSP   EQU   ALLAGL+25                                                03234000
ALLORG   EQU   ALLAGL+26                                                03235000
ALLOPT   EQU   ALLAGL+28                                                03236000
UNITABL  EQU   0                                                        03237000
UNITADR  EQU   UNITABL+4                                                03238000
@NM00010 EQU   UNITADR                                                  03239000
UNITSTAT EQU   UNITABL+6                                                03240000
IDCIOCL0 EQU   0                                                        03241000
IOCSTR   EQU   0                                                        03242000
IOCDSO   EQU   IOCSTR+16                                                03243000
IOCRFM   EQU   IOCSTR+17                                                03244000
IOCMAC   EQU   IOCSTR+18                                                03245000
IOCMAC2  EQU   IOCSTR+19                                                03246000
IOCCHP   EQU   IOCSTR+20                                                03247000
IOCMSG   EQU   IOCSTR+21                                                03248000
IOCDSN   EQU   IOCSTR+32                                                03249000
IOCRBA   EQU   IOCSTR+40                                                03250000
IOCTTR   EQU   IOCRBA                                                   03251000
IOCMEM   EQU   IOCSTR+44                                                03252000
IOCNWM   EQU   IOCSTR+48                                                03253000
OPNAGL   EQU   0                                                        03254000
OPNOPT   EQU   OPNAGL                                                   03255000
OPNRFM   EQU   OPNAGL+1                                                 03256000
OPNTYP   EQU   OPNAGL+2                                                 03257000
OPNMOD   EQU   OPNAGL+3                                                 03258000
OPNDEV   EQU   OPNAGL+24                                                03259000
OPNDSO   EQU   OPNAGL+41                                                03260000
OPNOPT2  EQU   OPNAGL+42                                                03261000
IOINFOPT EQU   0                                                        03262000
UVOLLIST EQU   0                                                        03263000
UVOLENT  EQU   UVOLLIST+2                                               03264000
DARGLIST EQU   0                                                        03265000
DARGSTID EQU   DARGLIST+8                                               03266000
DARGARY  EQU   DARGLIST+20                                              03267000
DARGINS  EQU   DARGARY                                                  03268000
DARGINL  EQU   DARGARY+2                                                03269000
FMTLIST  EQU   0                                                        03270000
FMTFLGS  EQU   FMTLIST                                                  03271000
FMTSPF   EQU   FMTLIST+2                                                03272000
FMTRFNO  EQU   FMTSPF                                                   03273000
FMTILEN  EQU   FMTRFNO                                                  03274000
FMTIOFF  EQU   FMTLIST+4                                                03275000
FMTTRBC  EQU   FMTIOFF                                                  03276000
FMTSTO   EQU   FMTTRBC                                                  03277000
FMTOCOL  EQU   FMTLIST+6                                                03278000
FMTCNVF  EQU   FMTLIST+10                                               03279000
ERCNVTAB EQU   0                                                        03280000
ERTYPE   EQU   ERCNVTAB                                                 03281000
EROPER   EQU   ERCNVTAB+1                                               03282000
EROSOPER EQU   ERCNVTAB+2                                               03283000
IDCDB010 EQU   0                                                        03284000
DMPITM   EQU   0                                                        03285000
DMPARY   EQU   0                                                        03286000
INFIL    EQU   0                                                        03287000
INDS     EQU   0                                                        03288000
INDSFLG  EQU   INDS+10                                                  03289000
DOUTF    EQU   0                                                        03290000
DOTDS    EQU   0                                                        03291000
DOTDSFLG EQU   DOTDS+10                                                 03292000
VOLSR    EQU   0                                                        03293000
VOLSRFLG EQU   VOLSR+10                                                 03294000
DCCHR    EQU   0                                                        03295000
DREC     EQU   0                                                        03296000
VOLDS    EQU   0                                                        03297000
VOLDSFLG EQU   VOLDS+10                                                 03298000
DSCHR    EQU   0                                                        03299000
DSCHH    EQU   0                                                        03300000
VOLRR    EQU   0                                                        03301000
VOLRRFLG EQU   VOLRR+10                                                 03302000
RRCHR    EQU   0                                                        03303000
RRCHH    EQU   0                                                        03304000
DKEYL    EQU   0                                                        03305000
DATAL    EQU   0                                                        03306000
DVTCS    EQU   0                                                        03307000
DVTCSFLG EQU   DVTCS+10                                                 03308000
CINFL    EQU   0                                                        03309000
CINDS    EQU   0                                                        03310000
CINDSFLG EQU   CINDS+10                                                 03311000
COFIL    EQU   0                                                        03312000
CCATL    EQU   0                                                        03313000
CCATLFLG EQU   CCATL+10                                                 03314000
CVOLD    EQU   0                                                        03315000
CVOLDFLG EQU   CVOLD+10                                                 03316000
CDCHR    EQU   0                                                        03317000
CDHHR    EQU   0                                                        03318000
CVOLS    EQU   0                                                        03319000
CVOLSFLG EQU   CVOLS+10                                                 03320000
CCCHR    EQU   0                                                        03321000
CRECR    EQU   0                                                        03322000
CKEYL    EQU   0                                                        03323000
CDATL    EQU   0                                                        03324000
CVTCS    EQU   0                                                        03325000
CVTCSFLG EQU   CVTCS+10                                                 03326000
DBFIL    EQU   0                                                        03327000
DBDS     EQU   0                                                        03328000
DBDSFLG  EQU   DBDS+10                                                  03329000
DBLST    EQU   0                                                        03330000
DBLSTCNT EQU   0                                                        03331000
DBVOL    EQU   0                                                        03332000
DBVOLFLG EQU   DBVOL+10                                                 03333000
DBVOLVAL EQU   DBVOL+21                                                 03334000
DBCCH    EQU   0                                                        03335000
DBCCHVAL EQU   DBCCH+1                                                  03336000
DBHHH    EQU   0                                                        03337000
DBHHHVAL EQU   DBHHH+1                                                  03338000
DBKEYPTR EQU   0                                                        03339000
DBKEY    EQU   0                                                        03340000
DBKEYVAL EQU   DBKEY                                                    03341000
DBDATPTR EQU   0                                                        03342000
DBDAT    EQU   0                                                        03343000
DBDATVAL EQU   DBDAT                                                    03344000
MNCNT    EQU   0                                                        03345000
MINFL    EQU   0                                                        03346000
MINDS    EQU   0                                                        03347000
MINDSFLG EQU   MINDS+10                                                 03348000
MOUTF    EQU   0                                                        03349000
MODS     EQU   0                                                        03350000
MODSFLG  EQU   MODS+10                                                  03351000
MVTCS    EQU   0                                                        03352000
MVTCSFLG EQU   MVTCS+10                                                 03353000
MVTCR    EQU   0                                                        03354000
MIRVO    EQU   0                                                        03355000
MIRVOFLG EQU   MIRVO+10                                                 03356000
MIRCH    EQU   0                                                        03357000
MIDVO    EQU   0                                                        03358000
MIDVOFLG EQU   MIDVO+10                                                 03359000
MIDCH    EQU   0                                                        03360000
MRRVO    EQU   0                                                        03361000
MRRVOFLG EQU   MRRVO+10                                                 03362000
MRRCH    EQU   0                                                        03363000
MRRHH    EQU   0                                                        03364000
MNDOF    EQU   0                                                        03365000
MNDST    EQU   0                                                        03366000
MNKOF    EQU   0                                                        03367000
MNKST    EQU   0                                                        03368000
MORVO    EQU   0                                                        03369000
MORVOFLG EQU   MORVO+10                                                 03370000
MORCH    EQU   0                                                        03371000
MODVO    EQU   0                                                        03372000
MODVOFLG EQU   MODVO+10                                                 03373000
MODCH    EQU   0                                                        03374000
RWFHDR   EQU   0                                                        03375000
SRPRTARG EQU   0                                                        03376000
RWFINFO  EQU   0                                                        03377000
RWFKEY1  EQU   RWFINFO+82                                               03378000
RWFKEY2  EQU   RWFINFO+93                                               03379000
RWHDRINF EQU   0                                                        03380000
RDARG    EQU   0                                                        03381000
RDCHR    EQU   RDARG+26                                                 03382000
RDSPACE  EQU   RDARG+36                                                 03383000
RDSPKL   EQU   RDARG+47                                                 03384000
INFOAREA EQU   0                                                        03385000
INFODSN  EQU   0                                                        03386000
INFOVOL  EQU   0                                                        03387000
DEVAREA  EQU   0                                                        03388000
DEVDEVTP EQU   DEVAREA                                                  03389000
DEVTBYT2 EQU   DEVDEVTP+1                                               03390000
@NM00054 EQU   DEVAREA+8                                                03391000
DEVWORD3 EQU   DEVAREA+12                                               03392000
DEVBOH   EQU   DEVWORD3+2                                               03393000
DEVWORD4 EQU   DEVAREA+16                                               03394000
DEV4B1   EQU   DEVWORD4+1                                               03395000
XTNTTBL2 EQU   0                                                        03396000
XTN2ENT  EQU   XTNTTBL2                                                 03397000
XTN2CHR1 EQU   XTN2ENT+44                                               03398000
XTN2CHR2 EQU   XTN2ENT+48                                               03399000
XTNTTBL  EQU   0                                                        03400000
XTNTHDR  EQU   XTNTTBL                                                  03401000
XTNHCHR1 EQU   XTNTHDR+68                                               03402000
XTNHCHR2 EQU   XTNTHDR+76                                               03403000
XTNTENT  EQU   XTNTTBL+88                                               03404000
XTNTCHR1 EQU   XTNTENT+62                                               03405000
XTNTCHR2 EQU   XTNTENT+70                                               03406000
SPLIST   EQU   0                                                        03407000
SPRNAME  EQU   SPLIST+8                                                 03408000
RWFR     EQU   0                                                        03409000
RWFRCNT  EQU   RWFR+16                                                  03410000
LOCTAB   EQU   0                                                        03411000
RIOAREA  EQU   0                                                        03412000
RIOHDR   EQU   RIOAREA                                                  03413000
RPREV    EQU   RIOHDR+2                                                 03414000
RKEY     EQU   0                                                        03415000
RKEYCHR  EQU   RKEY+6                                                   03416000
RKEYFLG  EQU   RKEY+11                                                  03417000
RBUF     EQU   0                                                        03418000
RBUFCNT  EQU   RBUF                                                     03419000
RBCCHHR  EQU   RBUFCNT                                                  03420000
WIOAREA  EQU   0                                                        03421000
WBUF     EQU   0                                                        03422000
WBUFCNT  EQU   WBUF                                                     03423000
WBCCHHR  EQU   WBUFCNT                                                  03424000
RB0      EQU   0                                                        03425000
RB0K     EQU   RB0                                                      03426000
RB0KVCH  EQU   RB0K                                                     03427000
RB0F     EQU   RB0+11                                                   03428000
RB0FMOD  EQU   RB0F                                                     03429000
RB0FERR  EQU   RB0F+1                                                   03430000
RB0FOVF  EQU   RB0F+3                                                   03431000
RB0C     EQU   RB0+16                                                   03432000
RB0CHH   EQU   RB0C+2                                                   03433000
RB0CDL   EQU   RB0C+6                                                   03434000
RB0DK    EQU   RB0+24                                                   03435000
RB1      EQU   0                                                        03436000
RB1K     EQU   RB1                                                      03437000
RB1KVCH  EQU   RB1K                                                     03438000
RB1KR    EQU   RB1K+10                                                  03439000
RB1F     EQU   RB1+11                                                   03440000
RB1FMOD  EQU   RB1F                                                     03441000
RB1FERR  EQU   RB1F+1                                                   03442000
RB1C     EQU   RB1+16                                                   03443000
RB1CCHH  EQU   RB1C                                                     03444000
RB1CR    EQU   RB1C+4                                                   03445000
RB1CKL   EQU   RB1C+5                                                   03446000
RB1CDL   EQU   RB1C+6                                                   03447000
RBIN     EQU   0                                                        03448000
RBI4     EQU   RBIN                                                     03449000
RBIC     EQU   RBIN+4                                                   03450000
RBICHH   EQU   RBIC+2                                                   03451000
RBICR    EQU   RBIC+4                                                   03452000
RBICKL   EQU   RBIC+5                                                   03453000
RBICDL   EQU   RBIC+6                                                   03454000
RBIDK    EQU   RBIN+12                                                  03455000
RWFDANA  EQU   0                                                        03456000
ALLA     EQU   0                                                        03457000
AMSTP011 EQU   0                                                        03458000
AMSTP041 EQU   0                                                        03459000
AMSTP042 EQU   0                                                        03460000
AMSTP043 EQU   0                                                        03461000
AMSTP044 EQU   0                                                        03462000
CDATLPTR EQU   0                                                        03463000
CDSRG    EQU   0                                                        03464000
CHARA    EQU   0                                                        03465000
CKEYLPTR EQU   0                                                        03466000
CLEN     EQU   0                                                        03467000
CLENCNT  EQU   0                                                        03468000
COPY     EQU   0                                                        03469000
CSRNG    EQU   0                                                        03470000
CVTOC    EQU   0                                                        03471000
DATALPTR EQU   0                                                        03472000
DBLOC    EQU   0                                                        03473000
DBRNG    EQU   0                                                        03474000
DISPL    EQU   0                                                        03475000
DKEYLPTR EQU   0                                                        03476000
DLENG    EQU   0                                                        03477000
DLENGCNT EQU   0                                                        03478000
DMPTRM   EQU   0                                                        03479000
DPVTC    EQU   0                                                        03480000
DRRNG    EQU   0                                                        03481000
DSRNG    EQU   0                                                        03482000
DUMP     EQU   0                                                        03483000
ERROR    EQU   0                                                        03484000
FREC     EQU   0                                                        03485000
FULLR    EQU   0                                                        03486000
HEXA     EQU   0                                                        03487000
IDCIOCO0 EQU   0                                                        03488000
IDCIOGT0 EQU   0                                                        03489000
IDCIOIT0 EQU   0                                                        03490000
IDCIOOP0 EQU   0                                                        03491000
IDCIOPO0 EQU   0                                                        03492000
IDCIOPT0 EQU   0                                                        03493000
IDCIOSI0 EQU   0                                                        03494000
IDCIOST0 EQU   0                                                        03495000
IDCIOTM0 EQU   0                                                        03496000
IDCIOVY0 EQU   0                                                        03497000
IDCIO050 EQU   0                                                        03498000
IDCSAAL0 EQU   0                                                        03499000
IDCSACA0 EQU   0                                                        03500000
IDCSACL0 EQU   0                                                        03501000
IDCSACR0 EQU   0                                                        03502000
IDCSADE0 EQU   0                                                        03503000
IDCSADL0 EQU   0                                                        03504000
IDCSADQ0 EQU   0                                                        03505000
IDCSAFS0 EQU   0                                                        03506000
IDCSAGP0 EQU   0                                                        03507000
IDCSAGS0 EQU   0                                                        03508000
IDCSAID0 EQU   0                                                        03509000
IDCSALC0 EQU   0                                                        03510000
IDCSALD0 EQU   0                                                        03511000
IDCSALK0 EQU   0                                                        03512000
IDCSANQ0 EQU   0                                                        03513000
IDCSAPR0 EQU   0                                                        03514000
IDCSAPT0 EQU   0                                                        03515000
IDCSAQL0 EQU   0                                                        03516000
IDCSARC0 EQU   0                                                        03517000
IDCSARV0 EQU   0                                                        03518000
IDCSASC0 EQU   0                                                        03519000
IDCSASI0 EQU   0                                                        03520000
IDCSASN0 EQU   0                                                        03521000
IDCSASS0 EQU   0                                                        03522000
IDCSAST0 EQU   0                                                        03523000
IDCSATI0 EQU   0                                                        03524000
IDCSAUC0 EQU   0                                                        03525000
IDCSAWO0 EQU   0                                                        03526000
IDCSA060 EQU   0                                                        03527000
IDCST010 EQU   0                                                        03528000
IDCTPER0 EQU   0                                                        03529000
IDONL    EQU   0                                                        03530000
LISTTEST EQU   0                                                        03531000
MIDSA    EQU   0                                                        03532000
MIRK     EQU   0                                                        03533000
MIRNG    EQU   0                                                        03534000
MNDAT    EQU   0                                                        03535000
MNKEY    EQU   0                                                        03536000
MODIF    EQU   0                                                        03537000
MODSA    EQU   0                                                        03538000
MORK     EQU   0                                                        03539000
MOVFL    EQU   0                                                        03540000
MVTOC    EQU   0                                                        03541000
NEWERID1 EQU   5                                                        03542000
STAGR    EQU   0                                                        03543000
GDTTBL   EQU   0                                                        03544000
GDTTR1   EQU   GDTTBL+8                                                 03545000
GDTTR2   EQU   GDTTBL+12                                                03546000
GDTDBG   EQU   GDTTBL+40                                                03547000
GDTSTC   EQU   GDTTBL+44                                                03548000
GDTPRT   EQU   GDTTBL+48                                                03549000
GDTESS   EQU   GDTTBL+52                                                03550000
GDTESA   EQU   GDTTBL+56                                                03551000
GDTRST   EQU   GDTTBL+60                                                03552000
GDTRES   EQU   GDTTBL+64                                                03553000
GDTCAL   EQU   GDTTBL+68                                                03554000
GDTGSP   EQU   GDTTBL+72                                                03555000
GDTFSP   EQU   GDTTBL+76                                                03556000
GDTGPL   EQU   GDTTBL+80                                                03557000
GDTFPL   EQU   GDTTBL+84                                                03558000
GDTLOD   EQU   GDTTBL+88                                                03559000
GDTDEL   EQU   GDTTBL+92                                                03560000
GDTPRL   EQU   GDTTBL+96                                                03561000
GDTEPL   EQU   GDTTBL+100                                               03562000
GDTTIM   EQU   GDTTBL+104                                               03563000
GDTIIO   EQU   GDTTBL+108                                               03564000
GDTTIO   EQU   GDTTBL+112                                               03565000
GDTOPN   EQU   GDTTBL+124                                               03566000
GDTCLS   EQU   GDTTBL+128                                               03567000
GDTGET   EQU   GDTTBL+132                                               03568000
GDTPUT   EQU   GDTTBL+136                                               03569000
GDTPOS   EQU   GDTTBL+140                                               03570000
GDTCPY   EQU   GDTTBL+144                                               03571000
GDTCAT   EQU   GDTTBL+148                                               03572000
GDTSNP   EQU   GDTTBL+164                                               03573000
GDTVFY   EQU   GDTTBL+172                                               03574000
GDTUID   EQU   GDTTBL+192                                               03575000
GDTPMT   EQU   GDTTBL+196                                               03576000
GDTCIR   EQU   GDTTBL+200                                               03577000
GDTLNK   EQU   GDTTBL+204                                               03578000
GDTALC   EQU   GDTTBL+208                                               03579000
GDTDLC   EQU   GDTTBL+212                                               03580000
GDTQAL   EQU   GDTTBL+216                                               03581000
GDTSTW   EQU   GDTTBL+220                                               03582000
GDTSSC   EQU   GDTTBL+224                                               03583000
GDTENQ   EQU   GDTTBL+228                                               03584000
GDTRSV   EQU   GDTTBL+232                                               03585000
GDTDEQ   EQU   GDTTBL+236                                               03586000
GDTSFO   EQU   GDTTBL+240                                               03587000
GDTWTO   EQU   GDTTBL+244                                               03588000
GDTSCR   EQU   GDTTBL+248                                               03589000
GDTUNT   EQU   GDTTBL+252                                               03590000
GDTRCT   EQU   GDTTBL+256                                               03591000
GDTIFO   EQU   GDTTBL+260                                               03592000
GDTEXP   EQU   GDTTBL+264                                               03593000
GDTSTA   EQU   GDTTBL+268                                               03594000
GDTERR   EQU   GDTTBL+272                                               03595000
GDTUNC   EQU   GDTTBL+276                                               03596000
GDTLOC   EQU   GDTTBL+280                                               03597000
FDTTBL   EQU   0                                                        03598000
FDTPTR   EQU   FDTTBL+8                                                 03599000
REPTBL   EQU   0                                                        03600000
REPCB    EQU   REPTBL                                                   03601000
REPORWIO EQU   REPCB+20                                                 03602000
REPSPRIT EQU   REPCB+40                                                 03603000
REPBUFF0 EQU   REPCB+52                                                 03604000
REPBUFF1 EQU   REPCB+56                                                 03605000
REPRWHDO EQU   REPCB+64                                                 03606000
REPRWHAR EQU   REPCB+100                                                03607000
REPRWINA EQU   REPCB+104                                                03608000
REPQRPTR EQU   REPCB+132                                                03609000
REPCBEXT EQU   REPTBL+156                                               03610000
REPR0LN  EQU   REPCBEXT                                                 03611000
REPR1LN  EQU   REPCBEXT+2                                               03612000
REPSRPR  EQU   REPCBEXT+4                                               03613000
REPRC    EQU   REPCBEXT+6                                               03614000
REPRCDCT EQU   REPCBEXT+8                                               03615000
CKREQ    EQU   REPCBEXT+16                                              03616000
CKRERN   EQU   CKREQ                                                    03617000
CKRMVAR  EQU   CKREQ+4                                                  03618000
WFAREA   EQU   REPCBEXT+76                                              03619000
WFIODAD  EQU   WFAREA                                                   03620000
WFIODLN  EQU   WFAREA+4                                                 03621000
WFIOKYA  EQU   WFAREA+8                                                 03622000
WFREQ    EQU   WFAREA+12                                                03623000
WFRTYP   EQU   WFREQ                                                    03624000
WFRGET   EQU   WFRTYP                                                   03625000
WFRUPD   EQU   WFRTYP                                                   03626000
WFRPOS   EQU   WFRTYP                                                   03627000
WFROPT   EQU   WFREQ+1                                                  03628000
WFRUP    EQU   WFROPT                                                   03629000
RWDEF    EQU   RWFHDR                                                   03630000
RWFHFT   EQU   RWDEF+89                                                 03631000
RWFHDLN  EQU   RWDEF+90                                                 03632000
RWFRDE   EQU   RWFR                                                     03633000
CCHVAL   EQU   DBCCHVAL                                                 03634000
CHVAL    EQU   CCHVAL+2                                                 03635000
RB00     EQU   RB0                                                      03636000
RB00DK   EQU   RB00+24                                                  03637000
RB00DKRN EQU   RB00DK                                                   03638000
RB00DKKL EQU   RB00DK+1                                                 03639000
RB00DKDL EQU   RB00DK+2                                                 03640000
RB1DEF   EQU   RB1                                                      03641000
RDSPKLDL EQU   RDSPKL                                                   03642000
VOLSER   EQU   DBVOLVAL                                                 03643000
*                                      START UNREFERENCED COMPONENTS    03644000
@NM00077 EQU   RB1DEF+6                                                 03645000
RB1VOLSR EQU   RB1DEF                                                   03646000
@NM00075 EQU   RB00DK+4                                                 03647000
@NM00074 EQU   RB00                                                     03648000
CCVAL    EQU   CCHVAL                                                   03649000
@NM00066 EQU   RWFRDE+15                                                03650000
RWFROV   EQU   RWFRDE+14                                                03651000
RWFRF2   EQU   RWFRDE+12                                                03652000
RWFRF1   EQU   RWFRDE+11                                                03653000
@NM00065 EQU   RWFRDE                                                   03654000
RWFHKLN  EQU   RWDEF+92                                                 03655000
@NM00045 EQU   RWDEF                                                    03656000
REPENQSW EQU   REPCBEXT+90                                              03657000
@NM00044 EQU   WFROPT                                                   03658000
WFRIN    EQU   WFROPT                                                   03659000
@NM00043 EQU   WFRTYP                                                   03660000
WFRLD    EQU   WFRTYP                                                   03661000
WFRADD   EQU   WFRTYP                                                   03662000
@NM00042 EQU   REPCBEXT+75                                              03663000
WFIOGUK  EQU   REPCBEXT+64                                              03664000
RDCATRC  EQU   REPCBEXT+60                                              03665000
@NM00041 EQU   CKREQ+2                                                  03666000
@NM00040 EQU   REPCBEXT+15                                              03667000
K        EQU   REPCBEXT+14                                              03668000
J        EQU   REPCBEXT+13                                              03669000
I        EQU   REPCBEXT+12                                              03670000
@NM00039 EQU   REPSRPR+1                                                03671000
@NM00038 EQU   REPSRPR                                                  03672000
REPSRPRT EQU   REPSRPR                                                  03673000
REPCDSOP EQU   REPCB+152                                                03674000
REPCPPTR EQU   REPCB+148                                                03675000
REPOPAGL EQU   REPCB+144                                                03676000
REPEXOAR EQU   REPCB+140                                                03677000
REPALLAG EQU   REPCB+136                                                03678000
REPODEVA EQU   REPCB+128                                                03679000
REPIDEVA EQU   REPCB+124                                                03680000
REPOLCPT EQU   REPCB+120                                                03681000
REPILCPT EQU   REPCB+116                                                03682000
REPOSYSI EQU   REPCB+112                                                03683000
REPISYSI EQU   REPCB+108                                                03684000
REPOINFO EQU   REPCB+96                                                 03685000
REPIINFO EQU   REPCB+92                                                 03686000
REPOXTNT EQU   REPCB+88                                                 03687000
REPOXTN2 EQU   REPCB+84                                                 03688000
REPIXTNT EQU   REPCB+80                                                 03689000
REPIXTN2 EQU   REPCB+76                                                 03690000
REPOUTCL EQU   REPCB+72                                                 03691000
REPINCL  EQU   REPCB+68                                                 03692000
REPRWHDI EQU   REPCB+60                                                 03693000
REPOBFPT EQU   REPCB+48                                                 03694000
REPIBFPT EQU   REPCB+44                                                 03695000
REPODSAR EQU   REPCB+36                                                 03696000
REPIDSAR EQU   REPCB+32                                                 03697000
REPODSOP EQU   REPCB+28                                                 03698000
REPIDSOP EQU   REPCB+24                                                 03699000
REPIRWIO EQU   REPCB+16                                                 03700000
REPARFIO EQU   REPCB+12                                                 03701000
REPRESER EQU   REPCB                                                    03702000
FDTVERB  EQU   FDTTBL                                                   03703000
GDTECT   EQU   GDTTBL+188                                               03704000
GDTPSB   EQU   GDTTBL+184                                               03705000
GDTUPT   EQU   GDTTBL+180                                               03706000
GDTCMB   EQU   GDTTBL+176                                               03707000
GDTSPR   EQU   GDTTBL+168                                               03708000
@NM00001 EQU   GDTTBL+160                                               03709000
GDTABH   EQU   GDTTBL+156                                               03710000
GDTABT   EQU   GDTTBL+152                                               03711000
GDTTOH   EQU   GDTTBL+120                                               03712000
GDTRIP   EQU   GDTTBL+116                                               03713000
GDTIOH   EQU   GDTTBL+36                                                03714000
GDTSAH   EQU   GDTTBL+32                                                03715000
GDTTPH   EQU   GDTTBL+28                                                03716000
GDTRIH   EQU   GDTTBL+24                                                03717000
GDTSTH   EQU   GDTTBL+20                                                03718000
GDTDBH   EQU   GDTTBL+16                                                03719000
GDTPRM   EQU   GDTTBL+4                                                 03720000
GDTHDR   EQU   GDTTBL                                                   03721000
RBICCC   EQU   RBIC                                                     03722000
RB1DK    EQU   RB1+24                                                   03723000
RB1CHH   EQU   RB1CCHH+2                                                03724000
RB1CCC   EQU   RB1CCHH                                                  03725000
@NM00076 EQU   RB1F+4                                                   03726000
RB1FOVF  EQU   RB1F+3                                                   03727000
RB0CKL   EQU   RB0C+5                                                   03728000
RB0CR    EQU   RB0C+4                                                   03729000
RB0CCC   EQU   RB0C                                                     03730000
@NM00073 EQU   RB0F+4                                                   03731000
RB0KR    EQU   RB0K+10                                                  03732000
WKEYDAT  EQU   WBUF+8                                                   03733000
WBDL     EQU   WBUFCNT+6                                                03734000
WBKL     EQU   WBUFCNT+5                                                03735000
WBREC    EQU   WBCCHHR+4                                                03736000
WBHH     EQU   WBCCHHR+2                                                03737000
WBCC     EQU   WBCCHHR                                                  03738000
WBUFF    EQU   WIOAREA+4                                                03739000
WNUMREC  EQU   WIOAREA                                                  03740000
RKEYDAT  EQU   RBUF+8                                                   03741000
RBDL     EQU   RBUFCNT+6                                                03742000
RBKL     EQU   RBUFCNT+5                                                03743000
RBREC    EQU   RBCCHHR+4                                                03744000
RBHH     EQU   RBCCHHR+2                                                03745000
RBCC     EQU   RBCCHHR                                                  03746000
@NM00072 EQU   RKEYFLG+4                                                03747000
RKEYFLG3 EQU   RKEYFLG+3                                                03748000
RKEYFLG2 EQU   RKEYFLG+1                                                03749000
RKEYFLG1 EQU   RKEYFLG                                                  03750000
RKEYR    EQU   RKEYCHR+4                                                03751000
RKEYHH   EQU   RKEYCHR+2                                                03752000
RKEYCC   EQU   RKEYCHR                                                  03753000
RKEYVOL  EQU   RKEY                                                     03754000
RBUFF    EQU   RIOAREA+282                                              03755000
@NM00071 EQU   RIOHDR+26                                                03756000
@NM00070 EQU   RIOHDR+10                                                03757000
RNUMREC  EQU   RIOHDR+8                                                 03758000
@NM00069 EQU   RIOHDR+7                                                 03759000
RPREVR   EQU   RPREV+4                                                  03760000
RPREVHH  EQU   RPREV+2                                                  03761000
RPREVCC  EQU   RPREV                                                    03762000
@NM00068 EQU   RIOHDR+1                                                 03763000
RFIRST   EQU   RIOHDR                                                   03764000
LOCDLEN  EQU   LOCTAB+18                                                03765000
LOCKLEN  EQU   LOCTAB+17                                                03766000
@NM00067 EQU   LOCTAB+16                                                03767000
LOCCNTFD EQU   LOCTAB+8                                                 03768000
LOCRCKD  EQU   LOCTAB+6                                                 03769000
LOCRCNT  EQU   LOCTAB+4                                                 03770000
LOCADDR  EQU   LOCTAB                                                   03771000
RWFRKD   EQU   RWFR+24                                                  03772000
RWFRDLN  EQU   RWFRCNT+6                                                03773000
RWFRKLN  EQU   RWFRCNT+5                                                03774000
RWFRR    EQU   RWFRCNT+4                                                03775000
RWFRHH   EQU   RWFRCNT+2                                                03776000
RWFRCC   EQU   RWFRCNT                                                  03777000
RWFRFLG  EQU   RWFR+11                                                  03778000
RWFRKEY  EQU   RWFR                                                     03779000
SPRVOL   EQU   SPRNAME+1                                                03780000
SPRLEN   EQU   SPRNAME                                                  03781000
SPQNAME  EQU   SPLIST                                                   03782000
@NM00064 EQU   XTNTENT+75                                               03783000
XTNTR2   EQU   XTNTCHR2+4                                               03784000
XTNTHH2  EQU   XTNTCHR2+2                                               03785000
XTNTCC2  EQU   XTNTCHR2                                                 03786000
@NM00063 EQU   XTNTENT+67                                               03787000
XTNTR1   EQU   XTNTCHR1+4                                               03788000
XTNTHH1  EQU   XTNTCHR1+2                                               03789000
XTNTCC1  EQU   XTNTCHR1                                                 03790000
@NM00062 EQU   XTNTENT+59                                               03791000
XTNTVOL  EQU   XTNTENT+53                                               03792000
XTNTVOLN EQU   XTNTENT+52                                               03793000
XTNTDSN  EQU   XTNTENT+8                                                03794000
XTNTDDN  EQU   XTNTENT                                                  03795000
@NM00061 EQU   XTNTHDR+85                                               03796000
XTNHMODE EQU   XTNTHDR+84                                               03797000
@NM00060 EQU   XTNTHDR+81                                               03798000
XTNHR2   EQU   XTNHCHR2+4                                               03799000
XTNHHH2  EQU   XTNHCHR2+2                                               03800000
XTNHCC2  EQU   XTNHCHR2                                                 03801000
@NM00059 EQU   XTNTHDR+73                                               03802000
XTNHR1   EQU   XTNHCHR1+4                                               03803000
XTNHHH1  EQU   XTNHCHR1+2                                               03804000
XTNHCC1  EQU   XTNHCHR1                                                 03805000
XTNHPWD  EQU   XTNTHDR+60                                               03806000
@NM00058 EQU   XTNTHDR+59                                               03807000
XTNHVOL  EQU   XTNTHDR+53                                               03808000
XTNHVOLN EQU   XTNTHDR+52                                               03809000
XTNHDSN  EQU   XTNTHDR+8                                                03810000
XTNHDDN  EQU   XTNTHDR                                                  03811000
XTN2HH2  EQU   XTN2CHR2+2                                               03812000
XTN2CC2  EQU   XTN2CHR2                                                 03813000
XTN2HH1  EQU   XTN2CHR1+2                                               03814000
XTN2CC1  EQU   XTN2CHR1                                                 03815000
XTN2DSN  EQU   XTN2ENT                                                  03816000
DEVWORD5 EQU   DEVAREA+20                                               03817000
@NM00057 EQU   DEV4B1+1                                                 03818000
@NM00056 EQU   DEV4B1                                                   03819000
INF4FLG  EQU   DEV4B1                                                   03820000
@NM00055 EQU   DEV4B1                                                   03821000
DEVKC    EQU   DEVWORD4                                                 03822000
DEVBOH2  EQU   DEVBOH+1                                                 03823000
DEVBOH1  EQU   DEVBOH                                                   03824000
DEVTC    EQU   DEVWORD3                                                 03825000
DEVMAXHH EQU   @NM00054+2                                               03826000
DEVMAXCC EQU   @NM00054                                                 03827000
DEVMAXBK EQU   DEVAREA+4                                                03828000
DEVTBYT4 EQU   DEVDEVTP+3                                               03829000
DEVTBYT3 EQU   DEVDEVTP+2                                               03830000
@NM00053 EQU   DEVTBYT2                                                 03831000
DEVRVDEV EQU   DEVTBYT2                                                 03832000
@NM00052 EQU   DEVTBYT2                                                 03833000
DEVTBYT1 EQU   DEVDEVTP                                                 03834000
INFVOL   EQU   INFOVOL+4                                                03835000
INFVOLLN EQU   INFOVOL+2                                                03836000
INFVOLID EQU   INFOVOL                                                  03837000
INFDSN   EQU   INFODSN+4                                                03838000
INFDSNLN EQU   INFODSN+2                                                03839000
INFDSNID EQU   INFODSN                                                  03840000
INFAREA  EQU   INFOAREA+4                                               03841000
INFDATAL EQU   INFOAREA+2                                               03842000
INFAREAL EQU   INFOAREA                                                 03843000
RDDLEN   EQU   RDARG+56                                                 03844000
RDKLEN   EQU   RDARG+52                                                 03845000
RDLENTOT EQU   RDARG+50                                                 03846000
RDSPDL   EQU   RDARG+48                                                 03847000
RDFUNC   EQU   RDARG+46                                                 03848000
@NM00051 EQU   RDSPACE+8                                                03849000
@NM00050 EQU   RDSPACE+6                                                03850000
@NM00049 EQU   RDSPACE+4                                                03851000
@NM00048 EQU   RDSPACE+1                                                03852000
@NM00047 EQU   RDSPACE                                                  03853000
RDRWPKLN EQU   RDARG+32                                                 03854000
RDDS     EQU   RDARG+31                                                 03855000
RDRECNUM EQU   RDCHR+4                                                  03856000
RDHH     EQU   RDCHR+2                                                  03857000
RDCC     EQU   RDCHR                                                    03858000
RDCCWCNT EQU   RDARG+24                                                 03859000
RDLOCPTR EQU   RDARG+20                                                 03860000
RDDARE   EQU   RDARG+16                                                 03861000
RDIOAREA EQU   RDARG+12                                                 03862000
RDCTLBK  EQU   RDARG+8                                                  03863000
RDRES    EQU   RDARG                                                    03864000
RWHDRDLN EQU   RWHDRINF+6                                               03865000
RWHDRKLN EQU   RWHDRINF+5                                               03866000
@NM00046 EQU   RWHDRINF+1                                               03867000
RWHDRFIX EQU   RWHDRINF                                                 03868000
RWFKCHR2 EQU   RWFKEY2+6                                                03869000
RWFKVOL2 EQU   RWFKEY2                                                  03870000
RWFKCHR1 EQU   RWFKEY1+6                                                03871000
RWFKVOL1 EQU   RWFKEY1                                                  03872000
RWFVOL   EQU   RWFINFO+52                                               03873000
RWFDSN   EQU   RWFINFO+8                                                03874000
RWFDDN   EQU   RWFINFO                                                  03875000
SRCCHHRP EQU   SRPRTARG+40                                              03876000
SRRECPTR EQU   SRPRTARG+36                                              03877000
SRSPRECL EQU   SRPRTARG+32                                              03878000
SRDSNPTR EQU   SRPRTARG+28                                              03879000
SRERCODE EQU   SRPRTARG+24                                              03880000
SRRWFKEY EQU   SRPRTARG+20                                              03881000
SRRWFDSN EQU   SRPRTARG+16                                              03882000
SRVOLPTR EQU   SRPRTARG+12                                              03883000
SRDSNHDR EQU   SRPRTARG+8                                               03884000
SRVREPTR EQU   SRPRTARG+4                                               03885000
SRVRECL  EQU   SRPRTARG                                                 03886000
RWFHFM   EQU   RWFHDR+99                                                03887000
RWFHDSNU EQU   RWFHDR+55                                                03888000
RWFHDSNR EQU   RWFHDR+11                                                03889000
RWFHKEY  EQU   RWFHDR                                                   03890000
MODCHVAL EQU   MODCH+1                                                  03891000
MODCHLEN EQU   MODCH                                                    03892000
MODVOVAL EQU   MODVO+21                                                 03893000
MODVOLEN EQU   MODVO+20                                                 03894000
MODVOMEM EQU   MODVO+12                                                 03895000
MODVOMLN EQU   MODVO+11                                                 03896000
MODVOFUQ EQU   MODVOFLG                                                 03897000
MODVOPOS EQU   MODVO+9                                                  03898000
MODVOPAS EQU   MODVO+1                                                  03899000
MODVOPLN EQU   MODVO                                                    03900000
MORCHVAL EQU   MORCH+1                                                  03901000
MORCHLEN EQU   MORCH                                                    03902000
MORVOVAL EQU   MORVO+21                                                 03903000
MORVOLEN EQU   MORVO+20                                                 03904000
MORVOMEM EQU   MORVO+12                                                 03905000
MORVOMLN EQU   MORVO+11                                                 03906000
MORVOFUQ EQU   MORVOFLG                                                 03907000
MORVOPOS EQU   MORVO+9                                                  03908000
MORVOPAS EQU   MORVO+1                                                  03909000
MORVOPLN EQU   MORVO                                                    03910000
MNKSTVAL EQU   MNKST+1                                                  03911000
MNKSTLEN EQU   MNKST                                                    03912000
MNKOFVAL EQU   MNKOF                                                    03913000
MNDSTVAL EQU   MNDST+1                                                  03914000
MNDSTLEN EQU   MNDST                                                    03915000
MNDOFVAL EQU   MNDOF                                                    03916000
MRRHHVAL EQU   MRRHH+1                                                  03917000
MRRHHLEN EQU   MRRHH                                                    03918000
MRRCHVAL EQU   MRRCH+1                                                  03919000
MRRCHLEN EQU   MRRCH                                                    03920000
MRRVOVAL EQU   MRRVO+21                                                 03921000
MRRVOLEN EQU   MRRVO+20                                                 03922000
MRRVOMEM EQU   MRRVO+12                                                 03923000
MRRVOMLN EQU   MRRVO+11                                                 03924000
MRRVOFUQ EQU   MRRVOFLG                                                 03925000
MRRVOPOS EQU   MRRVO+9                                                  03926000
MRRVOPAS EQU   MRRVO+1                                                  03927000
MRRVOPLN EQU   MRRVO                                                    03928000
MIDCHVAL EQU   MIDCH+1                                                  03929000
MIDCHLEN EQU   MIDCH                                                    03930000
MIDVOVAL EQU   MIDVO+21                                                 03931000
MIDVOLEN EQU   MIDVO+20                                                 03932000
MIDVOMEM EQU   MIDVO+12                                                 03933000
MIDVOMLN EQU   MIDVO+11                                                 03934000
MIDVOFUQ EQU   MIDVOFLG                                                 03935000
MIDVOPOS EQU   MIDVO+9                                                  03936000
MIDVOPAS EQU   MIDVO+1                                                  03937000
MIDVOPLN EQU   MIDVO                                                    03938000
MIRCHVAL EQU   MIRCH+1                                                  03939000
MIRCHLEN EQU   MIRCH                                                    03940000
MIRVOVAL EQU   MIRVO+21                                                 03941000
MIRVOLEN EQU   MIRVO+20                                                 03942000
MIRVOMEM EQU   MIRVO+12                                                 03943000
MIRVOMLN EQU   MIRVO+11                                                 03944000
MIRVOFUQ EQU   MIRVOFLG                                                 03945000
MIRVOPOS EQU   MIRVO+9                                                  03946000
MIRVOPAS EQU   MIRVO+1                                                  03947000
MIRVOPLN EQU   MIRVO                                                    03948000
MVTCRVAL EQU   MVTCR+1                                                  03949000
MVTCRLEN EQU   MVTCR                                                    03950000
MVTCSVAL EQU   MVTCS+21                                                 03951000
MVTCSLEN EQU   MVTCS+20                                                 03952000
MVTCSMEM EQU   MVTCS+12                                                 03953000
MVTCSMLN EQU   MVTCS+11                                                 03954000
MVTCSFUQ EQU   MVTCSFLG                                                 03955000
MVTCSPOS EQU   MVTCS+9                                                  03956000
MVTCSPAS EQU   MVTCS+1                                                  03957000
MVTCSPLN EQU   MVTCS                                                    03958000
MODSVAL  EQU   MODS+21                                                  03959000
MODSLEN  EQU   MODS+20                                                  03960000
MODSMEM  EQU   MODS+12                                                  03961000
MODSMLN  EQU   MODS+11                                                  03962000
MODSFUQ  EQU   MODSFLG                                                  03963000
MODSPOS  EQU   MODS+9                                                   03964000
MODSPAS  EQU   MODS+1                                                   03965000
MODSPLN  EQU   MODS                                                     03966000
MOUTFVAL EQU   MOUTF+10                                                 03967000
MOUTFLEN EQU   MOUTF+9                                                  03968000
MOUTFPAS EQU   MOUTF+1                                                  03969000
MOUTFPLN EQU   MOUTF                                                    03970000
MINDSVAL EQU   MINDS+21                                                 03971000
MINDSLEN EQU   MINDS+20                                                 03972000
MINDSMEM EQU   MINDS+12                                                 03973000
MINDSMLN EQU   MINDS+11                                                 03974000
MINDSFUQ EQU   MINDSFLG                                                 03975000
MINDSPOS EQU   MINDS+9                                                  03976000
MINDSPAS EQU   MINDS+1                                                  03977000
MINDSPLN EQU   MINDS                                                    03978000
MINFLVAL EQU   MINFL+10                                                 03979000
MINFLLEN EQU   MINFL+9                                                  03980000
MINFLPAS EQU   MINFL+1                                                  03981000
MINFLPLN EQU   MINFL                                                    03982000
MNCNTVAL EQU   MNCNT+1                                                  03983000
MNCNTLEN EQU   MNCNT                                                    03984000
DBHHHLEN EQU   DBHHH                                                    03985000
DBCCHLEN EQU   DBCCH                                                    03986000
DBVOLLEN EQU   DBVOL+20                                                 03987000
DBVOLMEM EQU   DBVOL+12                                                 03988000
DBVOLMLN EQU   DBVOL+11                                                 03989000
DBVOLFUQ EQU   DBVOLFLG                                                 03990000
DBVOLPOS EQU   DBVOL+9                                                  03991000
DBVOLPAS EQU   DBVOL+1                                                  03992000
DBVOLPLN EQU   DBVOL                                                    03993000
DBDSVAL  EQU   DBDS+21                                                  03994000
DBDSLEN  EQU   DBDS+20                                                  03995000
DBDSMEM  EQU   DBDS+12                                                  03996000
DBDSMLN  EQU   DBDS+11                                                  03997000
DBDSFUQ  EQU   DBDSFLG                                                  03998000
DBDSPOS  EQU   DBDS+9                                                   03999000
DBDSPAS  EQU   DBDS+1                                                   04000000
DBDSPLN  EQU   DBDS                                                     04001000
DBFILVAL EQU   DBFIL+10                                                 04002000
DBFILLEN EQU   DBFIL+9                                                  04003000
DBFILPAS EQU   DBFIL+1                                                  04004000
DBFILPLN EQU   DBFIL                                                    04005000
CVTCSVAL EQU   CVTCS+21                                                 04006000
CVTCSLEN EQU   CVTCS+20                                                 04007000
CVTCSMEM EQU   CVTCS+12                                                 04008000
CVTCSMLN EQU   CVTCS+11                                                 04009000
CVTCSFUQ EQU   CVTCSFLG                                                 04010000
CVTCSPOS EQU   CVTCS+9                                                  04011000
CVTCSPAS EQU   CVTCS+1                                                  04012000
CVTCSPLN EQU   CVTCS                                                    04013000
CDATLVAL EQU   CDATL                                                    04014000
CKEYLVAL EQU   CKEYL                                                    04015000
CRECRVAL EQU   CRECR+1                                                  04016000
CRECRLEN EQU   CRECR                                                    04017000
CCCHRVAL EQU   CCCHR+1                                                  04018000
CCCHRLEN EQU   CCCHR                                                    04019000
CVOLSVAL EQU   CVOLS+21                                                 04020000
CVOLSLEN EQU   CVOLS+20                                                 04021000
CVOLSMEM EQU   CVOLS+12                                                 04022000
CVOLSMLN EQU   CVOLS+11                                                 04023000
CVOLSFUQ EQU   CVOLSFLG                                                 04024000
CVOLSPOS EQU   CVOLS+9                                                  04025000
CVOLSPAS EQU   CVOLS+1                                                  04026000
CVOLSPLN EQU   CVOLS                                                    04027000
CDHHRVAL EQU   CDHHR+1                                                  04028000
CDHHRLEN EQU   CDHHR                                                    04029000
CDCHRVAL EQU   CDCHR+1                                                  04030000
CDCHRLEN EQU   CDCHR                                                    04031000
CVOLDVAL EQU   CVOLD+21                                                 04032000
CVOLDLEN EQU   CVOLD+20                                                 04033000
CVOLDMEM EQU   CVOLD+12                                                 04034000
CVOLDMLN EQU   CVOLD+11                                                 04035000
CVOLDFUQ EQU   CVOLDFLG                                                 04036000
CVOLDPOS EQU   CVOLD+9                                                  04037000
CVOLDPAS EQU   CVOLD+1                                                  04038000
CVOLDPLN EQU   CVOLD                                                    04039000
CCATLVAL EQU   CCATL+21                                                 04040000
CCATLLEN EQU   CCATL+20                                                 04041000
CCATLMEM EQU   CCATL+12                                                 04042000
CCATLMLN EQU   CCATL+11                                                 04043000
CCATLFUQ EQU   CCATLFLG                                                 04044000
CCATLPOS EQU   CCATL+9                                                  04045000
CCATLPAS EQU   CCATL+1                                                  04046000
CCATLPLN EQU   CCATL                                                    04047000
COFILVAL EQU   COFIL+10                                                 04048000
COFILLEN EQU   COFIL+9                                                  04049000
COFILPAS EQU   COFIL+1                                                  04050000
COFILPLN EQU   COFIL                                                    04051000
CINDSVAL EQU   CINDS+21                                                 04052000
CINDSLEN EQU   CINDS+20                                                 04053000
CINDSMEM EQU   CINDS+12                                                 04054000
CINDSMLN EQU   CINDS+11                                                 04055000
CINDSFUQ EQU   CINDSFLG                                                 04056000
CINDSPOS EQU   CINDS+9                                                  04057000
CINDSPAS EQU   CINDS+1                                                  04058000
CINDSPLN EQU   CINDS                                                    04059000
CINFLVAL EQU   CINFL+10                                                 04060000
CINFLLEN EQU   CINFL+9                                                  04061000
CINFLPAS EQU   CINFL+1                                                  04062000
CINFLPLN EQU   CINFL                                                    04063000
DVTCSVAL EQU   DVTCS+21                                                 04064000
DVTCSLEN EQU   DVTCS+20                                                 04065000
DVTCSMEM EQU   DVTCS+12                                                 04066000
DVTCSMLN EQU   DVTCS+11                                                 04067000
DVTCSFUQ EQU   DVTCSFLG                                                 04068000
DVTCSPOS EQU   DVTCS+9                                                  04069000
DVTCSPAS EQU   DVTCS+1                                                  04070000
DVTCSPLN EQU   DVTCS                                                    04071000
DATALVAL EQU   DATAL                                                    04072000
DKEYLVAL EQU   DKEYL                                                    04073000
RRCHHVAL EQU   RRCHH+1                                                  04074000
RRCHHLEN EQU   RRCHH                                                    04075000
RRCHRVAL EQU   RRCHR+1                                                  04076000
RRCHRLEN EQU   RRCHR                                                    04077000
VOLRRVAL EQU   VOLRR+21                                                 04078000
VOLRRLEN EQU   VOLRR+20                                                 04079000
VOLRRMEM EQU   VOLRR+12                                                 04080000
VOLRRMLN EQU   VOLRR+11                                                 04081000
VOLRRFUQ EQU   VOLRRFLG                                                 04082000
VOLRRPOS EQU   VOLRR+9                                                  04083000
VOLRRPAS EQU   VOLRR+1                                                  04084000
VOLRRPLN EQU   VOLRR                                                    04085000
DSCHHVAL EQU   DSCHH+1                                                  04086000
DSCHHLEN EQU   DSCHH                                                    04087000
DSCHRVAL EQU   DSCHR+1                                                  04088000
DSCHRLEN EQU   DSCHR                                                    04089000
VOLDSVAL EQU   VOLDS+21                                                 04090000
VOLDSLEN EQU   VOLDS+20                                                 04091000
VOLDSMEM EQU   VOLDS+12                                                 04092000
VOLDSMLN EQU   VOLDS+11                                                 04093000
VOLDSFUQ EQU   VOLDSFLG                                                 04094000
VOLDSPOS EQU   VOLDS+9                                                  04095000
VOLDSPAS EQU   VOLDS+1                                                  04096000
VOLDSPLN EQU   VOLDS                                                    04097000
DRECVAL  EQU   DREC+1                                                   04098000
DRECLEN  EQU   DREC                                                     04099000
DCCHRVAL EQU   DCCHR+1                                                  04100000
DCCHRLEN EQU   DCCHR                                                    04101000
VOLSRVAL EQU   VOLSR+21                                                 04102000
VOLSRLEN EQU   VOLSR+20                                                 04103000
VOLSRMEM EQU   VOLSR+12                                                 04104000
VOLSRMLN EQU   VOLSR+11                                                 04105000
VOLSRFUQ EQU   VOLSRFLG                                                 04106000
VOLSRPOS EQU   VOLSR+9                                                  04107000
VOLSRPAS EQU   VOLSR+1                                                  04108000
VOLSRPLN EQU   VOLSR                                                    04109000
DOTDSVAL EQU   DOTDS+21                                                 04110000
DOTDSLEN EQU   DOTDS+20                                                 04111000
DOTDSMEM EQU   DOTDS+12                                                 04112000
DOTDSMLN EQU   DOTDS+11                                                 04113000
DOTDSFUQ EQU   DOTDSFLG                                                 04114000
DOTDSPOS EQU   DOTDS+9                                                  04115000
DOTDSPAS EQU   DOTDS+1                                                  04116000
DOTDSPLN EQU   DOTDS                                                    04117000
DOUTFVAL EQU   DOUTF+10                                                 04118000
DOUTFLEN EQU   DOUTF+9                                                  04119000
DOUTFPAS EQU   DOUTF+1                                                  04120000
DOUTFPLN EQU   DOUTF                                                    04121000
INDSVAL  EQU   INDS+21                                                  04122000
INDSLEN  EQU   INDS+20                                                  04123000
INDSMEM  EQU   INDS+12                                                  04124000
INDSMLN  EQU   INDS+11                                                  04125000
INDSFUQ  EQU   INDSFLG                                                  04126000
INDSPOS  EQU   INDS+9                                                   04127000
INDSPAS  EQU   INDS+1                                                   04128000
INDSPLN  EQU   INDS                                                     04129000
INFILVAL EQU   INFIL+10                                                 04130000
INFILLEN EQU   INFIL+9                                                  04131000
INFILPAS EQU   INFIL+1                                                  04132000
INFILPLN EQU   INFIL                                                    04133000
@NM00037 EQU   DMPARY+15                                                04134000
DMPARYTP EQU   DMPARY+14                                                04135000
DMPARYEX EQU   DMPARY+12                                                04136000
DMPARYIC EQU   DMPARY+10                                                04137000
DMPARYSZ EQU   DMPARY+8                                                 04138000
DMPARYNM EQU   DMPARY                                                   04139000
@NM00036 EQU   DMPITM+15                                                04140000
DMPITMTP EQU   DMPITM+14                                                04141000
DMPITMLN EQU   DMPITM+12                                                04142000
DMPITMPT EQU   DMPITM+8                                                 04143000
DMPITMNM EQU   DMPITM                                                   04144000
@NM00035 EQU   ERCNVTAB+24                                              04145000
ERCPLPT  EQU   ERCNVTAB+20                                              04146000
ERCATRC  EQU   ERCNVTAB+16                                              04147000
ERDSNM   EQU   ERCNVTAB+12                                              04148000
@NM00034 EQU   ERCNVTAB+4                                               04149000
@NM00033 EQU   ERCNVTAB+3                                               04150000
@NM00032 EQU   EROSOPER                                                 04151000
EROSUCDX EQU   EROSOPER                                                 04152000
EROSCATL EQU   EROSOPER                                                 04153000
@NM00031 EQU   EROPER                                                   04154000
ERCATAL  EQU   EROPER                                                   04155000
ERCATDL  EQU   EROPER                                                   04156000
ERCATDE  EQU   EROPER                                                   04157000
ERCATLC  EQU   EROPER                                                   04158000
@NM00030 EQU   ERTYPE                                                   04159000
EROSCAT  EQU   ERTYPE                                                   04160000
ERCATLG  EQU   ERTYPE                                                   04161000
@NM00029 EQU   FMTCNVF+1                                                04162000
FMTAR    EQU   FMTCNVF+1                                                04163000
FMTBS    EQU   FMTCNVF+1                                                04164000
FMTSS    EQU   FMTCNVF+1                                                04165000
FMTAL    EQU   FMTCNVF+1                                                04166000
FMTZS    EQU   FMTCNVF+1                                                04167000
@NM00028 EQU   FMTCNVF                                                  04168000
FMTPU    EQU   FMTCNVF                                                  04169000
FMTBD    EQU   FMTCNVF                                                  04170000
FMTBHD   EQU   FMTCNVF                                                  04171000
FMTBHA   EQU   FMTCNVF                                                  04172000
FMTBH    EQU   FMTCNVF                                                  04173000
FMTOLEN  EQU   FMTLIST+8                                                04174000
FMTRIO   EQU   FMTOCOL                                                  04175000
FMTSPT   EQU   FMTSTO                                                   04176000
FMTSTL   EQU   FMTILEN                                                  04177000
@NM00027 EQU   FMTFLGS+1                                                04178000
FMTHDF   EQU   FMTFLGS                                                  04179000
FMTDFF   EQU   FMTFLGS                                                  04180000
FMTSTF   EQU   FMTFLGS                                                  04181000
FMTREPF  EQU   FMTFLGS                                                  04182000
FMTBDF   EQU   FMTFLGS                                                  04183000
FMTIDF   EQU   FMTFLGS                                                  04184000
FMTSCF   EQU   FMTFLGS                                                  04185000
FMTEOLF  EQU   FMTFLGS                                                  04186000
DARGDTM  EQU   DARGARY+4                                                04187000
DARGPCT  EQU   DARGINL                                                  04188000
DARGREP  EQU   DARGINS                                                  04189000
@NM00026 EQU   DARGLIST+19                                              04190000
DARGIND  EQU   DARGLIST+18                                              04191000
DARGRETL EQU   DARGLIST+16                                              04192000
DARGCNT  EQU   DARGLIST+14                                              04193000
DARGILP  EQU   DARGLIST+12                                              04194000
DARGSENT EQU   DARGSTID+3                                               04195000
DARGSMOD EQU   DARGSTID                                                 04196000
DARGRETP EQU   DARGLIST+4                                               04197000
DARGDBP  EQU   DARGLIST                                                 04198000
UVOLVOL  EQU   UVOLENT+4                                                04199000
UVOLDEV  EQU   UVOLENT                                                  04200000
UVOLCNT  EQU   UVOLLIST                                                 04201000
@NM00025 EQU   IOINFOPT                                                 04202000
IOINFTMS EQU   IOINFOPT                                                 04203000
IOINFSUP EQU   IOINFOPT                                                 04204000
IOINFDSN EQU   IOINFOPT                                                 04205000
IOINFVOL EQU   IOINFOPT                                                 04206000
IOINFDVT EQU   IOINFOPT                                                 04207000
OPNVOL   EQU   OPNAGL+44                                                04208000
@NM00024 EQU   OPNAGL+43                                                04209000
@NM00023 EQU   OPNOPT2                                                  04210000
OPNOPTJM EQU   OPNOPT2                                                  04211000
@NM00022 EQU   OPNOPT2                                                  04212000
OPNOPTAS EQU   OPNOPT2                                                  04213000
@NM00021 EQU   OPNDSO                                                   04214000
OPNDSOPO EQU   OPNDSO                                                   04215000
OPNDSOIS EQU   OPNDSO                                                   04216000
OPNDSOPS EQU   OPNDSO                                                   04217000
OPNDSOAM EQU   OPNDSO                                                   04218000
OPNKYL   EQU   OPNAGL+40                                                04219000
OPNBLK   EQU   OPNAGL+36                                                04220000
OPNREC   EQU   OPNAGL+32                                                04221000
OPNDEVIX EQU   OPNDEV+4                                                 04222000
OPNDEVDT EQU   OPNDEV                                                   04223000
OPNCBP   EQU   OPNAGL+20                                                04224000
OPNDSN   EQU   OPNAGL+16                                                04225000
OPNPWA   EQU   OPNAGL+12                                                04226000
OPNDDN   EQU   OPNAGL+8                                                 04227000
OPNIOC   EQU   OPNAGL+4                                                 04228000
OPNMODRP EQU   OPNMOD                                                   04229000
OPNMODUB EQU   OPNMOD                                                   04230000
OPNMODRS EQU   OPNMOD                                                   04231000
OPNMODAX EQU   OPNMOD                                                   04232000
OPNMODRR EQU   OPNMOD                                                   04233000
OPNMODRC EQU   OPNMOD                                                   04234000
OPNMODAC EQU   OPNMOD                                                   04235000
OPNMODPD EQU   OPNMOD                                                   04236000
@NM00020 EQU   OPNTYP                                                   04237000
OPNTYPRV EQU   OPNTYP                                                   04238000
OPNTYPEX EQU   OPNTYP                                                   04239000
OPNTYPRA EQU   OPNTYP                                                   04240000
OPNTYPXM EQU   OPNTYP                                                   04241000
OPNTYPCI EQU   OPNTYP                                                   04242000
OPNTYPSO EQU   OPNTYP                                                   04243000
OPNTYPSI EQU   OPNTYP                                                   04244000
@NM00019 EQU   OPNRFM                                                   04245000
OPNRFMBK EQU   OPNRFM                                                   04246000
OPNRFMSF EQU   OPNRFM                                                   04247000
OPNRFMUN EQU   OPNRFM                                                   04248000
OPNRFMVR EQU   OPNRFM                                                   04249000
OPNRFMFX EQU   OPNRFM                                                   04250000
OPNOPTSK EQU   OPNOPT                                                   04251000
OPNOPTDR EQU   OPNOPT                                                   04252000
OPNOPTCR EQU   OPNOPT                                                   04253000
OPNOPTKS EQU   OPNOPT                                                   04254000
OPNOPTBK EQU   OPNOPT                                                   04255000
OPNOPTUP EQU   OPNOPT                                                   04256000
OPNOPTOT EQU   OPNOPT                                                   04257000
OPNOPTIN EQU   OPNOPT                                                   04258000
IOCEXT   EQU   IOCSTR+64                                                04259000
IOCREL   EQU   IOCSTR+60                                                04260000
IOCWORK  EQU   IOCSTR+56                                                04261000
IOCRRN   EQU   IOCSTR+52                                                04262000
IOCPNM   EQU   IOCNWM+2                                                 04263000
IOCPTL   EQU   IOCNWM                                                   04264000
IOCKYA   EQU   IOCMEM                                                   04265000
IOCVRC   EQU   IOCTTR                                                   04266000
IOCCBP   EQU   IOCSTR+36                                                04267000
IOCHURBA EQU   IOCSTR+28                                                04268000
IOCVOLSR EQU   IOCSTR+22                                                04269000
@NM00018 EQU   IOCMSG                                                   04270000
IOCMSGAE EQU   IOCMSG                                                   04271000
IOCMSGCE EQU   IOCMSG                                                   04272000
IOCMSGOE EQU   IOCMSG                                                   04273000
IOCMSGOP EQU   IOCMSG                                                   04274000
@NM00017 EQU   IOCMSG                                                   04275000
IOCCHPSY EQU   IOCCHP                                                   04276000
IOCCHPAS EQU   IOCCHP                                                   04277000
IOCCHPBK EQU   IOCCHP                                                   04278000
IOCCHPCR EQU   IOCCHP                                                   04279000
IOCCHPKS EQU   IOCCHP                                                   04280000
IOCCHPSK EQU   IOCCHP                                                   04281000
IOCCHPDR EQU   IOCCHP                                                   04282000
IOCCHPSQ EQU   IOCCHP                                                   04283000
@NM00016 EQU   IOCMAC2                                                  04284000
IOCMACPA EQU   IOCMAC2                                                  04285000
@NM00015 EQU   IOCMAC2                                                  04286000
IOCMACCP EQU   IOCMAC2                                                  04287000
IOCMACRR EQU   IOCMAC2                                                  04288000
IOCMACAS EQU   IOCMAC2                                                  04289000
IOCMACSK EQU   IOCMAC2                                                  04290000
@NM00014 EQU   IOCMAC                                                   04291000
IOCMACCC EQU   IOCMAC                                                   04292000
IOCMACDR EQU   IOCMAC                                                   04293000
IOCMACBK EQU   IOCMAC                                                   04294000
IOCMACCR EQU   IOCMAC                                                   04295000
IOCMACUP EQU   IOCMAC                                                   04296000
IOCMACOT EQU   IOCMAC                                                   04297000
IOCMACIN EQU   IOCMAC                                                   04298000
@NM00013 EQU   IOCRFM                                                   04299000
IOCRFMBK EQU   IOCRFM                                                   04300000
IOCRFMSF EQU   IOCRFM                                                   04301000
IOCRFMUN EQU   IOCRFM                                                   04302000
IOCRFMVR EQU   IOCRFM                                                   04303000
IOCRFMFX EQU   IOCRFM                                                   04304000
@NM00012 EQU   IOCDSO                                                   04305000
IOCDSOPO EQU   IOCDSO                                                   04306000
IOCDSOIS EQU   IOCDSO                                                   04307000
IOCDSOPS EQU   IOCDSO                                                   04308000
IOCDSOAM EQU   IOCDSO                                                   04309000
IOCRKP   EQU   IOCSTR+13                                                04310000
IOCKYL   EQU   IOCSTR+12                                                04311000
IOCTRN   EQU   IOCSTR+8                                                 04312000
IOCDLN   EQU   IOCSTR+4                                                 04313000
IOCDAD   EQU   IOCSTR                                                   04314000
UNITVTOC EQU   UNITABL+7                                                04315000
@NM00011 EQU   UNITSTAT                                                 04316000
UNITUSHR EQU   UNITSTAT                                                 04317000
UNITXSHR EQU   UNITSTAT                                                 04318000
UNITISHR EQU   UNITSTAT                                                 04319000
UNITUA   EQU   @NM00010+1                                               04320000
UNITCHA  EQU   @NM00010                                                 04321000
UNITUCB  EQU   UNITABL                                                  04322000
ALLUNCNT EQU   ALLAGL+30                                                04323000
ALLVLCNT EQU   ALLAGL+29                                                04324000
@NM00009 EQU   ALLOPT                                                   04325000
ALLOPTUN EQU   ALLOPT                                                   04326000
ALLOPTPV EQU   ALLOPT                                                   04327000
ALLOPTDS EQU   ALLOPT                                                   04328000
ALLOPTVL EQU   ALLOPT                                                   04329000
@NM00008 EQU   ALLORG+1                                                 04330000
ALLORGVS EQU   ALLORG+1                                                 04331000
@NM00007 EQU   ALLORG+1                                                 04332000
ALLORGGS EQU   ALLORG+1                                                 04333000
ALLORGUN EQU   ALLORG                                                   04334000
ALLORGPO EQU   ALLORG                                                   04335000
ALLORGMQ EQU   ALLORG                                                   04336000
ALLORGCQ EQU   ALLORG                                                   04337000
ALLORGCX EQU   ALLORG                                                   04338000
ALLORGDA EQU   ALLORG                                                   04339000
ALLORGPS EQU   ALLORG                                                   04340000
ALLORGIS EQU   ALLORG                                                   04341000
ALLDSPUN EQU   ALLDSP                                                   04342000
ALLDSPCG EQU   ALLDSP                                                   04343000
ALLDSPDE EQU   ALLDSP                                                   04344000
ALLDSPKP EQU   ALLDSP                                                   04345000
@NM00006 EQU   ALLDSP                                                   04346000
ALLSTSOD EQU   ALLSTS                                                   04347000
ALLSTSMD EQU   ALLSTS                                                   04348000
ALLSTSNW EQU   ALLSTS                                                   04349000
ALLSTSSR EQU   ALLSTS                                                   04350000
@NM00005 EQU   ALLSTS                                                   04351000
ALLPWD   EQU   ALLAGL+20                                                04352000
ALLVLP   EQU   ALLAGL+16                                                04353000
ALLULP   EQU   ALLAGL+12                                                04354000
ALLDDN   EQU   ALLAGL+4                                                 04355000
ALLDSN   EQU   ALLAGL                                                   04356000
CIRPID   EQU   CIRAGL+28                                                04357000
CIRPWD   EQU   CIRAGL+24                                                04358000
CIRCAT   EQU   CIRAGL+20                                                04359000
CIRWKP   EQU   CIRAGL+16                                                04360000
CIRTLR   EQU   CIRAGL+12                                                04361000
CIRHDR   EQU   CIRAGL+8                                                 04362000
CIRTLN   EQU   CIRAGL+6                                                 04363000
CIRHLN   EQU   CIRAGL+4                                                 04364000
@NM00004 EQU   CIRAGL+1                                                 04365000
@NM00003 EQU   CIRTYPE                                                  04366000
CIRTYPAQ EQU   CIRTYPE                                                  04367000
CIRTYP1Q EQU   CIRTYPE                                                  04368000
NEWID1   EQU   TRACE1+95                                                04369000
CALLID   EQU   OLDERID1+90                                              04370000
@NM00002 EQU   OLDERID1                                                 04371000
*                                      END UNREFERENCED COMPONENTS      04372000
@RC00694 EQU   @RC00690                                                 04373000
@RC00718 EQU   @RC00716                                                 04374000
@PB00002 EQU   @EL00001                                                 04375000
@RC00723 EQU   @RC00718                                                 04376000
@ENDDATA EQU   *                                                        04377000
         END   IDCRD04,(C'PLS1208',0603,77300)                          04378000
