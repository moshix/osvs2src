         TITLE 'IDCRD05: MODIFY REPAIRV FUNCTION                       *00001000
                        '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCRD05  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCRD05   76.328'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @09,0                                               0002 00021000
@PSTART  LA    @10,4095(,@09)                                      0002 00022000
         LA    @11,4095(,@10)                                      0002 00023000
         LA    @12,4095(,@11)                                      0002 00024000
         USING @PSTART,@09                                         0002 00025000
         USING @PSTART+4095,@10                                    0002 00026000
         USING @PSTART+8190,@11                                    0002 00027000
         USING @PSTART+12285,@12                                   0002 00028000
         L     @00,@SIZDATD                                        0002 00029000
         GETMAIN  R,LV=(0)                                              00030000
         LR    @06,@01                                             0002 00031000
         USING @DATD,@06                                           0002 00032000
         ST    @13,@SA00001+4                                      0002 00033000
         LM    @00,@01,20(@13)                                     0002 00034000
         ST    @06,8(,@13)                                         0002 00035000
         LR    @13,@06                                             0002 00036000
         MVC   @PC00001(12),0(@01)                                 0002 00037000
*                                                                  0447 00038000
*        /************************************************************/ 00039000
*        /* SET TRACE AND DUMP POINT                                 */ 00040000
*        /************************************************************/ 00041000
*        IF GDTDBG = NULLPTR                                       0448 00042000
*          THEN;                                                   0448 00043000
         L     @15,@PC00001                                        0448 00044000
         L     @15,GDTDBG(,@15)                                    0448 00045000
         LTR   @15,@15                                             0448 00046000
         BZ    @RT00448                                            0448 00047000
*          ELSE                                                    0450 00048000
*            CALL IDCDB010 (GDTTBL,'RD50');                        0450 00049000
         L     @15,@PC00001                                        0450 00050000
         ST    @15,@AL00001                                        0450 00051000
         LA    @15,@CC02060                                        0450 00052000
         ST    @15,@AL00001+4                                      0450 00053000
         MVI   @AL00001+4,X'80'                                    0450 00054000
         L     @14,@PC00001                                        0450 00055000
         L     @15,GDTDBG(,@14)                                    0450 00056000
         LA    @01,@AL00001                                        0450 00057000
         BALR  @14,@15                                             0450 00058000
*        OLDERID2 = NEWERID2;                                      0451 00059000
@RT00448 L     @15,@PC00001                                        0451 00060000
         L     @01,GDTTR2(,@15)                                    0451 00061000
         L     @15,@PC00001                                        0451 00062000
         L     @15,GDTTR2(,@15)                                    0451 00063000
         MVC   @TS00001(95),NEWERID2(@15)                          0451 00064000
         MVC   OLDERID2(95,@01),@TS00001                           0451 00065000
*        NEWID2 = 'RD51';                                          0452 00066000
*                                                                  0452 00067000
         L     @15,@PC00001                                        0452 00068000
         L     @01,GDTTR2(,@15)                                    0452 00069000
         MVC   NEWID2(4,@01),@CC02061                              0452 00070000
*        /************************************************************/ 00071000
*        /* CALL MODIFY ROUTINE                                      */ 00072000
*        /************************************************************/ 00073000
*        CALL IDCRD050;                                            0453 00074000
*                                                                  0453 00075000
         BAL   @14,IDCRD050                                        0453 00076000
*        /************************************************************/ 00077000
*        /* SAVE RETURN CODE FROM MODIFY ROUTINE                     */ 00078000
*        /************************************************************/ 00079000
*        RESPECIFY RTNREG RSTD;                                    0454 00080000
*        TESTRC = RTNREG;                                          0455 00081000
         STH   RTNREG,TESTRC                                       0455 00082000
*        RESPECIFY RTNREG UNRSTD;                                  0456 00083000
*                                                                  0456 00084000
*        /************************************************************/ 00085000
*        /* SET MODIFY RETURN CODE IN LASTCC                         */ 00086000
*        /************************************************************/ 00087000
*        LASTCC = TESTRC;                                          0457 00088000
*                                                                  0457 00089000
         LH    @15,TESTRC                                          0457 00090000
         STH   @15,LASTCC                                          0457 00091000
*        /************************************************************/ 00092000
*        /* ISSUE RECORDS PROCESSED MESSAGE                          */ 00093000
*        /************************************************************/ 00094000
*        IF ADDR(MIRNG) ^= NULLPTR                                 0458 00095000
*          THEN                                                    0458 00096000
*                                                                  0458 00097000
         L     @15,@PC00001+4                                      0458 00098000
         L     @15,FDTPTR+388(,@15)                                0458 00099000
         LTR   @15,@15                                             0458 00100000
         BZ    @RF00458                                            0458 00101000
*            /********************************************************/ 00102000
*            /*                                                      */ 00103000
*            /* PRINT THE NUMBER OF RECORDS MODIFIED FROM            */ 00104000
*            /* INREPAIRRANGE                                        */ 00105000
*            /*                                                      */ 00106000
*            /********************************************************/ 00107000
*                                                                  0459 00108000
*             DO;                                                  0459 00109000
*               CKREQ = CKREQ && CKREQ;                            0460 00110000
         L     @15,@PC00001+8                                      0460 00111000
         XC    CKREQ(44,@15),CKREQ(@15)                            0460 00112000
*               CKRERN = MSG92;                                    0461 00113000
         L     @15,@PC00001+8                                      0461 00114000
         MVC   CKRERN(2,@15),@CH00865                              0461 00115000
*               CKRMVAR(1) = ADDR(REPRCDCT);                       0462 00116000
         L     @15,@PC00001+8                                      0462 00117000
         L     @14,@PC00001+8                                      0462 00118000
         LA    @14,REPRCDCT(,@14)                                  0462 00119000
         ST    @14,CKRMVAR(,@15)                                   0462 00120000
*               CALL IDCRDER;                                      0463 00121000
         L     @15,@CV01811                                        0463 00122000
         BALR  @14,@15                                             0463 00123000
*             END;                                                 0464 00124000
*                                                                  0464 00125000
*          ELSE                                                    0465 00126000
*                                                                  0465 00127000
*            /********************************************************/ 00128000
*            /*                                                      */ 00129000
*            /* IF LASTCC = 0, THEN ONE RECORD WAS PROCESSED,        */ 00130000
*            /* OTHERWISE NO RECORDS WERE PROCESSED                  */ 00131000
*            /*                                                      */ 00132000
*            /********************************************************/ 00133000
*            DO;                                                   0465 00134000
         B     @RC00458                                            0465 00135000
@RF00458 DS    0H                                                  0466 00136000
*            IF LASTCC = 0                                         0466 00137000
*              THEN                                                0466 00138000
         LH    @15,LASTCC                                          0466 00139000
         LTR   @15,@15                                             0466 00140000
         BNZ   @RF00466                                            0466 00141000
*                REPRCDCT = 1;                                     0467 00142000
         L     @15,@PC00001+8                                      0467 00143000
         MVC   REPRCDCT(4,@15),@CF00221                            0467 00144000
*              ELSE                                                0468 00145000
*                REPRCDCT = 0;                                     0468 00146000
*                                                                  0468 00147000
         B     @RC00466                                            0468 00148000
@RF00466 L     @15,@PC00001+8                                      0468 00149000
         SLR   @14,@14                                             0468 00150000
         ST    @14,REPRCDCT(,@15)                                  0468 00151000
*             DO;                                                  0469 00152000
@RC00466 DS    0H                                                  0470 00153000
*               CKREQ = CKREQ && CKREQ;                            0470 00154000
         L     @15,@PC00001+8                                      0470 00155000
         XC    CKREQ(44,@15),CKREQ(@15)                            0470 00156000
*               CKRERN = MSG92;                                    0471 00157000
         L     @15,@PC00001+8                                      0471 00158000
         MVC   CKRERN(2,@15),@CH00865                              0471 00159000
*               CKRMVAR(1) = ADDR(REPRCDCT);                       0472 00160000
         L     @15,@PC00001+8                                      0472 00161000
         L     @14,@PC00001+8                                      0472 00162000
         LA    @14,REPRCDCT(,@14)                                  0472 00163000
         ST    @14,CKRMVAR(,@15)                                   0472 00164000
*               CALL IDCRDER;                                      0473 00165000
         L     @15,@CV01811                                        0473 00166000
         BALR  @14,@15                                             0473 00167000
*             END;                                                 0474 00168000
*            END;                                                  0475 00169000
*                                                                  0475 00170000
*        /************************************************************/ 00171000
*        /* ISSUE UEPIL TO FREE STORAGE AND RETURN TO IDCRD01        */ 00172000
*        /************************************************************/ 00173000
*         CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                      0476 00174000
@RC00458 L     @15,@PC00001                                        0476 00175000
         ST    @15,@AL00001                                        0476 00176000
         LA    @15,MODID                                           0476 00177000
         ST    @15,@AL00001+4                                      0476 00178000
         LA    @15,LASTCC                                          0476 00179000
         ST    @15,@AL00001+8                                      0476 00180000
         MVI   @AL00001+8,X'80'                                    0476 00181000
         L     @14,@PC00001                                        0476 00182000
         L     @15,GDTEPL(,@14)                                    0476 00183000
         LA    @01,@AL00001                                        0476 00184000
         BALR  @14,@15                                             0476 00185000
*IDCRD050:                                                         0477 00186000
*        /************************************************************/ 00187000
*        /*                                                          */ 00188000
*        /* SUBROUTINE NAME - IDCRD050                               */ 00189000
*        /*                                                          */ 00190000
*        /* FUNCTION -                                               */ 00191000
*        /*                                                          */ 00192000
*        /* THIS IS THE MAIN PROCEDURE FOR THE MODIFY FUNCTION.      */ 00193000
*        /* IF THE INREPAIRRANGE PARAMETER WAS SPECIFIED, THE        */ 00194000
*        /* PROCEDURE MODRNG WILL BE CALLED TO PROCESS THE REQUEST.  */ 00195000
*        /* IF THE INREPAIRRANGE IS NOT PRESENT, THEN WE MAY HAVE    */ 00196000
*        /* AN INPUT RECORD FROM EITHER A DATASET OR A REPAIR        */ 00197000
*        /* WORKFILE, OR WE MAY HAVE SOME INPUT STRING IN THE        */ 00198000
*        /* COMMAND OR THE USER MAY BE TRYING TO REWRITE THE OUTPUT  */ 00199000
*        /* RECORD AS AN OVERFLOW RECORD.                            */ 00200000
*        /* IF AN INPUT RECORD IS PRESENT, IT IS SET IN AREA RB3     */ 00201000
*        /* POINTED BY BFPTRIN                                       */ 00202000
*        /* IF INPUT RECORD IS NOT PRESENT, BFPTRIN IS SET TO NULL   */ 00203000
*        /* AND STRINGSW IS SET TO ZERO(NOT).                        */ 00204000
*        /* A CHECK IS MADE FOR THE KIND OF OUTPUT.                  */ 00205000
*        /* IF THE OUTPUT IS A REPAIR WORKFILE, THE OUTPUT RECORD IS */ 00206000
*        /* SET IN AREA RB1 POINTED BY BFPTROUT AND THE PROCEDURE    */ 00207000
*        /* MODROUT IS CALLED TO PROCESS THE MODIFY REQUEST.         */ 00208000
*        /* IF THE OUTPUT IS A DATA SET OR A VTOCHEADER, THE OUTPUT  */ 00209000
*        /* RECORD IS SET IN AREA RB1 POINTED BY BFPTROUT AND THE    */ 00210000
*        /* PROCEDURE MODDSOUT IS CALL TO PROCESS THE MODIFY REQUEST.*/ 00211000
*        /* AFTER THE PROCEDURES RETURN TO IDCRD050, PROCEDURE       */ 00212000
*        /* MODCLFP IS CALLED TO CLOSE FILES, DEQUEUE AND FREE POOLS */ 00213000
*        /*                                                          */ 00214000
*        /* NOTES -                                                  */ 00215000
*        /*                                                          */ 00216000
*        /*    DEPENDENCIES - NONE                                   */ 00217000
*        /*                                                          */ 00218000
*        /*    RESTRICTIONS - GENERAL PURPOSE REGISTERS 7 AND 8      */ 00219000
*        /*                   MAY NOT BE USED BY THIS MODULE OR      */ 00220000
*        /*                   ANY OTHER REPAIRV MODULE AS THEY ARE   */ 00221000
*        /*                   DATA REGISTERS FOR MODULES IDCRD07     */ 00222000
*        /*                   AND IDCRD06 RESPECTIVELY               */ 00223000
*        /*                                                          */ 00224000
*        /*    REGISTER CONVENTIONS - SEE GLOBAL DATA AREA (AMSDF00) */ 00225000
*        /*                                                          */ 00226000
*        /*    PATCH LABEL - 'UPATCHIT'                              */ 00227000
*        /*                                                          */ 00228000
*        /* ENTRY POINT - IDCRD050 (ONLY ENTRY POINT)                */ 00229000
*        /*                                                          */ 00230000
*        /*    PURPOSE - MAIN ROUTINE OF THE REPAIRV FSR             */ 00231000
*        /*    MODIFY  FUNCTION                                      */ 00232000
*        /*                                                          */ 00233000
*        /*    LINKAGE - 'CALL IDCRD050'                             */ 00234000
*        /*                                                          */ 00235000
*        /*    INPUT -                                               */ 00236000
*        /*                                                          */ 00237000
*        /*      THE INPUT DATA CAN BE AS FOLLOWS.                   */ 00238000
*        /*       A) DATA STRING SPECFIED IN THE COMMAND             */ 00239000
*        /*       B) A RECORD IN A DATA SET                          */ 00240000
*        /*       C) A RECORD IN A REPAIR WORKFILE                   */ 00241000
*        /*       D) A RANGE OF DEBLOCKED RECORDS IN A REPAIR        */ 00242000
*        /*            WORKFILE                                      */ 00243000
*        /*                                                          */ 00244000
*        /*    OUTPUT -                                              */ 00245000
*        /*                                                          */ 00246000
*        /*      THE OUTPUT CAN BE AS FOLLOWS                        */ 00247000
*        /*       A) A MODIFIED RECORD ON A DATA SET                 */ 00248000
*        /*       B) A MODIFIED RECORD IN A VTOCHEADER               */ 00249000
*        /*       C) A MODIFIED RECORD IN A REPAIR WORKFILE          */ 00250000
*        /*       D) A RANGE OF MODIFIED RECORDS EITHER IN A DATA    */ 00251000
*        /*            SET OR VTOCHEADER                             */ 00252000
*        /*                                                          */ 00253000
*        /*      ERROR MESSAGES: IDC31221I                           */ 00254000
*        /*                      IDC31222I                           */ 00255000
*        /*                      IDC31223I                           */ 00256000
*        /*                      IDC31224I                           */ 00257000
*        /*                                                          */ 00258000
*        /*                                                          */ 00259000
*        /*    EXIT, NORMAL -                                        */ 00260000
*        /*                                                          */ 00261000
*        /*      LASTCC = 00        FUNCTION COMPLETED SUCCESSFULLY  */ 00262000
*        /*                                                          */ 00263000
*        /*    EXIT, ERROR -                                         */ 00264000
*        /*                                                          */ 00265000
*        /*      LASTCC = 12        FUNCTION COULD NOT COMPLETE      */ 00266000
*        /*                                                          */ 00267000
*        /* INTERNAL REFERENCES -                                    */ 00268000
*        /*    PROCEDURES/SUBROUTINES CALLED                         */ 00269000
*        /*                                                          */ 00270000
*        /*    MODROUT  - MODIFY A REPAIR WORKFILE RECORD SUBROUTINE */ 00271000
*        /*                                                          */ 00272000
*        /*    MODDSOUT - MODIFY A DATA SET OR VTOCHEADER RECORD     */ 00273000
*        /*      SUBROUTINE                                          */ 00274000
*        /*                                                          */ 00275000
*        /*    MODRNG   - MODIFY A RANGE OF RECORDS IN A DATA SET    */ 00276000
*        /*      OR VTOCHEADER FROM A RANGE OF DEBLOCKED RECORDS     */ 00277000
*        /*      IN A REPAIR WORKFILE SUBROUTINE                     */ 00278000
*        /*                                                          */ 00279000
*        /*    MODCLFP  - CLOSE FILES, FREE POOLS SUBROUTINE AND     */ 00280000
*        /*      DEQUEUE SUBROUTINE                                  */ 00281000
*        /*                                                          */ 00282000
*        /* EXTERNAL REFERENCES -                                    */ 00283000
*        /*    MACROS/SVCS -                                         */ 00284000
*        /*                                                          */ 00285000
*        /*    UCLOSE - IDCAMS I/O ADAPTER CLOSE ROUTINE             */ 00286000
*        /*      CLOSES THE REPAIR WORKFILE, AND THE ALTERNATE       */ 00287000
*        /*      REPORT FILE IF SPECIFIED                            */ 00288000
*        /*      GENERATES A CALL TO MODULE IDCIOCL                  */ 00289000
*        /*                                                          */ 00290000
*        /*    UEXCP  - IDCAMS I/O ADAPTER EXCP ROUTINE              */ 00291000
*        /*      TO CLOSE AND WRITE DATA SET OR VTOCHEADER           */ 00292000
*        /*      GENERATES A CALL TO MODULE IDCIO05                  */ 00293000
*        /*                                                          */ 00294000
*        /*    ?GETRCD - REPAIRV GET RECORD ROUTINE                  */ 00295000
*        /*      READS RECORDS FROM THE REPAIR WORKFILE              */ 00296000
*        /*      GENERATES A CALL TO MODULE IDCRDIO                  */ 00297000
*        /*                                                          */ 00298000
*        /*    ?POSRCD - REPAIRV RECORD POSITIONING ROUTINE          */ 00299000
*        /*      POSITIONS TO FIRST RECORD IN REPAIRRANGE            */ 00300000
*        /*      GENERATES A CALL TO MODULE IDCRDIO                  */ 00301000
*        /*                                                          */ 00302000
*        /*    ?CALLCKER - REPAIRV WRITE MESSAGE ROUTINE             */ 00303000
*        /*      WRITES ALL MESSAGES                                 */ 00304000
*        /*      GENERATES A CALL TO MODULE IDCRDER                  */ 00305000
*        /*                                                          */ 00306000
*        /*    ?MOVELONG - REPAIRV MVCL MACRO                        */ 00307000
*        /*      EXECUTES MVCL INSTRUCTION WITH GPR'S 2,3,4 & 5      */ 00308000
*        /*                                                          */ 00309000
*        /* PROCEDURES/SUBROUTINES CALLED                            */ 00310000
*        /*                                                          */ 00311000
*        /*    IDCRDDS - TO OPEN THE INPUT DATA SET OR               */ 00312000
*        /*      VTOCHEADER AND OBTAIN BUFFER SPACE                  */ 00313000
*        /*                                                          */ 00314000
*        /*    IDCRDRF - TO OPEN THE REPAIR WORKFILE AND OBTAIN      */ 00315000
*        /*      BUFFER AREAS                                        */ 00316000
*        /*                                                          */ 00317000
*        /*    IDCRDRD - TO READ A RECORD IN A DATA SET OR           */ 00318000
*        /*      VTOCHEADER                                          */ 00319000
*        /************************************************************/ 00320000
*                                                                  0477 00321000
*        PROCEDURE;                                                0477 00322000
@EL00001 L     @13,4(,@13)                                         0477 00323000
@EF00001 L     @00,@SIZDATD                                        0477 00324000
         LR    @01,@06                                             0477 00325000
         FREEMAIN R,LV=(0),A=(1)                                        00326000
@ER00001 LM    @14,@12,12(@13)                                     0477 00327000
         BR    @14                                                 0477 00328000
IDCRD050 STM   @14,@12,@SA00002                                    0477 00329000
*        /************************************************************/ 00330000
*        /*                                                          */ 00331000
*        /* INITIALIZE POINTERS TO ZERO AND INDICATORS               */ 00332000
*        /*                                                          */ 00333000
*        /************************************************************/ 00334000
*        SAVCLOUT = NULLPTR;                                       0478 00335000
         SLR   @15,@15                                             0478 00336000
         ST    @15,SAVCLOUT                                        0478 00337000
*        SAVCLIN  = NULLPTR;                                       0479 00338000
         SLR   @15,@15                                             0479 00339000
         ST    @15,SAVCLIN                                         0479 00340000
*        STRINGSW = NOT;                                           0480 00341000
         MVI   STRINGSW,X'00'                                      0480 00342000
*        OVFLSW = NOT;                                             0481 00343000
         MVI   OVFLSW,X'00'                                        0481 00344000
*        DATSPA = NOT;                                             0482 00345000
*                                                                  0482 00346000
         MVI   DATSPA,X'00'                                        0482 00347000
*        /************************************************************/ 00348000
*        /*                                                          */ 00349000
*        /*  PUT THE OUTPUT VOLSER AND CCHHR IN COMMON AREA          */ 00350000
*        /*                                                          */ 00351000
*        /************************************************************/ 00352000
*        IF ADDR(MVTOC) ^= NULLPTR                                 0483 00353000
*          THEN                                                    0483 00354000
         L     @15,@PC00001+4                                      0483 00355000
         L     @15,FDTPTR+424(,@15)                                0483 00356000
         LTR   @15,@15                                             0483 00357000
         BZ    @RF00483                                            0483 00358000
*            DO;                                                   0484 00359000
*            MOKAD6 = MVTCSVAL;                                    0485 00360000
         L     @15,@PC00001+4                                      0485 00361000
         L     @01,FDTPTR+428(,@15)                                0485 00362000
         MVC   MOKAD6(6),MVTCSVAL(@01)                             0485 00363000
*            MOKAD5 = MVTCRVAL;                                    0486 00364000
         L     @15,@PC00001+4                                      0486 00365000
         L     @01,FDTPTR+432(,@15)                                0486 00366000
         MVC   MOKAD5(5),MVTCRVAL(@01)                             0486 00367000
*            PARNA  = VTOCHDRK;                                    0487 00368000
         MVC   PARNA(17),VTOCHDRK                                  0487 00369000
*            END;                                                  0488 00370000
*           ELSE                                                   0489 00371000
*             DO;                                                  0489 00372000
         B     @RC00483                                            0489 00373000
@RF00483 DS    0H                                                  0490 00374000
*             IF ADDR(MODSA) ^= NULLPTR                            0490 00375000
*               THEN                                               0490 00376000
         L     @15,@PC00001+4                                      0490 00377000
         L     @15,FDTPTR+408(,@15)                                0490 00378000
         LTR   @15,@15                                             0490 00379000
         BZ    @RF00490                                            0490 00380000
*                 DO;                                              0491 00381000
*                 MOKAD6 = MODVOVAL;                               0492 00382000
         L     @15,@PC00001+4                                      0492 00383000
         L     @01,FDTPTR+488(,@15)                                0492 00384000
         MVC   MOKAD6(6),MODVOVAL(@01)                             0492 00385000
*                 MOKAD5 = MODCHVAL;                               0493 00386000
         L     @15,@PC00001+4                                      0493 00387000
         L     @01,FDTPTR+492(,@15)                                0493 00388000
         MVC   MOKAD5(5),MODCHVAL(@01)                             0493 00389000
*                 PARNA  = OUTDSAK;                                0494 00390000
         MVC   PARNA(17),OUTDSAK                                   0494 00391000
*                 END;                                             0495 00392000
*               ELSE;                                              0496 00393000
@RF00490 DS    0H                                                  0497 00394000
*             END;                                                 0497 00395000
*                                                                  0497 00396000
*        /************************************************************/ 00397000
*        /*                                                          */ 00398000
*        /* IF INREPAIRRANGE PRESENT  CALL MODRNG                    */ 00399000
*        /*                                                          */ 00400000
*        /************************************************************/ 00401000
*        IF ADDR(MIRNG) ^= NULLPTR                                 0498 00402000
*          THEN                                                    0498 00403000
@RC00483 L     @15,@PC00001+4                                      0498 00404000
         L     @15,FDTPTR+388(,@15)                                0498 00405000
         LTR   @15,@15                                             0498 00406000
         BZ    @RF00498                                            0498 00407000
*            DO;                                                   0499 00408000
*            CALL MODRNG;                                          0500 00409000
         BAL   @14,MODRNG                                          0500 00410000
*            RESPECIFY RTNREG RSTD;                                0501 00411000
*            TESTRC = RTNREG;                                      0502 00412000
         STH   RTNREG,TESTRC                                       0502 00413000
*            RESPECIFY RTNREG UNRSTD;                              0503 00414000
*            CALL MODCLFP;                                         0504 00415000
         BAL   @14,MODCLFP                                         0504 00416000
*            RETURN CODE(TESTRC);                                  0505 00417000
         LH    @15,TESTRC                                          0505 00418000
         L     @14,@SA00002                                        0505 00419000
         LM    @00,@12,@SA00002+8                                  0505 00420000
         BR    @14                                                 0505 00421000
*            END;                                                  0506 00422000
*          ELSE;                                                   0507 00423000
*                                                                  0507 00424000
@RF00498 DS    0H                                                  0508 00425000
*        /************************************************************/ 00426000
*        /*                                                          */ 00427000
*        /* IF INREPAIRKEY PRESENT CALL IDCRDRF TO OPEN THE REPAIR   */ 00428000
*        /*  WORKFILE AND OBTAIN BUFFERS                             */ 00429000
*        /*                                                          */ 00430000
*        /************************************************************/ 00431000
*        IF ADDR(MIRK) ^= NULLPTR                                  0508 00432000
*          THEN                                                    0508 00433000
         L     @15,@PC00001+4                                      0508 00434000
         L     @15,FDTPTR+380(,@15)                                0508 00435000
         LTR   @15,@15                                             0508 00436000
         BZ    @RF00508                                            0508 00437000
*            DO;                                                   0509 00438000
*            CALL IDCRDRF (IN);                                    0510 00439000
         L     @15,@CV01813                                        0510 00440000
         LA    @01,@AL00510                                        0510 00441000
         BALR  @14,@15                                             0510 00442000
*            RESPECIFY RTNREG RSTD;                                0511 00443000
*            TESTRC = RTNREG;                                      0512 00444000
         STH   RTNREG,TESTRC                                       0512 00445000
*            RESPECIFY RTNREG UNRSTD;                              0513 00446000
*                                                                  0513 00447000
*            /********************************************************/ 00448000
*            /* CHECK THE RETURN CODE FROM IDCRDRF AND IF NOT ZERO   */ 00449000
*            /*  RETURN WITH RC =12                                  */ 00450000
*            /********************************************************/ 00451000
*            IF TESTRC ^= 0                                        0514 00452000
*              THEN                                                0514 00453000
         LH    @15,TESTRC                                          0514 00454000
         LTR   @15,@15                                             0514 00455000
         BZ    @RF00514                                            0514 00456000
*                RETURN CODE(LASTCC12);                            0515 00457000
         LA    @15,12                                              0515 00458000
         L     @14,@SA00002                                        0515 00459000
         LM    @00,@12,@SA00002+8                                  0515 00460000
         BR    @14                                                 0515 00461000
*              ELSE;                                               0516 00462000
*                                                                  0516 00463000
@RF00514 DS    0H                                                  0517 00464000
*            /********************************************************/ 00465000
*            /*                                                      */ 00466000
*            /* SET PTR FOR DSNAME  AND DATSPA INDICATOR             */ 00467000
*            /*                                                      */ 00468000
*            /********************************************************/ 00469000
*            RWFPTR1 = REPIRWIO -> IOCDSN;                         0517 00470000
         L     @15,@PC00001+8                                      0517 00471000
         L     @01,REPIRWIO(,@15)                                  0517 00472000
         L     @15,IOCDSN(,@01)                                    0517 00473000
         ST    @15,RWFPTR1                                         0517 00474000
*            DATSPA = YESS;                                        0518 00475000
*                                                                  0518 00476000
         MVI   DATSPA,X'01'                                        0518 00477000
*            /********************************************************/ 00478000
*            /*                                                      */ 00479000
*            /* SET KEY FOR POSITIONING  AND POSITION RECORD         */ 00480000
*            /* FOR INPUT REPAIR WORKFILE RECORD                     */ 00481000
*            /********************************************************/ 00482000
*            KEYRWFVS = MIRVOVAL;                                  0519 00483000
         L     @15,@PC00001+4                                      0519 00484000
         L     @01,FDTPTR+436(,@15)                                0519 00485000
         MVC   KEYRWFVS(6),MIRVOVAL(@01)                           0519 00486000
*            KEYRWCHR = MIRCHVAL;                                  0520 00487000
         L     @15,@PC00001+4                                      0520 00488000
         L     @01,FDTPTR+440(,@15)                                0520 00489000
         MVC   KEYRWCHR(5),MIRCHVAL(@01)                           0520 00490000
*            WFIOKYA = ADDR(KEYRWF);                               0521 00491000
*                                                                  0521 00492000
         L     @15,@PC00001+8                                      0521 00493000
         LA    @14,KEYRWF                                          0521 00494000
         ST    @14,WFIOKYA(,@15)                                   0521 00495000
*            /********************************************************/ 00496000
*            /* ISSUE POSITION                                       */ 00497000
*            /********************************************************/ 00498000
*                                                                  0522 00499000
*             DO;                                                  0522 00500000
*               WFREQ = ''B;                                       0523 00501000
         L     @15,@PC00001+8                                      0523 00502000
         XC    WFREQ(2,@15),WFREQ(@15)                             0523 00503000
*               WFRPOS = ON;      /*  POSRCD */                    0524 00504000
         L     @15,@PC00001+8                                      0524 00505000
         OI    WFRPOS(@15),B'00001000'                             0524 00506000
*               WFRIN  = ON;      /* INPUT DS */                   0525 00507000
         L     @15,@PC00001+8                                      0525 00508000
         OI    WFRIN(@15),B'10000000'                              0525 00509000
*               CALL IDCRDIO;                                      0526 00510000
         L     @15,@CV01814                                        0526 00511000
         BALR  @14,@15                                             0526 00512000
*               RFY RTNREG RSTD;                                   0527 00513000
*               TESTRC = RTNREG;                                   0528 00514000
         STH   RTNREG,TESTRC                                       0528 00515000
*               RFY RTNREG UNRSTD;                                 0529 00516000
*             END;                                                 0530 00517000
*                                                                  0530 00518000
*            /********************************************************/ 00519000
*            /*  CHECK RETURN CODE FROM POSITIONING                  */ 00520000
*            /********************************************************/ 00521000
*            IF TESTRC ^= 0                                        0531 00522000
*              THEN                                                0531 00523000
*                                                                  0531 00524000
         LH    @15,TESTRC                                          0531 00525000
         LTR   @15,@15                                             0531 00526000
         BZ    @RF00531                                            0531 00527000
*                /****************************************************/ 00528000
*                /* POSITIONING FAILED. IF RECORD NOT FOUND, ISSUE   */ 00529000
*                /*  MESSAGE IDC31222I                               */ 00530000
*                /* CALL MODCLFP TO CLOSE FILE AND FREE POOLS        */ 00531000
*                /****************************************************/ 00532000
*                DO;                                               0532 00533000
*                IF TESTRC = NOTFOUND                              0533 00534000
*                  THEN                                            0533 00535000
*                                                                  0533 00536000
         CLC   TESTRC(2),@CH00181                                  0533 00537000
         BNE   @RF00533                                            0533 00538000
*                     DO;                                          0534 00539000
*                       CKREQ = CKREQ && CKREQ;                    0535 00540000
         L     @15,@PC00001+8                                      0535 00541000
         XC    CKREQ(44,@15),CKREQ(@15)                            0535 00542000
*                       CKRERN = MSG22;                            0536 00543000
         L     @15,@PC00001+8                                      0536 00544000
         MVC   CKRERN(2,@15),@CH00663                              0536 00545000
*                       CKRMVAR(1) = ADDR(KEYRWFVS);               0537 00546000
         L     @15,@PC00001+8                                      0537 00547000
         LA    @14,KEYRWFVS                                        0537 00548000
         ST    @14,CKRMVAR(,@15)                                   0537 00549000
*                       CKRMVAR(2) = ADDR(KEYRWCHR);               0538 00550000
         L     @15,@PC00001+8                                      0538 00551000
         LA    @14,KEYRWCHR                                        0538 00552000
         ST    @14,CKRMVAR+4(,@15)                                 0538 00553000
*                       CKRMVAR(3) = ADDR(RWFDANA);                0539 00554000
         L     @15,@PC00001+8                                      0539 00555000
         L     @14,RWFPTR1                                         0539 00556000
         ST    @14,CKRMVAR+8(,@15)                                 0539 00557000
*                       CALL IDCRDER;                              0540 00558000
         L     @15,@CV01811                                        0540 00559000
         BALR  @14,@15                                             0540 00560000
*                     END;                                         0541 00561000
*                  ELSE;                                           0542 00562000
@RF00533 DS    0H                                                  0543 00563000
*                CALL MODCLFP;                                     0543 00564000
         BAL   @14,MODCLFP                                         0543 00565000
*                RETURN CODE (LASTCC12);                           0544 00566000
         LA    @15,12                                              0544 00567000
         L     @14,@SA00002                                        0544 00568000
         LM    @00,@12,@SA00002+8                                  0544 00569000
         BR    @14                                                 0544 00570000
*                END;                                              0545 00571000
*               ELSE;                                              0546 00572000
*                                                                  0546 00573000
@RF00531 DS    0H                                                  0547 00574000
*            /********************************************************/ 00575000
*            /*  POSITIONING OK.   GET THE RECORD                    */ 00576000
*            /********************************************************/ 00577000
*                                                                  0547 00578000
*             DO;                                                  0547 00579000
*               WFREQ = ''B;                                       0548 00580000
         L     @15,@PC00001+8                                      0548 00581000
         XC    WFREQ(2,@15),WFREQ(@15)                             0548 00582000
*               WFRGET = ON;      /*  GETRCD */                    0549 00583000
         L     @15,@PC00001+8                                      0549 00584000
         OI    WFRGET(@15),B'00100000'                             0549 00585000
*               WFRIN  = ON;      /* INPUT DS */                   0550 00586000
         L     @15,@PC00001+8                                      0550 00587000
         OI    WFRIN(@15),B'10000000'                              0550 00588000
*               CALL IDCRDIO;                                      0551 00589000
         L     @15,@CV01814                                        0551 00590000
         BALR  @14,@15                                             0551 00591000
*               RFY RTNREG RSTD;                                   0552 00592000
*               TESTRC = RTNREG;                                   0553 00593000
         STH   RTNREG,TESTRC                                       0553 00594000
*               RFY RTNREG UNRSTD;                                 0554 00595000
*             END;                                                 0555 00596000
*                                                                  0555 00597000
*            /********************************************************/ 00598000
*            /* CHECK IF RECORD FOUND                                */ 00599000
*            /********************************************************/ 00600000
*            IF TESTRC ^= 0                                        0556 00601000
*              THEN                                                0556 00602000
*                                                                  0556 00603000
         LH    @15,TESTRC                                          0556 00604000
         LTR   @15,@15                                             0556 00605000
         BZ    @RF00556                                            0556 00606000
*                /****************************************************/ 00607000
*                /* RECORD COULD NOT BE READ. IF THE RECORD WAS NOT  */ 00608000
*                /*  FOUND, MESSAGE IDC31222I IS ISSUED              */ 00609000
*                /* CALL MODCLFP TO CLOSE FILE AND FREE POOLS        */ 00610000
*                /****************************************************/ 00611000
*                DO;                                               0557 00612000
*                IF TESTRC = EOF                                   0558 00613000
*                  THEN                                            0558 00614000
*                                                                  0558 00615000
         CLC   TESTRC(2),@CH00475                                  0558 00616000
         BNE   @RF00558                                            0558 00617000
*                     DO;                                          0559 00618000
*                       CKREQ = CKREQ && CKREQ;                    0560 00619000
         L     @15,@PC00001+8                                      0560 00620000
         XC    CKREQ(44,@15),CKREQ(@15)                            0560 00621000
*                       CKRERN = MSG22;                            0561 00622000
         L     @15,@PC00001+8                                      0561 00623000
         MVC   CKRERN(2,@15),@CH00663                              0561 00624000
*                       CKRMVAR(1) = ADDR(KEYRWFVS);               0562 00625000
         L     @15,@PC00001+8                                      0562 00626000
         LA    @14,KEYRWFVS                                        0562 00627000
         ST    @14,CKRMVAR(,@15)                                   0562 00628000
*                       CKRMVAR(2) = ADDR(KEYRWCHR);               0563 00629000
         L     @15,@PC00001+8                                      0563 00630000
         LA    @14,KEYRWCHR                                        0563 00631000
         ST    @14,CKRMVAR+4(,@15)                                 0563 00632000
*                       CKRMVAR(3) = ADDR(RWFDANA);                0564 00633000
         L     @15,@PC00001+8                                      0564 00634000
         L     @14,RWFPTR1                                         0564 00635000
         ST    @14,CKRMVAR+8(,@15)                                 0564 00636000
*                       CALL IDCRDER;                              0565 00637000
         L     @15,@CV01811                                        0565 00638000
         BALR  @14,@15                                             0565 00639000
*                     END;                                         0566 00640000
*                  ELSE;                                           0567 00641000
@RF00558 DS    0H                                                  0568 00642000
*                CALL MODCLFP;                                     0568 00643000
         BAL   @14,MODCLFP                                         0568 00644000
*                RETURN CODE (LASTCC12);                           0569 00645000
         LA    @15,12                                              0569 00646000
         L     @14,@SA00002                                        0569 00647000
         LM    @00,@12,@SA00002+8                                  0569 00648000
         BR    @14                                                 0569 00649000
*                END;                                              0570 00650000
*              ELSE;                                               0571 00651000
*                                                                  0571 00652000
@RF00556 DS    0H                                                  0572 00653000
*            /********************************************************/ 00654000
*            /*                                                      */ 00655000
*            /* SET INPUT IN AREA POINTED BY REPBUFF0                */ 00656000
*            /*                                                      */ 00657000
*            /********************************************************/ 00658000
*            REPR0LN = WFIODLN;                                    0572 00659000
         L     @15,@PC00001+8                                      0572 00660000
         L     @14,@PC00001+8                                      0572 00661000
         L     @14,WFIODLN(,@14)                                   0572 00662000
         STH   @14,REPR0LN(,@15)                                   0572 00663000
*            BFPTRIN = REPBUFF0;                                   0573 00664000
         L     @15,@PC00001+8                                      0573 00665000
         L     @15,REPBUFF0(,@15)                                  0573 00666000
         ST    @15,BFPTRIN                                         0573 00667000
*            RFY RWF1 BASED (WFIODAD);                             0574 00668000
*            RFY RB3 BASED (REPBUFF0);                             0575 00669000
*            MOVLEN = WFIODLN - KEYFLGLN;                          0576 00670000
*                                                                  0576 00671000
         L     @15,@PC00001+8                                      0576 00672000
         L     @15,WFIODLN(,@15)                                   0576 00673000
         SL    @15,@CF00475                                        0576 00674000
         STH   @15,MOVLEN                                          0576 00675000
*             RFY (REG2,REG3,REG4,REG5) RSTD;                      0577 00676000
*             REG2 = ADDR(RB3C);                                   0578 00677000
         L     @15,@PC00001+8                                      0578 00678000
         L     REG2,REPBUFF0(,@15)                                 0578 00679000
         LA    REG2,RB3C(,REG2)                                    0578 00680000
*             REG3 = MOVLEN;                                       0579 00681000
         LH    REG3,MOVLEN                                         0579 00682000
         N     REG3,@CF02153                                       0579 00683000
*             REG4 = ADDR(RWF1C);                                  0580 00684000
         L     @15,@PC00001+8                                      0580 00685000
         L     REG4,WFIODAD(,@15)                                  0580 00686000
         LA    REG4,RWF1C(,REG4)                                   0580 00687000
*             REG5 = MOVLEN;                                       0581 00688000
         LH    REG5,MOVLEN                                         0581 00689000
         N     REG5,@CF02153                                       0581 00690000
*             MVCL (REG2,REG4);                                    0582 00691000
         MVCL  REG2,REG4                                           0582 00692000
*             RFY(REG2,REG3,REG4,REG5) UNRSTD;                     0583 00693000
*                                                                  0583 00694000
*            /********************************************************/ 00695000
*            /*                                                      */ 00696000
*            /* RB3 CONTAINS THE INPUT RECORD                        */ 00697000
*            /* THE INPUT REPAIR WORKFILE IS CLOSED, SAVCLIN IS      */ 00698000
*            /* SET TO ZEROS                                         */ 00699000
*            /*                                                      */ 00700000
*            /********************************************************/ 00701000
*            CALL IDCIOCL0(GDTTBL,REPIRWIO);                       0584 00702000
         L     @15,@PC00001                                        0584 00703000
         ST    @15,@AL00001                                        0584 00704000
         L     @15,@PC00001+8                                      0584 00705000
         LA    @15,REPIRWIO(,@15)                                  0584 00706000
         ST    @15,@AL00001+4                                      0584 00707000
         MVI   @AL00001+4,X'80'                                    0584 00708000
         L     @14,@PC00001                                        0584 00709000
         L     @15,GDTCLS(,@14)                                    0584 00710000
         LA    @01,@AL00001                                        0584 00711000
         BALR  @14,@15                                             0584 00712000
*            REPIRWIO = NULLPTR;                                   0585 00713000
         L     @15,@PC00001+8                                      0585 00714000
         SLR   @14,@14                                             0585 00715000
         ST    @14,REPIRWIO(,@15)                                  0585 00716000
*            END;                                                  0586 00717000
*          ELSE                                                    0587 00718000
*                                                                  0587 00719000
*            /********************************************************/ 00720000
*            /*                                                      */ 00721000
*            /* IF INDATASETADDRESS IS PRESENT CALL IDCRDDS TO OPEN  */ 00722000
*            /*  THE DATA SET OR VTOCHEADER AND OBTAIN BUFFERS       */ 00723000
*            /*                                                      */ 00724000
*            /********************************************************/ 00725000
*            DO;                                                   0587 00726000
         B     @RC00508                                            0587 00727000
@RF00508 DS    0H                                                  0588 00728000
*            IF ADDR(MIDSA) ^= NULLPTR                             0588 00729000
*              THEN                                                0588 00730000
         L     @15,@PC00001+4                                      0588 00731000
         L     @15,FDTPTR+384(,@15)                                0588 00732000
         LTR   @15,@15                                             0588 00733000
         BZ    @RF00588                                            0588 00734000
*                DO;                                               0589 00735000
*                CALL IDCRDDS(IN,ZEROS);                           0590 00736000
         L     @15,@CV01810                                        0590 00737000
         LA    @01,@AL00590                                        0590 00738000
         BALR  @14,@15                                             0590 00739000
*                RESPECIFY RTNREG RSTD;                            0591 00740000
*                TESTRC = RTNREG;                                  0592 00741000
         STH   RTNREG,TESTRC                                       0592 00742000
*                RESPECIFY RTNREG UNRSTD;                          0593 00743000
*                                                                  0593 00744000
*                /****************************************************/ 00745000
*                /* CHECK THE RETURN CODE FROM IDCRDDS AND IF NOT    */ 00746000
*                /*  ZERO RETURN WITH RC = 12                        */ 00747000
*                /****************************************************/ 00748000
*                IF TESTRC ^= 0                                    0594 00749000
*                  THEN                                            0594 00750000
         LH    @15,TESTRC                                          0594 00751000
         LTR   @15,@15                                             0594 00752000
         BZ    @RF00594                                            0594 00753000
*                    RETURN CODE(LASTCC12);                        0595 00754000
         LA    @15,12                                              0595 00755000
         L     @14,@SA00002                                        0595 00756000
         LM    @00,@12,@SA00002+8                                  0595 00757000
         BR    @14                                                 0595 00758000
*                  ELSE;                                           0596 00759000
*                                                                  0596 00760000
@RF00594 DS    0H                                                  0597 00761000
*                /****************************************************/ 00762000
*                /*                                                  */ 00763000
*                /* SAVE REPIDSOP FOR CLOSE AND SET DATSPA INDICATOR */ 00764000
*                /*                                                  */ 00765000
*                /****************************************************/ 00766000
*                SAVCLIN = REPIDSOP;                               0597 00767000
         L     @15,@PC00001+8                                      0597 00768000
         L     @15,REPIDSOP(,@15)                                  0597 00769000
         ST    @15,SAVCLIN                                         0597 00770000
*                DATSPA = YESS;                                    0598 00771000
*                                                                  0598 00772000
         MVI   DATSPA,X'01'                                        0598 00773000
*                /****************************************************/ 00774000
*                /*                                                  */ 00775000
*                /* BUILD ARG LIST                                   */ 00776000
*                /*                                                  */ 00777000
*                /****************************************************/ 00778000
*                RFY RDARG BASED (REPIDSAR);                       0599 00779000
*                RDLOCPTR=REPILCPT;                                0600 00780000
         L     @15,@PC00001+8                                      0600 00781000
         L     @01,REPIDSAR(,@15)                                  0600 00782000
         L     @15,@PC00001+8                                      0600 00783000
         L     @00,REPILCPT(,@15)                                  0600 00784000
         ST    @00,RDLOCPTR(,@01)                                  0600 00785000
*                RDCTLBK = REPIDSOP;                               0601 00786000
         L     @15,@PC00001+8                                      0601 00787000
         L     @01,REPIDSAR(,@15)                                  0601 00788000
         L     @15,@PC00001+8                                      0601 00789000
         L     @00,REPIDSOP(,@15)                                  0601 00790000
         ST    @00,RDCTLBK(,@01)                                   0601 00791000
*                RDCHRC=MIDCHVAL;                                  0602 00792000
         L     @15,@PC00001+8                                      0602 00793000
         L     @01,REPIDSAR(,@15)                                  0602 00794000
         L     @15,@PC00001+4                                      0602 00795000
         L     @15,FDTPTR+448(,@15)                                0602 00796000
         MVC   RDCHRC(5,@01),MIDCHVAL(@15)                         0602 00797000
*                RDIOAREA = REPIBFPT;                              0603 00798000
         L     @15,@PC00001+8                                      0603 00799000
         L     @01,REPIDSAR(,@15)                                  0603 00800000
         L     @15,@PC00001+8                                      0603 00801000
         L     @00,REPIBFPT(,@15)                                  0603 00802000
         ST    @00,RDIOAREA(,@01)                                  0603 00803000
*                RDDS=ZERO;                                        0604 00804000
*                                                                  0604 00805000
         L     @15,@PC00001+8                                      0604 00806000
         L     @01,REPIDSAR(,@15)                                  0604 00807000
         MVI   RDDS(@01),X'00'                                     0604 00808000
*                /****************************************************/ 00809000
*                /* READ RECORD                                      */ 00810000
*                /****************************************************/ 00811000
*                CALL IDCRDRD(RDARG);                              0605 00812000
         L     @15,@PC00001+8                                      0605 00813000
         L     @01,REPIDSAR(,@15)                                  0605 00814000
         ST    @01,@AL00001                                        0605 00815000
         L     @15,@CV01812                                        0605 00816000
         LA    @01,@AL00001                                        0605 00817000
         BALR  @14,@15                                             0605 00818000
*                RFY XTNTTBL BASED(REPIXTNT);                      0606 00819000
*                RESPECIFY RTNREG RSTD;                            0607 00820000
*                TESTRC = RTNREG;                                  0608 00821000
         STH   RTNREG,TESTRC                                       0608 00822000
*                RESPECIFY RTNREG UNRSTD;                          0609 00823000
*                                                                  0609 00824000
*                /****************************************************/ 00825000
*                /*                                                  */ 00826000
*                /* CHECK THE RETURN CODE FROM IDCRDRD               */ 00827000
*                /* IF THE RC > 21, THEN THE RECORD COULD NOT BE READ*/ 00828000
*                /* CALL MODCLFP TO CLOSE FILE AND FREE POOLS        */ 00829000
*                /****************************************************/ 00830000
*                IF TESTRC > 21                                    0610 00831000
*                  THEN                                            0610 00832000
*                                                                  0610 00833000
         LH    @15,TESTRC                                          0610 00834000
         C     @15,@CF00652                                        0610 00835000
         BNH   @RF00610                                            0610 00836000
*                    /************************************************/ 00837000
*                    /* RECORD COULD NOT BE READ                     */ 00838000
*                    /* CALL MODCLFP TO CLSE FILE AND FREE POOLS     */ 00839000
*                    /************************************************/ 00840000
*                    DO;                                           0611 00841000
*                                                                  0611 00842000
*                    /************************************************/ 00843000
*                    /* CHECK IF RECORD NOT FOUND OR END OF TRACK    */ 00844000
*                    /************************************************/ 00845000
*                    IF TESTRC = NTFNDRD | TESTRC = ENDTRK         0612 00846000
*                      THEN                                        0612 00847000
         CLC   TESTRC(2),@CH01990                                  0612 00848000
         BE    @RT00612                                            0612 00849000
         CLC   TESTRC(2),@CH00698                                  0612 00850000
         BNE   @RF00612                                            0612 00851000
@RT00612 DS    0H                                                  0613 00852000
*                        DO;                                       0613 00853000
*                                                                  0613 00854000
*                        /********************************************/ 00855000
*                        /* RECORD NOT FOUND OR END OF TRACK  ISSUE  */ 00856000
*                        /*  MESSAGE IDC31221I                       */ 00857000
*                        /********************************************/ 00858000
*                        IF XTNHDSN = VTOCDSN                      0614 00859000
*                          THEN                                    0614 00860000
         L     @15,@PC00001+8                                      0614 00861000
         L     @01,REPIXTNT(,@15)                                  0614 00862000
         CLC   XTNHDSN(44,@01),VTOCDSN                             0614 00863000
         BNE   @RF00614                                            0614 00864000
*                            DSNMSG = FMT4DSN;                     0615 00865000
         MVC   DSNMSG(44),FMT4DSN                                  0615 00866000
*                          ELSE                                    0616 00867000
*                            DSNMSG = XTNHDSN;                     0616 00868000
*                                                                  0616 00869000
         B     @RC00614                                            0616 00870000
@RF00614 L     @15,@PC00001+8                                      0616 00871000
         L     @01,REPIXTNT(,@15)                                  0616 00872000
         MVC   DSNMSG(44),XTNHDSN(@01)                             0616 00873000
*                         DO;                                      0617 00874000
@RC00614 DS    0H                                                  0618 00875000
*                           CKREQ = CKREQ && CKREQ;                0618 00876000
         L     @15,@PC00001+8                                      0618 00877000
         XC    CKREQ(44,@15),CKREQ(@15)                            0618 00878000
*                           CKRERN = MSG21;                        0619 00879000
         L     @15,@PC00001+8                                      0619 00880000
         MVC   CKRERN(2,@15),@CH00652                              0619 00881000
*                           CKRMVAR(1) = ADDR(MIDVOVAL);           0620 00882000
         L     @15,@PC00001+8                                      0620 00883000
         L     @14,@PC00001+4                                      0620 00884000
         L     @01,FDTPTR+444(,@14)                                0620 00885000
         LA    @14,MIDVOVAL(,@01)                                  0620 00886000
         ST    @14,CKRMVAR(,@15)                                   0620 00887000
*                           CKRMVAR(2) = ADDR(RDCHR);              0621 00888000
         L     @15,@PC00001+8                                      0621 00889000
         L     @14,@PC00001+8                                      0621 00890000
         L     @01,REPIDSAR(,@14)                                  0621 00891000
         LA    @14,RDCHR(,@01)                                     0621 00892000
         ST    @14,CKRMVAR+4(,@15)                                 0621 00893000
*                           CKRMVAR(3) = ADDR(DSNMSG);             0622 00894000
         L     @15,@PC00001+8                                      0622 00895000
         LA    @14,DSNMSG                                          0622 00896000
         ST    @14,CKRMVAR+8(,@15)                                 0622 00897000
*                           CALL IDCRDER;                          0623 00898000
         L     @15,@CV01811                                        0623 00899000
         BALR  @14,@15                                             0623 00900000
*                         END;                                     0624 00901000
*                        END;                                      0625 00902000
*                      ELSE;                                       0626 00903000
@RF00612 DS    0H                                                  0627 00904000
*                    CALL MODCLFP;                                 0627 00905000
         BAL   @14,MODCLFP                                         0627 00906000
*                    RETURN CODE(LASTCC12);                        0628 00907000
         LA    @15,12                                              0628 00908000
         L     @14,@SA00002                                        0628 00909000
         LM    @00,@12,@SA00002+8                                  0628 00910000
         BR    @14                                                 0628 00911000
*                    END;                                          0629 00912000
*                                                                  0629 00913000
*                  ELSE;                                           0630 00914000
*                                                                  0630 00915000
@RF00610 DS    0H                                                  0631 00916000
*                /****************************************************/ 00917000
*                /*                                                  */ 00918000
*                /* SET BFPTRIN                                      */ 00919000
*                /*                                                  */ 00920000
*                /****************************************************/ 00921000
*                BFPTRIN = RDDARE - LENGTH(RB3NUM);                0631 00922000
         L     @15,@PC00001+8                                      0631 00923000
         L     @01,REPIDSAR(,@15)                                  0631 00924000
         L     @15,RDDARE(,@01)                                    0631 00925000
         SL    @15,@CF00044                                        0631 00926000
         ST    @15,BFPTRIN                                         0631 00927000
*                RFY RB3 BASED (BFPTRIN);                          0632 00928000
*                /****************************************************/ 00929000
*                /*                                                  */ 00930000
*                /* CLOSE INPUT DATA SET, CLEAR SAVCLIN              */ 00931000
*                /****************************************************/ 00932000
*                CALL IDCIO050(GDTTBL,CLOSE,SAVCLIN);              0633 00933000
         L     @15,@PC00001                                        0633 00934000
         ST    @15,@AL00001                                        0633 00935000
         LA    @15,CLOSE                                           0633 00936000
         ST    @15,@AL00001+4                                      0633 00937000
         LA    @15,SAVCLIN                                         0633 00938000
         ST    @15,@AL00001+8                                      0633 00939000
         MVI   @AL00001+8,X'80'                                    0633 00940000
         L     @14,@PC00001                                        0633 00941000
         L     @15,GDTEXP(,@14)                                    0633 00942000
         LA    @01,@AL00001                                        0633 00943000
         BALR  @14,@15                                             0633 00944000
*                SAVCLIN = NULLPTR;                                0634 00945000
*                                                                  0634 00946000
         SLR   @15,@15                                             0634 00947000
         ST    @15,SAVCLIN                                         0634 00948000
*                /****************************************************/ 00949000
*                /*                                                  */ 00950000
*                /* RB3 HAS THE INPUT RECORD                         */ 00951000
*                /*                                                  */ 00952000
*                /****************************************************/ 00953000
*                END;                                              0635 00954000
*                                                                  0635 00955000
*              /******************************************************/ 00956000
*              /*                                                    */ 00957000
*              /*   THE INPUT IS NOT A RECORD                        */ 00958000
*              /*   SET BFPTRIN NULL  AND STRINGSW ON                */ 00959000
*              /*                                                    */ 00960000
*              /******************************************************/ 00961000
*              ELSE                                                0636 00962000
*                DO;                                               0636 00963000
         B     @RC00588                                            0636 00964000
@RF00588 DS    0H                                                  0637 00965000
*                STRINGSW =YESS;                                   0637 00966000
         MVI   STRINGSW,X'01'                                      0637 00967000
*                BFPTRIN = NULLPTR;                                0638 00968000
         SLR   @15,@15                                             0638 00969000
         ST    @15,BFPTRIN                                         0638 00970000
*                END;                                              0639 00971000
*            END;                                                  0640 00972000
*                                                                  0640 00973000
@RC00588 DS    0H                                                  0641 00974000
*        /************************************************************/ 00975000
*        /*                                                          */ 00976000
*        /* NOW WE ARE GOING TO GET THE OUTPUT RECORD                */ 00977000
*        /* CHECK IF OUTREPAIRKEY PRESENT                            */ 00978000
*        /*                                                          */ 00979000
*        /************************************************************/ 00980000
*        IF ADDR(MORK) ^= NULLPTR                                  0641 00981000
*          THEN                                                    0641 00982000
@RC00508 L     @15,@PC00001+4                                      0641 00983000
         L     @15,FDTPTR+404(,@15)                                0641 00984000
         LTR   @15,@15                                             0641 00985000
         BZ    @RF00641                                            0641 00986000
*            DO;                                                   0642 00987000
*            CALL IDCRDRF(OUT);                                    0643 00988000
         L     @15,@CV01813                                        0643 00989000
         LA    @01,@AL00643                                        0643 00990000
         BALR  @14,@15                                             0643 00991000
*            RESPECIFY RTNREG RSTD;                                0644 00992000
*            TESTRC = RTNREG;                                      0645 00993000
         STH   RTNREG,TESTRC                                       0645 00994000
*            RESPECIFY RTNREG UNRSTD;                              0646 00995000
*                                                                  0646 00996000
*            /********************************************************/ 00997000
*            /*                                                      */ 00998000
*            /* CHECK THE RETURN CODE FROM IDCRDRF.                  */ 00999000
*            /*                                                      */ 01000000
*            /********************************************************/ 01001000
*            IF TESTRC ^= 0                                        0647 01002000
*              THEN                                                0647 01003000
*                                                                  0647 01004000
         LH    @15,TESTRC                                          0647 01005000
         LTR   @15,@15                                             0647 01006000
         BZ    @RF00647                                            0647 01007000
*                /****************************************************/ 01008000
*                /*  THE RC FROM RC ^= 0.  CALL MODCLFP TO CLOSE     */ 01009000
*                /*   FILES AND FREE POOLS                           */ 01010000
*                /*  RETURN WITH A RC = 12                           */ 01011000
*                /****************************************************/ 01012000
*                DO;                                               0648 01013000
*                /****************************************************/ 01014000
*                /* IDCRDRF ALREADY CLOSED THE RWF. IF AN ERROR      */ 01015000
*                /* OCCURRED ZERO OUT THE POINTER AND CALL CLEANUP   */ 01016000
*                /****************************************************/ 01017000
*                REPORWIO = NULLPTR;                               0649 01018000
         L     @15,@PC00001+8                                      0649 01019000
         SLR   @14,@14                                             0649 01020000
         ST    @14,REPORWIO(,@15)                                  0649 01021000
*                CALL MODCLFP;                                     0650 01022000
         BAL   @14,MODCLFP                                         0650 01023000
*                RETURN CODE(LASTCC12);                            0651 01024000
         LA    @15,12                                              0651 01025000
         L     @14,@SA00002                                        0651 01026000
         LM    @00,@12,@SA00002+8                                  0651 01027000
         BR    @14                                                 0651 01028000
*                END;                                              0652 01029000
*              ELSE;                                               0653 01030000
*                                                                  0653 01031000
@RF00647 DS    0H                                                  0654 01032000
*            /********************************************************/ 01033000
*            /*                                                      */ 01034000
*            /* SET DSNAME AND DATSPA INDICATOR                      */ 01035000
*            /*                                                      */ 01036000
*            /********************************************************/ 01037000
*            RWFPTR1 = REPORWIO -> IOCDSN;                         0654 01038000
         L     @15,@PC00001+8                                      0654 01039000
         L     @01,REPORWIO(,@15)                                  0654 01040000
         L     @15,IOCDSN(,@01)                                    0654 01041000
         ST    @15,RWFPTR1                                         0654 01042000
*            DATSPA = YESS;                                        0655 01043000
*                                                                  0655 01044000
         MVI   DATSPA,X'01'                                        0655 01045000
*            /********************************************************/ 01046000
*            /*                                                      */ 01047000
*            /* POSITION FOR THE OUTPUT RECORD                       */ 01048000
*            /*                                                      */ 01049000
*            /********************************************************/ 01050000
*            KEYRWFVS = MORVOVAL;                                  0656 01051000
         L     @15,@PC00001+4                                      0656 01052000
         L     @01,FDTPTR+480(,@15)                                0656 01053000
         MVC   KEYRWFVS(6),MORVOVAL(@01)                           0656 01054000
*            KEYRWCHR = MORCHVAL;                                  0657 01055000
         L     @15,@PC00001+4                                      0657 01056000
         L     @01,FDTPTR+484(,@15)                                0657 01057000
         MVC   KEYRWCHR(5),MORCHVAL(@01)                           0657 01058000
*            WFIOKYA = ADDR(KEYRWF);                               0658 01059000
*                                                                  0658 01060000
         L     @15,@PC00001+8                                      0658 01061000
         LA    @14,KEYRWF                                          0658 01062000
         ST    @14,WFIOKYA(,@15)                                   0658 01063000
*             DO;                                                  0659 01064000
*               WFREQ = ''B;                                       0660 01065000
         L     @15,@PC00001+8                                      0660 01066000
         XC    WFREQ(2,@15),WFREQ(@15)                             0660 01067000
*               WFRPOS = ON;      /*  POSRCD */                    0661 01068000
         L     @15,@PC00001+8                                      0661 01069000
         OI    WFRPOS(@15),B'00001000'                             0661 01070000
*               CALL IDCRDIO;                                      0662 01071000
         L     @15,@CV01814                                        0662 01072000
         BALR  @14,@15                                             0662 01073000
*               RFY RTNREG RSTD;                                   0663 01074000
*               TESTRC = RTNREG;                                   0664 01075000
         STH   RTNREG,TESTRC                                       0664 01076000
*               RFY RTNREG UNRSTD;                                 0665 01077000
*             END;                                                 0666 01078000
*                                                                  0666 01079000
*            /********************************************************/ 01080000
*            /* CHECK THE RETURN CODE FROM POSITIONING THE RECORD    */ 01081000
*            /*                                                      */ 01082000
*            /********************************************************/ 01083000
*            IF TESTRC ^= 0                                        0667 01084000
*              THEN                                                0667 01085000
*                                                                  0667 01086000
         LH    @15,TESTRC                                          0667 01087000
         LTR   @15,@15                                             0667 01088000
         BZ    @RF00667                                            0667 01089000
*                /****************************************************/ 01090000
*                /* BAD RETURN CODE FROM POSITIONING                 */ 01091000
*                /* CALL MODCLFP TO CLSE FILES AND FREE POOLS        */ 01092000
*                /****************************************************/ 01093000
*                DO;                                               0668 01094000
*                                                                  0668 01095000
*                /****************************************************/ 01096000
*                /* CHECK IS RECORD NOT FOUND                        */ 01097000
*                /****************************************************/ 01098000
*                IF TESTRC = NOTFOUND                              0669 01099000
*                  THEN                                            0669 01100000
*                                                                  0669 01101000
         CLC   TESTRC(2),@CH00181                                  0669 01102000
         BNE   @RF00669                                            0669 01103000
*                    /************************************************/ 01104000
*                    /* RECORD NOT FOUND. ISSUE MESSAGE IDC31224I    */ 01105000
*                    /************************************************/ 01106000
*                                                                  0670 01107000
*                     DO;                                          0670 01108000
*                       CKREQ = CKREQ && CKREQ;                    0671 01109000
         L     @15,@PC00001+8                                      0671 01110000
         XC    CKREQ(44,@15),CKREQ(@15)                            0671 01111000
*                       CKRERN = MSG24;                            0672 01112000
         L     @15,@PC00001+8                                      0672 01113000
         MVC   CKRERN(2,@15),@CH00312                              0672 01114000
*                       CKRMVAR(1) = ADDR(KEYRWFVS);               0673 01115000
         L     @15,@PC00001+8                                      0673 01116000
         LA    @14,KEYRWFVS                                        0673 01117000
         ST    @14,CKRMVAR(,@15)                                   0673 01118000
*                       CKRMVAR(2) = ADDR(KEYRWCHR);               0674 01119000
         L     @15,@PC00001+8                                      0674 01120000
         LA    @14,KEYRWCHR                                        0674 01121000
         ST    @14,CKRMVAR+4(,@15)                                 0674 01122000
*                       CKRMVAR(3) = ADDR(RWFDANA);                0675 01123000
         L     @15,@PC00001+8                                      0675 01124000
         L     @14,RWFPTR1                                         0675 01125000
         ST    @14,CKRMVAR+8(,@15)                                 0675 01126000
*                       CALL IDCRDER;                              0676 01127000
         L     @15,@CV01811                                        0676 01128000
         BALR  @14,@15                                             0676 01129000
*                     END;                                         0677 01130000
*                  ELSE;                                           0678 01131000
@RF00669 DS    0H                                                  0679 01132000
*                CALL MODCLFP;                                     0679 01133000
         BAL   @14,MODCLFP                                         0679 01134000
*                RETURN CODE(LASTCC12);                            0680 01135000
         LA    @15,12                                              0680 01136000
         L     @14,@SA00002                                        0680 01137000
         LM    @00,@12,@SA00002+8                                  0680 01138000
         BR    @14                                                 0680 01139000
*                END;                                              0681 01140000
*              ELSE;                                               0682 01141000
*                                                                  0682 01142000
@RF00667 DS    0H                                                  0683 01143000
*            /********************************************************/ 01144000
*            /*                                                      */ 01145000
*            /* GET THE RECORD                                       */ 01146000
*            /*                                                      */ 01147000
*            /********************************************************/ 01148000
*                                                                  0683 01149000
*             DO;                                                  0683 01150000
*               WFREQ = ''B;                                       0684 01151000
         L     @15,@PC00001+8                                      0684 01152000
         XC    WFREQ(2,@15),WFREQ(@15)                             0684 01153000
*               WFRGET = ON;      /*  GETRCD */                    0685 01154000
         L     @15,@PC00001+8                                      0685 01155000
         OI    WFRGET(@15),B'00100000'                             0685 01156000
*               WFRUP  = ON;      /* UPDATE */                     0686 01157000
         L     @15,@PC00001+8                                      0686 01158000
         OI    WFRUP(@15),B'01000000'                              0686 01159000
*               CALL IDCRDIO;                                      0687 01160000
         L     @15,@CV01814                                        0687 01161000
         BALR  @14,@15                                             0687 01162000
*               RFY RTNREG RSTD;                                   0688 01163000
*               TESTRC = RTNREG;                                   0689 01164000
         STH   RTNREG,TESTRC                                       0689 01165000
*               RFY RTNREG UNRSTD;                                 0690 01166000
*             END;                                                 0691 01167000
*                                                                  0691 01168000
*            /********************************************************/ 01169000
*            /*                                                      */ 01170000
*            /* CHECK THE RETURN CODE FROM GETTING THE RECORD        */ 01171000
*            /*                                                      */ 01172000
*            /********************************************************/ 01173000
*            IF TESTRC ^= 0                                        0692 01174000
*              THEN                                                0692 01175000
*                                                                  0692 01176000
         LH    @15,TESTRC                                          0692 01177000
         LTR   @15,@15                                             0692 01178000
         BZ    @RF00692                                            0692 01179000
*                /****************************************************/ 01180000
*                /*                                                  */ 01181000
*                /* THE RETURN CODE FROM GETTING THE RECORD IS NOT 0 */ 01182000
*                /* CALL MODCLFP TO CLOSE FILES AND FREE POOLS       */ 01183000
*                /*                                                  */ 01184000
*                /****************************************************/ 01185000
*                DO;                                               0693 01186000
*                                                                  0693 01187000
*                /****************************************************/ 01188000
*                /* CHECK IF THE RC WAS END OF FILE                  */ 01189000
*                /****************************************************/ 01190000
*                IF TESTRC = EOF                                   0694 01191000
*                  THEN                                            0694 01192000
*                                                                  0694 01193000
         CLC   TESTRC(2),@CH00475                                  0694 01194000
         BNE   @RF00694                                            0694 01195000
*                    /************************************************/ 01196000
*                    /* RC INDICATES END OF FILE. ISSUE MESSAGE      */ 01197000
*                    /*  IDC31224I                                   */ 01198000
*                    /************************************************/ 01199000
*                                                                  0695 01200000
*                     DO;                                          0695 01201000
*                       CKREQ = CKREQ && CKREQ;                    0696 01202000
         L     @15,@PC00001+8                                      0696 01203000
         XC    CKREQ(44,@15),CKREQ(@15)                            0696 01204000
*                       CKRERN = MSG24;                            0697 01205000
         L     @15,@PC00001+8                                      0697 01206000
         MVC   CKRERN(2,@15),@CH00312                              0697 01207000
*                       CKRMVAR(1) = ADDR(KEYRWFVS);               0698 01208000
         L     @15,@PC00001+8                                      0698 01209000
         LA    @14,KEYRWFVS                                        0698 01210000
         ST    @14,CKRMVAR(,@15)                                   0698 01211000
*                       CKRMVAR(2) = ADDR(KEYRWCHR);               0699 01212000
         L     @15,@PC00001+8                                      0699 01213000
         LA    @14,KEYRWCHR                                        0699 01214000
         ST    @14,CKRMVAR+4(,@15)                                 0699 01215000
*                       CKRMVAR(3) = ADDR(RWFDANA);                0700 01216000
         L     @15,@PC00001+8                                      0700 01217000
         L     @14,RWFPTR1                                         0700 01218000
         ST    @14,CKRMVAR+8(,@15)                                 0700 01219000
*                       CALL IDCRDER;                              0701 01220000
         L     @15,@CV01811                                        0701 01221000
         BALR  @14,@15                                             0701 01222000
*                     END;                                         0702 01223000
*                  ELSE;                                           0703 01224000
@RF00694 DS    0H                                                  0704 01225000
*                CALL MODCLFP;                                     0704 01226000
         BAL   @14,MODCLFP                                         0704 01227000
*                RETURN CODE(LASTCC12);                            0705 01228000
         LA    @15,12                                              0705 01229000
         L     @14,@SA00002                                        0705 01230000
         LM    @00,@12,@SA00002+8                                  0705 01231000
         BR    @14                                                 0705 01232000
*                END;                                              0706 01233000
*              ELSE;                                               0707 01234000
*                                                                  0707 01235000
@RF00692 DS    0H                                                  0708 01236000
*            /********************************************************/ 01237000
*            /*                                                      */ 01238000
*            /* PROCESS REPAIR WORKFILE OUTPUT                       */ 01239000
*            /*                                                      */ 01240000
*            /********************************************************/ 01241000
*            REPR1LN = WFIODLN;                                    0708 01242000
         L     @15,@PC00001+8                                      0708 01243000
         L     @14,@PC00001+8                                      0708 01244000
         L     @14,WFIODLN(,@14)                                   0708 01245000
         STH   @14,REPR1LN(,@15)                                   0708 01246000
*            BFPTROUT = REPBUFF1;                                  0709 01247000
         L     @15,@PC00001+8                                      0709 01248000
         L     @15,REPBUFF1(,@15)                                  0709 01249000
         ST    @15,BFPTROUT                                        0709 01250000
*            RFY RWF1 BASED (WFIODAD);                             0710 01251000
*            RFY RB2 BASED (REPBUFF1);                             0711 01252000
*                                                                  0711 01253000
*            /********************************************************/ 01254000
*            /*                                                      */ 01255000
*            /* MOVLEN HAS RECORD LENGTH TO BE MOVED                 */ 01256000
*            /*                                                      */ 01257000
*            /********************************************************/ 01258000
*            MOVLEN = WFIODLN;                                     0712 01259000
*                                                                  0712 01260000
         L     @15,@PC00001+8                                      0712 01261000
         L     @15,WFIODLN(,@15)                                   0712 01262000
         STH   @15,MOVLEN                                          0712 01263000
*             RFY (REG2,REG3,REG4,REG5) RSTD;                      0713 01264000
*             REG2 = ADDR(RB2);                                    0714 01265000
         L     @15,@PC00001+8                                      0714 01266000
         L     REG2,REPBUFF1(,@15)                                 0714 01267000
*             REG3 = MOVLEN;                                       0715 01268000
         LH    REG3,MOVLEN                                         0715 01269000
         N     REG3,@CF02153                                       0715 01270000
*             REG4 = ADDR(RWF1);                                   0716 01271000
         L     @15,@PC00001+8                                      0716 01272000
         L     REG4,WFIODAD(,@15)                                  0716 01273000
*             REG5 = MOVLEN;                                       0717 01274000
         LH    REG5,MOVLEN                                         0717 01275000
         N     REG5,@CF02153                                       0717 01276000
*             MVCL (REG2,REG4);                                    0718 01277000
         MVCL  REG2,REG4                                           0718 01278000
*             RFY(REG2,REG3,REG4,REG5) UNRSTD;                     0719 01279000
*                                                                  0719 01280000
*            /********************************************************/ 01281000
*            /*                                                      */ 01282000
*            /* CALL MODROUT SUBROUTINE TO MODIFY ONE REPAIR         */ 01283000
*            /*  WORKFILE RECORD                                     */ 01284000
*            /*                                                      */ 01285000
*            /********************************************************/ 01286000
*            CALL MODROUT;                                         0720 01287000
         BAL   @14,MODROUT                                         0720 01288000
*            RESPECIFY RTNREG RSTD;                                0721 01289000
*            TESTRC = RTNREG;                                      0722 01290000
         STH   RTNREG,TESTRC                                       0722 01291000
*            RESPECIFY RTNREG UNRSTD;                              0723 01292000
*            CALL MODCLFP;                                         0724 01293000
         BAL   @14,MODCLFP                                         0724 01294000
*            RETURN CODE(TESTRC);                                  0725 01295000
         LH    @15,TESTRC                                          0725 01296000
         L     @14,@SA00002                                        0725 01297000
         LM    @00,@12,@SA00002+8                                  0725 01298000
         BR    @14                                                 0725 01299000
*            END;                                                  0726 01300000
*          ELSE;                                                   0727 01301000
*                                                                  0727 01302000
@RF00641 DS    0H                                                  0728 01303000
*          /**********************************************************/ 01304000
*          /*                                                        */ 01305000
*          /* THE OUTPUT IS EITHER A DATA SET OR VTOCHEADER          */ 01306000
*          /* CALL IDCRDDS TO OPEN AND OBTAIN BUFFERS                */ 01307000
*          /**********************************************************/ 01308000
*          CALL IDCRDDS(OUT,ZEROS);                                0728 01309000
         L     @15,@CV01810                                        0728 01310000
         LA    @01,@AL00728                                        0728 01311000
         BALR  @14,@15                                             0728 01312000
*          RESPECIFY RTNREG RSTD;                                  0729 01313000
*          TESTRC = RTNREG;                                        0730 01314000
         STH   RTNREG,TESTRC                                       0730 01315000
*          RESPECIFY RTNREG UNRSTD;                                0731 01316000
*                                                                  0731 01317000
*          /**********************************************************/ 01318000
*          /*                                                        */ 01319000
*          /*CHECK IF THE RETURN CODE FROM IDCRDDS IS NOT ZERO       */ 01320000
*          /*                                                        */ 01321000
*          /**********************************************************/ 01322000
*          IF TESTRC ^= 0                                          0732 01323000
*            THEN                                                  0732 01324000
*                                                                  0732 01325000
         LH    @15,TESTRC                                          0732 01326000
         LTR   @15,@15                                             0732 01327000
         BZ    @RF00732                                            0732 01328000
*              /******************************************************/ 01329000
*              /* RC ^= 0 FROM IDCRDDS                               */ 01330000
*              /* CALL MODCLFP TO CLOSE FILES AND FREE POOLS         */ 01331000
*              /* RETURN WITH RC = 12. SET REPENQSW = ZERO SO NO     */ 01332000
*              /* DEQUEUE IS ISSUED IN MODCLFP.                      */ 01333000
*              /******************************************************/ 01334000
*              DO;                                                 0733 01335000
*              REPENQSW = ZERO;                                    0734 01336000
         L     @15,@PC00001+8                                      0734 01337000
         MVI   REPENQSW(@15),X'00'                                 0734 01338000
*              CALL MODCLFP;                                       0735 01339000
         BAL   @14,MODCLFP                                         0735 01340000
*              RETURN CODE(LASTCC12);                              0736 01341000
         LA    @15,12                                              0736 01342000
         L     @14,@SA00002                                        0736 01343000
         LM    @00,@12,@SA00002+8                                  0736 01344000
         BR    @14                                                 0736 01345000
*              END;                                                0737 01346000
*            ELSE;                                                 0738 01347000
*                                                                  0738 01348000
@RF00732 DS    0H                                                  0739 01349000
*          /**********************************************************/ 01350000
*          /*                                                        */ 01351000
*          /* SAVE FOR CLOSE AND SET ADDRESSABILITY FOR RDARG        */ 01352000
*          /* SET EITHER DSN OR VTOCHEADR CONSTANT IN A COMMON FIELD */ 01353000
*          /* TO BE USED FOR MESSAGES( DSNMSG)                       */ 01354000
*          /* SET THE DATSPA INDICATOR                               */ 01355000
*          /**********************************************************/ 01356000
*          SAVCLOUT = REPODSOP;                                    0739 01357000
         L     @15,@PC00001+8                                      0739 01358000
         L     @15,REPODSOP(,@15)                                  0739 01359000
         ST    @15,SAVCLOUT                                        0739 01360000
*          DATSPA = YESS;                                          0740 01361000
         MVI   DATSPA,X'01'                                        0740 01362000
*          RFY RDARG BASED (REPODSAR);                             0741 01363000
*          RFY XTNTTBL BASED(REPOXTNT);                            0742 01364000
*                                                                  0742 01365000
*          /**********************************************************/ 01366000
*          /*                                                        */ 01367000
*          /* CHECK IF THE OUT PUT IS VTOCHEADERADDRESS              */ 01368000
*          /*                                                        */ 01369000
*          /**********************************************************/ 01370000
*          IF ADDR(MVTOC) ^= NULLPTR                               0743 01371000
*             THEN                                                 0743 01372000
*                                                                  0743 01373000
         L     @15,@PC00001+4                                      0743 01374000
         L     @15,FDTPTR+424(,@15)                                0743 01375000
         LTR   @15,@15                                             0743 01376000
         BZ    @RF00743                                            0743 01377000
*               /*****************************************************/ 01378000
*               /*                                                   */ 01379000
*               /* THE VTOCHEADERADRRESS PARAMETER IS PRESENT        */ 01380000
*               /* MOVE THE VTOCNAME LITERAL TO COMMON MESSAGE AREA  */ 01381000
*               /*                                                   */ 01382000
*               /*****************************************************/ 01383000
*               DSNMSG = VTOCNAME;                                 0744 01384000
         MVI   DSNMSG+10,C' '                                      0744 01385000
         MVC   DSNMSG+11(33),DSNMSG+10                             0744 01386000
         MVC   DSNMSG(10),VTOCNAME                                 0744 01387000
*             ELSE                                                 0745 01388000
*                                                                  0745 01389000
*               /*****************************************************/ 01390000
*               /*                                                   */ 01391000
*               /* THE OUTDATASETADDRRESS PARAMETER IS PRESENT       */ 01392000
*               /* MOVE THE DSNAME LITERAL TO COMMON MESSAGE AREA    */ 01393000
*               /*  DSNMSG. NOTE THAT IF THE DATA SET IS A VTOC, THE */ 01394000
*               /*  DSNAME IS A FORMAT4.DSCB                         */ 01395000
*               /*****************************************************/ 01396000
*               DO;                                                0745 01397000
         B     @RC00743                                            0745 01398000
@RF00743 DS    0H                                                  0746 01399000
*               IF XTNHDSN = VTOCDSN                               0746 01400000
*                 THEN                                             0746 01401000
         L     @15,@PC00001+8                                      0746 01402000
         L     @01,REPOXTNT(,@15)                                  0746 01403000
         CLC   XTNHDSN(44,@01),VTOCDSN                             0746 01404000
         BNE   @RF00746                                            0746 01405000
*                   DSNMSG = FMT4DSN;                              0747 01406000
         MVC   DSNMSG(44),FMT4DSN                                  0747 01407000
*                 ELSE                                             0748 01408000
*                   DSNMSG = XTNHDSN;                              0748 01409000
         B     @RC00746                                            0748 01410000
@RF00746 L     @15,@PC00001+8                                      0748 01411000
         L     @01,REPOXTNT(,@15)                                  0748 01412000
         MVC   DSNMSG(44),XTNHDSN(@01)                             0748 01413000
*               END;                                               0749 01414000
*                                                                  0749 01415000
@RC00746 DS    0H                                                  0750 01416000
*          /**********************************************************/ 01417000
*          /*                                                        */ 01418000
*          /* GOOD OPEN SET RDARG LIST                               */ 01419000
*          /*                                                        */ 01420000
*          /**********************************************************/ 01421000
*          RDCHR = MOKAD5;                                         0750 01422000
@RC00743 L     @15,@PC00001+8                                      0750 01423000
         L     @01,REPODSAR(,@15)                                  0750 01424000
         MVC   RDCHR(5,@01),MOKAD5                                 0750 01425000
*          RDCTLBK  = REPODSOP;                                    0751 01426000
         L     @15,@PC00001+8                                      0751 01427000
         L     @01,REPODSAR(,@15)                                  0751 01428000
         L     @15,@PC00001+8                                      0751 01429000
         L     @00,REPODSOP(,@15)                                  0751 01430000
         ST    @00,RDCTLBK(,@01)                                   0751 01431000
*          RDLOCPTR = REPOLCPT;                                    0752 01432000
         L     @15,@PC00001+8                                      0752 01433000
         L     @01,REPODSAR(,@15)                                  0752 01434000
         L     @15,@PC00001+8                                      0752 01435000
         L     @00,REPOLCPT(,@15)                                  0752 01436000
         ST    @00,RDLOCPTR(,@01)                                  0752 01437000
*          RDIOAREA = REPOBFPT;                                    0753 01438000
         L     @15,@PC00001+8                                      0753 01439000
         L     @01,REPODSAR(,@15)                                  0753 01440000
         L     @15,@PC00001+8                                      0753 01441000
         L     @00,REPOBFPT(,@15)                                  0753 01442000
         ST    @00,RDIOAREA(,@01)                                  0753 01443000
*          RDDS     = ZERO;                                        0754 01444000
*                                                                  0754 01445000
         L     @15,@PC00001+8                                      0754 01446000
         L     @01,REPODSAR(,@15)                                  0754 01447000
         MVI   RDDS(@01),X'00'                                     0754 01448000
*          /**********************************************************/ 01449000
*          /*                                                        */ 01450000
*          /* CALL IDCRDRD TO READ ONE RECORD FROM A DATA SET OR     */ 01451000
*          /*  VTOCHEADER                                            */ 01452000
*          /*                                                        */ 01453000
*          /**********************************************************/ 01454000
*          CALL IDCRDRD(RDARG);                                    0755 01455000
         L     @15,@PC00001+8                                      0755 01456000
         L     @01,REPODSAR(,@15)                                  0755 01457000
         ST    @01,@AL00001                                        0755 01458000
         L     @15,@CV01812                                        0755 01459000
         LA    @01,@AL00001                                        0755 01460000
         BALR  @14,@15                                             0755 01461000
*          RESPECIFY RTNREG RSTD;                                  0756 01462000
*          TESTRC = RTNREG;                                        0757 01463000
         STH   RTNREG,TESTRC                                       0757 01464000
*          RESPECIFY RTNREG UNRSTD;                                0758 01465000
*                                                                  0758 01466000
*          /**********************************************************/ 01467000
*          /*                                                        */ 01468000
*          /*CHECK THE RETURN CODE FROM IDCRDRD                      */ 01469000
*          /*                                                        */ 01470000
*          /**********************************************************/ 01471000
*          IF TESTRC > 21                                          0759 01472000
*            THEN                                                  0759 01473000
*                                                                  0759 01474000
         LH    @15,TESTRC                                          0759 01475000
         C     @15,@CF00652                                        0759 01476000
         BNH   @RF00759                                            0759 01477000
*              /******************************************************/ 01478000
*              /*                                                    */ 01479000
*              /* THE RETURN CODE FROM IDCRDRD IS > 21 WHICH         */ 01480000
*              /*  INDICATES A BAD RECORD.  CALL MODCLFP TO CLOSE    */ 01481000
*              /*  THE FILES AND FREE POOLS AND RETURN WITH A RC = 12*/ 01482000
*              /******************************************************/ 01483000
*              DO;                                                 0760 01484000
*                                                                  0760 01485000
*              /******************************************************/ 01486000
*              /*                                                    */ 01487000
*              /* CHECK IF THE RC IS FOR RECORD NOT FOUND OR IF THE  */ 01488000
*              /*  END OF TRACK WAS ENCOUNTERED                      */ 01489000
*              /*                                                    */ 01490000
*              /******************************************************/ 01491000
*              IF TESTRC = NTFNDRD | TESTRC = ENDTRK               0761 01492000
*                THEN                                              0761 01493000
*                                                                  0761 01494000
         CLC   TESTRC(2),@CH01990                                  0761 01495000
         BE    @RT00761                                            0761 01496000
         CLC   TESTRC(2),@CH00698                                  0761 01497000
         BNE   @RF00761                                            0761 01498000
@RT00761 DS    0H                                                  0762 01499000
*                  /**************************************************/ 01500000
*                  /* RECORD NOT FOUND OR END OF TRACK ENCOUNTERED   */ 01501000
*                  /*  ISSUE MESSAGE IDC31223I                       */ 01502000
*                  /**************************************************/ 01503000
*                                                                  0762 01504000
*                   DO;                                            0762 01505000
*                     CKREQ = CKREQ && CKREQ;                      0763 01506000
         L     @15,@PC00001+8                                      0763 01507000
         XC    CKREQ(44,@15),CKREQ(@15)                            0763 01508000
*                     CKRERN = MSG23;                              0764 01509000
         L     @15,@PC00001+8                                      0764 01510000
         MVC   CKRERN(2,@15),@CH00667                              0764 01511000
*                     CKRMVAR(1) = ADDR(MOKAD6);                   0765 01512000
         L     @15,@PC00001+8                                      0765 01513000
         LA    @14,MOKAD6                                          0765 01514000
         ST    @14,CKRMVAR(,@15)                                   0765 01515000
*                     CKRMVAR(2) = ADDR(RDCHR);                    0766 01516000
         L     @15,@PC00001+8                                      0766 01517000
         L     @14,@PC00001+8                                      0766 01518000
         L     @01,REPODSAR(,@14)                                  0766 01519000
         LA    @14,RDCHR(,@01)                                     0766 01520000
         ST    @14,CKRMVAR+4(,@15)                                 0766 01521000
*                     CKRMVAR(3) = ADDR(PARNA);                    0767 01522000
         L     @15,@PC00001+8                                      0767 01523000
         LA    @14,PARNA                                           0767 01524000
         ST    @14,CKRMVAR+8(,@15)                                 0767 01525000
*                     CKRMVAR(4) = ADDR(DSNMSG);                   0768 01526000
         L     @15,@PC00001+8                                      0768 01527000
         LA    @14,DSNMSG                                          0768 01528000
         ST    @14,CKRMVAR+12(,@15)                                0768 01529000
*                     CALL IDCRDER;                                0769 01530000
         L     @15,@CV01811                                        0769 01531000
         BALR  @14,@15                                             0769 01532000
*                   END;                                           0770 01533000
*                ELSE;                                             0771 01534000
@RF00761 DS    0H                                                  0772 01535000
*              CALL MODCLFP;                                       0772 01536000
         BAL   @14,MODCLFP                                         0772 01537000
*              RETURN CODE(LASTCC12);                              0773 01538000
         LA    @15,12                                              0773 01539000
         L     @14,@SA00002                                        0773 01540000
         LM    @00,@12,@SA00002+8                                  0773 01541000
         BR    @14                                                 0773 01542000
*              END;                                                0774 01543000
*            ELSE;                                                 0775 01544000
*                                                                  0775 01545000
@RF00759 DS    0H                                                  0776 01546000
*        /************************************************************/ 01547000
*        /*                                                          */ 01548000
*        /*               FOR  OUTPUT  DEVICE                        */ 01549000
*        /* CALCULATE DEVICE MAX TRACK CAPACITY CONSTANTS            */ 01550000
*        /* KYCNST (IN KYCNSTCH) HAS RECORD WITH KEY OVERHEAD        */ 01551000
*        /* NOKYCNST HAS RECORD WITHOUT KEY OVERHEAD                 */ 01552000
*        /* DEVTC HAS TRACK CAPACITY                                 */ 01553000
*        /* SUMKEY WILL LATER HAVE NUMBER OF RECORDS WITH KEY        */ 01554000
*        /* SUMNOKEY WILL LATER HAVE NUMBER OF RECORDS WITHOUT KEY   */ 01555000
*        /*                                                          */ 01556000
*        /************************************************************/ 01557000
*        RFY DEVAREA BASED(REPODEVA);                              0776 01558000
*                                                                  0776 01559000
*        /************************************************************/ 01560000
*        /*                                                          */ 01561000
*        /* CHECK IF OVERHEAD FOR RECORD WITH KEY IS ONE OR TWO BYTES*/ 01562000
*        /* IF INF4FLG IS ON, THEN OVERHEAD CONSTANT IS TWO BYTES    */ 01563000
*        /*                                                          */ 01564000
*        /************************************************************/ 01565000
*        IF INF4FLG = ON                                           0777 01566000
*          THEN                                                    0777 01567000
         L     @15,@PC00001+8                                      0777 01568000
         L     @01,REPODEVA(,@15)                                  0777 01569000
         TM    INF4FLG(@01),B'00001000'                            0777 01570000
         BNO   @RF00777                                            0777 01571000
*            KYCNSTCH = DEVBOH;                                    0778 01572000
         L     @15,@PC00001+8                                      0778 01573000
         L     @01,REPODEVA(,@15)                                  0778 01574000
         MVC   KYCNSTCH(2),DEVBOH(@01)                             0778 01575000
*          ELSE                                                    0779 01576000
*            KYCNST   = DEVBOH1;                                   0779 01577000
         B     @RC00777                                            0779 01578000
@RF00777 L     @15,@PC00001+8                                      0779 01579000
         L     @01,REPODEVA(,@15)                                  0779 01580000
         SLR   @00,@00                                             0779 01581000
         IC    @00,DEVBOH1(,@01)                                   0779 01582000
         STH   @00,KYCNST                                          0779 01583000
*        NOKYCNST = KYCNST - DEVKC;                                0780 01584000
*                                                                  0780 01585000
@RC00777 L     @15,@PC00001+8                                      0780 01586000
         L     @01,REPODEVA(,@15)                                  0780 01587000
         LH    @00,KYCNST                                          0780 01588000
         N     @00,@CF02153                                        0780 01589000
         SLR   @15,@15                                             0780 01590000
         IC    @15,DEVKC(,@01)                                     0780 01591000
         SLR   @00,@15                                             0780 01592000
         STC   @00,NOKYCNST                                        0780 01593000
*        /************************************************************/ 01594000
*        /*                                                          */ 01595000
*        /* CHECK IS OUTPUT RECORD IS OVERFLOW                       */ 01596000
*        /*                                                          */ 01597000
*        /************************************************************/ 01598000
*        IF TESTRC = OVFLRCD                                       0781 01599000
*          THEN                                                    0781 01600000
         CLC   TESTRC(2),@CH00044                                  0781 01601000
         BNE   @RF00781                                            0781 01602000
*              OVFLSW = YESS;                                      0782 01603000
         MVI   OVFLSW,X'01'                                        0782 01604000
*            ELSE                                                  0783 01605000
*              OVFLSW = NOT;                                       0783 01606000
         B     @RC00781                                            0783 01607000
@RF00781 MVI   OVFLSW,X'00'                                        0783 01608000
*          BFPTROUT = RDDARE - LENGTH(RB1NUM);                     0784 01609000
@RC00781 L     @15,@PC00001+8                                      0784 01610000
         L     @01,REPODSAR(,@15)                                  0784 01611000
         L     @15,RDDARE(,@01)                                    0784 01612000
         SL    @15,@CF00044                                        0784 01613000
         ST    @15,BFPTROUT                                        0784 01614000
*          RFY RB1 BASED (BFPTROUT);                               0785 01615000
*                                                                  0785 01616000
*          /**********************************************************/ 01617000
*          /*                                                        */ 01618000
*          /* COMPUTE THE ADDRESS OF THE NEXT RECORD AND SAVE IT IN  */ 01619000
*          /* SVDTADDR. THIS ADDRESS WILL BE NEEDED IN CASE OF A     */ 01620000
*          /* FORMAT WRITE                                           */ 01621000
*          /*                                                        */ 01622000
*          /**********************************************************/ 01623000
*          SVDTADDR = RDDARE+ RB1CKL + RB1CDL + LENGTH(RB1C);      0786 01624000
*                                                                  0786 01625000
         L     @15,@PC00001+8                                      0786 01626000
         L     @01,REPODSAR(,@15)                                  0786 01627000
         L     @15,BFPTROUT                                        0786 01628000
         SLR   @14,@14                                             0786 01629000
         IC    @14,RB1CKL(,@15)                                    0786 01630000
         AL    @14,RDDARE(,@01)                                    0786 01631000
         L     @15,BFPTROUT                                        0786 01632000
         LH    @15,RB1CDL(,@15)                                    0786 01633000
         N     @15,@CF02153                                        0786 01634000
         ALR   @14,@15                                             0786 01635000
         AL    @14,@CF00181                                        0786 01636000
         ST    @14,SVDTADDR                                        0786 01637000
*        /************************************************************/ 01638000
*        /*                                                          */ 01639000
*        /* CALL MODDSOUT TO MODIFY ONE RECORD IN A DATA SET OR      */ 01640000
*        /*  VTOCHEADER                                              */ 01641000
*        /*                                                          */ 01642000
*        /************************************************************/ 01643000
*          CALL MODDSOUT;                                          0787 01644000
         BAL   @14,MODDSOUT                                        0787 01645000
*          RESPECIFY RTNREG RSTD;                                  0788 01646000
*          TESTRC = RTNREG;                                        0789 01647000
         STH   RTNREG,TESTRC                                       0789 01648000
*          RESPECIFY RTNREG UNRSTD;                                0790 01649000
*          CALL MODCLFP;                                           0791 01650000
         BAL   @14,MODCLFP                                         0791 01651000
*          RETURN CODE(TESTRC);                                    0792 01652000
         LH    @15,TESTRC                                          0792 01653000
         L     @14,@SA00002                                        0792 01654000
         LM    @00,@12,@SA00002+8                                  0792 01655000
         BR    @14                                                 0792 01656000
*MODROUT:   PROCEDURE;                                             0793 01657000
MODROUT  STM   @14,@12,@SA00003                                    0793 01658000
*        /************************************************************/ 01659000
*        /*                                                          */ 01660000
*        /* SUBROUTINE NAME - MODROUT                                */ 01661000
*        /*                                                          */ 01662000
*        /* FUNCTION -                                               */ 01663000
*        /*                                                          */ 01664000
*        /*  THIS PROCEDURE WILL MODIFY ONE RECORD (OUTPUT) IN A     */ 01665000
*        /*  A REPAIR WORKFILE.                                      */ 01666000
*        /*  IF THE INPUT IS A RECORD, THE BFPTRIN IS NOT NULL.      */ 01667000
*        /*  IF BFPTRIN IS NULL, THE INPUT IS  A DATA STRING         */ 01668000
*        /*  AND  DATA IS IN AREA RB3. THE OUTPUT RECORD IS IN AREA  */ 01669000
*        /*  RB2 POINTED BY BFPTROUT                                 */ 01670000
*        /*                                                          */ 01671000
*        /*                                                          */ 01672000
*        /* NOTES -                                                  */ 01673000
*        /*                                                          */ 01674000
*        /*    DEPENDENCIES - NONE                                   */ 01675000
*        /*                                                          */ 01676000
*        /*    RESTRICTIONS - GENERAL PURPOSE REGISTERS 7 AND 8      */ 01677000
*        /*                   MAY NOT BE USED BY THIS MODULE OR      */ 01678000
*        /*                   ANY OTHER REPAIRV MODULE AS THEY ARE   */ 01679000
*        /*                   DATA REGISTERS FOR MODULES IDCRD07     */ 01680000
*        /*                   AND IDCRD06 RESPECTIVELY               */ 01681000
*        /*                                                          */ 01682000
*        /*    REGISTER CONVENTIONS - SEE GLOBAL DATA AREA (AMSDF00) */ 01683000
*        /*                                                          */ 01684000
*        /*    PATCH LABEL - 'UPATCHIT'                              */ 01685000
*        /*                                                          */ 01686000
*        /* ENTRY POINT - MODROUT (ONLY ENTRY POINT)                 */ 01687000
*        /*                                                          */ 01688000
*        /*    PURPOSE - INVOKED TO PERFORM THE REPAIRV FSR          */ 01689000
*        /*    MODIFY  FUNCTION  FOR A RECORD IN A REPAIR WORKFILE   */ 01690000
*        /*                                                          */ 01691000
*        /*    LINKAGE - 'CALL MODROUT'                              */ 01692000
*        /*                                                          */ 01693000
*        /*    INPUT -                                               */ 01694000
*        /*                                                          */ 01695000
*        /*      THE INPUT DATA CAN BE AS FOLLOWS.                   */ 01696000
*        /*       A) DATA STRING SPECFIED IN THE COMMAND             */ 01697000
*        /*       B) A RECORD IN A DATA SET                          */ 01698000
*        /*       C) A RECORD IN A REPAIR WORKFILE                   */ 01699000
*        /*                                                          */ 01700000
*        /*    OUTPUT -                                              */ 01701000
*        /*                                                          */ 01702000
*        /*      THE OUTPUT CAN BE AS FOLLOWS                        */ 01703000
*        /*       A) A MODIFIED RECORD IN A REPAIR WORKFILE          */ 01704000
*        /*                                                          */ 01705000
*        /*      ERROR MESSAGES: IDC31230I                           */ 01706000
*        /*                      IDC31231I                           */ 01707000
*        /*                      IDC31232I                           */ 01708000
*        /*                      IDC31241I                           */ 01709000
*        /*                                                          */ 01710000
*        /*    EXIT, NORMAL -                                        */ 01711000
*        /*                                                          */ 01712000
*        /*      LASTCC = 00        FUNCTION COMPLETED SUCCESSFULLY  */ 01713000
*        /*                                                          */ 01714000
*        /*    EXIT, ERROR -                                         */ 01715000
*        /*                                                          */ 01716000
*        /*      LASTCC = 12        FUNCTION COULD NOT COMPLETE      */ 01717000
*        /*                                                          */ 01718000
*        /* INTERNAL REFERENCES -                                    */ 01719000
*        /*    PROCEDURES/SUBROUTINES CALLED                         */ 01720000
*        /*                                                          */ 01721000
*        /*    NONE                                                  */ 01722000
*        /*                                                          */ 01723000
*        /* EXTERNAL REFERENCES -                                    */ 01724000
*        /*    MACROS/SVCS -                                         */ 01725000
*        /*                                                          */ 01726000
*        /*    ?MOVELONG - REPAIRV MVCL MACRO                        */ 01727000
*        /*      EXECUTES MVCL INSTRUCTION WITH GPR'S 2,3,4 & 5      */ 01728000
*        /*                                                          */ 01729000
*        /*    ?UPDRDC - REPAIRV RECORD UPDATE ROUTINE               */ 01730000
*        /*      UPDATES A RECORD IN A REPAIR WORKFILE               */ 01731000
*        /*      GENERATES A CALL TO MODULE IDCRDIO                  */ 01732000
*        /*                                                          */ 01733000
*        /*    ?CALLCKER - REPAIRV WRITE MESSAGE ROUTINE             */ 01734000
*        /*      WRITES ALL MESSAGES                                 */ 01735000
*        /*      GENERATES A CALL TO MODULE IDCRDER                  */ 01736000
*        /*                                                          */ 01737000
*        /* PROCEDURES/SUBROUTINES CALLED                            */ 01738000
*        /*                                                          */ 01739000
*        /*    NONE                                                  */ 01740000
*        /*                                                          */ 01741000
*        /************************************************************/ 01742000
*                                                                  0794 01743000
*        /************************************************************/ 01744000
*        /*                                                          */ 01745000
*        /* SET DUMP POINT                                           */ 01746000
*        /*                                                          */ 01747000
*        /************************************************************/ 01748000
*          IF GDTDBG = NULLPTR                                     0794 01749000
*            THEN;                                                 0794 01750000
         L     @15,@PC00001                                        0794 01751000
         L     @15,GDTDBG(,@15)                                    0794 01752000
         LTR   @15,@15                                             0794 01753000
         BZ    @RT00794                                            0794 01754000
*            ELSE                                                  0796 01755000
*              CALL IDCDB010(GDTTBL,'RD52');                       0796 01756000
*                                                                  0796 01757000
         L     @15,@PC00001                                        0796 01758000
         ST    @15,@AL00001                                        0796 01759000
         LA    @15,@CC02086                                        0796 01760000
         ST    @15,@AL00001+4                                      0796 01761000
         MVI   @AL00001+4,X'80'                                    0796 01762000
         L     @14,@PC00001                                        0796 01763000
         L     @15,GDTDBG(,@14)                                    0796 01764000
         LA    @01,@AL00001                                        0796 01765000
         BALR  @14,@15                                             0796 01766000
*        /************************************************************/ 01767000
*        /*                                                          */ 01768000
*        /* SET TRACE POINT                                          */ 01769000
*        /*                                                          */ 01770000
*        /************************************************************/ 01771000
*        OLDERID2 = NEWERID2;                                      0797 01772000
@RT00794 L     @15,@PC00001                                        0797 01773000
         L     @01,GDTTR2(,@15)                                    0797 01774000
         L     @15,@PC00001                                        0797 01775000
         L     @15,GDTTR2(,@15)                                    0797 01776000
         MVC   @TS00001(95),NEWERID2(@15)                          0797 01777000
         MVC   OLDERID2(95,@01),@TS00001                           0797 01778000
*        NEWID2 = 'RD53';                                          0798 01779000
*                                                                  0798 01780000
         L     @15,@PC00001                                        0798 01781000
         L     @01,GDTTR2(,@15)                                    0798 01782000
         MVC   NEWID2(4,@01),@CC02087                              0798 01783000
*        /************************************************************/ 01784000
*        /*                                                          */ 01785000
*        /* CK FOR TYPE OF INPUT                                     */ 01786000
*        /*                                                          */ 01787000
*        /************************************************************/ 01788000
*        IF BFPTRIN ^= NULLPTR                                     0799 01789000
*          THEN                                                    0799 01790000
         L     @15,BFPTRIN                                         0799 01791000
         LTR   @15,@15                                             0799 01792000
         BZ    @RF00799                                            0799 01793000
*            DO;                                                   0800 01794000
*                                                                  0800 01795000
*            /********************************************************/ 01796000
*            /*                                                      */ 01797000
*            /* INPUT IS IN RB3 POINTED TO BY BFPTRIN                */ 01798000
*            /* WE WILL USE RWF2 AREA FOR INPUT                      */ 01799000
*            /*                                                      */ 01800000
*            /********************************************************/ 01801000
*            BFPTRIN = BFPTRIN - KEYFLGLN + LENGTH(RB3NUM);        0801 01802000
         L     @15,@CF02135                                        0801 01803000
         AL    @15,BFPTRIN                                         0801 01804000
         ST    @15,BFPTRIN                                         0801 01805000
*            RFY RWF2 BASED (BFPTRIN);                             0802 01806000
*            RWF2KYFL = RWF1KYFL;                                  0803 01807000
         L     @01,BFPTRIN                                         0803 01808000
         L     @15,@PC00001+8                                      0803 01809000
         L     @15,WFIODAD(,@15)                                   0803 01810000
         MVC   RWF2KYFL(16,@01),RWF1KYFL(@15)                      0803 01811000
*            RWF2CHR = RWF1CHR;                                    0804 01812000
*                                                                  0804 01813000
         L     @01,BFPTRIN                                         0804 01814000
         L     @15,@PC00001+8                                      0804 01815000
         L     @15,WFIODAD(,@15)                                   0804 01816000
         MVC   RWF2CHR(5,@01),RWF1CHR(@15)                         0804 01817000
*            /********************************************************/ 01818000
*            /*                                                      */ 01819000
*            /* SET MODIFIED FLAG                                    */ 01820000
*            /*                                                      */ 01821000
*            /********************************************************/ 01822000
*            IF RWF2FLG1 = UNMOD | RWF2FLG1 = DEBLOCKD             0805 01823000
*              THEN                                                0805 01824000
         L     @01,BFPTRIN                                         0805 01825000
         CLI   RWF2FLG1(@01),0                                     0805 01826000
         BE    @RT00805                                            0805 01827000
         L     @01,BFPTRIN                                         0805 01828000
         CLI   RWF2FLG1(@01),2                                     0805 01829000
         BNE   @RF00805                                            0805 01830000
@RT00805 DS    0H                                                  0806 01831000
*                RWF2FLG1 = RWF2FLG1 + 1;                          0806 01832000
         LA    @15,1                                               0806 01833000
         L     @14,BFPTRIN                                         0806 01834000
         SLR   @05,@05                                             0806 01835000
         IC    @05,RWF2FLG1(,@14)                                  0806 01836000
         ALR   @15,@05                                             0806 01837000
         L     @14,BFPTRIN                                         0806 01838000
         STC   @15,RWF2FLG1(,@14)                                  0806 01839000
*              ELSE;                                               0807 01840000
*                                                                  0807 01841000
@RF00805 DS    0H                                                  0808 01842000
*            /********************************************************/ 01843000
*            /*                                                      */ 01844000
*            /* UPDATE RECORD  LENGTH                                */ 01845000
*            /*                                                      */ 01846000
*            /********************************************************/ 01847000
*            WFIODAD = BFPTRIN;                                    0808 01848000
         L     @15,@PC00001+8                                      0808 01849000
         L     @14,BFPTRIN                                         0808 01850000
         ST    @14,WFIODAD(,@15)                                   0808 01851000
*            WFIODLN = RWF2CKL + RWF2CDL +KEYFLGLN + COUNTLN;      0809 01852000
         L     @15,@PC00001+8                                      0809 01853000
         L     @01,BFPTRIN                                         0809 01854000
         SLR   @00,@00                                             0809 01855000
         IC    @00,RWF2CKL(,@01)                                   0809 01856000
         L     @01,BFPTRIN                                         0809 01857000
         LH    @01,RWF2CDL(,@01)                                   0809 01858000
         N     @01,@CF02153                                        0809 01859000
         ALR   @00,@01                                             0809 01860000
         AL    @00,@CF00312                                        0809 01861000
         ST    @00,WFIODLN(,@15)                                   0809 01862000
*            IF RWF2CDL = ZERO                                     0810 01863000
*              THEN                                                0810 01864000
         L     @01,BFPTRIN                                         0810 01865000
         LH    @15,RWF2CDL(,@01)                                   0810 01866000
         N     @15,@CF02153                                        0810 01867000
         LTR   @15,@15                                             0810 01868000
         BNZ   @RF00810                                            0810 01869000
*                WFIODLN = WFIODLN + 1;                            0811 01870000
         L     @15,@PC00001+8                                      0811 01871000
         L     @14,@PC00001+8                                      0811 01872000
         LA    @05,1                                               0811 01873000
         AL    @05,WFIODLN(,@14)                                   0811 01874000
         ST    @05,WFIODLN(,@15)                                   0811 01875000
*              ELSE;                                               0812 01876000
*                                                                  0812 01877000
@RF00810 DS    0H                                                  0813 01878000
*            /********************************************************/ 01879000
*            /*                                                      */ 01880000
*            /* CK IF IT WILL FIT IN RWF                             */ 01881000
*            /*                                                      */ 01882000
*            /********************************************************/ 01883000
*            IF WFIODLN > (REPORWIO->IOCTRN)                       0813 01884000
*              THEN                                                0813 01885000
         L     @15,@PC00001+8                                      0813 01886000
         L     @14,@PC00001+8                                      0813 01887000
         L     @01,REPORWIO(,@14)                                  0813 01888000
         L     @00,WFIODLN(,@15)                                   0813 01889000
         C     @00,IOCTRN(,@01)                                    0813 01890000
         BNH   @RF00813                                            0813 01891000
*                DO;                                               0814 01892000
*                                                                  0814 01893000
*                /****************************************************/ 01894000
*                /*                                                  */ 01895000
*                /* INPUT TOO LONG. ISSUE MESSAGE IDC3121I           */ 01896000
*                /*                                                  */ 01897000
*                /****************************************************/ 01898000
*                                                                  0815 01899000
*                 DO;                                              0815 01900000
*                   CKREQ = CKREQ && CKREQ;                        0816 01901000
         L     @15,@PC00001+8                                      0816 01902000
         XC    CKREQ(44,@15),CKREQ(@15)                            0816 01903000
*                   CKRERN = MSG31;                                0817 01904000
         L     @15,@PC00001+8                                      0817 01905000
         MVC   CKRERN(2,@15),@CH00046                              0817 01906000
*                   CKRMVAR(1) = ADDR(RWFDANA);                    0818 01907000
         L     @15,@PC00001+8                                      0818 01908000
         L     @14,RWFPTR1                                         0818 01909000
         ST    @14,CKRMVAR(,@15)                                   0818 01910000
*                   CALL IDCRDER;                                  0819 01911000
         L     @15,@CV01811                                        0819 01912000
         BALR  @14,@15                                             0819 01913000
*                 END;                                             0820 01914000
*                RETURN CODE(LASTCC12);                            0821 01915000
         LA    @15,12                                              0821 01916000
         L     @14,@SA00003                                        0821 01917000
         LM    @00,@12,@SA00003+8                                  0821 01918000
         BR    @14                                                 0821 01919000
*                END;                                              0822 01920000
*              ELSE;                                               0823 01921000
*                                                                  0823 01922000
@RF00813 DS    0H                                                  0824 01923000
*            /********************************************************/ 01924000
*            /*                                                      */ 01925000
*            /* UPDATE THE REPAIR WORK FILE WITH THE INPUT RECORD    */ 01926000
*            /*                                                      */ 01927000
*            /********************************************************/ 01928000
*                                                                  0824 01929000
*             DO;                                                  0824 01930000
*               WFREQ = ''B;                                       0825 01931000
         L     @15,@PC00001+8                                      0825 01932000
         XC    WFREQ(2,@15),WFREQ(@15)                             0825 01933000
*               WFRUPD = ON;      /*  UPDRCD */                    0826 01934000
         L     @15,@PC00001+8                                      0826 01935000
         OI    WFRUPD(@15),B'00010000'                             0826 01936000
*               WFRUP  = ON;      /* UPDATE */                     0827 01937000
         L     @15,@PC00001+8                                      0827 01938000
         OI    WFRUP(@15),B'01000000'                              0827 01939000
*               CALL IDCRDIO;                                      0828 01940000
         L     @15,@CV01814                                        0828 01941000
         BALR  @14,@15                                             0828 01942000
*               RFY RTNREG RSTD;                                   0829 01943000
*               TESTRC = RTNREG;                                   0830 01944000
         STH   RTNREG,TESTRC                                       0830 01945000
*               RFY RTNREG UNRSTD;                                 0831 01946000
*             END;                                                 0832 01947000
*            RETURN CODE(TESTRC);                                  0833 01948000
         LH    @15,TESTRC                                          0833 01949000
         L     @14,@SA00003                                        0833 01950000
         LM    @00,@12,@SA00003+8                                  0833 01951000
         BR    @14                                                 0833 01952000
*            END;                                                  0834 01953000
*          ELSE;                                                   0835 01954000
*                                                                  0835 01955000
@RF00799 DS    0H                                                  0836 01956000
*        /************************************************************/ 01957000
*        /*                                                          */ 01958000
*        /* THE OUTPUT IS IN RB2 AND INPUT IS A STRING               */ 01959000
*        /* SET THE NEW RECORD IN AREA RWF2 POINTED BY REPBUFF0      */ 01960000
*        /*                                                          */ 01961000
*        /************************************************************/ 01962000
*        RFY RWF2 BASED (REPBUFF0);                                0836 01963000
*        RWF2KEY = RB2KEY;                                         0837 01964000
         L     @15,@PC00001+8                                      0837 01965000
         L     @01,REPBUFF0(,@15)                                  0837 01966000
         L     @15,@PC00001+8                                      0837 01967000
         L     @15,REPBUFF1(,@15)                                  0837 01968000
         MVC   RWF2KEY(11,@01),RB2KEY(@15)                         0837 01969000
*        RWF2FLG = RB2FLG;                                         0838 01970000
*                                                                  0838 01971000
         L     @15,@PC00001+8                                      0838 01972000
         L     @01,REPBUFF0(,@15)                                  0838 01973000
         L     @15,@PC00001+8                                      0838 01974000
         L     @15,REPBUFF1(,@15)                                  0838 01975000
         MVC   RWF2FLG(5,@01),RB2FLG(@15)                          0838 01976000
*        /************************************************************/ 01977000
*        /*                                                          */ 01978000
*        /*    SET MODIFIED RECORD INDICATOR                         */ 01979000
*        /*                                                          */ 01980000
*        /************************************************************/ 01981000
*        IF RWF2FLG1 = UNMOD | RWF2FLG1 = DEBLOCKD                 0839 01982000
*          THEN                                                    0839 01983000
         L     @15,@PC00001+8                                      0839 01984000
         L     @01,REPBUFF0(,@15)                                  0839 01985000
         CLI   RWF2FLG1(@01),0                                     0839 01986000
         BE    @RT00839                                            0839 01987000
         L     @15,@PC00001+8                                      0839 01988000
         L     @01,REPBUFF0(,@15)                                  0839 01989000
         CLI   RWF2FLG1(@01),2                                     0839 01990000
         BNE   @RF00839                                            0839 01991000
@RT00839 DS    0H                                                  0840 01992000
*            RWF2FLG1 = RWF2FLG1 + 1;                              0840 01993000
         L     @15,@PC00001+8                                      0840 01994000
         L     @01,REPBUFF0(,@15)                                  0840 01995000
         L     @15,@PC00001+8                                      0840 01996000
         L     @15,REPBUFF0(,@15)                                  0840 01997000
         LA    @14,1                                               0840 01998000
         SLR   @00,@00                                             0840 01999000
         IC    @00,RWF2FLG1(,@15)                                  0840 02000000
         ALR   @14,@00                                             0840 02001000
         STC   @14,RWF2FLG1(,@01)                                  0840 02002000
*          ELSE;                                                   0841 02003000
*                                                                  0841 02004000
@RF00839 DS    0H                                                  0842 02005000
*        /************************************************************/ 02006000
*        /*                                                          */ 02007000
*        /*  IF NEWCOUNT KEYWORD IS PRESENT, PROCESS NEWCOUNT        */ 02008000
*        /*                                                          */ 02009000
*        /************************************************************/ 02010000
*        IF ADDR(MNCNT) ^= NULLPTR                                 0842 02011000
*          THEN                                                    0842 02012000
*                                                                  0842 02013000
         L     @15,@PC00001+4                                      0842 02014000
         L     @15,FDTPTR+368(,@15)                                0842 02015000
         LTR   @15,@15                                             0842 02016000
         BZ    @RF00842                                            0842 02017000
*            /********************************************************/ 02018000
*            /* CHECK THAT THE NEWCOUNT PARAMETER LENGTH IS 8        */ 02019000
*            /********************************************************/ 02020000
*            DO;                                                   0843 02021000
*            IF MNCNTLEN ^= COUNTLN                                0844 02022000
*              THEN                                                0844 02023000
*                                                                  0844 02024000
         L     @15,@PC00001+4                                      0844 02025000
         L     @01,FDTPTR+368(,@15)                                0844 02026000
         CLI   MNCNTLEN(@01),8                                     0844 02027000
         BE    @RF00844                                            0844 02028000
*                /****************************************************/ 02029000
*                /* BAD COUNT LENGTH ISSUE MESSAGE IDC31241I         */ 02030000
*                /****************************************************/ 02031000
*                DO;                                               0845 02032000
*                                                                  0845 02033000
*                 DO;                                              0846 02034000
*                   CKREQ = CKREQ && CKREQ;                        0847 02035000
         L     @15,@PC00001+8                                      0847 02036000
         XC    CKREQ(44,@15),CKREQ(@15)                            0847 02037000
*                   CKRERN = MSG41;                                0848 02038000
         L     @15,@PC00001+8                                      0848 02039000
         MVC   CKRERN(2,@15),@CH00736                              0848 02040000
*                   CALL IDCRDER;                                  0849 02041000
         L     @15,@CV01811                                        0849 02042000
         BALR  @14,@15                                             0849 02043000
*                 END;                                             0850 02044000
*                RETURN CODE(LASTCC12);                            0851 02045000
         LA    @15,12                                              0851 02046000
         L     @14,@SA00003                                        0851 02047000
         LM    @00,@12,@SA00003+8                                  0851 02048000
         BR    @14                                                 0851 02049000
*                END;                                              0852 02050000
*              ELSE;                                               0853 02051000
@RF00844 DS    0H                                                  0854 02052000
*            RWF2C = MNCNTVAL;                                     0854 02053000
         L     @15,@PC00001+8                                      0854 02054000
         L     @01,REPBUFF0(,@15)                                  0854 02055000
         L     @15,@PC00001+4                                      0854 02056000
         L     @15,FDTPTR+368(,@15)                                0854 02057000
         MVC   RWF2C(8,@01),MNCNTVAL(@15)                          0854 02058000
*            END;                                                  0855 02059000
*          ELSE                                                    0856 02060000
*            RWF2C = RB2C;                                         0856 02061000
*                                                                  0856 02062000
         B     @RC00842                                            0856 02063000
@RF00842 L     @15,@PC00001+8                                      0856 02064000
         L     @01,REPBUFF0(,@15)                                  0856 02065000
         L     @15,@PC00001+8                                      0856 02066000
         L     @15,REPBUFF1(,@15)                                  0856 02067000
         MVC   RWF2C(8,@01),RB2C(@15)                              0856 02068000
*        /************************************************************/ 02069000
*        /*  MOVE KEY IF PRESENT                                     */ 02070000
*        /************************************************************/ 02071000
*        IF RB2CKL ^= ZERO                                         0857 02072000
*          THEN                                                    0857 02073000
@RC00842 L     @15,@PC00001+8                                      0857 02074000
         L     @01,REPBUFF1(,@15)                                  0857 02075000
         CLI   RB2CKL(@01),0                                       0857 02076000
         BE    @RF00857                                            0857 02077000
*            RWF2KD(1:RB2CKL) = RB2KD(1:RB2CKL);                   0858 02078000
         L     @15,@PC00001+8                                      0858 02079000
         L     @01,REPBUFF0(,@15)                                  0858 02080000
         L     @15,@PC00001+8                                      0858 02081000
         L     @15,REPBUFF1(,@15)                                  0858 02082000
         SLR   @14,@14                                             0858 02083000
         IC    @14,RB2CKL(,@15)                                    0858 02084000
         BCTR  @14,0                                               0858 02085000
         L     @15,@PC00001+8                                      0858 02086000
         L     @15,REPBUFF1(,@15)                                  0858 02087000
         EX    @14,@SM02156                                        0858 02088000
*          ELSE;                                                   0859 02089000
*                                                                  0859 02090000
@RF00857 DS    0H                                                  0860 02091000
*        /************************************************************/ 02092000
*        /*                                                          */ 02093000
*        /* CHECK IF NEWKEY PRESENT                                  */ 02094000
*        /*                                                          */ 02095000
*        /************************************************************/ 02096000
*        IF ADDR(MNKEY) ^= NULLPTR                                 0860 02097000
*          THEN                                                    0860 02098000
*                                                                  0860 02099000
         L     @15,@PC00001+4                                      0860 02100000
         L     @15,FDTPTR+364(,@15)                                0860 02101000
         LTR   @15,@15                                             0860 02102000
         BZ    @RF00860                                            0860 02103000
*            /********************************************************/ 02104000
*            /*                                                      */ 02105000
*            /* CHECK IF NEWKEY PARAMETER LENGTH IS OK, THAT IS, THE */ 02106000
*            /*  LENGTH IS LESS THAN 256 AND THE OFFSET IS NOT       */ 02107000
*            /*  GREATER THAN THE CURRENT KEY LENGTH + 1             */ 02108000
*            /*                                                      */ 02109000
*            /********************************************************/ 02110000
*            DO;                                                   0861 02111000
*            IF (MNKOFVAL > RB2CKL+1) | (MNKOFVAL+MNKSTLEN-1) >KEYMAXLN 02112000
*              THEN                                                0862 02113000
         L     @15,@PC00001+4                                      0862 02114000
         L     @01,FDTPTR+472(,@15)                                0862 02115000
         L     @15,@PC00001+8                                      0862 02116000
         L     @15,REPBUFF1(,@15)                                  0862 02117000
         LA    @14,1                                               0862 02118000
         SLR   @00,@00                                             0862 02119000
         IC    @00,RB2CKL(,@15)                                    0862 02120000
         ALR   @14,@00                                             0862 02121000
         C     @14,MNKOFVAL(,@01)                                  0862 02122000
         BL    @RT00862                                            0862 02123000
         L     @15,@PC00001+4                                      0862 02124000
         L     @01,FDTPTR+472(,@15)                                0862 02125000
         L     @15,@PC00001+4                                      0862 02126000
         L     @15,FDTPTR+476(,@15)                                0862 02127000
         SLR   @14,@14                                             0862 02128000
         IC    @14,MNKSTLEN(,@15)                                  0862 02129000
         AL    @14,MNKOFVAL(,@01)                                  0862 02130000
         BCTR  @14,0                                               0862 02131000
         C     @14,@CF00987                                        0862 02132000
         BNH   @RF00862                                            0862 02133000
@RT00862 DS    0H                                                  0863 02134000
*                DO;                                               0863 02135000
*                                                                  0863 02136000
*                /****************************************************/ 02137000
*                /* BAD OFFSET ISSUE MESSAGE IDC31230I               */ 02138000
*                /****************************************************/ 02139000
*                                                                  0864 02140000
*                 DO;                                              0864 02141000
*                   CKREQ = CKREQ && CKREQ;                        0865 02142000
         L     @15,@PC00001+8                                      0865 02143000
         XC    CKREQ(44,@15),CKREQ(@15)                            0865 02144000
*                   CKRERN = MSG30;                                0866 02145000
         L     @15,@PC00001+8                                      0866 02146000
         MVC   CKRERN(2,@15),@CH00698                              0866 02147000
*                   CKRMVAR(1) = ADDR(MNKOFVAL);                   0867 02148000
         L     @15,@PC00001+8                                      0867 02149000
         L     @14,@PC00001+4                                      0867 02150000
         L     @14,FDTPTR+472(,@14)                                0867 02151000
         ST    @14,CKRMVAR(,@15)                                   0867 02152000
*                   CALL IDCRDER;                                  0868 02153000
         L     @15,@CV01811                                        0868 02154000
         BALR  @14,@15                                             0868 02155000
*                 END;                                             0869 02156000
*                RETURN CODE(LASTCC12);                            0870 02157000
         LA    @15,12                                              0870 02158000
         L     @14,@SA00003                                        0870 02159000
         LM    @00,@12,@SA00003+8                                  0870 02160000
         BR    @14                                                 0870 02161000
*                END;                                              0871 02162000
*              ELSE;                                               0872 02163000
*                                                                  0872 02164000
@RF00862 DS    0H                                                  0873 02165000
*            /********************************************************/ 02166000
*            /*                                                      */ 02167000
*            /* CHECK IF KEY FIELD WILL EXPAND                       */ 02168000
*            /*                                                      */ 02169000
*            /********************************************************/ 02170000
*            IF RB2CKL = ZERO | RB2CKL< (MNKOFVAL+MNKSTLEN-1)      0873 02171000
*              THEN                                                0873 02172000
*                                                                  0873 02173000
         L     @15,@PC00001+8                                      0873 02174000
         L     @01,REPBUFF1(,@15)                                  0873 02175000
         CLI   RB2CKL(@01),0                                       0873 02176000
         BE    @RT00873                                            0873 02177000
         L     @15,@PC00001+8                                      0873 02178000
         L     @01,REPBUFF1(,@15)                                  0873 02179000
         L     @15,@PC00001+4                                      0873 02180000
         L     @15,FDTPTR+472(,@15)                                0873 02181000
         L     @14,@PC00001+4                                      0873 02182000
         L     @14,FDTPTR+476(,@14)                                0873 02183000
         SLR   @00,@00                                             0873 02184000
         IC    @00,MNKSTLEN(,@14)                                  0873 02185000
         AL    @00,MNKOFVAL(,@15)                                  0873 02186000
         BCTR  @00,0                                               0873 02187000
         SLR   @15,@15                                             0873 02188000
         IC    @15,RB2CKL(,@01)                                    0873 02189000
         CR    @00,@15                                             0873 02190000
         BNH   @RF00873                                            0873 02191000
@RT00873 DS    0H                                                  0874 02192000
*                /****************************************************/ 02193000
*                /*                                                  */ 02194000
*                /* KEY FIELD WILL EXPAND                            */ 02195000
*                /*                                                  */ 02196000
*                /****************************************************/ 02197000
*                RWF2CKL = MNKOFVAL+MNKSTLEN - 1;                  0874 02198000
         L     @15,@PC00001+8                                      0874 02199000
         L     @01,REPBUFF0(,@15)                                  0874 02200000
         L     @15,@PC00001+4                                      0874 02201000
         L     @15,FDTPTR+472(,@15)                                0874 02202000
         L     @14,@PC00001+4                                      0874 02203000
         L     @14,FDTPTR+476(,@14)                                0874 02204000
         SLR   @00,@00                                             0874 02205000
         IC    @00,MNKSTLEN(,@14)                                  0874 02206000
         AL    @00,MNKOFVAL(,@15)                                  0874 02207000
         BCTR  @00,0                                               0874 02208000
         STC   @00,RWF2CKL(,@01)                                   0874 02209000
*              ELSE;                                               0875 02210000
*                                                                  0875 02211000
@RF00873 DS    0H                                                  0876 02212000
*            /********************************************************/ 02213000
*            /*                                                      */ 02214000
*            /* NOW MOVE THE KEY INPUT STRING                        */ 02215000
*            /*                                                      */ 02216000
*            /********************************************************/ 02217000
*            RWF2KD(MNKOFVAL:(MNKSTLEN+MNKOFVAL-1)) = MNKSTVAL;    0876 02218000
*                                                                  0876 02219000
         L     @15,@PC00001+4                                      0876 02220000
         L     @01,FDTPTR+472(,@15)                                0876 02221000
         L     @01,MNKOFVAL(,@01)                                  0876 02222000
         L     @15,@PC00001+8                                      0876 02223000
         L     @15,REPBUFF0(,@15)                                  0876 02224000
         ALR   @15,@01                                             0876 02225000
         L     @14,@PC00001+4                                      0876 02226000
         L     @01,FDTPTR+476(,@14)                                0876 02227000
         L     @14,@PC00001+4                                      0876 02228000
         L     @14,FDTPTR+472(,@14)                                0876 02229000
         SLR   @05,@05                                             0876 02230000
         IC    @05,MNKSTLEN(,@01)                                  0876 02231000
         AL    @05,MNKOFVAL(,@14)                                  0876 02232000
         L     @14,@PC00001+4                                      0876 02233000
         L     @01,FDTPTR+472(,@14)                                0876 02234000
         SL    @05,MNKOFVAL(,@01)                                  0876 02235000
         BCTR  @05,0                                               0876 02236000
         L     @14,@PC00001+4                                      0876 02237000
         L     @01,FDTPTR+476(,@14)                                0876 02238000
         EX    @05,@SM02158                                        0876 02239000
*            /********************************************************/ 02240000
*            /*                                                      */ 02241000
*            /* CHECK THAT THE RECORD UPDATED WITH THE NEW KEY IN NOT*/ 02242000
*            /*  LARGER THAN THE REPAIR WORKFILE MAXIMUN RECORD SIZE,*/ 02243000
*            /*  WHICH IS THE ORIGINAL RECORD DEVICE TRACK CAPACITY  */ 02244000
*            /*                                                      */ 02245000
*            /********************************************************/ 02246000
*            IF (REPR1LN+(RWF2CKL-RB2CKL))> REPORWIO->IOCTRN       0877 02247000
*              THEN                                                0877 02248000
         L     @15,@PC00001+8                                      0877 02249000
         L     @14,@PC00001+8                                      0877 02250000
         L     @01,REPBUFF0(,@14)                                  0877 02251000
         L     @14,@PC00001+8                                      0877 02252000
         L     @14,REPBUFF1(,@14)                                  0877 02253000
         SLR   @00,@00                                             0877 02254000
         IC    @00,RWF2CKL(,@01)                                   0877 02255000
         SLR   @01,@01                                             0877 02256000
         IC    @01,RB2CKL(,@14)                                    0877 02257000
         SLR   @00,@01                                             0877 02258000
         LH    @01,REPR1LN(,@15)                                   0877 02259000
         N     @01,@CF02153                                        0877 02260000
         ALR   @00,@01                                             0877 02261000
         L     @01,@PC00001+8                                      0877 02262000
         L     @01,REPORWIO(,@01)                                  0877 02263000
         C     @00,IOCTRN(,@01)                                    0877 02264000
         BNH   @RF00877                                            0877 02265000
*                DO;                                               0878 02266000
*                                                                  0878 02267000
*                /****************************************************/ 02268000
*                /*  RECORD IS TOO LONG.  ISSUE MESSAGE IDC31232     */ 02269000
*                /****************************************************/ 02270000
*                                                                  0879 02271000
*                 DO;                                              0879 02272000
*                   CKREQ = CKREQ && CKREQ;                        0880 02273000
         L     @15,@PC00001+8                                      0880 02274000
         XC    CKREQ(44,@15),CKREQ(@15)                            0880 02275000
*                   CKRERN = MSG32;                                0881 02276000
         L     @15,@PC00001+8                                      0881 02277000
         MVC   CKRERN(2,@15),@CH00223                              0881 02278000
*                   CKRMVAR(1) = ADDR(RWFDANA);                    0882 02279000
         L     @15,@PC00001+8                                      0882 02280000
         L     @14,RWFPTR1                                         0882 02281000
         ST    @14,CKRMVAR(,@15)                                   0882 02282000
*                   CALL IDCRDER;                                  0883 02283000
         L     @15,@CV01811                                        0883 02284000
         BALR  @14,@15                                             0883 02285000
*                 END;                                             0884 02286000
*                RETURN CODE(LASTCC12);                            0885 02287000
         LA    @15,12                                              0885 02288000
         L     @14,@SA00003                                        0885 02289000
         LM    @00,@12,@SA00003+8                                  0885 02290000
         BR    @14                                                 0885 02291000
*                END;                                              0886 02292000
*              ELSE;                                               0887 02293000
*                                                                  0887 02294000
@RF00877 DS    0H                                                  0888 02295000
*            /********************************************************/ 02296000
*            /* END OF NEWKEY                                        */ 02297000
*            /********************************************************/ 02298000
*            END;                                                  0888 02299000
*                                                                  0888 02300000
*            /********************************************************/ 02301000
*            /*                                                      */ 02302000
*            /* MOVE THE DATA TO RWF2KD+RWF2CKL                      */ 02303000
*            /*                                                      */ 02304000
*            /********************************************************/ 02305000
*            TARPTR = ADDR(RWF2KD) + RWF2CKL;                      0889 02306000
@RF00860 L     @15,@PC00001+8                                      0889 02307000
         L     @01,REPBUFF0(,@15)                                  0889 02308000
         LA    @15,RWF2KD(,@01)                                    0889 02309000
         L     @14,@PC00001+8                                      0889 02310000
         L     @01,REPBUFF0(,@14)                                  0889 02311000
         SLR   @14,@14                                             0889 02312000
         IC    @14,RWF2CKL(,@01)                                   0889 02313000
         ALR   @15,@14                                             0889 02314000
         ST    @15,TARPTR                                          0889 02315000
*            SOURPTR = ADDR(RB2KD) + RB2CKL;                       0890 02316000
*                                                                  0890 02317000
         L     @15,@PC00001+8                                      0890 02318000
         L     @01,REPBUFF1(,@15)                                  0890 02319000
         LA    @15,RB2KD(,@01)                                     0890 02320000
         L     @14,@PC00001+8                                      0890 02321000
         L     @01,REPBUFF1(,@14)                                  0890 02322000
         SLR   @14,@14                                             0890 02323000
         IC    @14,RB2CKL(,@01)                                    0890 02324000
         ALR   @15,@14                                             0890 02325000
         ST    @15,SOURPTR                                         0890 02326000
*             RFY (REG2,REG3,REG4,REG5) RSTD;                      0891 02327000
*             REG2 = TARPTR;                                       0892 02328000
         L     REG2,TARPTR                                         0892 02329000
*             REG3 = RB2CDL;                                       0893 02330000
         L     @15,@PC00001+8                                      0893 02331000
         L     @01,REPBUFF1(,@15)                                  0893 02332000
         LH    REG3,RB2CDL(,@01)                                   0893 02333000
         N     REG3,@CF02153                                       0893 02334000
*             REG4 = SOURPTR;                                      0894 02335000
         L     REG4,SOURPTR                                        0894 02336000
*             REG5 = RB2CDL;                                       0895 02337000
         L     @15,@PC00001+8                                      0895 02338000
         L     @01,REPBUFF1(,@15)                                  0895 02339000
         LH    REG5,RB2CDL(,@01)                                   0895 02340000
         N     REG5,@CF02153                                       0895 02341000
*             MVCL (REG2,REG4);                                    0896 02342000
         MVCL  REG2,REG4                                           0896 02343000
*             RFY(REG2,REG3,REG4,REG5) UNRSTD;                     0897 02344000
*            /********************************************************/ 02345000
*            /*                                                      */ 02346000
*            /* CHECK IS NEWDATA KEYWORD PRESENT                     */ 02347000
*            /*                                                      */ 02348000
*            /********************************************************/ 02349000
*            IF ADDR(MNDAT) ^= NULLPTR                             0898 02350000
*              THEN                                                0898 02351000
*                                                                  0898 02352000
         L     @15,@PC00001+4                                      0898 02353000
         L     @15,FDTPTR+360(,@15)                                0898 02354000
         LTR   @15,@15                                             0898 02355000
         BZ    @RF00898                                            0898 02356000
*                /****************************************************/ 02357000
*                /*                                                  */ 02358000
*                /* CHECK THAT THE NEWDATA OFFSET IS NOT             */ 02359000
*                /*  LARGER THAN THE CURRENT DATA LENGTH + 1         */ 02360000
*                /*                                                  */ 02361000
*                /****************************************************/ 02362000
*                DO;                                               0899 02363000
*                IF MNDOFVAL > RB2CDL + 1                          0900 02364000
*                  THEN                                            0900 02365000
*                                                                  0900 02366000
         L     @15,@PC00001+4                                      0900 02367000
         L     @01,FDTPTR+464(,@15)                                0900 02368000
         L     @15,@PC00001+8                                      0900 02369000
         L     @15,REPBUFF1(,@15)                                  0900 02370000
         LA    @14,1                                               0900 02371000
         LH    @15,RB2CDL(,@15)                                    0900 02372000
         N     @15,@CF02153                                        0900 02373000
         ALR   @14,@15                                             0900 02374000
         C     @14,MNDOFVAL(,@01)                                  0900 02375000
         BNL   @RF00900                                            0900 02376000
*                   /*************************************************/ 02377000
*                   /*NEWDATA OFFSET OUTSIDE DATA FIELD. ISSUE       */ 02378000
*                   /* MESSAGE IDC31230I                             */ 02379000
*                   /*************************************************/ 02380000
*                    DO;                                           0901 02381000
*                                                                  0901 02382000
*                     DO;                                          0902 02383000
*                       CKREQ = CKREQ && CKREQ;                    0903 02384000
         L     @15,@PC00001+8                                      0903 02385000
         XC    CKREQ(44,@15),CKREQ(@15)                            0903 02386000
*                       CKRERN = MSG30;                            0904 02387000
         L     @15,@PC00001+8                                      0904 02388000
         MVC   CKRERN(2,@15),@CH00698                              0904 02389000
*                       CKRMVAR(1) = ADDR(MNDOFVAL);               0905 02390000
         L     @15,@PC00001+8                                      0905 02391000
         L     @14,@PC00001+4                                      0905 02392000
         L     @14,FDTPTR+464(,@14)                                0905 02393000
         ST    @14,CKRMVAR(,@15)                                   0905 02394000
*                       CALL IDCRDER;                              0906 02395000
         L     @15,@CV01811                                        0906 02396000
         BALR  @14,@15                                             0906 02397000
*                     END;                                         0907 02398000
*                    RETURN CODE(LASTCC12);                        0908 02399000
         LA    @15,12                                              0908 02400000
         L     @14,@SA00003                                        0908 02401000
         LM    @00,@12,@SA00003+8                                  0908 02402000
         BR    @14                                                 0908 02403000
*                    END;                                          0909 02404000
*                  ELSE;                                           0910 02405000
*                                                                  0910 02406000
@RF00900 DS    0H                                                  0911 02407000
*                /****************************************************/ 02408000
*                /*                                                  */ 02409000
*                /* CHECK IF DATA FIELD WILL INCREASE                */ 02410000
*                /*                                                  */ 02411000
*                /****************************************************/ 02412000
*                IF RB2CDL<(MNDOFVAL+MNDSTLEN-1)                   0911 02413000
*                  THEN                                            0911 02414000
*                                                                  0911 02415000
         L     @15,@PC00001+8                                      0911 02416000
         L     @01,REPBUFF1(,@15)                                  0911 02417000
         L     @15,@PC00001+4                                      0911 02418000
         L     @15,FDTPTR+464(,@15)                                0911 02419000
         L     @14,@PC00001+4                                      0911 02420000
         L     @14,FDTPTR+468(,@14)                                0911 02421000
         SLR   @00,@00                                             0911 02422000
         IC    @00,MNDSTLEN(,@14)                                  0911 02423000
         AL    @00,MNDOFVAL(,@15)                                  0911 02424000
         BCTR  @00,0                                               0911 02425000
         LH    @01,RB2CDL(,@01)                                    0911 02426000
         N     @01,@CF02153                                        0911 02427000
         CR    @00,@01                                             0911 02428000
         BNH   @RF00911                                            0911 02429000
*                    /************************************************/ 02430000
*                    /* DATA LENGTH WILL INCREASE                    */ 02431000
*                    /* CHECK IF THE RECORD UPDATED WITH THE NEWDATA */ 02432000
*                    /*  PARAMETER IS NOT LARGER THAN THE REPAIR     */ 02433000
*                    /*  WORKFILE RECORD MAXIMUN SIZE, WHICH IS THE  */ 02434000
*                    /*  ORIGINAL RECORD DEVICE TRACK CAPACITY       */ 02435000
*                    /*                                              */ 02436000
*                    /************************************************/ 02437000
*                    DO;                                           0912 02438000
*                    NEWLN= KEYFLGLN + COUNTLN + RWF2CKL + MNDOFVAL     02439000
*                         + MNDSTLEN - 1;                          0913 02440000
         L     @15,@PC00001+8                                      0913 02441000
         L     @01,REPBUFF0(,@15)                                  0913 02442000
         LA    @00,24                                              0913 02443000
         SLR   @15,@15                                             0913 02444000
         IC    @15,RWF2CKL(,@01)                                   0913 02445000
         ALR   @00,@15                                             0913 02446000
         L     @01,@PC00001+4                                      0913 02447000
         L     @01,FDTPTR+464(,@01)                                0913 02448000
         AL    @00,MNDOFVAL(,@01)                                  0913 02449000
         L     @01,@PC00001+4                                      0913 02450000
         L     @01,FDTPTR+468(,@01)                                0913 02451000
         SLR   @15,@15                                             0913 02452000
         IC    @15,MNDSTLEN(,@01)                                  0913 02453000
         ALR   @00,@15                                             0913 02454000
         BCTR  @00,0                                               0913 02455000
         STH   @00,NEWLN                                           0913 02456000
*                    IF NEWLN > REPORWIO->IOCTRN                   0914 02457000
*                      THEN                                        0914 02458000
*                                                                  0914 02459000
         L     @15,@PC00001+8                                      0914 02460000
         L     @01,REPORWIO(,@15)                                  0914 02461000
         LH    @00,NEWLN                                           0914 02462000
         N     @00,@CF02153                                        0914 02463000
         C     @00,IOCTRN(,@01)                                    0914 02464000
         BNH   @RF00914                                            0914 02465000
*                        /********************************************/ 02466000
*                        /* NEWDATA TOO LONG. ISSUE MESSAGE IDC31232I*/ 02467000
*                        /********************************************/ 02468000
*                        DO;                                       0915 02469000
*                                                                  0915 02470000
*                         DO;                                      0916 02471000
*                           CKREQ = CKREQ && CKREQ;                0917 02472000
         L     @15,@PC00001+8                                      0917 02473000
         XC    CKREQ(44,@15),CKREQ(@15)                            0917 02474000
*                           CKRERN = MSG32;                        0918 02475000
         L     @15,@PC00001+8                                      0918 02476000
         MVC   CKRERN(2,@15),@CH00223                              0918 02477000
*                           CKRMVAR(1) = ADDR(RWFDANA);            0919 02478000
         L     @15,@PC00001+8                                      0919 02479000
         L     @14,RWFPTR1                                         0919 02480000
         ST    @14,CKRMVAR(,@15)                                   0919 02481000
*                           CALL IDCRDER;                          0920 02482000
         L     @15,@CV01811                                        0920 02483000
         BALR  @14,@15                                             0920 02484000
*                         END;                                     0921 02485000
*                        RETURN CODE(LASTCC12);                    0922 02486000
         LA    @15,12                                              0922 02487000
         L     @14,@SA00003                                        0922 02488000
         LM    @00,@12,@SA00003+8                                  0922 02489000
         BR    @14                                                 0922 02490000
*                        END;                                      0923 02491000
*                      ELSE;                                       0924 02492000
*                                                                  0924 02493000
@RF00914 DS    0H                                                  0925 02494000
*                        /********************************************/ 02495000
*                        /*                                          */ 02496000
*                        /* RESET DATA LENGTH TO NEW DATA LENGTH     */ 02497000
*                        /*                                          */ 02498000
*                        /********************************************/ 02499000
*                        RWF2CDL = MNDOFVAL + MNDSTLEN - 1;        0925 02500000
*                                                                  0925 02501000
         L     @15,@PC00001+8                                      0925 02502000
         L     @01,REPBUFF0(,@15)                                  0925 02503000
         L     @15,@PC00001+4                                      0925 02504000
         L     @15,FDTPTR+464(,@15)                                0925 02505000
         L     @14,@PC00001+4                                      0925 02506000
         L     @14,FDTPTR+468(,@14)                                0925 02507000
         SLR   @00,@00                                             0925 02508000
         IC    @00,MNDSTLEN(,@14)                                  0925 02509000
         AL    @00,MNDOFVAL(,@15)                                  0925 02510000
         BCTR  @00,0                                               0925 02511000
         STH   @00,RWF2CDL(,@01)                                   0925 02512000
*                    END;                                          0926 02513000
*                                                                  0926 02514000
*                  ELSE;                                           0927 02515000
*                                                                  0927 02516000
@RF00911 DS    0H                                                  0928 02517000
*                /****************************************************/ 02518000
*                /*                                                  */ 02519000
*                /* MOVE DATA INPUT STRING                           */ 02520000
*                /*                                                  */ 02521000
*                /****************************************************/ 02522000
*                RWF2KD((RWF2CKL+MNDOFVAL):(MNDOFVAL+RWF2CKL       0928 02523000
*                               +MNDSTLEN-1))=MNDSTVAL;            0928 02524000
         L     @15,@PC00001+8                                      0928 02525000
         L     @01,REPBUFF0(,@15)                                  0928 02526000
         L     @15,@PC00001+4                                      0928 02527000
         L     @15,FDTPTR+464(,@15)                                0928 02528000
         SLR   @14,@14                                             0928 02529000
         IC    @14,RWF2CKL(,@01)                                   0928 02530000
         AL    @14,MNDOFVAL(,@15)                                  0928 02531000
         L     @15,@PC00001+8                                      0928 02532000
         L     @01,REPBUFF0(,@15)                                  0928 02533000
         ALR   @01,@14                                             0928 02534000
         L     @15,@PC00001+4                                      0928 02535000
         L     @15,FDTPTR+464(,@15)                                0928 02536000
         L     @14,@PC00001+8                                      0928 02537000
         L     @14,REPBUFF0(,@14)                                  0928 02538000
         SLR   @05,@05                                             0928 02539000
         IC    @05,RWF2CKL(,@14)                                   0928 02540000
         AL    @05,MNDOFVAL(,@15)                                  0928 02541000
         L     @04,@PC00001+4                                      0928 02542000
         L     @04,FDTPTR+468(,@04)                                0928 02543000
         SLR   @15,@15                                             0928 02544000
         IC    @15,MNDSTLEN(,@04)                                  0928 02545000
         ALR   @05,@15                                             0928 02546000
         L     @04,@PC00001+8                                      0928 02547000
         L     @04,REPBUFF0(,@04)                                  0928 02548000
         L     @15,@PC00001+4                                      0928 02549000
         L     @15,FDTPTR+464(,@15)                                0928 02550000
         SLR   @14,@14                                             0928 02551000
         IC    @14,RWF2CKL(,@04)                                   0928 02552000
         AL    @14,MNDOFVAL(,@15)                                  0928 02553000
         SLR   @05,@14                                             0928 02554000
         BCTR  @05,0                                               0928 02555000
         L     @04,@PC00001+4                                      0928 02556000
         L     @04,FDTPTR+468(,@04)                                0928 02557000
         EX    @05,@SM02160                                        0928 02558000
*                END;                                              0929 02559000
*              ELSE;                                               0930 02560000
*                                                                  0930 02561000
@RF00898 DS    0H                                                  0931 02562000
*              /******************************************************/ 02563000
*              /*                                                    */ 02564000
*              /* UPDATE THE RECORD                                  */ 02565000
*              /*                                                    */ 02566000
*              /******************************************************/ 02567000
*              WFIODAD = ADDR(RWF2);                               0931 02568000
         L     @15,@PC00001+8                                      0931 02569000
         L     @14,@PC00001+8                                      0931 02570000
         L     @14,REPBUFF0(,@14)                                  0931 02571000
         ST    @14,WFIODAD(,@15)                                   0931 02572000
*              WFIODLN = KEYFLGLN + COUNTLN + RWF2CKL+RWF2CDL;     0932 02573000
*                                                                  0932 02574000
         L     @15,@PC00001+8                                      0932 02575000
         L     @14,@PC00001+8                                      0932 02576000
         L     @01,REPBUFF0(,@14)                                  0932 02577000
         LA    @14,24                                              0932 02578000
         SLR   @00,@00                                             0932 02579000
         IC    @00,RWF2CKL(,@01)                                   0932 02580000
         ALR   @14,@00                                             0932 02581000
         L     @05,@PC00001+8                                      0932 02582000
         L     @01,REPBUFF0(,@05)                                  0932 02583000
         LH    @05,RWF2CDL(,@01)                                   0932 02584000
         N     @05,@CF02153                                        0932 02585000
         ALR   @14,@05                                             0932 02586000
         ST    @14,WFIODLN(,@15)                                   0932 02587000
*               DO;                                                0933 02588000
*                 WFREQ = ''B;                                     0934 02589000
         L     @15,@PC00001+8                                      0934 02590000
         XC    WFREQ(2,@15),WFREQ(@15)                             0934 02591000
*                 WFRUPD = ON;      /*  UPDRCD */                  0935 02592000
         L     @15,@PC00001+8                                      0935 02593000
         OI    WFRUPD(@15),B'00010000'                             0935 02594000
*                 WFRUP  = ON;      /* UPDATE */                   0936 02595000
         L     @15,@PC00001+8                                      0936 02596000
         OI    WFRUP(@15),B'01000000'                              0936 02597000
*                 CALL IDCRDIO;                                    0937 02598000
         L     @15,@CV01814                                        0937 02599000
         BALR  @14,@15                                             0937 02600000
*                 RFY RTNREG RSTD;                                 0938 02601000
*                 TESTRC = RTNREG;                                 0939 02602000
         STH   RTNREG,TESTRC                                       0939 02603000
*                 RFY RTNREG UNRSTD;                               0940 02604000
*               END;                                               0941 02605000
*              RETURN CODE(TESTRC);                                0942 02606000
         LH    @15,TESTRC                                          0942 02607000
         L     @14,@SA00003                                        0942 02608000
         LM    @00,@12,@SA00003+8                                  0942 02609000
         BR    @14                                                 0942 02610000
*END MODROUT;                                                      0943 02611000
*MODRNG:   PROCEDURE;                                              0944 02612000
MODRNG   STM   @14,@12,@SA00004                                    0944 02613000
*        /************************************************************/ 02614000
*        /*                                                          */ 02615000
*        /* SUBROUTINE NAME - MODRNG                                 */ 02616000
*        /*                                                          */ 02617000
*        /* FUNCTION -                                               */ 02618000
*        /*                                                          */ 02619000
*        /* THIS PROCEDURE WILL PROCESS THE MODIFY REQUEST WHEN      */ 02620000
*        /* INREPAIRRANGE IS PRESENT. THE INPUT RECORDS ARE IN A     */ 02621000
*        /* REPAIR WORK FILE AND MUST BE DEBLOCKED STAGE ERROR       */ 02622000
*        /* RECORDS.                                                 */ 02623000
*        /* THE MINIMUM NUMBER OF RECORDS TO BE MODIFIED IS A FULL   */ 02624000
*        /* TRACK AND THE MAXIMUM NUMBER IS A FULL CYLINDER.         */ 02625000
*        /*                                                          */ 02626000
*        /*                                                          */ 02627000
*        /* NOTES -                                                  */ 02628000
*        /*                                                          */ 02629000
*        /*    DEPENDENCIES - NONE                                   */ 02630000
*        /*                                                          */ 02631000
*        /*    RESTRICTIONS - GENERAL PURPOSE REGISTERS 7 AND 8      */ 02632000
*        /*                   MAY NOT BE USED BY THIS MODULE OR      */ 02633000
*        /*                   ANY OTHER REPAIRV MODULE AS THEY ARE   */ 02634000
*        /*                   DATA REGISTERS FOR MODULES IDCRD07     */ 02635000
*        /*                   AND IDCRD06 RESPECTIVELY               */ 02636000
*        /*                                                          */ 02637000
*        /*    REGISTER CONVENTIONS - SEE GLOBAL DATA AREA (AMSDF00) */ 02638000
*        /*                                                          */ 02639000
*        /*    PATCH LABEL - 'UPATCHIT'                              */ 02640000
*        /*                                                          */ 02641000
*        /* ENTRY POINT - MODRNG (ONLY ENTRY POINT)                  */ 02642000
*        /*                                                          */ 02643000
*        /*    PURPOSE - INVOKED TO PERFORM THE REPAIRV FSR          */ 02644000
*        /*    MODIFY  FUNCTION  WHEN THE INPUT IS A RANGE OF        */ 02645000
*        /*    RECORDS FROM A REPAIR WORKFILE                        */ 02646000
*        /*                                                          */ 02647000
*        /*    LINKAGE - 'CALL MODRNG'                               */ 02648000
*        /*                                                          */ 02649000
*        /*    INPUT -                                               */ 02650000
*        /*                                                          */ 02651000
*        /*      THE INPUT DATA CAN BE AS FOLLOWS.                   */ 02652000
*        /*       A) A RANGE OF DEBLOCKED RECORDS IN A REPAIR        */ 02653000
*        /*            WORKFILE                                      */ 02654000
*        /*                                                          */ 02655000
*        /*    OUTPUT -                                              */ 02656000
*        /*                                                          */ 02657000
*        /*      THE OUTPUT CAN BE AS FOLLOWS                        */ 02658000
*        /*       A) A RANGE OF MODIFIED RECORDS EITHER IN A DATA    */ 02659000
*        /*            SET OR VTOCHEADER                             */ 02660000
*        /*                                                          */ 02661000
*        /*      ERROR MESSAGES: IDC31213I                           */ 02662000
*        /*                      IDC31225I                           */ 02663000
*        /*                      IDC31226I                           */ 02664000
*        /*                      IDC31227I                           */ 02665000
*        /*                      IDC31228I                           */ 02666000
*        /*                      IDC31229I                           */ 02667000
*        /*                                                          */ 02668000
*        /*    EXIT, NORMAL -                                        */ 02669000
*        /*                                                          */ 02670000
*        /*      LASTCC = 00        FUNCTION COMPLETED SUCCESSFULLY  */ 02671000
*        /*                                                          */ 02672000
*        /*    EXIT, ERROR -                                         */ 02673000
*        /*                                                          */ 02674000
*        /*      LASTCC = 12        FUNCTION COULD NOT COMPLETE      */ 02675000
*        /*                                                          */ 02676000
*        /* INTERNAL REFERENCES -                                    */ 02677000
*        /*    PROCEDURES/SUBROUTINES CALLED                         */ 02678000
*        /*                                                          */ 02679000
*        /*    MODCLFP  - CLOSE FILES AND FREE POOLS SUBROUTINE      */ 02680000
*        /*                                                          */ 02681000
*        /* EXTERNAL REFERENCES -                                    */ 02682000
*        /*    MACROS/SVCS -                                         */ 02683000
*        /*                                                          */ 02684000
*        /*    UEXCP - IDCAMS SYSTEM ADAPTER EXCP ROUTINE            */ 02685000
*        /*      TO CLOSE, OPEN AND WRITE DATA SET OR VTOCHEADER     */ 02686000
*        /*      RECORDS                                             */ 02687000
*        /*      GENERATES A CALL TO MODULE IDCSADQO                 */ 02688000
*        /*                                                          */ 02689000
*        /*    ?GETRCD - REPAIRV GET RECORD ROUTINE                  */ 02690000
*        /*      READS RECORDS FROM THE REPAIR WORKFILE              */ 02691000
*        /*      GENERATES A CALL TO MODULE IDCRDIO                  */ 02692000
*        /*                                                          */ 02693000
*        /*    ?POSRCD - REPAIRV RECORD POSITIONING ROUTINE          */ 02694000
*        /*      POSITIONS TO FIRST RECORD IN REPAIRRANGE            */ 02695000
*        /*      GENERATES A CALL TO MODULE IDCRDIO                  */ 02696000
*        /*                                                          */ 02697000
*        /*    ?UPDRCD - REPAIRV RECORD UPDATE ROUTINE               */ 02698000
*        /*      UPDATES A RECORD IN A REPAIR WORKFILE               */ 02699000
*        /*      GENERATES A CALL TO MODULE IDCRDIO                  */ 02700000
*        /*                                                          */ 02701000
*        /*    ?CALLCKER - REPAIRV WRITE MESSAGE ROUTINE             */ 02702000
*        /*      WRITES ALL MESSAGES                                 */ 02703000
*        /*      GENERATES A CALL TO MODULE IDCRDER                  */ 02704000
*        /*                                                          */ 02705000
*        /* PROCEDURES/SUBROUTINES CALLED                            */ 02706000
*        /*                                                          */ 02707000
*        /*    IDCRDDS - TO OPEN THE INPUT DATA SET OR               */ 02708000
*        /*      VTOCHEADER AND OBTAIN BUFFER SPACE                  */ 02709000
*        /*                                                          */ 02710000
*        /*    IDCRDRF - TO OPEN THE REPAIR WORKFILE AND OBTAIN      */ 02711000
*        /*      BUFFER AREAS                                        */ 02712000
*        /*                                                          */ 02713000
*        /************************************************************/ 02714000
*                                                                  0945 02715000
*        /************************************************************/ 02716000
*        /*                                                          */ 02717000
*        /* SET DUMP POINT                                           */ 02718000
*        /*                                                          */ 02719000
*        /************************************************************/ 02720000
*        IF GDTDBG = NULLPTR                                       0945 02721000
*          THEN;                                                   0945 02722000
         L     @15,@PC00001                                        0945 02723000
         L     @15,GDTDBG(,@15)                                    0945 02724000
         LTR   @15,@15                                             0945 02725000
         BZ    @RT00945                                            0945 02726000
*          ELSE                                                    0947 02727000
*            CALL IDCDB010(GDTTBL,'RD58');                         0947 02728000
*                                                                  0947 02729000
         L     @15,@PC00001                                        0947 02730000
         ST    @15,@AL00001                                        0947 02731000
         LA    @15,@CC02093                                        0947 02732000
         ST    @15,@AL00001+4                                      0947 02733000
         MVI   @AL00001+4,X'80'                                    0947 02734000
         L     @14,@PC00001                                        0947 02735000
         L     @15,GDTDBG(,@14)                                    0947 02736000
         LA    @01,@AL00001                                        0947 02737000
         BALR  @14,@15                                             0947 02738000
*        /************************************************************/ 02739000
*        /*                                                          */ 02740000
*        /* SET TRACE POINT                                          */ 02741000
*        /*                                                          */ 02742000
*        /************************************************************/ 02743000
*        OLDERID2 = NEWERID2;                                      0948 02744000
@RT00945 L     @15,@PC00001                                        0948 02745000
         L     @01,GDTTR2(,@15)                                    0948 02746000
         L     @15,@PC00001                                        0948 02747000
         L     @15,GDTTR2(,@15)                                    0948 02748000
         MVC   @TS00001(95),NEWERID2(@15)                          0948 02749000
         MVC   OLDERID2(95,@01),@TS00001                           0948 02750000
*        NEWID2 = 'RD59';                                          0949 02751000
*                                                                  0949 02752000
         L     @15,@PC00001                                        0949 02753000
         L     @01,GDTTR2(,@15)                                    0949 02754000
         MVC   NEWID2(4,@01),@CC02094                              0949 02755000
*        /************************************************************/ 02756000
*        /* ZERO RECORDS PROCESSED COUNTER                           */ 02757000
*        /************************************************************/ 02758000
*        REPRCDCT = 0;                                             0950 02759000
*                                                                  0950 02760000
         L     @15,@PC00001+8                                      0950 02761000
         SLR   @14,@14                                             0950 02762000
         ST    @14,REPRCDCT(,@15)                                  0950 02763000
*        /************************************************************/ 02764000
*        /*                                                          */ 02765000
*        /* CALL IDCRDRF TO OPEN THE REPAIR WORKFILE AND OBTAIN      */ 02766000
*        /*  BUFFERS                                                 */ 02767000
*        /*                                                          */ 02768000
*        /************************************************************/ 02769000
*        CALL IDCRDRF(IN);                                         0951 02770000
         L     @15,@CV01813                                        0951 02771000
         LA    @01,@AL00951                                        0951 02772000
         BALR  @14,@15                                             0951 02773000
*        RESPECIFY RTNREG RSTD;                                    0952 02774000
*        TESTRC = RTNREG;                                          0953 02775000
         STH   RTNREG,TESTRC                                       0953 02776000
*        RESPECIFY RTNREG UNRSTD;                                  0954 02777000
*                                                                  0954 02778000
*        /************************************************************/ 02779000
*        /*                                                          */ 02780000
*        /* CHECK THE RETURN CODE FROM IDCRDRF.  IF RC ^= 0 THEN     */ 02781000
*        /*  RETURN WITH RC = 12                                     */ 02782000
*        /*                                                          */ 02783000
*        /************************************************************/ 02784000
*        IF TESTRC ^= 0                                            0955 02785000
*          THEN                                                    0955 02786000
*                                                                  0955 02787000
         LH    @15,TESTRC                                          0955 02788000
         LTR   @15,@15                                             0955 02789000
         BZ    @RF00955                                            0955 02790000
*            /********************************************************/ 02791000
*            /* BAD RETURN FROM IDCRDRF                              */ 02792000
*            /********************************************************/ 02793000
*            DO;                                                   0956 02794000
*            RETURN CODE(LASTCC12);                                0957 02795000
         LA    @15,12                                              0957 02796000
         L     @14,@SA00004                                        0957 02797000
         LM    @00,@12,@SA00004+8                                  0957 02798000
         BR    @14                                                 0957 02799000
*            END;                                                  0958 02800000
*          ELSE;                                                   0959 02801000
*                                                                  0959 02802000
@RF00955 DS    0H                                                  0960 02803000
*        /***********************************************************/  02804000
*        /*  SAVE REPIRWIO FOR CLOSE, AND SET ADDRRESSABILTY FOR DSN*/  02805000
*        /***********************************************************/  02806000
*        RWFPTR1= REPIRWIO-> IOCDSN;                               0960 02807000
*                                                                  0960 02808000
         L     @15,@PC00001+8                                      0960 02809000
         L     @01,REPIRWIO(,@15)                                  0960 02810000
         L     @15,IOCDSN(,@01)                                    0960 02811000
         ST    @15,RWFPTR1                                         0960 02812000
*        /************************************************************/ 02813000
*        /*                                                          */ 02814000
*        /* CK FIRST INPUT ADR SAME AS OUTPUT ADDRESS                */ 02815000
*        /*  MODKAD HAS OUTPUT ADDRESS                               */ 02816000
*        /*                                                          */ 02817000
*        /************************************************************/ 02818000
*        MIKAD6 = MRRVOVAL;                                        0961 02819000
         L     @15,@PC00001+4                                      0961 02820000
         L     @01,FDTPTR+452(,@15)                                0961 02821000
         MVC   MIKAD6(6),MRRVOVAL(@01)                             0961 02822000
*        MIKAD54= MRRCHVAL;                                        0962 02823000
         L     @15,@PC00001+4                                      0962 02824000
         L     @01,FDTPTR+456(,@15)                                0962 02825000
         MVC   MIKAD54(4),MRRCHVAL(@01)                            0962 02826000
*        MIKAD54R=ZERO;                                            0963 02827000
         MVI   MIKAD54R,X'00'                                      0963 02828000
*        IF MIKAD ^= MOKAD                                         0964 02829000
*          THEN                                                    0964 02830000
*                                                                  0964 02831000
         CLC   MIKAD(11),MOKAD                                     0964 02832000
         BE    @RF00964                                            0964 02833000
*            /********************************************************/ 02834000
*            /* FIRST INPUT ADDRESS NOT EQUAL TO OUTPUT ADDRESS      */ 02835000
*            /* ISSUE MESSAGE IDC31225I                              */ 02836000
*            /********************************************************/ 02837000
*            DO;                                                   0965 02838000
*                                                                  0965 02839000
*             DO;                                                  0966 02840000
*               CKREQ = CKREQ && CKREQ;                            0967 02841000
         L     @15,@PC00001+8                                      0967 02842000
         XC    CKREQ(44,@15),CKREQ(@15)                            0967 02843000
*               CKRERN = MSG25;                                    0968 02844000
         L     @15,@PC00001+8                                      0968 02845000
         MVC   CKRERN(2,@15),@CH00681                              0968 02846000
*               CKRMVAR(1) = ADDR(MOKAD6);                         0969 02847000
         L     @15,@PC00001+8                                      0969 02848000
         LA    @14,MOKAD6                                          0969 02849000
         ST    @14,CKRMVAR(,@15)                                   0969 02850000
*               CKRMVAR(2) = ADDR(MOKAD5);                         0970 02851000
         L     @15,@PC00001+8                                      0970 02852000
         LA    @14,MOKAD5                                          0970 02853000
         ST    @14,CKRMVAR+4(,@15)                                 0970 02854000
*               CKRMVAR(3) = ADDR(PARNA);                          0971 02855000
         L     @15,@PC00001+8                                      0971 02856000
         LA    @14,PARNA                                           0971 02857000
         ST    @14,CKRMVAR+8(,@15)                                 0971 02858000
*               CALL IDCRDER;                                      0972 02859000
         L     @15,@CV01811                                        0972 02860000
         BALR  @14,@15                                             0972 02861000
*             END;                                                 0973 02862000
*            RETURN CODE(LASTCC12);                                0974 02863000
         LA    @15,12                                              0974 02864000
         L     @14,@SA00004                                        0974 02865000
         LM    @00,@12,@SA00004+8                                  0974 02866000
         BR    @14                                                 0974 02867000
*            END;                                                  0975 02868000
*          ELSE;                                                   0976 02869000
*                                                                  0976 02870000
@RF00964 DS    0H                                                  0977 02871000
*        /************************************************************/ 02872000
*        /*                                                          */ 02873000
*        /* SET LAST ADDRESS   IN  MOKAD                             */ 02874000
*        /*                                                          */ 02875000
*        /************************************************************/ 02876000
*        IF ADDR(MRRHH) ^= NULLPTR                                 0977 02877000
*          THEN                                                    0977 02878000
         L     @15,@PC00001+4                                      0977 02879000
         L     @15,FDTPTR+460(,@15)                                0977 02880000
         LTR   @15,@15                                             0977 02881000
         BZ    @RF00977                                            0977 02882000
*            MOKAD5H = MRRHHVAL;                                   0978 02883000
         L     @15,@PC00001+4                                      0978 02884000
         L     @01,FDTPTR+460(,@15)                                0978 02885000
         MVC   MOKAD5H(2),MRRHHVAL(@01)                            0978 02886000
*          ELSE                                                    0979 02887000
*            MOKAD = MIKAD;                                        0979 02888000
*                                                                  0979 02889000
         B     @RC00977                                            0979 02890000
@RF00977 MVC   MOKAD(11),MIKAD                                     0979 02891000
*        /************************************************************/ 02892000
*        /*                                                          */ 02893000
*        /* CK LAST ADDR NOT LESS FIRST ADDRESS                      */ 02894000
*        /*                                                          */ 02895000
*        /************************************************************/ 02896000
*        IF MOKAD < MIKAD                                          0980 02897000
*          THEN                                                    0980 02898000
*                                                                  0980 02899000
@RC00977 CLC   MOKAD(11),MIKAD                                     0980 02900000
         BNL   @RF00980                                            0980 02901000
*            /********************************************************/ 02902000
*            /*  LAST (OUTPUT) ADDRESS IS LESS THAN FIRST( BEGINNING)*/ 02903000
*            /*   ADDRESS.   ISSUE MESSAGE IDC31213I                 */ 02904000
*            /********************************************************/ 02905000
*            DO;                                                   0981 02906000
*                                                                  0981 02907000
*             DO;                                                  0982 02908000
*               CKREQ = CKREQ && CKREQ;                            0983 02909000
         L     @15,@PC00001+8                                      0983 02910000
         XC    CKREQ(44,@15),CKREQ(@15)                            0983 02911000
*               CKRERN = MSG13;                                    0984 02912000
         L     @15,@PC00001+8                                      0984 02913000
         MVC   CKRERN(2,@15),@CH00612                              0984 02914000
*               CKRMVAR(1) = ADDR(MIKAD54H);                       0985 02915000
         L     @15,@PC00001+8                                      0985 02916000
         LA    @14,MIKAD54H                                        0985 02917000
         ST    @14,CKRMVAR(,@15)                                   0985 02918000
*               CKRMVAR(2) = ADDR(MOKAD5H);                        0986 02919000
         L     @15,@PC00001+8                                      0986 02920000
         LA    @14,MOKAD5H                                         0986 02921000
         ST    @14,CKRMVAR+4(,@15)                                 0986 02922000
*               CKRMVAR(3) = ADDR(INRRCON);                        0987 02923000
         L     @15,@PC00001+8                                      0987 02924000
         LA    @14,INRRCON                                         0987 02925000
         ST    @14,CKRMVAR+8(,@15)                                 0987 02926000
*               CKRMVAR(4) = ADDR(RWFDANA);                        0988 02927000
         L     @15,@PC00001+8                                      0988 02928000
         L     @14,RWFPTR1                                         0988 02929000
         ST    @14,CKRMVAR+12(,@15)                                0988 02930000
*               CALL IDCRDER;                                      0989 02931000
         L     @15,@CV01811                                        0989 02932000
         BALR  @14,@15                                             0989 02933000
*             END;                                                 0990 02934000
*            RETURN CODE(LASTCC12);                                0991 02935000
         LA    @15,12                                              0991 02936000
         L     @14,@SA00004                                        0991 02937000
         LM    @00,@12,@SA00004+8                                  0991 02938000
         BR    @14                                                 0991 02939000
*            END;                                                  0992 02940000
*          ELSE;                                                   0993 02941000
*                                                                  0993 02942000
@RF00980 DS    0H                                                  0994 02943000
*        /************************************************************/ 02944000
*        /* CALL IDCRDDS TO OPEN OUTPUT DATA SET OR VTOCHEADER AND   */ 02945000
*        /* OBTAIN BUFFERS, SET COMMON OUTPUT DSN OR                 */ 02946000
*        /* VTOCNAME AND SET ADDRESSABILITY FOR XTNTTBL              */ 02947000
*        /************************************************************/ 02948000
*        CALL IDCRDDS (OUT,MOKAD5);                                0994 02949000
         LA    @15,OUT                                             0994 02950000
         ST    @15,@AL00001                                        0994 02951000
         LA    @15,MOKAD5                                          0994 02952000
         ST    @15,@AL00001+4                                      0994 02953000
         L     @15,@CV01810                                        0994 02954000
         LA    @01,@AL00001                                        0994 02955000
         BALR  @14,@15                                             0994 02956000
*        RESPECIFY RTNREG RSTD;                                    0995 02957000
*        TESTRC = RTNREG;                                          0996 02958000
         STH   RTNREG,TESTRC                                       0996 02959000
*        RESPECIFY RTNREG UNRSTD;                                  0997 02960000
*                                                                  0997 02961000
*        /************************************************************/ 02962000
*        /*  CHECK THE RETURN CODE FROM IDCRDDS. IF THE RC ^= 0 THEN */ 02963000
*        /*   RETURN WITH RC = 12. SET REPENQSW = ZERO SO NO DEQUEUE */ 02964000
*        /*   IS ISSUED LATER.                                       */ 02965000
*        /************************************************************/ 02966000
*        IF TESTRC ^= 0                                            0998 02967000
*          THEN                                                    0998 02968000
         LH    @15,TESTRC                                          0998 02969000
         LTR   @15,@15                                             0998 02970000
         BZ    @RF00998                                            0998 02971000
*            DO;                                                   0999 02972000
*            REPENQSW = ZERO;                                      1000 02973000
         L     @15,@PC00001+8                                      1000 02974000
         MVI   REPENQSW(@15),X'00'                                 1000 02975000
*            RETURN CODE(LASTCC12);                                1001 02976000
         LA    @15,12                                              1001 02977000
         L     @14,@SA00004                                        1001 02978000
         LM    @00,@12,@SA00004+8                                  1001 02979000
         BR    @14                                                 1001 02980000
*            END;                                                  1002 02981000
*          ELSE                                                    1003 02982000
*        SAVCLOUT=REPODSOP;                                        1003 02983000
*                                                                  1003 02984000
@RF00998 L     @15,@PC00001+8                                      1003 02985000
         L     @15,REPODSOP(,@15)                                  1003 02986000
         ST    @15,SAVCLOUT                                        1003 02987000
*        /************************************************************/ 02988000
*        /*                                                          */ 02989000
*        /*               FOR  OUTPUT  DEVICE                        */ 02990000
*        /* CALCULATE DEVICE MAX TRACK CAPACITY CONSTANTS            */ 02991000
*        /* KYCNST (IN KYCNSTCH) HAS RECORD WITH KEY OVERHEAD        */ 02992000
*        /* NOKYCNST HAS RECORD WITHOUT KEY OVERHEAD                 */ 02993000
*        /* DEVTC HAS TRACK CAPACITY                                 */ 02994000
*        /* SUMKEY WILL LATER HAVE NUMBER OF RECORDS WITH KEY        */ 02995000
*        /* SUMNOKEY WILL LATER HAVE NUMBER OF RECORDS WITHOUT KEY   */ 02996000
*        /*                                                          */ 02997000
*        /************************************************************/ 02998000
*        RFY DEVAREA BASED(REPODEVA);                              1004 02999000
*                                                                  1004 03000000
*        /************************************************************/ 03001000
*        /*                                                          */ 03002000
*        /* CHECK IF THE KEY CONSTANT IN DEVICE TABLE IS ONE OR TWO  */ 03003000
*        /*  BYTES, ACCORDING TO THE VALUE OF INF4FLG                */ 03004000
*        /*                                                          */ 03005000
*        /************************************************************/ 03006000
*        IF INF4FLG = ON                                           1005 03007000
*          THEN                                                    1005 03008000
         L     @15,@PC00001+8                                      1005 03009000
         L     @01,REPODEVA(,@15)                                  1005 03010000
         TM    INF4FLG(@01),B'00001000'                            1005 03011000
         BNO   @RF01005                                            1005 03012000
*            KYCNSTCH = DEVBOH;                                    1006 03013000
         L     @15,@PC00001+8                                      1006 03014000
         L     @01,REPODEVA(,@15)                                  1006 03015000
         MVC   KYCNSTCH(2),DEVBOH(@01)                             1006 03016000
*          ELSE                                                    1007 03017000
*            KYCNST   = DEVBOH1;                                   1007 03018000
         B     @RC01005                                            1007 03019000
@RF01005 L     @15,@PC00001+8                                      1007 03020000
         L     @01,REPODEVA(,@15)                                  1007 03021000
         SLR   @00,@00                                             1007 03022000
         IC    @00,DEVBOH1(,@01)                                   1007 03023000
         STH   @00,KYCNST                                          1007 03024000
*        NOKYCNST = KYCNST - DEVKC;                                1008 03025000
@RC01005 L     @15,@PC00001+8                                      1008 03026000
         L     @01,REPODEVA(,@15)                                  1008 03027000
         LH    @00,KYCNST                                          1008 03028000
         N     @00,@CF02153                                        1008 03029000
         SLR   @15,@15                                             1008 03030000
         IC    @15,DEVKC(,@01)                                     1008 03031000
         SLR   @00,@15                                             1008 03032000
         STC   @00,NOKYCNST                                        1008 03033000
*        RFY XTNTTBL BASED(REPOXTNT);                              1009 03034000
*        RFY RDARG BASED (REPODSAR);                               1010 03035000
*                                                                  1010 03036000
*        /************************************************************/ 03037000
*        /*  CHECK IF THE VTOCHEADERADDRESS PARAMETER IS PRESENT     */ 03038000
*        /************************************************************/ 03039000
*        IF ADDR(MVTOC) ^= NULLPTR                                 1011 03040000
*          THEN                                                    1011 03041000
*                                                                  1011 03042000
         L     @15,@PC00001+4                                      1011 03043000
         L     @15,FDTPTR+424(,@15)                                1011 03044000
         LTR   @15,@15                                             1011 03045000
         BZ    @RF01011                                            1011 03046000
*            /********************************************************/ 03047000
*            /* VTOCHEADER ADDRESS  PARAMETER PRESENT                */ 03048000
*            /* SET VTOCHEADERADDRESS LITERAL FOR MESSAGES           */ 03049000
*            /********************************************************/ 03050000
*            DSNMSG = VTOCNAME;                                    1012 03051000
         MVI   DSNMSG+10,C' '                                      1012 03052000
         MVC   DSNMSG+11(33),DSNMSG+10                             1012 03053000
         MVC   DSNMSG(10),VTOCNAME                                 1012 03054000
*          ELSE                                                    1013 03055000
*                                                                  1013 03056000
*            /********************************************************/ 03057000
*            /* THE OUTPUT IS A DATA SET.  SET THE LITERAL FOR       */ 03058000
*            /*  MESSAGES TO THE DSNAME                              */ 03059000
*            /********************************************************/ 03060000
*            DSNMSG = XTNHDSN;                                     1013 03061000
*                                                                  1013 03062000
         B     @RC01011                                            1013 03063000
@RF01011 L     @15,@PC00001+8                                      1013 03064000
         L     @01,REPOXTNT(,@15)                                  1013 03065000
         MVC   DSNMSG(44),XTNHDSN(@01)                             1013 03066000
*        /************************************************************/ 03067000
*        /*                                                          */ 03068000
*        /* CK ALL TRACKS BETWEEN FIRST & LAST ADDRESS EXISTS        */ 03069000
*        /* FOR THE OUTPUT DATA EXTENT TABLE                         */ 03070000
*        /*                                                          */ 03071000
*        /************************************************************/ 03072000
*        SMIKAD5 = MIKAD5;                                         1014 03073000
@RC01011 MVC   SMIKAD5(5),MIKAD5                                   1014 03074000
*        ILOOP = 1;                                                1015 03075000
         MVC   ILOOP(2),@CH00221                                   1015 03076000
*        DO WHILE (XTNTCHR1(ILOOP) ^= LASTEXT & SMIKAD5 <= MOKAD5);     03077000
*                                                                  1016 03078000
         B     @DE01016                                            1016 03079000
@DL01016 DS    0H                                                  1017 03080000
*        /************************************************************/ 03081000
*        /*                                                          */ 03082000
*        /* CHECK THAT THE CURRENT FIRST ADDRESS IS >= THAN THE      */ 03083000
*        /*  CURRENT FIRST EXTENT TABLE ENTRY AND THAT IS ALSO <=    */ 03084000
*        /*  THAN THE CURRENT LAST EXTENT TABLE ENTRY                */ 03085000
*        /************************************************************/ 03086000
*        IF SMIKAD5 >= XTNTCHR1(ILOOP) & SMIKAD5 <= XTNTCHR2(ILOOP)     03087000
*          THEN                                                    1017 03088000
         LH    @15,ILOOP                                           1017 03089000
         N     @15,@CF02153                                        1017 03090000
         MH    @15,@CH02146                                        1017 03091000
         L     @14,@PC00001+8                                      1017 03092000
         L     @01,REPOXTNT(,@14)                                  1017 03093000
         ALR   @01,@15                                             1017 03094000
         CLC   SMIKAD5(5),XTNTCHR1-78(@01)                         1017 03095000
         BL    @RF01017                                            1017 03096000
         LH    @15,ILOOP                                           1017 03097000
         N     @15,@CF02153                                        1017 03098000
         MH    @15,@CH02146                                        1017 03099000
         L     @14,@PC00001+8                                      1017 03100000
         L     @01,REPOXTNT(,@14)                                  1017 03101000
         ALR   @01,@15                                             1017 03102000
         CLC   SMIKAD5(5),XTNTCHR2-78(@01)                         1017 03103000
         BH    @RF01017                                            1017 03104000
*            DO;                                                   1018 03105000
*            SMIHH = SMIHH + 1;                                    1019 03106000
         LA    @15,1                                               1019 03107000
         LH    @14,SMIHH                                           1019 03108000
         N     @14,@CF02153                                        1019 03109000
         ALR   @15,@14                                             1019 03110000
         STH   @15,SMIHH                                           1019 03111000
*            END;                                                  1020 03112000
*          ELSE                                                    1021 03113000
*            ILOOP = ILOOP + 1;                                    1021 03114000
         B     @RC01017                                            1021 03115000
@RF01017 LA    @15,1                                               1021 03116000
         LH    @14,ILOOP                                           1021 03117000
         N     @14,@CF02153                                        1021 03118000
         ALR   @15,@14                                             1021 03119000
         STH   @15,ILOOP                                           1021 03120000
*        END;                                                      1022 03121000
*                                                                  1022 03122000
@RC01017 DS    0H                                                  1022 03123000
@DE01016 LH    @15,ILOOP                                           1022 03124000
         N     @15,@CF02153                                        1022 03125000
         MH    @15,@CH02146                                        1022 03126000
         L     @14,@PC00001+8                                      1022 03127000
         L     @01,REPOXTNT(,@14)                                  1022 03128000
         ALR   @01,@15                                             1022 03129000
         CLC   XTNTCHR1-78(5,@01),LASTEXT                          1022 03130000
         BE    @DC01016                                            1022 03131000
         CLC   SMIKAD5(5),MOKAD5                                   1022 03132000
         BNH   @DL01016                                            1022 03133000
@DC01016 DS    0H                                                  1023 03134000
*        /************************************************************/ 03135000
*        /*                                                          */ 03136000
*        /* IF ALL TRACKS EXIST, XTNTCHR1 (ILOOP) IS NOT EQUAL TO    */ 03137000
*        /* LASTEXT ( ALL X'FF').                                    */ 03138000
*        /*                                                          */ 03139000
*        /************************************************************/ 03140000
*        IF XTNTCHR1(ILOOP) = LASTEXT                              1023 03141000
*          THEN                                                    1023 03142000
*                                                                  1023 03143000
         LH    @15,ILOOP                                           1023 03144000
         N     @15,@CF02153                                        1023 03145000
         MH    @15,@CH02146                                        1023 03146000
         L     @14,@PC00001+8                                      1023 03147000
         L     @01,REPOXTNT(,@14)                                  1023 03148000
         ALR   @01,@15                                             1023 03149000
         CLC   XTNTCHR1-78(5,@01),LASTEXT                          1023 03150000
         BNE   @RF01023                                            1023 03151000
*            /********************************************************/ 03152000
*            /* NOT ALL TRACKS EXIST.  ISSUE MESSAGE IDC31226I       */ 03153000
*            /********************************************************/ 03154000
*            DO;                                                   1024 03155000
*                                                                  1024 03156000
*             DO;                                                  1025 03157000
*               CKREQ = CKREQ && CKREQ;                            1026 03158000
         L     @15,@PC00001+8                                      1026 03159000
         XC    CKREQ(44,@15),CKREQ(@15)                            1026 03160000
*               CKRERN = MSG26;                                    1027 03161000
         L     @15,@PC00001+8                                      1027 03162000
         MVC   CKRERN(2,@15),@CH00685                              1027 03163000
*               CKRMVAR(1) = ADDR(DSNMSG);                         1028 03164000
         L     @15,@PC00001+8                                      1028 03165000
         LA    @14,DSNMSG                                          1028 03166000
         ST    @14,CKRMVAR(,@15)                                   1028 03167000
*               CALL IDCRDER;                                      1029 03168000
         L     @15,@CV01811                                        1029 03169000
         BALR  @14,@15                                             1029 03170000
*             END;                                                 1030 03171000
*            RETURN CODE(LASTCC12);                                1031 03172000
         LA    @15,12                                              1031 03173000
         L     @14,@SA00004                                        1031 03174000
         LM    @00,@12,@SA00004+8                                  1031 03175000
         BR    @14                                                 1031 03176000
*            END;                                                  1032 03177000
*          ELSE;                                                   1033 03178000
*                                                                  1033 03179000
@RF01023 DS    0H                                                  1034 03180000
*        /************************************************************/ 03181000
*        /*                                                          */ 03182000
*        /*  ALL TRACKS IN THE OUTPUT EXIST AS INDICATED BY          */ 03183000
*        /*  INREPAIRRANGE.                                          */ 03184000
*        /*                                                          */ 03185000
*        /************************************************************/ 03186000
*        SMIKAD5 = MIKAD5;                                         1034 03187000
         MVC   SMIKAD5(5),MIKAD5                                   1034 03188000
*        SMOKAD5 = MOKAD5;                                         1035 03189000
         MVC   SMOKAD5(5),MOKAD5                                   1035 03190000
*        XIND = 1;                                                 1036 03191000
         MVC   XIND(2),@CH00221                                    1036 03192000
*        RFY EXOARG BASED(REPEXOAR);                               1037 03193000
*        /************************************************************/ 03194000
*        /*                                                          */ 03195000
*        /* THIS IS THE MAIN LOOP TO PROCESS THE INPUT TRACKS.       */ 03196000
*        /* IF ANY ERROR OCCURS, MESSAGE IS ISSUED AND OUT.          */ 03197000
*        /*                                                          */ 03198000
*        /************************************************************/ 03199000
*        DO ILOOP = SMIHH TO SMOHH;                                1038 03200000
*                                                                  1038 03201000
         LH    @15,SMIHH                                           1038 03202000
         N     @15,@CF02153                                        1038 03203000
         B     @DE01038                                            1038 03204000
@DL01038 DS    0H                                                  1039 03205000
*        /************************************************************/ 03206000
*        /*                                                          */ 03207000
*        /*  CHECK IF EXTENT OPEN FOR ADDRESS SMIKADHH               */ 03208000
*        /*                                                          */ 03209000
*        /************************************************************/ 03210000
*        IF SMIKAD5 >= XTNTCHR1(XIND) & SMIKAD5 <= XTNTCHR2(XIND)  1039 03211000
*          THEN;                                                   1039 03212000
         LH    @15,XIND                                            1039 03213000
         N     @15,@CF02153                                        1039 03214000
         MH    @15,@CH02146                                        1039 03215000
         L     @14,@PC00001+8                                      1039 03216000
         L     @01,REPOXTNT(,@14)                                  1039 03217000
         ALR   @01,@15                                             1039 03218000
         CLC   SMIKAD5(5),XTNTCHR1-78(@01)                         1039 03219000
         BL    @RF01039                                            1039 03220000
         LH    @15,XIND                                            1039 03221000
         N     @15,@CF02153                                        1039 03222000
         MH    @15,@CH02146                                        1039 03223000
         L     @14,@PC00001+8                                      1039 03224000
         L     @01,REPOXTNT(,@14)                                  1039 03225000
         ALR   @01,@15                                             1039 03226000
         CLC   SMIKAD5(5),XTNTCHR2-78(@01)                         1039 03227000
         BNH   @RT01039                                            1039 03228000
*          ELSE                                                    1041 03229000
*                                                                  1041 03230000
*            /********************************************************/ 03231000
*            /*                                                      */ 03232000
*            /* CLOSE CURRENT EXTENT AND OPEN NEXT EXTENT            */ 03233000
*            /*                                                      */ 03234000
*            /********************************************************/ 03235000
*            DO;                                                   1041 03236000
@RF01039 DS    0H                                                  1042 03237000
*            CALL IDCIO050(GDTTBL,CLOSE,REPODSOP);                 1042 03238000
         L     @15,@PC00001                                        1042 03239000
         ST    @15,@AL00001                                        1042 03240000
         LA    @15,CLOSE                                           1042 03241000
         ST    @15,@AL00001+4                                      1042 03242000
         L     @15,@PC00001+8                                      1042 03243000
         LA    @15,REPODSOP(,@15)                                  1042 03244000
         ST    @15,@AL00001+8                                      1042 03245000
         MVI   @AL00001+8,X'80'                                    1042 03246000
         L     @14,@PC00001                                        1042 03247000
         L     @15,GDTEXP(,@14)                                    1042 03248000
         LA    @01,@AL00001                                        1042 03249000
         BALR  @14,@15                                             1042 03250000
*            XIND = XIND+1;                                        1043 03251000
         LA    @15,1                                               1043 03252000
         LH    @14,XIND                                            1043 03253000
         N     @14,@CF02153                                        1043 03254000
         ALR   @15,@14                                             1043 03255000
         STH   @15,XIND                                            1043 03256000
*            EXOEXT = ADDR(XTNTCHR1(XIND));                        1044 03257000
         L     @15,@PC00001+8                                      1044 03258000
         L     @01,REPEXOAR(,@15)                                  1044 03259000
         LH    @15,XIND                                            1044 03260000
         N     @15,@CF02153                                        1044 03261000
         MH    @15,@CH02146                                        1044 03262000
         L     @14,@PC00001+8                                      1044 03263000
         L     @14,REPOXTNT(,@14)                                  1044 03264000
         LA    @00,XTNTCHR1-78(@15,@14)                            1044 03265000
         ST    @00,EXOEXT(,@01)                                    1044 03266000
*            CALL IDCIO050(GDTTBL,OPENR,EXOARG);                   1045 03267000
         L     @15,@PC00001                                        1045 03268000
         ST    @15,@AL00001                                        1045 03269000
         LA    @15,OPENR                                           1045 03270000
         ST    @15,@AL00001+4                                      1045 03271000
         L     @15,@PC00001+8                                      1045 03272000
         L     @01,REPEXOAR(,@15)                                  1045 03273000
         ST    @01,@AL00001+8                                      1045 03274000
         MVI   @AL00001+8,X'80'                                    1045 03275000
         L     @14,@PC00001                                        1045 03276000
         L     @15,GDTEXP(,@14)                                    1045 03277000
         LA    @01,@AL00001                                        1045 03278000
         BALR  @14,@15                                             1045 03279000
*            RESPECIFY RTNREG RSTD;                                1046 03280000
*            TESTRC = RTNREG;                                      1047 03281000
         STH   RTNREG,TESTRC                                       1047 03282000
*            RESPECIFY RTNREG UNRSTD;                              1048 03283000
*                                                                  1048 03284000
*            /********************************************************/ 03285000
*            /* CHECK THE RC FROM UEXCP OPEN.  IF THE RC ^= 0 THEN   */ 03286000
*            /*  RETURN WITH RC = 12                                 */ 03287000
*            /********************************************************/ 03288000
*            IF TESTRC ^= 0                                        1049 03289000
*              THEN                                                1049 03290000
*                                                                  1049 03291000
         LH    @15,TESTRC                                          1049 03292000
         LTR   @15,@15                                             1049 03293000
         BZ    @RF01049                                            1049 03294000
*                /****************************************************/ 03295000
*                /*  BAD RC FROM UEXCP OPEN.  GET OUT                */ 03296000
*                /****************************************************/ 03297000
*                DO;                                               1050 03298000
*                RETURN CODE(LASTCC12);                            1051 03299000
         LA    @15,12                                              1051 03300000
         L     @14,@SA00004                                        1051 03301000
         LM    @00,@12,@SA00004+8                                  1051 03302000
         BR    @14                                                 1051 03303000
*                END;                                              1052 03304000
*              ELSE;                                               1053 03305000
@RF01049 DS    0H                                                  1054 03306000
*            END;                                                  1054 03307000
*                                                                  1054 03308000
*        /************************************************************/ 03309000
*        /*                                                          */ 03310000
*        /*  CONTINUE  EXTENT IS OK                                  */ 03311000
*        /*  POSTION FOR FIRST RECORD IN REPAIR WORKFILE TRACK       */ 03312000
*        /*                                                          */ 03313000
*        /************************************************************/ 03314000
*        WFIOKYA =ADDR(MIKAD);                                     1055 03315000
*                                                                  1055 03316000
@RT01039 L     @15,@PC00001+8                                      1055 03317000
         LA    @14,MIKAD                                           1055 03318000
         ST    @14,WFIOKYA(,@15)                                   1055 03319000
*         DO;                                                      1056 03320000
*           WFREQ = ''B;                                           1057 03321000
         L     @15,@PC00001+8                                      1057 03322000
         XC    WFREQ(2,@15),WFREQ(@15)                             1057 03323000
*           WFRPOS = ON;      /*  POSRCD */                        1058 03324000
         L     @15,@PC00001+8                                      1058 03325000
         OI    WFRPOS(@15),B'00001000'                             1058 03326000
*           WFRIN  = ON;      /* INPUT DS */                       1059 03327000
         L     @15,@PC00001+8                                      1059 03328000
         OI    WFRIN(@15),B'10000000'                              1059 03329000
*           CALL IDCRDIO;                                          1060 03330000
         L     @15,@CV01814                                        1060 03331000
         BALR  @14,@15                                             1060 03332000
*           RFY RTNREG RSTD;                                       1061 03333000
*           TESTRC = RTNREG;                                       1062 03334000
         STH   RTNREG,TESTRC                                       1062 03335000
*           RFY RTNREG UNRSTD;                                     1063 03336000
*         END;                                                     1064 03337000
*                                                                  1064 03338000
*        /************************************************************/ 03339000
*        /*                                                          */ 03340000
*        /* CHECK THE RETURN CODE FROM POSITIONING                   */ 03341000
*        /*                                                          */ 03342000
*        /************************************************************/ 03343000
*        IF TESTRC ^= 0                                            1065 03344000
*          THEN                                                    1065 03345000
*                                                                  1065 03346000
         LH    @15,TESTRC                                          1065 03347000
         LTR   @15,@15                                             1065 03348000
         BZ    @RF01065                                            1065 03349000
*        /************************************************************/ 03350000
*        /*                                                          */ 03351000
*        /*  BAD RETURN CODE FROM POSITIONING. CALL MODCLFP TO CLOSE */ 03352000
*        /*   FILES AND FREE POOLS                                   */ 03353000
*        /************************************************************/ 03354000
*                                                                  1066 03355000
*            DO;                                                   1066 03356000
*            IF TESTRC = EOF | TESTRC = NOTFOUND                   1067 03357000
*              THEN                                                1067 03358000
*                                                                  1067 03359000
         CLC   TESTRC(2),@CH00475                                  1067 03360000
         BE    @RT01067                                            1067 03361000
         CLC   TESTRC(2),@CH00181                                  1067 03362000
         BNE   @RF01067                                            1067 03363000
@RT01067 DS    0H                                                  1068 03364000
*              /******************************************************/ 03365000
*              /* RECORD NOT FOUND OR END OF TRACK ENCOUNTERED       */ 03366000
*              /*  ISSUE MESSAGE IDC31227I                           */ 03367000
*              /******************************************************/ 03368000
*                                                                  1068 03369000
*                 DO;                                              1068 03370000
*                   CKREQ = CKREQ && CKREQ;                        1069 03371000
         L     @15,@PC00001+8                                      1069 03372000
         XC    CKREQ(44,@15),CKREQ(@15)                            1069 03373000
*                   CKRERN = MSG27;                                1070 03374000
         L     @15,@PC00001+8                                      1070 03375000
         MVC   CKRERN(2,@15),@CH01944                              1070 03376000
*                   CKRMVAR(1) = ADDR(MIKAD6);                     1071 03377000
         L     @15,@PC00001+8                                      1071 03378000
         LA    @14,MIKAD6                                          1071 03379000
         ST    @14,CKRMVAR(,@15)                                   1071 03380000
*                   CKRMVAR(2) = ADDR(MIKAD54);                    1072 03381000
         L     @15,@PC00001+8                                      1072 03382000
         LA    @14,MIKAD54                                         1072 03383000
         ST    @14,CKRMVAR+4(,@15)                                 1072 03384000
*                   CKRMVAR(3) = ADDR(RWFDANA);                    1073 03385000
         L     @15,@PC00001+8                                      1073 03386000
         L     @14,RWFPTR1                                         1073 03387000
         ST    @14,CKRMVAR+8(,@15)                                 1073 03388000
*                   CALL IDCRDER;                                  1074 03389000
         L     @15,@CV01811                                        1074 03390000
         BALR  @14,@15                                             1074 03391000
*                 END;                                             1075 03392000
*              ELSE;                                               1076 03393000
@RF01067 DS    0H                                                  1077 03394000
*                DO;                                               1077 03395000
*                CALL MODCLFP;                                     1078 03396000
         BAL   @14,MODCLFP                                         1078 03397000
*                RETURN CODE(LASTCC12);                            1079 03398000
         LA    @15,12                                              1079 03399000
         L     @14,@SA00004                                        1079 03400000
         LM    @00,@12,@SA00004+8                                  1079 03401000
         BR    @14                                                 1079 03402000
*                END;                                              1080 03403000
*                                                                  1080 03404000
*            END;                                                  1081 03405000
*                                                                  1081 03406000
*          ELSE;                                                   1082 03407000
*                                                                  1082 03408000
@RF01065 DS    0H                                                  1083 03409000
*        /************************************************************/ 03410000
*        /*                                                          */ 03411000
*        /*  READ RECORD ZERO                                        */ 03412000
*        /*                                                          */ 03413000
*        /************************************************************/ 03414000
*                                                                  1083 03415000
*         DO;                                                      1083 03416000
*           WFREQ = ''B;                                           1084 03417000
         L     @15,@PC00001+8                                      1084 03418000
         XC    WFREQ(2,@15),WFREQ(@15)                             1084 03419000
*           WFRGET = ON;      /*  GETRCD */                        1085 03420000
         L     @15,@PC00001+8                                      1085 03421000
         OI    WFRGET(@15),B'00100000'                             1085 03422000
*           WFRIN  = ON;      /* INPUT DS */                       1086 03423000
         L     @15,@PC00001+8                                      1086 03424000
         OI    WFRIN(@15),B'10000000'                              1086 03425000
*           CALL IDCRDIO;                                          1087 03426000
         L     @15,@CV01814                                        1087 03427000
         BALR  @14,@15                                             1087 03428000
*           RFY RTNREG RSTD;                                       1088 03429000
*           TESTRC = RTNREG;                                       1089 03430000
         STH   RTNREG,TESTRC                                       1089 03431000
*           RFY RTNREG UNRSTD;                                     1090 03432000
*         END;                                                     1091 03433000
*                                                                  1091 03434000
*        /************************************************************/ 03435000
*        /*                                                          */ 03436000
*        /* CHECK THE RETURN CODE FROM GETTING RECORD ZERO           */ 03437000
*        /*                                                          */ 03438000
*        /************************************************************/ 03439000
*          IF TESTRC ^= 0                                          1092 03440000
*            THEN                                                  1092 03441000
*                                                                  1092 03442000
         LH    @15,TESTRC                                          1092 03443000
         LTR   @15,@15                                             1092 03444000
         BZ    @RF01092                                            1092 03445000
*              /******************************************************/ 03446000
*              /* THE RC FROM GETTING THE RECORD IN NOT ZERO.  CALL  */ 03447000
*              /*  MODCLFP TO CLOSE FILES AND FREE POOLS             */ 03448000
*              /******************************************************/ 03449000
*              DO;                                                 1093 03450000
*              IF TESTRC = NOTFOUND | TESTRC = EOF                 1094 03451000
*                THEN                                              1094 03452000
*                                                                  1094 03453000
         CLC   TESTRC(2),@CH00181                                  1094 03454000
         BE    @RT01094                                            1094 03455000
         CLC   TESTRC(2),@CH00475                                  1094 03456000
         BNE   @RF01094                                            1094 03457000
@RT01094 DS    0H                                                  1095 03458000
*                  /**************************************************/ 03459000
*                  /* THE RECORD WAS NOT FOUND OR END OF FILE WAS    */ 03460000
*                  /*  ENCOUNTERED.  ISSUE MESSAGE IDC31227I         */ 03461000
*                  /**************************************************/ 03462000
*                                                                  1095 03463000
*                   DO;                                            1095 03464000
*                     CKREQ = CKREQ && CKREQ;                      1096 03465000
         L     @15,@PC00001+8                                      1096 03466000
         XC    CKREQ(44,@15),CKREQ(@15)                            1096 03467000
*                     CKRERN = MSG27;                              1097 03468000
         L     @15,@PC00001+8                                      1097 03469000
         MVC   CKRERN(2,@15),@CH01944                              1097 03470000
*                     CKRMVAR(1) = ADDR(MIKAD6);                   1098 03471000
         L     @15,@PC00001+8                                      1098 03472000
         LA    @14,MIKAD6                                          1098 03473000
         ST    @14,CKRMVAR(,@15)                                   1098 03474000
*                     CKRMVAR(2) = ADDR(MIKAD54);                  1099 03475000
         L     @15,@PC00001+8                                      1099 03476000
         LA    @14,MIKAD54                                         1099 03477000
         ST    @14,CKRMVAR+4(,@15)                                 1099 03478000
*                     CKRMVAR(3) = ADDR(RWFDANA);                  1100 03479000
         L     @15,@PC00001+8                                      1100 03480000
         L     @14,RWFPTR1                                         1100 03481000
         ST    @14,CKRMVAR+8(,@15)                                 1100 03482000
*                     CALL IDCRDER;                                1101 03483000
         L     @15,@CV01811                                        1101 03484000
         BALR  @14,@15                                             1101 03485000
*                   END;                                           1102 03486000
*                ELSE;                                             1103 03487000
@RF01094 DS    0H                                                  1104 03488000
*                  DO;                                             1104 03489000
*                  CALL MODCLFP;                                   1105 03490000
         BAL   @14,MODCLFP                                         1105 03491000
*                  RETURN CODE(LASTCC12);                          1106 03492000
         LA    @15,12                                              1106 03493000
         L     @14,@SA00004                                        1106 03494000
         LM    @00,@12,@SA00004+8                                  1106 03495000
         BR    @14                                                 1106 03496000
*                  END;                                            1107 03497000
*              END;                                                1108 03498000
*            ELSE;                                                 1109 03499000
*                                                                  1109 03500000
*                                                                  1109 03501000
@RF01092 DS    0H                                                  1110 03502000
*        /************************************************************/ 03503000
*        /*                                                          */ 03504000
*        /*  THE OUTBUFFER WII BE BUILD IN AREA POINTED BY BFPTROUT  */ 03505000
*        /*                                                          */ 03506000
*        /************************************************************/ 03507000
*        RFY DSOUT BASED (REPOBFPT);                               1110 03508000
*        RFY RB2 BASED (WFIODAD);                                  1111 03509000
*        BFPTROUT = REPOBFPT;                                      1112 03510000
         L     @15,@PC00001+8                                      1112 03511000
         L     @15,REPOBFPT(,@15)                                  1112 03512000
         ST    @15,BFPTROUT                                        1112 03513000
*        BFPTROUT = BFPTROUT + CNST04;                             1113 03514000
*                                                                  1113 03515000
         LA    @15,4                                               1113 03516000
         AL    @15,BFPTROUT                                        1113 03517000
         ST    @15,BFPTROUT                                        1113 03518000
*        /************************************************************/ 03519000
*        /*                                                          */ 03520000
*        /* SINCE R0 WILL BE PART OF THE LOOP WHERE THE TRACK SIZE IS*/ 03521000
*        /* COMPUTED AND TRACK SIZE DOES NOT INCLUDE R0, THE CONSTNTS*/ 03522000
*        /* ARE INITIALIZED TO COMPENSATE FOR THE R0 LENGTH          */ 03523000
*        /*                                                          */ 03524000
*        /************************************************************/ 03525000
*        SIGMA = - KEYFLGLN;                                       1114 03526000
         MVC   SIGMA(4),@CF02147                                   1114 03527000
*        SUMKEY = ZERO;                                            1115 03528000
         SLR   @15,@15                                             1115 03529000
         STH   @15,SUMKEY                                          1115 03530000
*        SUMNOKEY = - 1;                                           1116 03531000
         MVC   SUMNOKEY(2),@CH02101                                1116 03532000
*        DOUT = ZERO;                                              1117 03533000
*                                                                  1117 03534000
         MVI   DOUT,X'00'                                          1117 03535000
*        /************************************************************/ 03536000
*        /*                                                          */ 03537000
*        /* PROCESS ALL RECORDS IN A TRACK                           */ 03538000
*        /* THE RWF INPUT RECORD IS IN RB2 AND THE OUTPUT            */ 03539000
*        /* TRACK IS BUILD IN DSOUT POINTED BY BFPTROUT              */ 03540000
*        /*                                                          */ 03541000
*        /************************************************************/ 03542000
*                                                                  1118 03543000
*        DO WHILE (DOUT = ZERO);                                   1118 03544000
         B     @DE01118                                            1118 03545000
@DL01118 DS    0H                                                  1119 03546000
*          /**********************************************************/ 03547000
*          /* CHECK TO SEE IF IGNORE FLAG IS SET FOR THIS RECORD     */ 03548000
*          /*  IF IT IS NOT, THEN CONTINUE PROCESSING THIS RECORD    */ 03549000
*          /* NOTE THAT THE IGNORE FLAG IS CREATED ONLY WHEN AN STAGE*/ 03550000
*          /*  ERROR RECORD PAIR DOES NOT CONTAIN AN ORIGINAL RECORD */ 03551000
*          /*  ONE AND THE PAIR IS DEBLOCKED                         */ 03552000
*          /**********************************************************/ 03553000
*          IF RB2FLG1 ^= IGNORE                                    1119 03554000
*            THEN                                                  1119 03555000
*                                                                  1119 03556000
         L     @15,@PC00001+8                                      1119 03557000
         L     @01,WFIODAD(,@15)                                   1119 03558000
         CLC   RB2FLG1(1,@01),IGNORE                               1119 03559000
         BE    @RF01119                                            1119 03560000
*              /******************************************************/ 03561000
*              /*                                                    */ 03562000
*              /* THE RECORD WILL NOT BE BYPASSED                    */ 03563000
*              /*                                                    */ 03564000
*              /******************************************************/ 03565000
*              DO;                                                 1120 03566000
*                                                                  1120 03567000
*              /******************************************************/ 03568000
*              /*                                                    */ 03569000
*              /* CHECK IF THE INPUT REPAIR WORKFILE RECORD IS A     */ 03570000
*              /*  DEBLOCKED OR DEBLOCKED/MODIFIED RECORD            */ 03571000
*              /*                                                    */ 03572000
*              /******************************************************/ 03573000
*              IF RB2FLG1 ^= DEBLKFLG & RB2FLG1 ^= DBKMODFL        1121 03574000
*                 THEN                                             1121 03575000
*                                                                  1121 03576000
         L     @15,@PC00001+8                                      1121 03577000
         L     @01,WFIODAD(,@15)                                   1121 03578000
         CLI   RB2FLG1(@01),2                                      1121 03579000
         BE    @RF01121                                            1121 03580000
         L     @15,@PC00001+8                                      1121 03581000
         L     @01,WFIODAD(,@15)                                   1121 03582000
         CLI   RB2FLG1(@01),3                                      1121 03583000
         BE    @RF01121                                            1121 03584000
*                  /**************************************************/ 03585000
*                  /*                                                */ 03586000
*                  /*  THE INPUT RECORD IS NOT A DEBLOCKED RECORD    */ 03587000
*                  /*  ISSUE MESSGE IDC31228I                        */ 03588000
*                  /**************************************************/ 03589000
*                  DO;                                             1122 03590000
*                                                                  1122 03591000
*                   DO;                                            1123 03592000
*                     CKREQ = CKREQ && CKREQ;                      1124 03593000
         L     @15,@PC00001+8                                      1124 03594000
         XC    CKREQ(44,@15),CKREQ(@15)                            1124 03595000
*                     CKRERN = MSG28;                              1125 03596000
         L     @15,@PC00001+8                                      1125 03597000
         MVC   CKRERN(2,@15),@CH00690                              1125 03598000
*                     CKRMVAR(1) = ADDR(MIKAD6);                   1126 03599000
         L     @15,@PC00001+8                                      1126 03600000
         LA    @14,MIKAD6                                          1126 03601000
         ST    @14,CKRMVAR(,@15)                                   1126 03602000
*                     CKRMVAR(2) = ADDR(MIKAD54);                  1127 03603000
         L     @15,@PC00001+8                                      1127 03604000
         LA    @14,MIKAD54                                         1127 03605000
         ST    @14,CKRMVAR+4(,@15)                                 1127 03606000
*                     CKRMVAR(3) = ADDR(RWFDANA);                  1128 03607000
         L     @15,@PC00001+8                                      1128 03608000
         L     @14,RWFPTR1                                         1128 03609000
         ST    @14,CKRMVAR+8(,@15)                                 1128 03610000
*                     CALL IDCRDER;                                1129 03611000
         L     @15,@CV01811                                        1129 03612000
         BALR  @14,@15                                             1129 03613000
*                   END;                                           1130 03614000
*                  RETURN CODE(LASTCC12);                          1131 03615000
         LA    @15,12                                              1131 03616000
         L     @14,@SA00004                                        1131 03617000
         LM    @00,@12,@SA00004+8                                  1131 03618000
         BR    @14                                                 1131 03619000
*                  END;                                            1132 03620000
*                ELSE;                                             1133 03621000
*                                                                  1133 03622000
@RF01121 DS    0H                                                  1134 03623000
*              /******************************************************/ 03624000
*              /*                                                    */ 03625000
*              /*  CK IF RECORD FITS IN THE OUTPUT TRACK             */ 03626000
*              /*  MUST SUBSTRACT 16 FROM INPUT LENGTH               */ 03627000
*              /*                                                    */ 03628000
*              /******************************************************/ 03629000
*              SIGMA = WFIODLN - KEYFLGLN + SIGMA - COUNTLN;       1134 03630000
         L     @15,@PC00001+8                                      1134 03631000
         L     @15,WFIODLN(,@15)                                   1134 03632000
         SL    @15,@CF00475                                        1134 03633000
         AL    @15,SIGMA                                           1134 03634000
         SL    @15,@CF00181                                        1134 03635000
         ST    @15,SIGMA                                           1134 03636000
*              IF RB2CKL ^= ZERO                                   1135 03637000
*                THEN                                              1135 03638000
         L     @15,@PC00001+8                                      1135 03639000
         L     @01,WFIODAD(,@15)                                   1135 03640000
         CLI   RB2CKL(@01),0                                       1135 03641000
         BE    @RF01135                                            1135 03642000
*                  SUMKEY = SUMKEY+1;                              1136 03643000
         LA    @15,1                                               1136 03644000
         LH    @14,SUMKEY                                          1136 03645000
         N     @14,@CF02153                                        1136 03646000
         ALR   @15,@14                                             1136 03647000
         STH   @15,SUMKEY                                          1136 03648000
*                ELSE                                              1137 03649000
*                 SUMNOKEY = SUMNOKEY+1;                           1137 03650000
         B     @RC01135                                            1137 03651000
@RF01135 LA    @15,1                                               1137 03652000
         AH    @15,SUMNOKEY                                        1137 03653000
         STH   @15,SUMNOKEY                                        1137 03654000
*              IF DEVTC < SIGMA + SUMKEY * KYCNST                  1138 03655000
*                        + SUMNOKEY * NOKYCNST                     1138 03656000
*                THEN                                              1138 03657000
*                                                                  1138 03658000
@RC01135 L     @15,@PC00001+8                                      1138 03659000
         L     @01,REPODEVA(,@15)                                  1138 03660000
         LH    @03,KYCNST                                          1138 03661000
         N     @03,@CF02153                                        1138 03662000
         LH    @00,SUMKEY                                          1138 03663000
         N     @00,@CF02153                                        1138 03664000
         MR    @02,@00                                             1138 03665000
         AL    @03,SIGMA                                           1138 03666000
         SLR   @02,@02                                             1138 03667000
         IC    @02,NOKYCNST                                        1138 03668000
         MH    @02,SUMNOKEY                                        1138 03669000
         ALR   @03,@02                                             1138 03670000
         LH    @02,DEVTC(,@01)                                     1138 03671000
         N     @02,@CF02153                                        1138 03672000
         CR    @03,@02                                             1138 03673000
         BNH   @RF01138                                            1138 03674000
*                  /**************************************************/ 03675000
*                  /*                                                */ 03676000
*                  /*  THE ACCUMULATIVE LENGTH OF THE INPUT RECRDS IS*/ 03677000
*                  /*  GREATER THAN THE OUTPUT DEVICE CAPACITY.      */ 03678000
*                  /*                                                */ 03679000
*                  /**************************************************/ 03680000
*                  DO;                                             1139 03681000
*                                                                  1139 03682000
*                   DO;                                            1140 03683000
*                     CKREQ = CKREQ && CKREQ;                      1141 03684000
         L     @15,@PC00001+8                                      1141 03685000
         XC    CKREQ(44,@15),CKREQ(@15)                            1141 03686000
*                     CKRERN = MSG29;                              1142 03687000
         L     @15,@PC00001+8                                      1142 03688000
         MVC   CKRERN(2,@15),@CH00694                              1142 03689000
*                     CKRMVAR(1) = ADDR(MIKAD54);                  1143 03690000
         L     @15,@PC00001+8                                      1143 03691000
         LA    @14,MIKAD54                                         1143 03692000
         ST    @14,CKRMVAR(,@15)                                   1143 03693000
*                     CKRMVAR(2) = ADDR(DSNMSG);                   1144 03694000
         L     @15,@PC00001+8                                      1144 03695000
         LA    @14,DSNMSG                                          1144 03696000
         ST    @14,CKRMVAR+4(,@15)                                 1144 03697000
*                     CALL IDCRDER;                                1145 03698000
         L     @15,@CV01811                                        1145 03699000
         BALR  @14,@15                                             1145 03700000
*                   END;                                           1146 03701000
*                  RETURN CODE(LASTCC12);                          1147 03702000
         LA    @15,12                                              1147 03703000
         L     @14,@SA00004                                        1147 03704000
         LM    @00,@12,@SA00004+8                                  1147 03705000
         BR    @14                                                 1147 03706000
*                  END;                                            1148 03707000
*                ELSE;                                             1149 03708000
*                                                                  1149 03709000
@RF01138 DS    0H                                                  1150 03710000
*              /******************************************************/ 03711000
*              /*                                                    */ 03712000
*              /* MOVE RECORD TO OUTPUT DSOUT POINTED TO BY BFPTROUT */ 03713000
*              /*                                                    */ 03714000
*              /******************************************************/ 03715000
*                                                                  1150 03716000
*               RFY (REG2,REG3,REG4,REG5) RSTD;                    1150 03717000
*               REG2 = BFPTROUT;                                   1151 03718000
         L     REG2,BFPTROUT                                       1151 03719000
*               REG3 = WFIODLN-KEYFLGLN;                           1152 03720000
         L     @15,@PC00001+8                                      1152 03721000
         L     REG3,WFIODLN(,@15)                                  1152 03722000
         SL    REG3,@CF00475                                       1152 03723000
*               REG4 = ADDR(RB2C);                                 1153 03724000
         L     @15,@PC00001+8                                      1153 03725000
         L     REG4,WFIODAD(,@15)                                  1153 03726000
         LA    REG4,RB2C(,REG4)                                    1153 03727000
*               REG5 = WFIODLN-KEYFLGLN;                           1154 03728000
         L     @15,@PC00001+8                                      1154 03729000
         L     REG5,WFIODLN(,@15)                                  1154 03730000
         SL    REG5,@CF00475                                       1154 03731000
*               MVCL (REG2,REG4);                                  1155 03732000
         MVCL  REG2,REG4                                           1155 03733000
*               RFY(REG2,REG3,REG4,REG5) UNRSTD;                   1156 03734000
*                                                                  1156 03735000
*              /******************************************************/ 03736000
*              /*                                                    */ 03737000
*              /*  SAVE OVERFLOW INDICATOR                           */ 03738000
*              /*                                                    */ 03739000
*              /******************************************************/ 03740000
*              IF RB2FLG3 = 1                                      1157 03741000
*                THEN                                              1157 03742000
         L     @15,@PC00001+8                                      1157 03743000
         L     @01,WFIODAD(,@15)                                   1157 03744000
         CLI   RB2FLG3(@01),1                                      1157 03745000
         BNE   @RF01157                                            1157 03746000
*                  OVFLSW = YESS;                                  1158 03747000
         MVI   OVFLSW,X'01'                                        1158 03748000
*                ELSE                                              1159 03749000
*                  OVFLSW = NOT;                                   1159 03750000
         B     @RC01157                                            1159 03751000
@RF01157 MVI   OVFLSW,X'00'                                        1159 03752000
*              BFPTROUT = BFPTROUT + WFIODLN - KEYFLGLN;           1160 03753000
*                                                                  1160 03754000
@RC01157 L     @15,@PC00001+8                                      1160 03755000
         L     @14,BFPTROUT                                        1160 03756000
         AL    @14,WFIODLN(,@15)                                   1160 03757000
         SL    @14,@CF00475                                        1160 03758000
         ST    @14,BFPTROUT                                        1160 03759000
*              END;                                                1161 03760000
*                                                                  1161 03761000
*            /********************************************************/ 03762000
*            /*                                                      */ 03763000
*            /*  OTHERWISE IGNORE THIS RECORD                        */ 03764000
*            /*                                                      */ 03765000
*            /********************************************************/ 03766000
*                                                                  1162 03767000
*            ELSE;                                                 1162 03768000
*                                                                  1162 03769000
@RF01119 DS    0H                                                  1163 03770000
*          /**********************************************************/ 03771000
*          /*                                                        */ 03772000
*          /* GET NEXT RECORD                                        */ 03773000
*          /*                                                        */ 03774000
*          /**********************************************************/ 03775000
*                                                                  1163 03776000
*           DO;                                                    1163 03777000
*             WFREQ = ''B;                                         1164 03778000
         L     @15,@PC00001+8                                      1164 03779000
         XC    WFREQ(2,@15),WFREQ(@15)                             1164 03780000
*             WFRGET = ON;      /*  GETRCD */                      1165 03781000
         L     @15,@PC00001+8                                      1165 03782000
         OI    WFRGET(@15),B'00100000'                             1165 03783000
*             WFRIN  = ON;      /* INPUT DS */                     1166 03784000
         L     @15,@PC00001+8                                      1166 03785000
         OI    WFRIN(@15),B'10000000'                              1166 03786000
*             CALL IDCRDIO;                                        1167 03787000
         L     @15,@CV01814                                        1167 03788000
         BALR  @14,@15                                             1167 03789000
*             RFY RTNREG RSTD;                                     1168 03790000
*             TESTRC = RTNREG;                                     1169 03791000
         STH   RTNREG,TESTRC                                       1169 03792000
*             RFY RTNREG UNRSTD;                                   1170 03793000
*           END;                                                   1171 03794000
*                                                                  1171 03795000
*          /**********************************************************/ 03796000
*          /*                                                        */ 03797000
*          /*  CHECK THE RETURN CODE FROM GETTING THE RECORD         */ 03798000
*          /*                                                        */ 03799000
*          /**********************************************************/ 03800000
*          IF TESTRC = IOERROR                                     1172 03801000
*            THEN                                                  1172 03802000
*                                                                  1172 03803000
         CLC   TESTRC(2),@CH00044                                  1172 03804000
         BNE   @RF01172                                            1172 03805000
*              /******************************************************/ 03806000
*              /*                                                    */ 03807000
*              /* I/O ERROR.  GET OUT WITH A RC = 12                 */ 03808000
*              /*                                                    */ 03809000
*              /******************************************************/ 03810000
*              RETURN CODE(LASTCC12);                              1173 03811000
         LA    @15,12                                              1173 03812000
         L     @14,@SA00004                                        1173 03813000
         LM    @00,@12,@SA00004+8                                  1173 03814000
         BR    @14                                                 1173 03815000
*            ELSE;                                                 1174 03816000
*                                                                  1174 03817000
@RF01172 DS    0H                                                  1175 03818000
*          /**********************************************************/ 03819000
*          /*                                                        */ 03820000
*          /* CHECK IF RC FROM IDCRDRD IS END OF FILE                */ 03821000
*          /*                                                        */ 03822000
*          /**********************************************************/ 03823000
*          IF TESTRC = EOF                                         1175 03824000
*            THEN                                                  1175 03825000
*                                                                  1175 03826000
         CLC   TESTRC(2),@CH00475                                  1175 03827000
         BNE   @RF01175                                            1175 03828000
*              /******************************************************/ 03829000
*              /*                                                    */ 03830000
*              /* END OF FILE ENCOUNTERED  SET DOUT = 1 & ILOOP=SMOHH*/ 03831000
*              /*  TO GET OUT OF BOTH LOOPS                          */ 03832000
*              /*                                                    */ 03833000
*              /******************************************************/ 03834000
*              DO;                                                 1176 03835000
*              DOUT = 1;                                           1177 03836000
         MVI   DOUT,X'01'                                          1177 03837000
*              ILOOP  = SMOHH;                                     1178 03838000
         LH    @15,SMOHH                                           1178 03839000
         N     @15,@CF02153                                        1178 03840000
         STH   @15,ILOOP                                           1178 03841000
*              END;                                                1179 03842000
*            ELSE                                                  1180 03843000
*                                                                  1180 03844000
*              DO;                                                 1180 03845000
         B     @RC01175                                            1180 03846000
@RF01175 DS    0H                                                  1181 03847000
*              /******************************************************* 03848000
*              /*                                                     * 03849000
*              /* CHECK IF IN THE SAME TRACK AND IF NOT OUT OF LOOP   * 03850000
*              /*                                                     * 03851000
*              /******************************************************* 03852000
*              IF RB2CHH ^= SMIHH                                  1181 03853000
*                THEN                                              1181 03854000
         L     @15,@PC00001+8                                      1181 03855000
         L     @01,WFIODAD(,@15)                                   1181 03856000
         CLC   RB2CHH(2,@01),SMIHH                                 1181 03857000
         BE    @RF01181                                            1181 03858000
*                  DO;                                             1182 03859000
*                  SMIHH = SMIHH + 1;                              1183 03860000
         LA    @15,1                                               1183 03861000
         LH    @14,SMIHH                                           1183 03862000
         N     @14,@CF02153                                        1183 03863000
         ALR   @15,@14                                             1183 03864000
         STH   @15,SMIHH                                           1183 03865000
*                  MIKAD54H = MIKAD54H + 1;                        1184 03866000
         LA    @15,1                                               1184 03867000
         SLR   @14,@14                                             1184 03868000
         ICM   @14,3,MIKAD54H                                      1184 03869000
         ALR   @15,@14                                             1184 03870000
         STCM  @15,3,MIKAD54H                                      1184 03871000
*                  DOUT = 1;                                       1185 03872000
         MVI   DOUT,X'01'                                          1185 03873000
*                  END;                                            1186 03874000
*                ELSE;                                             1187 03875000
@RF01181 DS    0H                                                  1188 03876000
*              END;                                                1188 03877000
*                                                                  1188 03878000
*        /************************************************************/ 03879000
*        /*                                                          */ 03880000
*        /*      END OF DO WHILE RECORD PROCESSING OF TRACK          */ 03881000
*        /*                                                          */ 03882000
*        /************************************************************/ 03883000
*        END;                                                      1189 03884000
*                                                                  1189 03885000
@RC01175 DS    0H                                                  1189 03886000
@DE01118 CLI   DOUT,0                                              1189 03887000
         BE    @DL01118                                            1189 03888000
*        /************************************************************/ 03889000
*        /*                                                          */ 03890000
*        /*THE TRACK WAS READ AND THE UPDATED RECORD WILL FIT ON THE */ 03891000
*        /* TRACK                                                    */ 03892000
*        /*RESET BFPTROUT, SIGMA, SUMNOKEY, SUMKEY AND SAVE NUMBER   */ 03893000
*        /*OF RECORDS IN THE TRACK                                   */ 03894000
*        /*THEN THE TRACK IN DSOUT (REPOFBPT) IS WRITTEN             */ 03895000
*        /*                                                          */ 03896000
*        /************************************************************/ 03897000
*        SAVNURE = SUMKEY + SUMNOKEY;                              1190 03898000
         LH    @15,SUMKEY                                          1190 03899000
         N     @15,@CF02153                                        1190 03900000
         AH    @15,SUMNOKEY                                        1190 03901000
         STH   @15,SAVNURE                                         1190 03902000
*        SUMKEY  = ZERO;                                           1191 03903000
         SLR   @15,@15                                             1191 03904000
         STH   @15,SUMKEY                                          1191 03905000
*        SUMNOKEY = - 1;                                           1192 03906000
         MVC   SUMNOKEY(2),@CH02101                                1192 03907000
*        SIGMA = - KEYFLGLN;                                       1193 03908000
         MVC   SIGMA(4),@CF02147                                   1193 03909000
*        BFPTROUT = REPOBFPT + CNST04;                             1194 03910000
*                                                                  1194 03911000
         L     @15,@PC00001+8                                      1194 03912000
         LA    @14,4                                               1194 03913000
         AL    @14,REPOBFPT(,@15)                                  1194 03914000
         ST    @14,BFPTROUT                                        1194 03915000
*        /************************************************************/ 03916000
*        /*      BUILD ARG LIST                                      */ 03917000
*        /*                                                          */ 03918000
*        /************************************************************/ 03919000
*        RDCTLBK = REPODSOP;                                       1195 03920000
         L     @15,@PC00001+8                                      1195 03921000
         L     @01,REPODSAR(,@15)                                  1195 03922000
         L     @15,@PC00001+8                                      1195 03923000
         L     @00,REPODSOP(,@15)                                  1195 03924000
         ST    @00,RDCTLBK(,@01)                                   1195 03925000
*        RDIOAREA = REPOBFPT;                                      1196 03926000
*                                                                  1196 03927000
         L     @15,@PC00001+8                                      1196 03928000
         L     @01,REPODSAR(,@15)                                  1196 03929000
         L     @15,@PC00001+8                                      1196 03930000
         L     @00,REPOBFPT(,@15)                                  1196 03931000
         ST    @00,RDIOAREA(,@01)                                  1196 03932000
*        /************************************************************/ 03933000
*        /*  SET THE BEGINNING CCHHR TO THE FIRST CCHHR IN THE       */ 03934000
*        /*    BUFFER WE ARE WRITING FROM                            */ 03935000
*        /*                                                          */ 03936000
*        /************************************************************/ 03937000
*        RESPECIFY WIOAREA  BASED (RDIOAREA);                      1197 03938000
*        RESPECIFY WBUF     BASED (ADDR(WBUFF));                   1198 03939000
*        RDCHR = WBCCHHR;                                          1199 03940000
         L     @15,@PC00001+8                                      1199 03941000
         L     @01,REPODSAR(,@15)                                  1199 03942000
         L     @15,@PC00001+8                                      1199 03943000
         L     @15,REPODSAR(,@15)                                  1199 03944000
         L     @15,RDIOAREA(,@15)                                  1199 03945000
         MVC   RDCHR(5,@01),WBCCHHR+4(@15)                         1199 03946000
*        RDDS = ZERO;                                              1200 03947000
*                                                                  1200 03948000
         L     @15,@PC00001+8                                      1200 03949000
         L     @01,REPODSAR(,@15)                                  1200 03950000
         MVI   RDDS(@01),X'00'                                     1200 03951000
*        /************************************************************/ 03952000
*        /*                                                          */ 03953000
*        /*     CHECK IF LAST RECORD IS OVERFLOW                     */ 03954000
*        /*                                                          */ 03955000
*        /************************************************************/ 03956000
*        IF OVFLSW = 1                                             1201 03957000
*          THEN                                                    1201 03958000
         CLI   OVFLSW,1                                            1201 03959000
         BNE   @RF01201                                            1201 03960000
*            RDFUNC = 2;                                           1202 03961000
         L     @15,@PC00001+8                                      1202 03962000
         L     @01,REPODSAR(,@15)                                  1202 03963000
         MVI   RDFUNC(@01),X'02'                                   1202 03964000
*          ELSE                                                    1203 03965000
*            RDFUNC = ZERO;                                        1203 03966000
*                                                                  1203 03967000
         B     @RC01201                                            1203 03968000
@RF01201 L     @15,@PC00001+8                                      1203 03969000
         L     @01,REPODSAR(,@15)                                  1203 03970000
         MVI   RDFUNC(@01),X'00'                                   1203 03971000
*        /************************************************************/ 03972000
*        /*                                                          */ 03973000
*        /*SET NUMBER OF RECORDS IN FRONT OF OUTPUT BUFFER           */ 03974000
*        /*                                                          */ 03975000
*        /************************************************************/ 03976000
*        DSOUT4 = SAVNURE;                                         1204 03977000
@RC01201 L     @15,@PC00001+8                                      1204 03978000
         L     @01,REPOBFPT(,@15)                                  1204 03979000
         LH    @00,SAVNURE                                         1204 03980000
         N     @00,@CF02153                                        1204 03981000
         ST    @00,DSOUT4(,@01)                                    1204 03982000
*        OLDERID2 = NEWERID2;                                      1205 03983000
         L     @15,@PC00001                                        1205 03984000
         L     @01,GDTTR2(,@15)                                    1205 03985000
         L     @15,@PC00001                                        1205 03986000
         L     @15,GDTTR2(,@15)                                    1205 03987000
         MVC   @TS00001(95),NEWERID2(@15)                          1205 03988000
         MVC   OLDERID2(95,@01),@TS00001                           1205 03989000
*        NEWID2 = 'RD5A';                                          1206 03990000
*                                                                  1206 03991000
         L     @15,@PC00001                                        1206 03992000
         L     @01,GDTTR2(,@15)                                    1206 03993000
         MVC   NEWID2(4,@01),@CC02105                              1206 03994000
*        /************************************************************/ 03995000
*        /*                                                          */ 03996000
*        /*  SET DUMP AND TRACE POINTS                               */ 03997000
*        /*                                                          */ 03998000
*        /************************************************************/ 03999000
*        IF GDTDBG = NULLPTR                                       1207 04000000
*          THEN;                                                   1207 04001000
         L     @15,@PC00001                                        1207 04002000
         L     @15,GDTDBG(,@15)                                    1207 04003000
         LTR   @15,@15                                             1207 04004000
         BZ    @RT01207                                            1207 04005000
*          ELSE                                                    1209 04006000
*            CALL IDCDB010(GDTTBL,'RD5B');                         1209 04007000
         L     @15,@PC00001                                        1209 04008000
         ST    @15,@AL00001                                        1209 04009000
         LA    @15,@CC02106                                        1209 04010000
         ST    @15,@AL00001+4                                      1209 04011000
         MVI   @AL00001+4,X'80'                                    1209 04012000
         L     @14,@PC00001                                        1209 04013000
         L     @15,GDTDBG(,@14)                                    1209 04014000
         LA    @01,@AL00001                                        1209 04015000
         BALR  @14,@15                                             1209 04016000
*        CALL IDCIO050(GDTTBL,FWRITE,RDARG);                       1210 04017000
@RT01207 L     @15,@PC00001                                        1210 04018000
         ST    @15,@AL00001                                        1210 04019000
         LA    @15,FWRITE                                          1210 04020000
         ST    @15,@AL00001+4                                      1210 04021000
         L     @15,@PC00001+8                                      1210 04022000
         L     @01,REPODSAR(,@15)                                  1210 04023000
         ST    @01,@AL00001+8                                      1210 04024000
         MVI   @AL00001+8,X'80'                                    1210 04025000
         L     @14,@PC00001                                        1210 04026000
         L     @15,GDTEXP(,@14)                                    1210 04027000
         LA    @01,@AL00001                                        1210 04028000
         BALR  @14,@15                                             1210 04029000
*        RESPECIFY RTNREG RSTD;                                    1211 04030000
*        TESTRC = RTNREG;                                          1212 04031000
         STH   RTNREG,TESTRC                                       1212 04032000
*        RESPECIFY RTNREG UNRSTD;                                  1213 04033000
*        IF TESTRC ^= 0                                            1214 04034000
*          THEN                                                    1214 04035000
         LH    @15,TESTRC                                          1214 04036000
         LTR   @15,@15                                             1214 04037000
         BZ    @RF01214                                            1214 04038000
*            DO;                                                   1215 04039000
*                                                                  1215 04040000
*            /********************************************************/ 04041000
*            /*                                                      */ 04042000
*            /* ISSUE MSG IDC31245I - I/O ERROR WHILE MODIFYING TRACK*/ 04043000
*            /*                                                      */ 04044000
*            /********************************************************/ 04045000
*                                                                  1216 04046000
*             DO;                                                  1216 04047000
*               CKREQ = CKREQ && CKREQ;                            1217 04048000
         L     @15,@PC00001+8                                      1217 04049000
         XC    CKREQ(44,@15),CKREQ(@15)                            1217 04050000
*               CKRERN = MSG45;                                    1218 04051000
         L     @15,@PC00001+8                                      1218 04052000
         MVC   CKRERN(2,@15),@CH00767                              1218 04053000
*               CKRMVAR(1) = ADDR(RDCHR);                          1219 04054000
         L     @15,@PC00001+8                                      1219 04055000
         L     @14,@PC00001+8                                      1219 04056000
         L     @01,REPODSAR(,@14)                                  1219 04057000
         LA    @14,RDCHR(,@01)                                     1219 04058000
         ST    @14,CKRMVAR(,@15)                                   1219 04059000
*               CKRMVAR(2) = ADDR(DSNMSG);                         1220 04060000
         L     @15,@PC00001+8                                      1220 04061000
         LA    @14,DSNMSG                                          1220 04062000
         ST    @14,CKRMVAR+4(,@15)                                 1220 04063000
*               CALL IDCRDER;                                      1221 04064000
         L     @15,@CV01811                                        1221 04065000
         BALR  @14,@15                                             1221 04066000
*             END;                                                 1222 04067000
*            RETURN CODE(LASTCC12);                                1223 04068000
         LA    @15,12                                              1223 04069000
         L     @14,@SA00004                                        1223 04070000
         LM    @00,@12,@SA00004+8                                  1223 04071000
         BR    @14                                                 1223 04072000
*            END;                                                  1224 04073000
*          ELSE;                                                   1225 04074000
@RF01214 DS    0H                                                  1226 04075000
*          REPRCDCT = REPRCDCT + SAVNURE+1;                        1226 04076000
*                                                                  1226 04077000
         L     @15,@PC00001+8                                      1226 04078000
         L     @14,@PC00001+8                                      1226 04079000
         LH    @05,SAVNURE                                         1226 04080000
         N     @05,@CF02153                                        1226 04081000
         AL    @05,REPRCDCT(,@14)                                  1226 04082000
         AL    @05,@CF00221                                        1226 04083000
         ST    @05,REPRCDCT(,@15)                                  1226 04084000
*        /************************************************************/ 04085000
*        /*                                                          */ 04086000
*        /*     END OF DO ILOOP                                      */ 04087000
*        /*                                                          */ 04088000
*        /************************************************************/ 04089000
*        END;                                                      1227 04090000
         LA    @15,1                                               1227 04091000
         LH    @14,ILOOP                                           1227 04092000
         N     @14,@CF02153                                        1227 04093000
         ALR   @15,@14                                             1227 04094000
@DE01038 STH   @15,ILOOP                                           1227 04095000
         LH    @14,SMOHH                                           1227 04096000
         N     @14,@CF02153                                        1227 04097000
         CR    @15,@14                                             1227 04098000
         BNH   @DL01038                                            1227 04099000
*        RETURN CODE(LASTCC00);                                    1228 04100000
         SLR   @15,@15                                             1228 04101000
         L     @14,@SA00004                                        1228 04102000
         LM    @00,@12,@SA00004+8                                  1228 04103000
         BR    @14                                                 1228 04104000
*END MODRNG;                                                       1229 04105000
*                                                                  1229 04106000
*MODDSOUT:    PROCEDURE;                                           1230 04107000
MODDSOUT STM   @14,@12,@SA00005                                    1230 04108000
*        /************************************************************/ 04109000
*        /*                                                          */ 04110000
*        /* SUBROUTINE NAME - MODDSOUT                               */ 04111000
*        /*                                                          */ 04112000
*        /* FUNCTION -                                               */ 04113000
*        /*                                                          */ 04114000
*        /*  PROCEDURE NAME - MODDSOUT                               */ 04115000
*        /*                                                          */ 04116000
*        /*  THIS PROCEDURE WILL PROCESS THE MODIFY REQUEST WHEN THE */ 04117000
*        /*  INPUT IS A RECORD FROM EITHER A DATA SET OR A REPAIR    */ 04118000
*        /*  WORK FILE, OR AN INPUT STRING OR IF THE OVERFLOW KEYWORD*/ 04119000
*        /*  IS PRESENT. IF INPUT RECORD IS PRESENT, IT IS IN RB3    */ 04120000
*        /*  POINTED BY BFPTRIN                                      */ 04121000
*        /*  THE OUPUT RECORD IS IN RB1 POINTED BY BFPTROUT.         */ 04122000
*        /*                                                          */ 04123000
*        /*                                                          */ 04124000
*        /* NOTES -                                                  */ 04125000
*        /*                                                          */ 04126000
*        /*    DEPENDENCIES - NONE                                   */ 04127000
*        /*                                                          */ 04128000
*        /*    RESTRICTIONS - GENERAL PURPOSE REGISTERS 7 AND 8      */ 04129000
*        /*                   MAY NOT BE USED BY THIS MODULE OR      */ 04130000
*        /*                   ANY OTHER REPAIRV MODULE AS THEY ARE   */ 04131000
*        /*                   DATA REGISTERS FOR MODULES IDCRD07     */ 04132000
*        /*                   AND IDCRD06 RESPECTIVELY               */ 04133000
*        /*                                                          */ 04134000
*        /*    REGISTER CONVENTIONS - SEE GLOBAL DATA AREA (AMSDF00) */ 04135000
*        /*                                                          */ 04136000
*        /*    PATCH LABEL - 'UPATCHIT'                              */ 04137000
*        /*                                                          */ 04138000
*        /* ENTRY POINT - MODDSOUT(ONLY ENTRY POINT)                 */ 04139000
*        /*                                                          */ 04140000
*        /*    PURPOSE - INVOKED TO PERFORM THE REPAIRV FSR          */ 04141000
*        /*    MODIFY  FUNCTION WHEN THE OUTPUT IS A RECORD          */ 04142000
*        /*    IN A DATA SET OR VTOCHEADER                           */ 04143000
*        /*                                                          */ 04144000
*        /*    LINKAGE - 'CALL MODDSOUT'                             */ 04145000
*        /*                                                          */ 04146000
*        /*    INPUT -                                               */ 04147000
*        /*                                                          */ 04148000
*        /*      THE INPUT DATA CAN BE AS FOLLOWS.                   */ 04149000
*        /*       A) DATA STRING SPECFIED IN THE COMMAND             */ 04150000
*        /*       B) A RECORD IN A DATA SET                          */ 04151000
*        /*       C) A RECORD IN A REPAIR WORKFILE                   */ 04152000
*        /*                                                          */ 04153000
*        /*    OUTPUT -                                              */ 04154000
*        /*                                                          */ 04155000
*        /*      THE OUTPUT CAN BE AS FOLLOWS                        */ 04156000
*        /*       A) A MODIFIED RECORD ON A DATA SET                 */ 04157000
*        /*       B) A MODIFIED RECORD IN A VTOCHEADER               */ 04158000
*        /*                                                          */ 04159000
*        /*      ERROR MESSAGES: IDC31230I                           */ 04160000
*        /*                      IDC31231I                           */ 04161000
*        /*                      IDC31232I                           */ 04162000
*        /*                      IDC31241I                           */ 04163000
*        /*                      IDC31242I                           */ 04164000
*        /*                      IDC31243I                           */ 04165000
*        /*                                                          */ 04166000
*        /*    EXIT, NORMAL -                                        */ 04167000
*        /*                                                          */ 04168000
*        /*      LASTCC = 00        FUNCTION COMPLETED SUCCESSFULLY  */ 04169000
*        /*                                                          */ 04170000
*        /*    EXIT, ERROR -                                         */ 04171000
*        /*                                                          */ 04172000
*        /*      LASTCC = 12        FUNCTION COULD NOT COMPLETE      */ 04173000
*        /*                                                          */ 04174000
*        /* INTERNAL REFERENCES -                                    */ 04175000
*        /*    PROCEDURES/SUBROUTINES CALLED                         */ 04176000
*        /*                                                          */ 04177000
*        /*    MODCLFP  - CLOSE FILES AND FREE POOLS SUBROUTINE      */ 04178000
*        /*                                                          */ 04179000
*        /* EXTERNAL REFERENCES -                                    */ 04180000
*        /*    MACROS/SVCS -                                         */ 04181000
*        /*                                                          */ 04182000
*        /*    UGPOOL - IDCAMS SYSTEM ADAPTER FREE POOL RUTINE       */ 04183000
*        /*      OBTAINS DYNAMIC STORAGE FOR I/O BUFFERS             */ 04184000
*        /*      GENERATES A CALL TO MODULE IDCSAGP                  */ 04185000
*        /*                                                          */ 04186000
*        /*    UEXCP  - IDCAMS I/O ADAPTER EXCP ROUTINE              */ 04187000
*        /*      TO WRITE DATA SET OR VTOCHEADER RECORDS             */ 04188000
*        /*      GENERATES A CALL TO MODULE IDCSADQO                 */ 04189000
*        /*                                                          */ 04190000
*        /*    ?CALLCKER - REPAIRV WRITE MESSAGE ROUTINE             */ 04191000
*        /*      WRITES ALL MESSAGES                                 */ 04192000
*        /*      GENERATES A CALL TO MODULE IDCRDER                  */ 04193000
*        /*                                                          */ 04194000
*        /*    ?MOVELONG - REPAIRV MVCL MACRO                        */ 04195000
*        /*      EXECUTES MVCL INSTRUCTION WITH GPR'S 2,3,4 & 5      */ 04196000
*        /*                                                          */ 04197000
*        /* PROCEDURES/SUBROUTINES CALLED                            */ 04198000
*        /*                                                          */ 04199000
*        /*    NONE                                                  */ 04200000
*        /*                                                          */ 04201000
*        /************************************************************/ 04202000
*                                                                  1231 04203000
*        /************************************************************/ 04204000
*        /*  HERE BEGINS THE CODE FOR MODDSOUT                       */ 04205000
*        /************************************************************/ 04206000
*        OLDERID2 = NEWERID2;                                      1231 04207000
         L     @15,@PC00001                                        1231 04208000
         L     @01,GDTTR2(,@15)                                    1231 04209000
         L     @15,@PC00001                                        1231 04210000
         L     @15,GDTTR2(,@15)                                    1231 04211000
         MVC   @TS00001(95),NEWERID2(@15)                          1231 04212000
         MVC   OLDERID2(95,@01),@TS00001                           1231 04213000
*        NEWID2='RD55';                                            1232 04214000
         L     @15,@PC00001                                        1232 04215000
         L     @01,GDTTR2(,@15)                                    1232 04216000
         MVC   NEWID2(4,@01),@CC02110                              1232 04217000
*        IF GDTDBG = NULLPTR                                       1233 04218000
*          THEN;                                                   1233 04219000
         L     @15,@PC00001                                        1233 04220000
         L     @15,GDTDBG(,@15)                                    1233 04221000
         LTR   @15,@15                                             1233 04222000
         BZ    @RT01233                                            1233 04223000
*          ELSE                                                    1235 04224000
*            CALL IDCDB010(GDTTBL,'RD54');                         1235 04225000
*                                                                  1235 04226000
         L     @15,@PC00001                                        1235 04227000
         ST    @15,@AL00001                                        1235 04228000
         LA    @15,@CC02111                                        1235 04229000
         ST    @15,@AL00001+4                                      1235 04230000
         MVI   @AL00001+4,X'80'                                    1235 04231000
         L     @14,@PC00001                                        1235 04232000
         L     @15,GDTDBG(,@14)                                    1235 04233000
         LA    @01,@AL00001                                        1235 04234000
         BALR  @14,@15                                             1235 04235000
*        /************************************************************/ 04236000
*        /*  INITIALIZE FORMAT WRITE SWITCH TO NO FORMAT WRITE       */ 04237000
*        /************************************************************/ 04238000
*        FWSW = NOT;                                               1236 04239000
*                                                                  1236 04240000
@RT01233 MVI   FWSW,X'00'                                          1236 04241000
*        /************************************************************/ 04242000
*        /*                                                          */ 04243000
*        /*  CHECK IF OVERFLOW SPECIFIED AS INPUT PARAMETER          */ 04244000
*        /*                                                          */ 04245000
*        /************************************************************/ 04246000
*        IF ADDR(MOVFL) ^= NULLPTR                                 1237 04247000
*          THEN                                                    1237 04248000
         L     @15,@PC00001+4                                      1237 04249000
         L     @15,FDTPTR+420(,@15)                                1237 04250000
         LTR   @15,@15                                             1237 04251000
         BZ    @RF01237                                            1237 04252000
*            DO;                                                   1238 04253000
*                                                                  1238 04254000
*            /********************************************************/ 04255000
*            /*                                                      */ 04256000
*            /*  WRITE SPECIAL FROM OUTPUT BUFFER                    */ 04257000
*            /*                                                      */ 04258000
*            /*                                                      */ 04259000
*            /********************************************************/ 04260000
*                                                                  1239 04261000
*            /********************************************************/ 04262000
*            /*                                                      */ 04263000
*            /*  BUILD IDCRDRD ARGUMENT LIST (RDARG)                 */ 04264000
*            /*                                                      */ 04265000
*            /*                                                      */ 04266000
*            /********************************************************/ 04267000
*                                                                  1239 04268000
*            RDCHR = RB1CCHR;                                      1239 04269000
         L     @15,@PC00001+8                                      1239 04270000
         L     @01,REPODSAR(,@15)                                  1239 04271000
         L     @15,BFPTROUT                                        1239 04272000
         MVC   RDCHR(5,@01),RB1CCHR(@15)                           1239 04273000
*            RDDS = ZERO;                                          1240 04274000
         L     @15,@PC00001+8                                      1240 04275000
         L     @01,REPODSAR(,@15)                                  1240 04276000
         MVI   RDDS(@01),X'00'                                     1240 04277000
*            RDFUNC = RITEOVFL;                                    1241 04278000
         L     @15,@PC00001+8                                      1241 04279000
         L     @01,REPODSAR(,@15)                                  1241 04280000
         MVI   RDFUNC(@01),X'02'                                   1241 04281000
*            RDCTLBK = REPODSOP;                                   1242 04282000
         L     @15,@PC00001+8                                      1242 04283000
         L     @01,REPODSAR(,@15)                                  1242 04284000
         L     @15,@PC00001+8                                      1242 04285000
         L     @00,REPODSOP(,@15)                                  1242 04286000
         ST    @00,RDCTLBK(,@01)                                   1242 04287000
*            RDIOAREA = BFPTROUT;                                  1243 04288000
         L     @15,@PC00001+8                                      1243 04289000
         L     @01,REPODSAR(,@15)                                  1243 04290000
         L     @00,BFPTROUT                                        1243 04291000
         ST    @00,RDIOAREA(,@01)                                  1243 04292000
*            RB1NUM = 1;                                           1244 04293000
*                                                                  1244 04294000
         L     @01,BFPTROUT                                        1244 04295000
         MVC   RB1NUM(4,@01),@CF00221                              1244 04296000
*            /********************************************************/ 04297000
*            /*                                                      */ 04298000
*            /*  CALL UEXCP TO WRITE SPECIAL ONE RECORD AND RETURN   */ 04299000
*            /*                                                      */ 04300000
*            /********************************************************/ 04301000
*            CALL IDCIO050(GDTTBL,WRITEREC,RDARG);                 1245 04302000
         L     @15,@PC00001                                        1245 04303000
         ST    @15,@AL00001                                        1245 04304000
         LA    @15,WRITEREC                                        1245 04305000
         ST    @15,@AL00001+4                                      1245 04306000
         L     @15,@PC00001+8                                      1245 04307000
         L     @01,REPODSAR(,@15)                                  1245 04308000
         ST    @01,@AL00001+8                                      1245 04309000
         MVI   @AL00001+8,X'80'                                    1245 04310000
         L     @14,@PC00001                                        1245 04311000
         L     @15,GDTEXP(,@14)                                    1245 04312000
         LA    @01,@AL00001                                        1245 04313000
         BALR  @14,@15                                             1245 04314000
*            RESPECIFY RTNREG RSTD;                                1246 04315000
*            TESTRC = RTNREG;                                      1247 04316000
         STH   RTNREG,TESTRC                                       1247 04317000
*            RESPECIFY RTNREG UNRSTD;                              1248 04318000
*            IF TESTRC ^= 0                                        1249 04319000
*              THEN                                                1249 04320000
         LH    @15,TESTRC                                          1249 04321000
         LTR   @15,@15                                             1249 04322000
         BZ    @RF01249                                            1249 04323000
*                DO;                                               1250 04324000
*                                                                  1250 04325000
*                /****************************************************/ 04326000
*                /*                                                  */ 04327000
*                /* ISSUE MSG IDC31245I - I/O ERROR WHILE MODIFYING  */ 04328000
*                /*    TRACK                                         */ 04329000
*                /*                                                  */ 04330000
*                /****************************************************/ 04331000
*                                                                  1251 04332000
*                 DO;                                              1251 04333000
*                   CKREQ = CKREQ && CKREQ;                        1252 04334000
         L     @15,@PC00001+8                                      1252 04335000
         XC    CKREQ(44,@15),CKREQ(@15)                            1252 04336000
*                   CKRERN = MSG45;                                1253 04337000
         L     @15,@PC00001+8                                      1253 04338000
         MVC   CKRERN(2,@15),@CH00767                              1253 04339000
*                   CKRMVAR(1) = ADDR(RDCHR);                      1254 04340000
         L     @15,@PC00001+8                                      1254 04341000
         L     @14,@PC00001+8                                      1254 04342000
         L     @01,REPODSAR(,@14)                                  1254 04343000
         LA    @14,RDCHR(,@01)                                     1254 04344000
         ST    @14,CKRMVAR(,@15)                                   1254 04345000
*                   CKRMVAR(2) = ADDR(DSNMSG);                     1255 04346000
         L     @15,@PC00001+8                                      1255 04347000
         LA    @14,DSNMSG                                          1255 04348000
         ST    @14,CKRMVAR+4(,@15)                                 1255 04349000
*                   CALL IDCRDER;                                  1256 04350000
         L     @15,@CV01811                                        1256 04351000
         BALR  @14,@15                                             1256 04352000
*                 END;                                             1257 04353000
*                RETURN CODE(LASTCC12);                            1258 04354000
         LA    @15,12                                              1258 04355000
         L     @14,@SA00005                                        1258 04356000
         LM    @00,@12,@SA00005+8                                  1258 04357000
         BR    @14                                                 1258 04358000
*                END;                                              1259 04359000
*              ELSE                                                1260 04360000
*                RETURN CODE(LASTCC00);                            1260 04361000
@RF01249 SLR   @15,@15                                             1260 04362000
         L     @14,@SA00005                                        1260 04363000
         LM    @00,@12,@SA00005+8                                  1260 04364000
         BR    @14                                                 1260 04365000
*            END;                                                  1261 04366000
*          ELSE;                                                   1262 04367000
*                                                                  1262 04368000
@RF01237 DS    0H                                                  1263 04369000
*        /************************************************************/ 04370000
*        /*                                                          */ 04371000
*        /* OVERFLOW NOT INPUT PARAMETER                             */ 04372000
*        /*  CHECK IF INPUT COMING FROM RWF OR DATA SET              */ 04373000
*        /*                                                          */ 04374000
*        /************************************************************/ 04375000
*        IF BFPTRIN ^= NULLPTR                                     1263 04376000
*          THEN                                                    1263 04377000
         L     @15,BFPTRIN                                         1263 04378000
         LTR   @15,@15                                             1263 04379000
         BZ    @RF01263                                            1263 04380000
*            DO;                                                   1264 04381000
*                                                                  1264 04382000
*            /********************************************************/ 04383000
*            /*  INPUT FROM DATA SET  OR VTOCHEADER                  */ 04384000
*            /*  SET NUMBER OF RECORDS TO WRITE AS ONE AND           */ 04385000
*            /*  SET FORMAT WRITE SWITCH                             */ 04386000
*            /*                                                      */ 04387000
*            /********************************************************/ 04388000
*            RB3NUM = 1;                                           1265 04389000
         L     @01,BFPTRIN                                         1265 04390000
         MVC   RB3NUM(4,@01),@CF00221                              1265 04391000
*            RB3CCHR = RB1CCHR;                                    1266 04392000
         L     @01,BFPTRIN                                         1266 04393000
         L     @15,BFPTROUT                                        1266 04394000
         MVC   RB3CCHR(5,@01),RB1CCHR(@15)                         1266 04395000
*            FWSW = YESS;                                          1267 04396000
         MVI   FWSW,X'01'                                          1267 04397000
*            END;                                                  1268 04398000
*                                                                  1268 04399000
*          ELSE                                                    1269 04400000
*                                                                  1269 04401000
*            /********************************************************/ 04402000
*            /* USER SUPPLIED INPUT INFORMATION                      */ 04403000
*            /* FIRST GET ENOUGH SPACE TO BUILD NEW INPUT BUFFER     */ 04404000
*            /* EQUAL TO DEVICE TRACK SIZE + 510 +4, WHERE 510 ALLOWS*/ 04405000
*            /* TO INCREASE KEY AND DATA BY 255 AND 4 IS NUMBER OF   */ 04406000
*            /* RECORDS IN FRONT OF BUFFER                           */ 04407000
*            /*                                                      */ 04408000
*            /********************************************************/ 04409000
*            DO;                                                   1269 04410000
         B     @RC01263                                            1269 04411000
@RF01263 DS    0H                                                  1270 04412000
*            RESPECIFY DEVAREA BASED(REPODEVA);                    1270 04413000
*            INFTC=DEVTC+ CNST04+CNST510;                          1271 04414000
         L     @15,@PC00001+8                                      1271 04415000
         L     @01,REPODEVA(,@15)                                  1271 04416000
         LA    @00,514                                             1271 04417000
         LH    @01,DEVTC(,@01)                                     1271 04418000
         N     @01,@CF02153                                        1271 04419000
         ALR   @00,@01                                             1271 04420000
         ST    @00,INFTC                                           1271 04421000
*            CALL IDCSAGP0(GDTTBL,INFTC,BFPTRIN,RD01,SETZERO);     1272 04422000
         L     @15,@PC00001                                        1272 04423000
         ST    @15,@AL00001                                        1272 04424000
         LA    @15,INFTC                                           1272 04425000
         ST    @15,@AL00001+4                                      1272 04426000
         LA    @15,BFPTRIN                                         1272 04427000
         ST    @15,@AL00001+8                                      1272 04428000
         LA    @15,RD01                                            1272 04429000
         ST    @15,@AL00001+12                                     1272 04430000
         LA    @15,SETZERO                                         1272 04431000
         ST    @15,@AL00001+16                                     1272 04432000
         MVI   @AL00001+16,X'80'                                   1272 04433000
         L     @14,@PC00001                                        1272 04434000
         L     @15,GDTGPL(,@14)                                    1272 04435000
         LA    @01,@AL00001                                        1272 04436000
         BALR  @14,@15                                             1272 04437000
*            RESPECIFY RTNREG RSTD;                                1273 04438000
*            TESTRC = RTNREG;                                      1274 04439000
         STH   RTNREG,TESTRC                                       1274 04440000
*            RESPECIFY RTNREG UNRSTD;                              1275 04441000
*                                                                  1275 04442000
*            /********************************************************/ 04443000
*            /* CHECK THE RETURN CODE FROM UGPPOL                    */ 04444000
*            /********************************************************/ 04445000
*            IF TESTRC ^= 0                                        1276 04446000
*              THEN                                                1276 04447000
*                                                                  1276 04448000
         LH    @15,TESTRC                                          1276 04449000
         LTR   @15,@15                                             1276 04450000
         BZ    @RF01276                                            1276 04451000
*                /****************************************************/ 04452000
*                /* BAD RC FROM UGPOOL.  RETURN WITH A RC = 12       */ 04453000
*                /****************************************************/ 04454000
*                RETURN CODE(LASTCC12);                            1277 04455000
         LA    @15,12                                              1277 04456000
         L     @14,@SA00005                                        1277 04457000
         LM    @00,@12,@SA00005+8                                  1277 04458000
         BR    @14                                                 1277 04459000
*              ELSE;                                               1278 04460000
*                                                                  1278 04461000
@RF01276 DS    0H                                                  1279 04462000
*            /********************************************************/ 04463000
*            /*  RETURN OK FROM GETTING CORE                         */ 04464000
*            /*  BUILD NEW RECORD IN NEW INPUT BUFFER                */ 04465000
*            /*                                                      */ 04466000
*            /*                                                      */ 04467000
*            /********************************************************/ 04468000
*            RFY RB3 BASED (BFPTRIN);                              1279 04469000
*                                                                  1279 04470000
*            /********************************************************/ 04471000
*            /* SET NUMBER OF RECORDS TO WRITE TO ONE                */ 04472000
*            /********************************************************/ 04473000
*            RB3NUM = 1;                                           1280 04474000
*                                                                  1280 04475000
         L     @01,BFPTRIN                                         1280 04476000
         MVC   RB3NUM(4,@01),@CF00221                              1280 04477000
*            /********************************************************/ 04478000
*            /*                                                      */ 04479000
*            /*  CHECK TO SEE IF USER SPECIFIED COUNT                */ 04480000
*            /*                                                      */ 04481000
*            /********************************************************/ 04482000
*            IF ADDR(MNCNT) ^= NULLPTR                             1281 04483000
*              THEN                                                1281 04484000
         L     @15,@PC00001+4                                      1281 04485000
         L     @15,FDTPTR+368(,@15)                                1281 04486000
         LTR   @15,@15                                             1281 04487000
         BZ    @RF01281                                            1281 04488000
*                DO;                                               1282 04489000
*                                                                  1282 04490000
*                /****************************************************/ 04491000
*                /* USER SUPPLIED COUNT FIELD                        */ 04492000
*                /* ENSURE ITS LENGTH IS EXACTLY EIGHT BYTES         */ 04493000
*                /* IF ITS NOT - ISSUE MESSAGE AND RETURN CODE 12    */ 04494000
*                /****************************************************/ 04495000
*                IF MNCNTLEN ^= COUNTLN                            1283 04496000
*                  THEN                                            1283 04497000
*                                                                  1283 04498000
         L     @15,@PC00001+4                                      1283 04499000
         L     @01,FDTPTR+368(,@15)                                1283 04500000
         CLI   MNCNTLEN(@01),8                                     1283 04501000
         BE    @RF01283                                            1283 04502000
*                    /************************************************/ 04503000
*                    /* BAD NEWCOUNT LENGTH.  ISSUE MESSAGE IDC31241I*/ 04504000
*                    /************************************************/ 04505000
*                    DO;                                           1284 04506000
*                                                                  1284 04507000
*                     DO;                                          1285 04508000
*                       CKREQ = CKREQ && CKREQ;                    1286 04509000
         L     @15,@PC00001+8                                      1286 04510000
         XC    CKREQ(44,@15),CKREQ(@15)                            1286 04511000
*                       CKRERN = MSG41;                            1287 04512000
         L     @15,@PC00001+8                                      1287 04513000
         MVC   CKRERN(2,@15),@CH00736                              1287 04514000
*                       CALL IDCRDER;                              1288 04515000
         L     @15,@CV01811                                        1288 04516000
         BALR  @14,@15                                             1288 04517000
*                     END;                                         1289 04518000
*                    RETURN CODE(LASTCC12);                        1290 04519000
         LA    @15,12                                              1290 04520000
         L     @14,@SA00005                                        1290 04521000
         LM    @00,@12,@SA00005+8                                  1290 04522000
         BR    @14                                                 1290 04523000
*                    END;                                          1291 04524000
*                  ELSE;                                           1292 04525000
*                                                                  1292 04526000
@RF01283 DS    0H                                                  1293 04527000
*                /****************************************************/ 04528000
*                /*                                                  */ 04529000
*                /* MOVE USER SPECIFIED COUNT INTO NEW INPUT         */ 04530000
*                /* COUNT FIELD AND SET FORMAT WRITE SWITCH ON       */ 04531000
*                /*                                                  */ 04532000
*                /****************************************************/ 04533000
*                RB3C = MNCNTVAL;                                  1293 04534000
         L     @01,BFPTRIN                                         1293 04535000
         L     @15,@PC00001+4                                      1293 04536000
         L     @15,FDTPTR+368(,@15)                                1293 04537000
         MVC   RB3C(8,@01),MNCNTVAL(@15)                           1293 04538000
*                FWSW = YESS;                                      1294 04539000
         MVI   FWSW,X'01'                                          1294 04540000
*                END;                                              1295 04541000
*                                                                  1295 04542000
*              ELSE                                                1296 04543000
*                                                                  1296 04544000
*                /****************************************************/ 04545000
*                /*  USER DIDNT SPECIFY COUNT - MOVE ORIGINAL        */ 04546000
*                /*   COUNT FIELD INTO NEW INPUT BUFFER              */ 04547000
*                /****************************************************/ 04548000
*                RB3C = RB1C;                                      1296 04549000
*                                                                  1296 04550000
         B     @RC01281                                            1296 04551000
@RF01281 L     @01,BFPTRIN                                         1296 04552000
         L     @15,BFPTROUT                                        1296 04553000
         MVC   RB3C(8,@01),RB1C(@15)                               1296 04554000
*            /********************************************************/ 04555000
*            /*                                                      */ 04556000
*            /*   CHECK IF USER SPECIFIED NEWKEY PARAMETER           */ 04557000
*            /*                                                      */ 04558000
*            /*                                                      */ 04559000
*            /********************************************************/ 04560000
*            IF ADDR(MNKEY) ^= NULLPTR                             1297 04561000
*              THEN                                                1297 04562000
*                                                                  1297 04563000
@RC01281 L     @15,@PC00001+4                                      1297 04564000
         L     @15,FDTPTR+364(,@15)                                1297 04565000
         LTR   @15,@15                                             1297 04566000
         BZ    @RF01297                                            1297 04567000
*                /****************************************************/ 04568000
*                /*USER SPECIFIED KEY INFORMATION - ENSURE THAT      */ 04569000
*                /*THE OFFSET VALUE INTO THE KEY THAT HE WISHES TO   */ 04570000
*                /*MODIFY IS WITHIN RANGE OF OLD KEY                 */ 04571000
*                /****************************************************/ 04572000
*                DO;                                               1298 04573000
*                IF MNKOFVAL >(RB1CKL+1) | (MNKOFVAL+MNKSTLEN-1) > 1299 04574000
*                  KEYMAXLN                                        1299 04575000
*                  THEN                                            1299 04576000
*                                                                  1299 04577000
         L     @15,@PC00001+4                                      1299 04578000
         L     @01,FDTPTR+472(,@15)                                1299 04579000
         LA    @00,1                                               1299 04580000
         L     @15,BFPTROUT                                        1299 04581000
         SLR   @14,@14                                             1299 04582000
         IC    @14,RB1CKL(,@15)                                    1299 04583000
         ALR   @00,@14                                             1299 04584000
         C     @00,MNKOFVAL(,@01)                                  1299 04585000
         BL    @RT01299                                            1299 04586000
         L     @15,@PC00001+4                                      1299 04587000
         L     @01,FDTPTR+472(,@15)                                1299 04588000
         L     @15,@PC00001+4                                      1299 04589000
         L     @15,FDTPTR+476(,@15)                                1299 04590000
         SLR   @14,@14                                             1299 04591000
         IC    @14,MNKSTLEN(,@15)                                  1299 04592000
         AL    @14,MNKOFVAL(,@01)                                  1299 04593000
         BCTR  @14,0                                               1299 04594000
         C     @14,@CF00987                                        1299 04595000
         BNH   @RF01299                                            1299 04596000
@RT01299 DS    0H                                                  1300 04597000
*                    /************************************************/ 04598000
*                    /* BAD OFFSET ISSUE MESSAGE IDC31230I AND RETURN*/ 04599000
*                    /************************************************/ 04600000
*                    DO;                                           1300 04601000
*                                                                  1300 04602000
*                     DO;                                          1301 04603000
*                       CKREQ = CKREQ && CKREQ;                    1302 04604000
         L     @15,@PC00001+8                                      1302 04605000
         XC    CKREQ(44,@15),CKREQ(@15)                            1302 04606000
*                       CKRERN = MSG30;                            1303 04607000
         L     @15,@PC00001+8                                      1303 04608000
         MVC   CKRERN(2,@15),@CH00698                              1303 04609000
*                       CKRMVAR(1) = ADDR(MNKOFVAL);               1304 04610000
         L     @15,@PC00001+8                                      1304 04611000
         L     @14,@PC00001+4                                      1304 04612000
         L     @14,FDTPTR+472(,@14)                                1304 04613000
         ST    @14,CKRMVAR(,@15)                                   1304 04614000
*                       CALL IDCRDER;                              1305 04615000
         L     @15,@CV01811                                        1305 04616000
         BALR  @14,@15                                             1305 04617000
*                     END;                                         1306 04618000
*                    RETURN CODE(LASTCC12);                        1307 04619000
         LA    @15,12                                              1307 04620000
         L     @14,@SA00005                                        1307 04621000
         LM    @00,@12,@SA00005+8                                  1307 04622000
         BR    @14                                                 1307 04623000
*                    END;                                          1308 04624000
*                                                                  1308 04625000
*                  ELSE;                                           1309 04626000
*                                                                  1309 04627000
@RF01299 DS    0H                                                  1310 04628000
*                /****************************************************/ 04629000
*                /*  MOVE NEW KEY TO INPUT BUFFER                    */ 04630000
*                /*  IF ORIGINAL KEY LENGTH NOT EQUAL TO ZERO        */ 04631000
*                /****************************************************/ 04632000
*                IF RB1CKL ^= ZERO                                 1310 04633000
*                  THEN                                            1310 04634000
*                                                                  1310 04635000
         L     @01,BFPTROUT                                        1310 04636000
         CLI   RB1CKL(@01),0                                       1310 04637000
         BE    @RF01310                                            1310 04638000
*                    /************************************************/ 04639000
*                    /*NON ZERO ORIGINAL KEY - MOVE INTO NEW INPUT   */ 04640000
*                    /* BUFFER SO CAN MODIFY FROM OFFSET             */ 04641000
*                    /************************************************/ 04642000
*                    RB3KD(1:RB1CKL)= RB1KD(1:RB1CKL);             1311 04643000
*                                                                  1311 04644000
         L     @01,BFPTRIN                                         1311 04645000
         L     @15,BFPTROUT                                        1311 04646000
         SLR   @14,@14                                             1311 04647000
         IC    @14,RB1CKL(,@15)                                    1311 04648000
         BCTR  @14,0                                               1311 04649000
         L     @15,BFPTROUT                                        1311 04650000
         EX    @14,@SM02162                                        1311 04651000
*                  ELSE;                                           1312 04652000
*                                                                  1312 04653000
@RF01310 DS    0H                                                  1313 04654000
*                /****************************************************/ 04655000
*                /*                                                  */ 04656000
*                /* MOVE INPUT KEY STRING TO NEW INPUT BUFFER        */ 04657000
*                /*                                                  */ 04658000
*                /****************************************************/ 04659000
*                RB3KD (MNKOFVAL:(MNKSTLEN + MNKOFVAL - 1))        1313 04660000
*                                          = MNKSTVAL;             1313 04661000
*                                                                  1313 04662000
         L     @15,@PC00001+4                                      1313 04663000
         L     @01,FDTPTR+472(,@15)                                1313 04664000
         L     @01,MNKOFVAL(,@01)                                  1313 04665000
         L     @15,BFPTRIN                                         1313 04666000
         ALR   @15,@01                                             1313 04667000
         L     @14,@PC00001+4                                      1313 04668000
         L     @01,FDTPTR+476(,@14)                                1313 04669000
         L     @14,@PC00001+4                                      1313 04670000
         L     @14,FDTPTR+472(,@14)                                1313 04671000
         SLR   @05,@05                                             1313 04672000
         IC    @05,MNKSTLEN(,@01)                                  1313 04673000
         AL    @05,MNKOFVAL(,@14)                                  1313 04674000
         L     @14,@PC00001+4                                      1313 04675000
         L     @01,FDTPTR+472(,@14)                                1313 04676000
         SL    @05,MNKOFVAL(,@01)                                  1313 04677000
         BCTR  @05,0                                               1313 04678000
         L     @14,@PC00001+4                                      1313 04679000
         L     @01,FDTPTR+476(,@14)                                1313 04680000
         EX    @05,@SM02164                                        1313 04681000
*                /****************************************************/ 04682000
*                /*                                                  */ 04683000
*                /* CK IF RECORD WILL EXPAND  AND IF IT DOES, SET    */ 04684000
*                /* THE NEW KEYLENGTH IN RB3CKL AND SET FWSW ON      */ 04685000
*                /*                                                  */ 04686000
*                /****************************************************/ 04687000
*                IF RB1CKL < (MNKOFVAL + MNKSTLEN - 1) | RB1CKL = ZERO  04688000
*                  THEN                                            1314 04689000
         L     @15,@PC00001+4                                      1314 04690000
         L     @01,FDTPTR+472(,@15)                                1314 04691000
         L     @15,@PC00001+4                                      1314 04692000
         L     @15,FDTPTR+476(,@15)                                1314 04693000
         SLR   @14,@14                                             1314 04694000
         IC    @14,MNKSTLEN(,@15)                                  1314 04695000
         AL    @14,MNKOFVAL(,@01)                                  1314 04696000
         BCTR  @14,0                                               1314 04697000
         L     @01,BFPTROUT                                        1314 04698000
         SLR   @00,@00                                             1314 04699000
         IC    @00,RB1CKL(,@01)                                    1314 04700000
         CR    @14,@00                                             1314 04701000
         BH    @RT01314                                            1314 04702000
         L     @01,BFPTROUT                                        1314 04703000
         CLI   RB1CKL(@01),0                                       1314 04704000
         BNE   @RF01314                                            1314 04705000
@RT01314 DS    0H                                                  1315 04706000
*                    DO;                                           1315 04707000
*                    FWSW = 1;                                     1316 04708000
         MVI   FWSW,X'01'                                          1316 04709000
*                    RB3CKL = MNKOFVAL + MNKSTLEN - 1;             1317 04710000
         L     @15,@PC00001+4                                      1317 04711000
         L     @01,FDTPTR+472(,@15)                                1317 04712000
         L     @15,@PC00001+4                                      1317 04713000
         L     @15,FDTPTR+476(,@15)                                1317 04714000
         SLR   @14,@14                                             1317 04715000
         IC    @14,MNKSTLEN(,@15)                                  1317 04716000
         AL    @14,MNKOFVAL(,@01)                                  1317 04717000
         BCTR  @14,0                                               1317 04718000
         L     @15,BFPTRIN                                         1317 04719000
         STC   @14,RB3CKL(,@15)                                    1317 04720000
*                    END;                                          1318 04721000
*                  ELSE;                                           1319 04722000
*                                                                  1319 04723000
@RF01314 DS    0H                                                  1320 04724000
*                /****************************************************/ 04725000
*                /*                                                  */ 04726000
*                /*   END OF USER SPECIFIED NEWKEY                   */ 04727000
*                /*                                                  */ 04728000
*                /****************************************************/ 04729000
*                END;                                              1320 04730000
*                                                                  1320 04731000
*            /********************************************************/ 04732000
*            /*                                                      */ 04733000
*            /*  USER DID NOT SPECIFY KEY - MOVE KEY FROM ORIGINAL   */ 04734000
*            /*   OUTPUT BUFFER                                      */ 04735000
*            /*                                                      */ 04736000
*            /********************************************************/ 04737000
*              ELSE                                                1321 04738000
*                RB3KD(1:RB3CKL) = RB1KD(1:RB3CKL);                1321 04739000
*                                                                  1321 04740000
         B     @RC01297                                            1321 04741000
@RF01297 L     @01,BFPTRIN                                         1321 04742000
         L     @15,BFPTRIN                                         1321 04743000
         SLR   @14,@14                                             1321 04744000
         IC    @14,RB3CKL(,@15)                                    1321 04745000
         BCTR  @14,0                                               1321 04746000
         L     @15,BFPTROUT                                        1321 04747000
         EX    @14,@SM02162                                        1321 04748000
*            /********************************************************/ 04749000
*            /*                                                      */ 04750000
*            /*  MOVE DATA FROM OUTPUT BUFFER(RB3) TO RB1            */ 04751000
*            /*                                                      */ 04752000
*            /********************************************************/ 04753000
*            TEMPB1PT = ADDR(RB1KD) + RB1CKL;                      1322 04754000
@RC01297 L     @01,BFPTROUT                                        1322 04755000
         LA    @15,RB1KD(,@01)                                     1322 04756000
         L     @14,BFPTROUT                                        1322 04757000
         SLR   @05,@05                                             1322 04758000
         IC    @05,RB1CKL(,@14)                                    1322 04759000
         ALR   @15,@05                                             1322 04760000
         ST    @15,TEMPB1PT                                        1322 04761000
*            TEMPB3PT = ADDR(RB3KD) + RB3CKL;                      1323 04762000
*                                                                  1323 04763000
         L     @01,BFPTRIN                                         1323 04764000
         LA    @15,RB3KD(,@01)                                     1323 04765000
         L     @14,BFPTRIN                                         1323 04766000
         SLR   @05,@05                                             1323 04767000
         IC    @05,RB3CKL(,@14)                                    1323 04768000
         ALR   @15,@05                                             1323 04769000
         ST    @15,TEMPB3PT                                        1323 04770000
*             RFY (REG2,REG3,REG4,REG5) RSTD;                      1324 04771000
*             REG2 = TEMPB3PT;                                     1325 04772000
         L     REG2,TEMPB3PT                                       1325 04773000
*             REG3 = RB1CDL;                                       1326 04774000
         L     @01,BFPTROUT                                        1326 04775000
         LH    REG3,RB1CDL(,@01)                                   1326 04776000
         N     REG3,@CF02153                                       1326 04777000
*             REG4 = TEMPB1PT;                                     1327 04778000
         L     REG4,TEMPB1PT                                       1327 04779000
*             REG5 = RB1CDL;                                       1328 04780000
         L     @01,BFPTROUT                                        1328 04781000
         LH    REG5,RB1CDL(,@01)                                   1328 04782000
         N     REG5,@CF02153                                       1328 04783000
*             MVCL (REG2,REG4);                                    1329 04784000
         MVCL  REG2,REG4                                           1329 04785000
*             RFY(REG2,REG3,REG4,REG5) UNRSTD;                     1330 04786000
*                                                                  1330 04787000
*            /********************************************************/ 04788000
*            /* CHECK IF USER SPECIFIED NEWDATA PARAMETER            */ 04789000
*            /********************************************************/ 04790000
*            IF ADDR(MNDAT) = NULLPTR                              1331 04791000
*              THEN;                                               1331 04792000
         L     @15,@PC00001+4                                      1331 04793000
         L     @15,FDTPTR+360(,@15)                                1331 04794000
         LTR   @15,@15                                             1331 04795000
         BZ    @RT01331                                            1331 04796000
*              ELSE                                                1333 04797000
*                                                                  1333 04798000
*                /****************************************************/ 04799000
*                /*                                                  */ 04800000
*                /*USER SPECIFIED DATA - CHECK IF INPUT IS OK        */ 04801000
*                /*IF OFFSET GREATER THAN DATA LENGTH- INPUT NOT OK */  04802000
*                /*                                                  */ 04803000
*                /****************************************************/ 04804000
*                DO;                                               1333 04805000
*                IF MNDOFVAL > RB1CDL + 1                          1334 04806000
*                  THEN                                            1334 04807000
*                                                                  1334 04808000
         L     @15,@PC00001+4                                      1334 04809000
         L     @01,FDTPTR+464(,@15)                                1334 04810000
         LA    @00,1                                               1334 04811000
         L     @15,BFPTROUT                                        1334 04812000
         LH    @15,RB1CDL(,@15)                                    1334 04813000
         N     @15,@CF02153                                        1334 04814000
         ALR   @00,@15                                             1334 04815000
         C     @00,MNDOFVAL(,@01)                                  1334 04816000
         BNL   @RF01334                                            1334 04817000
*                    /************************************************/ 04818000
*                    /* BAD NEWDATA OFFSET. ISSUE MSG IDC31230 AND   */ 04819000
*                    /*  RETURN WITH A RC = 12                       */ 04820000
*                    /************************************************/ 04821000
*                    DO;                                           1335 04822000
*                                                                  1335 04823000
*                     DO;                                          1336 04824000
*                       CKREQ = CKREQ && CKREQ;                    1337 04825000
         L     @15,@PC00001+8                                      1337 04826000
         XC    CKREQ(44,@15),CKREQ(@15)                            1337 04827000
*                       CKRERN = MSG30;                            1338 04828000
         L     @15,@PC00001+8                                      1338 04829000
         MVC   CKRERN(2,@15),@CH00698                              1338 04830000
*                       CKRMVAR(1) = ADDR(MNDOFVAL);               1339 04831000
         L     @15,@PC00001+8                                      1339 04832000
         L     @14,@PC00001+4                                      1339 04833000
         L     @14,FDTPTR+464(,@14)                                1339 04834000
         ST    @14,CKRMVAR(,@15)                                   1339 04835000
*                       CALL IDCRDER;                              1340 04836000
         L     @15,@CV01811                                        1340 04837000
         BALR  @14,@15                                             1340 04838000
*                     END;                                         1341 04839000
*                    RETURN CODE(LASTCC12);                        1342 04840000
         LA    @15,12                                              1342 04841000
         L     @14,@SA00005                                        1342 04842000
         LM    @00,@12,@SA00005+8                                  1342 04843000
         BR    @14                                                 1342 04844000
*                    END;                                          1343 04845000
*                                                                  1343 04846000
*                  ELSE;                                           1344 04847000
*                                                                  1344 04848000
@RF01334 DS    0H                                                  1345 04849000
*                /****************************************************/ 04850000
*                /* CALCULATE THE EXPANSION IN THE SIZE OF THE DATA  */ 04851000
*                /****************************************************/ 04852000
*                EXP = MNDOFVAL + MNDSTLEN - 1 - RB3CDL;           1345 04853000
*                                                                  1345 04854000
         L     @15,@PC00001+4                                      1345 04855000
         L     @01,FDTPTR+464(,@15)                                1345 04856000
         L     @15,@PC00001+4                                      1345 04857000
         L     @15,FDTPTR+468(,@15)                                1345 04858000
         SLR   @14,@14                                             1345 04859000
         IC    @14,MNDSTLEN(,@15)                                  1345 04860000
         AL    @14,MNDOFVAL(,@01)                                  1345 04861000
         BCTR  @14,0                                               1345 04862000
         L     @15,BFPTRIN                                         1345 04863000
         LH    @15,RB3CDL(,@15)                                    1345 04864000
         N     @15,@CF02153                                        1345 04865000
         SLR   @14,@15                                             1345 04866000
         STH   @14,EXP                                             1345 04867000
*                /****************************************************/ 04868000
*                /*                                                  */ 04869000
*                /*  IF EXP IS MORE THAN ZERO, EXP HAS THE LENGTH    */ 04870000
*                /*  INCREASE DUE TO THE NEWDATA PARAMETER           */ 04871000
*                /*                                                  */ 04872000
*                /****************************************************/ 04873000
*                IF EXP > ZERO                                     1346 04874000
*                  THEN                                            1346 04875000
         LH    @15,EXP                                             1346 04876000
         LTR   @15,@15                                             1346 04877000
         BNP   @RF01346                                            1346 04878000
*                    DO;                                           1347 04879000
*                    RB3CDL = RB3CDL + EXP;                        1348 04880000
         L     @01,BFPTRIN                                         1348 04881000
         LH    @15,RB3CDL(,@01)                                    1348 04882000
         N     @15,@CF02153                                        1348 04883000
         AH    @15,EXP                                             1348 04884000
         L     @14,BFPTRIN                                         1348 04885000
         STH   @15,RB3CDL(,@14)                                    1348 04886000
*                    FWSW = YESS;                                  1349 04887000
*                                                                  1349 04888000
         MVI   FWSW,X'01'                                          1349 04889000
*                    /************************************************/ 04890000
*                    /*  CHECK IF THE RECORD WITH THE INCREASED DATA */ 04891000
*                    /*  WILL FIT IN THE BUFFER                      */ 04892000
*                    /************************************************/ 04893000
*                    IF (COUNTLN+RB3CKL+RB3CDL) > DEVTC            1350 04894000
*                      THEN                                        1350 04895000
*                                                                  1350 04896000
         LA    @15,8                                               1350 04897000
         L     @14,BFPTRIN                                         1350 04898000
         SLR   @05,@05                                             1350 04899000
         IC    @05,RB3CKL(,@14)                                    1350 04900000
         ALR   @15,@05                                             1350 04901000
         L     @14,BFPTRIN                                         1350 04902000
         LH    @14,RB3CDL(,@14)                                    1350 04903000
         N     @14,@CF02153                                        1350 04904000
         ALR   @15,@14                                             1350 04905000
         L     @14,@PC00001+8                                      1350 04906000
         L     @01,REPODEVA(,@14)                                  1350 04907000
         LH    @14,DEVTC(,@01)                                     1350 04908000
         N     @14,@CF02153                                        1350 04909000
         CR    @15,@14                                             1350 04910000
         BNH   @RF01350                                            1350 04911000
*                        /********************************************/ 04912000
*                        /* RECORD WITH ADDITIONAL NEWDATA WILL NOT  */ 04913000
*                        /* FIT IN BUFFER.  ISSUE MSG IDC31232I AND  */ 04914000
*                        /* RETURN WITH A RC = 12                    */ 04915000
*                        /********************************************/ 04916000
*                        DO;                                       1351 04917000
*                                                                  1351 04918000
*                         DO;                                      1352 04919000
*                           CKREQ = CKREQ && CKREQ;                1353 04920000
         L     @15,@PC00001+8                                      1353 04921000
         XC    CKREQ(44,@15),CKREQ(@15)                            1353 04922000
*                           CKRERN = MSG32;                        1354 04923000
         L     @15,@PC00001+8                                      1354 04924000
         MVC   CKRERN(2,@15),@CH00223                              1354 04925000
*                           CKRMVAR(1) = ADDR(DSNMSG);             1355 04926000
         L     @15,@PC00001+8                                      1355 04927000
         LA    @14,DSNMSG                                          1355 04928000
         ST    @14,CKRMVAR(,@15)                                   1355 04929000
*                           CALL IDCRDER;                          1356 04930000
         L     @15,@CV01811                                        1356 04931000
         BALR  @14,@15                                             1356 04932000
*                         END;                                     1357 04933000
*                        RETURN CODE(LASTCC12);                    1358 04934000
         LA    @15,12                                              1358 04935000
         L     @14,@SA00005                                        1358 04936000
         LM    @00,@12,@SA00005+8                                  1358 04937000
         BR    @14                                                 1358 04938000
*                        END;                                      1359 04939000
*                      ELSE;                                       1360 04940000
*                                                                  1360 04941000
@RF01350 DS    0H                                                  1361 04942000
*                    /************************************************/ 04943000
*                    /*      END OF EXP > 0                          */ 04944000
*                    /************************************************/ 04945000
*                    END;                                          1361 04946000
*                                                                  1361 04947000
*                  ELSE;                                           1362 04948000
*                                                                  1362 04949000
@RF01346 DS    0H                                                  1363 04950000
*                /****************************************************/ 04951000
*                /*                                                  */ 04952000
*                /*    MOVE DATA FROM INPUT PARAM STREAM             */ 04953000
*                /*    TO NEW INPUT BUFFER                           */ 04954000
*                /*    DATA CANT BE MORE THAN 256 BYTES              */ 04955000
*                /****************************************************/ 04956000
*                RB3KD(RB3CKL+MNDOFVAL:(MNDSTLEN+RB3CKL+MNDOFVAL-1))=   04957000
*                      MNDSTVAL;                                   1363 04958000
*                                                                  1363 04959000
         L     @15,@PC00001+4                                      1363 04960000
         L     @01,FDTPTR+464(,@15)                                1363 04961000
         L     @15,BFPTRIN                                         1363 04962000
         SLR   @14,@14                                             1363 04963000
         IC    @14,RB3CKL(,@15)                                    1363 04964000
         AL    @14,MNDOFVAL(,@01)                                  1363 04965000
         L     @01,BFPTRIN                                         1363 04966000
         ALR   @01,@14                                             1363 04967000
         L     @15,@PC00001+4                                      1363 04968000
         L     @15,FDTPTR+468(,@15)                                1363 04969000
         SLR   @14,@14                                             1363 04970000
         IC    @14,MNDSTLEN(,@15)                                  1363 04971000
         L     @15,BFPTRIN                                         1363 04972000
         SLR   @05,@05                                             1363 04973000
         IC    @05,RB3CKL(,@15)                                    1363 04974000
         ALR   @14,@05                                             1363 04975000
         L     @15,@PC00001+4                                      1363 04976000
         L     @15,FDTPTR+464(,@15)                                1363 04977000
         AL    @14,MNDOFVAL(,@15)                                  1363 04978000
         L     @15,@PC00001+4                                      1363 04979000
         L     @15,FDTPTR+464(,@15)                                1363 04980000
         L     @05,BFPTRIN                                         1363 04981000
         SLR   @04,@04                                             1363 04982000
         IC    @04,RB3CKL(,@05)                                    1363 04983000
         AL    @04,MNDOFVAL(,@15)                                  1363 04984000
         SLR   @14,@04                                             1363 04985000
         BCTR  @14,0                                               1363 04986000
         L     @15,@PC00001+4                                      1363 04987000
         L     @15,FDTPTR+468(,@15)                                1363 04988000
         EX    @14,@SM02166                                        1363 04989000
*              /******************************************************/ 04990000
*              /*      END OF NEWDATA SPECIFIED ELSE                 */ 04991000
*              /******************************************************/ 04992000
*              END;                                                1364 04993000
*                                                                  1364 04994000
*          /**********************************************************/ 04995000
*          /*    END OF DATA SUPPLIED INFORMATION                    */ 04996000
*          /**********************************************************/ 04997000
*          END;                                                    1365 04998000
*                                                                  1365 04999000
@RT01331 DS    0H                                                  1366 05000000
*        /************************************************************/ 05001000
*        /*                                                          */ 05002000
*        /*  RB3, THE INPUT BUFFER CONTAINS THE NEW RECORD           */ 05003000
*        /*  FIRST SEE IF A FORMAT WRITE IS NEEDED                   */ 05004000
*        /*                                                          */ 05005000
*        /************************************************************/ 05006000
*        IF FWSW = NOT                                             1366 05007000
*          THEN                                                    1366 05008000
*                                                                  1366 05009000
@RC01263 CLI   FWSW,0                                              1366 05010000
         BNE   @RF01366                                            1366 05011000
*            /********************************************************/ 05012000
*            /*                                                      */ 05013000
*            /* NO FORMAT WRITE - JUST BUILD ARG LIST FOR            */ 05014000
*            /* UEXCP AND REWRITE THE MODIFIED RECORD                */ 05015000
*            /*                                                      */ 05016000
*            /********************************************************/ 05017000
*            DO;                                                   1367 05018000
*            RDCTLBK = REPODSOP;                                   1368 05019000
         L     @15,@PC00001+8                                      1368 05020000
         L     @01,REPODSAR(,@15)                                  1368 05021000
         L     @15,@PC00001+8                                      1368 05022000
         L     @00,REPODSOP(,@15)                                  1368 05023000
         ST    @00,RDCTLBK(,@01)                                   1368 05024000
*            RDIOAREA = BFPTRIN;                                   1369 05025000
         L     @15,@PC00001+8                                      1369 05026000
         L     @01,REPODSAR(,@15)                                  1369 05027000
         L     @00,BFPTRIN                                         1369 05028000
         ST    @00,RDIOAREA(,@01)                                  1369 05029000
*            RDCHR = RB1CCHR;                                      1370 05030000
         L     @15,@PC00001+8                                      1370 05031000
         L     @01,REPODSAR(,@15)                                  1370 05032000
         L     @15,BFPTROUT                                        1370 05033000
         MVC   RDCHR(5,@01),RB1CCHR(@15)                           1370 05034000
*            RDDS = ZERO;                                          1371 05035000
         L     @15,@PC00001+8                                      1371 05036000
         L     @01,REPODSAR(,@15)                                  1371 05037000
         MVI   RDDS(@01),X'00'                                     1371 05038000
*            RDFUNC = WRKYDATA;                                    1372 05039000
*                                                                  1372 05040000
         L     @15,@PC00001+8                                      1372 05041000
         L     @01,REPODSAR(,@15)                                  1372 05042000
         MVI   RDFUNC(@01),X'03'                                   1372 05043000
*            /********************************************************/ 05044000
*            /*                                                      */ 05045000
*            /*  CALL UEXCP TO WRITE KEY/DATA                        */ 05046000
*            /********************************************************/ 05047000
*            CALL IDCIO050(GDTTBL,WRITEREC,RDARG);                 1373 05048000
         L     @15,@PC00001                                        1373 05049000
         ST    @15,@AL00001                                        1373 05050000
         LA    @15,WRITEREC                                        1373 05051000
         ST    @15,@AL00001+4                                      1373 05052000
         L     @15,@PC00001+8                                      1373 05053000
         L     @01,REPODSAR(,@15)                                  1373 05054000
         ST    @01,@AL00001+8                                      1373 05055000
         MVI   @AL00001+8,X'80'                                    1373 05056000
         L     @14,@PC00001                                        1373 05057000
         L     @15,GDTEXP(,@14)                                    1373 05058000
         LA    @01,@AL00001                                        1373 05059000
         BALR  @14,@15                                             1373 05060000
*            RESPECIFY RTNREG RSTD;                                1374 05061000
*            TESTRC = RTNREG;                                      1375 05062000
         STH   RTNREG,TESTRC                                       1375 05063000
*            RESPECIFY RTNREG UNRSTD;                              1376 05064000
*            IF TESTRC ^= 0                                        1377 05065000
*              THEN                                                1377 05066000
         LH    @15,TESTRC                                          1377 05067000
         LTR   @15,@15                                             1377 05068000
         BZ    @RF01377                                            1377 05069000
*                DO;                                               1378 05070000
*                                                                  1378 05071000
*                /****************************************************/ 05072000
*                /*                                                  */ 05073000
*                /* ISSUE MSG IDC31245I - I/O ERROR MODIFYING TRACK  */ 05074000
*                /*                                                  */ 05075000
*                /****************************************************/ 05076000
*                                                                  1379 05077000
*                 DO;                                              1379 05078000
*                   CKREQ = CKREQ && CKREQ;                        1380 05079000
         L     @15,@PC00001+8                                      1380 05080000
         XC    CKREQ(44,@15),CKREQ(@15)                            1380 05081000
*                   CKRERN = MSG45;                                1381 05082000
         L     @15,@PC00001+8                                      1381 05083000
         MVC   CKRERN(2,@15),@CH00767                              1381 05084000
*                   CKRMVAR(1) = ADDR(RDCHR);                      1382 05085000
         L     @15,@PC00001+8                                      1382 05086000
         L     @14,@PC00001+8                                      1382 05087000
         L     @01,REPODSAR(,@14)                                  1382 05088000
         LA    @14,RDCHR(,@01)                                     1382 05089000
         ST    @14,CKRMVAR(,@15)                                   1382 05090000
*                   CKRMVAR(2) = ADDR(DSNMSG);                     1383 05091000
         L     @15,@PC00001+8                                      1383 05092000
         LA    @14,DSNMSG                                          1383 05093000
         ST    @14,CKRMVAR+4(,@15)                                 1383 05094000
*                   CALL IDCRDER;                                  1384 05095000
         L     @15,@CV01811                                        1384 05096000
         BALR  @14,@15                                             1384 05097000
*                 END;                                             1385 05098000
*                RETURN CODE(LASTCC12);                            1386 05099000
         LA    @15,12                                              1386 05100000
         L     @14,@SA00005                                        1386 05101000
         LM    @00,@12,@SA00005+8                                  1386 05102000
         BR    @14                                                 1386 05103000
*                END;                                              1387 05104000
*              ELSE                                                1388 05105000
*                RETURN CODE(LASTCC00);                            1388 05106000
@RF01377 SLR   @15,@15                                             1388 05107000
         L     @14,@SA00005                                        1388 05108000
         LM    @00,@12,@SA00005+8                                  1388 05109000
         BR    @14                                                 1388 05110000
*            END;                                                  1389 05111000
*                                                                  1389 05112000
*          ELSE;                                                   1390 05113000
@RF01366 DS    0H                                                  1391 05114000
*        /************************************************************/ 05115000
*        /*   MODIFIED RECORD MUST BE WRITTEN WITH A FORMAT WRITE    */ 05116000
*        /*                                                          */ 05117000
*        /*   INITIALIZE COUNTERS- SIGMA WILL BE THE NUMBER OF       */ 05118000
*        /*    BYTES ON THE TRACK SO FAR - SUMKEY WILL BE THE        */ 05119000
*        /*    NUMBER OF RECORDS ON THE TRACK WITH KEY FIELDS        */ 05120000
*        /*    AND SUMNOKEY WILL BE THE NUMBER OF RECORDS ON THE     */ 05121000
*        /*    TRACK WITH NO KEY FIELDS                              */ 05122000
*        /*    NOTE THAT R0 IS NOT PART OF THE TRACK CAPACITY        */ 05123000
*        /*                                                          */ 05124000
*        /************************************************************/ 05125000
*        SIGMA = ZERO;                                             1391 05126000
         SLR   @15,@15                                             1391 05127000
         ST    @15,SIGMA                                           1391 05128000
*        SUMKEY = ZERO;                                            1392 05129000
         SLR   @15,@15                                             1392 05130000
         STH   @15,SUMKEY                                          1392 05131000
*        SUMNOKEY = ZERO;                                          1393 05132000
*                                                                  1393 05133000
         SLR   @15,@15                                             1393 05134000
         STH   @15,SUMNOKEY                                        1393 05135000
*        /************************************************************/ 05136000
*        /*    SAVE THE CCHHR OF THE INPUT RECORD                    */ 05137000
*        /************************************************************/ 05138000
*        SAVCHR = RB3CCHR;                                         1394 05139000
*                                                                  1394 05140000
         L     @01,BFPTRIN                                         1394 05141000
         MVC   SAVCHR(5),RB3CCHR(@01)                              1394 05142000
*        /************************************************************/ 05143000
*        /*                                                          */ 05144000
*        /*  CHECK IF TRYING TO MODIFY RECORD ZERO COUNT- THATS      */ 05145000
*        /*      A NO-NO                                             */ 05146000
*        /*                                                          */ 05147000
*        /************************************************************/ 05148000
*        IF SAVCHR1 = ZERO                                         1395 05149000
*          THEN                                                    1395 05150000
*                                                                  1395 05151000
         CLI   SAVCHR1,0                                           1395 05152000
         BNE   @RF01395                                            1395 05153000
*            /********************************************************/ 05154000
*            /* CANNOT WRITE R0 COUNT FIELD                          */ 05155000
*            /* ISSUE MESSAGE AND RETURN CODE 12                     */ 05156000
*            /********************************************************/ 05157000
*            DO;                                                   1396 05158000
*                                                                  1396 05159000
*             DO;                                                  1397 05160000
*               CKREQ = CKREQ && CKREQ;                            1398 05161000
         L     @15,@PC00001+8                                      1398 05162000
         XC    CKREQ(44,@15),CKREQ(@15)                            1398 05163000
*               CKRERN = MSG43;                                    1399 05164000
         L     @15,@PC00001+8                                      1399 05165000
         MVC   CKRERN(2,@15),@CH00753                              1399 05166000
*               CKRMVAR(1) = ADDR(SAVCHR);                         1400 05167000
         L     @15,@PC00001+8                                      1400 05168000
         LA    @14,SAVCHR                                          1400 05169000
         ST    @14,CKRMVAR(,@15)                                   1400 05170000
*               CALL IDCRDER;                                      1401 05171000
         L     @15,@CV01811                                        1401 05172000
         BALR  @14,@15                                             1401 05173000
*             END;                                                 1402 05174000
*            RETURN CODE(LASTCC12);                                1403 05175000
         LA    @15,12                                              1403 05176000
         L     @14,@SA00005                                        1403 05177000
         LM    @00,@12,@SA00005+8                                  1403 05178000
         BR    @14                                                 1403 05179000
*            END;                                                  1404 05180000
*                                                                  1404 05181000
*          ELSE;                                                   1405 05182000
*                                                                  1405 05183000
@RF01395 DS    0H                                                  1406 05184000
*        /************************************************************/ 05185000
*        /*  READ IN ALL RECORDS PRIOR TO REQUEST RECORD IN RB0      */ 05186000
*        /*  EXCLUDING R0,                                           */ 05187000
*        /*  TO CALCULATE THE NUMBER OF BYTES USED                   */ 05188000
*        /*  ON THE TRACK SO FAR                                     */ 05189000
*        /*  SET THE CONSTANT PARAMETERS IN THE READ ARGUMENT LIST   */ 05190000
*        /*                                                          */ 05191000
*        /************************************************************/ 05192000
*        RDCTLBK = REPODSOP;                                       1406 05193000
         L     @15,@PC00001+8                                      1406 05194000
         L     @01,REPODSAR(,@15)                                  1406 05195000
         L     @15,@PC00001+8                                      1406 05196000
         L     @00,REPODSOP(,@15)                                  1406 05197000
         ST    @00,RDCTLBK(,@01)                                   1406 05198000
*        RDIOAREA = REPOBFPT;                                      1407 05199000
         L     @15,@PC00001+8                                      1407 05200000
         L     @01,REPODSAR(,@15)                                  1407 05201000
         L     @15,@PC00001+8                                      1407 05202000
         L     @00,REPOBFPT(,@15)                                  1407 05203000
         ST    @00,RDIOAREA(,@01)                                  1407 05204000
*        RDDS = ZERO;                                              1408 05205000
         L     @15,@PC00001+8                                      1408 05206000
         L     @01,REPODSAR(,@15)                                  1408 05207000
         MVI   RDDS(@01),X'00'                                     1408 05208000
*        PREVREC = SAVCHR1 - 1;                                    1409 05209000
*                                                                  1409 05210000
         SLR   @15,@15                                             1409 05211000
         IC    @15,SAVCHR1                                         1409 05212000
         BCTR  @15,0                                               1409 05213000
         STC   @15,PREVREC                                         1409 05214000
*        /************************************************************/ 05215000
*        /* CHECK IS THERE IS AT LEAST ONE PREVIOUS RECORD           */ 05216000
*        /************************************************************/ 05217000
*        IF PREVREC = ZERO                                         1410 05218000
*          THEN;                                                   1410 05219000
         CLI   PREVREC,0                                           1410 05220000
         BE    @RT01410                                            1410 05221000
*          ELSE                                                    1412 05222000
*                                                                  1412 05223000
*            /********************************************************/ 05224000
*            /*                                                      */ 05225000
*            /*  THERE IS AT LEAST ONE RECORD IN THE TRACK PRECEEDING*/ 05226000
*            /*  THE ONE TO BE MODIFIED.  ALL PREVIOUS RECORDS MUST  */ 05227000
*            /*  BE READ TO COMPUTE HOW MUCH SPACE IS LEFT IN THE    */ 05228000
*            /*  TRACK                                               */ 05229000
*            /*                                                      */ 05230000
*            /********************************************************/ 05231000
*            DO;                                                   1412 05232000
*                                                                  1412 05233000
*            /********************************************************/ 05234000
*            /*  LOOP UNTIL CURRENT RECORD                           */ 05235000
*            /********************************************************/ 05236000
*            DO I6 = 1 TO PREVREC;                                 1413 05237000
*                                                                  1413 05238000
         LA    @15,1                                               1413 05239000
         B     @DE01413                                            1413 05240000
@DL01413 DS    0H                                                  1414 05241000
*            /********************************************************/ 05242000
*            /*SET RECORD NUMBER AND MOVE CCHHR TO READ ARGUMENT LIST*/ 05243000
*            /********************************************************/ 05244000
*            SAVCHR1 = I6;                                         1414 05245000
         MVC   SAVCHR1(1),I6+1                                     1414 05246000
*            RDCHR = SAVCHR;                                       1415 05247000
*                                                                  1415 05248000
         L     @15,@PC00001+8                                      1415 05249000
         L     @01,REPODSAR(,@15)                                  1415 05250000
         MVC   RDCHR(5,@01),SAVCHR                                 1415 05251000
*            /********************************************************/ 05252000
*            /*  CALL IDCRDRD TO READ THE RECORD                     */ 05253000
*            /********************************************************/ 05254000
*            CALL IDCRDRD(RDARG);                                  1416 05255000
         L     @15,@PC00001+8                                      1416 05256000
         L     @01,REPODSAR(,@15)                                  1416 05257000
         ST    @01,@AL00001                                        1416 05258000
         L     @15,@CV01812                                        1416 05259000
         LA    @01,@AL00001                                        1416 05260000
         BALR  @14,@15                                             1416 05261000
*            RESPECIFY RTNREG RSTD;                                1417 05262000
*            TESTRC = RTNREG;                                      1418 05263000
         STH   RTNREG,TESTRC                                       1418 05264000
*            RESPECIFY RTNREG UNRSTD;                              1419 05265000
*            RESPECIFY RB0 BASED(RDDARE);                          1420 05266000
*                                                                  1420 05267000
*            /********************************************************/ 05268000
*            /*  CHECK THE RETURN CODE - IF IT IS NOT                */ 05269000
*            /*  OK OR RECORD NOT FOUND                              */ 05270000
*            /*  THEN PRIOR ERROR EXISTS ON TRACK                    */ 05271000
*            /*                                                      */ 05272000
*            /********************************************************/ 05273000
*            IF TESTRC > GOODCNT & TESTRC ^= NTFNDRD               1421 05274000
*              THEN                                                1421 05275000
         LH    @15,TESTRC                                          1421 05276000
         C     @15,@CF00288                                        1421 05277000
         BNH   @RF01421                                            1421 05278000
         CLC   TESTRC(2),@CH01990                                  1421 05279000
         BE    @RF01421                                            1421 05280000
*                DO;                                               1422 05281000
*                                                                  1422 05282000
*                /****************************************************/ 05283000
*                /*     BAD RECORD PRECEDING THE ONE TO BE UPDATED   */ 05284000
*                /*     ISSUE MSG IDC31242I AND RETURN WITH RC=12    */ 05285000
*                /****************************************************/ 05286000
*                                                                  1423 05287000
*                 DO;                                              1423 05288000
*                   CKREQ = CKREQ && CKREQ;                        1424 05289000
         L     @15,@PC00001+8                                      1424 05290000
         XC    CKREQ(44,@15),CKREQ(@15)                            1424 05291000
*                   CKRERN = MSG42;                                1425 05292000
         L     @15,@PC00001+8                                      1425 05293000
         MVC   CKRERN(2,@15),@CH00742                              1425 05294000
*                   CKRMVAR(1) = ADDR(PRECED);                     1426 05295000
         L     @15,@PC00001+8                                      1426 05296000
         LA    @14,PRECED                                          1426 05297000
         ST    @14,CKRMVAR(,@15)                                   1426 05298000
*                   CKRMVAR(2) = ADDR(MOKAD6);                     1427 05299000
         L     @15,@PC00001+8                                      1427 05300000
         LA    @14,MOKAD6                                          1427 05301000
         ST    @14,CKRMVAR+4(,@15)                                 1427 05302000
*                   CKRMVAR(3) = ADDR(MOKAD5);                     1428 05303000
         L     @15,@PC00001+8                                      1428 05304000
         LA    @14,MOKAD5                                          1428 05305000
         ST    @14,CKRMVAR+8(,@15)                                 1428 05306000
*                   CKRMVAR(4) = ADDR(DSNMSG);                     1429 05307000
         L     @15,@PC00001+8                                      1429 05308000
         LA    @14,DSNMSG                                          1429 05309000
         ST    @14,CKRMVAR+12(,@15)                                1429 05310000
*                   CALL IDCRDER;                                  1430 05311000
         L     @15,@CV01811                                        1430 05312000
         BALR  @14,@15                                             1430 05313000
*                 END;                                             1431 05314000
*                RETURN CODE(LASTCC12);                            1432 05315000
         LA    @15,12                                              1432 05316000
         L     @14,@SA00005                                        1432 05317000
         LM    @00,@12,@SA00005+8                                  1432 05318000
         BR    @14                                                 1432 05319000
*                END;                                              1433 05320000
*              ELSE;                                               1434 05321000
*                                                                  1434 05322000
@RF01421 DS    0H                                                  1435 05323000
*            /*******************************************************/  05324000
*            /*  THIS RECORD OK - SEE IF RECORD FOUND               */  05325000
*            /*******************************************************/  05326000
*            IF TESTRC ^= NTFNDRD                                  1435 05327000
*              THEN                                                1435 05328000
         CLC   TESTRC(2),@CH01990                                  1435 05329000
         BE    @RF01435                                            1435 05330000
*                DO;                                               1436 05331000
*                                                                  1436 05332000
*                /***************************************************** 05333000
*                /*ADD LENGTH OF THIS RECORD TO LENGTH OF TRACK SO FAR* 05334000
*                /*IF KEY EXISTS, ADD ONE TO SUM OF RECS WITH KEYS.   * 05335000
*                /*OTHERWISE ADD ONE TO SUM OF RECS WITHOUT KEYS.     * 05336000
*                /*LENGTH OF THIS RECORD IS KEY LEN PLUS DATA LEN     * 05337000
*                /*OF RECORD IN BUFFER.                               * 05338000
*                /*                                                   * 05339000
*                /***************************************************** 05340000
*                SIGMA = SIGMA + RB0CKL+ RB0CDL;                   1437 05341000
         L     @15,@PC00001+8                                      1437 05342000
         L     @01,REPODSAR(,@15)                                  1437 05343000
         L     @01,RDDARE(,@01)                                    1437 05344000
         SLR   @00,@00                                             1437 05345000
         IC    @00,RB0CKL(,@01)                                    1437 05346000
         AL    @00,SIGMA                                           1437 05347000
         L     @01,@PC00001+8                                      1437 05348000
         L     @01,REPODSAR(,@01)                                  1437 05349000
         L     @01,RDDARE(,@01)                                    1437 05350000
         LH    @01,RB0CDL(,@01)                                    1437 05351000
         N     @01,@CF02153                                        1437 05352000
         ALR   @00,@01                                             1437 05353000
         ST    @00,SIGMA                                           1437 05354000
*                IF RB0CKL ^= ZERO                                 1438 05355000
*                  THEN                                            1438 05356000
         L     @15,@PC00001+8                                      1438 05357000
         L     @01,REPODSAR(,@15)                                  1438 05358000
         L     @01,RDDARE(,@01)                                    1438 05359000
         CLI   RB0CKL(@01),0                                       1438 05360000
         BE    @RF01438                                            1438 05361000
*                    SUMKEY=SUMKEY + 1;                            1439 05362000
         LA    @15,1                                               1439 05363000
         LH    @14,SUMKEY                                          1439 05364000
         N     @14,@CF02153                                        1439 05365000
         ALR   @15,@14                                             1439 05366000
         STH   @15,SUMKEY                                          1439 05367000
*                  ELSE                                            1440 05368000
*                    SUMNOKEY = SUMNOKEY + 1;                      1440 05369000
*                                                                  1440 05370000
         B     @RC01438                                            1440 05371000
@RF01438 LA    @15,1                                               1440 05372000
         AH    @15,SUMNOKEY                                        1440 05373000
         STH   @15,SUMNOKEY                                        1440 05374000
*                /***************************************************** 05375000
*                /* IF END OF FILE RECORD THEN THE DATA LENGTH IS ZERO* 05376000
*                /*      BUT ACTUAL BYTES USED ON THE TRACK IS ONE    * 05377000
*                /***************************************************** 05378000
*                                                                  1441 05379000
*                IF  RB0CDL = ZERO                                 1441 05380000
*                  THEN                                            1441 05381000
@RC01438 L     @15,@PC00001+8                                      1441 05382000
         L     @01,REPODSAR(,@15)                                  1441 05383000
         L     @01,RDDARE(,@01)                                    1441 05384000
         LH    @15,RB0CDL(,@01)                                    1441 05385000
         N     @15,@CF02153                                        1441 05386000
         LTR   @15,@15                                             1441 05387000
         BNZ   @RF01441                                            1441 05388000
*                    SIGMA = SIGMA + 1;                            1442 05389000
         LA    @15,1                                               1442 05390000
         AL    @15,SIGMA                                           1442 05391000
         ST    @15,SIGMA                                           1442 05392000
*                  ELSE;                                           1443 05393000
@RF01441 DS    0H                                                  1444 05394000
*                END;                                              1444 05395000
*                                                                  1444 05396000
*              /******************************************************/ 05397000
*              /*IF RECORD NOT FOUND - JUST LOOP AGAIN*/           1445 05398000
*              /******************************************************/ 05399000
*              ELSE;                                               1445 05400000
*                                                                  1445 05401000
@RF01435 DS    0H                                                  1446 05402000
*            /********************************************************/ 05403000
*            /*END OF DO I6 = 1 TO PREVREC                           */ 05404000
*            /********************************************************/ 05405000
*            END;                                                  1446 05406000
*                                                                  1446 05407000
         LA    @15,1                                               1446 05408000
         LH    @14,I6                                              1446 05409000
         N     @14,@CF02153                                        1446 05410000
         ALR   @15,@14                                             1446 05411000
@DE01413 STH   @15,I6                                              1446 05412000
         SLR   @14,@14                                             1446 05413000
         IC    @14,PREVREC                                         1446 05414000
         CR    @15,@14                                             1446 05415000
         BNH   @DL01413                                            1446 05416000
*            /********************************************************/ 05417000
*            /*  END OF ELSE                                         */ 05418000
*            /********************************************************/ 05419000
*            END;                                                  1447 05420000
*                                                                  1447 05421000
*        /************************************************************/ 05422000
*        /*    ALL RECORDS UP TO INPUT RECORD HAVE BEEN READ         */ 05423000
*        /*    SIGMA HAS THE NUMBER OF BYTES USED SO FAR.            */ 05424000
*        /*    ADD OVERHEAD FACTORS FOR THE DEVICE                   */ 05425000
*        /*    TYPE   AND SAVE SIGMA                                 */ 05426000
*        /************************************************************/ 05427000
*        SIGMA = SIGMA + SUMKEY * KYCNST+ SUMNOKEY*NOKYCNST;       1448 05428000
*                                                                  1448 05429000
@RT01410 LH    @01,KYCNST                                          1448 05430000
         N     @01,@CF02153                                        1448 05431000
         LH    @15,SUMKEY                                          1448 05432000
         N     @15,@CF02153                                        1448 05433000
         MR    @00,@15                                             1448 05434000
         AL    @01,SIGMA                                           1448 05435000
         SLR   @00,@00                                             1448 05436000
         IC    @00,NOKYCNST                                        1448 05437000
         MH    @00,SUMNOKEY                                        1448 05438000
         ALR   @01,@00                                             1448 05439000
         ST    @01,SIGMA                                           1448 05440000
*        /************************************************************/ 05441000
*        /*    ADD TO THE SAVED VALUE OF SIGMA THE NUMBER            */ 05442000
*        /*    OF BYTES IN THE INPUT RECORD- AND ADJUST              */ 05443000
*        /*    FOR THE PADDING FACTOR FOR THE DEVICE TYPE            */ 05444000
*        /************************************************************/ 05445000
*        SAVSIG = SIGMA + RB3CKL + RB3CDL;                         1449 05446000
         L     @01,BFPTRIN                                         1449 05447000
         SLR   @00,@00                                             1449 05448000
         IC    @00,RB3CKL(,@01)                                    1449 05449000
         AL    @00,SIGMA                                           1449 05450000
         L     @01,BFPTRIN                                         1449 05451000
         LH    @01,RB3CDL(,@01)                                    1449 05452000
         N     @01,@CF02153                                        1449 05453000
         ALR   @00,@01                                             1449 05454000
         STH   @00,SAVSIG                                          1449 05455000
*        IF RB3CKL ^= ZERO                                         1450 05456000
*          THEN                                                    1450 05457000
         L     @01,BFPTRIN                                         1450 05458000
         CLI   RB3CKL(@01),0                                       1450 05459000
         BE    @RF01450                                            1450 05460000
*            SAVSIG=SAVSIG+KYCNST;                                 1451 05461000
         LH    @15,SAVSIG                                          1451 05462000
         N     @15,@CF02153                                        1451 05463000
         LH    @14,KYCNST                                          1451 05464000
         N     @14,@CF02153                                        1451 05465000
         ALR   @15,@14                                             1451 05466000
         STH   @15,SAVSIG                                          1451 05467000
*          ELSE                                                    1452 05468000
*            SAVSIG = SAVSIG + NOKYCNST;                           1452 05469000
         B     @RC01450                                            1452 05470000
@RF01450 LH    @15,SAVSIG                                          1452 05471000
         N     @15,@CF02153                                        1452 05472000
         SLR   @14,@14                                             1452 05473000
         IC    @14,NOKYCNST                                        1452 05474000
         ALR   @15,@14                                             1452 05475000
         STH   @15,SAVSIG                                          1452 05476000
*        IF RB3CDL = ZERO                                          1453 05477000
*          THEN                                                    1453 05478000
@RC01450 L     @01,BFPTRIN                                         1453 05479000
         LH    @15,RB3CDL(,@01)                                    1453 05480000
         N     @15,@CF02153                                        1453 05481000
         LTR   @15,@15                                             1453 05482000
         BNZ   @RF01453                                            1453 05483000
*            SAVSIG = SAVSIG + 1;                                  1454 05484000
         LA    @15,1                                               1454 05485000
         LH    @14,SAVSIG                                          1454 05486000
         N     @14,@CF02153                                        1454 05487000
         ALR   @15,@14                                             1454 05488000
         STH   @15,SAVSIG                                          1454 05489000
*          ELSE;                                                   1455 05490000
*                                                                  1455 05491000
@RF01453 DS    0H                                                  1456 05492000
*        /************************************************************/ 05493000
*        /*   RESET COUNTERS AND READ ALL SUBSEQUENT RECORD ON       */ 05494000
*        /*   THE TRACK TO COMPUTE THE TOTAL NUMBER OF BYTES         */ 05495000
*        /*   THAT WILL BE USED                                      */ 05496000
*        /*                                                          */ 05497000
*        /************************************************************/ 05498000
*        SIGMA = ZERO;                                             1456 05499000
         SLR   @15,@15                                             1456 05500000
         ST    @15,SIGMA                                           1456 05501000
*        SUMKEY = ZERO;                                            1457 05502000
         SLR   @15,@15                                             1457 05503000
         STH   @15,SUMKEY                                          1457 05504000
*        SUMNOKEY=ZERO;                                            1458 05505000
*                                                                  1458 05506000
         SLR   @15,@15                                             1458 05507000
         STH   @15,SUMNOKEY                                        1458 05508000
*        /************************************************************/ 05509000
*        /*  SET CONSTANT FIELDS FOR READ ARG LIST                   */ 05510000
*        /************************************************************/ 05511000
*        RDCTLBK = REPODSOP;                                       1459 05512000
         L     @15,@PC00001+8                                      1459 05513000
         L     @01,REPODSAR(,@15)                                  1459 05514000
         L     @15,@PC00001+8                                      1459 05515000
         L     @00,REPODSOP(,@15)                                  1459 05516000
         ST    @00,RDCTLBK(,@01)                                   1459 05517000
*        RDIOAREA = REPOBFPT;                                      1460 05518000
         L     @15,@PC00001+8                                      1460 05519000
         L     @01,REPODSAR(,@15)                                  1460 05520000
         L     @15,@PC00001+8                                      1460 05521000
         L     @00,REPOBFPT(,@15)                                  1460 05522000
         ST    @00,RDIOAREA(,@01)                                  1460 05523000
*        RDDS = ZERO;                                              1461 05524000
*                                                                  1461 05525000
         L     @15,@PC00001+8                                      1461 05526000
         L     @01,REPODSAR(,@15)                                  1461 05527000
         MVI   RDDS(@01),X'00'                                     1461 05528000
*        /************************************************************/ 05529000
*        /*  SET INIT VALUE OF CCHHR TO READ                         */ 05530000
*        /*                                                          */ 05531000
*        /************************************************************/ 05532000
*        SAVCHR = RB3CCHR;                                         1462 05533000
*                                                                  1462 05534000
         L     @01,BFPTRIN                                         1462 05535000
         MVC   SAVCHR(5),RB3CCHR(@01)                              1462 05536000
*        /************************************************************/ 05537000
*        /*  INITIALIZE COUNT OF RECORDS READ AFTER REQUESTED ONE    */ 05538000
*        /************************************************************/ 05539000
*        SVRECNUM = ZERO;                                          1463 05540000
         MVI   SVRECNUM,X'00'                                      1463 05541000
*        LASTOVFL = NOT;                                           1464 05542000
*                                                                  1464 05543000
         MVI   LASTOVFL,X'00'                                      1464 05544000
*        /************************************************************/ 05545000
*        /*  ALL THE RECORDS PAST THE RECORD TO BE MODIFIED MUST     */ 05546000
*        /*  BE READ TO CALCULATE THE NUMBER OF BYTES LEFT IN THE    */ 05547000
*        /*  TRACK LOOP TO LAST RECORD ON THE TRACK - FROM THE RECORD*/ 05548000
*        /*  BEYOND THE INPUT RECORD                                 */ 05549000
*        /*                                                          */ 05550000
*        /************************************************************/ 05551000
*        DO I6 = (RB3CR + 1) TO MAXNURCD;                          1465 05552000
*                                                                  1465 05553000
         LA    @15,1                                               1465 05554000
         L     @14,BFPTRIN                                         1465 05555000
         SLR   @05,@05                                             1465 05556000
         IC    @05,RB3CR(,@14)                                     1465 05557000
         ALR   @15,@05                                             1465 05558000
         B     @DE01465                                            1465 05559000
@DL01465 DS    0H                                                  1466 05560000
*        /************************************************************/ 05561000
*        /*  SET RECORD NUMBER AND MOVE CCHHR TO READ ARGUMENT LIST  */ 05562000
*        /************************************************************/ 05563000
*        SAVCHR1 = I6;                                             1466 05564000
         MVC   SAVCHR1(1),I6+1                                     1466 05565000
*        RDCHR = SAVCHR;                                           1467 05566000
*                                                                  1467 05567000
         L     @15,@PC00001+8                                      1467 05568000
         L     @01,REPODSAR(,@15)                                  1467 05569000
         MVC   RDCHR(5,@01),SAVCHR                                 1467 05570000
*        /************************************************************/ 05571000
*        /*  CALL IDCRDRD TO READ THE RECORD                         */ 05572000
*        /************************************************************/ 05573000
*        CALL IDCRDRD(RDARG);                                      1468 05574000
         L     @15,@PC00001+8                                      1468 05575000
         L     @01,REPODSAR(,@15)                                  1468 05576000
         ST    @01,@AL00001                                        1468 05577000
         L     @15,@CV01812                                        1468 05578000
         LA    @01,@AL00001                                        1468 05579000
         BALR  @14,@15                                             1468 05580000
*        RESPECIFY RTNREG RSTD;                                    1469 05581000
*        TESTRC = RTNREG;                                          1470 05582000
         STH   RTNREG,TESTRC                                       1470 05583000
*        RESPECIFY RTNREG UNRSTD;                                  1471 05584000
*                                                                  1471 05585000
*        /************************************************************/ 05586000
*        /*   CHECK TO SEE IF AT END OF TRACK - IF SO THEN           */ 05587000
*        /*     GET OUT OF LOOP                                      */ 05588000
*        /************************************************************/ 05589000
*        IF TESTRC = ENDTRK                                        1472 05590000
*          THEN                                                    1472 05591000
*                                                                  1472 05592000
         CLC   TESTRC(2),@CH00698                                  1472 05593000
         BNE   @RF01472                                            1472 05594000
*        /************************************************************/ 05595000
*        /*   GET OUT OF LOOP                                        */ 05596000
*        /************************************************************/ 05597000
*            I6 = MAXNURCD;                                        1473 05598000
         MVC   I6(2),@CH00689                                      1473 05599000
*          ELSE                                                    1474 05600000
*            DO;                                                   1474 05601000
*                                                                  1474 05602000
         B     @RC01472                                            1474 05603000
@RF01472 DS    0H                                                  1475 05604000
*            /********************************************************/ 05605000
*            /*   CHECK IF RECORD NOT FOUND                          */ 05606000
*            /********************************************************/ 05607000
*            IF TESTRC = NTFNDRD                                   1475 05608000
*              /******************************************************/ 05609000
*              /*YES-THEN JUST CONTINUE                              */ 05610000
*              /******************************************************/ 05611000
*                                                                  1475 05612000
*              THEN;                                               1475 05613000
*                                                                  1475 05614000
         CLC   TESTRC(2),@CH01990                                  1475 05615000
         BE    @RT01475                                            1475 05616000
*              ELSE                                                1477 05617000
*                                                                  1477 05618000
*                /****************************************************/ 05619000
*                /* CK RETURN CODE IS OK FOR A                       */ 05620000
*                /* VALID CONDITION THAT CAN OCCUR IF A DATA SET     */ 05621000
*                /* PROCESS IS TAKING PLACE                          */ 05622000
*                /* OTHERWISE IS AN UNCORRECTABLE TRACK              */ 05623000
*                /****************************************************/ 05624000
*                DO;                                               1477 05625000
*                IF (TESTRC > 15 & TESTRC < 29) | TESTRC = UNEXPEC 1478 05626000
*                            | TESTRC = NOSYNCBY                   1478 05627000
*                  THEN                                            1478 05628000
         LH    @15,TESTRC                                          1478 05629000
         C     @15,@CF00230                                        1478 05630000
         BNH   @GL00017                                            1478 05631000
         LH    @15,TESTRC                                          1478 05632000
         C     @15,@CF00694                                        1478 05633000
         BL    @RT01478                                            1478 05634000
@GL00017 CLC   TESTRC(2),@CH00046                                  1478 05635000
         BE    @RT01478                                            1478 05636000
         CLC   TESTRC(2),@CH00223                                  1478 05637000
         BNE   @RF01478                                            1478 05638000
@RT01478 DS    0H                                                  1479 05639000
*                    DO;                                           1479 05640000
*                                                                  1479 05641000
*                    /************************************************/ 05642000
*                    /* BAD RETURN CODE- CANNOT WRITE                */ 05643000
*                    /* ISSUE MSG IDC31242 AND RETURN WITH RC = 12   */ 05644000
*                    /************************************************/ 05645000
*                                                                  1480 05646000
*                     DO;                                          1480 05647000
*                       CKREQ = CKREQ && CKREQ;                    1481 05648000
         L     @15,@PC00001+8                                      1481 05649000
         XC    CKREQ(44,@15),CKREQ(@15)                            1481 05650000
*                       CKRERN = MSG42;                            1482 05651000
         L     @15,@PC00001+8                                      1482 05652000
         MVC   CKRERN(2,@15),@CH00742                              1482 05653000
*                       CKRMVAR(1) = ADDR(SUBSEQ);                 1483 05654000
         L     @15,@PC00001+8                                      1483 05655000
         LA    @14,SUBSEQ                                          1483 05656000
         ST    @14,CKRMVAR(,@15)                                   1483 05657000
*                       CKRMVAR(2) = ADDR(MOKAD6);                 1484 05658000
         L     @15,@PC00001+8                                      1484 05659000
         LA    @14,MOKAD6                                          1484 05660000
         ST    @14,CKRMVAR+4(,@15)                                 1484 05661000
*                       CKRMVAR(3) = ADDR(MOKAD5);                 1485 05662000
         L     @15,@PC00001+8                                      1485 05663000
         LA    @14,MOKAD5                                          1485 05664000
         ST    @14,CKRMVAR+8(,@15)                                 1485 05665000
*                       CKRMVAR(4) = ADDR(DSNMSG);                 1486 05666000
         L     @15,@PC00001+8                                      1486 05667000
         LA    @14,DSNMSG                                          1486 05668000
         ST    @14,CKRMVAR+12(,@15)                                1486 05669000
*                       CALL IDCRDER;                              1487 05670000
         L     @15,@CV01811                                        1487 05671000
         BALR  @14,@15                                             1487 05672000
*                     END;                                         1488 05673000
*                    RETURN CODE(LASTCC12);                        1489 05674000
         LA    @15,12                                              1489 05675000
         L     @14,@SA00005                                        1489 05676000
         LM    @00,@12,@SA00005+8                                  1489 05677000
         BR    @14                                                 1489 05678000
*                    END;                                          1490 05679000
*                  ELSE;                                           1491 05680000
*                                                                  1491 05681000
@RF01478 DS    0H                                                  1492 05682000
*                /****************************************************/ 05683000
*                /* THE RECORD JUST READ IN IS OK - COMPUTE ITS      */ 05684000
*                /* SIZE AND ADD TO NUMBER OF BYTES SO FAR           */ 05685000
*                /* IF OVERFLOW RECORD, SET LASTOVFL TO ONE          */ 05686000
*                /****************************************************/ 05687000
*                SIGMA = SIGMA + RB0CKL + RB0CDL;                  1492 05688000
         L     @15,@PC00001+8                                      1492 05689000
         L     @01,REPODSAR(,@15)                                  1492 05690000
         L     @01,RDDARE(,@01)                                    1492 05691000
         SLR   @00,@00                                             1492 05692000
         IC    @00,RB0CKL(,@01)                                    1492 05693000
         AL    @00,SIGMA                                           1492 05694000
         L     @01,@PC00001+8                                      1492 05695000
         L     @01,REPODSAR(,@01)                                  1492 05696000
         L     @01,RDDARE(,@01)                                    1492 05697000
         LH    @01,RB0CDL(,@01)                                    1492 05698000
         N     @01,@CF02153                                        1492 05699000
         ALR   @00,@01                                             1492 05700000
         ST    @00,SIGMA                                           1492 05701000
*                IF TESTRC = OVFLRCD                               1493 05702000
*                  THEN                                            1493 05703000
         CLC   TESTRC(2),@CH00044                                  1493 05704000
         BNE   @RF01493                                            1493 05705000
*                    LASTOVFL = YESS;                              1494 05706000
         MVI   LASTOVFL,X'01'                                      1494 05707000
*                  ELSE;                                           1495 05708000
@RF01493 DS    0H                                                  1496 05709000
*                IF RB0CKL ^= ZERO                                 1496 05710000
*                  THEN                                            1496 05711000
         L     @15,@PC00001+8                                      1496 05712000
         L     @01,REPODSAR(,@15)                                  1496 05713000
         L     @01,RDDARE(,@01)                                    1496 05714000
         CLI   RB0CKL(@01),0                                       1496 05715000
         BE    @RF01496                                            1496 05716000
*                    SUMKEY = SUMKEY + 1;                          1497 05717000
         LA    @15,1                                               1497 05718000
         LH    @14,SUMKEY                                          1497 05719000
         N     @14,@CF02153                                        1497 05720000
         ALR   @15,@14                                             1497 05721000
         STH   @15,SUMKEY                                          1497 05722000
*                  ELSE                                            1498 05723000
*                    SUMNOKEY = SUMNOKEY + 1;                      1498 05724000
*                                                                  1498 05725000
         B     @RC01496                                            1498 05726000
@RF01496 LA    @15,1                                               1498 05727000
         AH    @15,SUMNOKEY                                        1498 05728000
         STH   @15,SUMNOKEY                                        1498 05729000
*                /****************************************************/ 05730000
*                /* INCREMENT COUNT OF RECORDS READ                  */ 05731000
*                /****************************************************/ 05732000
*                SVRECNUM = SVRECNUM + 1;                          1499 05733000
*                                                                  1499 05734000
@RC01496 LA    @15,1                                               1499 05735000
         SLR   @14,@14                                             1499 05736000
         IC    @14,SVRECNUM                                        1499 05737000
         ALR   @15,@14                                             1499 05738000
         STC   @15,SVRECNUM                                        1499 05739000
*                /****************************************************/ 05740000
*                /* IF  END OF FILE RECORD THEN ADJUST NUMBER OF     */ 05741000
*                /* BYTES IN TRACK                                   */ 05742000
*                /****************************************************/ 05743000
*                IF RB0CDL= ZERO                                   1500 05744000
*                  THEN                                            1500 05745000
         L     @15,@PC00001+8                                      1500 05746000
         L     @01,REPODSAR(,@15)                                  1500 05747000
         L     @01,RDDARE(,@01)                                    1500 05748000
         LH    @15,RB0CDL(,@01)                                    1500 05749000
         N     @15,@CF02153                                        1500 05750000
         LTR   @15,@15                                             1500 05751000
         BNZ   @RF01500                                            1500 05752000
*                    SIGMA = SIGMA + 1;                            1501 05753000
         LA    @15,1                                               1501 05754000
         AL    @15,SIGMA                                           1501 05755000
         ST    @15,SIGMA                                           1501 05756000
*                  ELSE;                                           1502 05757000
*                                                                  1502 05758000
@RF01500 DS    0H                                                  1503 05759000
*                /****************************************************/ 05760000
*                /*   END OF DO FOR RECORD FOUND                     */ 05761000
*                /****************************************************/ 05762000
*                END;                                              1503 05763000
*                                                                  1503 05764000
*            /********************************************************/ 05765000
*            /*  END OF DO FOR NOT END OF TRACK ELSE                 */ 05766000
*            /********************************************************/ 05767000
*            END;                                                  1504 05768000
*                                                                  1504 05769000
@RT01475 DS    0H                                                  1505 05770000
*        /************************************************************/ 05771000
*        /*  END OF DO I6 LOOP                                       */ 05772000
*        /************************************************************/ 05773000
*        END;                                                      1505 05774000
*                                                                  1505 05775000
@RC01472 LA    @15,1                                               1505 05776000
         LH    @14,I6                                              1505 05777000
         N     @14,@CF02153                                        1505 05778000
         ALR   @15,@14                                             1505 05779000
@DE01465 STH   @15,I6                                              1505 05780000
         C     @15,@CF00689                                        1505 05781000
         BNH   @DL01465                                            1505 05782000
*        /************************************************************/ 05783000
*        /*   OUT OF LOOP - ADD SIGMA TO SAVED VALUE OF SIGMA        */ 05784000
*        /*   TO CALCULATE THE NUMBER OF BYTES ON THE TRACK          */ 05785000
*        /*   AND ADJUST FOR OVERHEAD FOR DEVICE                     */ 05786000
*        /*                                                          */ 05787000
*        /************************************************************/ 05788000
*        SIGMA = SIGMA + SUMKEY*KYCNST + SUMNOKEY*NOKYCNST + SAVSIG;    05789000
*                                                                  1506 05790000
         LH    @01,KYCNST                                          1506 05791000
         N     @01,@CF02153                                        1506 05792000
         LH    @15,SUMKEY                                          1506 05793000
         N     @15,@CF02153                                        1506 05794000
         MR    @00,@15                                             1506 05795000
         AL    @01,SIGMA                                           1506 05796000
         SLR   @00,@00                                             1506 05797000
         IC    @00,NOKYCNST                                        1506 05798000
         MH    @00,SUMNOKEY                                        1506 05799000
         ALR   @01,@00                                             1506 05800000
         LH    @00,SAVSIG                                          1506 05801000
         N     @00,@CF02153                                        1506 05802000
         ALR   @01,@00                                             1506 05803000
         ST    @01,SIGMA                                           1506 05804000
*        /************************************************************/ 05805000
*        /*   CHECK IF NEW TRACK WILL FIT ON DEVICE                  */ 05806000
*        /************************************************************/ 05807000
*        IF SIGMA > DEVTC                                          1507 05808000
*          THEN                                                    1507 05809000
         L     @15,@PC00001+8                                      1507 05810000
         L     @01,REPODEVA(,@15)                                  1507 05811000
         LH    @15,DEVTC(,@01)                                     1507 05812000
         N     @15,@CF02153                                        1507 05813000
         C     @15,SIGMA                                           1507 05814000
         BNL   @RF01507                                            1507 05815000
*            DO;                                                   1508 05816000
*                                                                  1508 05817000
*            /********************************************************/ 05818000
*            /* NO-INPUT TOO LONG                                    */ 05819000
*            /* ISSUE MESSAGE AS TO WHICH TYPE OF INPUT WAS          */ 05820000
*            /* IN ERROR AND RETURN CODE 12                          */ 05821000
*            /*                                                      */ 05822000
*            /********************************************************/ 05823000
*            IF STRINGSW = YESS                                    1509 05824000
*              THEN                                                1509 05825000
*                                                                  1509 05826000
         CLI   STRINGSW,1                                          1509 05827000
         BNE   @RF01509                                            1509 05828000
*                /****************************************************/ 05829000
*                /* INPUT STRING TOO LARGE.  ISSUE MSG IDC31232I     */ 05830000
*                /* RETURN WITH RC =12                               */ 05831000
*                /****************************************************/ 05832000
*                                                                  1510 05833000
*                 DO;                                              1510 05834000
*                   CKREQ = CKREQ && CKREQ;                        1511 05835000
         L     @15,@PC00001+8                                      1511 05836000
         XC    CKREQ(44,@15),CKREQ(@15)                            1511 05837000
*                   CKRERN = MSG32;                                1512 05838000
         L     @15,@PC00001+8                                      1512 05839000
         MVC   CKRERN(2,@15),@CH00223                              1512 05840000
*                   CKRMVAR(1) = ADDR(DSNMSG);                     1513 05841000
         L     @15,@PC00001+8                                      1513 05842000
         LA    @14,DSNMSG                                          1513 05843000
         ST    @14,CKRMVAR(,@15)                                   1513 05844000
*                   CALL IDCRDER;                                  1514 05845000
         L     @15,@CV01811                                        1514 05846000
         BALR  @14,@15                                             1514 05847000
*                 END;                                             1515 05848000
*              ELSE                                                1516 05849000
*                                                                  1516 05850000
*                /****************************************************/ 05851000
*                /* REPLACING RECORD TOO LARGE. ISSUE MSG IDC31231I  */ 05852000
*                /* RETURN WITH RC = 12                              */ 05853000
*                /****************************************************/ 05854000
*                                                                  1516 05855000
*                 DO;                                              1516 05856000
         B     @RC01509                                            1516 05857000
@RF01509 DS    0H                                                  1517 05858000
*                   CKREQ = CKREQ && CKREQ;                        1517 05859000
         L     @15,@PC00001+8                                      1517 05860000
         XC    CKREQ(44,@15),CKREQ(@15)                            1517 05861000
*                   CKRERN = MSG31;                                1518 05862000
         L     @15,@PC00001+8                                      1518 05863000
         MVC   CKRERN(2,@15),@CH00046                              1518 05864000
*                   CKRMVAR(1) = ADDR(DSNMSG);                     1519 05865000
         L     @15,@PC00001+8                                      1519 05866000
         LA    @14,DSNMSG                                          1519 05867000
         ST    @14,CKRMVAR(,@15)                                   1519 05868000
*                   CALL IDCRDER;                                  1520 05869000
         L     @15,@CV01811                                        1520 05870000
         BALR  @14,@15                                             1520 05871000
*                 END;                                             1521 05872000
*                                                                  1521 05873000
*            RETURN CODE(LASTCC12);                                1522 05874000
@RC01509 LA    @15,12                                              1522 05875000
         L     @14,@SA00005                                        1522 05876000
         LM    @00,@12,@SA00005+8                                  1522 05877000
         BR    @14                                                 1522 05878000
*            END;                                                  1523 05879000
*                                                                  1523 05880000
*          ELSE;                                                   1524 05881000
*                                                                  1524 05882000
@RF01507 DS    0H                                                  1525 05883000
*        /************************************************************/ 05884000
*        /*  THE MODIFIED RECORD WILL FIT IN THE TRACK               */ 05885000
*        /************************************************************/ 05886000
*        RDCHR = RB3CCHR;                                          1525 05887000
         L     @15,@PC00001+8                                      1525 05888000
         L     @01,REPODSAR(,@15)                                  1525 05889000
         L     @15,BFPTRIN                                         1525 05890000
         MVC   RDCHR(5,@01),RB3CCHR(@15)                           1525 05891000
*        RDDS = ZERO;                                              1526 05892000
*                                                                  1526 05893000
         L     @15,@PC00001+8                                      1526 05894000
         L     @01,REPODSAR(,@15)                                  1526 05895000
         MVI   RDDS(@01),X'00'                                     1526 05896000
*        /************************************************************/ 05897000
*        /*   DETERMINE IF INPUT RECORD IS TO BE OVERFLOW RECORD     */ 05898000
*        /*                                                          */ 05899000
*        /************************************************************/ 05900000
*        IF OVFLSW  = YESS                                         1527 05901000
*          THEN                                                    1527 05902000
         CLI   OVFLSW,1                                            1527 05903000
         BNE   @RF01527                                            1527 05904000
*            RDFUNC = RITEOVFL;                                    1528 05905000
         L     @15,@PC00001+8                                      1528 05906000
         L     @01,REPODSAR(,@15)                                  1528 05907000
         MVI   RDFUNC(@01),X'02'                                   1528 05908000
*          ELSE                                                    1529 05909000
*            RDFUNC = 1;                                           1529 05910000
         B     @RC01527                                            1529 05911000
@RF01527 L     @15,@PC00001+8                                      1529 05912000
         L     @01,REPODSAR(,@15)                                  1529 05913000
         MVI   RDFUNC(@01),X'01'                                   1529 05914000
*        RDCTLBK = REPODSOP;                                       1530 05915000
@RC01527 L     @15,@PC00001+8                                      1530 05916000
         L     @01,REPODSAR(,@15)                                  1530 05917000
         L     @15,@PC00001+8                                      1530 05918000
         L     @00,REPODSOP(,@15)                                  1530 05919000
         ST    @00,RDCTLBK(,@01)                                   1530 05920000
*        RDIOAREA = BFPTRIN;                                       1531 05921000
         L     @15,@PC00001+8                                      1531 05922000
         L     @01,REPODSAR(,@15)                                  1531 05923000
         L     @00,BFPTRIN                                         1531 05924000
         ST    @00,RDIOAREA(,@01)                                  1531 05925000
*        RB1NUM = 1;                                               1532 05926000
*                                                                  1532 05927000
         L     @01,BFPTROUT                                        1532 05928000
         MVC   RB1NUM(4,@01),@CF00221                              1532 05929000
*        /************************************************************/ 05930000
*        /*   CALL FWRITE TO DO A FORMAT WRITE OF ONE RECORD FOR     */ 05931000
*        /*   THE INPUT BUFFER                                       */ 05932000
*        /************************************************************/ 05933000
*        CALL IDCIO050(GDTTBL,FWRITE,RDARG);                       1533 05934000
*                                                                  1533 05935000
         L     @15,@PC00001                                        1533 05936000
         ST    @15,@AL00001                                        1533 05937000
         LA    @15,FWRITE                                          1533 05938000
         ST    @15,@AL00001+4                                      1533 05939000
         L     @15,@PC00001+8                                      1533 05940000
         L     @01,REPODSAR(,@15)                                  1533 05941000
         ST    @01,@AL00001+8                                      1533 05942000
         MVI   @AL00001+8,X'80'                                    1533 05943000
         L     @14,@PC00001                                        1533 05944000
         L     @15,GDTEXP(,@14)                                    1533 05945000
         LA    @01,@AL00001                                        1533 05946000
         BALR  @14,@15                                             1533 05947000
*        RESPECIFY RTNREG RSTD;                                    1534 05948000
*        TESTRC = RTNREG;                                          1535 05949000
         STH   RTNREG,TESTRC                                       1535 05950000
*        RESPECIFY RTNREG UNRSTD;                                  1536 05951000
*        IF TESTRC ^= 0                                            1537 05952000
*          THEN                                                    1537 05953000
         LH    @15,TESTRC                                          1537 05954000
         LTR   @15,@15                                             1537 05955000
         BZ    @RF01537                                            1537 05956000
*            DO;                                                   1538 05957000
*                                                                  1538 05958000
*            /********************************************************/ 05959000
*            /*                                                      */ 05960000
*            /* WRITE MSG IDC31245I - I/O ERROR WHILE MODIFYING TRACK*/ 05961000
*            /*                                                      */ 05962000
*            /********************************************************/ 05963000
*                                                                  1539 05964000
*             DO;                                                  1539 05965000
*               CKREQ = CKREQ && CKREQ;                            1540 05966000
         L     @15,@PC00001+8                                      1540 05967000
         XC    CKREQ(44,@15),CKREQ(@15)                            1540 05968000
*               CKRERN = MSG45;                                    1541 05969000
         L     @15,@PC00001+8                                      1541 05970000
         MVC   CKRERN(2,@15),@CH00767                              1541 05971000
*               CKRMVAR(1) = ADDR(RDCHR);                          1542 05972000
         L     @15,@PC00001+8                                      1542 05973000
         L     @14,@PC00001+8                                      1542 05974000
         L     @01,REPODSAR(,@14)                                  1542 05975000
         LA    @14,RDCHR(,@01)                                     1542 05976000
         ST    @14,CKRMVAR(,@15)                                   1542 05977000
*               CKRMVAR(2) = ADDR(DSNMSG);                         1543 05978000
         L     @15,@PC00001+8                                      1543 05979000
         LA    @14,DSNMSG                                          1543 05980000
         ST    @14,CKRMVAR+4(,@15)                                 1543 05981000
*               CALL IDCRDER;                                      1544 05982000
         L     @15,@CV01811                                        1544 05983000
         BALR  @14,@15                                             1544 05984000
*             END;                                                 1545 05985000
*            RETURN CODE(LASTCC12);                                1546 05986000
         LA    @15,12                                              1546 05987000
         L     @14,@SA00005                                        1546 05988000
         LM    @00,@12,@SA00005+8                                  1546 05989000
         BR    @14                                                 1546 05990000
*            END;                                                  1547 05991000
*                                                                  1547 05992000
*        /************************************************************/ 05993000
*        /*   CALCULATE THE NUMBER OF RECORDS LEFT TO WRITE ON       */ 05994000
*        /*     THE TRACK                                            */ 05995000
*        /*                                                          */ 05996000
*        /************************************************************/ 05997000
*                                                                  1548 05998000
*        IF SVRECNUM  = ZERO                                       1548 05999000
*          THEN;                                                   1548 06000000
@RF01537 CLI   SVRECNUM,0                                          1548 06001000
         BE    @RT01548                                            1548 06002000
*          ELSE                                                    1550 06003000
*            DO;                                                   1550 06004000
*                                                                  1550 06005000
*            /********************************************************/ 06006000
*            /* RESET ADDRESSABILITY TO THE SAVED ADDRESS OF THE     */ 06007000
*            /* FIRST RECORD READ AFTER THE INPUT RECORD MINUS       */ 06008000
*            /* THE FULL WORD AREA USED FOR THE NUMBER OF RECORDS    */ 06009000
*            /* TO WRITE                                             */ 06010000
*            /********************************************************/ 06011000
*            RESPECIFY  RB1     BASED (SVDTADDR-CNST04);           1551 06012000
*                                                                  1551 06013000
*            /********************************************************/ 06014000
*            /*   SET THE NUMBER OF RECORDS TO WRITE TO THE LAST     */ 06015000
*            /*   RECORD READ MINUS THE INPUT RECORD NUMBER.         */ 06016000
*            /*   WATCH OUT FOR MISSING RECORD NUMBERS               */ 06017000
*            /*   AND BUILD RDARG AREA                               */ 06018000
*            /********************************************************/ 06019000
*            RB1NUM=SVRECNUM;                                      1552 06020000
         SLR   @15,@15                                             1552 06021000
         IC    @15,SVRECNUM                                        1552 06022000
         L     @14,SVDTADDR                                        1552 06023000
         AL    @14,@CF02168                                        1552 06024000
         ST    @15,RB1NUM(,@14)                                    1552 06025000
*            RDIOAREA = SVDTADDR - LENGTH(RB1NUM);                 1553 06026000
         L     @15,@PC00001+8                                      1553 06027000
         L     @01,REPODSAR(,@15)                                  1553 06028000
         L     @00,SVDTADDR                                        1553 06029000
         SL    @00,@CF00044                                        1553 06030000
         ST    @00,RDIOAREA(,@01)                                  1553 06031000
*            RDCHR = RB1CCHR;                                      1554 06032000
         L     @15,@PC00001+8                                      1554 06033000
         L     @01,REPODSAR(,@15)                                  1554 06034000
         L     @15,SVDTADDR                                        1554 06035000
         MVC   RDCHR(5,@01),RB1CCHR-4(@15)                         1554 06036000
*            RDDS = ZERO;                                          1555 06037000
*                                                                  1555 06038000
         L     @15,@PC00001+8                                      1555 06039000
         L     @01,REPODSAR(,@15)                                  1555 06040000
         MVI   RDDS(@01),X'00'                                     1555 06041000
*            /********************************************************/ 06042000
*            /* SET TO WRITE SPECIAL ON THE LAST RECORD IF NEEDED    */ 06043000
*            /********************************************************/ 06044000
*            IF LASTOVFL = YESS                                    1556 06045000
*              THEN                                                1556 06046000
         CLI   LASTOVFL,1                                          1556 06047000
         BNE   @RF01556                                            1556 06048000
*                RDFUNC = RITEOVFL;                                1557 06049000
         L     @15,@PC00001+8                                      1557 06050000
         L     @01,REPODSAR(,@15)                                  1557 06051000
         MVI   RDFUNC(@01),X'02'                                   1557 06052000
*              ELSE                                                1558 06053000
*                RDFUNC = 1;                                       1558 06054000
*                                                                  1558 06055000
         B     @RC01556                                            1558 06056000
@RF01556 L     @15,@PC00001+8                                      1558 06057000
         L     @01,REPODSAR(,@15)                                  1558 06058000
         MVI   RDFUNC(@01),X'01'                                   1558 06059000
*            /********************************************************/ 06060000
*            /* CALL FWRITE TO FORMAT WRITE THE REST OF THE TRACK    */ 06061000
*            /********************************************************/ 06062000
*            CALL IDCIO050(GDTTBL,FWRITE,RDARG);                   1559 06063000
@RC01556 L     @15,@PC00001                                        1559 06064000
         ST    @15,@AL00001                                        1559 06065000
         LA    @15,FWRITE                                          1559 06066000
         ST    @15,@AL00001+4                                      1559 06067000
         L     @15,@PC00001+8                                      1559 06068000
         L     @01,REPODSAR(,@15)                                  1559 06069000
         ST    @01,@AL00001+8                                      1559 06070000
         MVI   @AL00001+8,X'80'                                    1559 06071000
         L     @14,@PC00001                                        1559 06072000
         L     @15,GDTEXP(,@14)                                    1559 06073000
         LA    @01,@AL00001                                        1559 06074000
         BALR  @14,@15                                             1559 06075000
*            RESPECIFY RTNREG RSTD;                                1560 06076000
*            TESTRC = RTNREG;                                      1561 06077000
         STH   RTNREG,TESTRC                                       1561 06078000
*            RESPECIFY RTNREG UNRSTD;                              1562 06079000
*            IF TESTRC ^= 0                                        1563 06080000
*              THEN                                                1563 06081000
         LH    @15,TESTRC                                          1563 06082000
         LTR   @15,@15                                             1563 06083000
         BZ    @RF01563                                            1563 06084000
*                DO;                                               1564 06085000
*                                                                  1564 06086000
*                /****************************************************/ 06087000
*                /*                                                  */ 06088000
*                /* WRITE MSG IDC31245I - I/O ERROR WHILE MODIFYING  */ 06089000
*                /* TRACK                                            */ 06090000
*                /*                                                  */ 06091000
*                /****************************************************/ 06092000
*                                                                  1565 06093000
*                 DO;                                              1565 06094000
*                   CKREQ = CKREQ && CKREQ;                        1566 06095000
         L     @15,@PC00001+8                                      1566 06096000
         XC    CKREQ(44,@15),CKREQ(@15)                            1566 06097000
*                   CKRERN = MSG45;                                1567 06098000
         L     @15,@PC00001+8                                      1567 06099000
         MVC   CKRERN(2,@15),@CH00767                              1567 06100000
*                   CKRMVAR(1) = ADDR(RDCHR);                      1568 06101000
         L     @15,@PC00001+8                                      1568 06102000
         L     @14,@PC00001+8                                      1568 06103000
         L     @01,REPODSAR(,@14)                                  1568 06104000
         LA    @14,RDCHR(,@01)                                     1568 06105000
         ST    @14,CKRMVAR(,@15)                                   1568 06106000
*                   CKRMVAR(2) = ADDR(DSNMSG);                     1569 06107000
         L     @15,@PC00001+8                                      1569 06108000
         LA    @14,DSNMSG                                          1569 06109000
         ST    @14,CKRMVAR+4(,@15)                                 1569 06110000
*                   CALL IDCRDER;                                  1570 06111000
         L     @15,@CV01811                                        1570 06112000
         BALR  @14,@15                                             1570 06113000
*                 END;                                             1571 06114000
*                RETURN CODE(LASTCC12);                            1572 06115000
         LA    @15,12                                              1572 06116000
         L     @14,@SA00005                                        1572 06117000
         LM    @00,@12,@SA00005+8                                  1572 06118000
         BR    @14                                                 1572 06119000
*                END;                                              1573 06120000
*                                                                  1573 06121000
*            /********************************************************/ 06122000
*            /* END OF MORE RECORDS TO REWRITE ELSE                  */ 06123000
*            /********************************************************/ 06124000
*            END;                                                  1574 06125000
*                                                                  1574 06126000
@RF01563 DS    0H                                                  1575 06127000
*        RETURN CODE(LASTCC00);                                    1575 06128000
@RT01548 SLR   @15,@15                                             1575 06129000
         L     @14,@SA00005                                        1575 06130000
         LM    @00,@12,@SA00005+8                                  1575 06131000
         BR    @14                                                 1575 06132000
*END MODDSOUT;                                                     1576 06133000
*MODCLFP:   PROCEDURE;                                             1577 06134000
MODCLFP  STM   @14,@12,@SA00006                                    1577 06135000
*        /************************************************************/ 06136000
*        /*                                                          */ 06137000
*        /* SUBROUTINE NAME - MODCLFP                                */ 06138000
*        /*                                                          */ 06139000
*        /* FUNCTION -                                               */ 06140000
*        /*                                                          */ 06141000
*        /* THIS PROCEDURE WILL CLOSE FILES, FREE POOL AND WILL      */ 06142000
*        /*   DEQUEUE ENQUEUED VTOC OR VTOCHEADER                    */ 06143000
*        /*                                                          */ 06144000
*        /* NOTES -                                                  */ 06145000
*        /*                                                          */ 06146000
*        /*    DEPENDENCIES - NONE                                   */ 06147000
*        /*                                                          */ 06148000
*        /*    RESTRICTIONS - GENERAL PURPOSE REGISTERS 7 AND 8      */ 06149000
*        /*                   MAY NOT BE USED BY THIS MODULE OR      */ 06150000
*        /*                   ANY OTHER REPAIRV MODULE AS THEY ARE   */ 06151000
*        /*                   DATA REGISTERS FOR MODULES IDCRD07     */ 06152000
*        /*                   AND IDCRD06 RESPECTIVELY               */ 06153000
*        /*                                                          */ 06154000
*        /*    REGISTER CONVENTIONS - SEE GLOBAL DATA AREA (AMSDF00) */ 06155000
*        /*                                                          */ 06156000
*        /*    PATCH LABEL - 'UPATCHIT'                              */ 06157000
*        /*                                                          */ 06158000
*        /* ENTRY POINT - MODCLFP (ONLY ENTRY POINT)                 */ 06159000
*        /*                                                          */ 06160000
*        /*    LINKAGE - 'CALL MODCLFP'                              */ 06161000
*        /*                                                          */ 06162000
*        /*    INPUT -                                               */ 06163000
*        /*                                                          */ 06164000
*        /*      REPIRWIO - IOCSTR POINTER FOR INPUT REPAIRWORKFILE*/   06165000
*        /*      REPORWIO - IOCSTR POINTER FOR OUTPUT REPAIR WORKFILE*/ 06166000
*        /*      SAVCLIN  - IOCTLBK POINTER FOR INPUT DATA SET       */ 06167000
*        /*      SAVCLOUT - IOCTLBK POINTER FOR OUTPUT DATA SET      */ 06168000
*        /*      REPQRPTR - QNAME AND RNAME POINTER                  */ 06169000
*        /*      DATSPA   - DATA SET INPUT INDICATOR                 */ 06170000
*        /*                                                          */ 06171000
*        /*    OUTPUT -                                              */ 06172000
*        /*      NONE                                                */ 06173000
*        /*                                                          */ 06174000
*        /*    EXIT, NORMAL -                                        */ 06175000
*        /*                                                          */ 06176000
*        /*      LASTCC = 00        FUNCTION COMPLETED SUCCESSFULLY  */ 06177000
*        /*                                                          */ 06178000
*        /*    PROCEDURES/SUBROUTINES CALLED                         */ 06179000
*        /*      NONE                                                */ 06180000
*        /*                                                          */ 06181000
*        /* EXTERNAL REFERENCES -                                    */ 06182000
*        /*    MACROS/SVCS -                                         */ 06183000
*        /*                                                          */ 06184000
*        /*    UCLOSE - IDCAMS I/O ADAPTER CLOSE ROUTINE             */ 06185000
*        /*      CLOSES THE REPAIR WORKFILE                          */ 06186000
*        /*      GENERATES A CALL TO MODULE IDCIOCL                  */ 06187000
*        /*                                                          */ 06188000
*        /*    UFPOOL - IDCAMS SYSTEM ADAPTER FREE POOL ROUTINE      */ 06189000
*        /*      RELEASES DYNAMIC STORAGE ACQUIRED FOR I/O BUFFERS   */ 06190000
*        /*      GENERATES A CALL TO MODULE IDCSAFP                  */ 06191000
*        /*                                                          */ 06192000
*        /*    UDEQ   - IDCAMS SYSTEM ADAPTER DEQUEUE ROUTINE        */ 06193000
*        /*      DEQUEUES VTOC OR VTOCHEADER THAT HAVE BEEN ENQUEUED */ 06194000
*        /*      GENERATES A CALL TO MODULE IDCSADQ                  */ 06195000
*        /*                                                          */ 06196000
*        /*    UEXCP  - IDCAMS I/O ADAPTER EXCP ROUTINE              */ 06197000
*        /*      TO CLOSE DATA SET OR VTOCHEADER                     */ 06198000
*        /*      GENERATES A CALL TO MODULE IDCSADQO                 */ 06199000
*        /*                                                          */ 06200000
*        /*                                                          */ 06201000
*        /* PROCEDURES/SUBROUTINES CALLED                            */ 06202000
*        /*   NONE                                                   */ 06203000
*        /************************************************************/ 06204000
*                                                                  1578 06205000
*        /************************************************************/ 06206000
*        /* IF INPUT REPAIR WORKFILE PRESENT, CLOSE IT               */ 06207000
*        /************************************************************/ 06208000
*        IF REPIRWIO ^= NULLPTR                                    1578 06209000
*          THEN                                                    1578 06210000
         L     @15,@PC00001+8                                      1578 06211000
         L     @15,REPIRWIO(,@15)                                  1578 06212000
         LTR   @15,@15                                             1578 06213000
         BZ    @RF01578                                            1578 06214000
*            CALL IDCIOCL0(GDTTBL,REPIRWIO);                       1579 06215000
         L     @15,@PC00001                                        1579 06216000
         ST    @15,@AL00001                                        1579 06217000
         L     @15,@PC00001+8                                      1579 06218000
         LA    @15,REPIRWIO(,@15)                                  1579 06219000
         ST    @15,@AL00001+4                                      1579 06220000
         MVI   @AL00001+4,X'80'                                    1579 06221000
         L     @14,@PC00001                                        1579 06222000
         L     @15,GDTCLS(,@14)                                    1579 06223000
         LA    @01,@AL00001                                        1579 06224000
         BALR  @14,@15                                             1579 06225000
*          ELSE;                                                   1580 06226000
*                                                                  1580 06227000
@RF01578 DS    0H                                                  1581 06228000
*        /************************************************************/ 06229000
*        /* IF OUTPUT REPAIR WORKFILE PRESENT, CLOSE IT              */ 06230000
*        /************************************************************/ 06231000
*        IF REPORWIO ^= NULLPTR                                    1581 06232000
*          THEN                                                    1581 06233000
         L     @15,@PC00001+8                                      1581 06234000
         L     @15,REPORWIO(,@15)                                  1581 06235000
         LTR   @15,@15                                             1581 06236000
         BZ    @RF01581                                            1581 06237000
*            CALL IDCIOCL0(GDTTBL,REPORWIO);                       1582 06238000
         L     @15,@PC00001                                        1582 06239000
         ST    @15,@AL00001                                        1582 06240000
         L     @15,@PC00001+8                                      1582 06241000
         LA    @15,REPORWIO(,@15)                                  1582 06242000
         ST    @15,@AL00001+4                                      1582 06243000
         MVI   @AL00001+4,X'80'                                    1582 06244000
         L     @14,@PC00001                                        1582 06245000
         L     @15,GDTCLS(,@14)                                    1582 06246000
         LA    @01,@AL00001                                        1582 06247000
         BALR  @14,@15                                             1582 06248000
*          ELSE;                                                   1583 06249000
*                                                                  1583 06250000
@RF01581 DS    0H                                                  1584 06251000
*        /************************************************************/ 06252000
*        /* IF INPUT DATASET IS PRESENT, CLOSE IT                    */ 06253000
*        /************************************************************/ 06254000
*        IF SAVCLIN ^= NULLPTR                                     1584 06255000
*          THEN                                                    1584 06256000
         L     @15,SAVCLIN                                         1584 06257000
         LTR   @15,@15                                             1584 06258000
         BZ    @RF01584                                            1584 06259000
*            CALL IDCIO050(GDTTBL,CLOSE,SAVCLIN);                  1585 06260000
         L     @15,@PC00001                                        1585 06261000
         ST    @15,@AL00001                                        1585 06262000
         LA    @15,CLOSE                                           1585 06263000
         ST    @15,@AL00001+4                                      1585 06264000
         LA    @15,SAVCLIN                                         1585 06265000
         ST    @15,@AL00001+8                                      1585 06266000
         MVI   @AL00001+8,X'80'                                    1585 06267000
         L     @14,@PC00001                                        1585 06268000
         L     @15,GDTEXP(,@14)                                    1585 06269000
         LA    @01,@AL00001                                        1585 06270000
         BALR  @14,@15                                             1585 06271000
*          ELSE;                                                   1586 06272000
*                                                                  1586 06273000
@RF01584 DS    0H                                                  1587 06274000
*        /************************************************************/ 06275000
*        /* IF OUTPUT DATA SET OR VTOCHEADER PRESENT, CLOSE IT       */ 06276000
*        /************************************************************/ 06277000
*        IF SAVCLOUT ^= NULLPTR                                    1587 06278000
*          THEN                                                    1587 06279000
         L     @15,SAVCLOUT                                        1587 06280000
         LTR   @15,@15                                             1587 06281000
         BZ    @RF01587                                            1587 06282000
*            CALL IDCIO050(GDTTBL,CLOSE,SAVCLOUT);                 1588 06283000
         L     @15,@PC00001                                        1588 06284000
         ST    @15,@AL00001                                        1588 06285000
         LA    @15,CLOSE                                           1588 06286000
         ST    @15,@AL00001+4                                      1588 06287000
         LA    @15,SAVCLOUT                                        1588 06288000
         ST    @15,@AL00001+8                                      1588 06289000
         MVI   @AL00001+8,X'80'                                    1588 06290000
         L     @14,@PC00001                                        1588 06291000
         L     @15,GDTEXP(,@14)                                    1588 06292000
         LA    @01,@AL00001                                        1588 06293000
         BALR  @14,@15                                             1588 06294000
*          ELSE;                                                   1589 06295000
*                                                                  1589 06296000
@RF01587 DS    0H                                                  1590 06297000
*            /********************************************************/ 06298000
*            /* IF VTOC OR VTOCHEADER ENQUEUED, DEQUEUED IT          */ 06299000
*            /********************************************************/ 06300000
*        IF REPENQSW ^= ZERO                                       1590 06301000
*          THEN                                                    1590 06302000
         L     @15,@PC00001+8                                      1590 06303000
         CLI   REPENQSW(@15),0                                     1590 06304000
         BE    @RF01590                                            1590 06305000
*            CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);                1591 06306000
         L     @15,@PC00001                                        1591 06307000
         ST    @15,@AL00001                                        1591 06308000
         L     @15,@PC00001+8                                      1591 06309000
         L     @01,REPQRPTR(,@15)                                  1591 06310000
         ST    @01,@AL00001+4                                      1591 06311000
         L     @15,@PC00001+8                                      1591 06312000
         L     @01,REPQRPTR(,@15)                                  1591 06313000
         LA    @15,SPRNAME(,@01)                                   1591 06314000
         ST    @15,@AL00001+8                                      1591 06315000
         MVI   @AL00001+8,X'80'                                    1591 06316000
         L     @14,@PC00001                                        1591 06317000
         L     @15,GDTDEQ(,@14)                                    1591 06318000
         LA    @01,@AL00001                                        1591 06319000
         BALR  @14,@15                                             1591 06320000
*          ELSE;                                                   1592 06321000
@RF01590 DS    0H                                                  1593 06322000
*        IF SAVCLOUT ^= ZERO | SAVCLIN ^= ZERO | DATSPA = YESS     1593 06323000
*          THEN                                                    1593 06324000
         L     @15,SAVCLOUT                                        1593 06325000
         LTR   @15,@15                                             1593 06326000
         BNZ   @RT01593                                            1593 06327000
         L     @15,SAVCLIN                                         1593 06328000
         LTR   @15,@15                                             1593 06329000
         BNZ   @RT01593                                            1593 06330000
         CLI   DATSPA,1                                            1593 06331000
         BNE   @RF01593                                            1593 06332000
@RT01593 DS    0H                                                  1594 06333000
*            CALL IDCSAFP0(GDTTBL,RD01,ALL);                       1594 06334000
         MVC   @AL00001+4(8),@AL01594                              1594 06335000
         L     @15,@PC00001                                        1594 06336000
         ST    @15,@AL00001                                        1594 06337000
         L     @14,@PC00001                                        1594 06338000
         L     @15,GDTFPL(,@14)                                    1594 06339000
         LA    @01,@AL00001                                        1594 06340000
         BALR  @14,@15                                             1594 06341000
*          ELSE;                                                   1595 06342000
*                                                                  1595 06343000
@RF01593 DS    0H                                                  1596 06344000
*        /************************************************************/ 06345000
*        /*                                                          */ 06346000
*        /*CLEAR DATA SETS AND REPAIR WORKFILE CONTROL BLOCK POINTERS*/ 06347000
*        /*CLEAR THE DATSPA INDICATOR                                */ 06348000
*        /*                                                          */ 06349000
*        /************************************************************/ 06350000
*        SAVCLIN = NULLPTR;                                        1596 06351000
         SLR   @15,@15                                             1596 06352000
         ST    @15,SAVCLIN                                         1596 06353000
*        SAVCLOUT = NULLPTR;                                       1597 06354000
         SLR   @15,@15                                             1597 06355000
         ST    @15,SAVCLOUT                                        1597 06356000
*        REPIRWIO = NULLPTR;                                       1598 06357000
         L     @15,@PC00001+8                                      1598 06358000
         SLR   @14,@14                                             1598 06359000
         ST    @14,REPIRWIO(,@15)                                  1598 06360000
*        REPORWIO = NULLPTR;                                       1599 06361000
         L     @15,@PC00001+8                                      1599 06362000
         SLR   @14,@14                                             1599 06363000
         ST    @14,REPORWIO(,@15)                                  1599 06364000
*        REPENQSW = ZERO;                                          1600 06365000
         L     @15,@PC00001+8                                      1600 06366000
         MVI   REPENQSW(@15),X'00'                                 1600 06367000
*        DATSPA = NOT;                                             1601 06368000
         MVI   DATSPA,X'00'                                        1601 06369000
*        RETURN CODE(LASTCC00);                                    1602 06370000
         SLR   @15,@15                                             1602 06371000
         L     @14,@SA00006                                        1602 06372000
         LM    @00,@12,@SA00006+8                                  1602 06373000
         BR    @14                                                 1602 06374000
*END MODCLFP;                                                      1603 06375000
*END IDCRD050;                                                     1604 06376000
*END IDCRD05                                                       1605 06377000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 06378000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 06379000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 06380000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 06381000
*/*%INCLUDE SYSLIB  (IDCCSRD )                                        * 06382000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                        * 06383000
*/*%INCLUDE SYSLIB  (IDCDF66 )                                        * 06384000
*/*%INCLUDE SYSLIB  (IDCDF65 )                                        * 06385000
*;                                                                 1605 06386000
@DATA    DS    0H                                                       06387000
@CH00612 DC    H'13'                                                    06388000
@CH00663 DC    H'22'                                                    06389000
@CH00667 DC    H'23'                                                    06390000
@CH00681 DC    H'25'                                                    06391000
@CH00685 DC    H'26'                                                    06392000
@CH01944 DC    H'27'                                                    06393000
@CH00690 DC    H'28'                                                    06394000
@CH00698 DC    H'30'                                                    06395000
@CH00046 DC    H'31'                                                    06396000
@CH00223 DC    H'32'                                                    06397000
@CH01990 DC    H'33'                                                    06398000
@CH00736 DC    H'41'                                                    06399000
@CH00742 DC    H'42'                                                    06400000
@CH00753 DC    H'43'                                                    06401000
@CH00767 DC    H'45'                                                    06402000
@CH02146 DC    H'78'                                                    06403000
@CH00865 DC    H'92'                                                    06404000
@CH02101 DC    H'-1'                                                    06405000
@SM02156 MVC   RWF2KD(0,@01),RB2KD(@15)                                 06406000
@SM02158 MVC   RWF2KD-1(0,@15),MNKSTVAL(@01)                            06407000
@SM02160 MVC   RWF2KD-1(0,@01),MNDSTVAL(@04)                            06408000
@SM02162 MVC   RB3KD(0,@01),RB1KD(@15)                                  06409000
@SM02164 MVC   RB3KD-1(0,@15),MNKSTVAL(@01)                             06410000
@SM02166 MVC   RB3KD-1(0,@01),MNDSTVAL(@15)                             06411000
         DS    0F                                                       06412000
@AL00590 EQU   *                       LIST WITH   2 ARGUMENT(S)        06413000
@AL00510 EQU   *                       LIST WITH   1 ARGUMENT(S)        06414000
@AL00951 DC    A(IN)                   LIST WITH   1 ARGUMENT(S)        06415000
         DC    A(ZEROS)                                                 06416000
@AL00728 EQU   *                       LIST WITH   2 ARGUMENT(S)        06417000
@AL00643 DC    A(OUT)                  LIST WITH   1 ARGUMENT(S)        06418000
         DC    A(ZEROS)                                                 06419000
@AL01594 DC    A(RD01)                 LIST WITH   2 ARGUMENT(S)        06420000
         DC    AL1(X'80')                                               06421000
         DC    AL3(ALL)                                                 06422000
@DATD    DSECT                                                          06423000
         DS    0F                                                       06424000
@SA00001 DS    18F                                                      06425000
@PC00001 DS    3F                                                       06426000
@SA00002 DS    15F                                                      06427000
@SA00004 DS    15F                                                      06428000
@SA00006 DS    15F                                                      06429000
@SA00003 DS    15F                                                      06430000
@SA00005 DS    15F                                                      06431000
@AL00001 DS    5A                                                       06432000
IDCRD05  CSECT                                                          06433000
         DS    0F                                                       06434000
@CF00221 DC    F'1'                                                     06435000
@CH00221 EQU   @CF00221+2                                               06436000
@CF00044 DC    F'4'                                                     06437000
@CH00044 EQU   @CF00044+2                                               06438000
@CF00288 DC    F'5'                                                     06439000
@CF00181 DC    F'8'                                                     06440000
@CH00181 EQU   @CF00181+2                                               06441000
@CF00230 DC    F'15'                                                    06442000
@CF00475 DC    F'16'                                                    06443000
@CH00475 EQU   @CF00475+2                                               06444000
@CF00652 DC    F'21'                                                    06445000
@CH00652 EQU   @CF00652+2                                               06446000
@CF00312 DC    F'24'                                                    06447000
@CH00312 EQU   @CF00312+2                                               06448000
@CF00694 DC    F'29'                                                    06449000
@CH00694 EQU   @CF00694+2                                               06450000
@CF00689 DC    F'110'                                                   06451000
@CH00689 EQU   @CF00689+2                                               06452000
@CF00987 DC    F'255'                                                   06453000
@CF02147 DC    F'-16'                                                   06454000
@CF02135 DC    F'-12'                                                   06455000
@CF02168 DC    F'-4'                                                    06456000
@CF02153 DC    XL4'0000FFFF'                                            06457000
@DATD    DSECT                                                          06458000
         DS    0D                                                       06459000
LISTSCAN DS    A                                                        06460000
IOCSPTR  DS    A                                                        06461000
OPNPTR   DS    A                                                        06462000
DDSTRU   DS    A                                                        06463000
FSADDR   DS    A                                                        06464000
ERCNVADR DS    A                                                        06465000
DMPINDEX DS    A                                                        06466000
CCMSGPTR DS    A                                                        06467000
CMMSGPTR DS    A                                                        06468000
CTMSGPTR DS    A                                                        06469000
ELEMENT  DS    F                                                        06470000
INFTC    DS    F                                                        06471000
SIGMA    DS    F                                                        06472000
TARPTR   DS    A                                                        06473000
SOURPTR  DS    A                                                        06474000
BFPTROUT DS    A                                                        06475000
BFPTRIN  DS    A                                                        06476000
SAVCLOUT DS    A                                                        06477000
SAVCLIN  DS    A                                                        06478000
RWFPTR1  DS    A                                                        06479000
TEMPB1PT DS    A                                                        06480000
TEMPB3PT DS    A                                                        06481000
SVDTADDR DS    A                                                        06482000
LISTPTR  DS    A                                                        06483000
TESTRC   DS    H                                                        06484000
LASTCC   DS    H                                                        06485000
NEWLN    DS    H                                                        06486000
ILOOP    DS    H                                                        06487000
SAVNURE  DS    H                                                        06488000
SAVSIG   DS    H                                                        06489000
I6       DS    H                                                        06490000
SUMKEY   DS    H                                                        06491000
SUMNOKEY DS    H                                                        06492000
XIND     DS    H                                                        06493000
EXP      DS    H                                                        06494000
MOVLEN   DS    H                                                        06495000
SETRC    DS    H                                                        06496000
NOKYCNST DS    FL1                                                      06497000
SVRECNUM DS    FL1                                                      06498000
OVFLSW   DS    FL1                                                      06499000
LASTOVFL DS    FL1                                                      06500000
PREVREC  DS    FL1                                                      06501000
DATSPA   DS    FL1                                                      06502000
STRINGSW DS    FL1                                                      06503000
FWSW     DS    FL1                                                      06504000
DOUT     DS    FL1                                                      06505000
LISTLN   DS    FL1                                                      06506000
@TS00001 DS    CL95                                                     06507000
KEYRWF   DS    CL11                                                     06508000
         ORG   KEYRWF                                                   06509000
KEYRWFVS DS    CL6                                                      06510000
KEYRWCHR DS    CL5                                                      06511000
         ORG   KEYRWCHR                                                 06512000
KEYRWFCH DS    CL4                                                      06513000
KEYRWFR  DS    CL1                                                      06514000
         ORG   KEYRWF+11                                                06515000
MOKAD    DS    CL11                                                     06516000
         ORG   MOKAD                                                    06517000
MOKAD6   DS    CL6                                                      06518000
MOKAD5   DS    CL5                                                      06519000
         ORG   MOKAD5                                                   06520000
MOKAD5C  DS    CL2                                                      06521000
MOKAD5H  DS    CL2                                                      06522000
MOKAD5R  DS    CL1                                                      06523000
         ORG   MOKAD+11                                                 06524000
PARNA    DS    CL17                                                     06525000
DSNMSG   DS    CL44                                                     06526000
MIKAD    DS    CL11                                                     06527000
         ORG   MIKAD                                                    06528000
MIKAD6   DS    CL6                                                      06529000
MIKAD5   DS    CL5                                                      06530000
         ORG   MIKAD5                                                   06531000
MIKAD54  DS    CL4                                                      06532000
         ORG   MIKAD54                                                  06533000
MIKAD54C DS    CL2                                                      06534000
MIKAD54H DS    CL2                                                      06535000
         ORG   MIKAD5+4                                                 06536000
MIKAD54R DS    CL1                                                      06537000
         ORG   MIKAD+11                                                 06538000
         DS    CL1                                                      06539000
SMIKAD5  DS    CL5                                                      06540000
         ORG   SMIKAD5                                                  06541000
SMICC    DS    FL2                                                      06542000
SMIHH    DS    FL2                                                      06543000
SMIR     DS    FL1                                                      06544000
         ORG   SMIKAD5+5                                                06545000
         DS    CL1                                                      06546000
SMOKAD5  DS    CL5                                                      06547000
         ORG   SMOKAD5                                                  06548000
SMOCC    DS    FL2                                                      06549000
SMOHH    DS    FL2                                                      06550000
SMOR     DS    FL1                                                      06551000
         ORG   SMOKAD5+5                                                06552000
         DS    CL1                                                      06553000
KYCNSTCH DS    CL2                                                      06554000
         ORG   KYCNSTCH                                                 06555000
KYCNST   DS    FL2                                                      06556000
         ORG   KYCNSTCH+2                                               06557000
SAVCHR   DS    CL5                                                      06558000
         ORG   SAVCHR                                                   06559000
@NM00142 DS    CL2                                                      06560000
@NM00143 DS    CL2                                                      06561000
SAVCHR1  DS    FL1                                                      06562000
         ORG   SAVCHR+5                                                 06563000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                06564000
@ENDDATD EQU   *                                                        06565000
IDCRD05  CSECT                                                          06566000
         NOPR  ((@ENDDATD-@DATD)/1025*16)                               06567000
         DS    0F                                                       06568000
@SIZDATD DC    AL1(0)                                                   06569000
         DC    AL3(@ENDDATD-@DATD)                                      06570000
@CV01810 DC    V(IDCRDDS)                                               06571000
@CV01811 DC    V(IDCRDER)                                               06572000
@CV01812 DC    V(IDCRDRD)                                               06573000
@CV01813 DC    V(IDCRDRF)                                               06574000
@CV01814 DC    V(IDCRDIO)                                               06575000
         DS    0D                                                       06576000
IGNORE   DC    XL1'F0'                                                  06577000
@CC02060 DC    C'RD50'                                                  06578000
@CC02061 DC    C'RD51'                                                  06579000
@CC02086 DC    C'RD52'                                                  06580000
@CC02087 DC    C'RD53'                                                  06581000
@CC02093 DC    C'RD58'                                                  06582000
@CC02094 DC    C'RD59'                                                  06583000
@CC02105 DC    C'RD5A'                                                  06584000
@CC02106 DC    C'RD5B'                                                  06585000
@CC02110 DC    C'RD55'                                                  06586000
@CC02111 DC    C'RD54'                                                  06587000
ALL      DC    CL3'ALL'                                                 06588000
FORMAT   DC    CL4'FORM'                                                06589000
HSECOND  DC    CL4'HSEC'                                                06590000
CLOCK    DC    CL4'KLOK'                                                06591000
SETZERO  DC    CL4'ZERO'                                                06592000
SETBLANK DC    CL4'BLNK'                                                06593000
NOSET    DC    CL4'NSET'                                                06594000
OVERRIDE DC    CL4'OVRD'                                                06595000
ACQUIRE  DC    CL8'ACQUIRE '                                            06596000
RELINQ   DC    CL8'RELINQ  '                                            06597000
MOUNT    DC    CL8'MOUNT   '                                            06598000
DEMOUNT  DC    CL8'DEMOUNT '                                            06599000
DEFINE   DC    CL8'DEFINE  '                                            06600000
MOVE     DC    CL8'MOVE    '                                            06601000
TRACEQ   DC    CL8'TRACEQ  '                                            06602000
COPYTABL DC    CL8'COPYTABL'                                            06603000
COPYCRTG DC    CL8'COPYCRTG'                                            06604000
COPYVOL  DC    CL8'COPYVOL '                                            06605000
VVIC     DC    CL8'VVIC    '                                            06606000
TUNE     DC    CL8'TUNE    '                                            06607000
NAMES    DC    CL4'NAME'                                                06608000
UNIT     DC    CL4'UNIT'                                                06609000
SHR      DC    CL4'SHR '                                                06610000
EXCL     DC    CL4'EXCL'                                                06611000
NOWAIT   DC    CL4'NWAI'                                                06612000
WAIT     DC    CL4'WAIT'                                                06613000
SECCHECK DC    CL8'SECCHECK'                                            06614000
SCRVTOC  DC    CL8'SCRVTOC '                                            06615000
GETVTOC  DC    CL8'GETVTOC '                                            06616000
PUTVTOC  DC    CL8'PUTVTOC '                                            06617000
RECATLG  DC    CL8'RECATLG '                                            06618000
INITVOL  DC    CL8'INITVOL '                                            06619000
CHECK    DC    CL8'CHECK   '                                            06620000
POSTUCB  DC    CL8'POSTUCB '                                            06621000
GET      DC    CL8'GET     '                                            06622000
PUT      DC    CL8'PUT     '                                            06623000
CLOSE    DC    CL8'CLOSE   '                                            06624000
OPEN     DC    CL8'OPEN    '                                            06625000
RVOPENR  DC    CL8'OPENR   '                                            06626000
RVRDCNT  DC    CL8'READCNT '                                            06627000
RVREADKD DC    CL8'READKD  '                                            06628000
RVSPACCR DC    CL8'SPACCR  '                                            06629000
RVFWRITE DC    CL8'FWRITE  '                                            06630000
RVWRITER DC    CL8'WRITEREC'                                            06631000
PUTLABEL DC    CL8'PUTLABEL'                                            06632000
GETLABEL DC    CL8'GETLABEL'                                            06633000
CANCEL   DC    CL8'CANCEL  '                                            06634000
SET      DC    CL8'SET     '                                            06635000
SELECTX  DC    CL8'SELECTX '                                            06636000
CHANGEX  DC    CL8'CHANGEX '                                            06637000
SELECTDD DC    CL8'SELECTDD'                                            06638000
SELECTDS DC    CL8'SELECTDS'                                            06639000
TBLREST  DC    CL8'TBLREST '                                            06640000
NULLIFYC DC    CL8'NULLIFYC'                                            06641000
RDMSC    DC    CL8'RDMSC   '                                            06642000
RDMSCTBL DC    CL8'RDMSCTBL'                                            06643000
RDCARTLB DC    CL8'RDCARTLB'                                            06644000
AUDITCEL DC    CL8'AUDITCEL'                                            06645000
RDSTGAD  DC    CL8'RDSTGAD '                                            06646000
OPENR    DC    CL8'OPENR   '                                            06647000
OUT      DC    CL1'O'                                                   06648000
IN       DC    CL1'I'                                                   06649000
RD01     DC    CL4'RD01'                                                06650000
VTOCHDRK DC    CL17'VTOCHEADERADDRESS'                                  06651000
OUTDSAK  DC    CL17'OUTDATASETADDRESS'                                  06652000
INRRCON  DC    CL17'INREPAIRRANGE    '                                  06653000
VTOCNAME DC    CL10'VTOCHEADER'                                         06654000
LASTEXT  DC    X'FFFFFFFFFF'                                            06655000
FWRITE   DC    CL8'FWRITE'                                              06656000
WRITEREC DC    CL8'WRITEREC'                                            06657000
MODID    DC    CL4'RD05'                                                06658000
PRECED   DC    CL13'PRECEDING    '                                      06659000
SUBSEQ   DC    CL13'SUBSEQUENT TO'                                      06660000
VTOCDSN  DS    CL44                                                     06661000
         ORG   VTOCDSN                                                  06662000
@NM00137 DC    44X'04'                                                  06663000
         ORG   VTOCDSN+44                                               06664000
FMT4DSN  DS    CL44                                                     06665000
         ORG   FMT4DSN                                                  06666000
@NM00138 DC    CL12'FORMAT4.DSCB'                                       06667000
@NM00139 DC    32X'40'                                                  06668000
         ORG   FMT4DSN+44                                               06669000
ZEROS    DS    CL8                                                      06670000
         ORG   ZEROS                                                    06671000
@NM00140 DC    8X'00'                                                   06672000
         ORG   ZEROS+8                                                  06673000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       06674000
@01      EQU   01                                                       06675000
@02      EQU   02                                                       06676000
@03      EQU   03                                                       06677000
@04      EQU   04                                                       06678000
@05      EQU   05                                                       06679000
@06      EQU   06                                                       06680000
@07      EQU   07                                                       06681000
@08      EQU   08                                                       06682000
@09      EQU   09                                                       06683000
@10      EQU   10                                                       06684000
@11      EQU   11                                                       06685000
@12      EQU   12                                                       06686000
@13      EQU   13                                                       06687000
@14      EQU   14                                                       06688000
@15      EQU   15                                                       06689000
RTNREG   EQU   @15                                                      06690000
REG2     EQU   @02                                                      06691000
REG3     EQU   @03                                                      06692000
REG4     EQU   @04                                                      06693000
REG5     EQU   @05                                                      06694000
REG7     EQU   @07                                                      06695000
REG8     EQU   @08                                                      06696000
REG0     EQU   @00                                                      06697000
REG1     EQU   @01                                                      06698000
REG10    EQU   @10                                                      06699000
REG11    EQU   @11                                                      06700000
REG12    EQU   @12                                                      06701000
REG13    EQU   @13                                                      06702000
REG14    EQU   @14                                                      06703000
REG15    EQU   @15                                                      06704000
REG6     EQU   @06                                                      06705000
REG9     EQU   @09                                                      06706000
IDCSAEP0 EQU   0                                                        06707000
IDCSAGP0 EQU   0                                                        06708000
IDCSAFP0 EQU   0                                                        06709000
IDCSADQ0 EQU   0                                                        06710000
TRACE1   EQU   0                                                        06711000
OLDERID1 EQU   TRACE1                                                   06712000
TRACE2   EQU   0                                                        06713000
OLDERID2 EQU   TRACE2                                                   06714000
NEWID2   EQU   TRACE2+95                                                06715000
NEWERID2 EQU   5                                                        06716000
CIRAGL   EQU   0                                                        06717000
CIRTYPE  EQU   CIRAGL                                                   06718000
ALLAGL   EQU   0                                                        06719000
ALLSTS   EQU   ALLAGL+24                                                06720000
ALLDSP   EQU   ALLAGL+25                                                06721000
ALLORG   EQU   ALLAGL+26                                                06722000
ALLOPT   EQU   ALLAGL+28                                                06723000
UNITABL  EQU   0                                                        06724000
UNITADR  EQU   UNITABL+4                                                06725000
@NM00010 EQU   UNITADR                                                  06726000
UNITSTAT EQU   UNITABL+6                                                06727000
IDCIOCL0 EQU   0                                                        06728000
IDCIO050 EQU   0                                                        06729000
IOCSTR   EQU   0                                                        06730000
IOCTRN   EQU   IOCSTR+8                                                 06731000
IOCDSO   EQU   IOCSTR+16                                                06732000
IOCRFM   EQU   IOCSTR+17                                                06733000
IOCMAC   EQU   IOCSTR+18                                                06734000
IOCMAC2  EQU   IOCSTR+19                                                06735000
IOCCHP   EQU   IOCSTR+20                                                06736000
IOCMSG   EQU   IOCSTR+21                                                06737000
IOCDSN   EQU   IOCSTR+32                                                06738000
IOCRBA   EQU   IOCSTR+40                                                06739000
IOCTTR   EQU   IOCRBA                                                   06740000
IOCMEM   EQU   IOCSTR+44                                                06741000
IOCNWM   EQU   IOCSTR+48                                                06742000
OPNAGL   EQU   0                                                        06743000
OPNOPT   EQU   OPNAGL                                                   06744000
OPNRFM   EQU   OPNAGL+1                                                 06745000
OPNTYP   EQU   OPNAGL+2                                                 06746000
OPNMOD   EQU   OPNAGL+3                                                 06747000
OPNDEV   EQU   OPNAGL+24                                                06748000
OPNDSO   EQU   OPNAGL+41                                                06749000
OPNOPT2  EQU   OPNAGL+42                                                06750000
IOINFOPT EQU   0                                                        06751000
UVOLLIST EQU   0                                                        06752000
UVOLENT  EQU   UVOLLIST+2                                               06753000
DARGLIST EQU   0                                                        06754000
DARGSTID EQU   DARGLIST+8                                               06755000
DARGARY  EQU   DARGLIST+20                                              06756000
DARGINS  EQU   DARGARY                                                  06757000
DARGINL  EQU   DARGARY+2                                                06758000
FMTLIST  EQU   0                                                        06759000
FMTFLGS  EQU   FMTLIST                                                  06760000
FMTSPF   EQU   FMTLIST+2                                                06761000
FMTRFNO  EQU   FMTSPF                                                   06762000
FMTILEN  EQU   FMTRFNO                                                  06763000
FMTIOFF  EQU   FMTLIST+4                                                06764000
FMTTRBC  EQU   FMTIOFF                                                  06765000
FMTSTO   EQU   FMTTRBC                                                  06766000
FMTOCOL  EQU   FMTLIST+6                                                06767000
FMTCNVF  EQU   FMTLIST+10                                               06768000
ERCNVTAB EQU   0                                                        06769000
ERTYPE   EQU   ERCNVTAB                                                 06770000
EROPER   EQU   ERCNVTAB+1                                               06771000
EROSOPER EQU   ERCNVTAB+2                                               06772000
IDCDB010 EQU   0                                                        06773000
DMPITM   EQU   0                                                        06774000
DMPARY   EQU   0                                                        06775000
INFIL    EQU   0                                                        06776000
INDS     EQU   0                                                        06777000
INDSFLG  EQU   INDS+10                                                  06778000
DOUTF    EQU   0                                                        06779000
DOTDS    EQU   0                                                        06780000
DOTDSFLG EQU   DOTDS+10                                                 06781000
VOLSR    EQU   0                                                        06782000
VOLSRFLG EQU   VOLSR+10                                                 06783000
DCCHR    EQU   0                                                        06784000
DREC     EQU   0                                                        06785000
VOLDS    EQU   0                                                        06786000
VOLDSFLG EQU   VOLDS+10                                                 06787000
DSCHR    EQU   0                                                        06788000
DSCHH    EQU   0                                                        06789000
VOLRR    EQU   0                                                        06790000
VOLRRFLG EQU   VOLRR+10                                                 06791000
RRCHR    EQU   0                                                        06792000
RRCHH    EQU   0                                                        06793000
DKEYL    EQU   0                                                        06794000
DATAL    EQU   0                                                        06795000
DVTCS    EQU   0                                                        06796000
DVTCSFLG EQU   DVTCS+10                                                 06797000
CINFL    EQU   0                                                        06798000
CINDS    EQU   0                                                        06799000
CINDSFLG EQU   CINDS+10                                                 06800000
COFIL    EQU   0                                                        06801000
CCATL    EQU   0                                                        06802000
CCATLFLG EQU   CCATL+10                                                 06803000
CVOLD    EQU   0                                                        06804000
CVOLDFLG EQU   CVOLD+10                                                 06805000
CDCHR    EQU   0                                                        06806000
CDHHR    EQU   0                                                        06807000
CVOLS    EQU   0                                                        06808000
CVOLSFLG EQU   CVOLS+10                                                 06809000
CCCHR    EQU   0                                                        06810000
CRECR    EQU   0                                                        06811000
CKEYL    EQU   0                                                        06812000
CDATL    EQU   0                                                        06813000
CVTCS    EQU   0                                                        06814000
CVTCSFLG EQU   CVTCS+10                                                 06815000
DBFIL    EQU   0                                                        06816000
DBDS     EQU   0                                                        06817000
DBDSFLG  EQU   DBDS+10                                                  06818000
DBVOL    EQU   0                                                        06819000
DBVOLFLG EQU   DBVOL+10                                                 06820000
DBCCH    EQU   0                                                        06821000
DBHHH    EQU   0                                                        06822000
DBKEY    EQU   0                                                        06823000
DBDAT    EQU   0                                                        06824000
MNDAT    EQU   0                                                        06825000
MNKEY    EQU   0                                                        06826000
MNCNT    EQU   0                                                        06827000
MNCNTLEN EQU   MNCNT                                                    06828000
MNCNTVAL EQU   MNCNT+1                                                  06829000
MINFL    EQU   0                                                        06830000
MINDS    EQU   0                                                        06831000
MINDSFLG EQU   MINDS+10                                                 06832000
MIRK     EQU   0                                                        06833000
MIDSA    EQU   0                                                        06834000
MIRNG    EQU   0                                                        06835000
MORK     EQU   0                                                        06836000
MODSA    EQU   0                                                        06837000
MOUTF    EQU   0                                                        06838000
MODS     EQU   0                                                        06839000
MODSFLG  EQU   MODS+10                                                  06840000
MOVFL    EQU   0                                                        06841000
MVTOC    EQU   0                                                        06842000
MVTCS    EQU   0                                                        06843000
MVTCSFLG EQU   MVTCS+10                                                 06844000
MVTCSVAL EQU   MVTCS+21                                                 06845000
MVTCR    EQU   0                                                        06846000
MVTCRVAL EQU   MVTCR+1                                                  06847000
MIRVO    EQU   0                                                        06848000
MIRVOFLG EQU   MIRVO+10                                                 06849000
MIRVOVAL EQU   MIRVO+21                                                 06850000
MIRCH    EQU   0                                                        06851000
MIRCHVAL EQU   MIRCH+1                                                  06852000
MIDVO    EQU   0                                                        06853000
MIDVOFLG EQU   MIDVO+10                                                 06854000
MIDVOVAL EQU   MIDVO+21                                                 06855000
MIDCH    EQU   0                                                        06856000
MIDCHVAL EQU   MIDCH+1                                                  06857000
MRRVO    EQU   0                                                        06858000
MRRVOFLG EQU   MRRVO+10                                                 06859000
MRRVOVAL EQU   MRRVO+21                                                 06860000
MRRCH    EQU   0                                                        06861000
MRRCHVAL EQU   MRRCH+1                                                  06862000
MRRHH    EQU   0                                                        06863000
MRRHHVAL EQU   MRRHH+1                                                  06864000
MNDOF    EQU   0                                                        06865000
MNDOFVAL EQU   MNDOF                                                    06866000
MNDST    EQU   0                                                        06867000
MNDSTLEN EQU   MNDST                                                    06868000
MNDSTVAL EQU   MNDST+1                                                  06869000
MNKOF    EQU   0                                                        06870000
MNKOFVAL EQU   MNKOF                                                    06871000
MNKST    EQU   0                                                        06872000
MNKSTLEN EQU   MNKST                                                    06873000
MNKSTVAL EQU   MNKST+1                                                  06874000
MORVO    EQU   0                                                        06875000
MORVOFLG EQU   MORVO+10                                                 06876000
MORVOVAL EQU   MORVO+21                                                 06877000
MORCH    EQU   0                                                        06878000
MORCHVAL EQU   MORCH+1                                                  06879000
MODVO    EQU   0                                                        06880000
MODVOFLG EQU   MODVO+10                                                 06881000
MODVOVAL EQU   MODVO+21                                                 06882000
MODCH    EQU   0                                                        06883000
MODCHVAL EQU   MODCH+1                                                  06884000
CCMSG    EQU   0                                                        06885000
CMMSG    EQU   0                                                        06886000
CMVOLFLG EQU   CMMSG+6                                                  06887000
CTMSG    EQU   0                                                        06888000
CTARRAY  EQU   CTMSG+4                                                  06889000
MDAGL    EQU   0                                                        06890000
MDFLAGS  EQU   MDAGL+30                                                 06891000
MDVTOC   EQU   MDAGL+32                                                 06892000
PUAGL    EQU   0                                                        06893000
CKAGL    EQU   0                                                        06894000
CKFLAGS  EQU   CKAGL+28                                                 06895000
EXCLAGL  EQU   0                                                        06896000
EXCLFLAG EQU   EXCLAGL+22                                               06897000
EXOARG   EQU   0                                                        06898000
EXOEXT   EQU   EXOARG+24                                                06899000
EXOPT    EQU   EXOARG+32                                                06900000
EXFLG    EQU   EXOARG+33                                                06901000
EXGARG   EQU   0                                                        06902000
EXWRARG  EQU   0                                                        06903000
EXRWCHR  EQU   EXWRARG+26                                               06904000
EXSPACE  EQU   EXWRARG+36                                               06905000
EXPARG   EQU   0                                                        06906000
EXPDATA  EQU   EXPARG+12                                                06907000
EXPDATAB EQU   0                                                        06908000
EXPARRAY EQU   EXPDATAB+4                                               06909000
VS2AGL   EQU   0                                                        06910000
VSLABOPT EQU   VS2AGL+28                                                06911000
VS2MSG   EQU   VS2AGL+35                                                06912000
VS2RESOP EQU   VS2AGL+36                                                06913000
VS1AGL   EQU   0                                                        06914000
VSSECOPT EQU   VS1AGL+68                                                06915000
VSVTOPT  EQU   VS1AGL+69                                                06916000
VSCATOPT EQU   VS1AGL+70                                                06917000
VSRETURN EQU   VS1AGL+71                                                06918000
VSMSG    EQU   VS1AGL+72                                                06919000
VSRESOPT EQU   VS1AGL+73                                                06920000
RCTAGL   EQU   0                                                        06921000
RCTOPT   EQU   RCTAGL+8                                                 06922000
STAEPARM EQU   0                                                        06923000
STARCVY  EQU   STAEPARM+52                                              06924000
STARETRY EQU   STAEPARM+53                                              06925000
VOLLABEL EQU   0                                                        06926000
SV82LIST EQU   0                                                        06927000
@NM00072 EQU   SV82LIST+4                                               06928000
SV82DCBP EQU   @NM00072                                                 06929000
@NM00073 EQU   SV82LIST+12                                              06930000
SV82WRKP EQU   @NM00073                                                 06931000
SRTAGL   EQU   0                                                        06932000
LCTINFO  EQU   0                                                        06933000
LCTFLAGS EQU   LCTINFO+32                                               06934000
UCTAGL   EQU   0                                                        06935000
UCTFLAGS EQU   UCTAGL+68                                                06936000
SELAGL   EQU   0                                                        06937000
SELFLAGS EQU   SELAGL+22                                                06938000
DATESAGL EQU   0                                                        06939000
DATESOPT EQU   DATESAGL+20                                              06940000
VS3AGL   EQU   0                                                        06941000
VS3FLAGS EQU   VS3AGL+58                                                06942000
VSDVTOC  EQU   0                                                        06943000
VSDSTAT  EQU   0                                                        06944000
VSDSFLG1 EQU   VSDSTAT+16                                               06945000
VSDFLG2  EQU   VSDSTAT+17                                               06946000
VSDSCR   EQU   0                                                        06947000
VSDSCRFL EQU   VSDSCR+4                                                 06948000
VSDUSAGE EQU   0                                                        06949000
VSDDORG  EQU   VSDUSAGE+9                                               06950000
VSDALLOC EQU   VSDUSAGE+10                                              06951000
VSDUSEF  EQU   VSDUSAGE+11                                              06952000
VSDDSORG EQU   VSDUSAGE+16                                              06953000
VSDBLOCK EQU   0                                                        06954000
VSDSPACE EQU   VSDBLOCK+12                                              06955000
VSDARRAY EQU   VSDBLOCK+16                                              06956000
VSDVARY  EQU   VSDARRAY+48                                              06957000
LOCTAB   EQU   0                                                        06958000
RIOAREA  EQU   0                                                        06959000
RIOHDR   EQU   RIOAREA                                                  06960000
RPREV    EQU   RIOHDR+2                                                 06961000
RKEY     EQU   0                                                        06962000
RKEYCHR  EQU   RKEY+6                                                   06963000
RKEYFLG  EQU   RKEY+11                                                  06964000
RBUF     EQU   0                                                        06965000
RBUFCNT  EQU   RBUF                                                     06966000
RBCCHHR  EQU   RBUFCNT                                                  06967000
WIOAREA  EQU   0                                                        06968000
WBUFF    EQU   WIOAREA+4                                                06969000
WBUF     EQU   0                                                        06970000
WBUFCNT  EQU   WBUF                                                     06971000
WBCCHHR  EQU   WBUFCNT                                                  06972000
RWFHDR   EQU   0                                                        06973000
SRPRTARG EQU   0                                                        06974000
RWFINFO  EQU   0                                                        06975000
RWFKEY1  EQU   RWFINFO+82                                               06976000
RWFKEY2  EQU   RWFINFO+93                                               06977000
RWHDRINF EQU   0                                                        06978000
RDARG    EQU   0                                                        06979000
RDCTLBK  EQU   RDARG+8                                                  06980000
RDIOAREA EQU   RDARG+12                                                 06981000
RDDARE   EQU   RDARG+16                                                 06982000
RDLOCPTR EQU   RDARG+20                                                 06983000
RDCHR    EQU   RDARG+26                                                 06984000
RDDS     EQU   RDARG+31                                                 06985000
RDSPACE  EQU   RDARG+36                                                 06986000
RDFUNC   EQU   RDARG+46                                                 06987000
RDSPKL   EQU   RDARG+47                                                 06988000
INFOAREA EQU   0                                                        06989000
INFODSN  EQU   0                                                        06990000
INFOVOL  EQU   0                                                        06991000
DEVAREA  EQU   0                                                        06992000
DEVDEVTP EQU   DEVAREA                                                  06993000
DEVTBYT2 EQU   DEVDEVTP+1                                               06994000
@NM00113 EQU   DEVAREA+8                                                06995000
DEVWORD3 EQU   DEVAREA+12                                               06996000
DEVTC    EQU   DEVWORD3                                                 06997000
DEVBOH   EQU   DEVWORD3+2                                               06998000
DEVBOH1  EQU   DEVBOH                                                   06999000
DEVWORD4 EQU   DEVAREA+16                                               07000000
DEVKC    EQU   DEVWORD4                                                 07001000
DEV4B1   EQU   DEVWORD4+1                                               07002000
INF4FLG  EQU   DEV4B1                                                   07003000
XTNTTBL2 EQU   0                                                        07004000
XTN2ENT  EQU   XTNTTBL2                                                 07005000
XTN2CHR1 EQU   XTN2ENT+44                                               07006000
XTN2CHR2 EQU   XTN2ENT+48                                               07007000
XTNTTBL  EQU   0                                                        07008000
XTNTHDR  EQU   XTNTTBL                                                  07009000
XTNHDSN  EQU   XTNTHDR+8                                                07010000
XTNHCHR1 EQU   XTNTHDR+68                                               07011000
XTNHCHR2 EQU   XTNTHDR+76                                               07012000
XTNTENT  EQU   XTNTTBL+88                                               07013000
XTNTCHR1 EQU   XTNTENT+62                                               07014000
XTNTCHR2 EQU   XTNTENT+70                                               07015000
SPLIST   EQU   0                                                        07016000
SPQNAME  EQU   SPLIST                                                   07017000
SPRNAME  EQU   SPLIST+8                                                 07018000
RWFR     EQU   0                                                        07019000
RWFRCNT  EQU   RWFR+16                                                  07020000
RB0      EQU   0                                                        07021000
RB0C     EQU   RB0                                                      07022000
RB0CKL   EQU   RB0C+5                                                   07023000
RB0CDL   EQU   RB0C+6                                                   07024000
RB1      EQU   0                                                        07025000
RB1NUM   EQU   RB1                                                      07026000
RB1C     EQU   RB1+4                                                    07027000
RB1CCHR  EQU   RB1C                                                     07028000
RB1CKL   EQU   RB1C+5                                                   07029000
RB1CDL   EQU   RB1C+6                                                   07030000
RB1KD    EQU   RB1+12                                                   07031000
RB2      EQU   0                                                        07032000
RB2KEY   EQU   RB2                                                      07033000
RB2FLG1  EQU   RB2+11                                                   07034000
RB2FLG3  EQU   RB2+14                                                   07035000
RB2C     EQU   RB2+16                                                   07036000
RB2CHR   EQU   RB2C                                                     07037000
RB2CHH   EQU   RB2CHR+2                                                 07038000
RB2CKL   EQU   RB2C+5                                                   07039000
RB2CDL   EQU   RB2C+6                                                   07040000
RB2KD    EQU   RB2+24                                                   07041000
RB3      EQU   0                                                        07042000
RB3NUM   EQU   RB3                                                      07043000
RB3C     EQU   RB3+4                                                    07044000
RB3CCHR  EQU   RB3C                                                     07045000
RB3CR    EQU   RB3CCHR+4                                                07046000
RB3CKL   EQU   RB3C+5                                                   07047000
RB3CDL   EQU   RB3C+6                                                   07048000
RB3KD    EQU   RB3+12                                                   07049000
RWF1     EQU   0                                                        07050000
RWF1KYFL EQU   RWF1                                                     07051000
RWF1C    EQU   RWF1+16                                                  07052000
RWF1CHR  EQU   RWF1C                                                    07053000
RWF2     EQU   0                                                        07054000
RWF2KYFL EQU   RWF2                                                     07055000
RWF2KEY  EQU   RWF2KYFL                                                 07056000
RWF2FLG1 EQU   RWF2KYFL+11                                              07057000
RWF2C    EQU   RWF2+16                                                  07058000
RWF2CHR  EQU   RWF2C                                                    07059000
RWF2CKL  EQU   RWF2C+5                                                  07060000
RWF2CDL  EQU   RWF2C+6                                                  07061000
RWF2KD   EQU   RWF2+24                                                  07062000
RWFDANA  EQU   0                                                        07063000
DSOUT    EQU   0                                                        07064000
DSOUT4   EQU   DSOUT                                                    07065000
ALLA     EQU   0                                                        07066000
AMSTP011 EQU   0                                                        07067000
AMSTP041 EQU   0                                                        07068000
AMSTP042 EQU   0                                                        07069000
AMSTP043 EQU   0                                                        07070000
AMSTP044 EQU   0                                                        07071000
CDATLPTR EQU   0                                                        07072000
CDSRG    EQU   0                                                        07073000
CHARA    EQU   0                                                        07074000
CKEYLPTR EQU   0                                                        07075000
CLEN     EQU   0                                                        07076000
CLENCNT  EQU   0                                                        07077000
COPY     EQU   0                                                        07078000
CSRNG    EQU   0                                                        07079000
CVTOC    EQU   0                                                        07080000
DATALPTR EQU   0                                                        07081000
DBDATPTR EQU   0                                                        07082000
DBKEYPTR EQU   0                                                        07083000
DBLOC    EQU   0                                                        07084000
DBLST    EQU   0                                                        07085000
DBLSTCNT EQU   0                                                        07086000
DBRNG    EQU   0                                                        07087000
DISPL    EQU   0                                                        07088000
DKEYLPTR EQU   0                                                        07089000
DLENG    EQU   0                                                        07090000
DLENGCNT EQU   0                                                        07091000
DMPTRM   EQU   0                                                        07092000
DPVTC    EQU   0                                                        07093000
DRRNG    EQU   0                                                        07094000
DSRNG    EQU   0                                                        07095000
DUMP     EQU   0                                                        07096000
ERROR    EQU   0                                                        07097000
FREC     EQU   0                                                        07098000
FULLR    EQU   0                                                        07099000
HEXA     EQU   0                                                        07100000
IDCIOCO0 EQU   0                                                        07101000
IDCIOGT0 EQU   0                                                        07102000
IDCIOIT0 EQU   0                                                        07103000
IDCIOOP0 EQU   0                                                        07104000
IDCIOPO0 EQU   0                                                        07105000
IDCIOPT0 EQU   0                                                        07106000
IDCIOSI0 EQU   0                                                        07107000
IDCIOST0 EQU   0                                                        07108000
IDCIOTM0 EQU   0                                                        07109000
IDCIOVY0 EQU   0                                                        07110000
IDCSAAL0 EQU   0                                                        07111000
IDCSACA0 EQU   0                                                        07112000
IDCSACL0 EQU   0                                                        07113000
IDCSACR0 EQU   0                                                        07114000
IDCSADE0 EQU   0                                                        07115000
IDCSADL0 EQU   0                                                        07116000
IDCSAFS0 EQU   0                                                        07117000
IDCSAGS0 EQU   0                                                        07118000
IDCSAID0 EQU   0                                                        07119000
IDCSALC0 EQU   0                                                        07120000
IDCSALD0 EQU   0                                                        07121000
IDCSALK0 EQU   0                                                        07122000
IDCSANQ0 EQU   0                                                        07123000
IDCSAPR0 EQU   0                                                        07124000
IDCSAPT0 EQU   0                                                        07125000
IDCSAQL0 EQU   0                                                        07126000
IDCSARC0 EQU   0                                                        07127000
IDCSARV0 EQU   0                                                        07128000
IDCSASC0 EQU   0                                                        07129000
IDCSASI0 EQU   0                                                        07130000
IDCSASN0 EQU   0                                                        07131000
IDCSASS0 EQU   0                                                        07132000
IDCSAST0 EQU   0                                                        07133000
IDCSATI0 EQU   0                                                        07134000
IDCSAUC0 EQU   0                                                        07135000
IDCSAWO0 EQU   0                                                        07136000
IDCSA060 EQU   0                                                        07137000
IDCST010 EQU   0                                                        07138000
IDCTPER0 EQU   0                                                        07139000
IDONL    EQU   0                                                        07140000
LISTTEST EQU   0                                                        07141000
MODIF    EQU   0                                                        07142000
NEWERID1 EQU   5                                                        07143000
STAGR    EQU   0                                                        07144000
GDTTBL   EQU   0                                                        07145000
GDTTR1   EQU   GDTTBL+8                                                 07146000
GDTTR2   EQU   GDTTBL+12                                                07147000
GDTDBG   EQU   GDTTBL+40                                                07148000
GDTSTC   EQU   GDTTBL+44                                                07149000
GDTPRT   EQU   GDTTBL+48                                                07150000
GDTESS   EQU   GDTTBL+52                                                07151000
GDTESA   EQU   GDTTBL+56                                                07152000
GDTRST   EQU   GDTTBL+60                                                07153000
GDTRES   EQU   GDTTBL+64                                                07154000
GDTCAL   EQU   GDTTBL+68                                                07155000
GDTGSP   EQU   GDTTBL+72                                                07156000
GDTFSP   EQU   GDTTBL+76                                                07157000
GDTGPL   EQU   GDTTBL+80                                                07158000
GDTFPL   EQU   GDTTBL+84                                                07159000
GDTLOD   EQU   GDTTBL+88                                                07160000
GDTDEL   EQU   GDTTBL+92                                                07161000
GDTPRL   EQU   GDTTBL+96                                                07162000
GDTEPL   EQU   GDTTBL+100                                               07163000
GDTTIM   EQU   GDTTBL+104                                               07164000
GDTIIO   EQU   GDTTBL+108                                               07165000
GDTTIO   EQU   GDTTBL+112                                               07166000
GDTOPN   EQU   GDTTBL+124                                               07167000
GDTCLS   EQU   GDTTBL+128                                               07168000
GDTGET   EQU   GDTTBL+132                                               07169000
GDTPUT   EQU   GDTTBL+136                                               07170000
GDTPOS   EQU   GDTTBL+140                                               07171000
GDTCPY   EQU   GDTTBL+144                                               07172000
GDTCAT   EQU   GDTTBL+148                                               07173000
GDTSNP   EQU   GDTTBL+164                                               07174000
GDTVFY   EQU   GDTTBL+172                                               07175000
GDTUID   EQU   GDTTBL+192                                               07176000
GDTPMT   EQU   GDTTBL+196                                               07177000
GDTCIR   EQU   GDTTBL+200                                               07178000
GDTLNK   EQU   GDTTBL+204                                               07179000
GDTALC   EQU   GDTTBL+208                                               07180000
GDTDLC   EQU   GDTTBL+212                                               07181000
GDTQAL   EQU   GDTTBL+216                                               07182000
GDTSTW   EQU   GDTTBL+220                                               07183000
GDTSSC   EQU   GDTTBL+224                                               07184000
GDTENQ   EQU   GDTTBL+228                                               07185000
GDTRSV   EQU   GDTTBL+232                                               07186000
GDTDEQ   EQU   GDTTBL+236                                               07187000
GDTSFO   EQU   GDTTBL+240                                               07188000
GDTWTO   EQU   GDTTBL+244                                               07189000
GDTSCR   EQU   GDTTBL+248                                               07190000
GDTUNT   EQU   GDTTBL+252                                               07191000
GDTRCT   EQU   GDTTBL+256                                               07192000
GDTIFO   EQU   GDTTBL+260                                               07193000
GDTEXP   EQU   GDTTBL+264                                               07194000
GDTSTA   EQU   GDTTBL+268                                               07195000
GDTERR   EQU   GDTTBL+272                                               07196000
GDTUNC   EQU   GDTTBL+276                                               07197000
GDTLOC   EQU   GDTTBL+280                                               07198000
FDTTBL   EQU   0                                                        07199000
FDTPTR   EQU   FDTTBL+8                                                 07200000
REPTBL   EQU   0                                                        07201000
REPCB    EQU   REPTBL                                                   07202000
REPIRWIO EQU   REPCB+16                                                 07203000
REPORWIO EQU   REPCB+20                                                 07204000
REPIDSOP EQU   REPCB+24                                                 07205000
REPODSOP EQU   REPCB+28                                                 07206000
REPIDSAR EQU   REPCB+32                                                 07207000
REPODSAR EQU   REPCB+36                                                 07208000
REPSPRIT EQU   REPCB+40                                                 07209000
REPIBFPT EQU   REPCB+44                                                 07210000
REPOBFPT EQU   REPCB+48                                                 07211000
REPBUFF0 EQU   REPCB+52                                                 07212000
REPBUFF1 EQU   REPCB+56                                                 07213000
REPIXTNT EQU   REPCB+80                                                 07214000
REPOXTNT EQU   REPCB+88                                                 07215000
REPRWHAR EQU   REPCB+100                                                07216000
REPRWINA EQU   REPCB+104                                                07217000
REPILCPT EQU   REPCB+116                                                07218000
REPOLCPT EQU   REPCB+120                                                07219000
REPODEVA EQU   REPCB+128                                                07220000
REPQRPTR EQU   REPCB+132                                                07221000
REPEXOAR EQU   REPCB+140                                                07222000
REPCBEXT EQU   REPTBL+156                                               07223000
REPR0LN  EQU   REPCBEXT                                                 07224000
REPR1LN  EQU   REPCBEXT+2                                               07225000
REPSRPR  EQU   REPCBEXT+4                                               07226000
REPRCDCT EQU   REPCBEXT+8                                               07227000
CKREQ    EQU   REPCBEXT+16                                              07228000
CKRERN   EQU   CKREQ                                                    07229000
CKRMVAR  EQU   CKREQ+4                                                  07230000
WFAREA   EQU   REPCBEXT+76                                              07231000
WFIODAD  EQU   WFAREA                                                   07232000
WFIODLN  EQU   WFAREA+4                                                 07233000
WFIOKYA  EQU   WFAREA+8                                                 07234000
WFREQ    EQU   WFAREA+12                                                07235000
WFRTYP   EQU   WFREQ                                                    07236000
WFRGET   EQU   WFRTYP                                                   07237000
WFRUPD   EQU   WFRTYP                                                   07238000
WFRPOS   EQU   WFRTYP                                                   07239000
WFROPT   EQU   WFREQ+1                                                  07240000
WFRIN    EQU   WFROPT                                                   07241000
WFRUP    EQU   WFROPT                                                   07242000
REPENQSW EQU   REPCBEXT+90                                              07243000
RWDEF    EQU   RWFHDR                                                   07244000
RWFRDE   EQU   RWFR                                                     07245000
RB2DEF   EQU   RB2                                                      07246000
RB2FLG   EQU   RB2DEF+11                                                07247000
RWF1DEF  EQU   RWF1                                                     07248000
RWF2DEF  EQU   RWF2                                                     07249000
RWF2FLG  EQU   RWF2DEF+11                                               07250000
RDCHRC   EQU   RDCHR                                                    07251000
RDSPKLDL EQU   RDSPKL                                                   07252000
*                                      START UNREFERENCED COMPONENTS    07253000
@NM00136 EQU   RWF2DEF+16                                               07254000
@NM00135 EQU   RWF2DEF                                                  07255000
@NM00134 EQU   RWF1DEF+16                                               07256000
RWF1FLG  EQU   RWF1DEF+11                                               07257000
@NM00133 EQU   RWF1DEF                                                  07258000
@NM00132 EQU   RB2DEF+16                                                07259000
@NM00131 EQU   RB2DEF                                                   07260000
@NM00125 EQU   RWFRDE+15                                                07261000
RWFROV   EQU   RWFRDE+14                                                07262000
RWFRF2   EQU   RWFRDE+12                                                07263000
RWFRF1   EQU   RWFRDE+11                                                07264000
@NM00124 EQU   RWFRDE                                                   07265000
RWFHKLN  EQU   RWDEF+92                                                 07266000
RWFHDLN  EQU   RWDEF+90                                                 07267000
RWFHFT   EQU   RWDEF+89                                                 07268000
@NM00104 EQU   RWDEF                                                    07269000
@NM00103 EQU   WFROPT                                                   07270000
@NM00102 EQU   WFRTYP                                                   07271000
WFRLD    EQU   WFRTYP                                                   07272000
WFRADD   EQU   WFRTYP                                                   07273000
@NM00101 EQU   REPCBEXT+75                                              07274000
WFIOGUK  EQU   REPCBEXT+64                                              07275000
RDCATRC  EQU   REPCBEXT+60                                              07276000
@NM00100 EQU   CKREQ+2                                                  07277000
@NM00099 EQU   REPCBEXT+15                                              07278000
K        EQU   REPCBEXT+14                                              07279000
J        EQU   REPCBEXT+13                                              07280000
I        EQU   REPCBEXT+12                                              07281000
REPRC    EQU   REPCBEXT+6                                               07282000
@NM00098 EQU   REPSRPR+1                                                07283000
@NM00097 EQU   REPSRPR                                                  07284000
REPSRPRT EQU   REPSRPR                                                  07285000
REPCDSOP EQU   REPCB+152                                                07286000
REPCPPTR EQU   REPCB+148                                                07287000
REPOPAGL EQU   REPCB+144                                                07288000
REPALLAG EQU   REPCB+136                                                07289000
REPIDEVA EQU   REPCB+124                                                07290000
REPOSYSI EQU   REPCB+112                                                07291000
REPISYSI EQU   REPCB+108                                                07292000
REPOINFO EQU   REPCB+96                                                 07293000
REPIINFO EQU   REPCB+92                                                 07294000
REPOXTN2 EQU   REPCB+84                                                 07295000
REPIXTN2 EQU   REPCB+76                                                 07296000
REPOUTCL EQU   REPCB+72                                                 07297000
REPINCL  EQU   REPCB+68                                                 07298000
REPRWHDO EQU   REPCB+64                                                 07299000
REPRWHDI EQU   REPCB+60                                                 07300000
REPARFIO EQU   REPCB+12                                                 07301000
REPRESER EQU   REPCB                                                    07302000
FDTVERB  EQU   FDTTBL                                                   07303000
GDTECT   EQU   GDTTBL+188                                               07304000
GDTPSB   EQU   GDTTBL+184                                               07305000
GDTUPT   EQU   GDTTBL+180                                               07306000
GDTCMB   EQU   GDTTBL+176                                               07307000
GDTSPR   EQU   GDTTBL+168                                               07308000
@NM00001 EQU   GDTTBL+160                                               07309000
GDTABH   EQU   GDTTBL+156                                               07310000
GDTABT   EQU   GDTTBL+152                                               07311000
GDTTOH   EQU   GDTTBL+120                                               07312000
GDTRIP   EQU   GDTTBL+116                                               07313000
GDTIOH   EQU   GDTTBL+36                                                07314000
GDTSAH   EQU   GDTTBL+32                                                07315000
GDTTPH   EQU   GDTTBL+28                                                07316000
GDTRIH   EQU   GDTTBL+24                                                07317000
GDTSTH   EQU   GDTTBL+20                                                07318000
GDTDBH   EQU   GDTTBL+16                                                07319000
GDTPRM   EQU   GDTTBL+4                                                 07320000
GDTHDR   EQU   GDTTBL                                                   07321000
@NM00141 EQU   DSOUT+4                                                  07322000
@NM00130 EQU   RWF2KYFL+15                                              07323000
RWF2FLG3 EQU   RWF2KYFL+14                                              07324000
RWF2FLG2 EQU   RWF2KYFL+12                                              07325000
RWF1KD   EQU   RWF1+24                                                  07326000
RWF1CDL  EQU   RWF1C+6                                                  07327000
RWF1CKL  EQU   RWF1C+5                                                  07328000
@NM00129 EQU   RWF1KYFL+15                                              07329000
RWF1FLG3 EQU   RWF1KYFL+14                                              07330000
RWF1FLG2 EQU   RWF1KYFL+12                                              07331000
RWF1FLG1 EQU   RWF1KYFL+11                                              07332000
RWF1KEY  EQU   RWF1KYFL                                                 07333000
RB3CHH   EQU   RB3CCHR+2                                                07334000
RB3CCC   EQU   RB3CCHR                                                  07335000
@NM00128 EQU   RB2CHR+4                                                 07336000
@NM00127 EQU   RB2CHR                                                   07337000
@NM00126 EQU   RB2+15                                                   07338000
RB2FLG2  EQU   RB2+12                                                   07339000
RB1CR    EQU   RB1CCHR+4                                                07340000
RB1CHH   EQU   RB1CCHR+2                                                07341000
RB1CCC   EQU   RB1CCHR                                                  07342000
RB0KD    EQU   RB0+8                                                    07343000
RB0CR    EQU   RB0C+4                                                   07344000
RB0CHH   EQU   RB0C+2                                                   07345000
RB0CCC   EQU   RB0C                                                     07346000
RWFRKD   EQU   RWFR+24                                                  07347000
RWFRDLN  EQU   RWFRCNT+6                                                07348000
RWFRKLN  EQU   RWFRCNT+5                                                07349000
RWFRR    EQU   RWFRCNT+4                                                07350000
RWFRHH   EQU   RWFRCNT+2                                                07351000
RWFRCC   EQU   RWFRCNT                                                  07352000
RWFRFLG  EQU   RWFR+11                                                  07353000
RWFRKEY  EQU   RWFR                                                     07354000
SPRVOL   EQU   SPRNAME+1                                                07355000
SPRLEN   EQU   SPRNAME                                                  07356000
@NM00123 EQU   XTNTENT+75                                               07357000
XTNTR2   EQU   XTNTCHR2+4                                               07358000
XTNTHH2  EQU   XTNTCHR2+2                                               07359000
XTNTCC2  EQU   XTNTCHR2                                                 07360000
@NM00122 EQU   XTNTENT+67                                               07361000
XTNTR1   EQU   XTNTCHR1+4                                               07362000
XTNTHH1  EQU   XTNTCHR1+2                                               07363000
XTNTCC1  EQU   XTNTCHR1                                                 07364000
@NM00121 EQU   XTNTENT+59                                               07365000
XTNTVOL  EQU   XTNTENT+53                                               07366000
XTNTVOLN EQU   XTNTENT+52                                               07367000
XTNTDSN  EQU   XTNTENT+8                                                07368000
XTNTDDN  EQU   XTNTENT                                                  07369000
@NM00120 EQU   XTNTHDR+85                                               07370000
XTNHMODE EQU   XTNTHDR+84                                               07371000
@NM00119 EQU   XTNTHDR+81                                               07372000
XTNHR2   EQU   XTNHCHR2+4                                               07373000
XTNHHH2  EQU   XTNHCHR2+2                                               07374000
XTNHCC2  EQU   XTNHCHR2                                                 07375000
@NM00118 EQU   XTNTHDR+73                                               07376000
XTNHR1   EQU   XTNHCHR1+4                                               07377000
XTNHHH1  EQU   XTNHCHR1+2                                               07378000
XTNHCC1  EQU   XTNHCHR1                                                 07379000
XTNHPWD  EQU   XTNTHDR+60                                               07380000
@NM00117 EQU   XTNTHDR+59                                               07381000
XTNHVOL  EQU   XTNTHDR+53                                               07382000
XTNHVOLN EQU   XTNTHDR+52                                               07383000
XTNHDDN  EQU   XTNTHDR                                                  07384000
XTN2HH2  EQU   XTN2CHR2+2                                               07385000
XTN2CC2  EQU   XTN2CHR2                                                 07386000
XTN2HH1  EQU   XTN2CHR1+2                                               07387000
XTN2CC1  EQU   XTN2CHR1                                                 07388000
XTN2DSN  EQU   XTN2ENT                                                  07389000
DEVWORD5 EQU   DEVAREA+20                                               07390000
@NM00116 EQU   DEV4B1+1                                                 07391000
@NM00115 EQU   DEV4B1                                                   07392000
@NM00114 EQU   DEV4B1                                                   07393000
DEVBOH2  EQU   DEVBOH+1                                                 07394000
DEVMAXHH EQU   @NM00113+2                                               07395000
DEVMAXCC EQU   @NM00113                                                 07396000
DEVMAXBK EQU   DEVAREA+4                                                07397000
DEVTBYT4 EQU   DEVDEVTP+3                                               07398000
DEVTBYT3 EQU   DEVDEVTP+2                                               07399000
@NM00112 EQU   DEVTBYT2                                                 07400000
DEVRVDEV EQU   DEVTBYT2                                                 07401000
@NM00111 EQU   DEVTBYT2                                                 07402000
DEVTBYT1 EQU   DEVDEVTP                                                 07403000
INFVOL   EQU   INFOVOL+4                                                07404000
INFVOLLN EQU   INFOVOL+2                                                07405000
INFVOLID EQU   INFOVOL                                                  07406000
INFDSN   EQU   INFODSN+4                                                07407000
INFDSNLN EQU   INFODSN+2                                                07408000
INFDSNID EQU   INFODSN                                                  07409000
INFAREA  EQU   INFOAREA+4                                               07410000
INFDATAL EQU   INFOAREA+2                                               07411000
INFAREAL EQU   INFOAREA                                                 07412000
RDDLEN   EQU   RDARG+56                                                 07413000
RDKLEN   EQU   RDARG+52                                                 07414000
RDLENTOT EQU   RDARG+50                                                 07415000
RDSPDL   EQU   RDARG+48                                                 07416000
@NM00110 EQU   RDSPACE+8                                                07417000
@NM00109 EQU   RDSPACE+6                                                07418000
@NM00108 EQU   RDSPACE+4                                                07419000
@NM00107 EQU   RDSPACE+1                                                07420000
@NM00106 EQU   RDSPACE                                                  07421000
RDRWPKLN EQU   RDARG+32                                                 07422000
RDRECNUM EQU   RDCHR+4                                                  07423000
RDHH     EQU   RDCHR+2                                                  07424000
RDCC     EQU   RDCHR                                                    07425000
RDCCWCNT EQU   RDARG+24                                                 07426000
RDRES    EQU   RDARG                                                    07427000
RWHDRDLN EQU   RWHDRINF+6                                               07428000
RWHDRKLN EQU   RWHDRINF+5                                               07429000
@NM00105 EQU   RWHDRINF+1                                               07430000
RWHDRFIX EQU   RWHDRINF                                                 07431000
RWFKCHR2 EQU   RWFKEY2+6                                                07432000
RWFKVOL2 EQU   RWFKEY2                                                  07433000
RWFKCHR1 EQU   RWFKEY1+6                                                07434000
RWFKVOL1 EQU   RWFKEY1                                                  07435000
RWFVOL   EQU   RWFINFO+52                                               07436000
RWFDSN   EQU   RWFINFO+8                                                07437000
RWFDDN   EQU   RWFINFO                                                  07438000
SRCCHHRP EQU   SRPRTARG+40                                              07439000
SRRECPTR EQU   SRPRTARG+36                                              07440000
SRSPRECL EQU   SRPRTARG+32                                              07441000
SRDSNPTR EQU   SRPRTARG+28                                              07442000
SRERCODE EQU   SRPRTARG+24                                              07443000
SRRWFKEY EQU   SRPRTARG+20                                              07444000
SRRWFDSN EQU   SRPRTARG+16                                              07445000
SRVOLPTR EQU   SRPRTARG+12                                              07446000
SRDSNHDR EQU   SRPRTARG+8                                               07447000
SRVREPTR EQU   SRPRTARG+4                                               07448000
SRVRECL  EQU   SRPRTARG                                                 07449000
RWFHFM   EQU   RWFHDR+99                                                07450000
RWFHDSNU EQU   RWFHDR+55                                                07451000
RWFHDSNR EQU   RWFHDR+11                                                07452000
RWFHKEY  EQU   RWFHDR                                                   07453000
WKEYDAT  EQU   WBUF+8                                                   07454000
WBDL     EQU   WBUFCNT+6                                                07455000
WBKL     EQU   WBUFCNT+5                                                07456000
WBREC    EQU   WBCCHHR+4                                                07457000
WBHH     EQU   WBCCHHR+2                                                07458000
WBCC     EQU   WBCCHHR                                                  07459000
WNUMREC  EQU   WIOAREA                                                  07460000
RKEYDAT  EQU   RBUF+8                                                   07461000
RBDL     EQU   RBUFCNT+6                                                07462000
RBKL     EQU   RBUFCNT+5                                                07463000
RBREC    EQU   RBCCHHR+4                                                07464000
RBHH     EQU   RBCCHHR+2                                                07465000
RBCC     EQU   RBCCHHR                                                  07466000
@NM00096 EQU   RKEYFLG+4                                                07467000
RKEYFLG3 EQU   RKEYFLG+3                                                07468000
RKEYFLG2 EQU   RKEYFLG+1                                                07469000
RKEYFLG1 EQU   RKEYFLG                                                  07470000
RKEYR    EQU   RKEYCHR+4                                                07471000
RKEYHH   EQU   RKEYCHR+2                                                07472000
RKEYCC   EQU   RKEYCHR                                                  07473000
RKEYVOL  EQU   RKEY                                                     07474000
RBUFF    EQU   RIOAREA+282                                              07475000
@NM00095 EQU   RIOHDR+26                                                07476000
@NM00094 EQU   RIOHDR+10                                                07477000
RNUMREC  EQU   RIOHDR+8                                                 07478000
@NM00093 EQU   RIOHDR+7                                                 07479000
RPREVR   EQU   RPREV+4                                                  07480000
RPREVHH  EQU   RPREV+2                                                  07481000
RPREVCC  EQU   RPREV                                                    07482000
@NM00092 EQU   RIOHDR+1                                                 07483000
RFIRST   EQU   RIOHDR                                                   07484000
LOCDLEN  EQU   LOCTAB+18                                                07485000
LOCKLEN  EQU   LOCTAB+17                                                07486000
@NM00091 EQU   LOCTAB+16                                                07487000
LOCCNTFD EQU   LOCTAB+8                                                 07488000
LOCRCKD  EQU   LOCTAB+6                                                 07489000
LOCRCNT  EQU   LOCTAB+4                                                 07490000
LOCADDR  EQU   LOCTAB                                                   07491000
VSDDSN   EQU   VSDARRAY+4                                               07492000
VSDVOLCT EQU   VSDARRAY                                                 07493000
VSDFMT0  EQU   VSDBLOCK+8                                               07494000
VSDVTOCS EQU   VSDBLOCK+4                                               07495000
VSDELEM  EQU   VSDBLOCK                                                 07496000
VSDFREE  EQU   VSDUSAGE+24                                              07497000
VSDALLC  EQU   VSDUSAGE+19                                              07498000
VSDDSOR3 EQU   VSDDSORG+2                                               07499000
@NM00090 EQU   VSDDSORG                                                 07500000
VSDSCAL  EQU   VSDUSAGE+12                                              07501000
@NM00089 EQU   VSDUSEF                                                  07502000
VSDCALFR EQU   VSDUSEF                                                  07503000
@NM00088 EQU   VSDALLOC                                                 07504000
VSDABSTR EQU   VSDALLOC                                                 07505000
VSDABLK  EQU   VSDALLOC                                                 07506000
VSDATRK  EQU   VSDALLOC                                                 07507000
VSDACYL  EQU   VSDALLOC                                                 07508000
@NM00087 EQU   VSDDORG                                                  07509000
VSDOU    EQU   VSDDORG                                                  07510000
VSDOIS   EQU   VSDDORG                                                  07511000
VSDODA   EQU   VSDDORG                                                  07512000
VSDOUN   EQU   VSDDORG                                                  07513000
VSDOPS   EQU   VSDDORG                                                  07514000
VSDOPO   EQU   VSDDORG                                                  07515000
VSDEXTS  EQU   VSDUSAGE+8                                               07516000
VSDSECAL EQU   VSDUSAGE+4                                               07517000
VSDFTRK  EQU   VSDUSAGE+2                                               07518000
VSDTRKS  EQU   VSDUSAGE                                                 07519000
@NM00086 EQU   VSDSCR+5                                                 07520000
@NM00085 EQU   VSDSCRFL                                                 07521000
VSDVSAM  EQU   VSDSCRFL                                                 07522000
VSDCATLC EQU   VSDSCRFL                                                 07523000
VSDACBPT EQU   VSDSCR                                                   07524000
VSDPRTC  EQU   VSDSTAT+25                                               07525000
VSDCAT   EQU   VSDSTAT+22                                               07526000
VSDEXP   EQU   VSDSTAT+20                                               07527000
VSDCRE   EQU   VSDSTAT+18                                               07528000
@NM00084 EQU   VSDFLG2                                                  07529000
VSDERROR EQU   VSDFLG2                                                  07530000
VSDPROT  EQU   VSDFLG2                                                  07531000
VSDPWW   EQU   VSDFLG2                                                  07532000
VSDPWR   EQU   VSDFLG2                                                  07533000
@NM00083 EQU   VSDSFLG1                                                 07534000
VSDCVSAM EQU   VSDSFLG1                                                 07535000
VSDCATLG EQU   VSDSFLG1                                                 07536000
VSDVSAME EQU   VSDSFLG1                                                 07537000
VSDVSAMC EQU   VSDSFLG1                                                 07538000
VSDVTOCE EQU   VSDSFLG1                                                 07539000
VSDVTOCC EQU   VSDSFLG1                                                 07540000
VSDOWNER EQU   VSDSTAT+8                                                07541000
VSDEXPIR EQU   VSDSTAT+4                                                07542000
VSDCREAT EQU   VSDSTAT                                                  07543000
VSDFRCCL EQU   VSDVTOC+21                                               07544000
@NM00082 EQU   VSDVTOC+20                                               07545000
VSDFREXT EQU   VSDVTOC+16                                               07546000
@NM00081 EQU   VSDVTOC+15                                               07547000
VSDFRTRK EQU   VSDVTOC+11                                               07548000
@NM00080 EQU   VSDVTOC+10                                               07549000
VSDFRCYL EQU   VSDVTOC+6                                                07550000
@NM00079 EQU   VSDVTOC                                                  07551000
@NM00078 EQU   VS3FLAGS                                                 07552000
VS3SYSNM EQU   VS3FLAGS                                                 07553000
VS3UNCAT EQU   VS3FLAGS                                                 07554000
VS3SCR   EQU   VS3FLAGS                                                 07555000
VS3USAGE EQU   VS3FLAGS                                                 07556000
VS3STAT  EQU   VS3FLAGS                                                 07557000
VS3DD    EQU   VS3AGL+50                                                07558000
VS3VOL   EQU   VS3AGL+44                                                07559000
VS3POOL  EQU   VS3AGL+40                                                07560000
VS3DEV   EQU   VS3AGL+36                                                07561000
VS3UCBP  EQU   VS3AGL+32                                                07562000
VS3CREAT EQU   VS3AGL+28                                                07563000
VS3EXPIR EQU   VS3AGL+24                                                07564000
VS3AST   EQU   VS3AGL+22                                                07565000
VS3LEVLN EQU   VS3AGL+20                                                07566000
VS3LEVP  EQU   VS3AGL+16                                                07567000
VS3EXDSP EQU   VS3AGL+12                                                07568000
VS3LISTP EQU   VS3AGL+8                                                 07569000
VS3HEAD  EQU   VS3AGL                                                   07570000
@NM00077 EQU   DATESOPT                                                 07571000
DATDAYOP EQU   DATESOPT                                                 07572000
DATDTEOP EQU   DATESOPT                                                 07573000
DATSUB   EQU   DATESOPT                                                 07574000
DATADD   EQU   DATESOPT                                                 07575000
DATRETRN EQU   DATESAGL+16                                              07576000
DATDAYS  EQU   DATESAGL+12                                              07577000
DATDATE  EQU   DATESAGL+8                                               07578000
DATHEAD  EQU   DATESAGL                                                 07579000
@NM00076 EQU   SELFLAGS                                                 07580000
SELVOL   EQU   SELAGL+16                                                07581000
SELDDNP  EQU   SELAGL+12                                                07582000
SELUCBP  EQU   SELAGL+8                                                 07583000
SELHEAD  EQU   SELAGL                                                   07584000
@NM00075 EQU   UCTFLAGS                                                 07585000
UCTVSCAT EQU   UCTFLAGS                                                 07586000
UCTDD    EQU   UCTAGL+60                                                07587000
UCTVOLP  EQU   UCTAGL+56                                                07588000
UCTACBP  EQU   UCTAGL+52                                                07589000
UCTDSN   EQU   UCTAGL+8                                                 07590000
UCTHEAD  EQU   UCTAGL                                                   07591000
@NM00074 EQU   LCTFLAGS                                                 07592000
LCTVSCAT EQU   LCTFLAGS                                                 07593000
LCTOWNER EQU   LCTINFO+24                                               07594000
LCTEXPIR EQU   LCTINFO+20                                               07595000
LCTCREAT EQU   LCTINFO+16                                               07596000
LCTACBP  EQU   LCTINFO+12                                               07597000
LCTMULVC EQU   LCTINFO+8                                                07598000
LCTHEAD  EQU   LCTINFO                                                  07599000
SRTWORKP EQU   SRTAGL+28                                                07600000
SRTFLDLN EQU   SRTAGL+24                                                07601000
SRTPOSIT EQU   SRTAGL+20                                                07602000
SRTLEN   EQU   SRTAGL+16                                                07603000
SRTNUM   EQU   SRTAGL+12                                                07604000
SRTADDR  EQU   SRTAGL+8                                                 07605000
SRTHEAD  EQU   SRTAGL                                                   07606000
SV82DEBP EQU   SV82WRKP                                                 07607000
SV82TTRP EQU   SV82LIST+8                                               07608000
SV82VOLP EQU   SV82DCBP                                                 07609000
SV82UCBP EQU   SV82LIST+1                                               07610000
SV82CODE EQU   SV82LIST                                                 07611000
VOLRESV3 EQU   VOLLABEL+55                                              07612000
VOLOWNER EQU   VOLLABEL+45                                              07613000
VOLRESV1 EQU   VOLLABEL+20                                              07614000
VOLVTOC  EQU   VOLLABEL+15                                              07615000
VOLSECTY EQU   VOLLABEL+14                                              07616000
VOLSERNO EQU   VOLLABEL+8                                               07617000
VOLNO    EQU   VOLLABEL+7                                               07618000
VOLLABI  EQU   VOLLABEL+4                                               07619000
VOLKEY   EQU   VOLLABEL                                                 07620000
STAVTTR  EQU   STAEPARM+54                                              07621000
@NM00071 EQU   STARETRY                                                 07622000
STAVTOC  EQU   STARETRY                                                 07623000
STAOFF   EQU   STARETRY                                                 07624000
STAIO05  EQU   STARETRY                                                 07625000
@NM00070 EQU   STARCVY                                                  07626000
STACLEAR EQU   STARCVY                                                  07627000
STAVPOST EQU   STARCVY                                                  07628000
STAVENQ  EQU   STARCVY                                                  07629000
STAVDMNT EQU   STARCVY                                                  07630000
STAVMNT  EQU   STARCVY                                                  07631000
STATCB   EQU   STAEPARM+48                                              07632000
STARTADD EQU   STAEPARM+44                                              07633000
STAEXSAV EQU   STAEPARM+40                                              07634000
STARTSAV EQU   STAEPARM+36                                              07635000
STARTTR  EQU   STAEPARM+32                                              07636000
@NM00069 EQU   STAEPARM+30                                              07637000
STARVOL  EQU   STAEPARM+24                                              07638000
STARUCB  EQU   STAEPARM+20                                              07639000
@NM00068 EQU   STAEPARM+18                                              07640000
STAVVOL  EQU   STAEPARM+12                                              07641000
STAVUCB  EQU   STAEPARM+8                                               07642000
STAHEAD  EQU   STAEPARM                                                 07643000
RCTDSET  EQU   RCTAGL+32                                                07644000
RCTNVOL  EQU   RCTAGL+26                                                07645000
RCTOVOL  EQU   RCTAGL+20                                                07646000
RCTNDEV  EQU   RCTAGL+16                                                07647000
RCTODEV  EQU   RCTAGL+12                                                07648000
@NM00067 EQU   RCTAGL+10                                                07649000
@NM00066 EQU   RCTOPT                                                   07650000
RCTVOL   EQU   RCTOPT                                                   07651000
RCTDEV   EQU   RCTOPT                                                   07652000
RCTHEAD  EQU   RCTAGL                                                   07653000
@NM00065 EQU   VSRESOPT                                                 07654000
VSREAL   EQU   VSRESOPT                                                 07655000
VSRES    EQU   VSRESOPT                                                 07656000
@NM00064 EQU   VSMSG                                                    07657000
VSTOV    EQU   VSMSG                                                    07658000
VSFROMV  EQU   VSMSG                                                    07659000
@NM00063 EQU   VSRETURN                                                 07660000
VSUCAT   EQU   VSRETURN                                                 07661000
VSVSAM   EQU   VSRETURN                                                 07662000
@NM00062 EQU   VSCATOPT                                                 07663000
VSLIST   EQU   VSCATOPT                                                 07664000
VSSERIAL EQU   VSCATOPT                                                 07665000
VSDEVICE EQU   VSCATOPT                                                 07666000
@NM00061 EQU   VSVTOPT                                                  07667000
VSVSFLAG EQU   VSVTOPT                                                  07668000
VSALTTRK EQU   VSVTOPT                                                  07669000
VSTIME   EQU   VSVTOPT                                                  07670000
VSUCMAST EQU   VSSECOPT                                                 07671000
VSOPCAT  EQU   VSSECOPT                                                 07672000
VSUCTEST EQU   VSSECOPT                                                 07673000
VSWRITE  EQU   VSSECOPT                                                 07674000
VSREAD   EQU   VSSECOPT                                                 07675000
VSNONONV EQU   VSSECOPT                                                 07676000
VSMASTER EQU   VSSECOPT                                                 07677000
VSNOVSAM EQU   VSSECOPT                                                 07678000
VSODEVP  EQU   VS1AGL+64                                                07679000
VSOSERP  EQU   VS1AGL+60                                                07680000
VSDEVP   EQU   VS1AGL+56                                                07681000
VSSERP   EQU   VS1AGL+52                                                07682000
VSPFILEP EQU   VS1AGL+48                                                07683000
VSPSWDP  EQU   VS1AGL+44                                                07684000
VSCATDDP EQU   VS1AGL+40                                                07685000
VSACBP   EQU   VS1AGL+36                                                07686000
VSCATP   EQU   VS1AGL+32                                                07687000
VSNXTATP EQU   VS1AGL+28                                                07688000
VSNUMATP EQU   VS1AGL+24                                                07689000
VSIOP    EQU   VS1AGL+20                                                07690000
VSFILEP  EQU   VS1AGL+16                                                07691000
VSVOLP   EQU   VS1AGL+12                                                07692000
VSUCBP   EQU   VS1AGL+8                                                 07693000
VSHEAD   EQU   VS1AGL                                                   07694000
VSVTOCPT EQU   VS2AGL+48                                                07695000
@NM00060 EQU   VS2AGL+45                                                07696000
VSDDNAME EQU   VS2AGL+37                                                07697000
@NM00059 EQU   VS2RESOP                                                 07698000
VS2REAL  EQU   VS2RESOP                                                 07699000
VS2RES   EQU   VS2RESOP                                                 07700000
@NM00058 EQU   VS2MSG                                                   07701000
VS2TOV   EQU   VS2MSG                                                   07702000
VSVOLUME EQU   VS2AGL+29                                                07703000
@NM00057 EQU   VSLABOPT                                                 07704000
VSNOVTOC EQU   VSLABOPT                                                 07705000
VSVOLSER EQU   VSLABOPT                                                 07706000
VSOWNER  EQU   VSLABOPT                                                 07707000
VSIOBKPT EQU   VS2AGL+24                                                07708000
VSVOLPTR EQU   VS2AGL+20                                                07709000
VSOWNPTR EQU   VS2AGL+16                                                07710000
VSVTOCSZ EQU   VS2AGL+12                                                07711000
VSUCBPTR EQU   VS2AGL+8                                                 07712000
VS2HEAD  EQU   VS2AGL                                                   07713000
EXPDATAL EQU   EXPARRAY+6                                               07714000
@NM00056 EQU   EXPARRAY+5                                               07715000
EXPKEYLN EQU   EXPARRAY+4                                               07716000
EXPDATAP EQU   EXPARRAY                                                 07717000
EXPRECNO EQU   EXPDATAB                                                 07718000
EXPCCHHR EQU   EXPARG+16                                                07719000
EXPCTLBK EQU   EXPARG+8                                                 07720000
EXPHEAD  EQU   EXPARG                                                   07721000
EXRWFUN  EQU   EXWRARG+46                                               07722000
@NM00055 EQU   EXSPACE+8                                                07723000
@NM00054 EQU   EXSPACE+6                                                07724000
@NM00053 EQU   EXSPACE+4                                                07725000
@NM00052 EQU   EXSPACE+1                                                07726000
@NM00051 EQU   EXSPACE                                                  07727000
EXRWKDLN EQU   EXWRARG+32                                               07728000
@NM00050 EQU   EXWRARG+31                                               07729000
EXRECNUM EQU   EXRWCHR+4                                                07730000
EXHH     EQU   EXRWCHR+2                                                07731000
EXCC     EQU   EXRWCHR                                                  07732000
EXCCWCNT EQU   EXWRARG+24                                               07733000
EXLOCPTR EQU   EXWRARG+20                                               07734000
EXRWDARE EQU   EXWRARG+16                                               07735000
EXRWIOAR EQU   EXWRARG+12                                               07736000
EXRWCTBL EQU   EXWRARG+8                                                07737000
EXRWRES  EQU   EXWRARG                                                  07738000
EXGDATAL EQU   EXGARG+30                                                07739000
@NM00049 EQU   EXGARG+29                                                07740000
EXGKEYLN EQU   EXGARG+28                                                07741000
EXGDATAP EQU   EXGARG+24                                                07742000
EXGRECNO EQU   EXGARG+20                                                07743000
EXGCCHH2 EQU   EXGARG+16                                                07744000
EXGCCHH1 EQU   EXGARG+12                                                07745000
EXGCTLBK EQU   EXGARG+8                                                 07746000
EXGHEAD  EQU   EXGARG                                                   07747000
EXOVTH   EQU   EXFLG                                                    07748000
EXORVT   EQU   EXFLG                                                    07749000
EXORDS   EQU   EXFLG                                                    07750000
EXOSPK   EQU   EXFLG                                                    07751000
EXORVS   EQU   EXFLG                                                    07752000
@NM00048 EQU   EXFLG                                                    07753000
EXOREAD  EQU   EXFLG                                                    07754000
@NM00047 EQU   EXOPT                                                    07755000
EXOREP   EQU   EXOPT                                                    07756000
EXOVTOC  EQU   EXOPT                                                    07757000
EXONEW   EQU   EXOPT                                                    07758000
EXOPASS  EQU   EXOPT                                                    07759000
EXOLAB   EQU   EXOPT                                                    07760000
EXOTAB   EQU   EXOPT                                                    07761000
EXOCTLBK EQU   EXOARG+28                                                07762000
EXOUCB   EQU   EXOARG+20                                                07763000
EXOVSN   EQU   EXOARG+16                                                07764000
EXODSN   EQU   EXOARG+12                                                07765000
EXODDN   EQU   EXOARG+8                                                 07766000
EXOHEAD  EQU   EXOARG                                                   07767000
@NM00046 EQU   EXCLFLAG                                                 07768000
EXCLMNT  EQU   EXCLFLAG                                                 07769000
EXCLVOL  EQU   EXCLAGL+16                                               07770000
EXCLDDP  EQU   EXCLAGL+12                                               07771000
EXCLUCBP EQU   EXCLAGL+8                                                07772000
EXCLHEAD EQU   EXCLAGL                                                  07773000
@NM00045 EQU   CKFLAGS                                                  07774000
CKDMTABL EQU   CKFLAGS                                                  07775000
CKRETTYP EQU   CKFLAGS                                                  07776000
CKTESTVT EQU   CKFLAGS                                                  07777000
CKLABELP EQU   CKAGL+24                                                 07778000
CKDATYPE EQU   CKAGL+20                                                 07779000
CKDDNAME EQU   CKAGL+12                                                 07780000
CKUCBPTR EQU   CKAGL+8                                                  07781000
CKHEAD   EQU   CKAGL                                                    07782000
PULABELP EQU   PUAGL+16                                                 07783000
PUTTRPTR EQU   PUAGL+12                                                 07784000
PUUCBPTR EQU   PUAGL+8                                                  07785000
PUHEAD   EQU   PUAGL                                                    07786000
MDR      EQU   MDVTOC+4                                                 07787000
MDHH     EQU   MDVTOC+2                                                 07788000
MDCC     EQU   MDVTOC                                                   07789000
@NM00044 EQU   MDAGL+31                                                 07790000
MDVTOCTR EQU   MDFLAGS                                                  07791000
MDFORCE  EQU   MDFLAGS                                                  07792000
MDDEQ    EQU   MDFLAGS                                                  07793000
MDENQ    EQU   MDFLAGS                                                  07794000
MDWAIT   EQU   MDFLAGS                                                  07795000
MDPOST   EQU   MDFLAGS                                                  07796000
MDCLEAR  EQU   MDFLAGS                                                  07797000
MDNEWVOL EQU   MDFLAGS                                                  07798000
MDLABEL  EQU   MDAGL+24                                                 07799000
MDPUAGL  EQU   MDAGL+20                                                 07800000
MDDDNAME EQU   MDAGL+12                                                 07801000
MDUCBPTR EQU   MDAGL+8                                                  07802000
MDHEAD   EQU   MDAGL                                                    07803000
CTTBLRR  EQU   CTARRAY+3                                                07804000
CTTBLHH  EQU   CTARRAY+2                                                07805000
CTTBLCC  EQU   CTARRAY+1                                                07806000
CTTBLID  EQU   CTARRAY                                                  07807000
CTREALH  EQU   CTMSG+3                                                  07808000
CTREALCC EQU   CTMSG+1                                                  07809000
@NM00043 EQU   CTMSG                                                    07810000
CMCSN2   EQU   CMMSG+28                                                 07811000
CMCSN1   EQU   CMMSG+16                                                 07812000
CMNUMCRT EQU   CMMSG+15                                                 07813000
@NM00042 EQU   CMMSG+14                                                 07814000
CMNEWVOL EQU   CMMSG+8                                                  07815000
@NM00041 EQU   CMMSG+7                                                  07816000
@NM00040 EQU   CMVOLFLG                                                 07817000
CMRONLY  EQU   CMVOLFLG                                                 07818000
CMBIND   EQU   CMVOLFLG                                                 07819000
CMSCRCRT EQU   CMVOLFLG                                                 07820000
CMEXCL   EQU   CMVOLFLG                                                 07821000
CMDERAS  EQU   CMVOLFLG                                                 07822000
CMSCRVOL EQU   CMVOLFLG                                                 07823000
CMCECART EQU   CMVOLFLG                                                 07824000
CMOLDVOL EQU   CMMSG                                                    07825000
CCOLDCSN EQU   CCMSG+24                                                 07826000
CCNEWCSN EQU   CCMSG+12                                                 07827000
@NM00039 EQU   CCMSG+10                                                 07828000
CCVOL    EQU   CCMSG+4                                                  07829000
@NM00038 EQU   CCMSG+2                                                  07830000
CCEJCODE EQU   CCMSG+1                                                  07831000
CCPSTCDE EQU   CCMSG                                                    07832000
MODCHLEN EQU   MODCH                                                    07833000
MODVOLEN EQU   MODVO+20                                                 07834000
MODVOMEM EQU   MODVO+12                                                 07835000
MODVOMLN EQU   MODVO+11                                                 07836000
MODVOFUQ EQU   MODVOFLG                                                 07837000
MODVOPOS EQU   MODVO+9                                                  07838000
MODVOPAS EQU   MODVO+1                                                  07839000
MODVOPLN EQU   MODVO                                                    07840000
MORCHLEN EQU   MORCH                                                    07841000
MORVOLEN EQU   MORVO+20                                                 07842000
MORVOMEM EQU   MORVO+12                                                 07843000
MORVOMLN EQU   MORVO+11                                                 07844000
MORVOFUQ EQU   MORVOFLG                                                 07845000
MORVOPOS EQU   MORVO+9                                                  07846000
MORVOPAS EQU   MORVO+1                                                  07847000
MORVOPLN EQU   MORVO                                                    07848000
MRRHHLEN EQU   MRRHH                                                    07849000
MRRCHLEN EQU   MRRCH                                                    07850000
MRRVOLEN EQU   MRRVO+20                                                 07851000
MRRVOMEM EQU   MRRVO+12                                                 07852000
MRRVOMLN EQU   MRRVO+11                                                 07853000
MRRVOFUQ EQU   MRRVOFLG                                                 07854000
MRRVOPOS EQU   MRRVO+9                                                  07855000
MRRVOPAS EQU   MRRVO+1                                                  07856000
MRRVOPLN EQU   MRRVO                                                    07857000
MIDCHLEN EQU   MIDCH                                                    07858000
MIDVOLEN EQU   MIDVO+20                                                 07859000
MIDVOMEM EQU   MIDVO+12                                                 07860000
MIDVOMLN EQU   MIDVO+11                                                 07861000
MIDVOFUQ EQU   MIDVOFLG                                                 07862000
MIDVOPOS EQU   MIDVO+9                                                  07863000
MIDVOPAS EQU   MIDVO+1                                                  07864000
MIDVOPLN EQU   MIDVO                                                    07865000
MIRCHLEN EQU   MIRCH                                                    07866000
MIRVOLEN EQU   MIRVO+20                                                 07867000
MIRVOMEM EQU   MIRVO+12                                                 07868000
MIRVOMLN EQU   MIRVO+11                                                 07869000
MIRVOFUQ EQU   MIRVOFLG                                                 07870000
MIRVOPOS EQU   MIRVO+9                                                  07871000
MIRVOPAS EQU   MIRVO+1                                                  07872000
MIRVOPLN EQU   MIRVO                                                    07873000
MVTCRLEN EQU   MVTCR                                                    07874000
MVTCSLEN EQU   MVTCS+20                                                 07875000
MVTCSMEM EQU   MVTCS+12                                                 07876000
MVTCSMLN EQU   MVTCS+11                                                 07877000
MVTCSFUQ EQU   MVTCSFLG                                                 07878000
MVTCSPOS EQU   MVTCS+9                                                  07879000
MVTCSPAS EQU   MVTCS+1                                                  07880000
MVTCSPLN EQU   MVTCS                                                    07881000
MODSVAL  EQU   MODS+21                                                  07882000
MODSLEN  EQU   MODS+20                                                  07883000
MODSMEM  EQU   MODS+12                                                  07884000
MODSMLN  EQU   MODS+11                                                  07885000
MODSFUQ  EQU   MODSFLG                                                  07886000
MODSPOS  EQU   MODS+9                                                   07887000
MODSPAS  EQU   MODS+1                                                   07888000
MODSPLN  EQU   MODS                                                     07889000
MOUTFVAL EQU   MOUTF+10                                                 07890000
MOUTFLEN EQU   MOUTF+9                                                  07891000
MOUTFPAS EQU   MOUTF+1                                                  07892000
MOUTFPLN EQU   MOUTF                                                    07893000
MINDSVAL EQU   MINDS+21                                                 07894000
MINDSLEN EQU   MINDS+20                                                 07895000
MINDSMEM EQU   MINDS+12                                                 07896000
MINDSMLN EQU   MINDS+11                                                 07897000
MINDSFUQ EQU   MINDSFLG                                                 07898000
MINDSPOS EQU   MINDS+9                                                  07899000
MINDSPAS EQU   MINDS+1                                                  07900000
MINDSPLN EQU   MINDS                                                    07901000
MINFLVAL EQU   MINFL+10                                                 07902000
MINFLLEN EQU   MINFL+9                                                  07903000
MINFLPAS EQU   MINFL+1                                                  07904000
MINFLPLN EQU   MINFL                                                    07905000
DBDATVAL EQU   DBDAT                                                    07906000
DBKEYVAL EQU   DBKEY                                                    07907000
DBHHHVAL EQU   DBHHH+1                                                  07908000
DBHHHLEN EQU   DBHHH                                                    07909000
DBCCHVAL EQU   DBCCH+1                                                  07910000
DBCCHLEN EQU   DBCCH                                                    07911000
DBVOLVAL EQU   DBVOL+21                                                 07912000
DBVOLLEN EQU   DBVOL+20                                                 07913000
DBVOLMEM EQU   DBVOL+12                                                 07914000
DBVOLMLN EQU   DBVOL+11                                                 07915000
DBVOLFUQ EQU   DBVOLFLG                                                 07916000
DBVOLPOS EQU   DBVOL+9                                                  07917000
DBVOLPAS EQU   DBVOL+1                                                  07918000
DBVOLPLN EQU   DBVOL                                                    07919000
DBDSVAL  EQU   DBDS+21                                                  07920000
DBDSLEN  EQU   DBDS+20                                                  07921000
DBDSMEM  EQU   DBDS+12                                                  07922000
DBDSMLN  EQU   DBDS+11                                                  07923000
DBDSFUQ  EQU   DBDSFLG                                                  07924000
DBDSPOS  EQU   DBDS+9                                                   07925000
DBDSPAS  EQU   DBDS+1                                                   07926000
DBDSPLN  EQU   DBDS                                                     07927000
DBFILVAL EQU   DBFIL+10                                                 07928000
DBFILLEN EQU   DBFIL+9                                                  07929000
DBFILPAS EQU   DBFIL+1                                                  07930000
DBFILPLN EQU   DBFIL                                                    07931000
CVTCSVAL EQU   CVTCS+21                                                 07932000
CVTCSLEN EQU   CVTCS+20                                                 07933000
CVTCSMEM EQU   CVTCS+12                                                 07934000
CVTCSMLN EQU   CVTCS+11                                                 07935000
CVTCSFUQ EQU   CVTCSFLG                                                 07936000
CVTCSPOS EQU   CVTCS+9                                                  07937000
CVTCSPAS EQU   CVTCS+1                                                  07938000
CVTCSPLN EQU   CVTCS                                                    07939000
CDATLVAL EQU   CDATL                                                    07940000
CKEYLVAL EQU   CKEYL                                                    07941000
CRECRVAL EQU   CRECR+1                                                  07942000
CRECRLEN EQU   CRECR                                                    07943000
CCCHRVAL EQU   CCCHR+1                                                  07944000
CCCHRLEN EQU   CCCHR                                                    07945000
CVOLSVAL EQU   CVOLS+21                                                 07946000
CVOLSLEN EQU   CVOLS+20                                                 07947000
CVOLSMEM EQU   CVOLS+12                                                 07948000
CVOLSMLN EQU   CVOLS+11                                                 07949000
CVOLSFUQ EQU   CVOLSFLG                                                 07950000
CVOLSPOS EQU   CVOLS+9                                                  07951000
CVOLSPAS EQU   CVOLS+1                                                  07952000
CVOLSPLN EQU   CVOLS                                                    07953000
CDHHRVAL EQU   CDHHR+1                                                  07954000
CDHHRLEN EQU   CDHHR                                                    07955000
CDCHRVAL EQU   CDCHR+1                                                  07956000
CDCHRLEN EQU   CDCHR                                                    07957000
CVOLDVAL EQU   CVOLD+21                                                 07958000
CVOLDLEN EQU   CVOLD+20                                                 07959000
CVOLDMEM EQU   CVOLD+12                                                 07960000
CVOLDMLN EQU   CVOLD+11                                                 07961000
CVOLDFUQ EQU   CVOLDFLG                                                 07962000
CVOLDPOS EQU   CVOLD+9                                                  07963000
CVOLDPAS EQU   CVOLD+1                                                  07964000
CVOLDPLN EQU   CVOLD                                                    07965000
CCATLVAL EQU   CCATL+21                                                 07966000
CCATLLEN EQU   CCATL+20                                                 07967000
CCATLMEM EQU   CCATL+12                                                 07968000
CCATLMLN EQU   CCATL+11                                                 07969000
CCATLFUQ EQU   CCATLFLG                                                 07970000
CCATLPOS EQU   CCATL+9                                                  07971000
CCATLPAS EQU   CCATL+1                                                  07972000
CCATLPLN EQU   CCATL                                                    07973000
COFILVAL EQU   COFIL+10                                                 07974000
COFILLEN EQU   COFIL+9                                                  07975000
COFILPAS EQU   COFIL+1                                                  07976000
COFILPLN EQU   COFIL                                                    07977000
CINDSVAL EQU   CINDS+21                                                 07978000
CINDSLEN EQU   CINDS+20                                                 07979000
CINDSMEM EQU   CINDS+12                                                 07980000
CINDSMLN EQU   CINDS+11                                                 07981000
CINDSFUQ EQU   CINDSFLG                                                 07982000
CINDSPOS EQU   CINDS+9                                                  07983000
CINDSPAS EQU   CINDS+1                                                  07984000
CINDSPLN EQU   CINDS                                                    07985000
CINFLVAL EQU   CINFL+10                                                 07986000
CINFLLEN EQU   CINFL+9                                                  07987000
CINFLPAS EQU   CINFL+1                                                  07988000
CINFLPLN EQU   CINFL                                                    07989000
DVTCSVAL EQU   DVTCS+21                                                 07990000
DVTCSLEN EQU   DVTCS+20                                                 07991000
DVTCSMEM EQU   DVTCS+12                                                 07992000
DVTCSMLN EQU   DVTCS+11                                                 07993000
DVTCSFUQ EQU   DVTCSFLG                                                 07994000
DVTCSPOS EQU   DVTCS+9                                                  07995000
DVTCSPAS EQU   DVTCS+1                                                  07996000
DVTCSPLN EQU   DVTCS                                                    07997000
DATALVAL EQU   DATAL                                                    07998000
DKEYLVAL EQU   DKEYL                                                    07999000
RRCHHVAL EQU   RRCHH+1                                                  08000000
RRCHHLEN EQU   RRCHH                                                    08001000
RRCHRVAL EQU   RRCHR+1                                                  08002000
RRCHRLEN EQU   RRCHR                                                    08003000
VOLRRVAL EQU   VOLRR+21                                                 08004000
VOLRRLEN EQU   VOLRR+20                                                 08005000
VOLRRMEM EQU   VOLRR+12                                                 08006000
VOLRRMLN EQU   VOLRR+11                                                 08007000
VOLRRFUQ EQU   VOLRRFLG                                                 08008000
VOLRRPOS EQU   VOLRR+9                                                  08009000
VOLRRPAS EQU   VOLRR+1                                                  08010000
VOLRRPLN EQU   VOLRR                                                    08011000
DSCHHVAL EQU   DSCHH+1                                                  08012000
DSCHHLEN EQU   DSCHH                                                    08013000
DSCHRVAL EQU   DSCHR+1                                                  08014000
DSCHRLEN EQU   DSCHR                                                    08015000
VOLDSVAL EQU   VOLDS+21                                                 08016000
VOLDSLEN EQU   VOLDS+20                                                 08017000
VOLDSMEM EQU   VOLDS+12                                                 08018000
VOLDSMLN EQU   VOLDS+11                                                 08019000
VOLDSFUQ EQU   VOLDSFLG                                                 08020000
VOLDSPOS EQU   VOLDS+9                                                  08021000
VOLDSPAS EQU   VOLDS+1                                                  08022000
VOLDSPLN EQU   VOLDS                                                    08023000
DRECVAL  EQU   DREC+1                                                   08024000
DRECLEN  EQU   DREC                                                     08025000
DCCHRVAL EQU   DCCHR+1                                                  08026000
DCCHRLEN EQU   DCCHR                                                    08027000
VOLSRVAL EQU   VOLSR+21                                                 08028000
VOLSRLEN EQU   VOLSR+20                                                 08029000
VOLSRMEM EQU   VOLSR+12                                                 08030000
VOLSRMLN EQU   VOLSR+11                                                 08031000
VOLSRFUQ EQU   VOLSRFLG                                                 08032000
VOLSRPOS EQU   VOLSR+9                                                  08033000
VOLSRPAS EQU   VOLSR+1                                                  08034000
VOLSRPLN EQU   VOLSR                                                    08035000
DOTDSVAL EQU   DOTDS+21                                                 08036000
DOTDSLEN EQU   DOTDS+20                                                 08037000
DOTDSMEM EQU   DOTDS+12                                                 08038000
DOTDSMLN EQU   DOTDS+11                                                 08039000
DOTDSFUQ EQU   DOTDSFLG                                                 08040000
DOTDSPOS EQU   DOTDS+9                                                  08041000
DOTDSPAS EQU   DOTDS+1                                                  08042000
DOTDSPLN EQU   DOTDS                                                    08043000
DOUTFVAL EQU   DOUTF+10                                                 08044000
DOUTFLEN EQU   DOUTF+9                                                  08045000
DOUTFPAS EQU   DOUTF+1                                                  08046000
DOUTFPLN EQU   DOUTF                                                    08047000
INDSVAL  EQU   INDS+21                                                  08048000
INDSLEN  EQU   INDS+20                                                  08049000
INDSMEM  EQU   INDS+12                                                  08050000
INDSMLN  EQU   INDS+11                                                  08051000
INDSFUQ  EQU   INDSFLG                                                  08052000
INDSPOS  EQU   INDS+9                                                   08053000
INDSPAS  EQU   INDS+1                                                   08054000
INDSPLN  EQU   INDS                                                     08055000
INFILVAL EQU   INFIL+10                                                 08056000
INFILLEN EQU   INFIL+9                                                  08057000
INFILPAS EQU   INFIL+1                                                  08058000
INFILPLN EQU   INFIL                                                    08059000
@NM00037 EQU   DMPARY+15                                                08060000
DMPARYTP EQU   DMPARY+14                                                08061000
DMPARYEX EQU   DMPARY+12                                                08062000
DMPARYIC EQU   DMPARY+10                                                08063000
DMPARYSZ EQU   DMPARY+8                                                 08064000
DMPARYNM EQU   DMPARY                                                   08065000
@NM00036 EQU   DMPITM+15                                                08066000
DMPITMTP EQU   DMPITM+14                                                08067000
DMPITMLN EQU   DMPITM+12                                                08068000
DMPITMPT EQU   DMPITM+8                                                 08069000
DMPITMNM EQU   DMPITM                                                   08070000
@NM00035 EQU   ERCNVTAB+24                                              08071000
ERCPLPT  EQU   ERCNVTAB+20                                              08072000
ERCATRC  EQU   ERCNVTAB+16                                              08073000
ERDSNM   EQU   ERCNVTAB+12                                              08074000
@NM00034 EQU   ERCNVTAB+4                                               08075000
@NM00033 EQU   ERCNVTAB+3                                               08076000
@NM00032 EQU   EROSOPER                                                 08077000
EROSUCDX EQU   EROSOPER                                                 08078000
EROSCATL EQU   EROSOPER                                                 08079000
@NM00031 EQU   EROPER                                                   08080000
ERCATAL  EQU   EROPER                                                   08081000
ERCATDL  EQU   EROPER                                                   08082000
ERCATDE  EQU   EROPER                                                   08083000
ERCATLC  EQU   EROPER                                                   08084000
@NM00030 EQU   ERTYPE                                                   08085000
EROSCAT  EQU   ERTYPE                                                   08086000
ERCATLG  EQU   ERTYPE                                                   08087000
@NM00029 EQU   FMTCNVF+1                                                08088000
FMTAR    EQU   FMTCNVF+1                                                08089000
FMTBS    EQU   FMTCNVF+1                                                08090000
FMTSS    EQU   FMTCNVF+1                                                08091000
FMTAL    EQU   FMTCNVF+1                                                08092000
FMTZS    EQU   FMTCNVF+1                                                08093000
@NM00028 EQU   FMTCNVF                                                  08094000
FMTPU    EQU   FMTCNVF                                                  08095000
FMTBD    EQU   FMTCNVF                                                  08096000
FMTBHD   EQU   FMTCNVF                                                  08097000
FMTBHA   EQU   FMTCNVF                                                  08098000
FMTBH    EQU   FMTCNVF                                                  08099000
FMTOLEN  EQU   FMTLIST+8                                                08100000
FMTRIO   EQU   FMTOCOL                                                  08101000
FMTSPT   EQU   FMTSTO                                                   08102000
FMTSTL   EQU   FMTILEN                                                  08103000
@NM00027 EQU   FMTFLGS+1                                                08104000
FMTHDF   EQU   FMTFLGS                                                  08105000
FMTDFF   EQU   FMTFLGS                                                  08106000
FMTSTF   EQU   FMTFLGS                                                  08107000
FMTREPF  EQU   FMTFLGS                                                  08108000
FMTBDF   EQU   FMTFLGS                                                  08109000
FMTIDF   EQU   FMTFLGS                                                  08110000
FMTSCF   EQU   FMTFLGS                                                  08111000
FMTEOLF  EQU   FMTFLGS                                                  08112000
DARGDTM  EQU   DARGARY+4                                                08113000
DARGPCT  EQU   DARGINL                                                  08114000
DARGREP  EQU   DARGINS                                                  08115000
@NM00026 EQU   DARGLIST+19                                              08116000
DARGIND  EQU   DARGLIST+18                                              08117000
DARGRETL EQU   DARGLIST+16                                              08118000
DARGCNT  EQU   DARGLIST+14                                              08119000
DARGILP  EQU   DARGLIST+12                                              08120000
DARGSENT EQU   DARGSTID+3                                               08121000
DARGSMOD EQU   DARGSTID                                                 08122000
DARGRETP EQU   DARGLIST+4                                               08123000
DARGDBP  EQU   DARGLIST                                                 08124000
UVOLVOL  EQU   UVOLENT+4                                                08125000
UVOLDEV  EQU   UVOLENT                                                  08126000
UVOLCNT  EQU   UVOLLIST                                                 08127000
@NM00025 EQU   IOINFOPT                                                 08128000
IOINFTMS EQU   IOINFOPT                                                 08129000
IOINFSUP EQU   IOINFOPT                                                 08130000
IOINFDSN EQU   IOINFOPT                                                 08131000
IOINFVOL EQU   IOINFOPT                                                 08132000
IOINFDVT EQU   IOINFOPT                                                 08133000
OPNVOL   EQU   OPNAGL+44                                                08134000
@NM00024 EQU   OPNAGL+43                                                08135000
@NM00023 EQU   OPNOPT2                                                  08136000
OPNOPTJM EQU   OPNOPT2                                                  08137000
@NM00022 EQU   OPNOPT2                                                  08138000
OPNOPTAS EQU   OPNOPT2                                                  08139000
@NM00021 EQU   OPNDSO                                                   08140000
OPNDSOPO EQU   OPNDSO                                                   08141000
OPNDSOIS EQU   OPNDSO                                                   08142000
OPNDSOPS EQU   OPNDSO                                                   08143000
OPNDSOAM EQU   OPNDSO                                                   08144000
OPNKYL   EQU   OPNAGL+40                                                08145000
OPNBLK   EQU   OPNAGL+36                                                08146000
OPNREC   EQU   OPNAGL+32                                                08147000
OPNDEVIX EQU   OPNDEV+4                                                 08148000
OPNDEVDT EQU   OPNDEV                                                   08149000
OPNCBP   EQU   OPNAGL+20                                                08150000
OPNDSN   EQU   OPNAGL+16                                                08151000
OPNPWA   EQU   OPNAGL+12                                                08152000
OPNDDN   EQU   OPNAGL+8                                                 08153000
OPNIOC   EQU   OPNAGL+4                                                 08154000
OPNMODRP EQU   OPNMOD                                                   08155000
OPNMODUB EQU   OPNMOD                                                   08156000
OPNMODRS EQU   OPNMOD                                                   08157000
OPNMODAX EQU   OPNMOD                                                   08158000
OPNMODRR EQU   OPNMOD                                                   08159000
OPNMODRC EQU   OPNMOD                                                   08160000
OPNMODAC EQU   OPNMOD                                                   08161000
OPNMODPD EQU   OPNMOD                                                   08162000
@NM00020 EQU   OPNTYP                                                   08163000
OPNTYPRV EQU   OPNTYP                                                   08164000
OPNTYPEX EQU   OPNTYP                                                   08165000
OPNTYPRA EQU   OPNTYP                                                   08166000
OPNTYPXM EQU   OPNTYP                                                   08167000
OPNTYPCI EQU   OPNTYP                                                   08168000
OPNTYPSO EQU   OPNTYP                                                   08169000
OPNTYPSI EQU   OPNTYP                                                   08170000
@NM00019 EQU   OPNRFM                                                   08171000
OPNRFMBK EQU   OPNRFM                                                   08172000
OPNRFMSF EQU   OPNRFM                                                   08173000
OPNRFMUN EQU   OPNRFM                                                   08174000
OPNRFMVR EQU   OPNRFM                                                   08175000
OPNRFMFX EQU   OPNRFM                                                   08176000
OPNOPTSK EQU   OPNOPT                                                   08177000
OPNOPTDR EQU   OPNOPT                                                   08178000
OPNOPTCR EQU   OPNOPT                                                   08179000
OPNOPTKS EQU   OPNOPT                                                   08180000
OPNOPTBK EQU   OPNOPT                                                   08181000
OPNOPTUP EQU   OPNOPT                                                   08182000
OPNOPTOT EQU   OPNOPT                                                   08183000
OPNOPTIN EQU   OPNOPT                                                   08184000
IOCEXT   EQU   IOCSTR+64                                                08185000
IOCREL   EQU   IOCSTR+60                                                08186000
IOCWORK  EQU   IOCSTR+56                                                08187000
IOCRRN   EQU   IOCSTR+52                                                08188000
IOCPNM   EQU   IOCNWM+2                                                 08189000
IOCPTL   EQU   IOCNWM                                                   08190000
IOCKYA   EQU   IOCMEM                                                   08191000
IOCVRC   EQU   IOCTTR                                                   08192000
IOCCBP   EQU   IOCSTR+36                                                08193000
IOCHURBA EQU   IOCSTR+28                                                08194000
IOCVOLSR EQU   IOCSTR+22                                                08195000
@NM00018 EQU   IOCMSG                                                   08196000
IOCMSGAE EQU   IOCMSG                                                   08197000
IOCMSGCE EQU   IOCMSG                                                   08198000
IOCMSGOE EQU   IOCMSG                                                   08199000
IOCMSGOP EQU   IOCMSG                                                   08200000
@NM00017 EQU   IOCMSG                                                   08201000
IOCCHPSY EQU   IOCCHP                                                   08202000
IOCCHPAS EQU   IOCCHP                                                   08203000
IOCCHPBK EQU   IOCCHP                                                   08204000
IOCCHPCR EQU   IOCCHP                                                   08205000
IOCCHPKS EQU   IOCCHP                                                   08206000
IOCCHPSK EQU   IOCCHP                                                   08207000
IOCCHPDR EQU   IOCCHP                                                   08208000
IOCCHPSQ EQU   IOCCHP                                                   08209000
@NM00016 EQU   IOCMAC2                                                  08210000
IOCMACPA EQU   IOCMAC2                                                  08211000
@NM00015 EQU   IOCMAC2                                                  08212000
IOCMACCP EQU   IOCMAC2                                                  08213000
IOCMACRR EQU   IOCMAC2                                                  08214000
IOCMACAS EQU   IOCMAC2                                                  08215000
IOCMACSK EQU   IOCMAC2                                                  08216000
@NM00014 EQU   IOCMAC                                                   08217000
IOCMACCC EQU   IOCMAC                                                   08218000
IOCMACDR EQU   IOCMAC                                                   08219000
IOCMACBK EQU   IOCMAC                                                   08220000
IOCMACCR EQU   IOCMAC                                                   08221000
IOCMACUP EQU   IOCMAC                                                   08222000
IOCMACOT EQU   IOCMAC                                                   08223000
IOCMACIN EQU   IOCMAC                                                   08224000
@NM00013 EQU   IOCRFM                                                   08225000
IOCRFMBK EQU   IOCRFM                                                   08226000
IOCRFMSF EQU   IOCRFM                                                   08227000
IOCRFMUN EQU   IOCRFM                                                   08228000
IOCRFMVR EQU   IOCRFM                                                   08229000
IOCRFMFX EQU   IOCRFM                                                   08230000
@NM00012 EQU   IOCDSO                                                   08231000
IOCDSOPO EQU   IOCDSO                                                   08232000
IOCDSOIS EQU   IOCDSO                                                   08233000
IOCDSOPS EQU   IOCDSO                                                   08234000
IOCDSOAM EQU   IOCDSO                                                   08235000
IOCRKP   EQU   IOCSTR+13                                                08236000
IOCKYL   EQU   IOCSTR+12                                                08237000
IOCDLN   EQU   IOCSTR+4                                                 08238000
IOCDAD   EQU   IOCSTR                                                   08239000
UNITVTOC EQU   UNITABL+7                                                08240000
@NM00011 EQU   UNITSTAT                                                 08241000
UNITUSHR EQU   UNITSTAT                                                 08242000
UNITXSHR EQU   UNITSTAT                                                 08243000
UNITISHR EQU   UNITSTAT                                                 08244000
UNITUA   EQU   @NM00010+1                                               08245000
UNITCHA  EQU   @NM00010                                                 08246000
UNITUCB  EQU   UNITABL                                                  08247000
ALLUNCNT EQU   ALLAGL+30                                                08248000
ALLVLCNT EQU   ALLAGL+29                                                08249000
@NM00009 EQU   ALLOPT                                                   08250000
ALLOPTUN EQU   ALLOPT                                                   08251000
ALLOPTPV EQU   ALLOPT                                                   08252000
ALLOPTDS EQU   ALLOPT                                                   08253000
ALLOPTVL EQU   ALLOPT                                                   08254000
@NM00008 EQU   ALLORG+1                                                 08255000
ALLORGVS EQU   ALLORG+1                                                 08256000
@NM00007 EQU   ALLORG+1                                                 08257000
ALLORGGS EQU   ALLORG+1                                                 08258000
ALLORGUN EQU   ALLORG                                                   08259000
ALLORGPO EQU   ALLORG                                                   08260000
ALLORGMQ EQU   ALLORG                                                   08261000
ALLORGCQ EQU   ALLORG                                                   08262000
ALLORGCX EQU   ALLORG                                                   08263000
ALLORGDA EQU   ALLORG                                                   08264000
ALLORGPS EQU   ALLORG                                                   08265000
ALLORGIS EQU   ALLORG                                                   08266000
ALLDSPUN EQU   ALLDSP                                                   08267000
ALLDSPCG EQU   ALLDSP                                                   08268000
ALLDSPDE EQU   ALLDSP                                                   08269000
ALLDSPKP EQU   ALLDSP                                                   08270000
@NM00006 EQU   ALLDSP                                                   08271000
ALLSTSOD EQU   ALLSTS                                                   08272000
ALLSTSMD EQU   ALLSTS                                                   08273000
ALLSTSNW EQU   ALLSTS                                                   08274000
ALLSTSSR EQU   ALLSTS                                                   08275000
@NM00005 EQU   ALLSTS                                                   08276000
ALLPWD   EQU   ALLAGL+20                                                08277000
ALLVLP   EQU   ALLAGL+16                                                08278000
ALLULP   EQU   ALLAGL+12                                                08279000
ALLDDN   EQU   ALLAGL+4                                                 08280000
ALLDSN   EQU   ALLAGL                                                   08281000
CIRPID   EQU   CIRAGL+28                                                08282000
CIRPWD   EQU   CIRAGL+24                                                08283000
CIRCAT   EQU   CIRAGL+20                                                08284000
CIRWKP   EQU   CIRAGL+16                                                08285000
CIRTLR   EQU   CIRAGL+12                                                08286000
CIRHDR   EQU   CIRAGL+8                                                 08287000
CIRTLN   EQU   CIRAGL+6                                                 08288000
CIRHLN   EQU   CIRAGL+4                                                 08289000
@NM00004 EQU   CIRAGL+1                                                 08290000
@NM00003 EQU   CIRTYPE                                                  08291000
CIRTYPAQ EQU   CIRTYPE                                                  08292000
CIRTYP1Q EQU   CIRTYPE                                                  08293000
NEWID1   EQU   TRACE1+95                                                08294000
CALLID   EQU   OLDERID1+90                                              08295000
@NM00002 EQU   OLDERID1                                                 08296000
*                                      END UNREFERENCED COMPONENTS      08297000
@PB00002 EQU   @EL00001                                                 08298000
@ENDDATA EQU   *                                                        08299000
         END   IDCRD05,(C'PLS2120',0603,76328)                          08300000
