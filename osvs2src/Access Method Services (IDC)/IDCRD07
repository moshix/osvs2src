         TITLE 'IDCRD07:IDCAMS REPAIRV SERVICE MODULE                  *00001000
                        '                                               00002000
         MACRO                                                          00003000
         GETMAIN &R,&LV=                                                00004000
         L     REG15,0(REG1)           GDTTBL ADDRESS                   00005000
         L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS             00006000
         CNOP  2,4                     BOUNDARY ALIGNMENT               00007000
         LA    REG14,*+14              RETURN ADDRESS                   00008000
         BALR  REG1,REG15              LINKAGE TO PROL ROUTINE          00009000
         DC    A(MODID)                MODULE ID ADDRESS                00010000
         DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS   00011000
         MEND                                                           00012000
IDCRD07  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCRD07   77.300'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @06,0                                               0002 00021000
@PSTART  LA    @09,4095(,@06)                                      0002 00022000
         LA    @10,4095(,@09)                                      0002 00023000
         LA    @11,4095(,@10)                                      0002 00024000
         LA    @12,4095(,@11)                                      0002 00025000
         USING @PSTART,@06                                         0002 00026000
         USING @PSTART+4095,@09                                    0002 00027000
         USING @PSTART+8190,@10                                    0002 00028000
         USING @PSTART+12285,@11                                   0002 00029000
         USING @PSTART+16380,@12                                   0002 00030000
         L     @00,@SIZDATD                                        0002 00031000
         GETMAIN  R,LV=(0)                                              00032000
         LR    @07,@01                                             0002 00033000
         USING @DATD,@07                                           0002 00034000
         ST    @13,@SA00001+4                                      0002 00035000
         LM    @00,@01,20(@13)                                     0002 00036000
         ST    @07,8(,@13)                                         0002 00037000
         LR    @13,@07                                             0002 00038000
         MVC   @PC00001(12),0(@01)                                 0002 00039000
*                                                                  0282 00040000
*   /*****************************************************************/ 00041000
*   /*                                                               */ 00042000
*   /* SET TRACE AND DUMP POINTS                                     */ 00043000
*   /*                                                               */ 00044000
*   /*****************************************************************/ 00045000
*                                                                  0283 00046000
*   IF GDTDBG=NULLPTR THEN                                         0283 00047000
         L     @15,@PC00001                                        0283 00048000
         L     @15,GDTDBG(,@15)                                    0283 00049000
         LTR   @15,@15                                             0283 00050000
         BZ    @RT00283                                            0283 00051000
*     ;                                                            0284 00052000
*   ELSE                                                           0285 00053000
*     CALL IDCDB010(GDTTBL,'RD71');                                0285 00054000
         L     @15,@PC00001                                        0285 00055000
         ST    @15,@AL00001                                        0285 00056000
         LA    @14,@CC01568                                        0285 00057000
         ST    @14,@AL00001+4                                      0285 00058000
         MVI   @AL00001+4,X'80'                                    0285 00059000
         L     @15,GDTDBG(,@15)                                    0285 00060000
         LA    @01,@AL00001                                        0285 00061000
         BALR  @14,@15                                             0285 00062000
*   OLDERID2=NEWERID2;                                             0286 00063000
@RT00283 L     @03,@PC00001                                        0286 00064000
         L     @03,GDTTR2(,@03)                                    0286 00065000
         MVC   @TS00001(95),NEWERID2(@03)                          0286 00066000
         MVC   OLDERID2(95,@03),@TS00001                           0286 00067000
*   NEWID2='RD72';                                                 0287 00068000
*                                                                  0287 00069000
         MVC   NEWID2(4,@03),@CC01569                              0287 00070000
*   /*****************************************************************/ 00071000
*   /*                                                               */ 00072000
*   /* INITIALIZE OPNAGL POINTER                                     */ 00073000
*   /*                                                               */ 00074000
*   /*****************************************************************/ 00075000
*                                                                  0288 00076000
*   OPNPTR=REPOPAGL;                                               0288 00077000
*                                                                  0288 00078000
         L     @15,@PC00001+8                                      0288 00079000
         L     OPNPTR,REPOPAGL(,@15)                               0288 00080000
*   /*****************************************************************/ 00081000
*   /*                                                               */ 00082000
*   /* INITIALIZE AUTOMATIC STORAGE VIA THE PROLOG AND RETURN TO THE */ 00083000
*   /* CALLER WITHOUT FREEING THE STORAGE                            */ 00084000
*   /*                                                               */ 00085000
*   /*****************************************************************/ 00086000
*                                                                  0289 00087000
*   GEN(ST REG6,SPLITSV1);                                         0289 00088000
         ST REG6,SPLITSV1                                               00089000
*   STM(REG9,REG12,SPLITSAV);                                      0290 00090000
         STM   REG9,REG12,SPLITSAV                                 0290 00091000
*   GEN(L REG13,4(,REG13));                                        0291 00092000
         L REG13,4(,REG13)                                              00093000
*   GEN(LM REG14,REG6,12(REG13));                                  0292 00094000
         LM REG14,REG6,12(REG13)                                        00095000
*   GEN(LM REG9,REG12,56(REG13));                                  0293 00096000
         LM REG9,REG12,56(REG13)                                        00097000
*   GEN(SR REG15,REG15);                                           0294 00098000
         SR REG15,REG15                                                 00099000
*   GEN(BR REG14);                                                 0295 00100000
         BR REG14                                                       00101000
         EJECT                                                          00102000
*IDCRDDS:                                                          0296 00103000
*   PROCEDURE(IOPARM,TOCHRVAL);                                    0296 00104000
*                                                                  0296 00105000
@EL00001 L     @13,4(,@13)                                         0296 00106000
@EF00001 L     @00,@SIZDATD                                        0296 00107000
         LR    @01,@07                                             0296 00108000
         FREEMAIN R,LV=(0),A=(1)                                        00109000
@ER00001 LM    @14,@12,12(@13)                                     0296 00110000
         BR    @14                                                 0296 00111000
IDCRDDS  STM   @14,@12,@SA00002                                    0296 00112000
         MVC   @PC00002(8),0(@01)                                  0296 00113000
*/********************************************************************/ 00114000
*/*                                                                  */ 00115000
*/*  PROCEDURE NAME - IDCRDDS                                        */ 00116000
*/*                                                                  */ 00117000
*/*  FUNCTION - THIS PROCEDURE IS CALLED BY MODULE IDCRD02,          */ 00118000
*/*             IDCRD03, IDCRD04, OR IDCRD05 TO:                     */ 00119000
*/*             1. OPEN A VTOCHEADER AND IN THE CASE OF A MODIFY     */ 00120000
*/*                REQUEST (IDCRD05 IS THE CALLING MODULE) RESERVE   */ 00121000
*/*                THE VTOC, OR OPEN A VTOC AND IN THE CASE OF A     */ 00122000
*/*                MODIFY REQUEST (IDCRD05 IS THE CALLING MODULE)    */ 00123000
*/*                RESERVE THE VTOC, OR OPEN A DATA SET, OR RESERVE  */ 00124000
*/*                AND OPEN THE STAGING PACK WHICH IS MOUNTED        */ 00125000
*/*                OFFLINE TO THE MSS.                               */ 00126000
*/*             2. CONSTRUCT AN EXTENT TABLE WHICH WILL CONTAIN:     */ 00127000
*/*                A. AN ENTRY FOR THE FIRST TRACK OF THE VTOC FOR   */ 00128000
*/*                   A VTOCHEADER, OR                               */ 00129000
*/*                B. AN ENTRY FOR THE EXTENT OF THE VTOC WITHIN     */ 00130000
*/*                   THE SPECIFIED DATASETRANGE, OR                 */ 00131000
*/*                C. AN ENTRY FOR EACH EXTENT OF A DATA SET         */ 00132000
*/*                   WITHIN THE SPECIFIED DATASETRANGE, OR          */ 00133000
*/*                D. AN ENTRY THAT INCLUDES THE ENTIRE STAGING      */ 00134000
*/*                   PACK                                           */ 00135000
*/*             3. OBTAIN INPUT/OUTPUT BUFFERS                       */ 00136000
*/*                                                                  */ 00137000
*/*  ENTRY POINT - IDCRDDS (ONLY ENTRY POINT FOR THIS PROCEDURE)     */ 00138000
*/*                                                                  */ 00139000
*/*            LINKAGE - 'CALL IDCRDDS (IOPARM,TOCHRVAL)'            */ 00140000
*/*                                                                  */ 00141000
*/*            INPUT -                                               */ 00142000
*/*                                                                  */ 00143000
*/*              GDTTBL (IDCAMS GLOBAL DATA TABLE)                   */ 00144000
*/*                THIS TABLE CONTAINS THE ADDRESS OF THE IDCAMS     */ 00145000
*/*                SYSTEM OPTIONS AND THE ENTRY POINTS TO THE        */ 00146000
*/*                SYSTEM AND I/O ADDRESSES.                         */ 00147000
*/*                                                                  */ 00148000
*/*              FDTTBL (IDCAMS FUNCTION DATA TABLE)                 */ 00149000
*/*                THIS TABLE CONTAINS THE ENCODED INFORMATION FROM  */ 00150000
*/*                THE IDCAMS COMMAND STATEMENTS                     */ 00151000
*/*                                                                  */ 00152000
*/*              REPTBL                                              */ 00153000
*/*                REPAIRV CONTROL BLOCK AND COMMUNICATION AREA      */ 00154000
*/*                                                                  */ 00155000
*/*              VTOC,                                               */ 00156000
*/*              VTOCHEADER,                                         */ 00157000
*/*              DATA SET, OR                                        */ 00158000
*/*              STAGING PACK OFFLINE TO THE MSS                     */ 00159000
*/*                                                                  */ 00160000
*/*            OUTPUT -                                              */ 00161000
*/*                                                                  */ 00162000
*/*                ERROR MESSAGES: IDC31203I TO IDC31212I            */ 00163000
*/*                                IDC31233I TO IDC31235I            */ 00164000
*/*                                IDC31239I TO IDC31240I            */ 00165000
*/*                                IDC3004I                          */ 00166000
*/*                                                                  */ 00167000
*/*                WTOR MESSAGE:   IDC498D                           */ 00168000
*/*                                                                  */ 00169000
*/*                UNIVERSAL TEXT MESSAGE: IDC3004I                  */ 00170000
*/*                                                                  */ 00171000
*/*                EXTENT TABLE (XTNTTBL) WHICH CONTAINS AN ENTRY    */ 00172000
*/*                FOR THE USER SUPPLIED INFORMATION VIA SYNTAX      */ 00173000
*/*                IN THE EXTENT TABLE HEADER, AND AN ENTRY FOR      */ 00174000
*/*                FOR EACH EXTENT OF THE VTOCHEADER, VTOC,          */ 00175000
*/*                DATA SET, OR STAGING PACK.                        */ 00176000
*/*                                                                  */ 00177000
*/*                FIELDS SET IN THE REPCB:                          */ 00178000
*/*                                                                  */ 00179000
*/*                     REPIDSOP = ADDRESS OF IOCTLBK FOR FIRST      */ 00180000
*/*                                EXTENT IF FOR INPUT REQUEST       */ 00181000
*/*                                                                  */ 00182000
*/*                     REPODSOP = ADDRESS OF IOCTLBK FOR FIRST      */ 00183000
*/*                                EXTENT IF FOR OUTPUT REQUEST      */ 00184000
*/*                                                                  */ 00185000
*/*                     REPIBFPT = ADDRESS OF BUFFER AREA OBTAINED   */ 00186000
*/*                                VIA THE UGPOOL MACRO IF FOR       */ 00187000
*/*                                INPUT REQUEST                     */ 00188000
*/*                                                                  */ 00189000
*/*                     REPOBFPT = ADDRESS OF BUFFER AREA OBTAINED   */ 00190000
*/*                                VIA THE UGPOOL MACRO IF FOR       */ 00191000
*/*                                OUTPUT REQUEST                    */ 00192000
*/*                                                                  */ 00193000
*/*                BUFFER AREA FOR INPUT/OUTPUT PROCESSING POINTED   */ 00194000
*/*                TO BY EITHER REPIBFPT IN THE REPCB FOR INPUT      */ 00195000
*/*                PROCESSING OR REPOBFPT IN THE REPCB FOR OUTPUT    */ 00196000
*/*                PROCESSING WITH THE FIRST BYTE OF THE BUFFER      */ 00197000
*/*                SET TO X'FF' TO INDICATE FIRST I/O REQUEST        */ 00198000
*/*                TO UEXCP.                                         */ 00199000
*/*                                                                  */ 00200000
*/*            EXIT NORMAL -                                         */ 00201000
*/*                                                                  */ 00202000
*/*              LASTCC = 00    FUNCTION COMPLETED NORMALLY          */ 00203000
*/*                                                                  */ 00204000
*/*            EXIT ERROR -                                          */ 00205000
*/*                                                                  */ 00206000
*/*              LASTCC = 12    FUNCTION DID NOT COMPLETE            */ 00207000
*/*                                                                  */ 00208000
*/* INTERNAL INTERFACES -                                            */ 00209000
*/*                                                                  */ 00210000
*/*      MACROS/SVCS                                                 */ 00211000
*/*                                                                  */ 00212000
*/*            NONE                                                  */ 00213000
*/*                                                                  */ 00214000
*/*      PROCEDURES/SUBROUTINES CALLED                               */ 00215000
*/*                                                                  */ 00216000
*/*            IDCRDIN - TO OBTAIN DATA SET NAME FOR THE SPECIFIED   */ 00217000
*/*                      DDNAME                                      */ 00218000
*/*                                                                  */ 00219000
*/*      DATA AREAS                                                  */ 00220000
*/*                                                                  */ 00221000
*/*            NONE                                                  */ 00222000
*/*                                                                  */ 00223000
*/*  EXTERNAL INTERFACES -                                           */ 00224000
*/*                                                                  */ 00225000
*/*       MACROS/SVCS                                                */ 00226000
*/*                                                                  */ 00227000
*/*             UDUMP - IDCAMS DUMP POINT ROUTINE                    */ 00228000
*/*               PRINTS A DUMP AT THE SPECIFIED DUMP POINT          */ 00229000
*/*               GENERATES A CALL TO MODULE IDCDB01                 */ 00230000
*/*                                                                  */ 00231000
*/*             UTRACE - IDCAMS TRACE POINT ROUTINE                  */ 00232000
*/*               SETS TRACE POINT                                   */ 00233000
*/*                                                                  */ 00234000
*/*             ?CALLCKER - REPAIRV MESSAGE WRITER                   */ 00235000
*/*               WRITES ALL MESSAGES                                */ 00236000
*/*               GENERATES A CALL TO MODULE IDCRDER                 */ 00237000
*/*                                                                  */ 00238000
*/*             UIOINFO - IDCAMS I/O ADAPTER INFORMATION ROUTINE     */ 00239000
*/*               RETURNS DSNAME AND VOLSER OF REQUESTED DDNAME      */ 00240000
*/*               GENERATES A CALL TO MODULE IDCIOSI                 */ 00241000
*/*                                                                  */ 00242000
*/*             DEVTYPE - OS/VS SYSTEM DEVICE CHARACTERISTICS MACRO  */ 00243000
*/*               OBTAINS DEVICE CHARACTERISTICS NOT RETURNED BY     */ 00244000
*/*               UIOINFO                                            */ 00245000
*/*                                                                  */ 00246000
*/*             WTOR - OS/VS SYSTEM WRITE TO OPERATOR WITH REPLY     */ 00247000
*/*                    MACRO                                         */ 00248000
*/*               PROMPTS OPERATOR FOR AUTHORIZATION TO ACCESS       */ 00249000
*/*               REQUESTED VOLUME OR VTOC                           */ 00250000
*/*                                                                  */ 00251000
*/*             UPRINT - IDCAMS TEXT PROCESSOR PRINT ROUTINE         */ 00252000
*/*               LOADS OPERATOR AUTHORIZATION PROMT MESSAGE         */ 00253000
*/*               IDC498D                                            */ 00254000
*/*               GENERATES A CALL TO MODULE AMSTP011                */ 00255000
*/*                                                                  */ 00256000
*/*             USYSINFO - IDCAMS SYSTEM ADAPTER I/O UNITS           */ 00257000
*/*                        INFORMATION ROUTINE                       */ 00258000
*/*               USED TO OBTAIN THE UCB ADDRESS                     */ 00259000
*/*               GENERATES A CALL TO MODULE IDCSASIO                */ 00260000
*/*                                                                  */ 00261000
*/*             URESERVE - IDCAMS SYSTEM ADAPTER RESERVE ROUTINE     */ 00262000
*/*               USED TO RESERVE THE VTOC FOR A MODIFY REQUEST OR   */ 00263000
*/*               TO RESERVE THE STAGING PACK OFFLINE TO THE MSS     */ 00264000
*/*               GENERATES A CALL TO MODULE IDCSARV                 */ 00265000
*/*                                                                  */ 00266000
*/*             UDEQ - IDCAMS SYSTEM ADAPTER DEQ ROUTINE             */ 00267000
*/*               USED TO DEQ THE VTOC FOR A MODIFY REQUEST OR       */ 00268000
*/*               TO DEQ THE STAGING PACK OFFLINE TO THE MSS         */ 00269000
*/*               GENERATES A CALL TO MODULE IDCSADQ                 */ 00270000
*/*                                                                  */ 00271000
*/*             UEXCP - IDCAMS I/O ADAPTER EXCP ROUTINE              */ 00272000
*/*               OPENS AND CLOSES DATA SETS OR STAGING PACKS        */ 00273000
*/*               GENERATES A CALL TO MODULE IDCIO05                 */ 00274000
*/*                                                                  */ 00275000
*/*             UGPOOL - IDCAMS SYSTEM ADAPTER GET POOL ROUTINE      */ 00276000
*/*               ACQUIRES DYNAMIC STORAGE FOR CHANNEL PROGRAMS      */ 00277000
*/*               AND I/O BUFFERS                                    */ 00278000
*/*               GENERATES A CALL TO MODULE IDCSAGP                 */ 00279000
*/*                                                                  */ 00280000
*/*             UFPOOL - IDCAMS SYSTEM ADAPTER FREE POOL ROUTINE     */ 00281000
*/*               RELEASES DYNAMIC STORAGE ACQUIRED FOR CHANNEL      */ 00282000
*/*               PROGRAMS AND I/O BUFFERS                           */ 00283000
*/*               GENERATES A CALL TO MODULE IDCSAFP                 */ 00284000
*/*                                                                  */ 00285000
*/*             UALLOC - IDCAMS SYSTEM ADAPTER ALLOCATION ROUTINE    */ 00286000
*/*               USED TO OBTAIN DDNAME WHEN DSNAME IS SUPPLIED AND  */ 00287000
*/*               TO DYNAMICALLY ALLOCATE DATA SET (OS/VS2 ONLY)     */ 00288000
*/*               GENERATES A CALL TO MODULE IDCSAAL                 */ 00289000
*/*                                                                  */ 00290000
*/*             UOPEN - IDCAMS I/O ADAPTER OPEN ROUTINE              */ 00291000
*/*               USED TO OPEN A OPENABLE DATA SET TO EXTRACT        */ 00292000
*/*               THE DATA SET EXTENTS FROM THE DEB IN ORDER TO      */ 00293000
*/*               CONSTRUCT THE EXTENT TABLE (XTNTTBL)               */ 00294000
*/*               GENERATES A CALL TO MODULE IDCIOOP                 */ 00295000
*/*                                                                  */ 00296000
*/*             UGET - IDCAMS I/O ADAPTER GET ROUTINE                */ 00297000
*/*               USED TO GET FIRST RECORD IN THE VTOC, THE          */ 00298000
*/*               FORMAT4 DSCB TO DETERMINE EXTENTS OF THE VTOC      */ 00299000
*/*               GENERATES A CALL TO MODULE IDCIOGT                 */ 00300000
*/*                                                                  */ 00301000
*/*             UCLOSE - IDCAMS I/O ADAPTER CLOSE ROUTINE            */ 00302000
*/*               CLOSES THE OPENABLE DATA SET AFTER THE DATA SET    */ 00303000
*/*               EXTENTS HAVE BEEN EXTRACTED FROM THE DEB           */ 00304000
*/*               GENERATES A CALL TO MODULE IDCIOCL                 */ 00305000
*/*                                                                  */ 00306000
*/*             OBTAIN - OS/VS SYSTEM OBTAIN FORMAT1 DSCB MACRO      */ 00307000
*/*               USED TO READ FORMAT1 DSCB TO DETERMINE DATA SET    */ 00308000
*/*               TYPE (VSAM OR NON-VSAM)                            */ 00309000
*/*                                                                  */ 00310000
*/*       PROCEDURES/SUBROUTINES CALLED                              */ 00311000
*/*                                                                  */ 00312000
*/*            NONE                                                  */ 00313000
*/*                                                                  */ 00314000
*/*       DATA AREAS -                                               */ 00315000
*/*                                                                  */ 00316000
*/*            XTNTTBL - REPAIRV EXTENT TABLE                        */ 00317000
*/*              CONTAINS EACH EXTENT WITHIN THE REQUESTED RANGE     */ 00318000
*/*                                                                  */ 00319000
*/*            DEVAREA - DEVTYPE SVC RETURN AREA                     */ 00320000
*/*              COMMUNICATES THE CHARACTERISTICS OF THE I/O DEVICE  */ 00321000
*/*                                                                  */ 00322000
*/*            INFOAREA - UIOINFO ROUTINE RETURN AREA                */ 00323000
*/*              COMMUNICATES THE DATA SET NAME AND VOLSER LIST      */ 00324000
*/*              OF THE REQUESTED DATA SET                           */ 00325000
*/*                                                                  */ 00326000
*/*            SINFAREA - USYSINFO ROUTINE RETURN AREA               */ 00327000
*/*              COMMUNICATES THE UCB ADDRESS OF THE REQUESTED       */ 00328000
*/*              DDNAME                                              */ 00329000
*/*                                                                  */ 00330000
*/********************************************************************/ 00331000
*                                                                  0297 00332000
*                                                                  0297 00333000
*/*********************************************************  @Y30LB33*/ 00334000
*/*                                                          @Y30LB33*/ 00335000
*/* MSS GLOBAL DATA AREAS FOR AMS (VS2):        10/13/76     @ZA09521*/ 00336000
*/*     (1) MSS MESSAGE STRUCTURES                           @Y30LB30*/ 00337000
*/*     (2) SYSTEM ADAPTER DECLARATIONS                      @Y30LB30*/ 00338000
*/*         A) DATA STRUCTURES                               @Y30LB30*/ 00339000
*/*         B) SYMBOLIC RETURN CODES                         @Y30LB30*/ 00340000
*/*     (3) VOLUME SERVICE DECLARATIONS                      @Y30LB30*/ 00341000
*/*         A) DATA STRUCTURES                               @Y30LB30*/ 00342000
*/*         B) SYMBOLIC RETURN CODES                         @Y30LB30*/ 00343000
*/*     (4) INPUT/OUTPUT ADAPTER DECLARATIONS                @Y30LB30*/ 00344000
*/*     (5) CONVENTIONALIZED NAMED VALUES DELCARATIONS       @Y30LB30*/ 00345000
*/*                                                          @Y30LB30*/ 00346000
*/* CHANGE ACTIVITY -                                        @YD00171*/ 00347000
*/*       @YD00171                                           @YD00171*/ 00348000
*/*       @YD00175                                           @YD00175*/ 00349000
*/* CHANGE 03  3/18/75  NEW COPY CART. MSSC MESSAGE FORMAT   @ZM00741*/ 00350000
*/* CHANGE 04 11/10/75  NEW STAEPARM FORMAT                  @ZA05112*/ 00351000
*/* CHANGE 05 03/04/76  MDFORCE IN MDAGL                     @ZA09521*/ 00352000
*/* CHANGE 06 9/1/76  DCRR - REBUILD A VOLUME LABEL          @ZDR2057*/ 00353000
*/* CHANGE 07 10/13/76 FIX TO CTMSG CTARRAY MULTIPLE         @ZA14727*/ 00354000
*/* CHANGE 08 10/20/76 REPAIRV                               @ZA11014*/ 00355000
*/*                                                          @YD00171*/ 00356000
*/*********************************************************  @Y30LB30*/ 00357000
*                                                                  0297 00358000
*                                   /*                       @Y30LB30*/ 00359000
*/*********************************************************  @Y30LB33*/ 00360000
*/*                                                          @Y30LB33*/ 00361000
*/*  THIS STRUCTURE IS THE FORMAT OF THE COPY CARTRIDGE      @Y30LB33*/ 00362000
*/*  MESSAGE RETURNED AFTER THE SUCCESSFUL COMPLETION        @Y30LB33*/ 00363000
*/*  OF THE USSC MACRO.                                      @Y30LB33*/ 00364000
*/*                                                          @Y30LB33*/ 00365000
*/*********************************************************  @Y30LB33*/ 00366000
*                                                                  0297 00367000
*                                   /*                       @Y30LB33*/ 00368000
*   DCL                                                            0297 00369000
*     CCMSGPTR PTR(31);             /* PTR TO MSG AREA       @Y30LB33   00370000
*                                                            @Y30LB33*/ 00371000
*   DCL                                                            0298 00372000
*     1 CCMSG BASED(CCMSGPTR),      /*                       @Y30LB33*/ 00373000
*      2 CCPSTCDE CHAR(1),          /* POST CODE             @ZM00741*/ 00374000
*      2 CCEJCODE FIXED(8),         /* EJECT CODE            @ZM00741*/ 00375000
*      2 * CHAR(2),                 /* RESERVED              @ZM00741*/ 00376000
*      2 CCVOL CHAR(6),             /* VOLUME                @Y30LB33*/ 00377000
*      2 * CHAR(2),                 /* RESERVED              @ZM00741*/ 00378000
*      2 CCNEWCSN CHAR(12),         /* REPLACEMENT CART      @Y30LB33*/ 00379000
*      2 CCOLDCSN CHAR(12);         /* OLD CARTRIDGE         @Y30LB33   00380000
*                                                            @Y30LB33   00381000
*                                                            @Y30LB33*/ 00382000
*/*********************************************************  @Y30LB33*/ 00383000
*/*                                                          @Y30LB33*/ 00384000
*/*  THIS STRUCTURE IS THE FORMAT OF THE MOVE AND            @Y30LB33*/ 00385000
*/*  DEFINE MESSAGES RETURNED AFTER THE SUCCESSFUL           @Y30LB33*/ 00386000
*/*  COMPLETION OF THE USSC MACRO                            @Y30LB33*/ 00387000
*/*                                                          @Y30LB33*/ 00388000
*/*********************************************************  @Y30LB33*/ 00389000
*                                                                  0299 00390000
*                                   /*                       @Y30LB33*/ 00391000
*   DCL                                                            0299 00392000
*     CMMSGPTR PTR(31);             /* PTR TO MSG AREA       @Y30LB30   00393000
*                                                            @Y30LB33*/ 00394000
*   DCL                                                            0300 00395000
*     1 CMMSG BASED(CMMSGPTR),      /*                       @Y30LB30*/ 00396000
*      2 CMOLDVOL CHAR(6),          /* OLD VOLID             @Y30LB30*/ 00397000
*      2 CMVOLFLG CHAR(1),          /* MESSAGE FLAGS         @Y30LB30*/ 00398000
*       3 CMCECART BIT(1),          /* CE CART               @Y30LB30*/ 00399000
*       3 CMSCRVOL BIT(1),          /* SCRATCH VOLUME        @Y30LB30*/ 00400000
*       3 CMDERAS BIT(1),           /* DASD ERASE            @Y30LB30*/ 00401000
*       3 CMEXCL BIT(1),            /* EXCLUSIVE VOLUME      @Y30LB30*/ 00402000
*       3 CMSCRCRT BIT(1),          /* SCRATCH CARTRIDGE     @Y30LB30*/ 00403000
*       3 CMBIND BIT(1),            /* BOUND VOLUME          @Y30LB30*/ 00404000
*       3 CMRONLY BIT(1),           /* READONLY VOLUME       @Y30LB30*/ 00405000
*       3 * BIT(1),                 /* UNUSED                @Y30LB33*/ 00406000
*      2 * CHAR(1),                 /* UNUSED                @Y30LB33*/ 00407000
*      2 CMNEWVOL CHAR(6),          /* NEW VOLID             @Y30LB30*/ 00408000
*      2 * CHAR(1),                 /* UNUSED                @Y30LB33*/ 00409000
*      2 CMNUMCRT CHAR(1),          /* NUMBER OF CARTS       @Y30LB30*/ 00410000
*      2 CMCSN1 CHAR(12),           /* CART SERIAL 1         @Y30LB30*/ 00411000
*      2 CMCSN2 CHAR(12);           /* CART SERIAL 2         @Y30LB30   00412000
*                                                            @Y30LB33*/ 00413000
*/*********************************************************  @Y30LB33*/ 00414000
*/*                                                          @Y30LB33*/ 00415000
*/* THIS STRUCTURE IS THE FORMAT OF THE COPY TABLES          @Y30LB33*/ 00416000
*/* MESSAGE RETURNED AFTER THE SUCCESSFUL COMPLETION         @Y30LB33*/ 00417000
*/* OF THE USSC MACRO TO COPY THE MSC TABLES                 @Y30LB30*/ 00418000
*/*                                                          @Y30LB33*/ 00419000
*/*********************************************************  @Y30LB33*/ 00420000
*                                                                  0301 00421000
*                                   /*                       @Y30LB33*/ 00422000
*   DCL                                                            0301 00423000
*     CTMSGPTR PTR(31);             /* PTR TO MSG AREA       @Y30LB33   00424000
*                                                            @Y30LB33*/ 00425000
*   DCL                                                            0302 00426000
*     1 CTMSG BASED(CTMSGPTR),      /*                       @Y30LB33*/ 00427000
*      2 * CHAR(1),                 /* UNUSED                @Y30LB33*/ 00428000
*      2 CTREALCC CHAR(2),          /* CYLINDER IN           @Y30LB33   00429000
*                                      TARGET DATA SET       @Y30LB33   00430000
*                                      WHERE FIRST           @Y30LB33   00431000
*                                      BEGINS                @Y30LB33*/ 00432000
*      2 CTREALH FIXED(8) UNSIGNED, /*                       @Y30LB33   00433000
*                                      TRACK IN TARGET       @Y30LB33   00434000
*                                      DATA SET WHERE        @Y30LB33   00435000
*                                      FIRST TABLE           @Y30LB33   00436000
*                                      BEGINS                @Y30LB33*/ 00437000
*      2 CTARRAY(14) CHAR(4),       /* TABLE TRACKS          @ZA14727*/ 00438000
*       3 CTTBLID CHAR(1),          /* TABLE ID              @Y30LB33*/ 00439000
*       3 CTTBLCC FIXED(8)          /* CYLINDER WHERE        @Y30LB33*/ 00440000
*             UNSIGNED,             /* TABLE BEGAN ON        @Y30LB33   00441000
*                                      TABLE VOLUME          @Y30LB33*/ 00442000
*       3 CTTBLHH FIXED(8)          /* TRACK WHERE           @Y30LB33*/ 00443000
*             UNSIGNED,             /* TABLE BEGAN ON        @Y30LB33   00444000
*                                      TABLE VOLUME          @Y30LB33*/ 00445000
*       3 CTTBLRR FIXED(8)          /* RECORD WHERE          @Y30LB33*/ 00446000
*             UNSIGNED;             /* TABLE BEGAN ON        @Y30LB33   00447000
*                                      TABLE VOLUME          @Y30LB33*/ 00448000
*/*                                                          @Y30LB33*/ 00449000
*/*********************************************************  @Y30LB37*/ 00450000
*/*                                                          @Y30LB37*/ 00451000
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR MOUNT/DEMOUNT   @Y30LB37*/ 00452000
*/*  FOR THE UMSSUNIT MACRO CALL.                            @Y30LB37*/ 00453000
*/*                                                          @Y30LB37*/ 00454000
*/*********************************************************  @Y30LB37*/ 00455000
*                                                                  0303 00456000
*                                   /*                       @Y30LB37*/ 00457000
*   DCL                                                            0303 00458000
*     1 MDAGL BDY(WORD) BASED,      /*                       @Y30LB37*/ 00459000
*      2 MDHEAD CHAR(8),            /* MDAGL HEADING         @Y30LB37*/ 00460000
*      2 MDUCBPTR PTR(31),          /* PTR TO UCB ADDR       @Y30LB37*/ 00461000
*      2 MDDDNAME CHAR(8),          /* DDNAME                @Y30LB37*/ 00462000
*      2 MDPUAGL PTR(31),           /* PTR TO PUAGL          @Y30LB37*/ 00463000
*      2 MDLABEL CHAR(6),           /* VOL SERIAL NUMBER     @Y30LB37*/ 00464000
*      2 MDFLAGS,                   /* OPTION FLAGS          @Y30LB37*/ 00465000
*       3 MDNEWVOL BIT(1),          /* NEW VOLUME            @Y30LB37*/ 00466000
*       3 MDCLEAR BIT(1),           /* CLEAR WITH MOUNT      @Y30LB37*/ 00467000
*       3 MDPOST BIT(1),            /* POST WITH DEMOUNT     @Y30LB37*/ 00468000
*       3 MDWAIT BIT(1),            /* WAIT ON DEMOUNT       @Y30LB37*/ 00469000
*       3 MDENQ BIT(1),             /* INTERNAL ENQ FLAG     @Y30LB37*/ 00470000
*       3 MDDEQ BIT(1),             /* DEQ WITH DEMOUNT      @YD00175*/ 00471000
*       3 MDFORCE BIT(1),           /* FORCE DEMOUNT         @ZA09521*/ 00472000
*       3 MDVTOCTR BIT(1),          /* USE SUPPLIED VTOC     @ZDR2057*/ 00473000
*      2 * CHAR(1),                 /* RESERVED (UNUSED)     @ZDR2057*/ 00474000
*      2 MDVTOC CHAR(5) BDY(WORD),  /* VTOC                  @ZDR2057*/ 00475000
*       3 MDCC FIXED(15),           /* CC (CYLANDER)         @ZDR2057*/ 00476000
*       3 MDHH FIXED(15),           /* HH (HEAD)             @ZDR2057*/ 00477000
*       3 MDR CHAR(1);              /* R (RECORD)            @ZDR2057   00478000
*                                                            @Y30LB30*/ 00479000
*/*********************************************************  @Y30LB37*/ 00480000
*/*                                                          @Y30LB37*/ 00481000
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR POST UCB        @Y30LB37*/ 00482000
*/*  FOR THE UMSSUNIT MACRO CALL.                            @Y30LB37*/ 00483000
*/*                                                          @Y30LB37*/ 00484000
*/*********************************************************  @Y30LB37*/ 00485000
*                                                                  0304 00486000
*                                   /*                       @Y30LB37*/ 00487000
*   DCL                                                            0304 00488000
*     1 PUAGL BDY(WORD) BASED,      /*                       @Y30LB37*/ 00489000
*      2 PUHEAD CHAR(8),            /* PUAGL HEADING         @Y30LB37*/ 00490000
*      2 PUUCBPTR PTR(31),          /* UCB POINTER           @Y30LB37*/ 00491000
*      2 PUTTRPTR PTR(31),          /* TTR POINTER           @Y30LB37*/ 00492000
*      2 PULABELP PTR(31);          /* VOLUME LABEL PTR      @Y30LB37   00493000
*                                                            @Y30LB37*/ 00494000
*/*********************************************************  @Y30LB37*/ 00495000
*/*                                                          @Y30LB37*/ 00496000
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR CHECK UCB       @Y30LB37*/ 00497000
*/*  FOR THE UMSSUNIT MACRO CALL.                            @Y30LB37*/ 00498000
*/*                                                          @Y30LB37*/ 00499000
*/*********************************************************  @Y30LB37*/ 00500000
*                                                                  0305 00501000
*                                   /*                       @Y30LB37*/ 00502000
*   DCL                                                            0305 00503000
*     1 CKAGL BDY(WORD) BASED,      /*                       @Y30LB37*/ 00504000
*      2 CKHEAD CHAR(8),            /* CKAGL HEADING         @Y30LB37*/ 00505000
*      2 CKUCBPTR PTR(31),          /* UCB POINTER           @Y30LB37*/ 00506000
*      2 CKDDNAME CHAR(8),          /* DDNAME                @Y30LB37*/ 00507000
*      2 CKDATYPE PTR(31),          /* RET ADDR OF TYPE      @Y30LB37*/ 00508000
*      2 CKLABELP PTR(31),          /* VOLUME LABEL PTR      @Y30LB37*/ 00509000
*      2 CKFLAGS,                   /* OPTION FLAGS          @Y30LB37*/ 00510000
*       3 CKTESTVT BIT(1),          /* TEST VIRTUAL          @Y30LB37*/ 00511000
*       3 CKRETTYP BIT(1),          /* RETURN TYPE           @Y30LB37*/ 00512000
*       3 CKDMTABL BIT(1),          /* TEST DEMOUNTABLE      @Z40LB35*/ 00513000
*       3 * BIT(5);                 /* RESERVED              @YD00175   00514000
*                                                            @Y30LB37*/ 00515000
*/*********************************************************  @YD00175*/ 00516000
*/*                                                          @YD00175*/ 00517000
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR EXCLUSIVE       @YD00175*/ 00518000
*/*  CONTROL FOR THE UMSSUNIT MACRO CALL.                    @YD00175*/ 00519000
*/*                                                          @YD00175*/ 00520000
*/*********************************************************  @YD00175*/ 00521000
*                                                                  0306 00522000
*                                   /*                       @YD00175*/ 00523000
*   DCL                                                            0306 00524000
*     1 EXCLAGL BDY(WORD) BASED,    /*                       @YD00175*/ 00525000
*      2 EXCLHEAD CHAR(8),          /* EXCLAGL HEADING       @YD00175*/ 00526000
*      2 EXCLUCBP PTR(31),          /* UCB POINTER           @YD00175*/ 00527000
*      2 EXCLDDP PTR(31),           /* DDNAME POINTER        @YD00175*/ 00528000
*      2 EXCLVOL CHAR(6),           /* VOLUME SERIAL         @YD00175*/ 00529000
*      2 EXCLFLAG,                  /* OPTION FLAGS          @YD00175*/ 00530000
*       3 EXCLMNT BIT(1),           /* VOLUME MOUNTED FLAG   @YD00175*/ 00531000
*       3 * BIT(7);                 /* RESERVED              @YD00175   00532000
*                                                            @YD00175*/ 00533000
*/*********************************************************  @YD00175*/ 00534000
*/*                                                          @Y30LB35*/ 00535000
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR OPEN            @Y30LB35*/ 00536000
*/*  FOR THE UEXCP MACRO CALL.                               @Y30LB35*/ 00537000
*/*                                                          @Y30LB35*/ 00538000
*/*********************************************************  @Y30LB35*/ 00539000
*                                                                  0307 00540000
*                                   /*                       @Y30LB35*/ 00541000
*   DCL                                                            0307 00542000
*     1 EXOARG BDY(WORD) BASED,     /*                       @Y30LB35*/ 00543000
*      2 EXOHEAD CHAR(8),           /* RESERVED              @Y30LB35*/ 00544000
*      2 EXODDN PTR(31),            /* POINTER TO DDNAME     @Y30LB35*/ 00545000
*      2 EXODSN PTR(31),            /* POINTER TO DSNAME     @Y30LB35*/ 00546000
*      2 EXOVSN PTR(31),            /* POINTER TO VOL SER    @Y30LB35*/ 00547000
*      2 EXOUCB PTR(31),            /* POINTER TO UCB        @Y30LB35*/ 00548000
*      2 EXOEXT PTR(31),            /* POINTER RET EXTENTS   @Y30LB30*/ 00549000
*      2 EXOCTLBK PTR(31),          /* PTR RET IOCTLBK PTR   @Y30LB30*/ 00550000
*      2 EXOPT,                     /* OPEN OPITIONS         @Y30LB35*/ 00551000
*       3 EXOTAB BIT(1),            /* OPEN FOR MSC TABLES   @Y30LB30*/ 00552000
*       3 EXOLAB BIT(1),            /* OPEN VOL LABEL        @Y30LB35*/ 00553000
*       3 EXOPASS BIT(1),           /* OPEN TEST PASSWD      @Y30LB35*/ 00554000
*       3 EXONEW BIT(1),            /* OPEN VOL TO INIT      @Y30LB35*/ 00555000
*       3 EXOVTOC BIT(1),           /* OPEN VOL TO READ      @Z40LB35   00556000
*                                      VTOC DSCBS            @Z40LB35*/ 00557000
*       3 EXOREP BIT(1),            /* REPAIR OPEN           @ZA11014*/ 00558000
*       3 * BIT(2),                 /* RESERVED              @ZA11014*/ 00559000
*      2 EXFLG,                     /* OPEN FLAGS            @Y30LB35*/ 00560000
*       3 EXOREAD BIT(1),           /* INDICATES READ ONLY   @Y30LB35*/ 00561000
*       3 * BIT(2),                 /* RESERVED              @ZA11014*/ 00562000
*       3 EXORVS BIT(1),            /* VSAM DATA SET         @ZA11014*/ 00563000
*       3 EXOSPK BIT(1),            /* STAGING PACK          @ZA11014*/ 00564000
*       3 EXORDS BIT(1),            /* DATA SET              @ZA11014*/ 00565000
*       3 EXORVT BIT(1),            /* VTOC                  @ZA11014*/ 00566000
*       3 EXOVTH BIT(1);            /* VTOC HEADER           @ZA11014   00567000
*                                                            @Y30LB30*/ 00568000
*/*********************************************************  @Y30LB35*/ 00569000
*/*                                                          @Y30LB35*/ 00570000
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR GET             @Y30LB35*/ 00571000
*/*  FOR THE UEXCP MACRO CALL.                               @Y30LB35*/ 00572000
*/*                                                          @Y30LB35*/ 00573000
*/*********************************************************  @Y30LB35*/ 00574000
*                                                                  0308 00575000
*                                   /*                       @Y30LB35*/ 00576000
*   DCL                                                            0308 00577000
*     1 EXGARG BDY(WORD) BASED,     /*                       @Y30LB35*/ 00578000
*      2 EXGHEAD CHAR(8),           /* RESERVED              @Y30LB35*/ 00579000
*      2 EXGCTLBK PTR(31),          /* POINTER TO IOCTLBK    @Y30LB35*/ 00580000
*      2 EXGCCHH1 PTR(31),          /* PTR TO SEEK CCHHR     @Y30LB35*/ 00581000
*      2 EXGCCHH2 PTR(31),          /* PTR TO SEARCH CCHHR   @Y30LB35*/ 00582000
*      2 EXGRECNO FIXED(31),        /* NUM RECORDS TO READ   @Y30LB35*/ 00583000
*      2 EXGDATAP PTR(31),          /* PTR AREA FOR RECS     @Y30LB35*/ 00584000
*      2 EXGKEYLN FIXED(8) UNSIGNED,/* LEN OF KEY            @Y30LB35*/ 00585000
*      2 * FIXED(8),                /* RESERVED              @Y30LB35*/ 00586000
*      2 EXGDATAL FIXED(15) UNSIGNED;/* LEN OF DATA          @Y30LB35*/ 00587000
*/*********************************************************  @ZA11014*/ 00588000
*/*                                                          @ZA11014*/ 00589000
*/* THIS STRUCTURE IS THE ARGUMENT LIST FOR REPAIRV          @ZA11014*/ 00590000
*/* I/O CALLS TO THE UEXCP MACRO                             @ZA11014*/ 00591000
*/*                                                          @ZA11014*/ 00592000
*/*********************************************************  @ZA11014*/ 00593000
*                                                                  0309 00594000
*                                   /*                       @Y30LB35*/ 00595000
*   DCL                                                            0309 00596000
*     1 EXWRARG BDY(WORD) BASED,    /*                       @ZA11014*/ 00597000
*      2 EXRWRES CHAR(8),           /* RESERVED              @ZA11014*/ 00598000
*      2 EXRWCTBL PTR(31),          /* POINTER TO IOCTLBK    @ZA11014*/ 00599000
*      2 EXRWIOAR PTR(31),          /* PTR TO SEEK CCHHR     @ZA11014*/ 00600000
*      2 EXRWDARE PTR(31),          /* PTR TO SEARCH CCHHR   @ZA11014*/ 00601000
*      2 EXLOCPTR PTR(31),          /* NUM RECORDS TO READ   @ZA11014*/ 00602000
*      2 EXCCWCNT FIXED(15),        /* PTR AREA FOR RECS     @ZA11014*/ 00603000
*      2 EXRWCHR,                   /*                       @ZA11014*/ 00604000
*       3 EXCC FIXED(16),           /*                       @ZA11014*/ 00605000
*       3 EXHH FIXED(16),           /*                       @ZA11014*/ 00606000
*       3 EXRECNUM FIXED(8),        /*                       @ZA11014*/ 00607000
*      2 * FIXED(8),                /* RESERVED              @ZA11014*/ 00608000
*      2 EXRWKDLN PTR(31),          /*                       @ZA11014*/ 00609000
*      2 EXSPACE,                   /*                       @ZA11014*/ 00610000
*       3 * FIXED(8),               /*                       @ZA11014*/ 00611000
*       3 * PTR(24),                /*                       @ZA11014*/ 00612000
*       3 * FIXED(15),              /*                       @ZA11014*/ 00613000
*       3 * FIXED(15),              /*                       @ZA11014*/ 00614000
*       3 * FIXED(15),              /*                       @ZA11014*/ 00615000
*      2 EXRWFUN FIXED(8);          /*                       @ZA11014*/ 00616000
*/*********************************************************  @Y30LB35*/ 00617000
*/*                                                          @Y30LB35*/ 00618000
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR PUT             @Y30LB35*/ 00619000
*/*  FOR THE UEXCP MACRO CALL.                               @Y30LB35*/ 00620000
*/*                                                          @Y30LB35*/ 00621000
*/*********************************************************  @Y30LB35*/ 00622000
*                                                                  0310 00623000
*                                   /*                       @Y30LB35*/ 00624000
*   DCL                                                            0310 00625000
*     1 EXPARG BDY(WORD) BASED,     /*                       @Y30LB35*/ 00626000
*      2 EXPHEAD CHAR(8),           /* RESERVED              @Y30LB35*/ 00627000
*      2 EXPCTLBK PTR(31),          /* PTR IOCTLBK PTR       @Y30LB35*/ 00628000
*      2 EXPDATA PTR(31),           /* PTR DATA-TO-WRITE     @Y30LB35*/ 00629000
*      2 EXPCCHHR PTR(31);          /* PTR TO SEEK CCHHR     @Y30LB35   00630000
*                                                            @Y30LB30*/ 00631000
*/*********************************************************  @Y30LB35*/ 00632000
*/*                                                          @Y30LB35*/ 00633000
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR DATA-TO-WRITE   @Y30LB35*/ 00634000
*/*  FOR THE UEXCP MACRO CALL.                               @Y30LB35*/ 00635000
*/*                                                          @Y30LB35*/ 00636000
*/*********************************************************  @Y30LB35*/ 00637000
*                                                                  0311 00638000
*                                   /*                       @Y30LB35*/ 00639000
*   DCL                                                            0311 00640000
*     1 EXPDATAB BDY(WORD) BASED(EXPDATA),/*                 @Y30LB35*/ 00641000
*      2 EXPRECNO FIXED(31),        /* NUM OF RECORDS        @Y30LB35*/ 00642000
*      2 EXPARRAY(*),               /* DATA-TO-WRITE ARRAY   @Y30LB35*/ 00643000
*       3 EXPDATAP PTR(31),         /* PTR TO DATA           @Y30LB30*/ 00644000
*       3 EXPKEYLN FIXED(8) UNSIGNED,/* LEN OF KEY           @Y30LB35*/ 00645000
*       3 * FIXED(8),               /* RESERVED              @Y30LB35*/ 00646000
*       3 EXPDATAL FIXED(15) UNSIGNED;/* LEN DATA            @Y30LB35   00647000
*                                                            @Y30LB30*/ 00648000
*/*********************************************************  @Y30LB35*/ 00649000
*/*                                                          @Y30LB35*/ 00650000
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR VOLUME SERVICES @Y30LB35*/ 00651000
*/*  FOR THE 'INITVOL', 'GETLABEL', AND 'PUTLABEL' REQUEST.  @Y30LB35*/ 00652000
*/*                                                          @Y30LB35*/ 00653000
*/*********************************************************  @Y30LB35*/ 00654000
*                                                                  0312 00655000
*                                   /*                       @Y30LB35*/ 00656000
*   DCL                                                            0312 00657000
*     1 VS2AGL BDY(WORD) BASED,     /*                       @Y30LB35*/ 00658000
*      2 VS2HEAD CHAR(8),           /* RESERVED              @Y30LB35*/ 00659000
*      2 VSUCBPTR PTR(31),          /* PTR TO UCB ADDR       @Y30LB35*/ 00660000
*      2 VSVTOCSZ FIXED(31),        /* VTOC TRK SIZE         @Y30LB35*/ 00661000
*      2 VSOWNPTR PTR(31),          /* PTR TO OWNER NAME     @Y30LB30*/ 00662000
*      2 VSVOLPTR PTR(31),          /* PTR TO VOLUME SER     @Y30LB30*/ 00663000
*      2 VSIOBKPT PTR(31),          /* PTR TO IOXCTLBK PTR   @Y30LB30*/ 00664000
*      2 VSLABOPT,                  /* LABEL OPTIONS         @Y30LB35*/ 00665000
*       3 VSOWNER BIT(1),           /* RETRIEVE OR UPDATE    @Y30LB35   00666000
*                                      OWNER FIELD IN LABEL@Y30LB35  */ 00667000
*       3 VSVOLSER BIT(1),          /* RETRIEVE OR UPDATE    @Y30LB35   00668000
*                                      VOL FIELD IN LABEL    @Y30LB35*/ 00669000
*       3 VSNOVTOC BIT(1),          /* NO DEFAULT VTOC       @ZDR2057*/ 00670000
*       3 * BIT(5),                 /* RESERVED              @ZDR2057*/ 00671000
*      2 VSVOLUME CHAR(6),          /* SERIAL NUM FOR OPEN   @Y30LB35*/ 00672000
*      2 VS2MSG,                    /* MESSAGE OPTION        @Y30LB35*/ 00673000
*       3 VS2TOV BIT(1),            /* TO VOLUME PLACED IN   @Y30LB35   00674000
*                                      MESSAGE               @Y30LB35*/ 00675000
*       3 * BIT(7),                 /* RESERVED              @Y30LB35*/ 00676000
*      2 VS2RESOP,                  /* RESERVE OPTION        @Y30LB30*/ 00677000
*       3 VS2RES BIT(1),            /* RESERVE TO BE         @Y30LB35   00678000
*                                      PERFORMED             @Y30LB35*/ 00679000
*       3 VS2REAL BIT(1),           /* REAL VOLUME           @Y30LB35*/ 00680000
*       3 * BIT(6),                 /* RESERVED              @Y30LB35*/ 00681000
*      2 VSDDNAME CHAR(8),          /* DD NAME               @YD00175*/ 00682000
*      2 * CHAR(3),                 /* RESERVED (UNUSED)     @ZDR2057*/ 00683000
*      2 VSVTOCPT PTR(31);          /* PTR TO VTOC           @ZDR2057   00684000
*                                                            @Y30LB30*/ 00685000
*/*********************************************************  @Y30LB30*/ 00686000
*/*                                                          @Y30LB30*/ 00687000
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR VOLUME SERVICES @Y30LB30*/ 00688000
*/*  FOR THE 'SECCHECK', 'SCRVTOC ', 'GETVTOC ', 'PUTVTOC ', @Y30LB30*/ 00689000
*/*  AND 'RECATLG  ' SERVICE REQUESTS.                       @Y30LB30*/ 00690000
*/*                                                          @Y30LB30*/ 00691000
*/*********************************************************  @Y30LB30*/ 00692000
*                                                                  0313 00693000
*                                   /*                       @Y30LB30*/ 00694000
*   DCL                                                            0313 00695000
*     1 VS1AGL BDY(WORD) BASED,     /*                       @Y30LB30*/ 00696000
*      2 VSHEAD CHAR(8),            /* RESERVED              @Y30LB30*/ 00697000
*      2 VSUCBP PTR(31),            /* UCB ADDRESS PTR       @Y30LB30*/ 00698000
*      2 VSVOLP PTR(31),            /* VOLUME SER PTR        @Y30LB30*/ 00699000
*      2 VSFILEP PTR(31),           /* DD NAME PTR           @Y30LB30*/ 00700000
*      2 VSIOP PTR(31),             /* VTOC IOCSTR PTR       @Y30LB30*/ 00701000
*      2 VSNUMATP PTR(31),          /* NO. ALT TRACK PTR     @Y30LB30*/ 00702000
*      2 VSNXTATP PTR(31),          /* NEXT ALT TRK PTR      @Y30LB30*/ 00703000
*      2 VSCATP PTR(31),            /* VSAM CAT NAME PTR     @Y30LB30*/ 00704000
*      2 VSACBP PTR(31),            /* VSAM CAT ACB PTR      @Y30LB30*/ 00705000
*      2 VSCATDDP PTR(31),          /* VSAM CAT DDNAME PTR   @Y30LB30*/ 00706000
*      2 VSPSWDP PTR(31),           /* VSAM CAT PSWD PTR     @Y30LB30*/ 00707000
*      2 VSPFILEP PTR(31),          /* PASSWORD FILE PTR     @Y30LB30*/ 00708000
*      2 VSSERP PTR(31),            /* NEW SERIAL PTR        @Y30LB30*/ 00709000
*      2 VSDEVP PTR(31),            /* DEVICE TYPE PTR       @Y30LB30*/ 00710000
*      2 VSOSERP PTR(31),           /* OLD SERIAL PTR        @Y30LB30*/ 00711000
*      2 VSODEVP PTR(31),           /* OLD DEVICE PTR        @Y30LB30*/ 00712000
*      2 VSSECOPT,                  /* SECURITY CHECK OPT    @Y30LB30*/ 00713000
*       3 VSNOVSAM BIT(1),          /* NO VSAM DATA SETS     @Y30LB30*/ 00714000
*       3 VSMASTER BIT(1),          /* VSAM MASTER PSWD      @Y30LB30*/ 00715000
*       3 VSNONONV BIT(1),          /* NO NON-VSAM D.S.      @Y30LB30*/ 00716000
*       3 VSREAD BIT(1),            /* NON-VSAM READ PSWD    @Y30LB30*/ 00717000
*       3 VSWRITE BIT(1),           /* NON-VSAM WRITE PSWD   @Y30LB30*/ 00718000
*       3 VSUCTEST BIT(1),          /* RET USER CAT INFO     @Y30LB30*/ 00719000
*       3 VSOPCAT BIT(1),           /* OPEN USERCAT VS/2     @Y30LB30*/ 00720000
*       3 VSUCMAST BIT(1),          /* VSAM USERCAT MASTER   @YD00171*/ 00721000
*      2 VSVTOPT,                   /* VTOC FIELD OPTIONS    @Y30LB30*/ 00722000
*       3 VSTIME BIT(1),            /* VSAM TIME STAMP       @Y30LB30*/ 00723000
*       3 VSALTTRK BIT(1),          /* ALTERNATE TRACKS      @Y30LB30*/ 00724000
*       3 VSVSFLAG BIT(1),          /* VSAM OWNERSHIP FLAG   @Y30LB30*/ 00725000
*       3 * BIT(5),                 /* RESERVED              @Y30LB30*/ 00726000
*      2 VSCATOPT,                  /* RECATALOG OPTIONS     @Y30LB30*/ 00727000
*       3 VSDEVICE BIT(1),          /* DEVICE TYPE           @Y30LB30*/ 00728000
*       3 VSSERIAL BIT(1),          /* VOLUME SERIAL         @Y30LB30*/ 00729000
*       3 VSLIST BIT(1),            /* LIST NAMES            @Y30LB30*/ 00730000
*       3 * BIT(5),                 /* RESERVED              @Y30LB30*/ 00731000
*      2 VSRETURN,                  /* INFORMATION RETURN    @Y30LB30*/ 00732000
*       3 VSVSAM BIT(1),            /* VOL OWNED BY VSAM     @Y30LB30*/ 00733000
*       3 VSUCAT BIT(1),            /* USER CAT ON VOLUME    @Y30LB30*/ 00734000
*       3 * BIT(6),                 /* RESERVED              @Y30LB30*/ 00735000
*      2 VSMSG,                     /* MESSAGE OPTIONS       @Y30LB30*/ 00736000
*       3 VSFROMV BIT(1),           /* FROM VOLUME           @Y30LB30*/ 00737000
*       3 VSTOV BIT(1),             /* TO VOLUME             @Y30LB30*/ 00738000
*       3 * BIT(6),                 /* RESERVED              @Y30LB30*/ 00739000
*      2 VSRESOPT,                  /* RESERVE OPTIONS       @Y30LB30*/ 00740000
*       3 VSRES BIT(1),             /* RESERVE VOLUME        @Y30LB30*/ 00741000
*       3 VSREAL BIT(1),            /* REAL VOLUME           @Y30LB30*/ 00742000
*       3 * BIT(6);                 /* RESERVED              @Y30LB30   00743000
*                                                            @Y30LB30*/ 00744000
*/*********************************************************  @Y30LB34*/ 00745000
*/*                                                          @Y30LB34*/ 00746000
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR URECAT MACRO    @Y30LB34*/ 00747000
*/*                                                          @Y30LB34*/ 00748000
*/*********************************************************  @Y30LB34*/ 00749000
*                                                                  0314 00750000
*                                   /*                       @Y30LB34*/ 00751000
*   DCL                                                            0314 00752000
*     1 RCTAGL BDY(WORD) BASED,     /*                       @Y30LB34*/ 00753000
*      2 RCTHEAD CHAR(8),           /* RESERVED              @Y30LB30*/ 00754000
*      2 RCTOPT CHAR(2),            /* RECAT OPTIONS         @Y30LB30*/ 00755000
*       3 RCTDEV BIT(1),            /* DEVICE TYPE           @Y30LB30*/ 00756000
*       3 RCTVOL BIT(1),            /* VOLUME SERIAL         @Y30LB30*/ 00757000
*       3 * BIT(6),                 /* RESERVED              @Y30LB34*/ 00758000
*      2 * CHAR(2),                 /* RESERVED              @Y30LB34*/ 00759000
*      2 RCTODEV FIXED(31),         /* OLD DEV TYPE          @Y30LB30*/ 00760000
*      2 RCTNDEV FIXED(31),         /* NEW DEV TYPE          @Y30LB30*/ 00761000
*      2 RCTOVOL CHAR(6),           /* OLD VOL SER           @Y30LB30*/ 00762000
*      2 RCTNVOL CHAR(6),           /* NEW VOL SER           @Y30LB30*/ 00763000
*      2 RCTDSET CHAR(44);          /* DATA SET NAME         @Y30LB30   00764000
*                                                            @Y30LB34   00765000
*                                                            @Y30LB34*/ 00766000
*/*********************************************************  @Y30LB30*/ 00767000
*/*                                                          @Y30LB30*/ 00768000
*/*  THIS STRUCTURE IS THE ARGUMENT LIST FOR USTAE MACRO     @Y30LB30*/ 00769000
*/*                                                          @Y30LB30*/ 00770000
*/*********************************************************  @Y30LB30*/ 00771000
*                                                                  0315 00772000
*                                   /*                       @Y30LB30*/ 00773000
*   DCL                                                            0315 00774000
*     1 STAEPARM BDY(WORD) BASED,   /*                       @Y30LB33*/ 00775000
*      2 STAHEAD CHAR(8),           /* RESERVED              @Y30LB30*/ 00776000
*      2 STAVUCB PTR(31),           /* VIRTUAL UCB ADDR      @Y30LB30*/ 00777000
*      2 STAVVOL CHAR(6),           /* VIRTUAL VOLSER        @Y30LB30*/ 00778000
*      2 * CHAR(2),                 /* RESERVED              @Y30LB30*/ 00779000
*      2 STARUCB PTR(31),           /* REAL UCB ADDR         @Y30LB30*/ 00780000
*      2 STARVOL CHAR(6),           /* REAL VOLSER           @Y30LB30*/ 00781000
*      2 * CHAR(2),                 /* RESERVED              @Y30LB30*/ 00782000
*      2 STARTTR CHAR(4),           /* TTR TO THE VTOC       @Y30LB30*/ 00783000
*      2 STARTSAV PTR(31),          /* PTR TO RETRY SAVAREA  @Y30LB30*/ 00784000
*      2 STAEXSAV PTR(31),          /* PTR STAEEXIT SAVAREA  @Y30LB35*/ 00785000
*      2 STARTADD PTR(31),          /* PTR TO RETRY AREA     @Y30LB30*/ 00786000
*      2 STATCB PTR(31),            /* PTR TO ENQUEUED TCB   @Y30LB35*/ 00787000
*      2 STARCVY,                   /* TRACKING FLAGS        @Y30LB30*/ 00788000
*       3 STAVMNT BIT(1),           /* VIRT VOL MOUNTED      @Y30LB30*/ 00789000
*       3 STAVDMNT BIT(1),          /* VIRT VOL DEMOUNTED    @Y30LB30*/ 00790000
*       3 STAVENQ BIT(1),           /* VOL ENQUEUED          @Y30LB30*/ 00791000
*       3 STAVPOST BIT(1),          /* VIRT VOL POSTED       @Y30LB30*/ 00792000
*       3 STACLEAR BIT(1),          /* REAL UCB CLEARED      @Y30LB30*/ 00793000
*       3 * BIT(3),                 /* RESERVED              @Y30LB30*/ 00794000
*      2 STARETRY,                  /* RETRY FLAGS           @Y30LB30*/ 00795000
*       3 STAIO05 BIT(1),           /* IO5 RETRY IN CONTROL  @Y30LB30*/ 00796000
*       3 STAOFF BIT(1),            /* STAE CANCELLED (VS1)  @Y30LB35*/ 00797000
*       3 STAVTOC BIT(1),           /* OPEN VTOC IN-PROCESS  @Z40LB35*/ 00798000
*       3 * BIT(5),                 /* RESERVED              @ZA05112*/ 00799000
*      2 STAVTTR CHAR(4);           /* VIRTUAL VTOC TTR      @ZA05112   00800000
*                                                            @Y30LB37*/ 00801000
*/*********************************************************  @Y30LB37*/ 00802000
*/*                                                          @Y30LB37*/ 00803000
*/*  THIS STRUCTURE IS THE MAPPING OF THE VOLUME LABEL REC   @Y30LB37*/ 00804000
*/*                                                          @Y30LB37*/ 00805000
*/*********************************************************  @Y30LB37*/ 00806000
*                                                                  0316 00807000
*                                   /*                       @Y30LB37*/ 00808000
*   DCL                                                            0316 00809000
*     1 VOLLABEL BASED,                                            0316 00810000
*      2 VOLKEY CHAR(4),            /* VOL LABEL KEY         @Y30LB37*/ 00811000
*      2 VOLLABI CHAR(3),           /* LABEL ID 'VOL'        @Y30LB37*/ 00812000
*      2 VOLNO CHAR(1),             /* VOL LABEL SEQ NUMBER  @Y30LB37*/ 00813000
*      2 VOLSERNO CHAR(6),          /* VOLUME SERIAL         @Y30LB37*/ 00814000
*      2 VOLSECTY CHAR(1),          /* RESERVED              @Y30LB37*/ 00815000
*      2 VOLVTOC CHAR(5),           /* CCHHR OF THE VTOC     @Y30LB37*/ 00816000
*      2 VOLRESV1 CHAR(25),         /* RESERVED              @Y30LB37*/ 00817000
*      2 VOLOWNER CHAR(10),         /* USER NAME AREA        @Y30LB37*/ 00818000
*      2 VOLRESV3 CHAR(29);         /* RESERVED              @Y30LB37   00819000
*                                                            @Y30LB37*/ 00820000
*/*********************************************************  @Y30LB35*/ 00821000
*/*                                                          @Y30LB35*/ 00822000
*/*  THIS STRUCTURE IS THE MAPPING OF THE SVC 82 PARMLIST    @Y30LB35*/ 00823000
*/*                                                          @Y30LB35*/ 00824000
*/*********************************************************  @Y30LB35*/ 00825000
*                                                                  0317 00826000
*                                   /*                       @Y30LB35*/ 00827000
*   DCL                                                            0317 00828000
*     1 SV82LIST BDY(WORD) BASED,   /* SVC 82 ARG LIST       @Y30LB35*/ 00829000
*      2 SV82CODE BIT(8),           /* OPERATION CODE        @Y30LB35*/ 00830000
*      2 SV82UCBP PTR(24),          /* UCB ADDRESS           @Y30LB35*/ 00831000
*      2 * PTR(31),                 /* THIRD ARGUMENT        @Y30LB35*/ 00832000
*       3 SV82DCBP PTR(31),         /* DCB PTR FOR - OPEN    @Y30LB35*/ 00833000
*        4 SV82VOLP PTR(31),        /* VOL PTR FOR - POST    @Y30LB35*/ 00834000
*      2 SV82TTRP PTR(31),          /* TTR TO VTOC ADDRESS   @Y30LB35*/ 00835000
*      2 * PTR(31),                 /* FIFTH ARGUMENT        @Y30LB35*/ 00836000
*       3 SV82WRKP PTR(31),         /* ADD RET AREA - CLEAR  @Y30LB35*/ 00837000
*        4 SV82DEBP PTR(31);        /* ADDR DEB - CLOSE      @Y30LB35   00838000
*                                                            @Y30LB35*/ 00839000
*/*********************************************************  @Z40LB37*/ 00840000
*/*                                                          @Z40LB37*/ 00841000
*/* SORT ARGUMENT LIST                                       @Z40LB37*/ 00842000
*/*                                                          @Z40LB37*/ 00843000
*/*********************************************************  @Z40LB37*/ 00844000
*                                                                  0318 00845000
*   DCL                                                            0318 00846000
*     1 SRTAGL BDY(WORD) BASED,     /*                       @Z40LB37*/ 00847000
*      2 SRTHEAD CHAR(8),           /* SRTAGL HEADING        @Z40LB37*/ 00848000
*      2 SRTADDR PTR(31),           /* PTR TO FIRST          @Z40LB37   00849000
*                                      ELEMENT               @Z40LB37*/ 00850000
*      2 SRTNUM FIXED(31),          /* NUMBER OF             @Z40LB37   00851000
*                                      ELEMENTS              @Z40LB37*/ 00852000
*      2 SRTLEN FIXED(31),          /* LENGTH OF             @Z40LB37   00853000
*                                      ELEMENT               @Z40LB37*/ 00854000
*      2 SRTPOSIT FIXED(31),        /* SORT FIELD            @Z40LB37   00855000
*                                      STARTING POSITION     @Z40LB37*/ 00856000
*      2 SRTFLDLN FIXED(31),        /* SORT FIELD LENGTH     @Z40LB37*/ 00857000
*      2 SRTWORKP PTR(31);          /* WORK AREA ADDRESS     @Z40LB37*/ 00858000
*/*********************************************************  @Z40LB37*/ 00859000
*/*                                                          @Z40LB37*/ 00860000
*/* ULOCATE DATA SET RETURNED INFORMATION AREA               @Z40LB37*/ 00861000
*/*                                                          @Z40LB37*/ 00862000
*/*********************************************************  @Z40LB37*/ 00863000
*                                                                  0319 00864000
*   DCL                                                            0319 00865000
*     1 LCTINFO BDY(WORD) BASED,    /*                       @Z40LB37*/ 00866000
*      2 LCTHEAD CHAR(8),           /* LCTINFO HEADING       @Z40LB37*/ 00867000
*      2 LCTMULVC FIXED(31),        /* NUMBER OF VOLUMES     @Z40LB37*/ 00868000
*      2 LCTACBP PTR(31),           /* PTR TO THE ACB        @Z40LB37*/ 00869000
*      2 LCTCREAT CHAR(4),          /* VSAM CREATION DATE    @Z40LB37*/ 00870000
*      2 LCTEXPIR CHAR(4),          /* VSAM EXPIRATION       @Z40LB37   00871000
*                                      DATE                  @Z40LB37*/ 00872000
*      2 LCTOWNER CHAR(8),          /* OWNER NAME            @Z40LB37*/ 00873000
*      2 LCTFLAGS,                  /* RETURN FLAGS          @Z40LB37*/ 00874000
*       3 LCTVSCAT BIT(1),          /* VSAM CATALOG ENTRY    @Z40LB37*/ 00875000
*       3 * BIT(7);                 /* RESERVED              @Z40LB37*/ 00876000
*/*********************************************************  @Z40LB37*/ 00877000
*/*                                                          @Z40LB37*/ 00878000
*/* UUNCATLG ARGUMENT LIST                                   @Z40LB63*/ 00879000
*/*                                                          @Z40LB37*/ 00880000
*/*********************************************************  @Z40LB37*/ 00881000
*                                                                  0320 00882000
*   DCL                                                            0320 00883000
*     1 UCTAGL BDY(WORD) BASED,     /*                       @Z40LB63*/ 00884000
*      2 UCTHEAD CHAR(8),           /* UCTAGL HEADING        @Z40LB63*/ 00885000
*      2 UCTDSN CHAR(44),           /* DATA SET NAME         @Z40LB63*/ 00886000
*      2 UCTACBP PTR(31),           /* PTR TO CAT ACB        @Z40LB63*/ 00887000
*      2 UCTVOLP PTR(31),           /* PTR TO VOLUME         @Z40LB30   00888000
*                                      LIST                  @Z40LB30*/ 00889000
*      2 UCTDD CHAR(8),             /* DDNAME                @Z40LB63*/ 00890000
*      2 UCTFLAGS,                  /* OPTION FLAGS          @Z40LB63*/ 00891000
*       3 UCTVSCAT BIT(1),          /* VSAM CATALOG          @Z40LB63*/ 00892000
*       3 * BIT(7);                 /* RESERVED              @Z40LB63*/ 00893000
*/*********************************************************  @Z40LB37*/ 00894000
*/*                                                          @Z40LB37*/ 00895000
*/* ARGUMENT LIST FOR SELECTING A DDNAME                     @Z40LB37*/ 00896000
*/*                                                          @Z40LB37*/ 00897000
*/*********************************************************  @Z40LB37*/ 00898000
*                                                                  0321 00899000
*   DCL                                                            0321 00900000
*     1 SELAGL BDY(WORD) BASED,     /*                       @Z40LB37*/ 00901000
*      2 SELHEAD CHAR(8),           /* SELAGL HEADING        @Z40LB37*/ 00902000
*      2 SELUCBP PTR(31),           /* UCB POINTER           @Z40LB37*/ 00903000
*      2 SELDDNP PTR(31),           /* DDNAME POINTER        @Z40LB37*/ 00904000
*      2 SELVOL CHAR(6),            /* VOLUME SERIAL         @Z40LB37*/ 00905000
*      2 SELFLAGS,                  /* OPTION FLAGS          @Z40LB37*/ 00906000
*       3 * BIT(8);                 /* RESERVED              @Z40LB37*/ 00907000
*/*********************************************************  @Z40LB37*/ 00908000
*/*                                                          @Z40LB37*/ 00909000
*/* ARGUMENT LIST FOR CONVERT DATE PROCEDURE                 @Z40LB35*/ 00910000
*/*                                                          @Z40LB37*/ 00911000
*/*********************************************************  @Z40LB37*/ 00912000
*                                                                  0322 00913000
*   DCL                                                            0322 00914000
*     1 DATESAGL BDY(WORD) BASED,                                  0322 00915000
*      2 DATHEAD CHAR(8),           /* IDENTIFIER HEADER     @Z40LB35*/ 00916000
*      2 DATDATE FIXED(31),         /* DATE TO CONVERT       @Z40LB35*/ 00917000
*      2 DATDAYS FIXED(31),         /* DAYS TO ADJUST        @Z40LB35*/ 00918000
*      2 DATRETRN PTR(31),          /* RETURN PTR OF DATE    @Z40LB35*/ 00919000
*      2 DATESOPT BIT(8),           /* OPTIONS FLAGS         @Z40LB35*/ 00920000
*       3 DATADD BIT(1),            /* ADD DAYS TO DATE      @Z40LB35*/ 00921000
*       3 DATSUB BIT(1),            /* SUBTRACT DAYS         @Z40LB35*/ 00922000
*       3 DATDTEOP BIT(1),          /* ADJUST DAYS           @Z40LB35*/ 00923000
*       3 DATDAYOP BIT(1),          /* CONVERT DATE ONLY     @Z40LB35*/ 00924000
*       3 * BIT(4);                 /* RESERVED              @Z40LB35*/ 00925000
*/*********************************************************  @Z40LB35*/ 00926000
*/*                                                          @Z40LB37*/ 00927000
*/* SELECTDS DATA SET ARGUMENT LIST                          @Z40LB35*/ 00928000
*/*                                                          @Z40LB35*/ 00929000
*/*********************************************************  @Z40LB37*/ 00930000
*                                                                  0323 00931000
*   DCL                                                            0323 00932000
*     1 VS3AGL BDY(WORD) BASED,                                    0323 00933000
*      2 VS3HEAD CHAR(8),           /* RESERVED              @Z40LB35*/ 00934000
*      2 VS3LISTP PTR(31),          /* PTR LIST ADDR         @Z40LB35*/ 00935000
*      2 VS3EXDSP PTR(31),          /* PTR EXCLUDE DS        @Z40LB35*/ 00936000
*      2 VS3LEVP PTR(31),           /* PTR LEVEL QUAL        @Z40LB35*/ 00937000
*      2 VS3LEVLN FIXED(15),        /* LENGTH OF QUAL        @Z40LB35*/ 00938000
*      2 VS3AST FIXED(15),          /* OFFSET ASTERISK       @Z40LB35*/ 00939000
*      2 VS3EXPIR PTR(31),          /* PTR EXPIRATION DATE   @Z40LB35*/ 00940000
*      2 VS3CREAT PTR(31),          /* PTR CREATION DATE     @Z40LB35*/ 00941000
*      2 VS3UCBP PTR(31),           /* PTR UCB               @Z40LB35*/ 00942000
*      2 VS3DEV CHAR(4),            /* DEVICE TYPE           @Z40LB35*/ 00943000
*      2 VS3POOL CHAR(4),           /* STORAGE POOL ID       @Z40LB35*/ 00944000
*      2 VS3VOL CHAR(6),            /* SERIAL NUMBER         @Z40LB35*/ 00945000
*      2 VS3DD CHAR(8),             /* DDNAME FOR OPEN       @Z40LB35*/ 00946000
*      2 VS3FLAGS,                  /* FLAGS                 @Z40LB35*/ 00947000
*       3 VS3STAT BIT(1),           /* RETURN VSDSTAT        @Z40LB35*/ 00948000
*       3 VS3USAGE BIT(1),          /* RETURN VSDUSAGE       @Z40LB35*/ 00949000
*       3 VS3SCR BIT(1),            /* RETURN VSDSCR         @Z40LB35*/ 00950000
*       3 VS3UNCAT BIT(1),          /* UNCAT SELECTION       @Z40LB35*/ 00951000
*       3 VS3SYSNM BIT(1),          /* SYSTEM NAME           @Z40LB35   00952000
*                                      SELECTION             @Z40LB35*/ 00953000
*       3 * BIT(3);                 /* RESERVED              @Z40LB35*/ 00954000
*/*********************************************************  @YD00175*/ 00955000
*/*                                                          @YD00175*/ 00956000
*/*   SELECTED DATA SET ARRAY                                @Z40LB35*/ 00957000
*/*                                                          @Z40LB35*/ 00958000
*/*********************************************************  @Z40LB35*/ 00959000
*                                                                  0324 00960000
*   DCL                                                            0324 00961000
*     ELEMENT FIXED(31);            /* ELEMENT COUNTER       @Z40LB35*/ 00962000
*   DCL                                                            0325 00963000
*     1 VSDVTOC BASED(VSDSPACE),    /* LSPACE INFO BLOCK     @Z40LB35*/ 00964000
*      2 * CHAR(6),                 /* RESERVED              @Z40LB35*/ 00965000
*      2 VSDFRCYL CHAR(4),          /* TOTAL FREE CYL        @Z40LB35*/ 00966000
*      2 * CHAR(1),                 /* RESERVED              @Z40LB35*/ 00967000
*      2 VSDFRTRK CHAR(4),          /* TOTAL FREE TRACKS     @Z40LB35*/ 00968000
*      2 * CHAR(1),                 /* RESERVED              @Z40LB35*/ 00969000
*      2 VSDFREXT CHAR(4),          /* TOTAL FREE EXTENTS    @Z40LB35*/ 00970000
*      2 * CHAR(1),                 /* RESERVED              @Z40LB35*/ 00971000
*      2 VSDFRCCL CHAR(4);          /* LARGEST CONT CYL      @Z40LB35*/ 00972000
*   DCL                                                            0326 00973000
*     1 VSDSTAT BASED(ADDR(VSDVARY(ELEMENT))) BDY(WORD),           0326 00974000
*      2 VSDCREAT FIXED(31),        /* CREATION DATE         @Z40LB35*/ 00975000
*      2 VSDEXPIR FIXED(31),        /* EXPIRATION DATE       @Z40LB35*/ 00976000
*      2 VSDOWNER CHAR(8),          /* OWNER OF D. S.        @Z40LB35*/ 00977000
*      2 VSDSFLG1 BIT(8),           /* FLAG BYTE             @Z40LB35*/ 00978000
*       3 VSDVTOCC BIT(1),          /* CREATION DATE VTOC    @Z40LB35*/ 00979000
*       3 VSDVTOCE BIT(1),          /* EXPIRATION DATE       @Z40LB35   00980000
*                                      VTOC                  @Z40LB35*/ 00981000
*       3 VSDVSAMC BIT(1),          /* CREATION DATE VSAM    @Z40LB35*/ 00982000
*       3 VSDVSAME BIT(1),          /* EXPIRATION DATE       @Z40LB35   00983000
*                                      VSAM                  @Z40LB35*/ 00984000
*       3 VSDCATLG BIT(1),          /* DSN IS CATALOGED      @Z40LB35*/ 00985000
*       3 VSDCVSAM BIT(1),          /* CATLG IN VSAM         @Z40LB35*/ 00986000
*       3 * BIT(2),                 /* RESERVED              @Z40LB35*/ 00987000
*      2 VSDFLG2 BIT(8),            /* FLAG BYTE             @Z40LB35*/ 00988000
*       3 VSDPWR BIT(1),            /* READ PROTECTED        @Z40LB35*/ 00989000
*       3 VSDPWW BIT(1),            /* WRITE PROTECTED       @Z40LB35*/ 00990000
*       3 VSDPROT BIT(1),           /* DSN IS PROTECTED      @Z40LB35*/ 00991000
*       3 VSDERROR BIT(1),          /* CATALOG ERROR         @Z40LB35*/ 00992000
*       3 * BIT(4),                 /* RESERVED              @Z40LB35*/ 00993000
*                                                                  0326 00994000
*     /***************************************************************/ 00995000
*     /*                                                             */ 00996000
*     /* THE FOLLOWING PORTION IS THE CALLERS WORK AREA      @Z40LB35*/ 00997000
*     /*                                                             */ 00998000
*     /***************************************************************/ 00999000
*                                                                  0326 01000000
*      2 VSDCRE CHAR(2),            /* CREATION DATE         @Z40LB35*/ 01001000
*      2 VSDEXP CHAR(2),            /* EXPIRATION DATE       @Z40LB35*/ 01002000
*      2 VSDCAT CHAR(3),            /* CATALOG INFO          @Z40LB35*/ 01003000
*      2 VSDPRTC CHAR(3);           /* PROTECTION INFO       @Z40LB35*/ 01004000
*   DCL                                                            0327 01005000
*     1 VSDSCR BASED(ADDR(VSDVARY(ELEMENT))) BDY(WORD),            0327 01006000
*      2 VSDACBPT PTR(31),          /* ACB PTR TO VSAM CAT   @Z40LB35*/ 01007000
*      2 VSDSCRFL BIT(8),           /* FLAG BYTE             @Z40LB35*/ 01008000
*       3 VSDCATLC BIT(1),          /* DATA SET IN CATLG     @Z40LB35*/ 01009000
*       3 VSDVSAM BIT(1),           /* DSN IN VSAM CATLG     @Z40LB35*/ 01010000
*       3 * BIT(6),                 /* RESERVED              @Z40LB35*/ 01011000
*      2 * CHAR(3);                 /* RESERVED              @Z40LB35*/ 01012000
*   DCL                                                            0328 01013000
*     1 VSDUSAGE BASED(ADDR(VSDVARY(ELEMENT))) BDY(WORD),          0328 01014000
*      2 VSDTRKS FIXED(15),         /* TRACKS ALLOCATED      @Z40LB35*/ 01015000
*      2 VSDFTRK FIXED(15),         /* TRACKS FREE           @Z40LB35*/ 01016000
*      2 VSDSECAL FIXED(31),        /* SECONDARY ALLOC       @Z40LB35*/ 01017000
*      2 VSDEXTS FIXED(8),          /* NUMBER EXTENTS        @Z40LB35*/ 01018000
*      2 VSDDORG BIT(8),            /* FLAG BYTE             @Z40LB35*/ 01019000
*       3 VSDOPO BIT(1),            /* PARTITIONED ORG       @Z40LB35*/ 01020000
*       3 VSDOPS BIT(1),            /* PHYSICAL SEQUENTIAL   @Z40LB35*/ 01021000
*       3 VSDOUN BIT(1),            /* UNKNOWN ORG           @Z40LB35*/ 01022000
*       3 VSDODA BIT(1),            /* DIRECT ACCESS ORG     @Z40LB35*/ 01023000
*       3 VSDOIS BIT(1),            /* INDEX SEQ ORG         @Z40LB35*/ 01024000
*       3 VSDOU BIT(1),             /* UNMOVEABLE            @Z40LB35*/ 01025000
*       3 * BIT(2),                 /* RESERVED              @Z40LB35*/ 01026000
*      2 VSDALLOC BIT(8),           /* FLAG BYTE             @Z40LB35*/ 01027000
*       3 VSDACYL BIT(1),           /* CYLINDER ALLOC        @Z40LB35*/ 01028000
*       3 VSDATRK BIT(1),           /* TRACK ALLOC           @Z40LB35*/ 01029000
*       3 VSDABLK BIT(1),           /* BLOCK ALLOC           @Z40LB35*/ 01030000
*       3 VSDABSTR BIT(1),          /* ABSOLUTE TRACKS       @Z40LB35*/ 01031000
*       3 * BIT(4),                 /* RESERVED              @Z40LB35*/ 01032000
*      2 VSDUSEF BIT(8),            /* FLAG BYTE             @Z40LB35*/ 01033000
*       3 VSDCALFR BIT(1),          /* UNABLE CAL. SPACE     @Z40LB35*/ 01034000
*       3 * BIT(7),                 /* RESERVED              @Z40LB35*/ 01035000
*                                                                  0328 01036000
*     /***************************************************************/ 01037000
*     /*                                                             */ 01038000
*     /* THE FOLLOWING PORTION IS THE CALLERS WORK AREA      @Z40LB35*/ 01039000
*     /*                                                             */ 01040000
*     /***************************************************************/ 01041000
*                                                                  0328 01042000
*      2 VSDSCAL CHAR(4),           /* SECONDARY ALLOC       @Z40LB35*/ 01043000
*      2 VSDDSORG CHAR(3),          /* DSORG                 @Z40LB35*/ 01044000
*       3 * CHAR(2),                /* RESERVED              @Z40LB35*/ 01045000
*       3 VSDDSOR3 CHAR(1),         /* DSORG INFO            @Z40LB35*/ 01046000
*      2 VSDALLC CHAR(5),           /* TOTAL TRKS ALLOC      @Z40LB35*/ 01047000
*      2 VSDFREE CHAR(4);           /* FREE TRACKS           @Z40LB35*/ 01048000
*   DCL                                                            0329 01049000
*     1 VSDBLOCK BDY(WORD) BASED,                                  0329 01050000
*      2 VSDELEM FIXED(31),         /* NUMBER DSN'S          @Z40LB35*/ 01051000
*      2 VSDVTOCS FIXED(31),        /* NUMBER TRKS IN VTOC   @Z40LB35*/ 01052000
*      2 VSDFMT0 FIXED(31),         /* NUMBER FMT0 IN VTOC   @Z40LB35*/ 01053000
*      2 VSDSPACE PTR(31),          /* PTR TO LSPACE INFO    @Z40LB35*/ 01054000
*      2 VSDARRAY(*) BDY(WORD),                                    0329 01055000
*       3 VSDVOLCT FIXED(31),       /* VOLUME COUNT          @Z40LB35*/ 01056000
*       3 VSDDSN CHAR(44),          /* DSN                   @Z40LB35*/ 01057000
*       3 VSDVARY CHAR(MAX(LENGTH(VSDSTAT),LENGTH(VSDSCR),LENGTH(  0329 01058000
*             VSDUSAGE)));          /*                       @Z40LB35*/ 01059000
*/*********************************************************  @YD00175*/ 01060000
*/*                                                          @YD00175*/ 01061000
*/*   KEYWORD ARGUMENT DECLARATIONS FOR ADAPTORS AND         #Y30LB30*/ 01062000
*/*   VOLUME SERVICES                                        #Y30LB30*/ 01063000
*/*                                                          #Y30LB30*/ 01064000
*/*********************************************************  #Y30LB30*/ 01065000
*                                                                  0330 01066000
*                                   /*                       #Y30LB30*/ 01067000
*   DCL                                                            0330 01068000
*     SECCHECK CHAR(8) INIT('SECCHECK');/*                   #Y30LB30   01069000
*                                      ARGUMENT FOR SECURITY CHECK   */ 01070000
*   DCL                                                            0331 01071000
*     SCRVTOC CHAR(8) INIT('SCRVTOC ');/*                    #Y30LB30   01072000
*                                      ARGUMENT FOR SCRATCH          */ 01073000
*   DCL                                                            0332 01074000
*     GETVTOC CHAR(8) INIT('GETVTOC ');/*                    @Y30LB30   01075000
*                                      ARGURMENT FOR GET VTOC        */ 01076000
*   DCL                                                            0333 01077000
*     PUTVTOC CHAR(8) INIT('PUTVTOC ');/*                    @Y30LB30   01078000
*                                      ARGUMENT FOR PUT VTOC         */ 01079000
*   DCL                                                            0334 01080000
*     RECATLG CHAR(8) INIT('RECATLG ');/*                    @Y30LB30   01081000
*                                      ARGUMENT FOR RECATALOG        */ 01082000
*   DCL                                                            0335 01083000
*     INITVOL CHAR(8) INIT('INITVOL ');/*                    @Y30LB30   01084000
*                                      ARGUMENT FOR INIT VOLUME      */ 01085000
*   DCL                                                            0336 01086000
*     CHECK CHAR(8) INIT('CHECK   ');/*                      @Y30LB30   01087000
*                                      ARGUMENT FOR CHECK UCB        */ 01088000
*   DCL                                                            0337 01089000
*     POSTUCB CHAR(8) INIT('POSTUCB ');/*                    @Y30LB30   01090000
*                                      ARGUMENT FOR POST UCB         */ 01091000
*   DCL                                                            0338 01092000
*     GET CHAR(8) INIT('GET     '); /*                       @Y30LB30   01093000
*                                      ARGUMENT FOR GET EXCP RECORD  */ 01094000
*   DCL                                                            0339 01095000
*     PUT CHAR(8) INIT('PUT     '); /*                       @Y30LB30   01096000
*                                      ARGUMENT FOR PUT EXCP RECORD  */ 01097000
*   DCL                                                            0340 01098000
*     CLOSE CHAR(8) INIT('CLOSE   ');/*                      @Y30LB30   01099000
*                                      ARGUMENT FOR CLOSE EXCP DCB   */ 01100000
*   DCL                                                            0341 01101000
*     OPEN CHAR(8) INIT('OPEN    ');/*                       @Y30LB30   01102000
*                                      ARGUMENT FOR OPEN EXCP DCB    */ 01103000
*   DCL                                                            0342 01104000
*     RVOPENR CHAR(8) INIT('OPENR   ');/*                    @ZA11014*/ 01105000
*   DCL                                                            0343 01106000
*     RVRDCNT CHAR(8) INIT('READCNT ');/*                    @ZA11014*/ 01107000
*   DCL                                                            0344 01108000
*     RVREADKD CHAR(8) INIT('READKD  ');/*                   @ZA11014*/ 01109000
*   DCL                                                            0345 01110000
*     RVSPACCR CHAR(8) INIT('SPACCR  ');/*                   @ZA11014*/ 01111000
*   DCL                                                            0346 01112000
*     RVFWRITE CHAR(8) INIT('FWRITE  ');/*                   @ZA11014*/ 01113000
*   DCL                                                            0347 01114000
*     RVWRITER CHAR(8) INIT('WRITEREC');/*                   @ZA11014*/ 01115000
*   DCL                                                            0348 01116000
*     PUTLABEL CHAR(8) INIT('PUTLABEL');/*                   @Y30LB30   01117000
*                                      PUTLABEL VS02 REQUEST         */ 01118000
*   DCL                                                            0349 01119000
*     GETLABEL CHAR(8) INIT('GETLABEL');/*                   @Y30LB30   01120000
*                                      GETLABEL VS02 REQUEST         */ 01121000
*   DCL                                                            0350 01122000
*     CANCEL CHAR(8) INIT('CANCEL  ');/*                     @Y30LB37   01123000
*                                      CANCEL REQUEST FOR USTAE      */ 01124000
*   DCL                                                            0351 01125000
*     SET CHAR(8) INIT('SET     '); /*                       @Y30LB37   01126000
*                                      SET REQUEST FOR USTAE         */ 01127000
*   DCL                                                            0352 01128000
*     SELECTX CHAR(8) INIT('SELECTX ');/*                    @YD00175   01129000
*                                      SELECT REQUEST FOR UMSSUNIT   */ 01130000
*   DCL                                                            0353 01131000
*     CHANGEX CHAR(8) INIT('CHANGEX ');/*                    @YD00175   01132000
*                                      CHANGE REQUEST FOR UMSSUNIT   */ 01133000
*   DCL                                                            0354 01134000
*     SELECTDD CHAR(8) INIT('SELECTDD');/*                   @Z40LB37   01135000
*                                      SELECTDD REQUEST      @Z40LB37   01136000
*                                      FOR UMSSUNIT          @Z40LB37*/ 01137000
*   DCL                                                            0355 01138000
*     SELECTDS CHAR(8) INIT('SELECTDS');/*                   @Z40LB37   01139000
*                                      SELECTDS REQUEST      @Z40LB37   01140000
*                                      FOR IDCVS03           @Z40LB37*/ 01141000
*/*                                                          @Y40LB63*/ 01142000
*/*********************************************************  @Y40LB63*/ 01143000
*/*                                                          @Y40LB63*/ 01144000
*/*   KEYWORD ARGUMENT DECLARATIONS FOR USSC MACRO FOR       @Y40LB63*/ 01145000
*/*   MSS RECOVERY                                           @Y40LB63*/ 01146000
*/*                                                          @Y40LB63*/ 01147000
*/*********************************************************  @Y40LB63*/ 01148000
*                                                                  0356 01149000
*   DCL                                                            0356 01150000
*     TBLREST CHAR(8) INIT('TBLREST ');/*                    @Y40LB63   01151000
*                                      COPY TABLES FOR       @Y40LB63   01152000
*                                      INTERNAL TABLE        @Y40LB63   01153000
*                                      RESTORE               @Y40LB63*/ 01154000
*   DCL                                                            0357 01155000
*     NULLIFYC CHAR(8) INIT('NULLIFYC');/*                   @Y40LB63   01156000
*                                      NULLIFYC ORDER WHICH        0357 01157000
*                                      ELEMINATES ALL TRACE OF ACTIVE   01158000
*                                      OR INACTIVE VOLUME OR A     0357 01159000
*                                      SCRATCH CART                  */ 01160000
*   DCL                                                            0358 01161000
*     RDMSC CHAR(8) INIT('RDMSC   ');/*                      @Y40LB63   01162000
*                                      QUERY ORDER TO READ MSC     0358 01163000
*                                      STORAGE               @Y40LB63*/ 01164000
*   DCL                                                            0359 01165000
*     RDMSCTBL CHAR(8) INIT('RDMSCTBL');/*                   @Y40LB63   01166000
*                                      QUERY ORDER TO READ MSC TABLES   01167000
*                                                            @Y40LB63*/ 01168000
*   DCL                                                            0360 01169000
*     RDCARTLB CHAR(8) INIT('RDCARTLB');/*                   @Y40LB63   01170000
*                                      QUERY ORDER TO READ A       0360 01171000
*                                      CARTRIDGE LABEL       @Y40LB63*/ 01172000
*   DCL                                                            0361 01173000
*     AUDITCEL CHAR(8) INIT('AUDITCEL');/*                   @Y40LB63   01174000
*                                      QUERY ORDER TO DO A CELL AUDIT   01175000
*                                      OF THE MSF            @Y40LB63*/ 01176000
*   DCL                                                            0362 01177000
*     RDSTGAD CHAR(8) INIT('RDSTGAD ');/*                    @Y40LB63   01178000
*                                      QUERY ORDER TO READ STAG- ING    01179000
*                                      ADAPTER STORAGE       @Y40LB63   01180000
*                                                            @Y30LB30*/ 01181000
*                                                                  0363 01182000
*/********************************************************************/ 01183000
*/*                                                                  */ 01184000
*/*   MACRO NAME = IDAAMDSB                                          */ 01185000
*/*                                                                  */ 01186000
*/*   DESCRIPTIVE NAME =DATA SET CHARACTERISTICS                     */ 01187000
*/*              AND STATISTICS BLOCK                                */ 01188000
*/*                                                                  */ 01189000
*/*   FUNCTION = CONTAINS DATA SET CHARACTERISTICS AND STATISTICS    */ 01190000
*/*                                                                  */ 01191000
*/*   CONTROL BLOCK STRUCTURE = THE IDAAMDSB IS POINTED TO BY IDAAMB */ 01192000
*/*                                                                  */ 01193000
*/*   INCLUDED MACROS = NONE                                         */ 01194000
*/*                                                                  */ 01195000
*/*   METHOD OF ACCESS = PL/S - NO DECLARES NECESSARY                */ 01196000
*/*                                                                  */ 01197000
*/*   CREATED BY = VSAM OPEN                                         */ 01198000
*/*                                                                  */ 01199000
*/*   STATUS = VS/1 RELEASE 4  (CHANGE FLAG @X04SVXX)                */ 01200000
*/*                                                                  */ 01201000
*/*   DATE OF LAST CHANGE = 8 AUG 74                                 */ 01202000
*/*                                                                  */ 01203000
*/********************************************************************/ 01204000
*                                                                  0363 01205000
*   DCL                                                            0363 01206000
*     1 IDAAMDSB BASED,             /* DATA SET CHAR./STATISTICS   0363 01207000
*                                      BLOCK                         */ 01208000
*      2 AMDSBID CHAR(1),           /* CONTROL BLOCK ID              */ 01209000
*      2 AMDATTR CHAR(1),           /* ATTRIBUTES                    */ 01210000
*       3 AMDDST BIT(1),            /* KEY, CHRONOLOGIC              */ 01211000
*       3 AMDWCK BIT(1),            /* WRITE CHECK                   */ 01212000
*       3 AMDSDT BIT(1),            /* SEQ SET WITH DATA             */ 01213000
*       3 AMDREPL BIT(1),           /* REPLICATION                   */ 01214000
*       3 AMDORDER BIT(1),          /* USE VOLS IN LIST ORDER        */ 01215000
*       3 AMDRANGE BIT(1),          /* KEY RANGE DATA SET            */ 01216000
*       3 AMDRRDS BIT(1),           /* RELATIVE RECORD DATA SET    0363 01217000
*                                                            @X04SVLC*/ 01218000
*       3 AMDSPAN BIT(1),           /* SPANNED RECORDS ARE ALLOWED 0363 01219000
*                                                            @X04SVLC*/ 01220000
*      2 AMDLEN FIXED(15),          /* LENGTH OF AMDSB               */ 01221000
*      2 AMDNEST FIXED(15),         /* NO OF ENTRIES IN IDX SECTN    */ 01222000
*       3 AMDAXRKP FIXED(15),       /* RELATIVE KEY POSITION OF    0363 01223000
*                                      ALTERNATE KEY         @X04SVLC*/ 01224000
*      2 AMDRKP FIXED(15),          /* RELATIVE KEY POSITION         */ 01225000
*      2 AMDKEYLN FIXED(15),        /* KEY LENGTH                    */ 01226000
*      2 AMDPCTCA PTR(8),           /* % FREE CI IN CA               */ 01227000
*      2 AMDPCTCI PTR(8),           /* % FREE BYTES IN CI            */ 01228000
*      2 AMDCIPCA FIXED(15),        /* TOTAL NO. OF CIS PER CA       */ 01229000
*      2 AMDFSCA FIXED(15),         /* NO OF FREE CIS PER CA         */ 01230000
*      2 AMDFSCI FIXED(31),         /* NO OF FREE BYTES PER CI       */ 01231000
*      2 AMDCINV FIXED(31),         /* CONTROL INTERVAL SIZE         */ 01232000
*      2 AMDLRECL FIXED(31),        /* MAXIMUM RECORD SIZE           */ 01233000
*      2 AMDHLRBA FIXED(32),        /* RBA OF HIGH LEVEL IDX REC     */ 01234000
*       3 AMDNSLOT FIXED(31),       /* NO. OF RECORD SLOTS PER CI  0363 01235000
*                                                            @X04SVLC*/ 01236000
*      2 AMDSSRBA FIXED(32),        /* RBA OF FIRST SEQ SET REC      */ 01237000
*       3 AMDMAXRR FIXED(31),       /* MAX RELATIVE RECORD NUMBER  0363 01238000
*                                                            @X04SVLC*/ 01239000
*      2 AMDPARDB PTR(31),          /* PTR TO FIRST ARDB             */ 01240000
*      2 AMDATTR3 BIT(8),           /* ATTRIBUTES            @X04SVLC*/ 01241000
*       3 AMDUNQ BIT(1),            /* ON=NON-UNIQUE KEYS    @X04SVLC   01242000
*                                      OFF=UNIQUE KEYS       @X04SVLC*/ 01243000
*       3 AMDFAULT BIT(1),          /* ON=CYLINDER FAULT ON SS1    0363 01244000
*                                      OFF=STAGE THE DATA SET      0363 01245000
*                                      (DEFAULT)             @X04SVLC*/ 01246000
*       3 AMDBIND BIT(1),           /* ON=BIND THE DATA SET ON SS1 0363 01247000
*                                      OFF=DO NOT BIND (DEFAULT)   0363 01248000
*                                                            @X04SVLC*/ 01249000
*       3 AMDWAIT BIT(1),           /* ON=WAIT ON A RELINQUISH OFF=DO   01250000
*                                      NOT WAIT (DEFAULT)    @X04SVLC*/ 01251000
*       3 AMDLM BIT(1),             /* ON=DATA SET LOADED OFF=LOAD 0363 01252000
*                                      MODE OR NOT LOADED    @X04SVLC*/ 01253000
*       3 * BIT(3),                 /* UNUSED                @X04SVLC*/ 01254000
*      2 * CHAR(7),                 /* UNUSED                @X04SVLC*/ 01255000
*      2 AMDSTAT BDY(WORD),         /* STATISTICS            @X04SVLC*/ 01256000
*       3 AMDSTSP CHAR(8),          /* SYSTEM TIME STAMP             */ 01257000
*       3 AMDNIL FIXED(15),         /* NUMBER INDEX LEVELS           */ 01258000
*       3 AMDNEXT FIXED(15),        /* NUMBER OF EXTENTS             */ 01259000
*       3 AMDNLR FIXED(31),         /* NUMBER LOGICAL RECORDS        */ 01260000
*       3 AMDDELR FIXED(31),        /* NUMBER DELETED RECORDS        */ 01261000
*       3 AMDIREC FIXED(31),        /* NUMBER INSERTED RECORDS       */ 01262000
*       3 AMDUPR FIXED(31),         /* NUMBER UPDATED RECORDS        */ 01263000
*       3 AMDRETR FIXED(31),        /* NUMBER RETRIEVED RECORDS      */ 01264000
*       3 AMDASPA FIXED(31),        /* BYTES OF FREE SPACE IN DS     */ 01265000
*       3 AMDNCIS FIXED(31),        /* NUMBER OF CI SPLITS           */ 01266000
*       3 AMDNCAS FIXED(31),        /* NUMBER OF CA SPLITS           */ 01267000
*       3 AMDEXCP FIXED(31);        /* NUMBER OF EXCPS               */ 01268000
*   DCL                                                            0364 01269000
*     1 IFGACB BASED,               /* LEVEL ONE DECLARE             */ 01270000
*      2 ACBCOMN,                   /* ACB COMMON SECTION X03004     */ 01271000
*       3 ACBID PTR(8),             /* ACB IDENTIFIER                */ 01272000
*       3 ACBSTYP PTR(8),           /* ACB SUBTYPE                   */ 01273000
*       3 ACBLENG FIXED(15),        /* ACB LENGTH IN BYTES           */ 01274000
*        4 ACBLENG2 FIXED(15),      /* ACB LENGTH IN BYTES           */ 01275000
*         5 ACBLEN2 FIXED(15),      /* ACB LENGTH IN BYTES X03004    */ 01276000
*       3 ACBAMBL PTR(31),          /* AMB LIST ADDRESS              */ 01277000
*        4 ACBJWA PTR(31),          /* JES WORKAREA ADDRESS          */ 01278000
*         5 ACBIBCT PTR(31),        /* IBCT ADDRESS                  */ 01279000
*       3 ACBINRTN PTR(31),         /* INTERFACE ROUTINE ADDRESS     */ 01280000
*       3 ACBMACRF BIT(16),         /* MACRF FLAGS                   */ 01281000
*        4 ACBMACR1 BIT(8),         /* MACRF FIRST BYTE              */ 01282000
*         5 ACBKEY BIT(1),          /* ACCESS DATA VIA INDEX         */ 01283000
*         5 ACBADR BIT(1),          /* ACCESS WITHOUT INDEX          */ 01284000
*          6 ACBADD BIT(1),         /* SAME AS ABOVE                 */ 01285000
*         5 ACBCNV BIT(1),          /* CONTROL INTERVAL PROCESSING   */ 01286000
*          6 ACBBLK BIT(1),         /* SAME AS ABOVE                 */ 01287000
*         5 ACBSEQ BIT(1),          /* SEQUENTIAL PROCESSING         */ 01288000
*         5 ACBDIR BIT(1),          /* DIRECT PROCESSING             */ 01289000
*         5 ACBIN BIT(1),           /* GET, READ                     */ 01290000
*         5 ACBOUT BIT(1),          /* PUT, WRITE                    */ 01291000
*         5 ACBUBF BIT(1),          /* USER BUFFERS                  */ 01292000
*        4 ACBMACR2 BIT(8),         /* MACRF SECOND BYTE             */ 01293000
*         5 * BIT(3),               /* RESERVED              @X04SVHS*/ 01294000
*         5 ACBSKP BIT(1),          /* SKIP SEQUENTIAL PROCESSING    */ 01295000
*         5 ACBLOGON BIT(1),        /* LOGON INDICATOR(VTAM) X03004  */ 01296000
*         5 ACBRST BIT(1),          /* SET DATA SET TO EMPTY STATE 0364 01297000
*                                                            @X04SVHS*/ 01298000
*         5 ACBDSN BIT(1),          /* BASIC SUBTASK SHARED CONTROL     01299000
*                                      BLOCK CONNECTION ON COMMON  0364 01300000
*                                      DSNAMES               @X04SVHS*/ 01301000
*         5 ACBAIX BIT(1),          /* ENTITY TO BE PROCESSED IS AIX    01302000
*                                      OF THE PATH SPECIFIED IN THE     01303000
*                                      GIVEN DDNAME          @X04SVHS*/ 01304000
*       3 ACBBSTNO PTR(8),          /* NO OF CONCURRENT STRINGS FOR     01305000
*                                      AIX PATH              @X04SVHS*/ 01306000
*       3 ACBSTRNO PTR(8),          /* NUMBER OF STRINGS     @X04SVHS*/ 01307000
*       3 ACBBUFND FIXED(15),       /* NUMBER OF BUFFERS REQUESTED 0364 01308000
*                                      FOR DATA                      */ 01309000
*       3 ACBBUFNI FIXED(15),       /* NUMBER OF BUFFERS REQUESTED 0364 01310000
*                                      FOR INDEX                     */ 01311000
*       3 ACBBUFPL PTR(31),         /* JES BUFFER POOL ADDR          */ 01312000
*        4 ACBMACR3 BIT(8),         /* MACRF THIRD BYTE      @X04SVHS*/ 01313000
*         5 * BIT(1),               /* RESERVED              @X04SVHS*/ 01314000
*         5 ACBLSR BIT(1),          /* LOCAL SHARED RESOURCE @X04SVHS*/ 01315000
*         5 ACBGSR BIT(1),          /* GLOBAL SHARED RESOURCE      0364 01316000
*                                                            @X04SVHS*/ 01317000
*         5 ACBICI BIT(1),          /* IMPROVED CONTROL INTERVAL   0364 01318000
*                                      PROCESSING            @X04SVHS*/ 01319000
*         5 ACBDFR BIT(1),          /* DEFER WRITES          @X04SVHS*/ 01320000
*         5 ACBSIS BIT(1),          /* SEQUENTIAL INSERT STRATEGY  0364 01321000
*                                                            @X04SVHS*/ 01322000
*         5 ACBNCFX BIT(1),         /* NFX=0/CFX=1           @X04SVHS*/ 01323000
*         5 * BIT(1),               /* RESERVED FOR VSAM             */ 01324000
*        4 ACBMACR4 BIT(8),         /* RESERVED FOR VSAM             */ 01325000
*        4 ACBJBUF FIXED(15),       /* NUMBER OF BUFFERS REQUESTED 0364 01326000
*                                      FOR JOURNAL                   */ 01327000
*       3 ACBRECFM BIT(8),          /* RECORD FORMAT                 */ 01328000
*        4 ACBRECAF BIT(1),         /* JES FORMAT                    */ 01329000
*       3 ACBCCTYP BIT(8),          /* CONTROL CHARACTER             */ 01330000
*        4 * BIT(4),                /* RESERVED                      */ 01331000
*        4 ACBASA BIT(4),           /* CONTROL CHARACTER TYPE        */ 01332000
*       3 ACBOPT BIT(16),           /* NON-USER OPTIONS              */ 01333000
*        4 ACBDSORG BIT(16),        /* MATCH ACBDORGA WITH DCBDSORG  */ 01334000
*         5 ACBCROPS BIT(2),        /* CHECKPOINT/RESTART OPTIONS    */ 01335000
*          6 ACBCRNCK BIT(1),       /* NO CHECK FOR MODIFY           */ 01336000
*          6 ACBCRNRE BIT(1),       /* NO DATA ERASE OR REPOSITION   */ 01337000
*         5 * BIT(10),              /* RESERVED                      */ 01338000
*         5 ACBDORGA BIT(1),        /* ACB INDICATOR                 */ 01339000
*         5 * BIT(3),               /* RESERVED                      */ 01340000
*       3 ACBMSGAR PTR(31),         /* MSG AREA              @X04SVHS*/ 01341000
*       3 ACBPASSW PTR(31),         /* PASSWORD ADDRESS              */ 01342000
*       3 ACBEXLST PTR(31),         /* USER EXIT LIST ADDR           */ 01343000
*        4 ACBUEL PTR(31),          /* SAME AS ABOVE                 */ 01344000
*/*  BEFORE OPEN                                                     */ 01345000
*/*  (FOR VTAM, ACBDDNM INITIALIZED TO X'FF000000000000')     X03004 */ 01346000
*                                                                  0364 01347000
*       3 ACBDDNM CHAR(8) BDY(WORD),/* DDNAME                        */ 01348000
*/*  AFTER OPEN                                                      */ 01349000
*                                                                  0364 01350000
*        4 ACBTIOT FIXED(15),       /* TIOT OFFSET                   */ 01351000
*        4 ACBINFL PTR(8),          /* INDICATOR FLAGS               */ 01352000
*        4 ACBAMETH PTR(8),         /* ACCESS METHOD TYPE            */ 01353000
*         5 ACBAM PTR(8),           /* ACCESS METHOD TYPE X03004     */ 01354000
*        4 ACBERFL BIT(8),          /* ERROR FLAGS                   */ 01355000
*        4 ACBDEB PTR(24),          /* DEB ADDRESS                   */ 01356000
*/*  NOT MOVED BY OPEN                                               */ 01357000
*                                                                  0364 01358000
*       3 ACBOFLGS BIT(8),          /* OPEN / CLOSE FLAGS            */ 01359000
*        4 * BIT(2),                /* RESERVED                      */ 01360000
*        4 ACBEOV BIT(1),           /* EOV CONCATENATION             */ 01361000
*        4 ACBOPEN BIT(1),          /* ACB IS OPEN                   */ 01362000
*        4 ACBDSERR BIT(1),         /* NO FURTHER REQUESTS POSSIBLE     01363000
*                                      AGAINST ACB                   */ 01364000
*        4 * BIT(1),                /* RESERVED                      */ 01365000
*        4 ACBEXFG BIT(1),          /* USER EXIT FLAG                */ 01366000
*         5 ACBLOCK BIT(1),         /* ACB IS LOCKED X03004          */ 01367000
*        4 ACBIOSFG BIT(1),         /* OPEN/CLOSE IN CONTROL         */ 01368000
*         5 ACBBUSY BIT(1),         /* ACB IS BUSY X03004            */ 01369000
*       3 ACBERFLG BIT(8),          /* ERROR FLAGS                   */ 01370000
*       3 ACBINFLG BIT(16),         /* INDICATOR FLAGS               */ 01371000
*        4 * BIT(1),                /* RESERVED FOR EXCP             */ 01372000
*        4 ACBJEPS BIT(1),          /* JEPS PROCESSING               */ 01373000
*        4 ACBIJRQE BIT(1),         /* RQE BEING HELD BY JAM         */ 01374000
*        4 ACBCAT BIT(1),           /* ACB FOR VSAM CATALOG          */ 01375000
*        4 ACBSCRA BIT(1),          /* CATALOG CONTROL BLOCK SYSTEM     01376000
*                                      AREA                  @X04SVHS*/ 01377000
*        4 ACBUCRA BIT(1),          /* CATALOG CONTROL BLOCK USER  0364 01378000
*                                      AREA                  @X04SVHS*/ 01379000
*        4 ACBVVIC BIT(1),          /* DATA SET BEING OPENED IS    0364 01380000
*                                      SYS1.VVIC             @X04SVHS*/ 01381000
*       3 ACBUJFCB PTR(31),         /* USER JFCB ADDRESS             */ 01382000
*        4 ACBOPTN BIT(8),          /* JAM UCS INDICATOR             */ 01383000
*        4 * PTR(24),               /* RESERVED                      */ 01384000
*       3 ACBBUFSP FIXED(31),       /* SIZE AVAILABLE FOR BUFFERS    */ 01385000
*       3 ACBBLKSZ FIXED(15),       /* BLOCKSIZE                     */ 01386000
*        4 ACBMSGLN FIXED(15),      /* LENGTH OF MSG AREA    @X04SVHS*/ 01387000
*       3 ACBLRECL FIXED(15),       /* LOGICAL RECORD LENGTH         */ 01388000
*       3 ACBUAPTR PTR(31),         /* USER WORKAREA ADDR CAXWA    0364 01389000
*                                      ADDRESS FOR CATALOG OPEN      */ 01390000
*       3 ACBCBMWA PTR(31),         /* CBM WORK AREA ADDRESS         */ 01391000
*       3 ACBAPID PTR(31);          /* APPLICATION ID ADDRESS X03004 */ 01392000
*                                                                  0365 01393000
*/********************************************************************/ 01394000
*/*                                                                  */ 01395000
*/*   MACRO NAME = IDAAMBL                                           */ 01396000
*/*                                                                  */ 01397000
*/*   DESCRIPTIVE NAME = ACCESS METHOD BLOCK LIST.                   */ 01398000
*/*                                                                  */ 01399000
*/*   FUNCTION = THE AMBL DESCRIBES A VSAM CLUSTER AND POINTS TO THE */ 01400000
*/*              CLUSTER'S DATA SET AND INDEX AMB'S. WHEN THE CLUSTER*/ 01401000
*/*              IS OPENED, AN AMBL IS BUILT TO DESCRIBE THE CLUSTER.*/ 01402000
*/*              IF THE CLUSTER IS SHARED WITH OTHER USERS, THE      */ 01403000
*/*              EXISTING AMB'S ADDRESSES ARE PUT INTO THE AMBL.     */ 01404000
*/*                                                                  */ 01405000
*/*   CONTROL BLOCK STRUCTURE = THE AMBL IS POINTED TO BY AN ACB     */ 01406000
*/*                             (ACBAMBL).                           */ 01407000
*/*                                                                  */ 01408000
*/*   INCLUDED MACROS = NONE                                         */ 01409000
*/*                                                                  */ 01410000
*/*   METHOD OF ACCESS = PL/S - RESPECIFY IDAAMBL BASED.             */ 01411000
*/*                                                                  */ 01412000
*/*   CREATED BY: VSAM OPEN MODULE IDA0192F.                         */ 01413000
*/*                                                                  */ 01414000
*/*   STATUS = VS1 RELEASE 4, VS2 RELEASE 3.  (CHANGE FLAGS @X04SVXX)*/ 01415000
*/*                                                                  */ 01416000
*/*   DATE OF LAST CHANGE = 22 JANUARY 75                            */ 01417000
*/*                                                                  */ 01418000
*/********************************************************************/ 01419000
*                                                                  0365 01420000
*   DCL                                                            0365 01421000
*     1 IDAAMBL BASED,                                             0365 01422000
*      2 AMBLPCHN PTR(31),          /* PRIMARY CHAIN POINTER         */ 01423000
*      2 AMBLSCHN PTR(31),          /* SECONDARY CHAIN POINTER       */ 01424000
*      2 AMBLACB PTR(31),           /* POINTER TO ACB                */ 01425000
*      2 AMBLEOV FIXED(31),         /* EOV/RM INTERFACE              */ 01426000
*       3 AMBLEFLG CHAR(1),         /* EOV FLAGS                     */ 01427000
*        4 AMBLWAIT BIT(1),         /* EOV IS WAITING                */ 01428000
*        4 AMBLESET BIT(1),         /* EOV RESET CONTROL BLOCKS.     */ 01429000
*       3 AMBLCOMP CHAR(1),         /* EOV LOCK                      */ 01430000
*       3 * CHAR(2),                /* NOT USED                      */ 01431000
*      2 AMBLDDNM CHAR(8),          /* DDNAME FROM ACB               */ 01432000
*       3 AMBLIDF CHAR(8),          /* CLUSTER ID            @X04SVLC*/ 01433000
*        4 AMBLCACB PTR(31) BDY(BYTE),/* CAT ACB             @X04SVLC*/ 01434000
*        4 AMBLDCI FIXED(24) BDY(BYTE),/* CI NBR             @X04SVLC*/ 01435000
*        4 AMBLQ BIT(8),            /* QUALIFIER             @X04SVLC*/ 01436000
*         5 AMBLDDC BIT(1),         /* DD CONNECT ONLY       @X04SVLC*/ 01437000
*         5 AMBLGSR BIT(1),         /* OPENED FOR GSR        @X04SVLC*/ 01438000
*         5 AMBLLSR BIT(1),         /* OPENED FOR LSR        @X04SVLC*/ 01439000
*         5 AMBLFSTP BIT(1),        /* OPENED FOR FAST PATH  @X04SVLC*/ 01440000
*         5 AMBLUBF BIT(1),         /* OPENED FOR USER BFR   @X04SVLC*/ 01441000
*         5 AMBLKSDS BIT(1),        /* OPENED AS KSDS        @X04SVLC*/ 01442000
*         5 AMBLESDS BIT(1),        /* OPENED AS ESDS        @X04SVLC*/ 01443000
*         5 AMBLDFR BIT(1),         /* OPENED WITH DEFER OPTION    0365 01444000
*                                                            @X04SVLC*/ 01445000
*      2 AMBLXPT PTR(31),           /* PTR FR BASE AMBL TO PATH AMBL    01446000
*                                      & VICE-VERSA          @X04SVLC*/ 01447000
*      2 AMBLVC FIXED(15),          /* VALID AMBL TABLE      @X04SVLC*/ 01448000
*       3 AMBLVRT FIXED(8),         /* RELATIVE VAT          @X04SVLC*/ 01449000
*       3 AMBLENO FIXED(8),         /* OFFSET WITHIN VAT     @X04SVLC*/ 01450000
*      2 AMBLTYPE BIT(8),           /* STRUCTURE TYPE        @X04SVLC*/ 01451000
*       3 AMBLPATH BIT(1),          /* ACB IS FOR PATH       @X04SVLC*/ 01452000
*       3 AMBLUPGR BIT(1),          /* ACB FOR UPGRADE       @X04SVLC*/ 01453000
*       3 AMBLAIX BIT(1),           /* ACB FOR AIX END USE-IMPLIES 0365 01454000
*                                      AMBLBASE ON           @X04SVLC*/ 01455000
*       3 AMBLBASE BIT(1),          /* ACB FOR BASE          @X04SVLC*/ 01456000
*       3 AMBLFIX BIT(1),           /* STRUCTURE FIXED BY OPEN     0365 01457000
*                                                            @X04SVLC*/ 01458000
*       3 * BIT(3),                 /* UNUSED                @X04SVLC*/ 01459000
*      2 * CHAR(1),                 /* UNUSED                @X04SVLC*/ 01460000
*      2 AMBLID CHAR(1),            /* AMBL IDENTIFER                */ 01461000
*      2 AMBLSHAR BIT(8),           /* SHARING INDICATORS            */ 01462000
*       3 AMBLPRIM BIT(1),          /* P-AMBL INDICATOR              */ 01463000
*       3 AMBLCATO BIT(1),          /* CATALOG OPEN IND IS ON        */ 01464000
*       3 AMBLWRIT BIT(1),          /* OUTPUT/UPDATE SPECIFIED       */ 01465000
*       3 * BIT(5),                 /* RESERVED                      */ 01466000
*      2 AMBLLEN PTR(8),            /* AMBL LENGTH                   */ 01467000
*      2 AMBLFLG1 BIT(8),           /* FLAG BYTE ONE                 */ 01468000
*       3 AMBLFULL BIT(1),          /* FULL ACCESS OK                */ 01469000
*       3 AMBLCINV BIT(1),          /* CINV ACCESS OK                */ 01470000
*       3 AMBLUPD BIT(1),           /* UPDATE ACCESS OK              */ 01471000
*       3 AMBLVVIC BIT(1),          /* AMBL FOR VVIC DATA SET      0365 01472000
*                                                            @X04SVRP*/ 01473000
*       3 AMBLSCRA BIT(1),          /* AMBL FOR SYSTEM CATALOG     0365 01474000
*                                      RECOVERY AREA         @X04SVRP*/ 01475000
*       3 AMBLUCRA BIT(1),          /* AMBL FOR USER CATALOG RECOVERY   01476000
*                                      AREA                  @X04SVRP*/ 01477000
*       3 AMBLCAT BIT(1),           /* IND ACB FOR A CATALOG         */ 01478000
*       3 AMBLDUMY BIT(1),          /* DD DUMMY SPECIFIED TO SIMPLIFY   01479000
*                                      TESTING FOR SPECIAL DATA SETS    01480000
*                                      IN EXISTING CODE THE AMBLCAT     01481000
*                                      AMBLVVIC AND AMBLSCRA BITS ARE   01482000
*                                      SET AS FOLLOWS: VVIC SCRA X 0365 01483000
*                                      CAT TYPE OF DATA SET 0 0 X 0     01484000
*                                      CATALOG 1 0 X 1 VVIC 0 1 X 1     01485000
*                                      SCRA                          */ 01486000
*      2 AMBLFLG2 BIT(8),           /* FLAG BYTE TWO                 */ 01487000
*       3 * BIT(3),                 /* RESERVED              @Z30SSDT*/ 01488000
*       3 AMBLSTAG BIT(1),          /* CLUSTER IS STAGED     @X04ACPS*/ 01489000
*       3 * BIT(4),                 /* RESERVED              @X04ACPS*/ 01490000
*      2 AMBLNST CHAR(1),           /* NUMBER OF STRINGS             */ 01491000
*      2 AMBLNUM FIXED(15),         /* NUMBER OF AMB PTRS IN AMBL    */ 01492000
*      2 * CHAR(1),                 /* RESERVED                      */ 01493000
*      2 AMBLNIDS PTR(8),           /* NUMBER IF IDS                 */ 01494000
*      2 AMBLMIDS(5) CHAR(2),       /* IDS OF MODULES LOADED         */ 01495000
*      2 AMBLDTA PTR(31),           /* POINTER TO DATA AMB           */ 01496000
*      2 AMBLIX PTR(31),            /* POINTER TO INDEX AMB          */ 01497000
*      2 AMBLBIB PTR(31),           /* PTR TO BIB            @X04SVLC*/ 01498000
*      2 AMBLCMB PTR(31);           /* PTR TO CMB            @X04SVRP*/ 01499000
*                                                                  0366 01500000
*/********************************************************************/ 01501000
*/*                                                                  */ 01502000
*/*   MACRO NAME = IDAAMB                                            */ 01503000
*/*                                                                  */ 01504000
*/*   DESCRIPTIVE NAME =ACCESS METHOD BLOCK                          */ 01505000
*/*                                                                  */ 01506000
*/*   FUNCTION = DESCRIBES DATA SET ATTRIBUTES AND SUPPLIES          */ 01507000
*/*              IOS COMPATIBLE FIELDS FOR I/O                       */ 01508000
*/*                                                                  */ 01509000
*/*   CONTROL BLOCK STRUCTURE = THE IDAAMB IS POINTED TO BY THE      */ 01510000
*/*              IDAAMBL                                             */ 01511000
*/*                                                                  */ 01512000
*/*   INCLUDED MACROS = NONE                                         */ 01513000
*/*                                                                  */ 01514000
*/*   METHOD OF ACCESS = PL/S - NO DECLARES NECESSARY                */ 01515000
*/*                                                                  */ 01516000
*/*   CREATED BY = VSAM OPEN                                         */ 01517000
*/*                                                                  */ 01518000
*/*   STATUS = VS/1 RELEASE 4  (CHANGE FLAG @X04SVXX)                */ 01519000
*/*               VS/2 RELEASE 3  (CHANGE FLAG @Y30SDXX)             */ 01520000
*/*                                                                  */ 01521000
*/*   DATE OF LAST CHANGE = 8 AUG 74                                 */ 01522000
*/*                                                                  */ 01523000
*/********************************************************************/ 01524000
*                                                                  0366 01525000
*   DCL                                                            0366 01526000
*     1 IDAAMB BASED,               /* AMB                           */ 01527000
*      2 AMBID BIT(8),              /* AMB IDENTIFIER                */ 01528000
*      2 AMBRSC BIT(8),             /* RESOURCE TS BYTE              */ 01529000
*      2 AMBLEN FIXED(15),          /* AMB LENGTH                    */ 01530000
*      2 AMBLINK PTR(31),           /* NEXT AMB                      */ 01531000
*      2 AMBBUFC PTR(31),           /* BUFFER CONTROL                */ 01532000
*      2 AMBPH PTR(31),             /* PLACEHOLDER                   */ 01533000
*      2 AMBCACB PTR(31),           /* PTR TO ACB OF CATALOG USED TO    01534000
*                                      ACCESS OBJECT                 */ 01535000
*      2 AMBDSB PTR(31),            /* AMDSB POINTER                 */ 01536000
*      2 AMBEOVR CHAR(1),           /* EOV REQUEST TYPE - NOT USED IN   01537000
*                                      MVM                   @Y30DSJH*/ 01538000
*       3 AMBFLG0 BIT(8),           /* MVM AMB FLAGS         @Y30DSJH*/ 01539000
*        4 AMBPSDS BIT(1),          /* PAGE SPACE            @Y30DSJH*/ 01540000
*        4 * BIT(7),                /* UNUSED IN MVM         @Y30DSJH*/ 01541000
*      2 AMBFLG1 BIT(8),            /* FLAG BYTE ONE                 */ 01542000
*       3 AMBCREAT BIT(1),          /* ON IF IN CREATE MODE          */ 01543000
*       3 AMBTYPE BIT(1),           /*                               */ 01544000
*       3 AMBMCAT BIT(1),           /* MASTER CATL                   */ 01545000
*       3 AMBPCAT BIT(1),           /* PRIVATE CATL                  */ 01546000
*       3 AMBSPEED BIT(1),          /* CREATE SPEED OPITON           */ 01547000
*       3 AMBUBF BIT(1),            /* USER BUFFERING                */ 01548000
*       3 AMBJRN BIT(1),            /* JOURNAL EXIT PRESENT          */ 01549000
*       3 AMBINBUF BIT(1),          /* SHARED DS--DIRECT REQ BFR   0366 01550000
*                                      INVALIDATION                  */ 01551000
*      2 AMBDSORG BIT(16),          /* DATA SET ORGANIZ.             */ 01552000
*       3 * BIT(12),                /* ALWAYS ZERO                   */ 01553000
*       3 AMBDORGA BIT(1),          /* ACCESS METHOD INDIC           */ 01554000
*       3 * BIT(3),                 /* ALWAYS ZERO                   */ 01555000
*      2 AMBIOBAD PTR(31),          /* IOB ADDR                      */ 01556000
*       3 AMBIOMB PTR(31),          /* IOMB CHAIN IN MVM     @Y30DSJH*/ 01557000
*      2 AMBCDSN CHAR(3),           /* CATALOG DSN                   */ 01558000
*      2 AMBDDSN CHAR(3),           /* DATA DSN                      */ 01559000
*      2 * PTR(16),                 /* RESERVED                      */ 01560000
*      2 AMBTIOT FIXED(15),         /* OFFSET TO TIOT                */ 01561000
*      2 AMBINFL PTR(8),            /* INDICATOR FLAGS               */ 01562000
*       3 * BIT(1),                 /* RESERVED FOR EXCP             */ 01563000
*       3 * BIT(2),                 /* RESERVED                      */ 01564000
*       3 AMBCAT BIT(1),            /* AMB FOR VSAM CATLG            */ 01565000
*       3 AMBSCRA BIT(1),           /* CATALOG CONTROL BLOCK SYSTEM     01566000
*                                      AREA                  @X04SVLC*/ 01567000
*       3 AMBUCRA BIT(1),           /* CATALOG CONTROL BLOCK USER  0366 01568000
*                                      AREA                  @X04SVLC*/ 01569000
*       3 AMBUPX BIT(1),            /* SET ON IF UPGRADE TABLE EXISTS   01570000
*                                                            @X04SVLC*/ 01571000
*      2 AMBAMETH PTR(8),           /* ACCESS METHOD TYPE            */ 01572000
*      2 AMBDEBPT PTR(31),          /* DEB ADDR                      */ 01573000
*       3 AMBIFLGS BIT(8),          /* IOS ERROR FLAGS               */ 01574000
*       3 AMBDEBAD PTR(24),         /* DEB ADDR                      */ 01575000
*      2 AMBOFLGS BIT(8),           /* OPEN FLAGS                    */ 01576000
*       3 * BIT(3),                 /* ALWAYS ZERO                   */ 01577000
*       3 AMBOPEN BIT(1),           /* AMB IS OPEN                   */ 01578000
*       3 * BIT(2),                 /* ALWAYS ZERO                   */ 01579000
*       3 AMBEXFG BIT(1),           /* USER EXIT FLAG                */ 01580000
*       3 AMBBUSY BIT(1),           /* BUSY BIT                      */ 01581000
*      2 AMBFLG2 PTR(8),            /* FLAG BYTE TWO         @X04SVLC*/ 01582000
*       3 AMBPUG BIT(1),            /* AMB PARTICIPATES IN UPGRADE 0366 01583000
*                                                            @X04SVLC*/ 01584000
*      2 AMBRPT FIXED(15),          /*                               */ 01585000
*      2 AMBEDB PTR(31),            /* EDB POINTER                   */ 01586000
*      2 AMBEOVPT PTR(31),          /* PTR TO KEY OR RBA - NOT USED     01587000
*                                      IN MVM                @Y30DSJH*/ 01588000
*       3 AMBAMBXN PTR(31),         /* PTR TO AMB EXTENSION IN MVM 0366 01589000
*                                                            @Y30DSJH*/ 01590000
*      2 AMBWKA PTR(31),            /* WORK AREA PTR                 */ 01591000
*      2 AMBIWA PTR(31),            /* INSERT WORK AREA PTR          */ 01592000
*      2 * PTR(31),                 /* UNUSED                @Z30SSMR*/ 01593000
*      2 AMBPIXP PTR(31),           /* PTR TO PRIME INDEX AMB        */ 01594000
*      2 AMBPAMBL PTR(31),          /* PTR TO PRIMARY AMBL   @X04SVLC*/ 01595000
*      2 AMBUPLH PTR(31),           /* PTR TO UPGRADE PLH    @X04SVLC*/ 01596000
*      2 AMBCSWD1 FIXED(31) BDY(WORD),/* CS WORD 1           @X04SVLC*/ 01597000
*       3 AMBAFLG BIT(8),           /* ADDITIONAL FLAGS      @X04SVLC*/ 01598000
*        4 * BIT(1),                /* UNUSED                @X04SVLC*/ 01599000
*        4 AMBLSR BIT(1),           /* LSR OPTION            @X04SVLC*/ 01600000
*        4 AMBGSR BIT(1),           /* GSR OPTION            @Y30SDLP*/ 01601000
*        4 AMBICI BIT(1),           /* ICIP OPTION           @Y30SDLP*/ 01602000
*        4 AMBDFR BIT(1),           /* DEFER WRITES          @X04SVLC*/ 01603000
*        4 AMBSIS BIT(1),           /* SEQ INSERT STRAT      @X04SVLC*/ 01604000
*        4 AMBCFX BIT(1),           /* FIXED CTRL BLK OPTN   @Y30SDLP*/ 01605000
*        4 * BIT(1),                /* UNUSED                @X04SVLC*/ 01606000
*       3 * FIXED(8),               /* UNUSED                @X04SVLC*/ 01607000
*       3 AMBRDCNT FIXED(15),       /* NBR OF CIS READ FOR THIS AMB -   01608000
*                                      VS1 ONLY              @X04SVLC*/ 01609000
*      2 AMBBM2SH PTR(31),          /* ADDR OF PLH DOING 2ND SEARCH     01610000
*                                      OF SUBPOOL - VS1 ONLY @X04SVLC*/ 01611000
*      2 AMBCPA PTR(31),            /* DB/DC - PTR TO WSHD. NON DB/DC   01612000
*                                      & VS1 - UNUSED. NON DB/DC & 0366 01613000
*                                      VS2 - PTR TO STATIC CPA'S   0366 01614000
*                                                            @Y30DSJH*/ 01615000
*      2 AMBWSHD PTR(31),           /* PTR TO WORK SPACE HDR @X04SVLC*/ 01616000
*      2 AMBEXEX CHAR(8),           /* EXCEPTION EXIT NAME   @X04SVLC*/ 01617000
*      2 AMBSZRD FIXED(15),         /* CP SIZE FOR READ      @X04SVLC*/ 01618000
*      2 AMBSZWR FIXED(15),         /* CP SIZE FOR WRITE     @X04SVLC*/ 01619000
*      2 AMBSZFW FIXED(15),         /* CP SIZE FORMAT WRITE  @X04SVLC*/ 01620000
*      2 AMBSZCP FIXED(15),         /* SIZE FOR CPA BASE     @X04SVLC*/ 01621000
*      2 AMBVIOT PTR(31);           /* POINTER TO IDAVIOT    @X04SVLC*/ 01622000
*   DCL                                                            0367 01623000
*     AMBINDEX BIT(1) CONSTANT('1'B);/* INDEX TYPE AMB               */ 01624000
*   DCL                                                            0368 01625000
*     AMBDATA BIT(1) CONSTANT('0'B);/* DATA TYPE AMB                 */ 01626000
*   DCL                                                            0369 01627000
*     AMBEOVMK BIT(8) CONSTANT('00000001'B);/* MOUNT BY KEY          */ 01628000
*   DCL                                                            0370 01629000
*     AMBEOVMR BIT(8) CONSTANT('10000001'B);/* MOUNT BY RBA          */ 01630000
*   DCL                                                            0371 01631000
*     AMBEOVAK BIT(8) CONSTANT('00000010'B);/* ALLOCATE BY KEY       */ 01632000
*   DCL                                                            0372 01633000
*     AMBEOVAR BIT(8) CONSTANT('10000010'B);/* ALLOCATE BY RBA       */ 01634000
*   DCL                                                            0373 01635000
*     AMBEOVUC BIT(8) CONSTANT('00000100'B);/* UPDATE CATALOG        */ 01636000
*   DCL                                                            0374 01637000
*     AMBEXOFF BIT(1) CONSTANT('1'B);/* AMB NOT LOCKED               */ 01638000
*                                                                  0375 01639000
*/* **************************************************************** */ 01640000
*/*                                                                  */ 01641000
*/*            ***** DATA EXTENT BLOCK *****                         */ 01642000
*/*                                                                  */ 01643000
*/*  OS/VS2 RELEASE 4, 12/05/75, LEVEL=10                            */ 01644000
*/*                                                                  */ 01645000
*/*  METHOD OF ACCESS                                                */ 01646000
*/*      PL/S - DCL (DEBPTR,DEBDAPTR,DEBEXPTR,DEBSBPTR) PTR          */ 01647000
*/*      BAL  - FIVE DSECTS ARE PRODUCED.  USING ON A DSECT NAME     */ 01648000
*/*             GIVES ADDRESSABILITY FOR ALL SYMBOLS WITHIN THAT     */ 01649000
*/*             DSECT.  THE DSECT NAMES AND THE SECTIONS WITHIN EACH */ 01650000
*/*             DSECT ARE                                            */ 01651000
*/*                                                                  */ 01652000
*/*             DEB ***  APPENDAGE VECTOR TABLE SECTION              */ 01653000
*/*                      PREFIX TABLE                                */ 01654000
*/*                      BASIC SECTION                               */ 01655000
*/*                      UNIT RECORD, MAGNETIC TAPE AND              */ 01656000
*/*                        TELECOMMUNICATIONS DEVICES SECTION        */ 01657000
*/*                      3540 ACCESS METHOD DEPENDENT SECTN  @X04AA9A*/ 01658000
*/*                      ISAM DEPENDENT SECTION                      */ 01659000
*/*                      *** POINTERS TO THE DEB IN OTHER CONTROL    */ 01660000
*/*                          BLOCKS SUCH AS DCB POINT TO THE BASIC   */ 01661000
*/*                          SECTION.  USING ON DEBBASIC GIVES       */ 01662000
*/*                          ADDRESSABILITY FOR BASIC SECTION AND    */ 01663000
*/*                          NEXT TWO SECTIONS.  DEBAPPAD IN BASIC   */ 01664000
*/*                          SECTION CONTAINS ADDRESS OF APPENDAGE   */ 01665000
*/*                          VECTOR TABLE (AVT) SECTION.  PREFIX     */ 01666000
*/*                          FOLLOWS AVT SECTION.                    */ 01667000
*/*             DEBDASD  DIRECT ACCESS STORAGE DEVICE SECTION        */ 01668000
*/*             DEBACSMD EXCP, BSAM AND QSAM DEPENDENT SECTION       */ 01669000
*/*                      BPAM DEPENDENT SECTION                      */ 01670000
*/*                      BDAM DEPENDENT SECTION                      */ 01671000
*/*                      BTAM DEPENDENT SECTION                      */ 01672000
*/*                      GAM DEPENDENT SECTION                       */ 01673000
*/*                      ISAM LOAD MODE EXTENSION **                 */ 01674000
*/*                      ISAM SCAN MODE EXTENSION **                 */ 01675000
*/*                      BISAM MODE EXTENSION **                     */ 01676000
*/*                      ** FOR THESE 3 EXTENSIONS, LOAD REGISTER    */ 01677000
*/*                         FROM DEBEXPT IN ISAM DEPENDENT SECTION   */ 01678000
*/*                         TO SET REGISTER FOR USING.               */ 01679000
*/*             DEBSUBNM SUBROUTINE NAME SECTION                     */ 01680000
*/*             DEBXTN   EXTENSION FOR OS/VS2                        */ 01681000
*/*                                                                  */ 01682000
*/*             WHEN LISTING IS SUPPRESSED, YOU CAN DETERMINE WHICH  */ 01683000
*/*             DSECT A SYNBOL IS IN BY USING THE STARTMENT NUMBER   */ 01684000
*/*             IN THE DEFN COLUMN IN THE CROSS REFERENCE LISTING.   */ 01685000
*/*             FOR EXAMPLE, ANY SYMBOL DEFINED BETWEEN THE          */ 01686000
*/*             STATEMENT NUMBERS FOR DEBDASD AND DEBACSMD IS IN     */ 01687000
*/*             THE DIRECT ACCESS STORAGE DEVICE SECTION.            */ 01688000
*/*                                                                  */ 01689000
*/*  F.E.'S                                                          */ 01690000
*/*      MICROFICHE LISTING - IEZDEB                                 */ 01691000
*/*                                                                  */ 01692000
*/*  DEVELOPERS                                                      */ 01693000
*/*      BAL LISTING  - SPECIFY LIST=YES ON MACRO CALL               */ 01694000
*/*      PL/S LISTING - SPECIFY %IHALIST='YES' BEFORE INCLUDE        */ 01695000
*/*                                                                  */ 01696000
*/*      FOR INTEGRATION, A LISTING SHOULD NOT BE REQUESTED.         */ 01697000
*/*                                                                  */ 01698000
*/*  FUNCTION                                                        */ 01699000
*/*      THE DATA EXTENT BLOCK (DEB) CONTAINS AN EXTENSION OF        */ 01700000
*/*      INFORMATION IN THE DCB.  EACH DEB IS ASSOCIATED WITH A      */ 01701000
*/*      DCB, AND THE TWO POINT TO EACH OTHER.  THE DEB CONTAINS     */ 01702000
*/*      INFORMATION CONCERNING THE PHYSICAL CHARACTERISTICS OF      */ 01703000
*/*      THE DATA SET AND OTHER INFORMATION THAT IS USED BY THE      */ 01704000
*/*      CONTROL PROGRAM.                                            */ 01705000
*/*                                                                  */ 01706000
*/* **************************************************************** */ 01707000
*                                                                  0375 01708000
*                                                                  0375 01709000
*/*  *************************************************************** */ 01710000
*/*                   DEB BASIC SECTION                              */ 01711000
*/*  *************************************************************** */ 01712000
*                                                                  0375 01713000
*   DECLARE                                                        0375 01714000
*     1 DEBBASIC BASED(DEBPTR) BDY(WORD),                          0375 01715000
*       3 DEBTCBAD PTR(31),         /* ADDRESS OF TCB FOR THIS DEB   */ 01716000
*        4 DEBNMSUB CHAR(1),        /* NUMBER OF SUBROUTINES LOADED     01717000
*                                      BY OPEN EXECUTOR ROUTINES     */ 01718000
*        4 DEBTCBB PTR(24),         /* ADDRESS OF TCB FOR THIS DEB   */ 01719000
*       3 DEBDEBAD PTR(31),         /* ADDRESS OF THE NEXT DEB IN THE   01720000
*                                      SAME TASK                     */ 01721000
*        4 DEBAMLNG CHAR(1),        /* NUMBER OF BYTES IN THE ACCESS    01722000
*                                      METHOD DEPENDENT SECTION. FOR    01723000
*                                      BDAM THIS FIELD CONTAINS THE     01724000
*                                      LENGTH EXPRESSED IN NUMBER OF    01725000
*                                      WORDS                         */ 01726000
*        4 DEBDEBB PTR(24),         /* *** SAME AS DEBDEBAD ABOVE    */ 01727000
*       3 DEBIRBAD PTR(31),         /* IRB STORAGE ADDRESS USED FOR     01728000
*                                      APPENDAGE ASYNCHRONOUS EXITS  */ 01729000
*        4 DEBOFLGS CHAR(1),        /* DATA SET STATUS FLAGS         */ 01730000
*         5 DEBDISP BIT(2),         /* DATA SET DISPOSITION FLAGS    */ 01731000
*         5 DEBEOF BIT(1),          /* END-OF-FILE (EOF) ENCOUNTERED    01732000
*                                      (TAPE INPUT) FORMAT 1 DSCB BIT   01733000
*                                      93.0 INDICATES THAT THE     0375 01734000
*                                      CURRENT VOLUME IS THE LAST  0375 01735000
*                                      VOLUME OF THE DATA SET (DASD     01736000
*                                      INPUT)                        */ 01737000
*         5 DEBRLSE BIT(1),         /* RELEASE UNUSED EXTERNAL     0375 01738000
*                                      STORAGE (DASD) EMULATOR TAPE     01739000
*                                      WITH SECOND GENERATION FORMAT.   01740000
*                                      TAPE MAY CONTAIN BLOCKS     0375 01741000
*                                      SHORTER THAN 12 CHARACTERS  0375 01742000
*                                      (TAPE)                        */ 01743000
*         5 DEBDCB BIT(1),          /* DCB MODIFICATION              */ 01744000
*         5 DEBSPLIT BIT(1),        /* SPLIT CYLINDER (DASD) 7-TRACK    01745000
*                                      EMULATOR TAPE WITH POSSIBLE 0375 01746000
*                                      MIXED PARITY RECORDS (TAPE)   */ 01747000
*         5 DEBLABEL BIT(1),        /* NONSTANDARD LABELS            */ 01748000
*         5 DEBRERR BIT(1),         /* USE REDUCED ERROR RECOVERY  0375 01749000
*                                      PROCEDURE (TAPE) CONCATENATED    01750000
*                                      PARTITIONED ORGANIZATION DATA    01751000
*                                      SETS PROCESSED USING BPAM   0375 01752000
*                                      (DASD)                        */ 01753000
*        4 DEBIRBB PTR(24),         /* *** SAME AS DEBIRBAD ABOVE    */ 01754000
*       3 DEBOPATB CHAR(1),         /* FLAGS INDICATING BOTH THE   0375 01755000
*                                      METHOD OF I/O PROCESSING AND     01756000
*                                      THE DISPOSITION THAT IS TO BE    01757000
*                                      PERFORMED WHEN AN           0375 01758000
*                                      END-OF-VOLUME (EOV) CONDITION    01759000
*                                      OCCURS                        */ 01760000
*        4 DEBABEND BIT(1),         /* SET BY ABEND INDICATING A   0375 01761000
*                                      SYSABEND OR SYSUDUMP DATA SET    01762000
*                                      (OS/VS2)                      */ 01763000
*        4 DEBZERO BIT(1),          /* ALWAYS ZERO                   */ 01764000
*        4 DEBPOSIT BIT(2),         /* DATA SET POSITIONING FLAGS    */ 01765000
*        4 DEBACCS BIT(4),          /* TYPE OF I/O ACCESSING BEING 0375 01766000
*                                      DONE                          */ 01767000
*       3 DEBQSCNT CHAR(1),         /* PURGE (SVC 16) - QUIESCE    0375 01768000
*                                      COUNT. NUMBER OF DEVICES    0375 01769000
*                                      EXECUTING USER'S CHANNEL    0375 01770000
*                                      PROGRAMS, AS SHOWN BY BITS 5     01771000
*                                      AND 6 OF UCBFL1 FIELDS        */ 01772000
*       3 DEBFLGS1 CHAR(1),         /* FLAG FIELD                    */ 01773000
*        4 DEBPWCKD BIT(1),         /* PASSWORD WAS SUPPLIED DURING     01774000
*                                      OPEN. EOV WILL NOT REQUEST A     01775000
*                                      PASSWORD FOR EACH ADDITIONAL     01776000
*                                      VOLUME OF A MULTIVOLUME DATA     01777000
*                                      SET                           */ 01778000
*        4 DEBEOFDF BIT(1),         /* SET BY EOV TO INFORM CLOSE  0375 01779000
*                                      THAT AN END-OF-FILE HAS BEEN     01780000
*                                      ENCOUNTERED AND, THEREFORE, 0375 01781000
*                                      DEFERRED LABEL PROCESSING IS     01782000
*                                      ALLOWED                       */ 01783000
*        4 DEBRSIOA BIT(1),         /* SIO APPENDAGE RE-ENTRY      0375 01784000
*                                      AUTHORIZATION BIT (OS/VS1)  0375 01785000
*                                      (MDC331)              @XM06077*/ 01786000
*        4 DEBRSV02 BIT(1),         /* RESERVED                      */ 01787000
*        4 DEBCINDI BIT(1),         /* DCB ASSOCIATED WITH THIS DEB     01788000
*                                      IS BEING PROCESSED BY THE   0375 01789000
*                                      COMPATIBILITY INTERFACE     0375 01790000
*                                      ROUTINES (VSAM) ICB462        */ 01791000
*        4 DEBF1CEV BIT(1),         /* EOV PROCESSING OCCURRED DURING   01792000
*                                      CLOSE PROCESSING. TESTED AND     01793000
*                                      SET TO ZERO BY CLOSE, SET TO     01794000
*                                      ONE BY EOV. (ICB353) A42228   */ 01795000
*        4 DEBAPFIN BIT(1),         /* IF ON, AUTHORIZED PROGRAMS CAN   01796000
*                                      BE LOADED MDC001              */ 01797000
*        4 DEBXTNIN BIT(1),         /* IF ONE, DEB EXTENSION EXISTS     01798000
*                                      (OS/VS2) MDC007               */ 01799000
*       3 DEBRSV05 CHAR(1),         /* RESERVED                      */ 01800000
*       3 DEBUSRPG PTR(31),         /* ADDRESS OF FIRST IOB IN THE 0375 01801000
*                                      USER PURGE CHAIN (OS/VS1)   0375 01802000
*                                      ADDRESS OF PURGED I/O RESTORE    01803000
*                                      LIST (PIRL) (OS/VS2) (MDC029)    01804000
*                                                              YM3158*/ 01805000
*        4 DEBNMEXT CHAR(1),        /* NUMBER OF EXTENTS SPECIFIED IN   01806000
*                                      DSCB'S                        */ 01807000
*        4 DEBUSRPB PTR(24),        /* *** SAME AS DEBUSRPG ABOVE    */ 01808000
*       3 DEBRRQ PTR(31),           /* POINTER TO RELATED REQUEST  0375 01809000
*                                      QUEUE (OS/VS2) MDC026         */ 01810000
*        4 DEBECBAD PTR(31),        /* ADDRESS OF A PARAMETER LIST 0375 01811000
*                                      USED TO LOCATE THE PURGE ECB     01812000
*                                      FOR AN SVC PURGE REQUEST    0375 01813000
*                                      (OS/VS1) MDC025               */ 01814000
*         5 DEBPRIOR CHAR(1),       /* PRIORITY OF THE TASK OWNING 0375 01815000
*                                      DEB                           */ 01816000
*         5 DEBECBB PTR(24),        /* *** SAME AS DEBECBAD ABOVE    */ 01817000
*       3 DEBDCBAD PTR(31),         /* ADDRESS OF DCB ASSOCIATED WITH   01818000
*                                      THIS DEB                      */ 01819000
*        4 DEBPROTG CHAR(1),        /* TASK PROTECTION KEY IN HIGH-     01820000
*                                      ORDER 4 BITS                  */ 01821000
*         5 DEBDEBID CHAR(1),       /* A HEX F IN LOW-ORDER 4 BITS TO   01822000
*                                      IDENTIFY THIS BLOCK AS A DEB  */ 01823000
*        4 DEBDCBB PTR(24),         /* *** SAME AS DEBDCBAD ABOVE    */ 01824000
*       3 DEBAPPAD PTR(31),         /* ADDRESS OF THE I/O APPENDAGE     01825000
*                                      VECTOR TABLE                  */ 01826000
*        4 DEBEXSCL CHAR(1),        /* EXTENT SCALE- 4 FOR DIRECT  0375 01827000
*                                      ACCESS DEVICE AND 3525 CARD 0375 01828000
*                                      PUNCH WITH DEVICE-ASSOCIATED     01829000
*                                      DATA SET SUPPORT AND 2 FOR  0375 01830000
*                                      NONDIRECT ACCESS DEVICE AND 0375 01831000
*                                      COMMUNICATION DEVICE. THIS  0375 01832000
*                                      FIELD IS USED TO DETERMINE THE   01833000
*                                      SIZE OF THE DEVICE DEPENDENT     01834000
*                                      SECTION ICB394                */ 01835000
*        4 DEBAPPB PTR(24),         /* *** SAME AS DEBAPPAD ABOVE    */ 01836000
*       3 DEBBASND CHAR(0) BDY(WORD);                              0375 01837000
*                                                                  0375 01838000
*/*  *************************************************************** */ 01839000
*/*    UNIT RECORD, MAGNETIC TAPE, TELECOMMUNICATIONS DEVICES SECTION*/ 01840000
*/*                                                                  */ 01841000
*/*      NOTE  FOR TELECOMMUNICATIONS DEVICES, THE UCB ADDRESS       */ 01842000
*/*            IS REPEATED FOR EACH LINE ASSIGNED                    */ 01843000
*/*  *************************************************************** */ 01844000
*                                                                  0376 01845000
*   DECLARE                                                        0376 01846000
*     1 DEBBAS02 DEF(DEBBASND) BDY(WORD),                          0376 01847000
*       3 DEBDDS1 BDY(WORD),                                       0376 01848000
*        4 DEBSUCBA PTR(31),        /* ADDRESS OF UCB ASSOCIATED WITH   01849000
*                                      A GIVEN DATA SET              */ 01850000
*         5 DEBSDVM CHAR(1),        /* DEVICE MODIFIER. FOR MAGNETIC    01851000
*                                      TAPE, SET MODE OPERATION CODE.   01852000
*                                      FOR UNIT RECORD, NOT USED.    */ 01853000
*         5 DEBSUCBB PTR(24),       /* *** SAME AS DEBSUCBA ABOVE    */ 01854000
*        4 DEBDEVED CHAR(0) BDY(WORD),/* END OF COMMON UNIT RECORD 0376 01855000
*                                      FIELDS (MDC330)       @X04AA9A*/ 01856000
*/*      THE FOLLOWING FIELDS ARE PRESENT ONLY FOR THE 3525 WITH     */ 01857000
*/*      DEVICE-ASSOCIATED DATA SET SUPPORT                          */ 01858000
*                                                                  0376 01859000
*        4 DEBRDCB PTR(31),         /* ADDRESS OF DCB FOR THE READ 0376 01860000
*                                      ASSOCIATED DATA SET ICB394    */ 01861000
*         5 DEBRSV06 CHAR(1),       /* RESERVED ICB394               */ 01862000
*         5 DEBRDCBA PTR(24),       /* SAME AS DEBRDCB ABOVE ICB394  */ 01863000
*        4 DEBPDCB PTR(31),         /* ADDRESS OF DCB FOR THE PUNCH     01864000
*                                      ASSOCIATED DATA SET ICB394    */ 01865000
*         5 DEBRSV07 CHAR(1),       /* RESERVED ICB394               */ 01866000
*         5 DEBPDCBA PTR(24),       /* SAME AS DEBPDCB ABOVE ICB394  */ 01867000
*        4 DEBWDCB PTR(31),         /* ADDRESS OF DCB FOR THE PRINT     01868000
*                                      ASSOCIATED DATA SET ICB394    */ 01869000
*         5 DEBRSV08 CHAR(1),       /* RESERVED ICB394               */ 01870000
*         5 DEBWDCBA PTR(24);       /* SAME AS DEBWDCB ABOVE ICB394  */ 01871000
*/*  *************************************************************** */ 01872000
*/*                 3540 ACCESS METHOD DEPENDENT SECTION     @X04AA9A*/ 01873000
*/*                 (OS/VS1 ONLY)                            @X04AA9A*/ 01874000
*/*                                                                  */ 01875000
*/*      NOTE  THIS SECTION FOLLOWS DEBSUCBA IN UNIT RECORD,         */ 01876000
*/*            MAGNETIC TAPE, TELECOMMUNICATIONS DEVICES SECTION     */ 01877000
*/*            IF DEB IS FOR 3540 DEVICE.                    @X04AA9A*/ 01878000
*/*  *************************************************************** */ 01879000
*                                                                  0377 01880000
*   DECLARE                                                        0377 01881000
*     1 DEBACS09 DEF(DEBDEVED) BDY(WORD),/*                  @X04AA9A*/ 01882000
*      2 DEBASC09 CHAR(16) BDY(WORD),/* 3540 ACCESS METHOD DEPENDENT    01883000
*                                      SECTION (MDC317)      @X04AA9A*/ 01884000
*       3 DEBVOLAC CHAR(1),         /* VOLUME ACCESSABILITY INDICATOR   01885000
*                                      (MDC327)              @X04AA9A*/ 01886000
*       3 DEBDSSQL CHAR(1),         /* DATA SET SECURITY QUALIFIER 0377 01887000
*                                      (MDC328)              @X04AA9A*/ 01888000
*       3 DEBVSEQU PTR(8),          /* VOLUME SEQUENCE NUMBER      0377 01889000
*                                      (MDC318)              @X04AA9A*/ 01890000
*       3 DEBEAMFG BIT(8),          /* FLAG BYTE (MDC319)    @X04AA9A*/ 01891000
*        4 DEBMULTI BIT(1),         /* MULTI-VOLUME INDICATOR      0377 01892000
*                                      (MDC320)              @X04AA9A*/ 01893000
*        4 DEBDSOPN BIT(1),         /* DATA SET IS OPEN (MDC321)   0377 01894000
*                                                            @X04AA9A*/ 01895000
*        4 DEBVAMSG BIT(1),         /* VOLUME ACCESSABILITY MESSAGE     01896000
*                                      HAS BEEN ISSUED (MDC329)    0377 01897000
*                                                            @X04AA9A*/ 01898000
*        4 DEBSECVL BIT(1),         /* SECURE VOLUME (MDC332)      0377 01899000
*                                                            @X04AA9A*/ 01900000
*        4 DEBRV004 BIT(1),         /* RESERVED              @X04AA9A*/ 01901000
*        4 DEBRV005 BIT(1),         /* RESERVED              @X04AA9A*/ 01902000
*        4 DEBRV006 BIT(1),         /* RESERVED              @X04AA9A*/ 01903000
*        4 DEBRV007 BIT(1),         /* RESERVED              @X04AA9A*/ 01904000
*       3 DEBDSID CHAR(8),          /* DATA SET IDENTIFIER (DSID)  0377 01905000
*                                      (INPUT) (MDC305)      @X04AA9A*/ 01906000
*        4 DEBEXDTE CHAR(6),        /* EXPIRATION DATE (OUTPUT)    0377 01907000
*                                      (MDC333)              @X04AA9A*/ 01908000
*        4 DEBWTPTI CHAR(1),        /* WRITE PROTECT INDICATOR     0377 01909000
*                                      (OUTPUT) (MDC334)     @X04AA9A*/ 01910000
*        4 DEBRV008 CHAR(1),        /* RESERVED (OUTPUT) (MDC335)  0377 01911000
*                                                            @X04AA9A*/ 01912000
*       3 DEBEOD CHAR(4) BDY(WORD), /* END OF DATA (EOD) ADDRESS   0377 01913000
*                                      (INPUT) (MDC306)      @X04AA9A*/ 01914000
*        4 DEBBOE CHAR(4) BDY(WORD),/* BEGINNING OF EXTENT (BOE)   0377 01915000
*                                      ADDRESS (OUTPUT) (MDC322)   0377 01916000
*                                                            @X04AA9A*/ 01917000
*         5 DEBEODRV PTR(8),        /* RESERVED (MDC307)     @X04AA9A*/ 01918000
*          6 DEBBOERV PTR(8),       /* RESERVED (MDC323)     @X04AA9A*/ 01919000
*         5 DEBEODTT PTR(8),        /* EOD TRACK NUMBER (MDC308)   0377 01920000
*                                                            @X04AA9A*/ 01921000
*          6 DEBBOETT PTR(8),       /* BOE TRACK NUMBER (MDC324)   0377 01922000
*                                                            @X04AA9A*/ 01923000
*         5 DEBEOD0 PTR(8),         /* MUST BE ZERO (MDC309) @X04AA9A*/ 01924000
*          6 DEBBOE0 PTR(8),        /* MUST BE ZERO (MDC325) @X04AA9A*/ 01925000
*         5 DEBEODSS PTR(8),        /* EOD SECTOR NUMBER (MDC310)  0377 01926000
*                                                            @X04AA9A*/ 01927000
*          6 DEBBOESS PTR(8);       /* BOE SECTOR NUMBER (MDC326)  0377 01928000
*                                                            @X04AA9A*/ 01929000
*/*  *************************************************************** */ 01930000
*/*              DEB ISAM DEPENDENT SECTION                          */ 01931000
*/*                                                                  */ 01932000
*/*      NOTE  PRESENT ONLY IF ISAM IS USED.  FOLLOWS THE BASIC      */ 01933000
*/*            SECTION AND PRECEDES THE DIRECT ACCESS STORAGE        */ 01934000
*/*            DEVICE SECTION.  COUNTED AS ONE EXTENT IN DEBNMEXT.   */ 01935000
*/*  *************************************************************** */ 01936000
*                                                                  0378 01937000
*   DECLARE                                                        0378 01938000
*     1 DEBBAS01 DEF(DEBBASND) BDY(WORD),                          0378 01939000
*      2 DEBISAM BDY(WORD),                                        0378 01940000
*       3 DEBFIEAD PTR(31),         /* ADDRESS OF FIRST INDEX EXTENT */ 01941000
*        4 DEBNIEE CHAR(1),         /* NUMBER OF EXTENTS OF        0378 01942000
*                                      INDEPENDENT INDEX AREA        */ 01943000
*        4 DEBFIEB PTR(24),         /* *** SAME AS DEBFIEAD ABOVE    */ 01944000
*       3 DEBFPEAD PTR(31),         /* ADDRESS OF THE FIRST PRIME  0378 01945000
*                                      DATA EXTENT                   */ 01946000
*        4 DEBNPEE CHAR(1),         /* NUMBER OF EXTENTS OF PRIME  0378 01947000
*                                      DATA AREA (M=0 EXTENT)        */ 01948000
*        4 DEBFPEB PTR(24),         /* *** SAME AS DEBFPEAD ABOVE    */ 01949000
*       3 DEBFOEAD PTR(31),         /* ADDRESS OF THE FIRST OVERFLOW    01950000
*                                      EXTENT                        */ 01951000
*        4 DEBNOEE CHAR(1),         /* NUMBER OF EXTENTS OF        0378 01952000
*                                      INDEPENDENT OVERFLOW AREA     */ 01953000
*        4 DEBFOEB PTR(24),         /* *** SAME AS DEBFOEAD ABOVE    */ 01954000
*       3 DEBEXPT PTR(31),          /* ADDRESS OF ISAM DEB EXTENSION    01955000
*                                      ICB379                        */ 01956000
*        4 DEBRPSID BIT(8),         /* ROTATIONAL POSITION SENSING 0378 01957000
*                                      (RPS) DEVICE INDICATORS       */ 01958000
*         5 DEBRPSP BIT(1),         /* PRIME DATA AREA IS ON RPS   0378 01959000
*                                      DEVICE                        */ 01960000
*         5 DEBRPSI BIT(1),         /* INDEPENDENT INDEX AREA IS ON     01961000
*                                      RPS DEVICE                    */ 01962000
*         5 DEBRPSO BIT(1),         /* INDEPENDENT OVERFLOW AREA IS     01963000
*                                      ON RPS DEVICE                 */ 01964000
*         5 DEBRPSAP BIT(1),        /* RPS SIO APPENDAGE HAS BEEN  0378 01965000
*                                      LOADED                        */ 01966000
*         5 DEBRSV09 BIT(1),        /* RESERVED                      */ 01967000
*         5 DEBRSV10 BIT(1),        /* RESERVED                      */ 01968000
*         5 DEBRSV11 BIT(1),        /* RESERVED                      */ 01969000
*         5 DEBRSV12 BIT(1),        /* RESERVED                      */ 01970000
*        4 DEBEXPTA PTR(24);        /* SAME AS DEBEXPT ABOVE ICB379  */ 01971000
*/*  *************************************************************** */ 01972000
*/*           DIRECT ACCESS STORAGE DEVICE SECTION                   */ 01973000
*/*                                                                  */ 01974000
*/*      NOTE  IF ISAM IS BEING USED, THIS SECTION FOLLOWS THE       */ 01975000
*/*            ISAM DEVICE DEPENDENT SECTION.  OTHERWISE, IT         */ 01976000
*/*            FOLLOWS THE BASIC SECTION.                            */ 01977000
*/*                                                                  */ 01978000
*/*            THERE IS ONE OF THESE SECTIONS FOR EACH EXTENT.       */ 01979000
*/*  *************************************************************** */ 01980000
*                                                                  0379 01981000
*   DECLARE                                                        0379 01982000
*     1 DEBDASD BASED(DEBDAPTR) BDY(WORD),                         0379 01983000
*       3 DEBUCBAD PTR(31),         /* ADDRESS OF UCB ASSOCIATED WITH   01984000
*                                      THIS DATA EXTENT              */ 01985000
*        4 DEBDVMOD CHAR(1),        /* DEVICE MODIFIER - FILE MASK   */ 01986000
*        4 DEBUCBA PTR(24),         /* *** SAME AS DEBUCBAD ABOVE    */ 01987000
*       3 DEBBINUM CHAR(2),         /* BIN NUMBER                    */ 01988000
*       3 DEBSTRCC CHAR(2),         /* CYLINDER ADDRESS FOR THE START   01989000
*                                      OF AN EXTENT LIMIT            */ 01990000
*       3 DEBSTRHH CHAR(2),         /* READ/WRITE TRACK ADDRESS FOR     01991000
*                                      THE START OF AN EXTENT LIMIT  */ 01992000
*       3 DEBENDCC CHAR(2),         /* CYLINDER ADDRESS FOR THE END     01993000
*                                      OF AN EXTENT LIMIT            */ 01994000
*       3 DEBENDHH CHAR(2),         /* READ/WRITE TRACK ADDRESS FOR     01995000
*                                      THE END OF AN EXTENT LIMIT    */ 01996000
*       3 DEBNMTRK CHAR(2);         /* NUMBER OF TRACKS ALLOCATED TO    01997000
*                                      A GIVEN EXTENT. FOR SPLIT   0379 01998000
*                                      CYLINDER DATA SETS, THIS FIELD   01999000
*                                      REPRESENTS THE NUMBER OF    0379 02000000
*                                      TRACKS BETWEEN THE START    0379 02001000
*                                      ADDRESS OF THE EXTENT AND THE    02002000
*                                      END ADDRESS OF THE EXTENT.    */ 02003000
*/*  *************************************************************** */ 02004000
*/*      EXCP ACCESS METHOD, BSAM AND QSAM DEPENDENT SECTION         */ 02005000
*/*  *************************************************************** */ 02006000
*                                                                  0380 02007000
*   DECLARE                                                        0380 02008000
*     1 DEBACSMD BASED(DEBEXPTR) BDY(WORD),                        0380 02009000
*       3 DEBVOLSQ CHAR(2),         /* VOLUME SEQUENCE NUMBER FOR  0380 02010000
*                                      MULTIVOLUME SEQUENTIAL DATA 0380 02011000
*                                      SETS                          */ 02012000
*        4 DEBVOLBT BIT(8),         /* FIRST BYTE OF DEBVOLSQ      0380 02013000
*                                      (MDC016)               YA00318*/ 02014000
*         5 DEBEXFUL BIT(1),        /* SET BY EOV WHEN REWRITING AN     02015000
*                                      OLD DIRECT ACCESS DATA SET TO    02016000
*                                      INDICATE THAT ALL PREVIOUS  0380 02017000
*                                      EXISTING EXTENTS HAVE BEEN  0380 02018000
*                                      FILLED (MDC017)        YA00318*/ 02019000
*         5 DEBRSV36 BIT(1),        /* RESERVED MDC018               */ 02020000
*         5 DEBRSV37 BIT(1),        /* RESERVED MDC018               */ 02021000
*         5 DEBRSV38 BIT(1),        /* RESERVED MDC018               */ 02022000
*         5 DEBRSV39 BIT(1),        /* RESERVED MDC018               */ 02023000
*         5 DEBRSV40 BIT(1),        /* RESERVED MDC018               */ 02024000
*         5 DEBRSV41 BIT(1),        /* RESERVED MDC018               */ 02025000
*         5 DEBRSV42 BIT(1),        /* RESERVED MDC018               */ 02026000
*        4 DEBVLSEQ PTR(8),         /* FOR DIRECT ACCESS, SEQUENCE 0380 02027000
*                                      NUMBER OF THE VOLUME OF THE 0380 02028000
*                                      DATA SET RELATIVE TO THE FIRST   02029000
*                                      VOLUME OF THE DATA SET. FOR 0380 02030000
*                                      TAPE, SEQUENCE NUMBER OF THE     02031000
*                                      VOLUME OF THE DATA SET      0380 02032000
*                                      RELATIVE TO THE FIRST VOLUME     02033000
*                                      PROCESSED. (MDC019)    YA00318*/ 02034000
*       3 DEBVOLNM CHAR(2),         /* TOTAL NUMBER OF VOLUMES IN A     02035000
*                                      MULTIVOLUME SEQUENTIAL DATA 0380 02036000
*                                      SET.                          */ 02037000
*       3 DEBDSNM CHAR(8) BDY(WORD),/* MEMBER NAME. THIS FIELD     0380 02038000
*                                      APPEARS ONLY WHEN AN OUTPUT 0380 02039000
*                                      DATA SET HAS BEEN OPENED FOR A   02040000
*                                      MEMBER NAME AND THE DSCB    0380 02041000
*                                      SPECIFIES A PARTITIONED DATA     02042000
*                                      SET.                          */ 02043000
*         5 DEBUTSAA PTR(31),       /* ADDRESS OF THE USER TOTALING     02044000
*                                      SAVE AREA                     */ 02045000
*          6 DEBRSV13 CHAR(1),      /* RESERVED                      */ 02046000
*          6 DEBUTSAB PTR(24),      /* *** SAME AS DEBUTSAA ABOVE    */ 02047000
*         5 DEBRSV14 CHAR(4) BDY(WORD),/* RESERVED (IF USER TOTALING    02048000
*                                      WAS SPECIFIED)                */ 02049000
*       3 DEBBLKSI FIXED(15),       /* MAXIMUM BLOCK SIZE (MDC346) 0380 02050000
*                                                            @ZA03699*/ 02051000
*       3 DEBLRECL FIXED(15);       /* LOGICAL RECORD LENGTH (MDC347)   02052000
*                                                            @ZA03699*/ 02053000
*/*  *************************************************************** */ 02054000
*/*                BPAM DEPENDENT SECTION                            */ 02055000
*/*  *************************************************************** */ 02056000
*                                                                  0381 02057000
*   DECLARE                                                        0381 02058000
*     1 DEBACS01 BASED(DEBEXPTR) BDY(WORD),                        0381 02059000
*       3 DEBDSNAM CHAR(8) BDY(WORD),/* FOR A PARTITIONED DATA SET 0381 02060000
*                                      OPENED FOR OUTPUT FOR A MEMBER   02061000
*                                      NAME, THIS FIELD IS THE MEMBER   02062000
*                                      NAME.                         */ 02063000
*        4 DEBEXTNM CHAR(1);        /* FOR A PARTITIONED DATA SET  0381 02064000
*                                      OPENED FOR INPUT, EACH ONE- 0381 02065000
*                                      BYTE FIELD CONTAINS THE EXTENT   02066000
*                                      NUMBER OF THE FIRST EXTENT  0381 02067000
*                                      ENTRY FOR EACH DATA SET EXCEPT   02068000
*                                      THE FIRST, IF TWO OR MORE DATA   02069000
*                                      SETS ARE CONCATENATED. THE  0381 02070000
*                                      NUMBER OF BYTES IN THE FIELD     02071000
*                                      IS EQUAL TO ONE LESS THAN THE    02072000
*                                      NUMBER OF DATA SETS         0381 02073000
*                                      CONCATENATED.                 */ 02074000
*/*  *************************************************************** */ 02075000
*/*                BDAM DEPENDENT SECTION                            */ 02076000
*/*  *************************************************************** */ 02077000
*                                                                  0382 02078000
*   DECLARE                                                        0382 02079000
*     1 DEBACS02 BASED(DEBEXPTR) BDY(WORD),                        0382 02080000
*                                                                  0382 02081000
*/*                       *****************************************  */ 02082000
*/*                       * FOR FIXED LENGTH RECORDS WITH THE     *  */ 02083000
*/*                       * OPTION OF RELATIVE BLOCK ADDRESSING   *  */ 02084000
*/*                       * (BUT NOT TRACK OVERFLOW)              *  */ 02085000
*/*                       *****************************************  */ 02086000
*                                                                  0382 02087000
*       3 DEBDBLK FIXED(31),        /* ONE FOUR-BYTE FIELD FOR EACH     02088000
*                                      EXTENT DESCRIBED IN THE DEVICE   02089000
*                                      DEPENDENT SECTION.            */ 02090000
*        4 DEBDBPT PTR(8),          /* NUMBER OF BLOCKS PER TRACK    */ 02091000
*        4 DEBDBPE CHAR(3);         /* NUMBER OF BLOCKS PER EXTENT   */ 02092000
*   DECLARE                                                        0383 02093000
*     1 DEBACS03 BASED(DEBEXPTR) BDY(WORD),                        0383 02094000
*                                                                  0383 02095000
*/*                       *****************************************  */ 02096000
*/*                       * FOR FIXED LENGTH RECORDS WITH THE     *  */ 02097000
*/*                       * OPTION OF RELATIVE BLOCK ADDRESSING   *  */ 02098000
*/*                       * AND TRACK OVERFLOW.                   *  */ 02099000
*/*                       *****************************************  */ 02100000
*                                                                  0383 02101000
*       3 DEBDTPP FIXED(31),        /* NUMBER OF TRACKS PER PERIOD   */ 02102000
*       3 DEBDBPP FIXED(31),        /* NUMBER OF BLOCKS PER PERIOD   */ 02103000
*/*                       THE FOLLOWING FIELD OCCURS ONCE FOR        */ 02104000
*/*                       EACH EXTENT.                               */ 02105000
*                                                                  0383 02106000
*       3 DEBDBPEF FIXED(31);       /* NUMBER OF BLOCKS PER EXTENT   */ 02107000
*/*  *************************************************************** */ 02108000
*/*               BTAM DEPENDENT SECTION                             */ 02109000
*/*                                                                  */ 02110000
*/*      NOTE  THIS SEGMENT IS ALWAYS PRESENT FOR BTAM.  IT IS       */ 02111000
*/*            USED WHEN A BUFFER POOL OR DYNAMIC BUFFERING IS       */ 02112000
*/*            USED.  OTHERWISE, THE FIELDS ARE ZERO.                */ 02113000
*/*  *************************************************************** */ 02114000
*                                                                  0384 02115000
*   DECLARE                                                        0384 02116000
*     1 DEBACS04 BASED(DEBEXPTR) BDY(WORD),                        0384 02117000
*       3 DEBTBFRA PTR(31),         /* ADDRESS OF THE BUFFER ROUTINE */ 02118000
*        4 DEBRSV15 CHAR(1),        /* RESERVED                      */ 02119000
*        4 DEBTBFRB PTR(24),        /* ADDRESS OF THE BUFFER ROUTINE */ 02120000
*/*                       THE FOLLOWING FIELD IS REPEATED FOR EACH   */ 02121000
*/*                       CCW ON THE CHANNEL PROGRAM QUEUE           */ 02122000
*                                                                  0384 02123000
*       3 DEBTCCWA PTR(31),         /* ADDRESS OF THE FIRST (OR    0384 02124000
*                                      FOLLOWING) CCW ON THE QUEUE   */ 02125000
*        4 DEBRSV16 CHAR(1),        /* RESERVED                      */ 02126000
*        4 DEBTCCWB PTR(24);        /* *** SAME AS DEBCCWA ABOVE     */ 02127000
*/*  *************************************************************** */ 02128000
*/*                 GAM DEPENDENT SECTION                            */ 02129000
*/*  *************************************************************** */ 02130000
*                                                                  0385 02131000
*   DECLARE                                                        0385 02132000
*     1 DEBACS05 BASED(DEBEXPTR) BDY(WORD),                        0385 02133000
*       3 DEBFUCBA PTR(31),         /* ADDRESS OF FIRST UCB          */ 02134000
*        4 DEBRSV17 CHAR(1),        /* RESERVED                      */ 02135000
*        4 DEBFUCBB PTR(24),        /* ADDRESS OF FIRST UCB          */ 02136000
*       3 DEBLUCBA PTR(31),         /* ADDRESS OF LAST UCB           */ 02137000
*        4 DEBRSV18 CHAR(1),        /* RESERVED                      */ 02138000
*        4 DEBLUCBB PTR(24);        /* ADDRESS OF LAST UCB           */ 02139000
*/*  *************************************************************** */ 02140000
*/*               ISAM LOAD MODE EXTENSION                           */ 02141000
*/*  *************************************************************** */ 02142000
*                                                                  0386 02143000
*   DECLARE                                                        0386 02144000
*     1 DEBACS06 BASED(DEBEXPT) BDY(WORD),                         0386 02145000
*      2 DEBDCBFA PTR(31),          /* ADDRESS OF DCB FIELD AREA   0386 02146000
*                                      MDC013                        */ 02147000
*      2 DEBPUT PTR(31);            /* ADDRESS OF PUT MODULE ICB379  */ 02148000
*/*  *************************************************************** */ 02149000
*/*               ISAM SCAN MODE EXTENSION                           */ 02150000
*/*  *************************************************************** */ 02151000
*                                                                  0387 02152000
*   DECLARE                                                        0387 02153000
*     1 DEBACS07 BASED(DEBEXPT) BDY(WORD),                         0387 02154000
*      2 * PTR(31),                 /* DEBDCBFA - ADDRESS OF DCB   0387 02155000
*                                      FIELD AREA MDC014             */ 02156000
*      2 DEBGET PTR(31),            /* ADDRESS OF GET OR PUT MODULE -   02157000
*                                      THIS FIELD IS ALSO CALLED   0387 02158000
*                                      DEBPUT ICB379                 */ 02159000
*      2 DEBWKPT4 PTR(31),          /* SAME AS DCBWKPT4 - ADDRESS OF    02160000
*                                      UCB ICB379                    */ 02161000
*      2 DEBWKPT5 PTR(31),          /* SAME AS DCBWKPT5 - ADDRESS OF    02162000
*                                      GET APPENDAGE MODULE ICB379   */ 02163000
*      2 DEBCREAD PTR(31),          /* ADDRESS OF CHANNEL-END      0387 02164000
*                                      APPENDAGE FOR READ ICB379     */ 02165000
*      2 DEBCSETL PTR(31),          /* ADDRESS OF CHANNEL-END      0387 02166000
*                                      APPENDAGE FOR SETL ICB379     */ 02167000
*      2 DEBCWRIT PTR(31),          /* ADDRESS OF CHANNEL-END      0387 02168000
*                                      APPENDAGE FOR WRITE ICB379    */ 02169000
*      2 DEBCCHK PTR(31),           /* ADDRESS OF CHANNEL-END      0387 02170000
*                                      APPENDAGE FOR WRITE VALIDITY     02171000
*                                      CHECK ICB379                  */ 02172000
*      2 DEBCREWT PTR(31),          /* ADDRESS OF CHANNEL-END      0387 02173000
*                                      APPENDAGE FOR RE-WRITE ICB379 */ 02174000
*      2 DEBCRECK PTR(31),          /* ADDRESS OF CHANNEL-END      0387 02175000
*                                      APPENDAGE FOR RE-CHECK ICB379 */ 02176000
*      2 DEBAREAD PTR(31),          /* ADDRESS OF ABNORMAL-END     0387 02177000
*                                      APPENDAGE FOR READ ICB379     */ 02178000
*      2 DEBASETL PTR(31),          /* ADDRESS OF ABNORMAL-END     0387 02179000
*                                      APPENDAGE FOR SETL ICB379     */ 02180000
*      2 DEBAWRIT PTR(31),          /* ADDRESS OF ABNORMAL-END     0387 02181000
*                                      APPENDAGE FOR WRITE ICB379    */ 02182000
*      2 DEBACHK PTR(31),           /* ADDRESS OF ABNORMAL-END     0387 02183000
*                                      APPENDAGE FOR WRITE VALIDITY     02184000
*                                      CHECK ICB379                  */ 02185000
*      2 DEBAREWT PTR(31),          /* ADDRESS OF ABNORMAL-END     0387 02186000
*                                      APPENDAGE FOR RE-WRITE ICB379 */ 02187000
*      2 DEBARECK PTR(31),          /* ADDRESS OF ABNORMAL-END     0387 02188000
*                                      APPENDAGE FOR RE-CHECK ICB379 */ 02189000
*      2 DEBRPSST PTR(31);          /* ADDRESS OF RPS SIO APPENDAGE     02190000
*                                      IF ADDRSPC=REAL WAS NOT     0387 02191000
*                                      SPECIFIED ICB379              */ 02192000
*/*  *************************************************************** */ 02193000
*/*               BISAM MODE EXTENSION                               */ 02194000
*/*  *************************************************************** */ 02195000
*                                                                  0388 02196000
*   DECLARE                                                        0388 02197000
*     1 DEBACS08 BASED(DEBEXPT) BDY(WORD),                         0388 02198000
*      2 * PTR(31),                 /* DEBDCBFA - ADDRESS OF DCB   0388 02199000
*                                      FIELD AREA MDC015             */ 02200000
*      2 DEBDISAD PTR(31),          /* ADDRESS OF PRIVILEGED MODULE     02201000
*                                      ENTERED WHEN A BISAM MACRO  0388 02202000
*                                      INSTRUCTION IS EXECUTED ICB379*/ 02203000
*      2 * PTR(31),                 /* DEBWKPT4 - SAME AS DCBWKPT4 -    02204000
*                                      ADDRESS OF THE PART 1       0388 02205000
*                                      APPENDAGE MODULE (ABNORMAL AND   02206000
*                                      CHANNEL-END APPANDAGES) ICB379*/ 02207000
*      2 * PTR(31),                 /* DEBWKPT5 - SAME AS DCBWKPT5 -    02208000
*                                      ADDRESS OF THE PART 2       0388 02209000
*                                      APPENDAGE MODULE (ABNORMAL AND   02210000
*                                      CHANNEL-END APPANDAGES) ICB379*/ 02211000
*      2 DEBFREED PTR(31),          /* ADDRESS OF DYNAMIC BUFFERING     02212000
*                                      MODULE ICB379                 */ 02213000
*      2 DEBRPSIO PTR(31),          /* ADDRESS OF RPS SIO APPENDAGE     02214000
*                                      MODULE IF ADDRSPC=REAL WAS NOT   02215000
*                                      SPECIFIED AND IF DYNAMIC    0388 02216000
*                                      BUFFERING IS USED ICB379      */ 02217000
*      2 DEBSIOA2 PTR(31);          /* ADDRESS OF DYNAMIC BUFFERING     02218000
*                                      APPENDAGE MODULE DISPLACED BY    02219000
*                                      PAGE FIX (PGFX) APPENDAGE IF     02220000
*                                      ADDRSPC=REAL WAS NOT SPECIFIED   02221000
*                                      ICB379                        */ 02222000
*/*  *************************************************************** */ 02223000
*/*               SUBROUTINE NAME SECTION                            */ 02224000
*/*                                                                  */ 02225000
*/*      NOTE  FOLLOWS THE ACCESS METHOD DEPENDENT SECTION, OR THE   */ 02226000
*/*            DEVICE DEPENDENT SECTION IF THERE IS NO ACCESS        */ 02227000
*/*            METHOD SECTION.                                       */ 02228000
*/*  *************************************************************** */ 02229000
*                                                                  0389 02230000
*   DECLARE                                                        0389 02231000
*     1 DEBSUBNM BASED(DEBSBPTR) BDY(WORD),                        0389 02232000
*        4 DEBSUBID CHAR(2);        /* SUBORUTINE IDENTIFICATION.  0389 02233000
*                                      EACH ACCESS METHOD SUBROUTINE,   02234000
*                                      APPENDAGE SUBROUTINE, AND IRB    02235000
*                                      ROUTINE WILL HAVE A UNIQUE  0389 02236000
*                                      EIGHT-BYTE NAME. THE LOW-   0389 02237000
*                                      ORDER TWO BYTES OF EACH     0389 02238000
*                                      ROUTINE NAME WILL BE IN THIS     02239000
*                                      FIELD IF THE SUBROUTINE IS  0389 02240000
*                                      LOADED BY THE OPEN ROUTINES.  */ 02241000
*/*  *************************************************************** */ 02242000
*/*          APPENDAGE VECTOR TABLE SECTION OF THE DEB               */ 02243000
*/*  *************************************************************** */ 02244000
*                                                                  0390 02245000
*   DECLARE                                                        0390 02246000
*     1 DEB BASED(DEBAPPAD) BDY(WORD),                             0390 02247000
*      2 DEBAVT BDY(WORD),          /* APPENDAGE VECTOR TABLE        */ 02248000
*       3 DEBEOEA PTR(31),          /* ADDRESS OF END-OF-EXTENT    0390 02249000
*                                      APPENDAGE ROUTINE             */ 02250000
*        4 DEBEOEAB CHAR(1),        /* FLAG BYTE ICB280              */ 02251000
*         5 DEBRSV19 BIT(1),        /* RESERVED                      */ 02252000
*         5 DEBRSV20 BIT(1),        /* RESERVED                      */ 02253000
*         5 DEBRSV21 BIT(1),        /* RESERVED                      */ 02254000
*         5 DEBRSV22 BIT(1),        /* RESERVED                      */ 02255000
*         5 DEBEOENP BIT(4),        /* NUMBER OF 2K PAGES TO BE FIXED   02256000
*                                      FOR THE END-OF-EXTENT       0390 02257000
*                                      APPENDAGE ICB280              */ 02258000
*        4 DEBEOEAD PTR(24),        /* ADDRESS OF END-OF-EXTENT    0390 02259000
*                                      APPENDAGE ROUTINE ICB280      */ 02260000
*       3 DEBSIOA PTR(31),          /* ADDRESS OF START I/O APPENDAGE   02261000
*                                      ROUTINE                       */ 02262000
*        4 DEBSIOAB CHAR(1),        /* FLAG BYTE ICB280              */ 02263000
*         5 DEBPGFX BIT(1),         /* ADDRESS IN DEBSIOAD CAN BE  0390 02264000
*                                      USED TO DETERMINE THE ENTRY 0390 02265000
*                                      POINT TO THE PAGE FIX (PGFX)     02266000
*                                      APPENDAGE ROUTINE BY ADDING 4    02267000
*                                      TO ADDRESS IN DEBSIOAD ICB280 */ 02268000
*         5 DEBSIOX BIT(1),         /* IF ZERO, DO NOT ENTER SIO   0390 02269000
*                                      APPENDAGE WHEN ERP IS ACTIVE.    02270000
*                                      IF ONE, ENTER SIO APPENDAGE 0390 02271000
*                                      EVEN WHEN ERP IS ACTIVE.    0390 02272000
*                                      ICB372                        */ 02273000
*         5 DEBIOVR BIT(1),         /* IF ONE, EXCPVR REQUEST IS   0390 02274000
*                                      VALID. IF ZERO, EXCPVR REQUEST   02275000
*                                      IS INVALID AND WILL NOT BE  0390 02276000
*                                      EXECUTED. ICB401              */ 02277000
*         5 DEBFIX BIT(1),          /* INDICATION THAT DEB HAS BEEN     02278000
*                                      FIXED (OS/VS2) (MDC032) YM5929*/ 02279000
*         5 DEBSIONP BIT(4),        /* NUMBER OF 2K PAGES TO BE FIXED   02280000
*                                      FOR THE SIO APPENDAGE ICB280  */ 02281000
*        4 DEBSIOAD PTR(24),        /* ADDRESS OF START I/O APPENDAGE   02282000
*                                      ROUTINE ICB280                */ 02283000
*       3 DEBPCIA PTR(31),          /* ADDRESS OF PCI APPENDAGE    0390 02284000
*                                      ROUTINE                       */ 02285000
*        4 DEBPCIAB CHAR(1),        /* FLAG BYTE ICB280              */ 02286000
*         5 DEBRSV24 BIT(1),        /* RESERVED                      */ 02287000
*         5 DEBRSV25 BIT(1),        /* RESERVED                      */ 02288000
*         5 DEBRSV26 BIT(1),        /* RESERVED                      */ 02289000
*         5 DEBRSV27 BIT(1),        /* RESERVED                      */ 02290000
*         5 DEBPCINP BIT(4),        /* NUMBER OF 2K PAGES TO BE FIXED   02291000
*                                      FOR THE PCI APPENDAGE ROUTINE    02292000
*                                      ICB280                        */ 02293000
*        4 DEBPCIAD PTR(24),        /* ADDRESS OF PROGRAM-         0390 02294000
*                                      CONTROLLED-INTERRUPTION (PCI)    02295000
*                                      APPENDAGE ROUTINE ICB280      */ 02296000
*       3 DEBCEA PTR(31),           /* ADDRESS OF CHANNEL-END      0390 02297000
*                                      APPENDAGE ROUTINE             */ 02298000
*        4 DEBCEAB CHAR(1),         /* FLAG BYTE ICB280              */ 02299000
*         5 DEBRSV28 BIT(1),        /* RESERVED                      */ 02300000
*         5 DEBRSV29 BIT(1),        /* RESERVED                      */ 02301000
*         5 DEBRSV30 BIT(1),        /* RESERVED                      */ 02302000
*         5 DEBRSV31 BIT(1),        /* RESERVED                      */ 02303000
*         5 DEBCENP BIT(4),         /* NUMBER OF 2K PAGES TO BE FIXED   02304000
*                                      FOR THE CHANNEL-END APPENDAGE    02305000
*                                      ICB280                        */ 02306000
*        4 DEBCEAD PTR(24),         /* ADDRESS OF CHANNEL END      0390 02307000
*                                      APPENDAGE ROUTINE ICB280      */ 02308000
*       3 DEBXCEA PTR(31),          /* ADDRESS OF ABNORMAL-END     0390 02309000
*                                      APPENDAGE ROUTINE             */ 02310000
*        4 DEBXCEAB CHAR(1),        /* FLAG BYTE ICB280              */ 02311000
*         5 DEBRSV32 BIT(1),        /* RESERVED                      */ 02312000
*         5 DEBRSV33 BIT(1),        /* RESERVED                      */ 02313000
*         5 DEBRSV34 BIT(1),        /* RESERVED                      */ 02314000
*         5 DEBRSV35 BIT(1),        /* RESERVED                      */ 02315000
*         5 DEBXCENP BIT(4),        /* NUMBER OF 2K PAGES TO BE FIXED   02316000
*                                      FOR THE ABNORMAL-END APPENDAGE   02317000
*                                      ICB280                        */ 02318000
*        4 DEBXCEAD PTR(24),        /* ADDRESS OF ABNORMAL-END     0390 02319000
*                                      APPENDAGE ROUTINE ICB280      */ 02320000
*/*  *************************************************************** */ 02321000
*/*                  DEB PREFIX TABLE                                */ 02322000
*/*  *************************************************************** */ 02323000
*                                                                  0390 02324000
*      2 DEBPREFX BDY(WORD),        /* DEB PREFIX TABLE              */ 02325000
*       3 DEBWKARA CHAR(1) BDY(WORD),/* I/O SUPPORT WORK AREA (DIRECT   02326000
*                                      ACCESS)                       */ 02327000
*       3 DEBDSCBA CHAR(7) BDY(WORD,2),/* DSCB ADDRESS (BBCCHHR) USED   02328000
*                                      BY I/O SUPPORT (DIRECT ACCESS)*/ 02329000
*       3 DEBXTNP PTR(31),          /* POINTER TO DEB EXTENSION    0390 02330000
*                                      (OS/VS2) MDC008               */ 02331000
*        4 DEBDCBMK CHAR(4) BDY(WORD),/* DCB MODIFICATION MASK USED     02332000
*                                      BY I/O SUPPORT (OS/VS1) MDC009*/ 02333000
*       3 DEBLNGTH CHAR(1),         /* LENGTH OF DEB IN DOUBLE WORDS */ 02334000
*       3 DEBAMTYP CHAR(1),         /* ACCESS METHOD TYPE ICB380     */ 02335000
*       3 DEBTBLOF FIXED(15);       /* OFFSET IN THE DEB TABLE TO THE   02336000
*                                      ENTRY FOR THIS DEB ICB380     */ 02337000
*/*  *************************************************************** */ 02338000
*/*                  DEB EXTENSION (OS/VS2)                          */ 02339000
*/*  *************************************************************** */ 02340000
*                                                                  0391 02341000
*   DECLARE                                                        0391 02342000
*     1 DEBXTN BASED(DEBXTNP) BDY(WORD),                           0391 02343000
*      2 DEBXLNGH FIXED(15),        /* LENGTH OF DEB EXTENSION MDC002*/ 02344000
*      2 DEBXFLG1 BIT(8),           /* FLAG BYTE (MDC027)      YM1272*/ 02345000
*       3 DEBXCDCB BIT(1),          /* DEBDCBAD FIELD CONTAINS THE 0391 02346000
*                                      ADDRESS OF A COPIED DCB. USED    02347000
*                                      BY END-OF-VOLUME, TCLOSE AND     02348000
*                                      TASK CLOSE. (MDC028)    YM1272*/ 02349000
*       3 DEBXTSKC BIT(1),          /* TASK CLOSE IS CLOSING THE   0391 02350000
*                                      RELATED DCB. SET BY TASK CLOSE   02351000
*                                      AND INTERROGATED BY         0391 02352000
*                                      END-OF-VOLUME, FEOV AND TCLOSE   02353000
*                                      FOR DEB'S NOT ON THE CURRENT     02354000
*                                      TCB DEB CHAIN. (MDC031) YM2869*/ 02355000
*       3 DEBXDSSI BIT(1),          /* DATA SET SECURITY INDICATOR.     02356000
*                                      SET BY OPEN AND CHECKPOINT. 0391 02357000
*                                      INTERROGATED BY EOV. (MDC348)    02358000
*                                                            @Z40RP9A*/ 02359000
*       3 DEBXRV43 BIT(1),          /* RESERVED                      */ 02360000
*       3 DEBXRV44 BIT(1),          /* RESERVED                      */ 02361000
*       3 DEBXRV45 BIT(1),          /* RESERVED                      */ 02362000
*       3 DEBXRV46 BIT(1),          /* RESERVED                      */ 02363000
*       3 DEBXRV47 BIT(1),          /* RESERVED                      */ 02364000
*      2 DEBXRV48 CHAR(1),          /* RESERVED                      */ 02365000
*      2 DEBXDSAB PTR(31),          /* POINTER TO DSAB MDC004        */ 02366000
*      2 DEBXDCBM CHAR(4) BDY(WORD),/* DCB MODIFICATION MASK USED BY    02367000
*                                      I/O SUPPORT MDC005            */ 02368000
*      2 DEBXDBPR PTR(31),          /* POINTER TO DEB MDC006         */ 02369000
*      2 DEBXDSO1 BIT(8),           /* SAME AS DCBDSORG BYTE 1 MDC020*/ 02370000
*      2 DEBXDSO2 BIT(8),           /* SAME AS DCBDSORG BYTE 2 MDC021*/ 02371000
*      2 DEBXMCF1 BIT(8),           /* SAME AS DCBMACRF BYTE 1 MDC022*/ 02372000
*      2 DEBXMCF2 BIT(8),           /* SAME AS DCBMACRF BYTE 2 MDC023*/ 02373000
*      2 DEBXXARG PTR(31),          /* ADDRESS OF BDAM READ EXCLUSIVE   02374000
*                                      LIST MDC024                   */ 02375000
*      2 DEBXOPNJ PTR(31),          /* POINTER TO DSAB (SEPARATE FROM   02376000
*                                      DEBXDSAB) DYNAMICALLY       0391 02377000
*                                      ALLOCATED BY OPEN TYPE=J. THIS   02378000
*                                      POINTER WILL EXIST FOR      0391 02379000
*                                      NON-AUTHORIZED CALLERS OF OPEN   02380000
*                                      TYPE=J FOR A DIRECT ACCESS  0391 02381000
*                                      DATA SET WHERE THE DATA SET 0391 02382000
*                                      BEING OPENED IS DIFFERENT FROM   02383000
*                                      THE DATA SET DESCRIBED BY THE    02384000
*                                      DDNAME IN DCB AND THE JFCNWRIT   02385000
*                                      BIT IS ON IN THE JFCB. THE  0391 02386000
*                                      POINTER WILL BE USED BY CLOSE    02387000
*                                      TO DYNAMICALLY UNALLOCATE THE    02388000
*                                      DATA SET. (MDC352)    @ZA02193*/ 02389000
*      2 DEBXRV40 PTR(31);          /* RESERVED                      */ 02390000
*   DCL                                                            0392 02391000
*    (F1PTR,                                                       0392 02392000
*     F3PTR,                                                       0392 02393000
*     F4PTR) PTR(31);                                              0392 02394000
*                                                                  0392 02395000
*/*      %INCLUDE SYSLIB(IECSDSL1)                                   */ 02396000
*                                                                  0393 02397000
*   DCL                                                            0393 02398000
*     1 IECSDSF1 BASED(F1PTR),      /* FORMAT 1 DSCB - DESCRIBED     */ 02399000
*      2 * CHAR(140);               /* IN THE FOLLOWING STRUCTURE    */ 02400000
*   DCL                                                            0394 02401000
*     1 IECSDSL1 BASED(ADDR(IECSDSF1)),/* START OF THE FORMAT 1 DSCB */ 02402000
*      2 DS1DSNAM CHAR(44),         /* DATA SET NAME                 */ 02403000
*      2 DS1FMTID CHAR(1),          /* FORMAT IDENTIFIER             */ 02404000
*      2 DS1DSSN CHAR(6),           /* DATA SET SERIAL NUMBER        */ 02405000
*      2 DS1VOLSQ CHAR(2),          /* VOLUME SEQUENCE NUMBER        */ 02406000
*      2 DS1CREDT CHAR(3),          /* CREATION DATE                 */ 02407000
*      2 DS1EXPDT CHAR(3),          /* EXPIRATION DATE               */ 02408000
*      2 DS1NOEPV CHAR(1),          /* NUMBER OF EXTENTS ON VOLUME   */ 02409000
*      2 DS1NOBDB CHAR(1),          /* NUMBER OF BYTES USED IN LAST     02410000
*                                      DIRECTORY BLOCK               */ 02411000
*      2 * CHAR(1),                 /* RESERVED                      */ 02412000
*      2 DS1SYSCD CHAR(13),         /* SYSTEM CODE                   */ 02413000
*      2 * CHAR(7),                 /* RESERVED                      */ 02414000
*      2 DS1DSORG CHAR(2),          /* DATA SET ORGANIZATION         */ 02415000
*      2 DS1RECFM CHAR(1),          /* RECORD FORMAT                 */ 02416000
*      2 DS1OPTCD CHAR(1),          /* OPTION CODE                   */ 02417000
*      2 DS1BLKL CHAR(2),           /* BLOCK LENGTH                  */ 02418000
*      2 DS1LRECL CHAR(2),          /* RECORD LENGTH                 */ 02419000
*      2 DS1KEYL CHAR(1),           /* KEY LENGTH                    */ 02420000
*      2 DS1RKP CHAR(2),            /* RELATIVE KEY POSITION         */ 02421000
*      2 DS1DSIND CHAR(1),          /* DATA SET INDICATORS           */ 02422000
*      2 DS1SCALO CHAR(4),          /* SECONDARY ALLOCATION          */ 02423000
*      2 DS1LSTAR CHAR(3),          /* LAST USED TRACK AND LAST BLOCK   02424000
*                                      ON TRACK                      */ 02425000
*      2 DS1TRBAL CHAR(2),          /* BYTES REMAINING ON LAST TRACK    02426000
*                                      USED                          */ 02427000
*      2 * CHAR(2),                 /* RESERVED                      */ 02428000
*      2 DS1EXT1 CHAR(10),          /* FIRST EXTENT DESCRIPTION FIRST   02429000
*                                      BYTE EXTENT TYPE INDICATOR  0394 02430000
*                                      SECOND BYTE EXTENT SEQUENCE 0394 02431000
*                                      NUMBER THIRD - SIXTH BYTES  0394 02432000
*                                      LOWER LIMIT SEVENTH - TENTH 0394 02433000
*                                      BYTES UPPER LIMIT             */ 02434000
*      2 DS1EXT2 CHAR(10),          /* SECOND EXTENT DESCRIPTION     */ 02435000
*      2 DS1EXT3 CHAR(10),          /* THIRD EXTENT DESCRIPTION      */ 02436000
*      2 DS1PTRDS CHAR(5),          /* POSSIBLE PTR TO A FORMAT 2 OR    02437000
*                                      3 DSCB                        */ 02438000
*      2 DS1END CHAR(0);            /* END OF THE FORMAT 1 DSCB      */ 02439000
*   DCL                                                            0395 02440000
*     1 IECSDSF3 BASED(F3PTR),      /* FORMAT 3 DSCB - DESCRIBED     */ 02441000
*      2 * CHAR(140);               /* IN THE FOLLOWING STRUCTURE    */ 02442000
*   DCL                                                            0396 02443000
*     1 IECSDSL3 BASED(ADDR(IECSDSF3)),/* START OF THE FORMAT 3 DSCB */ 02444000
*      2 * CHAR(4),                 /* KEY IDENTIFIER                */ 02445000
*      2 DS3EXTNT CHAR(40),         /* FOUR EXTENT DESCRIPTIONS FIRST   02446000
*                                      BYTE EXTENT TYPE INDICATOR  0396 02447000
*                                      SECOND BYTE EXTENT SEQUENCE 0396 02448000
*                                      NUMBER THIRD - SIXTH BYTES  0396 02449000
*                                      LOWER LIMIT SEVENTH - TENTH 0396 02450000
*                                      BYTES UPPER LIMIT             */ 02451000
*      2 DS3FMTID CHAR(1),          /* FORMAT IDENTIFIER             */ 02452000
*      2 DS3ADEXT CHAR(90),         /* NINE ADDITIONAL EXTENT      0396 02453000
*                                      DESCRIPTIONS                  */ 02454000
*      2 DS3PTRDS CHAR(5),          /* RESERVED                      */ 02455000
*      2 DS3END CHAR(0);            /* END OF THE FORMAT 3 DSCB      */ 02456000
*   DCL                                                            0397 02457000
*     1 IECSDSF4 BASED(F4PTR),      /* FORMAT 4 DSCB - DESCRIBED     */ 02458000
*      2 * CHAR(96);                /* IN THE FOLLOWING STRUCTURE    */ 02459000
*   DCL                                                            0398 02460000
*     1 IECSDSL4 BASED(ADDR(IECSDSF4)),/* START OF THE FORMAT 4 DSCB */ 02461000
*      2 DS4IDFMT CHAR(1),          /* FORMAT IDENTIFIER             */ 02462000
*      2 DS4HPCHR CHAR(5),          /* HIGHEST ADDRESS OF A FORMAT 1    02463000
*                                      DSCB                          */ 02464000
*      2 DS4DSREC CHAR(2),          /* NUMBER OF AVAILABLE DSCB'S    */ 02465000
*      2 DS4HCCHH CHAR(4),          /* CCHH OF NEXT AVAILABLE      0398 02466000
*                                      ALTERNATE TRACK               */ 02467000
*      2 DS4NOATK CHAR(2),          /* NUMBER OF REMAINING ALTERNATE    02468000
*                                      TRACKS                        */ 02469000
*      2 DS4VTOCI CHAR(1),          /* VTOC INDICATORS               */ 02470000
*      2 DS4NOEXT CHAR(1),          /* NUMBER OF EXTENTS IN VTOC     */ 02471000
*      2 * CHAR(2),                 /* RESERVED                      */ 02472000
*      2 DS4DEVCT CHAR(14),         /* DEVICE CONSTANTS              */ 02473000
*       3 DS4DEVSZ CHAR(4),         /* DEVICE SIZE                   */ 02474000
*       3 DS4DEVTK CHAR(2),         /* DEVICE TRACK LENGTH           */ 02475000
*       3 DS4DEVOV CHAR(2),         /* KEYED RECORD OVERHEAD         */ 02476000
*        4 DS4DEVI CHAR(1),         /* - NON-LAST KEYED RECORD     0398 02477000
*                                      OVERHEAD                      */ 02478000
*        4 DS4DEVL CHAR(1),         /* - LAST KEYED RECORD OVERHEAD  */ 02479000
*       3 DS4DEVK CHAR(1),          /* NON-KEYED RECORD OVERHEAD   0398 02480000
*                                      DIFFERENTIAL                  */ 02481000
*       3 DS4DEVFG CHAR(1),         /* FLAG BYTE                     */ 02482000
*       3 DS4DEVTL CHAR(2),         /* DEVICE TOLERANCE              */ 02483000
*       3 DS4DEVDT CHAR(1),         /* NUMBER OF DSCB'S PER TRACK    */ 02484000
*       3 DS4DEVDB CHAR(1),         /* NUMBER OF DIRECTORY BLOCKS PER   02485000
*                                      TRACK                         */ 02486000
*      2 DS4AMTIM CHAR(8),          /* VSAM TIME STAMP               */ 02487000
*      2 DS4AMCAT CHAR(3),          /* VSAM CATALOG INDICATOR        */ 02488000
*       3 DS4VSIND BIT(8),          /* VSAM INDICATORS               */ 02489000
*        4 DS4VSREF BIT(1),         /* A VSAM CATALOG REFERENCES THIS   02490000
*                                      VOLUME                        */ 02491000
*        4 DS4VSBAD BIT(1),         /* VSAM DATA SETS ON VOLUME ARE     02492000
*                                      UNUSABLE                      */ 02493000
*        4 * BIT(6),                /* RESERVED                      */ 02494000
*       3 DS4VSCRA PTR(16) BDY(BYTE),/* RELATIVE TRACK LOCATION OF 0398 02495000
*                                      THE CRA                       */ 02496000
*      2 DS4R2TIM CHAR(8),          /* VSAM VOLUME/CATALOG MATCH TIME   02497000
*                                      STAMP                         */ 02498000
*      2 * CHAR(5),                 /* RESERVED                      */ 02499000
*      2 DS4F6PTR CHAR(5),          /* POINTER TO FIRST FORMAT 6 DSCB*/ 02500000
*      2 DS4VTOCE CHAR(10),         /* VTOC EXTENT DESCRIPTION       */ 02501000
*      2 * CHAR(25),                /* RESERVED                      */ 02502000
*      2 DS4END CHAR(0);            /* END OF THE FORMAT 4 DSCB      */ 02503000
*                                                                  0399 02504000
*   /*****************************************************************/ 02505000
*   /*                                                               */ 02506000
*   /* INPUT PARAMETERS PASSED TO IDCRDDS                            */ 02507000
*   /*                                                               */ 02508000
*   /*****************************************************************/ 02509000
*                                                                  0399 02510000
*   DCL                                                            0399 02511000
*                                                                  0399 02512000
*     /***************************************************************/ 02513000
*     /*                                                             */ 02514000
*     /* 'INPUT' OR 'OUTPUT' PROCESSING KEYWORD                      */ 02515000
*     /*                                                             */ 02516000
*     /***************************************************************/ 02517000
*                                                                  0399 02518000
*     IOPARM CHAR(1),                                              0399 02519000
*                                                                  0399 02520000
*     /***************************************************************/ 02521000
*     /*                                                             */ 02522000
*     /* ENDING ADDRESS (CCHHR) OF RANGE PASSED BY IDCRD05           */ 02523000
*     /*                                                             */ 02524000
*     /***************************************************************/ 02525000
*                                                                  0399 02526000
*     TOCHRVAL CHAR(5);                                            0399 02527000
*                                                                  0399 02528000
*   /*****************************************************************/ 02529000
*   /*                                                               */ 02530000
*   /* IDCRDDS DYNAMIC STORAGE AREAS                                 */ 02531000
*   /*                                                               */ 02532000
*   /*****************************************************************/ 02533000
*                                                                  0400 02534000
*   DCL                                                            0400 02535000
*                                                                  0400 02536000
*     /***************************************************************/ 02537000
*     /*                                                             */ 02538000
*     /* STORAGE SIZE OF I/O BUFFER REQUESTED                        */ 02539000
*     /*                                                             */ 02540000
*     /***************************************************************/ 02541000
*                                                                  0400 02542000
*     REQBYTES FIXED(31),                                          0400 02543000
*                                                                  0400 02544000
*     /***************************************************************/ 02545000
*     /*                                                             */ 02546000
*     /* POINTER TO BUFFER POOL STORAGE ADDRESS                      */ 02547000
*     /*                                                             */ 02548000
*     /***************************************************************/ 02549000
*                                                                  0400 02550000
*     REQADDR PTR(31),                                             0400 02551000
*                                                                  0400 02552000
*     /***************************************************************/ 02553000
*     /*                                                             */ 02554000
*     /* POINTER TO DEVTYPE SVC RETURN AREA                          */ 02555000
*     /*                                                             */ 02556000
*     /***************************************************************/ 02557000
*                                                                  0400 02558000
*     DEVAREAP PTR(31),                                            0400 02559000
*                                                                  0400 02560000
*     /***************************************************************/ 02561000
*     /*                                                             */ 02562000
*     /* POINTER TO DDNAME                                           */ 02563000
*     /*                                                             */ 02564000
*     /***************************************************************/ 02565000
*                                                                  0400 02566000
*     DEVDD PTR(31),                                               0400 02567000
*                                                                  0400 02568000
*     /***************************************************************/ 02569000
*     /*                                                             */ 02570000
*     /* POINTER TO UIOINFO RETURN AREA                              */ 02571000
*     /*                                                             */ 02572000
*     /***************************************************************/ 02573000
*                                                                  0400 02574000
*     INFOPTR PTR(31),                                             0400 02575000
*                                                                  0400 02576000
*     /***************************************************************/ 02577000
*     /*                                                             */ 02578000
*     /* POINTER TO USYSINFO RETURN AREA                             */ 02579000
*     /*                                                             */ 02580000
*     /***************************************************************/ 02581000
*                                                                  0400 02582000
*     SINFPTR PTR(31),                                             0400 02583000
*                                                                  0400 02584000
*     /***************************************************************/ 02585000
*     /*                                                             */ 02586000
*     /* POINTER TO THE UCB IN USYSINFO RETURN AREA                  */ 02587000
*     /*                                                             */ 02588000
*     /***************************************************************/ 02589000
*                                                                  0400 02590000
*     SINFAREA PTR(31) BASED(SINFPTR),                             0400 02591000
*                                                                  0400 02592000
*     /***************************************************************/ 02593000
*     /*                                                             */ 02594000
*     /* WTOR ECB                                                    */ 02595000
*     /*                                                             */ 02596000
*     /***************************************************************/ 02597000
*                                                                  0400 02598000
*     WTORECB CHAR(4) BDY(WORD),                                   0400 02599000
*                                                                  0400 02600000
*     /***************************************************************/ 02601000
*     /*                                                             */ 02602000
*     /* WORKING POINTER TO XTNTTBL                                  */ 02603000
*     /*                                                             */ 02604000
*     /***************************************************************/ 02605000
*                                                                  0400 02606000
*     XTNTPTR PTR(31),                                             0400 02607000
*                                                                  0400 02608000
*     /***************************************************************/ 02609000
*     /*                                                             */ 02610000
*     /* WORKING POINTER TO XTNTTBL2                                 */ 02611000
*     /*                                                             */ 02612000
*     /***************************************************************/ 02613000
*                                                                  0400 02614000
*     XTNTPTR2 PTR(31),                                            0400 02615000
*                                                                  0400 02616000
*     /***************************************************************/ 02617000
*     /*                                                             */ 02618000
*     /* WTOR REPLY AREA                                             */ 02619000
*     /*                                                             */ 02620000
*     /***************************************************************/ 02621000
*                                                                  0400 02622000
*     WTOREPLY CHAR(1),                                            0400 02623000
*                                                                  0400 02624000
*     /***************************************************************/ 02625000
*     /*                                                             */ 02626000
*     /* UIOINFO OPTION BYTE                                         */ 02627000
*     /*                                                             */ 02628000
*     /***************************************************************/ 02629000
*                                                                  0400 02630000
*     INFOBYT CHAR(1),                                             0400 02631000
*                                                                  0400 02632000
*     /***************************************************************/ 02633000
*     /*                                                             */ 02634000
*     /* EXTENT TABLE ENTRY SAVE AREA                                */ 02635000
*     /*                                                             */ 02636000
*     /***************************************************************/ 02637000
*                                                                  0400 02638000
*     XTNTHOLD CHAR(LENGTH(XTNTENT)),                              0400 02639000
*                                                                  0400 02640000
*     /***************************************************************/ 02641000
*     /*                                                             */ 02642000
*     /* FORMAT 1 ADDRESS (CCHHR) SAVE AREA                          */ 02643000
*     /*                                                             */ 02644000
*     /***************************************************************/ 02645000
*                                                                  0400 02646000
*     FMT1ADDR CHAR(5),                                            0400 02647000
*                                                                  0400 02648000
*     /***************************************************************/ 02649000
*     /*                                                             */ 02650000
*     /* DDNAME SAVE AREA                                            */ 02651000
*     /*                                                             */ 02652000
*     /***************************************************************/ 02653000
*                                                                  0400 02654000
*     INFODD CHAR(8);                                              0400 02655000
*                                                                  0400 02656000
*   /*****************************************************************/ 02657000
*   /*                                                               */ 02658000
*   /* WTOR LIST FORM AND CAMLST NOTE THAT ADDRESSES IN CAMLST ARE   */ 02659000
*   /* PLACE HOLDERS ONLY ONLY AND WILL BE FILLED IN LATER           */ 02660000
*   /*                                                               */ 02661000
*   /*****************************************************************/ 02662000
*                                                                  0401 02663000
*   GEN DATA;                                                      0401 02664000
*                                                                  0401 02665000
*   /*****************************************************************/ 02666000
*   /*                                                               */ 02667000
*   /* DECLARES OF AREAS GENED FOR WTOR AND OBTAIN SVC'S             */ 02668000
*   /*                                                               */ 02669000
*   /*****************************************************************/ 02670000
*                                                                  0402 02671000
*   DCL                                                            0402 02672000
*     LWTORLST GEND CHAR(LENGTH(WTORLIST));                        0402 02673000
*   DCL                                                            0403 02674000
*     CAMLIST GEND CHAR(16);                                       0403 02675000
*                                                                  0403 02676000
*   /*****************************************************************/ 02677000
*   /*                                                               */ 02678000
*   /* OVERLAY STRUCTURES FOR WTORLIST AND CAMLST                    */ 02679000
*   /*                                                               */ 02680000
*   /*****************************************************************/ 02681000
*                                                                  0404 02682000
*   DCL                                                            0404 02683000
*     WTORLIST CHAR(84) BDY(WORD);                                 0404 02684000
*   DCL                                                            0405 02685000
*     1 CAM1 BDY(WORD),                                            0405 02686000
*      2 * CHAR(4),                                                0405 02687000
*      2 CAMDSN FIXED(31),                                         0405 02688000
*      2 CAMVOL FIXED(31),                                         0405 02689000
*      2 CAMWA FIXED(31);                                          0405 02690000
*                                                                  0405 02691000
*   /*****************************************************************/ 02692000
*   /*                                                               */ 02693000
*   /* OBTAIN WORK AREA                                              */ 02694000
*   /*                                                               */ 02695000
*   /*****************************************************************/ 02696000
*                                                                  0406 02697000
*   DCL                                                            0406 02698000
*     OBTAINWA CHAR(148) BDY(DWORD);                               0406 02699000
*                                                                  0406 02700000
*   /*****************************************************************/ 02701000
*   /*                                                               */ 02702000
*   /* IDCRDDS CONSTANTS                                             */ 02703000
*   /*                                                               */ 02704000
*   /*****************************************************************/ 02705000
*                                                                  0407 02706000
*   DCL                                                            0407 02707000
*                                                                  0407 02708000
*     /***************************************************************/ 02709000
*     /*                                                             */ 02710000
*     /* QNAME FOR URESERVE                                          */ 02711000
*     /*                                                             */ 02712000
*     /***************************************************************/ 02713000
*                                                                  0407 02714000
*     SYSVTOC CHAR(8) CONSTANT('SYSVTOC '),                        0407 02715000
*                                                                  0407 02716000
*     /***************************************************************/ 02717000
*     /*                                                             */ 02718000
*     /* FIXED BLOCK STANDARD RECORD FORMAT                          */ 02719000
*     /*                                                             */ 02720000
*     /***************************************************************/ 02721000
*                                                                  0407 02722000
*     FBS BIT(8) CONSTANT('88'X),                                  0407 02723000
*                                                                  0407 02724000
*     /***************************************************************/ 02725000
*     /*                                                             */ 02726000
*     /* FBS INDICATOR FOR REPAIR WORKFILE                           */ 02727000
*     /*                                                             */ 02728000
*     /***************************************************************/ 02729000
*                                                                  0407 02730000
*     FXBLKSTD CHAR(1) CONSTANT('F'),                              0407 02731000
*                                                                  0407 02732000
*     /***************************************************************/ 02733000
*     /*                                                             */ 02734000
*     /* VTOCHEADER DSNAME                                           */ 02735000
*     /*                                                             */ 02736000
*     /***************************************************************/ 02737000
*                                                                  0407 02738000
*     VHDRDSN CHAR(LENGTH(RWFHDSNU)) INIT('VTOCHEADER'),           0407 02739000
*                                                                  0407 02740000
*     /***************************************************************/ 02741000
*     /*                                                             */ 02742000
*     /* VTOC DSNAME                                                 */ 02743000
*     /*                                                             */ 02744000
*     /***************************************************************/ 02745000
*                                                                  0407 02746000
*     FMT4DSCB CHAR(LENGTH(RWFHDSNU)) INIT('FORMAT4.DSCB'),        0407 02747000
*                                                                  0407 02748000
*     /***************************************************************/ 02749000
*     /*                                                             */ 02750000
*     /* UGPOOL/UFPOOL STORAGE ID                                    */ 02751000
*     /*                                                             */ 02752000
*     /***************************************************************/ 02753000
*                                                                  0407 02754000
*     RD01 CHAR(4) CONSTANT('RD01'),                               0407 02755000
*                                                                  0407 02756000
*     /***************************************************************/ 02757000
*     /*                                                             */ 02758000
*     /* INPUT PARAMETER PASSED TO IDCRDDS BY IDCRD05                */ 02759000
*     /*                                                             */ 02760000
*     /***************************************************************/ 02761000
*                                                                  0407 02762000
*     INPUT CHAR(1) CONSTANT('I'),                                 0407 02763000
*                                                                  0407 02764000
*     /***************************************************************/ 02765000
*     /*                                                             */ 02766000
*     /* OUTPUT PARAMETER PASSED TO IDCRDDS BY IDCRD05               */ 02767000
*     /*                                                             */ 02768000
*     /***************************************************************/ 02769000
*                                                                  0407 02770000
*     OUTPUT CHAR(1) CONSTANT('O'),                                0407 02771000
*                                                                  0407 02772000
*     /***************************************************************/ 02773000
*     /*                                                             */ 02774000
*     /* OPERATOR REPLY OF 'Y' (YES)                                 */ 02775000
*     /*                                                             */ 02776000
*     /***************************************************************/ 02777000
*                                                                  0407 02778000
*     Y CHAR(1) CONSTANT('Y'),                                     0407 02779000
*                                                                  0407 02780000
*     /***************************************************************/ 02781000
*     /*                                                             */ 02782000
*     /* OPERATOR REPLY OF 'N' (NO)                                  */ 02783000
*     /*                                                             */ 02784000
*     /***************************************************************/ 02785000
*                                                                  0407 02786000
*     N CHAR(1) CONSTANT('N'),                                     0407 02787000
*                                                                  0407 02788000
*     /***************************************************************/ 02789000
*     /*                                                             */ 02790000
*     /* VSAM FORMAT INDICATOR                                       */ 02791000
*     /*                                                             */ 02792000
*     /***************************************************************/ 02793000
*                                                                  0407 02794000
*     VSAMFMT BIT(8) CONSTANT('08'X),                              0407 02795000
*                                                                  0407 02796000
*     /***************************************************************/ 02797000
*     /*                                                             */ 02798000
*     /* VTOC RECORD LENGTH                                          */ 02799000
*     /*                                                             */ 02800000
*     /***************************************************************/ 02801000
*                                                                  0407 02802000
*     VTOCRECL FIXED(31) CONSTANT(96),                             0407 02803000
*                                                                  0407 02804000
*     /***************************************************************/ 02805000
*     /*                                                             */ 02806000
*     /* VTOC KEY LENGTH                                             */ 02807000
*     /*                                                             */ 02808000
*     /***************************************************************/ 02809000
*                                                                  0407 02810000
*     VTOCKEYL FIXED(31) CONSTANT(44),                             0407 02811000
*                                                                  0407 02812000
*     /***************************************************************/ 02813000
*     /*                                                             */ 02814000
*     /* FORMAT1 DSCB IDENTIFIER                                     */ 02815000
*     /*                                                             */ 02816000
*     /***************************************************************/ 02817000
*                                                                  0407 02818000
*     FMT1ID BIT(8) CONSTANT('F1'X),                               0407 02819000
*                                                                  0407 02820000
*     /***************************************************************/ 02821000
*     /*                                                             */ 02822000
*     /* FORMAT3 DSCB IDENTIFIER                                     */ 02823000
*     /*                                                             */ 02824000
*     /***************************************************************/ 02825000
*                                                                  0407 02826000
*     FMT3ID BIT(8) CONSTANT('F3'X),                               0407 02827000
*                                                                  0407 02828000
*     /***************************************************************/ 02829000
*     /*                                                             */ 02830000
*     /* MODIFY ENQ INDICATOR                                        */ 02831000
*     /*                                                             */ 02832000
*     /***************************************************************/ 02833000
*                                                                  0407 02834000
*     MODENQ BIT(8) CONSTANT('80'X),                               0407 02835000
*                                                                  0407 02836000
*     /***************************************************************/ 02837000
*     /*                                                             */ 02838000
*     /* REPAIRV OPEN KEYWORD PASSED TO UEXCP                        */ 02839000
*     /*                                                             */ 02840000
*     /***************************************************************/ 02841000
*                                                                  0407 02842000
*     OPENR CHAR(8) CONSTANT('OPENR   ');                          0407 02843000
*                                                                  0407 02844000
*   /*****************************************************************/ 02845000
*   /*                                                               */ 02846000
*   /* FIELDS OF ZEROS                                               */ 02847000
*   /*                                                               */ 02848000
*   /*****************************************************************/ 02849000
*                                                                  0408 02850000
*   DCL                                                            0408 02851000
*     ZERO FIXED(15) CONSTANT(0);   /*                       @ZA17169*/ 02852000
*   DCL                                                            0409 02853000
*     1 ZEROS STATIC LOCAL,                                        0409 02854000
*      2 *(8) BIT(8) INIT((8)'00'X);                               0409 02855000
*                                                                  0409 02856000
*   /*****************************************************************/ 02857000
*   /*                                                               */ 02858000
*   /* LAST XTNTTBL ENTRY INDICATOR                                  */ 02859000
*   /*                                                               */ 02860000
*   /*****************************************************************/ 02861000
*                                                                  0410 02862000
*   DCL                                                            0410 02863000
*     1 LASTENT STATIC LOCAL,                                      0410 02864000
*      2 *(LENGTH(XTNTENT)) CHAR(1) INIT((LENGTH(XTNTENT))'FF'X);  0410 02865000
*                                                                  0410 02866000
*   /*****************************************************************/ 02867000
*   /*                                                               */ 02868000
*   /* IDCRDRD RETURN CODES                                          */ 02869000
*   /*                                                               */ 02870000
*   /*****************************************************************/ 02871000
*                                                                  0411 02872000
*   DCL                                                            0411 02873000
*                                                                  0411 02874000
*     /***************************************************************/ 02875000
*     /*                                                             */ 02876000
*     /* NORMAL RETURN                                               */ 02877000
*     /*                                                             */ 02878000
*     /***************************************************************/ 02879000
*                                                                  0411 02880000
*     RC01 FIXED(31) CONSTANT(1),                                  0411 02881000
*                                                                  0411 02882000
*     /***************************************************************/ 02883000
*     /*                                                             */ 02884000
*     /* END-OF-FILE                                                 */ 02885000
*     /*                                                             */ 02886000
*     /***************************************************************/ 02887000
*                                                                  0411 02888000
*     RC29 FIXED(31) CONSTANT(29),                                 0411 02889000
*                                                                  0411 02890000
*     /***************************************************************/ 02891000
*     /*                                                             */ 02892000
*     /* END-OF-TRACK                                                */ 02893000
*     /*                                                             */ 02894000
*     /***************************************************************/ 02895000
*                                                                  0411 02896000
*     RC30 FIXED(31) CONSTANT(31);                                 0411 02897000
*                                                                  0411 02898000
*   /*****************************************************************/ 02899000
*   /*                                                               */ 02900000
*   /* MESSAGE INDICES USED BY IDCRDER TO INDEX TO THE REQUESTED     */ 02901000
*   /* MESSAGE                                                       */ 02902000
*   /*                                                               */ 02903000
*   /*****************************************************************/ 02904000
*                                                                  0412 02905000
*   DCL                                                            0412 02906000
*                                                                  0412 02907000
*     /***************************************************************/ 02908000
*     /*                                                             */ 02909000
*     /* ERROR MESSAGE IDC31203I                                     */ 02910000
*     /*                                                             */ 02911000
*     /***************************************************************/ 02912000
*                                                                  0412 02913000
*     MSG03 FIXED(8) CONSTANT(3),                                  0412 02914000
*                                                                  0412 02915000
*     /***************************************************************/ 02916000
*     /*                                                             */ 02917000
*     /* ERROR MESSAGE IDC31204I                                     */ 02918000
*     /*                                                             */ 02919000
*     /***************************************************************/ 02920000
*                                                                  0412 02921000
*     MSG04 FIXED(8) CONSTANT(4),                                  0412 02922000
*                                                                  0412 02923000
*     /***************************************************************/ 02924000
*     /*                                                             */ 02925000
*     /* ERROR MESSAGE IDC31205I                                     */ 02926000
*     /*                                                             */ 02927000
*     /***************************************************************/ 02928000
*                                                                  0412 02929000
*     MSG05 FIXED(8) CONSTANT(5),                                  0412 02930000
*                                                                  0412 02931000
*     /***************************************************************/ 02932000
*     /*                                                             */ 02933000
*     /* ERROR MESSAGE IDC31206I                                     */ 02934000
*     /*                                                             */ 02935000
*     /***************************************************************/ 02936000
*                                                                  0412 02937000
*     MSG06 FIXED(8) CONSTANT(6),                                  0412 02938000
*                                                                  0412 02939000
*     /***************************************************************/ 02940000
*     /*                                                             */ 02941000
*     /* ERROR MESSAGE IDC31207I                                     */ 02942000
*     /*                                                             */ 02943000
*     /***************************************************************/ 02944000
*                                                                  0412 02945000
*     MSG07 FIXED(8) CONSTANT(7),                                  0412 02946000
*                                                                  0412 02947000
*     /***************************************************************/ 02948000
*     /*                                                             */ 02949000
*     /* ERROR MESSAGE IDC31208I                                     */ 02950000
*     /*                                                             */ 02951000
*     /***************************************************************/ 02952000
*                                                                  0412 02953000
*     MSG08 FIXED(8) CONSTANT(8),                                  0412 02954000
*                                                                  0412 02955000
*     /***************************************************************/ 02956000
*     /*                                                             */ 02957000
*     /* ERROR MESSAGE IDC31209I                                     */ 02958000
*     /*                                                             */ 02959000
*     /***************************************************************/ 02960000
*                                                                  0412 02961000
*     MSG09 FIXED(8) CONSTANT(9),                                  0412 02962000
*                                                                  0412 02963000
*     /***************************************************************/ 02964000
*     /*                                                             */ 02965000
*     /* ERROR MESSAGE IDC31210I                                     */ 02966000
*     /*                                                             */ 02967000
*     /***************************************************************/ 02968000
*                                                                  0412 02969000
*     MSG10 FIXED(8) CONSTANT(10),                                 0412 02970000
*                                                                  0412 02971000
*     /***************************************************************/ 02972000
*     /*                                                             */ 02973000
*     /* ERROR MESSAGE IDC31211I                                     */ 02974000
*     /*                                                             */ 02975000
*     /***************************************************************/ 02976000
*                                                                  0412 02977000
*     MSG11 FIXED(8) CONSTANT(11),                                 0412 02978000
*                                                                  0412 02979000
*     /***************************************************************/ 02980000
*     /*                                                             */ 02981000
*     /* ERROR MESSAGE IDC31212I                                     */ 02982000
*     /*                                                             */ 02983000
*     /***************************************************************/ 02984000
*                                                                  0412 02985000
*     MSG12 FIXED(8) CONSTANT(12),                                 0412 02986000
*                                                                  0412 02987000
*     /***************************************************************/ 02988000
*     /*                                                             */ 02989000
*     /* ERROR MESSAGE IDC31221I                                     */ 02990000
*     /*                                                             */ 02991000
*     /***************************************************************/ 02992000
*                                                                  0412 02993000
*     MSG21 FIXED(8) CONSTANT(21),                                 0412 02994000
*                                                                  0412 02995000
*     /***************************************************************/ 02996000
*     /*                                                             */ 02997000
*     /* ERROR MESSAGE IDC31223I                                     */ 02998000
*     /*                                                             */ 02999000
*     /***************************************************************/ 03000000
*                                                                  0412 03001000
*     MSG23 FIXED(8) CONSTANT(23),                                 0412 03002000
*                                                                  0412 03003000
*     /***************************************************************/ 03004000
*     /*                                                             */ 03005000
*     /* ERROR MESSAGE IDC31233I                                     */ 03006000
*     /*                                                             */ 03007000
*     /***************************************************************/ 03008000
*                                                                  0412 03009000
*     MSG33 FIXED(8) CONSTANT(33),                                 0412 03010000
*                                                                  0412 03011000
*     /***************************************************************/ 03012000
*     /*                                                             */ 03013000
*     /* ERROR MESSAGE IDC31234I                                     */ 03014000
*     /*                                                             */ 03015000
*     /***************************************************************/ 03016000
*                                                                  0412 03017000
*     MSG34 FIXED(8) CONSTANT(34),                                 0412 03018000
*                                                                  0412 03019000
*     /***************************************************************/ 03020000
*     /*                                                             */ 03021000
*     /* ERROR MESSAGE IDC31235I                                     */ 03022000
*     /*                                                             */ 03023000
*     /***************************************************************/ 03024000
*                                                                  0412 03025000
*     MSG35 FIXED(8) CONSTANT(35),                                 0412 03026000
*                                                                  0412 03027000
*     /***************************************************************/ 03028000
*     /*                                                             */ 03029000
*     /* ERROR MESSAGE IDC31239I                                     */ 03030000
*     /*                                                             */ 03031000
*     /***************************************************************/ 03032000
*                                                                  0412 03033000
*     MSG39 FIXED(8) CONSTANT(39),                                 0412 03034000
*                                                                  0412 03035000
*     /***************************************************************/ 03036000
*     /*                                                             */ 03037000
*     /* ERROR MESSAGE IDC31240I                                     */ 03038000
*     /*                                                             */ 03039000
*     /***************************************************************/ 03040000
*                                                                  0412 03041000
*     MSG40 FIXED(8) CONSTANT(40),                                 0412 03042000
*                                                                  0412 03043000
*     /***************************************************************/ 03044000
*     /*                                                             */ 03045000
*     /* ERROR MESSAGE IDC31246I                                     */ 03046000
*     /*                                                             */ 03047000
*     /***************************************************************/ 03048000
*                                                                  0412 03049000
*     MSG46 FIXED(8) CONSTANT(46),                                 0412 03050000
*                                                                  0412 03051000
*     /***************************************************************/ 03052000
*     /*                                                             */ 03053000
*     /* WTOR MESSAGE IDC498D - ACCESS TO STAGING PACK               */ 03054000
*     /*                                                             */ 03055000
*     /***************************************************************/ 03056000
*                                                                  0412 03057000
*     MSG77 FIXED(8) CONSTANT(77),                                 0412 03058000
*                                                                  0412 03059000
*     /***************************************************************/ 03060000
*     /*                                                             */ 03061000
*     /* WTOR MESSAGE IDC498D - ACCESS TO VTOCHEADER                 */ 03062000
*     /*                                                             */ 03063000
*     /***************************************************************/ 03064000
*                                                                  0412 03065000
*     MSG78 FIXED(8) CONSTANT(78),                                 0412 03066000
*                                                                  0412 03067000
*     /***************************************************************/ 03068000
*     /*                                                             */ 03069000
*     /* WTOR MESSAGE IDC498D - ACCESS TO VTOC                       */ 03070000
*     /*                                                             */ 03071000
*     /***************************************************************/ 03072000
*                                                                  0412 03073000
*     MSG79 FIXED(8) CONSTANT(79),                                 0412 03074000
*                                                                  0412 03075000
*     /***************************************************************/ 03076000
*     /*                                                             */ 03077000
*     /* UNIVERSAL TEXT MESSAGE IDC3004I                             */ 03078000
*     /*                                                             */ 03079000
*     /***************************************************************/ 03080000
*                                                                  0412 03081000
*     MSG93 FIXED(8) CONSTANT(93);                                 0412 03082000
*                                                                  0412 03083000
*   /*****************************************************************/ 03084000
*   /*                                                               */ 03085000
*   /* WTOR REQUIRED AREAS AND CONSTANTS                             */ 03086000
*   /*                                                               */ 03087000
*   /*****************************************************************/ 03088000
*                                                                  0413 03089000
*   DCL                                                            0413 03090000
*     DARGL CHAR(LENGTH(DARGLIST)) BDY(WORD);                      0413 03091000
*   DCL                                                            0414 03092000
*     WTORID CHAR(3) CONSTANT('RD0');                              0414 03093000
*                                                                  0414 03094000
*   /*****************************************************************/ 03095000
*   /*                                                               */ 03096000
*   /* VTOC DATA SET NAME                                            */ 03097000
*   /*                                                               */ 03098000
*   /*****************************************************************/ 03099000
*                                                                  0415 03100000
*   DCL                                                            0415 03101000
*     1 FMT4DSN STATIC LOCAL,                                      0415 03102000
*      2 *(LENGTH(XTNHDSN)) CHAR(1) INIT((LENGTH(XTNHDSN))'04'X);  0415 03103000
*                                                                  0415 03104000
*   /*****************************************************************/ 03105000
*   /*                                                               */ 03106000
*   /* BLANK DSNAME                                                  */ 03107000
*   /*                                                               */ 03108000
*   /*****************************************************************/ 03109000
*                                                                  0416 03110000
*   DCL                                                            0416 03111000
*     1 BLANKS STATIC LOCAL,                                       0416 03112000
*      2 *(LENGTH(XTNHDSN)) CHAR(1) INIT((LENGTH(XTNHDSN))'40'X);  0416 03113000
*                                                                  0416 03114000
*   /*****************************************************************/ 03115000
*   /*                                                               */ 03116000
*   /* UIOINFO RETURN AREA SCAN STRUCTURE                            */ 03117000
*   /*                                                               */ 03118000
*   /*****************************************************************/ 03119000
*                                                                  0417 03120000
*   DCL                                                            0417 03121000
*     1 INFOSCAN BASED,                                            0417 03122000
*      2 INFSCNID CHAR(2),                                         0417 03123000
*      2 INFSCNLN FIXED(16),                                       0417 03124000
*      2 INFSCNAR CHAR(*);                                         0417 03125000
*                                                                  0417 03126000
*   /*****************************************************************/ 03127000
*   /*                                                               */ 03128000
*   /* UIOINFO RETURN AREA POINTERS                                  */ 03129000
*   /*                                                               */ 03130000
*   /*****************************************************************/ 03131000
*                                                                  0418 03132000
*   DCL                                                            0418 03133000
*                                                                  0418 03134000
*     /***************************************************************/ 03135000
*     /*                                                             */ 03136000
*     /* UIOINFO RETURN AREA SCAN POINTER                            */ 03137000
*     /*                                                             */ 03138000
*     /***************************************************************/ 03139000
*                                                                  0418 03140000
*     INFSCNPT PTR(31),                                            0418 03141000
*                                                                  0418 03142000
*     /***************************************************************/ 03143000
*     /*                                                             */ 03144000
*     /* DATA SET NAME POINTER                                       */ 03145000
*     /*                                                             */ 03146000
*     /***************************************************************/ 03147000
*                                                                  0418 03148000
*     INFDSNPT PTR(31),                                            0418 03149000
*                                                                  0418 03150000
*     /***************************************************************/ 03151000
*     /*                                                             */ 03152000
*     /* VOLUME SERIAL LIST POINTER.                                 */ 03153000
*     /*                                                             */ 03154000
*     /***************************************************************/ 03155000
*                                                                  0418 03156000
*     INFVOLPT PTR(31);                                            0418 03157000
*                                                                  0418 03158000
*   /*****************************************************************/ 03159000
*   /*                                                               */ 03160000
*   /* VOLUME SERIAL LIST IDENTIFIER                                 */ 03161000
*   /*                                                               */ 03162000
*   /*****************************************************************/ 03163000
*                                                                  0419 03164000
*   DCL                                                            0419 03165000
*     VOLIDENT FIXED(16) CONSTANT(2);                              0419 03166000
*                                                                  0419 03167000
*   /*****************************************************************/ 03168000
*   /*                                                               */ 03169000
*   /* DATA SET NAME IDENTIFIER                                      */ 03170000
*   /*                                                               */ 03171000
*   /*****************************************************************/ 03172000
*                                                                  0420 03173000
*   DCL                                                            0420 03174000
*     DSNIDENT FIXED(16) CONSTANT(1);                              0420 03175000
*                                                                  0420 03176000
*   /*****************************************************************/ 03177000
*   /*                                                               */ 03178000
*   /* PARAMETER CONSTANTS                                           */ 03179000
*   /*                                                               */ 03180000
*   /*****************************************************************/ 03181000
*                                                                  0421 03182000
*   DCL                                                            0421 03183000
*                                                                  0421 03184000
*     /***************************************************************/ 03185000
*     /*                                                             */ 03186000
*     /* OBTAIN PARAMTER                                             */ 03187000
*     /*                                                             */ 03188000
*     /***************************************************************/ 03189000
*                                                                  0421 03190000
*     OBTAIN CHAR(8) CONSTANT('OBTAIN  '),                         0421 03191000
*                                                                  0421 03192000
*     /***************************************************************/ 03193000
*     /*                                                             */ 03194000
*     /* DATASETRANGE PARAMETER                                      */ 03195000
*     /*                                                             */ 03196000
*     /***************************************************************/ 03197000
*                                                                  0421 03198000
*     DSRANGE CHAR(17) CONSTANT('DATASETRANGE     '),              0421 03199000
*                                                                  0421 03200000
*     /***************************************************************/ 03201000
*     /*                                                             */ 03202000
*     /* INDATASETADDRESS PARAMETER                                  */ 03203000
*     /*                                                             */ 03204000
*     /***************************************************************/ 03205000
*                                                                  0421 03206000
*     INDSADD CHAR(17) CONSTANT('INDATASETADDRESS '),              0421 03207000
*                                                                  0421 03208000
*     /***************************************************************/ 03209000
*     /*                                                             */ 03210000
*     /* OUTDATASETADDRESS PARAMETER                                 */ 03211000
*     /*                                                             */ 03212000
*     /***************************************************************/ 03213000
*                                                                  0421 03214000
*     OUTDSADD CHAR(17) CONSTANT('OUTDATASETADDRESS'),             0421 03215000
*                                                                  0421 03216000
*     /***************************************************************/ 03217000
*     /*                                                             */ 03218000
*     /* VTOCHEADERADDRESS PARAMETER                                 */ 03219000
*     /*                                                             */ 03220000
*     /***************************************************************/ 03221000
*                                                                  0421 03222000
*     VHDRADD CHAR(17) CONSTANT('VTOCHEADERADDRESS'),              0421 03223000
*                                                                  0421 03224000
*     /***************************************************************/ 03225000
*     /*                                                             */ 03226000
*     /* STAGINGRANGE PARAMETER                                      */ 03227000
*     /*                                                             */ 03228000
*     /***************************************************************/ 03229000
*                                                                  0421 03230000
*     SRRANGE CHAR(17) CONSTANT('STAGINGRANGE     '),              0421 03231000
*                                                                  0421 03232000
*     /***************************************************************/ 03233000
*     /*                                                             */ 03234000
*     /* PARAMETER HOLD AREA FOR MESSAGE                             */ 03235000
*     /*                                                             */ 03236000
*     /***************************************************************/ 03237000
*                                                                  0421 03238000
*     PARMHOLD CHAR(17);                                           0421 03239000
*                                                                  0421 03240000
*   /*****************************************************************/ 03241000
*   /*                                                               */ 03242000
*   /* VTOC ADDRESS STRUCTURE                                        */ 03243000
*   /*                                                               */ 03244000
*   /*****************************************************************/ 03245000
*                                                                  0422 03246000
*   DCL                                                            0422 03247000
*     1 VTOCADDR,                                                  0422 03248000
*      2 VTOCCC FIXED(15),                                         0422 03249000
*      2 VTOCHH FIXED(15),                                         0422 03250000
*      2 VTOCR FIXED(8);                                           0422 03251000
*                                                                  0422 03252000
*   /*****************************************************************/ 03253000
*   /*                                                               */ 03254000
*   /* DCSB STRUCTURE                                                */ 03255000
*   /*                                                               */ 03256000
*   /*****************************************************************/ 03257000
*                                                                  0423 03258000
*   DCL                                                            0423 03259000
*     1 DSCBAREA BASED(IOCDAD),                                    0423 03260000
*      2 * CHAR(44),                                               0423 03261000
*      2 DSCBID FIXED(8);                                          0423 03262000
*                                                                  0424 03263000
*   /*****************************************************************/ 03264000
*   /*                                                               */ 03265000
*   /* ENTRY POINT FOR PROCEDURE IDCRDDS                             */ 03266000
*   /*                                                               */ 03267000
*   /*****************************************************************/ 03268000
*                                                                  0424 03269000
*   GEN(ENTRY IDCRDDS);                                            0424 03270000
         ENTRY IDCRDDS                                                  03271000
*   GEN(L REG6,SPLITSV1);                                          0425 03272000
         L REG6,SPLITSV1                                                03273000
*   LM(REG9,REG12,SPLITSAV);                                       0426 03274000
*                                                                  0426 03275000
         LM    REG9,REG12,SPLITSAV                                 0426 03276000
*   /*****************************************************************/ 03277000
*   /*                                                               */ 03278000
*   /* SET TRACE AND DUMP POINTS                                     */ 03279000
*   /*                                                               */ 03280000
*   /*****************************************************************/ 03281000
*                                                                  0427 03282000
*   IF GDTDBG=NULLPTR THEN                                         0427 03283000
         L     @04,@PC00001                                        0427 03284000
         L     @04,GDTDBG(,@04)                                    0427 03285000
         LTR   @04,@04                                             0427 03286000
         BZ    @RT00427                                            0427 03287000
*     ;                                                            0428 03288000
*   ELSE                                                           0429 03289000
*     CALL IDCDB010(GDTTBL,'RD6H');                                0429 03290000
         L     @04,@PC00001                                        0429 03291000
         ST    @04,@AL00001                                        0429 03292000
         LA    @15,@CC02856                                        0429 03293000
         ST    @15,@AL00001+4                                      0429 03294000
         MVI   @AL00001+4,X'80'                                    0429 03295000
         L     @15,GDTDBG(,@04)                                    0429 03296000
         LA    @01,@AL00001                                        0429 03297000
         BALR  @14,@15                                             0429 03298000
*   OLDERID2=NEWERID2;                                             0430 03299000
@RT00427 L     @04,@PC00001                                        0430 03300000
         L     @04,GDTTR2(,@04)                                    0430 03301000
         MVC   @TS00001(95),NEWERID2(@04)                          0430 03302000
         MVC   OLDERID2(95,@04),@TS00001                           0430 03303000
*   NEWID2='RD6I';                                                 0431 03304000
*                                                                  0431 03305000
         MVC   NEWID2(4,@04),@CC02857                              0431 03306000
*   /*****************************************************************/ 03307000
*   /*                                                               */ 03308000
*   /* SETUP ADDRESSABILITY FOR REFERENCED STRUCTURES                */ 03309000
*   /*                                                               */ 03310000
*   /*****************************************************************/ 03311000
*                                                                  0432 03312000
*   RESPECIFY                                                      0432 03313000
*     IOINFOPT BASED(ADDR(INFOBYT));                               0432 03314000
*   RESPECIFY                                                      0433 03315000
*     INFOAREA BASED(INFOPTR);                                     0433 03316000
*   RESPECIFY                                                      0434 03317000
*     XTNTTBL BASED(XTNTPTR);                                      0434 03318000
*   RESPECIFY                                                      0435 03319000
*     XTNTTBL2 BASED(XTNTPTR2);                                    0435 03320000
*   RESPECIFY                                                      0436 03321000
*     EXOARG BASED(REPEXOAR);                                      0436 03322000
*                                                                  0437 03323000
*   /*****************************************************************/ 03324000
*   /*                                                               */ 03325000
*   /* PROCESSING A VTOCHEADER                                       */ 03326000
*   /*                                                               */ 03327000
*   /*****************************************************************/ 03328000
*                                                                  0437 03329000
*   IF ADDR(DPVTC)^=NULLPTR|ADDR(CVTOC)^=NULLPTR|ADDR(MVTOC)^=NULLPTR   03330000
*     THEN                                                         0437 03331000
         SLR   @04,@04                                             0437 03332000
         L     @15,@PC00001+4                                      0437 03333000
         C     @04,FDTPTR+116(,@15)                                0437 03334000
         BNE   @RT00437                                            0437 03335000
         C     @04,FDTPTR+204(,@15)                                0437 03336000
         BNE   @RT00437                                            0437 03337000
         C     @04,FDTPTR+424(,@15)                                0437 03338000
         BE    @RF00437                                            0437 03339000
@RT00437 DS    0H                                                  0438 03340000
*DSVHDR:                                                           0438 03341000
*     DO;                                                          0438 03342000
*                                                                  0438 03343000
DSVHDR   DS    0H                                                  0439 03344000
*       /*************************************************************/ 03345000
*       /*                                                           */ 03346000
*       /* FOR MODIFY VALIDATE THE CCHHR LENGTH                      */ 03347000
*       /*                                                           */ 03348000
*       /*************************************************************/ 03349000
*                                                                  0439 03350000
*       IF ADDR(MVTOC)^=NULLPTR THEN                               0439 03351000
         SLR   @15,@15                                             0439 03352000
         L     @14,@PC00001+4                                      0439 03353000
         C     @15,FDTPTR+424(,@14)                                0439 03354000
         BE    @RF00439                                            0439 03355000
*         DO;                                                      0440 03356000
*                                                                  0440 03357000
*           /*********************************************************/ 03358000
*           /*                                                       */ 03359000
*           /* THE LENGTH OF THE VTOCHEADERADDRESS PARAMETER MUST BE */ 03360000
*           /* 5 BYTES. IF NOT, PREPARE TO RETURN TO IDCRD05 WITH RC */ 03361000
*           /* = 12                                                  */ 03362000
*           /*                                                       */ 03363000
*           /*********************************************************/ 03364000
*                                                                  0441 03365000
*           IF ADDR(MVTCR)^=NULLPTR&MVTCRLEN^=LENGTH(MVTCRVAL) THEN     03366000
         L     @14,FDTPTR+432(,@14)                                0441 03367000
         CR    @14,@15                                             0441 03368000
         BE    @RF00441                                            0441 03369000
         CLI   MVTCRLEN(@14),5                                     0441 03370000
         BE    @RF00441                                            0441 03371000
*             DO;                                                  0442 03372000
*                                                                  0442 03373000
*               /*****************************************************/ 03374000
*               /*                                                   */ 03375000
*               /* WRITE ERROR MESSAGE IDC31233I                     */ 03376000
*               /*                                                   */ 03377000
*               /*****************************************************/ 03378000
*                                                                  0443 03379000
*               DO;                                                0443 03380000
*                 CKREQ=CKREQ&&CKREQ;                              0444 03381000
         L     @15,@PC00001+8                                      0444 03382000
         XC    CKREQ(44,@15),CKREQ(@15)                            0444 03383000
*                 CKRERN=MSG33;                                    0445 03384000
         MVC   CKRERN(2,@15),@CH02800                              0445 03385000
*                 CKRMVAR(1)=ADDR(VHDRADD);                        0446 03386000
         LA    @05,@CC02842                                        0446 03387000
         ST    @05,CKRMVAR(,@15)                                   0446 03388000
*                 CKRMVAR(2)=ADDR(MVTCRVAL);                       0447 03389000
         LA    @05,MVTCRVAL(,@14)                                  0447 03390000
         ST    @05,CKRMVAR+4(,@15)                                 0447 03391000
*                 CKRMVAR(3)=ADDR(VHDRDSN);                        0448 03392000
         LA    @05,VHDRDSN                                         0448 03393000
         ST    @05,CKRMVAR+8(,@15)                                 0448 03394000
*                 CKRMVAR(4)=ADDR(MVTCRLEN);                       0449 03395000
         ST    @14,CKRMVAR+12(,@15)                                0449 03396000
*                 CALL IDCRDER;                                    0450 03397000
         L     @15,@CV01553                                        0450 03398000
         BALR  @14,@15                                             0450 03399000
*               END;                                               0451 03400000
*                                                                  0451 03401000
*               /*****************************************************/ 03402000
*               /*                                                   */ 03403000
*               /* RETURN TO IDCRD05 WITH RC = 12                    */ 03404000
*               /*                                                   */ 03405000
*               /*****************************************************/ 03406000
*                                                                  0452 03407000
*               RETURN CODE(LASTCC12);                             0452 03408000
         LA    @15,12                                              0452 03409000
         L     @14,@SA00002                                        0452 03410000
         LM    @00,@12,@SA00002+8                                  0452 03411000
         BR    @14                                                 0452 03412000
*             END;                                                 0453 03413000
*         END;                                                     0454 03414000
*                                                                  0454 03415000
@RF00441 DS    0H                                                  0455 03416000
*       /*************************************************************/ 03417000
*       /*                                                           */ 03418000
*       /* INITIALIZE COMMON FIELDS AND POINTERS                     */ 03419000
*       /*                                                           */ 03420000
*       /*************************************************************/ 03421000
*                                                                  0455 03422000
*       IF ADDR(DISPL)^=NULLPTR THEN                               0455 03423000
@RF00439 L     @15,@PC00001+4                                      0455 03424000
         L     @14,FDTPTR(,@15)                                    0455 03425000
         LTR   @14,@14                                             0455 03426000
         BZ    @RF00455                                            0455 03427000
*         DO;                                                      0456 03428000
*           INFODD=INFILVAL;                                       0457 03429000
         L     @04,FDTPTR+12(,@15)                                 0457 03430000
         MVC   INFODD(8),INFILVAL(@04)                             0457 03431000
*           INFOPTR=REPIINFO;                                      0458 03432000
         L     @04,@PC00001+8                                      0458 03433000
         L     @15,REPIINFO(,@04)                                  0458 03434000
         ST    @15,INFOPTR                                         0458 03435000
*           XTNTPTR=REPIXTNT;                                      0459 03436000
         L     XTNTPTR,REPIXTNT(,@04)                              0459 03437000
*         END;                                                     0460 03438000
*       ELSE                                                       0461 03439000
*         IF ADDR(COPY)^=NULLPTR THEN                              0461 03440000
         B     @RC00455                                            0461 03441000
@RF00455 L     @15,@PC00001+4                                      0461 03442000
         L     @14,FDTPTR+136(,@15)                                0461 03443000
         LTR   @14,@14                                             0461 03444000
         BZ    @RF00461                                            0461 03445000
*           DO;                                                    0462 03446000
*             INFODD=CINFLVAL;                                     0463 03447000
         L     @04,FDTPTR+140(,@15)                                0463 03448000
         MVC   INFODD(8),CINFLVAL(@04)                             0463 03449000
*             INFOPTR=REPIINFO;                                    0464 03450000
         L     @04,@PC00001+8                                      0464 03451000
         L     @15,REPIINFO(,@04)                                  0464 03452000
         ST    @15,INFOPTR                                         0464 03453000
*             XTNTPTR=REPIXTNT;                                    0465 03454000
         L     XTNTPTR,REPIXTNT(,@04)                              0465 03455000
*           END;                                                   0466 03456000
*         ELSE                                                     0467 03457000
*           DO;                                                    0467 03458000
         B     @RC00461                                            0467 03459000
@RF00461 DS    0H                                                  0468 03460000
*             INFODD=MOUTFVAL;                                     0468 03461000
         L     @04,@PC00001+4                                      0468 03462000
         L     @04,FDTPTR+412(,@04)                                0468 03463000
         MVC   INFODD(8),MOUTFVAL(@04)                             0468 03464000
*             INFOPTR=REPOINFO;                                    0469 03465000
         L     @04,@PC00001+8                                      0469 03466000
         L     @15,REPOINFO(,@04)                                  0469 03467000
         ST    @15,INFOPTR                                         0469 03468000
*             XTNTPTR=REPOXTNT;                                    0470 03469000
         L     XTNTPTR,REPOXTNT(,@04)                              0470 03470000
*           END;                                                   0471 03471000
*                                                                  0471 03472000
*       /*************************************************************/ 03473000
*       /*                                                           */ 03474000
*       /* CONSTRUCT UIOINFO OPTION BYTE                             */ 03475000
*       /*                                                           */ 03476000
*       /*************************************************************/ 03477000
*                                                                  0472 03478000
*       IOINFOPT=''B;                                              0472 03479000
@RC00461 DS    0H                                                  0472 03480000
@RC00455 LA    @04,INFOBYT                                         0472 03481000
         MVI   IOINFOPT(@04),X'00'                                 0472 03482000
*       IOINFVOL=ON;                                               0473 03483000
*                                                                  0473 03484000
         OI    IOINFVOL(@04),B'01000000'                           0473 03485000
*       /*************************************************************/ 03486000
*       /*                                                           */ 03487000
*       /* ISSUE UIOINFO FOR A LIST OF VOLUME SERIAL NUMBERS.        */ 03488000
*       /*                                                           */ 03489000
*       /*************************************************************/ 03490000
*                                                                  0474 03491000
*       CALL IDCIOSI0(GDTTBL,IOINFOPT,INFOPTR,INFODD);             0474 03492000
*                                                                  0474 03493000
         L     @15,@PC00001                                        0474 03494000
         ST    @15,@AL00001                                        0474 03495000
         ST    @04,@AL00001+4                                      0474 03496000
         LA    @04,INFOPTR                                         0474 03497000
         ST    @04,@AL00001+8                                      0474 03498000
         LA    @04,INFODD                                          0474 03499000
         ST    @04,@AL00001+12                                     0474 03500000
         MVI   @AL00001+12,X'80'                                   0474 03501000
         L     @15,GDTIFO(,@15)                                    0474 03502000
         LA    @01,@AL00001                                        0474 03503000
         BALR  @14,@15                                             0474 03504000
*       /*************************************************************/ 03505000
*       /*                                                           */ 03506000
*       /* SAVE RETURN CODE FROM UIOINFO                             */ 03507000
*       /*                                                           */ 03508000
*       /*************************************************************/ 03509000
*                                                                  0475 03510000
*       RESPECIFY                                                  0475 03511000
*         RTNREG RSTD;                                             0475 03512000
*       TESTRC=RTNREG;                                             0476 03513000
         STH   RTNREG,TESTRC                                       0476 03514000
*       RESPECIFY                                                  0477 03515000
*         RTNREG UNRSTD;                                           0477 03516000
*                                                                  0477 03517000
*       /*************************************************************/ 03518000
*       /*                                                           */ 03519000
*       /* IF UIOINFO FAILS, RETURN TO CALLER WITH RC = 12           */ 03520000
*       /*                                                           */ 03521000
*       /*************************************************************/ 03522000
*                                                                  0478 03523000
*       IF TESTRC^=0 THEN                                          0478 03524000
         LH    @04,TESTRC                                          0478 03525000
         LTR   @04,@04                                             0478 03526000
         BZ    @RF00478                                            0478 03527000
*         RETURN CODE(LASTCC12);                                   0479 03528000
*                                                                  0479 03529000
         LA    @15,12                                              0479 03530000
         L     @14,@SA00002                                        0479 03531000
         LM    @00,@12,@SA00002+8                                  0479 03532000
         BR    @14                                                 0479 03533000
*       /*************************************************************/ 03534000
*       /*                                                           */ 03535000
*       /* SETUP UIOINFO RETURN AREA ADDRESSABILITY                  */ 03536000
*       /*                                                           */ 03537000
*       /*************************************************************/ 03538000
*                                                                  0480 03539000
*       RESPECIFY                                                  0480 03540000
*         INFOSCAN BASED(INFSCNPT);                                0480 03541000
@RF00478 DS    0H                                                  0481 03542000
*       INFSCNPT=ADDR(INFAREA);                                    0481 03543000
*                                                                  0481 03544000
         L     INFSCNPT,INFOPTR                                    0481 03545000
         LA    INFSCNPT,INFAREA(,INFSCNPT)                         0481 03546000
*       /*************************************************************/ 03547000
*       /*                                                           */ 03548000
*       /* LOCATE VOLUME SERIAL LIST INFORMATION RETURNED BY UIOINFO */ 03549000
*       /*                                                           */ 03550000
*       /*************************************************************/ 03551000
*                                                                  0482 03552000
*       IF INFSCNID=VOLIDENT THEN                                  0482 03553000
         CLC   INFSCNID(2,INFSCNPT),@CH00156                       0482 03554000
         BNE   @RF00482                                            0482 03555000
*         DO;                                                      0483 03556000
*           INFVOLPT=INFSCNPT;                                     0484 03557000
         ST    INFSCNPT,INFVOLPT                                   0484 03558000
*           RESPECIFY                                              0485 03559000
*             INFOVOL BASED(INFVOLPT);                             0485 03560000
*         END;                                                     0486 03561000
*       ELSE                                                       0487 03562000
*                                                                  0487 03563000
*         /***********************************************************/ 03564000
*         /*                                                         */ 03565000
*         /* VOLSER LIST CANNOT BE FOUND RETURN TO THE CALLER WITH RC*/ 03566000
*         /* = 12                                                    */ 03567000
*         /*                                                         */ 03568000
*         /***********************************************************/ 03569000
*                                                                  0487 03570000
*         RETURN CODE(LASTCC12);                                   0487 03571000
*                                                                  0487 03572000
         B     @RC00482                                            0487 03573000
@RF00482 LA    @15,12                                              0487 03574000
         L     @14,@SA00002                                        0487 03575000
         LM    @00,@12,@SA00002+8                                  0487 03576000
         BR    @14                                                 0487 03577000
*       /*************************************************************/ 03578000
*       /*                                                           */ 03579000
*       /* SETUP DEVTYPE RETURN AREA ADDRESSABILITY                  */ 03580000
*       /*                                                           */ 03581000
*       /*************************************************************/ 03582000
*                                                                  0488 03583000
*       IF ADDR(MODIF)^=NULLPTR THEN                               0488 03584000
@RC00482 L     @04,@PC00001+4                                      0488 03585000
         L     @04,FDTPTR+356(,@04)                                0488 03586000
         LTR   @04,@04                                             0488 03587000
         BZ    @RF00488                                            0488 03588000
*         DEVAREAP=REPODEVA;                                       0489 03589000
         L     @04,@PC00001+8                                      0489 03590000
         L     @04,REPODEVA(,@04)                                  0489 03591000
         ST    @04,DEVAREAP                                        0489 03592000
*       ELSE                                                       0490 03593000
*         DEVAREAP=REPIDEVA;                                       0490 03594000
         B     @RC00488                                            0490 03595000
@RF00488 L     @04,@PC00001+8                                      0490 03596000
         L     @04,REPIDEVA(,@04)                                  0490 03597000
         ST    @04,DEVAREAP                                        0490 03598000
*       RESPECIFY                                                  0491 03599000
*         DEVAREA BASED(DEVAREAP);                                 0491 03600000
*                                                                  0491 03601000
@RC00488 DS    0H                                                  0492 03602000
*       /*************************************************************/ 03603000
*       /*                                                           */ 03604000
*       /* ISSUE DEVTYPE TO OBTAIN DEVICE CHARACTERISTICS            */ 03605000
*       /*                                                           */ 03606000
*       /*************************************************************/ 03607000
*                                                                  0492 03608000
*       RESPECIFY                                                  0492 03609000
*        (REG3,                                                    0492 03610000
*         REG4) RESTRICTED;                                        0492 03611000
*       REG3=ADDR(INFODD);                                         0493 03612000
         LA    REG3,INFODD                                         0493 03613000
*       REG4=DEVAREAP;                                             0494 03614000
         L     REG4,DEVAREAP                                       0494 03615000
*LDEVTYP1:                                                         0495 03616000
*       GEN;                                                       0495 03617000
LDEVTYP1 DS    0H                                                  0495 03618000
         DEVTYPE (3),(4),DEVTAB                                         03619000
*       RESPECIFY                                                  0496 03620000
*        (REG3,                                                    0496 03621000
*         REG4) UNRESTRICTED;                                      0496 03622000
*                                                                  0496 03623000
*       /*************************************************************/ 03624000
*       /*                                                           */ 03625000
*       /* SAVE RETURN CODE FROM DEVTYPE                             */ 03626000
*       /*                                                           */ 03627000
*       /*************************************************************/ 03628000
*                                                                  0497 03629000
*       RESPECIFY                                                  0497 03630000
*         RTNREG RSTD;                                             0497 03631000
*       TESTRC=RTNREG;                                             0498 03632000
         STH   RTNREG,TESTRC                                       0498 03633000
*       RESPECIFY                                                  0499 03634000
*         RTNREG UNRSTD;                                           0499 03635000
*                                                                  0499 03636000
*       /*************************************************************/ 03637000
*       /*                                                           */ 03638000
*       /* IF DEVTYPE FAILS, RETURN TO THE CALLER WITH RC = 12       */ 03639000
*       /*                                                           */ 03640000
*       /*************************************************************/ 03641000
*                                                                  0500 03642000
*       IF TESTRC^=0 THEN                                          0500 03643000
         LH    @04,TESTRC                                          0500 03644000
         LTR   @04,@04                                             0500 03645000
         BZ    @RF00500                                            0500 03646000
*         RETURN CODE(LASTCC12);                                   0501 03647000
*                                                                  0501 03648000
         LA    @15,12                                              0501 03649000
         L     @14,@SA00002                                        0501 03650000
         LM    @00,@12,@SA00002+8                                  0501 03651000
         BR    @14                                                 0501 03652000
*       /*************************************************************/ 03653000
*       /*                                                           */ 03654000
*       /* CONSTRUCT EXTENT TABLE HEADER FOR VTOCHEADER KEYWORD      */ 03655000
*       /*                                                           */ 03656000
*       /*************************************************************/ 03657000
*                                                                  0502 03658000
*       XTNHDDN=INFODD;                                            0502 03659000
@RF00500 MVC   XTNHDDN(8,XTNTPTR),INFODD                           0502 03660000
*       XTNHDSN=FMT4DSN;                                           0503 03661000
         MVC   XTNHDSN(44,XTNTPTR),FMT4DSN                         0503 03662000
*       XTNHVOL=INFVOL(1);                                         0504 03663000
         L     @04,INFVOLPT                                        0504 03664000
         MVC   XTNHVOL(6,XTNTPTR),INFVOL(@04)                      0504 03665000
*       XTNHVOLN=1;                                                0505 03666000
*                                                                  0505 03667000
         MVI   XTNHVOLN(XTNTPTR),X'01'                             0505 03668000
*       /*************************************************************/ 03669000
*       /*                                                           */ 03670000
*       /* IF VOLUME SERIAL NUMBER FROM UIOINFO DOES NOT MATCH VOLUME*/ 03671000
*       /* SERIAL NUMBER IN VTOCHEADER PARAMETER, PREPARE TO RETURN  */ 03672000
*       /* TO THE CALLER WITH RC = 12                                */ 03673000
*       /*                                                           */ 03674000
*       /*************************************************************/ 03675000
*                                                                  0506 03676000
*       IF(ADDR(DISPL)^=NULLPTR&DVTCSVAL(1:6)^=XTNHVOL)|(ADDR(COPY)^=   03677000
*           NULLPTR&CVTCSVAL(1:6)^=XTNHVOL)|(ADDR(MODIF)^=NULLPTR& 0506 03678000
*           MVTCSVAL(1:6)^=XTNHVOL) THEN                           0506 03679000
         L     @04,@PC00001+4                                      0506 03680000
         L     @15,FDTPTR(,@04)                                    0506 03681000
         LTR   @15,@15                                             0506 03682000
         BZ    @GL00005                                            0506 03683000
         L     @04,FDTPTR+120(,@04)                                0506 03684000
         CLC   DVTCSVAL(6,@04),XTNHVOL(XTNTPTR)                    0506 03685000
         BNE   @RT00506                                            0506 03686000
@GL00005 L     @04,@PC00001+4                                      0506 03687000
         L     @15,FDTPTR+136(,@04)                                0506 03688000
         LTR   @15,@15                                             0506 03689000
         BZ    @GL00004                                            0506 03690000
         L     @04,FDTPTR+208(,@04)                                0506 03691000
         CLC   CVTCSVAL(6,@04),XTNHVOL(XTNTPTR)                    0506 03692000
         BNE   @RT00506                                            0506 03693000
@GL00004 L     @04,@PC00001+4                                      0506 03694000
         L     @15,FDTPTR+356(,@04)                                0506 03695000
         LTR   @15,@15                                             0506 03696000
         BZ    @RF00506                                            0506 03697000
         L     @04,FDTPTR+428(,@04)                                0506 03698000
         CLC   MVTCSVAL(6,@04),XTNHVOL(XTNTPTR)                    0506 03699000
         BE    @RF00506                                            0506 03700000
@RT00506 DS    0H                                                  0507 03701000
*         DO;                                                      0507 03702000
*                                                                  0507 03703000
*           /*********************************************************/ 03704000
*           /*                                                       */ 03705000
*           /* WRITE ERROR MESSAGE IDC31210I                         */ 03706000
*           /*                                                       */ 03707000
*           /*********************************************************/ 03708000
*                                                                  0508 03709000
*           DO;                                                    0508 03710000
*             CKREQ=CKREQ&&CKREQ;                                  0509 03711000
         L     @04,@PC00001+8                                      0509 03712000
         XC    CKREQ(44,@04),CKREQ(@04)                            0509 03713000
*             CKRERN=MSG10;                                        0510 03714000
         MVC   CKRERN(2,@04),@CH00037                              0510 03715000
*             CKRMVAR(1)=ADDR(XTNHVOL);                            0511 03716000
         LA    @15,XTNHVOL(,XTNTPTR)                               0511 03717000
         ST    @15,CKRMVAR(,@04)                                   0511 03718000
*             CKRMVAR(2)=ADDR(VHDRADD);                            0512 03719000
         LA    @15,@CC02842                                        0512 03720000
         ST    @15,CKRMVAR+4(,@04)                                 0512 03721000
*             CKRMVAR(3)=ADDR(XTNHDDN);                            0513 03722000
         ST    XTNTPTR,CKRMVAR+8(,@04)                             0513 03723000
*             CALL IDCRDER;                                        0514 03724000
         L     @15,@CV01553                                        0514 03725000
         BALR  @14,@15                                             0514 03726000
*           END;                                                   0515 03727000
*                                                                  0515 03728000
*           /*********************************************************/ 03729000
*           /*                                                       */ 03730000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 03731000
*           /*                                                       */ 03732000
*           /*********************************************************/ 03733000
*                                                                  0516 03734000
*           RETURN CODE(LASTCC12);                                 0516 03735000
         LA    @15,12                                              0516 03736000
         L     @14,@SA00002                                        0516 03737000
         LM    @00,@12,@SA00002+8                                  0516 03738000
         BR    @14                                                 0516 03739000
*         END;                                                     0517 03740000
*       IF ADDR(MODIF)^=NULLPTR THEN                               0518 03741000
@RF00506 L     @04,@PC00001+4                                      0518 03742000
         L     @04,FDTPTR+356(,@04)                                0518 03743000
         LTR   @04,@04                                             0518 03744000
         BZ    @RF00518                                            0518 03745000
*         DO;                                                      0519 03746000
*           SINFPTR=REPOSYSI;                                      0520 03747000
*                                                                  0520 03748000
         L     @04,@PC00001+8                                      0520 03749000
         L     @04,REPOSYSI(,@04)                                  0520 03750000
         ST    @04,SINFPTR                                         0520 03751000
*           /*********************************************************/ 03752000
*           /*                                                       */ 03753000
*           /* MOVE WTOR LIST FORM                                   */ 03754000
*           /*                                                       */ 03755000
*           /*********************************************************/ 03756000
*                                                                  0521 03757000
*           WTORLIST=LWTORLST;                                     0521 03758000
*                                                                  0521 03759000
         MVC   WTORLIST(84),LWTORLST                               0521 03760000
*           /*********************************************************/ 03761000
*           /*                                                       */ 03762000
*           /* SETUP DARGLIST TO LOAD IDC498D MESSAGE IF REQUEST IS  */ 03763000
*           /* FOR MODIFY                                            */ 03764000
*           /*                                                       */ 03765000
*           /*********************************************************/ 03766000
*                                                                  0522 03767000
*           DARGL=''B;                                             0522 03768000
         XC    DARGL(20),DARGL                                     0522 03769000
*           DDSTRU=ADDR(DARGL);                                    0523 03770000
         LA    @04,DARGL                                           0523 03771000
         ST    @04,DDSTRU                                          0523 03772000
*           DARGRETP=ADDR(WTORLIST)+12;                            0524 03773000
         LA    @15,WTORLIST                                        0524 03774000
         AL    @15,@CF00039                                        0524 03775000
         ST    @15,DARGRETP(,@04)                                  0524 03776000
*           DARGSENT=MSG78;                                        0525 03777000
         MVI   DARGSENT(@04),X'4E'                                 0525 03778000
*           DARGSMOD=WTORID;                                       0526 03779000
         MVC   DARGSMOD(3,@04),@CC02814                            0526 03780000
*           DARGRETL=LENGTH(WTORLIST)-12;                          0527 03781000
*                                                                  0527 03782000
         MVC   DARGRETL(2,@04),@CH00818                            0527 03783000
*           /*********************************************************/ 03784000
*           /*                                                       */ 03785000
*           /* ISSUE UPRINT TO LOAD IDC498D MESSAGE                  */ 03786000
*           /*                                                       */ 03787000
*           /*********************************************************/ 03788000
*                                                                  0528 03789000
*           CALL AMSTP011(GDTTBL,0,DDSTRU);                        0528 03790000
*                                                                  0528 03791000
         L     @04,@PC00001                                        0528 03792000
         ST    @04,@AL00001                                        0528 03793000
         LA    @15,@CF00118                                        0528 03794000
         ST    @15,@AL00001+4                                      0528 03795000
         LA    @15,DDSTRU                                          0528 03796000
         ST    @15,@AL00001+8                                      0528 03797000
         MVI   @AL00001+8,X'80'                                    0528 03798000
         L     @15,GDTPRT(,@04)                                    0528 03799000
         LA    @01,@AL00001                                        0528 03800000
         BALR  @14,@15                                             0528 03801000
*           /*********************************************************/ 03802000
*           /*                                                       */ 03803000
*           /* SAVE RETURN CODE FROM UPRINT                          */ 03804000
*           /*                                                       */ 03805000
*           /*********************************************************/ 03806000
*                                                                  0529 03807000
*           RESPECIFY                                              0529 03808000
*             RTNREG RSTD;                                         0529 03809000
*           TESTRC=RTNREG;                                         0530 03810000
         STH   RTNREG,TESTRC                                       0530 03811000
*           RESPECIFY                                              0531 03812000
*             RTNREG UNRSTD;                                       0531 03813000
*                                                                  0531 03814000
*           /*********************************************************/ 03815000
*           /*                                                       */ 03816000
*           /* IF UPRINT FAILS, RETURN TO THE CALLER WITH RC = 12    */ 03817000
*           /*                                                       */ 03818000
*           /*********************************************************/ 03819000
*                                                                  0532 03820000
*           IF TESTRC^=0 THEN                                      0532 03821000
         LH    @04,TESTRC                                          0532 03822000
         LTR   @04,@04                                             0532 03823000
         BZ    @RF00532                                            0532 03824000
*             RETURN CODE(LASTCC12);                               0533 03825000
*                                                                  0533 03826000
         LA    @15,12                                              0533 03827000
         L     @14,@SA00002                                        0533 03828000
         LM    @00,@12,@SA00002+8                                  0533 03829000
         BR    @14                                                 0533 03830000
*           /*********************************************************/ 03831000
*           /*                                                       */ 03832000
*           /* INSERT VOLSER OF VTOCHEADER IN MESSAGE                */ 03833000
*           /*                                                       */ 03834000
*           /*********************************************************/ 03835000
*                                                                  0534 03836000
*           WTORLIST(62:67)=XTNHVOL;                               0534 03837000
*                                                                  0534 03838000
@RF00532 MVC   WTORLIST+61(6),XTNHVOL(XTNTPTR)                     0534 03839000
*           /*********************************************************/ 03840000
*           /*                                                       */ 03841000
*           /* PROMPT CONSOLE OPERATOR FOR AUTHORIZATION TO ACCESS   */ 03842000
*           /* VOLUME                                                */ 03843000
*           /*                                                       */ 03844000
*           /*********************************************************/ 03845000
*                                                                  0535 03846000
*           DO UNTIL(WTOREPLY=Y)|(WTOREPLY=N);                     0535 03847000
@DL00535 DS    0H                                                  0536 03848000
*             WTOREPLY=''B;                                        0536 03849000
         MVI   WTOREPLY,X'00'                                      0536 03850000
*             WTORECB=''B;                                         0537 03851000
         XC    WTORECB(4),WTORECB                                  0537 03852000
*             RESPECIFY                                            0538 03853000
*               REG3 RESTRICTED;                                   0538 03854000
*             REG3=ADDR(WTORLIST);                                 0539 03855000
         LA    REG3,WTORLIST                                       0539 03856000
*LWTOR1:                                                           0540 03857000
*             GEN;                                                 0540 03858000
LWTOR1   DS    0H                                                  0540 03859000
         WTOR  ,WTOREPLY,1,WTORECB,MF=(E,(3))                           03860000
         WAIT ECB=WTORECB                                               03861000
         DOM   MSG=(1)                                                  03862000
*             RESPECIFY                                            0541 03863000
*               REG3 UNRESTRICTED;                                 0541 03864000
*           END;                                                   0542 03865000
*                                                                  0542 03866000
@DE00535 CLI   WTOREPLY,C'Y'                                       0542 03867000
         BE    @DC00535                                            0542 03868000
         CLI   WTOREPLY,C'N'                                       0542 03869000
         BNE   @DL00535                                            0542 03870000
@DC00535 DS    0H                                                  0543 03871000
*           /*********************************************************/ 03872000
*           /*                                                       */ 03873000
*           /* IF REPLY IS 'N', PREPARE TO RETURN TO THE CALLER WITH */ 03874000
*           /* RC = 12                                               */ 03875000
*           /*                                                       */ 03876000
*           /*********************************************************/ 03877000
*                                                                  0543 03878000
*           IF WTOREPLY=N THEN                                     0543 03879000
         CLI   WTOREPLY,C'N'                                       0543 03880000
         BNE   @RF00543                                            0543 03881000
*             DO;                                                  0544 03882000
*                                                                  0544 03883000
*               /*****************************************************/ 03884000
*               /*                                                   */ 03885000
*               /* WRITE ACCESS DENIAL MESSAGE IDC31206I             */ 03886000
*               /*                                                   */ 03887000
*               /*****************************************************/ 03888000
*                                                                  0545 03889000
*               DO;                                                0545 03890000
*                 CKREQ=CKREQ&&CKREQ;                              0546 03891000
         L     @04,@PC00001+8                                      0546 03892000
         XC    CKREQ(44,@04),CKREQ(@04)                            0546 03893000
*                 CKRERN=MSG06;                                    0547 03894000
         MVC   CKRERN(2,@04),@CH00035                              0547 03895000
*                 CKRMVAR(1)=ADDR(XTNHVOL);                        0548 03896000
         LA    @15,XTNHVOL(,XTNTPTR)                               0548 03897000
         ST    @15,CKRMVAR(,@04)                                   0548 03898000
*                 CALL IDCRDER;                                    0549 03899000
         L     @15,@CV01553                                        0549 03900000
         BALR  @14,@15                                             0549 03901000
*               END;                                               0550 03902000
*                                                                  0550 03903000
*               /*****************************************************/ 03904000
*               /*                                                   */ 03905000
*               /* RETURN TO THE CALLER WITH RC = 12                 */ 03906000
*               /*                                                   */ 03907000
*               /*****************************************************/ 03908000
*                                                                  0551 03909000
*               RETURN CODE(LASTCC12);                             0551 03910000
         LA    @15,12                                              0551 03911000
         L     @14,@SA00002                                        0551 03912000
         LM    @00,@12,@SA00002+8                                  0551 03913000
         BR    @14                                                 0551 03914000
*             END;                                                 0552 03915000
*         END;                                                     0553 03916000
*                                                                  0553 03917000
*       /*************************************************************/ 03918000
*       /*                                                           */ 03919000
*       /* GET ADDRESS OF USYSINFO RETURN AREA FOR NON-MODIFY REQUEST*/ 03920000
*       /*                                                           */ 03921000
*       /*************************************************************/ 03922000
*                                                                  0554 03923000
*       ELSE                                                       0554 03924000
*         SINFPTR=REPISYSI;                                        0554 03925000
*                                                                  0554 03926000
         B     @RC00518                                            0554 03927000
@RF00518 L     @04,@PC00001+8                                      0554 03928000
         L     @04,REPISYSI(,@04)                                  0554 03929000
         ST    @04,SINFPTR                                         0554 03930000
*       /*************************************************************/ 03931000
*       /*                                                           */ 03932000
*       /* ISSUE USYSINFO TO OBTAIN THE UCB ADDRESS                  */ 03933000
*       /*                                                           */ 03934000
*       /*************************************************************/ 03935000
*                                                                  0555 03936000
*       CALL IDCSASI0(GDTTBL,UNIT,SINFPTR,XTNHDDN);                0555 03937000
*                                                                  0555 03938000
@RC00518 L     @04,@PC00001                                        0555 03939000
         ST    @04,@AL00001                                        0555 03940000
         LA    @15,UNIT                                            0555 03941000
         ST    @15,@AL00001+4                                      0555 03942000
         LA    @15,SINFPTR                                         0555 03943000
         ST    @15,@AL00001+8                                      0555 03944000
         ST    XTNTPTR,@AL00001+12                                 0555 03945000
         MVI   @AL00001+12,X'80'                                   0555 03946000
         L     @15,GDTSFO(,@04)                                    0555 03947000
         LA    @01,@AL00001                                        0555 03948000
         BALR  @14,@15                                             0555 03949000
*       /*************************************************************/ 03950000
*       /*                                                           */ 03951000
*       /* SAVE RETURN CODE FROM USYSINFO                            */ 03952000
*       /*                                                           */ 03953000
*       /*************************************************************/ 03954000
*                                                                  0556 03955000
*       RESPECIFY                                                  0556 03956000
*         RTNREG RSTD;                                             0556 03957000
*       TESTRC=RTNREG;                                             0557 03958000
         STH   RTNREG,TESTRC                                       0557 03959000
*       RESPECIFY                                                  0558 03960000
*         RTNREG UNRSTD;                                           0558 03961000
*                                                                  0558 03962000
*       /*************************************************************/ 03963000
*       /*                                                           */ 03964000
*       /* IF USYSINFO FAILS, RETURN TO THE CALLER WITH RC = 12      */ 03965000
*       /*                                                           */ 03966000
*       /*************************************************************/ 03967000
*                                                                  0559 03968000
*       IF TESTRC^=0 THEN                                          0559 03969000
         LH    @04,TESTRC                                          0559 03970000
         LTR   @04,@04                                             0559 03971000
         BZ    @RF00559                                            0559 03972000
*         RETURN CODE(LASTCC12);                                   0560 03973000
*                                                                  0560 03974000
         LA    @15,12                                              0560 03975000
         L     @14,@SA00002                                        0560 03976000
         LM    @00,@12,@SA00002+8                                  0560 03977000
         BR    @14                                                 0560 03978000
*       /*************************************************************/ 03979000
*       /*                                                           */ 03980000
*       /* IF REQUESTED FUNCTION IS MODIFY, RESERVE THE VOLUME       */ 03981000
*       /*                                                           */ 03982000
*       /*************************************************************/ 03983000
*                                                                  0561 03984000
*       IF ADDR(MODIF)^=NULLPTR THEN                               0561 03985000
@RF00559 L     @04,@PC00001+4                                      0561 03986000
         L     @04,FDTPTR+356(,@04)                                0561 03987000
         LTR   @04,@04                                             0561 03988000
         BZ    @RF00561                                            0561 03989000
*         DO;                                                      0562 03990000
*                                                                  0562 03991000
*           /*********************************************************/ 03992000
*           /*                                                       */ 03993000
*           /* CONSTRUCT QNAME, RNAME LENGTH, AND RNAME              */ 03994000
*           /*                                                       */ 03995000
*           /*********************************************************/ 03996000
*                                                                  0563 03997000
*           SPQNAME=SYSVTOC;                                       0563 03998000
         L     @04,@PC00001+8                                      0563 03999000
         L     @04,REPQRPTR(,@04)                                  0563 04000000
         MVC   SPQNAME(8,@04),@CC02747                             0563 04001000
*           SPRLEN=LENGTH(SPRVOL);                                 0564 04002000
         MVI   SPRLEN(@04),X'06'                                   0564 04003000
*           SPRVOL=XTNHVOL;                                        0565 04004000
*                                                                  0565 04005000
         MVC   SPRVOL(6,@04),XTNHVOL(XTNTPTR)                      0565 04006000
*           /*********************************************************/ 04007000
*           /*                                                       */ 04008000
*           /* ISSUE URESERVE TO RESERVE THE VTOC                    */ 04009000
*           /*                                                       */ 04010000
*           /*********************************************************/ 04011000
*                                                                  0566 04012000
*           CALL IDCSARV0(GDTTBL,EXCL,WAIT,SINFAREA,SPQNAME,SPRNAME);   04013000
*                                                                  0566 04014000
         L     @15,@PC00001                                        0566 04015000
         ST    @15,@AL00001                                        0566 04016000
         LA    @14,EXCL                                            0566 04017000
         ST    @14,@AL00001+4                                      0566 04018000
         LA    @14,WAIT                                            0566 04019000
         ST    @14,@AL00001+8                                      0566 04020000
         L     @01,SINFPTR                                         0566 04021000
         ST    @01,@AL00001+12                                     0566 04022000
         ST    @04,@AL00001+16                                     0566 04023000
         LA    @04,SPRNAME(,@04)                                   0566 04024000
         ST    @04,@AL00001+20                                     0566 04025000
         MVI   @AL00001+20,X'80'                                   0566 04026000
         L     @15,GDTRSV(,@15)                                    0566 04027000
         LA    @01,@AL00001                                        0566 04028000
         BALR  @14,@15                                             0566 04029000
*           /*********************************************************/ 04030000
*           /*                                                       */ 04031000
*           /* SAVE THE RETURN CODE FROM URESERVE                    */ 04032000
*           /*                                                       */ 04033000
*           /*********************************************************/ 04034000
*                                                                  0567 04035000
*           RESPECIFY                                              0567 04036000
*             RTNREG RSTD;                                         0567 04037000
*           TESTRC=RTNREG;                                         0568 04038000
         STH   RTNREG,TESTRC                                       0568 04039000
*           RESPECIFY                                              0569 04040000
*             RTNREG UNRSTD;                                       0569 04041000
*                                                                  0569 04042000
*           /*********************************************************/ 04043000
*           /*                                                       */ 04044000
*           /* IF URESERVE FAILS, RETURN TO IDCRD05 WITH RC = 12     */ 04045000
*           /*                                                       */ 04046000
*           /*********************************************************/ 04047000
*                                                                  0570 04048000
*           IF TESTRC^=0 THEN                                      0570 04049000
         LH    @04,TESTRC                                          0570 04050000
         LTR   @04,@04                                             0570 04051000
         BZ    @RF00570                                            0570 04052000
*             RETURN CODE(LASTCC12);                               0571 04053000
*                                                                  0571 04054000
         LA    @15,12                                              0571 04055000
         L     @14,@SA00002                                        0571 04056000
         LM    @00,@12,@SA00002+8                                  0571 04057000
         BR    @14                                                 0571 04058000
*           /*********************************************************/ 04059000
*           /*                                                       */ 04060000
*           /* SET MODIFY ENQ INDICATOR                              */ 04061000
*           /*                                                       */ 04062000
*           /*********************************************************/ 04063000
*                                                                  0572 04064000
*           REPENQSW=MODENQ;                                       0572 04065000
@RF00570 L     @04,@PC00001+8                                      0572 04066000
         MVI   REPENQSW(@04),X'80'                                 0572 04067000
*         END;                                                     0573 04068000
*                                                                  0573 04069000
*       /*************************************************************/ 04070000
*       /*                                                           */ 04071000
*       /* CONSTRUCT THE EXOARG                                      */ 04072000
*       /*                                                           */ 04073000
*       /*************************************************************/ 04074000
*                                                                  0574 04075000
*       EXOARG=''B;                                                0574 04076000
@RF00561 L     @04,@PC00001+8                                      0574 04077000
         L     @15,REPEXOAR(,@04)                                  0574 04078000
         XC    EXOARG(34,@15),EXOARG(@15)                          0574 04079000
*       EXOUCB=SINFAREA;                                           0575 04080000
         L     @01,SINFPTR                                         0575 04081000
         L     @14,SINFAREA(,@01)                                  0575 04082000
         ST    @14,EXOUCB(,@15)                                    0575 04083000
*       EXODDN=ADDR(XTNHDDN);                                      0576 04084000
         ST    XTNTPTR,EXODDN(,@15)                                0576 04085000
*       EXODSN=ADDR(XTNHDSN);                                      0577 04086000
         LA    @14,XTNHDSN(,XTNTPTR)                               0577 04087000
         ST    @14,EXODSN(,@15)                                    0577 04088000
*       IF ADDR(MODIF)^=NULLPTR THEN                               0578 04089000
         L     @14,@PC00001+4                                      0578 04090000
         L     @14,FDTPTR+356(,@14)                                0578 04091000
         LTR   @14,@14                                             0578 04092000
         BZ    @RF00578                                            0578 04093000
*         DO;                                                      0579 04094000
*           EXOREAD=OFF;                                           0580 04095000
         NI    EXOREAD(@15),B'01111111'                            0580 04096000
*           EXOCTLBK=ADDR(REPODSOP);                               0581 04097000
         LA    @04,REPODSOP(,@04)                                  0581 04098000
         ST    @04,EXOCTLBK(,@15)                                  0581 04099000
*         END;                                                     0582 04100000
*       ELSE                                                       0583 04101000
*         DO;                                                      0583 04102000
         B     @RC00578                                            0583 04103000
@RF00578 DS    0H                                                  0584 04104000
*           EXOCTLBK=ADDR(REPIDSOP);                               0584 04105000
         L     @04,@PC00001+8                                      0584 04106000
         L     @15,REPEXOAR(,@04)                                  0584 04107000
         LA    @04,REPIDSOP(,@04)                                  0584 04108000
         ST    @04,EXOCTLBK(,@15)                                  0584 04109000
*           EXOREAD=ON;                                            0585 04110000
         OI    EXOREAD(@15),B'10000000'                            0585 04111000
*         END;                                                     0586 04112000
*       EXOREP=ON;                                                 0587 04113000
@RC00578 L     @04,@PC00001+8                                      0587 04114000
         L     @04,REPEXOAR(,@04)                                  0587 04115000
         OI    EXOREP(@04),B'00000100'                             0587 04116000
*       EXOVTH=ON;                                                 0588 04117000
         OI    EXOVTH(@04),B'00000001'                             0588 04118000
*       EXOEXT=ADDR(XTNHCHR1);                                     0589 04119000
         LA    @15,XTNHCHR1(,XTNTPTR)                              0589 04120000
         ST    @15,EXOEXT(,@04)                                    0589 04121000
*       XTNHCHR1(1:2)=DEVMAXCC;                                    0590 04122000
         L     @15,DEVAREAP                                        0590 04123000
         MVC   XTNHCHR1(2,XTNTPTR),DEVMAXCC(@15)                   0590 04124000
*       XTNHCHR1(3:4)=DEVMAXHH;                                    0591 04125000
         MVC   XTNHCHR1+2(2,XTNTPTR),DEVMAXHH(@15)                 0591 04126000
*       XTNHCHR1(5:5)='00'X;                                       0592 04127000
*                                                                  0592 04128000
         MVI   XTNHCHR1+4(XTNTPTR),X'00'                           0592 04129000
*       /*************************************************************/ 04130000
*       /*                                                           */ 04131000
*       /* OPEN THE VTOC. UEXCP WILL RETURN BEGINNING CCHHR OF THE   */ 04132000
*       /* VTOC IN XTNHCHR1 POINTED TO BY EXOEXT                     */ 04133000
*       /*                                                           */ 04134000
*       /*************************************************************/ 04135000
*                                                                  0593 04136000
*       CALL IDCIO050(GDTTBL,OPENR,EXOARG);                        0593 04137000
*                                                                  0593 04138000
         L     @15,@PC00001                                        0593 04139000
         ST    @15,@AL00001                                        0593 04140000
         LA    @14,@CC02024                                        0593 04141000
         ST    @14,@AL00001+4                                      0593 04142000
         ST    @04,@AL00001+8                                      0593 04143000
         MVI   @AL00001+8,X'80'                                    0593 04144000
         L     @15,GDTEXP(,@15)                                    0593 04145000
         LA    @01,@AL00001                                        0593 04146000
         BALR  @14,@15                                             0593 04147000
*       /*************************************************************/ 04148000
*       /*                                                           */ 04149000
*       /* SAVE THE RETURN CODE FROM UEXCP                           */ 04150000
*       /*                                                           */ 04151000
*       /*************************************************************/ 04152000
*                                                                  0594 04153000
*       RESPECIFY                                                  0594 04154000
*         RTNREG RSTD;                                             0594 04155000
*       TESTRC=RTNREG;                                             0595 04156000
         STH   RTNREG,TESTRC                                       0595 04157000
*       RESPECIFY                                                  0596 04158000
*         RTNREG UNRSTD;                                           0596 04159000
*                                                                  0596 04160000
*       /*************************************************************/ 04161000
*       /*                                                           */ 04162000
*       /* IF UEXCP FAILS, PREPARE TO RETURN TO THE CALLER WITH RC = */ 04163000
*       /* 12                                                        */ 04164000
*       /*                                                           */ 04165000
*       /*************************************************************/ 04166000
*                                                                  0597 04167000
*       IF TESTRC^=0 THEN                                          0597 04168000
         LH    @04,TESTRC                                          0597 04169000
         SLR   @15,@15                                             0597 04170000
         CR    @04,@15                                             0597 04171000
         BE    @RF00597                                            0597 04172000
*         DO;                                                      0598 04173000
*                                                                  0598 04174000
*           /*********************************************************/ 04175000
*           /*                                                       */ 04176000
*           /* IF MODIFY FUNCTION, DEQ THE VOLUME                    */ 04177000
*           /*                                                       */ 04178000
*           /*********************************************************/ 04179000
*                                                                  0599 04180000
*           IF ADDR(MODIF)^=NULLPTR THEN                           0599 04181000
         L     @14,@PC00001+4                                      0599 04182000
         C     @15,FDTPTR+356(,@14)                                0599 04183000
         BE    @RF00599                                            0599 04184000
*             CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);               0600 04185000
*                                                                  0600 04186000
         L     @15,@PC00001                                        0600 04187000
         ST    @15,@AL00001                                        0600 04188000
         L     @14,@PC00001+8                                      0600 04189000
         L     @14,REPQRPTR(,@14)                                  0600 04190000
         ST    @14,@AL00001+4                                      0600 04191000
         LA    @14,SPRNAME(,@14)                                   0600 04192000
         ST    @14,@AL00001+8                                      0600 04193000
         MVI   @AL00001+8,X'80'                                    0600 04194000
         L     @15,GDTDEQ(,@15)                                    0600 04195000
         LA    @01,@AL00001                                        0600 04196000
         BALR  @14,@15                                             0600 04197000
*           /*********************************************************/ 04198000
*           /*                                                       */ 04199000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 04200000
*           /*                                                       */ 04201000
*           /*********************************************************/ 04202000
*                                                                  0601 04203000
*           RETURN CODE(LASTCC12);                                 0601 04204000
@RF00599 LA    @15,12                                              0601 04205000
         L     @14,@SA00002                                        0601 04206000
         LM    @00,@12,@SA00002+8                                  0601 04207000
         BR    @14                                                 0601 04208000
*         END;                                                     0602 04209000
*                                                                  0602 04210000
*       /*************************************************************/ 04211000
*       /*                                                           */ 04212000
*       /* IF THE MODIFY FUNCTION IS REQUESTED, THE BEGINNING CCHH OF*/ 04213000
*       /* THE VTOC RETURNED BY UEXCP OPENR IN XTNHCHR1 MUST EQUAL   */ 04214000
*       /* THE CCHH VALUE IN THE VTOCHEADERADDRESS CCHHR PARAMETER.  */ 04215000
*       /* IF NOT, PREPARE TO RETURN TO IDCRD05 WITH RC = 12         */ 04216000
*       /*                                                           */ 04217000
*       /*************************************************************/ 04218000
*                                                                  0603 04219000
*       IF ADDR(MODIF)^=NULLPTR&ADDR(MVTCR)^=NULLPTR THEN          0603 04220000
@RF00597 SLR   @04,@04                                             0603 04221000
         L     @15,@PC00001+4                                      0603 04222000
         C     @04,FDTPTR+356(,@15)                                0603 04223000
         BE    @RF00603                                            0603 04224000
         L     @15,FDTPTR+432(,@15)                                0603 04225000
         CR    @15,@04                                             0603 04226000
         BE    @RF00603                                            0603 04227000
*         DO;                                                      0604 04228000
*                                                                  0604 04229000
*           /*********************************************************/ 04230000
*           /*                                                       */ 04231000
*           /* VALIDATE VTOCHEADERADDRESS CCHHR PARAMETER            */ 04232000
*           /*                                                       */ 04233000
*           /*********************************************************/ 04234000
*                                                                  0605 04235000
*           IF XTNHCHR1(1:4)^=MVTCRVAL(1:4) THEN                   0605 04236000
         CLC   XTNHCHR1(4,XTNTPTR),MVTCRVAL(@15)                   0605 04237000
         BE    @RF00605                                            0605 04238000
*             DO;                                                  0606 04239000
*                                                                  0606 04240000
*               /*****************************************************/ 04241000
*               /*                                                   */ 04242000
*               /* CLOSE THE VTOC                                    */ 04243000
*               /*                                                   */ 04244000
*               /*****************************************************/ 04245000
*                                                                  0607 04246000
*               CALL IDCIO050(GDTTBL,CLOSE,REPODSOP);              0607 04247000
*                                                                  0607 04248000
         L     @15,@PC00001                                        0607 04249000
         ST    @15,@AL00001                                        0607 04250000
         LA    @14,CLOSE                                           0607 04251000
         ST    @14,@AL00001+4                                      0607 04252000
         L     @14,@PC00001+8                                      0607 04253000
         LA    @14,REPODSOP(,@14)                                  0607 04254000
         ST    @14,@AL00001+8                                      0607 04255000
         MVI   @AL00001+8,X'80'                                    0607 04256000
         L     @15,GDTEXP(,@15)                                    0607 04257000
         LA    @01,@AL00001                                        0607 04258000
         BALR  @14,@15                                             0607 04259000
*               /*****************************************************/ 04260000
*               /*                                                   */ 04261000
*               /* DEQ THE VOLUME                                    */ 04262000
*               /*                                                   */ 04263000
*               /*****************************************************/ 04264000
*                                                                  0608 04265000
*               CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);             0608 04266000
*                                                                  0608 04267000
         L     @15,@PC00001                                        0608 04268000
         ST    @15,@AL00001                                        0608 04269000
         L     @14,@PC00001+8                                      0608 04270000
         L     @14,REPQRPTR(,@14)                                  0608 04271000
         ST    @14,@AL00001+4                                      0608 04272000
         LA    @14,SPRNAME(,@14)                                   0608 04273000
         ST    @14,@AL00001+8                                      0608 04274000
         MVI   @AL00001+8,X'80'                                    0608 04275000
         L     @15,GDTDEQ(,@15)                                    0608 04276000
         LA    @01,@AL00001                                        0608 04277000
         BALR  @14,@15                                             0608 04278000
*               /*****************************************************/ 04279000
*               /*                                                   */ 04280000
*               /* WRITE ERROR MESSAGE IDC31239I                     */ 04281000
*               /*                                                   */ 04282000
*               /*****************************************************/ 04283000
*                                                                  0609 04284000
*               DO;                                                0609 04285000
*                 CKREQ=CKREQ&&CKREQ;                              0610 04286000
         L     @15,@PC00001+8                                      0610 04287000
         XC    CKREQ(44,@15),CKREQ(@15)                            0610 04288000
*                 CKRERN=MSG39;                                    0611 04289000
         MVC   CKRERN(2,@15),@CH00730                              0611 04290000
*                 CKRMVAR(1)=ADDR(MVTCRVAL);                       0612 04291000
         L     @14,@PC00001+4                                      0612 04292000
         L     @01,FDTPTR+432(,@14)                                0612 04293000
         LA    @14,MVTCRVAL(,@01)                                  0612 04294000
         ST    @14,CKRMVAR(,@15)                                   0612 04295000
*                 CALL IDCRDER;                                    0613 04296000
         L     @15,@CV01553                                        0613 04297000
         BALR  @14,@15                                             0613 04298000
*               END;                                               0614 04299000
*                                                                  0614 04300000
*               /*****************************************************/ 04301000
*               /*                                                   */ 04302000
*               /* RETURN TO IDCRD05 WITH RC = 12                    */ 04303000
*               /*                                                   */ 04304000
*               /*****************************************************/ 04305000
*                                                                  0615 04306000
*               RETURN CODE(LASTCC12);                             0615 04307000
         LA    @15,12                                              0615 04308000
         L     @14,@SA00002                                        0615 04309000
         LM    @00,@12,@SA00002+8                                  0615 04310000
         BR    @14                                                 0615 04311000
*             END;                                                 0616 04312000
*         END;                                                     0617 04313000
*                                                                  0617 04314000
@RF00605 DS    0H                                                  0618 04315000
*       /*************************************************************/ 04316000
*       /*                                                           */ 04317000
*       /* SET THE ENDING CCHH EQUAL TO BEGINNING CCHH AND ENDING R  */ 04318000
*       /* EQUAL TO X'FF'                                            */ 04319000
*       /*                                                           */ 04320000
*       /*************************************************************/ 04321000
*                                                                  0618 04322000
*       XTNHCHR2(1:4)=XTNHCHR1(1:4);                               0618 04323000
@RF00603 MVC   XTNHCHR2(4,XTNTPTR),XTNHCHR1(XTNTPTR)               0618 04324000
*       XTNHCHR2(5:5)='FF'X;                                       0619 04325000
*                                                                  0619 04326000
         MVI   XTNHCHR2+4(XTNTPTR),X'FF'                           0619 04327000
*       /*************************************************************/ 04328000
*       /*                                                           */ 04329000
*       /* CONSTRUCT THE FIRST AND ONLY EXTENT TABLE ENTRY           */ 04330000
*       /*                                                           */ 04331000
*       /*************************************************************/ 04332000
*                                                                  0620 04333000
*       I=1;                                                       0620 04334000
         L     @04,@PC00001+8                                      0620 04335000
         LA    @15,1                                               0620 04336000
         STC   @15,I(,@04)                                         0620 04337000
*       XTNTDDN(I)=XTNHDDN;                                        0621 04338000
         LA    @14,78                                              0621 04339000
         LR    @01,@15                                             0621 04340000
         MR    @00,@14                                             0621 04341000
         ST    @01,@TF00001                                        0621 04342000
         ALR   @01,XTNTPTR                                         0621 04343000
         MVC   XTNTDDN-78(8,@01),XTNHDDN(XTNTPTR)                  0621 04344000
*       XTNTDSN(I)=XTNHDSN;                                        0622 04345000
         LR    @01,XTNTPTR                                         0622 04346000
         AL    @01,@TF00001                                        0622 04347000
         MVC   XTNTDSN-78(44,@01),XTNHDSN(XTNTPTR)                 0622 04348000
*       XTNTVOLN(I)=XTNHVOLN;                                      0623 04349000
         LR    @01,XTNTPTR                                         0623 04350000
         AL    @01,@TF00001                                        0623 04351000
         MVC   XTNTVOLN-78(1,@01),XTNHVOLN(XTNTPTR)                0623 04352000
*       XTNTVOL(I)=XTNHVOL;                                        0624 04353000
         LR    @01,XTNTPTR                                         0624 04354000
         AL    @01,@TF00001                                        0624 04355000
         MVC   XTNTVOL-78(6,@01),XTNHVOL(XTNTPTR)                  0624 04356000
*       XTNTCHR1(I)=XTNHCHR1;                                      0625 04357000
         LR    @01,XTNTPTR                                         0625 04358000
         AL    @01,@TF00001                                        0625 04359000
         MVC   XTNTCHR1-78(5,@01),XTNHCHR1(XTNTPTR)                0625 04360000
*       XTNTCHR2(I)=XTNHCHR2;                                      0626 04361000
*                                                                  0626 04362000
         LR    @01,XTNTPTR                                         0626 04363000
         AL    @01,@TF00001                                        0626 04364000
         MVC   XTNTCHR2-78(5,@01),XTNHCHR2(XTNTPTR)                0626 04365000
*       /*************************************************************/ 04366000
*       /*                                                           */ 04367000
*       /* SET THE NEXT EXTENT TABLE ENTRY TO X'FF' TO INDICATE THE  */ 04368000
*       /* LAST ENTRY.                                               */ 04369000
*       /*                                                           */ 04370000
*       /*************************************************************/ 04371000
*                                                                  0627 04372000
*       I=I+1;                                                     0627 04373000
         AL    @15,@CF00221                                        0627 04374000
         STC   @15,I(,@04)                                         0627 04375000
*       XTNTENT(I)=LASTENT;                                        0628 04376000
*                                                                  0628 04377000
         MR    @14,@14                                             0628 04378000
         ALR   @15,XTNTPTR                                         0628 04379000
         MVC   XTNTENT-78(78,@15),LASTENT                          0628 04380000
*       /*************************************************************/ 04381000
*       /*                                                           */ 04382000
*       /* CALCULATE REQUIRED BYTES FOR THE I/O BUFFER               */ 04383000
*       /*                                                           */ 04384000
*       /*************************************************************/ 04385000
*                                                                  0629 04386000
*       REQBYTES=DEVTC+LENGTH(RIOHDR);                             0629 04387000
*                                                                  0629 04388000
         LA    @15,282                                             0629 04389000
         L     @14,DEVAREAP                                        0629 04390000
         LH    @14,DEVTC(,@14)                                     0629 04391000
         N     @14,@CF03043                                        0629 04392000
         ALR   @15,@14                                             0629 04393000
         ST    @15,REQBYTES                                        0629 04394000
*       /*************************************************************/ 04395000
*       /*                                                           */ 04396000
*       /* ISSUE UGPOOL FOR SPACE FOR AN I/O BUFFER.                 */ 04397000
*       /*                                                           */ 04398000
*       /*************************************************************/ 04399000
*                                                                  0630 04400000
*       CALL IDCSAGP0(GDTTBL,REQBYTES,REQADDR,RD01,SETZERO);       0630 04401000
*                                                                  0630 04402000
         L     @15,@PC00001                                        0630 04403000
         ST    @15,@AL00001                                        0630 04404000
         LA    @14,REQBYTES                                        0630 04405000
         ST    @14,@AL00001+4                                      0630 04406000
         LA    @14,REQADDR                                         0630 04407000
         ST    @14,@AL00001+8                                      0630 04408000
         LA    @14,@CC02759                                        0630 04409000
         ST    @14,@AL00001+12                                     0630 04410000
         LA    @14,SETZERO                                         0630 04411000
         ST    @14,@AL00001+16                                     0630 04412000
         MVI   @AL00001+16,X'80'                                   0630 04413000
         L     @15,GDTGPL(,@15)                                    0630 04414000
         LA    @01,@AL00001                                        0630 04415000
         BALR  @14,@15                                             0630 04416000
*       /*************************************************************/ 04417000
*       /*                                                           */ 04418000
*       /* SAVE THE RETURN CODE FROM UGPOOL                          */ 04419000
*       /*                                                           */ 04420000
*       /*************************************************************/ 04421000
*                                                                  0631 04422000
*       RESPECIFY                                                  0631 04423000
*         RTNREG RSTD;                                             0631 04424000
*       TESTRC=RTNREG;                                             0632 04425000
         STH   RTNREG,TESTRC                                       0632 04426000
*       RESPECIFY                                                  0633 04427000
*         RTNREG UNRSTD;                                           0633 04428000
*                                                                  0633 04429000
*       /*************************************************************/ 04430000
*       /*                                                           */ 04431000
*       /* IF UGPOOL FAILS, PREPARE TO RETURN TO THE CALLER WITH RC =*/ 04432000
*       /* 12                                                        */ 04433000
*       /*                                                           */ 04434000
*       /*************************************************************/ 04435000
*                                                                  0634 04436000
*       IF TESTRC^=0 THEN                                          0634 04437000
         LH    @15,TESTRC                                          0634 04438000
         SLR   @14,@14                                             0634 04439000
         CR    @15,@14                                             0634 04440000
         BE    @RF00634                                            0634 04441000
*         DO;                                                      0635 04442000
*                                                                  0635 04443000
*           /*********************************************************/ 04444000
*           /*                                                       */ 04445000
*           /* CLOSE THE CURRENT EXTENT TABLE ENTRY                  */ 04446000
*           /*                                                       */ 04447000
*           /*********************************************************/ 04448000
*                                                                  0636 04449000
*           IF ADDR(MODIF)^=NULLPTR THEN                           0636 04450000
         L     @15,@PC00001+4                                      0636 04451000
         C     @14,FDTPTR+356(,@15)                                0636 04452000
         BE    @RF00636                                            0636 04453000
*             CALL IDCIO050(GDTTBL,CLOSE,REPODSOP);                0637 04454000
         L     @15,@PC00001                                        0637 04455000
         ST    @15,@AL00001                                        0637 04456000
         LA    @14,CLOSE                                           0637 04457000
         ST    @14,@AL00001+4                                      0637 04458000
         L     @14,@PC00001+8                                      0637 04459000
         LA    @14,REPODSOP(,@14)                                  0637 04460000
         ST    @14,@AL00001+8                                      0637 04461000
         MVI   @AL00001+8,X'80'                                    0637 04462000
         L     @15,GDTEXP(,@15)                                    0637 04463000
         LA    @01,@AL00001                                        0637 04464000
         BALR  @14,@15                                             0637 04465000
*           ELSE                                                   0638 04466000
*             CALL IDCIO050(GDTTBL,CLOSE,REPIDSOP);                0638 04467000
*                                                                  0638 04468000
         B     @RC00636                                            0638 04469000
@RF00636 L     @15,@PC00001                                        0638 04470000
         ST    @15,@AL00001                                        0638 04471000
         LA    @14,CLOSE                                           0638 04472000
         ST    @14,@AL00001+4                                      0638 04473000
         L     @14,@PC00001+8                                      0638 04474000
         LA    @14,REPIDSOP(,@14)                                  0638 04475000
         ST    @14,@AL00001+8                                      0638 04476000
         MVI   @AL00001+8,X'80'                                    0638 04477000
         L     @15,GDTEXP(,@15)                                    0638 04478000
         LA    @01,@AL00001                                        0638 04479000
         BALR  @14,@15                                             0638 04480000
*           /*********************************************************/ 04481000
*           /*                                                       */ 04482000
*           /* IF MODIFY FUNCTION, DEQ THE VOLUME                    */ 04483000
*           /*                                                       */ 04484000
*           /*********************************************************/ 04485000
*                                                                  0639 04486000
*           IF ADDR(MODIF)^=NULLPTR THEN                           0639 04487000
@RC00636 L     @15,@PC00001+4                                      0639 04488000
         L     @15,FDTPTR+356(,@15)                                0639 04489000
         LTR   @15,@15                                             0639 04490000
         BZ    @RF00639                                            0639 04491000
*             CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);               0640 04492000
*                                                                  0640 04493000
         L     @15,@PC00001                                        0640 04494000
         ST    @15,@AL00001                                        0640 04495000
         L     @14,@PC00001+8                                      0640 04496000
         L     @14,REPQRPTR(,@14)                                  0640 04497000
         ST    @14,@AL00001+4                                      0640 04498000
         LA    @14,SPRNAME(,@14)                                   0640 04499000
         ST    @14,@AL00001+8                                      0640 04500000
         MVI   @AL00001+8,X'80'                                    0640 04501000
         L     @15,GDTDEQ(,@15)                                    0640 04502000
         LA    @01,@AL00001                                        0640 04503000
         BALR  @14,@15                                             0640 04504000
*           /*********************************************************/ 04505000
*           /*                                                       */ 04506000
*           /* WRITE UNIVERSAL TEXT MESSAGE IDC3004I                 */ 04507000
*           /*                                                       */ 04508000
*           /*********************************************************/ 04509000
*                                                                  0641 04510000
*           DO;                                                    0641 04511000
@RF00639 DS    0H                                                  0642 04512000
*             CKREQ=CKREQ&&CKREQ;                                  0642 04513000
         L     @15,@PC00001+8                                      0642 04514000
         XC    CKREQ(44,@15),CKREQ(@15)                            0642 04515000
*             CKRERN=MSG93;                                        0643 04516000
         MVC   CKRERN(2,@15),@CH00866                              0643 04517000
*             CALL IDCRDER;                                        0644 04518000
         L     @15,@CV01553                                        0644 04519000
         BALR  @14,@15                                             0644 04520000
*           END;                                                   0645 04521000
*                                                                  0645 04522000
*           /*********************************************************/ 04523000
*           /*                                                       */ 04524000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 04525000
*           /*                                                       */ 04526000
*           /*********************************************************/ 04527000
*                                                                  0646 04528000
*           RETURN CODE(LASTCC12);                                 0646 04529000
         LA    @15,12                                              0646 04530000
         L     @14,@SA00002                                        0646 04531000
         LM    @00,@12,@SA00002+8                                  0646 04532000
         BR    @14                                                 0646 04533000
*         END;                                                     0647 04534000
*                                                                  0647 04535000
*       /*************************************************************/ 04536000
*       /*                                                           */ 04537000
*       /* SET THE FIRST BYTE OF THE BUFFER AREA TO X'FF' TO INDICATE*/ 04538000
*       /* TO UEXCP THAT THE AREA HAS NOT PREVIOUSLY BEEN USED.      */ 04539000
*       /*                                                           */ 04540000
*       /*************************************************************/ 04541000
*                                                                  0648 04542000
*       IF ADDR(MODIF)^=NULLPTR THEN                               0648 04543000
@RF00634 L     @15,@PC00001+4                                      0648 04544000
         L     @15,FDTPTR+356(,@15)                                0648 04545000
         LTR   @15,@15                                             0648 04546000
         BZ    @RF00648                                            0648 04547000
*         REPOBFPT=REQADDR;                                        0649 04548000
         L     @15,@PC00001+8                                      0649 04549000
         L     @14,REQADDR                                         0649 04550000
         ST    @14,REPOBFPT(,@15)                                  0649 04551000
*       ELSE                                                       0650 04552000
*         REPIBFPT=REQADDR;                                        0650 04553000
         B     @RC00648                                            0650 04554000
@RF00648 L     @15,@PC00001+8                                      0650 04555000
         L     @14,REQADDR                                         0650 04556000
         ST    @14,REPIBFPT(,@15)                                  0650 04557000
*       RESPECIFY                                                  0651 04558000
*         RIOAREA BASED(REQADDR);                                  0651 04559000
@RC00648 DS    0H                                                  0652 04560000
*       RFIRST='FF'X;                                              0652 04561000
*                                                                  0652 04562000
         L     @01,REQADDR                                         0652 04563000
         MVI   RFIRST(@01),X'FF'                                   0652 04564000
*       /*************************************************************/ 04565000
*       /*                                                           */ 04566000
*       /* RETURN TO CALLER WITH RC = 00                             */ 04567000
*       /*                                                           */ 04568000
*       /*************************************************************/ 04569000
*                                                                  0653 04570000
*       RETURN CODE(LASTCC00);                                     0653 04571000
         SLR   @15,@15                                             0653 04572000
         L     @14,@SA00002                                        0653 04573000
         LM    @00,@12,@SA00002+8                                  0653 04574000
         BR    @14                                                 0653 04575000
*     END DSVHDR;                                                  0654 04576000
*                                                                  0655 04577000
*   /*****************************************************************/ 04578000
*   /*                                                               */ 04579000
*   /* PROCESSING A STAGING PACK                                     */ 04580000
*   /*                                                               */ 04581000
*   /*****************************************************************/ 04582000
*                                                                  0655 04583000
*   IF ADDR(STAGR)^=NULLPTR|ADDR(CSRNG)^=NULLPTR THEN              0655 04584000
@RF00437 SLR   @04,@04                                             0655 04585000
         L     @15,@PC00001+4                                      0655 04586000
         C     @04,FDTPTR+32(,@15)                                 0655 04587000
         BNE   @RT00655                                            0655 04588000
         C     @04,FDTPTR+148(,@15)                                0655 04589000
         BE    @RF00655                                            0655 04590000
@RT00655 DS    0H                                                  0656 04591000
*DSSTGPK:                                                          0656 04592000
*     DO;                                                          0656 04593000
*                                                                  0656 04594000
DSSTGPK  DS    0H                                                  0657 04595000
*       /*************************************************************/ 04596000
*       /*                                                           */ 04597000
*       /* INITIALIZE COMMON FIELDS AND POINTERS                     */ 04598000
*       /*                                                           */ 04599000
*       /*************************************************************/ 04600000
*                                                                  0657 04601000
*       IF ADDR(DISPL)^=NULLPTR THEN                               0657 04602000
         L     @15,@PC00001+4                                      0657 04603000
         L     @14,FDTPTR(,@15)                                    0657 04604000
         LTR   @14,@14                                             0657 04605000
         BZ    @RF00657                                            0657 04606000
*         INFODD=INFILVAL;                                         0658 04607000
         L     @01,FDTPTR+12(,@15)                                 0658 04608000
         MVC   INFODD(8),INFILVAL(@01)                             0658 04609000
*       ELSE                                                       0659 04610000
*         INFODD=CINFLVAL;                                         0659 04611000
         B     @RC00657                                            0659 04612000
@RF00657 L     @15,@PC00001+4                                      0659 04613000
         L     @01,FDTPTR+140(,@15)                                0659 04614000
         MVC   INFODD(8),CINFLVAL(@01)                             0659 04615000
*       INFOPTR=REPIINFO;                                          0660 04616000
@RC00657 L     @04,@PC00001+8                                      0660 04617000
         L     @15,REPIINFO(,@04)                                  0660 04618000
         ST    @15,INFOPTR                                         0660 04619000
*       XTNTPTR=REPIXTNT;                                          0661 04620000
*                                                                  0661 04621000
         L     XTNTPTR,REPIXTNT(,@04)                              0661 04622000
*       /*************************************************************/ 04623000
*       /*                                                           */ 04624000
*       /* SET TRACE POINT                                           */ 04625000
*       /*                                                           */ 04626000
*       /*************************************************************/ 04627000
*                                                                  0662 04628000
*       OLDERID2=NEWERID2;                                         0662 04629000
         L     @15,@PC00001                                        0662 04630000
         L     @15,GDTTR2(,@15)                                    0662 04631000
         MVC   @TS00001(95),NEWERID2(@15)                          0662 04632000
         MVC   OLDERID2(95,@15),@TS00001                           0662 04633000
*       NEWID2='RD6J';                                             0663 04634000
*                                                                  0663 04635000
         MVC   NEWID2(4,@15),@CC02879                              0663 04636000
*       /*************************************************************/ 04637000
*       /*                                                           */ 04638000
*       /* FOR DISPLAY, VALIDATE THE CCHHR AND HHR LENGTHS AND BUILD */ 04639000
*       /* THE EXTENT TABLE HEADER.                                  */ 04640000
*       /*                                                           */ 04641000
*       /*************************************************************/ 04642000
*                                                                  0664 04643000
*       IF ADDR(DISPL)^=NULLPTR THEN                               0664 04644000
         L     @15,@PC00001+4                                      0664 04645000
         L     @14,FDTPTR(,@15)                                    0664 04646000
         LTR   @14,@14                                             0664 04647000
         BZ    @RF00664                                            0664 04648000
*         DO;                                                      0665 04649000
*                                                                  0665 04650000
*           /*********************************************************/ 04651000
*           /*                                                       */ 04652000
*           /* THE LENGTH OF THE STAGINGINGRANGE PARAMETER (FROM     */ 04653000
*           /* CCHHR) MUST BE 5 BYTES. IF NOT, PREPARE TO RETURN TO  */ 04654000
*           /* THE CALLER WITH RC = 12                               */ 04655000
*           /*                                                       */ 04656000
*           /*********************************************************/ 04657000
*                                                                  0666 04658000
*           IF DCCHRLEN^=LENGTH(DCCHRVAL) THEN                     0666 04659000
         L     @15,FDTPTR+72(,@15)                                 0666 04660000
         CLI   DCCHRLEN(@15),5                                     0666 04661000
         BE    @RF00666                                            0666 04662000
*             DO;                                                  0667 04663000
*                                                                  0667 04664000
*               /*****************************************************/ 04665000
*               /*                                                   */ 04666000
*               /* WRITE ERROR MESSAGE IDC31207I                     */ 04667000
*               /*                                                   */ 04668000
*               /*****************************************************/ 04669000
*                                                                  0668 04670000
*               DO;                                                0668 04671000
*                 CKREQ=CKREQ&&CKREQ;                              0669 04672000
         XC    CKREQ(44,@04),CKREQ(@04)                            0669 04673000
*                 CKRERN=MSG07;                                    0670 04674000
         MVC   CKRERN(2,@04),@CH00040                              0670 04675000
*                 CKRMVAR(1)=ADDR(DCCHRVAL);                       0671 04676000
         LA    @05,DCCHRVAL(,@15)                                  0671 04677000
         ST    @05,CKRMVAR(,@04)                                   0671 04678000
*                 CKRMVAR(2)=ADDR(DCCHRLEN);                       0672 04679000
         ST    @15,CKRMVAR+4(,@04)                                 0672 04680000
*                 CALL IDCRDER;                                    0673 04681000
         L     @15,@CV01553                                        0673 04682000
         BALR  @14,@15                                             0673 04683000
*               END;                                               0674 04684000
*                                                                  0674 04685000
*               /*****************************************************/ 04686000
*               /*                                                   */ 04687000
*               /* RETURN TO THE CALLER WITH RC = 12                 */ 04688000
*               /*                                                   */ 04689000
*               /*****************************************************/ 04690000
*                                                                  0675 04691000
*               RETURN CODE(LASTCC12);                             0675 04692000
         LA    @15,12                                              0675 04693000
         L     @14,@SA00002                                        0675 04694000
         LM    @00,@12,@SA00002+8                                  0675 04695000
         BR    @14                                                 0675 04696000
*             END;                                                 0676 04697000
*                                                                  0676 04698000
*           /*********************************************************/ 04699000
*           /*                                                       */ 04700000
*           /* THE LENGTH OF THE STAGINGRANGE PARAMETER (TO HHR) MUST*/ 04701000
*           /* BE 0 OR 3. IF NOT, PREPARE TO RETURN TO THE CALLER    */ 04702000
*           /* WITH RC = 12                                          */ 04703000
*           /*                                                       */ 04704000
*           /*********************************************************/ 04705000
*                                                                  0677 04706000
*           IF ADDR(DREC)^=NULLPTR&DRECLEN^=LENGTH(DRECVAL) THEN   0677 04707000
@RF00666 L     @04,@PC00001+4                                      0677 04708000
         L     @04,FDTPTR+76(,@04)                                 0677 04709000
         LTR   @04,@04                                             0677 04710000
         BZ    @RF00677                                            0677 04711000
         CLI   DRECLEN(@04),3                                      0677 04712000
         BE    @RF00677                                            0677 04713000
*             DO;                                                  0678 04714000
*                                                                  0678 04715000
*               /*****************************************************/ 04716000
*               /*                                                   */ 04717000
*               /* WRITE ERROR MESSAGE IDC31207I                     */ 04718000
*               /*                                                   */ 04719000
*               /*****************************************************/ 04720000
*                                                                  0679 04721000
*               DO;                                                0679 04722000
*                 CKREQ=CKREQ&&CKREQ;                              0680 04723000
         L     @05,@PC00001+8                                      0680 04724000
         XC    CKREQ(44,@05),CKREQ(@05)                            0680 04725000
*                 CKRERN=MSG07;                                    0681 04726000
         MVC   CKRERN(2,@05),@CH00040                              0681 04727000
*                 CKRMVAR(1)=ADDR(DRECVAL);                        0682 04728000
         LA    @15,DRECVAL(,@04)                                   0682 04729000
         ST    @15,CKRMVAR(,@05)                                   0682 04730000
*                 CKRMVAR(2)=ADDR(DRECLEN);                        0683 04731000
         ST    @04,CKRMVAR+4(,@05)                                 0683 04732000
*                 CALL IDCRDER;                                    0684 04733000
         L     @15,@CV01553                                        0684 04734000
         BALR  @14,@15                                             0684 04735000
*               END;                                               0685 04736000
*                                                                  0685 04737000
*               /*****************************************************/ 04738000
*               /*                                                   */ 04739000
*               /* RETURN TO THE CALLER WITH RC = 12                 */ 04740000
*               /*                                                   */ 04741000
*               /*****************************************************/ 04742000
*                                                                  0686 04743000
*               RETURN CODE(LASTCC12);                             0686 04744000
         LA    @15,12                                              0686 04745000
         L     @14,@SA00002                                        0686 04746000
         LM    @00,@12,@SA00002+8                                  0686 04747000
         BR    @14                                                 0686 04748000
*             END;                                                 0687 04749000
*                                                                  0687 04750000
*           /*********************************************************/ 04751000
*           /*                                                       */ 04752000
*           /* CONSTRUCT THE EXTENT TABLE HEADER FOR DISPLAY         */ 04753000
*           /*                                                       */ 04754000
*           /*********************************************************/ 04755000
*                                                                  0688 04756000
*           IF ADDR(DREC)=NULLPTR THEN                             0688 04757000
@RF00677 L     @04,@PC00001+4                                      0688 04758000
         L     @15,FDTPTR+76(,@04)                                 0688 04759000
         LTR   @15,@15                                             0688 04760000
         BNZ   @RF00688                                            0688 04761000
*             XTNHCHR2=DCCHRVAL;                                   0689 04762000
         L     @04,FDTPTR+72(,@04)                                 0689 04763000
         MVC   XTNHCHR2(5,XTNTPTR),DCCHRVAL(@04)                   0689 04764000
*           ELSE                                                   0690 04765000
*             DO;                                                  0690 04766000
         B     @RC00688                                            0690 04767000
@RF00688 DS    0H                                                  0691 04768000
*               XTNHCHR2(1:2)=DCCHRVAL;                            0691 04769000
         L     @04,@PC00001+4                                      0691 04770000
         L     @01,FDTPTR+72(,@04)                                 0691 04771000
         MVC   XTNHCHR2(2,XTNTPTR),DCCHRVAL(@01)                   0691 04772000
*               XTNHCHR2(3:5)=DRECVAL;                             0692 04773000
         L     @04,FDTPTR+76(,@04)                                 0692 04774000
         MVC   XTNHCHR2+2(3,XTNTPTR),DRECVAL(@04)                  0692 04775000
*             END;                                                 0693 04776000
*           XTNHCHR1=DCCHRVAL;                                     0694 04777000
@RC00688 L     @04,@PC00001+4                                      0694 04778000
         L     @01,FDTPTR+72(,@04)                                 0694 04779000
         MVC   XTNHCHR1(5,XTNTPTR),DCCHRVAL(@01)                   0694 04780000
*           XTNHDSN=FMT4DSN;                                       0695 04781000
         MVC   XTNHDSN(44,XTNTPTR),FMT4DSN                         0695 04782000
*           XTNHDDN=INFILVAL;                                      0696 04783000
         L     @01,FDTPTR+12(,@04)                                 0696 04784000
         MVC   XTNHDDN(8,XTNTPTR),INFILVAL(@01)                    0696 04785000
*           XTNHVOLN=1;                                            0697 04786000
         MVI   XTNHVOLN(XTNTPTR),X'01'                             0697 04787000
*           XTNHVOL=VOLSRVAL;                                      0698 04788000
         L     @04,FDTPTR+68(,@04)                                 0698 04789000
         MVC   XTNHVOL(6,XTNTPTR),VOLSRVAL(@04)                    0698 04790000
*           XTNHMODE=INPUT;                                        0699 04791000
         MVI   XTNHMODE(XTNTPTR),C'I'                              0699 04792000
*         END;                                                     0700 04793000
*                                                                  0700 04794000
*       /*************************************************************/ 04795000
*       /*                                                           */ 04796000
*       /* FOR COPY, VALIDATE THE CCHHR AND R LENGTHS AND BUILD THE  */ 04797000
*       /* EXTENT TABLE HEADER.                                      */ 04798000
*       /*                                                           */ 04799000
*       /*************************************************************/ 04800000
*                                                                  0701 04801000
*       IF ADDR(COPY)^=NULLPTR THEN                                0701 04802000
@RF00664 L     @04,@PC00001+4                                      0701 04803000
         L     @15,FDTPTR+136(,@04)                                0701 04804000
         LTR   @15,@15                                             0701 04805000
         BZ    @RF00701                                            0701 04806000
*         DO;                                                      0702 04807000
*                                                                  0702 04808000
*           /*********************************************************/ 04809000
*           /*                                                       */ 04810000
*           /* THE LENGTH OF THE STAGINGRANGE PARAMETER (FROM CCHHR) */ 04811000
*           /* MUST BE 5 BYTES. IF NOT, PREPARE TO RETURN TO THE     */ 04812000
*           /* CALLER WITH RC = 12                                   */ 04813000
*           /*                                                       */ 04814000
*           /*********************************************************/ 04815000
*                                                                  0703 04816000
*           IF CCCHRLEN^=LENGTH(CCCHRVAL) THEN                     0703 04817000
         L     @04,FDTPTR+184(,@04)                                0703 04818000
         CLI   CCCHRLEN(@04),5                                     0703 04819000
         BE    @RF00703                                            0703 04820000
*             DO;                                                  0704 04821000
*                                                                  0704 04822000
*               /*****************************************************/ 04823000
*               /*                                                   */ 04824000
*               /* WRITE ERROR MESSAGE IDC31207I                     */ 04825000
*               /*                                                   */ 04826000
*               /*****************************************************/ 04827000
*                                                                  0705 04828000
*               DO;                                                0705 04829000
*                 CKREQ=CKREQ&&CKREQ;                              0706 04830000
         L     @05,@PC00001+8                                      0706 04831000
         XC    CKREQ(44,@05),CKREQ(@05)                            0706 04832000
*                 CKRERN=MSG07;                                    0707 04833000
         MVC   CKRERN(2,@05),@CH00040                              0707 04834000
*                 CKRMVAR(1)=ADDR(CCCHRVAL);                       0708 04835000
         LA    @15,CCCHRVAL(,@04)                                  0708 04836000
         ST    @15,CKRMVAR(,@05)                                   0708 04837000
*                 CKRMVAR(2)=ADDR(CCCHRLEN);                       0709 04838000
         ST    @04,CKRMVAR+4(,@05)                                 0709 04839000
*                 CALL IDCRDER;                                    0710 04840000
         L     @15,@CV01553                                        0710 04841000
         BALR  @14,@15                                             0710 04842000
*               END;                                               0711 04843000
*                                                                  0711 04844000
*               /*****************************************************/ 04845000
*               /*                                                   */ 04846000
*               /* RETURN TO THE CALLER WITH RC = 12                 */ 04847000
*               /*                                                   */ 04848000
*               /*****************************************************/ 04849000
*                                                                  0712 04850000
*               RETURN CODE(LASTCC12);                             0712 04851000
         LA    @15,12                                              0712 04852000
         L     @14,@SA00002                                        0712 04853000
         LM    @00,@12,@SA00002+8                                  0712 04854000
         BR    @14                                                 0712 04855000
*             END;                                                 0713 04856000
*                                                                  0713 04857000
*           /*********************************************************/ 04858000
*           /*                                                       */ 04859000
*           /* THE LENGTH OF THE STAGINGRANGE PARAMETER (TO R) MUST  */ 04860000
*           /* BE 1 BYTE. IF NOT, PREPARE TO RETURN TO THE CALLER    */ 04861000
*           /* WITH RC = 12                                          */ 04862000
*           /*                                                       */ 04863000
*           /*********************************************************/ 04864000
*                                                                  0714 04865000
*           IF ADDR(CRECR)^=NULLPTR&CRECRLEN^=LENGTH(CRECRVAL) THEN     04866000
@RF00703 L     @04,@PC00001+4                                      0714 04867000
         L     @04,FDTPTR+188(,@04)                                0714 04868000
         LTR   @04,@04                                             0714 04869000
         BZ    @RF00714                                            0714 04870000
         CLI   CRECRLEN(@04),1                                     0714 04871000
         BE    @RF00714                                            0714 04872000
*             DO;                                                  0715 04873000
*                                                                  0715 04874000
*               /*****************************************************/ 04875000
*               /*                                                   */ 04876000
*               /* WRITE ERROR MESSAGE IDC31207I                     */ 04877000
*               /*                                                   */ 04878000
*               /*****************************************************/ 04879000
*                                                                  0716 04880000
*               DO;                                                0716 04881000
*                 CKREQ=CKREQ&&CKREQ;                              0717 04882000
         L     @05,@PC00001+8                                      0717 04883000
         XC    CKREQ(44,@05),CKREQ(@05)                            0717 04884000
*                 CKRERN=MSG07;                                    0718 04885000
         MVC   CKRERN(2,@05),@CH00040                              0718 04886000
*                 CKRMVAR(1)=ADDR(CRECRVAL);                       0719 04887000
         LA    @15,CRECRVAL(,@04)                                  0719 04888000
         ST    @15,CKRMVAR(,@05)                                   0719 04889000
*                 CKRMVAR(2)=ADDR(CRECRLEN);                       0720 04890000
         ST    @04,CKRMVAR+4(,@05)                                 0720 04891000
*                 CALL IDCRDER;                                    0721 04892000
         L     @15,@CV01553                                        0721 04893000
         BALR  @14,@15                                             0721 04894000
*               END;                                               0722 04895000
*                                                                  0722 04896000
*               /*****************************************************/ 04897000
*               /*                                                   */ 04898000
*               /* RETURN TO THE CALLER WITH RC = 12                 */ 04899000
*               /*                                                   */ 04900000
*               /*****************************************************/ 04901000
*                                                                  0723 04902000
*               RETURN CODE(LASTCC12);                             0723 04903000
         LA    @15,12                                              0723 04904000
         L     @14,@SA00002                                        0723 04905000
         LM    @00,@12,@SA00002+8                                  0723 04906000
         BR    @14                                                 0723 04907000
*             END;                                                 0724 04908000
*                                                                  0724 04909000
*           /*********************************************************/ 04910000
*           /*                                                       */ 04911000
*           /* CONSTRUCT THE EXTENT TABLE HEADER FOR COPY            */ 04912000
*           /*                                                       */ 04913000
*           /*********************************************************/ 04914000
*                                                                  0725 04915000
*           IF ADDR(CRECR)=NULLPTR THEN                            0725 04916000
@RF00714 L     @04,@PC00001+4                                      0725 04917000
         L     @15,FDTPTR+188(,@04)                                0725 04918000
         LTR   @15,@15                                             0725 04919000
         BNZ   @RF00725                                            0725 04920000
*             XTNHCHR2=CCCHRVAL;                                   0726 04921000
         L     @04,FDTPTR+184(,@04)                                0726 04922000
         MVC   XTNHCHR2(5,XTNTPTR),CCCHRVAL(@04)                   0726 04923000
*           ELSE                                                   0727 04924000
*             DO;                                                  0727 04925000
         B     @RC00725                                            0727 04926000
@RF00725 DS    0H                                                  0728 04927000
*               XTNHCHR2(1:4)=CCCHRVAL;                            0728 04928000
         L     @04,@PC00001+4                                      0728 04929000
         L     @01,FDTPTR+184(,@04)                                0728 04930000
         MVC   XTNHCHR2(4,XTNTPTR),CCCHRVAL(@01)                   0728 04931000
*               XTNHCHR2(5:5)=CRECRVAL;                            0729 04932000
         L     @04,FDTPTR+188(,@04)                                0729 04933000
         MVC   XTNHCHR2+4(1,XTNTPTR),CRECRVAL(@04)                 0729 04934000
*             END;                                                 0730 04935000
*           XTNHCHR1=CCCHRVAL;                                     0731 04936000
@RC00725 L     @04,@PC00001+4                                      0731 04937000
         L     @01,FDTPTR+184(,@04)                                0731 04938000
         MVC   XTNHCHR1(5,XTNTPTR),CCCHRVAL(@01)                   0731 04939000
*           XTNHDSN=FMT4DSN;                                       0732 04940000
         MVC   XTNHDSN(44,XTNTPTR),FMT4DSN                         0732 04941000
*           XTNHDDN=CINFLVAL;                                      0733 04942000
         L     @01,FDTPTR+140(,@04)                                0733 04943000
         MVC   XTNHDDN(8,XTNTPTR),CINFLVAL(@01)                    0733 04944000
*           XTNHVOLN=1;                                            0734 04945000
         MVI   XTNHVOLN(XTNTPTR),X'01'                             0734 04946000
*           XTNHVOL=CVOLSVAL;                                      0735 04947000
         L     @04,FDTPTR+180(,@04)                                0735 04948000
         MVC   XTNHVOL(6,XTNTPTR),CVOLSVAL(@04)                    0735 04949000
*           XTNHMODE=INPUT;                                        0736 04950000
         MVI   XTNHMODE(XTNTPTR),C'I'                              0736 04951000
*         END;                                                     0737 04952000
*                                                                  0737 04953000
*       /*************************************************************/ 04954000
*       /*                                                           */ 04955000
*       /* CONSTRUCT UIOINFO OPTION BYTE                             */ 04956000
*       /*                                                           */ 04957000
*       /*************************************************************/ 04958000
*                                                                  0738 04959000
*       IOINFOPT=''B;                                              0738 04960000
@RF00701 LA    @04,INFOBYT                                         0738 04961000
         MVI   IOINFOPT(@04),X'00'                                 0738 04962000
*       IOINFVOL=ON;                                               0739 04963000
*                                                                  0739 04964000
         OI    IOINFVOL(@04),B'01000000'                           0739 04965000
*       /*************************************************************/ 04966000
*       /*                                                           */ 04967000
*       /* ISSUE UIOINFO FOR DEVICE CHARACTERISTICS AND A LIST OF    */ 04968000
*       /* VOLUME SERIAL NUMBERS.                                    */ 04969000
*       /*                                                           */ 04970000
*       /*************************************************************/ 04971000
*                                                                  0740 04972000
*       CALL IDCIOSI0(GDTTBL,IOINFOPT,INFOPTR,INFODD);             0740 04973000
*                                                                  0740 04974000
         L     @15,@PC00001                                        0740 04975000
         ST    @15,@AL00001                                        0740 04976000
         ST    @04,@AL00001+4                                      0740 04977000
         LA    @04,INFOPTR                                         0740 04978000
         ST    @04,@AL00001+8                                      0740 04979000
         LA    @04,INFODD                                          0740 04980000
         ST    @04,@AL00001+12                                     0740 04981000
         MVI   @AL00001+12,X'80'                                   0740 04982000
         L     @15,GDTIFO(,@15)                                    0740 04983000
         LA    @01,@AL00001                                        0740 04984000
         BALR  @14,@15                                             0740 04985000
*       /*************************************************************/ 04986000
*       /*                                                           */ 04987000
*       /* SAVE RETURN CODE FROM UIOINFO                             */ 04988000
*       /*                                                           */ 04989000
*       /*************************************************************/ 04990000
*                                                                  0741 04991000
*       RESPECIFY                                                  0741 04992000
*         RTNREG RSTD;                                             0741 04993000
*       TESTRC=RTNREG;                                             0742 04994000
         STH   RTNREG,TESTRC                                       0742 04995000
*       RESPECIFY                                                  0743 04996000
*         RTNREG UNRSTD;                                           0743 04997000
*                                                                  0743 04998000
*       /*************************************************************/ 04999000
*       /*                                                           */ 05000000
*       /* IF UIOINFO FAILS, RETURN TO THE CALLER WITH RC = 12       */ 05001000
*       /*                                                           */ 05002000
*       /*************************************************************/ 05003000
*                                                                  0744 05004000
*       IF TESTRC^=0 THEN                                          0744 05005000
         LH    @04,TESTRC                                          0744 05006000
         LTR   @04,@04                                             0744 05007000
         BZ    @RF00744                                            0744 05008000
*         RETURN CODE(LASTCC12);                                   0745 05009000
*                                                                  0745 05010000
         LA    @15,12                                              0745 05011000
         L     @14,@SA00002                                        0745 05012000
         LM    @00,@12,@SA00002+8                                  0745 05013000
         BR    @14                                                 0745 05014000
*       /*************************************************************/ 05015000
*       /*                                                           */ 05016000
*       /* SETUP UIOINFO RETURN AREA ADDRESSABILITY                  */ 05017000
*       /*                                                           */ 05018000
*       /*************************************************************/ 05019000
*                                                                  0746 05020000
*       RESPECIFY                                                  0746 05021000
*         INFOSCAN BASED(INFSCNPT);                                0746 05022000
@RF00744 DS    0H                                                  0747 05023000
*       INFSCNPT=INFOPTR+LENGTH(INFAREAL)+LENGTH(INFDATAL);        0747 05024000
         LA    INFSCNPT,4                                          0747 05025000
         AL    INFSCNPT,INFOPTR                                    0747 05026000
*       IF INFSCNID=VOLIDENT THEN                                  0748 05027000
         CLC   INFSCNID(2,INFSCNPT),@CH00156                       0748 05028000
         BNE   @RF00748                                            0748 05029000
*         DO;                                                      0749 05030000
*           INFVOLPT=INFSCNPT;                                     0750 05031000
         ST    INFSCNPT,INFVOLPT                                   0750 05032000
*           RESPECIFY                                              0751 05033000
*             INFOVOL BASED(INFVOLPT);                             0751 05034000
*         END;                                                     0752 05035000
*       ELSE                                                       0753 05036000
*                                                                  0753 05037000
*         /***********************************************************/ 05038000
*         /*                                                         */ 05039000
*         /* RETURN TO THE CALLER WITH RC = 12                       */ 05040000
*         /*                                                         */ 05041000
*         /***********************************************************/ 05042000
*                                                                  0753 05043000
*         RETURN CODE(LASTCC12);                                   0753 05044000
*                                                                  0753 05045000
         B     @RC00748                                            0753 05046000
@RF00748 LA    @15,12                                              0753 05047000
         L     @14,@SA00002                                        0753 05048000
         LM    @00,@12,@SA00002+8                                  0753 05049000
         BR    @14                                                 0753 05050000
*       /*************************************************************/ 05051000
*       /*                                                           */ 05052000
*       /* IF VOLUME SERIAL NUMBER IN EXTENT TABLE HEADER (FROM      */ 05053000
*       /* STAGINGRANGE PARAMETER) DOES NOT MATCH VOLSER IN DD       */ 05054000
*       /* STATEMENT, PREPARE TO RETURN TO CALLER WITH RC = 12       */ 05055000
*       /*                                                           */ 05056000
*       /*************************************************************/ 05057000
*                                                                  0754 05058000
*       IF XTNHVOL^=INFVOL(1) THEN                                 0754 05059000
@RC00748 L     @04,INFVOLPT                                        0754 05060000
         CLC   XTNHVOL(6,XTNTPTR),INFVOL(@04)                      0754 05061000
         BE    @RF00754                                            0754 05062000
*         DO;                                                      0755 05063000
*                                                                  0755 05064000
*           /*********************************************************/ 05065000
*           /*                                                       */ 05066000
*           /* WRITE ERROR MESSAGE IDC31204I                         */ 05067000
*           /*                                                       */ 05068000
*           /*********************************************************/ 05069000
*                                                                  0756 05070000
*           DO;                                                    0756 05071000
*             CKREQ=CKREQ&&CKREQ;                                  0757 05072000
         L     @05,@PC00001+8                                      0757 05073000
         XC    CKREQ(44,@05),CKREQ(@05)                            0757 05074000
*             CKRERN=MSG04;                                        0758 05075000
         MVC   CKRERN(2,@05),@CH00045                              0758 05076000
*             CKRMVAR(1)=ADDR(INFVOL(1));                          0759 05077000
         LA    @04,INFVOL(,@04)                                    0759 05078000
         ST    @04,CKRMVAR(,@05)                                   0759 05079000
*             CALL IDCRDER;                                        0760 05080000
         L     @15,@CV01553                                        0760 05081000
         BALR  @14,@15                                             0760 05082000
*           END;                                                   0761 05083000
*                                                                  0761 05084000
*           /*********************************************************/ 05085000
*           /*                                                       */ 05086000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 05087000
*           /*                                                       */ 05088000
*           /*********************************************************/ 05089000
*                                                                  0762 05090000
*           RETURN CODE(LASTCC12);                                 0762 05091000
         LA    @15,12                                              0762 05092000
         L     @14,@SA00002                                        0762 05093000
         LM    @00,@12,@SA00002+8                                  0762 05094000
         BR    @14                                                 0762 05095000
*         END;                                                     0763 05096000
*                                                                  0763 05097000
*       /*************************************************************/ 05098000
*       /*                                                           */ 05099000
*       /* IF THE STARTING ADDRESS IS GREATER THAN THE ENDING        */ 05100000
*       /* ADDRESS, PREPARE TO RETURN TO THE CALLER WITH RC = 12     */ 05101000
*       /*                                                           */ 05102000
*       /*************************************************************/ 05103000
*                                                                  0764 05104000
*       IF XTNHCHR1>XTNHCHR2 THEN                                  0764 05105000
@RF00754 CLC   XTNHCHR1(5,XTNTPTR),XTNHCHR2(XTNTPTR)               0764 05106000
         BNH   @RF00764                                            0764 05107000
*         DO;                                                      0765 05108000
*                                                                  0765 05109000
*           /*********************************************************/ 05110000
*           /*                                                       */ 05111000
*           /* WRITE ERROR MESSAGE IDC31208I                         */ 05112000
*           /*                                                       */ 05113000
*           /*********************************************************/ 05114000
*                                                                  0766 05115000
*           DO;                                                    0766 05116000
*             CKREQ=CKREQ&&CKREQ;                                  0767 05117000
         L     @04,@PC00001+8                                      0767 05118000
         XC    CKREQ(44,@04),CKREQ(@04)                            0767 05119000
*             CKRERN=MSG08;                                        0768 05120000
         MVC   CKRERN(2,@04),@CH00181                              0768 05121000
*             CKRMVAR(1)=ADDR(XTNHCHR1);                           0769 05122000
         LA    @15,XTNHCHR1(,XTNTPTR)                              0769 05123000
         ST    @15,CKRMVAR(,@04)                                   0769 05124000
*             CKRMVAR(2)=ADDR(XTNHCHR2);                           0770 05125000
         LA    @15,XTNHCHR2(,XTNTPTR)                              0770 05126000
         ST    @15,CKRMVAR+4(,@04)                                 0770 05127000
*             CKRMVAR(3)=ADDR(XTNHVOL);                            0771 05128000
         LA    @15,XTNHVOL(,XTNTPTR)                               0771 05129000
         ST    @15,CKRMVAR+8(,@04)                                 0771 05130000
*             CALL IDCRDER;                                        0772 05131000
         L     @15,@CV01553                                        0772 05132000
         BALR  @14,@15                                             0772 05133000
*           END;                                                   0773 05134000
*                                                                  0773 05135000
*           /*********************************************************/ 05136000
*           /*                                                       */ 05137000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 05138000
*           /*                                                       */ 05139000
*           /*********************************************************/ 05140000
*                                                                  0774 05141000
*           RETURN CODE(LASTCC12);                                 0774 05142000
         LA    @15,12                                              0774 05143000
         L     @14,@SA00002                                        0774 05144000
         LM    @00,@12,@SA00002+8                                  0774 05145000
         BR    @14                                                 0774 05146000
*         END;                                                     0775 05147000
*                                                                  0775 05148000
*       /*************************************************************/ 05149000
*       /*                                                           */ 05150000
*       /* ISSUE DEVTYPE MACRO                                       */ 05151000
*       /*                                                           */ 05152000
*       /*************************************************************/ 05153000
*                                                                  0776 05154000
*       RESPECIFY                                                  0776 05155000
*        (REG3,                                                    0776 05156000
*         REG4) RESTRICTED;                                        0776 05157000
@RF00764 DS    0H                                                  0777 05158000
*       REG3=ADDR(XTNHDDN);                                        0777 05159000
         LR    REG3,XTNTPTR                                        0777 05160000
*       DEVAREAP=REPIDEVA;                                         0778 05161000
         L     @02,@PC00001+8                                      0778 05162000
         L     @02,REPIDEVA(,@02)                                  0778 05163000
         ST    @02,DEVAREAP                                        0778 05164000
*       REG4=DEVAREAP;                                             0779 05165000
         LR    REG4,@02                                            0779 05166000
*LDEVTYP2:                                                         0780 05167000
*       GEN;                                                       0780 05168000
LDEVTYP2 DS    0H                                                  0780 05169000
         DEVTYPE (3),(4),DEVTAB                                         05170000
*       RESPECIFY                                                  0781 05171000
*        (REG3,                                                    0781 05172000
*         REG4) UNRESTRICTED;                                      0781 05173000
*       RESPECIFY                                                  0782 05174000
*         DEVAREA BASED(DEVAREAP);                                 0782 05175000
*                                                                  0782 05176000
*       /*************************************************************/ 05177000
*       /*                                                           */ 05178000
*       /* SAVE RETURN CODE FROM DEVTYPE                             */ 05179000
*       /*                                                           */ 05180000
*       /*************************************************************/ 05181000
*                                                                  0783 05182000
*       RESPECIFY                                                  0783 05183000
*         RTNREG RSTD;                                             0783 05184000
*       TESTRC=RTNREG;                                             0784 05185000
         STH   RTNREG,TESTRC                                       0784 05186000
*       RESPECIFY                                                  0785 05187000
*         RTNREG UNRSTD;                                           0785 05188000
*                                                                  0785 05189000
*       /*************************************************************/ 05190000
*       /*                                                           */ 05191000
*       /* IF DEVTYPE FAILS, RETURN TO THE CALLER WITH RC = 12       */ 05192000
*       /*                                                           */ 05193000
*       /*************************************************************/ 05194000
*                                                                  0786 05195000
*       IF TESTRC^=0 THEN                                          0786 05196000
         LH    @04,TESTRC                                          0786 05197000
         LTR   @04,@04                                             0786 05198000
         BZ    @RF00786                                            0786 05199000
*         RETURN CODE(LASTCC12);                                   0787 05200000
*                                                                  0787 05201000
         LA    @15,12                                              0787 05202000
         L     @14,@SA00002                                        0787 05203000
         LM    @00,@12,@SA00002+8                                  0787 05204000
         BR    @14                                                 0787 05205000
*       /*************************************************************/ 05206000
*       /*                                                           */ 05207000
*       /* IF THE STAGING PACK IS MOUNTED ON A VIRTUAL UNIT, PREPARE */ 05208000
*       /* TO RETURN TO THE CALLER WITH RC = 12                      */ 05209000
*       /*                                                           */ 05210000
*       /*************************************************************/ 05211000
*                                                                  0788 05212000
*       IF DEVRVDEV=ON THEN                                        0788 05213000
@RF00786 L     @04,DEVAREAP                                        0788 05214000
         TM    DEVRVDEV(@04),B'00001000'                           0788 05215000
         BNO   @RF00788                                            0788 05216000
*         DO;                                                      0789 05217000
*                                                                  0789 05218000
*           /*********************************************************/ 05219000
*           /*                                                       */ 05220000
*           /* WRITE ERROR MESSAGE IDC31203I                         */ 05221000
*           /*                                                       */ 05222000
*           /*********************************************************/ 05223000
*                                                                  0790 05224000
*           DO;                                                    0790 05225000
*             CKREQ=CKREQ&&CKREQ;                                  0791 05226000
         L     @15,@PC00001+8                                      0791 05227000
         XC    CKREQ(44,@15),CKREQ(@15)                            0791 05228000
*             CKRERN=MSG03;                                        0792 05229000
         MVC   CKRERN(2,@15),@CH00164                              0792 05230000
*             CALL IDCRDER;                                        0793 05231000
         L     @15,@CV01553                                        0793 05232000
         BALR  @14,@15                                             0793 05233000
*           END;                                                   0794 05234000
*                                                                  0794 05235000
*           /*********************************************************/ 05236000
*           /*                                                       */ 05237000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 05238000
*           /*                                                       */ 05239000
*           /*********************************************************/ 05240000
*                                                                  0795 05241000
*           RETURN CODE(LASTCC12);                                 0795 05242000
         LA    @15,12                                              0795 05243000
         L     @14,@SA00002                                        0795 05244000
         LM    @00,@12,@SA00002+8                                  0795 05245000
         BR    @14                                                 0795 05246000
*         END;                                                     0796 05247000
*                                                                  0796 05248000
*       /*************************************************************/ 05249000
*       /*                                                           */ 05250000
*       /* COMPARE STARTING ADDRESS CC AND HH AGAINST MAXIMUM        */ 05251000
*       /* CYLINDER AND TRACK NUMBERS FOR THE DEVICE AS RETURNED BY  */ 05252000
*       /* DEVTYPE. IF ANY USER-SUPPLIED VALUE IS LARGER THAN THE    */ 05253000
*       /* CORRESPONDING MAXIMUM FOR THE DEVICE, PREPARE TO RETURN TO*/ 05254000
*       /* THE CALLER WITH RC = 12                                   */ 05255000
*       /*                                                           */ 05256000
*       /*************************************************************/ 05257000
*                                                                  0797 05258000
*       IF XTNHCHR1(1:2)>DEVMAXCC|XTNHCHR1(3:4)>DEVMAXHH THEN      0797 05259000
@RF00788 L     @04,DEVAREAP                                        0797 05260000
         CLC   XTNHCHR1(2,XTNTPTR),DEVMAXCC(@04)                   0797 05261000
         BH    @RT00797                                            0797 05262000
         CLC   XTNHCHR1+2(2,XTNTPTR),DEVMAXHH(@04)                 0797 05263000
         BNH   @RF00797                                            0797 05264000
@RT00797 DS    0H                                                  0798 05265000
*         DO;                                                      0798 05266000
*                                                                  0798 05267000
*           /*********************************************************/ 05268000
*           /*                                                       */ 05269000
*           /* WRITE ERROR MESSAGE IDC31205I                         */ 05270000
*           /*                                                       */ 05271000
*           /*********************************************************/ 05272000
*                                                                  0799 05273000
*           DO;                                                    0799 05274000
*             CKREQ=CKREQ&&CKREQ;                                  0800 05275000
         L     @04,@PC00001+8                                      0800 05276000
         XC    CKREQ(44,@04),CKREQ(@04)                            0800 05277000
*             CKRERN=MSG05;                                        0801 05278000
         MVC   CKRERN(2,@04),@CH00288                              0801 05279000
*             CKRMVAR(1)=ADDR(XTNHCHR1);                           0802 05280000
         LA    @15,XTNHCHR1(,XTNTPTR)                              0802 05281000
         ST    @15,CKRMVAR(,@04)                                   0802 05282000
*             CALL IDCRDER;                                        0803 05283000
         L     @15,@CV01553                                        0803 05284000
         BALR  @14,@15                                             0803 05285000
*           END;                                                   0804 05286000
*                                                                  0804 05287000
*           /*********************************************************/ 05288000
*           /*                                                       */ 05289000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 05290000
*           /*                                                       */ 05291000
*           /*********************************************************/ 05292000
*                                                                  0805 05293000
*           RETURN CODE(LASTCC12);                                 0805 05294000
         LA    @15,12                                              0805 05295000
         L     @14,@SA00002                                        0805 05296000
         LM    @00,@12,@SA00002+8                                  0805 05297000
         BR    @14                                                 0805 05298000
*         END;                                                     0806 05299000
*                                                                  0806 05300000
*       /*************************************************************/ 05301000
*       /*                                                           */ 05302000
*       /* IF ENDING ADDRESS IS NOT EQUAL TO STARTING ADDRESS,       */ 05303000
*       /* COMPARE ENDING ADDRESS CC AND HH AGAINST MAXIMUM CYLINDER */ 05304000
*       /* AND TRACK NUMBERS FOR THE DEVICE AS RETURNED BY DEVTYPE.  */ 05305000
*       /* IF ANY USER-SUPPLIED VALUE IS LARGER THAN THE             */ 05306000
*       /* CORRESPONDING MAXIMUM FOR THE DEVICE, PREPARE TO RETURN TO*/ 05307000
*       /* THE CALLER WITH RC = 12                                   */ 05308000
*       /*                                                           */ 05309000
*       /*************************************************************/ 05310000
*                                                                  0807 05311000
*       IF XTNHCHR1(1:4)^=XTNHCHR2(1:4) THEN                       0807 05312000
@RF00797 CLC   XTNHCHR1(4,XTNTPTR),XTNHCHR2(XTNTPTR)               0807 05313000
         BE    @RF00807                                            0807 05314000
*         DO;                                                      0808 05315000
*           IF XTNHCHR2(1:2)>DEVMAXCC|XTNHCHR2(3:4)>DEVMAXHH THEN  0809 05316000
         L     @04,DEVAREAP                                        0809 05317000
         CLC   XTNHCHR2(2,XTNTPTR),DEVMAXCC(@04)                   0809 05318000
         BH    @RT00809                                            0809 05319000
         CLC   XTNHCHR2+2(2,XTNTPTR),DEVMAXHH(@04)                 0809 05320000
         BNH   @RF00809                                            0809 05321000
@RT00809 DS    0H                                                  0810 05322000
*             DO;                                                  0810 05323000
*                                                                  0810 05324000
*               /*****************************************************/ 05325000
*               /*                                                   */ 05326000
*               /* WRITE ERROR MESSAGE IDC31205I                     */ 05327000
*               /*                                                   */ 05328000
*               /*****************************************************/ 05329000
*                                                                  0811 05330000
*               DO;                                                0811 05331000
*                 CKREQ=CKREQ&&CKREQ;                              0812 05332000
         L     @04,@PC00001+8                                      0812 05333000
         XC    CKREQ(44,@04),CKREQ(@04)                            0812 05334000
*                 CKRERN=MSG05;                                    0813 05335000
         MVC   CKRERN(2,@04),@CH00288                              0813 05336000
*                 CKRMVAR(1)=ADDR(XTNHCHR2);                       0814 05337000
         LA    @15,XTNHCHR2(,XTNTPTR)                              0814 05338000
         ST    @15,CKRMVAR(,@04)                                   0814 05339000
*                 CALL IDCRDER;                                    0815 05340000
         L     @15,@CV01553                                        0815 05341000
         BALR  @14,@15                                             0815 05342000
*               END;                                               0816 05343000
*                                                                  0816 05344000
*               /*****************************************************/ 05345000
*               /*                                                   */ 05346000
*               /* RETURN TO THE CALLER WITH RC = 12                 */ 05347000
*               /*                                                   */ 05348000
*               /*****************************************************/ 05349000
*                                                                  0817 05350000
*               RETURN CODE(LASTCC12);                             0817 05351000
         LA    @15,12                                              0817 05352000
         L     @14,@SA00002                                        0817 05353000
         LM    @00,@12,@SA00002+8                                  0817 05354000
         BR    @14                                                 0817 05355000
*             END;                                                 0818 05356000
*         END;                                                     0819 05357000
*                                                                  0819 05358000
@RF00809 DS    0H                                                  0820 05359000
*       /*************************************************************/ 05360000
*       /*                                                           */ 05361000
*       /* MOVE WTOR LIST FORM                                       */ 05362000
*       /*                                                           */ 05363000
*       /*************************************************************/ 05364000
*                                                                  0820 05365000
*       WTORLIST=LWTORLST;                                         0820 05366000
*                                                                  0820 05367000
@RF00807 MVC   WTORLIST(84),LWTORLST                               0820 05368000
*       /*************************************************************/ 05369000
*       /*                                                           */ 05370000
*       /* SETUP DARGLIST TO LOAD IDC498D MESSAGE                    */ 05371000
*       /*                                                           */ 05372000
*       /*************************************************************/ 05373000
*                                                                  0821 05374000
*       DARGL=''B;                                                 0821 05375000
         XC    DARGL(20),DARGL                                     0821 05376000
*       DDSTRU=ADDR(DARGL);                                        0822 05377000
         LA    @04,DARGL                                           0822 05378000
         ST    @04,DDSTRU                                          0822 05379000
*       DARGRETP=ADDR(WTORLIST)+12;                                0823 05380000
         LA    @15,WTORLIST                                        0823 05381000
         AL    @15,@CF00039                                        0823 05382000
         ST    @15,DARGRETP(,@04)                                  0823 05383000
*       DARGSENT=MSG77;                                            0824 05384000
         MVI   DARGSENT(@04),X'4D'                                 0824 05385000
*       DARGSMOD=WTORID;                                           0825 05386000
         MVC   DARGSMOD(3,@04),@CC02814                            0825 05387000
*       DARGRETL=LENGTH(WTORLIST)-12;                              0826 05388000
*                                                                  0826 05389000
         MVC   DARGRETL(2,@04),@CH00818                            0826 05390000
*       /*************************************************************/ 05391000
*       /*                                                           */ 05392000
*       /* ISSUE UPRINT TO LOAD MESSAGE IDC498D                      */ 05393000
*       /*                                                           */ 05394000
*       /*************************************************************/ 05395000
*                                                                  0827 05396000
*       CALL AMSTP011(GDTTBL,0,DDSTRU);                            0827 05397000
*                                                                  0827 05398000
         L     @04,@PC00001                                        0827 05399000
         ST    @04,@AL00001                                        0827 05400000
         LA    @15,@CF00118                                        0827 05401000
         ST    @15,@AL00001+4                                      0827 05402000
         LA    @15,DDSTRU                                          0827 05403000
         ST    @15,@AL00001+8                                      0827 05404000
         MVI   @AL00001+8,X'80'                                    0827 05405000
         L     @15,GDTPRT(,@04)                                    0827 05406000
         LA    @01,@AL00001                                        0827 05407000
         BALR  @14,@15                                             0827 05408000
*       /*************************************************************/ 05409000
*       /*                                                           */ 05410000
*       /* SAVE RETURN CODE FROM UPRINT                              */ 05411000
*       /*                                                           */ 05412000
*       /*************************************************************/ 05413000
*                                                                  0828 05414000
*       RESPECIFY                                                  0828 05415000
*         RTNREG RSTD;                                             0828 05416000
*       TESTRC=RTNREG;                                             0829 05417000
         STH   RTNREG,TESTRC                                       0829 05418000
*       RESPECIFY                                                  0830 05419000
*         RTNREG UNRSTD;                                           0830 05420000
*                                                                  0830 05421000
*       /*************************************************************/ 05422000
*       /*                                                           */ 05423000
*       /* IF UPRINT FAILS, RETURN TO THE CALLER WITH RC = 12        */ 05424000
*       /*                                                           */ 05425000
*       /*************************************************************/ 05426000
*                                                                  0831 05427000
*       IF TESTRC^=0 THEN                                          0831 05428000
         LH    @04,TESTRC                                          0831 05429000
         LTR   @04,@04                                             0831 05430000
         BZ    @RF00831                                            0831 05431000
*         RETURN CODE(LASTCC12);                                   0832 05432000
*                                                                  0832 05433000
         LA    @15,12                                              0832 05434000
         L     @14,@SA00002                                        0832 05435000
         LM    @00,@12,@SA00002+8                                  0832 05436000
         BR    @14                                                 0832 05437000
*       /*************************************************************/ 05438000
*       /*                                                           */ 05439000
*       /* INSERT VOLSER OF STAGING PACK IN MESSAGE                  */ 05440000
*       /*                                                           */ 05441000
*       /*************************************************************/ 05442000
*                                                                  0833 05443000
*       WTORLIST(64:69)=XTNHVOL;                                   0833 05444000
*                                                                  0833 05445000
@RF00831 MVC   WTORLIST+63(6),XTNHVOL(XTNTPTR)                     0833 05446000
*       /*************************************************************/ 05447000
*       /*                                                           */ 05448000
*       /* PROMPT CONSOLE OPERATOR FOR AUTHORIZATION TO ACCESS VOLUME*/ 05449000
*       /*                                                           */ 05450000
*       /*************************************************************/ 05451000
*                                                                  0834 05452000
*       DO UNTIL(WTOREPLY=Y)|(WTOREPLY=N);                         0834 05453000
@DL00834 DS    0H                                                  0835 05454000
*         WTOREPLY=''B;                                            0835 05455000
         MVI   WTOREPLY,X'00'                                      0835 05456000
*         WTORECB=''B;                                             0836 05457000
         XC    WTORECB(4),WTORECB                                  0836 05458000
*         RESPECIFY                                                0837 05459000
*           REG3 RESTRICTED;                                       0837 05460000
*         REG3=ADDR(WTORLIST);                                     0838 05461000
         LA    REG3,WTORLIST                                       0838 05462000
*LWTOR2:                                                           0839 05463000
*         GEN;                                                     0839 05464000
LWTOR2   DS    0H                                                  0839 05465000
         WTOR  ,WTOREPLY,1,WTORECB,MF=(E,(3))                           05466000
         WAIT ECB=WTORECB                                               05467000
         DOM   MSG=(1)                                                  05468000
*         RESPECIFY                                                0840 05469000
*           REG3 UNRESTRICTED;                                     0840 05470000
*       END;                                                       0841 05471000
*                                                                  0841 05472000
@DE00834 CLI   WTOREPLY,C'Y'                                       0841 05473000
         BE    @DC00834                                            0841 05474000
         CLI   WTOREPLY,C'N'                                       0841 05475000
         BNE   @DL00834                                            0841 05476000
@DC00834 DS    0H                                                  0842 05477000
*       /*************************************************************/ 05478000
*       /*                                                           */ 05479000
*       /* IF REPLY IS 'N', PREPARE TO RETURN TO THE CALLER WITH RC =*/ 05480000
*       /* 12                                                        */ 05481000
*       /*                                                           */ 05482000
*       /*************************************************************/ 05483000
*                                                                  0842 05484000
*       IF WTOREPLY=N THEN                                         0842 05485000
         CLI   WTOREPLY,C'N'                                       0842 05486000
         BNE   @RF00842                                            0842 05487000
*         DO;                                                      0843 05488000
*                                                                  0843 05489000
*           /*********************************************************/ 05490000
*           /*                                                       */ 05491000
*           /* WRITE ERROR MESSAGE IDC31206I                         */ 05492000
*           /*                                                       */ 05493000
*           /*********************************************************/ 05494000
*                                                                  0844 05495000
*           DO;                                                    0844 05496000
*             CKREQ=CKREQ&&CKREQ;                                  0845 05497000
         L     @04,@PC00001+8                                      0845 05498000
         XC    CKREQ(44,@04),CKREQ(@04)                            0845 05499000
*             CKRERN=MSG06;                                        0846 05500000
         MVC   CKRERN(2,@04),@CH00035                              0846 05501000
*             CKRMVAR(1)=ADDR(XTNHVOL);                            0847 05502000
         LA    @15,XTNHVOL(,XTNTPTR)                               0847 05503000
         ST    @15,CKRMVAR(,@04)                                   0847 05504000
*             CALL IDCRDER;                                        0848 05505000
         L     @15,@CV01553                                        0848 05506000
         BALR  @14,@15                                             0848 05507000
*           END;                                                   0849 05508000
*                                                                  0849 05509000
*           /*********************************************************/ 05510000
*           /*                                                       */ 05511000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 05512000
*           /*                                                       */ 05513000
*           /*********************************************************/ 05514000
*                                                                  0850 05515000
*           RETURN CODE(LASTCC12);                                 0850 05516000
         LA    @15,12                                              0850 05517000
         L     @14,@SA00002                                        0850 05518000
         LM    @00,@12,@SA00002+8                                  0850 05519000
         BR    @14                                                 0850 05520000
*         END;                                                     0851 05521000
*                                                                  0851 05522000
*       /*************************************************************/ 05523000
*       /*                                                           */ 05524000
*       /* ISSUE USYSINFO TO OBTAIN THE UCB ADDRESS                  */ 05525000
*       /*                                                           */ 05526000
*       /*************************************************************/ 05527000
*                                                                  0852 05528000
*       SINFPTR=REPISYSI;                                          0852 05529000
@RF00842 L     @04,@PC00001+8                                      0852 05530000
         L     @04,REPISYSI(,@04)                                  0852 05531000
         ST    @04,SINFPTR                                         0852 05532000
*       CALL IDCSASI0(GDTTBL,UNIT,SINFPTR,XTNHDDN);                0853 05533000
*                                                                  0853 05534000
         L     @04,@PC00001                                        0853 05535000
         ST    @04,@AL00001                                        0853 05536000
         LA    @15,UNIT                                            0853 05537000
         ST    @15,@AL00001+4                                      0853 05538000
         LA    @15,SINFPTR                                         0853 05539000
         ST    @15,@AL00001+8                                      0853 05540000
         ST    XTNTPTR,@AL00001+12                                 0853 05541000
         MVI   @AL00001+12,X'80'                                   0853 05542000
         L     @15,GDTSFO(,@04)                                    0853 05543000
         LA    @01,@AL00001                                        0853 05544000
         BALR  @14,@15                                             0853 05545000
*       /*************************************************************/ 05546000
*       /*                                                           */ 05547000
*       /* SAVE RETURN CODE FROM USYSINFO                            */ 05548000
*       /*                                                           */ 05549000
*       /*************************************************************/ 05550000
*                                                                  0854 05551000
*       RESPECIFY                                                  0854 05552000
*         RTNREG RSTD;                                             0854 05553000
*       TESTRC=RTNREG;                                             0855 05554000
         STH   RTNREG,TESTRC                                       0855 05555000
*       RESPECIFY                                                  0856 05556000
*         RTNREG UNRSTD;                                           0856 05557000
*                                                                  0856 05558000
*       /*************************************************************/ 05559000
*       /*                                                           */ 05560000
*       /* IF USYSINFO FAILS, RETURN TO THE CALLER WITH RC = 12      */ 05561000
*       /*                                                           */ 05562000
*       /*************************************************************/ 05563000
*                                                                  0857 05564000
*       IF TESTRC^=0 THEN                                          0857 05565000
         LH    @04,TESTRC                                          0857 05566000
         LTR   @04,@04                                             0857 05567000
         BZ    @RF00857                                            0857 05568000
*         RETURN CODE(LASTCC12);                                   0858 05569000
*                                                                  0858 05570000
         LA    @15,12                                              0858 05571000
         L     @14,@SA00002                                        0858 05572000
         LM    @00,@12,@SA00002+8                                  0858 05573000
         BR    @14                                                 0858 05574000
*       /*************************************************************/ 05575000
*       /*                                                           */ 05576000
*       /* CONSTRUCT QNAME, RNAME LENGTH, RNAME                      */ 05577000
*       /*                                                           */ 05578000
*       /*************************************************************/ 05579000
*                                                                  0859 05580000
*       SPQNAME=SYSVTOC;                                           0859 05581000
@RF00857 L     @04,@PC00001+8                                      0859 05582000
         L     @04,REPQRPTR(,@04)                                  0859 05583000
         MVC   SPQNAME(8,@04),@CC02747                             0859 05584000
*       SPRLEN=LENGTH(SPRVOL);                                     0860 05585000
         MVI   SPRLEN(@04),X'06'                                   0860 05586000
*       SPRVOL=XTNHVOL;                                            0861 05587000
*                                                                  0861 05588000
         MVC   SPRVOL(6,@04),XTNHVOL(XTNTPTR)                      0861 05589000
*       /*************************************************************/ 05590000
*       /*                                                           */ 05591000
*       /* ISSUE URESERVE TO RESERVE THE VOLUME                      */ 05592000
*       /*                                                           */ 05593000
*       /*************************************************************/ 05594000
*                                                                  0862 05595000
*       CALL IDCSARV0(GDTTBL,EXCL,WAIT,SINFAREA,SPQNAME,SPRNAME);  0862 05596000
*                                                                  0862 05597000
         L     @15,@PC00001                                        0862 05598000
         ST    @15,@AL00001                                        0862 05599000
         LA    @14,EXCL                                            0862 05600000
         ST    @14,@AL00001+4                                      0862 05601000
         LA    @14,WAIT                                            0862 05602000
         ST    @14,@AL00001+8                                      0862 05603000
         L     @01,SINFPTR                                         0862 05604000
         ST    @01,@AL00001+12                                     0862 05605000
         ST    @04,@AL00001+16                                     0862 05606000
         LA    @04,SPRNAME(,@04)                                   0862 05607000
         ST    @04,@AL00001+20                                     0862 05608000
         MVI   @AL00001+20,X'80'                                   0862 05609000
         L     @15,GDTRSV(,@15)                                    0862 05610000
         LA    @01,@AL00001                                        0862 05611000
         BALR  @14,@15                                             0862 05612000
*       /*************************************************************/ 05613000
*       /*                                                           */ 05614000
*       /* SAVE THE RETURN CODE FROM URESERVE                        */ 05615000
*       /*                                                           */ 05616000
*       /*************************************************************/ 05617000
*                                                                  0863 05618000
*       RESPECIFY                                                  0863 05619000
*         RTNREG RSTD;                                             0863 05620000
*       TESTRC=RTNREG;                                             0864 05621000
         STH   RTNREG,TESTRC                                       0864 05622000
*       RESPECIFY                                                  0865 05623000
*         RTNREG UNRSTD;                                           0865 05624000
*                                                                  0865 05625000
*       /*************************************************************/ 05626000
*       /*                                                           */ 05627000
*       /* IF URESERVE FAILS, PREPARE TO RETURN TO THE CALLER WITH RC*/ 05628000
*       /* = 12                                                      */ 05629000
*       /*                                                           */ 05630000
*       /*************************************************************/ 05631000
*                                                                  0866 05632000
*       IF TESTRC^=0 THEN                                          0866 05633000
         LH    @04,TESTRC                                          0866 05634000
         LTR   @04,@04                                             0866 05635000
         BZ    @RF00866                                            0866 05636000
*         RETURN CODE(LASTCC12);                                   0867 05637000
*                                                                  0867 05638000
         LA    @15,12                                              0867 05639000
         L     @14,@SA00002                                        0867 05640000
         LM    @00,@12,@SA00002+8                                  0867 05641000
         BR    @14                                                 0867 05642000
*       /*************************************************************/ 05643000
*       /*                                                           */ 05644000
*       /* CONSTRUCT THE OPEN ARGUMENT LIST (EXOARG)                 */ 05645000
*       /*                                                           */ 05646000
*       /*************************************************************/ 05647000
*                                                                  0868 05648000
*       EXOARG=''B;                                                0868 05649000
@RF00866 L     @04,@PC00001+8                                      0868 05650000
         L     @15,REPEXOAR(,@04)                                  0868 05651000
         XC    EXOARG(34,@15),EXOARG(@15)                          0868 05652000
*       EXODDN=ADDR(XTNHDDN);                                      0869 05653000
         ST    XTNTPTR,EXODDN(,@15)                                0869 05654000
*       EXODSN=ADDR(XTNHDSN);                                      0870 05655000
         LA    @14,XTNHDSN(,XTNTPTR)                               0870 05656000
         ST    @14,EXODSN(,@15)                                    0870 05657000
*       EXOCTLBK=ADDR(REPIDSOP);                                   0871 05658000
         LA    @04,REPIDSOP(,@04)                                  0871 05659000
         ST    @04,EXOCTLBK(,@15)                                  0871 05660000
*       EXOREAD=ON;                                                0872 05661000
         OI    EXOREAD(@15),B'10000000'                            0872 05662000
*       EXOREP=ON;                                                 0873 05663000
         OI    EXOREP(@15),B'00000100'                             0873 05664000
*       EXOSPK=ON;                                                 0874 05665000
         OI    EXOSPK(@15),B'00001000'                             0874 05666000
*       EXOEXT=ADDR(XTNHCHR1);                                     0875 05667000
*                                                                  0875 05668000
         LA    @04,XTNHCHR1(,XTNTPTR)                              0875 05669000
         ST    @04,EXOEXT(,@15)                                    0875 05670000
*       /*************************************************************/ 05671000
*       /*                                                           */ 05672000
*       /* ISSUE UEXCP OPENR                                         */ 05673000
*       /*                                                           */ 05674000
*       /*************************************************************/ 05675000
*                                                                  0876 05676000
*       CALL IDCIO050(GDTTBL,OPENR,EXOARG);                        0876 05677000
*                                                                  0876 05678000
         L     @04,@PC00001                                        0876 05679000
         ST    @04,@AL00001                                        0876 05680000
         LA    @14,@CC02024                                        0876 05681000
         ST    @14,@AL00001+4                                      0876 05682000
         ST    @15,@AL00001+8                                      0876 05683000
         MVI   @AL00001+8,X'80'                                    0876 05684000
         L     @15,GDTEXP(,@04)                                    0876 05685000
         LA    @01,@AL00001                                        0876 05686000
         BALR  @14,@15                                             0876 05687000
*       /*************************************************************/ 05688000
*       /*                                                           */ 05689000
*       /* SAVE RETURN CODE FROM UEXCP                               */ 05690000
*       /*                                                           */ 05691000
*       /*************************************************************/ 05692000
*                                                                  0877 05693000
*       RESPECIFY                                                  0877 05694000
*         RTNREG RSTD;                                             0877 05695000
*       TESTRC=RTNREG;                                             0878 05696000
         STH   RTNREG,TESTRC                                       0878 05697000
*       RESPECIFY                                                  0879 05698000
*         RTNREG UNRSTD;                                           0879 05699000
*                                                                  0879 05700000
*       /*************************************************************/ 05701000
*       /*                                                           */ 05702000
*       /* IF UEXCP FAILS, PREPARE TO RETURN TO THE CALLER WITH RC = */ 05703000
*       /* 12                                                        */ 05704000
*       /*                                                           */ 05705000
*       /*************************************************************/ 05706000
*                                                                  0880 05707000
*       IF TESTRC^=0 THEN                                          0880 05708000
         LH    @04,TESTRC                                          0880 05709000
         LTR   @04,@04                                             0880 05710000
         BZ    @RF00880                                            0880 05711000
*         DO;                                                      0881 05712000
*                                                                  0881 05713000
*           /*********************************************************/ 05714000
*           /*                                                       */ 05715000
*           /* DEQ THE STAGING PACK                                  */ 05716000
*           /*                                                       */ 05717000
*           /*********************************************************/ 05718000
*                                                                  0882 05719000
*           CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);                 0882 05720000
*                                                                  0882 05721000
         L     @15,@PC00001                                        0882 05722000
         ST    @15,@AL00001                                        0882 05723000
         L     @14,@PC00001+8                                      0882 05724000
         L     @14,REPQRPTR(,@14)                                  0882 05725000
         ST    @14,@AL00001+4                                      0882 05726000
         LA    @14,SPRNAME(,@14)                                   0882 05727000
         ST    @14,@AL00001+8                                      0882 05728000
         MVI   @AL00001+8,X'80'                                    0882 05729000
         L     @15,GDTDEQ(,@15)                                    0882 05730000
         LA    @01,@AL00001                                        0882 05731000
         BALR  @14,@15                                             0882 05732000
*           /*********************************************************/ 05733000
*           /*                                                       */ 05734000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 05735000
*           /*                                                       */ 05736000
*           /*********************************************************/ 05737000
*                                                                  0883 05738000
*           RETURN CODE(LASTCC12);                                 0883 05739000
         LA    @15,12                                              0883 05740000
         L     @14,@SA00002                                        0883 05741000
         LM    @00,@12,@SA00002+8                                  0883 05742000
         BR    @14                                                 0883 05743000
*         END;                                                     0884 05744000
*                                                                  0884 05745000
*       /*************************************************************/ 05746000
*       /*                                                           */ 05747000
*       /* CALCULATE REQUIRED BYTES FOR THE I/O BUFFER               */ 05748000
*       /*                                                           */ 05749000
*       /*************************************************************/ 05750000
*                                                                  0885 05751000
*       REQBYTES=DEVTC+LENGTH(RIOHDR);                             0885 05752000
*                                                                  0885 05753000
@RF00880 LA    @04,282                                             0885 05754000
         L     @01,DEVAREAP                                        0885 05755000
         LH    @15,DEVTC(,@01)                                     0885 05756000
         N     @15,@CF03043                                        0885 05757000
         ALR   @04,@15                                             0885 05758000
         ST    @04,REQBYTES                                        0885 05759000
*       /*************************************************************/ 05760000
*       /*                                                           */ 05761000
*       /* ISSUE UGPOOL FOR SPACE FOR AN I/O BUFFER.                 */ 05762000
*       /*                                                           */ 05763000
*       /*************************************************************/ 05764000
*                                                                  0886 05765000
*       CALL IDCSAGP0(GDTTBL,REQBYTES,REPIBFPT,RD01,SETZERO);      0886 05766000
*                                                                  0886 05767000
         L     @04,@PC00001                                        0886 05768000
         ST    @04,@AL00001                                        0886 05769000
         LA    @15,REQBYTES                                        0886 05770000
         ST    @15,@AL00001+4                                      0886 05771000
         L     @15,@PC00001+8                                      0886 05772000
         LA    @15,REPIBFPT(,@15)                                  0886 05773000
         ST    @15,@AL00001+8                                      0886 05774000
         LA    @15,@CC02759                                        0886 05775000
         ST    @15,@AL00001+12                                     0886 05776000
         LA    @15,SETZERO                                         0886 05777000
         ST    @15,@AL00001+16                                     0886 05778000
         MVI   @AL00001+16,X'80'                                   0886 05779000
         L     @15,GDTGPL(,@04)                                    0886 05780000
         LA    @01,@AL00001                                        0886 05781000
         BALR  @14,@15                                             0886 05782000
*       /*************************************************************/ 05783000
*       /*                                                           */ 05784000
*       /* SAVE RETURN CODE FROM UGPOOL                              */ 05785000
*       /*                                                           */ 05786000
*       /*************************************************************/ 05787000
*                                                                  0887 05788000
*       RESPECIFY                                                  0887 05789000
*         RTNREG RSTD;                                             0887 05790000
*       TESTRC=RTNREG;                                             0888 05791000
         STH   RTNREG,TESTRC                                       0888 05792000
*       RESPECIFY                                                  0889 05793000
*         RTNREG UNRSTD;                                           0889 05794000
*                                                                  0889 05795000
*       /*************************************************************/ 05796000
*       /*                                                           */ 05797000
*       /* IF UGPOOL FAILS, PREPARE TO RETURN TO THE CALLER WITH RC =*/ 05798000
*       /* 12                                                        */ 05799000
*       /*                                                           */ 05800000
*       /*************************************************************/ 05801000
*                                                                  0890 05802000
*       IF TESTRC^=0 THEN                                          0890 05803000
         LH    @04,TESTRC                                          0890 05804000
         LTR   @04,@04                                             0890 05805000
         BZ    @RF00890                                            0890 05806000
*         DO;                                                      0891 05807000
*                                                                  0891 05808000
*           /*********************************************************/ 05809000
*           /*                                                       */ 05810000
*           /* CLOSE THE STAGING PACK                                */ 05811000
*           /*                                                       */ 05812000
*           /*********************************************************/ 05813000
*                                                                  0892 05814000
*           CALL IDCIO050(GDTTBL,CLOSE,REPIDSOP);                  0892 05815000
*                                                                  0892 05816000
         L     @15,@PC00001                                        0892 05817000
         ST    @15,@AL00001                                        0892 05818000
         LA    @14,CLOSE                                           0892 05819000
         ST    @14,@AL00001+4                                      0892 05820000
         L     @14,@PC00001+8                                      0892 05821000
         LA    @14,REPIDSOP(,@14)                                  0892 05822000
         ST    @14,@AL00001+8                                      0892 05823000
         MVI   @AL00001+8,X'80'                                    0892 05824000
         L     @15,GDTEXP(,@15)                                    0892 05825000
         LA    @01,@AL00001                                        0892 05826000
         BALR  @14,@15                                             0892 05827000
*           /*********************************************************/ 05828000
*           /*                                                       */ 05829000
*           /* DEQ THE STAGING PACK                                  */ 05830000
*           /*                                                       */ 05831000
*           /*********************************************************/ 05832000
*                                                                  0893 05833000
*           CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);                 0893 05834000
*                                                                  0893 05835000
         L     @15,@PC00001                                        0893 05836000
         ST    @15,@AL00001                                        0893 05837000
         L     @14,@PC00001+8                                      0893 05838000
         L     @14,REPQRPTR(,@14)                                  0893 05839000
         ST    @14,@AL00001+4                                      0893 05840000
         LA    @14,SPRNAME(,@14)                                   0893 05841000
         ST    @14,@AL00001+8                                      0893 05842000
         MVI   @AL00001+8,X'80'                                    0893 05843000
         L     @15,GDTDEQ(,@15)                                    0893 05844000
         LA    @01,@AL00001                                        0893 05845000
         BALR  @14,@15                                             0893 05846000
*           /*********************************************************/ 05847000
*           /*                                                       */ 05848000
*           /* WRITE UNIVERSAL TEXT MESSAGE IDC3004I                 */ 05849000
*           /*                                                       */ 05850000
*           /*********************************************************/ 05851000
*                                                                  0894 05852000
*           DO;                                                    0894 05853000
*             CKREQ=CKREQ&&CKREQ;                                  0895 05854000
         L     @15,@PC00001+8                                      0895 05855000
         XC    CKREQ(44,@15),CKREQ(@15)                            0895 05856000
*             CKRERN=MSG93;                                        0896 05857000
         MVC   CKRERN(2,@15),@CH00866                              0896 05858000
*             CALL IDCRDER;                                        0897 05859000
         L     @15,@CV01553                                        0897 05860000
         BALR  @14,@15                                             0897 05861000
*           END;                                                   0898 05862000
*                                                                  0898 05863000
*           /*********************************************************/ 05864000
*           /*                                                       */ 05865000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 05866000
*           /*                                                       */ 05867000
*           /*********************************************************/ 05868000
*                                                                  0899 05869000
*           RETURN CODE(LASTCC12);                                 0899 05870000
         LA    @15,12                                              0899 05871000
         L     @14,@SA00002                                        0899 05872000
         LM    @00,@12,@SA00002+8                                  0899 05873000
         BR    @14                                                 0899 05874000
*         END;                                                     0900 05875000
*                                                                  0900 05876000
*       /*************************************************************/ 05877000
*       /*                                                           */ 05878000
*       /* CONSTRUCT THE FIRST AND ONLY EXTENT TABLE ENTRY           */ 05879000
*       /*                                                           */ 05880000
*       /*************************************************************/ 05881000
*                                                                  0901 05882000
*       I=1;                                                       0901 05883000
@RF00890 L     @04,@PC00001+8                                      0901 05884000
         LA    @15,1                                               0901 05885000
         STC   @15,I(,@04)                                         0901 05886000
*       XTNTDDN(I)=XTNHDDN;                                        0902 05887000
         LA    @14,78                                              0902 05888000
         LR    @01,@15                                             0902 05889000
         MR    @00,@14                                             0902 05890000
         ST    @01,@TF00001                                        0902 05891000
         ALR   @01,XTNTPTR                                         0902 05892000
         MVC   XTNTDDN-78(8,@01),XTNHDDN(XTNTPTR)                  0902 05893000
*       XTNTDSN(I)=XTNHDSN;                                        0903 05894000
         LR    @01,XTNTPTR                                         0903 05895000
         AL    @01,@TF00001                                        0903 05896000
         MVC   XTNTDSN-78(44,@01),XTNHDSN(XTNTPTR)                 0903 05897000
*       XTNTCHR1(I)=XTNHCHR1;                                      0904 05898000
         LR    @01,XTNTPTR                                         0904 05899000
         AL    @01,@TF00001                                        0904 05900000
         MVC   XTNTCHR1-78(5,@01),XTNHCHR1(XTNTPTR)                0904 05901000
*       XTNTCHR2(I)=XTNHCHR2;                                      0905 05902000
         LR    @01,XTNTPTR                                         0905 05903000
         AL    @01,@TF00001                                        0905 05904000
         MVC   XTNTCHR2-78(5,@01),XTNHCHR2(XTNTPTR)                0905 05905000
*       XTNTVOLN(I)=XTNHVOLN;                                      0906 05906000
         LR    @01,XTNTPTR                                         0906 05907000
         AL    @01,@TF00001                                        0906 05908000
         MVC   XTNTVOLN-78(1,@01),XTNHVOLN(XTNTPTR)                0906 05909000
*       XTNTVOL(I)=XTNHVOL;                                        0907 05910000
*                                                                  0907 05911000
         LR    @01,XTNTPTR                                         0907 05912000
         AL    @01,@TF00001                                        0907 05913000
         MVC   XTNTVOL-78(6,@01),XTNHVOL(XTNTPTR)                  0907 05914000
*       /*************************************************************/ 05915000
*       /*                                                           */ 05916000
*       /* SET THE NEXT EXTENT TABLE ENTRY TO X'FF' TO INDICATE THE  */ 05917000
*       /* LAST ENTRY.                                               */ 05918000
*       /*                                                           */ 05919000
*       /*************************************************************/ 05920000
*                                                                  0908 05921000
*       I=I+1;                                                     0908 05922000
         AL    @15,@CF00221                                        0908 05923000
         STC   @15,I(,@04)                                         0908 05924000
*       XTNTENT(I)=LASTENT;                                        0909 05925000
*                                                                  0909 05926000
         MR    @14,@14                                             0909 05927000
         ALR   @15,XTNTPTR                                         0909 05928000
         MVC   XTNTENT-78(78,@15),LASTENT                          0909 05929000
*       /*************************************************************/ 05930000
*       /*                                                           */ 05931000
*       /* SET FIRST BYTE OF BUFFER AREA TO X'FF' TO INDICATE TO     */ 05932000
*       /* UEXCP THE AREA HAS NOT BEEN USED BEFORE                   */ 05933000
*       /*                                                           */ 05934000
*       /*************************************************************/ 05935000
*                                                                  0910 05936000
*       RESPECIFY                                                  0910 05937000
*         RIOAREA BASED(REPIBFPT);                                 0910 05938000
*       RFIRST='FF'X;                                              0911 05939000
*                                                                  0911 05940000
         L     @01,REPIBFPT(,@04)                                  0911 05941000
         MVI   RFIRST(@01),X'FF'                                   0911 05942000
*       /*************************************************************/ 05943000
*       /*                                                           */ 05944000
*       /* RETURN TO THE CALLER WITH RC = 00                         */ 05945000
*       /*                                                           */ 05946000
*       /*************************************************************/ 05947000
*                                                                  0912 05948000
*       RETURN CODE(LASTCC00);                                     0912 05949000
         SLR   @15,@15                                             0912 05950000
         L     @14,@SA00002                                        0912 05951000
         LM    @00,@12,@SA00002+8                                  0912 05952000
         BR    @14                                                 0912 05953000
*     END DSSTGPK;                                                 0913 05954000
*                                                                  0914 05955000
*   /*****************************************************************/ 05956000
*   /*                                                               */ 05957000
*   /* PROCESSING A DATA SET                                         */ 05958000
*   /*                                                               */ 05959000
*   /*****************************************************************/ 05960000
*                                                                  0914 05961000
*   IF ADDR(DSRNG)^=NULLPTR|ADDR(CDSRG)^=NULLPTR|ADDR(MIDSA)^=NULLPTR|  05962000
*       ADDR(MODSA)^=NULLPTR THEN                                  0914 05963000
@RF00655 SLR   @04,@04                                             0914 05964000
         L     @15,@PC00001+4                                      0914 05965000
         C     @04,FDTPTR+24(,@15)                                 0914 05966000
         BNE   @RT00914                                            0914 05967000
         C     @04,FDTPTR+152(,@15)                                0914 05968000
         BNE   @RT00914                                            0914 05969000
         C     @04,FDTPTR+384(,@15)                                0914 05970000
         BNE   @RT00914                                            0914 05971000
         C     @04,FDTPTR+408(,@15)                                0914 05972000
         BE    @RF00914                                            0914 05973000
@RT00914 DS    0H                                                  0915 05974000
*     DO;                                                          0915 05975000
*                                                                  0915 05976000
*       /*************************************************************/ 05977000
*       /*                                                           */ 05978000
*       /* GET DDNAME, ADDRESS OF UIOINFO RETURN AREA, AND ADDRESS OF*/ 05979000
*       /* EXTENT TABLE BUILD AREA INTO A COMMON FIELD AND POINTERS  */ 05980000
*       /* FOR EACH TYPE OF REQUEST                                  */ 05981000
*       /*                                                           */ 05982000
*       /*************************************************************/ 05983000
*                                                                  0916 05984000
*       IF ADDR(DISPL)^=NULLPTR THEN                               0916 05985000
         SLR   @15,@15                                             0916 05986000
         L     @14,@PC00001+4                                      0916 05987000
         C     @15,FDTPTR(,@14)                                    0916 05988000
         BE    @RF00916                                            0916 05989000
*         DO;                                                      0917 05990000
*           IF ADDR(INFIL)^=NULLPTR THEN                           0918 05991000
         L     @14,FDTPTR+12(,@14)                                 0918 05992000
         CR    @14,@15                                             0918 05993000
         BE    @RF00918                                            0918 05994000
*             INFODD=INFILVAL;                                     0919 05995000
         MVC   INFODD(8),INFILVAL(@14)                             0919 05996000
*           INFOPTR=REPIINFO;                                      0920 05997000
@RF00918 L     @04,@PC00001+8                                      0920 05998000
         L     @15,REPIINFO(,@04)                                  0920 05999000
         ST    @15,INFOPTR                                         0920 06000000
*           XTNTPTR=REPIXTNT;                                      0921 06001000
         L     XTNTPTR,REPIXTNT(,@04)                              0921 06002000
*         END;                                                     0922 06003000
*       ELSE                                                       0923 06004000
*         IF ADDR(COPY)^=NULLPTR THEN                              0923 06005000
         B     @RC00916                                            0923 06006000
@RF00916 SLR   @15,@15                                             0923 06007000
         L     @14,@PC00001+4                                      0923 06008000
         C     @15,FDTPTR+136(,@14)                                0923 06009000
         BE    @RF00923                                            0923 06010000
*           DO;                                                    0924 06011000
*             IF ADDR(CINFL)^=NULLPTR THEN                         0925 06012000
         L     @14,FDTPTR+140(,@14)                                0925 06013000
         CR    @14,@15                                             0925 06014000
         BE    @RF00925                                            0925 06015000
*               INFODD=CINFLVAL;                                   0926 06016000
         MVC   INFODD(8),CINFLVAL(@14)                             0926 06017000
*             INFOPTR=REPIINFO;                                    0927 06018000
@RF00925 L     @04,@PC00001+8                                      0927 06019000
         L     @15,REPIINFO(,@04)                                  0927 06020000
         ST    @15,INFOPTR                                         0927 06021000
*             XTNTPTR=REPIXTNT;                                    0928 06022000
         L     XTNTPTR,REPIXTNT(,@04)                              0928 06023000
*           END;                                                   0929 06024000
*         ELSE                                                     0930 06025000
*           IF ADDR(MODIF)^=NULLPTR&IOPARM=INPUT THEN              0930 06026000
         B     @RC00923                                            0930 06027000
@RF00923 SLR   @15,@15                                             0930 06028000
         L     @14,@PC00001+4                                      0930 06029000
         C     @15,FDTPTR+356(,@14)                                0930 06030000
         BE    @RF00930                                            0930 06031000
         L     @05,@PC00002                                        0930 06032000
         CLI   IOPARM(@05),C'I'                                    0930 06033000
         BNE   @RF00930                                            0930 06034000
*             DO;                                                  0931 06035000
*               IF ADDR(MINFL)^=NULLPTR THEN                       0932 06036000
         L     @14,FDTPTR+372(,@14)                                0932 06037000
         CR    @14,@15                                             0932 06038000
         BE    @RF00932                                            0932 06039000
*                 INFODD=MINFLVAL;                                 0933 06040000
         MVC   INFODD(8),MINFLVAL(@14)                             0933 06041000
*               INFOPTR=REPIINFO;                                  0934 06042000
@RF00932 L     @04,@PC00001+8                                      0934 06043000
         L     @15,REPIINFO(,@04)                                  0934 06044000
         ST    @15,INFOPTR                                         0934 06045000
*               XTNTPTR=REPIXTNT;                                  0935 06046000
         L     XTNTPTR,REPIXTNT(,@04)                              0935 06047000
*             END;                                                 0936 06048000
*           ELSE                                                   0937 06049000
*             DO;                                                  0937 06050000
         B     @RC00930                                            0937 06051000
@RF00930 DS    0H                                                  0938 06052000
*               IF ADDR(MOUTF)^=NULLPTR THEN                       0938 06053000
         L     @15,@PC00001+4                                      0938 06054000
         L     @15,FDTPTR+412(,@15)                                0938 06055000
         LTR   @15,@15                                             0938 06056000
         BZ    @RF00938                                            0938 06057000
*                 INFODD=MOUTFVAL;                                 0939 06058000
         MVC   INFODD(8),MOUTFVAL(@15)                             0939 06059000
*               INFOPTR=REPOINFO;                                  0940 06060000
@RF00938 L     @04,@PC00001+8                                      0940 06061000
         L     @15,REPOINFO(,@04)                                  0940 06062000
         ST    @15,INFOPTR                                         0940 06063000
*               XTNTPTR=REPOXTNT;                                  0941 06064000
         L     XTNTPTR,REPOXTNT(,@04)                              0941 06065000
*             END;                                                 0942 06066000
*     END;                                                         0943 06067000
*                                                                  0943 06068000
@RC00930 DS    0H                                                  0943 06069000
@RC00923 DS    0H                                                  0943 06070000
@RC00916 DS    0H                                                  0944 06071000
*   /*****************************************************************/ 06072000
*   /*                                                               */ 06073000
*   /* FOR DISPLAY, VALIDATE THE CCHHR AND CCHHR LENGTHS AND BUILD   */ 06074000
*   /* THE EXTENT TABLE HEADER                                       */ 06075000
*   /*                                                               */ 06076000
*   /*****************************************************************/ 06077000
*                                                                  0944 06078000
*   IF ADDR(DISPL)^=NULLPTR THEN                                   0944 06079000
@RF00914 L     @04,@PC00001+4                                      0944 06080000
         L     @04,FDTPTR(,@04)                                    0944 06081000
         LTR   @04,@04                                             0944 06082000
         BZ    @RF00944                                            0944 06083000
*DSETDISP:                                                         0945 06084000
*     DO;                                                          0945 06085000
*                                                                  0945 06086000
DSETDISP DS    0H                                                  0946 06087000
*       /*************************************************************/ 06088000
*       /*                                                           */ 06089000
*       /* THE LENGTH OF THE DATASETRANGE PARAMETER (FROM CCHHR) MUST*/ 06090000
*       /* BE 5 BYTES. IF NOT, PREPARE TO RETURN TO THE CALLER WITH  */ 06091000
*       /* RC = 12                                                   */ 06092000
*       /*                                                           */ 06093000
*       /*************************************************************/ 06094000
*                                                                  0946 06095000
*       IF DSCHRLEN^=LENGTH(DSCHRVAL) THEN                         0946 06096000
         L     @04,@PC00001+4                                      0946 06097000
         L     @01,FDTPTR+84(,@04)                                 0946 06098000
         CLI   DSCHRLEN(@01),5                                     0946 06099000
         BE    @RF00946                                            0946 06100000
*         DO;                                                      0947 06101000
*                                                                  0947 06102000
*           /*********************************************************/ 06103000
*           /*                                                       */ 06104000
*           /* IF DATA SET NAME SPECIFIED (OS/VS2 ONLY), GET DSNAME  */ 06105000
*           /* FROM FDT                                              */ 06106000
*           /*                                                       */ 06107000
*           /*********************************************************/ 06108000
*                                                                  0948 06109000
*           IF ADDR(INDS)^=NULLPTR THEN                            0948 06110000
         L     @04,FDTPTR+16(,@04)                                 0948 06111000
         LTR   @04,@04                                             0948 06112000
         BZ    @RF00948                                            0948 06113000
*             XTNHDSN=INDSVAL;                                     0949 06114000
*                                                                  0949 06115000
         MVC   XTNHDSN(44,XTNTPTR),INDSVAL(@04)                    0949 06116000
*           /*********************************************************/ 06117000
*           /*                                                       */ 06118000
*           /* CALL IDCRDIN TO ISSUE UIOINFO TO OBTAIN THE DATA SET  */ 06119000
*           /* NAME AND MOVE IT INTO FIELD XTNHDSN IN XTNTTBL. IF    */ 06120000
*           /* UIOINFO FAILS OR IF THE DATA SET NAME CANNOT BE       */ 06121000
*           /* LOCATED, XTNHDSN WILL BE SET TO BLANKS.               */ 06122000
*           /*                                                       */ 06123000
*           /*********************************************************/ 06124000
*                                                                  0950 06125000
*           ELSE                                                   0950 06126000
*             CALL IDCRDIN;                                        0950 06127000
*                                                                  0950 06128000
         B     @RC00948                                            0950 06129000
@RF00948 BAL   @14,IDCRDIN                                         0950 06130000
*           /*********************************************************/ 06131000
*           /*                                                       */ 06132000
*           /* WRITE ERROR MESSAGE IDC31233I                         */ 06133000
*           /*                                                       */ 06134000
*           /*********************************************************/ 06135000
*                                                                  0951 06136000
*           DO;                                                    0951 06137000
@RC00948 DS    0H                                                  0952 06138000
*             CKREQ=CKREQ&&CKREQ;                                  0952 06139000
         L     @04,@PC00001+8                                      0952 06140000
         XC    CKREQ(44,@04),CKREQ(@04)                            0952 06141000
*             CKRERN=MSG33;                                        0953 06142000
         MVC   CKRERN(2,@04),@CH02800                              0953 06143000
*             CKRMVAR(1)=ADDR(DSRANGE);                            0954 06144000
         LA    @15,@CC02833                                        0954 06145000
         ST    @15,CKRMVAR(,@04)                                   0954 06146000
*             CKRMVAR(2)=ADDR(DSCHRVAL);                           0955 06147000
         L     @15,@PC00001+4                                      0955 06148000
         L     @15,FDTPTR+84(,@15)                                 0955 06149000
         LA    @14,DSCHRVAL(,@15)                                  0955 06150000
         ST    @14,CKRMVAR+4(,@04)                                 0955 06151000
*             CKRMVAR(3)=ADDR(XTNHDSN);                            0956 06152000
         LA    @14,XTNHDSN(,XTNTPTR)                               0956 06153000
         ST    @14,CKRMVAR+8(,@04)                                 0956 06154000
*             CKRMVAR(4)=ADDR(DSCHRLEN);                           0957 06155000
         ST    @15,CKRMVAR+12(,@04)                                0957 06156000
*             CALL IDCRDER;                                        0958 06157000
         L     @15,@CV01553                                        0958 06158000
         BALR  @14,@15                                             0958 06159000
*           END;                                                   0959 06160000
*                                                                  0959 06161000
*           /*********************************************************/ 06162000
*           /*                                                       */ 06163000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 06164000
*           /*                                                       */ 06165000
*           /*********************************************************/ 06166000
*                                                                  0960 06167000
*           RETURN CODE(LASTCC12);                                 0960 06168000
         LA    @15,12                                              0960 06169000
         L     @14,@SA00002                                        0960 06170000
         LM    @00,@12,@SA00002+8                                  0960 06171000
         BR    @14                                                 0960 06172000
*         END;                                                     0961 06173000
*                                                                  0961 06174000
*       /*************************************************************/ 06175000
*       /*                                                           */ 06176000
*       /* THE LENGTH OF THE DATASETRANGE PARAMETER (TO CCHHR) MUST  */ 06177000
*       /* BE 0 OR 5 BYTES, IF NOT, PREPARE TO RETURN TO THE CALLER  */ 06178000
*       /* WITH RC = 12                                              */ 06179000
*       /*                                                           */ 06180000
*       /*************************************************************/ 06181000
*                                                                  0962 06182000
*       IF ADDR(DSCHH)^=NULLPTR&DSCHHLEN^=LENGTH(DSCHHVAL) THEN    0962 06183000
@RF00946 SLR   @04,@04                                             0962 06184000
         L     @15,@PC00001+4                                      0962 06185000
         L     @14,FDTPTR+88(,@15)                                 0962 06186000
         CR    @14,@04                                             0962 06187000
         BE    @RF00962                                            0962 06188000
         CLI   DSCHHLEN(@14),5                                     0962 06189000
         BE    @RF00962                                            0962 06190000
*         DO;                                                      0963 06191000
*                                                                  0963 06192000
*           /*********************************************************/ 06193000
*           /*                                                       */ 06194000
*           /* IF DATA SET NAME SPECIFIED (OS/VS2 ONLY), GET DSNAME  */ 06195000
*           /* FROM FDT                                              */ 06196000
*           /*                                                       */ 06197000
*           /*********************************************************/ 06198000
*                                                                  0964 06199000
*           IF ADDR(INDS)^=NULLPTR THEN                            0964 06200000
         L     @15,FDTPTR+16(,@15)                                 0964 06201000
         CR    @15,@04                                             0964 06202000
         BE    @RF00964                                            0964 06203000
*             XTNHDSN=INDSVAL;                                     0965 06204000
*                                                                  0965 06205000
         MVC   XTNHDSN(44,XTNTPTR),INDSVAL(@15)                    0965 06206000
*           /*********************************************************/ 06207000
*           /*                                                       */ 06208000
*           /* CALL IDCRDIN TO ISSUE UIOINFO TO OBTAIN THE DATA SET  */ 06209000
*           /* NAME AND MOVE IT INTO FIELD XTNHDSN IN XTNTTBL. IF    */ 06210000
*           /* UIOINFO FAILS OR IF THE DATA SET NAME CANNOT BE       */ 06211000
*           /* LOCATED, XTNHDSN WILL BE SET TO BLANKS.               */ 06212000
*           /*                                                       */ 06213000
*           /*********************************************************/ 06214000
*                                                                  0966 06215000
*           ELSE                                                   0966 06216000
*             CALL IDCRDIN;                                        0966 06217000
*                                                                  0966 06218000
         B     @RC00964                                            0966 06219000
@RF00964 BAL   @14,IDCRDIN                                         0966 06220000
*           /*********************************************************/ 06221000
*           /*                                                       */ 06222000
*           /* WRITE ERROR MESSAGE IDC3233I                          */ 06223000
*           /*                                                       */ 06224000
*           /*********************************************************/ 06225000
*                                                                  0967 06226000
*           DO;                                                    0967 06227000
@RC00964 DS    0H                                                  0968 06228000
*             CKREQ=CKREQ&&CKREQ;                                  0968 06229000
         L     @04,@PC00001+8                                      0968 06230000
         XC    CKREQ(44,@04),CKREQ(@04)                            0968 06231000
*             CKRERN=MSG33;                                        0969 06232000
         MVC   CKRERN(2,@04),@CH02800                              0969 06233000
*             CKRMVAR(1)=ADDR(DSRANGE);                            0970 06234000
         LA    @15,@CC02833                                        0970 06235000
         ST    @15,CKRMVAR(,@04)                                   0970 06236000
*             CKRMVAR(2)=ADDR(DSCHHVAL);                           0971 06237000
         L     @15,@PC00001+4                                      0971 06238000
         L     @15,FDTPTR+88(,@15)                                 0971 06239000
         LA    @14,DSCHHVAL(,@15)                                  0971 06240000
         ST    @14,CKRMVAR+4(,@04)                                 0971 06241000
*             CKRMVAR(3)=ADDR(XTNHDSN);                            0972 06242000
         LA    @14,XTNHDSN(,XTNTPTR)                               0972 06243000
         ST    @14,CKRMVAR+8(,@04)                                 0972 06244000
*             CKRMVAR(4)=ADDR(DSCHHLEN);                           0973 06245000
         ST    @15,CKRMVAR+12(,@04)                                0973 06246000
*             CALL IDCRDER;                                        0974 06247000
         L     @15,@CV01553                                        0974 06248000
         BALR  @14,@15                                             0974 06249000
*           END;                                                   0975 06250000
*                                                                  0975 06251000
*           /*********************************************************/ 06252000
*           /*                                                       */ 06253000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 06254000
*           /*                                                       */ 06255000
*           /*********************************************************/ 06256000
*                                                                  0976 06257000
*           RETURN CODE(LASTCC12);                                 0976 06258000
         LA    @15,12                                              0976 06259000
         L     @14,@SA00002                                        0976 06260000
         LM    @00,@12,@SA00002+8                                  0976 06261000
         BR    @14                                                 0976 06262000
*         END;                                                     0977 06263000
*                                                                  0977 06264000
*       /*************************************************************/ 06265000
*       /*                                                           */ 06266000
*       /* THE DATASETRANGE PARAMETER IS VALIDATED, CONSTRUCT THE    */ 06267000
*       /* EXTENT TABLE HEADER SETUP USER SUPPLIED RANGE IN XTNTTBL  */ 06268000
*       /* HEADER                                                    */ 06269000
*       /*                                                           */ 06270000
*       /*************************************************************/ 06271000
*                                                                  0978 06272000
*       IF ADDR(DSCHH)=NULLPTR THEN                                0978 06273000
@RF00962 L     @04,@PC00001+4                                      0978 06274000
         L     @15,FDTPTR+88(,@04)                                 0978 06275000
         LTR   @15,@15                                             0978 06276000
         BNZ   @RF00978                                            0978 06277000
*         XTNHCHR2=DSCHRVAL;                                       0979 06278000
         L     @04,FDTPTR+84(,@04)                                 0979 06279000
         MVC   XTNHCHR2(5,XTNTPTR),DSCHRVAL(@04)                   0979 06280000
*       ELSE                                                       0980 06281000
*         XTNHCHR2=DSCHHVAL;                                       0980 06282000
         B     @RC00978                                            0980 06283000
@RF00978 L     @04,@PC00001+4                                      0980 06284000
         L     @04,FDTPTR+88(,@04)                                 0980 06285000
         MVC   XTNHCHR2(5,XTNTPTR),DSCHHVAL(@04)                   0980 06286000
*       XTNHCHR1=DSCHRVAL;                                         0981 06287000
*                                                                  0981 06288000
@RC00978 L     @04,@PC00001+4                                      0981 06289000
         L     @01,FDTPTR+84(,@04)                                 0981 06290000
         MVC   XTNHCHR1(5,XTNTPTR),DSCHRVAL(@01)                   0981 06291000
*       /*************************************************************/ 06292000
*       /*                                                           */ 06293000
*       /* SETUP USER SUPPLIED DSNAME OR DDNAME AND PASSWORD IN      */ 06294000
*       /* XTNTTBL HEADER                                            */ 06295000
*       /*                                                           */ 06296000
*       /*************************************************************/ 06297000
*                                                                  0982 06298000
*       IF ADDR(INDS)^=NULLPTR THEN                                0982 06299000
         L     @04,FDTPTR+16(,@04)                                 0982 06300000
         LTR   @04,@04                                             0982 06301000
         BZ    @RF00982                                            0982 06302000
*         DO;                                                      0983 06303000
*           XTNHDSN=INDSVAL;                                       0984 06304000
         MVC   XTNHDSN(44,XTNTPTR),INDSVAL(@04)                    0984 06305000
*           XTNHDDN=BLANKS;                                        0985 06306000
         MVC   XTNHDDN(8,XTNTPTR),BLANKS                           0985 06307000
*           XTNHPWD=INDSPAS;                                       0986 06308000
         MVC   XTNHPWD(8,XTNTPTR),INDSPAS(@04)                     0986 06309000
*         END;                                                     0987 06310000
*       ELSE                                                       0988 06311000
*         DO;                                                      0988 06312000
         B     @RC00982                                            0988 06313000
@RF00982 DS    0H                                                  0989 06314000
*           XTNHDSN=BLANKS;                                        0989 06315000
         MVC   XTNHDSN(44,XTNTPTR),BLANKS                          0989 06316000
*           XTNHDDN=INFILVAL;                                      0990 06317000
         L     @04,@PC00001+4                                      0990 06318000
         L     @04,FDTPTR+12(,@04)                                 0990 06319000
         MVC   XTNHDDN(8,XTNTPTR),INFILVAL(@04)                    0990 06320000
*           XTNHPWD=INFILPAS;                                      0991 06321000
         MVC   XTNHPWD(8,XTNTPTR),INFILPAS(@04)                    0991 06322000
*         END;                                                     0992 06323000
*                                                                  0992 06324000
*       /*************************************************************/ 06325000
*       /*                                                           */ 06326000
*       /* SETUP USER SUPPLIED VOLSER IN XTNTTBL HEADER AND SET      */ 06327000
*       /* VOLUME NUMBER EQUAL TO 1 AND SET MODE EQUAL TO INPUT IN   */ 06328000
*       /* XTNTTBL HEADER                                            */ 06329000
*       /*                                                           */ 06330000
*       /*************************************************************/ 06331000
*                                                                  0993 06332000
*       XTNHVOLN=1;                                                0993 06333000
@RC00982 MVI   XTNHVOLN(XTNTPTR),X'01'                             0993 06334000
*       XTNHVOL=VOLDSVAL;                                          0994 06335000
         L     @04,@PC00001+4                                      0994 06336000
         L     @04,FDTPTR+80(,@04)                                 0994 06337000
         MVC   XTNHVOL(6,XTNTPTR),VOLDSVAL(@04)                    0994 06338000
*       XTNHMODE=INPUT;                                            0995 06339000
         MVI   XTNHMODE(XTNTPTR),C'I'                              0995 06340000
*     END DSETDISP;                                                0996 06341000
*                                                                  0997 06342000
*   /*****************************************************************/ 06343000
*   /*                                                               */ 06344000
*   /* FOR COPY, VALIDATE THE CCHHR AND HHR LENGTHS AND BUILD THE    */ 06345000
*   /* EXTENT TABLE HEADER                                           */ 06346000
*   /*                                                               */ 06347000
*   /*****************************************************************/ 06348000
*                                                                  0997 06349000
*   IF ADDR(COPY)^=NULLPTR THEN                                    0997 06350000
@RF00944 L     @04,@PC00001+4                                      0997 06351000
         L     @04,FDTPTR+136(,@04)                                0997 06352000
         LTR   @04,@04                                             0997 06353000
         BZ    @RF00997                                            0997 06354000
*DSETCOPY:                                                         0998 06355000
*     DO;                                                          0998 06356000
*                                                                  0998 06357000
DSETCOPY DS    0H                                                  0999 06358000
*       /*************************************************************/ 06359000
*       /*                                                           */ 06360000
*       /* THE LENGTH OF THE DATASETRANGE PARAMETER (FROM CCHHR),    */ 06361000
*       /* MUST BE 5 BYTES. IF NOT, PREPARE TO RETURN TO THE CALLER  */ 06362000
*       /* WITH RC = 12                                              */ 06363000
*       /*                                                           */ 06364000
*       /*************************************************************/ 06365000
*                                                                  0999 06366000
*       IF CDCHRLEN^=LENGTH(CDCHRVAL) THEN                         0999 06367000
         L     @04,@PC00001+4                                      0999 06368000
         L     @01,FDTPTR+172(,@04)                                0999 06369000
         CLI   CDCHRLEN(@01),5                                     0999 06370000
         BE    @RF00999                                            0999 06371000
*         DO;                                                      1000 06372000
*                                                                  1000 06373000
*           /*********************************************************/ 06374000
*           /*                                                       */ 06375000
*           /* IF DATA SET NAME SPECIFIED (OS/VS2 ONLY), GET DSNAME  */ 06376000
*           /* FROM FDT                                              */ 06377000
*           /*                                                       */ 06378000
*           /*********************************************************/ 06379000
*                                                                  1001 06380000
*           IF ADDR(CINDS)^=NULLPTR THEN                           1001 06381000
         L     @04,FDTPTR+144(,@04)                                1001 06382000
         LTR   @04,@04                                             1001 06383000
         BZ    @RF01001                                            1001 06384000
*             XTNHDSN=CINDSVAL;                                    1002 06385000
*                                                                  1002 06386000
         MVC   XTNHDSN(44,XTNTPTR),CINDSVAL(@04)                   1002 06387000
*           /*********************************************************/ 06388000
*           /*                                                       */ 06389000
*           /* CALL IDCRDIN TO ISSUE UIOINFO TO OBTAIN THE DATA SET  */ 06390000
*           /* NAME AND MOVE IT INTO FIELD XTNHDSN IN XTNTTBL. IF    */ 06391000
*           /* UIOINFO FAILS OR IF THE DATA SET NAME CANNOT BE       */ 06392000
*           /* LOCATED, XTNHDSN WILL BE SET TO BLANKS.               */ 06393000
*           /*                                                       */ 06394000
*           /*********************************************************/ 06395000
*                                                                  1003 06396000
*           ELSE                                                   1003 06397000
*             CALL IDCRDIN;                                        1003 06398000
*                                                                  1003 06399000
         B     @RC01001                                            1003 06400000
@RF01001 BAL   @14,IDCRDIN                                         1003 06401000
*           /*********************************************************/ 06402000
*           /*                                                       */ 06403000
*           /* WRITE ERROR MESSAGE IDC3233I                          */ 06404000
*           /*                                                       */ 06405000
*           /*********************************************************/ 06406000
*                                                                  1004 06407000
*           DO;                                                    1004 06408000
@RC01001 DS    0H                                                  1005 06409000
*             CKREQ=CKREQ&&CKREQ;                                  1005 06410000
         L     @04,@PC00001+8                                      1005 06411000
         XC    CKREQ(44,@04),CKREQ(@04)                            1005 06412000
*             CKRERN=MSG33;                                        1006 06413000
         MVC   CKRERN(2,@04),@CH02800                              1006 06414000
*             CKRMVAR(1)=ADDR(DSRANGE);                            1007 06415000
         LA    @15,@CC02833                                        1007 06416000
         ST    @15,CKRMVAR(,@04)                                   1007 06417000
*             CKRMVAR(2)=ADDR(CDCHRVAL);                           1008 06418000
         L     @15,@PC00001+4                                      1008 06419000
         L     @15,FDTPTR+172(,@15)                                1008 06420000
         LA    @14,CDCHRVAL(,@15)                                  1008 06421000
         ST    @14,CKRMVAR+4(,@04)                                 1008 06422000
*             CKRMVAR(3)=ADDR(XTNHDSN);                            1009 06423000
         LA    @14,XTNHDSN(,XTNTPTR)                               1009 06424000
         ST    @14,CKRMVAR+8(,@04)                                 1009 06425000
*             CKRMVAR(4)=ADDR(CDCHRLEN);                           1010 06426000
         ST    @15,CKRMVAR+12(,@04)                                1010 06427000
*             CALL IDCRDER;                                        1011 06428000
         L     @15,@CV01553                                        1011 06429000
         BALR  @14,@15                                             1011 06430000
*           END;                                                   1012 06431000
*                                                                  1012 06432000
*           /*********************************************************/ 06433000
*           /*                                                       */ 06434000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 06435000
*           /*                                                       */ 06436000
*           /*********************************************************/ 06437000
*                                                                  1013 06438000
*           RETURN CODE(LASTCC12);                                 1013 06439000
         LA    @15,12                                              1013 06440000
         L     @14,@SA00002                                        1013 06441000
         LM    @00,@12,@SA00002+8                                  1013 06442000
         BR    @14                                                 1013 06443000
*         END;                                                     1014 06444000
*                                                                  1014 06445000
*       /*************************************************************/ 06446000
*       /*                                                           */ 06447000
*       /* THE LENGTH OF THE DATASETRANGE PARAMETER (TO HHR) MUST BE */ 06448000
*       /* EQUAL TO 0 OR 3 BYTES. IF NOT, PREPARE TO RETURN TO THE   */ 06449000
*       /* CALLER WITH RC = 12                                       */ 06450000
*       /*                                                           */ 06451000
*       /*************************************************************/ 06452000
*                                                                  1015 06453000
*       IF ADDR(CDHHR)^=NULLPTR&CDHHRLEN^=LENGTH(CDHHRVAL) THEN    1015 06454000
@RF00999 SLR   @04,@04                                             1015 06455000
         L     @15,@PC00001+4                                      1015 06456000
         L     @14,FDTPTR+176(,@15)                                1015 06457000
         CR    @14,@04                                             1015 06458000
         BE    @RF01015                                            1015 06459000
         CLI   CDHHRLEN(@14),3                                     1015 06460000
         BE    @RF01015                                            1015 06461000
*         DO;                                                      1016 06462000
*                                                                  1016 06463000
*           /*********************************************************/ 06464000
*           /*                                                       */ 06465000
*           /* IF DATA SET NAME IS SPECIFIED (OS/VS2 ONLY), GET      */ 06466000
*           /* DSNAME FROM THE FDT                                   */ 06467000
*           /*                                                       */ 06468000
*           /*********************************************************/ 06469000
*                                                                  1017 06470000
*           IF ADDR(CINDS)^=NULLPTR THEN                           1017 06471000
         L     @15,FDTPTR+144(,@15)                                1017 06472000
         CR    @15,@04                                             1017 06473000
         BE    @RF01017                                            1017 06474000
*             XTNHDSN=CINDSVAL;                                    1018 06475000
*                                                                  1018 06476000
         MVC   XTNHDSN(44,XTNTPTR),CINDSVAL(@15)                   1018 06477000
*           /*********************************************************/ 06478000
*           /*                                                       */ 06479000
*           /* CALL IDCRDIN TO ISSUE UIOINFO TO OBTAIN THE DATA SET  */ 06480000
*           /* NAME AND MOVE IT INTO FIELD XTNHDSN IN XTNTTBL. IF    */ 06481000
*           /* UIOINFO FAILS OR IF THE DATA SET NAME CANNOT BE       */ 06482000
*           /* LOCATED, XTNHDSN WILL BE SET TO BLANKS                */ 06483000
*           /*                                                       */ 06484000
*           /*********************************************************/ 06485000
*                                                                  1019 06486000
*           ELSE                                                   1019 06487000
*             CALL IDCRDIN;                                        1019 06488000
*                                                                  1019 06489000
         B     @RC01017                                            1019 06490000
@RF01017 BAL   @14,IDCRDIN                                         1019 06491000
*           /*********************************************************/ 06492000
*           /*                                                       */ 06493000
*           /* WRITE ERROR MESSAGE IDC3233I                          */ 06494000
*           /*                                                       */ 06495000
*           /*********************************************************/ 06496000
*                                                                  1020 06497000
*           DO;                                                    1020 06498000
@RC01017 DS    0H                                                  1021 06499000
*             CKREQ=CKREQ&&CKREQ;                                  1021 06500000
         L     @04,@PC00001+8                                      1021 06501000
         XC    CKREQ(44,@04),CKREQ(@04)                            1021 06502000
*             CKRERN=MSG33;                                        1022 06503000
         MVC   CKRERN(2,@04),@CH02800                              1022 06504000
*             CKRMVAR(1)=ADDR(DSRANGE);                            1023 06505000
         LA    @15,@CC02833                                        1023 06506000
         ST    @15,CKRMVAR(,@04)                                   1023 06507000
*             CKRMVAR(2)=ADDR(CDHHRVAL);                           1024 06508000
         L     @15,@PC00001+4                                      1024 06509000
         L     @15,FDTPTR+176(,@15)                                1024 06510000
         LA    @14,CDHHRVAL(,@15)                                  1024 06511000
         ST    @14,CKRMVAR+4(,@04)                                 1024 06512000
*             CKRMVAR(3)=ADDR(XTNHDSN);                            1025 06513000
         LA    @14,XTNHDSN(,XTNTPTR)                               1025 06514000
         ST    @14,CKRMVAR+8(,@04)                                 1025 06515000
*             CKRMVAR(4)=ADDR(CDHHRLEN);                           1026 06516000
         ST    @15,CKRMVAR+12(,@04)                                1026 06517000
*             CALL IDCRDER;                                        1027 06518000
         L     @15,@CV01553                                        1027 06519000
         BALR  @14,@15                                             1027 06520000
*           END;                                                   1028 06521000
*                                                                  1028 06522000
*           /*********************************************************/ 06523000
*           /*                                                       */ 06524000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 06525000
*           /*                                                       */ 06526000
*           /*********************************************************/ 06527000
*                                                                  1029 06528000
*           RETURN CODE(LASTCC12);                                 1029 06529000
         LA    @15,12                                              1029 06530000
         L     @14,@SA00002                                        1029 06531000
         LM    @00,@12,@SA00002+8                                  1029 06532000
         BR    @14                                                 1029 06533000
*         END;                                                     1030 06534000
*                                                                  1030 06535000
*       /*************************************************************/ 06536000
*       /*                                                           */ 06537000
*       /* THE DATASETRANGE PARAMETER IS VALIDATED, CONSTRUCT THE    */ 06538000
*       /* EXTENT TABLE HEADER SETUP USER SUPPLIED RANGE IN XTNTTBL  */ 06539000
*       /* HEADER                                                    */ 06540000
*       /*                                                           */ 06541000
*       /*************************************************************/ 06542000
*                                                                  1031 06543000
*       IF ADDR(CDHHR)=NULLPTR THEN                                1031 06544000
@RF01015 L     @04,@PC00001+4                                      1031 06545000
         L     @15,FDTPTR+176(,@04)                                1031 06546000
         LTR   @15,@15                                             1031 06547000
         BNZ   @RF01031                                            1031 06548000
*         XTNHCHR2=CDCHRVAL;                                       1032 06549000
         L     @04,FDTPTR+172(,@04)                                1032 06550000
         MVC   XTNHCHR2(5,XTNTPTR),CDCHRVAL(@04)                   1032 06551000
*       ELSE                                                       1033 06552000
*         DO;                                                      1033 06553000
         B     @RC01031                                            1033 06554000
@RF01031 DS    0H                                                  1034 06555000
*           XTNHCHR2(1:2)=CDCHRVAL;                                1034 06556000
         L     @04,@PC00001+4                                      1034 06557000
         L     @01,FDTPTR+172(,@04)                                1034 06558000
         MVC   XTNHCHR2(2,XTNTPTR),CDCHRVAL(@01)                   1034 06559000
*           XTNHCHR2(3:5)=CDHHRVAL;                                1035 06560000
         L     @04,FDTPTR+176(,@04)                                1035 06561000
         MVC   XTNHCHR2+2(3,XTNTPTR),CDHHRVAL(@04)                 1035 06562000
*         END;                                                     1036 06563000
*       XTNHCHR1=CDCHRVAL;                                         1037 06564000
*                                                                  1037 06565000
@RC01031 L     @04,@PC00001+4                                      1037 06566000
         L     @01,FDTPTR+172(,@04)                                1037 06567000
         MVC   XTNHCHR1(5,XTNTPTR),CDCHRVAL(@01)                   1037 06568000
*       /*************************************************************/ 06569000
*       /*                                                           */ 06570000
*       /* SETUP USER SUPPLIED DSNAME OR DDNAME AND PASSWORD IN      */ 06571000
*       /* XTNTTBL HEADER                                            */ 06572000
*       /*                                                           */ 06573000
*       /*************************************************************/ 06574000
*                                                                  1038 06575000
*       IF ADDR(CINDS)^=NULLPTR THEN                               1038 06576000
         L     @04,FDTPTR+144(,@04)                                1038 06577000
         LTR   @04,@04                                             1038 06578000
         BZ    @RF01038                                            1038 06579000
*         DO;                                                      1039 06580000
*           XTNHDSN=CINDSVAL;                                      1040 06581000
         MVC   XTNHDSN(44,XTNTPTR),CINDSVAL(@04)                   1040 06582000
*           XTNHDDN=BLANKS;                                        1041 06583000
         MVC   XTNHDDN(8,XTNTPTR),BLANKS                           1041 06584000
*           XTNHPWD=CINDSPAS;                                      1042 06585000
         MVC   XTNHPWD(8,XTNTPTR),CINDSPAS(@04)                    1042 06586000
*         END;                                                     1043 06587000
*       ELSE                                                       1044 06588000
*         DO;                                                      1044 06589000
         B     @RC01038                                            1044 06590000
@RF01038 DS    0H                                                  1045 06591000
*           XTNHDSN=BLANKS;                                        1045 06592000
         MVC   XTNHDSN(44,XTNTPTR),BLANKS                          1045 06593000
*           XTNHDDN=CINFLVAL;                                      1046 06594000
         L     @04,@PC00001+4                                      1046 06595000
         L     @04,FDTPTR+140(,@04)                                1046 06596000
         MVC   XTNHDDN(8,XTNTPTR),CINFLVAL(@04)                    1046 06597000
*           XTNHPWD=CINFLPAS;                                      1047 06598000
         MVC   XTNHPWD(8,XTNTPTR),CINFLPAS(@04)                    1047 06599000
*         END;                                                     1048 06600000
*                                                                  1048 06601000
*       /*************************************************************/ 06602000
*       /*                                                           */ 06603000
*       /* SETUP USER SUPPLIED VOLSER IN XTNTTBL HEADER AND SET      */ 06604000
*       /* VOLUME NUMBER EQUAL TO 1 AND SET MODE EQUAL TO INPUT IN   */ 06605000
*       /* XTNTTBL HEADER                                            */ 06606000
*       /*                                                           */ 06607000
*       /*************************************************************/ 06608000
*                                                                  1049 06609000
*       XTNHVOLN=1;                                                1049 06610000
@RC01038 MVI   XTNHVOLN(XTNTPTR),X'01'                             1049 06611000
*       XTNHVOL=CVOLDVAL;                                          1050 06612000
         L     @04,@PC00001+4                                      1050 06613000
         L     @04,FDTPTR+168(,@04)                                1050 06614000
         MVC   XTNHVOL(6,XTNTPTR),CVOLDVAL(@04)                    1050 06615000
*       XTNHMODE=INPUT;                                            1051 06616000
         MVI   XTNHMODE(XTNTPTR),C'I'                              1051 06617000
*     END DSETCOPY;                                                1052 06618000
*                                                                  1053 06619000
*   /*****************************************************************/ 06620000
*   /*                                                               */ 06621000
*   /* FOR MODIFY INPUT, VALIDATE THE CCHHR LENGTH AND CONSTRUCT THE */ 06622000
*   /* EXTENT TABLE HEADER                                           */ 06623000
*   /*                                                               */ 06624000
*   /*****************************************************************/ 06625000
*                                                                  1053 06626000
*   IF ADDR(MODIF)^=NULLPTR THEN                                   1053 06627000
@RF00997 L     @04,@PC00001+4                                      1053 06628000
         L     @04,FDTPTR+356(,@04)                                1053 06629000
         LTR   @04,@04                                             1053 06630000
         BZ    @RF01053                                            1053 06631000
*     DO;                                                          1054 06632000
*       IF IOPARM=INPUT THEN                                       1055 06633000
         L     @04,@PC00002                                        1055 06634000
         CLI   IOPARM(@04),C'I'                                    1055 06635000
         BNE   @RF01055                                            1055 06636000
*DSETMODI:                                                         1056 06637000
*         DO;                                                      1056 06638000
*                                                                  1056 06639000
DSETMODI DS    0H                                                  1057 06640000
*           /*********************************************************/ 06641000
*           /*                                                       */ 06642000
*           /* THE LENGTH OF THE INDATASETADDRESS PARAMETER (CCHHR)  */ 06643000
*           /* MUST BE 5 BYTES. IF NOT, PREPARE TO RETURN TO THE     */ 06644000
*           /* CALLER WITH RC = 12                                   */ 06645000
*           /*                                                       */ 06646000
*           /*********************************************************/ 06647000
*                                                                  1057 06648000
*           IF MIDCHLEN^=LENGTH(MIDCHVAL) THEN                     1057 06649000
         L     @04,@PC00001+4                                      1057 06650000
         L     @01,FDTPTR+448(,@04)                                1057 06651000
         CLI   MIDCHLEN(@01),5                                     1057 06652000
         BE    @RF01057                                            1057 06653000
*             DO;                                                  1058 06654000
*                                                                  1058 06655000
*               /*****************************************************/ 06656000
*               /*                                                   */ 06657000
*               /* IF DATA SET NAME IS SPECIFIED (OS/VS2 ONLY), GET  */ 06658000
*               /* DSNAME FROM FDT                                   */ 06659000
*               /*                                                   */ 06660000
*               /*****************************************************/ 06661000
*                                                                  1059 06662000
*               IF ADDR(MINDS)^=NULLPTR THEN                       1059 06663000
         L     @04,FDTPTR+376(,@04)                                1059 06664000
         LTR   @04,@04                                             1059 06665000
         BZ    @RF01059                                            1059 06666000
*                 XTNHDSN=MINDSVAL;                                1060 06667000
*                                                                  1060 06668000
         MVC   XTNHDSN(44,XTNTPTR),MINDSVAL(@04)                   1060 06669000
*               /*****************************************************/ 06670000
*               /*                                                   */ 06671000
*               /* CALL IDCRDIN TO ISSUE UIOINFO TO OBTAIN THE DATA  */ 06672000
*               /* SET NAME AND MOVE IT INTO FIELD XTNHDSN IN        */ 06673000
*               /* XTNTTBL. IF UIOINFO FAILS OR IF THE DATA SET NAME */ 06674000
*               /* CANNOT BE LOCATED, XTNHDSN WILL BE SET TO BLANKS. */ 06675000
*               /*                                                   */ 06676000
*               /*****************************************************/ 06677000
*                                                                  1061 06678000
*               ELSE                                               1061 06679000
*                 CALL IDCRDIN;                                    1061 06680000
*                                                                  1061 06681000
         B     @RC01059                                            1061 06682000
@RF01059 BAL   @14,IDCRDIN                                         1061 06683000
*               /*****************************************************/ 06684000
*               /*                                                   */ 06685000
*               /* WRITE ERROR MESSAGE IDC31233I                     */ 06686000
*               /*                                                   */ 06687000
*               /*****************************************************/ 06688000
*                                                                  1062 06689000
*               DO;                                                1062 06690000
@RC01059 DS    0H                                                  1063 06691000
*                 CKREQ=CKREQ&&CKREQ;                              1063 06692000
         L     @04,@PC00001+8                                      1063 06693000
         XC    CKREQ(44,@04),CKREQ(@04)                            1063 06694000
*                 CKRERN=MSG33;                                    1064 06695000
         MVC   CKRERN(2,@04),@CH02800                              1064 06696000
*                 CKRMVAR(1)=ADDR(INDSADD);                        1065 06697000
         LA    @15,@CC02836                                        1065 06698000
         ST    @15,CKRMVAR(,@04)                                   1065 06699000
*                 CKRMVAR(2)=ADDR(MIDCHVAL);                       1066 06700000
         L     @15,@PC00001+4                                      1066 06701000
         L     @15,FDTPTR+448(,@15)                                1066 06702000
         LA    @14,MIDCHVAL(,@15)                                  1066 06703000
         ST    @14,CKRMVAR+4(,@04)                                 1066 06704000
*                 CKRMVAR(3)=ADDR(XTNHDSN);                        1067 06705000
         LA    @14,XTNHDSN(,XTNTPTR)                               1067 06706000
         ST    @14,CKRMVAR+8(,@04)                                 1067 06707000
*                 CKRMVAR(4)=ADDR(MIDCHLEN);                       1068 06708000
         ST    @15,CKRMVAR+12(,@04)                                1068 06709000
*                 CALL IDCRDER;                                    1069 06710000
         L     @15,@CV01553                                        1069 06711000
         BALR  @14,@15                                             1069 06712000
*               END;                                               1070 06713000
*                                                                  1070 06714000
*               /*****************************************************/ 06715000
*               /*                                                   */ 06716000
*               /* RETURN TO THE CALLER WITH RC = 12                 */ 06717000
*               /*                                                   */ 06718000
*               /*****************************************************/ 06719000
*                                                                  1071 06720000
*               RETURN CODE(LASTCC12);                             1071 06721000
         LA    @15,12                                              1071 06722000
         L     @14,@SA00002                                        1071 06723000
         LM    @00,@12,@SA00002+8                                  1071 06724000
         BR    @14                                                 1071 06725000
*             END;                                                 1072 06726000
*                                                                  1072 06727000
*           /*********************************************************/ 06728000
*           /*                                                       */ 06729000
*           /* THE INDATASETADDRESS PARAMETER IS VALIDATED, CONSTRUCT*/ 06730000
*           /* THE EXTENT TABLE HEADER SETUP USER SUPPLIED RANGE IN  */ 06731000
*           /* XTNTTBL HEADER                                        */ 06732000
*           /*                                                       */ 06733000
*           /*********************************************************/ 06734000
*                                                                  1073 06735000
*           XTNHCHR1=MIDCHVAL;                                     1073 06736000
@RF01057 L     @04,@PC00001+4                                      1073 06737000
         L     @15,FDTPTR+448(,@04)                                1073 06738000
         MVC   XTNHCHR1(5,XTNTPTR),MIDCHVAL(@15)                   1073 06739000
*           XTNHCHR2=MIDCHVAL;                                     1074 06740000
*                                                                  1074 06741000
         MVC   XTNHCHR2(5,XTNTPTR),MIDCHVAL(@15)                   1074 06742000
*           /*********************************************************/ 06743000
*           /*                                                       */ 06744000
*           /* SETUP USER SUPPLIED DSNAME OR DDNAME AND PASSWORD IN  */ 06745000
*           /* XTNTTBL HEADER                                        */ 06746000
*           /*                                                       */ 06747000
*           /*********************************************************/ 06748000
*                                                                  1075 06749000
*           IF ADDR(MINDS)^=NULLPTR THEN                           1075 06750000
         L     @04,FDTPTR+376(,@04)                                1075 06751000
         LTR   @04,@04                                             1075 06752000
         BZ    @RF01075                                            1075 06753000
*             DO;                                                  1076 06754000
*               XTNHDSN=MINDSVAL;                                  1077 06755000
         MVC   XTNHDSN(44,XTNTPTR),MINDSVAL(@04)                   1077 06756000
*               XTNHDDN=BLANKS;                                    1078 06757000
         MVC   XTNHDDN(8,XTNTPTR),BLANKS                           1078 06758000
*               XTNHPWD=MINDSPAS;                                  1079 06759000
         MVC   XTNHPWD(8,XTNTPTR),MINDSPAS(@04)                    1079 06760000
*             END;                                                 1080 06761000
*           ELSE                                                   1081 06762000
*             DO;                                                  1081 06763000
         B     @RC01075                                            1081 06764000
@RF01075 DS    0H                                                  1082 06765000
*               XTNHDSN=BLANKS;                                    1082 06766000
         MVC   XTNHDSN(44,XTNTPTR),BLANKS                          1082 06767000
*               XTNHDDN=MINFLVAL;                                  1083 06768000
         L     @04,@PC00001+4                                      1083 06769000
         L     @04,FDTPTR+372(,@04)                                1083 06770000
         MVC   XTNHDDN(8,XTNTPTR),MINFLVAL(@04)                    1083 06771000
*               XTNHPWD=MINFLPAS;                                  1084 06772000
         MVC   XTNHPWD(8,XTNTPTR),MINFLPAS(@04)                    1084 06773000
*             END;                                                 1085 06774000
*                                                                  1085 06775000
*           /*********************************************************/ 06776000
*           /*                                                       */ 06777000
*           /* SETUP USER SUPPLIED VOLSER IN XTNTTBL HEADER AND SET  */ 06778000
*           /* VOLUME NUMBER EQUAL TO 1 AND SET MODE EQUAL TO INPUT  */ 06779000
*           /* IN XTNTTBL HEADER                                     */ 06780000
*           /*                                                       */ 06781000
*           /*********************************************************/ 06782000
*                                                                  1086 06783000
*           XTNHVOLN=1;                                            1086 06784000
@RC01075 MVI   XTNHVOLN(XTNTPTR),X'01'                             1086 06785000
*           XTNHVOL=MIDVOVAL;                                      1087 06786000
         L     @04,@PC00001+4                                      1087 06787000
         L     @04,FDTPTR+444(,@04)                                1087 06788000
         MVC   XTNHVOL(6,XTNTPTR),MIDVOVAL(@04)                    1087 06789000
*           XTNHMODE=INPUT;                                        1088 06790000
         MVI   XTNHMODE(XTNTPTR),C'I'                              1088 06791000
*         END DSETMODI;                                            1089 06792000
*                                                                  1089 06793000
*       /*************************************************************/ 06794000
*       /*                                                           */ 06795000
*       /* FOR MODIFY OUTPUT, VALIDATE THE OUTDATASETADDRESS         */ 06796000
*       /* PARAMETER AND CONSTRUCT THE EXTENT TABLE HEADER           */ 06797000
*       /*                                                           */ 06798000
*       /*************************************************************/ 06799000
*                                                                  1090 06800000
*       IF IOPARM=OUTPUT THEN                                      1090 06801000
@RF01055 L     @04,@PC00002                                        1090 06802000
         CLI   IOPARM(@04),C'O'                                    1090 06803000
         BNE   @RF01090                                            1090 06804000
*DSETMODO:                                                         1091 06805000
*         DO;                                                      1091 06806000
*                                                                  1091 06807000
DSETMODO DS    0H                                                  1092 06808000
*           /*********************************************************/ 06809000
*           /*                                                       */ 06810000
*           /* THE LENGTH OF THE OUTDATASETADDRESS PARAMETER (CCHHR) */ 06811000
*           /* MUST BE 5 BYTES. IF NOT, PREPARE TO RETURN TO THE     */ 06812000
*           /* CALLER WITH RC = 12                                   */ 06813000
*           /*                                                       */ 06814000
*           /*********************************************************/ 06815000
*                                                                  1092 06816000
*           IF ADDR(MODSA)^=NULLPTR&MODCHLEN^=LENGTH(MODCHVAL) THEN     06817000
         SLR   @04,@04                                             1092 06818000
         L     @15,@PC00001+4                                      1092 06819000
         C     @04,FDTPTR+408(,@15)                                1092 06820000
         BE    @RF01092                                            1092 06821000
         L     @01,FDTPTR+492(,@15)                                1092 06822000
         CLI   MODCHLEN(@01),5                                     1092 06823000
         BE    @RF01092                                            1092 06824000
*             DO;                                                  1093 06825000
*                                                                  1093 06826000
*               /*****************************************************/ 06827000
*               /*                                                   */ 06828000
*               /* IF DATA SET NAME IS SPECIFIED (OS/VS2 ONLY), GET  */ 06829000
*               /* DSNAME FROM FDT                                   */ 06830000
*               /*                                                   */ 06831000
*               /*****************************************************/ 06832000
*                                                                  1094 06833000
*               IF ADDR(MODS)^=NULLPTR THEN                        1094 06834000
         L     @15,FDTPTR+416(,@15)                                1094 06835000
         CR    @15,@04                                             1094 06836000
         BE    @RF01094                                            1094 06837000
*                 XTNHDSN=MODSVAL;                                 1095 06838000
*                                                                  1095 06839000
         MVC   XTNHDSN(44,XTNTPTR),MODSVAL(@15)                    1095 06840000
*               /*****************************************************/ 06841000
*               /*                                                   */ 06842000
*               /* CALL IDCRDIN TO ISSUE UIOINFO TO OBTAIN THE DATA  */ 06843000
*               /* SET NAME AND MOVE IT INTO FIELD XTNHDSN IN        */ 06844000
*               /* XTNTTBL. IF UIOINFO FAILS OR IF THE DATA SET NAME */ 06845000
*               /* CANNOT BE LOCATED, XTNHDSN WILL BE SET TO BLANKS  */ 06846000
*               /*                                                   */ 06847000
*               /*****************************************************/ 06848000
*                                                                  1096 06849000
*               ELSE                                               1096 06850000
*                 CALL IDCRDIN;                                    1096 06851000
*                                                                  1096 06852000
         B     @RC01094                                            1096 06853000
@RF01094 BAL   @14,IDCRDIN                                         1096 06854000
*               /*****************************************************/ 06855000
*               /*                                                   */ 06856000
*               /* WRITE ERROR MESSAGE IDC3233I                      */ 06857000
*               /*                                                   */ 06858000
*               /*****************************************************/ 06859000
*                                                                  1097 06860000
*               DO;                                                1097 06861000
@RC01094 DS    0H                                                  1098 06862000
*                 CKREQ=CKREQ&&CKREQ;                              1098 06863000
         L     @04,@PC00001+8                                      1098 06864000
         XC    CKREQ(44,@04),CKREQ(@04)                            1098 06865000
*                 CKRERN=MSG33;                                    1099 06866000
         MVC   CKRERN(2,@04),@CH02800                              1099 06867000
*                 CKRMVAR(1)=ADDR(OUTDSADD);                       1100 06868000
         LA    @15,@CC02839                                        1100 06869000
         ST    @15,CKRMVAR(,@04)                                   1100 06870000
*                 CKRMVAR(2)=ADDR(MODCHVAL);                       1101 06871000
         L     @15,@PC00001+4                                      1101 06872000
         L     @15,FDTPTR+492(,@15)                                1101 06873000
         LA    @14,MODCHVAL(,@15)                                  1101 06874000
         ST    @14,CKRMVAR+4(,@04)                                 1101 06875000
*                 CKRMVAR(3)=ADDR(XTNHDSN);                        1102 06876000
         LA    @14,XTNHDSN(,XTNTPTR)                               1102 06877000
         ST    @14,CKRMVAR+8(,@04)                                 1102 06878000
*                 CKRMVAR(4)=ADDR(MODCHLEN);                       1103 06879000
         ST    @15,CKRMVAR+12(,@04)                                1103 06880000
*                 CALL IDCRDER;                                    1104 06881000
         L     @15,@CV01553                                        1104 06882000
         BALR  @14,@15                                             1104 06883000
*               END;                                               1105 06884000
*                                                                  1105 06885000
*               /*****************************************************/ 06886000
*               /*                                                   */ 06887000
*               /* RETURN TO THE CALLER WITH RC = 12                 */ 06888000
*               /*                                                   */ 06889000
*               /*****************************************************/ 06890000
*                                                                  1106 06891000
*               RETURN CODE(LASTCC12);                             1106 06892000
         LA    @15,12                                              1106 06893000
         L     @14,@SA00002                                        1106 06894000
         LM    @00,@12,@SA00002+8                                  1106 06895000
         BR    @14                                                 1106 06896000
*             END;                                                 1107 06897000
*                                                                  1107 06898000
*           /*********************************************************/ 06899000
*           /*                                                       */ 06900000
*           /* THE OUTDATASETADDRESS PARAMETER IS VALIDATED,         */ 06901000
*           /* CONSTRUCT THE EXTENT TABLE HEADER SETUP USER SUPPLIED */ 06902000
*           /* RANGE IN XTNTTBL HEADER                               */ 06903000
*           /*                                                       */ 06904000
*           /*********************************************************/ 06905000
*                                                                  1108 06906000
*           XTNHCHR1=MODCHVAL;                                     1108 06907000
@RF01092 L     @04,@PC00001+4                                      1108 06908000
         L     @04,FDTPTR+492(,@04)                                1108 06909000
         MVC   XTNHCHR1(5,XTNTPTR),MODCHVAL(@04)                   1108 06910000
*           IF TOCHRVAL=ZEROS(1:LENGTH(TOCHRVAL)) THEN             1109 06911000
         L     @15,@PC00002+4                                      1109 06912000
         CLC   TOCHRVAL(5,@15),ZEROS                               1109 06913000
         BNE   @RF01109                                            1109 06914000
*             XTNHCHR2=MODCHVAL;                                   1110 06915000
         MVC   XTNHCHR2(5,XTNTPTR),MODCHVAL(@04)                   1110 06916000
*           ELSE                                                   1111 06917000
*             XTNHCHR2=TOCHRVAL;                                   1111 06918000
*                                                                  1111 06919000
         B     @RC01109                                            1111 06920000
@RF01109 L     @04,@PC00002+4                                      1111 06921000
         MVC   XTNHCHR2(5,XTNTPTR),TOCHRVAL(@04)                   1111 06922000
*           /*********************************************************/ 06923000
*           /*                                                       */ 06924000
*           /* SETUP USER SUPPLIED DSNAME OR DDNAME AND PASSWORD IN  */ 06925000
*           /* XTNTTBL HEADER                                        */ 06926000
*           /*                                                       */ 06927000
*           /*********************************************************/ 06928000
*                                                                  1112 06929000
*           IF ADDR(MODS)^=NULLPTR THEN                            1112 06930000
@RC01109 L     @04,@PC00001+4                                      1112 06931000
         L     @04,FDTPTR+416(,@04)                                1112 06932000
         LTR   @04,@04                                             1112 06933000
         BZ    @RF01112                                            1112 06934000
*             DO;                                                  1113 06935000
*               XTNHDSN=MODSVAL;                                   1114 06936000
         MVC   XTNHDSN(44,XTNTPTR),MODSVAL(@04)                    1114 06937000
*               XTNHDDN=BLANKS;                                    1115 06938000
         MVC   XTNHDDN(8,XTNTPTR),BLANKS                           1115 06939000
*               XTNHPWD=MODSPAS;                                   1116 06940000
         MVC   XTNHPWD(8,XTNTPTR),MODSPAS(@04)                     1116 06941000
*             END;                                                 1117 06942000
*           ELSE                                                   1118 06943000
*             DO;                                                  1118 06944000
         B     @RC01112                                            1118 06945000
@RF01112 DS    0H                                                  1119 06946000
*               XTNHDSN=BLANKS;                                    1119 06947000
         MVC   XTNHDSN(44,XTNTPTR),BLANKS                          1119 06948000
*               XTNHDDN=MOUTFVAL;                                  1120 06949000
         L     @04,@PC00001+4                                      1120 06950000
         L     @04,FDTPTR+412(,@04)                                1120 06951000
         MVC   XTNHDDN(8,XTNTPTR),MOUTFVAL(@04)                    1120 06952000
*               XTNHPWD=MOUTFPAS;                                  1121 06953000
         MVC   XTNHPWD(8,XTNTPTR),MOUTFPAS(@04)                    1121 06954000
*             END;                                                 1122 06955000
*                                                                  1122 06956000
*           /*********************************************************/ 06957000
*           /*                                                       */ 06958000
*           /* SETUP USER SUPPLIED VOLSER IN XTNTTBL HEADER AND SET  */ 06959000
*           /* VOLUME NUMBER EQUAL TO 1 AND SET MODE EQUAL TO OUTPUT */ 06960000
*           /* IN XTNTTBL HEADER                                     */ 06961000
*           /*                                                       */ 06962000
*           /*********************************************************/ 06963000
*                                                                  1123 06964000
*           XTNHVOLN=1;                                            1123 06965000
@RC01112 MVI   XTNHVOLN(XTNTPTR),X'01'                             1123 06966000
*           XTNHVOL=MODVOVAL;                                      1124 06967000
         L     @04,@PC00001+4                                      1124 06968000
         L     @04,FDTPTR+488(,@04)                                1124 06969000
         MVC   XTNHVOL(6,XTNTPTR),MODVOVAL(@04)                    1124 06970000
*           XTNHMODE=OUTPUT;                                       1125 06971000
         MVI   XTNHMODE(XTNTPTR),C'O'                              1125 06972000
*         END DSETMODO;                                            1126 06973000
*     END;                                                         1127 06974000
@RF01090 DS    0H                                                  1128 06975000
*                                                                  1128 06976000
*   /*****************************************************************/ 06977000
*   /*                                                               */ 06978000
*   /* VTOC AND DATA SET PROCESSING ALL INPUT PARAMETERS HAVE BEEN   */ 06979000
*   /* VALIDATED ISSUE UALLOC TO GET DDNAME IF DSNAME WAS SPECIFIED  */ 06980000
*   /*                                                               */ 06981000
*   /*****************************************************************/ 06982000
*                                                                  1128 06983000
*   IF XTNHDSN^=BLANKS THEN                                        1128 06984000
@RF01053 CLC   XTNHDSN(44,XTNTPTR),BLANKS                          1128 06985000
         BE    @RF01128                                            1128 06986000
*     DO;                                                          1129 06987000
*                                                                  1129 06988000
*       /*************************************************************/ 06989000
*       /*                                                           */ 06990000
*       /* IF DSNAME SPECIFIED IS FORMAT4.DSCB, PREPARE TO RETURN TO */ 06991000
*       /* THE CALLER WITH RC = 12                                   */ 06992000
*       /*                                                           */ 06993000
*       /*************************************************************/ 06994000
*                                                                  1130 06995000
*       IF XTNHDSN=FMT4DSCB THEN                                   1130 06996000
         CLC   XTNHDSN(44,XTNTPTR),FMT4DSCB                        1130 06997000
         BNE   @RF01130                                            1130 06998000
*         DO;                                                      1131 06999000
*                                                                  1131 07000000
*           /*********************************************************/ 07001000
*           /*                                                       */ 07002000
*           /* WRITE ERROR MESSAGE IDC31209I                         */ 07003000
*           /*                                                       */ 07004000
*           /*********************************************************/ 07005000
*                                                                  1132 07006000
*           DO;                                                    1132 07007000
*             CKREQ=CKREQ&&CKREQ;                                  1133 07008000
         L     @15,@PC00001+8                                      1133 07009000
         XC    CKREQ(44,@15),CKREQ(@15)                            1133 07010000
*             CKRERN=MSG09;                                        1134 07011000
         MVC   CKRERN(2,@15),@CH00036                              1134 07012000
*             CALL IDCRDER;                                        1135 07013000
         L     @15,@CV01553                                        1135 07014000
         BALR  @14,@15                                             1135 07015000
*           END;                                                   1136 07016000
*                                                                  1136 07017000
*           /*********************************************************/ 07018000
*           /*                                                       */ 07019000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 07020000
*           /*                                                       */ 07021000
*           /*********************************************************/ 07022000
*                                                                  1137 07023000
*           RETURN CODE(LASTCC12);                                 1137 07024000
         LA    @15,12                                              1137 07025000
         L     @14,@SA00002                                        1137 07026000
         LM    @00,@12,@SA00002+8                                  1137 07027000
         BR    @14                                                 1137 07028000
*         END;                                                     1138 07029000
*                                                                  1138 07030000
*       /*************************************************************/ 07031000
*       /*                                                           */ 07032000
*       /* CONSTRUCT UALLOC ARGUMENT LIST (ALLAGL)                   */ 07033000
*       /*                                                           */ 07034000
*       /*************************************************************/ 07035000
*                                                                  1139 07036000
*       RESPECIFY                                                  1139 07037000
*         ALLAGL BASED(REPALLAG);                                  1139 07038000
@RF01130 DS    0H                                                  1140 07039000
*       ALLAGL=''B;                                                1140 07040000
         L     @04,@PC00001+8                                      1140 07041000
         L     @04,REPALLAG(,@04)                                  1140 07042000
         XC    ALLAGL(31,@04),ALLAGL(@04)                          1140 07043000
*       ALLDSN=ADDR(XTNHDSN);                                      1141 07044000
         LA    @15,XTNHDSN(,XTNTPTR)                               1141 07045000
         ST    @15,ALLDSN(,@04)                                    1141 07046000
*       IF XTNHPWD^=ZEROS THEN                                     1142 07047000
         CLC   XTNHPWD(8,XTNTPTR),ZEROS                            1142 07048000
         BE    @RF01142                                            1142 07049000
*         ALLPWD=ADDR(XTNHPWD);                                    1143 07050000
         LA    @15,XTNHPWD(,XTNTPTR)                               1143 07051000
         ST    @15,ALLPWD(,@04)                                    1143 07052000
*       ALLSTSOD=ON;                                               1144 07053000
@RF01142 L     @04,@PC00001+8                                      1144 07054000
         L     @04,REPALLAG(,@04)                                  1144 07055000
         OI    ALLSTSOD(@04),B'00000001'                           1144 07056000
*       ALLDSPKP=ON;                                               1145 07057000
         OI    ALLDSPKP(@04),B'00001000'                           1145 07058000
*       ALLOPTVL=OFF;                                              1146 07059000
*       ALLOPTDS=ON;                                               1147 07060000
*                                                                  1147 07061000
         OI    ALLOPTDS(@04),B'01000000'                           1147 07062000
         NI    ALLOPTVL(@04),B'01111111'                           1147 07063000
*       /*************************************************************/ 07064000
*       /*                                                           */ 07065000
*       /* ISSUE UALLOC.                                             */ 07066000
*       /*                                                           */ 07067000
*       /*************************************************************/ 07068000
*                                                                  1148 07069000
*       CALL IDCSAAL0(GDTTBL,ALLAGL);                              1148 07070000
*                                                                  1148 07071000
         L     @15,@PC00001                                        1148 07072000
         ST    @15,@AL00001                                        1148 07073000
         ST    @04,@AL00001+4                                      1148 07074000
         MVI   @AL00001+4,X'80'                                    1148 07075000
         L     @15,GDTALC(,@15)                                    1148 07076000
         LA    @01,@AL00001                                        1148 07077000
         BALR  @14,@15                                             1148 07078000
*       /*************************************************************/ 07079000
*       /*                                                           */ 07080000
*       /* SAVE RETURN CODE FROM UALLOC                              */ 07081000
*       /*                                                           */ 07082000
*       /*************************************************************/ 07083000
*                                                                  1149 07084000
*       RESPECIFY                                                  1149 07085000
*         RTNREG RSTD;                                             1149 07086000
*       TESTRC=RTNREG;                                             1150 07087000
         STH   RTNREG,TESTRC                                       1150 07088000
*       RESPECIFY                                                  1151 07089000
*         RTNREG UNRSTD;                                           1151 07090000
*                                                                  1151 07091000
*       /*************************************************************/ 07092000
*       /*                                                           */ 07093000
*       /* IF UALLOC FAILS, RETURN TO THE CALLER WITH RC = 12        */ 07094000
*       /*                                                           */ 07095000
*       /*************************************************************/ 07096000
*                                                                  1152 07097000
*       IF TESTRC^=0 THEN                                          1152 07098000
         LH    @04,TESTRC                                          1152 07099000
         LTR   @04,@04                                             1152 07100000
         BZ    @RF01152                                            1152 07101000
*         RETURN CODE(LASTCC12);                                   1153 07102000
*                                                                  1153 07103000
         LA    @15,12                                              1153 07104000
         L     @14,@SA00002                                        1153 07105000
         LM    @00,@12,@SA00002+8                                  1153 07106000
         BR    @14                                                 1153 07107000
*       /*************************************************************/ 07108000
*       /*                                                           */ 07109000
*       /* PLACE DDNAME IN THE EXTENT TABLE HEADER                   */ 07110000
*       /*                                                           */ 07111000
*       /*************************************************************/ 07112000
*                                                                  1154 07113000
*       XTNHDDN=ALLDDN;                                            1154 07114000
@RF01152 L     @04,@PC00001+8                                      1154 07115000
         L     @04,REPALLAG(,@04)                                  1154 07116000
         MVC   XTNHDDN(8,XTNTPTR),ALLDDN(@04)                      1154 07117000
*     END;                                                         1155 07118000
*                                                                  1155 07119000
*   /*****************************************************************/ 07120000
*   /*                                                               */ 07121000
*   /* ISSUE UIOINFO TO GET DSNAME AND VOLSER INFO CONSTRUCT UIOINFO */ 07122000
*   /* OPTION BYTE                                                   */ 07123000
*   /*                                                               */ 07124000
*   /*****************************************************************/ 07125000
*                                                                  1156 07126000
*   IOINFOPT=''B;                                                  1156 07127000
@RF01128 LA    @04,INFOBYT                                         1156 07128000
         MVI   IOINFOPT(@04),X'00'                                 1156 07129000
*   IOINFVOL=ON;                                                   1157 07130000
*   IOINFDSN=ON;                                                   1158 07131000
*                                                                  1158 07132000
         OI    IOINFVOL(@04),B'01100000'                           1158 07133000
*   /*****************************************************************/ 07134000
*   /*                                                               */ 07135000
*   /* GET ADDRESS OF UIOINFO RETURN AREA                            */ 07136000
*   /*                                                               */ 07137000
*   /*****************************************************************/ 07138000
*                                                                  1159 07139000
*   IF ADDR(MODIF)^=NULLPTR&IOPARM^=INPUT THEN                     1159 07140000
         L     @04,@PC00001+4                                      1159 07141000
         L     @04,FDTPTR+356(,@04)                                1159 07142000
         LTR   @04,@04                                             1159 07143000
         BZ    @RF01159                                            1159 07144000
         L     @04,@PC00002                                        1159 07145000
         CLI   IOPARM(@04),C'I'                                    1159 07146000
         BE    @RF01159                                            1159 07147000
*     INFOPTR=REPOINFO;                                            1160 07148000
         L     @04,@PC00001+8                                      1160 07149000
         L     @04,REPOINFO(,@04)                                  1160 07150000
         ST    @04,INFOPTR                                         1160 07151000
*   ELSE                                                           1161 07152000
*     INFOPTR=REPIINFO;                                            1161 07153000
*                                                                  1161 07154000
         B     @RC01159                                            1161 07155000
@RF01159 L     @04,@PC00001+8                                      1161 07156000
         L     @04,REPIINFO(,@04)                                  1161 07157000
         ST    @04,INFOPTR                                         1161 07158000
*   /*****************************************************************/ 07159000
*   /*                                                               */ 07160000
*   /* ISSUE UIOINFO                                                 */ 07161000
*   /*                                                               */ 07162000
*   /*****************************************************************/ 07163000
*                                                                  1162 07164000
*   CALL IDCIOSI0(GDTTBL,IOINFOPT,INFOPTR,XTNHDDN);                1162 07165000
*                                                                  1162 07166000
@RC01159 L     @04,@PC00001                                        1162 07167000
         ST    @04,@AL00001                                        1162 07168000
         LA    @15,INFOBYT                                         1162 07169000
         ST    @15,@AL00001+4                                      1162 07170000
         LA    @15,INFOPTR                                         1162 07171000
         ST    @15,@AL00001+8                                      1162 07172000
         ST    XTNTPTR,@AL00001+12                                 1162 07173000
         MVI   @AL00001+12,X'80'                                   1162 07174000
         L     @15,GDTIFO(,@04)                                    1162 07175000
         LA    @01,@AL00001                                        1162 07176000
         BALR  @14,@15                                             1162 07177000
*   /*****************************************************************/ 07178000
*   /*                                                               */ 07179000
*   /* SAVE RETURN CODE UIOINFO                                      */ 07180000
*   /*                                                               */ 07181000
*   /*****************************************************************/ 07182000
*                                                                  1163 07183000
*   RESPECIFY                                                      1163 07184000
*     RTNREG RSTD;                                                 1163 07185000
*   TESTRC=RTNREG;                                                 1164 07186000
         STH   RTNREG,TESTRC                                       1164 07187000
*   RESPECIFY                                                      1165 07188000
*     RTNREG UNRSTD;                                               1165 07189000
*                                                                  1165 07190000
*   /*****************************************************************/ 07191000
*   /*                                                               */ 07192000
*   /* IF UIOINFO FAILS, RETURN TO THE CALLER WITH RC = 12           */ 07193000
*   /*                                                               */ 07194000
*   /*****************************************************************/ 07195000
*                                                                  1166 07196000
*   IF TESTRC^=0 THEN                                              1166 07197000
         LH    @04,TESTRC                                          1166 07198000
         LTR   @04,@04                                             1166 07199000
         BZ    @RF01166                                            1166 07200000
*     RETURN CODE(LASTCC12);                                       1167 07201000
*                                                                  1167 07202000
         LA    @15,12                                              1167 07203000
         L     @14,@SA00002                                        1167 07204000
         LM    @00,@12,@SA00002+8                                  1167 07205000
         BR    @14                                                 1167 07206000
*   /*****************************************************************/ 07207000
*   /*                                                               */ 07208000
*   /* SETUP UIOINFO RETURN AREA ADDRESSABILITY                      */ 07209000
*   /*                                                               */ 07210000
*   /*****************************************************************/ 07211000
*                                                                  1168 07212000
*   RESPECIFY                                                      1168 07213000
*     INFOAREA BASED(INFOPTR);                                     1168 07214000
@RF01166 DS    0H                                                  1169 07215000
*   RESPECIFY                                                      1169 07216000
*     INFOSCAN BASED(INFSCNPT);                                    1169 07217000
*   INFSCNPT=INFOPTR+LENGTH(INFAREAL)+LENGTH(INFDATAL);            1170 07218000
*                                                                  1170 07219000
         LA    INFSCNPT,4                                          1170 07220000
         AL    INFSCNPT,INFOPTR                                    1170 07221000
*   /*****************************************************************/ 07222000
*   /*                                                               */ 07223000
*   /* LOOP TWICE THROUGH UIOINFO RETURN AREA TO LOCATE DATA SET NAME*/ 07224000
*   /* AND VOLSER LIST                                               */ 07225000
*   /*                                                               */ 07226000
*   /*****************************************************************/ 07227000
*                                                                  1171 07228000
*   INFDSNPT=0;                                                    1171 07229000
         SLR   @04,@04                                             1171 07230000
         LR    INFDSNPT,@04                                        1171 07231000
*   INFVOLPT=0;                                                    1172 07232000
         ST    @04,INFVOLPT                                        1172 07233000
*   DO I=1 TO 2;                                                   1173 07234000
         LA    @04,1                                               1173 07235000
         L     @15,@PC00001+8                                      1173 07236000
         STC   @04,I(,@15)                                         1173 07237000
@DL01173 DS    0H                                                  1174 07238000
*     IF INFSCNID=DSNIDENT THEN                                    1174 07239000
         CLC   INFSCNID(2,INFSCNPT),@CH00221                       1174 07240000
         BNE   @RF01174                                            1174 07241000
*       DO;                                                        1175 07242000
*         INFDSNPT=INFSCNPT;                                       1176 07243000
         LR    INFDSNPT,INFSCNPT                                   1176 07244000
*         RESPECIFY                                                1177 07245000
*           INFODSN BASED(INFDSNPT);                               1177 07246000
*       END;                                                       1178 07247000
*     ELSE                                                         1179 07248000
*       IF INFSCNID=VOLIDENT THEN                                  1179 07249000
         B     @RC01174                                            1179 07250000
@RF01174 CLC   INFSCNID(2,INFSCNPT),@CH00156                       1179 07251000
         BNE   @RF01179                                            1179 07252000
*         DO;                                                      1180 07253000
*           INFVOLPT=INFSCNPT;                                     1181 07254000
         ST    INFSCNPT,INFVOLPT                                   1181 07255000
*           RESPECIFY                                              1182 07256000
*             INFOVOL BASED(INFVOLPT);                             1182 07257000
*         END;                                                     1183 07258000
*     INFSCNPT=INFSCNPT+INFSCNLN+LENGTH(INFSCNID)+LENGTH(INFSCNLN);     07259000
@RF01179 DS    0H                                                  1184 07260000
@RC01174 LR    @04,INFSCNPT                                        1184 07261000
         LH    @15,INFSCNLN(,INFSCNPT)                             1184 07262000
         N     @15,@CF03043                                        1184 07263000
         ALR   @04,@15                                             1184 07264000
         AL    @04,@CF00045                                        1184 07265000
         LR    INFSCNPT,@04                                        1184 07266000
*   END;                                                           1185 07267000
*                                                                  1185 07268000
         L     @15,@PC00001+8                                      1185 07269000
         LA    @04,1                                               1185 07270000
         SLR   @14,@14                                             1185 07271000
         IC    @14,I(,@15)                                         1185 07272000
         ALR   @04,@14                                             1185 07273000
         L     @15,@PC00001+8                                      1185 07274000
         STC   @04,I(,@15)                                         1185 07275000
         C     @04,@CF00156                                        1185 07276000
         BNH   @DL01173                                            1185 07277000
*   /*****************************************************************/ 07278000
*   /*                                                               */ 07279000
*   /* IF EITHER DSNAME OR VOLSER LIST CANNOT BE LOCATED, RETURN TO  */ 07280000
*   /* THE CALLER WITH RC = 12                                       */ 07281000
*   /*                                                               */ 07282000
*   /*****************************************************************/ 07283000
*                                                                  1186 07284000
*   IF INFDSNPT=0|INFVOLPT=0 THEN                                  1186 07285000
         SLR   @04,@04                                             1186 07286000
         CR    INFDSNPT,@04                                        1186 07287000
         BE    @RT01186                                            1186 07288000
         C     @04,INFVOLPT                                        1186 07289000
         BNE   @RF01186                                            1186 07290000
@RT01186 DS    0H                                                  1187 07291000
*     RETURN CODE(LASTCC12);                                       1187 07292000
*                                                                  1187 07293000
         LA    @15,12                                              1187 07294000
         L     @14,@SA00002                                        1187 07295000
         LM    @00,@12,@SA00002+8                                  1187 07296000
         BR    @14                                                 1187 07297000
*   /*****************************************************************/ 07298000
*   /*                                                               */ 07299000
*   /* PUT DSNAME IN EXTENT TABLE HEADER                             */ 07300000
*   /*                                                               */ 07301000
*   /*****************************************************************/ 07302000
*                                                                  1188 07303000
*   IF XTNHDSN=BLANKS THEN                                         1188 07304000
@RF01186 CLC   XTNHDSN(44,XTNTPTR),BLANKS                          1188 07305000
         BNE   @RF01188                                            1188 07306000
*     DO;                                                          1189 07307000
*       IF INFDSN=FMT4DSCB THEN                                    1190 07308000
         CLC   INFDSN(44,INFDSNPT),FMT4DSCB                        1190 07309000
         BNE   @RF01190                                            1190 07310000
*         XTNHDSN=FMT4DSN;                                         1191 07311000
         MVC   XTNHDSN(44,XTNTPTR),FMT4DSN                         1191 07312000
*       ELSE                                                       1192 07313000
*         XTNHDSN=INFDSN;                                          1192 07314000
         B     @RC01190                                            1192 07315000
@RF01190 MVC   XTNHDSN(44,XTNTPTR),INFDSN(INFDSNPT)                1192 07316000
*     END;                                                         1193 07317000
*                                                                  1193 07318000
@RC01190 DS    0H                                                  1194 07319000
*   /*****************************************************************/ 07320000
*   /*                                                               */ 07321000
*   /* IF VOLUME SERIAL NUMBER FROM UIOINFO DOES NOT MATCH VOLUME    */ 07322000
*   /* SERIAL NUMBER IN SYNTAX, PREPARE TO RETURN TO RETURN TO THE   */ 07323000
*   /* CALLER WITH RC = 12                                           */ 07324000
*   /*                                                               */ 07325000
*   /*****************************************************************/ 07326000
*                                                                  1194 07327000
*   IF XTNHVOL^=INFVOL(1) THEN                                     1194 07328000
@RF01188 L     @04,INFVOLPT                                        1194 07329000
         CLC   XTNHVOL(6,XTNTPTR),INFVOL(@04)                      1194 07330000
         BE    @RF01194                                            1194 07331000
*     DO;                                                          1195 07332000
*       IF ADDR(DISPL)^=NULLPTR|ADDR(COPY)^=NULLPTR THEN           1196 07333000
         SLR   @04,@04                                             1196 07334000
         L     @15,@PC00001+4                                      1196 07335000
         C     @04,FDTPTR(,@15)                                    1196 07336000
         BNE   @RT01196                                            1196 07337000
         C     @04,FDTPTR+136(,@15)                                1196 07338000
         BE    @RF01196                                            1196 07339000
@RT01196 DS    0H                                                  1197 07340000
*         PARMHOLD=DSRANGE;                                        1197 07341000
         MVC   PARMHOLD(17),@CC02833                               1197 07342000
*       ELSE                                                       1198 07343000
*         IF XTNHMODE=INPUT THEN                                   1198 07344000
         B     @RC01196                                            1198 07345000
@RF01196 CLI   XTNHMODE(XTNTPTR),C'I'                              1198 07346000
         BNE   @RF01198                                            1198 07347000
*           PARMHOLD=INDSADD;                                      1199 07348000
         MVC   PARMHOLD(17),@CC02836                               1199 07349000
*         ELSE                                                     1200 07350000
*           PARMHOLD=OUTDSADD;                                     1200 07351000
*                                                                  1200 07352000
         B     @RC01198                                            1200 07353000
@RF01198 MVC   PARMHOLD(17),@CC02839                               1200 07354000
*       /*************************************************************/ 07355000
*       /*                                                           */ 07356000
*       /* WRITE ERROR MESSAGE IDC31210I                             */ 07357000
*       /*                                                           */ 07358000
*       /*************************************************************/ 07359000
*                                                                  1201 07360000
*       DO;                                                        1201 07361000
@RC01198 DS    0H                                                  1201 07362000
@RC01196 DS    0H                                                  1202 07363000
*         CKREQ=CKREQ&&CKREQ;                                      1202 07364000
         L     @04,@PC00001+8                                      1202 07365000
         XC    CKREQ(44,@04),CKREQ(@04)                            1202 07366000
*         CKRERN=MSG10;                                            1203 07367000
         MVC   CKRERN(2,@04),@CH00037                              1203 07368000
*         CKRMVAR(1)=ADDR(XTNHVOL);                                1204 07369000
         LA    @15,XTNHVOL(,XTNTPTR)                               1204 07370000
         ST    @15,CKRMVAR(,@04)                                   1204 07371000
*         CKRMVAR(2)=ADDR(PARMHOLD);                               1205 07372000
         LA    @05,PARMHOLD                                        1205 07373000
         ST    @05,CKRMVAR+4(,@04)                                 1205 07374000
*         CKRMVAR(3)=ADDR(INFODD);                                 1206 07375000
         LA    @05,INFODD                                          1206 07376000
         ST    @05,CKRMVAR+8(,@04)                                 1206 07377000
*         CALL IDCRDER;                                            1207 07378000
         L     @15,@CV01553                                        1207 07379000
         BALR  @14,@15                                             1207 07380000
*       END;                                                       1208 07381000
*                                                                  1208 07382000
*       /*************************************************************/ 07383000
*       /*                                                           */ 07384000
*       /* RETURN TO THE CALL WITH RC = 12                           */ 07385000
*       /*                                                           */ 07386000
*       /*************************************************************/ 07387000
*                                                                  1209 07388000
*       RETURN CODE(LASTCC12);                                     1209 07389000
         LA    @15,12                                              1209 07390000
         L     @14,@SA00002                                        1209 07391000
         LM    @00,@12,@SA00002+8                                  1209 07392000
         BR    @14                                                 1209 07393000
*     END;                                                         1210 07394000
*                                                                  1210 07395000
*   /*****************************************************************/ 07396000
*   /*                                                               */ 07397000
*   /* IF STARTING ADDRESS GREATER THAN ENDING ADDRESS, PREPARE TO   */ 07398000
*   /* RETURN TO THE CALLER WITH RC = 12                             */ 07399000
*   /*                                                               */ 07400000
*   /*****************************************************************/ 07401000
*                                                                  1211 07402000
*   IF XTNHCHR1>XTNHCHR2 THEN                                      1211 07403000
@RF01194 CLC   XTNHCHR1(5,XTNTPTR),XTNHCHR2(XTNTPTR)               1211 07404000
         BNH   @RF01211                                            1211 07405000
*     DO;                                                          1212 07406000
*                                                                  1212 07407000
*       /*************************************************************/ 07408000
*       /*                                                           */ 07409000
*       /* WRITE ERROR MESSAGE IDC31235I                             */ 07410000
*       /*                                                           */ 07411000
*       /*************************************************************/ 07412000
*                                                                  1213 07413000
*       DO;                                                        1213 07414000
*         CKREQ=CKREQ&&CKREQ;                                      1214 07415000
         L     @04,@PC00001+8                                      1214 07416000
         XC    CKREQ(44,@04),CKREQ(@04)                            1214 07417000
*         CKRERN=MSG35;                                            1215 07418000
         MVC   CKRERN(2,@04),@CH00709                              1215 07419000
*         CKRMVAR(1)=ADDR(XTNHCHR1);                               1216 07420000
         LA    @15,XTNHCHR1(,XTNTPTR)                              1216 07421000
         ST    @15,CKRMVAR(,@04)                                   1216 07422000
*         CKRMVAR(2)=ADDR(XTNHCHR2);                               1217 07423000
         LA    @15,XTNHCHR2(,XTNTPTR)                              1217 07424000
         ST    @15,CKRMVAR+4(,@04)                                 1217 07425000
*         CKRMVAR(3)=ADDR(XTNHDSN);                                1218 07426000
         LA    @15,XTNHDSN(,XTNTPTR)                               1218 07427000
         ST    @15,CKRMVAR+8(,@04)                                 1218 07428000
*         CALL IDCRDER;                                            1219 07429000
         L     @15,@CV01553                                        1219 07430000
         BALR  @14,@15                                             1219 07431000
*       END;                                                       1220 07432000
*                                                                  1220 07433000
*       /*************************************************************/ 07434000
*       /*                                                           */ 07435000
*       /* RETURN TO THE CALLER WITH RC = 12                         */ 07436000
*       /*                                                           */ 07437000
*       /*************************************************************/ 07438000
*                                                                  1221 07439000
*       RETURN CODE(LASTCC12);                                     1221 07440000
         LA    @15,12                                              1221 07441000
         L     @14,@SA00002                                        1221 07442000
         LM    @00,@12,@SA00002+8                                  1221 07443000
         BR    @14                                                 1221 07444000
*     END;                                                         1222 07445000
*                                                                  1222 07446000
*   /*****************************************************************/ 07447000
*   /*                                                               */ 07448000
*   /* GET ADDRESS OF DEVTYPE RETURN AREA                            */ 07449000
*   /*                                                               */ 07450000
*   /*****************************************************************/ 07451000
*                                                                  1223 07452000
*   IF ADDR(MODIF)^=NULLPTR&IOPARM=OUTPUT THEN                     1223 07453000
@RF01211 L     @04,@PC00001+4                                      1223 07454000
         L     @04,FDTPTR+356(,@04)                                1223 07455000
         LTR   @04,@04                                             1223 07456000
         BZ    @RF01223                                            1223 07457000
         L     @04,@PC00002                                        1223 07458000
         CLI   IOPARM(@04),C'O'                                    1223 07459000
         BNE   @RF01223                                            1223 07460000
*     DEVAREAP=REPODEVA;                                           1224 07461000
         L     @04,@PC00001+8                                      1224 07462000
         L     @04,REPODEVA(,@04)                                  1224 07463000
         ST    @04,DEVAREAP                                        1224 07464000
*   ELSE                                                           1225 07465000
*     DEVAREAP=REPIDEVA;                                           1225 07466000
*                                                                  1225 07467000
         B     @RC01223                                            1225 07468000
@RF01223 L     @04,@PC00001+8                                      1225 07469000
         L     @04,REPIDEVA(,@04)                                  1225 07470000
         ST    @04,DEVAREAP                                        1225 07471000
*   /*****************************************************************/ 07472000
*   /*                                                               */ 07473000
*   /* ISSUE DEVTYPE MACRO                                           */ 07474000
*   /*                                                               */ 07475000
*   /*****************************************************************/ 07476000
*                                                                  1226 07477000
*   RESPECIFY                                                      1226 07478000
*    (REG3,                                                        1226 07479000
*     REG4) RESTRICTED;                                            1226 07480000
@RC01223 DS    0H                                                  1227 07481000
*   REG3=ADDR(XTNHDDN);                                            1227 07482000
         LR    REG3,XTNTPTR                                        1227 07483000
*   REG4=DEVAREAP;                                                 1228 07484000
         L     REG4,DEVAREAP                                       1228 07485000
*LDEVTYP3:                                                         1229 07486000
*   GEN;                                                           1229 07487000
LDEVTYP3 DS    0H                                                  1229 07488000
         DEVTYPE (3),(4),DEVTAB                                         07489000
*   RESPECIFY                                                      1230 07490000
*    (REG3,                                                        1230 07491000
*     REG4) UNRESTRICTED;                                          1230 07492000
*                                                                  1230 07493000
*   /*****************************************************************/ 07494000
*   /*                                                               */ 07495000
*   /* SAVE RETURN CODE FROM DEVTYPE                                 */ 07496000
*   /*                                                               */ 07497000
*   /*****************************************************************/ 07498000
*                                                                  1231 07499000
*   RESPECIFY                                                      1231 07500000
*     RTNREG RSTD;                                                 1231 07501000
*   TESTRC=RTNREG;                                                 1232 07502000
         STH   RTNREG,TESTRC                                       1232 07503000
*   RESPECIFY                                                      1233 07504000
*     RTNREG UNRSTD;                                               1233 07505000
*                                                                  1233 07506000
*   /*****************************************************************/ 07507000
*   /*                                                               */ 07508000
*   /* IF DEVTYPE FAILS, RETURN TO CALLER WITH RC = 12               */ 07509000
*   /*                                                               */ 07510000
*   /*****************************************************************/ 07511000
*                                                                  1234 07512000
*   IF TESTRC^=0 THEN                                              1234 07513000
         LH    @04,TESTRC                                          1234 07514000
         LTR   @04,@04                                             1234 07515000
         BZ    @RF01234                                            1234 07516000
*     RETURN CODE(LASTCC12);                                       1235 07517000
*                                                                  1235 07518000
         LA    @15,12                                              1235 07519000
         L     @14,@SA00002                                        1235 07520000
         LM    @00,@12,@SA00002+8                                  1235 07521000
         BR    @14                                                 1235 07522000
*   /*****************************************************************/ 07523000
*   /*                                                               */ 07524000
*   /* IF THE DATA SET IS MOUNTED ON A REAL UNIT, PREPARE TO RETURN  */ 07525000
*   /* TO THE CALLER WITH RC = 12                                    */ 07526000
*   /*                                                               */ 07527000
*   /*****************************************************************/ 07528000
*                                                                  1236 07529000
*   IF DEVRVDEV=OFF THEN                                           1236 07530000
@RF01234 L     @04,DEVAREAP                                        1236 07531000
         TM    DEVRVDEV(@04),B'00001000'                           1236 07532000
         BNZ   @RF01236                                            1236 07533000
*     DO;                                                          1237 07534000
*                                                                  1237 07535000
*       /*************************************************************/ 07536000
*       /*                                                           */ 07537000
*       /* TEST FOR VTOC                                             */ 07538000
*       /*                                                           */ 07539000
*       /*************************************************************/ 07540000
*                                                                  1238 07541000
*       IF XTNHDSN=FMT4DSN THEN                                    1238 07542000
         CLC   XTNHDSN(44,XTNTPTR),FMT4DSN                         1238 07543000
         BNE   @RF01238                                            1238 07544000
*         XTNHDSN=FMT4DSCB;                                        1239 07545000
*                                                                  1239 07546000
         MVC   XTNHDSN(44,XTNTPTR),FMT4DSCB                        1239 07547000
*       /*************************************************************/ 07548000
*       /*                                                           */ 07549000
*       /* WRITE ERROR MESSAGE IDC31211I                             */ 07550000
*       /*                                                           */ 07551000
*       /*************************************************************/ 07552000
*                                                                  1240 07553000
*       DO;                                                        1240 07554000
@RF01238 DS    0H                                                  1241 07555000
*         CKREQ=CKREQ&&CKREQ;                                      1241 07556000
         L     @04,@PC00001+8                                      1241 07557000
         XC    CKREQ(44,@04),CKREQ(@04)                            1241 07558000
*         CKRERN=MSG11;                                            1242 07559000
         MVC   CKRERN(2,@04),@CH00038                              1242 07560000
*         CKRMVAR(1)=ADDR(XTNHDSN);                                1243 07561000
         LA    @15,XTNHDSN(,XTNTPTR)                               1243 07562000
         ST    @15,CKRMVAR(,@04)                                   1243 07563000
*         CALL IDCRDER;                                            1244 07564000
         L     @15,@CV01553                                        1244 07565000
         BALR  @14,@15                                             1244 07566000
*       END;                                                       1245 07567000
*                                                                  1245 07568000
*       /*************************************************************/ 07569000
*       /*                                                           */ 07570000
*       /* RETURN TO THE CALLER WITH RC = 12                         */ 07571000
*       /*                                                           */ 07572000
*       /*************************************************************/ 07573000
*                                                                  1246 07574000
*       RETURN CODE(LASTCC12);                                     1246 07575000
         LA    @15,12                                              1246 07576000
         L     @14,@SA00002                                        1246 07577000
         LM    @00,@12,@SA00002+8                                  1246 07578000
         BR    @14                                                 1246 07579000
*     END;                                                         1247 07580000
*                                                                  1247 07581000
*   /*****************************************************************/ 07582000
*   /*                                                               */ 07583000
*   /* COMPARE STARTING ADDRESS CC AND HH AGAINST MAXIMUM CYLINDER   */ 07584000
*   /* AND TRACK NUMBERS FOR THE DEVICE AS RETURNED BY DEVTYPE. IF   */ 07585000
*   /* ANY USER-SUPPLIED VALUE IS LARGER THAN THE CORRESPONDING      */ 07586000
*   /* MAXIMUM FOR THE DEVICE, PREPARE TO RETURN TO THE CALLER WITH  */ 07587000
*   /* RC = 12                                                       */ 07588000
*   /*                                                               */ 07589000
*   /*****************************************************************/ 07590000
*                                                                  1248 07591000
*   IF XTNHCHR1(1:2)>DEVMAXCC|XTNHCHR1(3:4)>DEVMAXHH THEN          1248 07592000
@RF01236 L     @04,DEVAREAP                                        1248 07593000
         CLC   XTNHCHR1(2,XTNTPTR),DEVMAXCC(@04)                   1248 07594000
         BH    @RT01248                                            1248 07595000
         CLC   XTNHCHR1+2(2,XTNTPTR),DEVMAXHH(@04)                 1248 07596000
         BNH   @RF01248                                            1248 07597000
@RT01248 DS    0H                                                  1249 07598000
*     DO;                                                          1249 07599000
*       IF ADDR(DISPL)^=NULLPTR|ADDR(COPY)^=NULLPTR THEN           1250 07600000
         SLR   @04,@04                                             1250 07601000
         L     @15,@PC00001+4                                      1250 07602000
         C     @04,FDTPTR(,@15)                                    1250 07603000
         BNE   @RT01250                                            1250 07604000
         C     @04,FDTPTR+136(,@15)                                1250 07605000
         BE    @RF01250                                            1250 07606000
@RT01250 DS    0H                                                  1251 07607000
*         PARMHOLD=DSRANGE;                                        1251 07608000
         MVC   PARMHOLD(17),@CC02833                               1251 07609000
*       ELSE                                                       1252 07610000
*         IF XTNHMODE=INPUT THEN                                   1252 07611000
         B     @RC01250                                            1252 07612000
@RF01250 CLI   XTNHMODE(XTNTPTR),C'I'                              1252 07613000
         BNE   @RF01252                                            1252 07614000
*           PARMHOLD=INDSADD;                                      1253 07615000
         MVC   PARMHOLD(17),@CC02836                               1253 07616000
*         ELSE                                                     1254 07617000
*           PARMHOLD=OUTDSADD;                                     1254 07618000
*                                                                  1254 07619000
         B     @RC01252                                            1254 07620000
@RF01252 MVC   PARMHOLD(17),@CC02839                               1254 07621000
*       /*************************************************************/ 07622000
*       /*                                                           */ 07623000
*       /* WRITE ERROR MESSAGE IDC31234I                             */ 07624000
*       /*                                                           */ 07625000
*       /*************************************************************/ 07626000
*                                                                  1255 07627000
*       DO;                                                        1255 07628000
@RC01252 DS    0H                                                  1255 07629000
@RC01250 DS    0H                                                  1256 07630000
*         CKREQ=CKREQ&&CKREQ;                                      1256 07631000
         L     @04,@PC00001+8                                      1256 07632000
         XC    CKREQ(44,@04),CKREQ(@04)                            1256 07633000
*         CKRERN=MSG34;                                            1257 07634000
         MVC   CKRERN(2,@04),@CH02802                              1257 07635000
*         CKRMVAR(1)=ADDR(PARMHOLD);                               1258 07636000
         LA    @15,PARMHOLD                                        1258 07637000
         ST    @15,CKRMVAR(,@04)                                   1258 07638000
*         CKRMVAR(2)=ADDR(XTNHCHR1);                               1259 07639000
         LA    @15,XTNHCHR1(,XTNTPTR)                              1259 07640000
         ST    @15,CKRMVAR+4(,@04)                                 1259 07641000
*         CALL IDCRDER;                                            1260 07642000
         L     @15,@CV01553                                        1260 07643000
         BALR  @14,@15                                             1260 07644000
*       END;                                                       1261 07645000
*                                                                  1261 07646000
*       /*************************************************************/ 07647000
*       /*                                                           */ 07648000
*       /* RETURN TO THE CALLER WITH RC = 12                         */ 07649000
*       /*                                                           */ 07650000
*       /*************************************************************/ 07651000
*                                                                  1262 07652000
*       RETURN CODE(LASTCC12);                                     1262 07653000
         LA    @15,12                                              1262 07654000
         L     @14,@SA00002                                        1262 07655000
         LM    @00,@12,@SA00002+8                                  1262 07656000
         BR    @14                                                 1262 07657000
*     END;                                                         1263 07658000
*                                                                  1263 07659000
*   /*****************************************************************/ 07660000
*   /*                                                               */ 07661000
*   /* IF ENDING ADDRESS IS NOT EQUAL TO STARTING ADDRESS, COMPARE   */ 07662000
*   /* ENDING ADDRESS CC AND HH AGAINST MAXIMUM CYLINDER AND TRACK   */ 07663000
*   /* NUMBERS FOR THE DEVICE AS RETURNED BY DEVTYPE. IF ANY         */ 07664000
*   /* USER-SUPPLIED VALUE IS LARGER THAN THE CORRESPONDING MAXIMUM  */ 07665000
*   /* FOR THE DEVICE, PREPARE TO RETURN TO THE CALLER WITH RC = 12  */ 07666000
*   /*                                                               */ 07667000
*   /*****************************************************************/ 07668000
*                                                                  1264 07669000
*   IF XTNHCHR1(1:4)^=XTNHCHR2(1:4) THEN                           1264 07670000
@RF01248 CLC   XTNHCHR1(4,XTNTPTR),XTNHCHR2(XTNTPTR)               1264 07671000
         BE    @RF01264                                            1264 07672000
*     DO;                                                          1265 07673000
*       IF XTNHCHR2(1:2)>DEVMAXCC|XTNHCHR2(3:4)>DEVMAXHH THEN      1266 07674000
         L     @04,DEVAREAP                                        1266 07675000
         CLC   XTNHCHR2(2,XTNTPTR),DEVMAXCC(@04)                   1266 07676000
         BH    @RT01266                                            1266 07677000
         CLC   XTNHCHR2+2(2,XTNTPTR),DEVMAXHH(@04)                 1266 07678000
         BNH   @RF01266                                            1266 07679000
@RT01266 DS    0H                                                  1267 07680000
*         DO;                                                      1267 07681000
*           IF ADDR(DISPL)^=NULLPTR|ADDR(COPY)^=NULLPTR THEN       1268 07682000
         SLR   @04,@04                                             1268 07683000
         L     @15,@PC00001+4                                      1268 07684000
         C     @04,FDTPTR(,@15)                                    1268 07685000
         BNE   @RT01268                                            1268 07686000
         C     @04,FDTPTR+136(,@15)                                1268 07687000
         BE    @RF01268                                            1268 07688000
@RT01268 DS    0H                                                  1269 07689000
*             PARMHOLD=DSRANGE;                                    1269 07690000
         MVC   PARMHOLD(17),@CC02833                               1269 07691000
*           ELSE                                                   1270 07692000
*             IF XTNHMODE=INPUT THEN                               1270 07693000
         B     @RC01268                                            1270 07694000
@RF01268 CLI   XTNHMODE(XTNTPTR),C'I'                              1270 07695000
         BNE   @RF01270                                            1270 07696000
*               PARMHOLD=INDSADD;                                  1271 07697000
         MVC   PARMHOLD(17),@CC02836                               1271 07698000
*             ELSE                                                 1272 07699000
*               PARMHOLD=OUTDSADD;                                 1272 07700000
*                                                                  1272 07701000
         B     @RC01270                                            1272 07702000
@RF01270 MVC   PARMHOLD(17),@CC02839                               1272 07703000
*           /*********************************************************/ 07704000
*           /*                                                       */ 07705000
*           /* WRITE ERROR MESSAGE IDC31234I                         */ 07706000
*           /*                                                       */ 07707000
*           /*********************************************************/ 07708000
*                                                                  1273 07709000
*           DO;                                                    1273 07710000
@RC01270 DS    0H                                                  1273 07711000
@RC01268 DS    0H                                                  1274 07712000
*             CKREQ=CKREQ&&CKREQ;                                  1274 07713000
         L     @04,@PC00001+8                                      1274 07714000
         XC    CKREQ(44,@04),CKREQ(@04)                            1274 07715000
*             CKRERN=MSG34;                                        1275 07716000
         MVC   CKRERN(2,@04),@CH02802                              1275 07717000
*             CKRMVAR(1)=ADDR(PARMHOLD);                           1276 07718000
         LA    @15,PARMHOLD                                        1276 07719000
         ST    @15,CKRMVAR(,@04)                                   1276 07720000
*             CKRMVAR(2)=ADDR(XTNHCHR2);                           1277 07721000
         LA    @15,XTNHCHR2(,XTNTPTR)                              1277 07722000
         ST    @15,CKRMVAR+4(,@04)                                 1277 07723000
*             CALL IDCRDER;                                        1278 07724000
         L     @15,@CV01553                                        1278 07725000
         BALR  @14,@15                                             1278 07726000
*           END;                                                   1279 07727000
*                                                                  1279 07728000
*           /*********************************************************/ 07729000
*           /*                                                       */ 07730000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 07731000
*           /*                                                       */ 07732000
*           /*********************************************************/ 07733000
*                                                                  1280 07734000
*           RETURN CODE(LASTCC12);                                 1280 07735000
         LA    @15,12                                              1280 07736000
         L     @14,@SA00002                                        1280 07737000
         LM    @00,@12,@SA00002+8                                  1280 07738000
         BR    @14                                                 1280 07739000
*         END;                                                     1281 07740000
*     END;                                                         1282 07741000
*                                                                  1282 07742000
@RF01266 DS    0H                                                  1283 07743000
*   /*****************************************************************/ 07744000
*   /*                                                               */ 07745000
*   /* CALCULATE REQUIRED BYTES FOR I/O BUFFER                       */ 07746000
*   /*                                                               */ 07747000
*   /*****************************************************************/ 07748000
*                                                                  1283 07749000
*   REQBYTES=DEVTC+LENGTH(RIOHDR);                                 1283 07750000
*                                                                  1283 07751000
@RF01264 LA    @04,282                                             1283 07752000
         L     @01,DEVAREAP                                        1283 07753000
         LH    @15,DEVTC(,@01)                                     1283 07754000
         N     @15,@CF03043                                        1283 07755000
         ALR   @04,@15                                             1283 07756000
         ST    @04,REQBYTES                                        1283 07757000
*   /*****************************************************************/ 07758000
*   /*                                                               */ 07759000
*   /* ISSUE UGPOOL                                                  */ 07760000
*   /*                                                               */ 07761000
*   /*****************************************************************/ 07762000
*                                                                  1284 07763000
*   CALL IDCSAGP0(GDTTBL,REQBYTES,REQADDR,RD01,SETZERO);           1284 07764000
*                                                                  1284 07765000
         L     @04,@PC00001                                        1284 07766000
         ST    @04,@AL00001                                        1284 07767000
         LA    @15,REQBYTES                                        1284 07768000
         ST    @15,@AL00001+4                                      1284 07769000
         LA    @15,REQADDR                                         1284 07770000
         ST    @15,@AL00001+8                                      1284 07771000
         LA    @15,@CC02759                                        1284 07772000
         ST    @15,@AL00001+12                                     1284 07773000
         LA    @15,SETZERO                                         1284 07774000
         ST    @15,@AL00001+16                                     1284 07775000
         MVI   @AL00001+16,X'80'                                   1284 07776000
         L     @15,GDTGPL(,@04)                                    1284 07777000
         LA    @01,@AL00001                                        1284 07778000
         BALR  @14,@15                                             1284 07779000
*   /*****************************************************************/ 07780000
*   /*                                                               */ 07781000
*   /* SAVE RETURN CODE FROM UGPOOL                                  */ 07782000
*   /*                                                               */ 07783000
*   /*****************************************************************/ 07784000
*                                                                  1285 07785000
*   RESPECIFY                                                      1285 07786000
*     RTNREG RSTD;                                                 1285 07787000
*   TESTRC=RTNREG;                                                 1286 07788000
         STH   RTNREG,TESTRC                                       1286 07789000
*   RESPECIFY                                                      1287 07790000
*     RTNREG UNRSTD;                                               1287 07791000
*                                                                  1287 07792000
*   /*****************************************************************/ 07793000
*   /*                                                               */ 07794000
*   /* IF UGPOOL FAILS, RETURN TO THE CALLER WITH RC = 12            */ 07795000
*   /*                                                               */ 07796000
*   /*****************************************************************/ 07797000
*                                                                  1288 07798000
*   IF TESTRC^=0 THEN                                              1288 07799000
         LH    @04,TESTRC                                          1288 07800000
         LTR   @04,@04                                             1288 07801000
         BZ    @RF01288                                            1288 07802000
*     RETURN CODE(LASTCC12);                                       1289 07803000
*                                                                  1289 07804000
         LA    @15,12                                              1289 07805000
         L     @14,@SA00002                                        1289 07806000
         LM    @00,@12,@SA00002+8                                  1289 07807000
         BR    @14                                                 1289 07808000
*   /*****************************************************************/ 07809000
*   /*                                                               */ 07810000
*   /* SET THE FIRST BYTE OF THE BUFFER AREA TO X'FF' TO INDICATE TO */ 07811000
*   /* UEXCP THAT THE AREA HAS NOT PREVIOUSLY BEEN USED              */ 07812000
*   /*                                                               */ 07813000
*   /*****************************************************************/ 07814000
*                                                                  1290 07815000
*   IF ADDR(MODIF)^=NULLPTR&XTNHMODE=OUTPUT THEN                   1290 07816000
@RF01288 L     @04,@PC00001+4                                      1290 07817000
         L     @04,FDTPTR+356(,@04)                                1290 07818000
         LTR   @04,@04                                             1290 07819000
         BZ    @RF01290                                            1290 07820000
         CLI   XTNHMODE(XTNTPTR),C'O'                              1290 07821000
         BNE   @RF01290                                            1290 07822000
*     DO;                                                          1291 07823000
*       REPOBFPT=REQADDR;                                          1292 07824000
         L     @15,@PC00001+8                                      1292 07825000
         L     @14,REQADDR                                         1292 07826000
         ST    @14,REPOBFPT(,@15)                                  1292 07827000
*       XTNTPTR2=REPOXTN2;                                         1293 07828000
         L     XTNTPTR2,REPOXTN2(,@15)                             1293 07829000
*     END;                                                         1294 07830000
*   ELSE                                                           1295 07831000
*     DO;                                                          1295 07832000
         B     @RC01290                                            1295 07833000
@RF01290 DS    0H                                                  1296 07834000
*       REPIBFPT=REQADDR;                                          1296 07835000
         L     @15,@PC00001+8                                      1296 07836000
         L     @14,REQADDR                                         1296 07837000
         ST    @14,REPIBFPT(,@15)                                  1296 07838000
*       XTNTPTR2=REPIXTN2;                                         1297 07839000
         L     XTNTPTR2,REPIXTN2(,@15)                             1297 07840000
*     END;                                                         1298 07841000
*   RESPECIFY                                                      1299 07842000
*     RIOAREA BASED(REQADDR);                                      1299 07843000
@RC01290 DS    0H                                                  1300 07844000
*   RFIRST='FF'X;                                                  1300 07845000
         L     @01,REQADDR                                         1300 07846000
         MVI   RFIRST(@01),X'FF'                                   1300 07847000
*                                                                  1301 07848000
*   /*****************************************************************/ 07849000
*   /*                                                               */ 07850000
*   /* PROCESSING A DATA SET: VTOC (OPENABLE)                        */ 07851000
*   /*                                                               */ 07852000
*   /*****************************************************************/ 07853000
*                                                                  1301 07854000
*   IF XTNHDSN=FMT4DSN THEN                                        1301 07855000
         CLC   XTNHDSN(44,XTNTPTR),FMT4DSN                         1301 07856000
         BNE   @RF01301                                            1301 07857000
*DSVTOC:                                                           1302 07858000
*     DO;                                                          1302 07859000
*                                                                  1302 07860000
DSVTOC   DS    0H                                                  1303 07861000
*       /*************************************************************/ 07862000
*       /*                                                           */ 07863000
*       /* SET TRACE POINTS                                          */ 07864000
*       /*                                                           */ 07865000
*       /*************************************************************/ 07866000
*                                                                  1303 07867000
*       OLDERID2=NEWERID2;                                         1303 07868000
         L     @04,@PC00001                                        1303 07869000
         L     @15,GDTTR2(,@04)                                    1303 07870000
         MVC   @TS00001(95),NEWERID2(@15)                          1303 07871000
         MVC   OLDERID2(95,@15),@TS00001                           1303 07872000
*       NEWID2='RD6L';                                             1304 07873000
*                                                                  1304 07874000
         MVC   NEWID2(4,@15),@CC02909                              1304 07875000
*       /*************************************************************/ 07876000
*       /*                                                           */ 07877000
*       /* FOR MODIFY OUTPUT PROCESSING, PROMPT THE CONSOLE OPERATOR */ 07878000
*       /* FOR AUTHROIZATION TO ACCESS VOLUME                        */ 07879000
*       /*                                                           */ 07880000
*       /*************************************************************/ 07881000
*                                                                  1305 07882000
*       IF ADDR(MODIF)^=NULLPTR&XTNHMODE=OUTPUT THEN               1305 07883000
         L     @15,@PC00001+4                                      1305 07884000
         L     @15,FDTPTR+356(,@15)                                1305 07885000
         LTR   @15,@15                                             1305 07886000
         BZ    @RF01305                                            1305 07887000
         CLI   XTNHMODE(XTNTPTR),C'O'                              1305 07888000
         BNE   @RF01305                                            1305 07889000
*         DO;                                                      1306 07890000
*                                                                  1306 07891000
*           /*********************************************************/ 07892000
*           /*                                                       */ 07893000
*           /* MOVE WTOR LIST FORM                                   */ 07894000
*           /*                                                       */ 07895000
*           /*********************************************************/ 07896000
*                                                                  1307 07897000
*           WTORLIST=LWTORLST;                                     1307 07898000
*                                                                  1307 07899000
         MVC   WTORLIST(84),LWTORLST                               1307 07900000
*           /*********************************************************/ 07901000
*           /*                                                       */ 07902000
*           /* SETUP DARGLIST TO LOAD MESSAGE IDC498D IF REQUEST IS  */ 07903000
*           /* FOR MODIFY OUTPUT                                     */ 07904000
*           /*                                                       */ 07905000
*           /*********************************************************/ 07906000
*                                                                  1308 07907000
*           DARGL=''B;                                             1308 07908000
         XC    DARGL(20),DARGL                                     1308 07909000
*           DDSTRU=ADDR(DARGL);                                    1309 07910000
         LA    @15,DARGL                                           1309 07911000
         ST    @15,DDSTRU                                          1309 07912000
*           DARGRETP=ADDR(WTORLIST)+12;                            1310 07913000
         LA    @14,WTORLIST                                        1310 07914000
         AL    @14,@CF00039                                        1310 07915000
         ST    @14,DARGRETP(,@15)                                  1310 07916000
*           DARGSENT=MSG79;                                        1311 07917000
         MVI   DARGSENT(@15),X'4F'                                 1311 07918000
*           DARGSMOD=WTORID;                                       1312 07919000
         MVC   DARGSMOD(3,@15),@CC02814                            1312 07920000
*           DARGRETL=LENGTH(WTORLIST)-12;                          1313 07921000
*                                                                  1313 07922000
         MVC   DARGRETL(2,@15),@CH00818                            1313 07923000
*           /*********************************************************/ 07924000
*           /*                                                       */ 07925000
*           /* ISSUE UPRINT TO LOAD IDC498D MESSAGE                  */ 07926000
*           /*                                                       */ 07927000
*           /*********************************************************/ 07928000
*                                                                  1314 07929000
*           CALL AMSTP011(GDTTBL,0,DDSTRU);                        1314 07930000
*                                                                  1314 07931000
         ST    @04,@AL00001                                        1314 07932000
         LA    @15,@CF00118                                        1314 07933000
         ST    @15,@AL00001+4                                      1314 07934000
         LA    @15,DDSTRU                                          1314 07935000
         ST    @15,@AL00001+8                                      1314 07936000
         MVI   @AL00001+8,X'80'                                    1314 07937000
         L     @15,GDTPRT(,@04)                                    1314 07938000
         LA    @01,@AL00001                                        1314 07939000
         BALR  @14,@15                                             1314 07940000
*           /*********************************************************/ 07941000
*           /*                                                       */ 07942000
*           /* SAVE RETURN CODE FROM UPRINT                          */ 07943000
*           /*                                                       */ 07944000
*           /*********************************************************/ 07945000
*                                                                  1315 07946000
*           RESPECIFY                                              1315 07947000
*             RTNREG RSTD;                                         1315 07948000
*           TESTRC=RTNREG;                                         1316 07949000
         STH   RTNREG,TESTRC                                       1316 07950000
*           RESPECIFY                                              1317 07951000
*             RTNREG UNRSTD;                                       1317 07952000
*                                                                  1317 07953000
*           /*********************************************************/ 07954000
*           /*                                                       */ 07955000
*           /* IF UPRINT FAILS, RETURN TO IDCRD05 WITH RC = 12       */ 07956000
*           /*                                                       */ 07957000
*           /*********************************************************/ 07958000
*                                                                  1318 07959000
*           IF TESTRC^=0 THEN                                      1318 07960000
         LH    @04,TESTRC                                          1318 07961000
         LTR   @04,@04                                             1318 07962000
         BZ    @RF01318                                            1318 07963000
*             RETURN CODE(LASTCC12);                               1319 07964000
*                                                                  1319 07965000
         LA    @15,12                                              1319 07966000
         L     @14,@SA00002                                        1319 07967000
         LM    @00,@12,@SA00002+8                                  1319 07968000
         BR    @14                                                 1319 07969000
*           /*********************************************************/ 07970000
*           /*                                                       */ 07971000
*           /* INSERT VOLSER OF VTOC OR DATA SET IN MESSAGE          */ 07972000
*           /*                                                       */ 07973000
*           /*********************************************************/ 07974000
*                                                                  1320 07975000
*           WTORLIST(56:61)=XTNHVOL;                               1320 07976000
*                                                                  1320 07977000
@RF01318 MVC   WTORLIST+55(6),XTNHVOL(XTNTPTR)                     1320 07978000
*           /*********************************************************/ 07979000
*           /*                                                       */ 07980000
*           /* PROMPT CONSOLE OPERATOR FOR AUTHORIZATION TO ACCESS   */ 07981000
*           /* VOLUME                                                */ 07982000
*           /*                                                       */ 07983000
*           /*********************************************************/ 07984000
*                                                                  1321 07985000
*           DO UNTIL(WTOREPLY=Y)|(WTOREPLY=N);                     1321 07986000
@DL01321 DS    0H                                                  1322 07987000
*             WTOREPLY=''B;                                        1322 07988000
         MVI   WTOREPLY,X'00'                                      1322 07989000
*             WTORECB=''B;                                         1323 07990000
         XC    WTORECB(4),WTORECB                                  1323 07991000
*             RESPECIFY                                            1324 07992000
*               REG3 RESTRICTED;                                   1324 07993000
*             REG3=ADDR(WTORLIST);                                 1325 07994000
         LA    REG3,WTORLIST                                       1325 07995000
*LWTOR3:                                                           1326 07996000
*             GEN;                                                 1326 07997000
LWTOR3   DS    0H                                                  1326 07998000
         WTOR  ,WTOREPLY,1,WTORECB,MF=(E,(3))                           07999000
         WAIT  ECB=WTORECB                                              08000000
         DOM   MSG=(1)                                                  08001000
*             RESPECIFY                                            1327 08002000
*               REG3 UNRESTRICTED;                                 1327 08003000
*           END;                                                   1328 08004000
*                                                                  1328 08005000
@DE01321 CLI   WTOREPLY,C'Y'                                       1328 08006000
         BE    @DC01321                                            1328 08007000
         CLI   WTOREPLY,C'N'                                       1328 08008000
         BNE   @DL01321                                            1328 08009000
@DC01321 DS    0H                                                  1329 08010000
*           /*********************************************************/ 08011000
*           /*                                                       */ 08012000
*           /* IF REPLY IS 'N', PREPARE TO RETURN TO IDCRD05 WITH RC */ 08013000
*           /* = 12                                                  */ 08014000
*           /*                                                       */ 08015000
*           /*********************************************************/ 08016000
*                                                                  1329 08017000
*           IF WTOREPLY=N THEN                                     1329 08018000
         CLI   WTOREPLY,C'N'                                       1329 08019000
         BNE   @RF01329                                            1329 08020000
*             DO;                                                  1330 08021000
*                                                                  1330 08022000
*               /*****************************************************/ 08023000
*               /*                                                   */ 08024000
*               /* WRITE ACCESS DENIAL MESSAGE IDC31206I             */ 08025000
*               /*                                                   */ 08026000
*               /*****************************************************/ 08027000
*                                                                  1331 08028000
*               DO;                                                1331 08029000
*                 CKREQ=CKREQ&&CKREQ;                              1332 08030000
         L     @04,@PC00001+8                                      1332 08031000
         XC    CKREQ(44,@04),CKREQ(@04)                            1332 08032000
*                 CKRERN=MSG06;                                    1333 08033000
         MVC   CKRERN(2,@04),@CH00035                              1333 08034000
*                 CKRMVAR(1)=ADDR(XTNHVOL);                        1334 08035000
         LA    @15,XTNHVOL(,XTNTPTR)                               1334 08036000
         ST    @15,CKRMVAR(,@04)                                   1334 08037000
*                 CALL IDCRDER;                                    1335 08038000
         L     @15,@CV01553                                        1335 08039000
         BALR  @14,@15                                             1335 08040000
*               END;                                               1336 08041000
*                                                                  1336 08042000
*               /*****************************************************/ 08043000
*               /*                                                   */ 08044000
*               /* RETURN TO THE CALLER WITH RC = 12                 */ 08045000
*               /*                                                   */ 08046000
*               /*****************************************************/ 08047000
*                                                                  1337 08048000
*               RETURN CODE(LASTCC12);                             1337 08049000
         LA    @15,12                                              1337 08050000
         L     @14,@SA00002                                        1337 08051000
         LM    @00,@12,@SA00002+8                                  1337 08052000
         BR    @14                                                 1337 08053000
*             END;                                                 1338 08054000
*                                                                  1338 08055000
*           /*********************************************************/ 08056000
*           /*                                                       */ 08057000
*           /* GET ADDRESS OF USYSINFO RETURN AREA                   */ 08058000
*           /*                                                       */ 08059000
*           /*********************************************************/ 08060000
*                                                                  1339 08061000
*           SINFPTR=REPOSYSI;                                      1339 08062000
*                                                                  1339 08063000
@RF01329 L     @04,@PC00001+8                                      1339 08064000
         L     @04,REPOSYSI(,@04)                                  1339 08065000
         ST    @04,SINFPTR                                         1339 08066000
*           /*********************************************************/ 08067000
*           /*                                                       */ 08068000
*           /* ISSUE USYSINFO TO GET UCB ADDRESS                     */ 08069000
*           /*                                                       */ 08070000
*           /*********************************************************/ 08071000
*                                                                  1340 08072000
*           CALL IDCSASI0(GDTTBL,UNIT,SINFPTR,XTNHDDN);            1340 08073000
*                                                                  1340 08074000
         L     @04,@PC00001                                        1340 08075000
         ST    @04,@AL00001                                        1340 08076000
         LA    @15,UNIT                                            1340 08077000
         ST    @15,@AL00001+4                                      1340 08078000
         LA    @15,SINFPTR                                         1340 08079000
         ST    @15,@AL00001+8                                      1340 08080000
         ST    XTNTPTR,@AL00001+12                                 1340 08081000
         MVI   @AL00001+12,X'80'                                   1340 08082000
         L     @15,GDTSFO(,@04)                                    1340 08083000
         LA    @01,@AL00001                                        1340 08084000
         BALR  @14,@15                                             1340 08085000
*           /*********************************************************/ 08086000
*           /*                                                       */ 08087000
*           /* SAVE RETURN CODE FROM USYSINFO                        */ 08088000
*           /*                                                       */ 08089000
*           /*********************************************************/ 08090000
*                                                                  1341 08091000
*           RESPECIFY                                              1341 08092000
*             RTNREG RSTD;                                         1341 08093000
*           TESTRC=RTNREG;                                         1342 08094000
         STH   RTNREG,TESTRC                                       1342 08095000
*           RESPECIFY                                              1343 08096000
*             RTNREG UNRSTD;                                       1343 08097000
*                                                                  1343 08098000
*           /*********************************************************/ 08099000
*           /*                                                       */ 08100000
*           /* IF USYSINFO FAILS, RETURN TO IDCRD05 WITH RC = 12     */ 08101000
*           /*                                                       */ 08102000
*           /*********************************************************/ 08103000
*                                                                  1344 08104000
*           IF TESTRC^=0 THEN                                      1344 08105000
         LH    @04,TESTRC                                          1344 08106000
         LTR   @04,@04                                             1344 08107000
         BZ    @RF01344                                            1344 08108000
*             RETURN CODE(LASTCC12);                               1345 08109000
*                                                                  1345 08110000
         LA    @15,12                                              1345 08111000
         L     @14,@SA00002                                        1345 08112000
         LM    @00,@12,@SA00002+8                                  1345 08113000
         BR    @14                                                 1345 08114000
*           /*********************************************************/ 08115000
*           /*                                                       */ 08116000
*           /* CONSTRUCT QNAME, RNAME LENGTH, AND RNAME              */ 08117000
*           /*                                                       */ 08118000
*           /*********************************************************/ 08119000
*                                                                  1346 08120000
*           SPQNAME=SYSVTOC;                                       1346 08121000
@RF01344 L     @04,@PC00001+8                                      1346 08122000
         L     @04,REPQRPTR(,@04)                                  1346 08123000
         MVC   SPQNAME(8,@04),@CC02747                             1346 08124000
*           SPRLEN=LENGTH(SPRVOL);                                 1347 08125000
         MVI   SPRLEN(@04),X'06'                                   1347 08126000
*           SPRVOL=XTNHVOL;                                        1348 08127000
*                                                                  1348 08128000
         MVC   SPRVOL(6,@04),XTNHVOL(XTNTPTR)                      1348 08129000
*           /*********************************************************/ 08130000
*           /*                                                       */ 08131000
*           /* ISSUE URESERVE TO RESERVE THE VTOC                    */ 08132000
*           /*                                                       */ 08133000
*           /*********************************************************/ 08134000
*                                                                  1349 08135000
*           CALL IDCSARV0(GDTTBL,EXCL,WAIT,SINFAREA,SPQNAME,SPRNAME);   08136000
*                                                                  1349 08137000
         L     @15,@PC00001                                        1349 08138000
         ST    @15,@AL00001                                        1349 08139000
         LA    @14,EXCL                                            1349 08140000
         ST    @14,@AL00001+4                                      1349 08141000
         LA    @14,WAIT                                            1349 08142000
         ST    @14,@AL00001+8                                      1349 08143000
         L     @01,SINFPTR                                         1349 08144000
         ST    @01,@AL00001+12                                     1349 08145000
         ST    @04,@AL00001+16                                     1349 08146000
         LA    @04,SPRNAME(,@04)                                   1349 08147000
         ST    @04,@AL00001+20                                     1349 08148000
         MVI   @AL00001+20,X'80'                                   1349 08149000
         L     @15,GDTRSV(,@15)                                    1349 08150000
         LA    @01,@AL00001                                        1349 08151000
         BALR  @14,@15                                             1349 08152000
*           /*********************************************************/ 08153000
*           /*                                                       */ 08154000
*           /* SAVE THE RETURN CODE FROM URESERVE                    */ 08155000
*           /*                                                       */ 08156000
*           /*********************************************************/ 08157000
*                                                                  1350 08158000
*           RESPECIFY                                              1350 08159000
*             RTNREG RSTD;                                         1350 08160000
*           TESTRC=RTNREG;                                         1351 08161000
         STH   RTNREG,TESTRC                                       1351 08162000
*           RESPECIFY                                              1352 08163000
*             RTNREG UNRSTD;                                       1352 08164000
*                                                                  1352 08165000
*           /*********************************************************/ 08166000
*           /*                                                       */ 08167000
*           /* IF URESERVE FAILS, RETURN TO IDCRD05 WITH RC = 12     */ 08168000
*           /*                                                       */ 08169000
*           /*********************************************************/ 08170000
*                                                                  1353 08171000
*           IF TESTRC^=0 THEN                                      1353 08172000
         LH    @04,TESTRC                                          1353 08173000
         LTR   @04,@04                                             1353 08174000
         BZ    @RF01353                                            1353 08175000
*             RETURN CODE(LASTCC12);                               1354 08176000
*                                                                  1354 08177000
         LA    @15,12                                              1354 08178000
         L     @14,@SA00002                                        1354 08179000
         LM    @00,@12,@SA00002+8                                  1354 08180000
         BR    @14                                                 1354 08181000
*           /*********************************************************/ 08182000
*           /*                                                       */ 08183000
*           /* SET MODIFY ENQ INDICATOR                              */ 08184000
*           /*                                                       */ 08185000
*           /*********************************************************/ 08186000
*                                                                  1355 08187000
*           REPENQSW=MODENQ;                                       1355 08188000
@RF01353 L     @04,@PC00001+8                                      1355 08189000
         MVI   REPENQSW(@04),X'80'                                 1355 08190000
*         END;                                                     1356 08191000
*                                                                  1356 08192000
*       /*************************************************************/ 08193000
*       /*                                                           */ 08194000
*       /* CONSTRUCT THE OPEN ARGUMENT LIST (OPNAGL)                 */ 08195000
*       /*                                                           */ 08196000
*       /*************************************************************/ 08197000
*                                                                  1357 08198000
*       OPNPTR=REPOPAGL;                                           1357 08199000
@RF01305 L     @04,@PC00001+8                                      1357 08200000
         L     OPNPTR,REPOPAGL(,@04)                               1357 08201000
*       OPNAGL=''B;                                                1358 08202000
         XC    OPNAGL(48,OPNPTR),OPNAGL(OPNPTR)                    1358 08203000
*       OPNIOC=ADDR(REPCDSOP);                                     1359 08204000
         LA    @04,REPCDSOP(,@04)                                  1359 08205000
         ST    @04,OPNIOC(,OPNPTR)                                 1359 08206000
*       OPNOPTIN=ON;                                               1360 08207000
         OI    OPNOPTIN(OPNPTR),B'10000000'                        1360 08208000
*       OPNDSOPS=ON;                                               1361 08209000
         OI    OPNDSOPS(OPNPTR),B'01000000'                        1361 08210000
*       OPNOPTBK=ON;                                               1362 08211000
         OI    OPNOPTBK(OPNPTR),B'00010000'                        1362 08212000
*       OPNOPTJM=ON;                                               1363 08213000
         OI    OPNOPTJM(OPNPTR),B'00100000'                        1363 08214000
*       OPNDDN=ADDR(XTNHDDN);                                      1364 08215000
         ST    XTNTPTR,OPNDDN(,OPNPTR)                             1364 08216000
*       OPNDSN=ADDR(XTNHDSN);                                      1365 08217000
         LA    @04,XTNHDSN(,XTNTPTR)                               1365 08218000
         ST    @04,OPNDSN(,OPNPTR)                                 1365 08219000
*       OPNBLK=VTOCRECL;                                           1366 08220000
         MVC   OPNBLK(4,OPNPTR),@CF00886                           1366 08221000
*       OPNKYL=VTOCKEYL;                                           1367 08222000
         MVI   OPNKYL(OPNPTR),X'2C'                                1367 08223000
*       OPNVOL=ADDR(XTNHVOLN);                                     1368 08224000
*                                                                  1368 08225000
         LA    @04,XTNHVOLN(,XTNTPTR)                              1368 08226000
         ST    @04,OPNVOL(,OPNPTR)                                 1368 08227000
*       /*************************************************************/ 08228000
*       /*                                                           */ 08229000
*       /* ISSUE UOPEN                                               */ 08230000
*       /*                                                           */ 08231000
*       /*************************************************************/ 08232000
*                                                                  1369 08233000
*       CALL IDCIOOP0(GDTTBL,OPNAGL);                              1369 08234000
*                                                                  1369 08235000
         L     @04,@PC00001                                        1369 08236000
         ST    @04,@AL00001                                        1369 08237000
         ST    OPNPTR,@AL00001+4                                   1369 08238000
         MVI   @AL00001+4,X'80'                                    1369 08239000
         L     @15,GDTOPN(,@04)                                    1369 08240000
         LA    @01,@AL00001                                        1369 08241000
         BALR  @14,@15                                             1369 08242000
*       /*************************************************************/ 08243000
*       /*                                                           */ 08244000
*       /* SAVE THE RETURN CODE FROM UOPEN                           */ 08245000
*       /*                                                           */ 08246000
*       /*************************************************************/ 08247000
*                                                                  1370 08248000
*       RESPECIFY                                                  1370 08249000
*         RTNREG RSTD;                                             1370 08250000
*       TESTRC=RTNREG;                                             1371 08251000
         STH   RTNREG,TESTRC                                       1371 08252000
*       RESPECIFY                                                  1372 08253000
*         RTNREG UNRSTD;                                           1372 08254000
*                                                                  1372 08255000
*       /*************************************************************/ 08256000
*       /*                                                           */ 08257000
*       /* IF UOPEN FAILS, PREPARE TO RETURN TO THE CALLER WITH RC = */ 08258000
*       /* 12                                                        */ 08259000
*       /*                                                           */ 08260000
*       /*************************************************************/ 08261000
*                                                                  1373 08262000
*       IF TESTRC^=0 THEN                                          1373 08263000
         LH    @04,TESTRC                                          1373 08264000
         SLR   @15,@15                                             1373 08265000
         CR    @04,@15                                             1373 08266000
         BE    @RF01373                                            1373 08267000
*         DO;                                                      1374 08268000
*                                                                  1374 08269000
*           /*********************************************************/ 08270000
*           /*                                                       */ 08271000
*           /* IF MODIFY OUTPUT, DEQ THE VTOC                        */ 08272000
*           /*                                                       */ 08273000
*           /*********************************************************/ 08274000
*                                                                  1375 08275000
*           IF ADDR(MODIF)^=NULLPTR&XTNHMODE=OUTPUT THEN           1375 08276000
         L     @04,@PC00001+4                                      1375 08277000
         C     @15,FDTPTR+356(,@04)                                1375 08278000
         BE    @RF01375                                            1375 08279000
         CLI   XTNHMODE(XTNTPTR),C'O'                              1375 08280000
         BNE   @RF01375                                            1375 08281000
*             CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);               1376 08282000
*                                                                  1376 08283000
         L     @15,@PC00001                                        1376 08284000
         ST    @15,@AL00001                                        1376 08285000
         L     @14,@PC00001+8                                      1376 08286000
         L     @14,REPQRPTR(,@14)                                  1376 08287000
         ST    @14,@AL00001+4                                      1376 08288000
         LA    @14,SPRNAME(,@14)                                   1376 08289000
         ST    @14,@AL00001+8                                      1376 08290000
         MVI   @AL00001+8,X'80'                                    1376 08291000
         L     @15,GDTDEQ(,@15)                                    1376 08292000
         LA    @01,@AL00001                                        1376 08293000
         BALR  @14,@15                                             1376 08294000
*           /*********************************************************/ 08295000
*           /*                                                       */ 08296000
*           /* FREE THE BUFFERS                                      */ 08297000
*           /*                                                       */ 08298000
*           /*********************************************************/ 08299000
*                                                                  1377 08300000
*           CALL IDCSAFP0(GDTTBL,RD01,ALL);                        1377 08301000
*                                                                  1377 08302000
@RF01375 MVC   @AL00001+4(8),@AL01377                              1377 08303000
         L     @15,@PC00001                                        1377 08304000
         ST    @15,@AL00001                                        1377 08305000
         L     @15,GDTFPL(,@15)                                    1377 08306000
         LA    @01,@AL00001                                        1377 08307000
         BALR  @14,@15                                             1377 08308000
*           /*********************************************************/ 08309000
*           /*                                                       */ 08310000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 08311000
*           /*                                                       */ 08312000
*           /*********************************************************/ 08313000
*                                                                  1378 08314000
*           RETURN CODE(LASTCC12);                                 1378 08315000
         LA    @15,12                                              1378 08316000
         L     @14,@SA00002                                        1378 08317000
         LM    @00,@12,@SA00002+8                                  1378 08318000
         BR    @14                                                 1378 08319000
*         END;                                                     1379 08320000
*                                                                  1379 08321000
*       /*************************************************************/ 08322000
*       /*                                                           */ 08323000
*       /* ISSUE UGET FOR FIRST RECORD IN THE VTOC FIRST RECORD IS   */ 08324000
*       /* FORMAT 4 DSCB                                             */ 08325000
*       /*                                                           */ 08326000
*       /*************************************************************/ 08327000
*                                                                  1380 08328000
*       CALL IDCIOGT0(GDTTBL,REPCDSOP);                            1380 08329000
*                                                                  1380 08330000
@RF01373 L     @04,@PC00001                                        1380 08331000
         ST    @04,@AL00001                                        1380 08332000
         L     @15,@PC00001+8                                      1380 08333000
         LA    @15,REPCDSOP(,@15)                                  1380 08334000
         ST    @15,@AL00001+4                                      1380 08335000
         MVI   @AL00001+4,X'80'                                    1380 08336000
         L     @15,GDTGET(,@04)                                    1380 08337000
         LA    @01,@AL00001                                        1380 08338000
         BALR  @14,@15                                             1380 08339000
*       /*************************************************************/ 08340000
*       /*                                                           */ 08341000
*       /* SAVE RETURN CODE FROM UGET                                */ 08342000
*       /*                                                           */ 08343000
*       /*************************************************************/ 08344000
*                                                                  1381 08345000
*       RESPECIFY                                                  1381 08346000
*         RTNREG RSTD;                                             1381 08347000
*       TESTRC=RTNREG;                                             1382 08348000
         STH   RTNREG,TESTRC                                       1382 08349000
*       RESPECIFY                                                  1383 08350000
*         RTNREG UNRSTD;                                           1383 08351000
*                                                                  1383 08352000
*       /*************************************************************/ 08353000
*       /*                                                           */ 08354000
*       /* IF UGET FAILS, PREPARE TO RETURN TO THE CALLER WITH RC =  */ 08355000
*       /* 12                                                        */ 08356000
*       /*                                                           */ 08357000
*       /*************************************************************/ 08358000
*                                                                  1384 08359000
*       IF TESTRC^=0 THEN                                          1384 08360000
         LH    @04,TESTRC                                          1384 08361000
         LTR   @04,@04                                             1384 08362000
         BZ    @RF01384                                            1384 08363000
*         DO;                                                      1385 08364000
*                                                                  1385 08365000
*           /*********************************************************/ 08366000
*           /*                                                       */ 08367000
*           /* CLOSE THE VTOC                                        */ 08368000
*           /*                                                       */ 08369000
*           /*********************************************************/ 08370000
*                                                                  1386 08371000
*           CALL IDCIOCL0(GDTTBL,REPCDSOP);                        1386 08372000
*                                                                  1386 08373000
         L     @04,@PC00001                                        1386 08374000
         ST    @04,@AL00001                                        1386 08375000
         L     @15,@PC00001+8                                      1386 08376000
         LA    @15,REPCDSOP(,@15)                                  1386 08377000
         ST    @15,@AL00001+4                                      1386 08378000
         MVI   @AL00001+4,X'80'                                    1386 08379000
         L     @15,GDTCLS(,@04)                                    1386 08380000
         LA    @01,@AL00001                                        1386 08381000
         BALR  @14,@15                                             1386 08382000
*           /*********************************************************/ 08383000
*           /*                                                       */ 08384000
*           /* IF MODIFY OUTPUT, DEQ THE VTOC                        */ 08385000
*           /*                                                       */ 08386000
*           /*********************************************************/ 08387000
*                                                                  1387 08388000
*           IF ADDR(MODIF)^=NULLPTR&XTNHMODE=OUTPUT THEN           1387 08389000
         L     @04,@PC00001+4                                      1387 08390000
         L     @04,FDTPTR+356(,@04)                                1387 08391000
         LTR   @04,@04                                             1387 08392000
         BZ    @RF01387                                            1387 08393000
         CLI   XTNHMODE(XTNTPTR),C'O'                              1387 08394000
         BNE   @RF01387                                            1387 08395000
*             CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);               1388 08396000
*                                                                  1388 08397000
         L     @15,@PC00001                                        1388 08398000
         ST    @15,@AL00001                                        1388 08399000
         L     @14,@PC00001+8                                      1388 08400000
         L     @14,REPQRPTR(,@14)                                  1388 08401000
         ST    @14,@AL00001+4                                      1388 08402000
         LA    @14,SPRNAME(,@14)                                   1388 08403000
         ST    @14,@AL00001+8                                      1388 08404000
         MVI   @AL00001+8,X'80'                                    1388 08405000
         L     @15,GDTDEQ(,@15)                                    1388 08406000
         LA    @01,@AL00001                                        1388 08407000
         BALR  @14,@15                                             1388 08408000
*           /*********************************************************/ 08409000
*           /*                                                       */ 08410000
*           /* FREE THE BUFFERS                                      */ 08411000
*           /*                                                       */ 08412000
*           /*********************************************************/ 08413000
*                                                                  1389 08414000
*           CALL IDCSAFP0(GDTTBL,RD01,ALL);                        1389 08415000
*                                                                  1389 08416000
@RF01387 MVC   @AL00001+4(8),@AL01389                              1389 08417000
         L     @15,@PC00001                                        1389 08418000
         ST    @15,@AL00001                                        1389 08419000
         L     @15,GDTFPL(,@15)                                    1389 08420000
         LA    @01,@AL00001                                        1389 08421000
         BALR  @14,@15                                             1389 08422000
*           /*********************************************************/ 08423000
*           /*                                                       */ 08424000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 08425000
*           /*                                                       */ 08426000
*           /*********************************************************/ 08427000
*                                                                  1390 08428000
*           RETURN CODE(LASTCC12);                                 1390 08429000
         LA    @15,12                                              1390 08430000
         L     @14,@SA00002                                        1390 08431000
         LM    @00,@12,@SA00002+8                                  1390 08432000
         BR    @14                                                 1390 08433000
*         END;                                                     1391 08434000
*                                                                  1391 08435000
*       /*************************************************************/ 08436000
*       /*                                                           */ 08437000
*       /* UGET WAS SUCCESSFUL. SET-UP FORMAT 4 DSCB ADDRESSABILITY  */ 08438000
*       /*                                                           */ 08439000
*       /*************************************************************/ 08440000
*                                                                  1392 08441000
*       IOCSPTR=REPCDSOP;                                          1392 08442000
@RF01384 L     @04,@PC00001+8                                      1392 08443000
         L     @03,REPCDSOP(,@04)                                  1392 08444000
         ST    @03,IOCSPTR                                         1392 08445000
*       F4PTR=IOCDAD+VTOCKEYL;                                     1393 08446000
*                                                                  1393 08447000
         LA    F4PTR,44                                            1393 08448000
         AL    F4PTR,IOCDAD(,@03)                                  1393 08449000
*       /*************************************************************/ 08450000
*       /*                                                           */ 08451000
*       /* CONSTRUCT THE EXTENT TABLE ENTRY FOR THE VTOC INITIALIZE  */ 08452000
*       /* INDEX                                                     */ 08453000
*       /*                                                           */ 08454000
*       /*************************************************************/ 08455000
*                                                                  1394 08456000
*       I=1;                                                       1394 08457000
*                                                                  1394 08458000
         LA    @03,1                                               1394 08459000
         STC   @03,I(,@04)                                         1394 08460000
*       /*************************************************************/ 08461000
*       /*                                                           */ 08462000
*       /* IF THE VTOC STARTING ADDRESS (CCHH) IS GREATER THAN THE   */ 08463000
*       /* USER-SUPPLIED STARTING ADDRESS, USE THE VTOC STARTING     */ 08464000
*       /* ADDRESS                                                   */ 08465000
*       /*                                                           */ 08466000
*       /*************************************************************/ 08467000
*                                                                  1395 08468000
*       IF DS4VTOCE(3:6)>XTNHCHR1(1:4) THEN                        1395 08469000
         CLC   DS4VTOCE+2(4,F4PTR),XTNHCHR1(XTNTPTR)               1395 08470000
         BNH   @RF01395                                            1395 08471000
*         DO;                                                      1396 08472000
*           XTNTCHR1(I,1:4)=DS4VTOCE(3:6);                         1397 08473000
         MH    @03,@CH02809                                        1397 08474000
         ST    @03,@TF00001                                        1397 08475000
         ALR   @03,XTNTPTR                                         1397 08476000
         MVC   XTNTCHR1-78(4,@03),DS4VTOCE+2(F4PTR)                1397 08477000
*           XTNTCHR1(I,5:5)='00'X;                                 1398 08478000
         LR    @04,XTNTPTR                                         1398 08479000
         AL    @04,@TF00001                                        1398 08480000
         MVI   XTNTCHR1-74(@04),X'00'                              1398 08481000
*         END;                                                     1399 08482000
*                                                                  1399 08483000
*       /*************************************************************/ 08484000
*       /*                                                           */ 08485000
*       /* OTHERWISE, USE THE USER'S STARTING ADDRESS.               */ 08486000
*       /*                                                           */ 08487000
*       /*************************************************************/ 08488000
*                                                                  1400 08489000
*       ELSE                                                       1400 08490000
*         XTNTCHR1(I)=XTNHCHR1;                                    1400 08491000
*                                                                  1400 08492000
         B     @RC01395                                            1400 08493000
@RF01395 L     @04,@PC00001+8                                      1400 08494000
         SLR   @03,@03                                             1400 08495000
         IC    @03,I(,@04)                                         1400 08496000
         MH    @03,@CH02809                                        1400 08497000
         ALR   @03,XTNTPTR                                         1400 08498000
         MVC   XTNTCHR1-78(5,@03),XTNHCHR1(XTNTPTR)                1400 08499000
*       /*************************************************************/ 08500000
*       /*                                                           */ 08501000
*       /* IF THE VTOC ENDING ADDRESS (CCHH) IS LESS THAN THE        */ 08502000
*       /* USER-SUPPLIED ENDING ADDRESS, USE THE VTOC ENDING ADDRESS */ 08503000
*       /*                                                           */ 08504000
*       /*************************************************************/ 08505000
*                                                                  1401 08506000
*       IF DS4VTOCE(7:10)<XTNHCHR2(1:4) THEN                       1401 08507000
@RC01395 CLC   DS4VTOCE+6(4,F4PTR),XTNHCHR2(XTNTPTR)               1401 08508000
         BNL   @RF01401                                            1401 08509000
*         DO;                                                      1402 08510000
*           XTNTCHR2(I,1:4)=DS4VTOCE(7:10);                        1403 08511000
         L     @04,@PC00001+8                                      1403 08512000
         SLR   @03,@03                                             1403 08513000
         IC    @03,I(,@04)                                         1403 08514000
         MH    @03,@CH02809                                        1403 08515000
         ST    @03,@TF00001                                        1403 08516000
         ALR   @03,XTNTPTR                                         1403 08517000
         MVC   XTNTCHR2-78(4,@03),DS4VTOCE+6(F4PTR)                1403 08518000
*           XTNTCHR2(I,5:5)='FF'X;                                 1404 08519000
         LR    @04,XTNTPTR                                         1404 08520000
         AL    @04,@TF00001                                        1404 08521000
         MVI   XTNTCHR2-74(@04),X'FF'                              1404 08522000
*         END;                                                     1405 08523000
*                                                                  1405 08524000
*       /*************************************************************/ 08525000
*       /*                                                           */ 08526000
*       /* OTHERWISE, USE THE USER'S ENDING ADDRESS.                 */ 08527000
*       /*                                                           */ 08528000
*       /*************************************************************/ 08529000
*                                                                  1406 08530000
*       ELSE                                                       1406 08531000
*         XTNTCHR2(I)=XTNHCHR2;                                    1406 08532000
*                                                                  1406 08533000
         B     @RC01401                                            1406 08534000
@RF01401 L     @04,@PC00001+8                                      1406 08535000
         SLR   @15,@15                                             1406 08536000
         IC    @15,I(,@04)                                         1406 08537000
         MH    @15,@CH02809                                        1406 08538000
         ALR   @15,XTNTPTR                                         1406 08539000
         MVC   XTNTCHR2-78(5,@15),XTNHCHR2(XTNTPTR)                1406 08540000
*       /*************************************************************/ 08541000
*       /*                                                           */ 08542000
*       /* CLOSE THE VTOC                                            */ 08543000
*       /*                                                           */ 08544000
*       /*************************************************************/ 08545000
*                                                                  1407 08546000
*       CALL IDCIOCL0(GDTTBL,REPCDSOP);                            1407 08547000
*                                                                  1407 08548000
@RC01401 L     @04,@PC00001                                        1407 08549000
         ST    @04,@AL00001                                        1407 08550000
         L     @15,@PC00001+8                                      1407 08551000
         LA    @15,REPCDSOP(,@15)                                  1407 08552000
         ST    @15,@AL00001+4                                      1407 08553000
         MVI   @AL00001+4,X'80'                                    1407 08554000
         L     @15,GDTCLS(,@04)                                    1407 08555000
         LA    @01,@AL00001                                        1407 08556000
         BALR  @14,@15                                             1407 08557000
*       /*************************************************************/ 08558000
*       /*                                                           */ 08559000
*       /* IF AN INVALID ENTRY WAS MADE IN THE EXTENT TABLE, (USER   */ 08560000
*       /* SUPPLIED RANGE NOT WITHIN EXTENTS OF VTOC), PREPARE TO    */ 08561000
*       /* RETURN TO THE CALLER WITH RC = 12                         */ 08562000
*       /*                                                           */ 08563000
*       /*************************************************************/ 08564000
*                                                                  1408 08565000
*       IF XTNHCHR1(1:4)>XTNTCHR2(I,1:4)|XTNHCHR2(1:4)<XTNTCHR1(I,1:4)  08566000
*         THEN                                                     1408 08567000
         L     @04,@PC00001+8                                      1408 08568000
         SLR   @15,@15                                             1408 08569000
         IC    @15,I(,@04)                                         1408 08570000
         MH    @15,@CH02809                                        1408 08571000
         ST    @15,@TF00001                                        1408 08572000
         ALR   @15,XTNTPTR                                         1408 08573000
         CLC   XTNHCHR1(4,XTNTPTR),XTNTCHR2-78(@15)                1408 08574000
         BH    @RT01408                                            1408 08575000
         LR    @04,XTNTPTR                                         1408 08576000
         AL    @04,@TF00001                                        1408 08577000
         CLC   XTNHCHR2(4,XTNTPTR),XTNTCHR1-78(@04)                1408 08578000
         BNL   @RF01408                                            1408 08579000
@RT01408 DS    0H                                                  1409 08580000
*         DO;                                                      1409 08581000
*           IF ADDR(MODIF)^=NULLPTR&IOPARM=OUTPUT THEN             1410 08582000
         L     @04,@PC00001+4                                      1410 08583000
         L     @04,FDTPTR+356(,@04)                                1410 08584000
         LTR   @04,@04                                             1410 08585000
         BZ    @RF01410                                            1410 08586000
         L     @04,@PC00002                                        1410 08587000
         CLI   IOPARM(@04),C'O'                                    1410 08588000
         BNE   @RF01410                                            1410 08589000
*             DO;                                                  1411 08590000
*                                                                  1411 08591000
*               /*****************************************************/ 08592000
*               /*                                                   */ 08593000
*               /* DEQ THE VTOC                                      */ 08594000
*               /*                                                   */ 08595000
*               /*****************************************************/ 08596000
*                                                                  1412 08597000
*               CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);             1412 08598000
*                                                                  1412 08599000
         L     @04,@PC00001                                        1412 08600000
         ST    @04,@AL00001                                        1412 08601000
         L     @15,@PC00001+8                                      1412 08602000
         L     @15,REPQRPTR(,@15)                                  1412 08603000
         ST    @15,@AL00001+4                                      1412 08604000
         LA    @15,SPRNAME(,@15)                                   1412 08605000
         ST    @15,@AL00001+8                                      1412 08606000
         MVI   @AL00001+8,X'80'                                    1412 08607000
         L     @15,GDTDEQ(,@04)                                    1412 08608000
         LA    @01,@AL00001                                        1412 08609000
         BALR  @14,@15                                             1412 08610000
*               /*****************************************************/ 08611000
*               /*                                                   */ 08612000
*               /* WRITE ERROR MESSAGE IDC31240I                     */ 08613000
*               /*                                                   */ 08614000
*               /*****************************************************/ 08615000
*                                                                  1413 08616000
*               DO;                                                1413 08617000
*                 CKREQ=CKREQ&&CKREQ;                              1414 08618000
         L     @04,@PC00001+8                                      1414 08619000
         XC    CKREQ(44,@04),CKREQ(@04)                            1414 08620000
*                 CKRERN=MSG40;                                    1415 08621000
         MVC   CKRERN(2,@04),@CH00732                              1415 08622000
*                 CKRMVAR(1)=ADDR(XTNHCHR2);                       1416 08623000
         LA    @15,XTNHCHR2(,XTNTPTR)                              1416 08624000
         ST    @15,CKRMVAR(,@04)                                   1416 08625000
*                 CALL IDCRDER;                                    1417 08626000
         L     @15,@CV01553                                        1417 08627000
         BALR  @14,@15                                             1417 08628000
*               END;                                               1418 08629000
*             END;                                                 1419 08630000
*           ELSE                                                   1420 08631000
*             IF ADDR(MODIF)^=NULLPTR&IOPARM=INPUT THEN            1420 08632000
*                                                                  1420 08633000
         B     @RC01410                                            1420 08634000
@RF01410 L     @04,@PC00001+4                                      1420 08635000
         L     @04,FDTPTR+356(,@04)                                1420 08636000
         LTR   @04,@04                                             1420 08637000
         BZ    @RF01420                                            1420 08638000
         L     @04,@PC00002                                        1420 08639000
         CLI   IOPARM(@04),C'I'                                    1420 08640000
         BNE   @RF01420                                            1420 08641000
*               /*****************************************************/ 08642000
*               /*                                                   */ 08643000
*               /* WRITE ERROR MESSAGE IDC31221I                     */ 08644000
*               /*                                                   */ 08645000
*               /*****************************************************/ 08646000
*                                                                  1421 08647000
*               DO;                                                1421 08648000
*                 CKREQ=CKREQ&&CKREQ;                              1422 08649000
         L     @04,@PC00001+8                                      1422 08650000
         XC    CKREQ(44,@04),CKREQ(@04)                            1422 08651000
*                 CKRERN=MSG21;                                    1423 08652000
         MVC   CKRERN(2,@04),@CH00651                              1423 08653000
*                 CKRMVAR(1)=ADDR(XTNHVOL);                        1424 08654000
         LA    @15,XTNHVOL(,XTNTPTR)                               1424 08655000
         ST    @15,CKRMVAR(,@04)                                   1424 08656000
*                 CKRMVAR(2)=ADDR(XTNHCHR1);                       1425 08657000
         LA    @15,XTNHCHR1(,XTNTPTR)                              1425 08658000
         ST    @15,CKRMVAR+4(,@04)                                 1425 08659000
*                 CKRMVAR(3)=ADDR(FMT4DSCB);                       1426 08660000
         LA    @05,FMT4DSCB                                        1426 08661000
         ST    @05,CKRMVAR+8(,@04)                                 1426 08662000
*                 CALL IDCRDER;                                    1427 08663000
         L     @15,@CV01553                                        1427 08664000
         BALR  @14,@15                                             1427 08665000
*               END;                                               1428 08666000
*             ELSE                                                 1429 08667000
*                                                                  1429 08668000
*               /*****************************************************/ 08669000
*               /*                                                   */ 08670000
*               /* WRITE ERROR MESSAGE IDC31212I                     */ 08671000
*               /*                                                   */ 08672000
*               /*****************************************************/ 08673000
*                                                                  1429 08674000
*               DO;                                                1429 08675000
         B     @RC01420                                            1429 08676000
@RF01420 DS    0H                                                  1430 08677000
*                 CKREQ=CKREQ&&CKREQ;                              1430 08678000
         L     @04,@PC00001+8                                      1430 08679000
         XC    CKREQ(44,@04),CKREQ(@04)                            1430 08680000
*                 CKRERN=MSG12;                                    1431 08681000
         MVC   CKRERN(2,@04),@CH00039                              1431 08682000
*                 CKRMVAR(1)=ADDR(XTNHCHR1);                       1432 08683000
         LA    @15,XTNHCHR1(,XTNTPTR)                              1432 08684000
         ST    @15,CKRMVAR(,@04)                                   1432 08685000
*                 CKRMVAR(2)=ADDR(XTNHCHR2);                       1433 08686000
         LA    @15,XTNHCHR2(,XTNTPTR)                              1433 08687000
         ST    @15,CKRMVAR+4(,@04)                                 1433 08688000
*                 CKRMVAR(3)=ADDR(FMT4DSCB);                       1434 08689000
         LA    @05,FMT4DSCB                                        1434 08690000
         ST    @05,CKRMVAR+8(,@04)                                 1434 08691000
*                 CALL IDCRDER;                                    1435 08692000
         L     @15,@CV01553                                        1435 08693000
         BALR  @14,@15                                             1435 08694000
*               END;                                               1436 08695000
*                                                                  1436 08696000
*           /*********************************************************/ 08697000
*           /*                                                       */ 08698000
*           /* FREE THE BUFFERS                                      */ 08699000
*           /*                                                       */ 08700000
*           /*********************************************************/ 08701000
*                                                                  1437 08702000
*           CALL IDCSAFP0(GDTTBL,RD01,ALL);                        1437 08703000
*                                                                  1437 08704000
@RC01420 DS    0H                                                  1437 08705000
@RC01410 MVC   @AL00001+4(8),@AL01437                              1437 08706000
         L     @15,@PC00001                                        1437 08707000
         ST    @15,@AL00001                                        1437 08708000
         L     @15,GDTFPL(,@15)                                    1437 08709000
         LA    @01,@AL00001                                        1437 08710000
         BALR  @14,@15                                             1437 08711000
*           /*********************************************************/ 08712000
*           /*                                                       */ 08713000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 08714000
*           /*                                                       */ 08715000
*           /*********************************************************/ 08716000
*                                                                  1438 08717000
*           RETURN CODE(LASTCC12);                                 1438 08718000
         LA    @15,12                                              1438 08719000
         L     @14,@SA00002                                        1438 08720000
         LM    @00,@12,@SA00002+8                                  1438 08721000
         BR    @14                                                 1438 08722000
*         END;                                                     1439 08723000
*                                                                  1439 08724000
*       /*************************************************************/ 08725000
*       /*                                                           */ 08726000
*       /* THE USER-SUPPLIED RANGE IS VALIDATED, CONSTRUCT THE EXTENT*/ 08727000
*       /* TABLE ENTRY                                               */ 08728000
*       /*                                                           */ 08729000
*       /*************************************************************/ 08730000
*                                                                  1440 08731000
*       XTNTDDN(I)=XTNHDDN;                                        1440 08732000
@RF01408 LA    @04,78                                              1440 08733000
         L     @15,@PC00001+8                                      1440 08734000
         SLR   @14,@14                                             1440 08735000
         IC    @14,I(,@15)                                         1440 08736000
         LR    @01,@14                                             1440 08737000
         MR    @00,@04                                             1440 08738000
         ST    @01,@TF00001                                        1440 08739000
         ALR   @01,XTNTPTR                                         1440 08740000
         MVC   XTNTDDN-78(8,@01),XTNHDDN(XTNTPTR)                  1440 08741000
*       XTNTDSN(I)=XTNHDSN;                                        1441 08742000
         LR    @01,XTNTPTR                                         1441 08743000
         AL    @01,@TF00001                                        1441 08744000
         MVC   XTNTDSN-78(44,@01),XTNHDSN(XTNTPTR)                 1441 08745000
*       XTNTVOLN(I)=XTNHVOLN;                                      1442 08746000
         LR    @01,XTNTPTR                                         1442 08747000
         AL    @01,@TF00001                                        1442 08748000
         MVC   XTNTVOLN-78(1,@01),XTNHVOLN(XTNTPTR)                1442 08749000
*       XTNTVOL(I)=XTNHVOL;                                        1443 08750000
*                                                                  1443 08751000
         LR    @01,XTNTPTR                                         1443 08752000
         AL    @01,@TF00001                                        1443 08753000
         MVC   XTNTVOL-78(6,@01),XTNHVOL(XTNTPTR)                  1443 08754000
*       /*************************************************************/ 08755000
*       /*                                                           */ 08756000
*       /* SET THE NEXT EXTENT TABLE ENTRY TO X'FF' TO INDICATE THE  */ 08757000
*       /* LAST ENTRY.                                               */ 08758000
*       /*                                                           */ 08759000
*       /*************************************************************/ 08760000
*                                                                  1444 08761000
*       I=I+1;                                                     1444 08762000
         AL    @14,@CF00221                                        1444 08763000
         STC   @14,I(,@15)                                         1444 08764000
*       XTNTENT(I)=LASTENT;                                        1445 08765000
*                                                                  1445 08766000
         LR    @01,@14                                             1445 08767000
         MR    @00,@04                                             1445 08768000
         ALR   @01,XTNTPTR                                         1445 08769000
         MVC   XTNTENT-78(78,@01),LASTENT                          1445 08770000
*       /*************************************************************/ 08771000
*       /*                                                           */ 08772000
*       /* CONSTRUCT THE OPEN ARGUMENT LIST (EXOARG)                 */ 08773000
*       /*                                                           */ 08774000
*       /*************************************************************/ 08775000
*                                                                  1446 08776000
*       I=1;                                                       1446 08777000
         LA    @14,1                                               1446 08778000
         STC   @14,I(,@15)                                         1446 08779000
*       EXOARG=''B;                                                1447 08780000
         L     @03,REPEXOAR(,@15)                                  1447 08781000
         XC    EXOARG(34,@03),EXOARG(@03)                          1447 08782000
*       EXODDN=ADDR(XTNTDDN(I));                                   1448 08783000
         LR    @01,@14                                             1448 08784000
         MR    @00,@04                                             1448 08785000
         LA    @04,XTNTDDN-78(@01,XTNTPTR)                         1448 08786000
         ST    @04,EXODDN(,@03)                                    1448 08787000
*       EXODSN=ADDR(XTNTDSN(I));                                   1449 08788000
         LA    @04,XTNTDSN-78(@01,XTNTPTR)                         1449 08789000
         ST    @04,EXODSN(,@03)                                    1449 08790000
*       IF XTNHMODE=INPUT THEN                                     1450 08791000
         CLI   XTNHMODE(XTNTPTR),C'I'                              1450 08792000
         BNE   @RF01450                                            1450 08793000
*         EXOCTLBK=ADDR(REPIDSOP);                                 1451 08794000
         LA    @04,REPIDSOP(,@15)                                  1451 08795000
         ST    @04,EXOCTLBK(,@03)                                  1451 08796000
*       ELSE                                                       1452 08797000
*         EXOCTLBK=ADDR(REPODSOP);                                 1452 08798000
         B     @RC01450                                            1452 08799000
@RF01450 L     @04,@PC00001+8                                      1452 08800000
         L     @01,REPEXOAR(,@04)                                  1452 08801000
         LA    @04,REPODSOP(,@04)                                  1452 08802000
         ST    @04,EXOCTLBK(,@01)                                  1452 08803000
*       EXORVT=ON;                                                 1453 08804000
@RC01450 L     @04,@PC00001+8                                      1453 08805000
         L     @04,REPEXOAR(,@04)                                  1453 08806000
         OI    EXORVT(@04),B'00000010'                             1453 08807000
*       EXOREP=ON;                                                 1454 08808000
*                                                                  1454 08809000
         OI    EXOREP(@04),B'00000100'                             1454 08810000
*       /*************************************************************/ 08811000
*       /*                                                           */ 08812000
*       /* ISSUE UEXCP OPENR                                         */ 08813000
*       /*                                                           */ 08814000
*       /*************************************************************/ 08815000
*                                                                  1455 08816000
*       CALL IDCIO050(GDTTBL,OPENR,EXOARG);                        1455 08817000
*                                                                  1455 08818000
         L     @15,@PC00001                                        1455 08819000
         ST    @15,@AL00001                                        1455 08820000
         LA    @14,@CC02024                                        1455 08821000
         ST    @14,@AL00001+4                                      1455 08822000
         ST    @04,@AL00001+8                                      1455 08823000
         MVI   @AL00001+8,X'80'                                    1455 08824000
         L     @15,GDTEXP(,@15)                                    1455 08825000
         LA    @01,@AL00001                                        1455 08826000
         BALR  @14,@15                                             1455 08827000
*       /*************************************************************/ 08828000
*       /*                                                           */ 08829000
*       /* SAVE RETURN CODE FROM UEXCP                               */ 08830000
*       /*                                                           */ 08831000
*       /*************************************************************/ 08832000
*                                                                  1456 08833000
*       RESPECIFY                                                  1456 08834000
*         RTNREG RSTD;                                             1456 08835000
*       TESTRC=RTNREG;                                             1457 08836000
         STH   RTNREG,TESTRC                                       1457 08837000
*       RESPECIFY                                                  1458 08838000
*         RTNREG UNRSTD;                                           1458 08839000
*                                                                  1458 08840000
*       /*************************************************************/ 08841000
*       /*                                                           */ 08842000
*       /* SET DUMP POINT                                            */ 08843000
*       /*                                                           */ 08844000
*       /*************************************************************/ 08845000
*                                                                  1459 08846000
*       IF GDTDBG=NULLPTR THEN                                     1459 08847000
         L     @04,@PC00001                                        1459 08848000
         L     @04,GDTDBG(,@04)                                    1459 08849000
         LTR   @04,@04                                             1459 08850000
         BZ    @RT01459                                            1459 08851000
*         ;                                                        1460 08852000
*       ELSE                                                       1461 08853000
*         CALL IDCDB010(GDTTBL,'RD6P');                            1461 08854000
*                                                                  1461 08855000
         L     @04,@PC00001                                        1461 08856000
         ST    @04,@AL00001                                        1461 08857000
         LA    @15,@CC02914                                        1461 08858000
         ST    @15,@AL00001+4                                      1461 08859000
         MVI   @AL00001+4,X'80'                                    1461 08860000
         L     @15,GDTDBG(,@04)                                    1461 08861000
         LA    @01,@AL00001                                        1461 08862000
         BALR  @14,@15                                             1461 08863000
*       /*************************************************************/ 08864000
*       /*                                                           */ 08865000
*       /* IF UEXCP FAILS, PREPARE TO RETURN TO THE CALLER WITH RC = */ 08866000
*       /* 12                                                        */ 08867000
*       /*                                                           */ 08868000
*       /*************************************************************/ 08869000
*                                                                  1462 08870000
*       IF TESTRC^=0 THEN                                          1462 08871000
@RT01459 SLR   @04,@04                                             1462 08872000
         CH    @04,TESTRC                                          1462 08873000
         BE    @RF01462                                            1462 08874000
*         DO;                                                      1463 08875000
*                                                                  1463 08876000
*           /*********************************************************/ 08877000
*           /*                                                       */ 08878000
*           /* IF MODIFY OUTPUT, DEQ THE VTOC                        */ 08879000
*           /*                                                       */ 08880000
*           /*********************************************************/ 08881000
*                                                                  1464 08882000
*           IF ADDR(MODIF)^=NULLPTR&XTNHMODE=OUTPUT THEN           1464 08883000
         L     @15,@PC00001+4                                      1464 08884000
         C     @04,FDTPTR+356(,@15)                                1464 08885000
         BE    @RF01464                                            1464 08886000
         CLI   XTNHMODE(XTNTPTR),C'O'                              1464 08887000
         BNE   @RF01464                                            1464 08888000
*             CALL IDCSADQ0(GDTTBL,SPQNAME,SPRNAME);               1465 08889000
*                                                                  1465 08890000
         L     @15,@PC00001                                        1465 08891000
         ST    @15,@AL00001                                        1465 08892000
         L     @14,@PC00001+8                                      1465 08893000
         L     @14,REPQRPTR(,@14)                                  1465 08894000
         ST    @14,@AL00001+4                                      1465 08895000
         LA    @14,SPRNAME(,@14)                                   1465 08896000
         ST    @14,@AL00001+8                                      1465 08897000
         MVI   @AL00001+8,X'80'                                    1465 08898000
         L     @15,GDTDEQ(,@15)                                    1465 08899000
         LA    @01,@AL00001                                        1465 08900000
         BALR  @14,@15                                             1465 08901000
*           /*********************************************************/ 08902000
*           /*                                                       */ 08903000
*           /* FREE THE BUFFERS                                      */ 08904000
*           /*                                                       */ 08905000
*           /*********************************************************/ 08906000
*                                                                  1466 08907000
*           CALL IDCSAFP0(GDTTBL,RD01,ALL);                        1466 08908000
*                                                                  1466 08909000
@RF01464 MVC   @AL00001+4(8),@AL01466                              1466 08910000
         L     @15,@PC00001                                        1466 08911000
         ST    @15,@AL00001                                        1466 08912000
         L     @15,GDTFPL(,@15)                                    1466 08913000
         LA    @01,@AL00001                                        1466 08914000
         BALR  @14,@15                                             1466 08915000
*           /*********************************************************/ 08916000
*           /*                                                       */ 08917000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 08918000
*           /*                                                       */ 08919000
*           /*********************************************************/ 08920000
*                                                                  1467 08921000
*           RETURN CODE(LASTCC12);                                 1467 08922000
         LA    @15,12                                              1467 08923000
         L     @14,@SA00002                                        1467 08924000
         LM    @00,@12,@SA00002+8                                  1467 08925000
         BR    @14                                                 1467 08926000
*         END;                                                     1468 08927000
*                                                                  1468 08928000
*       /*************************************************************/ 08929000
*       /*                                                           */ 08930000
*       /* RETURN TO THE CALLER WITH RC = 00                         */ 08931000
*       /*                                                           */ 08932000
*       /*************************************************************/ 08933000
*                                                                  1469 08934000
*       RETURN CODE(LASTCC00);                                     1469 08935000
@RF01462 SLR   @15,@15                                             1469 08936000
         L     @14,@SA00002                                        1469 08937000
         LM    @00,@12,@SA00002+8                                  1469 08938000
         BR    @14                                                 1469 08939000
*     END DSVTOC;                                                  1470 08940000
*                                                                  1471 08941000
*   /*****************************************************************/ 08942000
*   /*                                                               */ 08943000
*   /* PROCESSING A DATA SET: VSAM/NON-VSAM                          */ 08944000
*   /*                                                               */ 08945000
*   /*****************************************************************/ 08946000
*                                                                  1471 08947000
*   RESPECIFY                                                      1471 08948000
*     IOINFOPT BASED(ADDR(INFOBYT));                               1471 08949000
@RF01301 DS    0H                                                  1472 08950000
*   RESPECIFY                                                      1472 08951000
*     XTNTTBL BASED(XTNTPTR);                                      1472 08952000
*   RESPECIFY                                                      1473 08953000
*     XTNTTBL2 BASED(XTNTPTR2);                                    1473 08954000
*   RESPECIFY                                                      1474 08955000
*     EXOARG BASED(REPEXOAR);                                      1474 08956000
*                                                                  1474 08957000
*   /*****************************************************************/ 08958000
*   /*                                                               */ 08959000
*   /* ISSUE OBTAIN TO READ FORMAT 1 DSCB TO DETERMINE DATA SET TYPE */ 08960000
*   /* (VSAM OR NON-VSAM)                                            */ 08961000
*   /*                                                               */ 08962000
*   /*****************************************************************/ 08963000
*                                                                  1475 08964000
*   CAM1=CAMLIST;                                                  1475 08965000
         MVC   CAM1(16),CAMLIST                                    1475 08966000
*   RESPECIFY                                                      1476 08967000
*     REG3 RESTRICTED;                                             1476 08968000
*   CAMDSN=ADDR(XTNHDSN);                                          1477 08969000
         LA    @02,XTNHDSN(,XTNTPTR)                               1477 08970000
         ST    @02,CAMDSN                                          1477 08971000
*   CAMVOL=ADDR(XTNHVOL);                                          1478 08972000
         LA    @02,XTNHVOL(,XTNTPTR)                               1478 08973000
         ST    @02,CAMVOL                                          1478 08974000
*   CAMWA=ADDR(OBTAINWA);                                          1479 08975000
         LA    @02,OBTAINWA                                        1479 08976000
         ST    @02,CAMWA                                           1479 08977000
*   REG3=ADDR(CAM1);                                               1480 08978000
         LA    REG3,CAM1                                           1480 08979000
*LOBTAIN:                                                          1481 08980000
*   GEN;                                                           1481 08981000
LOBTAIN  DS    0H                                                  1481 08982000
         OBTAIN (3)                                                     08983000
*   RESPECIFY                                                      1482 08984000
*     REG3 UNRESTRICTED;                                           1482 08985000
*                                                                  1482 08986000
*   /*****************************************************************/ 08987000
*   /*                                                               */ 08988000
*   /* SAVE RETURN CODE FROM OBTAIN                                  */ 08989000
*   /*                                                               */ 08990000
*   /*****************************************************************/ 08991000
*                                                                  1483 08992000
*   RESPECIFY                                                      1483 08993000
*     RTNREG RSTD;                                                 1483 08994000
*   TESTRC=RTNREG;                                                 1484 08995000
         STH   RTNREG,TESTRC                                       1484 08996000
*   RESPECIFY                                                      1485 08997000
*     RTNREG UNRSTD;                                               1485 08998000
*                                                                  1485 08999000
*   /*****************************************************************/ 09000000
*   /*                                                               */ 09001000
*   /* IF OBTAIN FAILS, PREPARE TO RETURN TO THE CALLER WITH RC = 12 */ 09002000
*   /*                                                               */ 09003000
*   /*****************************************************************/ 09004000
*                                                                  1486 09005000
*   IF TESTRC^=0 THEN                                              1486 09006000
         LH    @15,TESTRC                                          1486 09007000
         LTR   @15,@15                                             1486 09008000
         BZ    @RF01486                                            1486 09009000
*     DO;                                                          1487 09010000
*                                                                  1487 09011000
*       /*************************************************************/ 09012000
*       /*                                                           */ 09013000
*       /* WRITE ERROR MESSAGE IDC31246I                             */ 09014000
*       /*                                                           */ 09015000
*       /*************************************************************/ 09016000
*                                                                  1488 09017000
*       DO;                                                        1488 09018000
*         CKREQ=CKREQ&&CKREQ;                                      1489 09019000
         L     @04,@PC00001+8                                      1489 09020000
         XC    CKREQ(44,@04),CKREQ(@04)                            1489 09021000
*         CKRERN=MSG46;                                            1490 09022000
         MVC   CKRERN(2,@04),@CH00770                              1490 09023000
*         CKRMVAR(1)=ADDR(OBTAIN);                                 1491 09024000
         LA    @15,@CC02831                                        1491 09025000
         ST    @15,CKRMVAR(,@04)                                   1491 09026000
*         CKRMVAR(2)=ADDR(XTNHDSN);                                1492 09027000
         LA    @15,XTNHDSN(,XTNTPTR)                               1492 09028000
         ST    @15,CKRMVAR+4(,@04)                                 1492 09029000
*         CALL IDCRDER;                                            1493 09030000
         L     @15,@CV01553                                        1493 09031000
         BALR  @14,@15                                             1493 09032000
*       END;                                                       1494 09033000
*                                                                  1494 09034000
*       /*************************************************************/ 09035000
*       /*                                                           */ 09036000
*       /* FREE THE BUFFERS                                          */ 09037000
*       /*                                                           */ 09038000
*       /*************************************************************/ 09039000
*                                                                  1495 09040000
*       CALL IDCSAFP0(GDTTBL,RD01,ALL);                            1495 09041000
*                                                                  1495 09042000
         MVC   @AL00001+4(8),@AL01495                              1495 09043000
         L     @15,@PC00001                                        1495 09044000
         ST    @15,@AL00001                                        1495 09045000
         L     @15,GDTFPL(,@15)                                    1495 09046000
         LA    @01,@AL00001                                        1495 09047000
         BALR  @14,@15                                             1495 09048000
*       /*************************************************************/ 09049000
*       /*                                                           */ 09050000
*       /* RETURN TO THE CALLER WITH RC = 12                         */ 09051000
*       /*                                                           */ 09052000
*       /*************************************************************/ 09053000
*                                                                  1496 09054000
*       RETURN CODE(LASTCC12);                                     1496 09055000
         LA    @15,12                                              1496 09056000
         L     @14,@SA00002                                        1496 09057000
         LM    @00,@12,@SA00002+8                                  1496 09058000
         BR    @14                                                 1496 09059000
*     END;                                                         1497 09060000
*                                                                  1497 09061000
*   /*****************************************************************/ 09062000
*   /*                                                               */ 09063000
*   /* IF THE DATA SET IS FIXED BLOCK STANDARD, SET REPAIR WORKFILE  */ 09064000
*   /* HEADER RECORD INDICATORS                                      */ 09065000
*   /*                                                               */ 09066000
*   /*****************************************************************/ 09067000
*                                                                  1498 09068000
*   F1PTR=ADDR(OBTAINWA)-LENGTH(XTNHDSN);                          1498 09069000
@RF01486 LA    F1PTR,OBTAINWA                                      1498 09070000
         SL    F1PTR,@CF00600                                      1498 09071000
*   IF DS1RECFM=FBS THEN                                           1499 09072000
         CLI   DS1RECFM(F1PTR),X'88'                               1499 09073000
         BNE   @RF01499                                            1499 09074000
*     DO;                                                          1500 09075000
*       RWHDRFIX=FXBLKSTD;                                         1501 09076000
         L     @03,@PC00001+8                                      1501 09077000
         L     @03,REPRWHAR(,@03)                                  1501 09078000
         MVI   RWHDRFIX(@03),C'F'                                  1501 09079000
*       RWHDRDLN=DS1LRECL;                                         1502 09080000
         MVC   RWHDRDLN(2,@03),DS1LRECL(F1PTR)                     1502 09081000
*       RWHDRKLN=NULLPTR;                                          1503 09082000
         MVI   RWHDRKLN(@03),X'00'                                 1503 09083000
*     END;                                                         1504 09084000
*                                                                  1504 09085000
*   /*****************************************************************/ 09086000
*   /*                                                               */ 09087000
*   /* OTHERWISE, CLEAR THE INDICATORS                               */ 09088000
*   /*                                                               */ 09089000
*   /*****************************************************************/ 09090000
*                                                                  1505 09091000
*   ELSE                                                           1505 09092000
*     DO;                                                          1505 09093000
         B     @RC01499                                            1505 09094000
@RF01499 DS    0H                                                  1506 09095000
*       RWHDRFIX=''B;                                              1506 09096000
         L     @03,@PC00001+8                                      1506 09097000
         L     @03,REPRWHAR(,@03)                                  1506 09098000
         MVI   RWHDRFIX(@03),X'00'                                 1506 09099000
*       RWHDRDLN=NULLPTR;                                          1507 09100000
         SLR   @15,@15                                             1507 09101000
         STH   @15,RWHDRDLN(,@03)                                  1507 09102000
*       RWHDRKLN=NULLPTR;                                          1508 09103000
         MVI   RWHDRKLN(@03),X'00'                                 1508 09104000
*     END;                                                         1509 09105000
*                                                                  1510 09106000
*   /*****************************************************************/ 09107000
*   /*                                                               */ 09108000
*   /* PROCESSING A DATA SET: VSAM                                   */ 09109000
*   /*                                                               */ 09110000
*   /*****************************************************************/ 09111000
*                                                                  1510 09112000
*   IF DS1DSORG(2)=VSAMFMT THEN                                    1510 09113000
@RC01499 CLI   DS1DSORG+1(F1PTR),X'08'                             1510 09114000
         BNE   @RF01510                                            1510 09115000
*DSVSAM:                                                           1511 09116000
*     DO;                                                          1511 09117000
*                                                                  1511 09118000
DSVSAM   DS    0H                                                  1512 09119000
*       /*************************************************************/ 09120000
*       /*                                                           */ 09121000
*       /* SET TRACE POINT                                           */ 09122000
*       /*                                                           */ 09123000
*       /*************************************************************/ 09124000
*                                                                  1512 09125000
*       OLDERID2=NEWERID2;                                         1512 09126000
         L     @03,@PC00001                                        1512 09127000
         L     @03,GDTTR2(,@03)                                    1512 09128000
         MVC   @TS00001(95),NEWERID2(@03)                          1512 09129000
         MVC   OLDERID2(95,@03),@TS00001                           1512 09130000
*       NEWID2='RD6M';                                             1513 09131000
*                                                                  1513 09132000
         MVC   NEWID2(4,@03),@CC02924                              1513 09133000
*       /*************************************************************/ 09134000
*       /*                                                           */ 09135000
*       /* CONSTRUCT THE OPEN ARGUMENT LIST (OPNAGL)                 */ 09136000
*       /*                                                           */ 09137000
*       /*************************************************************/ 09138000
*                                                                  1514 09139000
*       OPNPTR=REPOPAGL;                                           1514 09140000
         L     @15,@PC00001+8                                      1514 09141000
         L     OPNPTR,REPOPAGL(,@15)                               1514 09142000
*       OPNAGL=''B;                                                1515 09143000
         XC    OPNAGL(48,OPNPTR),OPNAGL(OPNPTR)                    1515 09144000
*       OPNMODRC=ON;                                               1516 09145000
         OI    OPNMODRC(OPNPTR),B'00100000'                        1516 09146000
*       OPNOPTIN=ON;                                               1517 09147000
         OI    OPNOPTIN(OPNPTR),B'10000000'                        1517 09148000
*       OPNDSOAM=ON;                                               1518 09149000
         OI    OPNDSOAM(OPNPTR),B'10000000'                        1518 09150000
*       OPNDDN=ADDR(XTNHDDN);                                      1519 09151000
         ST    XTNTPTR,OPNDDN(,OPNPTR)                             1519 09152000
*       IF XTNHPWD^=ZEROS THEN                                     1520 09153000
         CLC   XTNHPWD(8,XTNTPTR),ZEROS                            1520 09154000
         BE    @RF01520                                            1520 09155000
*         OPNPWA=ADDR(XTNHPWD);                                    1521 09156000
         LA    @03,XTNHPWD(,XTNTPTR)                               1521 09157000
         ST    @03,OPNPWA(,OPNPTR)                                 1521 09158000
*       OPNIOC=ADDR(REPCDSOP);                                     1522 09159000
*                                                                  1522 09160000
@RF01520 L     @03,@PC00001+8                                      1522 09161000
         LA    @03,REPCDSOP(,@03)                                  1522 09162000
         ST    @03,OPNIOC(,OPNPTR)                                 1522 09163000
*       /*************************************************************/ 09164000
*       /*                                                           */ 09165000
*       /* ISSUE UOPEN                                               */ 09166000
*       /*                                                           */ 09167000
*       /*************************************************************/ 09168000
*                                                                  1523 09169000
*       CALL IDCIOOP0(GDTTBL,OPNAGL);                              1523 09170000
*                                                                  1523 09171000
         L     @03,@PC00001                                        1523 09172000
         ST    @03,@AL00001                                        1523 09173000
         ST    OPNPTR,@AL00001+4                                   1523 09174000
         MVI   @AL00001+4,X'80'                                    1523 09175000
         L     @15,GDTOPN(,@03)                                    1523 09176000
         LA    @01,@AL00001                                        1523 09177000
         BALR  @14,@15                                             1523 09178000
*       /*************************************************************/ 09179000
*       /*                                                           */ 09180000
*       /* * SAVE RETURN CODE FROM UOPEN                             */ 09181000
*       /*                                                           */ 09182000
*       /*************************************************************/ 09183000
*                                                                  1524 09184000
*       RESPECIFY                                                  1524 09185000
*         RTNREG RSTD;                                             1524 09186000
*       TESTRC=RTNREG;                                             1525 09187000
         STH   RTNREG,TESTRC                                       1525 09188000
*       RESPECIFY                                                  1526 09189000
*         RTNREG UNRSTD;                                           1526 09190000
*       IOCSPTR=REPCDSOP;                                          1527 09191000
*                                                                  1527 09192000
         L     @15,@PC00001+8                                      1527 09193000
         L     @15,REPCDSOP(,@15)                                  1527 09194000
         ST    @15,IOCSPTR                                         1527 09195000
*       /*************************************************************/ 09196000
*       /*                                                           */ 09197000
*       /* IF UOPEN FAILS, PREPARE TO RETURN TO THE CALLER WITH RC = */ 09198000
*       /* 12                                                        */ 09199000
*       /*                                                           */ 09200000
*       /*************************************************************/ 09201000
*                                                                  1528 09202000
*       IF TESTRC^=0&IOCMSGOP=OFF THEN                             1528 09203000
         LH    @14,TESTRC                                          1528 09204000
         LTR   @14,@14                                             1528 09205000
         BZ    @RF01528                                            1528 09206000
         TM    IOCMSGOP(@15),B'00100000'                           1528 09207000
         BNZ   @RF01528                                            1528 09208000
*         DO;                                                      1529 09209000
*                                                                  1529 09210000
*           /*********************************************************/ 09211000
*           /*                                                       */ 09212000
*           /* FREE THE BUFFERS                                      */ 09213000
*           /*                                                       */ 09214000
*           /*********************************************************/ 09215000
*                                                                  1530 09216000
*           CALL IDCSAFP0(GDTTBL,RD01,ALL);                        1530 09217000
*                                                                  1530 09218000
         MVC   @AL00001+4(8),@AL01530                              1530 09219000
         L     @15,@PC00001                                        1530 09220000
         ST    @15,@AL00001                                        1530 09221000
         L     @15,GDTFPL(,@15)                                    1530 09222000
         LA    @01,@AL00001                                        1530 09223000
         BALR  @14,@15                                             1530 09224000
*           /*********************************************************/ 09225000
*           /*                                                       */ 09226000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 09227000
*           /*                                                       */ 09228000
*           /*********************************************************/ 09229000
*                                                                  1531 09230000
*           RETURN CODE(LASTCC12);                                 1531 09231000
         LA    @15,12                                              1531 09232000
         L     @14,@SA00002                                        1531 09233000
         LM    @00,@12,@SA00002+8                                  1531 09234000
         BR    @14                                                 1531 09235000
*         END;                                                     1532 09236000
*       RESPECIFY                                                  1533 09237000
*         IFGACB BASED(IOCCBP);                                    1533 09238000
@RF01528 DS    0H                                                  1534 09239000
*       RESPECIFY                                                  1534 09240000
*         IDAAMBL BASED(ACBAMBL);                                  1534 09241000
*       RESPECIFY                                                  1535 09242000
*         IDAAMB BASED(AMBLIX);                                    1535 09243000
*       RESPECIFY                                                  1536 09244000
*         IDAAMDSB BASED(AMBDSB);                                  1536 09245000
*                                                                  1536 09246000
*       /*************************************************************/ 09247000
*       /*                                                           */ 09248000
*       /* IF FIELD AMBLIX IS NOT EQUAL TO ZERO, DATA SET IS A KEY   */ 09249000
*       /* SEQUENTIAL DATA SET (KSDS)                                */ 09250000
*       /*                                                           */ 09251000
*       /*************************************************************/ 09252000
*                                                                  1537 09253000
*       IF AMBLIX^=NULLPTR THEN                                    1537 09254000
         SLR   @15,@15                                             1537 09255000
         L     @01,IOCSPTR                                         1537 09256000
         L     @01,IOCCBP(,@01)                                    1537 09257000
         L     @01,ACBAMBL(,@01)                                   1537 09258000
         L     @14,AMBLIX(,@01)                                    1537 09259000
         CR    @14,@15                                             1537 09260000
         BE    @RF01537                                            1537 09261000
*         DO;                                                      1538 09262000
*           DEBPTR=AMBDEBAD;                                       1539 09263000
         L     @03,AMBDEBAD-1(,@14)                                1539 09264000
         LA    @03,0(,@03)                                         1539 09265000
         ST    @03,DEBPTR                                          1539 09266000
*           DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);              1540 09267000
*                                                                  1540 09268000
         AL    @03,@CF00223                                        1540 09269000
         LR    DEBDAPTR,@03                                        1540 09270000
*           /*********************************************************/ 09271000
*           /*                                                       */ 09272000
*           /* CONSTRUCT XTNTTBL2                                    */ 09273000
*           /*                                                       */ 09274000
*           /*********************************************************/ 09275000
*                                                                  1541 09276000
*           RESPECIFY                                              1541 09277000
*             REG3 RESTRICTED;                                     1541 09278000
*           REG3=ZERO;                                             1542 09279000
         LR    REG3,@15                                            1542 09280000
*           DO I=1 BY 1 TO DEBNMEXT;                               1543 09281000
         LA    @15,1                                               1543 09282000
         L     @14,@PC00001+8                                      1543 09283000
         STC   @15,I(,@14)                                         1543 09284000
         B     @DE01543                                            1543 09285000
@DL01543 DS    0H                                                  1544 09286000
*             XTN2CC1(I)=(DEBDAPTR+REG3)->DEBSTRCC;                1544 09287000
         L     @15,@PC00001+8                                      1544 09288000
         SLR   @14,@14                                             1544 09289000
         IC    @14,I(,@15)                                         1544 09290000
         LR    @15,@14                                             1544 09291000
         MH    @15,@CH00797                                        1544 09292000
         LR    @01,DEBDAPTR                                        1544 09293000
         ALR   @01,REG3                                            1544 09294000
         LH    @00,DEBSTRCC(,@01)                                  1544 09295000
         N     @00,@CF03043                                        1544 09296000
         LR    @14,XTNTPTR2                                        1544 09297000
         AL    @14,@CF03047                                        1544 09298000
         STH   @00,XTN2CC1-44(@15,@14)                             1544 09299000
*             XTN2HH1(I)=(DEBDAPTR+REG3)->DEBSTRHH;                1545 09300000
         LH    @14,DEBSTRHH(,@01)                                  1545 09301000
         N     @14,@CF03043                                        1545 09302000
         ST    @01,@TF00001                                        1545 09303000
         LR    @01,XTNTPTR2                                        1545 09304000
         AL    @01,@CF03048                                        1545 09305000
         STH   @14,XTN2HH1-46(@15,@01)                             1545 09306000
*             XTN2CC2(I)=(DEBDAPTR+REG3)->DEBENDCC;                1546 09307000
         L     @01,@TF00001                                        1546 09308000
         LH    @14,DEBENDCC(,@01)                                  1546 09309000
         N     @14,@CF03043                                        1546 09310000
         LR    @01,XTNTPTR2                                        1546 09311000
         AL    @01,@CF03049                                        1546 09312000
         STH   @14,XTN2CC2-48(@15,@01)                             1546 09313000
*             XTN2HH2(I)=(DEBDAPTR+REG3)->DEBENDHH;                1547 09314000
         L     @01,@TF00001                                        1547 09315000
         LH    @14,DEBENDHH(,@01)                                  1547 09316000
         N     @14,@CF03043                                        1547 09317000
         AL    @15,@CF03050                                        1547 09318000
         STH   @14,XTN2HH2-50(@15,XTNTPTR2)                        1547 09319000
*             REG3=I;                                              1548 09320000
         L     @15,@PC00001+8                                      1548 09321000
         SLR   @14,@14                                             1548 09322000
         IC    @14,I(,@15)                                         1548 09323000
         LR    REG3,@14                                            1548 09324000
*             SLL(REG3,EXTNTVAL);                                  1549 09325000
         L     @01,DEBPTR                                          1549 09326000
         SLR   @15,@15                                             1549 09327000
         IC    @15,EXTNTVAL(,@01)                                  1549 09328000
         SLL   REG3,0(@15)                                         1549 09329000
*           END;                                                   1550 09330000
         L     @14,@PC00001+8                                      1550 09331000
         LA    @15,1                                               1550 09332000
         SLR   @01,@01                                             1550 09333000
         IC    @01,I(,@14)                                         1550 09334000
         ALR   @15,@01                                             1550 09335000
         L     @14,@PC00001+8                                      1550 09336000
         STC   @15,I(,@14)                                         1550 09337000
@DE01543 L     @14,DEBPTR                                          1550 09338000
         SLR   @01,@01                                             1550 09339000
         IC    @01,DEBNMEXT(,@14)                                  1550 09340000
         CR    @15,@01                                             1550 09341000
         BNH   @DL01543                                            1550 09342000
*           RESPECIFY                                              1551 09343000
*             IDAAMB BASED(AMBLDTA);                               1551 09344000
*           DEBPTR=AMBDEBAD;                                       1552 09345000
         L     @01,IOCSPTR                                         1552 09346000
         L     @01,IOCCBP(,@01)                                    1552 09347000
         L     @01,ACBAMBL(,@01)                                   1552 09348000
         L     @01,AMBLDTA(,@01)                                   1552 09349000
         L     @15,AMBDEBAD-1(,@01)                                1552 09350000
         LA    @15,0(,@15)                                         1552 09351000
         ST    @15,DEBPTR                                          1552 09352000
*           DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);              1553 09353000
         AL    @15,@CF00223                                        1553 09354000
         LR    DEBDAPTR,@15                                        1553 09355000
*           REG3=0;                                                1554 09356000
         SLR   REG3,REG3                                           1554 09357000
*           K=0;                                                   1555 09358000
         L     @15,@PC00001+8                                      1555 09359000
         MVI   K(@15),X'00'                                        1555 09360000
*           DO J=I BY 1 TO(DEBNMEXT+(I-1));                        1556 09361000
         SLR   @14,@14                                             1556 09362000
         IC    @14,I(,@15)                                         1556 09363000
         L     @15,@PC00001+8                                      1556 09364000
         STC   @14,J(,@15)                                         1556 09365000
         B     @DE01556                                            1556 09366000
@DL01556 DS    0H                                                  1557 09367000
*             XTN2CC1(J)=(DEBDAPTR+REG3)->DEBSTRCC;                1557 09368000
         L     @15,@PC00001+8                                      1557 09369000
         SLR   @14,@14                                             1557 09370000
         IC    @14,J(,@15)                                         1557 09371000
         MH    @14,@CH00797                                        1557 09372000
         LR    @01,DEBDAPTR                                        1557 09373000
         ALR   @01,REG3                                            1557 09374000
         LH    @00,DEBSTRCC(,@01)                                  1557 09375000
         N     @00,@CF03043                                        1557 09376000
         LR    @15,XTNTPTR2                                        1557 09377000
         AL    @15,@CF03047                                        1557 09378000
         STH   @00,XTN2CC1-44(@14,@15)                             1557 09379000
*             XTN2HH1(J)=(DEBDAPTR+REG3)->DEBSTRHH;                1558 09380000
         LH    @15,DEBSTRHH(,@01)                                  1558 09381000
         N     @15,@CF03043                                        1558 09382000
         ST    @01,@TF00001                                        1558 09383000
         LR    @01,XTNTPTR2                                        1558 09384000
         AL    @01,@CF03048                                        1558 09385000
         STH   @15,XTN2HH1-46(@14,@01)                             1558 09386000
*             XTN2CC2(J)=(DEBDAPTR+REG3)->DEBENDCC;                1559 09387000
         L     @01,@TF00001                                        1559 09388000
         LH    @15,DEBENDCC(,@01)                                  1559 09389000
         N     @15,@CF03043                                        1559 09390000
         LR    @01,XTNTPTR2                                        1559 09391000
         AL    @01,@CF03049                                        1559 09392000
         STH   @15,XTN2CC2-48(@14,@01)                             1559 09393000
*             XTN2HH2(J)=(DEBDAPTR+REG3)->DEBENDHH;                1560 09394000
         L     @01,@TF00001                                        1560 09395000
         LH    @15,DEBENDHH(,@01)                                  1560 09396000
         N     @15,@CF03043                                        1560 09397000
         AL    @14,@CF03050                                        1560 09398000
         STH   @15,XTN2HH2-50(@14,XTNTPTR2)                        1560 09399000
*             K=K+1;                                               1561 09400000
         L     @15,@PC00001+8                                      1561 09401000
         LA    @14,1                                               1561 09402000
         SLR   @01,@01                                             1561 09403000
         IC    @01,K(,@15)                                         1561 09404000
         ALR   @14,@01                                             1561 09405000
         STC   @14,K(,@15)                                         1561 09406000
*             REG3=K;                                              1562 09407000
         LR    REG3,@14                                            1562 09408000
*             SLL(REG3,EXTNTVAL);                                  1563 09409000
         L     @01,DEBPTR                                          1563 09410000
         SLR   @15,@15                                             1563 09411000
         IC    @15,EXTNTVAL(,@01)                                  1563 09412000
         SLL   REG3,0(@15)                                         1563 09413000
*           END;                                                   1564 09414000
         L     @15,@PC00001+8                                      1564 09415000
         LA    @14,1                                               1564 09416000
         SLR   @01,@01                                             1564 09417000
         IC    @01,J(,@15)                                         1564 09418000
         ALR   @14,@01                                             1564 09419000
         L     @15,@PC00001+8                                      1564 09420000
         STC   @14,J(,@15)                                         1564 09421000
@DE01556 L     @15,@PC00001+8                                      1564 09422000
         SLR   @01,@01                                             1564 09423000
         IC    @01,I(,@15)                                         1564 09424000
         BCTR  @01,0                                               1564 09425000
         L     @15,DEBPTR                                          1564 09426000
         SLR   @00,@00                                             1564 09427000
         IC    @00,DEBNMEXT(,@15)                                  1564 09428000
         ALR   @01,@00                                             1564 09429000
         CR    @14,@01                                             1564 09430000
         BNH   @DL01556                                            1564 09431000
*           XTN2ENT(J)=LASTENT;                                    1565 09432000
         L     @02,@PC00001+8                                      1565 09433000
         SLR   @15,@15                                             1565 09434000
         IC    @15,J(,@02)                                         1565 09435000
         MH    @15,@CH00797                                        1565 09436000
         ALR   @15,XTNTPTR2                                        1565 09437000
         AL    @15,@CF03051                                        1565 09438000
         MVC   XTN2ENT(52,@15),LASTENT                             1565 09439000
*         END;                                                     1566 09440000
*                                                                  1566 09441000
*       /*************************************************************/ 09442000
*       /*                                                           */ 09443000
*       /* IF NOT A KSDS, SAVE DATA EXTENTS ONLY IN XTNTTBL2         */ 09444000
*       /*                                                           */ 09445000
*       /*************************************************************/ 09446000
*                                                                  1567 09447000
*       ELSE                                                       1567 09448000
*         DO;                                                      1567 09449000
         B     @RC01537                                            1567 09450000
@RF01537 DS    0H                                                  1568 09451000
*           REG3=0;                                                1568 09452000
         SLR   REG3,REG3                                           1568 09453000
*           DEBPTR=AMBDEBAD;                                       1569 09454000
         L     @01,IOCSPTR                                         1569 09455000
         L     @01,IOCCBP(,@01)                                    1569 09456000
         L     @01,ACBAMBL(,@01)                                   1569 09457000
         L     @01,AMBLDTA(,@01)                                   1569 09458000
         L     @15,AMBDEBAD-1(,@01)                                1569 09459000
         LA    @15,0(,@15)                                         1569 09460000
         ST    @15,DEBPTR                                          1569 09461000
*           DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);              1570 09462000
         AL    @15,@CF00223                                        1570 09463000
         LR    DEBDAPTR,@15                                        1570 09464000
*           DO I=1 BY 1 TO DEBNMEXT;                               1571 09465000
         LA    @15,1                                               1571 09466000
         L     @14,@PC00001+8                                      1571 09467000
         STC   @15,I(,@14)                                         1571 09468000
         B     @DE01571                                            1571 09469000
@DL01571 DS    0H                                                  1572 09470000
*             XTN2CC1(I)=(DEBDAPTR+REG3)->DEBSTRCC;                1572 09471000
         L     @15,@PC00001+8                                      1572 09472000
         SLR   @14,@14                                             1572 09473000
         IC    @14,I(,@15)                                         1572 09474000
         LR    @15,@14                                             1572 09475000
         MH    @15,@CH00797                                        1572 09476000
         LR    @01,DEBDAPTR                                        1572 09477000
         ALR   @01,REG3                                            1572 09478000
         LH    @00,DEBSTRCC(,@01)                                  1572 09479000
         N     @00,@CF03043                                        1572 09480000
         LR    @14,XTNTPTR2                                        1572 09481000
         AL    @14,@CF03047                                        1572 09482000
         STH   @00,XTN2CC1-44(@15,@14)                             1572 09483000
*             XTN2HH1(I)=(DEBDAPTR+REG3)->DEBSTRHH;                1573 09484000
         LH    @14,DEBSTRHH(,@01)                                  1573 09485000
         N     @14,@CF03043                                        1573 09486000
         ST    @01,@TF00001                                        1573 09487000
         LR    @01,XTNTPTR2                                        1573 09488000
         AL    @01,@CF03048                                        1573 09489000
         STH   @14,XTN2HH1-46(@15,@01)                             1573 09490000
*             XTN2CC2(I)=(DEBDAPTR+REG3)->DEBENDCC;                1574 09491000
         L     @01,@TF00001                                        1574 09492000
         LH    @14,DEBENDCC(,@01)                                  1574 09493000
         N     @14,@CF03043                                        1574 09494000
         LR    @01,XTNTPTR2                                        1574 09495000
         AL    @01,@CF03049                                        1574 09496000
         STH   @14,XTN2CC2-48(@15,@01)                             1574 09497000
*             XTN2HH2(I)=(DEBDAPTR+REG3)->DEBENDHH;                1575 09498000
         L     @01,@TF00001                                        1575 09499000
         LH    @14,DEBENDHH(,@01)                                  1575 09500000
         N     @14,@CF03043                                        1575 09501000
         AL    @15,@CF03050                                        1575 09502000
         STH   @14,XTN2HH2-50(@15,XTNTPTR2)                        1575 09503000
*             REG3=I;                                              1576 09504000
         L     @15,@PC00001+8                                      1576 09505000
         SLR   @14,@14                                             1576 09506000
         IC    @14,I(,@15)                                         1576 09507000
         LR    REG3,@14                                            1576 09508000
*             SLL(REG3,EXTNTVAL);                                  1577 09509000
         L     @01,DEBPTR                                          1577 09510000
         SLR   @15,@15                                             1577 09511000
         IC    @15,EXTNTVAL(,@01)                                  1577 09512000
         SLL   REG3,0(@15)                                         1577 09513000
*           END;                                                   1578 09514000
         L     @14,@PC00001+8                                      1578 09515000
         LA    @15,1                                               1578 09516000
         SLR   @01,@01                                             1578 09517000
         IC    @01,I(,@14)                                         1578 09518000
         ALR   @15,@01                                             1578 09519000
         L     @14,@PC00001+8                                      1578 09520000
         STC   @15,I(,@14)                                         1578 09521000
@DE01571 L     @14,DEBPTR                                          1578 09522000
         SLR   @01,@01                                             1578 09523000
         IC    @01,DEBNMEXT(,@14)                                  1578 09524000
         CR    @15,@01                                             1578 09525000
         BNH   @DL01571                                            1578 09526000
*           XTN2ENT(I)=LASTENT;                                    1579 09527000
         L     @02,@PC00001+8                                      1579 09528000
         SLR   @15,@15                                             1579 09529000
         IC    @15,I(,@02)                                         1579 09530000
         MH    @15,@CH00797                                        1579 09531000
         ALR   @15,XTNTPTR2                                        1579 09532000
         AL    @15,@CF03051                                        1579 09533000
         MVC   XTN2ENT(52,@15),LASTENT                             1579 09534000
*         END;                                                     1580 09535000
*       RESPECIFY                                                  1581 09536000
*         REG3 UNRESTRICTED;                                       1581 09537000
*                                                                  1581 09538000
@RC01537 DS    0H                                                  1582 09539000
*       /*************************************************************/ 09540000
*       /*                                                           */ 09541000
*       /* GET ADDRESS OF USYSINFO RETURN AREA                       */ 09542000
*       /*                                                           */ 09543000
*       /*************************************************************/ 09544000
*                                                                  1582 09545000
*       IF ADDR(MODIF)^=NULLPTR&IOPARM=OUTPUT THEN                 1582 09546000
         L     @15,@PC00001+4                                      1582 09547000
         L     @15,FDTPTR+356(,@15)                                1582 09548000
         LTR   @15,@15                                             1582 09549000
         BZ    @RF01582                                            1582 09550000
         L     @15,@PC00002                                        1582 09551000
         CLI   IOPARM(@15),C'O'                                    1582 09552000
         BNE   @RF01582                                            1582 09553000
*         SINFPTR=REPOSYSI;                                        1583 09554000
*                                                                  1583 09555000
         L     @15,@PC00001+8                                      1583 09556000
         L     @15,REPOSYSI(,@15)                                  1583 09557000
         ST    @15,SINFPTR                                         1583 09558000
*       /*************************************************************/ 09559000
*       /*                                                           */ 09560000
*       /* DO NOT CLOSE VSAM DATA SET IN ORDER TO ENSURE NO ONE ELSE */ 09561000
*       /* WILL GET CONTROL DURING MODIFY                            */ 09562000
*       /*                                                           */ 09563000
*       /*************************************************************/ 09564000
*                                                                  1584 09565000
*       ELSE                                                       1584 09566000
*         DO;                                                      1584 09567000
         B     @RC01582                                            1584 09568000
@RF01582 DS    0H                                                  1585 09569000
*           SINFPTR=REPISYSI;                                      1585 09570000
*                                                                  1585 09571000
         L     @15,@PC00001+8                                      1585 09572000
         L     @14,REPISYSI(,@15)                                  1585 09573000
         ST    @14,SINFPTR                                         1585 09574000
*           /*********************************************************/ 09575000
*           /*                                                       */ 09576000
*           /* CLOSE VSAM DATA SET IF INPUT PROCESSING AND ZERO OUT  */ 09577000
*           /* REPCDSOP SO MODIFY KNOWS ITS CLOSED                   */ 09578000
*           /*                                                       */ 09579000
*           /*********************************************************/ 09580000
*                                                                  1586 09581000
*           CALL IDCIOCL0(GDTTBL,REPCDSOP);                        1586 09582000
         L     @14,@PC00001                                        1586 09583000
         ST    @14,@AL00001                                        1586 09584000
         LA    @15,REPCDSOP(,@15)                                  1586 09585000
         ST    @15,@AL00001+4                                      1586 09586000
         MVI   @AL00001+4,X'80'                                    1586 09587000
         L     @15,GDTCLS(,@14)                                    1586 09588000
         LA    @01,@AL00001                                        1586 09589000
         BALR  @14,@15                                             1586 09590000
*           REPCDSOP=NULLPTR;                                      1587 09591000
         L     @15,@PC00001+8                                      1587 09592000
         SLR   @14,@14                                             1587 09593000
         ST    @14,REPCDSOP(,@15)                                  1587 09594000
*         END;                                                     1588 09595000
*                                                                  1588 09596000
*       /*************************************************************/ 09597000
*       /*                                                           */ 09598000
*       /* ISSUE USYSINFO TO GET UCB ADDRESS                         */ 09599000
*       /*                                                           */ 09600000
*       /*************************************************************/ 09601000
*                                                                  1589 09602000
*       CALL IDCSASI0(GDTTBL,UNIT,SINFPTR,XTNHDDN);                1589 09603000
*                                                                  1589 09604000
@RC01582 L     @15,@PC00001                                        1589 09605000
         ST    @15,@AL00001                                        1589 09606000
         LA    @14,UNIT                                            1589 09607000
         ST    @14,@AL00001+4                                      1589 09608000
         LA    @14,SINFPTR                                         1589 09609000
         ST    @14,@AL00001+8                                      1589 09610000
         ST    XTNTPTR,@AL00001+12                                 1589 09611000
         MVI   @AL00001+12,X'80'                                   1589 09612000
         L     @15,GDTSFO(,@15)                                    1589 09613000
         LA    @01,@AL00001                                        1589 09614000
         BALR  @14,@15                                             1589 09615000
*       /*************************************************************/ 09616000
*       /*                                                           */ 09617000
*       /* SAVE RETURN CODE FROM USYSINFO                            */ 09618000
*       /*                                                           */ 09619000
*       /*************************************************************/ 09620000
*                                                                  1590 09621000
*       RESPECIFY                                                  1590 09622000
*         RTNREG RSTD;                                             1590 09623000
*       TESTRC=RTNREG;                                             1591 09624000
         STH   RTNREG,TESTRC                                       1591 09625000
*       RESPECIFY                                                  1592 09626000
*         RTNREG UNRSTD;                                           1592 09627000
*                                                                  1592 09628000
*       /*************************************************************/ 09629000
*       /*                                                           */ 09630000
*       /* IF USYSINFO FAILS, PREPARE TO RETURN TO THE CALLER WITH RC*/ 09631000
*       /* = 12                                                      */ 09632000
*       /*                                                           */ 09633000
*       /*************************************************************/ 09634000
*                                                                  1593 09635000
*       IF TESTRC^=0 THEN                                          1593 09636000
         LH    @15,TESTRC                                          1593 09637000
         LTR   @15,@15                                             1593 09638000
         BZ    @RF01593                                            1593 09639000
*         DO;                                                      1594 09640000
*                                                                  1594 09641000
*           /*********************************************************/ 09642000
*           /*                                                       */ 09643000
*           /* FREE THE BUFFERS                                      */ 09644000
*           /*                                                       */ 09645000
*           /*********************************************************/ 09646000
*                                                                  1595 09647000
*           CALL IDCSAFP0(GDTTBL,RD01,ALL);                        1595 09648000
*                                                                  1595 09649000
         MVC   @AL00001+4(8),@AL01595                              1595 09650000
         L     @15,@PC00001                                        1595 09651000
         ST    @15,@AL00001                                        1595 09652000
         L     @15,GDTFPL(,@15)                                    1595 09653000
         LA    @01,@AL00001                                        1595 09654000
         BALR  @14,@15                                             1595 09655000
*           /*********************************************************/ 09656000
*           /*                                                       */ 09657000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 09658000
*           /*                                                       */ 09659000
*           /*********************************************************/ 09660000
*                                                                  1596 09661000
*           RETURN CODE(LASTCC12);                                 1596 09662000
         LA    @15,12                                              1596 09663000
         L     @14,@SA00002                                        1596 09664000
         LM    @00,@12,@SA00002+8                                  1596 09665000
         BR    @14                                                 1596 09666000
*         END;                                                     1597 09667000
*                                                                  1597 09668000
*       /*************************************************************/ 09669000
*       /*                                                           */ 09670000
*       /* SET THE UCB ADDRESS INTO THE EXOARG FOR CALLING UEXCP TO  */ 09671000
*       /* OPEN THE VSAM EXTENTS LATER                               */ 09672000
*       /*                                                           */ 09673000
*       /*************************************************************/ 09674000
*                                                                  1598 09675000
*       EXOUCB=SINFAREA;                                           1598 09676000
*                                                                  1598 09677000
@RF01593 L     @15,@PC00001+8                                      1598 09678000
         L     @15,REPEXOAR(,@15)                                  1598 09679000
         L     @14,SINFPTR                                         1598 09680000
         L     @14,SINFAREA(,@14)                                  1598 09681000
         ST    @14,EXOUCB(,@15)                                    1598 09682000
*       /*************************************************************/ 09683000
*       /*                                                           */ 09684000
*       /* SET THE VSAM BIT FOR UEXCP OPEN                           */ 09685000
*       /*                                                           */ 09686000
*       /*************************************************************/ 09687000
*                                                                  1599 09688000
*       EXORVS=ON;                                                 1599 09689000
         OI    EXORVS(@15),B'00010000'                             1599 09690000
*     END DSVSAM;                                                  1600 09691000
*                                                                  1601 09692000
*   /*****************************************************************/ 09693000
*   /*                                                               */ 09694000
*   /* PROCESSING A DATA SET: NON-VSAM                               */ 09695000
*   /*                                                               */ 09696000
*   /*****************************************************************/ 09697000
*                                                                  1601 09698000
*   ELSE                                                           1601 09699000
*     DO;                                                          1601 09700000
*                                                                  1601 09701000
         B     @RC01510                                            1601 09702000
@RF01510 DS    0H                                                  1602 09703000
*       /*************************************************************/ 09704000
*       /*                                                           */ 09705000
*       /* SET TRACE POINT                                           */ 09706000
*       /*                                                           */ 09707000
*       /*************************************************************/ 09708000
*                                                                  1602 09709000
*       OLDERID2=NEWERID2;                                         1602 09710000
         L     @03,@PC00001                                        1602 09711000
         L     @15,GDTTR2(,@03)                                    1602 09712000
         MVC   @TS00001(95),NEWERID2(@15)                          1602 09713000
         MVC   OLDERID2(95,@15),@TS00001                           1602 09714000
*       NEWID2='RD6N';                                             1603 09715000
*                                                                  1603 09716000
         MVC   NEWID2(4,@15),@CC02931                              1603 09717000
*       /*************************************************************/ 09718000
*       /*                                                           */ 09719000
*       /* CONSTRUCT THE OPEN ARGUMENT LIST (OPNAGL)                 */ 09720000
*       /*                                                           */ 09721000
*       /*************************************************************/ 09722000
*                                                                  1604 09723000
*       OPNPTR=REPOPAGL;                                           1604 09724000
         L     @15,@PC00001+8                                      1604 09725000
         L     OPNPTR,REPOPAGL(,@15)                               1604 09726000
*       OPNAGL=''B;                                                1605 09727000
         XC    OPNAGL(48,OPNPTR),OPNAGL(OPNPTR)                    1605 09728000
*       OPNMODRC=ON;                                               1606 09729000
         OI    OPNMODRC(OPNPTR),B'00100000'                        1606 09730000
*       OPNOPTIN=ON;                                               1607 09731000
         OI    OPNOPTIN(OPNPTR),B'10000000'                        1607 09732000
*       OPNDDN=ADDR(XTNHDDN);                                      1608 09733000
         ST    XTNTPTR,OPNDDN(,OPNPTR)                             1608 09734000
*       OPNIOC=ADDR(REPCDSOP);                                     1609 09735000
*                                                                  1609 09736000
         LA    @15,REPCDSOP(,@15)                                  1609 09737000
         ST    @15,OPNIOC(,OPNPTR)                                 1609 09738000
*       /*************************************************************/ 09739000
*       /*                                                           */ 09740000
*       /* ISSUE UOPEN                                               */ 09741000
*       /*                                                           */ 09742000
*       /*************************************************************/ 09743000
*                                                                  1610 09744000
*       CALL IDCIOOP0(GDTTBL,OPNAGL);                              1610 09745000
*                                                                  1610 09746000
         ST    @03,@AL00001                                        1610 09747000
         ST    OPNPTR,@AL00001+4                                   1610 09748000
         MVI   @AL00001+4,X'80'                                    1610 09749000
         L     @15,GDTOPN(,@03)                                    1610 09750000
         LA    @01,@AL00001                                        1610 09751000
         BALR  @14,@15                                             1610 09752000
*       /*************************************************************/ 09753000
*       /*                                                           */ 09754000
*       /* SAVE RETURN CODE FROM UOPEN                               */ 09755000
*       /*                                                           */ 09756000
*       /*************************************************************/ 09757000
*                                                                  1611 09758000
*       RESPECIFY                                                  1611 09759000
*         RTNREG RSTD;                                             1611 09760000
*       TESTRC=RTNREG;                                             1612 09761000
         STH   RTNREG,TESTRC                                       1612 09762000
*       RESPECIFY                                                  1613 09763000
*         RTNREG UNRSTD;                                           1613 09764000
*                                                                  1613 09765000
*       /*************************************************************/ 09766000
*       /*                                                           */ 09767000
*       /* IF UOPEN FAILS, PREPARE TO RETURN TO THE CALLER WITH RC = */ 09768000
*       /* 12                                                        */ 09769000
*       /*                                                           */ 09770000
*       /*************************************************************/ 09771000
*                                                                  1614 09772000
*       IF TESTRC^=0 THEN                                          1614 09773000
         LH    @15,TESTRC                                          1614 09774000
         LTR   @15,@15                                             1614 09775000
         BZ    @RF01614                                            1614 09776000
*         DO;                                                      1615 09777000
*                                                                  1615 09778000
*           /*********************************************************/ 09779000
*           /*                                                       */ 09780000
*           /* FREE THE BUFFERS                                      */ 09781000
*           /*                                                       */ 09782000
*           /*********************************************************/ 09783000
*                                                                  1616 09784000
*           CALL IDCSAFP0(GDTTBL,RD01,ALL);                        1616 09785000
*                                                                  1616 09786000
         MVC   @AL00001+4(8),@AL01616                              1616 09787000
         L     @15,@PC00001                                        1616 09788000
         ST    @15,@AL00001                                        1616 09789000
         L     @15,GDTFPL(,@15)                                    1616 09790000
         LA    @01,@AL00001                                        1616 09791000
         BALR  @14,@15                                             1616 09792000
*           /*********************************************************/ 09793000
*           /*                                                       */ 09794000
*           /* RETURN TO THE CALLER WITH RC = 12                     */ 09795000
*           /*                                                       */ 09796000
*           /*********************************************************/ 09797000
*                                                                  1617 09798000
*           RETURN CODE(LASTCC12);                                 1617 09799000
         LA    @15,12                                              1617 09800000
         L     @14,@SA00002                                        1617 09801000
         LM    @00,@12,@SA00002+8                                  1617 09802000
         BR    @14                                                 1617 09803000
*         END;                                                     1618 09804000
*       IOCSPTR=REPCDSOP;                                          1619 09805000
@RF01614 L     @03,@PC00001+8                                      1619 09806000
         L     @03,REPCDSOP(,@03)                                  1619 09807000
         ST    @03,IOCSPTR                                         1619 09808000
*       RESPECIFY                                                  1620 09809000
*         IHADCB BASED(IOCCBP);                                    1620 09810000
*       DEBPTR=DCBDEBAD;                                           1621 09811000
         L     @03,IOCCBP(,@03)                                    1621 09812000
         L     @03,DCBDEBAD+40(,@03)                               1621 09813000
         ST    @03,DEBPTR                                          1621 09814000
*       DEBDAPTR=ADDR(DEBBASIC)+LENGTH(DEBBASIC);                  1622 09815000
*                                                                  1622 09816000
         AL    @03,@CF00223                                        1622 09817000
         LR    DEBDAPTR,@03                                        1622 09818000
*       /*************************************************************/ 09819000
*       /*                                                           */ 09820000
*       /* SAVE THE DEB EXTENTS IN XTNTTBL2.                         */ 09821000
*       /*                                                           */ 09822000
*       /*************************************************************/ 09823000
*                                                                  1623 09824000
*       RESPECIFY                                                  1623 09825000
*         REG3 RESTRICTED;                                         1623 09826000
*       REG3=0;                                                    1624 09827000
         SLR   REG3,REG3                                           1624 09828000
*       DO I=1 BY 1 TO DEBNMEXT;                                   1625 09829000
         LA    @15,1                                               1625 09830000
         L     @14,@PC00001+8                                      1625 09831000
         STC   @15,I(,@14)                                         1625 09832000
         B     @DE01625                                            1625 09833000
@DL01625 DS    0H                                                  1626 09834000
*         XTN2CC1(I)=(DEBDAPTR+REG3)->DEBSTRCC;                    1626 09835000
         L     @15,@PC00001+8                                      1626 09836000
         SLR   @14,@14                                             1626 09837000
         IC    @14,I(,@15)                                         1626 09838000
         LR    @15,@14                                             1626 09839000
         MH    @15,@CH00797                                        1626 09840000
         LR    @01,DEBDAPTR                                        1626 09841000
         ALR   @01,REG3                                            1626 09842000
         LH    @00,DEBSTRCC(,@01)                                  1626 09843000
         N     @00,@CF03043                                        1626 09844000
         LR    @14,XTNTPTR2                                        1626 09845000
         AL    @14,@CF03047                                        1626 09846000
         STH   @00,XTN2CC1-44(@15,@14)                             1626 09847000
*         XTN2HH1(I)=(DEBDAPTR+REG3)->DEBSTRHH;                    1627 09848000
         LH    @14,DEBSTRHH(,@01)                                  1627 09849000
         N     @14,@CF03043                                        1627 09850000
         ST    @01,@TF00001                                        1627 09851000
         LR    @01,XTNTPTR2                                        1627 09852000
         AL    @01,@CF03048                                        1627 09853000
         STH   @14,XTN2HH1-46(@15,@01)                             1627 09854000
*         XTN2CC2(I)=(DEBDAPTR+REG3)->DEBENDCC;                    1628 09855000
         L     @01,@TF00001                                        1628 09856000
         LH    @14,DEBENDCC(,@01)                                  1628 09857000
         N     @14,@CF03043                                        1628 09858000
         LR    @01,XTNTPTR2                                        1628 09859000
         AL    @01,@CF03049                                        1628 09860000
         STH   @14,XTN2CC2-48(@15,@01)                             1628 09861000
*         XTN2HH2(I)=(DEBDAPTR+REG3)->DEBENDHH;                    1629 09862000
         L     @01,@TF00001                                        1629 09863000
         LH    @14,DEBENDHH(,@01)                                  1629 09864000
         N     @14,@CF03043                                        1629 09865000
         AL    @15,@CF03050                                        1629 09866000
         STH   @14,XTN2HH2-50(@15,XTNTPTR2)                        1629 09867000
*         REG3=I;                                                  1630 09868000
         L     @15,@PC00001+8                                      1630 09869000
         SLR   @14,@14                                             1630 09870000
         IC    @14,I(,@15)                                         1630 09871000
         LR    REG3,@14                                            1630 09872000
*         SLL(REG3,EXTNTVAL);                                      1631 09873000
         L     @01,DEBPTR                                          1631 09874000
         SLR   @15,@15                                             1631 09875000
         IC    @15,EXTNTVAL(,@01)                                  1631 09876000
         SLL   REG3,0(@15)                                         1631 09877000
*       END;                                                       1632 09878000
         L     @14,@PC00001+8                                      1632 09879000
         LA    @15,1                                               1632 09880000
         SLR   @01,@01                                             1632 09881000
         IC    @01,I(,@14)                                         1632 09882000
         ALR   @15,@01                                             1632 09883000
         L     @14,@PC00001+8                                      1632 09884000
         STC   @15,I(,@14)                                         1632 09885000
@DE01625 L     @14,DEBPTR                                          1632 09886000
         SLR   @01,@01                                             1632 09887000
         IC    @01,DEBNMEXT(,@14)                                  1632 09888000
         CR    @15,@01                                             1632 09889000
         BNH   @DL01625                                            1632 09890000
*       RESPECIFY                                                  1633 09891000
*         REG3 UNRESTRICTED;                                       1633 09892000
*                                                                  1633 09893000
*       /*************************************************************/ 09894000
*       /*                                                           */ 09895000
*       /* SET THE LAST ENTRY INDICATOR IN XTNTTBL2                  */ 09896000
*       /*                                                           */ 09897000
*       /*************************************************************/ 09898000
*                                                                  1634 09899000
*       I=I+1;                                                     1634 09900000
         L     @15,@PC00001+8                                      1634 09901000
         LA    @14,1                                               1634 09902000
         SLR   @03,@03                                             1634 09903000
         IC    @03,I(,@15)                                         1634 09904000
         ALR   @14,@03                                             1634 09905000
         STC   @14,I(,@15)                                         1634 09906000
*       XTN2ENT(I)=LASTENT;                                        1635 09907000
*                                                                  1635 09908000
         MH    @14,@CH00797                                        1635 09909000
         ALR   @14,XTNTPTR2                                        1635 09910000
         AL    @14,@CF03051                                        1635 09911000
         MVC   XTN2ENT(52,@14),LASTENT                             1635 09912000
*       /*************************************************************/ 09913000
*       /*                                                           */ 09914000
*       /* CLOSE THE NON-VSAM DATA SET                               */ 09915000
*       /*                                                           */ 09916000
*       /*************************************************************/ 09917000
*                                                                  1636 09918000
*       CALL IDCIOCL0(GDTTBL,REPCDSOP);                            1636 09919000
         L     @15,@PC00001                                        1636 09920000
         ST    @15,@AL00001                                        1636 09921000
         L     @14,@PC00001+8                                      1636 09922000
         LA    @14,REPCDSOP(,@14)                                  1636 09923000
         ST    @14,@AL00001+4                                      1636 09924000
         MVI   @AL00001+4,X'80'                                    1636 09925000
         L     @15,GDTCLS(,@15)                                    1636 09926000
         LA    @01,@AL00001                                        1636 09927000
         BALR  @14,@15                                             1636 09928000
*       REPCDSOP=NULLPTR;                                          1637 09929000
*                                                                  1637 09930000
         L     @15,@PC00001+8                                      1637 09931000
         SLR   @14,@14                                             1637 09932000
         ST    @14,REPCDSOP(,@15)                                  1637 09933000
*       /*************************************************************/ 09934000
*       /*                                                           */ 09935000
*       /* SET THE DATA SET INDICATOR IN THE UEXCP ARG LIST          */ 09936000
*       /*                                                           */ 09937000
*       /*************************************************************/ 09938000
*                                                                  1638 09939000
*       EXORDS=ON;                                                 1638 09940000
         L     @01,REPEXOAR(,@15)                                  1638 09941000
         OI    EXORDS(@01),B'00000100'                             1638 09942000
*     END;                                                         1639 09943000
*                                                                  1640 09944000
*   /*****************************************************************/ 09945000
*   /*                                                               */ 09946000
*   /* THIS SECTION COMPLETES VSAM AND NON-VSAM DATA SET PROCESSING  */ 09947000
*   /* BY BUILDING XTNTTBL TO CONTAIN ONLY THE ENTRIES FROM XTNTTBL2 */ 09948000
*   /* THAT ARE WITHIN THE RANGE SPECIFIED BY THE USER. I INDEXES    */ 09949000
*   /* XTNTTBL2 J INDEXES XTNTTBL K EQUALS XTNTTBL2 ENTRIES          */ 09950000
*   /*                                                               */ 09951000
*   /*****************************************************************/ 09952000
*                                                                  1640 09953000
*   I=1;                                                           1640 09954000
@RC01510 L     @15,@PC00001+8                                      1640 09955000
         MVI   I(@15),X'01'                                        1640 09956000
*   J=1;                                                           1641 09957000
         MVI   J(@15),X'01'                                        1641 09958000
*   K=0;                                                           1642 09959000
*                                                                  1642 09960000
         MVI   K(@15),X'00'                                        1642 09961000
*   /*****************************************************************/ 09962000
*   /*                                                               */ 09963000
*   /* EACH ENTRY IN XTNTTBL2 IS CHECKED AGAINST THE USER SUPPLIED   */ 09964000
*   /* RANGE AND XTNTTBL IS CONSTRUCTED USING THE THE EXTENTS OR     */ 09965000
*   /* PORTIONS OF EXTENTS THAT FALL WITHIN THE RANGE.               */ 09966000
*   /*                                                               */ 09967000
*   /*****************************************************************/ 09968000
*                                                                  1643 09969000
*BLDXTTBL:                                                         1643 09970000
*   DO UNTIL XTN2ENT(I)=LASTENT(1:LENGTH(XTN2ENT));                1643 09971000
*                                                                  1643 09972000
BLDXTTBL DS    0H                                                  1643 09973000
@DL01643 DS    0H                                                  1644 09974000
*     /***************************************************************/ 09975000
*     /*                                                             */ 09976000
*     /* COMPARE THE XTNTTBL2 LOWER LIMIT AGAINST THE USER SUPPLIED  */ 09977000
*     /* RANGE                                                       */ 09978000
*     /*                                                             */ 09979000
*     /***************************************************************/ 09980000
*                                                                  1644 09981000
*     IF XTNHCHR1(1:4)<=XTN2CHR2(I)&XTNHCHR2(1:4)>=XTN2CHR1(I) THEN     09982000
         L     @15,@PC00001+8                                      1644 09983000
         SLR   @14,@14                                             1644 09984000
         IC    @14,I(,@15)                                         1644 09985000
         MH    @14,@CH00797                                        1644 09986000
         ST    @14,@TF00001                                        1644 09987000
         ALR   @14,XTNTPTR2                                        1644 09988000
         AL    @14,@CF03049                                        1644 09989000
         CLC   XTNHCHR1(4,XTNTPTR),XTN2CHR2-48(@14)                1644 09990000
         BH    @RF01644                                            1644 09991000
         LR    @01,XTNTPTR2                                        1644 09992000
         AL    @01,@TF00001                                        1644 09993000
         AL    @01,@CF03047                                        1644 09994000
         CLC   XTNHCHR2(4,XTNTPTR),XTN2CHR1-44(@01)                1644 09995000
         BL    @RF01644                                            1644 09996000
*       DO;                                                        1645 09997000
*                                                                  1645 09998000
*         /***********************************************************/ 09999000
*         /*                                                         */ 10000000
*         /* IF WITHIN THE RANGE (COMPARING CCHH ONLY), SAVE THE     */ 10001000
*         /* DDNAME AND VOLUME SERIAL NUMBER FROM THE EXTENT TABLE   */ 10002000
*         /* HEADER AND THE DSNAME FROM THE XTNTTBL2 ENTRY.          */ 10003000
*         /*                                                         */ 10004000
*         /***********************************************************/ 10005000
*                                                                  1646 10006000
*         K=K+1;                                                   1646 10007000
         LA    @14,1                                               1646 10008000
         SLR   @03,@03                                             1646 10009000
         IC    @03,K(,@15)                                         1646 10010000
         ALR   @03,@14                                             1646 10011000
         STC   @03,K(,@15)                                         1646 10012000
*         XTNTDDN(J)=XTNHDDN;                                      1647 10013000
         SLR   @03,@03                                             1647 10014000
         IC    @03,J(,@15)                                         1647 10015000
         MH    @03,@CH02809                                        1647 10016000
         ST    @03,@TF00002                                        1647 10017000
         ALR   @03,XTNTPTR                                         1647 10018000
         MVC   XTNTDDN-78(8,@03),XTNHDDN(XTNTPTR)                  1647 10019000
*         XTNTDSN(J)=XTNHDSN;                                      1648 10020000
         LR    @01,XTNTPTR                                         1648 10021000
         AL    @01,@TF00002                                        1648 10022000
         MVC   XTNTDSN-78(44,@01),XTNHDSN(XTNTPTR)                 1648 10023000
*         XTNTVOLN(J)=1;                                           1649 10024000
         L     @15,@TF00002                                        1649 10025000
         STC   @14,XTNTVOLN-78(@15,XTNTPTR)                        1649 10026000
*         XTNTVOL(J)=XTNHVOL;                                      1650 10027000
*                                                                  1650 10028000
         LR    @01,XTNTPTR                                         1650 10029000
         AL    @01,@TF00002                                        1650 10030000
         MVC   XTNTVOL-78(6,@01),XTNHVOL(XTNTPTR)                  1650 10031000
*         /***********************************************************/ 10032000
*         /*                                                         */ 10033000
*         /* SET THE XTNTTBL LOWER LIMIT: = USER LOWER LIMIT IF THE  */ 10034000
*         /* REAL EXTENT BEGINS BEFORE THE USER REQUESTED EXTENT =   */ 10035000
*         /* XTNTTBL2 LOWER LIMIT IF THE USER EXTENT BEGINS IN A     */ 10036000
*         /* DIFFERENT REAL EXTENT                                   */ 10037000
*         /*                                                         */ 10038000
*         /***********************************************************/ 10039000
*                                                                  1651 10040000
*         IF XTNHCHR1(1:4)>=XTN2CHR1(I)&XTNHCHR1(1:4)<=XTN2CHR2(I) THEN 10041000
         LR    @01,XTNTPTR2                                        1651 10042000
         AL    @01,@TF00001                                        1651 10043000
         AL    @01,@CF03047                                        1651 10044000
         CLC   XTNHCHR1(4,XTNTPTR),XTN2CHR1-44(@01)                1651 10045000
         BL    @RF01651                                            1651 10046000
         LR    @01,XTNTPTR2                                        1651 10047000
         AL    @01,@TF00001                                        1651 10048000
         AL    @01,@CF03049                                        1651 10049000
         CLC   XTNHCHR1(4,XTNTPTR),XTN2CHR2-48(@01)                1651 10050000
         BH    @RF01651                                            1651 10051000
*           XTNTCHR1(J)=XTNHCHR1;                                  1652 10052000
         LR    @01,XTNTPTR                                         1652 10053000
         AL    @01,@TF00002                                        1652 10054000
         MVC   XTNTCHR1-78(5,@01),XTNHCHR1(XTNTPTR)                1652 10055000
*         ELSE                                                     1653 10056000
*           DO;                                                    1653 10057000
         B     @RC01651                                            1653 10058000
@RF01651 DS    0H                                                  1654 10059000
*             XTNTCHR1(J,1:4)=XTN2CHR1(I);                         1654 10060000
         L     @15,@PC00001+8                                      1654 10061000
         SLR   @14,@14                                             1654 10062000
         IC    @14,J(,@15)                                         1654 10063000
         MH    @14,@CH02809                                        1654 10064000
         ST    @14,@TF00001                                        1654 10065000
         ALR   @14,XTNTPTR                                         1654 10066000
         SLR   @03,@03                                             1654 10067000
         IC    @03,I(,@15)                                         1654 10068000
         MH    @03,@CH00797                                        1654 10069000
         ALR   @03,XTNTPTR2                                        1654 10070000
         AL    @03,@CF03047                                        1654 10071000
         MVC   XTNTCHR1-78(4,@14),XTN2CHR1-44(@03)                 1654 10072000
*             XTNTCHR1(J,5:5)=0;                                   1655 10073000
         SLR   @15,@15                                             1655 10074000
         L     @14,@TF00001                                        1655 10075000
         STC   @15,XTNTCHR1-74(@14,XTNTPTR)                        1655 10076000
*           END;                                                   1656 10077000
*                                                                  1656 10078000
*         /***********************************************************/ 10079000
*         /*                                                         */ 10080000
*         /* SET END OF THIS EXTENT = USER UPPER LIMIT IF USER UPPER */ 10081000
*         /* CCHH IS REALLY LESS THAN THE END OF THIS EXTENT =       */ 10082000
*         /* XTNTTBL2 UPPER LIMIT CCHH IF USER UPPER LIMIT IS IN A   */ 10083000
*         /* DIFFERENT EXTENT                                        */ 10084000
*         /*                                                         */ 10085000
*         /***********************************************************/ 10086000
*                                                                  1657 10087000
*         IF XTNHCHR2(1:4)<=XTN2CHR2(I)&XTNHCHR2(1:4)>=XTN2CHR1(I) THEN 10088000
@RC01651 L     @15,@PC00001+8                                      1657 10089000
         SLR   @14,@14                                             1657 10090000
         IC    @14,I(,@15)                                         1657 10091000
         MH    @14,@CH00797                                        1657 10092000
         ST    @14,@TF00001                                        1657 10093000
         ALR   @14,XTNTPTR2                                        1657 10094000
         AL    @14,@CF03049                                        1657 10095000
         CLC   XTNHCHR2(4,XTNTPTR),XTN2CHR2-48(@14)                1657 10096000
         BH    @RF01657                                            1657 10097000
         LR    @01,XTNTPTR2                                        1657 10098000
         AL    @01,@TF00001                                        1657 10099000
         AL    @01,@CF03047                                        1657 10100000
         CLC   XTNHCHR2(4,XTNTPTR),XTN2CHR1-44(@01)                1657 10101000
         BL    @RF01657                                            1657 10102000
*           XTNTCHR2(J)=XTNHCHR2;                                  1658 10103000
         SLR   @14,@14                                             1658 10104000
         IC    @14,J(,@15)                                         1658 10105000
         MH    @14,@CH02809                                        1658 10106000
         ALR   @14,XTNTPTR                                         1658 10107000
         MVC   XTNTCHR2-78(5,@14),XTNHCHR2(XTNTPTR)                1658 10108000
*         ELSE                                                     1659 10109000
*           DO;                                                    1659 10110000
         B     @RC01657                                            1659 10111000
@RF01657 DS    0H                                                  1660 10112000
*             XTNTCHR2(J,1:4)=XTN2CHR2(I);                         1660 10113000
         L     @15,@PC00001+8                                      1660 10114000
         SLR   @14,@14                                             1660 10115000
         IC    @14,J(,@15)                                         1660 10116000
         MH    @14,@CH02809                                        1660 10117000
         ST    @14,@TF00001                                        1660 10118000
         ALR   @14,XTNTPTR                                         1660 10119000
         SLR   @03,@03                                             1660 10120000
         IC    @03,I(,@15)                                         1660 10121000
         MH    @03,@CH00797                                        1660 10122000
         ALR   @03,XTNTPTR2                                        1660 10123000
         AL    @03,@CF03049                                        1660 10124000
         MVC   XTNTCHR2-78(4,@14),XTN2CHR2-48(@03)                 1660 10125000
*             XTNTCHR2(J,5:5)='FF'X;                               1661 10126000
         LR    @01,XTNTPTR                                         1661 10127000
         AL    @01,@TF00001                                        1661 10128000
         MVI   XTNTCHR2-74(@01),X'FF'                              1661 10129000
*           END;                                                   1662 10130000
*         I=I+1;                                                   1663 10131000
@RC01657 L     @15,@PC00001+8                                      1663 10132000
         LA    @14,1                                               1663 10133000
         SLR   @03,@03                                             1663 10134000
         IC    @03,I(,@15)                                         1663 10135000
         ALR   @03,@14                                             1663 10136000
         STC   @03,I(,@15)                                         1663 10137000
*         J=J+1;                                                   1664 10138000
         SLR   @03,@03                                             1664 10139000
         IC    @03,J(,@15)                                         1664 10140000
         ALR   @14,@03                                             1664 10141000
         STC   @14,J(,@15)                                         1664 10142000
*       END;                                                       1665 10143000
*                                                                  1665 10144000
*     /***************************************************************/ 10145000
*     /*                                                             */ 10146000
*     /* IF NEITHER XTNTTBL2 LIMIT IS WITHIN THE USER'S RANGE, SKIP  */ 10147000
*     /* THIS XTNTTBL2 ENTRY.                                        */ 10148000
*     /*                                                             */ 10149000
*     /***************************************************************/ 10150000
*                                                                  1666 10151000
*     ELSE                                                         1666 10152000
*       I=I+1;                                                     1666 10153000
         B     @RC01644                                            1666 10154000
@RF01644 L     @15,@PC00001+8                                      1666 10155000
         LA    @14,1                                               1666 10156000
         SLR   @03,@03                                             1666 10157000
         IC    @03,I(,@15)                                         1666 10158000
         ALR   @14,@03                                             1666 10159000
         STC   @14,I(,@15)                                         1666 10160000
*   END BLDXTTBL;                                                  1667 10161000
*                                                                  1667 10162000
@RC01644 DS    0H                                                  1667 10163000
@DE01643 L     @15,@PC00001+8                                      1667 10164000
         SLR   @14,@14                                             1667 10165000
         IC    @14,I(,@15)                                         1667 10166000
         MH    @14,@CH00797                                        1667 10167000
         ALR   @14,XTNTPTR2                                        1667 10168000
         AL    @14,@CF03051                                        1667 10169000
         CLC   XTN2ENT(52,@14),LASTENT                             1667 10170000
         BNE   @DL01643                                            1667 10171000
*   /*****************************************************************/ 10172000
*   /*                                                               */ 10173000
*   /* SET LAST EXTENT ENTRY INDICATOR IN XTNTTBL                    */ 10174000
*   /*                                                               */ 10175000
*   /*****************************************************************/ 10176000
*                                                                  1668 10177000
*   XTNTENT(J)=LASTENT;                                            1668 10178000
*                                                                  1668 10179000
         LA    @04,78                                              1668 10180000
         SLR   @01,@01                                             1668 10181000
         IC    @01,J(,@15)                                         1668 10182000
         MR    @00,@04                                             1668 10183000
         ALR   @01,XTNTPTR                                         1668 10184000
         MVC   XTNTENT-78(78,@01),LASTENT                          1668 10185000
*   /*****************************************************************/ 10186000
*   /*                                                               */ 10187000
*   /* IF NO ENTRIES WERE MADE IN XTNTTBL, PREPARE TO RETURN TO THE  */ 10188000
*   /* CALLER WITH RC = 12                                           */ 10189000
*   /*                                                               */ 10190000
*   /*****************************************************************/ 10191000
*                                                                  1669 10192000
*   I=1;                                                           1669 10193000
         LA    @14,1                                               1669 10194000
         STC   @14,I(,@15)                                         1669 10195000
*   IF XTNTENT(I)=LASTENT THEN                                     1670 10196000
         LR    @01,@14                                             1670 10197000
         MR    @00,@04                                             1670 10198000
         ALR   @01,XTNTPTR                                         1670 10199000
         CLC   XTNTENT-78(78,@01),LASTENT                          1670 10200000
         BNE   @RF01670                                            1670 10201000
*     DO;                                                          1671 10202000
*       IF ADDR(MODIF)^=NULLPTR&IOPARM=OUTPUT THEN                 1672 10203000
*                                                                  1672 10204000
         L     @04,@PC00001+4                                      1672 10205000
         L     @01,FDTPTR+356(,@04)                                1672 10206000
         LTR   @01,@01                                             1672 10207000
         BZ    @RF01672                                            1672 10208000
         L     @04,@PC00002                                        1672 10209000
         CLI   IOPARM(@04),C'O'                                    1672 10210000
         BNE   @RF01672                                            1672 10211000
*         /***********************************************************/ 10212000
*         /*                                                         */ 10213000
*         /* WRITE ERROR MESSAGE IDC31223I                           */ 10214000
*         /*                                                         */ 10215000
*         /***********************************************************/ 10216000
*                                                                  1673 10217000
*         DO;                                                      1673 10218000
*           CKREQ=CKREQ&&CKREQ;                                    1674 10219000
         XC    CKREQ(44,@15),CKREQ(@15)                            1674 10220000
*           CKRERN=MSG23;                                          1675 10221000
         MVC   CKRERN(2,@15),@CH00666                              1675 10222000
*           CKRMVAR(1)=ADDR(XTNHVOL);                              1676 10223000
         LA    @04,XTNHVOL(,XTNTPTR)                               1676 10224000
         ST    @04,CKRMVAR(,@15)                                   1676 10225000
*           CKRMVAR(2)=ADDR(XTNHCHR2);                             1677 10226000
         LA    @04,XTNHCHR2(,XTNTPTR)                              1677 10227000
         ST    @04,CKRMVAR+4(,@15)                                 1677 10228000
*           CKRMVAR(3)=ADDR(OUTDSADD);                             1678 10229000
         LA    @04,@CC02839                                        1678 10230000
         ST    @04,CKRMVAR+8(,@15)                                 1678 10231000
*           CKRMVAR(4)=ADDR(XTNHDSN);                              1679 10232000
         LA    @04,XTNHDSN(,XTNTPTR)                               1679 10233000
         ST    @04,CKRMVAR+12(,@15)                                1679 10234000
*           CALL IDCRDER;                                          1680 10235000
         L     @15,@CV01553                                        1680 10236000
         BALR  @14,@15                                             1680 10237000
*         END;                                                     1681 10238000
*       ELSE                                                       1682 10239000
*         IF ADDR(MODIF)^=NULLPTR&IOPARM=INPUT THEN                1682 10240000
*                                                                  1682 10241000
         B     @RC01672                                            1682 10242000
@RF01672 L     @04,@PC00001+4                                      1682 10243000
         L     @04,FDTPTR+356(,@04)                                1682 10244000
         LTR   @04,@04                                             1682 10245000
         BZ    @RF01682                                            1682 10246000
         L     @04,@PC00002                                        1682 10247000
         CLI   IOPARM(@04),C'I'                                    1682 10248000
         BNE   @RF01682                                            1682 10249000
*           /*********************************************************/ 10250000
*           /*                                                       */ 10251000
*           /* WRITE ERROR MESSAGE IDC31221I                         */ 10252000
*           /*                                                       */ 10253000
*           /*********************************************************/ 10254000
*                                                                  1683 10255000
*           DO;                                                    1683 10256000
*             CKREQ=CKREQ&&CKREQ;                                  1684 10257000
         L     @04,@PC00001+8                                      1684 10258000
         XC    CKREQ(44,@04),CKREQ(@04)                            1684 10259000
*             CKRERN=MSG21;                                        1685 10260000
         MVC   CKRERN(2,@04),@CH00651                              1685 10261000
*             CKRMVAR(1)=ADDR(XTNHVOL);                            1686 10262000
         LA    @01,XTNHVOL(,XTNTPTR)                               1686 10263000
         ST    @01,CKRMVAR(,@04)                                   1686 10264000
*             CKRMVAR(2)=ADDR(XTNHCHR1);                           1687 10265000
         LA    @01,XTNHCHR1(,XTNTPTR)                              1687 10266000
         ST    @01,CKRMVAR+4(,@04)                                 1687 10267000
*             CKRMVAR(3)=ADDR(XTNHDSN);                            1688 10268000
         LA    @01,XTNHDSN(,XTNTPTR)                               1688 10269000
         ST    @01,CKRMVAR+8(,@04)                                 1688 10270000
*             CALL IDCRDER;                                        1689 10271000
         L     @15,@CV01553                                        1689 10272000
         BALR  @14,@15                                             1689 10273000
*           END;                                                   1690 10274000
*         ELSE                                                     1691 10275000
*                                                                  1691 10276000
*           /*********************************************************/ 10277000
*           /*                                                       */ 10278000
*           /* WRITE ERROR MESSAGE IDC31212I                         */ 10279000
*           /*                                                       */ 10280000
*           /*********************************************************/ 10281000
*                                                                  1691 10282000
*           DO;                                                    1691 10283000
         B     @RC01682                                            1691 10284000
@RF01682 DS    0H                                                  1692 10285000
*             CKREQ=CKREQ&&CKREQ;                                  1692 10286000
         L     @04,@PC00001+8                                      1692 10287000
         XC    CKREQ(44,@04),CKREQ(@04)                            1692 10288000
*             CKRERN=MSG12;                                        1693 10289000
         MVC   CKRERN(2,@04),@CH00039                              1693 10290000
*             CKRMVAR(1)=ADDR(XTNHCHR1);                           1694 10291000
         LA    @01,XTNHCHR1(,XTNTPTR)                              1694 10292000
         ST    @01,CKRMVAR(,@04)                                   1694 10293000
*             CKRMVAR(2)=ADDR(XTNHCHR2);                           1695 10294000
         LA    @01,XTNHCHR2(,XTNTPTR)                              1695 10295000
         ST    @01,CKRMVAR+4(,@04)                                 1695 10296000
*             CKRMVAR(3)=ADDR(XTNHDSN);                            1696 10297000
         LA    @01,XTNHDSN(,XTNTPTR)                               1696 10298000
         ST    @01,CKRMVAR+8(,@04)                                 1696 10299000
*             CALL IDCRDER;                                        1697 10300000
         L     @15,@CV01553                                        1697 10301000
         BALR  @14,@15                                             1697 10302000
*           END;                                                   1698 10303000
*                                                                  1698 10304000
*       /*************************************************************/ 10305000
*       /*                                                           */ 10306000
*       /* FREE THE BUFFERS                                          */ 10307000
*       /*                                                           */ 10308000
*       /*************************************************************/ 10309000
*                                                                  1699 10310000
*       CALL IDCSAFP0(GDTTBL,RD01,ALL);                            1699 10311000
*                                                                  1699 10312000
@RC01682 DS    0H                                                  1699 10313000
@RC01672 MVC   @AL00001+4(8),@AL01699                              1699 10314000
         L     @01,@PC00001                                        1699 10315000
         ST    @01,@AL00001                                        1699 10316000
         L     @15,GDTFPL(,@01)                                    1699 10317000
         LA    @01,@AL00001                                        1699 10318000
         BALR  @14,@15                                             1699 10319000
*       /*************************************************************/ 10320000
*       /*                                                           */ 10321000
*       /* RETURN TO THE CALLER WITH RC = 12                         */ 10322000
*       /*                                                           */ 10323000
*       /*************************************************************/ 10324000
*                                                                  1700 10325000
*       RETURN CODE(LASTCC12);                                     1700 10326000
         LA    @15,12                                              1700 10327000
         L     @14,@SA00002                                        1700 10328000
         LM    @00,@12,@SA00002+8                                  1700 10329000
         BR    @14                                                 1700 10330000
*     END;                                                         1701 10331000
*                                                                  1701 10332000
*   /*****************************************************************/ 10333000
*   /*                                                               */ 10334000
*   /* SORT THE XTNTTBL ENTRIES INTO ASCENDING SEQUENCE OF STARTING  */ 10335000
*   /* ADDRESS. K = NUMBER OF ENTRIES IN TABLE.                      */ 10336000
*   /*                                                               */ 10337000
*   /*****************************************************************/ 10338000
*                                                                  1702 10339000
*   DO I=1 TO K;                                                   1702 10340000
@RF01670 LA    @04,1                                               1702 10341000
         B     @DE01702                                            1702 10342000
@DL01702 DS    0H                                                  1703 10343000
*     DO J=I TO K;                                                 1703 10344000
         L     @04,@PC00001+8                                      1703 10345000
         SLR   @01,@01                                             1703 10346000
         IC    @01,I(,@04)                                         1703 10347000
         B     @DE01703                                            1703 10348000
@DL01703 DS    0H                                                  1704 10349000
*       IF XTNTCHR1(I)>XTNTCHR1(J+1) THEN                          1704 10350000
         LA    @04,78                                              1704 10351000
         L     @01,@PC00001+8                                      1704 10352000
         SLR   @03,@03                                             1704 10353000
         IC    @03,I(,@01)                                         1704 10354000
         MR    @02,@04                                             1704 10355000
         LR    @15,@04                                             1704 10356000
         SLR   @04,@04                                             1704 10357000
         IC    @04,J(,@01)                                         1704 10358000
         MR    @14,@04                                             1704 10359000
         ST    @03,@TF00001                                        1704 10360000
         ALR   @03,XTNTPTR                                         1704 10361000
         ST    @15,@TF00002                                        1704 10362000
         ALR   @15,XTNTPTR                                         1704 10363000
         CLC   XTNTCHR1-78(5,@03),XTNTCHR1(@15)                    1704 10364000
         BNH   @RF01704                                            1704 10365000
*         DO;                                                      1705 10366000
*           XTNTHOLD=XTNTENT(I);                                   1706 10367000
         LR    @04,XTNTPTR                                         1706 10368000
         AL    @04,@TF00001                                        1706 10369000
         MVC   XTNTHOLD(78),XTNTENT-78(@04)                        1706 10370000
*           XTNTENT(I)=XTNTENT(J+1);                               1707 10371000
         LR    @04,XTNTPTR                                         1707 10372000
         AL    @04,@TF00001                                        1707 10373000
         LR    @01,XTNTPTR                                         1707 10374000
         AL    @01,@TF00002                                        1707 10375000
         MVC   @TS00001(78),XTNTENT(@01)                           1707 10376000
         MVC   XTNTENT-78(78,@04),@TS00001                         1707 10377000
*           XTNTENT(J+1)=XTNTHOLD;                                 1708 10378000
         LR    @04,XTNTPTR                                         1708 10379000
         AL    @04,@TF00002                                        1708 10380000
         MVC   XTNTENT(78,@04),XTNTHOLD                            1708 10381000
*         END;                                                     1709 10382000
*     END;                                                         1710 10383000
@RF01704 L     @04,@PC00001+8                                      1710 10384000
         LA    @01,1                                               1710 10385000
         SLR   @15,@15                                             1710 10386000
         IC    @15,J(,@04)                                         1710 10387000
         ALR   @01,@15                                             1710 10388000
@DE01703 L     @04,@PC00001+8                                      1710 10389000
         STC   @01,J(,@04)                                         1710 10390000
         L     @04,@PC00001+8                                      1710 10391000
         SLR   @15,@15                                             1710 10392000
         IC    @15,K(,@04)                                         1710 10393000
         CR    @01,@15                                             1710 10394000
         BNH   @DL01703                                            1710 10395000
*   END;                                                           1711 10396000
*                                                                  1711 10397000
         L     @01,@PC00001+8                                      1711 10398000
         LA    @04,1                                               1711 10399000
         SLR   @15,@15                                             1711 10400000
         IC    @15,I(,@01)                                         1711 10401000
         ALR   @04,@15                                             1711 10402000
@DE01702 L     @01,@PC00001+8                                      1711 10403000
         STC   @04,I(,@01)                                         1711 10404000
         L     @01,@PC00001+8                                      1711 10405000
         SLR   @15,@15                                             1711 10406000
         IC    @15,K(,@01)                                         1711 10407000
         CR    @04,@15                                             1711 10408000
         BNH   @DL01702                                            1711 10409000
*   /*****************************************************************/ 10410000
*   /*                                                               */ 10411000
*   /* CHECK THE EXTENT LIST FOR DUPLICATE ENTRIES THAT CAN EXIST IN */ 10412000
*   /* KSDS DATA SETS K STILL EQUALS THE NUMBER OF EXTENT TABLE      */ 10413000
*   /* ENTRIES                                                       */ 10414000
*   /*                                                               */ 10415000
*   /*****************************************************************/ 10416000
*                                                                  1712 10417000
*   I=1;                                                           1712 10418000
         L     @04,@PC00001+8                                      1712 10419000
         MVI   I(@04),X'01'                                        1712 10420000
*   DO WHILE XTNTENT(I)^=LASTENT;                                  1713 10421000
         B     @DE01713                                            1713 10422000
@DL01713 DS    0H                                                  1714 10423000
*     IF XTNTENT(I)=XTNTENT(I+1) THEN                              1714 10424000
         L     @04,@PC00001+8                                      1714 10425000
         SLR   @01,@01                                             1714 10426000
         IC    @01,I(,@04)                                         1714 10427000
         LR    @04,@01                                             1714 10428000
         MH    @04,@CH02809                                        1714 10429000
         ST    @04,@TF00001                                        1714 10430000
         ALR   @04,XTNTPTR                                         1714 10431000
         LR    @15,XTNTPTR                                         1714 10432000
         AL    @15,@TF00001                                        1714 10433000
         CLC   XTNTENT-78(78,@04),XTNTENT(@15)                     1714 10434000
         BNE   @RF01714                                            1714 10435000
*       DO J=I TO K;                                               1715 10436000
         B     @DE01715                                            1715 10437000
@DL01715 DS    0H                                                  1716 10438000
*         XTNTENT(J)=XTNTENT(J+1);                                 1716 10439000
         L     @04,@PC00001+8                                      1716 10440000
         SLR   @01,@01                                             1716 10441000
         IC    @01,J(,@04)                                         1716 10442000
         MH    @01,@CH02809                                        1716 10443000
         ST    @01,@TF00001                                        1716 10444000
         ALR   @01,XTNTPTR                                         1716 10445000
         LR    @04,XTNTPTR                                         1716 10446000
         AL    @04,@TF00001                                        1716 10447000
         MVC   XTNTENT-78(78,@01),XTNTENT(@04)                     1716 10448000
*       END;                                                       1717 10449000
         L     @04,@PC00001+8                                      1717 10450000
         LA    @01,1                                               1717 10451000
         SLR   @00,@00                                             1717 10452000
         IC    @00,J(,@04)                                         1717 10453000
         ALR   @01,@00                                             1717 10454000
@DE01715 L     @04,@PC00001+8                                      1717 10455000
         STC   @01,J(,@04)                                         1717 10456000
         L     @04,@PC00001+8                                      1717 10457000
         SLR   @00,@00                                             1717 10458000
         IC    @00,K(,@04)                                         1717 10459000
         CR    @01,@00                                             1717 10460000
         BNH   @DL01715                                            1717 10461000
*     ELSE                                                         1718 10462000
*       I=I+1;                                                     1718 10463000
         B     @RC01714                                            1718 10464000
@RF01714 L     @04,@PC00001+8                                      1718 10465000
         LA    @15,1                                               1718 10466000
         SLR   @14,@14                                             1718 10467000
         IC    @14,I(,@04)                                         1718 10468000
         ALR   @15,@14                                             1718 10469000
         STC   @15,I(,@04)                                         1718 10470000
*   END;                                                           1719 10471000
*                                                                  1719 10472000
@RC01714 DS    0H                                                  1719 10473000
@DE01713 LA    @04,78                                              1719 10474000
         L     @15,@PC00001+8                                      1719 10475000
         SLR   @01,@01                                             1719 10476000
         IC    @01,I(,@15)                                         1719 10477000
         MR    @00,@04                                             1719 10478000
         ALR   @01,XTNTPTR                                         1719 10479000
         CLC   XTNTENT-78(78,@01),LASTENT                          1719 10480000
         BNE   @DL01713                                            1719 10481000
*   /*****************************************************************/ 10482000
*   /*                                                               */ 10483000
*   /* CONSTRUCT THE OPEN ARGUMENT LIST (EXOARG)                     */ 10484000
*   /*                                                               */ 10485000
*   /*****************************************************************/ 10486000
*                                                                  1720 10487000
*   I=1;                                                           1720 10488000
         LA    @14,1                                               1720 10489000
         STC   @14,I(,@15)                                         1720 10490000
*   EXODDN=ADDR(XTNTDDN(I));                                       1721 10491000
         L     @03,REPEXOAR(,@15)                                  1721 10492000
         LR    @01,@14                                             1721 10493000
         MR    @00,@04                                             1721 10494000
         LA    @04,XTNTDDN-78(@01,XTNTPTR)                         1721 10495000
         ST    @04,EXODDN(,@03)                                    1721 10496000
*   EXODSN=ADDR(XTNTDSN(I));                                       1722 10497000
         LA    @04,XTNTDSN-78(@01,XTNTPTR)                         1722 10498000
         ST    @04,EXODSN(,@03)                                    1722 10499000
*   IF XTNHMODE=INPUT THEN                                         1723 10500000
         CLI   XTNHMODE(XTNTPTR),C'I'                              1723 10501000
         BNE   @RF01723                                            1723 10502000
*     EXOCTLBK=ADDR(REPIDSOP);                                     1724 10503000
         LA    @04,REPIDSOP(,@15)                                  1724 10504000
         ST    @04,EXOCTLBK(,@03)                                  1724 10505000
*   ELSE                                                           1725 10506000
*     EXOCTLBK=ADDR(REPODSOP);                                     1725 10507000
         B     @RC01723                                            1725 10508000
@RF01723 L     @04,@PC00001+8                                      1725 10509000
         L     @01,REPEXOAR(,@04)                                  1725 10510000
         LA    @04,REPODSOP(,@04)                                  1725 10511000
         ST    @04,EXOCTLBK(,@01)                                  1725 10512000
*   EXOREP=ON;                                                     1726 10513000
@RC01723 L     @04,@PC00001+8                                      1726 10514000
         L     @15,REPEXOAR(,@04)                                  1726 10515000
         OI    EXOREP(@15),B'00000100'                             1726 10516000
*   EXOEXT=ADDR(XTNTCHR1(I));                                      1727 10517000
*                                                                  1727 10518000
         SLR   @14,@14                                             1727 10519000
         IC    @14,I(,@04)                                         1727 10520000
         MH    @14,@CH02809                                        1727 10521000
         LA    @04,XTNTCHR1-78(@14,XTNTPTR)                        1727 10522000
         ST    @04,EXOEXT(,@15)                                    1727 10523000
*   /*****************************************************************/ 10524000
*   /*                                                               */ 10525000
*   /* ISSUE UEXCP OPENR TO OPEN THE FIRST EXTENT.                   */ 10526000
*   /*                                                               */ 10527000
*   /*****************************************************************/ 10528000
*                                                                  1728 10529000
*   CALL IDCIO050(GDTTBL,OPENR,EXOARG);                            1728 10530000
*                                                                  1728 10531000
         L     @14,@PC00001                                        1728 10532000
         ST    @14,@AL00001                                        1728 10533000
         LA    @05,@CC02024                                        1728 10534000
         ST    @05,@AL00001+4                                      1728 10535000
         ST    @15,@AL00001+8                                      1728 10536000
         MVI   @AL00001+8,X'80'                                    1728 10537000
         L     @15,GDTEXP(,@14)                                    1728 10538000
         LA    @01,@AL00001                                        1728 10539000
         BALR  @14,@15                                             1728 10540000
*   /*****************************************************************/ 10541000
*   /*                                                               */ 10542000
*   /* SAVE THE RETURN CODE FROM UEXCP                               */ 10543000
*   /*                                                               */ 10544000
*   /*****************************************************************/ 10545000
*                                                                  1729 10546000
*   RESPECIFY                                                      1729 10547000
*     RTNREG RSTD;                                                 1729 10548000
*   TESTRC=RTNREG;                                                 1730 10549000
         STH   RTNREG,TESTRC                                       1730 10550000
*   RESPECIFY                                                      1731 10551000
*     RTNREG UNRSTD;                                               1731 10552000
*                                                                  1731 10553000
*   /*****************************************************************/ 10554000
*   /*                                                               */ 10555000
*   /* IF UEXCP FAILS, PREPARE TO RETURN TO THE CALLER WITH RC = 12  */ 10556000
*   /*                                                               */ 10557000
*   /*****************************************************************/ 10558000
*                                                                  1732 10559000
*   IF TESTRC^=0 THEN                                              1732 10560000
         LH    @15,TESTRC                                          1732 10561000
         LTR   @15,@15                                             1732 10562000
         BZ    @RF01732                                            1732 10563000
*     DO;                                                          1733 10564000
*                                                                  1733 10565000
*       /*************************************************************/ 10566000
*       /*                                                           */ 10567000
*       /* FREE THE BUFFERS                                          */ 10568000
*       /*                                                           */ 10569000
*       /*************************************************************/ 10570000
*                                                                  1734 10571000
*       CALL IDCSAFP0(GDTTBL,RD01,ALL);                            1734 10572000
*                                                                  1734 10573000
         MVC   @AL00001+4(8),@AL01734                              1734 10574000
         L     @15,@PC00001                                        1734 10575000
         ST    @15,@AL00001                                        1734 10576000
         L     @15,GDTFPL(,@15)                                    1734 10577000
         LA    @01,@AL00001                                        1734 10578000
         BALR  @14,@15                                             1734 10579000
*       /*************************************************************/ 10580000
*       /*                                                           */ 10581000
*       /* RETURN TO THE CALLER WITH RC = 12                         */ 10582000
*       /*                                                           */ 10583000
*       /*************************************************************/ 10584000
*                                                                  1735 10585000
*       RETURN CODE(LASTCC12);                                     1735 10586000
         LA    @15,12                                              1735 10587000
         L     @14,@SA00002                                        1735 10588000
         LM    @00,@12,@SA00002+8                                  1735 10589000
         BR    @14                                                 1735 10590000
*     END;                                                         1736 10591000
*                                                                  1736 10592000
*   /*****************************************************************/ 10593000
*   /*                                                               */ 10594000
*   /* SET DUMP POINT                                                */ 10595000
*   /*                                                               */ 10596000
*   /*****************************************************************/ 10597000
*                                                                  1737 10598000
*   IF GDTDBG=NULLPTR THEN                                         1737 10599000
@RF01732 L     @15,@PC00001                                        1737 10600000
         L     @15,GDTDBG(,@15)                                    1737 10601000
         LTR   @15,@15                                             1737 10602000
         BZ    @RT01737                                            1737 10603000
*     ;                                                            1738 10604000
*   ELSE                                                           1739 10605000
*     CALL IDCDB010(GDTTBL,'RD6Q');                                1739 10606000
*                                                                  1739 10607000
         L     @15,@PC00001                                        1739 10608000
         ST    @15,@AL00001                                        1739 10609000
         LA    @14,@CC02935                                        1739 10610000
         ST    @14,@AL00001+4                                      1739 10611000
         MVI   @AL00001+4,X'80'                                    1739 10612000
         L     @15,GDTDBG(,@15)                                    1739 10613000
         LA    @01,@AL00001                                        1739 10614000
         BALR  @14,@15                                             1739 10615000
*   /*****************************************************************/ 10616000
*   /*                                                               */ 10617000
*   /* ALL DATA SET PROCESSING COMPLETE RETURN TO THE CALLER WITH RC */ 10618000
*   /* = 00                                                          */ 10619000
*   /*                                                               */ 10620000
*   /*****************************************************************/ 10621000
*                                                                  1740 10622000
*   RETURN CODE(LASTCC00);                                         1740 10623000
@RT01737 SLR   @15,@15                                             1740 10624000
         L     @14,@SA00002                                        1740 10625000
         LM    @00,@12,@SA00002+8                                  1740 10626000
         BR    @14                                                 1740 10627000
*IDCRDIN:                                                          1741 10628000
*   PROCEDURE;                                                     1741 10629000
*                                                                  1741 10630000
IDCRDIN  STM   @14,@12,@SA00003                                    1741 10631000
*/********************************************************************/ 10632000
*/*                                                                  */ 10633000
*/* PROCEDURE NAME -IDCRDIN                                          */ 10634000
*/*                                                                  */ 10635000
*/* FUNCTION - THIS SUBROUTINE IS CALLED TO OBTAIN THE NAME OF THE   */ 10636000
*/*            DATA SET BEING OPENED BY ISSUING THE UIOINFO MACRO.   */ 10637000
*/*            IF THE DATA SET NAME CANNOT BE LOCATED OR IF UIOINFO  */ 10638000
*/*            FAILS, THE DATA SET NAME FIELD, XTNHDSN IN XTNTTBL,   */ 10639000
*/*            IS SET TO BLANKS, ELSE XTNHDSN IS SET EQUAL TO THE    */ 10640000
*/*            DATA SET NAME IN THE UIOINFO RETURN AREA.             */ 10641000
*/*                                                                  */ 10642000
*/********************************************************************/ 10643000
*                                                                  1742 10644000
*                                                                  1742 10645000
*   /*****************************************************************/ 10646000
*   /*                                                               */ 10647000
*   /* ISSUE UIOINFO TO GET DATA SET NAME CONSTRUCT UIOINFO OPTION   */ 10648000
*   /* BYTE                                                          */ 10649000
*   /*                                                               */ 10650000
*   /*****************************************************************/ 10651000
*                                                                  1742 10652000
*   IOINFOPT=''B;                                                  1742 10653000
         LA    @04,INFOBYT                                         1742 10654000
         MVI   IOINFOPT(@04),X'00'                                 1742 10655000
*   IOINFDSN=ON;                                                   1743 10656000
*                                                                  1743 10657000
         OI    IOINFDSN(@04),B'00100000'                           1743 10658000
*   /*****************************************************************/ 10659000
*   /*                                                               */ 10660000
*   /* ISSUE UIOINFO                                                 */ 10661000
*   /*                                                               */ 10662000
*   /*****************************************************************/ 10663000
*                                                                  1744 10664000
*   CALL IDCIOSI0(GDTTBL,IOINFOPT,INFOPTR,INFODD);                 1744 10665000
*                                                                  1744 10666000
         L     @15,@PC00001                                        1744 10667000
         ST    @15,@AL00001                                        1744 10668000
         ST    @04,@AL00001+4                                      1744 10669000
         LA    @04,INFOPTR                                         1744 10670000
         ST    @04,@AL00001+8                                      1744 10671000
         LA    @04,INFODD                                          1744 10672000
         ST    @04,@AL00001+12                                     1744 10673000
         MVI   @AL00001+12,X'80'                                   1744 10674000
         L     @15,GDTIFO(,@15)                                    1744 10675000
         LA    @01,@AL00001                                        1744 10676000
         BALR  @14,@15                                             1744 10677000
*   /*****************************************************************/ 10678000
*   /*                                                               */ 10679000
*   /* SAVE RETURN CODE FROM UIOINFO                                 */ 10680000
*   /*                                                               */ 10681000
*   /*****************************************************************/ 10682000
*                                                                  1745 10683000
*   RESPECIFY                                                      1745 10684000
*     RTNREG RSTD;                                                 1745 10685000
*   TESTRC=RTNREG;                                                 1746 10686000
         STH   RTNREG,TESTRC                                       1746 10687000
*   RESPECIFY                                                      1747 10688000
*     RTNREG UNRSTD;                                               1747 10689000
*                                                                  1747 10690000
*   /*****************************************************************/ 10691000
*   /*                                                               */ 10692000
*   /* IF UIOINFO IS SUCCESSFUL, LOCATE DSNAME                       */ 10693000
*   /*                                                               */ 10694000
*   /*****************************************************************/ 10695000
*                                                                  1748 10696000
*   IF TESTRC=0 THEN                                               1748 10697000
         LH    @04,TESTRC                                          1748 10698000
         LTR   @04,@04                                             1748 10699000
         BNZ   @RF01748                                            1748 10700000
*     DO;                                                          1749 10701000
*       INFDSNPT=INFOPTR+LENGTH(INFAREAL)+LENGTH(INFDATAL);        1750 10702000
         LA    INFDSNPT,4                                          1750 10703000
         AL    INFDSNPT,INFOPTR                                    1750 10704000
*       RESPECIFY                                                  1751 10705000
*         INFODSN BASED(INFDSNPT);                                 1751 10706000
*       IF INFDSNID=DSNIDENT THEN                                  1752 10707000
         CLC   INFDSNID(2,INFDSNPT),@CH00221                       1752 10708000
         BNE   @RF01752                                            1752 10709000
*         XTNHDSN=INFDSN;                                          1753 10710000
         MVC   XTNHDSN(44,XTNTPTR),INFDSN(INFDSNPT)                1753 10711000
*       ELSE                                                       1754 10712000
*         XTNHDSN=BLANKS;                                          1754 10713000
         B     @RC01752                                            1754 10714000
@RF01752 MVC   XTNHDSN(44,XTNTPTR),BLANKS                          1754 10715000
*     END;                                                         1755 10716000
*                                                                  1755 10717000
*   /*****************************************************************/ 10718000
*   /*                                                               */ 10719000
*   /* IF UIOINFO IS UNSUCCESSFUL, SET DSNAME EQUAL TO BLANKS        */ 10720000
*   /*                                                               */ 10721000
*   /*****************************************************************/ 10722000
*                                                                  1756 10723000
*   ELSE                                                           1756 10724000
*     XTNHDSN=BLANKS;                                              1756 10725000
         B     @RC01748                                            1756 10726000
@RF01748 MVC   XTNHDSN(44,XTNTPTR),BLANKS                          1756 10727000
*   RETURN CODE(LASTCC00);                                         1757 10728000
@RC01748 SLR   @15,@15                                             1757 10729000
         L     @14,@SA00003                                        1757 10730000
         LM    @00,@12,@SA00003+8                                  1757 10731000
         BR    @14                                                 1757 10732000
*   END IDCRDIN;                                                   1758 10733000
*   END IDCRDDS;                                                   1759 10734000
*                                                                  1760 10735000
*/********************************************************************/ 10736000
*/*                                                                  */ 10737000
*/*  PROCEDURE NAME - IDCRDRD                                        */ 10738000
*/*                                                                  */ 10739000
*/*  DESCRIPTIVE NAME - SREADREC                                     */ 10740000
*/*                                                                  */ 10741000
*/*  DESCRIPTION - SREADREC IS USED TO READ ALL POSSIBLE             */ 10742000
*/*           RECORDS ON A TRACK, AND TO RETURN A                    */ 10743000
*/*           POINTER TO THE REQUESTED RECORD WITH A                 */ 10744000
*/*           RETURN CODE INDICATING A COMBINATION                   */ 10745000
*/*           OF THE RESULTS OF READING THE COUNT FIELD              */ 10746000
*/*           OF THE REQUESTED RECORD, AND THE KEY/DATA              */ 10747000
*/*           FIELDS FOR THAT RECORD                                 */ 10748000
*/*                                                                  */ 10749000
*/*  INPUT - THE FOLLOWING FIELDS OF RDARG:                          */ 10750000
*/*          RDCTLBL - I/O CNTL BLK POINTER                          */ 10751000
*/*          RDIOAREA- READ BUFFER AREA PTR                          */ 10752000
*/*          RDLOCPTR- LOCATION TABLE POINTER                        */ 10753000
*/*          RDCC    - CYLINDER ADDR OR REQUESTED RECORD             */ 10754000
*/*          RDHH    - TRACK    ADDR OR REQUESTED RECORD             */ 10755000
*/*          RDRECNUM- REQUESTED RECORD NUMBER                       */ 10756000
*/*          RDDS    - ZERO FOR DATA SET REQUEST                     */ 10757000
*/*          RDRWPKLN- LENGTH PTR IF NECESSARY                       */ 10758000
*/*                                                                  */ 10759000
*/*  OUTPUT - THE FOLLOWING FIELD  OF RDARG:                         */ 10760000
*/*           RDDARE - ADDR OF THE REQUESTED RECORD                  */ 10761000
*/*                                                                  */ 10762000
*/*         - ONE OF THE FOLLOWING RETURN CODES:                     */ 10763000
*/*           NOTE THAT THE '*'ED RETURN CODES                       */ 10764000
*/*            INDICATE AN ACTUAL ERROR NOT RELATED                  */ 10765000
*/*            TO AN MSS STAGE OR DESTAGE ERROR-                     */ 10766000
*/*           REPAIRV PROCESSING WILL TERMINATE FOR ALL              */ 10767000
*/*            '*'ED RETURN CODES OVER 16                            */ 10768000
*/*                                                                  */ 10769000
*/*            CODE-INDICATION                                       */ 10770000
*/*                                                                  */ 10771000
*/*              01 GOOD COUNT,GOOD KEY/DATA                         */ 10772000
*/*            * 02 GOOD COUNT,BAD KEY/DATA                          */ 10773000
*/*              03 GOOD COUNT,DESTAGE ERROR ON KEY/DATA             */ 10774000
*/*              04 GOOD COUNT,OVERFLOW,GOOD KEY/DATA                */ 10775000
*/*              05 RESERVED                                         */ 10776000
*/*              06 RESERVED                                         */ 10777000
*/*            * 07 BAD COUNT,GOOD KEY/DATA                          */ 10778000
*/*              08 DESTAGE ERROR ON COUNT,DESTAGE ERROR ON KEY/DATA */ 10779000
*/*              09 STAGE ERROR ON COUNT,DESTAGE ERROR ON KEY/DATA   */ 10780000
*/*              10 STAGE ERROR ON COUNT,STAGE ERROR ON KEY/DATA     */ 10781000
*/*              11 RESERVED                                         */ 10782000
*/*              12 RESERVED                                         */ 10783000
*/*              13 RESERVED                                         */ 10784000
*/*              14 RESERVED                                         */ 10785000
*/*              15 RESERVED                                         */ 10786000
*/*            * 16 GOOD COUNT,BAD KEY/DATA                          */ 10787000
*/*              17 RESERVED                                         */ 10788000
*/*            * 18 BAD COUNT                                        */ 10789000
*/*            * 19 BAD COUNT,BAD KEY/DATA                           */ 10790000
*/*            * 20 DESTAGE ERROR ON COUNT,BAD KEY/DATA              */ 10791000
*/*            * 21 STAGE ERROR ON COUNT,BAD KEY/DATA                */ 10792000
*/*            * 22 UNCORRECTABLE I/O ERROR PRIOR TO REQUESTED RECORD*/ 10793000
*/*              23 RESERVED                                         */ 10794000
*/*              24 RESERVED                                         */ 10795000
*/*              25 RESERVED                                         */ 10796000
*/*              26 RESERVED                                         */ 10797000
*/*              27 RESERVED                                         */ 10798000
*/*              28 RESERVED                                         */ 10799000
*/*              29 END OF FILE                                      */ 10800000
*/*              30 END OF TRACK                                     */ 10801000
*/*            * 31 UNEXPECTED RESULTS                               */ 10802000
*/*              32 SYNC BYTE MISSING-TRACK UNRECOVERABLE            */ 10803000
*/*              33 NO RECORD FOUND                                  */ 10804000
*/*                                                                  */ 10805000
*/*                                                                  */ 10806000
*/********************************************************************/ 10807000
*                                                                  1760 10808000
*IDCRDRD:                                                          1760 10809000
*   PROC(ARGLST);                                                  1760 10810000
*                                                                  1760 10811000
IDCRDRD  STM   @14,@12,@SA00004                                    1760 10812000
         MVC   @PC00004(4),0(@01)                                  1760 10813000
*/********************************************************************/ 10814000
*/*                                                                  */ 10815000
*/*                                                                  */ 10816000
*/*  THE FOLLOWING ARE THE RETURN CODES RETURNED BY                  */ 10817000
*/*   SREADREC                                                       */ 10818000
*/*                                                                  */ 10819000
*/*   ALL OTHER COMBINATIONS ARE IMPOSSIBLE CONDITIONS               */ 10820000
*/*                                                                  */ 10821000
*/********************************************************************/ 10822000
*/********************************************************************/ 10823000
*/*                  GOOD COUNT,GOOD KEY/DATA                        */ 10824000
*/********************************************************************/ 10825000
*                                                                  1761 10826000
*   DCL                                                            1761 10827000
*     RCSRGG FIXED(15) INIT(01);                                   1761 10828000
*                                                                  1761 10829000
*/********************************************************************/ 10830000
*/*                  GOOD COUNT,BAD KEY/DATA,STAGING PACK            */ 10831000
*/********************************************************************/ 10832000
*                                                                  1762 10833000
*   DCL                                                            1762 10834000
*     RCSRGBSP FIXED(15) INIT(02);                                 1762 10835000
*                                                                  1762 10836000
*/********************************************************************/ 10837000
*/*                  GOOD COUNT,DESTAGE ERROR KEY/DATA,DS            */ 10838000
*/********************************************************************/ 10839000
*                                                                  1763 10840000
*   DCL                                                            1763 10841000
*     RCSRGDS FIXED(15) INIT(03);                                  1763 10842000
*                                                                  1763 10843000
*/********************************************************************/ 10844000
*/*                  GOOD COUNT,OVERFLOW,GOOD KEY/DATA               */ 10845000
*/********************************************************************/ 10846000
*                                                                  1764 10847000
*   DCL                                                            1764 10848000
*     RCSRGGOF FIXED(15) INIT(04);                                 1764 10849000
*                                                                  1764 10850000
*/********************************************************************/ 10851000
*/*                  GOOD COUNT,STAGE ERROR   KEY/DATA               */ 10852000
*/********************************************************************/ 10853000
*                                                                  1765 10854000
*   DCL                                                            1765 10855000
*     RCSRGSTG FIXED(15) INIT(05);                                 1765 10856000
*                                                                  1765 10857000
*/********************************************************************/ 10858000
*/*                  BAD COUNT,GOOD KEY/DATA,STG PACK                */ 10859000
*/********************************************************************/ 10860000
*                                                                  1766 10861000
*   DCL                                                            1766 10862000
*     RCSRBG FIXED(15) INIT(07);                                   1766 10863000
*                                                                  1766 10864000
*/********************************************************************/ 10865000
*/*                  DESTAGE ERR COUNT,DESTAGE ERR K/D, DS           */ 10866000
*/********************************************************************/ 10867000
*                                                                  1767 10868000
*   DCL                                                            1767 10869000
*     RCSRDSDS FIXED(15) INIT(08);                                 1767 10870000
*                                                                  1767 10871000
*/********************************************************************/ 10872000
*/*                  STAGE ERROR ON COUNT,DESTAGE ERR KEY/DATA       */ 10873000
*/********************************************************************/ 10874000
*                                                                  1768 10875000
*   DCL                                                            1768 10876000
*     RCSRSTDS FIXED(15) INIT(09);                                 1768 10877000
*                                                                  1768 10878000
*/********************************************************************/ 10879000
*/*                  STAGE ERROR COUNT,STAGE ERR KEY/DATA,DS         */ 10880000
*/********************************************************************/ 10881000
*                                                                  1769 10882000
*   DCL                                                            1769 10883000
*     RCSRSTST FIXED(15) INIT(10);                                 1769 10884000
*                                                                  1769 10885000
*/********************************************************************/ 10886000
*/*                  GOOD COUNT/BAD KEY/DATA,DS                      */ 10887000
*/********************************************************************/ 10888000
*                                                                  1770 10889000
*   DCL                                                            1770 10890000
*     RCSRGBDT FIXED(15) INIT(16);                                 1770 10891000
*                                                                  1770 10892000
*/********************************************************************/ 10893000
*/*                  BAD COUNT,DATA SET                              */ 10894000
*/********************************************************************/ 10895000
*                                                                  1771 10896000
*   DCL                                                            1771 10897000
*     RCSRBCNT FIXED(15) INIT(18);                                 1771 10898000
*                                                                  1771 10899000
*/********************************************************************/ 10900000
*/*                  BAD COUNT,BAD KEY/DATA,SP                       */ 10901000
*/********************************************************************/ 10902000
*                                                                  1772 10903000
*   DCL                                                            1772 10904000
*     RCSRBB FIXED(15) INIT(19);                                   1772 10905000
*                                                                  1772 10906000
*/********************************************************************/ 10907000
*/*                  DESTAGE ERROR ON COUNT,BAD KEY/DATA,DS          */ 10908000
*/********************************************************************/ 10909000
*                                                                  1773 10910000
*   DCL                                                            1773 10911000
*     RCSRDSB FIXED(15) INIT(20);                                  1773 10912000
*                                                                  1773 10913000
*/********************************************************************/ 10914000
*/*                  STAGE ERROR ON COUNT,BAD KEY/DATA,DS            */ 10915000
*/********************************************************************/ 10916000
*                                                                  1774 10917000
*   DCL                                                            1774 10918000
*     RCSRSTB FIXED(15) INIT(21);                                  1774 10919000
*                                                                  1774 10920000
*/********************************************************************/ 10921000
*/*                  UNCORRECTABLE I/O ERROR PRIOR TO REQ REC        */ 10922000
*/********************************************************************/ 10923000
*                                                                  1775 10924000
*   DCL                                                            1775 10925000
*     RCSRUNCO FIXED(15) INIT(22);                                 1775 10926000
*                                                                  1775 10927000
*/********************************************************************/ 10928000
*/*                  END OF FILE                                     */ 10929000
*/********************************************************************/ 10930000
*                                                                  1776 10931000
*   DCL                                                            1776 10932000
*     RCSREOF FIXED(15) INIT(29);                                  1776 10933000
*                                                                  1776 10934000
*   /*****************************************************************/ 10935000
*   /*                                                               */ 10936000
*   /* END OF TRACK                                                  */ 10937000
*   /*                                                               */ 10938000
*   /*****************************************************************/ 10939000
*                                                                  1777 10940000
*/********************************************************************/ 10941000
*                                                                  1777 10942000
*   DCL                                                            1777 10943000
*     RCSREOTR FIXED(15) INIT(30);                                 1777 10944000
*                                                                  1777 10945000
*/********************************************************************/ 10946000
*/*                  UNEXPECTED RESULTS                              */ 10947000
*/********************************************************************/ 10948000
*                                                                  1778 10949000
*   DCL                                                            1778 10950000
*     RCSRUEX FIXED(15) INIT(31);                                  1778 10951000
*                                                                  1778 10952000
*/********************************************************************/ 10953000
*/*                  SYNC BYTE MISSING-TRACK UNRECOVERABLE           */ 10954000
*/********************************************************************/ 10955000
*                                                                  1779 10956000
*   DCL                                                            1779 10957000
*     RCSRSYNC FIXED(15) INIT(32);                                 1779 10958000
*                                                                  1779 10959000
*/********************************************************************/ 10960000
*/*                  NO RECORD FOUND                                 */ 10961000
*/********************************************************************/ 10962000
*                                                                  1780 10963000
*   DCL                                                            1780 10964000
*     RCSRNRF FIXED(15) INIT(33);                                  1780 10965000
*                                                                  1780 10966000
*/********************************************************************/ 10967000
*/*                                                                  */ 10968000
*/*                                                                  */ 10969000
*/*      THE FOLLOWING ARE THE RETURN CODES SENT BACK                */ 10970000
*/*        TO SREADREC FROM THE UEXCP FUNCTIONS                      */ 10971000
*/*                                                                  */ 10972000
*/*                                                                  */ 10973000
*/*                                                                  */ 10974000
*/********************************************************************/ 10975000
*/********************************************************************/ 10976000
*/*                  DESTAGE ERROR                                   */ 10977000
*/********************************************************************/ 10978000
*                                                                  1781 10979000
*   DCL                                                            1781 10980000
*     RCABDS FIXED(15) INIT(08);                                   1781 10981000
*                                                                  1781 10982000
*/********************************************************************/ 10983000
*/*                  STAGE ERROR                                     */ 10984000
*/********************************************************************/ 10985000
*                                                                  1782 10986000
*   DCL                                                            1782 10987000
*     RCABST FIXED(15) INIT(12);                                   1782 10988000
*                                                                  1782 10989000
*/********************************************************************/ 10990000
*/*                  OVERFLOW RECORD, GOOD DATA                      */ 10991000
*/********************************************************************/ 10992000
*                                                                  1783 10993000
*   DCL                                                            1783 10994000
*     RCABOV FIXED(15) INIT(16);                                   1783 10995000
*                                                                  1783 10996000
*/********************************************************************/ 10997000
*/*                  NO RECORD FOUND                                 */ 10998000
*/********************************************************************/ 10999000
*                                                                  1784 11000000
*   DCL                                                            1784 11001000
*     RCABNRF FIXED(15) INIT(20);                                  1784 11002000
*                                                                  1784 11003000
*/********************************************************************/ 11004000
*/*                  SYNC BYTE MISSING                               */ 11005000
*/********************************************************************/ 11006000
*                                                                  1785 11007000
*   DCL                                                            1785 11008000
*     RCABSYNC FIXED(15) INIT(24);                                 1785 11009000
*                                                                  1785 11010000
*/********************************************************************/ 11011000
*/*                  UNCORRECTABLE DATA CHECK                        */ 11012000
*/********************************************************************/ 11013000
*                                                                  1786 11014000
*   DCL                                                            1786 11015000
*     RCABDTCK FIXED(15) INIT(28);                                 1786 11016000
*                                                                  1786 11017000
*/********************************************************************/ 11018000
*/*                  END OF FILE RECORD READ                         */ 11019000
*/********************************************************************/ 11020000
*                                                                  1787 11021000
*   DCL                                                            1787 11022000
*     RCABEOFR FIXED(15) INIT(32);                                 1787 11023000
*                                                                  1787 11024000
*/********************************************************************/ 11025000
*/*                                                                  */ 11026000
*/*                                                                  */ 11027000
*/*    THE FOLLOWING ARE MISCELLANEOUS CONSTANTS                     */ 11028000
*/*      USED BY SREADREC                                            */ 11029000
*/*                                                                  */ 11030000
*/*                                                                  */ 11031000
*/*                                                                  */ 11032000
*/********************************************************************/ 11033000
*                                                                  1788 11034000
*   DCL                                                            1788 11035000
*     FSTIME FIXED(8) INIT('FF'X);  /* FIRST TIME INDICATOR          */ 11036000
*   DCL                                                            1789 11037000
*     NTFNDPTR CHAR(4) INIT('FFFFFFFF'X);/* NOT FIRST TIME IND       */ 11038000
*   DCL                                                            1790 11039000
*     DSIND FIXED(8) INIT('00'X);   /* DATA SET INDICATOR            */ 11040000
*   DCL                                                            1791 11041000
*     KEYPTR(110) BASED(RDKLEN);    /* BASE FOR KEY LENGTHS          */ 11042000
*   DCL                                                            1792 11043000
*     KEYLENS FIXED(31) BASED(KEYPTR(LENINDEX));                   1792 11044000
*   DCL                                                            1793 11045000
*     DATPTR(110) BASED(RDDLEN);    /* BASE FOR KEY LENGTHS          */ 11046000
*   DCL                                                            1794 11047000
*     DATALENS FIXED(31) BASED(DATPTR(LENINDEX));/* LIST OF DATA   1794 11048000
*                                      LENGTHS                       */ 11049000
*   DCL                                                            1795 11050000
*     LENINDEX FIXED(15);           /* DO LOOP CONTROL               */ 11051000
*   DCL                                                            1796 11052000
*     RDCTR FIXED(15);              /* DO LOOP CONTROL               */ 11053000
*   DCL                                                            1797 11054000
*     READCNT CHAR(8) INIT('READCNT ');                            1797 11055000
*   DCL                                                            1798 11056000
*     READKD CHAR(8) INIT('READKD  ');                             1798 11057000
*   DCL                                                            1799 11058000
*     SPACCR CHAR(8) INIT('SPACCR  ');                             1799 11059000
*   DCL                                                            1800 11060000
*     LOCENT FIXED(15) INIT(DIM(LOCTAB));/* NUM ENTS IN LOCTAB       */ 11061000
*   DCL                                                            1801 11062000
*     ARGLST CHAR(*);                                              1801 11063000
*                                                                  1802 11064000
*/********************************************************************/ 11065000
*/*                                                                  */ 11066000
*/*                                                                  */ 11067000
*/*      THE FOLLOWING IS THE CODE FOR SREADREC                      */ 11068000
*/*                                                                  */ 11069000
*/*                                                                  */ 11070000
*/*                                                                  */ 11071000
*/*                                                                  */ 11072000
*/********************************************************************/ 11073000
*                                                                  1802 11074000
*   GEN(ENTRY IDCRDRD);                                            1802 11075000
         ENTRY IDCRDRD                                                  11076000
*   GEN(L REG6,SPLITSV1);                                          1803 11077000
         L REG6,SPLITSV1                                                11078000
*   LM(REG9,REG12,SPLITSAV);                                       1804 11079000
*                                                                  1804 11080000
         LM    REG9,REG12,SPLITSAV                                 1804 11081000
*/********************************************************************/ 11082000
*/* OBTAIN ADDRESSABILITY TO INPUT CONTROL BLOCKS                    */ 11083000
*/********************************************************************/ 11084000
*                                                                  1805 11085000
*   RESPECIFY                                                      1805 11086000
*     RDARG BASED(ADDR(ARGLST));                                   1805 11087000
*   RESPECIFY                                                      1806 11088000
*     RIOAREA BASED(RDIOAREA);                                     1806 11089000
*   RESPECIFY                                                      1807 11090000
*     LOCTAB BASED(RDLOCPTR);                                      1807 11091000
*                                                                  1807 11092000
*/********************************************************************/ 11093000
*/* SET UP FULL REGION DUMP POINT                                    */ 11094000
*/********************************************************************/ 11095000
*                                                                  1808 11096000
*   IF GDTDBG=NULLPTR THEN                                         1808 11097000
         L     @15,@PC00001                                        1808 11098000
         L     @15,GDTDBG(,@15)                                    1808 11099000
         LTR   @15,@15                                             1808 11100000
         BZ    @RT01808                                            1808 11101000
*     ;                                                            1809 11102000
*   ELSE                                                           1810 11103000
*     CALL IDCDB010(GDTTBL,'RDDD');                                1810 11104000
*                                                                  1810 11105000
         L     @15,@PC00001                                        1810 11106000
         ST    @15,@AL00001                                        1810 11107000
         LA    @14,@CC02992                                        1810 11108000
         ST    @14,@AL00001+4                                      1810 11109000
         MVI   @AL00001+4,X'80'                                    1810 11110000
         L     @15,GDTDBG(,@15)                                    1810 11111000
         LA    @01,@AL00001                                        1810 11112000
         BALR  @14,@15                                             1810 11113000
*/********************************************************************/ 11114000
*/* SET TRACE ID                                                     */ 11115000
*/********************************************************************/ 11116000
*                                                                  1811 11117000
*   OLDERID2=NEWERID2;                                             1811 11118000
@RT01808 L     @15,@PC00001                                        1811 11119000
         L     @15,GDTTR2(,@15)                                    1811 11120000
         MVC   @TS00001(95),NEWERID2(@15)                          1811 11121000
         MVC   OLDERID2(95,@15),@TS00001                           1811 11122000
*   NEWID2='RDD1';                                                 1812 11123000
*                                                                  1812 11124000
         MVC   NEWID2(4,@15),@CC02993                              1812 11125000
*   /*****************************************************************/ 11126000
*   /*                                                               */ 11127000
*   /* CHECK TO SEE IF CALL IS FOR SAME TRACK                        */ 11128000
*   /*                                                               */ 11129000
*   /*****************************************************************/ 11130000
*                                                                  1813 11131000
*   IF RPREVCC^=RDCC|RPREVHH^=RDHH|RFIRST=FSTIME                   1813 11132000
*                                                                  1813 11133000
*   /*****************************************************************/ 11134000
*   /*                                                               */ 11135000
*   /* NEW TRACK REQUESTED                                           */ 11136000
*   /*                                                               */ 11137000
*   /*****************************************************************/ 11138000
*                                                                  1813 11139000
*     THEN                                                         1813 11140000
         L     @15,@PC00004                                        1813 11141000
         L     @14,RDIOAREA(,@15)                                  1813 11142000
         LH    @05,RDCC(,@15)                                      1813 11143000
         N     @05,@CF03043                                        1813 11144000
         CH    @05,RPREVCC(,@14)                                   1813 11145000
         BNE   @RT01813                                            1813 11146000
         LH    @15,RDHH(,@15)                                      1813 11147000
         N     @15,@CF03043                                        1813 11148000
         CH    @15,RPREVHH(,@14)                                   1813 11149000
         BNE   @RT01813                                            1813 11150000
         CLC   RFIRST(1,@14),FSTIME                                1813 11151000
         BNE   @RF01813                                            1813 11152000
@RT01813 DS    0H                                                  1814 11153000
*     DO;                                                          1814 11154000
*                                                                  1814 11155000
*       /*************************************************************/ 11156000
*       /*                                                           */ 11157000
*       /* READ THE NEW TRACK                                        */ 11158000
*       /*                                                           */ 11159000
*       /*************************************************************/ 11160000
*                                                                  1815 11161000
*       CALL SRDRCRD;                                              1815 11162000
         BAL   @14,SRDRCRD                                         1815 11163000
*       RESPECIFY                                                  1816 11164000
*         RTNREG RSTD;                                             1816 11165000
*       TESTRC=RTNREG;                                             1817 11166000
         STH   RTNREG,TESTRC                                       1817 11167000
*       RESPECIFY                                                  1818 11168000
*         RTNREG UNRSTD;                                           1818 11169000
*     END;                                                         1819 11170000
*   ELSE                                                           1820 11171000
*                                                                  1820 11172000
*     /***************************************************************/ 11173000
*     /*                                                             */ 11174000
*     /* ENSURE RETURN CODE IS OK                                    */ 11175000
*     /*                                                             */ 11176000
*     /***************************************************************/ 11177000
*                                                                  1820 11178000
*     TESTRC=0;                                                    1820 11179000
*                                                                  1820 11180000
         B     @RC01813                                            1820 11181000
@RF01813 SLR   @15,@15                                             1820 11182000
         STH   @15,TESTRC                                          1820 11183000
*   /*****************************************************************/ 11184000
*   /*                                                               */ 11185000
*   /* IF REQUESTED RECORD NUMBER IS GREATER THAN THE SIZE OF THE    */ 11186000
*   /* LOCATION TABLE THEN IT OBVIOUSLY IS NOT THERE                 */ 11187000
*   /*                                                               */ 11188000
*   /*****************************************************************/ 11189000
*                                                                  1821 11190000
*   IF RDRECNUM+1>LOCENT THEN                                      1821 11191000
@RC01813 L     @15,@PC00004                                        1821 11192000
         LA    @14,1                                               1821 11193000
         SLR   @05,@05                                             1821 11194000
         IC    @05,RDRECNUM(,@15)                                  1821 11195000
         ALR   @14,@05                                             1821 11196000
         CH    @14,LOCENT                                          1821 11197000
         BNH   @RF01821                                            1821 11198000
*     RETURN CODE(RCSREOTR);                                       1822 11199000
*                                                                  1822 11200000
         LH    @15,RCSREOTR                                        1822 11201000
         L     @14,@SA00004                                        1822 11202000
         LM    @00,@12,@SA00004+8                                  1822 11203000
         BR    @14                                                 1822 11204000
*   /*****************************************************************/ 11205000
*   /*                                                               */ 11206000
*   /* CHECK TO SEE IF RETURN CODE IS ACCEPTABLE UNEXPECTED RESULTS  */ 11207000
*   /* IS NOT ACCEPTABLE                                             */ 11208000
*   /*                                                               */ 11209000
*   /*****************************************************************/ 11210000
*                                                                  1823 11211000
*   IF TESTRC^=RCSRUEX THEN                                        1823 11212000
@RF01821 LH    @15,RCSRUEX                                         1823 11213000
         CH    @15,TESTRC                                          1823 11214000
         BE    @RF01823                                            1823 11215000
*     DO;                                                          1824 11216000
*                                                                  1824 11217000
*       /*************************************************************/ 11218000
*       /*                                                           */ 11219000
*       /* CONTINUE SET TESTRC TO UNEXPECTED RESULTS IN CASE NONE OF */ 11220000
*       /* THE CONDITIONS WERE TESTING FOR EXIST                     */ 11221000
*       /*                                                           */ 11222000
*       /*************************************************************/ 11223000
*                                                                  1825 11224000
*       TESTRC=RCSRUEX;                                            1825 11225000
*                                                                  1825 11226000
         STH   @15,TESTRC                                          1825 11227000
*       /*************************************************************/ 11228000
*       /*                                                           */ 11229000
*       /* GET ADDRESS OF DATA FOR REQUESTED RECORD                  */ 11230000
*       /*                                                           */ 11231000
*       /*************************************************************/ 11232000
*                                                                  1826 11233000
*       RDDARE=LOCADDR(RDRECNUM+1);                                1826 11234000
*                                                                  1826 11235000
         L     @14,@PC00004                                        1826 11236000
         SLR   @05,@05                                             1826 11237000
         IC    @05,RDRECNUM(,@14)                                  1826 11238000
         MH    @05,@CH00647                                        1826 11239000
         L     @04,RDLOCPTR(,@14)                                  1826 11240000
         L     @03,LOCADDR(@05,@04)                                1826 11241000
         ST    @03,RDDARE(,@14)                                    1826 11242000
*       /*************************************************************/ 11243000
*       /*                                                           */ 11244000
*       /* DETERMINE RETURN CODE TO SEND BACK IT IS A COMBINATION OF */ 11245000
*       /* THE READ COUNT RETURN CODE AND THE READ KEY/DATA RETURN   */ 11246000
*       /* CODE OF THE RECORD SET TRACE ID                           */ 11247000
*       /*                                                           */ 11248000
*       /*************************************************************/ 11249000
*                                                                  1827 11250000
*       OLDERID2=NEWERID2;                                         1827 11251000
         L     @14,@PC00001                                        1827 11252000
         L     @14,GDTTR2(,@14)                                    1827 11253000
         MVC   @TS00001(95),NEWERID2(@14)                          1827 11254000
         MVC   OLDERID2(95,@14),@TS00001                           1827 11255000
*       NEWID2='RDDR';                                             1828 11256000
*                                                                  1828 11257000
         MVC   NEWID2(4,@14),@CC02995                              1828 11258000
*       /*************************************************************/ 11259000
*       /*                                                           */ 11260000
*       /* IF EITHER RETURN CODE WAS UNEXPECTED RESULTS THEN RETURN  */ 11261000
*       /* WITH UNEXPECTED RESULTS                                   */ 11262000
*       /*                                                           */ 11263000
*       /*************************************************************/ 11264000
*                                                                  1829 11265000
*       IF LOCRCNT(RDRECNUM+1)=RCSRUEX|LOCRCKD(RDRECNUM+1)=RCSRUEX THEN 11266000
         CH    @15,LOCRCNT(@05,@04)                                1829 11267000
         BE    @RT01829                                            1829 11268000
         CH    @15,LOCRCKD(@05,@04)                                1829 11269000
         BNE   @RF01829                                            1829 11270000
@RT01829 DS    0H                                                  1830 11271000
*         TESTRC=RCSRUEX;                                          1830 11272000
*                                                                  1830 11273000
         LH    @15,RCSRUEX                                         1830 11274000
         STH   @15,TESTRC                                          1830 11275000
*       /*************************************************************/ 11276000
*       /*                                                           */ 11277000
*       /* IF EITHER RETURN CODE WAS SYNC BYTE MISSING THEN RETURN   */ 11278000
*       /* WITH RC INDICATING SYNC BYTE MISSING                      */ 11279000
*       /*                                                           */ 11280000
*       /*************************************************************/ 11281000
*                                                                  1831 11282000
*       IF LOCRCNT(RDRECNUM+1)=RCABSYNC|LOCRCKD(RDRECNUM+1)=RCABSYNC    11283000
*         THEN                                                     1831 11284000
@RF01829 LH    @15,RCABSYNC                                        1831 11285000
         L     @14,@PC00004                                        1831 11286000
         SLR   @05,@05                                             1831 11287000
         IC    @05,RDRECNUM(,@14)                                  1831 11288000
         MH    @05,@CH00647                                        1831 11289000
         L     @14,RDLOCPTR(,@14)                                  1831 11290000
         CH    @15,LOCRCNT(@05,@14)                                1831 11291000
         BE    @RT01831                                            1831 11292000
         CH    @15,LOCRCKD(@05,@14)                                1831 11293000
         BNE   @RF01831                                            1831 11294000
@RT01831 DS    0H                                                  1832 11295000
*         TESTRC=RCSRSYNC;                                         1832 11296000
*                                                                  1832 11297000
         LH    @15,RCSRSYNC                                        1832 11298000
         STH   @15,TESTRC                                          1832 11299000
*       /*************************************************************/ 11300000
*       /*                                                           */ 11301000
*       /* IF EITHER RETURN CODE WAS UNCORRECTABLE I/O ERROR THEN    */ 11302000
*       /* RETURN WITH UNCORRECTABLE I/O ERROR                       */ 11303000
*       /*                                                           */ 11304000
*       /*************************************************************/ 11305000
*                                                                  1833 11306000
*       IF LOCRCNT(RDRECNUM+1)=RCSRUNCO|LOCRCKD(RDRECNUM+1)=RCSRUNCO    11307000
*         THEN                                                     1833 11308000
@RF01831 LH    @15,RCSRUNCO                                        1833 11309000
         L     @14,@PC00004                                        1833 11310000
         SLR   @05,@05                                             1833 11311000
         IC    @05,RDRECNUM(,@14)                                  1833 11312000
         MH    @05,@CH00647                                        1833 11313000
         L     @14,RDLOCPTR(,@14)                                  1833 11314000
         CH    @15,LOCRCNT(@05,@14)                                1833 11315000
         BE    @RT01833                                            1833 11316000
         CH    @15,LOCRCKD(@05,@14)                                1833 11317000
         BNE   @RF01833                                            1833 11318000
@RT01833 DS    0H                                                  1834 11319000
*         TESTRC=RCSRUNCO;                                         1834 11320000
*                                                                  1834 11321000
         LH    @15,RCSRUNCO                                        1834 11322000
         STH   @15,TESTRC                                          1834 11323000
*       /*************************************************************/ 11324000
*       /*                                                           */ 11325000
*       /* IF COUNT RETURN CODE IS RECORD NOT FOUND THEN RETURN WITH */ 11326000
*       /* RECORD NOT FOUND                                          */ 11327000
*       /*                                                           */ 11328000
*       /*************************************************************/ 11329000
*                                                                  1835 11330000
*       IF LOCRCNT(RDRECNUM+1)=RCABNRF THEN                        1835 11331000
@RF01833 L     @15,@PC00004                                        1835 11332000
         SLR   @14,@14                                             1835 11333000
         IC    @14,RDRECNUM(,@15)                                  1835 11334000
         MH    @14,@CH00647                                        1835 11335000
         L     @01,RDLOCPTR(,@15)                                  1835 11336000
         LH    @15,LOCRCNT(@14,@01)                                1835 11337000
         CH    @15,RCABNRF                                         1835 11338000
         BNE   @RF01835                                            1835 11339000
*         TESTRC=RCSRNRF;                                          1836 11340000
*                                                                  1836 11341000
         LH    @15,RCSRNRF                                         1836 11342000
         STH   @15,TESTRC                                          1836 11343000
*       /*************************************************************/ 11344000
*       /*                                                           */ 11345000
*       /* IF COUNT RETURN CODE WAS END OF TRACK THEN RETURN WITH END*/ 11346000
*       /* OF TRACK                                                  */ 11347000
*       /*                                                           */ 11348000
*       /*************************************************************/ 11349000
*                                                                  1837 11350000
*       IF LOCRCNT(RDRECNUM+1)=RCSREOTR THEN                       1837 11351000
@RF01835 LH    @15,RCSREOTR                                        1837 11352000
         L     @14,@PC00004                                        1837 11353000
         SLR   @05,@05                                             1837 11354000
         IC    @05,RDRECNUM(,@14)                                  1837 11355000
         MH    @05,@CH00647                                        1837 11356000
         L     @01,RDLOCPTR(,@14)                                  1837 11357000
         CH    @15,LOCRCNT(@05,@01)                                1837 11358000
         BNE   @RF01837                                            1837 11359000
*         TESTRC=RCSREOTR;                                         1838 11360000
*                                                                  1838 11361000
         STH   @15,TESTRC                                          1838 11362000
*       /*************************************************************/ 11363000
*       /*                                                           */ 11364000
*       /* IF KEY/D RETURN CODE WAS END OF FILE READ THEN RETURN WITH*/ 11365000
*       /* END OF FILE INDICATION                                    */ 11366000
*       /*                                                           */ 11367000
*       /*************************************************************/ 11368000
*                                                                  1839 11369000
*       IF LOCRCKD(RDRECNUM+1)=RCABEOFR THEN                       1839 11370000
@RF01837 L     @15,@PC00004                                        1839 11371000
         SLR   @14,@14                                             1839 11372000
         IC    @14,RDRECNUM(,@15)                                  1839 11373000
         MH    @14,@CH00647                                        1839 11374000
         L     @01,RDLOCPTR(,@15)                                  1839 11375000
         LH    @15,LOCRCKD(@14,@01)                                1839 11376000
         CH    @15,RCABEOFR                                        1839 11377000
         BNE   @RF01839                                            1839 11378000
*         TESTRC=RCSREOF;                                          1840 11379000
*                                                                  1840 11380000
         LH    @15,RCSREOF                                         1840 11381000
         STH   @15,TESTRC                                          1840 11382000
*       /*************************************************************/ 11383000
*       /*                                                           */ 11384000
*       /* IF COUNT RETURN CODE WAS OK AND KEY/DATA RETURN CODE WAS  */ 11385000
*       /* OK THEN RETURN PROPER CODE                                */ 11386000
*       /*                                                           */ 11387000
*       /*************************************************************/ 11388000
*                                                                  1841 11389000
*       IF LOCRCNT(RDRECNUM+1)=0&LOCRCKD(RDRECNUM+1)=0 THEN        1841 11390000
@RF01839 SLR   @15,@15                                             1841 11391000
         L     @14,@PC00004                                        1841 11392000
         SLR   @05,@05                                             1841 11393000
         IC    @05,RDRECNUM(,@14)                                  1841 11394000
         MH    @05,@CH00647                                        1841 11395000
         L     @14,RDLOCPTR(,@14)                                  1841 11396000
         CH    @15,LOCRCNT(@05,@14)                                1841 11397000
         BNE   @RF01841                                            1841 11398000
         CH    @15,LOCRCKD(@05,@14)                                1841 11399000
         BNE   @RF01841                                            1841 11400000
*         TESTRC=RCSRGG;                                           1842 11401000
*                                                                  1842 11402000
         LH    @15,RCSRGG                                          1842 11403000
         STH   @15,TESTRC                                          1842 11404000
*       /*************************************************************/ 11405000
*       /*                                                           */ 11406000
*       /* IF COUNT RETURN CODE WAS GOOD AND KEY/DATA RETURN CODE WAS*/ 11407000
*       /* BAD KEY/DATA AND REQUEST WAS FOR A STAGING PACK THEN      */ 11408000
*       /* RETURN PROPER CODE                                        */ 11409000
*       /*                                                           */ 11410000
*       /*************************************************************/ 11411000
*                                                                  1843 11412000
*       IF LOCRCNT(RDRECNUM+1)=0&LOCRCKD(RDRECNUM+1)=RCABDTCK&RDDS^=    11413000
*           DSIND THEN                                             1843 11414000
@RF01841 L     @15,@PC00004                                        1843 11415000
         SLR   @14,@14                                             1843 11416000
         IC    @14,RDRECNUM(,@15)                                  1843 11417000
         MH    @14,@CH00647                                        1843 11418000
         L     @05,RDLOCPTR(,@15)                                  1843 11419000
         LH    @04,LOCRCNT(@14,@05)                                1843 11420000
         LTR   @04,@04                                             1843 11421000
         BNZ   @RF01843                                            1843 11422000
         LH    @14,LOCRCKD(@14,@05)                                1843 11423000
         CH    @14,RCABDTCK                                        1843 11424000
         BNE   @RF01843                                            1843 11425000
         CLC   RDDS(1,@15),DSIND                                   1843 11426000
         BE    @RF01843                                            1843 11427000
*         TESTRC=RCSRGBSP;                                         1844 11428000
*                                                                  1844 11429000
         LH    @15,RCSRGBSP                                        1844 11430000
         STH   @15,TESTRC                                          1844 11431000
*       /*************************************************************/ 11432000
*       /*                                                           */ 11433000
*       /* IF COUNT RETURN CODE WAS GOOD AND KEY/DATA RETURN CODE WAS*/ 11434000
*       /* DESTAGE ERROR AND REQUEST WAS FOR A DATA SET THEN RETURN  */ 11435000
*       /* PROPER CODE                                               */ 11436000
*       /*                                                           */ 11437000
*       /*************************************************************/ 11438000
*                                                                  1845 11439000
*       IF LOCRCNT(RDRECNUM+1)=0&LOCRCKD(RDRECNUM+1)=RCABDS&RDDS=DSIND  11440000
*         THEN                                                     1845 11441000
@RF01843 L     @15,@PC00004                                        1845 11442000
         SLR   @14,@14                                             1845 11443000
         IC    @14,RDRECNUM(,@15)                                  1845 11444000
         MH    @14,@CH00647                                        1845 11445000
         L     @05,RDLOCPTR(,@15)                                  1845 11446000
         LH    @04,LOCRCNT(@14,@05)                                1845 11447000
         LTR   @04,@04                                             1845 11448000
         BNZ   @RF01845                                            1845 11449000
         LH    @14,LOCRCKD(@14,@05)                                1845 11450000
         CH    @14,RCABDS                                          1845 11451000
         BNE   @RF01845                                            1845 11452000
         CLC   RDDS(1,@15),DSIND                                   1845 11453000
         BNE   @RF01845                                            1845 11454000
*         TESTRC=RCSRGDS;                                          1846 11455000
*                                                                  1846 11456000
         LH    @15,RCSRGDS                                         1846 11457000
         STH   @15,TESTRC                                          1846 11458000
*       /*************************************************************/ 11459000
*       /*                                                           */ 11460000
*       /* IF COUNT RETURN CODE WAS GOOD AND KEY/DATA RETURN CODE    */ 11461000
*       /* GOOD WITH OVERFLOW THEN RETURN PROPER CODE                */ 11462000
*       /*                                                           */ 11463000
*       /*************************************************************/ 11464000
*                                                                  1847 11465000
*       IF LOCRCNT(RDRECNUM+1)=0&LOCRCKD(RDRECNUM+1)=RCABOV THEN   1847 11466000
@RF01845 L     @15,@PC00004                                        1847 11467000
         SLR   @14,@14                                             1847 11468000
         IC    @14,RDRECNUM(,@15)                                  1847 11469000
         MH    @14,@CH00647                                        1847 11470000
         L     @15,RDLOCPTR(,@15)                                  1847 11471000
         LH    @05,LOCRCNT(@14,@15)                                1847 11472000
         LTR   @05,@05                                             1847 11473000
         BNZ   @RF01847                                            1847 11474000
         LH    @15,LOCRCKD(@14,@15)                                1847 11475000
         CH    @15,RCABOV                                          1847 11476000
         BNE   @RF01847                                            1847 11477000
*         TESTRC=RCSRGGOF;                                         1848 11478000
*                                                                  1848 11479000
         LH    @15,RCSRGGOF                                        1848 11480000
         STH   @15,TESTRC                                          1848 11481000
*       /*************************************************************/ 11482000
*       /*                                                           */ 11483000
*       /* IF COUNT RETURN CODE WAS BAD AND KEY/DATA RETURN CODE WAS */ 11484000
*       /* GOOD AND REQUEST WAS FOR A STAGING PACK THEN RETURN PROPER*/ 11485000
*       /* CODE                                                      */ 11486000
*       /*                                                           */ 11487000
*       /*************************************************************/ 11488000
*                                                                  1849 11489000
*       IF LOCRCNT(RDRECNUM+1)=RCABDTCK&LOCRCKD(RDRECNUM+1)=0&RDDS^=    11490000
*           DSIND THEN                                             1849 11491000
@RF01847 L     @15,@PC00004                                        1849 11492000
         SLR   @14,@14                                             1849 11493000
         IC    @14,RDRECNUM(,@15)                                  1849 11494000
         MH    @14,@CH00647                                        1849 11495000
         L     @05,RDLOCPTR(,@15)                                  1849 11496000
         LH    @04,LOCRCNT(@14,@05)                                1849 11497000
         CH    @04,RCABDTCK                                        1849 11498000
         BNE   @RF01849                                            1849 11499000
         LH    @04,LOCRCKD(@14,@05)                                1849 11500000
         LTR   @04,@04                                             1849 11501000
         BNZ   @RF01849                                            1849 11502000
         CLC   RDDS(1,@15),DSIND                                   1849 11503000
         BE    @RF01849                                            1849 11504000
*         DO;                                                      1850 11505000
*                                                                  1850 11506000
*           /*********************************************************/ 11507000
*           /*                                                       */ 11508000
*           /* SET RETURN CODE AND KEY/DATA LENGTHS USED             */ 11509000
*           /*                                                       */ 11510000
*           /*********************************************************/ 11511000
*                                                                  1851 11512000
*           TESTRC=RCSRBG;                                         1851 11513000
         LH    @04,RCSRBG                                          1851 11514000
         STH   @04,TESTRC                                          1851 11515000
*           RDSPKL=LOCKLEN(RDRECNUM+1);                            1852 11516000
         SLR   @04,@04                                             1852 11517000
         IC    @04,LOCKLEN(@14,@05)                                1852 11518000
         STC   @04,RDSPKL(,@15)                                    1852 11519000
*           RDSPDL=LOCDLEN(RDRECNUM+1);                            1853 11520000
         LH    @14,LOCDLEN(@14,@05)                                1853 11521000
         STH   @14,RDSPDL(,@15)                                    1853 11522000
*         END;                                                     1854 11523000
*                                                                  1854 11524000
*       /*************************************************************/ 11525000
*       /*                                                           */ 11526000
*       /* IF COUNT RETURN CODE WAS DESTAGE ERROR AND KEY/DATA RETURN*/ 11527000
*       /* CODE WAS DESTAGE ERROR AND REQUEST WAS FOR A DATA SET THEN*/ 11528000
*       /* RETURN PROPER CODE                                        */ 11529000
*       /*                                                           */ 11530000
*       /*************************************************************/ 11531000
*                                                                  1855 11532000
*       IF LOCRCNT(RDRECNUM+1)=RCABDS&LOCRCKD(RDRECNUM+1)=RCABDS&RDDS=  11533000
*           DSIND THEN                                             1855 11534000
@RF01849 LH    @15,RCABDS                                          1855 11535000
         L     @14,@PC00004                                        1855 11536000
         SLR   @05,@05                                             1855 11537000
         IC    @05,RDRECNUM(,@14)                                  1855 11538000
         MH    @05,@CH00647                                        1855 11539000
         L     @04,RDLOCPTR(,@14)                                  1855 11540000
         CH    @15,LOCRCNT(@05,@04)                                1855 11541000
         BNE   @RF01855                                            1855 11542000
         CH    @15,LOCRCKD(@05,@04)                                1855 11543000
         BNE   @RF01855                                            1855 11544000
         CLC   RDDS(1,@14),DSIND                                   1855 11545000
         BNE   @RF01855                                            1855 11546000
*         TESTRC=RCSRDSDS;                                         1856 11547000
*                                                                  1856 11548000
         LH    @15,RCSRDSDS                                        1856 11549000
         STH   @15,TESTRC                                          1856 11550000
*       /*************************************************************/ 11551000
*       /*                                                           */ 11552000
*       /* IF COUNT RETURN CODE STAGE ERROR AND KEY/DATA RETURN CODE */ 11553000
*       /* WAS DESTAGE ERROR AND REQUEST WAS FOR A DATA SET THEN     */ 11554000
*       /* RETURN PROPER CODE                                        */ 11555000
*       /*                                                           */ 11556000
*       /*************************************************************/ 11557000
*                                                                  1857 11558000
*       IF LOCRCNT(RDRECNUM+1)=RCABST&LOCRCKD(RDRECNUM+1)=RCABDS&RDDS=  11559000
*           DSIND THEN                                             1857 11560000
@RF01855 L     @15,@PC00004                                        1857 11561000
         SLR   @14,@14                                             1857 11562000
         IC    @14,RDRECNUM(,@15)                                  1857 11563000
         MH    @14,@CH00647                                        1857 11564000
         L     @05,RDLOCPTR(,@15)                                  1857 11565000
         LH    @04,LOCRCNT(@14,@05)                                1857 11566000
         CH    @04,RCABST                                          1857 11567000
         BNE   @RF01857                                            1857 11568000
         LH    @14,LOCRCKD(@14,@05)                                1857 11569000
         CH    @14,RCABDS                                          1857 11570000
         BNE   @RF01857                                            1857 11571000
         CLC   RDDS(1,@15),DSIND                                   1857 11572000
         BNE   @RF01857                                            1857 11573000
*         TESTRC=RCSRSTDS;                                         1858 11574000
*                                                                  1858 11575000
         LH    @15,RCSRSTDS                                        1858 11576000
         STH   @15,TESTRC                                          1858 11577000
*       /*************************************************************/ 11578000
*       /*                                                           */ 11579000
*       /* IF COUNT RETURN CODE WAS STAGE ERROR AND KEY/DATA RETURN  */ 11580000
*       /* CODE WAS STAGE ERROR AND REQUEST WAS FOR A DATA SET THEN  */ 11581000
*       /* RETURN PROPER CODE                                        */ 11582000
*       /*                                                           */ 11583000
*       /*************************************************************/ 11584000
*                                                                  1859 11585000
*       IF LOCRCNT(RDRECNUM+1)=RCABST&LOCRCKD(RDRECNUM+1)=RCABST&RDDS=  11586000
*           DSIND THEN                                             1859 11587000
@RF01857 LH    @15,RCABST                                          1859 11588000
         L     @14,@PC00004                                        1859 11589000
         SLR   @05,@05                                             1859 11590000
         IC    @05,RDRECNUM(,@14)                                  1859 11591000
         MH    @05,@CH00647                                        1859 11592000
         L     @04,RDLOCPTR(,@14)                                  1859 11593000
         CH    @15,LOCRCNT(@05,@04)                                1859 11594000
         BNE   @RF01859                                            1859 11595000
         CH    @15,LOCRCKD(@05,@04)                                1859 11596000
         BNE   @RF01859                                            1859 11597000
         CLC   RDDS(1,@14),DSIND                                   1859 11598000
         BNE   @RF01859                                            1859 11599000
*         TESTRC=RCSRSTST;                                         1860 11600000
*                                                                  1860 11601000
         LH    @15,RCSRSTST                                        1860 11602000
         STH   @15,TESTRC                                          1860 11603000
*       /*************************************************************/ 11604000
*       /*                                                           */ 11605000
*       /* IF COUNT RETURN CODE WAS GOOD AND KEY/DATA RETURN CODE WAS*/ 11606000
*       /* STAGE ERROR AND REQUEST WAS FOR A DATA SET THEN RETURN    */ 11607000
*       /* PROPER CODE                                               */ 11608000
*       /*                                                           */ 11609000
*       /*************************************************************/ 11610000
*                                                                  1861 11611000
*       IF LOCRCNT(RDRECNUM+1)=0&LOCRCKD(RDRECNUM+1)=RCABST&RDDS=DSIND  11612000
*         THEN                                                     1861 11613000
@RF01859 L     @15,@PC00004                                        1861 11614000
         SLR   @14,@14                                             1861 11615000
         IC    @14,RDRECNUM(,@15)                                  1861 11616000
         MH    @14,@CH00647                                        1861 11617000
         L     @05,RDLOCPTR(,@15)                                  1861 11618000
         LH    @04,LOCRCNT(@14,@05)                                1861 11619000
         LTR   @04,@04                                             1861 11620000
         BNZ   @RF01861                                            1861 11621000
         LH    @14,LOCRCKD(@14,@05)                                1861 11622000
         CH    @14,RCABST                                          1861 11623000
         BNE   @RF01861                                            1861 11624000
         CLC   RDDS(1,@15),DSIND                                   1861 11625000
         BNE   @RF01861                                            1861 11626000
*         TESTRC=RCSRGSTG;                                         1862 11627000
*                                                                  1862 11628000
         LH    @15,RCSRGSTG                                        1862 11629000
         STH   @15,TESTRC                                          1862 11630000
*       /*************************************************************/ 11631000
*       /*                                                           */ 11632000
*       /* IF COUNT RETURN CODE WAS GOOD AND KEY/DATA RETURN CODE WAS*/ 11633000
*       /* BAD KEY/DATA AND REQUEST WAS FOR A DATA SET THEN RETURN   */ 11634000
*       /* PROPER CODE                                               */ 11635000
*       /*                                                           */ 11636000
*       /*************************************************************/ 11637000
*                                                                  1863 11638000
*       IF LOCRCNT(RDRECNUM+1)=0&LOCRCKD(RDRECNUM+1)=RCABDTCK&RDDS=     11639000
*           DSIND THEN                                             1863 11640000
@RF01861 L     @15,@PC00004                                        1863 11641000
         SLR   @14,@14                                             1863 11642000
         IC    @14,RDRECNUM(,@15)                                  1863 11643000
         MH    @14,@CH00647                                        1863 11644000
         L     @05,RDLOCPTR(,@15)                                  1863 11645000
         LH    @04,LOCRCNT(@14,@05)                                1863 11646000
         LTR   @04,@04                                             1863 11647000
         BNZ   @RF01863                                            1863 11648000
         LH    @14,LOCRCKD(@14,@05)                                1863 11649000
         CH    @14,RCABDTCK                                        1863 11650000
         BNE   @RF01863                                            1863 11651000
         CLC   RDDS(1,@15),DSIND                                   1863 11652000
         BNE   @RF01863                                            1863 11653000
*         TESTRC=RCSRGBDT;                                         1864 11654000
*                                                                  1864 11655000
         LH    @15,RCSRGBDT                                        1864 11656000
         STH   @15,TESTRC                                          1864 11657000
*       /*************************************************************/ 11658000
*       /*                                                           */ 11659000
*       /* IF COUNT RETURN CODE WAS BAD AND REQUEST WAS FOR A DATA   */ 11660000
*       /* SET THEN RETURN PROPER CODE                               */ 11661000
*       /*                                                           */ 11662000
*       /*************************************************************/ 11663000
*                                                                  1865 11664000
*       IF LOCRCNT(RDRECNUM+1)=RCABDTCK&RDDS=DSIND THEN            1865 11665000
@RF01863 L     @15,@PC00004                                        1865 11666000
         SLR   @14,@14                                             1865 11667000
         IC    @14,RDRECNUM(,@15)                                  1865 11668000
         MH    @14,@CH00647                                        1865 11669000
         L     @01,RDLOCPTR(,@15)                                  1865 11670000
         LH    @14,LOCRCNT(@14,@01)                                1865 11671000
         CH    @14,RCABDTCK                                        1865 11672000
         BNE   @RF01865                                            1865 11673000
         CLC   RDDS(1,@15),DSIND                                   1865 11674000
         BNE   @RF01865                                            1865 11675000
*         TESTRC=RCSRBCNT;                                         1866 11676000
*                                                                  1866 11677000
         LH    @15,RCSRBCNT                                        1866 11678000
         STH   @15,TESTRC                                          1866 11679000
*       /*************************************************************/ 11680000
*       /*                                                           */ 11681000
*       /* IF COUNT RETURN CODE WAS BAD AND KEY/DATA RETURN CODE WAS */ 11682000
*       /* BAD KEY/DATA AND REQUEST WAS FOR A STAGING PACK THEN      */ 11683000
*       /* RETURN PROPER CODE                                        */ 11684000
*       /*                                                           */ 11685000
*       /*************************************************************/ 11686000
*                                                                  1867 11687000
*       IF LOCRCNT(RDRECNUM+1)=RCABDTCK&LOCRCKD(RDRECNUM+1)=RCABDTCK&   11688000
*           RDDS^=DSIND THEN                                       1867 11689000
@RF01865 LH    @15,RCABDTCK                                        1867 11690000
         L     @14,@PC00004                                        1867 11691000
         SLR   @05,@05                                             1867 11692000
         IC    @05,RDRECNUM(,@14)                                  1867 11693000
         MH    @05,@CH00647                                        1867 11694000
         L     @04,RDLOCPTR(,@14)                                  1867 11695000
         CH    @15,LOCRCNT(@05,@04)                                1867 11696000
         BNE   @RF01867                                            1867 11697000
         CH    @15,LOCRCKD(@05,@04)                                1867 11698000
         BNE   @RF01867                                            1867 11699000
         CLC   RDDS(1,@14),DSIND                                   1867 11700000
         BE    @RF01867                                            1867 11701000
*         DO;                                                      1868 11702000
*                                                                  1868 11703000
*           /*********************************************************/ 11704000
*           /*                                                       */ 11705000
*           /* SET RETURN CODE AND KEY/DATA LENGTHS USED             */ 11706000
*           /*                                                       */ 11707000
*           /*********************************************************/ 11708000
*                                                                  1869 11709000
*           TESTRC=RCSRBB;                                         1869 11710000
         LH    @15,RCSRBB                                          1869 11711000
         STH   @15,TESTRC                                          1869 11712000
*           RDSPKL=LOCKLEN(RDRECNUM+1);                            1870 11713000
         SLR   @15,@15                                             1870 11714000
         IC    @15,LOCKLEN(@05,@04)                                1870 11715000
         STC   @15,RDSPKL(,@14)                                    1870 11716000
*           RDSPDL=LOCDLEN(RDRECNUM+1);                            1871 11717000
         LH    @15,LOCDLEN(@05,@04)                                1871 11718000
         STH   @15,RDSPDL(,@14)                                    1871 11719000
*         END;                                                     1872 11720000
*                                                                  1872 11721000
*       /*************************************************************/ 11722000
*       /*                                                           */ 11723000
*       /* IF COUNT RETURN CODE WAS DESTAGE ERROR AND KEY/DATA RETURN*/ 11724000
*       /* CODE WAS BAD KEY/DATA AND REQUEST WAS FOR A DATA SET THEN */ 11725000
*       /* RETURN PROPER CODE                                        */ 11726000
*       /*                                                           */ 11727000
*       /*************************************************************/ 11728000
*                                                                  1873 11729000
*       IF LOCRCNT(RDRECNUM+1)=RCABDS&LOCRCKD(RDRECNUM+1)=RCABDTCK&RDDS 11730000
*           =DSIND THEN                                            1873 11731000
@RF01867 L     @15,@PC00004                                        1873 11732000
         SLR   @14,@14                                             1873 11733000
         IC    @14,RDRECNUM(,@15)                                  1873 11734000
         MH    @14,@CH00647                                        1873 11735000
         L     @05,RDLOCPTR(,@15)                                  1873 11736000
         LH    @04,LOCRCNT(@14,@05)                                1873 11737000
         CH    @04,RCABDS                                          1873 11738000
         BNE   @RF01873                                            1873 11739000
         LH    @14,LOCRCKD(@14,@05)                                1873 11740000
         CH    @14,RCABDTCK                                        1873 11741000
         BNE   @RF01873                                            1873 11742000
         CLC   RDDS(1,@15),DSIND                                   1873 11743000
         BNE   @RF01873                                            1873 11744000
*         TESTRC=RCSRDSB;                                          1874 11745000
*                                                                  1874 11746000
         LH    @15,RCSRDSB                                         1874 11747000
         STH   @15,TESTRC                                          1874 11748000
*       /*************************************************************/ 11749000
*       /*                                                           */ 11750000
*       /* IF COUNT RETURN CODE WAS STAGE ERROR AND KEY/DATA RETURN  */ 11751000
*       /* CODE WAS BAD KEY/DATA AND REQUEST WAS FOR A DATA SET THEN */ 11752000
*       /* RETURN PROPER CODE                                        */ 11753000
*       /*                                                           */ 11754000
*       /*************************************************************/ 11755000
*                                                                  1875 11756000
*       IF LOCRCNT(RDRECNUM+1)=RCABST&LOCRCKD(RDRECNUM+1)=RCABDTCK&RDDS 11757000
*           =DSIND THEN                                            1875 11758000
@RF01873 L     @15,@PC00004                                        1875 11759000
         SLR   @14,@14                                             1875 11760000
         IC    @14,RDRECNUM(,@15)                                  1875 11761000
         MH    @14,@CH00647                                        1875 11762000
         L     @05,RDLOCPTR(,@15)                                  1875 11763000
         LH    @04,LOCRCNT(@14,@05)                                1875 11764000
         CH    @04,RCABST                                          1875 11765000
         BNE   @RF01875                                            1875 11766000
         LH    @14,LOCRCKD(@14,@05)                                1875 11767000
         CH    @14,RCABDTCK                                        1875 11768000
         BNE   @RF01875                                            1875 11769000
         CLC   RDDS(1,@15),DSIND                                   1875 11770000
         BNE   @RF01875                                            1875 11771000
*         TESTRC=RCSRSTB;                                          1876 11772000
         LH    @15,RCSRSTB                                         1876 11773000
         STH   @15,TESTRC                                          1876 11774000
*     END;                          /* NOT UNEXPECTED RC             */ 11775000
@RF01875 DS    0H                                                  1878 11776000
*   RETURN CODE(TESTRC);                                           1878 11777000
@RF01823 LH    @15,TESTRC                                          1878 11778000
         L     @14,@SA00004                                        1878 11779000
         LM    @00,@12,@SA00004+8                                  1878 11780000
         BR    @14                                                 1878 11781000
*                                                                  1879 11782000
*/********************************************************************/ 11783000
*/*                                                                  */ 11784000
*/*  PROCEDURE NAME - SRDRCRD                                        */ 11785000
*/*                                                                  */ 11786000
*/*  DESCRIPTION - SRDRCRD WILL READ IN THE RECORDS                  */ 11787000
*/*     ON THE REQUESTED TRACK AND SET THE LOCATION                  */ 11788000
*/*     TABLE ENTRIES FOR THAT TRACK                                 */ 11789000
*/*                                                                  */ 11790000
*/*   IT USES THE UEXCP READCNT FUNCTION,                            */ 11791000
*/*           THE UEXCP READKD FUNCTION,                             */ 11792000
*/*           AND THE UEXCP SPACCR FUNCTION                          */ 11793000
*/*                                                                  */ 11794000
*/*  INPUT - RDARG                                                   */ 11795000
*/*                                                                  */ 11796000
*/*   OUTPUT - THE LOCATION TABLE FOR THE TRACK                      */ 11797000
*/*    WILL CONTAIN ALL THE INFORMATION ABOUT                        */ 11798000
*/*    THE RECORDS ON THE TRACK                                      */ 11799000
*/*                                                                  */ 11800000
*/********************************************************************/ 11801000
*                                                                  1879 11802000
*SRDRCRD:                                                          1879 11803000
*   PROC;                                                          1879 11804000
*                                                                  1879 11805000
SRDRCRD  STM   @14,@12,@SA00005                                    1879 11806000
*   /*****************************************************************/ 11807000
*   /*                                                               */ 11808000
*   /* DECLARES                                              @ZA17169*/ 11809000
*   /*                                                               */ 11810000
*   /*****************************************************************/ 11811000
*                                                                  1880 11812000
*   DCL                                                            1880 11813000
*     SPACCRCT FIXED(15);           /* IO05 SPACCR LOOP CONTROL    1880 11814000
*                                                            @ZA17169*/ 11815000
*   DCL                                                            1881 11816000
*     SAVCCWCT FIXED(15);           /* RDCCWCT SAVED VALUE   @ZA17169*/ 11817000
*   DCL                                                            1882 11818000
*     RETRY FIXED(15) CONSTANT(2);  /* # OF ATTEMPTS         @ZA17169*/ 11819000
*                                                                  1882 11820000
*   /*****************************************************************/ 11821000
*   /*                                                               */ 11822000
*   /* SET TRACK ID TO 'RDD2'                                        */ 11823000
*   /*                                                               */ 11824000
*   /*****************************************************************/ 11825000
*                                                                  1883 11826000
*   OLDERID2=NEWERID2;                                             1883 11827000
         L     @02,@PC00001                                        1883 11828000
         L     @02,GDTTR2(,@02)                                    1883 11829000
         MVC   @TS00001(95),NEWERID2(@02)                          1883 11830000
         MVC   OLDERID2(95,@02),@TS00001                           1883 11831000
*   NEWID2='RDD2';                                                 1884 11832000
*                                                                  1884 11833000
         MVC   NEWID2(4,@02),@CC03002                              1884 11834000
*   /*****************************************************************/ 11835000
*   /*                                                               */ 11836000
*   /* SET FIRST TIME SWITCH FOR READCNT                             */ 11837000
*   /*                                                               */ 11838000
*   /*****************************************************************/ 11839000
*                                                                  1885 11840000
*   RFIRST=FSTIME;                                                 1885 11841000
*                                                                  1885 11842000
         L     @02,@PC00004                                        1885 11843000
         L     @15,RDIOAREA(,@02)                                  1885 11844000
         MVC   RFIRST(1,@15),FSTIME                                1885 11845000
*   /*****************************************************************/ 11846000
*   /*                                                               */ 11847000
*   /* SET CURRENT CCHHR IN RIOAREA FOR NEXT SREADREC CALL           */ 11848000
*   /*                                                               */ 11849000
*   /*****************************************************************/ 11850000
*                                                                  1886 11851000
*   RPREV=RDCHR;                                                   1886 11852000
*                                                                  1886 11853000
         MVC   RPREV(5,@15),RDCHR(@02)                             1886 11854000
*   /*****************************************************************/ 11855000
*   /*                                                               */ 11856000
*   /* INITIALIZE LEN ENTRY INDEX AND SAVED RDCCWCNT         @ZA17169*/ 11857000
*   /*                                                               */ 11858000
*   /*****************************************************************/ 11859000
*                                                                  1887 11860000
*   LENINDEX=ZERO;                                                 1887 11861000
         SLR   @02,@02                                             1887 11862000
         LR    LENINDEX,@02                                        1887 11863000
*   SAVCCWCT=ZERO;                  /*                       @ZA17169*/ 11864000
         LR    SAVCCWCT,@02                                        1888 11865000
*   SPACCRCT=ZERO;                  /*                       @ZA17169*/ 11866000
*                                                                  1889 11867000
         LR    SPACCRCT,@02                                        1889 11868000
*   /*****************************************************************/ 11869000
*   /*                                                               */ 11870000
*   /* KEEP CALLING UEXCP TO READ THE COUNT FIELDS UNTIL IT RETURNS  */ 11871000
*   /* AN INDICATION THAT NO MORE READING CAN BE DONE                */ 11872000
*   /*                                                               */ 11873000
*   /*****************************************************************/ 11874000
*                                                                  1890 11875000
*   TESTRC=0;                                                      1890 11876000
*                                                                  1890 11877000
         STH   @02,TESTRC                                          1890 11878000
*   /*****************************************************************/ 11879000
*   /*                                                               */ 11880000
*   /* EXIT FROM THE DO WHILE IF NO RECORD FOUND OR, UNCORRECTABLE   */ 11881000
*   /* I/O ERROR BEFORE REQUESTED REC OR SYNCH BYTE MISSING ON TRACK */ 11882000
*   /* OR UNEXPECTED RESULTS                                         */ 11883000
*   /*                                                               */ 11884000
*   /*****************************************************************/ 11885000
*                                                                  1891 11886000
*   DO WHILE TESTRC^=RCABNRF&TESTRC^=RCSRUNCO&TESTRC^=RCABSYNC&TESTRC^= 11887000
*         RCSRUEX;                                                 1891 11888000
         B     @DE01891                                            1891 11889000
@DL01891 DS    0H                                                  1892 11890000
*     CALL IDCIO050(GDTTBL,READCNT,RDARG);                         1892 11891000
         L     @02,@PC00001                                        1892 11892000
         ST    @02,@AL00001                                        1892 11893000
         LA    @15,READCNT                                         1892 11894000
         ST    @15,@AL00001+4                                      1892 11895000
         L     @15,@PC00004                                        1892 11896000
         ST    @15,@AL00001+8                                      1892 11897000
         MVI   @AL00001+8,X'80'                                    1892 11898000
         L     @15,GDTEXP(,@02)                                    1892 11899000
         LA    @01,@AL00001                                        1892 11900000
         BALR  @14,@15                                             1892 11901000
*     RESPECIFY                                                    1893 11902000
*       RTNREG RSTD;                                               1893 11903000
*     TESTRC=RTNREG;                                               1894 11904000
         STH   RTNREG,TESTRC                                       1894 11905000
*     RESPECIFY                                                    1895 11906000
*       RTNREG UNRSTD;                                             1895 11907000
*                                                                  1895 11908000
*     /***************************************************************/ 11909000
*     /*                                                             */ 11910000
*     /* SET TRACE ID                                                */ 11911000
*     /*                                                             */ 11912000
*     /***************************************************************/ 11913000
*                                                                  1896 11914000
*     OLDERID2=NEWERID2;                                           1896 11915000
         L     @02,@PC00001                                        1896 11916000
         L     @02,GDTTR2(,@02)                                    1896 11917000
         MVC   @TS00001(95),NEWERID2(@02)                          1896 11918000
         MVC   OLDERID2(95,@02),@TS00001                           1896 11919000
*     NEWID2='RDD3';                                               1897 11920000
*                                                                  1897 11921000
         MVC   NEWID2(4,@02),@CC03003                              1897 11922000
*     /***************************************************************/ 11923000
*     /*                                                             */ 11924000
*     /* AS LONG AS WE ARE PROGRESSING THROUGH OUR CCW STRING WE CAN */ 11925000
*     /* CONTINUE WITHOUT THE FEAR OF LOOPING. HOWEVER, SINCE CALLS  */ 11926000
*     /* TO IDCIO05 TO SPACE OVER THE BAD COUNTS ZERO THE RETURN     */ 11927000
*     /* CODE, WE MUST ALLOW ONLY A FINITE NUMBER OF RETRIES. WE     */ 11928000
*     /* ALLOW 2 RETRIES.                                    @ZA17169*/ 11929000
*     /*                                                             */ 11930000
*     /***************************************************************/ 11931000
*                                                                  1898 11932000
*     IF RDCCWCNT>SAVCCWCT THEN     /*                       @ZA17169*/ 11933000
         L     @02,@PC00004                                        1898 11934000
         LH    @02,RDCCWCNT(,@02)                                  1898 11935000
         CR    @02,SAVCCWCT                                        1898 11936000
         BNH   @RF01898                                            1898 11937000
*       DO;                         /*                       @ZA17169*/ 11938000
*         SPACCRCT=ZERO;            /*                       @ZA17169*/ 11939000
         SLR   SPACCRCT,SPACCRCT                                   1900 11940000
*         SAVCCWCT=RDCCWCNT;        /*                       @ZA17169*/ 11941000
         LR    SAVCCWCT,@02                                        1901 11942000
*       END;                        /*                       @ZA17169*/ 11943000
*                                                                  1902 11944000
*     /***************************************************************/ 11945000
*     /*                                                             */ 11946000
*     /* CHECK TO SEE IF LAST REC READ WAS R0                        */ 11947000
*     /*                                                             */ 11948000
*     /***************************************************************/ 11949000
*                                                                  1903 11950000
*     IF RDCCWCNT=ZERO&TESTRC^=4 THEN                              1903 11951000
@RF01898 SLR   @02,@02                                             1903 11952000
         L     @15,@PC00004                                        1903 11953000
         CH    @02,RDCCWCNT(,@15)                                  1903 11954000
         BNE   @RF01903                                            1903 11955000
         LH    @14,TESTRC                                          1903 11956000
         C     @14,@CF00045                                        1903 11957000
         BE    @RF01903                                            1903 11958000
*       DO;                                                        1904 11959000
*                                                                  1904 11960000
*         /***********************************************************/ 11961000
*         /*                                                         */ 11962000
*         /* READCNT STOPPED ON R0, SET COUNT TO OK, KEY/DATA TO     */ 11963000
*         /* CURRENT RC AND CALL SPACCR TO BYPASS READ R0 UP TO TWO  */ 11964000
*         /* TIMES ONLY                                      @ZA17169*/ 11965000
*         /*                                                         */ 11966000
*         /***********************************************************/ 11967000
*                                                                  1905 11968000
*         LOCRCNT(1)=0;                                            1905 11969000
         L     @01,RDLOCPTR(,@15)                                  1905 11970000
         STH   @02,LOCRCNT(,@01)                                   1905 11971000
*         LOCRCKD(1)=TESTRC;                                       1906 11972000
*                                                                  1906 11973000
         STH   @14,LOCRCKD(,@01)                                   1906 11974000
*         /***********************************************************/ 11975000
*         /*                                                         */ 11976000
*         /* IF WE HAVE ALREADY RETRIED THIS TWICE THEN      @ZA17169*/ 11977000
*         /* SIMPLY RETURN, OTHERWISE CALL IO05 AND          @ZA17169*/ 11978000
*         /* INCREMENT THE SPACCR COUNT.                     @ZA17169*/ 11979000
*         /*                                                         */ 11980000
*         /***********************************************************/ 11981000
*                                                                  1907 11982000
*         IF SPACCRCT<=RETRY THEN   /*                       @ZA17169*/ 11983000
         C     SPACCRCT,@CF00156                                   1907 11984000
         BH    @RF01907                                            1907 11985000
*           DO;                     /*                       @ZA17169*/ 11986000
*             CALL IDCIO050(GDTTBL,SPACCR,RDARG);/*          @ZA17169*/ 11987000
         L     @02,@PC00001                                        1909 11988000
         ST    @02,@AL00001                                        1909 11989000
         LA    @14,SPACCR                                          1909 11990000
         ST    @14,@AL00001+4                                      1909 11991000
         ST    @15,@AL00001+8                                      1909 11992000
         MVI   @AL00001+8,X'80'                                    1909 11993000
         L     @15,GDTEXP(,@02)                                    1909 11994000
         LA    @01,@AL00001                                        1909 11995000
         BALR  @14,@15                                             1909 11996000
*             RESPECIFY                                            1910 11997000
*               RTNREG RSTD;                                       1910 11998000
*             TESTRC=RTNREG;                                       1911 11999000
         STH   RTNREG,TESTRC                                       1911 12000000
*             RESPECIFY                                            1912 12001000
*               RTNREG UNRSTD;      /*                       @ZA17169*/ 12002000
*             SPACCRCT=SPACCRCT+1;  /*                       @ZA17169*/ 12003000
         AL    SPACCRCT,@CF00221                                   1913 12004000
*           END;                    /*                       @ZA17169*/ 12005000
*       END;                                                       1915 12006000
*                                                                  1915 12007000
*     /***************************************************************/ 12008000
*     /*                                                             */ 12009000
*     /* CHECK RETURN CODE FROM READCNT                              */ 12010000
*     /*                                                             */ 12011000
*     /***************************************************************/ 12012000
*                                                                  1916 12013000
*     ELSE                                                         1916 12014000
*       IF TESTRC=RCABNRF THEN                                     1916 12015000
         B     @RC01903                                            1916 12016000
@RF01903 CLC   TESTRC(2),RCABNRF                                   1916 12017000
         BNE   @RF01916                                            1916 12018000
*         DO;                                                      1917 12019000
*                                                                  1917 12020000
*           /*********************************************************/ 12021000
*           /*                                                       */ 12022000
*           /* RECORD NOT FOUND- FIRST SET EO TRACK IND IN ALL LOCTAB*/ 12023000
*           /* ENTRIES FROM HERE TO END THEN SET LAST RECORD NUMBER  */ 12024000
*           /* FOR READ KEY/DATA TO READ                             */ 12025000
*           /*                                                       */ 12026000
*           /*********************************************************/ 12027000
*                                                                  1918 12028000
*           DO RDCTR=(RDCCWCNT+1) TO LOCENT;                       1918 12029000
         L     @15,@PC00004                                        1918 12030000
         LA    RDCTR,1                                             1918 12031000
         AH    RDCTR,RDCCWCNT(,@15)                                1918 12032000
         B     @DE01918                                            1918 12033000
@DL01918 DS    0H                                                  1919 12034000
*             LOCRCNT(RDCTR)=RCSREOTR;                             1919 12035000
         LR    @15,RDCTR                                           1919 12036000
         MH    @15,@CH00647                                        1919 12037000
         L     @14,@PC00004                                        1919 12038000
         L     @01,RDLOCPTR(,@14)                                  1919 12039000
         LH    @14,RCSREOTR                                        1919 12040000
         AL    @01,@CF03052                                        1919 12041000
         STH   @14,LOCRCNT-4(@15,@01)                              1919 12042000
*           END;                                                   1920 12043000
         AL    RDCTR,@CF00221                                      1920 12044000
@DE01918 CH    RDCTR,LOCENT                                        1920 12045000
         BNH   @DL01918                                            1920 12046000
*           RDCCWCNT=RDCCWCNT-1;                                   1921 12047000
         L     @02,@PC00004                                        1921 12048000
         LH    @15,RDCCWCNT(,@02)                                  1921 12049000
         BCTR  @15,0                                               1921 12050000
         STH   @15,RDCCWCNT(,@02)                                  1921 12051000
*         END;                                                     1922 12052000
*       ELSE                                                       1923 12053000
*         IF TESTRC=RCABDTCK THEN                                  1923 12054000
         B     @RC01916                                            1923 12055000
@RF01916 CLC   TESTRC(2),RCABDTCK                                  1923 12056000
         BNE   @RF01923                                            1923 12057000
*           DO;                                                    1924 12058000
*                                                                  1924 12059000
*             /*******************************************************/ 12060000
*             /*                                                     */ 12061000
*             /* BAD COUNT FIELD - DETERMINE WHAT TO DO NOW          */ 12062000
*             /*                                                     */ 12063000
*             /*******************************************************/ 12064000
*                                                                  1925 12065000
*                                                                  1925 12066000
*/********************************************************************/ 12067000
*/*                                                                  */ 12068000
*/*                                                                  */ 12069000
*/*  THE FOLLOWING SECTION OF CODE IS USED TO DETERMINE              */ 12070000
*/*   THE CONDITIONS FOLLOWING A BAD COUNT RETURN CODE               */ 12071000
*/*   FROM READ COUNT                                                */ 12072000
*/*                                                                  */ 12073000
*/*                                                                  */ 12074000
*/********************************************************************/ 12075000
*                                                                  1925 12076000
*             /*******************************************************/ 12077000
*             /*                                                     */ 12078000
*             /* CHECK IF DATA SET REQUEST, OR IF LEN INFO NOT AVAIL */ 12079000
*             /*                                                     */ 12080000
*             /*******************************************************/ 12081000
*                                                                  1925 12082000
*             IF RDDS=DSIND|RDLENTOT=ZERO THEN                     1925 12083000
*                                                                  1925 12084000
         L     @02,@PC00004                                        1925 12085000
         CLC   RDDS(1,@02),DSIND                                   1925 12086000
         BE    @RT01925                                            1925 12087000
         LH    @02,RDLENTOT(,@02)                                  1925 12088000
         LTR   @02,@02                                             1925 12089000
         BNZ   @RF01925                                            1925 12090000
@RT01925 DS    0H                                                  1926 12091000
*               /*****************************************************/ 12092000
*               /*                                                   */ 12093000
*               /* CANNOT CONTINUE ON THIS TRACK CHECK TO SEE IF WE  */ 12094000
*               /* CAN SATISFY THIS REQUEST                          */ 12095000
*               /*                                                   */ 12096000
*               /*****************************************************/ 12097000
*                                                                  1926 12098000
*               IF RDRECNUM>=RDCCWCNT THEN                         1926 12099000
         L     @02,@PC00004                                        1926 12100000
         SLR   @15,@15                                             1926 12101000
         IC    @15,RDRECNUM(,@02)                                  1926 12102000
         CH    @15,RDCCWCNT(,@02)                                  1926 12103000
         BL    @RF01926                                            1926 12104000
*                 DO;                                              1927 12105000
*                                                                  1927 12106000
*                   /*************************************************/ 12107000
*                   /*                                               */ 12108000
*                   /* ERROR BEFORE REQUESTED RECORD                 */ 12109000
*                   /*                                               */ 12110000
*                   /*************************************************/ 12111000
*                                                                  1928 12112000
*                   TESTRC=RCSRUNCO;                               1928 12113000
         LH    @14,RCSRUNCO                                        1928 12114000
         STH   @14,TESTRC                                          1928 12115000
*                   LOCRCNT(RDRECNUM+1)=TESTRC;                    1929 12116000
         MH    @15,@CH00647                                        1929 12117000
         L     @02,RDLOCPTR(,@02)                                  1929 12118000
         STH   @14,LOCRCNT(@15,@02)                                1929 12119000
*                 END;                                             1930 12120000
*               ELSE                                               1931 12121000
*                 DO;                                              1931 12122000
*                                                                  1931 12123000
         B     @RC01926                                            1931 12124000
@RF01926 DS    0H                                                  1932 12125000
*                   /*************************************************/ 12126000
*                   /*                                               */ 12127000
*                   /* ERROR AFTER REQUESTED RECORD SET UNCORRECTABLE*/ 12128000
*                   /* ERROR BEFORE REQUESTED RECORD RC IN REST OF   */ 12129000
*                   /* LOCTAB                                        */ 12130000
*                   /*                                               */ 12131000
*                   /*************************************************/ 12132000
*                                                                  1932 12133000
*                   DO RDCTR=(RDCCWCNT+1) TO LOCENT;               1932 12134000
         L     @15,@PC00004                                        1932 12135000
         LA    RDCTR,1                                             1932 12136000
         AH    RDCTR,RDCCWCNT(,@15)                                1932 12137000
         B     @DE01932                                            1932 12138000
@DL01932 DS    0H                                                  1933 12139000
*                     LOCRCNT(RDCTR)=TESTRC;                       1933 12140000
         LR    @15,RDCTR                                           1933 12141000
         MH    @15,@CH00647                                        1933 12142000
         L     @14,@PC00004                                        1933 12143000
         L     @01,RDLOCPTR(,@14)                                  1933 12144000
         LH    @14,TESTRC                                          1933 12145000
         AL    @01,@CF03052                                        1933 12146000
         STH   @14,LOCRCNT-4(@15,@01)                              1933 12147000
*                   END;                                           1934 12148000
*                                                                  1934 12149000
         AL    RDCTR,@CF00221                                      1934 12150000
@DE01932 CH    RDCTR,LOCENT                                        1934 12151000
         BNH   @DL01932                                            1934 12152000
*                   /*************************************************/ 12153000
*                   /*                                               */ 12154000
*                   /* SET LAST RECORD FOR READKD TO READ            */ 12155000
*                   /*                                               */ 12156000
*                   /*************************************************/ 12157000
*                                                                  1935 12158000
*                   RDCCWCNT=RDCCWCNT-1;                           1935 12159000
         L     @02,@PC00004                                        1935 12160000
         LH    @15,RDCCWCNT(,@02)                                  1935 12161000
         BCTR  @15,0                                               1935 12162000
         STH   @15,RDCCWCNT(,@02)                                  1935 12163000
*                 END;                                             1936 12164000
*                                                                  1936 12165000
*             /*******************************************************/ 12166000
*             /*                                                     */ 12167000
*             /* NOT A DATA SET REQUEST, LEN INFO AVAILABLE          */ 12168000
*             /*                                                     */ 12169000
*             /*******************************************************/ 12170000
*                                                                  1937 12171000
*             ELSE                                                 1937 12172000
*               DO;                                                1937 12173000
*                                                                  1937 12174000
         B     @RC01925                                            1937 12175000
@RF01925 DS    0H                                                  1938 12176000
*                 /***************************************************/ 12177000
*                 /*                                                 */ 12178000
*                 /* CALC WHICH LEN ENTRY TO USE AND SET IN LOCTAB   */ 12179000
*                 /*                                                 */ 12180000
*                 /***************************************************/ 12181000
*                                                                  1938 12182000
*                 IF RDLENTOT^=LENINDEX THEN                       1938 12183000
*                                                                  1938 12184000
         L     @02,@PC00004                                        1938 12185000
         CH    LENINDEX,RDLENTOT(,@02)                             1938 12186000
         BE    @RF01938                                            1938 12187000
*                   /*************************************************/ 12188000
*                   /*                                               */ 12189000
*                   /* IF NOT AT LAST ENTRY PROVIDED, USE NEXT ONE   */ 12190000
*                   /*                                               */ 12191000
*                   /*************************************************/ 12192000
*                                                                  1939 12193000
*                   LENINDEX=LENINDEX+1;                           1939 12194000
         AL    LENINDEX,@CF00221                                   1939 12195000
*                 ELSE                                             1940 12196000
*                   ;                                              1940 12197000
*                                                                  1940 12198000
@RF01938 DS    0H                                                  1941 12199000
*                 /***************************************************/ 12200000
*                 /*                                                 */ 12201000
*                 /* SET CURRENT KEY AND DATA LENGTH IN LOCTAB ENTRY */ 12202000
*                 /*                                                 */ 12203000
*                 /***************************************************/ 12204000
*                                                                  1941 12205000
*                 LOCKLEN(RDCCWCNT+1)=KEYLENS;                     1941 12206000
         L     @02,@PC00004                                        1941 12207000
         LH    @15,RDCCWCNT(,@02)                                  1941 12208000
         MH    @15,@CH00647                                        1941 12209000
         L     @14,RDLOCPTR(,@02)                                  1941 12210000
         LR    @01,LENINDEX                                        1941 12211000
         SLA   @01,2                                               1941 12212000
         ST    @02,@TF00001                                        1941 12213000
         L     @02,RDKLEN(,@02)                                    1941 12214000
         AL    @02,@CF03049                                        1941 12215000
         L     @02,KEYPTR(@01,@02)                                 1941 12216000
         L     @02,KEYLENS(,@02)                                   1941 12217000
         STC   @02,LOCKLEN(@15,@14)                                1941 12218000
*                 LOCDLEN(RDCCWCNT+1)=DATALENS;                    1942 12219000
*                                                                  1942 12220000
         L     @02,@TF00001                                        1942 12221000
         L     @02,RDDLEN(,@02)                                    1942 12222000
         AL    @02,@CF03049                                        1942 12223000
         L     @02,DATPTR(@01,@02)                                 1942 12224000
         L     @02,DATALENS(,@02)                                  1942 12225000
         STH   @02,LOCDLEN(@15,@14)                                1942 12226000
*                 /***************************************************/ 12227000
*                 /*                                                 */ 12228000
*                 /* SET LEN PTR FOR SPACE COUNT                     */ 12229000
*                 /*                                                 */ 12230000
*                 /***************************************************/ 12231000
*                                                                  1943 12232000
*                 RDRWPKLN=ADDR(LOCKLEN(RDCCWCNT+1));              1943 12233000
*                                                                  1943 12234000
         LA    @02,LOCKLEN(@15,@14)                                1943 12235000
         L     @01,@TF00001                                        1943 12236000
         ST    @02,RDRWPKLN(,@01)                                  1943 12237000
*                 /***************************************************/ 12238000
*                 /*                                                 */ 12239000
*                 /* CALL SPACCR TO SET UP TO BYPASS BAD COUNT IF WE */ 12240000
*                 /* HAVE ALREADY RETRIED THIS TWICE THEN    @ZA17169*/ 12241000
*                 /* SIMPLY RETURN, OTHERWISE CALL IO05 AND  @ZA17169*/ 12242000
*                 /* INCREMENT THE SPACCR COUNT.             @ZA17169*/ 12243000
*                 /*                                                 */ 12244000
*                 /***************************************************/ 12245000
*                                                                  1944 12246000
*                 IF SPACCRCT<=RETRY THEN/*                  @ZA17169*/ 12247000
         C     SPACCRCT,@CF00156                                   1944 12248000
         BH    @RF01944                                            1944 12249000
*                   DO;             /*                       @ZA17169*/ 12250000
*                     CALL IDCIO050(GDTTBL,SPACCR,RDARG);/*  @ZA17169*/ 12251000
         L     @02,@PC00001                                        1946 12252000
         ST    @02,@AL00001                                        1946 12253000
         LA    @15,SPACCR                                          1946 12254000
         ST    @15,@AL00001+4                                      1946 12255000
         L     @01,@TF00001                                        1946 12256000
         ST    @01,@AL00001+8                                      1946 12257000
         MVI   @AL00001+8,X'80'                                    1946 12258000
         L     @15,GDTEXP(,@02)                                    1946 12259000
         LA    @01,@AL00001                                        1946 12260000
         BALR  @14,@15                                             1946 12261000
*                     RESPECIFY                                    1947 12262000
*                       RTNREG RSTD;                               1947 12263000
*                     TESTRC=RTNREG;                               1948 12264000
         STH   RTNREG,TESTRC                                       1948 12265000
*                     RESPECIFY                                    1949 12266000
*                       RTNREG UNRSTD;/*                     @ZA17169*/ 12267000
*                     SPACCRCT=SPACCRCT+1;/*                 @ZA17169*/ 12268000
         AL    SPACCRCT,@CF00221                                   1950 12269000
*                   END;            /*                       @ZA17169*/ 12270000
*               END;                                               1952 12271000
*                                                                  1952 12272000
*             /*******************************************************/ 12273000
*             /*                                                     */ 12274000
*             /* END DATA CHECK DO                                   */ 12275000
*             /*                                                     */ 12276000
*             /*******************************************************/ 12277000
*                                                                  1953 12278000
*           END;                                                   1953 12279000
*                                                                  1953 12280000
*     /***************************************************************/ 12281000
*     /*                                                             */ 12282000
*     /* NOT A DATA CHECK CHECK FOR DESTAGE ERROR                    */ 12283000
*     /*                                                             */ 12284000
*     /***************************************************************/ 12285000
*                                                                  1954 12286000
*         ELSE                                                     1954 12287000
*           IF TESTRC=RCABDS THEN                                  1954 12288000
         B     @RC01923                                            1954 12289000
@RF01923 CLC   TESTRC(2),RCABDS                                    1954 12290000
         BNE   @RF01954                                            1954 12291000
*             DO;                                                  1955 12292000
*                                                                  1955 12293000
*               /*****************************************************/ 12294000
*               /*                                                   */ 12295000
*               /* DESTAGE ERROR ON COUNT SET KEY LEN TO ZERO AND    */ 12296000
*               /* DATA LEN TO ONE AND CALL SPACCR TO BYPASS THE BAD */ 12297000
*               /* COUNT IF WE HAVE ALREADY RETRIED THIS TWICE THEN  */ 12298000
*               /*                                           @ZA17169*/ 12299000
*               /* SIMPLY RETURN, OTHERWISE CALL IO05 AND    @ZA17169*/ 12300000
*               /* INCREMENT THE SPACCR COUNT.               @ZA17169*/ 12301000
*               /*                                                   */ 12302000
*               /*****************************************************/ 12303000
*                                                                  1956 12304000
*               LOCKLEN(RDCCWCNT+1)=ZERO;                          1956 12305000
         L     @02,@PC00004                                        1956 12306000
         LH    @15,RDCCWCNT(,@02)                                  1956 12307000
         MH    @15,@CH00647                                        1956 12308000
         L     @14,RDLOCPTR(,@02)                                  1956 12309000
         SLR   @01,@01                                             1956 12310000
         STC   @01,LOCKLEN(@15,@14)                                1956 12311000
*               LOCDLEN(RDCCWCNT+1)=1;                             1957 12312000
         LA    @01,1                                               1957 12313000
         STH   @01,LOCDLEN(@15,@14)                                1957 12314000
*               RDRWPKLN=ADDR(LOCKLEN(RDCCWCNT+1));                1958 12315000
         LA    @15,LOCKLEN(@15,@14)                                1958 12316000
         ST    @15,RDRWPKLN(,@02)                                  1958 12317000
*               IF SPACCRCT<=RETRY THEN/*                    @ZA17169*/ 12318000
         C     SPACCRCT,@CF00156                                   1959 12319000
         BH    @RF01959                                            1959 12320000
*                 DO;               /*                       @ZA17169*/ 12321000
*                   CALL IDCIO050(GDTTBL,SPACCR,RDARG);/*    @ZA17169*/ 12322000
         L     @15,@PC00001                                        1961 12323000
         ST    @15,@AL00001                                        1961 12324000
         LA    @14,SPACCR                                          1961 12325000
         ST    @14,@AL00001+4                                      1961 12326000
         ST    @02,@AL00001+8                                      1961 12327000
         MVI   @AL00001+8,X'80'                                    1961 12328000
         L     @15,GDTEXP(,@15)                                    1961 12329000
         LA    @01,@AL00001                                        1961 12330000
         BALR  @14,@15                                             1961 12331000
*                   RESPECIFY                                      1962 12332000
*                     RTNREG RSTD;                                 1962 12333000
*                   TESTRC=RTNREG;                                 1963 12334000
         STH   RTNREG,TESTRC                                       1963 12335000
*                   RESPECIFY                                      1964 12336000
*                     RTNREG UNRSTD;/*                       @ZA17169*/ 12337000
*                   SPACCRCT=SPACCRCT+1;/*                   @ZA17169*/ 12338000
         AL    SPACCRCT,@CF00221                                   1965 12339000
*                 END;              /*                       @ZA17169*/ 12340000
*             END;                                                 1967 12341000
*           ELSE                                                   1968 12342000
*             IF TESTRC=RCABST THEN                                1968 12343000
         B     @RC01954                                            1968 12344000
@RF01954 CLC   TESTRC(2),RCABST                                    1968 12345000
         BNE   @RF01968                                            1968 12346000
*               DO;                                                1969 12347000
*                                                                  1969 12348000
*                 /***************************************************/ 12349000
*                 /*                                                 */ 12350000
*                 /* STAGING ERROR ON COUNT KEY/DATA LENGTHS IN COUNT*/ 12351000
*                 /* FIELD CALL UEXCP SPACCR TO BYPASS BAD COUNT IF  */ 12352000
*                 /* WE HAVE ALREADY RETRIED THIS TWICE THEN @ZA17169*/ 12353000
*                 /* SIMPLY RETURN, OTHERWISE CALL IO05 AND  @ZA17169*/ 12354000
*                 /* INCREMENT THE SPACCR COUNT.             @ZA17169*/ 12355000
*                 /*                                                 */ 12356000
*                 /***************************************************/ 12357000
*                                                                  1970 12358000
*                 RDRWPKLN=NULLPTR;                                1970 12359000
         L     @02,@PC00004                                        1970 12360000
         SLR   @15,@15                                             1970 12361000
         ST    @15,RDRWPKLN(,@02)                                  1970 12362000
*                 IF SPACCRCT<=RETRY THEN/*                  @ZA17169*/ 12363000
         C     SPACCRCT,@CF00156                                   1971 12364000
         BH    @RF01971                                            1971 12365000
*                   DO;             /*                       @ZA17169*/ 12366000
*                     CALL IDCIO050(GDTTBL,SPACCR,RDARG);/*  @ZA17169*/ 12367000
         L     @15,@PC00001                                        1973 12368000
         ST    @15,@AL00001                                        1973 12369000
         LA    @14,SPACCR                                          1973 12370000
         ST    @14,@AL00001+4                                      1973 12371000
         ST    @02,@AL00001+8                                      1973 12372000
         MVI   @AL00001+8,X'80'                                    1973 12373000
         L     @15,GDTEXP(,@15)                                    1973 12374000
         LA    @01,@AL00001                                        1973 12375000
         BALR  @14,@15                                             1973 12376000
*                     RESPECIFY                                    1974 12377000
*                       RTNREG RSTD;                               1974 12378000
*                     TESTRC=RTNREG;                               1975 12379000
         STH   RTNREG,TESTRC                                       1975 12380000
*                     RESPECIFY                                    1976 12381000
*                       RTNREG UNRSTD;/*                     @ZA17169*/ 12382000
*                     SPACCRCT=SPACCRCT+1;/*                 @ZA17169*/ 12383000
         AL    SPACCRCT,@CF00221                                   1977 12384000
*                   END;            /*                       @ZA17169*/ 12385000
*               END;                                               1979 12386000
*             ELSE                                                 1980 12387000
*               IF TESTRC=RCABSYNC THEN                            1980 12388000
*                                                                  1980 12389000
         B     @RC01968                                            1980 12390000
@RF01968 CLC   TESTRC(2),RCABSYNC                                  1980 12391000
         BNE   @RF01980                                            1980 12392000
*                 /***************************************************/ 12393000
*                 /*                                                 */ 12394000
*                 /* SYNC BYTE MISSING CANNOT CONTINUE ON THIS TRACK */ 12395000
*                 /* CHECK TO SEE IF WE CAN SATISFY THIS REQUEST     */ 12396000
*                 /*                                                 */ 12397000
*                 /***************************************************/ 12398000
*                                                                  1981 12399000
*                 IF RDRECNUM>=RDCCWCNT THEN                       1981 12400000
         L     @02,@PC00004                                        1981 12401000
         SLR   @15,@15                                             1981 12402000
         IC    @15,RDRECNUM(,@02)                                  1981 12403000
         CH    @15,RDCCWCNT(,@02)                                  1981 12404000
         BL    @RF01981                                            1981 12405000
*                   DO;                                            1982 12406000
*                                                                  1982 12407000
*                     /***********************************************/ 12408000
*                     /*                                             */ 12409000
*                     /* ERROR BEFORE REQUESTED RECORD               */ 12410000
*                     /*                                             */ 12411000
*                     /***********************************************/ 12412000
*                                                                  1983 12413000
*                     TESTRC=RCSRUNCO;                             1983 12414000
         LH    @14,RCSRUNCO                                        1983 12415000
         STH   @14,TESTRC                                          1983 12416000
*                     LOCRCNT(RDRECNUM+1)=TESTRC;                  1984 12417000
         MH    @15,@CH00647                                        1984 12418000
         L     @02,RDLOCPTR(,@02)                                  1984 12419000
         STH   @14,LOCRCNT(@15,@02)                                1984 12420000
*                   END;                                           1985 12421000
*                 ELSE                                             1986 12422000
*                   DO;                                            1986 12423000
*                                                                  1986 12424000
         B     @RC01981                                            1986 12425000
@RF01981 DS    0H                                                  1987 12426000
*                     /***********************************************/ 12427000
*                     /*                                             */ 12428000
*                     /* ERROR AFTER REQUESTED RECORD SET            */ 12429000
*                     /* UNCORRECTABLE ERROR BEFORE REQUESTED RECORD */ 12430000
*                     /* RC IN REST OF LOCTAB                        */ 12431000
*                     /*                                             */ 12432000
*                     /***********************************************/ 12433000
*                                                                  1987 12434000
*                     DO RDCTR=(RDCCWCNT+1) TO LOCENT;             1987 12435000
         L     @15,@PC00004                                        1987 12436000
         LA    RDCTR,1                                             1987 12437000
         AH    RDCTR,RDCCWCNT(,@15)                                1987 12438000
         B     @DE01987                                            1987 12439000
@DL01987 DS    0H                                                  1988 12440000
*                       LOCRCNT(RDCTR)=TESTRC;                     1988 12441000
         LH    @15,TESTRC                                          1988 12442000
         LR    @14,RDCTR                                           1988 12443000
         MH    @14,@CH00647                                        1988 12444000
         L     @01,@PC00004                                        1988 12445000
         L     @01,RDLOCPTR(,@01)                                  1988 12446000
         ST    @14,@TF00001                                        1988 12447000
         LA    @14,0(@14,@01)                                      1988 12448000
         AL    @14,@CF03052                                        1988 12449000
         STH   @15,LOCRCNT-4(,@14)                                 1988 12450000
*                       LOCRCKD(RDCTR)=TESTRC;                     1989 12451000
         L     @14,@TF00001                                        1989 12452000
         AL    @14,@CF03053                                        1989 12453000
         STH   @15,LOCRCKD-6(@14,@01)                              1989 12454000
*                       LOCADDR(RDCTR)=NTFNDPTR;                   1990 12455000
         ICM   @00,15,NTFNDPTR                                     1990 12456000
         L     @15,@TF00001                                        1990 12457000
         AL    @01,@CF03054                                        1990 12458000
         ST    @00,LOCADDR(@15,@01)                                1990 12459000
*                     END;                                         1991 12460000
*                                                                  1991 12461000
         AL    RDCTR,@CF00221                                      1991 12462000
@DE01987 CH    RDCTR,LOCENT                                        1991 12463000
         BNH   @DL01987                                            1991 12464000
*                     /***********************************************/ 12465000
*                     /*                                             */ 12466000
*                     /* SET LAST RECORD FOR READKD TO READ          */ 12467000
*                     /*                                             */ 12468000
*                     /***********************************************/ 12469000
*                                                                  1992 12470000
*                     RDCCWCNT=RDCCWCNT-1;                         1992 12471000
         L     @02,@PC00004                                        1992 12472000
         LH    @15,RDCCWCNT(,@02)                                  1992 12473000
         BCTR  @15,0                                               1992 12474000
         STH   @15,RDCCWCNT(,@02)                                  1992 12475000
*                   END;                                           1993 12476000
*               ELSE                                               1994 12477000
*                 IF TESTRC=4 THEN                                 1994 12478000
         B     @RC01980                                            1994 12479000
@RF01980 CLC   TESTRC(2),@CH00045                                  1994 12480000
         BNE   @RF01994                                            1994 12481000
*                   DO;                                            1995 12482000
*                                                                  1995 12483000
*                     /***********************************************/ 12484000
*                     /*                                             */ 12485000
*                     /* UNCORRECTABLE ERROR SOMEWHERE ON THE TRACK  */ 12486000
*                     /* SET UNCORRECTABLE RETURN CODE AND RETURN    */ 12487000
*                     /*                                             */ 12488000
*                     /***********************************************/ 12489000
*                                                                  1996 12490000
*                     TESTRC=RCSRUNCO;                             1996 12491000
         LH    @02,RCSRUNCO                                        1996 12492000
         STH   @02,TESTRC                                          1996 12493000
*                     LOCRCNT(RDRECNUM+1)=TESTRC;                  1997 12494000
         L     @15,@PC00004                                        1997 12495000
         SLR   @14,@14                                             1997 12496000
         IC    @14,RDRECNUM(,@15)                                  1997 12497000
         MH    @14,@CH00647                                        1997 12498000
         L     @01,RDLOCPTR(,@15)                                  1997 12499000
         STH   @02,LOCRCNT(@14,@01)                                1997 12500000
*                   END;                                           1998 12501000
*                 ELSE                                             1999 12502000
*                   DO;                                            1999 12503000
*                                                                  1999 12504000
         B     @RC01994                                            1999 12505000
@RF01994 DS    0H                                                  2000 12506000
*                     /***********************************************/ 12507000
*                     /*                                             */ 12508000
*                     /* NONE OF THE EXPECTED RETURN CODES SET       */ 12509000
*                     /* UNEXPECTED RESULTS AND RETURN               */ 12510000
*                     /*                                             */ 12511000
*                     /***********************************************/ 12512000
*                                                                  2000 12513000
*                     TESTRC=RCSRUEX;                              2000 12514000
         LH    @02,RCSRUEX                                         2000 12515000
         STH   @02,TESTRC                                          2000 12516000
*                     DO RDCTR=(RDCCWCNT+1) TO LOCENT;             2001 12517000
         L     @15,@PC00004                                        2001 12518000
         LA    RDCTR,1                                             2001 12519000
         AH    RDCTR,RDCCWCNT(,@15)                                2001 12520000
         B     @DE02001                                            2001 12521000
@DL02001 DS    0H                                                  2002 12522000
*                       LOCRCNT(RDCTR)=TESTRC;                     2002 12523000
         LH    @15,TESTRC                                          2002 12524000
         LR    @14,RDCTR                                           2002 12525000
         MH    @14,@CH00647                                        2002 12526000
         L     @01,@PC00004                                        2002 12527000
         L     @01,RDLOCPTR(,@01)                                  2002 12528000
         ST    @14,@TF00001                                        2002 12529000
         LA    @14,0(@14,@01)                                      2002 12530000
         AL    @14,@CF03052                                        2002 12531000
         STH   @15,LOCRCNT-4(,@14)                                 2002 12532000
*                       LOCRCKD(RDCTR)=TESTRC;                     2003 12533000
         L     @14,@TF00001                                        2003 12534000
         AL    @14,@CF03053                                        2003 12535000
         STH   @15,LOCRCKD-6(@14,@01)                              2003 12536000
*                       LOCADDR(RDCTR)=NTFNDPTR;                   2004 12537000
         ICM   @00,15,NTFNDPTR                                     2004 12538000
         L     @15,@TF00001                                        2004 12539000
         AL    @01,@CF03054                                        2004 12540000
         ST    @00,LOCADDR(@15,@01)                                2004 12541000
*                     END;                                         2005 12542000
         AL    RDCTR,@CF00221                                      2005 12543000
@DE02001 CH    RDCTR,LOCENT                                        2005 12544000
         BNH   @DL02001                                            2005 12545000
*                   END;                                           2006 12546000
*                                                                  2006 12547000
*     /***************************************************************/ 12548000
*     /*                                                             */ 12549000
*     /* END OF DO WHILE LOOP FOR READING COUNTS                     */ 12550000
*     /*                                                             */ 12551000
*     /***************************************************************/ 12552000
*                                                                  2007 12553000
*   END;                                                           2007 12554000
*                                                                  2007 12555000
@RC01994 DS    0H                                                  2007 12556000
@RC01980 DS    0H                                                  2007 12557000
@RC01968 DS    0H                                                  2007 12558000
@RC01954 DS    0H                                                  2007 12559000
@RC01923 DS    0H                                                  2007 12560000
@RC01916 DS    0H                                                  2007 12561000
@RC01903 DS    0H                                                  2007 12562000
@DE01891 LH    @02,TESTRC                                          2007 12563000
         CH    @02,RCABNRF                                         2007 12564000
         BE    @DC01891                                            2007 12565000
         CH    @02,RCSRUNCO                                        2007 12566000
         BE    @DC01891                                            2007 12567000
         CH    @02,RCABSYNC                                        2007 12568000
         BE    @DC01891                                            2007 12569000
         CH    @02,RCSRUEX                                         2007 12570000
         BNE   @DL01891                                            2007 12571000
@DC01891 DS    0H                                                  2008 12572000
*/********************************************************************/ 12573000
*/*                                                                  */ 12574000
*/*    ALL COUNT FIELDS HAVE BEEN READ                               */ 12575000
*/*                                                                  */ 12576000
*/*    READ KEY  AND  DATA FIELDS IF NECESSARY                       */ 12577000
*/*                                                                  */ 12578000
*/*                                                                  */ 12579000
*/*                                                                  */ 12580000
*/********************************************************************/ 12581000
*                                                                  2008 12582000
*   /*****************************************************************/ 12583000
*   /*                                                               */ 12584000
*   /* SET INDEX OF LAST RECORD READ RESET RECORDS READ COUNTER      */ 12585000
*   /*                                                               */ 12586000
*   /*****************************************************************/ 12587000
*                                                                  2008 12588000
*   RNUMREC=RDCCWCNT;                                              2008 12589000
         L     @15,@PC00004                                        2008 12590000
         L     @14,RDIOAREA(,@15)                                  2008 12591000
         LH    @05,RDCCWCNT(,@15)                                  2008 12592000
         STH   @05,RNUMREC(,@14)                                   2008 12593000
*   RDCCWCNT=ZERO;                                                 2009 12594000
*                                                                  2009 12595000
         SLR   @05,@05                                             2009 12596000
         STH   @05,RDCCWCNT(,@15)                                  2009 12597000
*   /*****************************************************************/ 12598000
*   /*                                                               */ 12599000
*   /* SET FIRST TIME TO READ KEY/DATA                               */ 12600000
*   /*                                                               */ 12601000
*   /*****************************************************************/ 12602000
*                                                                  2010 12603000
*   RFIRST=FSTIME;                                                 2010 12604000
*                                                                  2010 12605000
         MVC   RFIRST(1,@14),FSTIME                                2010 12606000
*   /*****************************************************************/ 12607000
*   /*                                                               */ 12608000
*   /* READ ALL THE RECORDS AVAILABLE UNLESS AN UNCORRECTABLE I/O    */ 12609000
*   /* ERROR OCCURRED BEFORE REQUESTED RECORD OR UNEXPECTED RESULTS  */ 12610000
*   /* WERE INDICATED FROM READCNT                                   */ 12611000
*   /*                                                               */ 12612000
*   /*****************************************************************/ 12613000
*                                                                  2011 12614000
*   DO WHILE RNUMREC>RDCCWCNT&TESTRC^=RCSRUNCO&TESTRC^=RCSRUEX;    2011 12615000
*                                                                  2011 12616000
         B     @DE02011                                            2011 12617000
@DL02011 DS    0H                                                  2012 12618000
*     /***************************************************************/ 12619000
*     /*                                                             */ 12620000
*     /* CALL READKD TO READ IN AS MUCH AS POSSIBLE                  */ 12621000
*     /*                                                             */ 12622000
*     /***************************************************************/ 12623000
*                                                                  2012 12624000
*     CALL IDCIO050(GDTTBL,READKD,RDARG);                          2012 12625000
         L     @15,@PC00001                                        2012 12626000
         ST    @15,@AL00001                                        2012 12627000
         LA    @14,READKD                                          2012 12628000
         ST    @14,@AL00001+4                                      2012 12629000
         L     @14,@PC00004                                        2012 12630000
         ST    @14,@AL00001+8                                      2012 12631000
         MVI   @AL00001+8,X'80'                                    2012 12632000
         L     @15,GDTEXP(,@15)                                    2012 12633000
         LA    @01,@AL00001                                        2012 12634000
         BALR  @14,@15                                             2012 12635000
*     RESPECIFY                                                    2013 12636000
*       RTNREG RSTD;                                               2013 12637000
*     TESTRC=RTNREG;                                               2014 12638000
         STH   RTNREG,TESTRC                                       2014 12639000
*     RESPECIFY                                                    2015 12640000
*       RTNREG UNRSTD;                                             2015 12641000
*                                                                  2015 12642000
*     /***************************************************************/ 12643000
*     /*                                                             */ 12644000
*     /* END OF DO WHILE LOOP TO READ COUNT/KEY/DATA FIELDS          */ 12645000
*     /*                                                             */ 12646000
*     /***************************************************************/ 12647000
*                                                                  2016 12648000
*   END;                                                           2016 12649000
@DE02011 L     @15,@PC00004                                        2016 12650000
         L     @01,RDIOAREA(,@15)                                  2016 12651000
         LH    @14,RNUMREC(,@01)                                   2016 12652000
         CH    @14,RDCCWCNT(,@15)                                  2016 12653000
         BNH   @DC02011                                            2016 12654000
         LH    @15,TESTRC                                          2016 12655000
         CH    @15,RCSRUNCO                                        2016 12656000
         BE    @DC02011                                            2016 12657000
         CH    @15,RCSRUEX                                         2016 12658000
         BNE   @DL02011                                            2016 12659000
@DC02011 DS    0H                                                  2017 12660000
*   RETURN CODE(TESTRC);                                           2017 12661000
         LH    @15,TESTRC                                          2017 12662000
         L     @14,@SA00005                                        2017 12663000
         LM    @00,@12,@SA00005+8                                  2017 12664000
         BR    @14                                                 2017 12665000
*   END SRDRCRD;                                                   2018 12666000
*   END IDCRDRD;                                                   2019 12667000
*IDCRD7X:                                                          2020 12668000
*   PROCEDURE;                                                     2020 12669000
*                                                                  2020 12670000
IDCRD7X  STM   @14,@12,@SA00006                                    2020 12671000
*/********************************************************************/ 12672000
*/*                                                                  */ 12673000
*/* PROCEDURE NAME - IDCRD7X                                         */ 12674000
*/*                                                                  */ 12675000
*/* FUNCTION - THIS PROCEDURE FREES AUTOMATIC STORAGE OBTAINED WHEN  */ 12676000
*/*            THIS MODULE WAS INITIALLY ENTERED IN PROCEDURE        */ 12677000
*/*            IDCRD07 AND RESTORES THE CODE REGS.                   */ 12678000
*/*                                                                  */ 12679000
*/* ENTRY POINT -IDCRD7X (ONLY ENTRY POINT FOR THIS PROCEDURE)       */ 12680000
*/*                                                                  */ 12681000
*/*            LINKAGE - 'CALL IDCRD7X;'                             */ 12682000
*/*                                                                  */ 12683000
*/*            INPUT -                                               */ 12684000
*/*                                                                  */ 12685000
*/*              NONE                                                */ 12686000
*/*                                                                  */ 12687000
*/*            OUTPUT -                                              */ 12688000
*/*                                                                  */ 12689000
*/*              NONE                                                */ 12690000
*/*                                                                  */ 12691000
*/*            EXIT, NORMAL -                                        */ 12692000
*/*                                                                  */ 12693000
*/*              LASTCC = CURRENT VALUE                              */ 12694000
*/*                                                                  */ 12695000
*/*            EXIT, ERROR -                                         */ 12696000
*/*                                                                  */ 12697000
*/*              NONE                                                */ 12698000
*/*                                                                  */ 12699000
*/* INTERNAL INTERFACES -                                            */ 12700000
*/*                                                                  */ 12701000
*/*      NONE                                                        */ 12702000
*/*                                                                  */ 12703000
*/* EXTERNAL INTERFACES -                                            */ 12704000
*/*                                                                  */ 12705000
*/*      MACROS/SVCS -                                               */ 12706000
*/*                                                                  */ 12707000
*/*            ?UEPIL - IDCAMS SYSTEM ADAPTER EPILOG ROUTINE         */ 12708000
*/*              FACILITATES SYSTEM INDEPENDENT EPILOG ACTIVITY      */ 12709000
*/*              GENERATES A CALL TO MODULE IDCSAEP                  */ 12710000
*/*                                                                  */ 12711000
*/*            UTRACE - IDCAMS TRACE POINT ROUTINE                   */ 12712000
*/*              SETS TRACE POINT                                    */ 12713000
*/*                                                                  */ 12714000
*/*      PROCEDURES/SUBROUTINES CALLED -                             */ 12715000
*/*                                                                  */ 12716000
*/*            NONE                                                  */ 12717000
*/*                                                                  */ 12718000
*/*      DATA AREAS -                                                */ 12719000
*/*                                                                  */ 12720000
*/*            NONE                                                  */ 12721000
*/*                                                                  */ 12722000
*/********************************************************************/ 12723000
*                                                                  2021 12724000
*                                                                  2021 12725000
*   /*****************************************************************/ 12726000
*   /*                                                               */ 12727000
*   /* ENTRY POINT FOR IDCRD7X                                       */ 12728000
*   /*                                                               */ 12729000
*   /*****************************************************************/ 12730000
*                                                                  2021 12731000
*   GEN(ENTRY IDCRD7X);                                            2021 12732000
         ENTRY IDCRD7X                                                  12733000
*   GEN(STM 14,12,12(13));          /*                       @ZA27486*/ 12734000
         STM 14,12,12(13)                                               12735000
*   GEN(L REG6,SPLITSV1);                                          2023 12736000
         L REG6,SPLITSV1                                                12737000
*   LM(REG9,REG12,SPLITSAV);                                       2024 12738000
*                                                                  2024 12739000
         LM    REG9,REG12,SPLITSAV                                 2024 12740000
*   /*****************************************************************/ 12741000
*   /*                                                               */ 12742000
*   /* SET TRACE POINT                                               */ 12743000
*   /*                                                               */ 12744000
*   /*****************************************************************/ 12745000
*                                                                  2025 12746000
*   OLDERID2=NEWERID2;                                             2025 12747000
         L     @03,@PC00001                                        2025 12748000
         L     @15,GDTTR2(,@03)                                    2025 12749000
         MVC   @TS00001(95),NEWERID2(@15)                          2025 12750000
         MVC   OLDERID2(95,@15),@TS00001                           2025 12751000
*   NEWID2='RD73';                                                 2026 12752000
*                                                                  2026 12753000
         MVC   NEWID2(4,@15),@CC03008                              2026 12754000
*   /*****************************************************************/ 12755000
*   /*                                                               */ 12756000
*   /* ISSUE UEPIL TO FREE STORAGE AND RETURN TO IDCRD01 ESTABLISHING*/ 12757000
*   /* LINKAGE TO THE RD06 SAVE AREA.                        @ZA27486*/ 12758000
*   /*                                                               */ 12759000
*   /*****************************************************************/ 12760000
*                                                                  2027 12761000
*   RESPECIFY                                                      2027 12762000
*    (REG7,                                                        2027 12763000
*     REG13) RESTRICTED;            /*                       @ZA27486*/ 12764000
*   FORCHAIN=REG7;                  /*                       @ZA27486*/ 12765000
         ST    REG7,FORCHAIN(,REG13)                               2028 12766000
*   SAVER13=REG13;                  /*                       @ZA27486*/ 12767000
         LR    SAVER13,REG13                                       2029 12768000
*   REG13=REG7;                     /*                       @ZA27486*/ 12769000
         LR    REG13,REG7                                          2030 12770000
*   BACKCHAN=SAVER13;               /*                       @ZA27486*/ 12771000
         ST    SAVER13,BACKCHAN(,REG13)                            2031 12772000
*   FORCHAIN=NULLPTR;               /*                       @ZA27486*/ 12773000
         SLR   @02,@02                                             2032 12774000
         ST    @02,FORCHAIN(,REG13)                                2032 12775000
*   RESPECIFY                                                      2033 12776000
*    (REG7,                                                        2033 12777000
*     REG13) UNRESTRICTED;          /*                       @ZA27486*/ 12778000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                            2034 12779000
         ST    @03,@AL00001                                        2034 12780000
         LA    @02,MODID                                           2034 12781000
         ST    @02,@AL00001+4                                      2034 12782000
         LA    @02,LASTCC                                          2034 12783000
         ST    @02,@AL00001+8                                      2034 12784000
         MVI   @AL00001+8,X'80'                                    2034 12785000
         L     @15,GDTEPL(,@03)                                    2034 12786000
         LA    @01,@AL00001                                        2034 12787000
         BALR  @14,@15                                             2034 12788000
*   END IDCRD7X;                                                   2035 12789000
@EL00006 DS    0H                                                  2035 12790000
@EF00006 DS    0H                                                  2035 12791000
@ER00006 LM    @14,@12,@SA00006                                    2035 12792000
         BR    @14                                                 2035 12793000
         EJECT                                                          12794000
*   END IDCRD07                                                    2036 12795000
*                                                                  2036 12796000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 12797000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 12798000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 12799000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 12800000
*/*%INCLUDE SYSLIB  (IDCCSRD )                                       */ 12801000
*/*%INCLUDE SYSLIB  (IDCDF65 )                                       */ 12802000
*/*%INCLUDE SYSLIB  (IDCDF66 )                                       */ 12803000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 12804000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 12805000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 12806000
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                       */ 12807000
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */ 12808000
*/*%INCLUDE SYSLIB  (IDAAMBL )                                       */ 12809000
*/*%INCLUDE SYSLIB  (IDAAMB  )                                       */ 12810000
*/*%INCLUDE SYSLIB  (IEZDEB  )                                       */ 12811000
*/*%INCLUDE SYSLIB  (IECSDSL1)                                       */ 12812000
*                                                                  2036 12813000
*       ;                                                          2036 12814000
@DATA    DS    0H                                                       12815000
@CH00164 DC    H'3'                                                     12816000
@CH00288 DC    H'5'                                                     12817000
@CH00035 DC    H'6'                                                     12818000
@CH00040 DC    H'7'                                                     12819000
@CH00181 DC    H'8'                                                     12820000
@CH00036 DC    H'9'                                                     12821000
@CH00037 DC    H'10'                                                    12822000
@CH00038 DC    H'11'                                                    12823000
@CH00647 DC    H'20'                                                    12824000
@CH00651 DC    H'21'                                                    12825000
@CH00666 DC    H'23'                                                    12826000
@CH02800 DC    H'33'                                                    12827000
@CH02802 DC    H'34'                                                    12828000
@CH00709 DC    H'35'                                                    12829000
@CH00730 DC    H'39'                                                    12830000
@CH00732 DC    H'40'                                                    12831000
@CH00770 DC    H'46'                                                    12832000
@CH00797 DC    H'52'                                                    12833000
@CH00818 DC    H'72'                                                    12834000
@CH02809 DC    H'78'                                                    12835000
@CH00866 DC    H'93'                                                    12836000
         DS    0F                                                       12837000
@AL01377 EQU   *                       LIST WITH   2 ARGUMENT(S)        12838000
@AL01389 EQU   *                       LIST WITH   2 ARGUMENT(S)        12839000
@AL01437 EQU   *                       LIST WITH   2 ARGUMENT(S)        12840000
@AL01466 EQU   *                       LIST WITH   2 ARGUMENT(S)        12841000
@AL01495 EQU   *                       LIST WITH   2 ARGUMENT(S)        12842000
@AL01530 EQU   *                       LIST WITH   2 ARGUMENT(S)        12843000
@AL01595 EQU   *                       LIST WITH   2 ARGUMENT(S)        12844000
@AL01616 EQU   *                       LIST WITH   2 ARGUMENT(S)        12845000
@AL01699 EQU   *                       LIST WITH   2 ARGUMENT(S)        12846000
@AL01734 DC    A(@CC02759)             LIST WITH   2 ARGUMENT(S)        12847000
         DC    AL1(X'80')                                               12848000
         DC    AL3(ALL)                                                 12849000
@DATD    DSECT                                                          12850000
         DS    0F                                                       12851000
@SA00001 DS    18F                                                      12852000
@PC00001 DS    3F                                                       12853000
@SA00002 DS    15F                                                      12854000
@PC00002 DS    2F                                                       12855000
@SA00003 DS    15F                                                      12856000
@SA00004 DS    15F                                                      12857000
@PC00004 DS    1F                                                       12858000
@SA00005 DS    15F                                                      12859000
@SA00006 DS    15F                                                      12860000
@AL00001 DS    6A                                                       12861000
@TF00001 DS    F                                                        12862000
@TF00002 DS    F                                                        12863000
IDCRD07  CSECT                                                          12864000
         DS    0F                                                       12865000
@CF00118 DC    F'0'                                                     12866000
@CF00221 DC    F'1'                                                     12867000
@CH00221 EQU   @CF00221+2                                               12868000
@CF00156 DC    F'2'                                                     12869000
@CH00156 EQU   @CF00156+2                                               12870000
@CF00045 DC    F'4'                                                     12871000
@CH00045 EQU   @CF00045+2                                               12872000
@CF00039 DC    F'12'                                                    12873000
@CH00039 EQU   @CF00039+2                                               12874000
@CF00223 DC    F'32'                                                    12875000
@CF00600 DC    F'44'                                                    12876000
@CF00886 DC    F'96'                                                    12877000
@CF03051 DC    F'-52'                                                   12878000
@CF03054 DC    F'-20'                                                   12879000
@CF03052 DC    F'-16'                                                   12880000
@CF03053 DC    F'-14'                                                   12881000
@CF03047 DC    F'-8'                                                    12882000
@CF03048 DC    F'-6'                                                    12883000
@CF03049 DC    F'-4'                                                    12884000
@CF03050 DC    F'-2'                                                    12885000
@CF03043 DC    XL4'0000FFFF'                                            12886000
@DATD    DSECT                                                          12887000
         DS    0D                                                       12888000
LISTSCAN DS    A                                                        12889000
IOCSPTR  DS    A                                                        12890000
DDSTRU   DS    A                                                        12891000
FSADDR   DS    A                                                        12892000
ERCNVADR DS    A                                                        12893000
DMPINDEX DS    A                                                        12894000
DCBPTR   DS    A                                                        12895000
DEBPTR   DS    A                                                        12896000
DEBEXPTR DS    A                                                        12897000
DEBSBPTR DS    A                                                        12898000
CCMSGPTR DS    A                                                        12899000
CMMSGPTR DS    A                                                        12900000
CTMSGPTR DS    A                                                        12901000
ELEMENT  DS    F                                                        12902000
F3PTR    DS    A                                                        12903000
REQBYTES DS    F                                                        12904000
REQADDR  DS    A                                                        12905000
DEVAREAP DS    A                                                        12906000
INFOPTR  DS    A                                                        12907000
SINFPTR  DS    A                                                        12908000
INFVOLPT DS    A                                                        12909000
DEVDD    DS    A                                                        12910000
LISTPTR  DS    A                                                        12911000
TESTRC   DS    H                                                        12912000
LASTCC   DS    H                                                        12913000
SETRC    DS    H                                                        12914000
LISTLN   DS    FL1                                                      12915000
@TS00001 DS    CL95                                                     12916000
         DS    CL2                                                      12917000
SPLITSAV DS    CL16                                                     12918000
WTORECB  DS    CL4                                                      12919000
WTOREPLY DS    CL1                                                      12920000
INFOBYT  DS    CL1                                                      12921000
XTNTHOLD DS    CL78                                                     12922000
INFODD   DS    CL8                                                      12923000
WTORLIST DS    CL84                                                     12924000
CAM1     DS    CL16                                                     12925000
         ORG   CAM1                                                     12926000
@NM00196 DS    CL4                                                      12927000
CAMDSN   DS    FL4                                                      12928000
CAMVOL   DS    FL4                                                      12929000
CAMWA    DS    FL4                                                      12930000
         ORG   CAM1+16                                                  12931000
         DS    CL4                                                      12932000
OBTAINWA DS    CL148                                                    12933000
DARGL    DS    CL20                                                     12934000
PARMHOLD DS    CL17                                                     12935000
         DS    CL1                                                      12936000
VTOCADDR DS    CL5                                                      12937000
         ORG   VTOCADDR                                                 12938000
VTOCCC   DS    FL2                                                      12939000
VTOCHH   DS    FL2                                                      12940000
VTOCR    DS    FL1                                                      12941000
         ORG   VTOCADDR+5                                               12942000
FMT1ADDR DS    CL5                                                      12943000
SPLITSV1 DS    CL4                                                      12944000
IDCRD07  CSECT                                                          12945000
         DS    0F                                                       12946000
@SIZDATD DC    AL1(0)                                                   12947000
         DC    AL3(@ENDDATD-@DATD)                                      12948000
@CV01553 DC    V(IDCRDER)                                               12949000
         DS    0D                                                       12950000
RCSRGG   DC    H'1'                                                     12951000
RCSRGBSP DC    H'2'                                                     12952000
RCSRGDS  DC    H'3'                                                     12953000
RCSRGGOF DC    H'4'                                                     12954000
RCSRGSTG DC    H'5'                                                     12955000
RCSRBG   DC    H'7'                                                     12956000
RCSRDSDS DC    H'8'                                                     12957000
RCSRSTDS DC    H'9'                                                     12958000
RCSRSTST DC    H'10'                                                    12959000
RCSRGBDT DC    H'16'                                                    12960000
RCSRBCNT DC    H'18'                                                    12961000
RCSRBB   DC    H'19'                                                    12962000
RCSRDSB  DC    H'20'                                                    12963000
RCSRSTB  DC    H'21'                                                    12964000
RCSRUNCO DC    H'22'                                                    12965000
RCSREOF  DC    H'29'                                                    12966000
RCSREOTR DC    H'30'                                                    12967000
RCSRUEX  DC    H'31'                                                    12968000
RCSRSYNC DC    H'32'                                                    12969000
RCSRNRF  DC    H'33'                                                    12970000
RCABDS   DC    H'8'                                                     12971000
RCABST   DC    H'12'                                                    12972000
RCABOV   DC    H'16'                                                    12973000
RCABNRF  DC    H'20'                                                    12974000
RCABSYNC DC    H'24'                                                    12975000
RCABDTCK DC    H'28'                                                    12976000
RCABEOFR DC    H'32'                                                    12977000
LOCENT   DC    AL2(125)                                                 12978000
FSTIME   DC    XL1'FF'                                                  12979000
DSIND    DC    XL1'00'                                                  12980000
@CC02833 DC    C'DATASETRANGE     '                                     12981000
@CC02836 DC    C'INDATASETADDRESS '                                     12982000
@CC02839 DC    C'OUTDATASETADDRESS'                                     12983000
@CC02842 DC    C'VTOCHEADERADDRESS'                                     12984000
@CC02024 DC    C'OPENR   '                                              12985000
@CC02747 DC    C'SYSVTOC '                                              12986000
@CC02831 DC    C'OBTAIN  '                                              12987000
@CC01568 DC    C'RD71'                                                  12988000
@CC01569 DC    C'RD72'                                                  12989000
@CC02759 DC    C'RD01'                                                  12990000
@CC02856 DC    C'RD6H'                                                  12991000
@CC02857 DC    C'RD6I'                                                  12992000
@CC02879 DC    C'RD6J'                                                  12993000
@CC02909 DC    C'RD6L'                                                  12994000
@CC02914 DC    C'RD6P'                                                  12995000
@CC02924 DC    C'RD6M'                                                  12996000
@CC02931 DC    C'RD6N'                                                  12997000
@CC02935 DC    C'RD6Q'                                                  12998000
@CC02992 DC    C'RDDD'                                                  12999000
@CC02993 DC    C'RDD1'                                                  13000000
@CC02995 DC    C'RDDR'                                                  13001000
@CC03002 DC    C'RDD2'                                                  13002000
@CC03003 DC    C'RDD3'                                                  13003000
@CC03008 DC    C'RD73'                                                  13004000
@CC02814 EQU   @CC02759                                                 13005000
ALL      DC    CL3'ALL'                                                 13006000
FORMAT   DC    CL4'FORM'                                                13007000
HSECOND  DC    CL4'HSEC'                                                13008000
CLOCK    DC    CL4'KLOK'                                                13009000
SETZERO  DC    CL4'ZERO'                                                13010000
SETBLANK DC    CL4'BLNK'                                                13011000
NOSET    DC    CL4'NSET'                                                13012000
OVERRIDE DC    CL4'OVRD'                                                13013000
ACQUIRE  DC    CL8'ACQUIRE '                                            13014000
RELINQ   DC    CL8'RELINQ  '                                            13015000
MOUNT    DC    CL8'MOUNT   '                                            13016000
DEMOUNT  DC    CL8'DEMOUNT '                                            13017000
DEFINE   DC    CL8'DEFINE  '                                            13018000
MOVE     DC    CL8'MOVE    '                                            13019000
TRACEQ   DC    CL8'TRACEQ  '                                            13020000
COPYTABL DC    CL8'COPYTABL'                                            13021000
COPYCRTG DC    CL8'COPYCRTG'                                            13022000
COPYVOL  DC    CL8'COPYVOL '                                            13023000
VVIC     DC    CL8'VVIC    '                                            13024000
TUNE     DC    CL8'TUNE    '                                            13025000
NAMES    DC    CL4'NAME'                                                13026000
UNIT     DC    CL4'UNIT'                                                13027000
SHR      DC    CL4'SHR '                                                13028000
EXCL     DC    CL4'EXCL'                                                13029000
NOWAIT   DC    CL4'NWAI'                                                13030000
WAIT     DC    CL4'WAIT'                                                13031000
MODID    DC    CL4'RD07'                                                13032000
FIXAREA  DS    CL1024                                                   13033000
         ORG   FIXAREA                                                  13034000
@NM00089 DS    CL256                                                    13035000
         ORG   @NM00089                                                 13036000
@NM00090 DC    256X'00'                                                 13037000
         ORG   FIXAREA+256                                              13038000
@NM00091 DS    CL256                                                    13039000
         ORG   @NM00091                                                 13040000
@NM00092 DC    256X'00'                                                 13041000
         ORG   FIXAREA+512                                              13042000
@NM00093 DS    CL256                                                    13043000
         ORG   @NM00093                                                 13044000
@NM00094 DC    256X'00'                                                 13045000
         ORG   FIXAREA+768                                              13046000
@NM00095 DS    CL256                                                    13047000
         ORG   @NM00095                                                 13048000
@NM00096 DC    256X'00'                                                 13049000
         ORG   FIXAREA+1024                                             13050000
SECCHECK DC    CL8'SECCHECK'                                            13051000
SCRVTOC  DC    CL8'SCRVTOC '                                            13052000
GETVTOC  DC    CL8'GETVTOC '                                            13053000
PUTVTOC  DC    CL8'PUTVTOC '                                            13054000
RECATLG  DC    CL8'RECATLG '                                            13055000
INITVOL  DC    CL8'INITVOL '                                            13056000
CHECK    DC    CL8'CHECK   '                                            13057000
POSTUCB  DC    CL8'POSTUCB '                                            13058000
GET      DC    CL8'GET     '                                            13059000
PUT      DC    CL8'PUT     '                                            13060000
CLOSE    DC    CL8'CLOSE   '                                            13061000
OPEN     DC    CL8'OPEN    '                                            13062000
RVOPENR  DC    CL8'OPENR   '                                            13063000
RVRDCNT  DC    CL8'READCNT '                                            13064000
RVREADKD DC    CL8'READKD  '                                            13065000
RVSPACCR DC    CL8'SPACCR  '                                            13066000
RVFWRITE DC    CL8'FWRITE  '                                            13067000
RVWRITER DC    CL8'WRITEREC'                                            13068000
PUTLABEL DC    CL8'PUTLABEL'                                            13069000
GETLABEL DC    CL8'GETLABEL'                                            13070000
CANCEL   DC    CL8'CANCEL  '                                            13071000
SET      DC    CL8'SET     '                                            13072000
SELECTX  DC    CL8'SELECTX '                                            13073000
CHANGEX  DC    CL8'CHANGEX '                                            13074000
SELECTDD DC    CL8'SELECTDD'                                            13075000
SELECTDS DC    CL8'SELECTDS'                                            13076000
TBLREST  DC    CL8'TBLREST '                                            13077000
NULLIFYC DC    CL8'NULLIFYC'                                            13078000
RDMSC    DC    CL8'RDMSC   '                                            13079000
RDMSCTBL DC    CL8'RDMSCTBL'                                            13080000
RDCARTLB DC    CL8'RDCARTLB'                                            13081000
AUDITCEL DC    CL8'AUDITCEL'                                            13082000
RDSTGAD  DC    CL8'RDSTGAD '                                            13083000
VHDRDSN  DC    CL44'VTOCHEADER'                                         13084000
FMT4DSCB DC    CL44'FORMAT4.DSCB'                                       13085000
ZEROS    DS    CL8                                                      13086000
         ORG   ZEROS                                                    13087000
@NM00197 DC    8X'00'                                                   13088000
         ORG   ZEROS+8                                                  13089000
LASTENT  DS    CL78                                                     13090000
         ORG   LASTENT                                                  13091000
@NM00198 DC    78X'FF'                                                  13092000
         ORG   LASTENT+78                                               13093000
FMT4DSN  DS    CL44                                                     13094000
         ORG   FMT4DSN                                                  13095000
@NM00199 DC    44X'04'                                                  13096000
         ORG   FMT4DSN+44                                               13097000
BLANKS   DS    CL44                                                     13098000
         ORG   BLANKS                                                   13099000
@NM00200 DC    44X'40'                                                  13100000
         ORG   BLANKS+44                                                13101000
NTFNDPTR DC    X'FFFFFFFF'                                              13102000
READCNT  DC    CL8'READCNT '                                            13103000
READKD   DC    CL8'READKD  '                                            13104000
SPACCR   DC    CL8'SPACCR  '                                            13105000
@DATD    DSECT                                                          13106000
IDCRD07  CSECT                                                          13107000
LWTORLST WTOR  '1234567890123456789012345678901234567890123456789012345X13108000
               67890123456789012',MF=L                                  13109000
CAMLIST  CAMLST SEARCH,XTNHDSN,XTNHVOL,XTNHVOL                          13110000
@DATD    DSECT                                                          13111000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                13112000
@ENDDATD EQU   *                                                        13113000
IDCRD07  CSECT                                                          13114000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       13115000
@01      EQU   01                                                       13116000
@02      EQU   02                                                       13117000
@03      EQU   03                                                       13118000
@04      EQU   04                                                       13119000
@05      EQU   05                                                       13120000
@06      EQU   06                                                       13121000
@07      EQU   07                                                       13122000
@08      EQU   08                                                       13123000
@09      EQU   09                                                       13124000
@10      EQU   10                                                       13125000
@11      EQU   11                                                       13126000
@12      EQU   12                                                       13127000
@13      EQU   13                                                       13128000
@14      EQU   14                                                       13129000
@15      EQU   15                                                       13130000
SAVCCWCT EQU   @05                                                      13131000
SPACCRCT EQU   @03                                                      13132000
RDCTR    EQU   @02                                                      13133000
LENINDEX EQU   @04                                                      13134000
INFDSNPT EQU   @03                                                      13135000
INFSCNPT EQU   @02                                                      13136000
XTNTPTR2 EQU   @04                                                      13137000
XTNTPTR  EQU   @05                                                      13138000
F4PTR    EQU   @02                                                      13139000
F1PTR    EQU   @02                                                      13140000
SAVER13  EQU   @02                                                      13141000
DEBDAPTR EQU   @02                                                      13142000
OPNPTR   EQU   @02                                                      13143000
RTNREG   EQU   @15                                                      13144000
REG3     EQU   @03                                                      13145000
REG4     EQU   @04                                                      13146000
REG7     EQU   @07                                                      13147000
REG8     EQU   @08                                                      13148000
REG9     EQU   @09                                                      13149000
REG12    EQU   @12                                                      13150000
REG13    EQU   @13                                                      13151000
REG0     EQU   @00                                                      13152000
REG1     EQU   @01                                                      13153000
REG10    EQU   @10                                                      13154000
REG11    EQU   @11                                                      13155000
REG14    EQU   @14                                                      13156000
REG15    EQU   @15                                                      13157000
REG2     EQU   @02                                                      13158000
REG5     EQU   @05                                                      13159000
REG6     EQU   @06                                                      13160000
IDCSAEP0 EQU   0                                                        13161000
IDCSAGP0 EQU   0                                                        13162000
IDCSAFP0 EQU   0                                                        13163000
IDCSAAL0 EQU   0                                                        13164000
IDCSARV0 EQU   0                                                        13165000
IDCSADQ0 EQU   0                                                        13166000
IDCSASI0 EQU   0                                                        13167000
TRACE1   EQU   0                                                        13168000
OLDERID1 EQU   TRACE1                                                   13169000
TRACE2   EQU   0                                                        13170000
OLDERID2 EQU   TRACE2                                                   13171000
NEWID2   EQU   TRACE2+95                                                13172000
NEWERID2 EQU   5                                                        13173000
CIRAGL   EQU   0                                                        13174000
CIRTYPE  EQU   CIRAGL                                                   13175000
ALLAGL   EQU   0                                                        13176000
ALLDSN   EQU   ALLAGL                                                   13177000
ALLDDN   EQU   ALLAGL+4                                                 13178000
ALLPWD   EQU   ALLAGL+20                                                13179000
ALLSTS   EQU   ALLAGL+24                                                13180000
ALLSTSOD EQU   ALLSTS                                                   13181000
ALLDSP   EQU   ALLAGL+25                                                13182000
ALLDSPKP EQU   ALLDSP                                                   13183000
ALLORG   EQU   ALLAGL+26                                                13184000
ALLOPT   EQU   ALLAGL+28                                                13185000
ALLOPTVL EQU   ALLOPT                                                   13186000
ALLOPTDS EQU   ALLOPT                                                   13187000
UNITABL  EQU   0                                                        13188000
UNITADR  EQU   UNITABL+4                                                13189000
@NM00010 EQU   UNITADR                                                  13190000
UNITSTAT EQU   UNITABL+6                                                13191000
IDCIOOP0 EQU   0                                                        13192000
IDCIOCL0 EQU   0                                                        13193000
IDCIOGT0 EQU   0                                                        13194000
IDCIOSI0 EQU   0                                                        13195000
IDCIO050 EQU   0                                                        13196000
IOCSTR   EQU   0                                                        13197000
IOCDAD   EQU   IOCSTR                                                   13198000
IOCDSO   EQU   IOCSTR+16                                                13199000
IOCRFM   EQU   IOCSTR+17                                                13200000
IOCMAC   EQU   IOCSTR+18                                                13201000
IOCMAC2  EQU   IOCSTR+19                                                13202000
IOCCHP   EQU   IOCSTR+20                                                13203000
IOCMSG   EQU   IOCSTR+21                                                13204000
IOCMSGOP EQU   IOCMSG                                                   13205000
IOCCBP   EQU   IOCSTR+36                                                13206000
IOCRBA   EQU   IOCSTR+40                                                13207000
IOCTTR   EQU   IOCRBA                                                   13208000
IOCMEM   EQU   IOCSTR+44                                                13209000
IOCNWM   EQU   IOCSTR+48                                                13210000
OPNAGL   EQU   0                                                        13211000
OPNOPT   EQU   OPNAGL                                                   13212000
OPNOPTIN EQU   OPNOPT                                                   13213000
OPNOPTBK EQU   OPNOPT                                                   13214000
OPNRFM   EQU   OPNAGL+1                                                 13215000
OPNTYP   EQU   OPNAGL+2                                                 13216000
OPNMOD   EQU   OPNAGL+3                                                 13217000
OPNMODRC EQU   OPNMOD                                                   13218000
OPNIOC   EQU   OPNAGL+4                                                 13219000
OPNDDN   EQU   OPNAGL+8                                                 13220000
OPNPWA   EQU   OPNAGL+12                                                13221000
OPNDSN   EQU   OPNAGL+16                                                13222000
OPNDEV   EQU   OPNAGL+24                                                13223000
OPNBLK   EQU   OPNAGL+36                                                13224000
OPNKYL   EQU   OPNAGL+40                                                13225000
OPNDSO   EQU   OPNAGL+41                                                13226000
OPNDSOAM EQU   OPNDSO                                                   13227000
OPNDSOPS EQU   OPNDSO                                                   13228000
OPNOPT2  EQU   OPNAGL+42                                                13229000
OPNOPTJM EQU   OPNOPT2                                                  13230000
OPNVOL   EQU   OPNAGL+44                                                13231000
IOINFOPT EQU   0                                                        13232000
IOINFVOL EQU   IOINFOPT                                                 13233000
IOINFDSN EQU   IOINFOPT                                                 13234000
UVOLLIST EQU   0                                                        13235000
UVOLENT  EQU   UVOLLIST+2                                               13236000
AMSTP011 EQU   0                                                        13237000
DARGLIST EQU   0                                                        13238000
DARGRETP EQU   DARGLIST+4                                               13239000
DARGSTID EQU   DARGLIST+8                                               13240000
DARGSMOD EQU   DARGSTID                                                 13241000
DARGSENT EQU   DARGSTID+3                                               13242000
DARGRETL EQU   DARGLIST+16                                              13243000
DARGARY  EQU   DARGLIST+20                                              13244000
DARGINS  EQU   DARGARY                                                  13245000
DARGINL  EQU   DARGARY+2                                                13246000
FMTLIST  EQU   0                                                        13247000
FMTFLGS  EQU   FMTLIST                                                  13248000
FMTSPF   EQU   FMTLIST+2                                                13249000
FMTRFNO  EQU   FMTSPF                                                   13250000
FMTILEN  EQU   FMTRFNO                                                  13251000
FMTIOFF  EQU   FMTLIST+4                                                13252000
FMTTRBC  EQU   FMTIOFF                                                  13253000
FMTSTO   EQU   FMTTRBC                                                  13254000
FMTOCOL  EQU   FMTLIST+6                                                13255000
FMTCNVF  EQU   FMTLIST+10                                               13256000
ERCNVTAB EQU   0                                                        13257000
ERTYPE   EQU   ERCNVTAB                                                 13258000
EROPER   EQU   ERCNVTAB+1                                               13259000
EROSOPER EQU   ERCNVTAB+2                                               13260000
IDCDB010 EQU   0                                                        13261000
DMPITM   EQU   0                                                        13262000
DMPARY   EQU   0                                                        13263000
DISPL    EQU   0                                                        13264000
INFIL    EQU   0                                                        13265000
INFILPAS EQU   INFIL+1                                                  13266000
INFILVAL EQU   INFIL+10                                                 13267000
INDS     EQU   0                                                        13268000
INDSPAS  EQU   INDS+1                                                   13269000
INDSFLG  EQU   INDS+10                                                  13270000
INDSVAL  EQU   INDS+21                                                  13271000
DSRNG    EQU   0                                                        13272000
STAGR    EQU   0                                                        13273000
DOUTF    EQU   0                                                        13274000
DOTDS    EQU   0                                                        13275000
DOTDSFLG EQU   DOTDS+10                                                 13276000
VOLSR    EQU   0                                                        13277000
VOLSRFLG EQU   VOLSR+10                                                 13278000
VOLSRVAL EQU   VOLSR+21                                                 13279000
DCCHR    EQU   0                                                        13280000
DCCHRLEN EQU   DCCHR                                                    13281000
DCCHRVAL EQU   DCCHR+1                                                  13282000
DREC     EQU   0                                                        13283000
DRECLEN  EQU   DREC                                                     13284000
DRECVAL  EQU   DREC+1                                                   13285000
VOLDS    EQU   0                                                        13286000
VOLDSFLG EQU   VOLDS+10                                                 13287000
VOLDSVAL EQU   VOLDS+21                                                 13288000
DSCHR    EQU   0                                                        13289000
DSCHRLEN EQU   DSCHR                                                    13290000
DSCHRVAL EQU   DSCHR+1                                                  13291000
DSCHH    EQU   0                                                        13292000
DSCHHLEN EQU   DSCHH                                                    13293000
DSCHHVAL EQU   DSCHH+1                                                  13294000
VOLRR    EQU   0                                                        13295000
VOLRRFLG EQU   VOLRR+10                                                 13296000
RRCHR    EQU   0                                                        13297000
RRCHH    EQU   0                                                        13298000
DKEYL    EQU   0                                                        13299000
DATAL    EQU   0                                                        13300000
DPVTC    EQU   0                                                        13301000
DVTCS    EQU   0                                                        13302000
DVTCSFLG EQU   DVTCS+10                                                 13303000
DVTCSVAL EQU   DVTCS+21                                                 13304000
COPY     EQU   0                                                        13305000
CINFL    EQU   0                                                        13306000
CINFLPAS EQU   CINFL+1                                                  13307000
CINFLVAL EQU   CINFL+10                                                 13308000
CINDS    EQU   0                                                        13309000
CINDSPAS EQU   CINDS+1                                                  13310000
CINDSFLG EQU   CINDS+10                                                 13311000
CINDSVAL EQU   CINDS+21                                                 13312000
CSRNG    EQU   0                                                        13313000
CDSRG    EQU   0                                                        13314000
COFIL    EQU   0                                                        13315000
CCATL    EQU   0                                                        13316000
CCATLFLG EQU   CCATL+10                                                 13317000
CVOLD    EQU   0                                                        13318000
CVOLDFLG EQU   CVOLD+10                                                 13319000
CVOLDVAL EQU   CVOLD+21                                                 13320000
CDCHR    EQU   0                                                        13321000
CDCHRLEN EQU   CDCHR                                                    13322000
CDCHRVAL EQU   CDCHR+1                                                  13323000
CDHHR    EQU   0                                                        13324000
CDHHRLEN EQU   CDHHR                                                    13325000
CDHHRVAL EQU   CDHHR+1                                                  13326000
CVOLS    EQU   0                                                        13327000
CVOLSFLG EQU   CVOLS+10                                                 13328000
CVOLSVAL EQU   CVOLS+21                                                 13329000
CCCHR    EQU   0                                                        13330000
CCCHRLEN EQU   CCCHR                                                    13331000
CCCHRVAL EQU   CCCHR+1                                                  13332000
CRECR    EQU   0                                                        13333000
CRECRLEN EQU   CRECR                                                    13334000
CRECRVAL EQU   CRECR+1                                                  13335000
CKEYL    EQU   0                                                        13336000
CDATL    EQU   0                                                        13337000
CVTOC    EQU   0                                                        13338000
CVTCS    EQU   0                                                        13339000
CVTCSFLG EQU   CVTCS+10                                                 13340000
CVTCSVAL EQU   CVTCS+21                                                 13341000
DBFIL    EQU   0                                                        13342000
DBDS     EQU   0                                                        13343000
DBDSFLG  EQU   DBDS+10                                                  13344000
DBVOL    EQU   0                                                        13345000
DBVOLFLG EQU   DBVOL+10                                                 13346000
DBCCH    EQU   0                                                        13347000
DBHHH    EQU   0                                                        13348000
DBKEY    EQU   0                                                        13349000
DBDAT    EQU   0                                                        13350000
MODIF    EQU   0                                                        13351000
MNCNT    EQU   0                                                        13352000
MINFL    EQU   0                                                        13353000
MINFLPAS EQU   MINFL+1                                                  13354000
MINFLVAL EQU   MINFL+10                                                 13355000
MINDS    EQU   0                                                        13356000
MINDSPAS EQU   MINDS+1                                                  13357000
MINDSFLG EQU   MINDS+10                                                 13358000
MINDSVAL EQU   MINDS+21                                                 13359000
MIDSA    EQU   0                                                        13360000
MODSA    EQU   0                                                        13361000
MOUTF    EQU   0                                                        13362000
MOUTFPAS EQU   MOUTF+1                                                  13363000
MOUTFVAL EQU   MOUTF+10                                                 13364000
MODS     EQU   0                                                        13365000
MODSPAS  EQU   MODS+1                                                   13366000
MODSFLG  EQU   MODS+10                                                  13367000
MODSVAL  EQU   MODS+21                                                  13368000
MVTOC    EQU   0                                                        13369000
MVTCS    EQU   0                                                        13370000
MVTCSFLG EQU   MVTCS+10                                                 13371000
MVTCSVAL EQU   MVTCS+21                                                 13372000
MVTCR    EQU   0                                                        13373000
MVTCRLEN EQU   MVTCR                                                    13374000
MVTCRVAL EQU   MVTCR+1                                                  13375000
MIRVO    EQU   0                                                        13376000
MIRVOFLG EQU   MIRVO+10                                                 13377000
MIRCH    EQU   0                                                        13378000
MIDVO    EQU   0                                                        13379000
MIDVOFLG EQU   MIDVO+10                                                 13380000
MIDVOVAL EQU   MIDVO+21                                                 13381000
MIDCH    EQU   0                                                        13382000
MIDCHLEN EQU   MIDCH                                                    13383000
MIDCHVAL EQU   MIDCH+1                                                  13384000
MRRVO    EQU   0                                                        13385000
MRRVOFLG EQU   MRRVO+10                                                 13386000
MRRCH    EQU   0                                                        13387000
MRRHH    EQU   0                                                        13388000
MNDOF    EQU   0                                                        13389000
MNDST    EQU   0                                                        13390000
MNKOF    EQU   0                                                        13391000
MNKST    EQU   0                                                        13392000
MORVO    EQU   0                                                        13393000
MORVOFLG EQU   MORVO+10                                                 13394000
MORCH    EQU   0                                                        13395000
MODVO    EQU   0                                                        13396000
MODVOFLG EQU   MODVO+10                                                 13397000
MODVOVAL EQU   MODVO+21                                                 13398000
MODCH    EQU   0                                                        13399000
MODCHLEN EQU   MODCH                                                    13400000
MODCHVAL EQU   MODCH+1                                                  13401000
RWFHDR   EQU   0                                                        13402000
RWFHDSNU EQU   RWFHDR+55                                                13403000
SRPRTARG EQU   0                                                        13404000
RWFINFO  EQU   0                                                        13405000
RWFKEY1  EQU   RWFINFO+82                                               13406000
RWFKEY2  EQU   RWFINFO+93                                               13407000
RWHDRINF EQU   0                                                        13408000
RWHDRFIX EQU   RWHDRINF                                                 13409000
RWHDRKLN EQU   RWHDRINF+5                                               13410000
RWHDRDLN EQU   RWHDRINF+6                                               13411000
RDARG    EQU   0                                                        13412000
RDIOAREA EQU   RDARG+12                                                 13413000
RDDARE   EQU   RDARG+16                                                 13414000
RDLOCPTR EQU   RDARG+20                                                 13415000
RDCCWCNT EQU   RDARG+24                                                 13416000
RDCHR    EQU   RDARG+26                                                 13417000
RDCC     EQU   RDCHR                                                    13418000
RDHH     EQU   RDCHR+2                                                  13419000
RDRECNUM EQU   RDCHR+4                                                  13420000
RDDS     EQU   RDARG+31                                                 13421000
RDRWPKLN EQU   RDARG+32                                                 13422000
RDSPACE  EQU   RDARG+36                                                 13423000
RDSPKL   EQU   RDARG+47                                                 13424000
RDSPDL   EQU   RDARG+48                                                 13425000
RDLENTOT EQU   RDARG+50                                                 13426000
RDKLEN   EQU   RDARG+52                                                 13427000
RDDLEN   EQU   RDARG+56                                                 13428000
INFOAREA EQU   0                                                        13429000
INFAREAL EQU   INFOAREA                                                 13430000
INFDATAL EQU   INFOAREA+2                                               13431000
INFAREA  EQU   INFOAREA+4                                               13432000
INFODSN  EQU   0                                                        13433000
INFDSNID EQU   INFODSN                                                  13434000
INFDSN   EQU   INFODSN+4                                                13435000
INFOVOL  EQU   0                                                        13436000
INFVOL   EQU   INFOVOL+4                                                13437000
DEVAREA  EQU   0                                                        13438000
DEVDEVTP EQU   DEVAREA                                                  13439000
DEVTBYT2 EQU   DEVDEVTP+1                                               13440000
DEVRVDEV EQU   DEVTBYT2                                                 13441000
@NM00054 EQU   DEVAREA+8                                                13442000
DEVMAXCC EQU   @NM00054                                                 13443000
DEVMAXHH EQU   @NM00054+2                                               13444000
DEVWORD3 EQU   DEVAREA+12                                               13445000
DEVTC    EQU   DEVWORD3                                                 13446000
DEVBOH   EQU   DEVWORD3+2                                               13447000
DEVWORD4 EQU   DEVAREA+16                                               13448000
DEV4B1   EQU   DEVWORD4+1                                               13449000
XTNTTBL2 EQU   0                                                        13450000
XTN2ENT  EQU   XTNTTBL2                                                 13451000
XTN2CHR1 EQU   XTN2ENT+44                                               13452000
XTN2CC1  EQU   XTN2CHR1                                                 13453000
XTN2HH1  EQU   XTN2CHR1+2                                               13454000
XTN2CHR2 EQU   XTN2ENT+48                                               13455000
XTN2CC2  EQU   XTN2CHR2                                                 13456000
XTN2HH2  EQU   XTN2CHR2+2                                               13457000
XTNTTBL  EQU   0                                                        13458000
XTNTHDR  EQU   XTNTTBL                                                  13459000
XTNHDDN  EQU   XTNTHDR                                                  13460000
XTNHDSN  EQU   XTNTHDR+8                                                13461000
XTNHVOLN EQU   XTNTHDR+52                                               13462000
XTNHVOL  EQU   XTNTHDR+53                                               13463000
XTNHPWD  EQU   XTNTHDR+60                                               13464000
XTNHCHR1 EQU   XTNTHDR+68                                               13465000
XTNHCHR2 EQU   XTNTHDR+76                                               13466000
XTNHMODE EQU   XTNTHDR+84                                               13467000
XTNTENT  EQU   XTNTTBL+88                                               13468000
XTNTDDN  EQU   XTNTENT                                                  13469000
XTNTDSN  EQU   XTNTENT+8                                                13470000
XTNTVOLN EQU   XTNTENT+52                                               13471000
XTNTVOL  EQU   XTNTENT+53                                               13472000
XTNTCHR1 EQU   XTNTENT+62                                               13473000
XTNTCHR2 EQU   XTNTENT+70                                               13474000
SPLIST   EQU   0                                                        13475000
SPQNAME  EQU   SPLIST                                                   13476000
SPRNAME  EQU   SPLIST+8                                                 13477000
SPRLEN   EQU   SPRNAME                                                  13478000
SPRVOL   EQU   SPRNAME+1                                                13479000
RWFR     EQU   0                                                        13480000
RWFRCNT  EQU   RWFR+16                                                  13481000
LOCTAB   EQU   0                                                        13482000
LOCADDR  EQU   LOCTAB                                                   13483000
LOCRCNT  EQU   LOCTAB+4                                                 13484000
LOCRCKD  EQU   LOCTAB+6                                                 13485000
LOCKLEN  EQU   LOCTAB+17                                                13486000
LOCDLEN  EQU   LOCTAB+18                                                13487000
RIOAREA  EQU   0                                                        13488000
RIOHDR   EQU   RIOAREA                                                  13489000
RFIRST   EQU   RIOHDR                                                   13490000
RPREV    EQU   RIOHDR+2                                                 13491000
RPREVCC  EQU   RPREV                                                    13492000
RPREVHH  EQU   RPREV+2                                                  13493000
RNUMREC  EQU   RIOHDR+8                                                 13494000
RKEY     EQU   0                                                        13495000
RKEYCHR  EQU   RKEY+6                                                   13496000
RKEYFLG  EQU   RKEY+11                                                  13497000
RBUF     EQU   0                                                        13498000
RBUFCNT  EQU   RBUF                                                     13499000
RBCCHHR  EQU   RBUFCNT                                                  13500000
WIOAREA  EQU   0                                                        13501000
WBUF     EQU   0                                                        13502000
WBUFCNT  EQU   WBUF                                                     13503000
WBCCHHR  EQU   WBUFCNT                                                  13504000
IHADCB   EQU   0                                                        13505000
IHADCS00 EQU   0                                                        13506000
DCBFDAD  EQU   IHADCS00+5                                               13507000
IHADCS01 EQU   0                                                        13508000
DCBDVTBL EQU   IHADCS01                                                 13509000
IHADCS11 EQU   0                                                        13510000
DCBRELB  EQU   IHADCS11                                                 13511000
DCBREL   EQU   DCBRELB+1                                                13512000
DCBBUFCB EQU   IHADCS11+4                                               13513000
DCBDSORG EQU   IHADCS11+10                                              13514000
DCBDSRG1 EQU   DCBDSORG                                                 13515000
DCBDSRG2 EQU   DCBDSORG+1                                               13516000
DCBIOBAD EQU   IHADCS11+12                                              13517000
DCBODEB  EQU   DCBIOBAD                                                 13518000
DCBLNP   EQU   DCBODEB                                                  13519000
DCBQSLM  EQU   DCBLNP                                                   13520000
DCBIOBAA EQU   DCBODEB+1                                                13521000
IHADCS50 EQU   0                                                        13522000
DCBSVCXL EQU   IHADCS50                                                 13523000
DCBEODAD EQU   IHADCS50+4                                               13524000
DCBBFALN EQU   DCBEODAD                                                 13525000
DCBHIARC EQU   DCBBFALN                                                 13526000
DCBBFTEK EQU   DCBHIARC                                                 13527000
DCBBFT   EQU   DCBBFTEK                                                 13528000
DCBEXLST EQU   IHADCS50+8                                               13529000
DCBRECFM EQU   DCBEXLST                                                 13530000
DCBRECLA EQU   DCBRECFM                                                 13531000
IHADCS24 EQU   0                                                        13532000
DCBOFLGS EQU   IHADCS24+8                                               13533000
DCBOFLWR EQU   DCBOFLGS                                                 13534000
DCBIFLG  EQU   IHADCS24+9                                               13535000
DCBIBPCT EQU   DCBIFLG                                                  13536000
DCBMACR  EQU   IHADCS24+10                                              13537000
DCBMACR1 EQU   DCBMACR                                                  13538000
DCBMRFE  EQU   DCBMACR1                                                 13539000
DCBMRGET EQU   DCBMRFE                                                  13540000
DCBMRAPG EQU   DCBMACR1                                                 13541000
DCBMRRD  EQU   DCBMRAPG                                                 13542000
DCBMRCI  EQU   DCBMACR1                                                 13543000
DCBMRMVG EQU   DCBMRCI                                                  13544000
DCBMRLCG EQU   DCBMACR1                                                 13545000
DCBMRABC EQU   DCBMACR1                                                 13546000
DCBMRPT1 EQU   DCBMRABC                                                 13547000
DCBMRSBG EQU   DCBMRPT1                                                 13548000
DCBMRCRL EQU   DCBMACR1                                                 13549000
DCBMRCHK EQU   DCBMRCRL                                                 13550000
DCBMRRDX EQU   DCBMRCHK                                                 13551000
DCBMRDMG EQU   DCBMACR1                                                 13552000
DCBMACR2 EQU   DCBMACR+1                                                13553000
DCBMRPUT EQU   DCBMACR2                                                 13554000
DCBMRWRT EQU   DCBMACR2                                                 13555000
DCBMRMVP EQU   DCBMACR2                                                 13556000
DCBMR5WD EQU   DCBMACR2                                                 13557000
DCBMRLDM EQU   DCBMR5WD                                                 13558000
DCBMRLCP EQU   DCBMRLDM                                                 13559000
DCBMR4WD EQU   DCBMACR2                                                 13560000
DCBMRPT2 EQU   DCBMR4WD                                                 13561000
DCBMRTMD EQU   DCBMRPT2                                                 13562000
DCBMR3WD EQU   DCBMACR2                                                 13563000
DCBMRCTL EQU   DCBMR3WD                                                 13564000
DCBMRSTK EQU   DCBMRCTL                                                 13565000
DCBMR1WD EQU   DCBMACR2                                                 13566000
DCBMRSWA EQU   DCBMR1WD                                                 13567000
DCBMRDMD EQU   DCBMRSWA                                                 13568000
IHADCS25 EQU   0                                                        13569000
DCBMACRF EQU   IHADCS25+2                                               13570000
DCBMACF1 EQU   DCBMACRF                                                 13571000
DCBMFFE  EQU   DCBMACF1                                                 13572000
DCBMFGET EQU   DCBMFFE                                                  13573000
DCBMFAPG EQU   DCBMACF1                                                 13574000
DCBMFRD  EQU   DCBMFAPG                                                 13575000
DCBMFCI  EQU   DCBMACF1                                                 13576000
DCBMFMVG EQU   DCBMFCI                                                  13577000
DCBMFLCG EQU   DCBMACF1                                                 13578000
DCBMFABC EQU   DCBMACF1                                                 13579000
DCBMFPT1 EQU   DCBMFABC                                                 13580000
DCBMFSBG EQU   DCBMFPT1                                                 13581000
DCBMFCRL EQU   DCBMACF1                                                 13582000
DCBMFCHK EQU   DCBMFCRL                                                 13583000
DCBMFDMG EQU   DCBMACF1                                                 13584000
DCBMACF2 EQU   DCBMACRF+1                                               13585000
DCBMFPUT EQU   DCBMACF2                                                 13586000
DCBMFWRT EQU   DCBMACF2                                                 13587000
DCBMFMVP EQU   DCBMACF2                                                 13588000
DCBMF5WD EQU   DCBMACF2                                                 13589000
DCBMFLDM EQU   DCBMF5WD                                                 13590000
DCBMFLCP EQU   DCBMFLDM                                                 13591000
DCBMF4WD EQU   DCBMACF2                                                 13592000
DCBMFPT2 EQU   DCBMF4WD                                                 13593000
DCBMFTMD EQU   DCBMFPT2                                                 13594000
DCBMF3WD EQU   DCBMACF2                                                 13595000
DCBMFCTL EQU   DCBMF3WD                                                 13596000
DCBMFSTK EQU   DCBMFCTL                                                 13597000
DCBMF1WD EQU   DCBMACF2                                                 13598000
DCBMFSWA EQU   DCBMF1WD                                                 13599000
DCBMFDMD EQU   DCBMFSWA                                                 13600000
DCBDEBAD EQU   IHADCS25+4                                               13601000
DCBIFLGS EQU   DCBDEBAD                                                 13602000
DCBIFPCT EQU   DCBIFLGS                                                 13603000
IHADCS28 EQU   0                                                        13604000
DCBOPTCD EQU   IHADCS28                                                 13605000
DCBOPTZ  EQU   DCBOPTCD                                                 13606000
IHADCS44 EQU   0                                                        13607000
LINKAGES EQU   0                                                        13608000
BACKCHAN EQU   LINKAGES+4                                               13609000
FORCHAIN EQU   LINKAGES+8                                               13610000
CCMSG    EQU   0                                                        13611000
CMMSG    EQU   0                                                        13612000
CMVOLFLG EQU   CMMSG+6                                                  13613000
CTMSG    EQU   0                                                        13614000
CTARRAY  EQU   CTMSG+4                                                  13615000
MDAGL    EQU   0                                                        13616000
MDFLAGS  EQU   MDAGL+30                                                 13617000
MDVTOC   EQU   MDAGL+32                                                 13618000
PUAGL    EQU   0                                                        13619000
CKAGL    EQU   0                                                        13620000
CKFLAGS  EQU   CKAGL+28                                                 13621000
EXCLAGL  EQU   0                                                        13622000
EXCLFLAG EQU   EXCLAGL+22                                               13623000
EXOARG   EQU   0                                                        13624000
EXODDN   EQU   EXOARG+8                                                 13625000
EXODSN   EQU   EXOARG+12                                                13626000
EXOUCB   EQU   EXOARG+20                                                13627000
EXOEXT   EQU   EXOARG+24                                                13628000
EXOCTLBK EQU   EXOARG+28                                                13629000
EXOPT    EQU   EXOARG+32                                                13630000
EXOREP   EQU   EXOPT                                                    13631000
EXFLG    EQU   EXOARG+33                                                13632000
EXOREAD  EQU   EXFLG                                                    13633000
EXORVS   EQU   EXFLG                                                    13634000
EXOSPK   EQU   EXFLG                                                    13635000
EXORDS   EQU   EXFLG                                                    13636000
EXORVT   EQU   EXFLG                                                    13637000
EXOVTH   EQU   EXFLG                                                    13638000
EXGARG   EQU   0                                                        13639000
EXWRARG  EQU   0                                                        13640000
EXRWCHR  EQU   EXWRARG+26                                               13641000
EXSPACE  EQU   EXWRARG+36                                               13642000
EXPARG   EQU   0                                                        13643000
EXPDATA  EQU   EXPARG+12                                                13644000
EXPDATAB EQU   0                                                        13645000
EXPARRAY EQU   EXPDATAB+4                                               13646000
VS2AGL   EQU   0                                                        13647000
VSLABOPT EQU   VS2AGL+28                                                13648000
VS2MSG   EQU   VS2AGL+35                                                13649000
VS2RESOP EQU   VS2AGL+36                                                13650000
VS1AGL   EQU   0                                                        13651000
VSSECOPT EQU   VS1AGL+68                                                13652000
VSVTOPT  EQU   VS1AGL+69                                                13653000
VSCATOPT EQU   VS1AGL+70                                                13654000
VSRETURN EQU   VS1AGL+71                                                13655000
VSMSG    EQU   VS1AGL+72                                                13656000
VSRESOPT EQU   VS1AGL+73                                                13657000
RCTAGL   EQU   0                                                        13658000
RCTOPT   EQU   RCTAGL+8                                                 13659000
STAEPARM EQU   0                                                        13660000
STARCVY  EQU   STAEPARM+52                                              13661000
STARETRY EQU   STAEPARM+53                                              13662000
VOLLABEL EQU   0                                                        13663000
SV82LIST EQU   0                                                        13664000
@NM00131 EQU   SV82LIST+4                                               13665000
SV82DCBP EQU   @NM00131                                                 13666000
@NM00132 EQU   SV82LIST+12                                              13667000
SV82WRKP EQU   @NM00132                                                 13668000
SRTAGL   EQU   0                                                        13669000
LCTINFO  EQU   0                                                        13670000
LCTFLAGS EQU   LCTINFO+32                                               13671000
UCTAGL   EQU   0                                                        13672000
UCTFLAGS EQU   UCTAGL+68                                                13673000
SELAGL   EQU   0                                                        13674000
SELFLAGS EQU   SELAGL+22                                                13675000
DATESAGL EQU   0                                                        13676000
DATESOPT EQU   DATESAGL+20                                              13677000
VS3AGL   EQU   0                                                        13678000
VS3FLAGS EQU   VS3AGL+58                                                13679000
VSDVTOC  EQU   0                                                        13680000
VSDSTAT  EQU   0                                                        13681000
VSDSFLG1 EQU   VSDSTAT+16                                               13682000
VSDFLG2  EQU   VSDSTAT+17                                               13683000
VSDSCR   EQU   0                                                        13684000
VSDSCRFL EQU   VSDSCR+4                                                 13685000
VSDUSAGE EQU   0                                                        13686000
VSDDORG  EQU   VSDUSAGE+9                                               13687000
VSDALLOC EQU   VSDUSAGE+10                                              13688000
VSDUSEF  EQU   VSDUSAGE+11                                              13689000
VSDDSORG EQU   VSDUSAGE+16                                              13690000
VSDBLOCK EQU   0                                                        13691000
VSDSPACE EQU   VSDBLOCK+12                                              13692000
VSDARRAY EQU   VSDBLOCK+16                                              13693000
VSDVARY  EQU   VSDARRAY+48                                              13694000
IDAAMDSB EQU   0                                                        13695000
AMDATTR  EQU   IDAAMDSB+1                                               13696000
AMDNEST  EQU   IDAAMDSB+4                                               13697000
AMDHLRBA EQU   IDAAMDSB+28                                              13698000
AMDSSRBA EQU   IDAAMDSB+32                                              13699000
AMDATTR3 EQU   IDAAMDSB+40                                              13700000
AMDSTAT  EQU   IDAAMDSB+48                                              13701000
IFGACB   EQU   0                                                        13702000
ACBCOMN  EQU   IFGACB                                                   13703000
ACBLENG  EQU   ACBCOMN+2                                                13704000
ACBLENG2 EQU   ACBLENG                                                  13705000
ACBAMBL  EQU   ACBCOMN+4                                                13706000
ACBJWA   EQU   ACBAMBL                                                  13707000
ACBMACRF EQU   ACBCOMN+12                                               13708000
ACBMACR1 EQU   ACBMACRF                                                 13709000
ACBADR   EQU   ACBMACR1                                                 13710000
ACBCNV   EQU   ACBMACR1                                                 13711000
ACBMACR2 EQU   ACBMACRF+1                                               13712000
ACBBUFPL EQU   ACBCOMN+20                                               13713000
ACBMACR3 EQU   ACBBUFPL                                                 13714000
ACBRECFM EQU   ACBCOMN+24                                               13715000
ACBCCTYP EQU   ACBCOMN+25                                               13716000
ACBOPT   EQU   ACBCOMN+26                                               13717000
ACBDSORG EQU   ACBOPT                                                   13718000
ACBCROPS EQU   ACBDSORG                                                 13719000
ACBEXLST EQU   ACBCOMN+36                                               13720000
ACBDDNM  EQU   ACBCOMN+40                                               13721000
ACBAMETH EQU   ACBDDNM+3                                                13722000
ACBOFLGS EQU   ACBCOMN+48                                               13723000
ACBEXFG  EQU   ACBOFLGS                                                 13724000
ACBIOSFG EQU   ACBOFLGS                                                 13725000
ACBINFLG EQU   ACBCOMN+50                                               13726000
ACBUJFCB EQU   ACBCOMN+52                                               13727000
ACBBLKSZ EQU   ACBCOMN+60                                               13728000
IDAAMBL  EQU   0                                                        13729000
AMBLEOV  EQU   IDAAMBL+12                                               13730000
AMBLEFLG EQU   AMBLEOV                                                  13731000
AMBLDDNM EQU   IDAAMBL+16                                               13732000
AMBLIDF  EQU   AMBLDDNM                                                 13733000
AMBLQ    EQU   AMBLIDF+7                                                13734000
AMBLVC   EQU   IDAAMBL+28                                               13735000
AMBLTYPE EQU   IDAAMBL+30                                               13736000
AMBLSHAR EQU   IDAAMBL+33                                               13737000
AMBLFLG1 EQU   IDAAMBL+35                                               13738000
AMBLFLG2 EQU   IDAAMBL+36                                               13739000
AMBLDTA  EQU   IDAAMBL+52                                               13740000
AMBLIX   EQU   IDAAMBL+56                                               13741000
IDAAMB   EQU   0                                                        13742000
AMBDSB   EQU   IDAAMB+20                                                13743000
AMBEOVR  EQU   IDAAMB+24                                                13744000
AMBFLG0  EQU   AMBEOVR                                                  13745000
AMBFLG1  EQU   IDAAMB+25                                                13746000
AMBDSORG EQU   IDAAMB+26                                                13747000
AMBIOBAD EQU   IDAAMB+28                                                13748000
AMBINFL  EQU   IDAAMB+42                                                13749000
AMBDEBPT EQU   IDAAMB+44                                                13750000
AMBDEBAD EQU   AMBDEBPT+1                                               13751000
AMBOFLGS EQU   IDAAMB+48                                                13752000
AMBFLG2  EQU   IDAAMB+49                                                13753000
AMBEOVPT EQU   IDAAMB+56                                                13754000
AMBCSWD1 EQU   IDAAMB+84                                                13755000
AMBAFLG  EQU   AMBCSWD1                                                 13756000
DEBBASIC EQU   0                                                        13757000
DEBTCBAD EQU   DEBBASIC                                                 13758000
DEBDEBAD EQU   DEBBASIC+4                                               13759000
DEBIRBAD EQU   DEBBASIC+8                                               13760000
DEBOFLGS EQU   DEBIRBAD                                                 13761000
DEBOPATB EQU   DEBBASIC+12                                              13762000
DEBFLGS1 EQU   DEBBASIC+14                                              13763000
DEBUSRPG EQU   DEBBASIC+16                                              13764000
DEBNMEXT EQU   DEBUSRPG                                                 13765000
DEBRRQ   EQU   DEBBASIC+20                                              13766000
DEBECBAD EQU   DEBRRQ                                                   13767000
DEBDCBAD EQU   DEBBASIC+24                                              13768000
DEBPROTG EQU   DEBDCBAD                                                 13769000
DEBAPPAD EQU   DEBBASIC+28                                              13770000
DEBEXSCL EQU   DEBAPPAD                                                 13771000
DEBBASND EQU   DEBBASIC+32                                              13772000
DEBDASD  EQU   0                                                        13773000
DEBUCBAD EQU   DEBDASD                                                  13774000
DEBSTRCC EQU   DEBDASD+6                                                13775000
DEBSTRHH EQU   DEBDASD+8                                                13776000
DEBENDCC EQU   DEBDASD+10                                               13777000
DEBENDHH EQU   DEBDASD+12                                               13778000
DEBACSMD EQU   0                                                        13779000
DEBVOLSQ EQU   DEBACSMD                                                 13780000
DEBVOLBT EQU   DEBVOLSQ                                                 13781000
DEBDSNM  EQU   DEBACSMD+4                                               13782000
DEBUTSAA EQU   DEBDSNM                                                  13783000
DEBACS01 EQU   0                                                        13784000
DEBDSNAM EQU   DEBACS01                                                 13785000
DEBACS02 EQU   0                                                        13786000
DEBDBLK  EQU   DEBACS02                                                 13787000
DEBACS03 EQU   0                                                        13788000
DEBACS04 EQU   0                                                        13789000
DEBTBFRA EQU   DEBACS04                                                 13790000
DEBTCCWA EQU   DEBACS04+4                                               13791000
DEBACS05 EQU   0                                                        13792000
DEBFUCBA EQU   DEBACS05                                                 13793000
DEBLUCBA EQU   DEBACS05+4                                               13794000
DEBACS06 EQU   0                                                        13795000
DEBACS07 EQU   0                                                        13796000
DEBACS08 EQU   0                                                        13797000
DEBSUBNM EQU   0                                                        13798000
DEB      EQU   0                                                        13799000
DEBAVT   EQU   DEB                                                      13800000
DEBEOEA  EQU   DEBAVT                                                   13801000
DEBEOEAB EQU   DEBEOEA                                                  13802000
DEBSIOA  EQU   DEBAVT+4                                                 13803000
DEBSIOAB EQU   DEBSIOA                                                  13804000
DEBPCIA  EQU   DEBAVT+8                                                 13805000
DEBPCIAB EQU   DEBPCIA                                                  13806000
DEBCEA   EQU   DEBAVT+12                                                13807000
DEBCEAB  EQU   DEBCEA                                                   13808000
DEBXCEA  EQU   DEBAVT+16                                                13809000
DEBXCEAB EQU   DEBXCEA                                                  13810000
DEBPREFX EQU   DEB+20                                                   13811000
DEBXTNP  EQU   DEBPREFX+8                                               13812000
DEBXTN   EQU   0                                                        13813000
DEBXFLG1 EQU   DEBXTN+2                                                 13814000
IECSDSF1 EQU   0                                                        13815000
IECSDSL1 EQU   0                                                        13816000
DS1DSORG EQU   IECSDSL1+82                                              13817000
DS1RECFM EQU   IECSDSL1+84                                              13818000
DS1LRECL EQU   IECSDSL1+88                                              13819000
IECSDSF3 EQU   0                                                        13820000
IECSDSL3 EQU   0                                                        13821000
IECSDSF4 EQU   0                                                        13822000
IECSDSL4 EQU   0                                                        13823000
DS4DEVCT EQU   IECSDSL4+18                                              13824000
DS4DEVOV EQU   DS4DEVCT+6                                               13825000
DS4AMCAT EQU   IECSDSL4+40                                              13826000
DS4VSIND EQU   DS4AMCAT                                                 13827000
DS4VTOCE EQU   IECSDSL4+61                                              13828000
SINFAREA EQU   0                                                        13829000
INFOSCAN EQU   0                                                        13830000
INFSCNID EQU   INFOSCAN                                                 13831000
INFSCNLN EQU   INFOSCAN+2                                               13832000
DSCBAREA EQU   0                                                        13833000
KEYPTR   EQU   0                                                        13834000
KEYLENS  EQU   0                                                        13835000
DATPTR   EQU   0                                                        13836000
DATALENS EQU   0                                                        13837000
ALLA     EQU   0                                                        13838000
AMSTP041 EQU   0                                                        13839000
AMSTP042 EQU   0                                                        13840000
AMSTP043 EQU   0                                                        13841000
AMSTP044 EQU   0                                                        13842000
CDATLPTR EQU   0                                                        13843000
CHARA    EQU   0                                                        13844000
CKEYLPTR EQU   0                                                        13845000
CLEN     EQU   0                                                        13846000
CLENCNT  EQU   0                                                        13847000
DATALPTR EQU   0                                                        13848000
DBDATPTR EQU   0                                                        13849000
DBKEYPTR EQU   0                                                        13850000
DBLOC    EQU   0                                                        13851000
DBLST    EQU   0                                                        13852000
DBLSTCNT EQU   0                                                        13853000
DBRNG    EQU   0                                                        13854000
DKEYLPTR EQU   0                                                        13855000
DLENG    EQU   0                                                        13856000
DLENGCNT EQU   0                                                        13857000
DMPTRM   EQU   0                                                        13858000
DRRNG    EQU   0                                                        13859000
DUMP     EQU   0                                                        13860000
ERROR    EQU   0                                                        13861000
FREC     EQU   0                                                        13862000
FULLR    EQU   0                                                        13863000
HEXA     EQU   0                                                        13864000
IDCIOCO0 EQU   0                                                        13865000
IDCIOIT0 EQU   0                                                        13866000
IDCIOPO0 EQU   0                                                        13867000
IDCIOPT0 EQU   0                                                        13868000
IDCIOST0 EQU   0                                                        13869000
IDCIOTM0 EQU   0                                                        13870000
IDCIOVY0 EQU   0                                                        13871000
IDCSACA0 EQU   0                                                        13872000
IDCSACL0 EQU   0                                                        13873000
IDCSACR0 EQU   0                                                        13874000
IDCSADE0 EQU   0                                                        13875000
IDCSADL0 EQU   0                                                        13876000
IDCSAFS0 EQU   0                                                        13877000
IDCSAGS0 EQU   0                                                        13878000
IDCSAID0 EQU   0                                                        13879000
IDCSALC0 EQU   0                                                        13880000
IDCSALD0 EQU   0                                                        13881000
IDCSALK0 EQU   0                                                        13882000
IDCSANQ0 EQU   0                                                        13883000
IDCSAPR0 EQU   0                                                        13884000
IDCSAPT0 EQU   0                                                        13885000
IDCSAQL0 EQU   0                                                        13886000
IDCSARC0 EQU   0                                                        13887000
IDCSASC0 EQU   0                                                        13888000
IDCSASN0 EQU   0                                                        13889000
IDCSASS0 EQU   0                                                        13890000
IDCSAST0 EQU   0                                                        13891000
IDCSATI0 EQU   0                                                        13892000
IDCSAUC0 EQU   0                                                        13893000
IDCSAWO0 EQU   0                                                        13894000
IDCSA060 EQU   0                                                        13895000
IDCST010 EQU   0                                                        13896000
IDCTPER0 EQU   0                                                        13897000
IDONL    EQU   0                                                        13898000
LISTTEST EQU   0                                                        13899000
MIRK     EQU   0                                                        13900000
MIRNG    EQU   0                                                        13901000
MNDAT    EQU   0                                                        13902000
MNKEY    EQU   0                                                        13903000
MORK     EQU   0                                                        13904000
MOVFL    EQU   0                                                        13905000
NEWERID1 EQU   5                                                        13906000
GDTTBL   EQU   0                                                        13907000
GDTTR1   EQU   GDTTBL+8                                                 13908000
GDTTR2   EQU   GDTTBL+12                                                13909000
GDTDBG   EQU   GDTTBL+40                                                13910000
GDTSTC   EQU   GDTTBL+44                                                13911000
GDTPRT   EQU   GDTTBL+48                                                13912000
GDTESS   EQU   GDTTBL+52                                                13913000
GDTESA   EQU   GDTTBL+56                                                13914000
GDTRST   EQU   GDTTBL+60                                                13915000
GDTRES   EQU   GDTTBL+64                                                13916000
GDTCAL   EQU   GDTTBL+68                                                13917000
GDTGSP   EQU   GDTTBL+72                                                13918000
GDTFSP   EQU   GDTTBL+76                                                13919000
GDTGPL   EQU   GDTTBL+80                                                13920000
GDTFPL   EQU   GDTTBL+84                                                13921000
GDTLOD   EQU   GDTTBL+88                                                13922000
GDTDEL   EQU   GDTTBL+92                                                13923000
GDTPRL   EQU   GDTTBL+96                                                13924000
GDTEPL   EQU   GDTTBL+100                                               13925000
GDTTIM   EQU   GDTTBL+104                                               13926000
GDTIIO   EQU   GDTTBL+108                                               13927000
GDTTIO   EQU   GDTTBL+112                                               13928000
GDTOPN   EQU   GDTTBL+124                                               13929000
GDTCLS   EQU   GDTTBL+128                                               13930000
GDTGET   EQU   GDTTBL+132                                               13931000
GDTPUT   EQU   GDTTBL+136                                               13932000
GDTPOS   EQU   GDTTBL+140                                               13933000
GDTCPY   EQU   GDTTBL+144                                               13934000
GDTCAT   EQU   GDTTBL+148                                               13935000
GDTSNP   EQU   GDTTBL+164                                               13936000
GDTVFY   EQU   GDTTBL+172                                               13937000
GDTUID   EQU   GDTTBL+192                                               13938000
GDTPMT   EQU   GDTTBL+196                                               13939000
GDTCIR   EQU   GDTTBL+200                                               13940000
GDTLNK   EQU   GDTTBL+204                                               13941000
GDTALC   EQU   GDTTBL+208                                               13942000
GDTDLC   EQU   GDTTBL+212                                               13943000
GDTQAL   EQU   GDTTBL+216                                               13944000
GDTSTW   EQU   GDTTBL+220                                               13945000
GDTSSC   EQU   GDTTBL+224                                               13946000
GDTENQ   EQU   GDTTBL+228                                               13947000
GDTRSV   EQU   GDTTBL+232                                               13948000
GDTDEQ   EQU   GDTTBL+236                                               13949000
GDTSFO   EQU   GDTTBL+240                                               13950000
GDTWTO   EQU   GDTTBL+244                                               13951000
GDTSCR   EQU   GDTTBL+248                                               13952000
GDTUNT   EQU   GDTTBL+252                                               13953000
GDTRCT   EQU   GDTTBL+256                                               13954000
GDTIFO   EQU   GDTTBL+260                                               13955000
GDTEXP   EQU   GDTTBL+264                                               13956000
GDTSTA   EQU   GDTTBL+268                                               13957000
GDTERR   EQU   GDTTBL+272                                               13958000
GDTUNC   EQU   GDTTBL+276                                               13959000
GDTLOC   EQU   GDTTBL+280                                               13960000
FDTTBL   EQU   0                                                        13961000
FDTPTR   EQU   FDTTBL+8                                                 13962000
REPTBL   EQU   0                                                        13963000
REPCB    EQU   REPTBL                                                   13964000
REPIDSOP EQU   REPCB+24                                                 13965000
REPODSOP EQU   REPCB+28                                                 13966000
REPSPRIT EQU   REPCB+40                                                 13967000
REPIBFPT EQU   REPCB+44                                                 13968000
REPOBFPT EQU   REPCB+48                                                 13969000
REPIXTN2 EQU   REPCB+76                                                 13970000
REPIXTNT EQU   REPCB+80                                                 13971000
REPOXTN2 EQU   REPCB+84                                                 13972000
REPOXTNT EQU   REPCB+88                                                 13973000
REPIINFO EQU   REPCB+92                                                 13974000
REPOINFO EQU   REPCB+96                                                 13975000
REPRWHAR EQU   REPCB+100                                                13976000
REPRWINA EQU   REPCB+104                                                13977000
REPISYSI EQU   REPCB+108                                                13978000
REPOSYSI EQU   REPCB+112                                                13979000
REPIDEVA EQU   REPCB+124                                                13980000
REPODEVA EQU   REPCB+128                                                13981000
REPQRPTR EQU   REPCB+132                                                13982000
REPALLAG EQU   REPCB+136                                                13983000
REPEXOAR EQU   REPCB+140                                                13984000
REPOPAGL EQU   REPCB+144                                                13985000
REPCDSOP EQU   REPCB+152                                                13986000
REPCBEXT EQU   REPTBL+156                                               13987000
REPSRPR  EQU   REPCBEXT+4                                               13988000
I        EQU   REPCBEXT+12                                              13989000
J        EQU   REPCBEXT+13                                              13990000
K        EQU   REPCBEXT+14                                              13991000
CKREQ    EQU   REPCBEXT+16                                              13992000
CKRERN   EQU   CKREQ                                                    13993000
CKRMVAR  EQU   CKREQ+4                                                  13994000
WFAREA   EQU   REPCBEXT+76                                              13995000
WFREQ    EQU   WFAREA+12                                                13996000
WFRTYP   EQU   WFREQ                                                    13997000
WFROPT   EQU   WFREQ+1                                                  13998000
REPENQSW EQU   REPCBEXT+90                                              13999000
IOPARM   EQU   0                                                        14000000
TOCHRVAL EQU   0                                                        14001000
ARGLST   EQU   0                                                        14002000
RWDEF    EQU   RWFHDR                                                   14003000
RWFRDE   EQU   RWFR                                                     14004000
EXTNTVAL EQU   DEBEXSCL                                                 14005000
DEBBAS02 EQU   DEBBASND                                                 14006000
DEBDDS1  EQU   DEBBAS02                                                 14007000
DEBSUCBA EQU   DEBDDS1                                                  14008000
DEBDEVED EQU   DEBDDS1+4                                                14009000
DEBRDCB  EQU   DEBDDS1+4                                                14010000
DEBPDCB  EQU   DEBDDS1+8                                                14011000
DEBWDCB  EQU   DEBDDS1+12                                               14012000
DEBACS09 EQU   DEBDEVED                                                 14013000
DEBASC09 EQU   DEBACS09                                                 14014000
DEBEAMFG EQU   DEBASC09+3                                               14015000
DEBDSID  EQU   DEBASC09+4                                               14016000
DEBEOD   EQU   DEBASC09+12                                              14017000
DEBBOE   EQU   DEBEOD                                                   14018000
DEBEODRV EQU   DEBBOE                                                   14019000
DEBEODTT EQU   DEBBOE+1                                                 14020000
DEBEOD0  EQU   DEBBOE+2                                                 14021000
DEBEODSS EQU   DEBBOE+3                                                 14022000
DEBBAS01 EQU   DEBBASND                                                 14023000
DEBISAM  EQU   DEBBAS01                                                 14024000
DEBFIEAD EQU   DEBISAM                                                  14025000
DEBFPEAD EQU   DEBISAM+4                                                14026000
DEBFOEAD EQU   DEBISAM+8                                                14027000
DEBEXPT  EQU   DEBISAM+12                                               14028000
DEBRPSID EQU   DEBEXPT                                                  14029000
RDSPKLDL EQU   RDSPKL                                                   14030000
*                                      START UNREFERENCED COMPONENTS    14031000
DEBEXPTA EQU   DEBEXPT+1                                                14032000
DEBRSV12 EQU   DEBRPSID                                                 14033000
DEBRSV11 EQU   DEBRPSID                                                 14034000
DEBRSV10 EQU   DEBRPSID                                                 14035000
DEBRSV09 EQU   DEBRPSID                                                 14036000
DEBRPSAP EQU   DEBRPSID                                                 14037000
DEBRPSO  EQU   DEBRPSID                                                 14038000
DEBRPSI  EQU   DEBRPSID                                                 14039000
DEBRPSP  EQU   DEBRPSID                                                 14040000
DEBFOEB  EQU   DEBFOEAD+1                                               14041000
DEBNOEE  EQU   DEBFOEAD                                                 14042000
DEBFPEB  EQU   DEBFPEAD+1                                               14043000
DEBNPEE  EQU   DEBFPEAD                                                 14044000
DEBFIEB  EQU   DEBFIEAD+1                                               14045000
DEBNIEE  EQU   DEBFIEAD                                                 14046000
DEBBOESS EQU   DEBEODSS                                                 14047000
DEBBOE0  EQU   DEBEOD0                                                  14048000
DEBBOETT EQU   DEBEODTT                                                 14049000
DEBBOERV EQU   DEBEODRV                                                 14050000
DEBRV008 EQU   DEBDSID+7                                                14051000
DEBWTPTI EQU   DEBDSID+6                                                14052000
DEBEXDTE EQU   DEBDSID                                                  14053000
DEBRV007 EQU   DEBEAMFG                                                 14054000
DEBRV006 EQU   DEBEAMFG                                                 14055000
DEBRV005 EQU   DEBEAMFG                                                 14056000
DEBRV004 EQU   DEBEAMFG                                                 14057000
DEBSECVL EQU   DEBEAMFG                                                 14058000
DEBVAMSG EQU   DEBEAMFG                                                 14059000
DEBDSOPN EQU   DEBEAMFG                                                 14060000
DEBMULTI EQU   DEBEAMFG                                                 14061000
DEBVSEQU EQU   DEBASC09+2                                               14062000
DEBDSSQL EQU   DEBASC09+1                                               14063000
DEBVOLAC EQU   DEBASC09                                                 14064000
DEBWDCBA EQU   DEBWDCB+1                                                14065000
DEBRSV08 EQU   DEBWDCB                                                  14066000
DEBPDCBA EQU   DEBPDCB+1                                                14067000
DEBRSV07 EQU   DEBPDCB                                                  14068000
DEBRDCBA EQU   DEBRDCB+1                                                14069000
DEBRSV06 EQU   DEBRDCB                                                  14070000
DEBSUCBB EQU   DEBSUCBA+1                                               14071000
DEBSDVM  EQU   DEBSUCBA                                                 14072000
@NM00066 EQU   RWFRDE+15                                                14073000
RWFROV   EQU   RWFRDE+14                                                14074000
RWFRF2   EQU   RWFRDE+12                                                14075000
RWFRF1   EQU   RWFRDE+11                                                14076000
@NM00065 EQU   RWFRDE                                                   14077000
RWFHKLN  EQU   RWDEF+92                                                 14078000
RWFHDLN  EQU   RWDEF+90                                                 14079000
RWFHFT   EQU   RWDEF+89                                                 14080000
@NM00045 EQU   RWDEF                                                    14081000
@NM00044 EQU   WFROPT                                                   14082000
WFRUP    EQU   WFROPT                                                   14083000
WFRIN    EQU   WFROPT                                                   14084000
@NM00043 EQU   WFRTYP                                                   14085000
WFRPOS   EQU   WFRTYP                                                   14086000
WFRUPD   EQU   WFRTYP                                                   14087000
WFRGET   EQU   WFRTYP                                                   14088000
WFRLD    EQU   WFRTYP                                                   14089000
WFRADD   EQU   WFRTYP                                                   14090000
WFIOKYA  EQU   WFAREA+8                                                 14091000
WFIODLN  EQU   WFAREA+4                                                 14092000
WFIODAD  EQU   WFAREA                                                   14093000
@NM00042 EQU   REPCBEXT+75                                              14094000
WFIOGUK  EQU   REPCBEXT+64                                              14095000
RDCATRC  EQU   REPCBEXT+60                                              14096000
@NM00041 EQU   CKREQ+2                                                  14097000
@NM00040 EQU   REPCBEXT+15                                              14098000
REPRCDCT EQU   REPCBEXT+8                                               14099000
REPRC    EQU   REPCBEXT+6                                               14100000
@NM00039 EQU   REPSRPR+1                                                14101000
@NM00038 EQU   REPSRPR                                                  14102000
REPSRPRT EQU   REPSRPR                                                  14103000
REPR1LN  EQU   REPCBEXT+2                                               14104000
REPR0LN  EQU   REPCBEXT                                                 14105000
REPCPPTR EQU   REPCB+148                                                14106000
REPOLCPT EQU   REPCB+120                                                14107000
REPILCPT EQU   REPCB+116                                                14108000
REPOUTCL EQU   REPCB+72                                                 14109000
REPINCL  EQU   REPCB+68                                                 14110000
REPRWHDO EQU   REPCB+64                                                 14111000
REPRWHDI EQU   REPCB+60                                                 14112000
REPBUFF1 EQU   REPCB+56                                                 14113000
REPBUFF0 EQU   REPCB+52                                                 14114000
REPODSAR EQU   REPCB+36                                                 14115000
REPIDSAR EQU   REPCB+32                                                 14116000
REPORWIO EQU   REPCB+20                                                 14117000
REPIRWIO EQU   REPCB+16                                                 14118000
REPARFIO EQU   REPCB+12                                                 14119000
REPRESER EQU   REPCB                                                    14120000
FDTVERB  EQU   FDTTBL                                                   14121000
GDTECT   EQU   GDTTBL+188                                               14122000
GDTPSB   EQU   GDTTBL+184                                               14123000
GDTUPT   EQU   GDTTBL+180                                               14124000
GDTCMB   EQU   GDTTBL+176                                               14125000
GDTSPR   EQU   GDTTBL+168                                               14126000
@NM00001 EQU   GDTTBL+160                                               14127000
GDTABH   EQU   GDTTBL+156                                               14128000
GDTABT   EQU   GDTTBL+152                                               14129000
GDTTOH   EQU   GDTTBL+120                                               14130000
GDTRIP   EQU   GDTTBL+116                                               14131000
GDTIOH   EQU   GDTTBL+36                                                14132000
GDTSAH   EQU   GDTTBL+32                                                14133000
GDTTPH   EQU   GDTTBL+28                                                14134000
GDTRIH   EQU   GDTTBL+24                                                14135000
GDTSTH   EQU   GDTTBL+20                                                14136000
GDTDBH   EQU   GDTTBL+16                                                14137000
GDTPRM   EQU   GDTTBL+4                                                 14138000
GDTHDR   EQU   GDTTBL                                                   14139000
DSCBID   EQU   DSCBAREA+44                                              14140000
@NM00201 EQU   DSCBAREA                                                 14141000
INFSCNAR EQU   INFOSCAN+4                                               14142000
DS4END   EQU   IECSDSL4+96                                              14143000
@NM00195 EQU   IECSDSL4+71                                              14144000
DS4F6PTR EQU   IECSDSL4+56                                              14145000
@NM00194 EQU   IECSDSL4+51                                              14146000
DS4R2TIM EQU   IECSDSL4+43                                              14147000
DS4VSCRA EQU   DS4AMCAT+1                                               14148000
@NM00193 EQU   DS4VSIND                                                 14149000
DS4VSBAD EQU   DS4VSIND                                                 14150000
DS4VSREF EQU   DS4VSIND                                                 14151000
DS4AMTIM EQU   IECSDSL4+32                                              14152000
DS4DEVDB EQU   DS4DEVCT+13                                              14153000
DS4DEVDT EQU   DS4DEVCT+12                                              14154000
DS4DEVTL EQU   DS4DEVCT+10                                              14155000
DS4DEVFG EQU   DS4DEVCT+9                                               14156000
DS4DEVK  EQU   DS4DEVCT+8                                               14157000
DS4DEVL  EQU   DS4DEVOV+1                                               14158000
DS4DEVI  EQU   DS4DEVOV                                                 14159000
DS4DEVTK EQU   DS4DEVCT+4                                               14160000
DS4DEVSZ EQU   DS4DEVCT                                                 14161000
@NM00192 EQU   IECSDSL4+16                                              14162000
DS4NOEXT EQU   IECSDSL4+15                                              14163000
DS4VTOCI EQU   IECSDSL4+14                                              14164000
DS4NOATK EQU   IECSDSL4+12                                              14165000
DS4HCCHH EQU   IECSDSL4+8                                               14166000
DS4DSREC EQU   IECSDSL4+6                                               14167000
DS4HPCHR EQU   IECSDSL4+1                                               14168000
DS4IDFMT EQU   IECSDSL4                                                 14169000
@NM00191 EQU   IECSDSF4                                                 14170000
DS3END   EQU   IECSDSL3+140                                             14171000
DS3PTRDS EQU   IECSDSL3+135                                             14172000
DS3ADEXT EQU   IECSDSL3+45                                              14173000
DS3FMTID EQU   IECSDSL3+44                                              14174000
DS3EXTNT EQU   IECSDSL3+4                                               14175000
@NM00190 EQU   IECSDSL3                                                 14176000
@NM00189 EQU   IECSDSF3                                                 14177000
DS1END   EQU   IECSDSL1+140                                             14178000
DS1PTRDS EQU   IECSDSL1+135                                             14179000
DS1EXT3  EQU   IECSDSL1+125                                             14180000
DS1EXT2  EQU   IECSDSL1+115                                             14181000
DS1EXT1  EQU   IECSDSL1+105                                             14182000
@NM00188 EQU   IECSDSL1+103                                             14183000
DS1TRBAL EQU   IECSDSL1+101                                             14184000
DS1LSTAR EQU   IECSDSL1+98                                              14185000
DS1SCALO EQU   IECSDSL1+94                                              14186000
DS1DSIND EQU   IECSDSL1+93                                              14187000
DS1RKP   EQU   IECSDSL1+91                                              14188000
DS1KEYL  EQU   IECSDSL1+90                                              14189000
DS1BLKL  EQU   IECSDSL1+86                                              14190000
DS1OPTCD EQU   IECSDSL1+85                                              14191000
@NM00187 EQU   IECSDSL1+75                                              14192000
DS1SYSCD EQU   IECSDSL1+62                                              14193000
@NM00186 EQU   IECSDSL1+61                                              14194000
DS1NOBDB EQU   IECSDSL1+60                                              14195000
DS1NOEPV EQU   IECSDSL1+59                                              14196000
DS1EXPDT EQU   IECSDSL1+56                                              14197000
DS1CREDT EQU   IECSDSL1+53                                              14198000
DS1VOLSQ EQU   IECSDSL1+51                                              14199000
DS1DSSN  EQU   IECSDSL1+45                                              14200000
DS1FMTID EQU   IECSDSL1+44                                              14201000
DS1DSNAM EQU   IECSDSL1                                                 14202000
@NM00185 EQU   IECSDSF1                                                 14203000
DEBXRV40 EQU   DEBXTN+28                                                14204000
DEBXOPNJ EQU   DEBXTN+24                                                14205000
DEBXXARG EQU   DEBXTN+20                                                14206000
DEBXMCF2 EQU   DEBXTN+19                                                14207000
DEBXMCF1 EQU   DEBXTN+18                                                14208000
DEBXDSO2 EQU   DEBXTN+17                                                14209000
DEBXDSO1 EQU   DEBXTN+16                                                14210000
DEBXDBPR EQU   DEBXTN+12                                                14211000
DEBXDCBM EQU   DEBXTN+8                                                 14212000
DEBXDSAB EQU   DEBXTN+4                                                 14213000
DEBXRV48 EQU   DEBXTN+3                                                 14214000
DEBXRV47 EQU   DEBXFLG1                                                 14215000
DEBXRV46 EQU   DEBXFLG1                                                 14216000
DEBXRV45 EQU   DEBXFLG1                                                 14217000
DEBXRV44 EQU   DEBXFLG1                                                 14218000
DEBXRV43 EQU   DEBXFLG1                                                 14219000
DEBXDSSI EQU   DEBXFLG1                                                 14220000
DEBXTSKC EQU   DEBXFLG1                                                 14221000
DEBXCDCB EQU   DEBXFLG1                                                 14222000
DEBXLNGH EQU   DEBXTN                                                   14223000
DEBTBLOF EQU   DEBPREFX+14                                              14224000
DEBAMTYP EQU   DEBPREFX+13                                              14225000
DEBLNGTH EQU   DEBPREFX+12                                              14226000
DEBDCBMK EQU   DEBXTNP                                                  14227000
DEBDSCBA EQU   DEBPREFX+1                                               14228000
DEBWKARA EQU   DEBPREFX                                                 14229000
DEBXCEAD EQU   DEBXCEA+1                                                14230000
DEBXCENP EQU   DEBXCEAB                                                 14231000
DEBRSV35 EQU   DEBXCEAB                                                 14232000
DEBRSV34 EQU   DEBXCEAB                                                 14233000
DEBRSV33 EQU   DEBXCEAB                                                 14234000
DEBRSV32 EQU   DEBXCEAB                                                 14235000
DEBCEAD  EQU   DEBCEA+1                                                 14236000
DEBCENP  EQU   DEBCEAB                                                  14237000
DEBRSV31 EQU   DEBCEAB                                                  14238000
DEBRSV30 EQU   DEBCEAB                                                  14239000
DEBRSV29 EQU   DEBCEAB                                                  14240000
DEBRSV28 EQU   DEBCEAB                                                  14241000
DEBPCIAD EQU   DEBPCIA+1                                                14242000
DEBPCINP EQU   DEBPCIAB                                                 14243000
DEBRSV27 EQU   DEBPCIAB                                                 14244000
DEBRSV26 EQU   DEBPCIAB                                                 14245000
DEBRSV25 EQU   DEBPCIAB                                                 14246000
DEBRSV24 EQU   DEBPCIAB                                                 14247000
DEBSIOAD EQU   DEBSIOA+1                                                14248000
DEBSIONP EQU   DEBSIOAB                                                 14249000
DEBFIX   EQU   DEBSIOAB                                                 14250000
DEBIOVR  EQU   DEBSIOAB                                                 14251000
DEBSIOX  EQU   DEBSIOAB                                                 14252000
DEBPGFX  EQU   DEBSIOAB                                                 14253000
DEBEOEAD EQU   DEBEOEA+1                                                14254000
DEBEOENP EQU   DEBEOEAB                                                 14255000
DEBRSV22 EQU   DEBEOEAB                                                 14256000
DEBRSV21 EQU   DEBEOEAB                                                 14257000
DEBRSV20 EQU   DEBEOEAB                                                 14258000
DEBRSV19 EQU   DEBEOEAB                                                 14259000
DEBSUBID EQU   DEBSUBNM                                                 14260000
DEBSIOA2 EQU   DEBACS08+24                                              14261000
DEBRPSIO EQU   DEBACS08+20                                              14262000
DEBFREED EQU   DEBACS08+16                                              14263000
@NM00184 EQU   DEBACS08+12                                              14264000
@NM00183 EQU   DEBACS08+8                                               14265000
DEBDISAD EQU   DEBACS08+4                                               14266000
@NM00182 EQU   DEBACS08                                                 14267000
DEBRPSST EQU   DEBACS07+64                                              14268000
DEBARECK EQU   DEBACS07+60                                              14269000
DEBAREWT EQU   DEBACS07+56                                              14270000
DEBACHK  EQU   DEBACS07+52                                              14271000
DEBAWRIT EQU   DEBACS07+48                                              14272000
DEBASETL EQU   DEBACS07+44                                              14273000
DEBAREAD EQU   DEBACS07+40                                              14274000
DEBCRECK EQU   DEBACS07+36                                              14275000
DEBCREWT EQU   DEBACS07+32                                              14276000
DEBCCHK  EQU   DEBACS07+28                                              14277000
DEBCWRIT EQU   DEBACS07+24                                              14278000
DEBCSETL EQU   DEBACS07+20                                              14279000
DEBCREAD EQU   DEBACS07+16                                              14280000
DEBWKPT5 EQU   DEBACS07+12                                              14281000
DEBWKPT4 EQU   DEBACS07+8                                               14282000
DEBGET   EQU   DEBACS07+4                                               14283000
@NM00181 EQU   DEBACS07                                                 14284000
DEBPUT   EQU   DEBACS06+4                                               14285000
DEBDCBFA EQU   DEBACS06                                                 14286000
DEBLUCBB EQU   DEBLUCBA+1                                               14287000
DEBRSV18 EQU   DEBLUCBA                                                 14288000
DEBFUCBB EQU   DEBFUCBA+1                                               14289000
DEBRSV17 EQU   DEBFUCBA                                                 14290000
DEBTCCWB EQU   DEBTCCWA+1                                               14291000
DEBRSV16 EQU   DEBTCCWA                                                 14292000
DEBTBFRB EQU   DEBTBFRA+1                                               14293000
DEBRSV15 EQU   DEBTBFRA                                                 14294000
DEBDBPEF EQU   DEBACS03+8                                               14295000
DEBDBPP  EQU   DEBACS03+4                                               14296000
DEBDTPP  EQU   DEBACS03                                                 14297000
DEBDBPE  EQU   DEBDBLK+1                                                14298000
DEBDBPT  EQU   DEBDBLK                                                  14299000
DEBEXTNM EQU   DEBDSNAM                                                 14300000
DEBLRECL EQU   DEBACSMD+14                                              14301000
DEBBLKSI EQU   DEBACSMD+12                                              14302000
DEBRSV14 EQU   DEBDSNM+4                                                14303000
DEBUTSAB EQU   DEBUTSAA+1                                               14304000
DEBRSV13 EQU   DEBUTSAA                                                 14305000
DEBVOLNM EQU   DEBACSMD+2                                               14306000
DEBVLSEQ EQU   DEBVOLSQ+1                                               14307000
DEBRSV42 EQU   DEBVOLBT                                                 14308000
DEBRSV41 EQU   DEBVOLBT                                                 14309000
DEBRSV40 EQU   DEBVOLBT                                                 14310000
DEBRSV39 EQU   DEBVOLBT                                                 14311000
DEBRSV38 EQU   DEBVOLBT                                                 14312000
DEBRSV37 EQU   DEBVOLBT                                                 14313000
DEBRSV36 EQU   DEBVOLBT                                                 14314000
DEBEXFUL EQU   DEBVOLBT                                                 14315000
DEBNMTRK EQU   DEBDASD+14                                               14316000
DEBBINUM EQU   DEBDASD+4                                                14317000
DEBUCBA  EQU   DEBUCBAD+1                                               14318000
DEBDVMOD EQU   DEBUCBAD                                                 14319000
DEBAPPB  EQU   DEBAPPAD+1                                               14320000
DEBDCBB  EQU   DEBDCBAD+1                                               14321000
DEBDEBID EQU   DEBPROTG                                                 14322000
DEBECBB  EQU   DEBECBAD+1                                               14323000
DEBPRIOR EQU   DEBECBAD                                                 14324000
DEBUSRPB EQU   DEBUSRPG+1                                               14325000
DEBRSV05 EQU   DEBBASIC+15                                              14326000
DEBXTNIN EQU   DEBFLGS1                                                 14327000
DEBAPFIN EQU   DEBFLGS1                                                 14328000
DEBF1CEV EQU   DEBFLGS1                                                 14329000
DEBCINDI EQU   DEBFLGS1                                                 14330000
DEBRSV02 EQU   DEBFLGS1                                                 14331000
DEBRSIOA EQU   DEBFLGS1                                                 14332000
DEBEOFDF EQU   DEBFLGS1                                                 14333000
DEBPWCKD EQU   DEBFLGS1                                                 14334000
DEBQSCNT EQU   DEBBASIC+13                                              14335000
DEBACCS  EQU   DEBOPATB                                                 14336000
DEBPOSIT EQU   DEBOPATB                                                 14337000
DEBZERO  EQU   DEBOPATB                                                 14338000
DEBABEND EQU   DEBOPATB                                                 14339000
DEBIRBB  EQU   DEBIRBAD+1                                               14340000
DEBRERR  EQU   DEBOFLGS                                                 14341000
DEBLABEL EQU   DEBOFLGS                                                 14342000
DEBSPLIT EQU   DEBOFLGS                                                 14343000
DEBDCB   EQU   DEBOFLGS                                                 14344000
DEBRLSE  EQU   DEBOFLGS                                                 14345000
DEBEOF   EQU   DEBOFLGS                                                 14346000
DEBDISP  EQU   DEBOFLGS                                                 14347000
DEBDEBB  EQU   DEBDEBAD+1                                               14348000
DEBAMLNG EQU   DEBDEBAD                                                 14349000
DEBTCBB  EQU   DEBTCBAD+1                                               14350000
DEBNMSUB EQU   DEBTCBAD                                                 14351000
AMBVIOT  EQU   IDAAMB+116                                               14352000
AMBSZCP  EQU   IDAAMB+114                                               14353000
AMBSZFW  EQU   IDAAMB+112                                               14354000
AMBSZWR  EQU   IDAAMB+110                                               14355000
AMBSZRD  EQU   IDAAMB+108                                               14356000
AMBEXEX  EQU   IDAAMB+100                                               14357000
AMBWSHD  EQU   IDAAMB+96                                                14358000
AMBCPA   EQU   IDAAMB+92                                                14359000
AMBBM2SH EQU   IDAAMB+88                                                14360000
AMBRDCNT EQU   AMBCSWD1+2                                               14361000
@NM00180 EQU   AMBCSWD1+1                                               14362000
@NM00179 EQU   AMBAFLG                                                  14363000
AMBCFX   EQU   AMBAFLG                                                  14364000
AMBSIS   EQU   AMBAFLG                                                  14365000
AMBDFR   EQU   AMBAFLG                                                  14366000
AMBICI   EQU   AMBAFLG                                                  14367000
AMBGSR   EQU   AMBAFLG                                                  14368000
AMBLSR   EQU   AMBAFLG                                                  14369000
@NM00178 EQU   AMBAFLG                                                  14370000
AMBUPLH  EQU   IDAAMB+80                                                14371000
AMBPAMBL EQU   IDAAMB+76                                                14372000
AMBPIXP  EQU   IDAAMB+72                                                14373000
@NM00177 EQU   IDAAMB+68                                                14374000
AMBIWA   EQU   IDAAMB+64                                                14375000
AMBWKA   EQU   IDAAMB+60                                                14376000
AMBAMBXN EQU   AMBEOVPT                                                 14377000
AMBEDB   EQU   IDAAMB+52                                                14378000
AMBRPT   EQU   IDAAMB+50                                                14379000
AMBPUG   EQU   AMBFLG2                                                  14380000
AMBBUSY  EQU   AMBOFLGS                                                 14381000
AMBEXFG  EQU   AMBOFLGS                                                 14382000
@NM00176 EQU   AMBOFLGS                                                 14383000
AMBOPEN  EQU   AMBOFLGS                                                 14384000
@NM00175 EQU   AMBOFLGS                                                 14385000
AMBIFLGS EQU   AMBDEBPT                                                 14386000
AMBAMETH EQU   IDAAMB+43                                                14387000
AMBUPX   EQU   AMBINFL                                                  14388000
AMBUCRA  EQU   AMBINFL                                                  14389000
AMBSCRA  EQU   AMBINFL                                                  14390000
AMBCAT   EQU   AMBINFL                                                  14391000
@NM00174 EQU   AMBINFL                                                  14392000
@NM00173 EQU   AMBINFL                                                  14393000
AMBTIOT  EQU   IDAAMB+40                                                14394000
@NM00172 EQU   IDAAMB+38                                                14395000
AMBDDSN  EQU   IDAAMB+35                                                14396000
AMBCDSN  EQU   IDAAMB+32                                                14397000
AMBIOMB  EQU   AMBIOBAD                                                 14398000
@NM00171 EQU   AMBDSORG+1                                               14399000
AMBDORGA EQU   AMBDSORG+1                                               14400000
@NM00170 EQU   AMBDSORG                                                 14401000
AMBINBUF EQU   AMBFLG1                                                  14402000
AMBJRN   EQU   AMBFLG1                                                  14403000
AMBUBF   EQU   AMBFLG1                                                  14404000
AMBSPEED EQU   AMBFLG1                                                  14405000
AMBPCAT  EQU   AMBFLG1                                                  14406000
AMBMCAT  EQU   AMBFLG1                                                  14407000
AMBTYPE  EQU   AMBFLG1                                                  14408000
AMBCREAT EQU   AMBFLG1                                                  14409000
@NM00169 EQU   AMBFLG0                                                  14410000
AMBPSDS  EQU   AMBFLG0                                                  14411000
AMBCACB  EQU   IDAAMB+16                                                14412000
AMBPH    EQU   IDAAMB+12                                                14413000
AMBBUFC  EQU   IDAAMB+8                                                 14414000
AMBLINK  EQU   IDAAMB+4                                                 14415000
AMBLEN   EQU   IDAAMB+2                                                 14416000
AMBRSC   EQU   IDAAMB+1                                                 14417000
AMBID    EQU   IDAAMB                                                   14418000
AMBLCMB  EQU   IDAAMBL+64                                               14419000
AMBLBIB  EQU   IDAAMBL+60                                               14420000
AMBLMIDS EQU   IDAAMBL+42                                               14421000
AMBLNIDS EQU   IDAAMBL+41                                               14422000
@NM00168 EQU   IDAAMBL+40                                               14423000
AMBLNUM  EQU   IDAAMBL+38                                               14424000
AMBLNST  EQU   IDAAMBL+37                                               14425000
@NM00167 EQU   AMBLFLG2                                                 14426000
AMBLSTAG EQU   AMBLFLG2                                                 14427000
@NM00166 EQU   AMBLFLG2                                                 14428000
AMBLDUMY EQU   AMBLFLG1                                                 14429000
AMBLCAT  EQU   AMBLFLG1                                                 14430000
AMBLUCRA EQU   AMBLFLG1                                                 14431000
AMBLSCRA EQU   AMBLFLG1                                                 14432000
AMBLVVIC EQU   AMBLFLG1                                                 14433000
AMBLUPD  EQU   AMBLFLG1                                                 14434000
AMBLCINV EQU   AMBLFLG1                                                 14435000
AMBLFULL EQU   AMBLFLG1                                                 14436000
AMBLLEN  EQU   IDAAMBL+34                                               14437000
@NM00165 EQU   AMBLSHAR                                                 14438000
AMBLWRIT EQU   AMBLSHAR                                                 14439000
AMBLCATO EQU   AMBLSHAR                                                 14440000
AMBLPRIM EQU   AMBLSHAR                                                 14441000
AMBLID   EQU   IDAAMBL+32                                               14442000
@NM00164 EQU   IDAAMBL+31                                               14443000
@NM00163 EQU   AMBLTYPE                                                 14444000
AMBLFIX  EQU   AMBLTYPE                                                 14445000
AMBLBASE EQU   AMBLTYPE                                                 14446000
AMBLAIX  EQU   AMBLTYPE                                                 14447000
AMBLUPGR EQU   AMBLTYPE                                                 14448000
AMBLPATH EQU   AMBLTYPE                                                 14449000
AMBLENO  EQU   AMBLVC+1                                                 14450000
AMBLVRT  EQU   AMBLVC                                                   14451000
AMBLXPT  EQU   IDAAMBL+24                                               14452000
AMBLDFR  EQU   AMBLQ                                                    14453000
AMBLESDS EQU   AMBLQ                                                    14454000
AMBLKSDS EQU   AMBLQ                                                    14455000
AMBLUBF  EQU   AMBLQ                                                    14456000
AMBLFSTP EQU   AMBLQ                                                    14457000
AMBLLSR  EQU   AMBLQ                                                    14458000
AMBLGSR  EQU   AMBLQ                                                    14459000
AMBLDDC  EQU   AMBLQ                                                    14460000
AMBLDCI  EQU   AMBLIDF+4                                                14461000
AMBLCACB EQU   AMBLIDF                                                  14462000
@NM00162 EQU   AMBLEOV+2                                                14463000
AMBLCOMP EQU   AMBLEOV+1                                                14464000
AMBLESET EQU   AMBLEFLG                                                 14465000
AMBLWAIT EQU   AMBLEFLG                                                 14466000
AMBLACB  EQU   IDAAMBL+8                                                14467000
AMBLSCHN EQU   IDAAMBL+4                                                14468000
AMBLPCHN EQU   IDAAMBL                                                  14469000
ACBAPID  EQU   ACBCOMN+72                                               14470000
ACBCBMWA EQU   ACBCOMN+68                                               14471000
ACBUAPTR EQU   ACBCOMN+64                                               14472000
ACBLRECL EQU   ACBCOMN+62                                               14473000
ACBMSGLN EQU   ACBBLKSZ                                                 14474000
ACBBUFSP EQU   ACBCOMN+56                                               14475000
@NM00161 EQU   ACBUJFCB+1                                               14476000
ACBOPTN  EQU   ACBUJFCB                                                 14477000
ACBVVIC  EQU   ACBINFLG                                                 14478000
ACBUCRA  EQU   ACBINFLG                                                 14479000
ACBSCRA  EQU   ACBINFLG                                                 14480000
ACBCAT   EQU   ACBINFLG                                                 14481000
ACBIJRQE EQU   ACBINFLG                                                 14482000
ACBJEPS  EQU   ACBINFLG                                                 14483000
@NM00160 EQU   ACBINFLG                                                 14484000
ACBERFLG EQU   ACBCOMN+49                                               14485000
ACBBUSY  EQU   ACBIOSFG                                                 14486000
ACBLOCK  EQU   ACBEXFG                                                  14487000
@NM00159 EQU   ACBOFLGS                                                 14488000
ACBDSERR EQU   ACBOFLGS                                                 14489000
ACBOPEN  EQU   ACBOFLGS                                                 14490000
ACBEOV   EQU   ACBOFLGS                                                 14491000
@NM00158 EQU   ACBOFLGS                                                 14492000
ACBDEB   EQU   ACBDDNM+5                                                14493000
ACBERFL  EQU   ACBDDNM+4                                                14494000
ACBAM    EQU   ACBAMETH                                                 14495000
ACBINFL  EQU   ACBDDNM+2                                                14496000
ACBTIOT  EQU   ACBDDNM                                                  14497000
ACBUEL   EQU   ACBEXLST                                                 14498000
ACBPASSW EQU   ACBCOMN+32                                               14499000
ACBMSGAR EQU   ACBCOMN+28                                               14500000
@NM00157 EQU   ACBDSORG+1                                               14501000
ACBDORGA EQU   ACBDSORG+1                                               14502000
@NM00156 EQU   ACBDSORG                                                 14503000
ACBCRNRE EQU   ACBCROPS                                                 14504000
ACBCRNCK EQU   ACBCROPS                                                 14505000
ACBASA   EQU   ACBCCTYP                                                 14506000
@NM00155 EQU   ACBCCTYP                                                 14507000
ACBRECAF EQU   ACBRECFM                                                 14508000
ACBJBUF  EQU   ACBBUFPL+2                                               14509000
ACBMACR4 EQU   ACBBUFPL+1                                               14510000
@NM00154 EQU   ACBMACR3                                                 14511000
ACBNCFX  EQU   ACBMACR3                                                 14512000
ACBSIS   EQU   ACBMACR3                                                 14513000
ACBDFR   EQU   ACBMACR3                                                 14514000
ACBICI   EQU   ACBMACR3                                                 14515000
ACBGSR   EQU   ACBMACR3                                                 14516000
ACBLSR   EQU   ACBMACR3                                                 14517000
@NM00153 EQU   ACBMACR3                                                 14518000
ACBBUFNI EQU   ACBCOMN+18                                               14519000
ACBBUFND EQU   ACBCOMN+16                                               14520000
ACBSTRNO EQU   ACBCOMN+15                                               14521000
ACBBSTNO EQU   ACBCOMN+14                                               14522000
ACBAIX   EQU   ACBMACR2                                                 14523000
ACBDSN   EQU   ACBMACR2                                                 14524000
ACBRST   EQU   ACBMACR2                                                 14525000
ACBLOGON EQU   ACBMACR2                                                 14526000
ACBSKP   EQU   ACBMACR2                                                 14527000
@NM00152 EQU   ACBMACR2                                                 14528000
ACBUBF   EQU   ACBMACR1                                                 14529000
ACBOUT   EQU   ACBMACR1                                                 14530000
ACBIN    EQU   ACBMACR1                                                 14531000
ACBDIR   EQU   ACBMACR1                                                 14532000
ACBSEQ   EQU   ACBMACR1                                                 14533000
ACBBLK   EQU   ACBCNV                                                   14534000
ACBADD   EQU   ACBADR                                                   14535000
ACBKEY   EQU   ACBMACR1                                                 14536000
ACBINRTN EQU   ACBCOMN+8                                                14537000
ACBIBCT  EQU   ACBJWA                                                   14538000
ACBLEN2  EQU   ACBLENG2                                                 14539000
ACBSTYP  EQU   ACBCOMN+1                                                14540000
ACBID    EQU   ACBCOMN                                                  14541000
AMDEXCP  EQU   AMDSTAT+44                                               14542000
AMDNCAS  EQU   AMDSTAT+40                                               14543000
AMDNCIS  EQU   AMDSTAT+36                                               14544000
AMDASPA  EQU   AMDSTAT+32                                               14545000
AMDRETR  EQU   AMDSTAT+28                                               14546000
AMDUPR   EQU   AMDSTAT+24                                               14547000
AMDIREC  EQU   AMDSTAT+20                                               14548000
AMDDELR  EQU   AMDSTAT+16                                               14549000
AMDNLR   EQU   AMDSTAT+12                                               14550000
AMDNEXT  EQU   AMDSTAT+10                                               14551000
AMDNIL   EQU   AMDSTAT+8                                                14552000
AMDSTSP  EQU   AMDSTAT                                                  14553000
@NM00151 EQU   IDAAMDSB+41                                              14554000
@NM00150 EQU   AMDATTR3                                                 14555000
AMDLM    EQU   AMDATTR3                                                 14556000
AMDWAIT  EQU   AMDATTR3                                                 14557000
AMDBIND  EQU   AMDATTR3                                                 14558000
AMDFAULT EQU   AMDATTR3                                                 14559000
AMDUNQ   EQU   AMDATTR3                                                 14560000
AMDPARDB EQU   IDAAMDSB+36                                              14561000
AMDMAXRR EQU   AMDSSRBA                                                 14562000
AMDNSLOT EQU   AMDHLRBA                                                 14563000
AMDLRECL EQU   IDAAMDSB+24                                              14564000
AMDCINV  EQU   IDAAMDSB+20                                              14565000
AMDFSCI  EQU   IDAAMDSB+16                                              14566000
AMDFSCA  EQU   IDAAMDSB+14                                              14567000
AMDCIPCA EQU   IDAAMDSB+12                                              14568000
AMDPCTCI EQU   IDAAMDSB+11                                              14569000
AMDPCTCA EQU   IDAAMDSB+10                                              14570000
AMDKEYLN EQU   IDAAMDSB+8                                               14571000
AMDRKP   EQU   IDAAMDSB+6                                               14572000
AMDAXRKP EQU   AMDNEST                                                  14573000
AMDLEN   EQU   IDAAMDSB+2                                               14574000
AMDSPAN  EQU   AMDATTR                                                  14575000
AMDRRDS  EQU   AMDATTR                                                  14576000
AMDRANGE EQU   AMDATTR                                                  14577000
AMDORDER EQU   AMDATTR                                                  14578000
AMDREPL  EQU   AMDATTR                                                  14579000
AMDSDT   EQU   AMDATTR                                                  14580000
AMDWCK   EQU   AMDATTR                                                  14581000
AMDDST   EQU   AMDATTR                                                  14582000
AMDSBID  EQU   IDAAMDSB                                                 14583000
VSDDSN   EQU   VSDARRAY+4                                               14584000
VSDVOLCT EQU   VSDARRAY                                                 14585000
VSDFMT0  EQU   VSDBLOCK+8                                               14586000
VSDVTOCS EQU   VSDBLOCK+4                                               14587000
VSDELEM  EQU   VSDBLOCK                                                 14588000
VSDFREE  EQU   VSDUSAGE+24                                              14589000
VSDALLC  EQU   VSDUSAGE+19                                              14590000
VSDDSOR3 EQU   VSDDSORG+2                                               14591000
@NM00149 EQU   VSDDSORG                                                 14592000
VSDSCAL  EQU   VSDUSAGE+12                                              14593000
@NM00148 EQU   VSDUSEF                                                  14594000
VSDCALFR EQU   VSDUSEF                                                  14595000
@NM00147 EQU   VSDALLOC                                                 14596000
VSDABSTR EQU   VSDALLOC                                                 14597000
VSDABLK  EQU   VSDALLOC                                                 14598000
VSDATRK  EQU   VSDALLOC                                                 14599000
VSDACYL  EQU   VSDALLOC                                                 14600000
@NM00146 EQU   VSDDORG                                                  14601000
VSDOU    EQU   VSDDORG                                                  14602000
VSDOIS   EQU   VSDDORG                                                  14603000
VSDODA   EQU   VSDDORG                                                  14604000
VSDOUN   EQU   VSDDORG                                                  14605000
VSDOPS   EQU   VSDDORG                                                  14606000
VSDOPO   EQU   VSDDORG                                                  14607000
VSDEXTS  EQU   VSDUSAGE+8                                               14608000
VSDSECAL EQU   VSDUSAGE+4                                               14609000
VSDFTRK  EQU   VSDUSAGE+2                                               14610000
VSDTRKS  EQU   VSDUSAGE                                                 14611000
@NM00145 EQU   VSDSCR+5                                                 14612000
@NM00144 EQU   VSDSCRFL                                                 14613000
VSDVSAM  EQU   VSDSCRFL                                                 14614000
VSDCATLC EQU   VSDSCRFL                                                 14615000
VSDACBPT EQU   VSDSCR                                                   14616000
VSDPRTC  EQU   VSDSTAT+25                                               14617000
VSDCAT   EQU   VSDSTAT+22                                               14618000
VSDEXP   EQU   VSDSTAT+20                                               14619000
VSDCRE   EQU   VSDSTAT+18                                               14620000
@NM00143 EQU   VSDFLG2                                                  14621000
VSDERROR EQU   VSDFLG2                                                  14622000
VSDPROT  EQU   VSDFLG2                                                  14623000
VSDPWW   EQU   VSDFLG2                                                  14624000
VSDPWR   EQU   VSDFLG2                                                  14625000
@NM00142 EQU   VSDSFLG1                                                 14626000
VSDCVSAM EQU   VSDSFLG1                                                 14627000
VSDCATLG EQU   VSDSFLG1                                                 14628000
VSDVSAME EQU   VSDSFLG1                                                 14629000
VSDVSAMC EQU   VSDSFLG1                                                 14630000
VSDVTOCE EQU   VSDSFLG1                                                 14631000
VSDVTOCC EQU   VSDSFLG1                                                 14632000
VSDOWNER EQU   VSDSTAT+8                                                14633000
VSDEXPIR EQU   VSDSTAT+4                                                14634000
VSDCREAT EQU   VSDSTAT                                                  14635000
VSDFRCCL EQU   VSDVTOC+21                                               14636000
@NM00141 EQU   VSDVTOC+20                                               14637000
VSDFREXT EQU   VSDVTOC+16                                               14638000
@NM00140 EQU   VSDVTOC+15                                               14639000
VSDFRTRK EQU   VSDVTOC+11                                               14640000
@NM00139 EQU   VSDVTOC+10                                               14641000
VSDFRCYL EQU   VSDVTOC+6                                                14642000
@NM00138 EQU   VSDVTOC                                                  14643000
@NM00137 EQU   VS3FLAGS                                                 14644000
VS3SYSNM EQU   VS3FLAGS                                                 14645000
VS3UNCAT EQU   VS3FLAGS                                                 14646000
VS3SCR   EQU   VS3FLAGS                                                 14647000
VS3USAGE EQU   VS3FLAGS                                                 14648000
VS3STAT  EQU   VS3FLAGS                                                 14649000
VS3DD    EQU   VS3AGL+50                                                14650000
VS3VOL   EQU   VS3AGL+44                                                14651000
VS3POOL  EQU   VS3AGL+40                                                14652000
VS3DEV   EQU   VS3AGL+36                                                14653000
VS3UCBP  EQU   VS3AGL+32                                                14654000
VS3CREAT EQU   VS3AGL+28                                                14655000
VS3EXPIR EQU   VS3AGL+24                                                14656000
VS3AST   EQU   VS3AGL+22                                                14657000
VS3LEVLN EQU   VS3AGL+20                                                14658000
VS3LEVP  EQU   VS3AGL+16                                                14659000
VS3EXDSP EQU   VS3AGL+12                                                14660000
VS3LISTP EQU   VS3AGL+8                                                 14661000
VS3HEAD  EQU   VS3AGL                                                   14662000
@NM00136 EQU   DATESOPT                                                 14663000
DATDAYOP EQU   DATESOPT                                                 14664000
DATDTEOP EQU   DATESOPT                                                 14665000
DATSUB   EQU   DATESOPT                                                 14666000
DATADD   EQU   DATESOPT                                                 14667000
DATRETRN EQU   DATESAGL+16                                              14668000
DATDAYS  EQU   DATESAGL+12                                              14669000
DATDATE  EQU   DATESAGL+8                                               14670000
DATHEAD  EQU   DATESAGL                                                 14671000
@NM00135 EQU   SELFLAGS                                                 14672000
SELVOL   EQU   SELAGL+16                                                14673000
SELDDNP  EQU   SELAGL+12                                                14674000
SELUCBP  EQU   SELAGL+8                                                 14675000
SELHEAD  EQU   SELAGL                                                   14676000
@NM00134 EQU   UCTFLAGS                                                 14677000
UCTVSCAT EQU   UCTFLAGS                                                 14678000
UCTDD    EQU   UCTAGL+60                                                14679000
UCTVOLP  EQU   UCTAGL+56                                                14680000
UCTACBP  EQU   UCTAGL+52                                                14681000
UCTDSN   EQU   UCTAGL+8                                                 14682000
UCTHEAD  EQU   UCTAGL                                                   14683000
@NM00133 EQU   LCTFLAGS                                                 14684000
LCTVSCAT EQU   LCTFLAGS                                                 14685000
LCTOWNER EQU   LCTINFO+24                                               14686000
LCTEXPIR EQU   LCTINFO+20                                               14687000
LCTCREAT EQU   LCTINFO+16                                               14688000
LCTACBP  EQU   LCTINFO+12                                               14689000
LCTMULVC EQU   LCTINFO+8                                                14690000
LCTHEAD  EQU   LCTINFO                                                  14691000
SRTWORKP EQU   SRTAGL+28                                                14692000
SRTFLDLN EQU   SRTAGL+24                                                14693000
SRTPOSIT EQU   SRTAGL+20                                                14694000
SRTLEN   EQU   SRTAGL+16                                                14695000
SRTNUM   EQU   SRTAGL+12                                                14696000
SRTADDR  EQU   SRTAGL+8                                                 14697000
SRTHEAD  EQU   SRTAGL                                                   14698000
SV82DEBP EQU   SV82WRKP                                                 14699000
SV82TTRP EQU   SV82LIST+8                                               14700000
SV82VOLP EQU   SV82DCBP                                                 14701000
SV82UCBP EQU   SV82LIST+1                                               14702000
SV82CODE EQU   SV82LIST                                                 14703000
VOLRESV3 EQU   VOLLABEL+55                                              14704000
VOLOWNER EQU   VOLLABEL+45                                              14705000
VOLRESV1 EQU   VOLLABEL+20                                              14706000
VOLVTOC  EQU   VOLLABEL+15                                              14707000
VOLSECTY EQU   VOLLABEL+14                                              14708000
VOLSERNO EQU   VOLLABEL+8                                               14709000
VOLNO    EQU   VOLLABEL+7                                               14710000
VOLLABI  EQU   VOLLABEL+4                                               14711000
VOLKEY   EQU   VOLLABEL                                                 14712000
STAVTTR  EQU   STAEPARM+54                                              14713000
@NM00130 EQU   STARETRY                                                 14714000
STAVTOC  EQU   STARETRY                                                 14715000
STAOFF   EQU   STARETRY                                                 14716000
STAIO05  EQU   STARETRY                                                 14717000
@NM00129 EQU   STARCVY                                                  14718000
STACLEAR EQU   STARCVY                                                  14719000
STAVPOST EQU   STARCVY                                                  14720000
STAVENQ  EQU   STARCVY                                                  14721000
STAVDMNT EQU   STARCVY                                                  14722000
STAVMNT  EQU   STARCVY                                                  14723000
STATCB   EQU   STAEPARM+48                                              14724000
STARTADD EQU   STAEPARM+44                                              14725000
STAEXSAV EQU   STAEPARM+40                                              14726000
STARTSAV EQU   STAEPARM+36                                              14727000
STARTTR  EQU   STAEPARM+32                                              14728000
@NM00128 EQU   STAEPARM+30                                              14729000
STARVOL  EQU   STAEPARM+24                                              14730000
STARUCB  EQU   STAEPARM+20                                              14731000
@NM00127 EQU   STAEPARM+18                                              14732000
STAVVOL  EQU   STAEPARM+12                                              14733000
STAVUCB  EQU   STAEPARM+8                                               14734000
STAHEAD  EQU   STAEPARM                                                 14735000
RCTDSET  EQU   RCTAGL+32                                                14736000
RCTNVOL  EQU   RCTAGL+26                                                14737000
RCTOVOL  EQU   RCTAGL+20                                                14738000
RCTNDEV  EQU   RCTAGL+16                                                14739000
RCTODEV  EQU   RCTAGL+12                                                14740000
@NM00126 EQU   RCTAGL+10                                                14741000
@NM00125 EQU   RCTOPT                                                   14742000
RCTVOL   EQU   RCTOPT                                                   14743000
RCTDEV   EQU   RCTOPT                                                   14744000
RCTHEAD  EQU   RCTAGL                                                   14745000
@NM00124 EQU   VSRESOPT                                                 14746000
VSREAL   EQU   VSRESOPT                                                 14747000
VSRES    EQU   VSRESOPT                                                 14748000
@NM00123 EQU   VSMSG                                                    14749000
VSTOV    EQU   VSMSG                                                    14750000
VSFROMV  EQU   VSMSG                                                    14751000
@NM00122 EQU   VSRETURN                                                 14752000
VSUCAT   EQU   VSRETURN                                                 14753000
VSVSAM   EQU   VSRETURN                                                 14754000
@NM00121 EQU   VSCATOPT                                                 14755000
VSLIST   EQU   VSCATOPT                                                 14756000
VSSERIAL EQU   VSCATOPT                                                 14757000
VSDEVICE EQU   VSCATOPT                                                 14758000
@NM00120 EQU   VSVTOPT                                                  14759000
VSVSFLAG EQU   VSVTOPT                                                  14760000
VSALTTRK EQU   VSVTOPT                                                  14761000
VSTIME   EQU   VSVTOPT                                                  14762000
VSUCMAST EQU   VSSECOPT                                                 14763000
VSOPCAT  EQU   VSSECOPT                                                 14764000
VSUCTEST EQU   VSSECOPT                                                 14765000
VSWRITE  EQU   VSSECOPT                                                 14766000
VSREAD   EQU   VSSECOPT                                                 14767000
VSNONONV EQU   VSSECOPT                                                 14768000
VSMASTER EQU   VSSECOPT                                                 14769000
VSNOVSAM EQU   VSSECOPT                                                 14770000
VSODEVP  EQU   VS1AGL+64                                                14771000
VSOSERP  EQU   VS1AGL+60                                                14772000
VSDEVP   EQU   VS1AGL+56                                                14773000
VSSERP   EQU   VS1AGL+52                                                14774000
VSPFILEP EQU   VS1AGL+48                                                14775000
VSPSWDP  EQU   VS1AGL+44                                                14776000
VSCATDDP EQU   VS1AGL+40                                                14777000
VSACBP   EQU   VS1AGL+36                                                14778000
VSCATP   EQU   VS1AGL+32                                                14779000
VSNXTATP EQU   VS1AGL+28                                                14780000
VSNUMATP EQU   VS1AGL+24                                                14781000
VSIOP    EQU   VS1AGL+20                                                14782000
VSFILEP  EQU   VS1AGL+16                                                14783000
VSVOLP   EQU   VS1AGL+12                                                14784000
VSUCBP   EQU   VS1AGL+8                                                 14785000
VSHEAD   EQU   VS1AGL                                                   14786000
VSVTOCPT EQU   VS2AGL+48                                                14787000
@NM00119 EQU   VS2AGL+45                                                14788000
VSDDNAME EQU   VS2AGL+37                                                14789000
@NM00118 EQU   VS2RESOP                                                 14790000
VS2REAL  EQU   VS2RESOP                                                 14791000
VS2RES   EQU   VS2RESOP                                                 14792000
@NM00117 EQU   VS2MSG                                                   14793000
VS2TOV   EQU   VS2MSG                                                   14794000
VSVOLUME EQU   VS2AGL+29                                                14795000
@NM00116 EQU   VSLABOPT                                                 14796000
VSNOVTOC EQU   VSLABOPT                                                 14797000
VSVOLSER EQU   VSLABOPT                                                 14798000
VSOWNER  EQU   VSLABOPT                                                 14799000
VSIOBKPT EQU   VS2AGL+24                                                14800000
VSVOLPTR EQU   VS2AGL+20                                                14801000
VSOWNPTR EQU   VS2AGL+16                                                14802000
VSVTOCSZ EQU   VS2AGL+12                                                14803000
VSUCBPTR EQU   VS2AGL+8                                                 14804000
VS2HEAD  EQU   VS2AGL                                                   14805000
EXPDATAL EQU   EXPARRAY+6                                               14806000
@NM00115 EQU   EXPARRAY+5                                               14807000
EXPKEYLN EQU   EXPARRAY+4                                               14808000
EXPDATAP EQU   EXPARRAY                                                 14809000
EXPRECNO EQU   EXPDATAB                                                 14810000
EXPCCHHR EQU   EXPARG+16                                                14811000
EXPCTLBK EQU   EXPARG+8                                                 14812000
EXPHEAD  EQU   EXPARG                                                   14813000
EXRWFUN  EQU   EXWRARG+46                                               14814000
@NM00114 EQU   EXSPACE+8                                                14815000
@NM00113 EQU   EXSPACE+6                                                14816000
@NM00112 EQU   EXSPACE+4                                                14817000
@NM00111 EQU   EXSPACE+1                                                14818000
@NM00110 EQU   EXSPACE                                                  14819000
EXRWKDLN EQU   EXWRARG+32                                               14820000
@NM00109 EQU   EXWRARG+31                                               14821000
EXRECNUM EQU   EXRWCHR+4                                                14822000
EXHH     EQU   EXRWCHR+2                                                14823000
EXCC     EQU   EXRWCHR                                                  14824000
EXCCWCNT EQU   EXWRARG+24                                               14825000
EXLOCPTR EQU   EXWRARG+20                                               14826000
EXRWDARE EQU   EXWRARG+16                                               14827000
EXRWIOAR EQU   EXWRARG+12                                               14828000
EXRWCTBL EQU   EXWRARG+8                                                14829000
EXRWRES  EQU   EXWRARG                                                  14830000
EXGDATAL EQU   EXGARG+30                                                14831000
@NM00108 EQU   EXGARG+29                                                14832000
EXGKEYLN EQU   EXGARG+28                                                14833000
EXGDATAP EQU   EXGARG+24                                                14834000
EXGRECNO EQU   EXGARG+20                                                14835000
EXGCCHH2 EQU   EXGARG+16                                                14836000
EXGCCHH1 EQU   EXGARG+12                                                14837000
EXGCTLBK EQU   EXGARG+8                                                 14838000
EXGHEAD  EQU   EXGARG                                                   14839000
@NM00107 EQU   EXFLG                                                    14840000
@NM00106 EQU   EXOPT                                                    14841000
EXOVTOC  EQU   EXOPT                                                    14842000
EXONEW   EQU   EXOPT                                                    14843000
EXOPASS  EQU   EXOPT                                                    14844000
EXOLAB   EQU   EXOPT                                                    14845000
EXOTAB   EQU   EXOPT                                                    14846000
EXOVSN   EQU   EXOARG+16                                                14847000
EXOHEAD  EQU   EXOARG                                                   14848000
@NM00105 EQU   EXCLFLAG                                                 14849000
EXCLMNT  EQU   EXCLFLAG                                                 14850000
EXCLVOL  EQU   EXCLAGL+16                                               14851000
EXCLDDP  EQU   EXCLAGL+12                                               14852000
EXCLUCBP EQU   EXCLAGL+8                                                14853000
EXCLHEAD EQU   EXCLAGL                                                  14854000
@NM00104 EQU   CKFLAGS                                                  14855000
CKDMTABL EQU   CKFLAGS                                                  14856000
CKRETTYP EQU   CKFLAGS                                                  14857000
CKTESTVT EQU   CKFLAGS                                                  14858000
CKLABELP EQU   CKAGL+24                                                 14859000
CKDATYPE EQU   CKAGL+20                                                 14860000
CKDDNAME EQU   CKAGL+12                                                 14861000
CKUCBPTR EQU   CKAGL+8                                                  14862000
CKHEAD   EQU   CKAGL                                                    14863000
PULABELP EQU   PUAGL+16                                                 14864000
PUTTRPTR EQU   PUAGL+12                                                 14865000
PUUCBPTR EQU   PUAGL+8                                                  14866000
PUHEAD   EQU   PUAGL                                                    14867000
MDR      EQU   MDVTOC+4                                                 14868000
MDHH     EQU   MDVTOC+2                                                 14869000
MDCC     EQU   MDVTOC                                                   14870000
@NM00103 EQU   MDAGL+31                                                 14871000
MDVTOCTR EQU   MDFLAGS                                                  14872000
MDFORCE  EQU   MDFLAGS                                                  14873000
MDDEQ    EQU   MDFLAGS                                                  14874000
MDENQ    EQU   MDFLAGS                                                  14875000
MDWAIT   EQU   MDFLAGS                                                  14876000
MDPOST   EQU   MDFLAGS                                                  14877000
MDCLEAR  EQU   MDFLAGS                                                  14878000
MDNEWVOL EQU   MDFLAGS                                                  14879000
MDLABEL  EQU   MDAGL+24                                                 14880000
MDPUAGL  EQU   MDAGL+20                                                 14881000
MDDDNAME EQU   MDAGL+12                                                 14882000
MDUCBPTR EQU   MDAGL+8                                                  14883000
MDHEAD   EQU   MDAGL                                                    14884000
CTTBLRR  EQU   CTARRAY+3                                                14885000
CTTBLHH  EQU   CTARRAY+2                                                14886000
CTTBLCC  EQU   CTARRAY+1                                                14887000
CTTBLID  EQU   CTARRAY                                                  14888000
CTREALH  EQU   CTMSG+3                                                  14889000
CTREALCC EQU   CTMSG+1                                                  14890000
@NM00102 EQU   CTMSG                                                    14891000
CMCSN2   EQU   CMMSG+28                                                 14892000
CMCSN1   EQU   CMMSG+16                                                 14893000
CMNUMCRT EQU   CMMSG+15                                                 14894000
@NM00101 EQU   CMMSG+14                                                 14895000
CMNEWVOL EQU   CMMSG+8                                                  14896000
@NM00100 EQU   CMMSG+7                                                  14897000
@NM00099 EQU   CMVOLFLG                                                 14898000
CMRONLY  EQU   CMVOLFLG                                                 14899000
CMBIND   EQU   CMVOLFLG                                                 14900000
CMSCRCRT EQU   CMVOLFLG                                                 14901000
CMEXCL   EQU   CMVOLFLG                                                 14902000
CMDERAS  EQU   CMVOLFLG                                                 14903000
CMSCRVOL EQU   CMVOLFLG                                                 14904000
CMCECART EQU   CMVOLFLG                                                 14905000
CMOLDVOL EQU   CMMSG                                                    14906000
CCOLDCSN EQU   CCMSG+24                                                 14907000
CCNEWCSN EQU   CCMSG+12                                                 14908000
@NM00098 EQU   CCMSG+10                                                 14909000
CCVOL    EQU   CCMSG+4                                                  14910000
@NM00097 EQU   CCMSG+2                                                  14911000
CCEJCODE EQU   CCMSG+1                                                  14912000
CCPSTCDE EQU   CCMSG                                                    14913000
IDBYTES  EQU   LINKAGES                                                 14914000
@NM00088 EQU   IHADCS44+10                                              14915000
DCBXENDA EQU   IHADCS44+8                                               14916000
DCBCENDA EQU   IHADCS44+6                                               14917000
DCBSIOA  EQU   IHADCS44+4                                               14918000
DCBPCIA  EQU   IHADCS44+2                                               14919000
DCBEOEA  EQU   IHADCS44                                                 14920000
@NM00087 EQU   IHADCS28+1                                               14921000
@NM00086 EQU   DCBOPTCD                                                 14922000
DCBSRCHD EQU   DCBOPTZ                                                  14923000
@NM00085 EQU   DCBOPTCD                                                 14924000
DCBDEBA  EQU   DCBDEBAD+1                                               14925000
@NM00084 EQU   DCBIFLGS                                                 14926000
DCBIFIOE EQU   DCBIFLGS                                                 14927000
DCBCH12  EQU   DCBIFPCT                                                 14928000
DCBCH9   EQU   DCBIFPCT                                                 14929000
DCBIFEC  EQU   DCBIFLGS                                                 14930000
DCBMFSTI EQU   DCBMFDMD                                                 14931000
DCBMFAWR EQU   DCBMFSTK                                                 14932000
DCBMFUIP EQU   DCBMFTMD                                                 14933000
DCBMFIDW EQU   DCBMFLCP                                                 14934000
DCBMFWRK EQU   DCBMFMVP                                                 14935000
DCBMFRDQ EQU   DCBMFWRT                                                 14936000
DCBMFGTQ EQU   DCBMFPUT                                                 14937000
DCBMFSTL EQU   DCBMACF2                                                 14938000
DCBMFCK  EQU   DCBMFDMG                                                 14939000
DCBMFRDX EQU   DCBMFCHK                                                 14940000
DCBMFDBF EQU   DCBMFSBG                                                 14941000
DCBMFRDI EQU   DCBMFLCG                                                 14942000
DCBMFRDK EQU   DCBMFMVG                                                 14943000
DCBMFWRQ EQU   DCBMFRD                                                  14944000
DCBMFPTQ EQU   DCBMFGET                                                 14945000
DCBMFECP EQU   DCBMACF1                                                 14946000
DCBTIOT  EQU   IHADCS25                                                 14947000
DCBMRSTI EQU   DCBMRDMD                                                 14948000
DCBMRAWR EQU   DCBMRSTK                                                 14949000
DCBMRUIP EQU   DCBMRTMD                                                 14950000
DCBMRIDW EQU   DCBMRLCP                                                 14951000
DCBMRWRK EQU   DCBMRMVP                                                 14952000
DCBMRRDQ EQU   DCBMRWRT                                                 14953000
DCBMRGTQ EQU   DCBMRPUT                                                 14954000
DCBMRSTL EQU   DCBMACR2                                                 14955000
DCBMRCK  EQU   DCBMRDMG                                                 14956000
DCBPGFXA EQU   DCBMRRDX                                                 14957000
DCBMRDBF EQU   DCBMRSBG                                                 14958000
DCBMRRDI EQU   DCBMRLCG                                                 14959000
DCBMRRDK EQU   DCBMRMVG                                                 14960000
DCBMRWRQ EQU   DCBMRRD                                                  14961000
DCBMRPTQ EQU   DCBMRGET                                                 14962000
DCBMRECP EQU   DCBMACR1                                                 14963000
@NM00083 EQU   DCBIFLG                                                  14964000
DCBIBIOE EQU   DCBIFLG                                                  14965000
DCBICH12 EQU   DCBIBPCT                                                 14966000
DCBICH9  EQU   DCBIBPCT                                                 14967000
DCBIBEC  EQU   DCBIFLG                                                  14968000
DCBOFIOF EQU   DCBOFLGS                                                 14969000
DCBOFUEX EQU   DCBOFLGS                                                 14970000
DCBOFTM  EQU   DCBOFLGS                                                 14971000
DCBOFPPC EQU   DCBOFLGS                                                 14972000
DCBOFOPN EQU   DCBOFLGS                                                 14973000
DCBOFEOV EQU   DCBOFLGS                                                 14974000
DCBOFLRB EQU   DCBOFLGS                                                 14975000
DCBOFIOD EQU   DCBOFLWR                                                 14976000
DCBDDNAM EQU   IHADCS24                                                 14977000
DCBEXLSA EQU   DCBEXLST+1                                               14978000
DCBRECKL EQU   DCBRECFM                                                 14979000
DCBRECCC EQU   DCBRECFM                                                 14980000
DCBRECSB EQU   DCBRECFM                                                 14981000
DCBRECBR EQU   DCBRECFM                                                 14982000
DCBRECTO EQU   DCBRECLA                                                 14983000
DCBRECL  EQU   DCBRECLA                                                 14984000
DCBEODA  EQU   DCBEODAD+1                                               14985000
DCBBFA   EQU   DCBBFTEK                                                 14986000
DCBH0    EQU   DCBBFTEK                                                 14987000
DCBBFTKD EQU   DCBBFTEK                                                 14988000
DCBBFTE  EQU   DCBBFT                                                   14989000
DCBBFTKR EQU   DCBBFT                                                   14990000
DCBBFTS  EQU   DCBBFT                                                   14991000
DCBH1    EQU   DCBBFTEK                                                 14992000
DCBSVCXA EQU   DCBSVCXL+1                                               14993000
@NM00082 EQU   DCBSVCXL                                                 14994000
DCBODEBA EQU   DCBIOBAA                                                 14995000
@NM00081 EQU   DCBQSLM                                                  14996000
DCBUPDBT EQU   DCBQSLM                                                  14997000
DCBUPDCM EQU   DCBQSLM                                                  14998000
DCB1DVDS EQU   DCBQSLM                                                  14999000
@NM00080 EQU   DCBDSRG2                                                 15000000
DCBDSGTR EQU   DCBDSRG2                                                 15001000
DCBACBM  EQU   DCBDSRG2                                                 15002000
@NM00079 EQU   DCBDSRG2                                                 15003000
DCBDSGTQ EQU   DCBDSRG2                                                 15004000
DCBDSGTX EQU   DCBDSRG2                                                 15005000
DCBDSGGS EQU   DCBDSRG2                                                 15006000
DCBDSGU  EQU   DCBDSRG1                                                 15007000
DCBDSGPO EQU   DCBDSRG1                                                 15008000
@NM00078 EQU   DCBDSRG1                                                 15009000
@NM00077 EQU   DCBDSRG1                                                 15010000
DCBDSGCX EQU   DCBDSRG1                                                 15011000
DCBDSGDA EQU   DCBDSRG1                                                 15012000
DCBDSGPS EQU   DCBDSRG1                                                 15013000
DCBDSGIS EQU   DCBDSRG1                                                 15014000
DCBBUFL  EQU   IHADCS11+8                                               15015000
DCBBUFCA EQU   DCBBUFCB+1                                               15016000
DCBBUFNO EQU   DCBBUFCB                                                 15017000
DCBDEVT  EQU   DCBREL                                                   15018000
DCBKEYLE EQU   DCBRELB                                                  15019000
DCBTRBAL EQU   IHADCS01+6                                               15020000
@NM00076 EQU   IHADCS01+5                                               15021000
@NM00075 EQU   IHADCS01+4                                               15022000
DCBDVTBA EQU   DCBDVTBL+1                                               15023000
@NM00074 EQU   DCBDVTBL                                                 15024000
DCBKEYCN EQU   IHADCS00+4                                               15025000
DCBRELAD EQU   IHADCS00                                                 15026000
@NM00073 EQU   IHADCB                                                   15027000
WKEYDAT  EQU   WBUF+8                                                   15028000
WBDL     EQU   WBUFCNT+6                                                15029000
WBKL     EQU   WBUFCNT+5                                                15030000
WBREC    EQU   WBCCHHR+4                                                15031000
WBHH     EQU   WBCCHHR+2                                                15032000
WBCC     EQU   WBCCHHR                                                  15033000
WBUFF    EQU   WIOAREA+4                                                15034000
WNUMREC  EQU   WIOAREA                                                  15035000
RKEYDAT  EQU   RBUF+8                                                   15036000
RBDL     EQU   RBUFCNT+6                                                15037000
RBKL     EQU   RBUFCNT+5                                                15038000
RBREC    EQU   RBCCHHR+4                                                15039000
RBHH     EQU   RBCCHHR+2                                                15040000
RBCC     EQU   RBCCHHR                                                  15041000
@NM00072 EQU   RKEYFLG+4                                                15042000
RKEYFLG3 EQU   RKEYFLG+3                                                15043000
RKEYFLG2 EQU   RKEYFLG+1                                                15044000
RKEYFLG1 EQU   RKEYFLG                                                  15045000
RKEYR    EQU   RKEYCHR+4                                                15046000
RKEYHH   EQU   RKEYCHR+2                                                15047000
RKEYCC   EQU   RKEYCHR                                                  15048000
RKEYVOL  EQU   RKEY                                                     15049000
RBUFF    EQU   RIOAREA+282                                              15050000
@NM00071 EQU   RIOHDR+26                                                15051000
@NM00070 EQU   RIOHDR+10                                                15052000
@NM00069 EQU   RIOHDR+7                                                 15053000
RPREVR   EQU   RPREV+4                                                  15054000
@NM00068 EQU   RIOHDR+1                                                 15055000
@NM00067 EQU   LOCTAB+16                                                15056000
LOCCNTFD EQU   LOCTAB+8                                                 15057000
RWFRKD   EQU   RWFR+24                                                  15058000
RWFRDLN  EQU   RWFRCNT+6                                                15059000
RWFRKLN  EQU   RWFRCNT+5                                                15060000
RWFRR    EQU   RWFRCNT+4                                                15061000
RWFRHH   EQU   RWFRCNT+2                                                15062000
RWFRCC   EQU   RWFRCNT                                                  15063000
RWFRFLG  EQU   RWFR+11                                                  15064000
RWFRKEY  EQU   RWFR                                                     15065000
@NM00064 EQU   XTNTENT+75                                               15066000
XTNTR2   EQU   XTNTCHR2+4                                               15067000
XTNTHH2  EQU   XTNTCHR2+2                                               15068000
XTNTCC2  EQU   XTNTCHR2                                                 15069000
@NM00063 EQU   XTNTENT+67                                               15070000
XTNTR1   EQU   XTNTCHR1+4                                               15071000
XTNTHH1  EQU   XTNTCHR1+2                                               15072000
XTNTCC1  EQU   XTNTCHR1                                                 15073000
@NM00062 EQU   XTNTENT+59                                               15074000
@NM00061 EQU   XTNTHDR+85                                               15075000
@NM00060 EQU   XTNTHDR+81                                               15076000
XTNHR2   EQU   XTNHCHR2+4                                               15077000
XTNHHH2  EQU   XTNHCHR2+2                                               15078000
XTNHCC2  EQU   XTNHCHR2                                                 15079000
@NM00059 EQU   XTNTHDR+73                                               15080000
XTNHR1   EQU   XTNHCHR1+4                                               15081000
XTNHHH1  EQU   XTNHCHR1+2                                               15082000
XTNHCC1  EQU   XTNHCHR1                                                 15083000
@NM00058 EQU   XTNTHDR+59                                               15084000
XTN2DSN  EQU   XTN2ENT                                                  15085000
DEVWORD5 EQU   DEVAREA+20                                               15086000
@NM00057 EQU   DEV4B1+1                                                 15087000
@NM00056 EQU   DEV4B1                                                   15088000
INF4FLG  EQU   DEV4B1                                                   15089000
@NM00055 EQU   DEV4B1                                                   15090000
DEVKC    EQU   DEVWORD4                                                 15091000
DEVBOH2  EQU   DEVBOH+1                                                 15092000
DEVBOH1  EQU   DEVBOH                                                   15093000
DEVMAXBK EQU   DEVAREA+4                                                15094000
DEVTBYT4 EQU   DEVDEVTP+3                                               15095000
DEVTBYT3 EQU   DEVDEVTP+2                                               15096000
@NM00053 EQU   DEVTBYT2                                                 15097000
@NM00052 EQU   DEVTBYT2                                                 15098000
DEVTBYT1 EQU   DEVDEVTP                                                 15099000
INFVOLLN EQU   INFOVOL+2                                                15100000
INFVOLID EQU   INFOVOL                                                  15101000
INFDSNLN EQU   INFODSN+2                                                15102000
RDFUNC   EQU   RDARG+46                                                 15103000
@NM00051 EQU   RDSPACE+8                                                15104000
@NM00050 EQU   RDSPACE+6                                                15105000
@NM00049 EQU   RDSPACE+4                                                15106000
@NM00048 EQU   RDSPACE+1                                                15107000
@NM00047 EQU   RDSPACE                                                  15108000
RDCTLBK  EQU   RDARG+8                                                  15109000
RDRES    EQU   RDARG                                                    15110000
@NM00046 EQU   RWHDRINF+1                                               15111000
RWFKCHR2 EQU   RWFKEY2+6                                                15112000
RWFKVOL2 EQU   RWFKEY2                                                  15113000
RWFKCHR1 EQU   RWFKEY1+6                                                15114000
RWFKVOL1 EQU   RWFKEY1                                                  15115000
RWFVOL   EQU   RWFINFO+52                                               15116000
RWFDSN   EQU   RWFINFO+8                                                15117000
RWFDDN   EQU   RWFINFO                                                  15118000
SRCCHHRP EQU   SRPRTARG+40                                              15119000
SRRECPTR EQU   SRPRTARG+36                                              15120000
SRSPRECL EQU   SRPRTARG+32                                              15121000
SRDSNPTR EQU   SRPRTARG+28                                              15122000
SRERCODE EQU   SRPRTARG+24                                              15123000
SRRWFKEY EQU   SRPRTARG+20                                              15124000
SRRWFDSN EQU   SRPRTARG+16                                              15125000
SRVOLPTR EQU   SRPRTARG+12                                              15126000
SRDSNHDR EQU   SRPRTARG+8                                               15127000
SRVREPTR EQU   SRPRTARG+4                                               15128000
SRVRECL  EQU   SRPRTARG                                                 15129000
RWFHFM   EQU   RWFHDR+99                                                15130000
RWFHDSNR EQU   RWFHDR+11                                                15131000
RWFHKEY  EQU   RWFHDR                                                   15132000
MODVOLEN EQU   MODVO+20                                                 15133000
MODVOMEM EQU   MODVO+12                                                 15134000
MODVOMLN EQU   MODVO+11                                                 15135000
MODVOFUQ EQU   MODVOFLG                                                 15136000
MODVOPOS EQU   MODVO+9                                                  15137000
MODVOPAS EQU   MODVO+1                                                  15138000
MODVOPLN EQU   MODVO                                                    15139000
MORCHVAL EQU   MORCH+1                                                  15140000
MORCHLEN EQU   MORCH                                                    15141000
MORVOVAL EQU   MORVO+21                                                 15142000
MORVOLEN EQU   MORVO+20                                                 15143000
MORVOMEM EQU   MORVO+12                                                 15144000
MORVOMLN EQU   MORVO+11                                                 15145000
MORVOFUQ EQU   MORVOFLG                                                 15146000
MORVOPOS EQU   MORVO+9                                                  15147000
MORVOPAS EQU   MORVO+1                                                  15148000
MORVOPLN EQU   MORVO                                                    15149000
MNKSTVAL EQU   MNKST+1                                                  15150000
MNKSTLEN EQU   MNKST                                                    15151000
MNKOFVAL EQU   MNKOF                                                    15152000
MNDSTVAL EQU   MNDST+1                                                  15153000
MNDSTLEN EQU   MNDST                                                    15154000
MNDOFVAL EQU   MNDOF                                                    15155000
MRRHHVAL EQU   MRRHH+1                                                  15156000
MRRHHLEN EQU   MRRHH                                                    15157000
MRRCHVAL EQU   MRRCH+1                                                  15158000
MRRCHLEN EQU   MRRCH                                                    15159000
MRRVOVAL EQU   MRRVO+21                                                 15160000
MRRVOLEN EQU   MRRVO+20                                                 15161000
MRRVOMEM EQU   MRRVO+12                                                 15162000
MRRVOMLN EQU   MRRVO+11                                                 15163000
MRRVOFUQ EQU   MRRVOFLG                                                 15164000
MRRVOPOS EQU   MRRVO+9                                                  15165000
MRRVOPAS EQU   MRRVO+1                                                  15166000
MRRVOPLN EQU   MRRVO                                                    15167000
MIDVOLEN EQU   MIDVO+20                                                 15168000
MIDVOMEM EQU   MIDVO+12                                                 15169000
MIDVOMLN EQU   MIDVO+11                                                 15170000
MIDVOFUQ EQU   MIDVOFLG                                                 15171000
MIDVOPOS EQU   MIDVO+9                                                  15172000
MIDVOPAS EQU   MIDVO+1                                                  15173000
MIDVOPLN EQU   MIDVO                                                    15174000
MIRCHVAL EQU   MIRCH+1                                                  15175000
MIRCHLEN EQU   MIRCH                                                    15176000
MIRVOVAL EQU   MIRVO+21                                                 15177000
MIRVOLEN EQU   MIRVO+20                                                 15178000
MIRVOMEM EQU   MIRVO+12                                                 15179000
MIRVOMLN EQU   MIRVO+11                                                 15180000
MIRVOFUQ EQU   MIRVOFLG                                                 15181000
MIRVOPOS EQU   MIRVO+9                                                  15182000
MIRVOPAS EQU   MIRVO+1                                                  15183000
MIRVOPLN EQU   MIRVO                                                    15184000
MVTCSLEN EQU   MVTCS+20                                                 15185000
MVTCSMEM EQU   MVTCS+12                                                 15186000
MVTCSMLN EQU   MVTCS+11                                                 15187000
MVTCSFUQ EQU   MVTCSFLG                                                 15188000
MVTCSPOS EQU   MVTCS+9                                                  15189000
MVTCSPAS EQU   MVTCS+1                                                  15190000
MVTCSPLN EQU   MVTCS                                                    15191000
MODSLEN  EQU   MODS+20                                                  15192000
MODSMEM  EQU   MODS+12                                                  15193000
MODSMLN  EQU   MODS+11                                                  15194000
MODSFUQ  EQU   MODSFLG                                                  15195000
MODSPOS  EQU   MODS+9                                                   15196000
MODSPLN  EQU   MODS                                                     15197000
MOUTFLEN EQU   MOUTF+9                                                  15198000
MOUTFPLN EQU   MOUTF                                                    15199000
MINDSLEN EQU   MINDS+20                                                 15200000
MINDSMEM EQU   MINDS+12                                                 15201000
MINDSMLN EQU   MINDS+11                                                 15202000
MINDSFUQ EQU   MINDSFLG                                                 15203000
MINDSPOS EQU   MINDS+9                                                  15204000
MINDSPLN EQU   MINDS                                                    15205000
MINFLLEN EQU   MINFL+9                                                  15206000
MINFLPLN EQU   MINFL                                                    15207000
MNCNTVAL EQU   MNCNT+1                                                  15208000
MNCNTLEN EQU   MNCNT                                                    15209000
DBDATVAL EQU   DBDAT                                                    15210000
DBKEYVAL EQU   DBKEY                                                    15211000
DBHHHVAL EQU   DBHHH+1                                                  15212000
DBHHHLEN EQU   DBHHH                                                    15213000
DBCCHVAL EQU   DBCCH+1                                                  15214000
DBCCHLEN EQU   DBCCH                                                    15215000
DBVOLVAL EQU   DBVOL+21                                                 15216000
DBVOLLEN EQU   DBVOL+20                                                 15217000
DBVOLMEM EQU   DBVOL+12                                                 15218000
DBVOLMLN EQU   DBVOL+11                                                 15219000
DBVOLFUQ EQU   DBVOLFLG                                                 15220000
DBVOLPOS EQU   DBVOL+9                                                  15221000
DBVOLPAS EQU   DBVOL+1                                                  15222000
DBVOLPLN EQU   DBVOL                                                    15223000
DBDSVAL  EQU   DBDS+21                                                  15224000
DBDSLEN  EQU   DBDS+20                                                  15225000
DBDSMEM  EQU   DBDS+12                                                  15226000
DBDSMLN  EQU   DBDS+11                                                  15227000
DBDSFUQ  EQU   DBDSFLG                                                  15228000
DBDSPOS  EQU   DBDS+9                                                   15229000
DBDSPAS  EQU   DBDS+1                                                   15230000
DBDSPLN  EQU   DBDS                                                     15231000
DBFILVAL EQU   DBFIL+10                                                 15232000
DBFILLEN EQU   DBFIL+9                                                  15233000
DBFILPAS EQU   DBFIL+1                                                  15234000
DBFILPLN EQU   DBFIL                                                    15235000
CVTCSLEN EQU   CVTCS+20                                                 15236000
CVTCSMEM EQU   CVTCS+12                                                 15237000
CVTCSMLN EQU   CVTCS+11                                                 15238000
CVTCSFUQ EQU   CVTCSFLG                                                 15239000
CVTCSPOS EQU   CVTCS+9                                                  15240000
CVTCSPAS EQU   CVTCS+1                                                  15241000
CVTCSPLN EQU   CVTCS                                                    15242000
CDATLVAL EQU   CDATL                                                    15243000
CKEYLVAL EQU   CKEYL                                                    15244000
CVOLSLEN EQU   CVOLS+20                                                 15245000
CVOLSMEM EQU   CVOLS+12                                                 15246000
CVOLSMLN EQU   CVOLS+11                                                 15247000
CVOLSFUQ EQU   CVOLSFLG                                                 15248000
CVOLSPOS EQU   CVOLS+9                                                  15249000
CVOLSPAS EQU   CVOLS+1                                                  15250000
CVOLSPLN EQU   CVOLS                                                    15251000
CVOLDLEN EQU   CVOLD+20                                                 15252000
CVOLDMEM EQU   CVOLD+12                                                 15253000
CVOLDMLN EQU   CVOLD+11                                                 15254000
CVOLDFUQ EQU   CVOLDFLG                                                 15255000
CVOLDPOS EQU   CVOLD+9                                                  15256000
CVOLDPAS EQU   CVOLD+1                                                  15257000
CVOLDPLN EQU   CVOLD                                                    15258000
CCATLVAL EQU   CCATL+21                                                 15259000
CCATLLEN EQU   CCATL+20                                                 15260000
CCATLMEM EQU   CCATL+12                                                 15261000
CCATLMLN EQU   CCATL+11                                                 15262000
CCATLFUQ EQU   CCATLFLG                                                 15263000
CCATLPOS EQU   CCATL+9                                                  15264000
CCATLPAS EQU   CCATL+1                                                  15265000
CCATLPLN EQU   CCATL                                                    15266000
COFILVAL EQU   COFIL+10                                                 15267000
COFILLEN EQU   COFIL+9                                                  15268000
COFILPAS EQU   COFIL+1                                                  15269000
COFILPLN EQU   COFIL                                                    15270000
CINDSLEN EQU   CINDS+20                                                 15271000
CINDSMEM EQU   CINDS+12                                                 15272000
CINDSMLN EQU   CINDS+11                                                 15273000
CINDSFUQ EQU   CINDSFLG                                                 15274000
CINDSPOS EQU   CINDS+9                                                  15275000
CINDSPLN EQU   CINDS                                                    15276000
CINFLLEN EQU   CINFL+9                                                  15277000
CINFLPLN EQU   CINFL                                                    15278000
DVTCSLEN EQU   DVTCS+20                                                 15279000
DVTCSMEM EQU   DVTCS+12                                                 15280000
DVTCSMLN EQU   DVTCS+11                                                 15281000
DVTCSFUQ EQU   DVTCSFLG                                                 15282000
DVTCSPOS EQU   DVTCS+9                                                  15283000
DVTCSPAS EQU   DVTCS+1                                                  15284000
DVTCSPLN EQU   DVTCS                                                    15285000
DATALVAL EQU   DATAL                                                    15286000
DKEYLVAL EQU   DKEYL                                                    15287000
RRCHHVAL EQU   RRCHH+1                                                  15288000
RRCHHLEN EQU   RRCHH                                                    15289000
RRCHRVAL EQU   RRCHR+1                                                  15290000
RRCHRLEN EQU   RRCHR                                                    15291000
VOLRRVAL EQU   VOLRR+21                                                 15292000
VOLRRLEN EQU   VOLRR+20                                                 15293000
VOLRRMEM EQU   VOLRR+12                                                 15294000
VOLRRMLN EQU   VOLRR+11                                                 15295000
VOLRRFUQ EQU   VOLRRFLG                                                 15296000
VOLRRPOS EQU   VOLRR+9                                                  15297000
VOLRRPAS EQU   VOLRR+1                                                  15298000
VOLRRPLN EQU   VOLRR                                                    15299000
VOLDSLEN EQU   VOLDS+20                                                 15300000
VOLDSMEM EQU   VOLDS+12                                                 15301000
VOLDSMLN EQU   VOLDS+11                                                 15302000
VOLDSFUQ EQU   VOLDSFLG                                                 15303000
VOLDSPOS EQU   VOLDS+9                                                  15304000
VOLDSPAS EQU   VOLDS+1                                                  15305000
VOLDSPLN EQU   VOLDS                                                    15306000
VOLSRLEN EQU   VOLSR+20                                                 15307000
VOLSRMEM EQU   VOLSR+12                                                 15308000
VOLSRMLN EQU   VOLSR+11                                                 15309000
VOLSRFUQ EQU   VOLSRFLG                                                 15310000
VOLSRPOS EQU   VOLSR+9                                                  15311000
VOLSRPAS EQU   VOLSR+1                                                  15312000
VOLSRPLN EQU   VOLSR                                                    15313000
DOTDSVAL EQU   DOTDS+21                                                 15314000
DOTDSLEN EQU   DOTDS+20                                                 15315000
DOTDSMEM EQU   DOTDS+12                                                 15316000
DOTDSMLN EQU   DOTDS+11                                                 15317000
DOTDSFUQ EQU   DOTDSFLG                                                 15318000
DOTDSPOS EQU   DOTDS+9                                                  15319000
DOTDSPAS EQU   DOTDS+1                                                  15320000
DOTDSPLN EQU   DOTDS                                                    15321000
DOUTFVAL EQU   DOUTF+10                                                 15322000
DOUTFLEN EQU   DOUTF+9                                                  15323000
DOUTFPAS EQU   DOUTF+1                                                  15324000
DOUTFPLN EQU   DOUTF                                                    15325000
INDSLEN  EQU   INDS+20                                                  15326000
INDSMEM  EQU   INDS+12                                                  15327000
INDSMLN  EQU   INDS+11                                                  15328000
INDSFUQ  EQU   INDSFLG                                                  15329000
INDSPOS  EQU   INDS+9                                                   15330000
INDSPLN  EQU   INDS                                                     15331000
INFILLEN EQU   INFIL+9                                                  15332000
INFILPLN EQU   INFIL                                                    15333000
@NM00037 EQU   DMPARY+15                                                15334000
DMPARYTP EQU   DMPARY+14                                                15335000
DMPARYEX EQU   DMPARY+12                                                15336000
DMPARYIC EQU   DMPARY+10                                                15337000
DMPARYSZ EQU   DMPARY+8                                                 15338000
DMPARYNM EQU   DMPARY                                                   15339000
@NM00036 EQU   DMPITM+15                                                15340000
DMPITMTP EQU   DMPITM+14                                                15341000
DMPITMLN EQU   DMPITM+12                                                15342000
DMPITMPT EQU   DMPITM+8                                                 15343000
DMPITMNM EQU   DMPITM                                                   15344000
@NM00035 EQU   ERCNVTAB+24                                              15345000
ERCPLPT  EQU   ERCNVTAB+20                                              15346000
ERCATRC  EQU   ERCNVTAB+16                                              15347000
ERDSNM   EQU   ERCNVTAB+12                                              15348000
@NM00034 EQU   ERCNVTAB+4                                               15349000
@NM00033 EQU   ERCNVTAB+3                                               15350000
@NM00032 EQU   EROSOPER                                                 15351000
EROSUCDX EQU   EROSOPER                                                 15352000
EROSCATL EQU   EROSOPER                                                 15353000
@NM00031 EQU   EROPER                                                   15354000
ERCATAL  EQU   EROPER                                                   15355000
ERCATDL  EQU   EROPER                                                   15356000
ERCATDE  EQU   EROPER                                                   15357000
ERCATLC  EQU   EROPER                                                   15358000
@NM00030 EQU   ERTYPE                                                   15359000
EROSCAT  EQU   ERTYPE                                                   15360000
ERCATLG  EQU   ERTYPE                                                   15361000
@NM00029 EQU   FMTCNVF+1                                                15362000
FMTAR    EQU   FMTCNVF+1                                                15363000
FMTBS    EQU   FMTCNVF+1                                                15364000
FMTSS    EQU   FMTCNVF+1                                                15365000
FMTAL    EQU   FMTCNVF+1                                                15366000
FMTZS    EQU   FMTCNVF+1                                                15367000
@NM00028 EQU   FMTCNVF                                                  15368000
FMTPU    EQU   FMTCNVF                                                  15369000
FMTBD    EQU   FMTCNVF                                                  15370000
FMTBHD   EQU   FMTCNVF                                                  15371000
FMTBHA   EQU   FMTCNVF                                                  15372000
FMTBH    EQU   FMTCNVF                                                  15373000
FMTOLEN  EQU   FMTLIST+8                                                15374000
FMTRIO   EQU   FMTOCOL                                                  15375000
FMTSPT   EQU   FMTSTO                                                   15376000
FMTSTL   EQU   FMTILEN                                                  15377000
@NM00027 EQU   FMTFLGS+1                                                15378000
FMTHDF   EQU   FMTFLGS                                                  15379000
FMTDFF   EQU   FMTFLGS                                                  15380000
FMTSTF   EQU   FMTFLGS                                                  15381000
FMTREPF  EQU   FMTFLGS                                                  15382000
FMTBDF   EQU   FMTFLGS                                                  15383000
FMTIDF   EQU   FMTFLGS                                                  15384000
FMTSCF   EQU   FMTFLGS                                                  15385000
FMTEOLF  EQU   FMTFLGS                                                  15386000
DARGDTM  EQU   DARGARY+4                                                15387000
DARGPCT  EQU   DARGINL                                                  15388000
DARGREP  EQU   DARGINS                                                  15389000
@NM00026 EQU   DARGLIST+19                                              15390000
DARGIND  EQU   DARGLIST+18                                              15391000
DARGCNT  EQU   DARGLIST+14                                              15392000
DARGILP  EQU   DARGLIST+12                                              15393000
DARGDBP  EQU   DARGLIST                                                 15394000
UVOLVOL  EQU   UVOLENT+4                                                15395000
UVOLDEV  EQU   UVOLENT                                                  15396000
UVOLCNT  EQU   UVOLLIST                                                 15397000
@NM00025 EQU   IOINFOPT                                                 15398000
IOINFTMS EQU   IOINFOPT                                                 15399000
IOINFSUP EQU   IOINFOPT                                                 15400000
IOINFDVT EQU   IOINFOPT                                                 15401000
@NM00024 EQU   OPNAGL+43                                                15402000
@NM00023 EQU   OPNOPT2                                                  15403000
@NM00022 EQU   OPNOPT2                                                  15404000
OPNOPTAS EQU   OPNOPT2                                                  15405000
@NM00021 EQU   OPNDSO                                                   15406000
OPNDSOPO EQU   OPNDSO                                                   15407000
OPNDSOIS EQU   OPNDSO                                                   15408000
OPNREC   EQU   OPNAGL+32                                                15409000
OPNDEVIX EQU   OPNDEV+4                                                 15410000
OPNDEVDT EQU   OPNDEV                                                   15411000
OPNCBP   EQU   OPNAGL+20                                                15412000
OPNMODRP EQU   OPNMOD                                                   15413000
OPNMODUB EQU   OPNMOD                                                   15414000
OPNMODRS EQU   OPNMOD                                                   15415000
OPNMODAX EQU   OPNMOD                                                   15416000
OPNMODRR EQU   OPNMOD                                                   15417000
OPNMODAC EQU   OPNMOD                                                   15418000
OPNMODPD EQU   OPNMOD                                                   15419000
@NM00020 EQU   OPNTYP                                                   15420000
OPNTYPRV EQU   OPNTYP                                                   15421000
OPNTYPEX EQU   OPNTYP                                                   15422000
OPNTYPRA EQU   OPNTYP                                                   15423000
OPNTYPXM EQU   OPNTYP                                                   15424000
OPNTYPCI EQU   OPNTYP                                                   15425000
OPNTYPSO EQU   OPNTYP                                                   15426000
OPNTYPSI EQU   OPNTYP                                                   15427000
@NM00019 EQU   OPNRFM                                                   15428000
OPNRFMBK EQU   OPNRFM                                                   15429000
OPNRFMSF EQU   OPNRFM                                                   15430000
OPNRFMUN EQU   OPNRFM                                                   15431000
OPNRFMVR EQU   OPNRFM                                                   15432000
OPNRFMFX EQU   OPNRFM                                                   15433000
OPNOPTSK EQU   OPNOPT                                                   15434000
OPNOPTDR EQU   OPNOPT                                                   15435000
OPNOPTCR EQU   OPNOPT                                                   15436000
OPNOPTKS EQU   OPNOPT                                                   15437000
OPNOPTUP EQU   OPNOPT                                                   15438000
OPNOPTOT EQU   OPNOPT                                                   15439000
IOCEXT   EQU   IOCSTR+64                                                15440000
IOCREL   EQU   IOCSTR+60                                                15441000
IOCWORK  EQU   IOCSTR+56                                                15442000
IOCRRN   EQU   IOCSTR+52                                                15443000
IOCPNM   EQU   IOCNWM+2                                                 15444000
IOCPTL   EQU   IOCNWM                                                   15445000
IOCKYA   EQU   IOCMEM                                                   15446000
IOCVRC   EQU   IOCTTR                                                   15447000
IOCDSN   EQU   IOCSTR+32                                                15448000
IOCHURBA EQU   IOCSTR+28                                                15449000
IOCVOLSR EQU   IOCSTR+22                                                15450000
@NM00018 EQU   IOCMSG                                                   15451000
IOCMSGAE EQU   IOCMSG                                                   15452000
IOCMSGCE EQU   IOCMSG                                                   15453000
IOCMSGOE EQU   IOCMSG                                                   15454000
@NM00017 EQU   IOCMSG                                                   15455000
IOCCHPSY EQU   IOCCHP                                                   15456000
IOCCHPAS EQU   IOCCHP                                                   15457000
IOCCHPBK EQU   IOCCHP                                                   15458000
IOCCHPCR EQU   IOCCHP                                                   15459000
IOCCHPKS EQU   IOCCHP                                                   15460000
IOCCHPSK EQU   IOCCHP                                                   15461000
IOCCHPDR EQU   IOCCHP                                                   15462000
IOCCHPSQ EQU   IOCCHP                                                   15463000
@NM00016 EQU   IOCMAC2                                                  15464000
IOCMACPA EQU   IOCMAC2                                                  15465000
@NM00015 EQU   IOCMAC2                                                  15466000
IOCMACCP EQU   IOCMAC2                                                  15467000
IOCMACRR EQU   IOCMAC2                                                  15468000
IOCMACAS EQU   IOCMAC2                                                  15469000
IOCMACSK EQU   IOCMAC2                                                  15470000
@NM00014 EQU   IOCMAC                                                   15471000
IOCMACCC EQU   IOCMAC                                                   15472000
IOCMACDR EQU   IOCMAC                                                   15473000
IOCMACBK EQU   IOCMAC                                                   15474000
IOCMACCR EQU   IOCMAC                                                   15475000
IOCMACUP EQU   IOCMAC                                                   15476000
IOCMACOT EQU   IOCMAC                                                   15477000
IOCMACIN EQU   IOCMAC                                                   15478000
@NM00013 EQU   IOCRFM                                                   15479000
IOCRFMBK EQU   IOCRFM                                                   15480000
IOCRFMSF EQU   IOCRFM                                                   15481000
IOCRFMUN EQU   IOCRFM                                                   15482000
IOCRFMVR EQU   IOCRFM                                                   15483000
IOCRFMFX EQU   IOCRFM                                                   15484000
@NM00012 EQU   IOCDSO                                                   15485000
IOCDSOPO EQU   IOCDSO                                                   15486000
IOCDSOIS EQU   IOCDSO                                                   15487000
IOCDSOPS EQU   IOCDSO                                                   15488000
IOCDSOAM EQU   IOCDSO                                                   15489000
IOCRKP   EQU   IOCSTR+13                                                15490000
IOCKYL   EQU   IOCSTR+12                                                15491000
IOCTRN   EQU   IOCSTR+8                                                 15492000
IOCDLN   EQU   IOCSTR+4                                                 15493000
UNITVTOC EQU   UNITABL+7                                                15494000
@NM00011 EQU   UNITSTAT                                                 15495000
UNITUSHR EQU   UNITSTAT                                                 15496000
UNITXSHR EQU   UNITSTAT                                                 15497000
UNITISHR EQU   UNITSTAT                                                 15498000
UNITUA   EQU   @NM00010+1                                               15499000
UNITCHA  EQU   @NM00010                                                 15500000
UNITUCB  EQU   UNITABL                                                  15501000
ALLUNCNT EQU   ALLAGL+30                                                15502000
ALLVLCNT EQU   ALLAGL+29                                                15503000
@NM00009 EQU   ALLOPT                                                   15504000
ALLOPTUN EQU   ALLOPT                                                   15505000
ALLOPTPV EQU   ALLOPT                                                   15506000
@NM00008 EQU   ALLORG+1                                                 15507000
ALLORGVS EQU   ALLORG+1                                                 15508000
@NM00007 EQU   ALLORG+1                                                 15509000
ALLORGGS EQU   ALLORG+1                                                 15510000
ALLORGUN EQU   ALLORG                                                   15511000
ALLORGPO EQU   ALLORG                                                   15512000
ALLORGMQ EQU   ALLORG                                                   15513000
ALLORGCQ EQU   ALLORG                                                   15514000
ALLORGCX EQU   ALLORG                                                   15515000
ALLORGDA EQU   ALLORG                                                   15516000
ALLORGPS EQU   ALLORG                                                   15517000
ALLORGIS EQU   ALLORG                                                   15518000
ALLDSPUN EQU   ALLDSP                                                   15519000
ALLDSPCG EQU   ALLDSP                                                   15520000
ALLDSPDE EQU   ALLDSP                                                   15521000
@NM00006 EQU   ALLDSP                                                   15522000
ALLSTSMD EQU   ALLSTS                                                   15523000
ALLSTSNW EQU   ALLSTS                                                   15524000
ALLSTSSR EQU   ALLSTS                                                   15525000
@NM00005 EQU   ALLSTS                                                   15526000
ALLVLP   EQU   ALLAGL+16                                                15527000
ALLULP   EQU   ALLAGL+12                                                15528000
CIRPID   EQU   CIRAGL+28                                                15529000
CIRPWD   EQU   CIRAGL+24                                                15530000
CIRCAT   EQU   CIRAGL+20                                                15531000
CIRWKP   EQU   CIRAGL+16                                                15532000
CIRTLR   EQU   CIRAGL+12                                                15533000
CIRHDR   EQU   CIRAGL+8                                                 15534000
CIRTLN   EQU   CIRAGL+6                                                 15535000
CIRHLN   EQU   CIRAGL+4                                                 15536000
@NM00004 EQU   CIRAGL+1                                                 15537000
@NM00003 EQU   CIRTYPE                                                  15538000
CIRTYPAQ EQU   CIRTYPE                                                  15539000
CIRTYP1Q EQU   CIRTYPE                                                  15540000
NEWID1   EQU   TRACE1+95                                                15541000
CALLID   EQU   OLDERID1+90                                              15542000
@NM00002 EQU   OLDERID1                                                 15543000
*                                      END UNREFERENCED COMPONENTS      15544000
@RF00543 EQU   @RC00518                                                 15545000
@RC01752 EQU   @RC01748                                                 15546000
@RF01907 EQU   @RC01903                                                 15547000
@RC01925 EQU   @RC01923                                                 15548000
@RF01944 EQU   @RC01923                                                 15549000
@RF01959 EQU   @RC01954                                                 15550000
@RF01971 EQU   @RC01968                                                 15551000
@RC01981 EQU   @RC01980                                                 15552000
@PB00006 EQU   @EL00001                                                 15553000
@RC01926 EQU   @RC01925                                                 15554000
@PB00004 EQU   @PB00006                                                 15555000
@PB00002 EQU   @PB00004                                                 15556000
@ENDDATA EQU   *                                                        15557000
         END   IDCRD07,(C'PLS1223',0603,77300)                          15558000
