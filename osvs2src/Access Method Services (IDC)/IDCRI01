         TITLE '*********  IDCRI01:  READER/INTERPRETER MAIN MODULE   **00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCRI01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCRI01   76.310'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @11,4095(,@12)                                      0002 00022000
         LA    @10,4095(,@11)                                      0002 00023000
         LA    @09,4095(,@10)                                      0002 00024000
         LA    @08,4095(,@09)                                      0002 00025000
         LA    @07,4095(,@08)                                      0002 00026000
         USING @PSTART,@12                                         0002 00027000
         USING @PSTART+4095,@11                                    0002 00028000
         USING @PSTART+8190,@10                                    0002 00029000
         USING @PSTART+12285,@09                                   0002 00030000
         USING @PSTART+16380,@08                                   0002 00031000
         USING @PSTART+20475,@07                                   0002 00032000
         L     @00,@SIZDATD                                        0002 00033000
         GETMAIN  R,LV=(0)                                              00034000
         LR    @06,@01                                             0002 00035000
         USING @DATD,@06                                           0002 00036000
         ST    @13,@SA00001+4                                      0002 00037000
         LM    @00,@01,20(@13)                                     0002 00038000
         ST    @06,8(,@13)                                         0002 00039000
         LR    @13,@06                                             0002 00040000
         MVC   @PC00001(24),0(@01)                                 0002 00041000
*        GDTPTR=ADDR(GDTTBLX);                                     0275 00042000
*                                                                  0275 00043000
         L     GDTPTR,@PC00001                                     0275 00044000
*        IF GDTDBG = NULLPTR                                       0276 00045000
*          THEN;                                                   0276 00046000
         ICM   @05,15,GDTDBG(GDTPTR)                               0276 00047000
         BZ    @RT00276                                            0276 00048000
*          ELSE                                                    0278 00049000
*            CALL IDCDB010(GDTTBL,'RIEX');                         0278 00050000
         ST    GDTPTR,@AL00001                                     0278 00051000
         LA    @05,@CC00901                                        0278 00052000
         ST    @05,@AL00001+4                                      0278 00053000
         MVI   @AL00001+4,X'80'                                    0278 00054000
         L     @15,GDTDBG(,GDTPTR)                                 0278 00055000
         LA    @01,@AL00001                                        0278 00056000
         BALR  @14,@15                                             0278 00057000
*        RISTATUS=0;                                               0279 00058000
@RT00276 SLR   @02,@02                                             0279 00059000
         STH   @02,RISTATUS                                        0279 00060000
*        VERBNAME=BLANK;                                           0280 00061000
         MVI   VERBNAME+1,C' '                                     0280 00062000
         MVC   VERBNAME+2(6),VERBNAME+1                            0280 00063000
         MVI   VERBNAME,C' '                                       0280 00064000
*        OPTSFLAG=OFF;                                             0281 00065000
         NI    OPTSFLAG,B'11011111'                                0281 00066000
*        UNITINDX=0;                                       /*@YL026UL*/ 00067000
         SLR   UNITINDX,UNITINDX                                   0282 00068000
*        CHAR1=BLANK;                                              0283 00069000
         MVI   CHAR1,C' '                                          0283 00070000
*        CONTNEXT=NO;                                              0284 00071000
         NI    CONTNEXT,B'11110111'                                0284 00072000
*        VLISTID1='RI';                                            0285 00073000
*                                                                  0285 00074000
         MVC   VLISTID1(2),@CC00902                                0285 00075000
*        DDSTRU=ADDR(PRNTAREA);                                    0286 00076000
         LA    @15,PRNTAREA                                        0286 00077000
         ST    @15,DDSTRU                                          0286 00078000
*        PRNTAREA=''B;                                             0287 00079000
*                                                                  0287 00080000
         XC    PRNTAREA(20),PRNTAREA                               0287 00081000
*        /************************************************************/ 00082000
*        /*                                                          */ 00083000
*        /* STORE INPUT PARAMETER DATA INTO R/I'S OWN DATA AREA      */ 00084000
*        /*                                                          */ 00085000
*        /************************************************************/ 00086000
*        POOLID=SPACEID;                                           0288 00087000
         L     @15,@PC00001+8                                      0288 00088000
         MVC   POOLID(4),SPACEID(@15)                              0288 00089000
*        MAXCC=AMSMAX;                                     /*@YL026UL*/ 00090000
         L     @15,@PC00001+12                                     0289 00091000
         MVC   MAXCC(2),AMSMAX(@15)                                0289 00092000
*        LASTCC=AMSLAST;                                   /*@YL026UL*/ 00093000
*                                                                  0290 00094000
         L     @15,@PC00001+16                                     0290 00095000
         MVC   LASTCC(2),AMSLAST(@15)                              0290 00096000
*        /************************************************************/ 00097000
*        /*                                                          */ 00098000
*        /*  CHECK TO SEE IF R/I INITIALIZATION NEEDS TO BE DONE     */ 00099000
*        /*  AND TERMINATE IF INITIALIZATION WAS NOT COMPLETED OKAY  */ 00100000
*        /*                                                          */ 00101000
*        /************************************************************/ 00102000
*        IF GDTRIH = NULLPTR                                       0291 00103000
*          THEN                                                    0291 00104000
         C     @02,GDTRIH(,GDTPTR)                                 0291 00105000
         BNE   @RF00291                                            0291 00106000
*            DO;                                                   0292 00107000
*                                                                  0292 00108000
*            CALL RIINIT;                                          0293 00109000
*                                                                  0293 00110000
         BAL   @14,RIINIT                                          0293 00111000
*            IF RISTATUS^=0                                        0294 00112000
*              THEN                                                0294 00113000
*                                                                  0294 00114000
         ICM   @02,3,RISTATUS                                      0294 00115000
         BZ    @RF00294                                            0294 00116000
*                CALL IDCRI03(GDTTBL,COMMAREA);            /*@YL026UL*/ 00117000
*                                                                  0295 00118000
         ST    GDTPTR,@AL00001                                     0295 00119000
         LA    @02,COMMAREA                                        0295 00120000
         ST    @02,@AL00001+4                                      0295 00121000
         L     @15,@CV00622                                        0295 00122000
         LA    @01,@AL00001                                        0295 00123000
         BALR  @14,@15                                             0295 00124000
*            END;                                                  0296 00125000
*                                                                  0296 00126000
@RF00294 DS    0H                                                  0297 00127000
*        /************************************************************/ 00128000
*        /*                                                          */ 00129000
*        /* SCAN AND INTERPRET INPUT FUNCTION AND MODAL COMMANDS     */ 00130000
*        /* UNTIL A FUNCTION COMMAND TO BE EXECUTED IS FOUND.  THEN  */ 00131000
*        /* ENCODE THIS COMMAND INTO THE FUNCTION DATA TABLE (FDT).  */ 00132000
*        /*                                                          */ 00133000
*        /************************************************************/ 00134000
*        GOODCMD=NO;                                               0297 00135000
@RF00291 NI    GOODCMD,B'01111111'                                 0297 00136000
*        DO WHILE(RISTATUS=0 & GOODCMD=NO);                        0298 00137000
*                                                                  0298 00138000
         B     @DE00298                                            0298 00139000
@DL00298 DS    0H                                                  0299 00140000
*          CALL SCANCMD;                                           0299 00141000
*                                                                  0299 00142000
         BAL   @14,SCANCMD                                         0299 00143000
*          CALL IDCRI03(GDTTBL,COMMAREA);                  /*@YL026UL*/ 00144000
*                                                                  0300 00145000
         ST    GDTPTR,@AL00001                                     0300 00146000
         LA    @02,COMMAREA                                        0300 00147000
         ST    @02,@AL00001+4                                      0300 00148000
         L     @15,@CV00622                                        0300 00149000
         LA    @01,@AL00001                                        0300 00150000
         BALR  @14,@15                                             0300 00151000
*        END;                                                      0301 00152000
*                                                                  0301 00153000
@DE00298 ICM   @02,3,RISTATUS                                      0301 00154000
         BNZ   @DC00298                                            0301 00155000
         TM    GOODCMD,B'10000000'                                 0301 00156000
         BZ    @DL00298                                            0301 00157000
@DC00298 DS    0H                                                  0302 00158000
*        /************************************************************/ 00159000
*        /*                                                          */ 00160000
*        /* UPDATE PARAMETER DATA, PREPARING TO RETURN TO EXECUTIVE  */ 00161000
*        /*                                                          */ 00162000
*        /************************************************************/ 00163000
*        FDTLOC=FDTADDR;                                           0302 00164000
         L     @02,@PC00001+4                                      0302 00165000
         MVC   FDTLOC(4,@02),FDTADDR                               0302 00166000
*        FUNCNAME=FSRLNAME;                                        0303 00167000
         L     @02,@PC00001+20                                     0303 00168000
         MVC   FUNCNAME(8,@02),FSRLNAME                            0303 00169000
*        AMSMAX=MAXCC;                                     /*@YL026UL*/ 00170000
         L     @02,@PC00001+12                                     0304 00171000
         MVC   AMSMAX(2,@02),MAXCC                                 0304 00172000
*        AMSLAST=LASTCC;                                   /*@YL026UL*/ 00173000
*                                                                  0305 00174000
         L     @02,@PC00001+16                                     0305 00175000
         MVC   AMSLAST(2,@02),LASTCC                               0305 00176000
*        CALL IDCSAEP0(GDTTBL,MODID,RISTATUS);                     0306 00177000
*                                                                  0306 00178000
         ST    GDTPTR,@AL00001                                     0306 00179000
         LA    @02,MODID                                           0306 00180000
         ST    @02,@AL00001+4                                      0306 00181000
         LA    @02,RISTATUS                                        0306 00182000
         ST    @02,@AL00001+8                                      0306 00183000
         MVI   @AL00001+8,X'80'                                    0306 00184000
         L     @15,GDTEPL(,GDTPTR)                                 0306 00185000
         LA    @01,@AL00001                                        0306 00186000
         BALR  @14,@15                                             0306 00187000
*/********************************************************************/ 00188000
*/*                                                                  */ 00189000
*/*  PROCEDURE NAME - RIINIT                                         */ 00190000
*/*                                                                  */ 00191000
*/*  FUNCTION - THIS PROCEDURE OBTAINS AND INITIALIZES SPACE FOR THE */ 00192000
*/*             READER/INTERPRETER HISTORICAL DATA AREA (R/I HDA),   */ 00193000
*/*             OBTAINS SPACE FOR AND SETS UP REFERENCE TO THE UPRINT*/ 00194000
*/*             ARGUMENT STRUCTURE, AND LOADS THE DESCRIPTOR LOAD    */ 00195000
*/*             MODULE NAME TABLE.  FINALLY, IT SETS UP PARAMETER    */ 00196000
*/*             OPTION INPUT IF IT EXISTS.                           */ 00197000
*/*                                                                  */ 00198000
*/*  INPUT -                                                         */ 00199000
*/*          OPTSPTR - POINTER TO PARAMETER OPTIONS STRING           */ 00200000
*/*          OPTSLEN - LENGTH OF PARAMETER OPTIONS STRING            */ 00201000
*/*                                                                  */ 00202000
*/*  OUTPUT -                                                        */ 00203000
*/*          FIRSTCHR- SIGNALS THAT THE LOCATION AND LENGTH OF THE   */ 00204000
*/*                    INPUT CHARACTERS TO BE SCANNED ARE NOT TO BE  */ 00205000
*/*                    FOUND IN THE R/I HDA.                         */ 00206000
*/*          GDTRIH -  POINTER TO R/I HDA.                           */ 00207000
*/*          LEFTMGN - LEFT COMMAND STREAM SOURCE MARGIN TO BE USED  */ 00208000
*/*          RIGHTMGN- RIGHT COMMAND STREAM SOURCE MARGIN TO BE USED */ 00209000
*/*          OPNIOC -  OPEN FLAGS AND POINTERS SET WHEN OPENING THE  */ 00210000
*/*          OPNPTR    COMMAND INPUT STREAM FOR INPUT.               */ 00211000
*/*          OPNAGL                                                  */ 00212000
*/*          OPNTYPSI                                                */ 00213000
*/*          OPTSFLAG- FLAG NOTING THAT PARAMETER OPTIONS ARE        */ 00214000
*/*                    BEING SCANNED.                                */ 00215000
*/*          RECRDPTR- POINTER TO CHARACTER STRING TO BE SCANNED     */ 00216000
*/*          SCNLIMIT- POSITION OF LAST CHARACTER OF THE STRING TO   */ 00217000
*/*                    BE SCANNED.                                   */ 00218000
*/*          CHAR1 -   FIRST CHARACTER OF PARAMETER OPTIONS STRING   */ 00219000
*/*          SCANINDX- POSITION WITHIN CHARACTER STRING BEING        */ 00220000
*/*                    SCANNED AT WHICH TO BEGIN THE SCANNING.       */ 00221000
*/*          VERBNAME- VERB NAME GENERATED WHEN PARAMETER OPTIONS    */ 00222000
*/*                    ARE BEING SCANNED.                            */ 00223000
*/*          LASTCC -  LAST AMS SYSTEM CONDITION CODE                */ 00224000
*/*          RISTATUS- R/I INTERNAL STATUS CODE                      */ 00225000
*/*          LOADTPTR- POINTER TO DESCRIPTOR LOAD MODULE NAME TABLE  */ 00226000
*/*          KWTBLPTR- POINTER TO MODAL COMMAND KEYWORD AND VERB     */ 00227000
*/*                    SYMBOL TABLE                                  */ 00228000
*/*          FINALCHR- SIGNALS THAT EOF HAS NOT BEEN FOUND YET       */ 00229000
*/*                                                                  */ 00230000
*/********************************************************************/ 00231000
*RIINIT: PROCEDURE;                                                0307 00232000
@EL00001 L     @13,4(,@13)                                         0307 00233000
@EF00001 L     @00,@SIZDATD                                        0307 00234000
         LR    @01,@06                                             0307 00235000
         FREEMAIN R,LV=(0),A=(1)                                        00236000
@ER00001 LM    @14,@12,12(@13)                                     0307 00237000
         BR    @14                                                 0307 00238000
RIINIT   STM   @14,@12,@SA00002                                    0307 00239000
*        /************************************************************/ 00240000
*        /*                                                          */ 00241000
*        /* READER/INTERPRETER INITIALIZATION DATA DEFINITIONS       */ 00242000
*        /*                                                          */ 00243000
*        /************************************************************/ 00244000
*                                                                  0308 00245000
*        DCL OPTSPTR PTR(31)           /*POINTER TO PARAMETER OPTIONS*/ 00246000
*                    BASED(GDTPRM);                                0308 00247000
*                                                                  0308 00248000
*        /*PARAMETER OPTIONS CHARACTER STRING                        */ 00249000
*        DCL 1 PARMOPTS CHAR(*) BASED(OPTSPTR) BDY(HWORD),         0309 00250000
*              2 OPTSLEN FIXED(15);    /*LENGTH OF OPTIONS STRING    */ 00251000
*                                                                  0309 00252000
*        DCL LMGNDFLT FIXED(15)        /*LEFT COMMAND MARGIN DEFAULT */ 00253000
*                     CONSTANT(2);                                 0310 00254000
*        DCL RMGNDFLT FIXED(15)        /*RIGHT COMMAND MARGIN DEFAULT*/ 00255000
*                     CONSTANT(72);                                0311 00256000
*        DCL LTBLNAME CHAR(8)          /*LOAD NAME OF THE DESCRIPTOR */ 00257000
*                     INIT('IDCRILT ');/* LOAD MODULE NAME TABLE     */ 00258000
*        DCL KTBLNAME CHAR(8)          /*LOAD NAME OF TABLE OF       */ 00259000
*                     INIT('IDCRIKT ');/* MODAL KEYWORDS             */ 00260000
*        /************************************************************/ 00261000
*        /*                                                          */ 00262000
*        /*  ** RIINIT **  READER/INTERPRETER INITIALIZATION ROUTINE */ 00263000
*        /*                                                          */ 00264000
*        /************************************************************/ 00265000
*                                                                  0314 00266000
*        /************************************************************/ 00267000
*        /*                                                          */ 00268000
*        /*  OBTAIN SPACE FOR THE R/I HISTORICAL DATA AREA AND FOR   */ 00269000
*        /*  THE UPRINT ARGUMENT STRUCTURE , INITIALIZING THE SPACE  */ 00270000
*        /*  TO ZEROES.                                              */ 00271000
*        /*                                                          */ 00272000
*        /************************************************************/ 00273000
*        AMTTOGET=HDASIZE;                                         0314 00274000
*                                                                  0314 00275000
         MVC   AMTTOGET(4),@CF00794                                0314 00276000
*        CALL IDCSAGS0(GDTTBL,AMTTOGET,GDTRIH,SETZERO);            0315 00277000
         ST    GDTPTR,@AL00001                                     0315 00278000
         LA    @02,AMTTOGET                                        0315 00279000
         ST    @02,@AL00001+4                                      0315 00280000
         LA    @02,GDTRIH(,GDTPTR)                                 0315 00281000
         ST    @02,@AL00001+8                                      0315 00282000
         LA    @02,SETZERO                                         0315 00283000
         ST    @02,@AL00001+12                                     0315 00284000
         MVI   @AL00001+12,X'80'                                   0315 00285000
         L     @15,GDTGSP(,GDTPTR)                                 0315 00286000
         LA    @01,@AL00001                                        0315 00287000
         BALR  @14,@15                                             0315 00288000
*        RESPECIFY RTNREG RSTD;                                    0316 00289000
*        TESTRC = RTNREG;                                          0317 00290000
         STH   RTNREG,TESTRC                                       0317 00291000
*        RESPECIFY RTNREG UNRSTD;                                  0318 00292000
*                                                                  0318 00293000
*        IF TESTRC^=0                                              0319 00294000
*          THEN                                                    0319 00295000
         LH    @02,TESTRC                                          0319 00296000
         LTR   @02,@02                                             0319 00297000
         BZ    @RF00319                                            0319 00298000
*            DO;                                                   0320 00299000
*            LASTCC=TERMERR;                                       0321 00300000
         MVC   LASTCC(2),@CH00482                                  0321 00301000
*            RISTATUS=NOSPACE;                                     0322 00302000
         MVC   RISTATUS(2),@CH00811                                0322 00303000
*            END;                                                  0323 00304000
*                                                                  0323 00305000
*          /**********************************************************/ 00306000
*          /*                                                        */ 00307000
*          /* OBTAIN DESCRIPTOR LOAD MODULE NAME TABLE , OBTAIN THE  */ 00308000
*          /* MODAL COMMAND KEYWORD TABLE (CONTAINS THE KEYWORDS TO  */ 00309000
*          /* BE USED FOR MODAL COMMANDS - MAY BE IN ANY LANGUAGE),  */ 00310000
*          /* INITIALIZE COMMAND SOURCE MARGINS, AND OPEN SYSIN FILE.*/ 00311000
*          /*                                                        */ 00312000
*          /**********************************************************/ 00313000
*          ELSE                                                    0324 00314000
*            DO;                                                   0324 00315000
*                                                                  0324 00316000
         B     @RC00319                                            0324 00317000
@RF00319 DS    0H                                                  0325 00318000
*              CALL IDCSALD0(GDTTBL,LTBLNAME,LOADTPTR);            0325 00319000
         ST    GDTPTR,@AL00001                                     0325 00320000
         LA    @15,LTBLNAME                                        0325 00321000
         ST    @15,@AL00001+4                                      0325 00322000
         L     @01,GDTRIH(,GDTPTR)                                 0325 00323000
         LA    @15,LOADTPTR(,@01)                                  0325 00324000
         ST    @15,@AL00001+8                                      0325 00325000
         L     @15,GDTLOD(,GDTPTR)                                 0325 00326000
         LA    @01,@AL00001                                        0325 00327000
         BALR  @14,@15                                             0325 00328000
*              CALL IDCSALD0(GDTTBL,KTBLNAME,KWTBLPTR);            0326 00329000
*                                                                  0326 00330000
         ST    GDTPTR,@AL00001                                     0326 00331000
         LA    @15,KTBLNAME                                        0326 00332000
         ST    @15,@AL00001+4                                      0326 00333000
         L     @01,GDTRIH(,GDTPTR)                                 0326 00334000
         LA    @15,KWTBLPTR(,@01)                                  0326 00335000
         ST    @15,@AL00001+8                                      0326 00336000
         L     @15,GDTLOD(,GDTPTR)                                 0326 00337000
         LA    @01,@AL00001                                        0326 00338000
         BALR  @14,@15                                             0326 00339000
*              LEFTMGN=LMGNDFLT;                                   0327 00340000
         L     @15,GDTRIH(,GDTPTR)                                 0327 00341000
         MVC   LEFTMGN(2,@15),@CH00163                             0327 00342000
*              RIGHTMGN=RMGNDFLT;                                  0328 00343000
*                                                                  0328 00344000
         MVC   RIGHTMGN(2,@15),@CH00914                            0328 00345000
*              OPNPTR=ADDR(OPENAREA);                              0329 00346000
         LA    OPNPTR,OPENAREA                                     0329 00347000
*              OPNAGL=''B;                                         0330 00348000
         XC    OPNAGL(48,OPNPTR),OPNAGL(OPNPTR)                    0330 00349000
*              OPNTYPSI=ON;                                        0331 00350000
         OI    OPNTYPSI(OPNPTR),B'10000000'                        0331 00351000
*              OPNIOC=ADDR(ADDRIOCS);                              0332 00352000
*                                                                  0332 00353000
         LA    @15,ADDRIOCS(,@15)                                  0332 00354000
         ST    @15,OPNIOC(,OPNPTR)                                 0332 00355000
*              CALL IDCIOOP0(GDTTBL,OPNAGL);                       0333 00356000
         ST    GDTPTR,@AL00001                                     0333 00357000
         ST    OPNPTR,@AL00001+4                                   0333 00358000
         MVI   @AL00001+4,X'80'                                    0333 00359000
         L     @15,GDTOPN(,GDTPTR)                                 0333 00360000
         LA    @01,@AL00001                                        0333 00361000
         BALR  @14,@15                                             0333 00362000
*              RESPECIFY RTNREG RSTD;                              0334 00363000
*              TESTRC = RTNREG;                                    0335 00364000
         STH   RTNREG,TESTRC                                       0335 00365000
*              RESPECIFY RTNREG UNRSTD;                            0336 00366000
*                                                                  0336 00367000
*              IF TESTRC ^= 0                                      0337 00368000
*                THEN                                              0337 00369000
         LH    @02,TESTRC                                          0337 00370000
         LTR   @02,@02                                             0337 00371000
         BZ    @RF00337                                            0337 00372000
*                  DO;                                             0338 00373000
*                  LASTCC=TERMERR;                                 0339 00374000
         MVC   LASTCC(2),@CH00482                                  0339 00375000
*                  RISTATUS=SKIPREST;                              0340 00376000
         MVC   RISTATUS(2),@CH00042                                0340 00377000
*                  END;                                            0341 00378000
*                ELSE                                              0342 00379000
*                                                                  0342 00380000
*                  /**************************************************/ 00381000
*                  /*                                                */ 00382000
*                  /*  IF A PARAMETER OPTIONS STRING EXISTS THEN SET */ 00383000
*                  /*  IT UP AS IF IT WERE THE PARAMETER SET OF A    */ 00384000
*                  /*  'PARM' COMMAND. ALSO PRINT THE OPTIONS.       */ 00385000
*                  /*                                                */ 00386000
*                  /**************************************************/ 00387000
*                  IF GDTPRM^=0 & OPTSPTR^=0 & OPTSLEN^=0          0342 00388000
*                    THEN                                          0342 00389000
         B     @RC00337                                            0342 00390000
@RF00337 SLR   @02,@02                                             0342 00391000
         L     @15,GDTPRM(,GDTPTR)                                 0342 00392000
         CR    @15,@02                                             0342 00393000
         BE    @RF00342                                            0342 00394000
         L     @15,OPTSPTR(,@15)                                   0342 00395000
         CR    @15,@02                                             0342 00396000
         BE    @RF00342                                            0342 00397000
         LH    @14,OPTSLEN(,@15)                                   0342 00398000
         CR    @14,@02                                             0342 00399000
         BE    @RF00342                                            0342 00400000
*                      DO;                                         0343 00401000
*                      OPTSFLAG=ON;                                0344 00402000
         OI    OPTSFLAG,B'00100000'                                0344 00403000
*                      MORTOCOM=NO;                                0345 00404000
*                      FIRSTCHR=NO;                                0346 00405000
         NI    MORTOCOM,B'11101011'                                0346 00406000
*                      RECRDPTR=OPTSPTR+2;                         0347 00407000
         AH    @15,@CH00163                                        0347 00408000
         ST    @15,RECRDPTR                                        0347 00409000
*                      SCNLIMIT=OPTSLEN+1;                         0348 00410000
         LA    @02,1                                               0348 00411000
         LR    @05,@14                                             0348 00412000
         ALR   @05,@02                                             0348 00413000
         STH   @05,SCNLIMIT                                        0348 00414000
*                      CHAR1=INREC(1);                             0349 00415000
         MVC   CHAR1(1),INREC(@15)                                 0349 00416000
*                      CHAR2=INREC(2);                             0350 00417000
         MVC   CHAR2(1),INREC+1(@15)                               0350 00418000
*                      SCANINDX=1;                                 0351 00419000
         STH   @02,SCANINDX                                        0351 00420000
*                      VERBNAME=PARMSYM;                           0352 00421000
*                                                                  0352 00422000
         L     @02,GDTRIH(,GDTPTR)                                 0352 00423000
         L     @02,KWTBLPTR(,@02)                                  0352 00424000
         MVC   VERBNAME(8),PARMSYM(@02)                            0352 00425000
*                      DARGDBP=RECRDPTR;                           0353 00426000
         L     @02,DDSTRU                                          0353 00427000
         ST    @15,DARGDBP(,@02)                                   0353 00428000
*                      DARGILP=OPTSLEN;                            0354 00429000
         STH   @14,DARGILP(,@02)                                   0354 00430000
*                      DARGSMOD=RISTID;                            0355 00431000
         MVC   DARGSMOD(3,@02),RISTID                              0355 00432000
*                      DARGSENT=INRECID;                           0356 00433000
*                                                                  0356 00434000
         MVI   DARGSENT(@02),X'27'                                 0356 00435000
*                      CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       0357 00436000
*                                                                  0357 00437000
         ST    GDTPTR,@AL00001                                     0357 00438000
         LA    @02,@CF00125                                        0357 00439000
         ST    @02,@AL00001+4                                      0357 00440000
         LA    @02,DDSTRU                                          0357 00441000
         ST    @02,@AL00001+8                                      0357 00442000
         MVI   @AL00001+8,X'80'                                    0357 00443000
         L     @15,GDTPRT(,GDTPTR)                                 0357 00444000
         LA    @01,@AL00001                                        0357 00445000
         BALR  @14,@15                                             0357 00446000
*                      END;                                        0358 00447000
*                                                                  0358 00448000
*            END;                                                  0359 00449000
*                                                                  0359 00450000
*        END RIINIT;                                               0360 00451000
@EL00002 DS    0H                                                  0360 00452000
@EF00002 DS    0H                                                  0360 00453000
@ER00002 LM    @14,@12,@SA00002                                    0360 00454000
         BR    @14                                                 0360 00455000
*/********************************************************************/ 00456000
*/*                                                                  */ 00457000
*/*  PROCEDURE NAME - SCANCMD                                        */ 00458000
*/*                                                                  */ 00459000
*/*  FUNCTION - THIS ROUTINE SCANS THE INPUT COMMAND, USING THE      */ 00460000
*/*             COMMAND DESCRIPTOR AS A BASIS FOR SCANNING.  KEYWORDS*/ 00461000
*/*             ARE INTERPRETED AND SCALAR DATA IS EXTRACTED AND     */ 00462000
*/*             USED TO BUILD A FUNCTION DATA TABLE.  SYNTAX AND     */ 00463000
*/*             SEMANTIC CHECKING AND FDT BUILDING ARE DONE BASED    */ 00464000
*/*             UPON COMMAND DESCRIPTOR INFORMATION.                 */ 00465000
*/*                                                                  */ 00466000
*/*  INPUT -                                                         */ 00467000
*/*          OPTSFLAG- FLAG INDICATING WHETHER OR NOT A PARAMETER    */ 00468000
*/*                    OPTIONS STRING IS BEING CURRENTLY SCANNED     */ 00469000
*/*          RISTATUS- INTERNAL R/I STATUS CODE INDICATING WHETHER   */ 00470000
*/*                    OR NOT AN ERROR HAS OCCURRED.                 */ 00471000
*/*          CHAR1 -   MOST RECENT INPUT CHARACTER EXTRACTED         */ 00472000
*/*          COMMAND DESCRIPTOR - DATA STRUCTURE CONTAINING DATA     */ 00473000
*/*                               THAT DESCRIBES THE CURRENT COMMAND */ 00474000
*/*                               BEING SCANNED.                     */ 00475000
*/*          SUPERID - PUSHDOWN STACK OF PARAMETER ID#S OF           */ 00476000
*/*                    SUPERPARAMETERS OF SUBPARAMETER LISTS         */ 00477000
*/*                    CURRENTLY BEING SCANNED.                      */ 00478000
*/*          REPDEPTH- LEVEL OF "REPEATEDNESS" NESTING OF PARAMETER  */ 00479000
*/*                    LIST CURRENTLY BEING SCANNED.                 */ 00480000
*/*          PARMLVL - LEVEL OF SUBPARAMETER NESTING OF PARAMETER    */ 00481000
*/*                    LIST CURRENTLY BEING SCANNED.                 */ 00482000
*/*          SCANONLY- FLAG INDICATING WHETHER OR NOT THE CURRENT    */ 00483000
*/*                    COMMAND IS TO HAVE AN FDT BUILT OR IF IT IS   */ 00484000
*/*                    JUST BEING SCANNED FOR SYNTAX ERRORS.         */ 00485000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/ 00486000
*/*          SUBSYET - INDICATES WHETHER OR NOT ANY SUBPARAMETERS    */ 00487000
*/*                    HAVE BEEN FOUND YET IN CURRENT SUBPARM. LIST  */ 00488000
*/*          PPARMCNT- ARRAY OF COUNTS OF POSITIONAL SUBPARAMETERS   */ 00489000
*/*                    FOUND SO FAR IN CURRENT SUBPARM. LISTS        */ 00490000
*/*                                                                  */ 00491000
*/*  OUTPUT -                                                        */ 00492000
*/*          FUNCTION DATA TABLE                                     */ 00493000
*/*          FINALCHR- FLAG INDICATING THAT THE LAST INPUT CHAR.     */ 00494000
*/*                    HAS JUST BEEN EXTRACTED.                      */ 00495000
*/*          INQUOTED- FLAG INDICATING THAT THE R/I IS CURRENTLY     */ 00496000
*/*                    SCANNING WITHIN A QUOTED STRING.              */ 00497000
*/*          PARMLVL - (SEE 'INPUT')                                 */ 00498000
*/*          PPARMCNT- PUSHDOWN STACK OF COUNTS, EACH INDICATING     */ 00499000
*/*                    HOW MANY POSITIONAL PARAMETERS HAVE BEEN      */ 00500000
*/*                    FOUND AT A LEVEL OF PARAMETER LIST NESTING.   */ 00501000
*/*          SUPERID - (SEE 'INPUT')                                 */ 00502000
*/*          REPDEPTH- (SEE 'INPUT')                                 */ 00503000
*/*          SKIPPAST- INDICATES THAT INITIALLY NO COMMAND HAS JUST  */ 00504000
*/*                    BEEN BYPASSED DUE TO AN ERROR IN IT.          */ 00505000
*/*          EOFOK -   FLAG INDICATING WHETHER OR NOT THE SCAN IS    */ 00506000
*/*                    CURRENTLY AT A POINT WHERE THE OCCURRENCE OF  */ 00507000
*/*                    INPUT END-OF-FILE WOULD NOT BE AN ERROR.      */ 00508000
*/*          BLKLEFT - NUMBER OF BYTES OF SPACE REMAINING TO BE      */ 00509000
*/*                    ALLOCATED FOR FDT SCALAR DATA STRUCTURES.     */ 00510000
*/*          PARMID -  ID# OF PARAMETER CURRENTLY BEING EXAMINED     */ 00511000
*/*          FDTPTR -  PRIMARY FDT VECTOR OF POINTERS.               */ 00512000
*/*          ARRYPTR - POINTER TO AN INTERMEDIATE FDT POINTER VECTOR */ 00513000
*/*          LASTCC -  LAST SYSTEM CONDITION CODE                    */ 00514000
*/*          SUBSYET - SEE 'INPUT'                                   */ 00515000
*/*                                                                  */ 00516000
*/********************************************************************/ 00517000
*SCANCMD:PROCEDURE;                                                0361 00518000
SCANCMD  STM   @14,@03,@SA00003                                    0361 00519000
         STM   @06,@12,@SA00003+24                                 0361 00520000
*        /************************************************************/ 00521000
*        /*                                                          */ 00522000
*        /* SCANCMD PROCEDURE DATA DEFINITIONS                       */ 00523000
*        /*                                                          */ 00524000
*        /************************************************************/ 00525000
*        DCL STMTEND  BIT(1);          /*SIGNALS THAT THE END OF THE    00526000
*                                        COMMAND HAS BEEN FOUND      */ 00527000
*        DCL PRMFOUND BIT(1);          /*SIGNALS THAT NEXT PARAMETER    00528000
*                                        IS TO BE EXTRACTED          */ 00529000
*        DCL WORKPTR2 PTR(31);         /*VARIABLE TO CONTAIN       0364 00530000
*                                        A TEMPORARY POINTER VALUE   */ 00531000
*        DCL WORKPTR3 PTR(31);         /*VARIABLE TO CONTAIN       0365 00532000
*                                        A TEMPORARY POINTER VALUE   */ 00533000
*        DCL SETUPERR FIXED(31);       /*ERROR CODE FOR ERROR FOUND     00534000
*                                        DURING DESCRIPTOR SET-UP    */ 00535000
*                                                                  0366 00536000
*        /*STATIC ERROR MESSAGE CODES                                */ 00537000
*        DCL BADPOS   FIXED(31)        /*TOO MANY POSITIONAL PARM'S  */ 00538000
*                     CONSTANT(1);                                 0367 00539000
*        DCL TOOMANY  FIXED(31)        /*TOO MANY RIGHT PARENTHESES  */ 00540000
*                     CONSTANT(34);    /* AT COMMAND TERMINATION     */ 00541000
*        /************************************************************/ 00542000
*        /*                                                          */ 00543000
*        /*  ** SCANCMD **  SCAN INPUT COMMAND & BUILD FDT           */ 00544000
*        /*                                                          */ 00545000
*        /************************************************************/ 00546000
*                                                                  0369 00547000
*        IF GDTDBG = NULLPTR                                       0369 00548000
*          THEN;                                                   0369 00549000
         ICM   @02,15,GDTDBG(GDTPTR)                               0369 00550000
         BZ    @RT00369                                            0369 00551000
*          ELSE                                                    0371 00552000
*            CALL IDCDB010(GDTTBL,'RISC');                         0371 00553000
*                                                                  0371 00554000
         ST    GDTPTR,@AL00001                                     0371 00555000
         LA    @02,@CC00930                                        0371 00556000
         ST    @02,@AL00001+4                                      0371 00557000
         MVI   @AL00001+4,X'80'                                    0371 00558000
         L     @15,GDTDBG(,GDTPTR)                                 0371 00559000
         LA    @01,@AL00001                                        0371 00560000
         BALR  @14,@15                                             0371 00561000
*        STMTEND=NO;                                               0372 00562000
@RT00369 NI    STMTEND,B'01111111'                                 0372 00563000
*        FINALCHR=NO;                                              0373 00564000
         NI    FINALCHR,B'11111101'                                0373 00565000
*        PARMLVL=1;                                                0374 00566000
         LA    @02,1                                               0374 00567000
         STH   @02,PARMLVL                                         0374 00568000
*        PPARMCNT(1)=1;                                            0375 00569000
         STH   @02,PPARMCNT                                        0375 00570000
*        SUPERID(1)=0;                                             0376 00571000
         SLR   @02,@02                                             0376 00572000
         STH   @02,SUPERID                                         0376 00573000
*        REPDEPTH=0;                                               0377 00574000
         STH   @02,REPDEPTH                                        0377 00575000
*        SKIPPAST=NO;                                              0378 00576000
*        EOFOK=YES;                                                0379 00577000
         OI    EOFOK,B'01000000'                                   0379 00578000
         NI    SKIPPAST,B'11110111'                                0379 00579000
*        BLKLEFT=0;                                                0380 00580000
         ST    @02,BLKLEFT                                         0380 00581000
*        SCANONLY=NO;                                              0381 00582000
*                                                                  0381 00583000
         NI    SCANONLY,B'11101111'                                0381 00584000
*        /************************************************************/ 00585000
*        /*                                                          */ 00586000
*        /* EXTRACT THE COMMAND VERB (UNLESS NOW SCANNING PARAMETER  */ 00587000
*        /* OPTIONS) AND CALL 'IDCRI02' TO SET UP THE APPROPRIATE    */ 00588000
*        /* COMMAND DESCRIPTOR AND TO PREPARE FOR COMMAND SCANNING.  */ 00589000
*        /* IF AN ERROR IS ENCOUNTERED DOING THIS, BYPASS THE        */ 00590000
*        /* COMMAND.                                                 */ 00591000
*        /*                                                          */ 00592000
*        /************************************************************/ 00593000
*        IF OPTSFLAG=OFF                                           0382 00594000
*          THEN                                                    0382 00595000
*                                                                  0382 00596000
         TM    OPTSFLAG,B'00100000'                                0382 00597000
         BNZ   @RF00382                                            0382 00598000
*            CALL GETNEXT;                                         0383 00599000
*                                                                  0383 00600000
         BAL   @14,GETNEXT                                         0383 00601000
*          ELSE                                                    0384 00602000
*                                                                  0384 00603000
*            CALL SCANSEP(NO);                                     0384 00604000
*                                                                  0384 00605000
         B     @RC00382                                            0384 00606000
@RF00382 LA    @01,@AL00384                                        0384 00607000
         BAL   @14,SCANSEP                                         0384 00608000
*        IF RISTATUS=0                                             0385 00609000
*          THEN                                                    0385 00610000
@RC00382 ICM   @02,3,RISTATUS                                      0385 00611000
         BNZ   @RF00385                                            0385 00612000
*            DO;                                                   0386 00613000
*                                                                  0386 00614000
*            CALL IDCRI02(GDTTBL,COMMAREA);                /*@YL026UL*/ 00615000
*                                                                  0387 00616000
         ST    GDTPTR,@AL00001                                     0387 00617000
         LA    @02,COMMAREA                                        0387 00618000
         ST    @02,@AL00001+4                                      0387 00619000
         L     @15,@CV00621                                        0387 00620000
         LA    @01,@AL00001                                        0387 00621000
         BALR  @14,@15                                             0387 00622000
*            IF RISTATUS^=0                                        0388 00623000
*              THEN                                                0388 00624000
         LH    @02,RISTATUS                                        0388 00625000
         LTR   @02,@02                                             0388 00626000
         BZ    @RF00388                                            0388 00627000
*                DO;                                               0389 00628000
*                SETUPERR=RISTATUS;                                0390 00629000
         ST    @02,SETUPERR                                        0390 00630000
*                IF SETUPERR=NOSPACE                               0391 00631000
*                  THEN                                            0391 00632000
*                                                                  0391 00633000
         CH    @02,@CH00811                                        0391 00634000
         BNE   @RF00391                                            0391 00635000
*                    CALL ERROR1(SETUPERR);                        0392 00636000
*                                                                  0392 00637000
         LA    @02,SETUPERR                                        0392 00638000
         ST    @02,@AL00001                                        0392 00639000
         LA    @01,@AL00001                                        0392 00640000
         BAL   @14,ERROR1                                          0392 00641000
*                  ELSE                                            0393 00642000
*                                                                  0393 00643000
*                    CALL ERROR2(SETUPERR,LENGTH(ERRFIELD),        0393 00644000
*                                ADDR(ERRFIELD));                  0393 00645000
*                                                                  0393 00646000
         B     @RC00391                                            0393 00647000
@RF00391 LA    @02,SETUPERR                                        0393 00648000
         ST    @02,@AL00001                                        0393 00649000
         LA    @02,@CF00786                                        0393 00650000
         ST    @02,@AL00001+4                                      0393 00651000
         LA    @02,ERRFIELD                                        0393 00652000
         ST    @02,@AFTEMPS+12                                     0393 00653000
         LA    @02,@AFTEMPS+12                                     0393 00654000
         ST    @02,@AL00001+8                                      0393 00655000
         LA    @01,@AL00001                                        0393 00656000
         BAL   @14,ERROR2                                          0393 00657000
*                END;                                              0394 00658000
@RC00391 DS    0H                                                  0395 00659000
*            END;                                                  0395 00660000
*                                                                  0395 00661000
@RF00388 DS    0H                                                  0396 00662000
*        /************************************************************/ 00663000
*        /*                                                          */ 00664000
*        /* SCAN THE PARAMETER SET, EXTRACTING ONE PARAMETER AT A    */ 00665000
*        /* TIME UNTIL THE STATEMENT END IS FOUND OR AN ERROR OCCURS.*/ 00666000
*        /*                                                          */ 00667000
*        /************************************************************/ 00668000
*DOLOOP5:DO WHILE(STMTEND=NO & RISTATUS=0);                        0396 00669000
@RF00385 DS    0H                                                  0396 00670000
DOLOOP5  B     @DE00396                                            0396 00671000
@DL00396 DS    0H                                                  0397 00672000
*          OLDERID2 = NEWERID2;                                    0397 00673000
         L     @02,GDTTR2(,GDTPTR)                                 0397 00674000
         MVC   @TS00001(95),NEWERID2(@02)                          0397 00675000
         MVC   OLDERID2(95,@02),@TS00001                           0397 00676000
*          NEWID2='RI01';                                          0398 00677000
         MVC   NEWID2(4,@02),@CC00820                              0398 00678000
*          IF CHAR1=ENDDELIM                                       0399 00679000
*            THEN                                                  0399 00680000
         CLI   CHAR1,C';'                                          0399 00681000
         BNE   @RF00399                                            0399 00682000
*DOGRP5:       DO;                                                 0400 00683000
DOGRP5   DS    0H                                                  0401 00684000
*                STMTEND=YES;                                      0401 00685000
*                                                                  0401 00686000
         OI    STMTEND,B'10000000'                                 0401 00687000
*                /****************************************************/ 00688000
*                /*                                                  */ 00689000
*                /* APPLY DEFAULTS AND PERFORM SEMANTIC CHECKING AT  */ 00690000
*                /* COMMAND TERMINATION.  ISSUE A WARNING IF TOO FEW */ 00691000
*                /* PARENTHESES APPEAR AT COMMAND END.               */ 00692000
*                /*                                                  */ 00693000
*                /****************************************************/ 00694000
*                IF PARMLVL > 1                                    0402 00695000
*                  THEN                                            0402 00696000
         LH    @02,PARMLVL                                         0402 00697000
         CH    @02,@CH00228                                        0402 00698000
         BNH   @RF00402                                            0402 00699000
*                    DO;                                           0403 00700000
*                    DARGSMOD=RISTID;                              0404 00701000
         L     @02,DDSTRU                                          0404 00702000
         MVC   DARGSMOD(3,@02),RISTID                              0404 00703000
*                    DARGSENT=TOOFEW;                              0405 00704000
*                                                                  0405 00705000
         MVI   DARGSENT(@02),X'23'                                 0405 00706000
*                    CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         0406 00707000
*                                                                  0406 00708000
         ST    GDTPTR,@AL00001                                     0406 00709000
         LA    @02,@CF00125                                        0406 00710000
         ST    @02,@AL00001+4                                      0406 00711000
         LA    @02,DDSTRU                                          0406 00712000
         ST    @02,@AL00001+8                                      0406 00713000
         MVI   @AL00001+8,X'80'                                    0406 00714000
         L     @15,GDTPRT(,GDTPTR)                                 0406 00715000
         LA    @01,@AL00001                                        0406 00716000
         BALR  @14,@15                                             0406 00717000
*                    END;                                          0407 00718000
*                                                                  0407 00719000
*                DO WHILE(PARMLVL>0);                              0408 00720000
@RF00402 B     @DE00408                                            0408 00721000
@DL00408 DS    0H                                                  0409 00722000
*                  PARMID=SUPERID(PARMLVL);                        0409 00723000
         LH    @02,PARMLVL                                         0409 00724000
         ALR   @02,@02                                             0409 00725000
         LH    @02,SUPERID-2(@02)                                  0409 00726000
         STH   @02,PARMID                                          0409 00727000
*                  IF PARMID=0                                     0410 00728000
*                    THEN                                          0410 00729000
         LTR   @02,@02                                             0410 00730000
         BNZ   @RF00410                                            0410 00731000
*                      DO;                                         0411 00732000
*                                                                  0411 00733000
*                      CALL DEFAULTS;                              0412 00734000
         BAL   @14,DEFAULTS                                        0412 00735000
*                      CALL NEEDNOTS;                              0413 00736000
*                                                                  0413 00737000
         BAL   @14,NEEDNOTS                                        0413 00738000
*                      END;                                        0414 00739000
*                    ELSE                                          0415 00740000
*                      IF REPEATED=YES                             0415 00741000
*                        THEN                                      0415 00742000
         B     @RC00410                                            0415 00743000
@RF00410 LH    @02,PARMID                                          0415 00744000
         MH    @02,@CH00038                                        0415 00745000
         L     @01,WORKPTR                                         0415 00746000
         AL    @01,@CF01440                                        0415 00747000
         L     @02,PARMPTR(@02,@01)                                0415 00748000
         TM    REPEATED(@02),B'00100000'                           0415 00749000
         BNO   @RF00415                                            0415 00750000
*                          DO;                                     0416 00751000
*                                                                  0416 00752000
*                          CALL DEFAULTS;                          0417 00753000
         BAL   @14,DEFAULTS                                        0417 00754000
*                          CALL NEEDNOTS;                          0418 00755000
*                                                                  0418 00756000
         BAL   @14,NEEDNOTS                                        0418 00757000
*                          REPDEPTH=REPDEPTH-1;                    0419 00758000
         LH    @02,REPDEPTH                                        0419 00759000
         BCTR  @02,0                                               0419 00760000
         STH   @02,REPDEPTH                                        0419 00761000
*                          END;                                    0420 00762000
*                  PARMLVL=PARMLVL-1;                              0421 00763000
@RF00415 DS    0H                                                  0421 00764000
@RC00410 LH    @02,PARMLVL                                         0421 00765000
         BCTR  @02,0                                               0421 00766000
         STH   @02,PARMLVL                                         0421 00767000
*                END;                                              0422 00768000
*                                                                  0422 00769000
@DE00408 SLR   @02,@02                                             0422 00770000
         CH    @02,PARMLVL                                         0422 00771000
         BL    @DL00408                                            0422 00772000
*                /****************************************************/ 00773000
*                /*                                                  */ 00774000
*                /* IF FDT BUILDING HAS COMPLETED OKAY, THEN CHECK   */ 00775000
*                /* FOR PARAMETERS WITHIN THE FIRST LEVEL OF REPEATED*/ 00776000
*                /* SUBLIST NESTING.  THE POINTERS WHICH POINT TO THE*/ 00777000
*                /* SCALAR DATA OF THESE PARAMETERS ARE CURRENTLY IN */ 00778000
*                /* THE FORM OF LISTS OF POINTER VECTOR BLOCKS.      */ 00779000
*                /* REASSEMBLE EACH LIST INTO A SINGLE VECTOR OF PTRS*/ 00780000
*                /*                                                  */ 00781000
*                /****************************************************/ 00782000
*                IF RISTATUS=0 & SCANONLY=NO                       0423 00783000
*                  THEN                                            0423 00784000
         CH    @02,RISTATUS                                        0423 00785000
         BNE   @RF00423                                            0423 00786000
         TM    SCANONLY,B'00010000'                                0423 00787000
         BNZ   @RF00423                                            0423 00788000
*DOLOOP7:            DO PARMID=1 TO MAXID WHILE(RISTATUS=0);       0424 00789000
DOLOOP7  LA    @02,1                                               0424 00790000
         B     @DE00424                                            0424 00791000
@DL00424 SLR   @15,@15                                             0424 00792000
         CH    @15,RISTATUS                                        0424 00793000
         BNE   @DC00424                                            0424 00794000
*                      IF PARMPTR(PARMID)^=NULLPTR & OCCURNUM > 1  0425 00795000
*                        THEN                                      0425 00796000
*                                                                  0425 00797000
         MH    @02,@CH00038                                        0425 00798000
         L     @01,WORKPTR                                         0425 00799000
         AL    @01,@CF01440                                        0425 00800000
         L     @02,PARMPTR(@02,@01)                                0425 00801000
         CR    @02,@15                                             0425 00802000
         BE    @RF00425                                            0425 00803000
         CLC   OCCURNUM(3,@02),@CF00228+1                          0425 00804000
         BNH   @RF00425                                            0425 00805000
*                          /******************************************/ 00806000
*                          /*                                        */ 00807000
*                          /* CHECK ALL PARAMETERS WITHIN REPEATED   */ 00808000
*                          /* SUBLISTS TO SEE IF THEY ARE AT THE 1ST */ 00809000
*                          /* LEVEL OF REPEAT NESTING.               */ 00810000
*                          /*                                        */ 00811000
*                          /******************************************/ 00812000
*DOGRP6:                   DO;                                     0426 00813000
DOGRP6   DS    0H                                                  0427 00814000
*                          REPNEST=0;                              0427 00815000
         SLR   REPNEST,REPNEST                                     0427 00816000
*                          VLISTID=PARMID;                         0428 00817000
         LH    @15,PARMID                                          0428 00818000
         STH   @15,VLISTID                                         0428 00819000
*                          PARMID=SUPRPARM(PARMID);                0429 00820000
         MH    @15,@CH00038                                        0429 00821000
         L     @01,WORKPTR                                         0429 00822000
         AL    @01,@CF01441                                        0429 00823000
         LH    @15,SUPRPARM-8(@15,@01)                             0429 00824000
         STH   @15,PARMID                                          0429 00825000
*                          DO WHILE(PARMID^=0);                    0430 00826000
         B     @DE00430                                            0430 00827000
@DL00430 DS    0H                                                  0431 00828000
*                            IF REPEATED=YES                       0431 00829000
*                              THEN                                0431 00830000
         LH    @15,PARMID                                          0431 00831000
         MH    @15,@CH00038                                        0431 00832000
         L     @01,WORKPTR                                         0431 00833000
         AL    @01,@CF01440                                        0431 00834000
         L     @01,PARMPTR(@15,@01)                                0431 00835000
         TM    REPEATED(@01),B'00100000'                           0431 00836000
         BNO   @RF00431                                            0431 00837000
*                                REPNEST=REPNEST+1;                0432 00838000
         AL    REPNEST,@CF00228                                    0432 00839000
*                            PARMID=SUPRPARM(PARMID);              0433 00840000
@RF00431 LH    @15,PARMID                                          0433 00841000
         MH    @15,@CH00038                                        0433 00842000
         L     @01,WORKPTR                                         0433 00843000
         AL    @01,@CF01441                                        0433 00844000
         LH    @15,SUPRPARM-8(@15,@01)                             0433 00845000
         STH   @15,PARMID                                          0433 00846000
*                          END;                                    0434 00847000
@DE00430 ICM   @15,3,PARMID                                        0434 00848000
         BNZ   @DL00430                                            0434 00849000
*                          PARMID=VLISTID;                         0435 00850000
         MVC   PARMID(2),VLISTID                                   0435 00851000
*                          IF REPNEST=1                            0436 00852000
*                            THEN                                  0436 00853000
*                                                                  0436 00854000
         CH    REPNEST,@CH00228                                    0436 00855000
         BNE   @RF00436                                            0436 00856000
*                              /**************************************/ 00857000
*                              /*                                    */ 00858000
*                              /* FOR PARAMETERS HAVING THE LISTS OF */ 00859000
*                              /* POINTER BLOCKS, ALLOCATE ENOUGH    */ 00860000
*                              /* SPACE FOR A SINGLE PTR BLOCK AND   */ 00861000
*                              /* MOVE THE POINTERS FROM THE LIST    */ 00862000
*                              /* INTO THE SINGLE VECTOR OF POINTERS.*/ 00863000
*                              /* THEN FREE UP THE 'LIST' SPACE.     */ 00864000
*                              /*                                    */ 00865000
*                              /**************************************/ 00866000
*DOGRP7:                       DO;                                 0437 00867000
DOGRP7   DS    0H                                                  0438 00868000
*                              VECTRNUM=1;                         0438 00869000
         MVC   VECTRNUM(2),@CH00228                                0438 00870000
*                              ARRYPTR=FDTPTR(PARMID);             0439 00871000
         LH    @15,PARMID                                          0439 00872000
         SLA   @15,2                                               0439 00873000
         L     @01,FDTADDR                                         0439 00874000
         L     ARRYPTR,FDTPTR-4(@15,@01)                           0439 00875000
*                              DO WHILE(VECTRPTR^=0);              0440 00876000
         B     @DE00440                                            0440 00877000
@DL00440 DS    0H                                                  0441 00878000
*                                VECTRNUM=VECTRNUM+1;              0441 00879000
         LH    @01,VECTRNUM                                        0441 00880000
         LA    @01,1(,@01)                                         0441 00881000
         STH   @01,VECTRNUM                                        0441 00882000
*                                ARRYPTR=VECTRPTR;                 0442 00883000
         LR    @15,ARRYPTR                                         0442 00884000
         AH    @15,VECTRLEN                                        0442 00885000
         L     @15,VECTRPTR(,@15)                                  0442 00886000
         LR    ARRYPTR,@15                                         0442 00887000
*                              END;                                0443 00888000
@DE00440 LH    @15,VECTRLEN                                        0443 00889000
         LR    @14,ARRYPTR                                         0443 00890000
         ALR   @14,@15                                             0443 00891000
         ICM   @01,15,VECTRPTR(@14)                                0443 00892000
         BNZ   @DL00440                                            0443 00893000
*                              AMTTOGET=VECTRNUM*VECTRLEN;         0444 00894000
         MH    @15,VECTRNUM                                        0444 00895000
         ST    @15,AMTTOGET                                        0444 00896000
*                              WORKPTR2=FDTPTR(PARMID);            0445 00897000
*                                                                  0445 00898000
         L     @02,FDTADDR                                         0445 00899000
         LH    @15,PARMID                                          0445 00900000
         SLA   @15,2                                               0445 00901000
         L     @14,FDTPTR-4(@15,@02)                               0445 00902000
         ST    @14,WORKPTR2                                        0445 00903000
*                              CALL IDCSAGP0(GDTTBL,AMTTOGET,FDTPTR(PAR 00904000
*ID),                                                              0446 00905000
*                                     POOLID,SETZERO);             0446 00906000
         ST    GDTPTR,@AL00001                                     0446 00907000
         LA    @14,AMTTOGET                                        0446 00908000
         ST    @14,@AL00001+4                                      0446 00909000
         LA    @02,FDTPTR-4(@15,@02)                               0446 00910000
         ST    @02,@AL00001+8                                      0446 00911000
         LA    @02,POOLID                                          0446 00912000
         ST    @02,@AL00001+12                                     0446 00913000
         LA    @02,SETZERO                                         0446 00914000
         ST    @02,@AL00001+16                                     0446 00915000
         MVI   @AL00001+16,X'80'                                   0446 00916000
         L     @15,GDTGPL(,GDTPTR)                                 0446 00917000
         LA    @01,@AL00001                                        0446 00918000
         BALR  @14,@15                                             0446 00919000
*                              RESPECIFY RTNREG RSTD;              0447 00920000
*                              TESTRC = RTNREG;                    0448 00921000
         STH   RTNREG,TESTRC                                       0448 00922000
*                              RESPECIFY RTNREG UNRSTD;            0449 00923000
*                                                                  0449 00924000
*                              WORKPTR3=FDTPTR(PARMID);            0450 00925000
         LH    @02,PARMID                                          0450 00926000
         SLA   @02,2                                               0450 00927000
         L     @01,FDTADDR                                         0450 00928000
         L     @02,FDTPTR-4(@02,@01)                               0450 00929000
         ST    @02,WORKPTR3                                        0450 00930000
*                              IF TESTRC=0                         0451 00931000
*                                THEN                              0451 00932000
         LH    @02,TESTRC                                          0451 00933000
         LTR   @02,@02                                             0451 00934000
         BNZ   @RF00451                                            0451 00935000
*                                  DO INDEX=1 TO VECTRNUM;         0452 00936000
         LA    @02,1                                               0452 00937000
         B     @DE00452                                            0452 00938000
@DL00452 DS    0H                                                  0453 00939000
*                                    WORKPTR3->DATABLK(1:VECTRLEN)=     00940000
*                                      WORKPTR2->DATABLK(1:VECTRLEN);   00941000
         L     @15,WORKPTR3                                        0453 00942000
         LH    @14,VECTRLEN                                        0453 00943000
         LR    @01,@14                                             0453 00944000
         BCTR  @01,0                                               0453 00945000
         L     @00,WORKPTR2                                        0453 00946000
         LR    @02,@00                                             0453 00947000
         EX    @01,@SM01442                                        0453 00948000
*                                    WORKPTR3=WORKPTR3+VECTRLEN;   0454 00949000
         ALR   @15,@14                                             0454 00950000
         ST    @15,WORKPTR3                                        0454 00951000
*                                    WORKPTR2=                     0455 00952000
*                                      (WORKPTR2+VECTRLEN)->VECTRPTR;   00953000
         ALR   @00,@14                                             0455 00954000
         LR    @02,@00                                             0455 00955000
         L     @02,VECTRPTR(,@02)                                  0455 00956000
         ST    @02,WORKPTR2                                        0455 00957000
*                                  END;                            0456 00958000
         LH    @15,INDEX                                           0456 00959000
         AL    @15,@CF00228                                        0456 00960000
         LR    @02,@15                                             0456 00961000
@DE00452 STH   @02,INDEX                                           0456 00962000
         CH    @02,VECTRNUM                                        0456 00963000
         BNH   @DL00452                                            0456 00964000
*                                ELSE                              0457 00965000
*                                                                  0457 00966000
*                                  CALL ERROR1(NOSPACE);           0457 00967000
*                                                                  0457 00968000
         B     @RC00451                                            0457 00969000
@RF00451 LA    @01,@AL00457                                        0457 00970000
         BAL   @14,ERROR1                                          0457 00971000
*                              CALL IDCSAFP0(GDTTBL,RIPOOLID);     0458 00972000
*                                                                  0458 00973000
@RC00451 ST    GDTPTR,@AL00001                                     0458 00974000
         LA    @02,RIPOOLID                                        0458 00975000
         ST    @02,@AL00001+4                                      0458 00976000
         MVI   @AL00001+4,X'80'                                    0458 00977000
         L     @15,GDTFPL(,GDTPTR)                                 0458 00978000
         LA    @01,@AL00001                                        0458 00979000
         BALR  @14,@15                                             0458 00980000
*                              END DOGRP7;                         0459 00981000
*                          END DOGRP6;                             0460 00982000
@RF00436 DS    0H                                                  0461 00983000
*                    END DOLOOP7;                                  0461 00984000
*                                                                  0461 00985000
@RF00425 LA    @02,1                                               0461 00986000
         AH    @02,PARMID                                          0461 00987000
@DE00424 STH   @02,PARMID                                          0461 00988000
         L     @01,DESCPTR                                         0461 00989000
         CH    @02,MAXID(,@01)                                     0461 00990000
         BNH   @DL00424                                            0461 00991000
@DC00424 DS    0H                                                  0462 00992000
*                /****************************************************/ 00993000
*                /*                                                  */ 00994000
*                /* IN PREPARATION FOR PICKING UP THE NEXT COMMAND,  */ 00995000
*                /* BYPASS ALL CHARACTERS ASSOCIATED WITH THE CURRENT*/ 00996000
*                /* COMMAND.                                         */ 00997000
*                /*                                                  */ 00998000
*                /****************************************************/ 00999000
*                DO WHILE(MORTOCOM=YES & RISTATUS=0);              0462 01000000
*                                                                  0462 01001000
@RF00423 B     @DE00462                                            0462 01002000
@DL00462 DS    0H                                                  0463 01003000
*                  CALL NEXTCHAR;                                  0463 01004000
         BAL   @14,NEXTCHAR                                        0463 01005000
*                  CALL SKIPCMD;                                   0464 01006000
*                                                                  0464 01007000
         BAL   @14,SKIPCMD                                         0464 01008000
*                END;                                              0465 01009000
@DE00462 TM    MORTOCOM,B'00010000'                                0465 01010000
         BNO   @DC00462                                            0465 01011000
         ICM   @02,3,RISTATUS                                      0465 01012000
         BZ    @DL00462                                            0465 01013000
@DC00462 DS    0H                                                  0466 01014000
*              END DOGRP5;                                         0466 01015000
*                                                                  0466 01016000
*            /********************************************************/ 01017000
*            /*                                                      */ 01018000
*            /* THE END OF THE CURRENT COMMAND HAS NOT BEEN REACHED  */ 01019000
*            /*                                                      */ 01020000
*            /********************************************************/ 01021000
*            ELSE                                                  0467 01022000
*              IF SUPERID(PARMLVL)=0                               0467 01023000
*                  THEN                                            0467 01024000
*                                                                  0467 01025000
         B     @RC00399                                            0467 01026000
@RF00399 LH    @02,PARMLVL                                         0467 01027000
         ALR   @02,@02                                             0467 01028000
         LH    @02,SUPERID-2(@02)                                  0467 01029000
         LTR   @02,@02                                             0467 01030000
         BNZ   @RF00467                                            0467 01031000
*                    /************************************************/ 01032000
*                    /*                                              */ 01033000
*                    /* IF FIRST-LEVEL PARAMETERS ARE BEING SCANNED  */ 01034000
*                    /* AND THE SCAN CURRENTLY POINTS TO A CLOSING   */ 01035000
*                    /* PARENTHESIS, THEN TOO MANY PARENTHESES HAVE  */ 01036000
*                    /* BEEN CODED AND WILL THEREFORE BE IGNORED.    */ 01037000
*                    /* A WARNING MESSAGE IS ISSUED.                 */ 01038000
*                    /*                                              */ 01039000
*                    /************************************************/ 01040000
*DOGRP10:            DO;                                           0468 01041000
DOGRP10  DS    0H                                                  0469 01042000
*                    OLDERID2 = NEWERID2;                          0469 01043000
         L     @02,GDTTR2(,GDTPTR)                                 0469 01044000
         MVC   @TS00001(95),NEWERID2(@02)                          0469 01045000
         MVC   OLDERID2(95,@02),@TS00001                           0469 01046000
*                    NEWID2='RI02';                                0470 01047000
         MVC   NEWID2(4,@02),@CC00951                              0470 01048000
*                    IF CHAR1 = CLOSING                            0471 01049000
*                      THEN                                        0471 01050000
         CLI   CHAR1,C')'                                          0471 01051000
         BNE   @RF00471                                            0471 01052000
*                        DO WHILE(RISTATUS=0 & CHAR1=CLOSING);     0472 01053000
         B     @DE00472                                            0472 01054000
@DL00472 DS    0H                                                  0473 01055000
*                          DARGSMOD=RISTID;                        0473 01056000
         L     @02,DDSTRU                                          0473 01057000
         MVC   DARGSMOD(3,@02),RISTID                              0473 01058000
*                          DARGSENT=TOOMANY;                       0474 01059000
*                                                                  0474 01060000
         MVI   DARGSENT(@02),X'22'                                 0474 01061000
*                          CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);   0475 01062000
*                                                                  0475 01063000
         ST    GDTPTR,@AL00001                                     0475 01064000
         LA    @02,@CF00125                                        0475 01065000
         ST    @02,@AL00001+4                                      0475 01066000
         LA    @02,DDSTRU                                          0475 01067000
         ST    @02,@AL00001+8                                      0475 01068000
         MVI   @AL00001+8,X'80'                                    0475 01069000
         L     @15,GDTPRT(,GDTPTR)                                 0475 01070000
         LA    @01,@AL00001                                        0475 01071000
         BALR  @14,@15                                             0475 01072000
*                          CALL NEXTCHAR;                          0476 01073000
         BAL   @14,NEXTCHAR                                        0476 01074000
*                          CALL SCANSEP(YES);                      0477 01075000
*                                                                  0477 01076000
         LA    @01,@AL00477                                        0477 01077000
         BAL   @14,SCANSEP                                         0477 01078000
*                        END;                                      0478 01079000
*                                                                  0478 01080000
@DE00472 ICM   @02,3,RISTATUS                                      0478 01081000
         BNZ   @DC00472                                            0478 01082000
         CLI   CHAR1,C')'                                          0478 01083000
         BE    @DL00472                                            0478 01084000
@DC00472 DS    0H                                                  0479 01085000
*                    /************************************************/ 01086000
*                    /*                                      @Y30SSFR*/ 01087000
*                    /* IF COMMAND END HAS NOT BEEN FOUND, THEN      */ 01088000
*                    /* EXTRACT A FIRST-LEVEL PARAMETER, AFTER       */ 01089000
*                    /* CHECKING THE DESCRIPTOR LIST TO SEE IF IT    */ 01090000
*                    /* IS TO BE A POSITIONAL OR KEYWORD PARAMETER.  */ 01091000
*                    /*                                      @Y30SSFR*/ 01092000
*                    /************************************************/ 01093000
*                    IF RISTATUS^=0 | CHAR1=ENDDELIM               0479 01094000
*                      THEN;                                       0479 01095000
@RF00471 ICM   @02,3,RISTATUS                                      0479 01096000
         BNZ   @RT00479                                            0479 01097000
         CLI   CHAR1,C';'                                          0479 01098000
         BE    @RT00479                                            0479 01099000
*                      ELSE                                        0481 01100000
*                                                                  0481 01101000
*                        /********************************************/ 01102000
*                        /*                                  @Y30SSFR*/ 01103000
*                        /* IF NO LIST OF POSITIONAL PARAMETERS IS   */ 01104000
*                        /* SPECIFIED IN THE DESCRIPTOR, THEN ALL    */ 01105000
*                        /* FIRST-LEVEL PARM'S ARE KEYWORD PARM'S.   */ 01106000
*                        /* ALSO, IF ALL FIRST-LEVEL POSITIONALS     */ 01107000
*                        /* HAVE BEEN EXTRACTED, EXPECT A KEYWORD.   */ 01108000
*                        /* IF NEITHER OF THE ABOVE, EXPECT A        */ 01109000
*                        /* POSITIONAL PARAMETER.            @Y30SSFR*/ 01110000
*                        /*                                  @Y30SSFR*/ 01111000
*                        /********************************************/ 01112000
*                        IF POSDSPL=0 |                            0481 01113000
*                           PPARMCNT(PARMLVL) > VPOSCNT            0481 01114000
*                          THEN                                    0481 01115000
*                                                                  0481 01116000
         L     @02,DESCPTR                                         0481 01117000
         CLI   POSDSPL(@02),0                                      0481 01118000
         BE    @RT00481                                            0481 01119000
         LH    @15,PARMLVL                                         0481 01120000
         ALR   @15,@15                                             0481 01121000
         SLR   @14,@14                                             0481 01122000
         IC    @14,POSDSPL(,@02)                                   0481 01123000
         ALR   @14,@14                                             0481 01124000
         ALR   @02,@14                                             0481 01125000
         LH    @15,PPARMCNT-2(@15)                                 0481 01126000
         CH    @15,VPOSCNT(,@02)                                   0481 01127000
         BNH   @RF00481                                            0481 01128000
@RT00481 DS    0H                                                  0482 01129000
*                            CALL KWDPARM;                 /*@YL026UL*/ 01130000
*                                                                  0482 01131000
         BAL   @14,KWDPARM                                         0482 01132000
*                          ELSE                                    0483 01133000
*                            DO;                                   0483 01134000
         B     @RC00481                                            0483 01135000
@RF00481 DS    0H                                                  0484 01136000
*                            PARMID=                               0484 01137000
*                                VPOSID(PPARMCNT(PARMLVL));/*@YL026UL*/ 01138000
*                                                                  0484 01139000
         LH    @02,PARMLVL                                         0484 01140000
         ALR   @02,@02                                             0484 01141000
         LH    @02,PPARMCNT-2(@02)                                 0484 01142000
         ALR   @02,@02                                             0484 01143000
         L     @15,DESCPTR                                         0484 01144000
         SLR   @14,@14                                             0484 01145000
         IC    @14,POSDSPL(,@15)                                   0484 01146000
         ALR   @14,@14                                             0484 01147000
         ALR   @15,@14                                             0484 01148000
         LH    @02,VPOSID-2(@02,@15)                               0484 01149000
         STH   @02,PARMID                                          0484 01150000
*                            CALL POSPARM;                         0485 01151000
*                                                                  0485 01152000
         BAL   @14,POSPARM                                         0485 01153000
*                            END;                                  0486 01154000
*                    END DOGRP10;                                  0487 01155000
*                  ELSE                                            0488 01156000
*                                                                  0488 01157000
*                    /************************************************/ 01158000
*                    /*                                              */ 01159000
*                    /* IF A SUBPARAMETER LIST IS BEING SCANNED AND  */ 01160000
*                    /* THE SCAN CURRENTLY POINTS TO A CLOSING       */ 01161000
*                    /* PARENTHESIS, THEN THE CURRENT SUBPARAMETER   */ 01162000
*                    /* LIST SCAN IS FINISHED.  MAKE SURE THAT SOME  */ 01163000
*                    /* SUBPARAMETERS WERE FOUND.                    */ 01164000
*                    /*                                              */ 01165000
*                    /************************************************/ 01166000
*                    IF CHAR1=CLOSING                              0488 01167000
*                      THEN                                        0488 01168000
         B     @RC00467                                            0488 01169000
@RF00467 CLI   CHAR1,C')'                                          0488 01170000
         BNE   @RF00488                                            0488 01171000
*                        IF SUBSYET=NO                             0489 01172000
*                          THEN                                    0489 01173000
*                                                                  0489 01174000
         TM    SUBSYET,B'00010000'                                 0489 01175000
         BNZ   @RF00489                                            0489 01176000
*                            CALL ERROR2(BADELIM1,LENGTH(CHAR1),   0490 01177000
*                                        ADDR(CHAR1));             0490 01178000
*                                                                  0490 01179000
         MVC   @AL00001(8),@AL00490                                0490 01180000
         LA    @02,CHAR1                                           0490 01181000
         ST    @02,@AFTEMPS+12                                     0490 01182000
         LA    @02,@AFTEMPS+12                                     0490 01183000
         ST    @02,@AL00001+8                                      0490 01184000
         LA    @01,@AL00001                                        0490 01185000
         BAL   @14,ERROR2                                          0490 01186000
*                          ELSE                                    0491 01187000
*                            DO;                                   0491 01188000
         B     @RC00489                                            0491 01189000
@RF00489 DS    0H                                                  0492 01190000
*                              PARMID=SUPERID(PARMLVL);            0492 01191000
*                                                                  0492 01192000
         LH    @02,PARMLVL                                         0492 01193000
         ALR   @02,@02                                             0492 01194000
         LH    @02,SUPERID-2(@02)                                  0492 01195000
         STH   @02,PARMID                                          0492 01196000
*                              CALL NEXTCHAR;                      0493 01197000
*                                                                  0493 01198000
         BAL   @14,NEXTCHAR                                        0493 01199000
*                              IF RISTATUS=0                       0494 01200000
*                                THEN                              0494 01201000
         ICM   @02,3,RISTATUS                                      0494 01202000
         BNZ   @RF00494                                            0494 01203000
*                                  IF REPEATED=NO                  0495 01204000
*                                    THEN                          0495 01205000
         LH    @02,PARMID                                          0495 01206000
         MH    @02,@CH00038                                        0495 01207000
         L     @01,WORKPTR                                         0495 01208000
         AL    @01,@CF01440                                        0495 01209000
         L     @02,PARMPTR(@02,@01)                                0495 01210000
         TM    REPEATED(@02),B'00100000'                           0495 01211000
         BNZ   @RF00495                                            0495 01212000
*                                      DO;                         0496 01213000
*                                                                  0496 01214000
*                                      CALL SCANSEP(YES);          0497 01215000
*                                                                  0497 01216000
         LA    @01,@AL00497                                        0497 01217000
         BAL   @14,SCANSEP                                         0497 01218000
*                                      PARMLVL=PARMLVL-1;          0498 01219000
         LH    @02,PARMLVL                                         0498 01220000
         BCTR  @02,0                                               0498 01221000
         STH   @02,PARMLVL                                         0498 01222000
*                                      END;                        0499 01223000
*                                                                  0499 01224000
*                                    /********************************/ 01225000
*                                    /*                              */ 01226000
*                                    /* WHEN CURRENTLY SCANNING      */ 01227000
*                                    /* WITHIN A REPEATED SUBPARM.   */ 01228000
*                                    /* LIST, TREAT EACH SUBLIST     */ 01229000
*                                    /* SEPARATELY, APPLYING DEFAULTS*/ 01230000
*                                    /* AND PERFORMING SEMANTIC      */ 01231000
*                                    /* CHECKING.                    */ 01232000
*                                    /*                              */ 01233000
*                                    /********************************/ 01234000
*                                    ELSE                          0500 01235000
*                                                                  0500 01236000
*                                      CALL INREPEAT;              0500 01237000
*                                                                  0500 01238000
         B     @RC00495                                            0500 01239000
@RF00495 BAL   @14,INREPEAT                                        0500 01240000
*                            END;                                  0501 01241000
*                                                                  0501 01242000
*                      /**********************************************/ 01243000
*                      /*                                            */ 01244000
*                      /* A SUBPARAMETER LIST HAS ADDITIONAL         */ 01245000
*                      /* SUBPARAMETERS TO BE SCANNED.               */ 01246000
*                      /*                                            */ 01247000
*                      /**********************************************/ 01248000
*                      ELSE                                        0502 01249000
*                                                                  0502 01250000
*                        /********************************************/ 01251000
*                        /*                                          */ 01252000
*                        /* EXAMINE THE DESCRIPTOR SUBPARM LIST FOR  */ 01253000
*                        /* THIS PARAMETER TO SEE IF A POSITIONAL    */ 01254000
*                        /* PARM. REMAINS TO BE EXTRACTED OR IF A    */ 01255000
*                        /* KEYWORD PARAMETER SHOULD BE PICKED UP.   */ 01256000
*                        /*                                          */ 01257000
*                        /********************************************/ 01258000
*DOGRP15:                DO;                                       0502 01259000
         B     @RC00488                                            0502 01260000
@RF00488 DS    0H                                                  0502 01261000
DOGRP15  DS    0H                                                  0503 01262000
*                          SUBSYET=YES;                            0503 01263000
         OI    SUBSYET,B'00010000'                                 0503 01264000
*                          PARMID=SUPERID(PARMLVL);                0504 01265000
         LH    @02,PARMLVL                                         0504 01266000
         ALR   @02,@02                                             0504 01267000
         LH    @15,SUPERID-2(@02)                                  0504 01268000
         STH   @15,PARMID                                          0504 01269000
*                          IF PPARMCNT(PARMLVL) <= SUBCOUNT        0505 01270000
*                            THEN                                  0505 01271000
         LH    @02,PPARMCNT-2(@02)                                 0505 01272000
         LA    @14,12                                              0505 01273000
         MR    @14,@14                                             0505 01274000
         L     @01,WORKPTR                                         0505 01275000
         AL    @01,@CF01440                                        0505 01276000
         L     @15,PARMPTR(@15,@01)                                0505 01277000
         LA    @14,12                                              0505 01278000
         ALR   @14,@15                                             0505 01279000
         SLR   @01,@01                                             0505 01280000
         IC    @01,SUBDSPL(,@14)                                   0505 01281000
         ALR   @01,@01                                             0505 01282000
         ALR   @15,@01                                             0505 01283000
         CH    @02,SUBCOUNT(,@15)                                  0505 01284000
         BH    @RF00505                                            0505 01285000
*                              DO;                                 0506 01286000
*                              OLDERID2 = NEWERID2;                0507 01287000
         L     @14,GDTTR2(,GDTPTR)                                 0507 01288000
         MVC   @TS00001(95),NEWERID2(@14)                          0507 01289000
         MVC   OLDERID2(95,@14),@TS00001                           0507 01290000
*                              NEWID2='RI03';                      0508 01291000
         MVC   NEWID2(4,@14),@CC00957                              0508 01292000
*                              IF PARMTYPE(PPARMCNT(PARMLVL)) = 'K'     01293000
*                                THEN                              0509 01294000
*                                                                  0509 01295000
         SLA   @02,2                                               0509 01296000
         ALR   @15,@02                                             0509 01297000
         BCTR  @15,0                                               0509 01298000
         BCTR  @15,0                                               0509 01299000
         CLI   PARMTYPE-2(@15),C'K'                                0509 01300000
         BNE   @RF00509                                            0509 01301000
*                                  CALL KWDPARM;                   0510 01302000
*                                                                  0510 01303000
         BAL   @14,KWDPARM                                         0510 01304000
*                                ELSE                              0511 01305000
*                                  DO;                             0511 01306000
         B     @RC00509                                            0511 01307000
@RF00509 DS    0H                                                  0512 01308000
*                                  PARMID=SUBID(PPARMCNT(PARMLVL));     01309000
*                                                                  0512 01310000
         LH    @02,PARMLVL                                         0512 01311000
         ALR   @02,@02                                             0512 01312000
         LH    @02,PPARMCNT-2(@02)                                 0512 01313000
         SLA   @02,2                                               0512 01314000
         LA    @15,12                                              0512 01315000
         LR    @14,@15                                             0512 01316000
         MH    @14,PARMID                                          0512 01317000
         L     @01,WORKPTR                                         0512 01318000
         AL    @01,@CF01440                                        0512 01319000
         L     @14,PARMPTR(@14,@01)                                0512 01320000
         ALR   @15,@14                                             0512 01321000
         SLR   @01,@01                                             0512 01322000
         IC    @01,SUBDSPL(,@15)                                   0512 01323000
         ALR   @01,@01                                             0512 01324000
         ALR   @14,@01                                             0512 01325000
         LH    @02,SUBID-4(@02,@14)                                0512 01326000
         STH   @02,PARMID                                          0512 01327000
*                                  CALL POSPARM;                   0513 01328000
*                                                                  0513 01329000
         BAL   @14,POSPARM                                         0513 01330000
*                                  END;                            0514 01331000
*                              END;                                0515 01332000
*                                                                  0515 01333000
*                            /****************************************/ 01334000
*                            /*                                      */ 01335000
*                            /* IF NO SUBPARAMETERS OF THE CURRENT   */ 01336000
*                            /* SUPERPARAMETER REMAIN TO BE EXTRACTED*/ 01337000
*                            /* A SYNTAX ERROR HAS BEEN FOUND.       */ 01338000
*                            /*                                      */ 01339000
*                            /****************************************/ 01340000
*                            ELSE                                  0516 01341000
*                                                                  0516 01342000
*                              CALL ERROR2(BADPOS,LENGTH(ERRFIELD),     01343000
*                                          ADDR(ERRFIELD));        0516 01344000
*                                                                  0516 01345000
         B     @RC00505                                            0516 01346000
@RF00505 MVC   @AL00001(8),@AL00516                                0516 01347000
         LA    @02,ERRFIELD                                        0516 01348000
         ST    @02,@AFTEMPS+12                                     0516 01349000
         LA    @02,@AFTEMPS+12                                     0516 01350000
         ST    @02,@AL00001+8                                      0516 01351000
         LA    @01,@AL00001                                        0516 01352000
         BAL   @14,ERROR2                                          0516 01353000
*                        END DOGRP15;                              0517 01354000
@RC00505 DS    0H                                                  0518 01355000
*        END DOLOOP5;                                              0518 01356000
@RC00488 DS    0H                                                  0518 01357000
@RC00467 DS    0H                                                  0518 01358000
@RC00399 DS    0H                                                  0518 01359000
@DE00396 TM    STMTEND,B'10000000'                                 0518 01360000
         BNZ   @DC00396                                            0518 01361000
         ICM   @02,3,RISTATUS                                      0518 01362000
         BZ    @DL00396                                            0518 01363000
@DC00396 DS    0H                                                  0519 01364000
*/********************************************************************/ 01365000
*/*                                                                  */ 01366000
*/*  PROCEDURE NAME - GETNEXT                                        */ 01367000
*/*                                                                  */ 01368000
*/*  FUNCTION - THIS PROCEDURE OBTAINS THE VERB NAME AND POINTER TO  */ 01369000
*/*             THE PARAMETER SET OF THE NEXT FUNCTION COMMAND.      */ 01370000
*/*             MODAL COMMANDS ARE INTERPRETED TO DETERMINE OF THE   */ 01371000
*/*             NEXT FUNCTION COMMAND FOUND IS TO BE RETURNED IN     */ 01372000
*/*             ENCODED FORM TO THE AMS EXECUTIVE FOR EXECUTION.     */ 01373000
*/*             FUNCTION COMMANDS WHICH ARE NOT TO BE ENCODED OR     */ 01374000
*/*             RETURNED WILL SIMPLY BE EXAMINED FOR CORRECT SYNTAX  */ 01375000
*/*             AND THEN BYPASSED.  WHEN REQUIRED, A NEW INPUT RECORD*/ 01376000
*/*             IS READ IN ORDER TO OBTAIN THE NEXT FUNCTION OR MODAL*/ 01377000
*/*             COMMAND SYNTACTIC UNIT.                              */ 01378000
*/*                                                                  */ 01379000
*/*  INPUT -                                                         */ 01380000
*/*          SCANONLY - FLAG INDICATING WHETHER OR NOT THE CURRENT   */ 01381000
*/*                     COMMAND IS TO BE ENCODED INTO AN FDT OR JUST */ 01382000
*/*                     SCANNED FOR SYNTAX CHECKING.                 */ 01383000
*/*          RISTATUS - INTERNAL R/I CODE SET TO NON-ZERO CODE WHEN  */ 01384000
*/*                     AN ERROR HAS BEEN FOUND DURING R/I SCANNING. */ 01385000
*/*          LASTCC -   LAST SYSTEM CONDITION CODE                   */ 01386000
*/*          MAXCC -    MAXIMUM SYSTEM CONDITION CODE SO FAR         */ 01387000
*/*          SYNUNIT -  MOST RECENTLY EXTRACTED SYNTACTIC UNIT       */ 01388000
*/*          NESTLVL -  CURRENT 'IF' COMMAND NESTING LEVEL           */ 01389000
*/*          SINGLCMD - FLAG INDICATING THAT A SINGLE COMMAND (NOT A */ 01390000
*/*                     DO-GROUP) FOLLOWS AN 'IF' OR 'ELSE' COMMAND  */ 01391000
*/*          IFNEXT -   FLAG INDICATING THAT AN 'IF' COMMAND FOLLOWS */ 01392000
*/*                     AN 'IF' OR 'ELSE' COMMAND                    */ 01393000
*/*          NULLDO -   NUMBER OF NULL 'DO' COMMANDS FOUND AT CURRENT*/ 01394000
*/*                     'IF' NESTING LEVEL (A NULLDO COUNT EXISTS FOR*/ 01395000
*/*                     EACH LEVEL OF 'IF' NESTING)                  */ 01396000
*/*          DOFLAG -   INDICATES WHETHER OR NOT A DO-GROUP IS BEING */ 01397000
*/*                     SCANNED AT CURRENT 'IF' NESTING LEVEL        */ 01398000
*/*          THENFLAG - INDICATES WHETHER OR NOT THE 'THEN' PATH     */ 01399000
*/*                     COMMANDS ARE CURRENTLY BEING SCANNED AT      */ 01400000
*/*                     CURRENT LEVEL OF 'IF' NESTING.               */ 01401000
*/*          ELSEFLAG - FLAG INDICATING WHETHER OR NOT THE 'ELSE'    */ 01402000
*/*                     PATH COMMANDS ARE CURRENTLY BEING SCANNED    */ 01403000
*/*                     AT CURRENT LEVEL OF 'IF' NESTING             */ 01404000
*/*          SKIPFLAG - INDICATES WHETHER OR NOT COMMANDS AT CURRENT */ 01405000
*/*                     LEVEL OF 'IF' NESTING ARE TO BE EXECUTED.    */ 01406000
*/*          UNITINDX - LENGTH OF MOST RECENTLY EXTRACTED SYNTACTIC  */ 01407000
*/*                     UNIT.                                        */ 01408000
*/*          GETVERB -  FLAG INDICATING WHETHER OR NOT THE NEXT      */ 01409000
*/*                     INPUT COMMAND VERB HAS BEEN EXTRACTED.       */ 01410000
*/*                                                                  */ 01411000
*/*  OUTPUT -                                                        */ 01412000
*/*          VERBNAME - NAME OF FUNCTION COMMAND VERB WHOSE PARAMETER*/ 01413000
*/*                     PARAMETER SET WILL NEXT BE SCANNED.          */ 01414000
*/*          SCANONLY - FLAG NOTING WHETHER OR NOT NEXT FUNCTION     */ 01415000
*/*                     COMMAND IS TO BE EXECUTED.                   */ 01416000
*/*          IFNEXT -   FLAG SET 'ON' WHEN COMMAND FOLLOWING A 'THEN'*/ 01417000
*/*                     OR 'ELSE' IS AN 'IF' MODAL COMMAND.          */ 01418000
*/*          SINGLCMD - FLAG SET 'ON' WHEN A SINGLE COMMAND (NOT A   */ 01419000
*/*                     DO-GROUP) FOLLOWS THE 'THEN' OR 'ELSE' JUST  */ 01420000
*/*                     SCANNED.                                     */ 01421000
*/*          MAXCC -    MAX. SYSTEM CONDITION CODE; RESET BASED UPON */ 01422000
*/*                     EVALUATION OF 'IF' MODAL COMMANDS            */ 01423000
*/*          LASTCC -   LAST SYSTEM CONDITION CODE; SET BASED UPON   */ 01424000
*/*                     EVALUATION OF 'IF' COMMANDS AND UPON MODAL   */ 01425000
*/*                     COMMAND ERRORS FOUND.                        */ 01426000
*/*          EOFOK -    FLAG SET 'ON' WHEN SCANNING BETWEEN COMMANDS */ 01427000
*/*                     TO SIGNAL THAT EOF MAY BE PROPERLY FOUND.    */ 01428000
*/*          GETVERB -  FLAG SET 'ON' WHEN THE NEXT COMMAND VERB HAS */ 01429000
*/*                     ALREADY BEEN EXTRACTED FOLLOWING A 'THEN' OR */ 01430000
*/*                     'ELSE'.                                      */ 01431000
*/*          RISTATUS - R/I INTERNAL STATUS CODE; SET TO A NON-ZERO  */ 01432000
*/*                     CODE WHEN ANY ERROR IS FOUND.                */ 01433000
*/*          NESTLVL -  LEVEL OF 'IF' NESTING AT WHICH SCANNING IS   */ 01434000
*/*                     CURRENTLY TAKING PLACE.                      */ 01435000
*/*          NULLDO -   NULL DO COMMANDS ENCOUNTERED WHILE SCANNING  */ 01436000
*/*                     AT CURRENT LEVEL OF 'IF' NESTING             */ 01437000
*/*          DOFLAG -   FLAG SET 'ON' WHEN SCANNING WITHIN A DO-GROUP*/ 01438000
*/*                     AT CURRENT LEVEL OF 'IF' NESTING             */ 01439000
*/*                                                                  */ 01440000
*/********************************************************************/ 01441000
*GETNEXT:PROCEDURE;                                                0519 01442000
         B     @PB00004                                            0519 01443000
GETNEXT  STM   @14,@03,@SA00004                                    0519 01444000
         STM   @06,@12,@SA00004+24                                 0519 01445000
*        /************************************************************/ 01446000
*        /*                                                          */ 01447000
*        /* DATA DEFINITIONS FOR OBTAINING NEXT FUNCTION COMMAND     */ 01448000
*        /*                                                          */ 01449000
*        /************************************************************/ 01450000
*                                                                  0520 01451000
*        DCL RELATION CHAR(32);        /*FIELD TO CONTAIN EXTRACTED     01452000
*                                        'IF' COMMAND RELATIONAL   0520 01453000
*                                        EXPRESSION OR 'SET' COMMAND    01454000
*                                        ASSIGNMENT EXPRESSION.      */ 01455000
*        DCL RELSIZE  FIXED(15);       /*NUMBER OF EXTRACTED CHAR'S IN  01456000
*                                        ABOVE EXPRESSION.           */ 01457000
*        DCL PART1LEN FIXED(15);       /*LENGTH OF EITHER 'MAXCC' OR    01458000
*                                        'LASTCC' CONSTANT           */ 01459000
*                                                                  0522 01460000
*        DCL EQSIGN1  CHAR(1)          /*EQUAL SIGN                  */ 01461000
*                     CONSTANT('=');                               0523 01462000
*        DCL EQSIGN2  CHAR(2)          /*EQUAL SIGN                  */ 01463000
*                     CONSTANT('EQ');                              0524 01464000
*                                                                  0524 01465000
*        /*STATIC ERROR MESSAGE CODES                                */ 01466000
*        DCL BADELSE  FIXED(15)        /*IMPROPER 'ELSE' COMMAND     */ 01467000
*                     CONSTANT(28);                                0525 01468000
*        DCL BADDOEND FIXED(15)        /*IMPROPER 'DO' OR 'END'      */ 01469000
*                     CONSTANT(29);                                0526 01470000
*        DCL BADEXPR1 FIXED(15)        /*BAD EXPRESSION IN 'IF' CMD. */ 01471000
*                     CONSTANT(30);                                0527 01472000
*        DCL BADEXPR2 FIXED(15)        /*BAD EXPRESSION IN 'SET' CMD.*/ 01473000
*                     CONSTANT(31);                                0528 01474000
*        DCL NOTHEN   FIXED(15)        /*MISSING 'THEN' KEYWORD      */ 01475000
*                     CONSTANT(33);                                0529 01476000
*        DCL BADIFNST FIXED(15)        /*TOO MUCH 'IF' NESTING       */ 01477000
*                     CONSTANT(38);                                0530 01478000
*                                                                  0530 01479000
*        DCL 1 *,                                                  0531 01480000
*              2 NONMODAL BIT(1),      /*SIGNALS THAT A NON-MODAL  0531 01481000
*                                        COMMAND VERB HAS BEEN FOUND */ 01482000
*              2 REDOLVL0 BIT(1),      /*'IF' NESTING HAS RETURNED TO   01483000
*                                        A LEVEL OF ZERO FOLLOWING AN   01484000
*                                        'IF-THEN' MODAL COMMAND     */ 01485000
*              2 EXPREND  BIT(1),      /*SIGNALS THAT ALL OF THE   0531 01486000
*                                        RELATIONAL EXPRESSION HAS 0531 01487000
*                                        BEEN EXTRACTED.             */ 01488000
*              2 SINGLCMD BIT(1),      /*SIGNALS THAT A SINGLE COMMAND  01489000
*                                        (A NON-MODAL OR A 'SET' MODAL  01490000
*                                        COMMAND) FOLLOWS THE 'THEN'    01491000
*                                        OR 'ELSE' JUST SCANNED.     */ 01492000
*              2 IFNEXT   BIT(1),      /*AN 'IF' COMMAND FOLLOWS THE    01493000
*                                        THE CURRENT 'THEN' OR 'ELSE'*/ 01494000
*              2 GETVERB  BIT(1);      /*EXTRACT THE NEXT COMMAND VERB  01495000
*                                        BEFORE RESUMING SEARCH FOR     01496000
*                                        FUNCTION COMMAND.           */ 01497000
*        /************************************************************/ 01498000
*        /*                                                          */ 01499000
*        /*  ** GETNEXT ** GET NEXT FUNCTION COMMAND                 */ 01500000
*        /*                                                          */ 01501000
*        /************************************************************/ 01502000
*        IF GDTDBG = NULLPTR                                       0532 01503000
*          THEN;                                                   0532 01504000
         ICM   @05,15,GDTDBG(GDTPTR)                               0532 01505000
         BZ    @RT00532                                            0532 01506000
*          ELSE                                                    0534 01507000
*            CALL IDCDB010(GDTTBL,'RIGN');                         0534 01508000
*                                                                  0534 01509000
         ST    GDTPTR,@AL00001                                     0534 01510000
         LA    @05,@CC00987                                        0534 01511000
         ST    @05,@AL00001+4                                      0534 01512000
         MVI   @AL00001+4,X'80'                                    0534 01513000
         L     @15,GDTDBG(,GDTPTR)                                 0534 01514000
         LA    @01,@AL00001                                        0534 01515000
         BALR  @14,@15                                             0534 01516000
*        /************************************************************/ 01517000
*        /*                                                          */ 01518000
*        /* PICK UP THE FIRST COMMAND VERB ENCOUNTERED, BYPASSING    */ 01519000
*        /* DELIMITING SEPARATOR CHARACTERS WHICH SURROUND IT.       */ 01520000
*        /*                                                          */ 01521000
*        /************************************************************/ 01522000
*        NULLCMD=NO;                                               0535 01523000
@RT00532 NI    NULLCMD,B'10111111'                                 0535 01524000
*        COMMENT=NO;                                               0536 01525000
*        FIRSTCHR=YES;                                             0537 01526000
         OI    FIRSTCHR,B'00000100'                                0537 01527000
         NI    COMMENT,B'10111111'                                 0537 01528000
*        CHAR1=BLANK;                                              0538 01529000
*                                                                  0538 01530000
         MVI   CHAR1,C' '                                          0538 01531000
*        CALL SCANSEP(NO);                                         0539 01532000
         LA    @01,@AL00539                                        0539 01533000
         BAL   @14,SCANSEP                                         0539 01534000
*        CALL NXTFIELD(VERBFLD);                                   0540 01535000
         LA    @01,@AL00540                                        0540 01536000
         BAL   @14,NXTFIELD                                        0540 01537000
*        CALL SCANSEP(NO);                                         0541 01538000
*                                                                  0541 01539000
         LA    @01,@AL00541                                        0541 01540000
         BAL   @14,SCANSEP                                         0541 01541000
*        /************************************************************/ 01542000
*        /*                                                          */ 01543000
*        /* SCAN AND INTERPRET INPUT COMMANDS UNTIL A NON-MODAL      */ 01544000
*        /* (FUNCTION) COMMAND IS FOUND.  EACH PASS OF THE FOLLOWING */ 01545000
*        /* SECTION OF CODE BEGINS BY COMPUTING THE CURRENT MAXIMUM  */ 01546000
*        /* SYSTEM CONDITION CODE AND EXAMINING A VERB NAME JUST     */ 01547000
*        /* EXTRACTED.  APPROPRIATE FLAGS ARE SET BASED UPON THE     */ 01548000
*        /* MODAL STATEMENTS ENCOUNTERED.                            */ 01549000
*        /*                                                          */ 01550000
*        /************************************************************/ 01551000
*        NONMODAL=NO;                                              0542 01552000
*        IFNEXT=NO;                                                0543 01553000
*        SINGLCMD=NO;                                              0544 01554000
         NI    NONMODAL,B'01100111'                                0544 01555000
*DOLOOP10:DO WHILE(NONMODAL=NO & RISTATUS=0);                      0545 01556000
DOLOOP10 B     @DE00545                                            0545 01557000
@DL00545 DS    0H                                                  0546 01558000
*          EOFOK=NO;                                               0546 01559000
         NI    EOFOK,B'10111111'                                   0546 01560000
*          GETVERB=YES;                                            0547 01561000
*          REDOLVL0=NO;                                            0548 01562000
*                                                                  0548 01563000
         OI    GETVERB,B'00000100'                                 0548 01564000
         NI    REDOLVL0,B'10111111'                                0548 01565000
*          /**********************************************************/ 01566000
*          /*                                                        */ 01567000
*          /* IF CURRENTLY NO 'IF' MODAL COMMAND NESTING, CHECK      */ 01568000
*          /* THE EXTRACTED VERB NAME TO SEE IF IT IS A MODAL COMMAND*/ 01569000
*          /* VERB.  IF SO, INTERPRET THAT MODAL COMMAND, SETTING    */ 01570000
*          /* CONTROL FLAGS; IF NOT A MODAL, 'GETNEXT' IS FINISHED.  */ 01571000
*          /*                                                        */ 01572000
*          /**********************************************************/ 01573000
*          IF NESTLVL=0                                            0549 01574000
*            THEN                                                  0549 01575000
         L     @02,GDTRIH(,GDTPTR)                                 0549 01576000
         CLI   NESTLVL(@02),0                                      0549 01577000
         BNE   @RF00549                                            0549 01578000
*              IF SYNUNIT=IFSYM                                    0550 01579000
*                THEN                                              0550 01580000
*                                                                  0550 01581000
         L     @02,KWTBLPTR(,@02)                                  0550 01582000
         CLC   SYNUNIT(9),IFSYM(@02)                               0550 01583000
         BNE   @RF00550                                            0550 01584000
*                  CALL MODALIF;                                   0551 01585000
*                                                                  0551 01586000
         BAL   @14,MODALIF                                         0551 01587000
*                ELSE                                              0552 01588000
*                  IF SYNUNIT=SETSYM                               0552 01589000
*                    THEN                                          0552 01590000
*                                                                  0552 01591000
         B     @RC00550                                            0552 01592000
@RF00550 L     @02,GDTRIH(,GDTPTR)                                 0552 01593000
         L     @02,KWTBLPTR(,@02)                                  0552 01594000
         CLC   SYNUNIT(9),SETSYM(@02)                              0552 01595000
         BNE   @RF00552                                            0552 01596000
*                      CALL MODALSET;                              0553 01597000
*                                                                  0553 01598000
         BAL   @14,MODALSET                                        0553 01599000
*                    ELSE                                          0554 01600000
*                      IF SYNUNIT=DOSYM | SYNUNIT=ENDSYM           0554 01601000
*                        THEN                                      0554 01602000
*                                                                  0554 01603000
         B     @RC00552                                            0554 01604000
@RF00552 L     @02,GDTRIH(,GDTPTR)                                 0554 01605000
         L     @02,KWTBLPTR(,@02)                                  0554 01606000
         CLC   SYNUNIT(9),DOSYM(@02)                               0554 01607000
         BE    @RT00554                                            0554 01608000
         CLC   SYNUNIT(9),ENDSYM(@02)                              0554 01609000
         BNE   @RF00554                                            0554 01610000
@RT00554 DS    0H                                                  0555 01611000
*                          /******************************************/ 01612000
*                          /*                                        */ 01613000
*                          /* 'DO' AND 'END' COMMANDS ARE SIMPLY     */ 01614000
*                          /* IGNORED AT THIS LEVEL.                 */ 01615000
*                          /*                                        */ 01616000
*                          /******************************************/ 01617000
*                                                                  0555 01618000
*                          CALL BYPASTRM;                          0555 01619000
*                                                                  0555 01620000
         BAL   @14,BYPASTRM                                        0555 01621000
*                        ELSE                                      0556 01622000
*                          IF SYNUNIT=ELSESYM                      0556 01623000
*                            THEN                                  0556 01624000
*                                                                  0556 01625000
         B     @RC00554                                            0556 01626000
@RF00554 L     @02,GDTRIH(,GDTPTR)                                 0556 01627000
         L     @02,KWTBLPTR(,@02)                                  0556 01628000
         CLC   SYNUNIT(9),ELSESYM(@02)                             0556 01629000
         BNE   @RF00556                                            0556 01630000
*                              /**************************************/ 01631000
*                              /*                                    */ 01632000
*                              /* AN 'ELSE' STATEMENT IS IN ERROR IF */ 01633000
*                              /* IT APPEARS AT THIS LEVEL.          */ 01634000
*                              /*                                    */ 01635000
*                              /**************************************/ 01636000
*                              DO;                                 0557 01637000
*                              LASTCC=TERMERR;                     0558 01638000
         MVC   LASTCC(2),@CH00482                                  0558 01639000
*                              RISTATUS=BADELSE;                   0559 01640000
         MVC   RISTATUS(2),@CH00970                                0559 01641000
*                              END;                                0560 01642000
*                            ELSE                                  0561 01643000
*                              NONMODAL=YES;                       0561 01644000
*                                                                  0561 01645000
         B     @RC00556                                            0561 01646000
@RF00556 OI    NONMODAL,B'10000000'                                0561 01647000
*          /********************************************************/   01648000
*          /*                                                      */   01649000
*          /* WHEN WITHIN SOME LEVEL OF 'IF' COMMAND NESTING,      */   01650000
*          /* MODAL COMMANDS ARE CHECKED TO BE SURE THAT THEY OCCUR*/   01651000
*          /* PROPERLY IN THE MODAL COMMAND STRUCTURE.  IF OKAY,   */   01652000
*          /* THE COMMAND IS INTERPRETED AND CONTROL FLAGS ARE SET.*/   01653000
*          /* IF NOT A MODAL COMMAND, 'GETNEXT' IS FINISHED.       */   01654000
*          /*                                                      */   01655000
*          /********************************************************/   01656000
*          ELSE                                                    0562 01657000
*                                                                  0562 01658000
*            /******************************************************/   01659000
*            /*                                                    */   01660000
*            /* AN 'ELSE' COMMAND MUST HAVE A MATCHING 'IF-THEN'   */   01661000
*            /* MODAL COMMAND OR IT IS AN ERROR.                   */   01662000
*            /*                                                    */   01663000
*            /******************************************************/   01664000
*            IF SYNUNIT=ELSESYM                                    0562 01665000
*              THEN                                                0562 01666000
         B     @RC00549                                            0562 01667000
@RF00549 L     @02,GDTRIH(,GDTPTR)                                 0562 01668000
         L     @01,KWTBLPTR(,@02)                                  0562 01669000
         CLC   SYNUNIT(9),ELSESYM(@01)                             0562 01670000
         BNE   @RF00562                                            0562 01671000
*                IF THENFLAG(NESTLVL)=ON & DOFLAG(NESTLVL)=OFF     0563 01672000
*                  THEN                                            0563 01673000
*                                                                  0563 01674000
         SLR   @15,@15                                             0563 01675000
         IC    @15,NESTLVL(,@02)                                   0563 01676000
         ALR   @15,@15                                             0563 01677000
         ALR   @02,@15                                             0563 01678000
         TM    THENFLAG-2(@02),B'01000000'                         0563 01679000
         BNO   @RF00563                                            0563 01680000
         TM    DOFLAG-2(@02),B'10000000'                           0563 01681000
         BNZ   @RF00563                                            0563 01682000
*                    CALL MODLELSE;                                0564 01683000
*                                                                  0564 01684000
         BAL   @14,MODLELSE                                        0564 01685000
*                  ELSE                                            0565 01686000
*                    DO;                                           0565 01687000
         B     @RC00563                                            0565 01688000
@RF00563 DS    0H                                                  0566 01689000
*                    LASTCC=TERMERR;                               0566 01690000
         MVC   LASTCC(2),@CH00482                                  0566 01691000
*                    RISTATUS=BADELSE;                             0567 01692000
         MVC   RISTATUS(2),@CH00970                                0567 01693000
*                    END;                                          0568 01694000
*              ELSE                                                0569 01695000
*DOGRP20:        DO;                                               0569 01696000
         B     @RC00562                                            0569 01697000
@RF00562 DS    0H                                                  0569 01698000
DOGRP20  DS    0H                                                  0570 01699000
*                OLDERID2 = NEWERID2;                              0570 01700000
         L     @02,GDTTR2(,GDTPTR)                                 0570 01701000
         MVC   @TS00001(95),NEWERID2(@02)                          0570 01702000
         MVC   OLDERID2(95,@02),@TS00001                           0570 01703000
*                NEWID2='RI04';                                    0571 01704000
*                                                                  0571 01705000
         MVC   NEWID2(4,@02),@CC00997                              0571 01706000
*                /****************************************************/ 01707000
*                /*                                                  */ 01708000
*                /* IF THERE IS NO MATCHING 'ELSE' FOR ONE OR MORE   */ 01709000
*                /* 'THEN' KEYWORDS, THEN ADJUST THE 'IF' NESTING    */ 01710000
*                /* LEVEL ONE LESS DEEP FOR EACH NONMATCH            */ 01711000
*                /*                                                  */ 01712000
*                /****************************************************/ 01713000
*                DO WHILE(NESTLVL>0 & SINGLCMD=NO & IFNEXT=NO &    0572 01714000
*                         DOFLAG(NESTLVL)=OFF);                    0572 01715000
         B     @DE00572                                            0572 01716000
@DL00572 DS    0H                                                  0573 01717000
*                  NESTLVL=NESTLVL-1;                              0573 01718000
         L     @02,GDTRIH(,GDTPTR)                                 0573 01719000
         SLR   @15,@15                                             0573 01720000
         IC    @15,NESTLVL(,@02)                                   0573 01721000
         BCTR  @15,0                                               0573 01722000
         STC   @15,NESTLVL(,@02)                                   0573 01723000
*                END;                                              0574 01724000
@DE00572 L     @02,GDTRIH(,GDTPTR)                                 0574 01725000
         CLI   NESTLVL(@02),0                                      0574 01726000
         BNH   @DC00572                                            0574 01727000
         TM    SINGLCMD,B'00011000'                                0574 01728000
         BNZ   @DC00572                                            0574 01729000
         SLR   @15,@15                                             0574 01730000
         IC    @15,NESTLVL(,@02)                                   0574 01731000
         ALR   @15,@15                                             0574 01732000
         ALR   @02,@15                                             0574 01733000
         TM    DOFLAG-2(@02),B'10000000'                           0574 01734000
         BZ    @DL00572                                            0574 01735000
@DC00572 DS    0H                                                  0575 01736000
*                IF NESTLVL=0                                      0575 01737000
*                  THEN                                            0575 01738000
         L     @02,GDTRIH(,GDTPTR)                                 0575 01739000
         CLI   NESTLVL(@02),0                                      0575 01740000
         BNE   @RF00575                                            0575 01741000
*                    REDOLVL0=YES;                                 0576 01742000
         OI    REDOLVL0,B'01000000'                                0576 01743000
*                  ELSE                                            0577 01744000
*                    IF SYNUNIT=IFSYM                              0577 01745000
*                      THEN                                        0577 01746000
*                                                                  0577 01747000
         B     @RC00575                                            0577 01748000
@RF00575 L     @02,GDTRIH(,GDTPTR)                                 0577 01749000
         L     @02,KWTBLPTR(,@02)                                  0577 01750000
         CLC   SYNUNIT(9),IFSYM(@02)                               0577 01751000
         BNE   @RF00577                                            0577 01752000
*                        CALL MODALIF;                             0578 01753000
*                                                                  0578 01754000
         BAL   @14,MODALIF                                         0578 01755000
*                      ELSE                                        0579 01756000
*                                                                  0579 01757000
*                        /********************************************/ 01758000
*                        /*                                          */ 01759000
*                        /* AN 'END' COMMAND NULLIFIES A MATCHING    */ 01760000
*                        /* 'DO' COMMAND. HOWEVER, IT IS AN ERROR IF */ 01761000
*                        /* NO MATCHING 'DO' EXISTS.  IF ALL IS OKAY,*/ 01762000
*                        /* THE 'END' IS BYPASSED & SCANNING RESUMES */ 01763000
*                        /*                                          */ 01764000
*                        /********************************************/ 01765000
*                        IF SYNUNIT=ENDSYM                         0579 01766000
*                          THEN                                    0579 01767000
         B     @RC00577                                            0579 01768000
@RF00577 L     @02,GDTRIH(,GDTPTR)                                 0579 01769000
         L     @01,KWTBLPTR(,@02)                                  0579 01770000
         CLC   SYNUNIT(9),ENDSYM(@01)                              0579 01771000
         BNE   @RF00579                                            0579 01772000
*                            DO;                                   0580 01773000
*                            IF NULLDO(NESTLVL)=0                  0581 01774000
*                              THEN                                0581 01775000
         SLR   @15,@15                                             0581 01776000
         IC    @15,NESTLVL(,@02)                                   0581 01777000
         LR    @14,@15                                             0581 01778000
         ALR   @14,@14                                             0581 01779000
         SLR   @01,@01                                             0581 01780000
         IC    @01,NULLDO-2(@14,@02)                               0581 01781000
         CH    @01,@CH00125                                        0581 01782000
         BNE   @RF00581                                            0581 01783000
*                                IF DOFLAG(NESTLVL)=ON             0582 01784000
*                                  THEN                            0582 01785000
         ST    @14,@TF00001                                        0582 01786000
         ALR   @14,@02                                             0582 01787000
         TM    DOFLAG-2(@14),B'10000000'                           0582 01788000
         BNO   @RF00582                                            0582 01789000
*                                    DO;                           0583 01790000
*                                    DOFLAG(NESTLVL)=OFF;          0584 01791000
         LR    @01,@02                                             0584 01792000
         AL    @01,@TF00001                                        0584 01793000
         NI    DOFLAG-2(@01),B'01111111'                           0584 01794000
*                                    IF ELSEFLAG(NESTLVL)=ON       0585 01795000
*                                      THEN                        0585 01796000
         LR    @01,@02                                             0585 01797000
         AL    @01,@TF00001                                        0585 01798000
         TM    ELSEFLAG-2(@01),B'00100000'                         0585 01799000
         BNO   @RF00585                                            0585 01800000
*                                        NESTLVL=NESTLVL-1;        0586 01801000
         BCTR  @15,0                                               0586 01802000
         STC   @15,NESTLVL(,@02)                                   0586 01803000
*                                    END;                          0587 01804000
*                                  ELSE                            0588 01805000
*                                    DO;                           0588 01806000
         B     @RC00582                                            0588 01807000
@RF00582 DS    0H                                                  0589 01808000
*                                    LASTCC=TERMERR;               0589 01809000
         MVC   LASTCC(2),@CH00482                                  0589 01810000
*                                    RISTATUS=BADDOEND;            0590 01811000
         MVC   RISTATUS(2),@CH00972                                0590 01812000
*                                    END;                          0591 01813000
*                              ELSE                                0592 01814000
*                                NULLDO(NESTLVL)=NULLDO(NESTLVL)-1;     01815000
         B     @RC00581                                            0592 01816000
@RF00581 L     @02,GDTRIH(,GDTPTR)                                 0592 01817000
         SLR   @15,@15                                             0592 01818000
         IC    @15,NESTLVL(,@02)                                   0592 01819000
         ALR   @15,@15                                             0592 01820000
         SLR   @14,@14                                             0592 01821000
         IC    @14,NULLDO-2(@15,@02)                               0592 01822000
         BCTR  @14,0                                               0592 01823000
         STC   @14,NULLDO-2(@15,@02)                               0592 01824000
*                            IF SINGLCMD=YES                       0593 01825000
*                              THEN                                0593 01826000
@RC00581 TM    SINGLCMD,B'00010000'                                0593 01827000
         BNO   @RF00593                                            0593 01828000
*                                DO;                               0594 01829000
*                                LASTCC=TERMERR;                   0595 01830000
         MVC   LASTCC(2),@CH00482                                  0595 01831000
*                                RISTATUS=BADDOEND;                0596 01832000
         MVC   RISTATUS(2),@CH00972                                0596 01833000
*                                END;                              0597 01834000
*                              ELSE                                0598 01835000
*                                                                  0598 01836000
*                                CALL BYPASTRM;                    0598 01837000
*                                                                  0598 01838000
         B     @RC00593                                            0598 01839000
@RF00593 BAL   @14,BYPASTRM                                        0598 01840000
*                            END;                                  0599 01841000
*                          ELSE                                    0600 01842000
*                            IF SYNUNIT=SETSYM                     0600 01843000
*                              THEN                                0600 01844000
*                                                                  0600 01845000
         B     @RC00579                                            0600 01846000
@RF00579 L     @02,GDTRIH(,GDTPTR)                                 0600 01847000
         L     @02,KWTBLPTR(,@02)                                  0600 01848000
         CLC   SYNUNIT(9),SETSYM(@02)                              0600 01849000
         BNE   @RF00600                                            0600 01850000
*                                CALL MODALSET;                    0601 01851000
*                                                                  0601 01852000
         BAL   @14,MODALSET                                        0601 01853000
*                              ELSE                                0602 01854000
*                                                                  0602 01855000
*                                /************************************/ 01856000
*                                /*                                  */ 01857000
*                                /* A 'DO' COMMAND NOT FOLLOWING AN  */ 01858000
*                                /* 'IF' OR AN 'ELSE' COMMAND IS JUST*/ 01859000
*                                /* BYPASSED AFTER NOTING THAT THE   */ 01860000
*                                /* 'END' WILL BE BYPASSED TOO       */ 01861000
*                                /*                                  */ 01862000
*                                /************************************/ 01863000
*                                IF SYNUNIT=DOSYM                  0602 01864000
*                                  THEN                            0602 01865000
         B     @RC00600                                            0602 01866000
@RF00600 L     @02,GDTRIH(,GDTPTR)                                 0602 01867000
         L     @01,KWTBLPTR(,@02)                                  0602 01868000
         CLC   SYNUNIT(9),DOSYM(@01)                               0602 01869000
         BNE   @RF00602                                            0602 01870000
*                                    DO;                           0603 01871000
*                                    NULLDO(NESTLVL)=NULLDO(NESTLVL)+1; 01872000
*                                                                  0604 01873000
         SLR   @15,@15                                             0604 01874000
         IC    @15,NESTLVL(,@02)                                   0604 01875000
         ALR   @15,@15                                             0604 01876000
         LA    @14,1                                               0604 01877000
         SLR   @01,@01                                             0604 01878000
         IC    @01,NULLDO-2(@15,@02)                               0604 01879000
         ALR   @14,@01                                             0604 01880000
         STC   @14,NULLDO-2(@15,@02)                               0604 01881000
*                                    CALL BYPASTRM;                0605 01882000
*                                                                  0605 01883000
         BAL   @14,BYPASTRM                                        0605 01884000
*                                    END;                          0606 01885000
*                                  ELSE                            0607 01886000
*                                                                  0607 01887000
*                                    /********************************/ 01888000
*                                    /*                              */ 01889000
*                                    /* IF NOT A MODAL COMMAND, CHECK*/ 01890000
*                                    /* WHETHER THE CURRENT GROUP OF */ 01891000
*                                    /* FUNCTION COMMANDS ARE JUST   */ 01892000
*                                    /* BEING SCANNED OR NOT. ALSO,  */ 01893000
*                                    /* MOVE ONE 'IF' NESTING LEVEL  */ 01894000
*                                    /* LESS DEEP IF THIS NON-MODAL  */ 01895000
*                                    /* IS A SINGLE COMMAND FOLLOWING*/ 01896000
*                                    /* AN 'ELSE' COMMAND.           */ 01897000
*                                    /*                              */ 01898000
*                                    /********************************/ 01899000
*                                    DO;                           0607 01900000
         B     @RC00602                                            0607 01901000
@RF00602 DS    0H                                                  0608 01902000
*                                    IF SKIPFLAG(NESTLVL)=ON       0608 01903000
*                                      THEN                        0608 01904000
         L     @02,GDTRIH(,GDTPTR)                                 0608 01905000
         SLR   @15,@15                                             0608 01906000
         IC    @15,NESTLVL(,@02)                                   0608 01907000
         ALR   @15,@15                                             0608 01908000
         ALR   @02,@15                                             0608 01909000
         TM    SKIPFLAG-2(@02),B'00010000'                         0608 01910000
         BNO   @RF00608                                            0608 01911000
*                                        SCANONLY=YES;             0609 01912000
         OI    SCANONLY,B'00010000'                                0609 01913000
*                                    NONMODAL=YES;                 0610 01914000
@RF00608 OI    NONMODAL,B'10000000'                                0610 01915000
*                                    IF SINGLCMD=YES               0611 01916000
*                                      THEN                        0611 01917000
         TM    SINGLCMD,B'00010000'                                0611 01918000
         BNO   @RF00611                                            0611 01919000
*                                        DO;                       0612 01920000
*                                        SINGLCMD=NO;              0613 01921000
         NI    SINGLCMD,B'11101111'                                0613 01922000
*                                        IF ELSEFLAG(NESTLVL)=ON   0614 01923000
*                                          THEN                    0614 01924000
         L     @02,GDTRIH(,GDTPTR)                                 0614 01925000
         SLR   @15,@15                                             0614 01926000
         IC    @15,NESTLVL(,@02)                                   0614 01927000
         LR    @14,@15                                             0614 01928000
         ALR   @14,@14                                             0614 01929000
         ALR   @14,@02                                             0614 01930000
         TM    ELSEFLAG-2(@14),B'00100000'                         0614 01931000
         BNO   @RF00614                                            0614 01932000
*                                            NESTLVL=NESTLVL-1;    0615 01933000
         BCTR  @15,0                                               0615 01934000
         STC   @15,NESTLVL(,@02)                                   0615 01935000
*                                        END;                      0616 01936000
@RF00614 DS    0H                                                  0617 01937000
*                                    END;                          0617 01938000
@RF00611 DS    0H                                                  0618 01939000
*                END DOGRP20;                                      0618 01940000
*                                                                  0618 01941000
@RC00602 DS    0H                                                  0618 01942000
@RC00600 DS    0H                                                  0618 01943000
@RC00579 DS    0H                                                  0618 01944000
@RC00577 DS    0H                                                  0618 01945000
@RC00575 DS    0H                                                  0619 01946000
*          IF RISTATUS=0 & REDOLVL0=NO                             0619 01947000
*            THEN                                                  0619 01948000
@RC00562 DS    0H                                                  0619 01949000
@RC00549 ICM   @02,3,RISTATUS                                      0619 01950000
         BNZ   @RF00619                                            0619 01951000
         TM    REDOLVL0,B'01000000'                                0619 01952000
         BNZ   @RF00619                                            0619 01953000
*DOGRP25:      DO;                                                 0620 01954000
DOGRP25  DS    0H                                                  0621 01955000
*              OLDERID2 = NEWERID2;                                0621 01956000
         L     @02,GDTTR2(,GDTPTR)                                 0621 01957000
         MVC   @TS00001(95),NEWERID2(@02)                          0621 01958000
         MVC   OLDERID2(95,@02),@TS00001                           0621 01959000
*              NEWID2='RI05';                                      0622 01960000
*                                                                  0622 01961000
         MVC   NEWID2(4,@02),@CC01000                              0622 01962000
*              /******************************************************/ 01963000
*              /*                                                    */ 01964000
*              /* IF THE LENGTH OF THE EXTRACTED COMMAND VERB NAME IS*/ 01965000
*              /* ZERO, THEN IT IS A NULL COMMAND.  IT IS THEN SIMPLY*/ 01966000
*              /* BYPASSED AND SCANNING RESUMES IN SEARCH OF THE     */ 01967000
*              /* NEXT FUNCTION COMMAND TO BE SCANNED.               */ 01968000
*              /*                                                    */ 01969000
*              /******************************************************/ 01970000
*              IF UNITINDX=0 & NONMODAL=YES                        0623 01971000
*                THEN                                              0623 01972000
         LTR   UNITINDX,UNITINDX                                   0623 01973000
         BNZ   @RF00623                                            0623 01974000
         TM    NONMODAL,B'10000000'                                0623 01975000
         BNO   @RF00623                                            0623 01976000
*                  DO;                                             0624 01977000
*                  NULLCMD=YES;                                    0625 01978000
         OI    NULLCMD,B'01000000'                                 0625 01979000
*                  NONMODAL=NO;                                    0626 01980000
*                                                                  0626 01981000
         NI    NONMODAL,B'01111111'                                0626 01982000
*                  CALL BYPASTRM;                                  0627 01983000
*                                                                  0627 01984000
         BAL   @14,BYPASTRM                                        0627 01985000
*                  SCANONLY=NO;                                    0628 01986000
         NI    SCANONLY,B'11101111'                                0628 01987000
*                  END;                                            0629 01988000
*                                                                  0629 01989000
*              /******************************************************/ 01990000
*              /*                                                    */ 01991000
*              /* IF A GOOD FUNCTION COMMAND HAS NOT BEEN FOUND YET, */ 01992000
*              /* GET THE NEXT COMMAND VERB AND RESUME THE SCAN LOOP.*/ 01993000
*              /*                                                    */ 01994000
*              /******************************************************/ 01995000
*              IF NONMODAL=NO  & GETVERB=YES                       0630 01996000
*                THEN                                              0630 01997000
@RF00623 TM    GETVERB,B'00000100'                                 0630 01998000
         BNO   @RF00630                                            0630 01999000
         TM    NONMODAL,B'10000000'                                0630 02000000
         BNZ   @RF00630                                            0630 02001000
*                  DO;                                             0631 02002000
*                                                                  0631 02003000
*                  CALL SCANSEP(YES);                              0632 02004000
         LA    @01,@AL00632                                        0632 02005000
         BAL   @14,SCANSEP                                         0632 02006000
*                  CALL NXTFIELD(VERBFLD);                         0633 02007000
         LA    @01,@AL00633                                        0633 02008000
         BAL   @14,NXTFIELD                                        0633 02009000
*                  CALL SCANSEP(NO);                               0634 02010000
*                                                                  0634 02011000
         LA    @01,@AL00634                                        0634 02012000
         BAL   @14,SCANSEP                                         0634 02013000
*                  END;                                            0635 02014000
*                ELSE                                              0636 02015000
*                                                                  0636 02016000
*                  /**************************************************/ 02017000
*                  /*                                                */ 02018000
*                  /* IF A NON-MODAL, NON-NULL COMMAND HAS BEEN FOUND*/ 02019000
*                  /* THEN PICK IT UP AS THE FUNCTION COMMAND VERB   */ 02020000
*                  /* NAME IF IT DOESN'T EXCEED MAX. VERB NAME LENGTH*/ 02021000
*                  /*                                                */ 02022000
*                  /**************************************************/ 02023000
*                  IF UNITINDX <= VERBMAX                          0636 02024000
*                    THEN                                          0636 02025000
         B     @RC00630                                            0636 02026000
@RF00630 CH    UNITINDX,@CH00042                                   0636 02027000
         BH    @RF00636                                            0636 02028000
*                      VERBNAME=SYNUNIT;                           0637 02029000
         MVC   VERBNAME(8),SYNUNIT                                 0637 02030000
*                    ELSE                                          0638 02031000
*                                                                  0638 02032000
*                      CALL ERROR2(BADVERB2,LENGTH(ERRFIELD),      0638 02033000
*                                  ADDR(ERRFIELD));                0638 02034000
*                                                                  0638 02035000
*                                                                  0638 02036000
         B     @RC00636                                            0638 02037000
@RF00636 MVC   @AL00001(8),@AL00638                                0638 02038000
         LA    @02,ERRFIELD                                        0638 02039000
         ST    @02,@AFTEMPS                                        0638 02040000
         LA    @02,@AFTEMPS                                        0638 02041000
         ST    @02,@AL00001+8                                      0638 02042000
         LA    @01,@AL00001                                        0638 02043000
         BAL   @14,ERROR2                                          0638 02044000
*              END DOGRP25;                                        0639 02045000
@RC00636 DS    0H                                                  0639 02046000
@RC00630 DS    0H                                                  0640 02047000
*        END DOLOOP10;                                             0640 02048000
@RF00619 DS    0H                                                  0640 02049000
@DE00545 TM    NONMODAL,B'10000000'                                0640 02050000
         BNZ   @DC00545                                            0640 02051000
         ICM   @02,3,RISTATUS                                      0640 02052000
         BZ    @DL00545                                            0640 02053000
@DC00545 DS    0H                                                  0641 02054000
*/********************************************************************/ 02055000
*/*                                                                  */ 02056000
*/*  PROCEDURE NAME - MODALSET                                       */ 02057000
*/*                                                                  */ 02058000
*/*  FUNCTION - THIS ROUTINE SCANS AND INTERPRETS THE PART OF THE    */ 02059000
*/*             MODAL 'SET' COMMAND WHICH FOLLOWS THE VERB NAME      */ 02060000
*/*             'SET'.  IF THE SYNTAX IS OKAY, THE PROVIDED NUMBER   */ 02061000
*/*             IS ASSIGNED AS THE VALUE OF THE CONDITION CODE.      */ 02062000
*/*                                                                  */ 02063000
*/*  INPUT -                                                         */ 02064000
*/*          NESTLVL - LEVEL OF 'IF' NESTING AT WHICH SCANNING IS    */ 02065000
*/*                    CURRENTLY TAKING PLACE                        */ 02066000
*/*          ELSEFLAG- FLAG SET 'ON' WHILE SCANNING ELSE-PATH        */ 02067000
*/*                    COMMANDS AT CURRENT 'IF' NESTING LEVEL        */ 02068000
*/*          SKIPFLAG- FLAG SET 'ON' WHILE SCANNING COMMAND(S) WHICH */ 02069000
*/*                    IS NOT TO BE ENCODED INTO AN FDT & EXECUTED.  */ 02070000
*/*          RISTATUS- STATUS CODE SET TO A NON-ZERO CODE WHEN ANY   */ 02071000
*/*                    ERROR IS ENCOUNTERED.                         */ 02072000
*/*          LASTCC -  LAST SYSTEM COND. CODE; MAY BE RESET BY 'SET' */ 02073000
*/*                    COMMAND OR BY OCCURRENCE OF AN ERROR.         */ 02074000
*/*          MAXCC -   MAXIMUM SYSTEM COND. CODE; MAY BE RESET BY    */ 02075000
*/*                    'SET' COMMAND.                                */ 02076000
*/*          SYNUNIT - ALL OR PART OF 'SET' COMMAND ASSIGNMENT       */ 02077000
*/*                    EXPRESSION.                                   */ 02078000
*/*          UNITINDX- LENGTH OF ABOVE SEGMENT OF ASSIGNMENT EXPR.   */ 02079000
*/*          CNVRTWRD- CONVERTED DECIMAL NUMBER IN BINARY FORM FROM  */ 02080000
*/*                    'SET' COMMAND ASSIGNMENT EXPRESSION.          */ 02081000
*/*          SINGLCMD- FLAG SET 'ON' WHEN A SINGLE COMMAND FOLLOWS A */ 02082000
*/*                    'THEN' OR 'ELSE'                              */ 02083000
*/*          CHAR1 -   INPUT CHARACTER MOST RECENTLY EXTRACTED.      */ 02084000
*/*                                                                  */ 02085000
*/*  OUTPUT -                                                        */ 02086000
*/*          SINGLCMD- SEE 'INPUT'                                   */ 02087000
*/*          NESTLVL - LEVEL OF 'IF' NESTING AT WHICH SCANNING WILL  */ 02088000
*/*                    BE DONE FOLLOWING THIS 'SET' COMMAND.         */ 02089000
*/*          RISTATUS- SEE 'INPUT'                                   */ 02090000
*/*          SYNUNIT - DECIMAL NUMBER FROM 'SET' COMMAND TO BE       */ 02091000
*/*                    CONVERTED AND ASSIGNED AS THE COND. CODE VALUE*/ 02092000
*/*          UNITINDX- LENGTH OF DECIMAL NUMBER (EBCDIC FORM)        */ 02093000
*/*          LASTCC -  SEE 'INPUT'                                   */ 02094000
*/*          MAXCC -   SEE 'INPUT'                                   */ 02095000
*/*                                                                  */ 02096000
*/********************************************************************/ 02097000
*MODALSET:PROCEDURE;                                               0641 02098000
         B     @PB00005                                            0641 02099000
MODALSET STM   @14,@03,@SA00005                                    0641 02100000
         STM   @06,@12,@SA00005+24                                 0641 02101000
*        /************************************************************/ 02102000
*        /*                                                          */ 02103000
*        /*  ** MODALSET **  INTERPRET MODAL 'SET' COMMAND           */ 02104000
*        /*                                                          */ 02105000
*        /************************************************************/ 02106000
*        IF GDTDBG = NULLPTR                                       0642 02107000
*          THEN;                                                   0642 02108000
         ICM   @02,15,GDTDBG(GDTPTR)                               0642 02109000
         BZ    @RT00642                                            0642 02110000
*          ELSE                                                    0644 02111000
*            CALL IDCDB010(GDTTBL,'RIMS');                         0644 02112000
*                                                                  0644 02113000
         ST    GDTPTR,@AL00001                                     0644 02114000
         LA    @02,@CC01004                                        0644 02115000
         ST    @02,@AL00001+4                                      0644 02116000
         MVI   @AL00001+4,X'80'                                    0644 02117000
         L     @15,GDTDBG(,GDTPTR)                                 0644 02118000
         LA    @01,@AL00001                                        0644 02119000
         BALR  @14,@15                                             0644 02120000
*        /************************************************************/ 02121000
*        /*                                                          */ 02122000
*        /* EXTRACT THE ELEMENTS OF THE ASSIGNMENT EXPRESSION (THERE */ 02123000
*        /* MAY OR MAY NOT BE DELIMITERS TO BE IGNORED SURROUNDING   */ 02124000
*        /* THE EQUAL SIGN), CHECKING TO BE SURE THAT THE MAXIMUM    */ 02125000
*        /* POSSIBLE LENGTH FOR SUCH AN EXPRESSION IS NOT EXCEEDED.  */ 02126000
*        /*                                                          */ 02127000
*        /************************************************************/ 02128000
*        RELATION=BLANK;                                           0645 02129000
@RT00642 MVI   RELATION+1,C' '                                     0645 02130000
         MVC   RELATION+2(30),RELATION+1                           0645 02131000
         MVI   RELATION,C' '                                       0645 02132000
*        RELSIZE=0;                                                0646 02133000
         SLR   RELSIZE,RELSIZE                                     0646 02134000
*        EXPREND=NO;                                               0647 02135000
         NI    EXPREND,B'11011111'                                 0647 02136000
*        DO WHILE(EXPREND=NO);                                     0648 02137000
*                                                                  0648 02138000
         B     @DE00648                                            0648 02139000
@DL00648 DS    0H                                                  0649 02140000
*          CALL NXTFIELD(VERBFLD);                                 0649 02141000
         LA    @01,@AL00649                                        0649 02142000
         BAL   @14,NXTFIELD                                        0649 02143000
*          CALL SCANSEP(NO);                                       0650 02144000
*                                                                  0650 02145000
         LA    @01,@AL00650                                        0650 02146000
         BAL   @14,SCANSEP                                         0650 02147000
*          IF RELSIZE+UNITINDX = 0  |                              0651 02148000
*             RELSIZE+UNITINDX > MAX(MAXCCLN,LSTCCLN)+2+LENGTH(MXDECNUM 02149000
*            THEN                                                  0651 02150000
         LR    @15,RELSIZE                                         0651 02151000
         ALR   @15,UNITINDX                                        0651 02152000
         LTR   @15,@15                                             0651 02153000
         BZ    @RT00651                                            0651 02154000
         L     @01,GDTRIH(,GDTPTR)                                 0651 02155000
         L     @14,KWTBLPTR(,@01)                                  0651 02156000
         SLR   @01,@01                                             0651 02157000
         IC    @01,MAXCCLN(,@14)                                   0651 02158000
         SLR   @00,@00                                             0651 02159000
         IC    @00,LSTCCLN(,@14)                                   0651 02160000
         CR    @01,@00                                             0651 02161000
         BNL   *+6                                                      02162000
         LR    @01,@00                                             0651 02163000
         AH    @01,@CH00038                                        0651 02164000
         CR    @15,@01                                             0651 02165000
         BNH   @RF00651                                            0651 02166000
@RT00651 DS    0H                                                  0652 02167000
*              RISTATUS=BADEXPR2;                                  0652 02168000
         MVC   RISTATUS(2),@CH00054                                0652 02169000
*            ELSE                                                  0653 02170000
*              DO;                                                 0653 02171000
         B     @RC00651                                            0653 02172000
@RF00651 DS    0H                                                  0654 02173000
*              RELATION(RELSIZE+1:RELSIZE+UNITINDX)=SYNUNIT;       0654 02174000
         LA    @01,RELATION(RELSIZE)                               0654 02175000
         LR    @15,UNITINDX                                        0654 02176000
         BCTR  @15,0                                               0654 02177000
         EX    @15,@SM01447                                        0654 02178000
*              RELSIZE=RELSIZE+UNITINDX;                           0655 02179000
         ALR   RELSIZE,UNITINDX                                    0655 02180000
*              END;                                                0656 02181000
*          IF RISTATUS^=0 | CHAR1=ENDDELIM                         0657 02182000
*            THEN                                                  0657 02183000
@RC00651 ICM   @15,3,RISTATUS                                      0657 02184000
         BNZ   @RT00657                                            0657 02185000
         CLI   CHAR1,C';'                                          0657 02186000
         BNE   @RF00657                                            0657 02187000
@RT00657 DS    0H                                                  0658 02188000
*              EXPREND=YES;                                        0658 02189000
         OI    EXPREND,B'00100000'                                 0658 02190000
*        END;                                                      0659 02191000
*                                                                  0659 02192000
@RF00657 DS    0H                                                  0659 02193000
@DE00648 TM    EXPREND,B'00100000'                                 0659 02194000
         BZ    @DL00648                                            0659 02195000
*        IF RISTATUS=0                                             0660 02196000
*          THEN                                                    0660 02197000
*                                                                  0660 02198000
         ICM   @15,3,RISTATUS                                      0660 02199000
         BNZ   @RF00660                                            0660 02200000
*            /********************************************************/ 02201000
*            /*                                                      */ 02202000
*            /* INTERPRET THE ASSIGNMENT EXPRESSION AND ASSIGN THE   */ 02203000
*            /* PROVIDED NUMBER AS THE VALUE OF THE LAST OR MAXIMUM  */ 02204000
*            /* SYSTEM CONDITION CODE (WHICHEVER IS SPECIFIED IN THE */ 02205000
*            /* ASSIGNMENT EXPRESSION.                               */ 02206000
*            /*                                                      */ 02207000
*            /********************************************************/ 02208000
*DOGRP27:    DO;                                                   0661 02209000
DOGRP27  DS    0H                                                  0662 02210000
*            IF RELATION(1:MAXCCLN)=MAXCCSYM                       0662 02211000
*              THEN                                                0662 02212000
         L     @01,GDTRIH(,GDTPTR)                                 0662 02213000
         L     @15,KWTBLPTR(,@01)                                  0662 02214000
         SLR   @14,@14                                             0662 02215000
         IC    @14,MAXCCLN(,@15)                                   0662 02216000
         LR    @01,@14                                             0662 02217000
         BCTR  @01,0                                               0662 02218000
         EX    @01,@SC01449                                        0662 02219000
         BNE   @RF00662                                            0662 02220000
*                PART1LEN=MAXCCLN;                                 0663 02221000
         LR    PART1LEN,@14                                        0663 02222000
*              ELSE                                                0664 02223000
*                IF RELATION(1:LSTCCLN)=LSTCCSYM                   0664 02224000
*                  THEN                                            0664 02225000
         B     @RC00662                                            0664 02226000
@RF00662 L     @01,GDTRIH(,GDTPTR)                                 0664 02227000
         L     @15,KWTBLPTR(,@01)                                  0664 02228000
         SLR   @14,@14                                             0664 02229000
         IC    @14,LSTCCLN(,@15)                                   0664 02230000
         LR    @01,@14                                             0664 02231000
         BCTR  @01,0                                               0664 02232000
         EX    @01,@SC01451                                        0664 02233000
         BNE   @RF00664                                            0664 02234000
*                    PART1LEN=LSTCCLN;                             0665 02235000
         LR    PART1LEN,@14                                        0665 02236000
*                  ELSE                                            0666 02237000
*                    RISTATUS=BADEXPR2;                            0666 02238000
         B     @RC00664                                            0666 02239000
@RF00664 MVC   RISTATUS(2),@CH00054                                0666 02240000
*            IF RELATION(PART1LEN+1)=EQSIGN1                       0667 02241000
*              THEN                                                0667 02242000
@RC00664 DS    0H                                                  0667 02243000
@RC00662 LA    @01,RELATION(PART1LEN)                              0667 02244000
         CLI   0(@01),C'='                                         0667 02245000
         BNE   @RF00667                                            0667 02246000
*                PART1LEN=PART1LEN+1;                              0668 02247000
         AL    PART1LEN,@CF00228                                   0668 02248000
*              ELSE                                                0669 02249000
*                IF RELATION(PART1LEN+1:PART1LEN+2)=EQSIGN2        0669 02250000
*                  THEN                                            0669 02251000
         B     @RC00667                                            0669 02252000
@RF00667 LA    @01,RELATION(PART1LEN)                              0669 02253000
         CLC   0(2,@01),@CC00968                                   0669 02254000
         BNE   @RF00669                                            0669 02255000
*                    PART1LEN=PART1LEN+2;                          0670 02256000
         AH    PART1LEN,@CH00163                                   0670 02257000
*                  ELSE                                            0671 02258000
*                    RISTATUS=BADEXPR2;                            0671 02259000
         B     @RC00669                                            0671 02260000
@RF00669 MVC   RISTATUS(2),@CH00054                                0671 02261000
*            IF RISTATUS=0                                         0672 02262000
*              THEN                                                0672 02263000
*                                                                  0672 02264000
@RC00669 DS    0H                                                  0672 02265000
@RC00667 ICM   @15,3,RISTATUS                                      0672 02266000
         BNZ   @RF00672                                            0672 02267000
*                /****************************************************/ 02268000
*                /*                                                  */ 02269000
*                /* IF A NUMBER HAS BEEN PROPERLY CODED, THEN        */ 02270000
*                /* PLACE THE NUMBER INTO SYNUNIT IN PREPARATION FOR */ 02271000
*                /* CONVERSION AND CONVERT THE NUMBER.               */ 02272000
*                /*                                                  */ 02273000
*                /****************************************************/ 02274000
*                IF PART1LEN < RELSIZE                             0673 02275000
*                  THEN                                            0673 02276000
         CR    PART1LEN,RELSIZE                                    0673 02277000
         BNL   @RF00673                                            0673 02278000
*                    DO;                                           0674 02279000
*                    UNITINDX=RELSIZE-PART1LEN;                    0675 02280000
         LR    @15,RELSIZE                                         0675 02281000
         SLR   @15,PART1LEN                                        0675 02282000
         LR    UNITINDX,@15                                        0675 02283000
*                    SYNUNIT=RELATION(PART1LEN+1:RELSIZE);         0676 02284000
*                                                                  0676 02285000
         MVI   SYNUNIT+1,C' '                                      0676 02286000
         MVC   SYNUNIT+2(253),SYNUNIT+1                            0676 02287000
         BCTR  @15,0                                               0676 02288000
         LA    @01,RELATION(PART1LEN)                              0676 02289000
         EX    @15,@SM01453                                        0676 02290000
*                    CALL PACKCVB;                                 0677 02291000
*                                                                  0677 02292000
         BAL   @14,PACKCVB                                         0677 02293000
*                    IF RISTATUS^=0                                0678 02294000
*                      THEN                                        0678 02295000
         ICM   @02,3,RISTATUS                                      0678 02296000
         BZ    @RF00678                                            0678 02297000
*                        RISTATUS=SKIPREST;                        0679 02298000
         MVC   RISTATUS(2),@CH00042                                0679 02299000
*                    END;                                          0680 02300000
*                  ELSE                                            0681 02301000
*                    RISTATUS=BADEXPR2;                            0681 02302000
         B     @RC00673                                            0681 02303000
@RF00673 MVC   RISTATUS(2),@CH00054                                0681 02304000
*            END DOGRP27;                                          0682 02305000
*                                                                  0682 02306000
@RC00673 DS    0H                                                  0682 02307000
@RF00672 DS    0H                                                  0683 02308000
*        /************************************************************/ 02309000
*        /*                                                          */ 02310000
*        /* IF NO ERROR HAS OCCURRED, ASSIGN THE PROVIDED VALUE AS   */ 02311000
*        /* THE NEW VALUE OF THE SPECIFIED CONDITION CODE.           */ 02312000
*        /* (HOWEVER, NEVER ASSIGN A VALUE HIGHER THAN 16).  IF THE  */ 02313000
*        /* 'SET' COMMAND HAS UPDATED 'LASTCC', THEN 'MAXCC' MAY     */ 02314000
*        /* ALSO HAVE TO BE UPDATED.                                 */ 02315000
*        /*                                                          */ 02316000
*        /************************************************************/ 02317000
*        IF RISTATUS ^= 0                                          0683 02318000
*          THEN                                                    0683 02319000
@RF00660 ICM   @02,3,RISTATUS                                      0683 02320000
         BZ    @RF00683                                            0683 02321000
*            LASTCC=TERMERR;                                       0684 02322000
         MVC   LASTCC(2),@CH00482                                  0684 02323000
*          ELSE                                                    0685 02324000
*            DO;                                                   0685 02325000
         B     @RC00683                                            0685 02326000
@RF00683 DS    0H                                                  0686 02327000
*            IF SKIPFLAG(NESTLVL)=OFF                              0686 02328000
*              THEN                                                0686 02329000
         L     @02,GDTRIH(,GDTPTR)                                 0686 02330000
         SLR   @15,@15                                             0686 02331000
         IC    @15,NESTLVL(,@02)                                   0686 02332000
         ALR   @15,@15                                             0686 02333000
         ALR   @15,@02                                             0686 02334000
         TM    SKIPFLAG-2(@15),B'00010000'                         0686 02335000
         BNZ   @RF00686                                            0686 02336000
*                IF RELATION(1:MAXCCLN)=MAXCCSYM                   0687 02337000
*                  THEN                                            0687 02338000
         L     @02,KWTBLPTR(,@02)                                  0687 02339000
         SLR   @15,@15                                             0687 02340000
         IC    @15,MAXCCLN(,@02)                                   0687 02341000
         BCTR  @15,0                                               0687 02342000
         EX    @15,@SC01455                                        0687 02343000
         BNE   @RF00687                                            0687 02344000
*                    MAXCC=MIN(TERMERR,CNVRTWRD);                  0688 02345000
         L     @02,CNVRTWRD                                        0688 02346000
         LA    @15,16                                              0688 02347000
         CR    @02,@15                                             0688 02348000
         BNH   *+6                                                      02349000
         LR    @02,@15                                             0688 02350000
         STH   @02,MAXCC                                           0688 02351000
*                  ELSE                                            0689 02352000
*                    DO;                                           0689 02353000
         B     @RC00687                                            0689 02354000
@RF00687 DS    0H                                                  0690 02355000
*                    LASTCC=MIN(TERMERR,CNVRTWRD);                 0690 02356000
         L     @02,CNVRTWRD                                        0690 02357000
         LA    @15,16                                              0690 02358000
         CR    @02,@15                                             0690 02359000
         BNH   *+6                                                      02360000
         LR    @02,@15                                             0690 02361000
         STH   @02,LASTCC                                          0690 02362000
*                    MAXCC=MAX(MAXCC,LASTCC);                      0691 02363000
         LH    @15,MAXCC                                           0691 02364000
         CR    @15,@02                                             0691 02365000
         BNL   *+6                                                      02366000
         LR    @15,@02                                             0691 02367000
         STH   @15,MAXCC                                           0691 02368000
*                    END;                                          0692 02369000
*            IF MAXCC >= TERMERR                                   0693 02370000
*              THEN                                                0693 02371000
@RC00687 DS    0H                                                  0693 02372000
@RF00686 LH    @02,MAXCC                                           0693 02373000
         CH    @02,@CH00482                                        0693 02374000
         BL    @RF00693                                            0693 02375000
*                RISTATUS=SKIPREST;                                0694 02376000
         MVC   RISTATUS(2),@CH00042                                0694 02377000
*              ELSE                                                0695 02378000
*                                                                  0695 02379000
*                CALL BYPASTRM;                                    0695 02380000
*                                                                  0695 02381000
         B     @RC00693                                            0695 02382000
@RF00693 BAL   @14,BYPASTRM                                        0695 02383000
*            END;                                                  0696 02384000
*                                                                  0696 02385000
@RC00693 DS    0H                                                  0697 02386000
*        /************************************************************/ 02387000
*        /*                                                          */ 02388000
*        /* IF THIS 'SET' COMMAND IS A SINGLE COMMAND FOLLOWING AN   */ 02389000
*        /* 'ELSE' COMMAND, THEN ADJUST THE 'IF' NESTING LEVEL ONE   */ 02390000
*        /* LEVEL LESS DEEP.                                         */ 02391000
*        /*                                                          */ 02392000
*        /************************************************************/ 02393000
*        IF SINGLCMD=YES                                           0697 02394000
*          THEN                                                    0697 02395000
@RC00683 TM    SINGLCMD,B'00010000'                                0697 02396000
         BNO   @RF00697                                            0697 02397000
*            DO;                                                   0698 02398000
*            SINGLCMD=NO;                                          0699 02399000
         NI    SINGLCMD,B'11101111'                                0699 02400000
*            IF ELSEFLAG(NESTLVL)=ON                               0700 02401000
*              THEN                                                0700 02402000
         L     @02,GDTRIH(,GDTPTR)                                 0700 02403000
         SLR   @15,@15                                             0700 02404000
         IC    @15,NESTLVL(,@02)                                   0700 02405000
         LR    @14,@15                                             0700 02406000
         ALR   @14,@14                                             0700 02407000
         ALR   @14,@02                                             0700 02408000
         TM    ELSEFLAG-2(@14),B'00100000'                         0700 02409000
         BNO   @RF00700                                            0700 02410000
*                NESTLVL=NESTLVL-1;                                0701 02411000
         BCTR  @15,0                                               0701 02412000
         STC   @15,NESTLVL(,@02)                                   0701 02413000
*            END;                                                  0702 02414000
*                                                                  0702 02415000
*        END MODALSET;                                             0703 02416000
@EL00005 DS    0H                                                  0703 02417000
@EF00005 DS    0H                                                  0703 02418000
@ER00005 LM    @14,@03,@SA00005                                    0703 02419000
         LM    @06,@12,@SA00005+24                                 0703 02420000
         BR    @14                                                 0703 02421000
*/********************************************************************/ 02422000
*/*                                                                  */ 02423000
*/*  PROCEDURE NAME - MODALIF                                        */ 02424000
*/*                                                                  */ 02425000
*/*  FUNCTION - THIS ROUTINE SCANS AND INTERPRETS THE PART OF THE    */ 02426000
*/*             MODAL 'IF' COMMAND WHICH FOLLOWS THE VERB NAME 'IF'. */ 02427000
*/*             IF THE SYNTAX OF THE RELATIONAL EXPRESSION TO BE     */ 02428000
*/*             EVALUATED IS OKAY, THEN THE EVALUATION IS DONE TO    */ 02429000
*/*             DETERMINE IF THE EXPRESSION IS TRUE OR FALSE. FLAGS  */ 02430000
*/*             TO CONTROL SELECTION OF FUNCTION COMMANDS TO BE      */ 02431000
*/*             EXECUTED ARE SET BASED UPON THE RESULT.  A CHECK IS  */ 02432000
*/*             ALSO MADE TO SEE IF A DO-GROUP OR A NESTING 'IF'     */ 02433000
*/*             COMMAND FOLLOWS THE 'THEN' KEYWORD.                  */ 02434000
*/*                                                                  */ 02435000
*/*  INPUT -                                                         */ 02436000
*/*          NESTLVL - LEVEL OF 'IF' NESTING AT WHICH SCANNING HAS   */ 02437000
*/*                    TAKING PLACE PREVIOUS TO THIS 'IF' COMMAND    */ 02438000
*/*          SKIPFLAG- FLAG SET 'ON' IF COMMANDS AT CURRENT LEVEL    */ 02439000
*/*                    OF 'IF' NESTING ARE JUST BEING SCANNED FOR    */ 02440000
*/*                    SYNTAX CHECKING.                              */ 02441000
*/*          RISTATUS- INTERNAL STATUS CODE; SET TO NON-ZERO CODE    */ 02442000
*/*                    WHEN ANY ERROR IS FOUND.                      */ 02443000
*/*          SYNUNIT - ALL OR PART OF 'IF' COMMAND EXPRESSION.       */ 02444000
*/*          UNITINDX- LENGTH OF ABOVE 'IF' COMMAND SEGMENT.         */ 02445000
*/*          LASTCC -  CURRENT VALUE OF LAST SYSTEM COND. CODE       */ 02446000
*/*          MAXCC -   CURRENT VALUE OF MAXIMUM SYSTEM COND. CODE    */ 02447000
*/*          CNVRTWRD- VALUE (CONVERTED TO BINARY FORM) TAKEN FROM   */ 02448000
*/*                    'IF' COMMAND RELATIONAL EXPRESSION TO BE      */ 02449000
*/*                    COMPARTED TO THE CONDITION CODE VALUE         */ 02450000
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED FROM COMMAND.  */ 02451000
*/*                                                                  */ 02452000
*/*  OUTPUT -                                                        */ 02453000
*/*          NESTLVL - LEVEL OF 'IF' NESTING AT WHICH SCANNING IS    */ 02454000
*/*                    TAKING PLACE AFTER THIS 'IF' COMMAND.         */ 02455000
*/*          RISTATUS- SEE 'INPUT'                                   */ 02456000
*/*          LASTCC -  SEE 'INPUT'                                   */ 02457000
*/*          DOFLAG -  SET 'ON' WHEN SCANNING WITHIN A DO-GROUP AT   */ 02458000
*/*                    THE CURRENT 'IF' NESTING LEVEL                */ 02459000
*/*          THENFLAG- SET 'ON' WHEN 'THEN-PATH' COMMANDS ARE BEING  */ 02460000
*/*                    SCANNED AT CURRENT 'IF' NESTING LEVEL         */ 02461000
*/*          SKIPFLAG- SET 'ON' WHEN 'THEN-PATH' COMMANDS ARE ONLY TO*/ 02462000
*/*                    BE SCANNED FOR CORRECT SYNTAX.                */ 02463000
*/*          IFNEXT -  FLAG SET 'ON' WHEN AN 'IF' COMMAND FOLLOWS    */ 02464000
*/*                    THE 'THEN' KEYWORD OF THE CURRENT 'IF' COMMAND*/ 02465000
*/*          SYNUNIT - ALL OR PART OF 'IF' COMMAND RELATIONAL EXPR.  */ 02466000
*/*          UNITINDX- LENGTH OF RELATIONAL EXPRESSION SEGMENT       */ 02467000
*/*          GETVERB - FLAG SET 'ON' WHEN THE NEXT COMMAND VERB IS   */ 02468000
*/*                    YET TO BE EXTRACTED.                          */ 02469000
*/*          SINGLCMD- FLAG SET 'ON' WHEN A SINGLE COMMAND RATHER    */ 02470000
*/*                    THAN A DO-GROUP FOLLOWS THE 'THEN' KEYWORD.   */ 02471000
*/*                                                                  */ 02472000
*/********************************************************************/ 02473000
*MODALIF:PROCEDURE;                                                0704 02474000
MODALIF  STM   @14,@03,@SA00006                                    0704 02475000
         STM   @06,@12,@SA00006+24                                 0704 02476000
*        /************************************************************/ 02477000
*        /*                                                          */ 02478000
*        /* DATA DEFINITIONS FOR INTERPRETING MODAL 'IF' COMMAND     */ 02479000
*        /*                                                          */ 02480000
*        /************************************************************/ 02481000
*                                                                  0705 02482000
*        DCL CCVALUE  FIXED(15);       /*SYSTEM CONDITION CODE VALUE */ 02483000
*        DCL DIGITPOS FIXED(15);       /*POSITION WITHIN RELATIONAL     02484000
*                                        EXPRESSION WHERE NUMBER TO BE  02485000
*                                        COMPARED WITH THE CC APPEARS*/ 02486000
*        DCL RELOPER  CHAR(2);         /*EXTRACTED RELATIONAL      0707 02487000
*                                        OPERATOR                    */ 02488000
*                                                                  0707 02489000
*        DCL GTSIGN1  CHAR(1)          /*GREATER-THAN SIGN           */ 02490000
*                     CONSTANT('>');                               0708 02491000
*        DCL GTSIGN2  CHAR(2)          /*GREATER-THAN SIGN           */ 02492000
*                     CONSTANT('GT');                              0709 02493000
*        DCL LTSIGN1  CHAR(1)          /*LESS-THAN SIGN              */ 02494000
*                     CONSTANT('<');                               0710 02495000
*        DCL LTSIGN2  CHAR(2)          /*LESS-THAN SIGN              */ 02496000
*                     CONSTANT('LT');                              0711 02497000
*        DCL NESIGN1  CHAR(2)          /*NOT-EQUAL SIGN              */ 02498000
*                     CONSTANT('^=');                              0712 02499000
*        DCL NESIGN2  CHAR(2)          /*NOT-EQUAL SIGN              */ 02500000
*                     CONSTANT('NE');                              0713 02501000
*        DCL GESIGN1  CHAR(2)          /*GREATER-THAN-OR-EQUAL SIGN  */ 02502000
*                     CONSTANT('>=');                              0714 02503000
*        DCL GESIGN2  CHAR(2)          /*GREATER-THAN-OR-EQUAL SIGN  */ 02504000
*                     CONSTANT('GE');                              0715 02505000
*        DCL LESIGN1  CHAR(2)          /*LESS-THAN-OR-EQUAL SIGN     */ 02506000
*                     CONSTANT('<=');                              0716 02507000
*        DCL LESIGN2  CHAR(2)          /*LESS-THAN-OR-EQUAL SIGN     */ 02508000
*                     CONSTANT('LE');                              0717 02509000
*        /************************************************************/ 02510000
*        /*                                                          */ 02511000
*        /*  ** MODALIF **  INTERPRET THE MODAL 'IF' COMMAND         */ 02512000
*        /*                                                          */ 02513000
*        /************************************************************/ 02514000
*        IF GDTDBG = NULLPTR                                       0718 02515000
*          THEN;                                                   0718 02516000
         ICM   @02,15,GDTDBG(GDTPTR)                               0718 02517000
         BZ    @RT00718                                            0718 02518000
*          ELSE                                                    0720 02519000
*            CALL IDCDB010(GDTTBL,'RIMI');                         0720 02520000
*                                                                  0720 02521000
         ST    GDTPTR,@AL00001                                     0720 02522000
         LA    @02,@CC01036                                        0720 02523000
         ST    @02,@AL00001+4                                      0720 02524000
         MVI   @AL00001+4,X'80'                                    0720 02525000
         L     @15,GDTDBG(,GDTPTR)                                 0720 02526000
         LA    @01,@AL00001                                        0720 02527000
         BALR  @14,@15                                             0720 02528000
*        /************************************************************/ 02529000
*        /*                                                          */ 02530000
*        /* NOTE THAT THIS 'IF' COMMAND MEANS ONE LEVEL DEEPER OF    */ 02531000
*        /* 'IF' NESTING.                                            */ 02532000
*        /*                                                          */ 02533000
*        /************************************************************/ 02534000
*        NESTLVL=NESTLVL+1;                                        0721 02535000
@RT00718 L     @02,GDTRIH(,GDTPTR)                                 0721 02536000
         LA    @15,1                                               0721 02537000
         SLR   @14,@14                                             0721 02538000
         IC    @14,NESTLVL(,@02)                                   0721 02539000
         ALR   @15,@14                                             0721 02540000
         STC   @15,NESTLVL(,@02)                                   0721 02541000
*        IF NESTLVL > IFNSTMX                                      0722 02542000
*          THEN                                                    0722 02543000
         CLI   NESTLVL(@02),10                                     0722 02544000
         BNH   @RF00722                                            0722 02545000
*            DO;                                                   0723 02546000
*            RISTATUS=BADIFNST;                                    0724 02547000
         MVC   RISTATUS(2),@CH00979                                0724 02548000
*            LASTCC=TERMERR;                                       0725 02549000
         MVC   LASTCC(2),@CH00482                                  0725 02550000
*            RETURN;                                               0726 02551000
@EL00006 DS    0H                                                  0726 02552000
@EF00006 DS    0H                                                  0726 02553000
@ER00006 LM    @14,@03,@SA00006                                    0726 02554000
         LM    @06,@12,@SA00006+24                                 0726 02555000
         BR    @14                                                 0726 02556000
*            END;                                                  0727 02557000
*        MODLFLGS(NESTLVL)=''B;                                    0728 02558000
@RF00722 L     @15,GDTRIH(,GDTPTR)                                 0728 02559000
         SLR   @14,@14                                             0728 02560000
         IC    @14,NESTLVL(,@15)                                   0728 02561000
         ALR   @14,@14                                             0728 02562000
         ST    @14,@TF00001                                        0728 02563000
         ALR   @14,@15                                             0728 02564000
         XC    MODLFLGS-2(2,@14),MODLFLGS-2(@14)                   0728 02565000
*        THENFLAG(NESTLVL)=ON;                                     0729 02566000
         AL    @15,@TF00001                                        0729 02567000
         OI    THENFLAG-2(@15),B'01000000'                         0729 02568000
*        IFNEXT=NO;                                                0730 02569000
*                                                                  0730 02570000
         NI    IFNEXT,B'11110111'                                  0730 02571000
*        /************************************************************/ 02572000
*        /*                                                          */ 02573000
*        /* EXTRACT THE ELEMENTS OF THE RELATIONAL EXPRESSION THAT   */ 02574000
*        /* FOLLOWS THE 'IF' VERB (THERE MAY OR MAY NOT BE DELIMITERS*/ 02575000
*        /* SURROUNDING THE COMPARISON SIGN), CHECKING TO BE SURE    */ 02576000
*        /* THAT THE MAXIMUM POSSIBLE LENGTH FOR SUCH AN EXPRESSION  */ 02577000
*        /* IS NOT EXCEEDED.                                         */ 02578000
*        /*                                                          */ 02579000
*        /************************************************************/ 02580000
*        RELATION=BLANK;                                           0731 02581000
         MVI   RELATION+1,C' '                                     0731 02582000
         MVC   RELATION+2(30),RELATION+1                           0731 02583000
         MVI   RELATION,C' '                                       0731 02584000
*        RELSIZE=0;                                                0732 02585000
         SLR   RELSIZE,RELSIZE                                     0732 02586000
*        EXPREND=NO;                                               0733 02587000
         NI    EXPREND,B'11011111'                                 0733 02588000
*        DO WHILE(EXPREND=NO & RISTATUS=0);                        0734 02589000
*                                                                  0734 02590000
         B     @DE00734                                            0734 02591000
@DL00734 DS    0H                                                  0735 02592000
*          CALL NXTFIELD(VERBFLD);                                 0735 02593000
         LA    @01,@AL00735                                        0735 02594000
         BAL   @14,NXTFIELD                                        0735 02595000
*          CALL SCANSEP(NO);                                       0736 02596000
*                                                                  0736 02597000
         LA    @01,@AL00736                                        0736 02598000
         BAL   @14,SCANSEP                                         0736 02599000
*          IF RELSIZE+UNITINDX = 0  |                              0737 02600000
*             RELSIZE+UNITINDX > MAX(MAXCCLN,LSTCCLN)+2+LENGTH(MXDECNUM 02601000
*            THEN                                                  0737 02602000
         LR    @15,RELSIZE                                         0737 02603000
         ALR   @15,UNITINDX                                        0737 02604000
         LTR   @15,@15                                             0737 02605000
         BZ    @RT00737                                            0737 02606000
         L     @01,GDTRIH(,GDTPTR)                                 0737 02607000
         L     @14,KWTBLPTR(,@01)                                  0737 02608000
         SLR   @01,@01                                             0737 02609000
         IC    @01,MAXCCLN(,@14)                                   0737 02610000
         SLR   @00,@00                                             0737 02611000
         IC    @00,LSTCCLN(,@14)                                   0737 02612000
         CR    @01,@00                                             0737 02613000
         BNL   *+6                                                      02614000
         LR    @01,@00                                             0737 02615000
         AH    @01,@CH00038                                        0737 02616000
         CR    @15,@01                                             0737 02617000
         BNH   @RF00737                                            0737 02618000
@RT00737 DS    0H                                                  0738 02619000
*              RISTATUS=BADEXPR1;                                  0738 02620000
         MVC   RISTATUS(2),@CH00974                                0738 02621000
*            ELSE                                                  0739 02622000
*              DO;                                                 0739 02623000
         B     @RC00737                                            0739 02624000
@RF00737 DS    0H                                                  0740 02625000
*              RELATION(RELSIZE+1:RELSIZE+UNITINDX)=SYNUNIT;       0740 02626000
         LA    @01,RELATION(RELSIZE)                               0740 02627000
         LR    @15,UNITINDX                                        0740 02628000
         BCTR  @15,0                                               0740 02629000
         EX    @15,@SM01447                                        0740 02630000
*              RELSIZE=RELSIZE+UNITINDX;                           0741 02631000
*                                                                  0741 02632000
         ALR   RELSIZE,UNITINDX                                    0741 02633000
*              /******************************************************/ 02634000
*              /*                                                    */ 02635000
*              /* THE FINAL CHARACTER IN THE LAST EXPRESSION ELEMENT */ 02636000
*              /* SHOULD ALWAYS BE A DECIMAL DIGIT; OTHERWISE, THE   */ 02637000
*              /* RELATIONAL EXPRESSION IS IN ERROR.                 */ 02638000
*              /*                                                    */ 02639000
*              /******************************************************/ 02640000
*              IF SYNUNIT(UNITINDX) >= '0' & SYNUNIT(UNITINDX) <= '9' | 02641000
*                 CHAR1=ENDDELIM                                   0742 02642000
*                THEN                                              0742 02643000
         LA    @01,SYNUNIT-1(UNITINDX)                             0742 02644000
         CLI   0(@01),C'0'                                         0742 02645000
         BL    @GL00020                                            0742 02646000
         LA    @01,SYNUNIT-1(UNITINDX)                             0742 02647000
         CLI   0(@01),C'9'                                         0742 02648000
         BNH   @RT00742                                            0742 02649000
@GL00020 CLI   CHAR1,C';'                                          0742 02650000
         BNE   @RF00742                                            0742 02651000
@RT00742 DS    0H                                                  0743 02652000
*                  EXPREND=YES;                                    0743 02653000
         OI    EXPREND,B'00100000'                                 0743 02654000
*              END;                                                0744 02655000
@RF00742 DS    0H                                                  0745 02656000
*        END;                                                      0745 02657000
@RC00737 DS    0H                                                  0745 02658000
@DE00734 TM    EXPREND,B'00100000'                                 0745 02659000
         BNZ   @DC00734                                            0745 02660000
         ICM   @15,3,RISTATUS                                      0745 02661000
         BZ    @DL00734                                            0745 02662000
@DC00734 DS    0H                                                  0746 02663000
*        IF RISTATUS=0                                             0746 02664000
*          THEN                                                    0746 02665000
*                                                                  0746 02666000
         ICM   @15,3,RISTATUS                                      0746 02667000
         BNZ   @RF00746                                            0746 02668000
*            /********************************************************/ 02669000
*            /*                                                      */ 02670000
*            /* DEPENDING UPON WHETHER THE EXPRESSION INVOLVES MAXCC */ 02671000
*            /* OR LASTCC, OBTAIN THE CURRENT CONDITION CODE TO BE   */ 02672000
*            /* USED IN THE COMPARISON.                              */ 02673000
*            /*                                                      */ 02674000
*            /********************************************************/ 02675000
*            IF RELATION(1:MAXCCLN)=MAXCCSYM                       0747 02676000
*              THEN                                                0747 02677000
         L     @01,GDTRIH(,GDTPTR)                                 0747 02678000
         L     @15,KWTBLPTR(,@01)                                  0747 02679000
         SLR   @14,@14                                             0747 02680000
         IC    @14,MAXCCLN(,@15)                                   0747 02681000
         LR    @01,@14                                             0747 02682000
         BCTR  @01,0                                               0747 02683000
         EX    @01,@SC01449                                        0747 02684000
         BNE   @RF00747                                            0747 02685000
*                DO;                                               0748 02686000
*                CCVALUE=MAXCC;                                    0749 02687000
         MVC   CCVALUE(2),MAXCC                                    0749 02688000
*                PART1LEN=MAXCCLN;                                 0750 02689000
         LR    PART1LEN,@14                                        0750 02690000
*                END;                                              0751 02691000
*              ELSE                                                0752 02692000
*                IF RELATION(1:LSTCCLN)=LSTCCSYM                   0752 02693000
*                  THEN                                            0752 02694000
         B     @RC00747                                            0752 02695000
@RF00747 L     @01,GDTRIH(,GDTPTR)                                 0752 02696000
         L     @15,KWTBLPTR(,@01)                                  0752 02697000
         SLR   @14,@14                                             0752 02698000
         IC    @14,LSTCCLN(,@15)                                   0752 02699000
         LR    @01,@14                                             0752 02700000
         BCTR  @01,0                                               0752 02701000
         EX    @01,@SC01451                                        0752 02702000
         BNE   @RF00752                                            0752 02703000
*                    DO;                                           0753 02704000
*                    CCVALUE=LASTCC;                               0754 02705000
         MVC   CCVALUE(2),LASTCC                                   0754 02706000
*                    PART1LEN=LSTCCLN;                             0755 02707000
         LR    PART1LEN,@14                                        0755 02708000
*                    END;                                          0756 02709000
*                  ELSE                                            0757 02710000
*                    RISTATUS=BADEXPR1;                            0757 02711000
         B     @RC00752                                            0757 02712000
@RF00752 MVC   RISTATUS(2),@CH00974                                0757 02713000
*        IF RISTATUS=0                                             0758 02714000
*          THEN                                                    0758 02715000
@RC00752 DS    0H                                                  0758 02716000
@RC00747 DS    0H                                                  0758 02717000
@RF00746 ICM   @15,3,RISTATUS                                      0758 02718000
         BNZ   @RF00758                                            0758 02719000
*DOGRP30:    DO;                                                   0759 02720000
*                                                                  0759 02721000
DOGRP30  DS    0H                                                  0760 02722000
*            /********************************************************/ 02723000
*            /*                                                      */ 02724000
*            /* SKIP PAST THE OPERATOR OF THE RELATIONAL EXPRESSION  */ 02725000
*            /* AND CONVERT THE NUMBER TO WHICH THE CONDITION CODE   */ 02726000
*            /* VALUE IS TO BE COMPARED.                             */ 02727000
*            /*                                                      */ 02728000
*            /********************************************************/ 02729000
*            IF RELATION(PART1LEN+2) >= '0' &                      0760 02730000
*               RELATION(PART1LEN+2) <= '9'                        0760 02731000
*              THEN                                                0760 02732000
         LA    @01,RELATION+1(PART1LEN)                            0760 02733000
         CLI   0(@01),C'0'                                         0760 02734000
         BL    @RF00760                                            0760 02735000
         LA    @01,RELATION+1(PART1LEN)                            0760 02736000
         CLI   0(@01),C'9'                                         0760 02737000
         BH    @RF00760                                            0760 02738000
*                DIGITPOS=PART1LEN+2;                              0761 02739000
         LA    @01,2(,PART1LEN)                                    0761 02740000
         STH   @01,DIGITPOS                                        0761 02741000
*              ELSE                                                0762 02742000
*                DIGITPOS=PART1LEN+3;                              0762 02743000
         B     @RC00760                                            0762 02744000
@RF00760 LA    @01,3(,PART1LEN)                                    0762 02745000
         STH   @01,DIGITPOS                                        0762 02746000
*            IF DIGITPOS <= RELSIZE                                0763 02747000
*              THEN                                                0763 02748000
@RC00760 LH    @15,DIGITPOS                                        0763 02749000
         CR    @15,RELSIZE                                         0763 02750000
         BH    @RF00763                                            0763 02751000
*                DO;                                               0764 02752000
*                UNITINDX=RELSIZE-DIGITPOS+1;                      0765 02753000
         LR    @14,RELSIZE                                         0765 02754000
         SLR   @14,@15                                             0765 02755000
         LA    UNITINDX,1                                          0765 02756000
         ALR   UNITINDX,@14                                        0765 02757000
*                SYNUNIT=RELATION(DIGITPOS:RELSIZE);               0766 02758000
*                                                                  0766 02759000
         MVI   SYNUNIT+1,C' '                                      0766 02760000
         MVC   SYNUNIT+2(253),SYNUNIT+1                            0766 02761000
         LA    @01,RELATION-1(@15)                                 0766 02762000
         EX    @14,@SM01453                                        0766 02763000
*                CALL PACKCVB;                                     0767 02764000
*                                                                  0767 02765000
         BAL   @14,PACKCVB                                         0767 02766000
*                IF RISTATUS^=0                                    0768 02767000
*                  THEN                                            0768 02768000
         ICM   @02,3,RISTATUS                                      0768 02769000
         BZ    @RF00768                                            0768 02770000
*                    RISTATUS=SKIPREST;                            0769 02771000
         MVC   RISTATUS(2),@CH00042                                0769 02772000
*                END;                                              0770 02773000
*              ELSE                                                0771 02774000
*                RISTATUS=BADEXPR1;                                0771 02775000
*                                                                  0771 02776000
         B     @RC00763                                            0771 02777000
@RF00763 MVC   RISTATUS(2),@CH00974                                0771 02778000
*            /********************************************************/ 02779000
*            /*                                                      */ 02780000
*            /* MATCH THE EXPRESSION'S OPERATOR WITH ONE OF THE      */ 02781000
*            /* OPERATORS ALLOWED; THEN PERFORM THE INDICATED        */ 02782000
*            /* COMPARISON BETWEEN THE CONDITION CODE & THE PROVIDED */ 02783000
*            /* VALUE.  IF A MATCHING OPERATOR IS NOT FOUND, IT IS   */ 02784000
*            /* AN ERROR.  IF THE COMPARISON IS FALSE, A FLAG IS SET */ 02785000
*            /* TO SIGNAL THAT COMMANDS ASSOCIATED WITH THE 'THEN    */ 02786000
*            /* PATH' ARE SIMPLY TO BE SCANNED FOR CORRECT SYNTAX.   */ 02787000
*            /*                                                      */ 02788000
*            /********************************************************/ 02789000
*            RELOPER=RELATION(PART1LEN+1:DIGITPOS-1);              0772 02790000
@RC00763 MVI   RELOPER+1,C' '                                      0772 02791000
         LH    @02,DIGITPOS                                        0772 02792000
         SLR   @02,PART1LEN                                        0772 02793000
         BCTR  @02,0                                               0772 02794000
         BCTR  @02,0                                               0772 02795000
         LA    @01,RELATION(PART1LEN)                              0772 02796000
         EX    @02,@SM01457                                        0772 02797000
*            IF RELOPER=GESIGN1 | RELOPER=GESIGN2                  0773 02798000
*              THEN                                                0773 02799000
         CLC   RELOPER(2),@CC01029                                 0773 02800000
         BE    @RT00773                                            0773 02801000
         CLC   RELOPER(2),@CC01031                                 0773 02802000
         BNE   @RF00773                                            0773 02803000
@RT00773 DS    0H                                                  0774 02804000
*                IF CCVALUE < CNVRTWRD                             0774 02805000
*                  THEN                                            0774 02806000
         LH    @02,CCVALUE                                         0774 02807000
         C     @02,CNVRTWRD                                        0774 02808000
         BNL   @RF00774                                            0774 02809000
*                    SKIPFLAG(NESTLVL)=ON;                         0775 02810000
         L     @02,GDTRIH(,GDTPTR)                                 0775 02811000
         SLR   @15,@15                                             0775 02812000
         IC    @15,NESTLVL(,@02)                                   0775 02813000
         ALR   @15,@15                                             0775 02814000
         ALR   @02,@15                                             0775 02815000
         OI    SKIPFLAG-2(@02),B'00010000'                         0775 02816000
*                  ELSE;                                           0776 02817000
@RF00774 DS    0H                                                  0777 02818000
*              ELSE                                                0777 02819000
*                IF RELOPER=LESIGN1 | RELOPER=LESIGN2              0777 02820000
*                  THEN                                            0777 02821000
         B     @RC00773                                            0777 02822000
@RF00773 CLC   RELOPER(2),@CC01033                                 0777 02823000
         BE    @RT00777                                            0777 02824000
         CLC   RELOPER(2),@CC01035                                 0777 02825000
         BNE   @RF00777                                            0777 02826000
@RT00777 DS    0H                                                  0778 02827000
*                    IF CCVALUE > CNVRTWRD                         0778 02828000
*                      THEN                                        0778 02829000
         LH    @02,CCVALUE                                         0778 02830000
         C     @02,CNVRTWRD                                        0778 02831000
         BNH   @RF00778                                            0778 02832000
*                        SKIPFLAG(NESTLVL)=ON;                     0779 02833000
         L     @02,GDTRIH(,GDTPTR)                                 0779 02834000
         SLR   @15,@15                                             0779 02835000
         IC    @15,NESTLVL(,@02)                                   0779 02836000
         ALR   @15,@15                                             0779 02837000
         ALR   @02,@15                                             0779 02838000
         OI    SKIPFLAG-2(@02),B'00010000'                         0779 02839000
*                      ELSE;                                       0780 02840000
@RF00778 DS    0H                                                  0781 02841000
*                  ELSE                                            0781 02842000
*                    IF RELOPER=NESIGN1 | RELOPER=NESIGN2          0781 02843000
*                      THEN                                        0781 02844000
         B     @RC00777                                            0781 02845000
@RF00777 CLC   RELOPER(2),@CC01025                                 0781 02846000
         BE    @RT00781                                            0781 02847000
         CLC   RELOPER(2),@CC01027                                 0781 02848000
         BNE   @RF00781                                            0781 02849000
@RT00781 DS    0H                                                  0782 02850000
*                        IF CCVALUE=CNVRTWRD                       0782 02851000
*                          THEN                                    0782 02852000
         LH    @02,CCVALUE                                         0782 02853000
         C     @02,CNVRTWRD                                        0782 02854000
         BNE   @RF00782                                            0782 02855000
*                            SKIPFLAG(NESTLVL)=ON;                 0783 02856000
         L     @02,GDTRIH(,GDTPTR)                                 0783 02857000
         SLR   @15,@15                                             0783 02858000
         IC    @15,NESTLVL(,@02)                                   0783 02859000
         ALR   @15,@15                                             0783 02860000
         ALR   @02,@15                                             0783 02861000
         OI    SKIPFLAG-2(@02),B'00010000'                         0783 02862000
*                          ELSE;                                   0784 02863000
@RF00782 DS    0H                                                  0785 02864000
*                      ELSE                                        0785 02865000
*                        IF RELOPER=GTSIGN1 | RELOPER=GTSIGN2      0785 02866000
*                          THEN                                    0785 02867000
         B     @RC00781                                            0785 02868000
@RF00781 CLI   RELOPER,C'>'                                        0785 02869000
         BE    @RT00785                                            0785 02870000
         CLC   RELOPER(2),@CC01019                                 0785 02871000
         BNE   @RF00785                                            0785 02872000
@RT00785 DS    0H                                                  0786 02873000
*                            IF CCVALUE <= CNVRTWRD                0786 02874000
*                              THEN                                0786 02875000
         LH    @02,CCVALUE                                         0786 02876000
         C     @02,CNVRTWRD                                        0786 02877000
         BH    @RF00786                                            0786 02878000
*                                SKIPFLAG(NESTLVL)=ON;             0787 02879000
         L     @02,GDTRIH(,GDTPTR)                                 0787 02880000
         SLR   @15,@15                                             0787 02881000
         IC    @15,NESTLVL(,@02)                                   0787 02882000
         ALR   @15,@15                                             0787 02883000
         ALR   @02,@15                                             0787 02884000
         OI    SKIPFLAG-2(@02),B'00010000'                         0787 02885000
*                              ELSE;                               0788 02886000
@RF00786 DS    0H                                                  0789 02887000
*                          ELSE                                    0789 02888000
*                            IF RELOPER=LTSIGN1 | RELOPER=LTSIGN2  0789 02889000
*                              THEN                                0789 02890000
         B     @RC00785                                            0789 02891000
@RF00785 CLI   RELOPER,C'<'                                        0789 02892000
         BE    @RT00789                                            0789 02893000
         CLC   RELOPER(2),@CC01023                                 0789 02894000
         BNE   @RF00789                                            0789 02895000
@RT00789 DS    0H                                                  0790 02896000
*                                IF CCVALUE >= CNVRTWRD            0790 02897000
*                                  THEN                            0790 02898000
         LH    @02,CCVALUE                                         0790 02899000
         C     @02,CNVRTWRD                                        0790 02900000
         BL    @RF00790                                            0790 02901000
*                                    SKIPFLAG(NESTLVL)=ON;         0791 02902000
         L     @02,GDTRIH(,GDTPTR)                                 0791 02903000
         SLR   @15,@15                                             0791 02904000
         IC    @15,NESTLVL(,@02)                                   0791 02905000
         ALR   @15,@15                                             0791 02906000
         ALR   @02,@15                                             0791 02907000
         OI    SKIPFLAG-2(@02),B'00010000'                         0791 02908000
*                                  ELSE;                           0792 02909000
@RF00790 DS    0H                                                  0793 02910000
*                              ELSE                                0793 02911000
*                                IF RELOPER=EQSIGN1 | RELOPER=EQSIGN2   02912000
*                                  THEN                            0793 02913000
         B     @RC00789                                            0793 02914000
@RF00789 CLI   RELOPER,C'='                                        0793 02915000
         BE    @RT00793                                            0793 02916000
         CLC   RELOPER(2),@CC00968                                 0793 02917000
         BNE   @RF00793                                            0793 02918000
@RT00793 DS    0H                                                  0794 02919000
*                                    IF CCVALUE ^= CNVRTWRD        0794 02920000
*                                      THEN                        0794 02921000
         LH    @02,CCVALUE                                         0794 02922000
         C     @02,CNVRTWRD                                        0794 02923000
         BE    @RF00794                                            0794 02924000
*                                        SKIPFLAG(NESTLVL)=ON;     0795 02925000
         L     @02,GDTRIH(,GDTPTR)                                 0795 02926000
         SLR   @15,@15                                             0795 02927000
         IC    @15,NESTLVL(,@02)                                   0795 02928000
         ALR   @15,@15                                             0795 02929000
         ALR   @02,@15                                             0795 02930000
         OI    SKIPFLAG-2(@02),B'00010000'                         0795 02931000
*                                      ELSE;                       0796 02932000
@RF00794 DS    0H                                                  0797 02933000
*                                  ELSE                            0797 02934000
*                                    RISTATUS=BADEXPR1;            0797 02935000
*                                                                  0797 02936000
         B     @RC00793                                            0797 02937000
@RF00793 MVC   RISTATUS(2),@CH00974                                0797 02938000
*            /********************************************************/ 02939000
*            /*                                                      */ 02940000
*            /* IF THIS 'IF' COMMAND IS JUST BEING SCANNED FOR SYNTAX*/ 02941000
*            /* CHECKING, THEN OVERRIDE THE RESULT OF THE RELATIONAL */ 02942000
*            /* EXPRESSION EVALUATION AND NOTE THAT ALL COMMANDS AT  */ 02943000
*            /* THIS DEEPER LEVEL ARE ALSO JUST TO BE SCANNED.       */ 02944000
*            /*                                                      */ 02945000
*            /********************************************************/ 02946000
*            IF NESTLVL>1 & SKIPFLAG(NESTLVL-1)=ON                 0798 02947000
*              THEN                                                0798 02948000
@RC00793 DS    0H                                                  0798 02949000
@RC00789 DS    0H                                                  0798 02950000
@RC00785 DS    0H                                                  0798 02951000
@RC00781 DS    0H                                                  0798 02952000
@RC00777 DS    0H                                                  0798 02953000
@RC00773 L     @02,GDTRIH(,GDTPTR)                                 0798 02954000
         CLI   NESTLVL(@02),1                                      0798 02955000
         BNH   @RF00798                                            0798 02956000
         SLR   @15,@15                                             0798 02957000
         IC    @15,NESTLVL(,@02)                                   0798 02958000
         ALR   @15,@15                                             0798 02959000
         ST    @15,@TF00001                                        0798 02960000
         ALR   @15,@02                                             0798 02961000
         TM    SKIPFLAG-4(@15),B'00010000'                         0798 02962000
         BNO   @RF00798                                            0798 02963000
*                SKIPFLAG(NESTLVL)=ON;                             0799 02964000
*                                                                  0799 02965000
         AL    @02,@TF00001                                        0799 02966000
         OI    SKIPFLAG-2(@02),B'00010000'                         0799 02967000
*            END DOGRP30;                                          0800 02968000
@RF00798 DS    0H                                                  0801 02969000
*        IF RISTATUS=0                                             0801 02970000
*          THEN                                                    0801 02971000
@RF00758 ICM   @02,3,RISTATUS                                      0801 02972000
         BNZ   @RF00801                                            0801 02973000
*DOGRP35:    DO;                                                   0802 02974000
*                                                                  0802 02975000
DOGRP35  DS    0H                                                  0803 02976000
*            /********************************************************/ 02977000
*            /*                                                      */ 02978000
*            /* EXTRACT THE FIELD WHICH FOLLOWS THE RELATIONAL       */ 02979000
*            /* EXPRESSION AND MAKE SURE IT IS THE 'THEN' KEYWORD;   */ 02980000
*            /* OTHERWISE, A SYNTAX ERROR HAS BEEN FOUND.            */ 02981000
*            /*                                                      */ 02982000
*            /********************************************************/ 02983000
*                                                                  0803 02984000
*            CALL NXTFIELD(VERBFLD);                               0803 02985000
         LA    @01,@AL00803                                        0803 02986000
         BAL   @14,NXTFIELD                                        0803 02987000
*            CALL SCANSEP(NO);                                     0804 02988000
*                                                                  0804 02989000
         LA    @01,@AL00804                                        0804 02990000
         BAL   @14,SCANSEP                                         0804 02991000
*            IF RISTATUS=0 & SYNUNIT=THENSYM                       0805 02992000
*              THEN                                                0805 02993000
*                                                                  0805 02994000
         ICM   @02,3,RISTATUS                                      0805 02995000
         BNZ   @RF00805                                            0805 02996000
         L     @02,GDTRIH(,GDTPTR)                                 0805 02997000
         L     @02,KWTBLPTR(,@02)                                  0805 02998000
         CLC   SYNUNIT(9),THENSYM(@02)                             0805 02999000
         BNE   @RF00805                                            0805 03000000
*                /****************************************************/ 03001000
*                /*                                                  */ 03002000
*                /* IF THE COMMAND-END DELIMITER IMMEDIATELY FOLLOWS */ 03003000
*                /* THE 'THEN' KEYWORD, THE 'THEN PATH' JUST CONSISTS*/ 03004000
*                /* OF A NULL COMMAND.  THE DELIMITER IS SIMPLY      */ 03005000
*                /* BYPASSED AND SCANNING CONTINUES.                 */ 03006000
*                /*                                                  */ 03007000
*                /****************************************************/ 03008000
*                IF CHAR1=ENDDELIM                                 0806 03009000
*                  THEN                                            0806 03010000
*                                                                  0806 03011000
         CLI   CHAR1,C';'                                          0806 03012000
         BNE   @RF00806                                            0806 03013000
*                    CALL BYPASTRM;                                0807 03014000
*                                                                  0807 03015000
         BAL   @14,BYPASTRM                                        0807 03016000
*                  ELSE                                            0808 03017000
*                                                                  0808 03018000
*                    /************************************************/ 03019000
*                    /*                                              */ 03020000
*                    /* EXTRACT THE VERB NAME OF THE COMMAND WHICH   */ 03021000
*                    /* FOLLOWS THE 'THEN' KEYWORD. IF IT IS A 'DO'  */ 03022000
*                    /* COMMAND, SET THE FLAG THAT INDICATES THAT A  */ 03023000
*                    /* 'DO GROUP' FOLLOWS AND SCAN UP TO THE NEXT   */ 03024000
*                    /* COMMAND VERB NAME.  IF NOT A 'DO', NOTE THAT */ 03025000
*                    /* THE NEXT COMMAND VERB NAME HAS ALREADY BEEN  */ 03026000
*                    /* EXTRACTED.  IF THAT VERB NAME IS NOT 'IF',   */ 03027000
*                    /* THEN A SINGLE COMMAND FOLLOWS THE 'THEN' AT  */ 03028000
*                    /* THIS NESTING LEVEL.                          */ 03029000
*                    /*                                              */ 03030000
*                    /************************************************/ 03031000
*                    DO;                                           0808 03032000
*                                                                  0808 03033000
         B     @RC00806                                            0808 03034000
@RF00806 DS    0H                                                  0809 03035000
*                    CALL NXTFIELD(VERBFLD);                       0809 03036000
         LA    @01,@AL00809                                        0809 03037000
         BAL   @14,NXTFIELD                                        0809 03038000
*                    CALL SCANSEP(NO);                             0810 03039000
*                                                                  0810 03040000
         LA    @01,@AL00810                                        0810 03041000
         BAL   @14,SCANSEP                                         0810 03042000
*                    IF RISTATUS=0 & SYNUNIT=DOSYM                 0811 03043000
*                      THEN                                        0811 03044000
         ICM   @02,3,RISTATUS                                      0811 03045000
         BNZ   @RF00811                                            0811 03046000
         L     @02,GDTRIH(,GDTPTR)                                 0811 03047000
         L     @02,KWTBLPTR(,@02)                                  0811 03048000
         CLC   SYNUNIT(9),DOSYM(@02)                               0811 03049000
         BNE   @RF00811                                            0811 03050000
*                        DO;                                       0812 03051000
*                                                                  0812 03052000
*                        CALL BYPASTRM;                            0813 03053000
*                                                                  0813 03054000
         BAL   @14,BYPASTRM                                        0813 03055000
*                        DOFLAG(NESTLVL)=ON;                       0814 03056000
         L     @02,GDTRIH(,GDTPTR)                                 0814 03057000
         SLR   @15,@15                                             0814 03058000
         IC    @15,NESTLVL(,@02)                                   0814 03059000
         ALR   @15,@15                                             0814 03060000
         ALR   @02,@15                                             0814 03061000
         OI    DOFLAG-2(@02),B'10000000'                           0814 03062000
*                        END;                                      0815 03063000
*                      ELSE                                        0816 03064000
*                        DO;                                       0816 03065000
         B     @RC00811                                            0816 03066000
@RF00811 DS    0H                                                  0817 03067000
*                        GETVERB=NO;                               0817 03068000
         NI    GETVERB,B'11111011'                                 0817 03069000
*                        IF SYNUNIT ^= IFSYM                       0818 03070000
*                          THEN                                    0818 03071000
         L     @02,GDTRIH(,GDTPTR)                                 0818 03072000
         L     @02,KWTBLPTR(,@02)                                  0818 03073000
         CLC   SYNUNIT(9),IFSYM(@02)                               0818 03074000
         BE    @RF00818                                            0818 03075000
*                            SINGLCMD=YES;                         0819 03076000
         OI    SINGLCMD,B'00010000'                                0819 03077000
*                          ELSE                                    0820 03078000
*                            IFNEXT=YES;                           0820 03079000
         B     @RC00818                                            0820 03080000
@RF00818 OI    IFNEXT,B'00001000'                                  0820 03081000
*                        END;                                      0821 03082000
*                    END;                                          0822 03083000
*                                                                  0822 03084000
*              /******************************************************/ 03085000
*              /*                                                    */ 03086000
*              /* THE KEYWORD 'THEN' IS MISSING FROM 'IF' COMMAND    */ 03087000
*              /* OR SOME OTHER ERROR HAS ALREADY OCCURRED.          */ 03088000
*              /*                                                    */ 03089000
*              /******************************************************/ 03090000
*              ELSE                                                0823 03091000
*                IF RISTATUS=0                                     0823 03092000
*                  THEN                                            0823 03093000
         B     @RC00805                                            0823 03094000
@RF00805 ICM   @02,3,RISTATUS                                      0823 03095000
         BNZ   @RF00823                                            0823 03096000
*                    DO;                                           0824 03097000
*                    LASTCC=TERMERR;                               0825 03098000
         MVC   LASTCC(2),@CH00482                                  0825 03099000
*                    RISTATUS=NOTHEN;                              0826 03100000
         MVC   RISTATUS(2),@CH00977                                0826 03101000
*                    END;                                          0827 03102000
*            END DOGRP35;                                          0828 03103000
@RF00823 DS    0H                                                  0828 03104000
@RC00805 DS    0H                                                  0829 03105000
*        IF RISTATUS ^= 0                                          0829 03106000
*          THEN                                                    0829 03107000
@RF00801 LH    @02,RISTATUS                                        0829 03108000
         LTR   @02,@02                                             0829 03109000
         BZ    @RF00829                                            0829 03110000
*            IF RISTATUS=EOFILE & EOFOK=YES                        0830 03111000
*              THEN;                                               0830 03112000
         CH    @02,@CH00157                                        0830 03113000
         BNE   @RF00830                                            0830 03114000
         TM    EOFOK,B'01000000'                                   0830 03115000
         BO    @RT00830                                            0830 03116000
*              ELSE                                                0832 03117000
*                LASTCC=TERMERR;                                   0832 03118000
*                                                                  0832 03119000
@RF00830 MVC   LASTCC(2),@CH00482                                  0832 03120000
*        END MODALIF;                                              0833 03121000
         B     @EL00006                                            0833 03122000
*/********************************************************************/ 03123000
*/*                                                                  */ 03124000
*/*  PROCEDURE NAME - MODLELSE                                       */ 03125000
*/*                                                                  */ 03126000
*/*  FUNCTION - THIS ROUTINE SETS UP TO SCAN AND INTERPRET WHAT      */ 03127000
*/*             FOLLOWS THE 'ELSE' COMMAND.  APPROPRIATE CONTROL     */ 03128000
*/*             FLAGS ARE SET AND A CHECK IS MADE TO SEE IF AN 'IF'  */ 03129000
*/*             COMMAND OR A DO-GROUP FOLLOWS THE 'ELSE' COMMAND.    */ 03130000
*/*                                                                  */ 03131000
*/*  INPUT -                                                         */ 03132000
*/*          SKIPFLAG- FLAG SET 'ON' WHEN COMMANDS ARE (HAVE BEEN)   */ 03133000
*/*                    GETTING SCANNED FOR SYNTAX CHECKING ONLY.     */ 03134000
*/*          NESTLVL - LEVEL OF 'IF' COMMAND NESTING AT WHICH        */ 03135000
*/*                    SCANNING IS CURRENTLY TAKING PLACE.           */ 03136000
*/*          CHAR1 -   CHARACTER MOST RECENTLY EXTRACTED.            */ 03137000
*/*          SYNUNIT - SYNTACTIC UNIT MOST RECENTLY EXTRACTED.       */ 03138000
*/*                                                                  */ 03139000
*/*  OUTPUT -                                                        */ 03140000
*/*          DOFLAG -  SET 'ON' WHEN SCANNING WITHIN A DO-GROUP AT   */ 03141000
*/*                    CURRENT 'IF' NESTING LEVEL                    */ 03142000
*/*          THENFLAG- SET 'ON' WHEN SCANNING 'THEN-PATH' COMMANDS   */ 03143000
*/*                    AT CURRENT 'IF' NESTING LEVEL                 */ 03144000
*/*          ELSEFLAG- SET 'ON' WHEN SCANNING 'ELSE-PATH' COMMANDS   */ 03145000
*/*                    AT CURRENT 'IF' NESTING LEVEL                 */ 03146000
*/*          SKIPFLAG- SEE 'INPUT'                                   */ 03147000
*/*          NESTLVL - CURRENT LEVEL OF 'IF' COMMAND NESTING         */ 03148000
*/*          IFNEXT -  FLAG SET 'ON' WHEN AN 'IF' COMMANDS FOLLOWS   */ 03149000
*/*                    THE 'ELSE' COMMAND VERB                       */ 03150000
*/*          GETVERB - FLAG SET 'ON' WHEN THE NEXT COMMAND VERB IS   */ 03151000
*/*                    YET TO BE EXTRACTED AFTER THE 'ELSE' COMMAND. */ 03152000
*/*          SINGLCMD- FLAG SET 'ON' WHEN A SINGLE COMMAND AS OPPOSED*/ 03153000
*/*                    TO A DO-GROUP FOLLOWS THE 'ELSE' COMMAND.     */ 03154000
*/*          LASTCC -  VALUE OF LAST SYSTEM CONDITION CODE; MAY BE   */ 03155000
*/*                    RESET IF SYNTAX ERROR IS FOUND IN 'ELSE' CMD. */ 03156000
*/*                                                                  */ 03157000
*/********************************************************************/ 03158000
*MODLELSE:PROCEDURE;                                               0834 03159000
MODLELSE STM   @14,@04,@SA00007                                    0834 03160000
         STM   @06,@12,@SA00007+28                                 0834 03161000
*        /************************************************************/ 03162000
*        /*                                                          */ 03163000
*        /*  ** MODLELSE **  INTERPRET THE MODAL 'ELSE' COMMAND      */ 03164000
*        /*                                                          */ 03165000
*        /************************************************************/ 03166000
*        IF GDTDBG = NULLPTR                                       0835 03167000
*          THEN;                                                   0835 03168000
         ICM   @04,15,GDTDBG(GDTPTR)                               0835 03169000
         BZ    @RT00835                                            0835 03170000
*          ELSE                                                    0837 03171000
*            CALL IDCDB010(GDTTBL,'RIME');                         0837 03172000
*                                                                  0837 03173000
         ST    GDTPTR,@AL00001                                     0837 03174000
         LA    @04,@CC01046                                        0837 03175000
         ST    @04,@AL00001+4                                      0837 03176000
         MVI   @AL00001+4,X'80'                                    0837 03177000
         L     @15,GDTDBG(,GDTPTR)                                 0837 03178000
         LA    @01,@AL00001                                        0837 03179000
         BALR  @14,@15                                             0837 03180000
*        THENFLAG(NESTLVL)=OFF;                                    0838 03181000
@RT00835 DS    0H                                                  0839 03182000
*        ELSEFLAG(NESTLVL)=ON;                                     0839 03183000
*                                                                  0839 03184000
         L     @04,GDTRIH(,GDTPTR)                                 0839 03185000
         SLR   @02,@02                                             0839 03186000
         IC    @02,NESTLVL(,@04)                                   0839 03187000
         ALR   @02,@02                                             0839 03188000
         ST    @02,@TF00001                                        0839 03189000
         ALR   @02,@04                                             0839 03190000
         OI    ELSEFLAG-2(@02),B'00100000'                         0839 03191000
         NI    THENFLAG-2(@02),B'10111111'                         0839 03192000
*        /************************************************************/ 03193000
*        /*                                                          */ 03194000
*        /* IF WHAT FOLLOWED THE MATCHING 'THEN' FOR THIS 'ELSE' WAS */ 03195000
*        /* SCANNED ONLY (BECAUSE OF THE RESULT OF AN 'IF'           */ 03196000
*        /* EXPRESSION), THEN SET THE FLAG TO INDICATE THAT A        */ 03197000
*        /* FUNCTION COMMAND ASSOCIATED WITH THIS 'ELSE' MAY BE      */ 03198000
*        /* ACCEPTED FOR EXECUTION.                                  */ 03199000
*        /*                                                          */ 03200000
*        /************************************************************/ 03201000
*        IF SKIPFLAG(NESTLVL)=OFF                                  0840 03202000
*          THEN                                                    0840 03203000
         LR    @02,@04                                             0840 03204000
         AL    @02,@TF00001                                        0840 03205000
         TM    SKIPFLAG-2(@02),B'00010000'                         0840 03206000
         BNZ   @RF00840                                            0840 03207000
*            SKIPFLAG(NESTLVL)=ON;                                 0841 03208000
         AL    @04,@TF00001                                        0841 03209000
         OI    SKIPFLAG-2(@04),B'00010000'                         0841 03210000
*          ELSE                                                    0842 03211000
*            IF NESTLVL<=1 | SKIPFLAG(NESTLVL-1)=OFF               0842 03212000
*              THEN                                                0842 03213000
         B     @RC00840                                            0842 03214000
@RF00840 L     @04,GDTRIH(,GDTPTR)                                 0842 03215000
         CLI   NESTLVL(@04),1                                      0842 03216000
         BNH   @RT00842                                            0842 03217000
         SLR   @02,@02                                             0842 03218000
         IC    @02,NESTLVL(,@04)                                   0842 03219000
         ALR   @02,@02                                             0842 03220000
         ALR   @04,@02                                             0842 03221000
         TM    SKIPFLAG-4(@04),B'00010000'                         0842 03222000
         BNZ   @RF00842                                            0842 03223000
@RT00842 DS    0H                                                  0843 03224000
*                SKIPFLAG(NESTLVL)=OFF;                            0843 03225000
*                                                                  0843 03226000
         L     @04,GDTRIH(,GDTPTR)                                 0843 03227000
         SLR   @02,@02                                             0843 03228000
         IC    @02,NESTLVL(,@04)                                   0843 03229000
         ALR   @02,@02                                             0843 03230000
         ALR   @04,@02                                             0843 03231000
         NI    SKIPFLAG-2(@04),B'11101111'                         0843 03232000
*        /************************************************************/ 03233000
*        /*                                                          */ 03234000
*        /* IF THE COMMAND-END DELIMITER IMMEDIATELY FOLLOWS THE     */ 03235000
*        /* 'ELSE' KEYWORD, THE 'ELSE PATH' CONSISTS ONLY OF A NULL  */ 03236000
*        /* COMMAND.  THE COMMAND-END DELIMITER IS THEN BYPASSED AND */ 03237000
*        /* SCANNING CONTINUES.                                      */ 03238000
*        /*                                                          */ 03239000
*        /************************************************************/ 03240000
*        IF CHAR1=ENDDELIM                                         0844 03241000
*          THEN                                                    0844 03242000
@RF00842 DS    0H                                                  0844 03243000
@RC00840 CLI   CHAR1,C';'                                          0844 03244000
         BNE   @RF00844                                            0844 03245000
*            DO;                                                   0845 03246000
*            NESTLVL=NESTLVL-1;                                    0846 03247000
*                                                                  0846 03248000
         L     @04,GDTRIH(,GDTPTR)                                 0846 03249000
         SLR   @02,@02                                             0846 03250000
         IC    @02,NESTLVL(,@04)                                   0846 03251000
         BCTR  @02,0                                               0846 03252000
         STC   @02,NESTLVL(,@04)                                   0846 03253000
*            CALL BYPASTRM;                                        0847 03254000
*                                                                  0847 03255000
         BAL   @14,BYPASTRM                                        0847 03256000
*            END;                                                  0848 03257000
*          ELSE                                                    0849 03258000
*                                                                  0849 03259000
*            /********************************************************/ 03260000
*            /*                                                      */ 03261000
*            /* EXTRACT THE VERB NAME OF THE COMMAND WHICH FOLLOWS   */ 03262000
*            /* THE 'ELSE'.  IF IT IS A 'DO' COMMAND, SET THE FLAG   */ 03263000
*            /* THAT INDICATES THAT A 'DO GROUP' FOLLOWS AND SCAN UP */ 03264000
*            /* TO THE NEXT COMMAND VERB NAME.  IF NOT A 'DO', NOTE  */ 03265000
*            /* THAT THE NEXT COMMAND VERB NAME HAS ALREADY BEEN     */ 03266000
*            /* EXTRACTED.                                           */ 03267000
*            /*                                                      */ 03268000
*            /********************************************************/ 03269000
*            DO;                                                   0849 03270000
*                                                                  0849 03271000
         B     @RC00844                                            0849 03272000
@RF00844 DS    0H                                                  0850 03273000
*            CALL NXTFIELD(VERBFLD);                               0850 03274000
         LA    @01,@AL00850                                        0850 03275000
         BAL   @14,NXTFIELD                                        0850 03276000
*            CALL SCANSEP(NO);                                     0851 03277000
*                                                                  0851 03278000
         LA    @01,@AL00851                                        0851 03279000
         BAL   @14,SCANSEP                                         0851 03280000
*            IF SYNUNIT=DOSYM                                      0852 03281000
*              THEN                                                0852 03282000
         L     @04,GDTRIH(,GDTPTR)                                 0852 03283000
         L     @04,KWTBLPTR(,@04)                                  0852 03284000
         CLC   SYNUNIT(9),DOSYM(@04)                               0852 03285000
         BNE   @RF00852                                            0852 03286000
*                DO;                                               0853 03287000
*                                                                  0853 03288000
*                CALL BYPASTRM;                                    0854 03289000
*                                                                  0854 03290000
         BAL   @14,BYPASTRM                                        0854 03291000
*                DOFLAG(NESTLVL)=ON;                               0855 03292000
         L     @04,GDTRIH(,GDTPTR)                                 0855 03293000
         SLR   @02,@02                                             0855 03294000
         IC    @02,NESTLVL(,@04)                                   0855 03295000
         ALR   @02,@02                                             0855 03296000
         ALR   @04,@02                                             0855 03297000
         OI    DOFLAG-2(@04),B'10000000'                           0855 03298000
*                END;                                              0856 03299000
*              ELSE                                                0857 03300000
*                DO;                                               0857 03301000
         B     @RC00852                                            0857 03302000
@RF00852 DS    0H                                                  0858 03303000
*                GETVERB=NO;                                       0858 03304000
         NI    GETVERB,B'11111011'                                 0858 03305000
*                IF SYNUNIT^=IFSYM                                 0859 03306000
*                  THEN                                            0859 03307000
         L     @04,GDTRIH(,GDTPTR)                                 0859 03308000
         L     @04,KWTBLPTR(,@04)                                  0859 03309000
         CLC   SYNUNIT(9),IFSYM(@04)                               0859 03310000
         BE    @RF00859                                            0859 03311000
*                    SINGLCMD=YES;                                 0860 03312000
         OI    SINGLCMD,B'00010000'                                0860 03313000
*                  ELSE                                            0861 03314000
*                    IFNEXT=YES;                                   0861 03315000
         B     @RC00859                                            0861 03316000
@RF00859 OI    IFNEXT,B'00001000'                                  0861 03317000
*                END;                                              0862 03318000
@RC00859 DS    0H                                                  0863 03319000
*            END;                                                  0863 03320000
*                                                                  0863 03321000
@RC00852 DS    0H                                                  0864 03322000
*        IF RISTATUS ^= 0                                          0864 03323000
*          THEN                                                    0864 03324000
@RC00844 LH    @04,RISTATUS                                        0864 03325000
         LTR   @04,@04                                             0864 03326000
         BZ    @RF00864                                            0864 03327000
*            IF RISTATUS=EOFILE & EOFOK=YES                        0865 03328000
*              THEN;                                               0865 03329000
         CH    @04,@CH00157                                        0865 03330000
         BNE   @RF00865                                            0865 03331000
         TM    EOFOK,B'01000000'                                   0865 03332000
         BO    @RT00865                                            0865 03333000
*              ELSE                                                0867 03334000
*                LASTCC=TERMERR;                                   0867 03335000
*                                                                  0867 03336000
@RF00865 MVC   LASTCC(2),@CH00482                                  0867 03337000
*        END MODLELSE;                                             0868 03338000
@EL00007 DS    0H                                                  0868 03339000
@EF00007 DS    0H                                                  0868 03340000
@ER00007 LM    @14,@04,@SA00007                                    0868 03341000
         LM    @06,@12,@SA00007+28                                 0868 03342000
         BR    @14                                                 0868 03343000
*/********************************************************************/ 03344000
*/*                                                                  */ 03345000
*/*  PROCEDURE NAME - BYPASTRM                                       */ 03346000
*/*                                                                  */ 03347000
*/*  FUNCTION - THIS ROUTINE BYPASSES THE COMMAND-END DELIMITER THAT */ 03348000
*/*             FOLLOWS A MODAL COMMAND OR INDICATES A NULL COMMAND  */ 03349000
*/*             AND ALSO SCANS PAST RECORDS WHICH FOLLOW THIS RECORD */ 03350000
*/*             IF CONTINUATION DELIMITERS ARE FOUND.  UPON EXIT FROM*/ 03351000
*/*             BYPASTRM, THE SCAN POINTS TO THE FIRST CHARACTER OF  */ 03352000
*/*             THE NEXT COMMAND VERB NAME.                          */ 03353000
*/*                                                                  */ 03354000
*/*  INPUT -                                                         */ 03355000
*/*          CHAR1 -   MOST RECENTLY EXTRACTED CHARACTER FROM THE    */ 03356000
*/*                    INPUT STREAM (SHOULD BE A SEMICOLON)          */ 03357000
*/*          MORTOCOM- FLAG SET 'ON' WHEN THE CURRENT RECORD IS      */ 03358000
*/*                    CONTINUED ON TO THE NEXT RECORD.              */ 03359000
*/*                                                                  */ 03360000
*/*  OUTPUT -                                                        */ 03361000
*/*          EOFOK -   FLAG SET 'ON' WHEN END-OF-FILE MAY CORRECTLY  */ 03362000
*/*                    ENCOUNTERED ON THE COMMAND INPUT STREAM.      */ 03363000
*/*          FIRSTCHR- FLAG SET 'ON' WHEN THE FIRST CHARACTER OF A   */ 03364000
*/*                    NEW RECORD IS TO BE OBTAINED NEXT.            */ 03365000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 03366000
*/*                    CODE IF END-OF-FILE IS FOUND WHILE SCANNING   */ 03367000
*/*                    UP TO THE NEXT COMMAND'S VERB NAME.           */ 03368000
*/*                                                                  */ 03369000
*/********************************************************************/ 03370000
*BYPASTRM:PROCEDURE;                                               0869 03371000
BYPASTRM STM   @14,@12,@SA00008                                    0869 03372000
*        /************************************************************/ 03373000
*        /*                                                          */ 03374000
*        /*  ** BYPASTRM **  BYPASS COMMAND-ENDING DELIMITER         */ 03375000
*        /*                                                          */ 03376000
*        /************************************************************/ 03377000
*        IF GDTDBG = NULLPTR                                       0870 03378000
*          THEN;                                                   0870 03379000
         ICM   @02,15,GDTDBG(GDTPTR)                               0870 03380000
         BZ    @RT00870                                            0870 03381000
*          ELSE                                                    0872 03382000
*            CALL IDCDB010(GDTTBL,'RIBT');                         0872 03383000
*                                                                  0872 03384000
         ST    GDTPTR,@AL00001                                     0872 03385000
         LA    @02,@CC01050                                        0872 03386000
         ST    @02,@AL00001+4                                      0872 03387000
         MVI   @AL00001+4,X'80'                                    0872 03388000
         L     @15,GDTDBG(,GDTPTR)                                 0872 03389000
         LA    @01,@AL00001                                        0872 03390000
         BALR  @14,@15                                             0872 03391000
*        DO WHILE(MORTOCOM=YES & RISTATUS=0);                      0873 03392000
*                                                                  0873 03393000
@RT00870 B     @DE00873                                            0873 03394000
@DL00873 DS    0H                                                  0874 03395000
*          CALL NEXTCHAR;                                          0874 03396000
         BAL   @14,NEXTCHAR                                        0874 03397000
*          CALL SKIPCMD;                                           0875 03398000
*                                                                  0875 03399000
         BAL   @14,SKIPCMD                                         0875 03400000
*        END;                                                      0876 03401000
@DE00873 TM    MORTOCOM,B'00010000'                                0876 03402000
         BNO   @DC00873                                            0876 03403000
         ICM   @02,3,RISTATUS                                      0876 03404000
         BZ    @DL00873                                            0876 03405000
@DC00873 DS    0H                                                  0877 03406000
*        IF RISTATUS=0                                             0877 03407000
*          THEN                                                    0877 03408000
         ICM   @02,3,RISTATUS                                      0877 03409000
         BNZ   @RF00877                                            0877 03410000
*            DO;                                                   0878 03411000
*            EOFOK=YES;                                            0879 03412000
         OI    EOFOK,B'01000000'                                   0879 03413000
*            FIRSTCHR=YES;                                         0880 03414000
         OI    FIRSTCHR,B'00000100'                                0880 03415000
*            CHAR1=BLANK;                                          0881 03416000
*                                                                  0881 03417000
         MVI   CHAR1,C' '                                          0881 03418000
*            CALL SCANSEP(NO);                                     0882 03419000
*                                                                  0882 03420000
         LA    @01,@AL00882                                        0882 03421000
         BAL   @14,SCANSEP                                         0882 03422000
*            END;                                                  0883 03423000
*        END BYPASTRM;                                             0884 03424000
*                                                                  0884 03425000
*                                                                  0884 03426000
@EL00008 DS    0H                                                  0884 03427000
@EF00008 DS    0H                                                  0884 03428000
@ER00008 LM    @14,@12,@SA00008                                    0884 03429000
         BR    @14                                                 0884 03430000
*        END GETNEXT;                                              0885 03431000
@EL00004 DS    0H                                                  0885 03432000
@EF00004 DS    0H                                                  0885 03433000
@ER00004 LM    @14,@03,@SA00004                                    0885 03434000
         LM    @06,@12,@SA00004+24                                 0885 03435000
         BR    @14                                                 0885 03436000
*/********************************************************************/ 03437000
*/*                                                                  */ 03438000
*/*  PROCEDURE NAME - KWDPARM                                        */ 03439000
*/*                                                                  */ 03440000
*/*  FUNCTION - THIS ROUTINE EXTRACTS A KEYWORD AND THEN SEARCHES THE*/ 03441000
*/*             COMMAND DESCRIPTOR FOR A MATCH.  THEN, USING THE     */ 03442000
*/*             PARAMETER DESCRIPTION, THE ROUTINE SETS UP TO EXTRACT*/ 03443000
*/*             THIS PARAMETER'S SUBPARAMETERS OR DATA IF EITHER     */ 03444000
*/*             EXISTS.                                              */ 03445000
*/*                                                                  */ 03446000
*/*  INPUT -                                                         */ 03447000
*/*          COMMAND DESCRIPTOR FOR FUNCTION COMMAND BEING SCANNED.  */ 03448000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 03449000
*/*                    VALUE WHEN AN ERROR HAS OCCURRED.             */ 03450000
*/*          SUPERID - PARAMETER ID# OF PARAMETER WHOSE SUBPARAMETER */ 03451000
*/*                    LIST IS CURRENTLY BEING SCANNED (ID#=0 IF     */ 03452000
*/*                    FIRST-LEVEL PARM'S. ARE NOW BEING SCANNED).   */ 03453000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/ 03454000
*/*          SYNUNIT - CONTAINS THE KEYWORD JUST EXTRACTED           */ 03455000
*/*          UNITINDX- LENGTH OF KEYWORD JUST EXTRACTED.             */ 03456000
*/*          CHAR1 -   MOST RECENTLY EXTRACTED CHARACTER             */ 03457000
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */ 03458000
*/*                    SCANNING IS CURRENTLY TAKING PLACE.           */ 03459000
*/*          REPDEPTH- LEVEL OF REPEATED SUBPARAMETER LIST NESTING   */ 03460000
*/*                    AT WHICH SCANNING IS CURRENTLY TAKING PLACE.  */ 03461000
*/*                                                                  */ 03462000
*/*  OUTPUT -                                                        */ 03463000
*/*          JUSTONE - FLAG SET 'ON' WHEN A SINGLE SCALAR LIST ITEM  */ 03464000
*/*                    HAS BEEN CODED FOR A PARAMETER                */ 03465000
*/*          PARMID -  ID# OF PARAMETER CURRENTLY BEING HANDLED.     */ 03466000
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */ 03467000
*/*                    SCANNING WILL TAKE PLACE AFTER THIS KEYWORD.  */ 03468000
*/*          PPARMCNT- NUMBER OF POSITIONAL PARAMETERS FOUND IN      */ 03469000
*/*                    CURRENT SUBPARAMETER LIST.                    */ 03470000
*/*          SUPERID - SEE 'INPUT'                                   */ 03471000
*/*          SUBSYET - FLAG SET 'ON' WHEN AT LEAST ONE SUBPARAMETER  */ 03472000
*/*                    HAS BEEN FOUND IN THE CURRENT SUBLIST.        */ 03473000
*/*          REPDEPTH- LEVEL OF REPEATED SUBPARM. LIST NESTING AT    */ 03474000
*/*                    WHICH SCANNING WILL TAKE PLACE FOLLOWING THIS */ 03475000
*/*                    KEYWORD.                                      */ 03476000
*/*          REPCOUNT- NUMBER OF REPEATED SUBLISTS FOUND AT CURRENT  */ 03477000
*/*                    REPEATED SUBLIST LEVEL.                       */ 03478000
*/*          REPLIMIT- MAXIMUM NUMBER OF REPEATED SUBLISTS ALLOWED   */ 03479000
*/*                    AT CURRENT LEVEL.                             */ 03480000
*/*          ARRYPTR - POINTER TO INTERMEDIATE POINTER VECTOR WHICH  */ 03481000
*/*                    CONTAINS PTRS TO DATA STRUCTURES FOR CURRENT  */ 03482000
*/*                    KEYWORD PARAMETER                             */ 03483000
*/*                                                                  */ 03484000
*/********************************************************************/ 03485000
*KWDPARM:PROCEDURE;                                                0886 03486000
KWDPARM  STM   @14,@04,@SA00009                                    0886 03487000
         STM   @06,@12,@SA00009+28                                 0886 03488000
*        /************************************************************/ 03489000
*        /*                                                          */ 03490000
*        /* KWDPARM PROCEDURE DATA DECLARATIONS                      */ 03491000
*        /*                                                          */ 03492000
*        /************************************************************/ 03493000
*        DCL SUBTOTAL FIXED(15);       /*COUNT OF SUBPARAMETERS OF 0887 03494000
*                                        CURRENT PARAMETER           */ 03495000
*        DCL WORKVAR1 FIXED(15);       /*VARIABLE TO CONTAIN @YL026UL*/ 03496000
*                                      /*A TEMPORARY VALUE   @YL026UL*/ 03497000
*        DCL KWDMATCH BIT(1);          /*SIGNALS THAT A MATCHING   0889 03498000
*                                        KEYWORD HAS BEEN FOUND      */ 03499000
*                                                                  0889 03500000
*        /*STATIC ERROR MESSAGE CODES                                */ 03501000
*        DCL BADELIM2 FIXED(31)        /*LEFT PARENTHESIS MISSING    */ 03502000
*                     CONSTANT(9);                                 0890 03503000
*        /************************************************************/ 03504000
*        /*                                                          */ 03505000
*        /*  ** KWDPARM **  EXTRACT A KEYWORD PARAMETER              */ 03506000
*        /*                                                          */ 03507000
*        /************************************************************/ 03508000
*        KWDMATCH=NO;                                              0891 03509000
         NI    KWDMATCH,B'01111111'                                0891 03510000
*        JUSTONE=NO;                                               0892 03511000
         NI    JUSTONE,B'11111110'                                 0892 03512000
*        ENDPAREN=YES;                                             0893 03513000
*                                                                  0893 03514000
         OI    ENDPAREN,B'10000000'                                0893 03515000
*        /************************************************************/ 03516000
*        /*                                                          */ 03517000
*        /* EXTRACT THE KEYWORD, CHECKING THAT IT DOESN'T EXCEED     */ 03518000
*        /* KEYWORD LENGTH LIMIT.                                    */ 03519000
*        /*                                                          */ 03520000
*        /************************************************************/ 03521000
*                                                                  0894 03522000
*        CALL NXTFIELD(KEYWORD);                                   0894 03523000
*                                                                  0894 03524000
         LA    @01,@AL00894                                        0894 03525000
         BAL   @14,NXTFIELD                                        0894 03526000
*        IF RISTATUS=0                                             0895 03527000
*          THEN                                                    0895 03528000
*                                                                  0895 03529000
         ICM   @04,3,RISTATUS                                      0895 03530000
         BNZ   @RF00895                                            0895 03531000
*            /********************************************************/ 03532000
*            /*                                                      */ 03533000
*            /* SCAN KEYWORD DESCRIPTIONS IN THE COMMAND DESCRIPTOR, */ 03534000
*            /* SEARCHING FOR A MATCH WITH THE EXTRACTED KEYWORD     */ 03535000
*            /*                                                      */ 03536000
*            /********************************************************/ 03537000
*DOGRP40:    DO;                                                   0896 03538000
DOGRP40  DS    0H                                                  0897 03539000
*            IF SUPERID(PARMLVL)=0                                 0897 03540000
*              THEN                                                0897 03541000
*                                                                  0897 03542000
         LH    @04,PARMLVL                                         0897 03543000
         ALR   @04,@04                                             0897 03544000
         LH    @04,SUPERID-2(@04)                                  0897 03545000
         LTR   @04,@04                                             0897 03546000
         BNZ   @RF00897                                            0897 03547000
*                /****************************************************/ 03548000
*                /*                                                  */ 03549000
*                /* WHEN CURRENTLY SCANNING FIRST-LEVEL PARAMETERS,  */ 03550000
*                /* CHECK DESCRIPTION OF EVERY FIRST-LEVEL PARAMETER */ 03551000
*                /* FOR A KEYWORD NAME MATCH.                        */ 03552000
*                /*                                                  */ 03553000
*                /****************************************************/ 03554000
*                DO INDEX=1 TO MAXID WHILE(KWDMATCH=NO);           0898 03555000
         LA    @04,1                                               0898 03556000
         B     @DE00898                                            0898 03557000
@DL00898 TM    KWDMATCH,B'10000000'                                0898 03558000
         BNZ   @DC00898                                            0898 03559000
*                  IF PARMPTR(INDEX)^=0                            0899 03560000
*                    THEN                                          0899 03561000
         L     @02,WORKPTR                                         0899 03562000
         LA    @15,12                                              0899 03563000
         LR    @01,@04                                             0899 03564000
         MR    @00,@15                                             0899 03565000
         AL    @01,@CF01440                                        0899 03566000
         L     @14,PARMPTR(@01,@02)                                0899 03567000
         LTR   @14,@14                                             0899 03568000
         BZ    @RF00899                                            0899 03569000
*                      DO;                                         0900 03570000
*                      PARMID=INDEX;                               0901 03571000
         STH   @04,PARMID                                          0901 03572000
*                      IF LEVEL1=YES & KWDDSPL^=0                  0902 03573000
*                        THEN                                      0902 03574000
         LR    @01,@04                                             0902 03575000
         MR    @00,@15                                             0902 03576000
         AL    @02,@CF01440                                        0902 03577000
         L     @04,PARMPTR(@01,@02)                                0902 03578000
         TM    LEVEL1(@04),B'01000000'                             0902 03579000
         BNO   @RF00902                                            0902 03580000
         CLI   KWDDSPL(@04),0                                      0902 03581000
         BE    @RF00902                                            0902 03582000
*                          DO;                                     0903 03583000
*                            KWDPTR=ADDR(KWDCOUNT)+LENGTH(KWDCOUNT);    03584000
         LA    @15,1                                               0904 03585000
         SLR   KWDPTR,KWDPTR                                       0904 03586000
         IC    KWDPTR,KWDDSPL(,@04)                                0904 03587000
         ALR   KWDPTR,KWDPTR                                       0904 03588000
         ALR   @04,KWDPTR                                          0904 03589000
         ALR   @04,@15                                             0904 03590000
         LR    KWDPTR,@04                                          0904 03591000
*                            DO LISTINDX=1 TO KWDCOUNT             0905 03592000
*                                      WHILE(KWDMATCH=NO);         0905 03593000
         B     @DE00905                                            0905 03594000
@DL00905 TM    KWDMATCH,B'10000000'                                0905 03595000
         BNZ   @DC00905                                            0905 03596000
*                              IF UNITINDX=KWDLEN &                0906 03597000
*                                 KWDITEM(1:KWDLEN) = SYNUNIT(1:KWDLEN) 03598000
*                                THEN                              0906 03599000
         SLR   @04,@04                                             0906 03600000
         IC    @04,KWDLEN(,KWDPTR)                                 0906 03601000
         CR    UNITINDX,@04                                        0906 03602000
         BNE   @RF00906                                            0906 03603000
         BCTR  @04,0                                               0906 03604000
         EX    @04,@SC01463                                        0906 03605000
         BNE   @RF00906                                            0906 03606000
*                                  KWDMATCH=YES;                   0907 03607000
         OI    KWDMATCH,B'10000000'                                0907 03608000
*                                ELSE                              0908 03609000
*                                  KWDPTR=KWDPTR+KWDLEN+LENGTH(KWDLEN); 03610000
         B     @RC00906                                            0908 03611000
@RF00906 LR    @04,KWDPTR                                          0908 03612000
         SLR   @15,@15                                             0908 03613000
         IC    @15,KWDLEN(,KWDPTR)                                 0908 03614000
         ALR   @04,@15                                             0908 03615000
         AL    @04,@CF00228                                        0908 03616000
         LR    KWDPTR,@04                                          0908 03617000
*                            END;                                  0909 03618000
@RC00906 LA    @15,1                                               0909 03619000
         AH    @15,LISTINDX                                        0909 03620000
@DE00905 STH   @15,LISTINDX                                        0909 03621000
         LH    @04,PARMID                                          0909 03622000
         MH    @04,@CH00038                                        0909 03623000
         LH    @14,PARMID                                          0909 03624000
         MH    @14,@CH00038                                        0909 03625000
         L     @01,WORKPTR                                         0909 03626000
         AL    @01,@CF01440                                        0909 03627000
         L     @14,PARMPTR(@14,@01)                                0909 03628000
         SLR   @01,@01                                             0909 03629000
         IC    @01,KWDDSPL(,@14)                                   0909 03630000
         ALR   @01,@01                                             0909 03631000
         L     @14,WORKPTR                                         0909 03632000
         AL    @14,@CF01440                                        0909 03633000
         AL    @01,PARMPTR(@04,@14)                                0909 03634000
         SLR   @04,@04                                             0909 03635000
         IC    @04,KWDCOUNT(,@01)                                  0909 03636000
         CR    @15,@04                                             0909 03637000
         BNH   @DL00905                                            0909 03638000
@DC00905 DS    0H                                                  0910 03639000
*                          END;                                    0910 03640000
*                      END;                                        0911 03641000
@RF00902 DS    0H                                                  0912 03642000
*                END;                                              0912 03643000
@RF00899 LA    @04,1                                               0912 03644000
         AH    @04,INDEX                                           0912 03645000
@DE00898 STH   @04,INDEX                                           0912 03646000
         L     @02,DESCPTR                                         0912 03647000
         CH    @04,MAXID(,@02)                                     0912 03648000
         BNH   @DL00898                                            0912 03649000
@DC00898 DS    0H                                                  0913 03650000
*              ELSE                                                0913 03651000
*                                                                  0913 03652000
*                /****************************************************/ 03653000
*                /*                                                  */ 03654000
*                /*  WHEN SCANNING A SUBPARAMETER LIST, CHECK FOR A  */ 03655000
*                /*  KEYWORD MATCH AMONG THE POSSIBLE SUBPARAMETERS  */ 03656000
*                /*  OF THE CURRENT SUPERPARAMETER.                  */ 03657000
*                /*                                                  */ 03658000
*                /****************************************************/ 03659000
*                DO;                                               0913 03660000
         B     @RC00897                                            0913 03661000
@RF00897 DS    0H                                                  0914 03662000
*                  OLDERID2 = NEWERID2;                            0914 03663000
         L     @04,GDTTR2(,GDTPTR)                                 0914 03664000
         MVC   @TS00001(95),NEWERID2(@04)                          0914 03665000
         MVC   OLDERID2(95,@04),@TS00001                           0914 03666000
*                  NEWID2='RI09';                                  0915 03667000
         MVC   NEWID2(4,@04),@CC01060                              0915 03668000
*                  SUBTOTAL=SUBCOUNT;                              0916 03669000
         LA    @04,12                                              0916 03670000
         LR    @02,@04                                             0916 03671000
         MH    @02,PARMID                                          0916 03672000
         L     @01,WORKPTR                                         0916 03673000
         AL    @01,@CF01440                                        0916 03674000
         L     @02,PARMPTR(@02,@01)                                0916 03675000
         ALR   @04,@02                                             0916 03676000
         SLR   @15,@15                                             0916 03677000
         IC    @15,SUBDSPL(,@04)                                   0916 03678000
         ALR   @15,@15                                             0916 03679000
         ALR   @02,@15                                             0916 03680000
         MVC   SUBTOTAL(2),SUBCOUNT(@02)                           0916 03681000
*                  DO INDEX=1 TO SUBTOTAL WHILE(KWDMATCH=NO);      0917 03682000
         LA    @04,1                                               0917 03683000
         B     @DE00917                                            0917 03684000
@DL00917 TM    KWDMATCH,B'10000000'                                0917 03685000
         BNZ   @DC00917                                            0917 03686000
*                    PARMID=SUBID(INDEX);                          0918 03687000
         SLA   @04,2                                               0918 03688000
         L     @02,WORKPTR                                         0918 03689000
         LA    @15,12                                              0918 03690000
         LR    @14,@15                                             0918 03691000
         MH    @14,PARMID                                          0918 03692000
         AL    @14,@CF01440                                        0918 03693000
         L     @14,PARMPTR(@14,@02)                                0918 03694000
         LR    @01,@14                                             0918 03695000
         ALR   @01,@15                                             0918 03696000
         SLR   @00,@00                                             0918 03697000
         IC    @00,SUBDSPL(,@01)                                   0918 03698000
         ALR   @00,@00                                             0918 03699000
         ALR   @14,@00                                             0918 03700000
         LH    @04,SUBID-4(@04,@14)                                0918 03701000
         STH   @04,PARMID                                          0918 03702000
*                    IF KWDDSPL ^= 0                               0919 03703000
*                      THEN                                        0919 03704000
         LR    @01,@04                                             0919 03705000
         MR    @00,@15                                             0919 03706000
         AL    @02,@CF01440                                        0919 03707000
         L     @04,PARMPTR(@01,@02)                                0919 03708000
         CLI   KWDDSPL(@04),0                                      0919 03709000
         BE    @RF00919                                            0919 03710000
*                        DO;                                       0920 03711000
         ST    @04,@TF00001                                        0920 03712000
*                          KWDPTR=ADDR(KWDCOUNT)+LENGTH(KWDCOUNT); 0921 03713000
         LA    @15,1                                               0921 03714000
         L     @01,@TF00001                                        0921 03715000
         SLR   KWDPTR,KWDPTR                                       0921 03716000
         IC    KWDPTR,KWDDSPL(,@01)                                0921 03717000
         ALR   KWDPTR,KWDPTR                                       0921 03718000
         AL    KWDPTR,@TF00001                                     0921 03719000
         LR    @14,KWDPTR                                          0921 03720000
         ALR   @14,@15                                             0921 03721000
         ST    KWDPTR,@TF00001                                     0921 03722000
         LR    KWDPTR,@14                                          0921 03723000
*                          WORKVAR1=KWDCOUNT;              /*@YL026UL*/ 03724000
         L     @01,@TF00001                                        0922 03725000
         SLR   WORKVAR1,WORKVAR1                                   0922 03726000
         IC    WORKVAR1,KWDCOUNT(,@01)                             0922 03727000
*                          DO LISTINDX=1 TO WORKVAR1               0923 03728000
*                                      WHILE(KWDMATCH=NO); /*@YL026UL*/ 03729000
         B     @DE00923                                            0923 03730000
@DL00923 TM    KWDMATCH,B'10000000'                                0923 03731000
         BNZ   @DC00923                                            0923 03732000
*                            IF UNITINDX=KWDLEN &                  0924 03733000
*                               KWDITEM(1:KWDLEN)=SYNUNIT(1:KWDLEN)     03734000
*                              THEN                                0924 03735000
         SLR   @15,@15                                             0924 03736000
         IC    @15,KWDLEN(,KWDPTR)                                 0924 03737000
         CR    UNITINDX,@15                                        0924 03738000
         BNE   @RF00924                                            0924 03739000
         BCTR  @15,0                                               0924 03740000
         EX    @15,@SC01463                                        0924 03741000
         BNE   @RF00924                                            0924 03742000
*                                KWDMATCH=YES;                     0925 03743000
         OI    KWDMATCH,B'10000000'                                0925 03744000
*                              ELSE                                0926 03745000
*                                KWDPTR=KWDPTR+KWDLEN+LENGTH(KWDLEN);   03746000
         B     @RC00924                                            0926 03747000
@RF00924 LR    @15,KWDPTR                                          0926 03748000
         SLR   @14,@14                                             0926 03749000
         IC    @14,KWDLEN(,KWDPTR)                                 0926 03750000
         ALR   @15,@14                                             0926 03751000
         AL    @15,@CF00228                                        0926 03752000
         LR    KWDPTR,@15                                          0926 03753000
*                          END;                                    0927 03754000
@RC00924 LA    @15,1                                               0927 03755000
         AH    @15,LISTINDX                                        0927 03756000
@DE00923 STH   @15,LISTINDX                                        0927 03757000
         CR    @15,WORKVAR1                                        0927 03758000
         BNH   @DL00923                                            0927 03759000
@DC00923 DS    0H                                                  0928 03760000
*                        END;                                      0928 03761000
*                    IF KWDMATCH=NO                                0929 03762000
*                      THEN                                        0929 03763000
@RF00919 TM    KWDMATCH,B'10000000'                                0929 03764000
         BNZ   @RF00929                                            0929 03765000
*                        PARMID=SUPERID(PARMLVL);                  0930 03766000
         LH    @04,PARMLVL                                         0930 03767000
         ALR   @04,@04                                             0930 03768000
         LH    @04,SUPERID-2(@04)                                  0930 03769000
         STH   @04,PARMID                                          0930 03770000
*                  END;                                            0931 03771000
@RF00929 LA    @04,1                                               0931 03772000
         AH    @04,INDEX                                           0931 03773000
@DE00917 STH   @04,INDEX                                           0931 03774000
         CH    @04,SUBTOTAL                                        0931 03775000
         BNH   @DL00917                                            0931 03776000
@DC00917 DS    0H                                                  0932 03777000
*                END;                                              0932 03778000
*                                                                  0932 03779000
*            /********************************************************/ 03780000
*            /*                                                      */ 03781000
*            /* IF A MATCHING KEYWORD WAS FOUND, SET A FLAG NOTING   */ 03782000
*            /* THIS KEYWORD PARAMETER ID#, AND THEN USE THE KEYWORD */ 03783000
*            /* DESCRIPTOR DATA TO CONTROL SCANNING OF THE REMAINDER */ 03784000
*            /* OF THE PARAMETER                                     */ 03785000
*            /*                                                      */ 03786000
*            /********************************************************/ 03787000
*            IF KWDMATCH=YES                                       0933 03788000
*              THEN                                                0933 03789000
@RC00897 TM    KWDMATCH,B'10000000'                                0933 03790000
         BNO   @RF00933                                            0933 03791000
*DOGRP45:        DO;                                               0934 03792000
*                                                                  0934 03793000
DOGRP45  DS    0H                                                  0935 03794000
*                CALL SETFLAG;                                     0935 03795000
*                                                                  0935 03796000
         BAL   @14,SETFLAG                                         0935 03797000
*                IF RISTATUS ^= 0                                  0936 03798000
*                  THEN                                            0936 03799000
         ICM   @04,3,RISTATUS                                      0936 03800000
         BNZ   @RT00936                                            0936 03801000
*                    RETURN;                                       0937 03802000
*                                                                  0937 03803000
*                /****************************************************/ 03804000
*                /*                                                  */ 03805000
*                /* SCAN PAST THE OPENING PARENTHESIS FOLLOWING THE  */ 03806000
*                /* KEYWORD, UNLESS IT IS A 'VALUE' KEYWORD          */ 03807000
*                /*                                                  */ 03808000
*                /****************************************************/ 03809000
*                IF SUBLIST=YES | SCLRDATA=YES                     0938 03810000
*                  THEN                                            0938 03811000
         LH    @04,PARMID                                          0938 03812000
         MH    @04,@CH00038                                        0938 03813000
         L     @02,WORKPTR                                         0938 03814000
         AL    @02,@CF01440                                        0938 03815000
         L     @04,PARMPTR(@04,@02)                                0938 03816000
         TM    SUBLIST(@04),B'10000010'                            0938 03817000
         BZ    @RF00938                                            0938 03818000
*DOGRP47:            DO;                                   /*@YL026UL*/ 03819000
*                                                                  0939 03820000
DOGRP47  DS    0H                                                  0940 03821000
*                    CALL SCANSEP(NO);                             0940 03822000
*                                                                  0940 03823000
         LA    @01,@AL00940                                        0940 03824000
         BAL   @14,SCANSEP                                         0940 03825000
*                    IF CHAR1 ^= OPENING                           0941 03826000
*                      THEN                                        0941 03827000
*                                                                  0941 03828000
         CLI   CHAR1,C'('                                          0941 03829000
         BE    @RF00941                                            0941 03830000
*                        CALL ERROR2(BADELIM2,LENGTH(ERRFIELD),    0942 03831000
*                                    ADDR(ERRFIELD));              0942 03832000
*                                                                  0942 03833000
         MVC   @AL00001(8),@AL00942                                0942 03834000
         LA    @04,ERRFIELD                                        0942 03835000
         ST    @04,@AFTEMPS+4                                      0942 03836000
         LA    @04,@AFTEMPS+4                                      0942 03837000
         ST    @04,@AL00001+8                                      0942 03838000
         LA    @01,@AL00001                                        0942 03839000
         BAL   @14,ERROR2                                          0942 03840000
*                      ELSE                                        0943 03841000
*DOGRP50:                DO;                                       0943 03842000
*                                                                  0943 03843000
         B     @RC00941                                            0943 03844000
@RF00941 DS    0H                                                  0943 03845000
DOGRP50  DS    0H                                                  0944 03846000
*                        CALL NEXTCHAR;                            0944 03847000
         BAL   @14,NEXTCHAR                                        0944 03848000
*                        CALL SCANSEP(NO);                         0945 03849000
*                                                                  0945 03850000
         LA    @01,@AL00945                                        0945 03851000
         BAL   @14,SCANSEP                                         0945 03852000
*                        IF RISTATUS=0                             0946 03853000
*                          THEN                                    0946 03854000
*                                                                  0946 03855000
         ICM   @04,3,RISTATUS                                      0946 03856000
         BNZ   @RF00946                                            0946 03857000
*                            /****************************************/ 03858000
*                            /*                                      */ 03859000
*                            /* IF SCALAR DATA IS TO BE EXTRACTED    */ 03860000
*                            /* FOLLOWING THE KEYWORD, THEN EXTRACT  */ 03861000
*                            /* DATA.  IF SUBPARAMETERS FOLLOW THE   */ 03862000
*                            /* KEYWORD, SET UP TO SCAN THEM         */ 03863000
*                            /*                                      */ 03864000
*                            /****************************************/ 03865000
*                            IF SCLRDATA=YES                       0947 03866000
*                              THEN                                0947 03867000
         LH    @04,PARMID                                          0947 03868000
         MH    @04,@CH00038                                        0947 03869000
         L     @02,WORKPTR                                         0947 03870000
         AL    @02,@CF01440                                        0947 03871000
         L     @04,PARMPTR(@04,@02)                                0947 03872000
         TM    SCLRDATA(@04),B'10000000'                           0947 03873000
         BNO   @RF00947                                            0947 03874000
*                                DO;                               0948 03875000
*                                                                  0948 03876000
*                                CALL GETDATA;                     0949 03877000
*                                                                  0949 03878000
         BAL   @14,GETDATA                                         0949 03879000
*                                IF RISTATUS=0                     0950 03880000
*                                  THEN                            0950 03881000
*                                                                  0950 03882000
         ICM   @04,3,RISTATUS                                      0950 03883000
         BNZ   @RF00950                                            0950 03884000
*                                    /********************************/ 03885000
*                                    /*                              */ 03886000
*                                    /* IF IT EXISTS, BYPASS THE     */ 03887000
*                                    /* CLOSING PAREN FOLLOWING THE  */ 03888000
*                                    /* DATA.  THE PAREN IS REQUIRED */ 03889000
*                                    /* EXCEPT AT COMMAND END.       */ 03890000
*                                    /*                              */ 03891000
*                                    /********************************/ 03892000
*                                    IF CHAR1 ^= CLOSING           0951 03893000
*                                      THEN                        0951 03894000
         CLI   CHAR1,C')'                                          0951 03895000
         BE    @RF00951                                            0951 03896000
*                                        IF CHAR1=ENDDELIM         0952 03897000
*                                          THEN                    0952 03898000
         CLI   CHAR1,C';'                                          0952 03899000
         BNE   @RF00952                                            0952 03900000
*                                            ENDPAREN=NO;          0953 03901000
         NI    ENDPAREN,B'01111111'                                0953 03902000
*                                          ELSE                    0954 03903000
*                                                                  0954 03904000
*                                            CALL ERROR2(BADELIM3, 0954 03905000
*                                                    LENGTH(ERRFIELD),  03906000
*                                                    ADDR(ERRFIELD));   03907000
*                                                                  0954 03908000
         B     @RC00952                                            0954 03909000
@RF00952 MVC   @AL00001(8),@AL00954                                0954 03910000
         LA    @04,ERRFIELD                                        0954 03911000
         ST    @04,@AFTEMPS+4                                      0954 03912000
         LA    @04,@AFTEMPS+4                                      0954 03913000
         ST    @04,@AL00001+8                                      0954 03914000
         LA    @01,@AL00001                                        0954 03915000
         BAL   @14,ERROR2                                          0954 03916000
*                                      ELSE                        0955 03917000
*                                        DO;                       0955 03918000
*                                                                  0955 03919000
         B     @RC00951                                            0955 03920000
@RF00951 DS    0H                                                  0956 03921000
*                                        CALL NEXTCHAR;            0956 03922000
         BAL   @14,NEXTCHAR                                        0956 03923000
*                                        CALL SCANSEP(YES);        0957 03924000
*                                                                  0957 03925000
         LA    @01,@AL00957                                        0957 03926000
         BAL   @14,SCANSEP                                         0957 03927000
*                                        END;                      0958 03928000
*                                END;                              0959 03929000
*                                                                  0959 03930000
*                              /**************************************/ 03931000
*                              /*                                    */ 03932000
*                              /* THE 'VALUE' OF THIS PARAMETER IS A */ 03933000
*                              /* SUBPARAMETER LIST RATHER THAN A    */ 03934000
*                              /* SCALAR OR LIST OF SCALARS.         */ 03935000
*                              /*                                    */ 03936000
*                              /**************************************/ 03937000
*                              ELSE                                0960 03938000
*DOGRP55:                        DO;                               0960 03939000
         B     @RC00947                                            0960 03940000
@RF00947 DS    0H                                                  0960 03941000
DOGRP55  DS    0H                                                  0961 03942000
*                                PARMLVL=PARMLVL+1;                0961 03943000
         LA    @04,1                                               0961 03944000
         LH    @02,PARMLVL                                         0961 03945000
         ALR   @02,@04                                             0961 03946000
         STH   @02,PARMLVL                                         0961 03947000
*                                PPARMCNT(PARMLVL)=1;              0962 03948000
         ALR   @02,@02                                             0962 03949000
         STH   @04,PPARMCNT-2(@02)                                 0962 03950000
*                                SUPERID(PARMLVL)=PARMID;          0963 03951000
         LH    @15,PARMID                                          0963 03952000
         STH   @15,SUPERID-2(@02)                                  0963 03953000
*                                SUBSYET=NO;                       0964 03954000
*                                                                  0964 03955000
         NI    SUBSYET,B'11101111'                                 0964 03956000
*                                /**********************************/   03957000
*                                /*                                */   03958000
*                                /* IF THE SUBPARAMETER LIST MAY BE*/   03959000
*                                /* REPEATED, BYPASS DELIMITER(S)  */   03960000
*                                /* AND SET INDEXES AND COUNTS TO  */   03961000
*                                /* NOTE START OF REPEATED LISTS.  */   03962000
*                                /*                                */   03963000
*                                /**********************************/   03964000
*                                IF REPEATED=YES                   0965 03965000
*                                  THEN                            0965 03966000
         MH    @15,@CH00038                                        0965 03967000
         L     @02,WORKPTR                                         0965 03968000
         AL    @02,@CF01440                                        0965 03969000
         L     @02,PARMPTR(@15,@02)                                0965 03970000
         TM    REPEATED(@02),B'00100000'                           0965 03971000
         BNO   @RF00965                                            0965 03972000
*                                    DO;                           0966 03973000
*                                    REPDEPTH=REPDEPTH+1;          0967 03974000
         AH    @04,REPDEPTH                                        0967 03975000
         STH   @04,REPDEPTH                                        0967 03976000
*                                    IF CHAR1=OPENING              0968 03977000
*                                      THEN                        0968 03978000
         CLI   CHAR1,C'('                                          0968 03979000
         BNE   @RF00968                                            0968 03980000
*                                        DO;                       0969 03981000
*                                                                  0969 03982000
*                                        CALL NEXTCHAR;            0970 03983000
         BAL   @14,NEXTCHAR                                        0970 03984000
*                                        CALL SCANSEP(NO);         0971 03985000
*                                                                  0971 03986000
         LA    @01,@AL00971                                        0971 03987000
         BAL   @14,SCANSEP                                         0971 03988000
*                                        ONEREP(REPDEPTH)=NO;      0972 03989000
         LH    @04,REPDEPTH                                        0972 03990000
         LA    @02,ONEREP-1(@04)                                   0972 03991000
         NI    0(@02),B'01111111'                                  0972 03992000
*                                        END;                      0973 03993000
*                                      ELSE                        0974 03994000
*                                        ONEREP(REPDEPTH)=YES;     0974 03995000
         B     @RC00968                                            0974 03996000
@RF00968 LH    @04,REPDEPTH                                        0974 03997000
         LA    @02,ONEREP-1(@04)                                   0974 03998000
         OI    0(@02),B'10000000'                                  0974 03999000
*                                    REPCOUNT(REPDEPTH)=1;         0975 04000000
@RC00968 LH    @15,REPDEPTH                                        0975 04001000
         LR    @14,@15                                             0975 04002000
         ALR   @14,@14                                             0975 04003000
         LA    @01,1                                               0975 04004000
         STH   @01,REPCOUNT-2(@14)                                 0975 04005000
*                                    REPLIMIT(REPDEPTH)=REPMAX;    0976 04006000
         LA    @01,12                                              0976 04007000
         LR    @00,@01                                             0976 04008000
         MH    @00,PARMID                                          0976 04009000
         L     @15,WORKPTR                                         0976 04010000
         ST    @14,@TF00001                                        0976 04011000
         LR    @14,@00                                             0976 04012000
         AL    @15,@CF01440                                        0976 04013000
         AL    @01,PARMPTR(@14,@15)                                0976 04014000
         SLR   @00,@00                                             0976 04015000
         IC    @00,REPMAX(,@01)                                    0976 04016000
         L     @01,@TF00001                                        0976 04017000
         STH   @00,REPLIMIT-2(@01)                                 0976 04018000
*                                    ARRYPTR=                      0977 04019000
*                                        FDTPTR(SUPERID(PARMLVL)); 0977 04020000
         LH    @15,PARMLVL                                         0977 04021000
         ALR   @15,@15                                             0977 04022000
         LH    @15,SUPERID-2(@15)                                  0977 04023000
         SLA   @15,2                                               0977 04024000
         L     @01,FDTADDR                                         0977 04025000
         L     ARRYPTR,FDTPTR-4(@15,@01)                           0977 04026000
*                                    HWORDARG=REPDEPTH-1;          0978 04027000
*                                                                  0978 04028000
         LH    @15,REPDEPTH                                        0978 04029000
         BCTR  @15,0                                               0978 04030000
         STH   @15,HWORDARG                                        0978 04031000
*                                    CALL DSPLCALC(HWORDARG);      0979 04032000
*                                                                  0979 04033000
         LA    @15,HWORDARG                                        0979 04034000
         ST    @15,@AL00001                                        0979 04035000
         LA    @01,@AL00001                                        0979 04036000
         BAL   @14,DSPLCALC                                        0979 04037000
*                                    REPTOTAL=1;                   0980 04038000
         LR    @15,ARRYPTR                                         0980 04039000
         ALR   @15,ARRYDSPL                                        0980 04040000
         MVC   REPTOTAL(4,@15),@CF00228                            0980 04041000
*                                    END;                          0981 04042000
*                                                                  0981 04043000
*                                END DOGRP55;                      0982 04044000
*                        END DOGRP50;                              0983 04045000
*                    END DOGRP47;                                  0984 04046000
*                                                                  0984 04047000
*                  /**************************************************/ 04048000
*                  /*                                                */ 04049000
*                  /* WHEN A VALUE KEYWORD IS EXTRACTED, SCAN TO     */ 04050000
*                  /* THE NEXT SYNTACTIC UNIT                        */ 04051000
*                  /*                                                */ 04052000
*                  /**************************************************/ 04053000
*                  ELSE                                            0985 04054000
*                                                                  0985 04055000
*                    CALL SCANSEP(YES);                            0985 04056000
*                                                                  0985 04057000
         B     @RC00938                                            0985 04058000
@RF00938 LA    @01,@AL00985                                        0985 04059000
         BAL   @14,SCANSEP                                         0985 04060000
*                END DOGRP45;                                      0986 04061000
*                                                                  0986 04062000
*              /******************************************************/ 04063000
*              /*                                                    */ 04064000
*              /* IF NO MATCHING KEYWORD WAS FOUND, IT IS AN ERROR   */ 04065000
*              /*                                                    */ 04066000
*              /******************************************************/ 04067000
*              ELSE                                                0987 04068000
*                                                                  0987 04069000
*                CALL ERROR2(BADKWD2,LENGTH(ERRFIELD),ADDR(ERRFIELD));  04070000
*                                                                  0987 04071000
         B     @RC00933                                            0987 04072000
@RF00933 MVC   @AL00001(8),@AL00987                                0987 04073000
         LA    @04,ERRFIELD                                        0987 04074000
         ST    @04,@AFTEMPS+4                                      0987 04075000
         LA    @04,@AFTEMPS+4                                      0987 04076000
         ST    @04,@AL00001+8                                      0987 04077000
         LA    @01,@AL00001                                        0987 04078000
         BAL   @14,ERROR2                                          0987 04079000
*            END DOGRP40;                                          0988 04080000
*                                                                  0988 04081000
*        END KWDPARM;                                              0989 04082000
@EL00009 DS    0H                                                  0989 04083000
@EF00009 DS    0H                                                  0989 04084000
@ER00009 LM    @14,@04,@SA00009                                    0989 04085000
         LM    @06,@12,@SA00009+28                                 0989 04086000
         BR    @14                                                 0989 04087000
*/********************************************************************/ 04088000
*/*                                                                  */ 04089000
*/*  PROCEDURE NAME - POSPARM                                        */ 04090000
*/*                                                                  */ 04091000
*/*  FUNCTION - THIS ROUTINE SETS UP TO EXTRACT SCALAR DATA          */ 04092000
*/*             ASSOCIATED WITH THE POSITIONAL PARAMETER OR PREPARES */ 04093000
*/*             TO SCAN A POSITIONAL PARAMETER'S SUBPARAMETER LIST.  */ 04094000
*/*                                                                  */ 04095000
*/*  INPUT -                                                         */ 04096000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 04097000
*/*          PPARMCNT- NUMBER OF POSITIONAL PARAMETERS FOUND SO FAR  */ 04098000
*/*                    IN CURRENT SUBPARAMETER LIST.                 */ 04099000
*/*          CHAR1 -   MOST RECENTLY EXTRACTED INPUT CHARACTER       */ 04100000
*/*          RISTATUS- R/I STATUS CODE; SET TO NON-ZERO VALUE WHEN   */ 04101000
*/*                    AN ERROR IS FOUND.                            */ 04102000
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */ 04103000
*/*                    SCANNING IS CURRENTLY TAKING PLACE.           */ 04104000
*/*          REPDEPTH- LEVEL OF REPEATED SUBPARM. LIST NESTING AT    */ 04105000
*/*                    WHICH SCANNING IS CURRENTLY TAKING PLACE.     */ 04106000
*/*                                                                  */ 04107000
*/*  OUTPUT -                                                        */ 04108000
*/*          JUSTONE - FLAG SET 'ON' WHEN A SINGLE SCALAR LIST ITEM  */ 04109000
*/*                    HAS BEEN CODED FOR A PARAMETER                */ 04110000
*/*          PARMID -  ID# OF PARAMETER CURRENTLY BEING HANDLED.     */ 04111000
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */ 04112000
*/*                    SCANNING WILL TAKE PLACE AFTER THIS PARAMETER */ 04113000
*/*          PPARMCNT- NUMBER OF POSITIONAL PARAMETERS FOUND IN      */ 04114000
*/*                    CURRENT SUBPARAMETER LIST.                    */ 04115000
*/*          SUPERID - ID# OF PARAMETER WHOSE SUBPARAMETER LIST IS   */ 04116000
*/*                    CURRENTLY BEING SCANNED                       */ 04117000
*/*          SUBSYET - FLAG SET 'ON' WHEN AT LEAST ONE SUBPARAMETER  */ 04118000
*/*                    HAS BEEN FOUND IN THE CURRENT SUBLIST.        */ 04119000
*/*          REPDEPTH- LEVEL OF REPEATED SUBPARM. LIST NESTING AT    */ 04120000
*/*                    WHICH SCANNING WILL TAKE PLACE FOLLOWING THIS */ 04121000
*/*                    POSITIONAL PARAMETER                          */ 04122000
*/*          REPCOUNT- NUMBER OF REPEATED SUBLISTS FOUND AT CURRENT  */ 04123000
*/*                    REPEATED SUBLIST LEVEL.                       */ 04124000
*/*          REPLIMIT- MAXIMUM NUMBER OF REPEATED SUBLISTS ALLOWED   */ 04125000
*/*                    AT CURRENT LEVEL.                             */ 04126000
*/*          ARRYPTR - POINTER TO INTERMEDIATE POINTER VECTOR WHICH  */ 04127000
*/*                    CONTAINS PTRS TO DATA STRUCTURES FOR CURRENT  */ 04128000
*/*                    POSITIONAL PARAMETER                          */ 04129000
*/*                                                                  */ 04130000
*/********************************************************************/ 04131000
*POSPARM:PROCEDURE;                                                0990 04132000
POSPARM  STM   @14,@04,@SA00010                                    0990 04133000
         STM   @06,@12,@SA00010+28                                 0990 04134000
*        /************************************************************/ 04135000
*        /*                                                          */ 04136000
*        /*  ** POSPARM **  GET POSITIONAL PARAMETER VALUE           */ 04137000
*        /*                                                          */ 04138000
*        /************************************************************/ 04139000
*        IF GDTDBG = NULLPTR                                       0991 04140000
*          THEN;                                                   0991 04141000
         ICM   @04,15,GDTDBG(GDTPTR)                               0991 04142000
         BZ    @RT00991                                            0991 04143000
*          ELSE                                                    0993 04144000
*            CALL IDCDB010(GDTTBL,'RIPP');                         0993 04145000
*                                                                  0993 04146000
         ST    GDTPTR,@AL00001                                     0993 04147000
         LA    @04,@CC01075                                        0993 04148000
         ST    @04,@AL00001+4                                      0993 04149000
         MVI   @AL00001+4,X'80'                                    0993 04150000
         L     @15,GDTDBG(,GDTPTR)                                 0993 04151000
         LA    @01,@AL00001                                        0993 04152000
         BALR  @14,@15                                             0993 04153000
*        JUSTONE=NO;                                               0994 04154000
*                                                                  0994 04155000
@RT00991 NI    JUSTONE,B'11111110'                                 0994 04156000
*        /************************************************************/ 04157000
*        /*                                                          */ 04158000
*        /* SET A FLAG NOTING THAT THIS PARAMETER HAS BEEN FOUND     */ 04159000
*        /* AND INCREMENT COUNT OF POSITIONAL PARAMETERS.            */ 04160000
*        /*                                                          */ 04161000
*        /************************************************************/ 04162000
*                                                                  0995 04163000
*        CALL SETFLAG;                                             0995 04164000
*                                                                  0995 04165000
         BAL   @14,SETFLAG                                         0995 04166000
*        PPARMCNT(PARMLVL)=PPARMCNT(PARMLVL)+1;                    0996 04167000
*                                                                  0996 04168000
         LH    @04,PARMLVL                                         0996 04169000
         ALR   @04,@04                                             0996 04170000
         LA    @02,1                                               0996 04171000
         AH    @02,PPARMCNT-2(@04)                                 0996 04172000
         STH   @02,PPARMCNT-2(@04)                                 0996 04173000
*        /************************************************************/ 04174000
*        /*                                                          */ 04175000
*        /* IF THE VALUE OF THE POSITIONAL PARAMETER IS A LIST, THEN */ 04176000
*        /* EITHER EXTRACT A LIST OF SCALARS OR SET UP TO SCAN A     */ 04177000
*        /* LIST OF SUBPARAMETERS.                                   */ 04178000
*        /*                                                          */ 04179000
*        /************************************************************/ 04180000
*        IF CHAR1 = OPENING                                        0997 04181000
*          THEN                                                    0997 04182000
         CLI   CHAR1,C'('                                          0997 04183000
         BNE   @RF00997                                            0997 04184000
*DOGRP60:    DO;                                                   0998 04185000
*                                                                  0998 04186000
DOGRP60  DS    0H                                                  0999 04187000
*              CALL NEXTCHAR;                                      0999 04188000
         BAL   @14,NEXTCHAR                                        0999 04189000
*              CALL SCANSEP(NO);                                   1000 04190000
*                                                                  1000 04191000
         LA    @01,@AL01000                                        1000 04192000
         BAL   @14,SCANSEP                                         1000 04193000
*              IF RISTATUS^=0                                      1001 04194000
*                THEN                                              1001 04195000
         ICM   @04,3,RISTATUS                                      1001 04196000
         BNZ   @RT01001                                            1001 04197000
*                  RETURN;                                         1002 04198000
*                                                                  1002 04199000
*              /******************************************************/ 04200000
*              /*                                                    */ 04201000
*              /* EXTRACT THE LIST OF SCALAR DATA ITEMS AND          */ 04202000
*              /* CHECK FOR PROPER PARENTHESES IF THE POSITIONAL     */ 04203000
*              /* PARAMETER IS A SCALAR LIST.                        */ 04204000
*              /*                                                    */ 04205000
*              /******************************************************/ 04206000
*              IF LIST=YES                                         1003 04207000
*                THEN                                              1003 04208000
         LH    @04,PARMID                                          1003 04209000
         MH    @04,@CH00038                                        1003 04210000
         L     @02,WORKPTR                                         1003 04211000
         AL    @02,@CF01440                                        1003 04212000
         L     @04,PARMPTR(@04,@02)                                1003 04213000
         TM    LIST(@04),B'00001000'                               1003 04214000
         BNO   @RF01003                                            1003 04215000
*                  DO;                                             1004 04216000
*                                                                  1004 04217000
*                  CALL GETDATA;                                   1005 04218000
*                                                                  1005 04219000
         BAL   @14,GETDATA                                         1005 04220000
*                  IF RISTATUS=0                                   1006 04221000
*                    THEN                                          1006 04222000
*                                                                  1006 04223000
         ICM   @04,3,RISTATUS                                      1006 04224000
         BNZ   @RF01006                                            1006 04225000
*                      /**********************************************/ 04226000
*                      /*                                            */ 04227000
*                      /* IF IT EXISTS, BYPASS THE CLOSING PAREN     */ 04228000
*                      /* FOLLOWING THE DATA.  EXCEPT AT COMMAND     */ 04229000
*                      /* END, THE CLOSING PAREN IN REQUIRED.        */ 04230000
*                      /*                                            */ 04231000
*                      /**********************************************/ 04232000
*                      IF CHAR1^=CLOSING                           1007 04233000
*                        THEN                                      1007 04234000
         CLI   CHAR1,C')'                                          1007 04235000
         BE    @RF01007                                            1007 04236000
*                          IF CHAR1=ENDDELIM                       1008 04237000
*                            THEN                                  1008 04238000
         CLI   CHAR1,C';'                                          1008 04239000
         BNE   @RF01008                                            1008 04240000
*                              ENDPAREN=NO;                        1009 04241000
         NI    ENDPAREN,B'01111111'                                1009 04242000
*                            ELSE                                  1010 04243000
*                                                                  1010 04244000
*                              CALL ERROR2(BADELIM3,LENGTH(ERRFIELD),   04245000
*                                          ADDR(ERRFIELD));        1010 04246000
*                                                                  1010 04247000
         B     @RC01008                                            1010 04248000
@RF01008 MVC   @AL00001(8),@AL01010                                1010 04249000
         LA    @04,ERRFIELD                                        1010 04250000
         ST    @04,@AFTEMPS+8                                      1010 04251000
         LA    @04,@AFTEMPS+8                                      1010 04252000
         ST    @04,@AL00001+8                                      1010 04253000
         LA    @01,@AL00001                                        1010 04254000
         BAL   @14,ERROR2                                          1010 04255000
*                        ELSE                                      1011 04256000
*                          DO;                                     1011 04257000
*                                                                  1011 04258000
         B     @RC01007                                            1011 04259000
@RF01007 DS    0H                                                  1012 04260000
*                          CALL NEXTCHAR;                          1012 04261000
         BAL   @14,NEXTCHAR                                        1012 04262000
*                          CALL SCANSEP(YES);                      1013 04263000
*                                                                  1013 04264000
         LA    @01,@AL01013                                        1013 04265000
         BAL   @14,SCANSEP                                         1013 04266000
*                          END;                                    1014 04267000
*                  END;                                            1015 04268000
*                ELSE                                              1016 04269000
*                                                                  1016 04270000
*                  CALL ERROR2(BADELIM5,LENGTH(ERRFIELD),          1016 04271000
*                              ADDR(ERRFIELD));            /*@YL026UL*/ 04272000
*                                                                  1016 04273000
         B     @RC01003                                            1016 04274000
@RF01003 MVC   @AL00001(8),@AL01016                                1016 04275000
         LA    @04,ERRFIELD                                        1016 04276000
         ST    @04,@AFTEMPS+8                                      1016 04277000
         LA    @04,@AFTEMPS+8                                      1016 04278000
         ST    @04,@AL00001+8                                      1016 04279000
         LA    @01,@AL00001                                        1016 04280000
         BAL   @14,ERROR2                                          1016 04281000
*            END DOGRP60;                                          1017 04282000
*          ELSE                                                    1018 04283000
*                                                                  1018 04284000
*            /********************************************************/ 04285000
*            /*                                                      */ 04286000
*            /* IF THERE IS NO LEFT PARENTHESIS TO DELIMIT A SCALAR  */ 04287000
*            /* LIST, THEN THE LIST MUST BE JUST ONE SCALAR LONG.    */ 04288000
*            /* AN EXCEPTION IS WHEN A LIST OF LISTS IS INVOLVED, IN */ 04289000
*            /* WHICH CASE THE PARENTHESES FOR THE REPEATED LISTS    */ 04290000
*            /* MAY SERVE TO DELIMIT THE SCALAR LISTS.               */ 04291000
*            /*                                                      */ 04292000
*            /********************************************************/ 04293000
*            DO;                                                   1018 04294000
         B     @RC00997                                            1018 04295000
@RF00997 DS    0H                                                  1019 04296000
*            IF LIST=YES                                           1019 04297000
*              THEN                                                1019 04298000
         L     @04,WORKPTR                                         1019 04299000
         LH    @02,PARMID                                          1019 04300000
         LA    @15,12                                              1019 04301000
         LR    @01,@02                                             1019 04302000
         MR    @00,@15                                             1019 04303000
         LA    @14,0(@01,@04)                                      1019 04304000
         AL    @14,@CF01440                                        1019 04305000
         L     @14,PARMPTR(,@14)                                   1019 04306000
         TM    LIST(@14),B'00001000'                               1019 04307000
         BNO   @RF01019                                            1019 04308000
*                DO;                                               1020 04309000
*                TESTID=PARMID;                                    1021 04310000
         LR    TESTID,@02                                          1021 04311000
*                PARMID=SUPRPARM(PARMID);                          1022 04312000
         L     @02,WORKPTR                                         1022 04313000
         AL    @01,@CF01441                                        1022 04314000
         LH    @14,SUPRPARM-8(@01,@02)                             1022 04315000
         STH   @14,PARMID                                          1022 04316000
*                IF PARMID^=0 & REPEATED=YES & SUBCOUNT=1          1023 04317000
*                  THEN;                                           1023 04318000
         LTR   @14,@14                                             1023 04319000
         BZ    @RF01023                                            1023 04320000
         LR    @01,@14                                             1023 04321000
         MR    @00,@15                                             1023 04322000
         AL    @02,@CF01440                                        1023 04323000
         L     @02,PARMPTR(@01,@02)                                1023 04324000
         TM    REPEATED(@02),B'00100000'                           1023 04325000
         BNO   @RF01023                                            1023 04326000
         ALR   @15,@02                                             1023 04327000
         SLR   @14,@14                                             1023 04328000
         IC    @14,SUBDSPL(,@15)                                   1023 04329000
         ALR   @14,@14                                             1023 04330000
         ALR   @02,@14                                             1023 04331000
         CLC   SUBCOUNT(2,@02),@CH00228                            1023 04332000
         BE    @RT01023                                            1023 04333000
*                  ELSE                                            1025 04334000
*                    JUSTONE=YES;                                  1025 04335000
@RF01023 OI    JUSTONE,B'00000001'                                 1025 04336000
*                PARMID=TESTID;                                    1026 04337000
@RT01023 STH   TESTID,PARMID                                       1026 04338000
*                END;                                              1027 04339000
*                                                                  1027 04340000
*            CALL GETDATA;                                         1028 04341000
*                                                                  1028 04342000
@RF01019 BAL   @14,GETDATA                                         1028 04343000
*            END;                                                  1029 04344000
*                                                                  1029 04345000
*        END POSPARM;                                              1030 04346000
*                                                                  1030 04347000
*                                                                  1030 04348000
@EL00010 DS    0H                                                  1030 04349000
@EF00010 DS    0H                                                  1030 04350000
@ER00010 LM    @14,@04,@SA00010                                    1030 04351000
         LM    @06,@12,@SA00010+28                                 1030 04352000
         BR    @14                                                 1030 04353000
*        END SCANCMD;                                      /*@YL026UL*/ 04354000
@EL00003 DS    0H                                                  1031 04355000
@EF00003 DS    0H                                                  1031 04356000
@ER00003 LM    @14,@03,@SA00003                                    1031 04357000
         LM    @06,@12,@SA00003+24                                 1031 04358000
         BR    @14                                                 1031 04359000
*/********************************************************************/ 04360000
*/*                                                                  */ 04361000
*/*  PROCEDURE NAME - GETDATA                                        */ 04362000
*/*                                                                  */ 04363000
*/*  FUNCTION - THIS ROUTINE SETS UP TO EXTRACT THE SCALAR VALUE OR  */ 04364000
*/*             VALUES ASSOCIATED WITH A PARAMETER.                  */ 04365000
*/*                                                                  */ 04366000
*/*  INPUT -                                                         */ 04367000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 04368000
*/*          CHAR1 -   MOST RECENTLY EXTRACTED INPUT CHARACTER       */ 04369000
*/*          CHAR2 -   CHARACTER WHICH IS TO BE EXTRACTED NEXT       */ 04370000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO NON-ZERO     */ 04371000
*/*                    VALUE WHEN AN ERROR IS DETECTED.              */ 04372000
*/*          PWORD -   SWITCH SET TO INDICATE WHETHER A PASSWORD     */ 04373000
*/*                    SCALAR IS CURRENTLY BEING EXTRACTED, IS NOT   */ 04374000
*/*                    BEING EXTRACTED, OR WILL BE EXTRACTED NEXT.   */ 04375000
*/*          SCANONLY- FLAG SET 'ON' WHEN CURRENT COMMAND IS BEING   */ 04376000
*/*                    SCANNED FOR SYNTAX CHECKING ONLY.             */ 04377000
*/*          JUSTONE - FLAG SET 'ON' WHEN NO PARENTHESES HAVE BEEN   */ 04378000
*/*                    CODED TO DELIMIT A SCALAR LIST SINCE ONLY ONE */ 04379000
*/*                    LIST ELEMENT EXISTS.                          */ 04380000
*/*                                                                  */ 04381000
*/*  OUTPUT -                                                        */ 04382000
*/*          FUNCTION DATA TABLE DATA ENTRIES                        */ 04383000
*/*          SCLRCNT - COUNT OF SCALARS FOUND IN A SCALAR LIST       */ 04384000
*/*          PWORD -   SEE 'INPUT'                                   */ 04385000
*/*          PWORDSW - FLAG SET 'ON' WHEN A PASSWORD ITEM MAY FOLLOW */ 04386000
*/*                    THE PRIMARY SCALAR VALUE                      */ 04387000
*/*          ORGSIGN - CONTAINS A CHARACTER CODE INDICATING THE FORM */ 04388000
*/*                    IN WHICH A CONSTANT WAS SPECIFIED             */ 04389000
*/*                                                                  */ 04390000
*/********************************************************************/ 04391000
*GETDATA:PROCEDURE;                                                1032 04392000
GETDATA  STM   @14,@04,@SA00011                                    1032 04393000
         STM   @06,@12,@SA00011+28                                 1032 04394000
*        /************************************************************/ 04395000
*        /*                                                          */ 04396000
*        /* GETDATA PROCEDURE DATA DEFINITIONS                       */ 04397000
*        /*                                                          */ 04398000
*        /************************************************************/ 04399000
*        DCL ENDVALUE BIT(1);          /*SIGNALS THAT ALL THE SCALAR    04400000
*                                        DATA HAS BEEN EXTRACTED     */ 04401000
*                                                                  1033 04402000
*        /*STATIC ERROR MESSAGE CODES                                */ 04403000
*        DCL BADNUM   FIXED(31)        /*IMPROPER NUMERICAL VALUE    */ 04404000
*                     CONSTANT(15);                                1034 04405000
*        DCL BADPWD   FIXED(31)        /*PASSWORD APPEARS IMPROPERLY */ 04406000
*                     CONSTANT(18);                                1035 04407000
*        /************************************************************/ 04408000
*        /*                                                          */ 04409000
*        /*  ** GETDATA **  EXTRACT SCALAR VALUE OR VALUES           */ 04410000
*        /*                                                          */ 04411000
*        /************************************************************/ 04412000
*        SCLRCNT=0;                                                1036 04413000
         SLR   @04,@04                                             1036 04414000
         STH   @04,SCLRCNT                                         1036 04415000
*        PWORD=NONE;                                               1037 04416000
         SLR   PWORD,PWORD                                         1037 04417000
*        ENDVALUE=NO;                                              1038 04418000
         NI    ENDVALUE,B'01111111'                                1038 04419000
*        PWORDSW=OFF;                                              1039 04420000
         NI    PWORDSW,B'01111111'                                 1039 04421000
*        OLDERID2 = NEWERID2;                                      1040 04422000
         L     @04,GDTTR2(,GDTPTR)                                 1040 04423000
         MVC   @TS00001(95),NEWERID2(@04)                          1040 04424000
         MVC   OLDERID2(95,@04),@TS00001                           1040 04425000
*        NEWID2='RI11';                                            1041 04426000
*                                                                  1041 04427000
         MVC   NEWID2(4,@04),@CC01084                              1041 04428000
*        /************************************************************/ 04429000
*        /*                                                          */ 04430000
*        /*  EXTRACT DATA UNTIL THE ENTIRE SCALAR OR LIST OF         */ 04431000
*        /*  SCALARS HAS BEEN PICKED UP                              */ 04432000
*        /*                                                          */ 04433000
*        /************************************************************/ 04434000
*        DO WHILE(ENDVALUE=NO );                                   1042 04435000
*                                                                  1042 04436000
         B     @DE01042                                            1042 04437000
@DL01042 DS    0H                                                  1043 04438000
*          /**********************************************************/ 04439000
*          /*                                                @YL026UL*/ 04440000
*          /* NOTE WHETHER OR NOT A PASSWORD IS ALLOWED WITH @YL026UL*/ 04441000
*          /* THE CURRENT PARAMETER.  THEN USE THE PARAMETER @YL026UL*/ 04442000
*          /* DATA FORMAT TO EXTRACT THE CONSTANT.           @YL026UL*/ 04443000
*          /*                                                @YL026UL*/ 04444000
*          /**********************************************************/ 04445000
*          IF PWORDOPT=YES & PWORD=NONE                            1043 04446000
*            THEN                                                  1043 04447000
         LA    @04,12                                              1043 04448000
         LR    @15,@04                                             1043 04449000
         MH    @15,PARMID                                          1043 04450000
         L     @01,WORKPTR                                         1043 04451000
         AL    @01,@CF01440                                        1043 04452000
         AL    @04,PARMPTR(@15,@01)                                1043 04453000
         TM    PWORDOPT(@04),B'00000010'                           1043 04454000
         BNO   @RF01043                                            1043 04455000
         LTR   PWORD,PWORD                                         1043 04456000
         BNZ   @RF01043                                            1043 04457000
*              PWORDSW=ON;                                 /*@YL026UL*/ 04458000
         OI    PWORDSW,B'10000000'                                 1044 04459000
*            ELSE                                                  1045 04460000
*              PWORDSW=OFF;                                /*@YL026UL*/ 04461000
*                                                                  1045 04462000
         B     @RC01043                                            1045 04463000
@RF01043 NI    PWORDSW,B'01111111'                                 1045 04464000
*          ORGSIGN=BLANK;                                          1046 04465000
@RC01043 MVI   ORGSIGN,C' '                                        1046 04466000
*          IF NUMBER=YES |                                         1047 04467000
*             (ANYSTRNG=YES & (CHAR1=HEXSIGN | CHAR1=BINSIGN) &    1047 04468000
*              CHAR2=QUOTE & PWORD^=NEXT)                  /*@YL026UL*/ 04469000
*                                                                  1047 04470000
*            /********************************************************/ 04471000
*            /*                                                      */ 04472000
*            /* EXTRACT A NUMBER IN DECIMAL FORM OR EXTRACT A NUMBER */ 04473000
*            /* OR STRING WHICH IS SPECIFIED IN BINARY OR HEX FORM.  */ 04474000
*            /*                                                      */ 04475000
*            /********************************************************/ 04476000
*            THEN                                                  1047 04477000
         LA    @04,12                                              1047 04478000
         LR    @15,@04                                             1047 04479000
         MH    @15,PARMID                                          1047 04480000
         L     @01,WORKPTR                                         1047 04481000
         AL    @01,@CF01440                                        1047 04482000
         AL    @04,PARMPTR(@15,@01)                                1047 04483000
         TM    NUMBER(@04),B'10000000'                             1047 04484000
         BO    @RT01047                                            1047 04485000
         TM    ANYSTRNG(@04),B'01000000'                           1047 04486000
         BNO   @RF01047                                            1047 04487000
         CLI   CHAR1,C'X'                                          1047 04488000
         BE    @GL00045                                            1047 04489000
         CLI   CHAR1,C'B'                                          1047 04490000
         BNE   @RF01047                                            1047 04491000
@GL00045 CLI   CHAR2,C''''                                         1047 04492000
         BNE   @RF01047                                            1047 04493000
         CH    PWORD,@CH00228                                      1047 04494000
         BE    @RF01047                                            1047 04495000
@RT01047 DS    0H                                                  1048 04496000
*              IF CHAR1=HEXSIGN | CHAR1=BINSIGN                    1048 04497000
*                THEN                                              1048 04498000
         CLI   CHAR1,C'X'                                          1048 04499000
         BE    @RT01048                                            1048 04500000
         CLI   CHAR1,C'B'                                          1048 04501000
         BNE   @RF01048                                            1048 04502000
@RT01048 DS    0H                                                  1049 04503000
*                  DO;                                             1049 04504000
*                  ORGSIGN=CHAR1;                                  1050 04505000
*                                                                  1050 04506000
         MVC   ORGSIGN(1),CHAR1                                    1050 04507000
*                  CALL NEXTCHAR;                                  1051 04508000
*                                                                  1051 04509000
         BAL   @14,NEXTCHAR                                        1051 04510000
*                  IF RISTATUS=0                                   1052 04511000
*                    THEN                                          1052 04512000
         ICM   @04,3,RISTATUS                                      1052 04513000
         BNZ   @RF01052                                            1052 04514000
*                      IF CHAR1=QUOTE                              1053 04515000
*                        THEN                                      1053 04516000
*                                                                  1053 04517000
         CLI   CHAR1,C''''                                         1053 04518000
         BNE   @RF01053                                            1053 04519000
*                          CALL GETQUOTD;                          1054 04520000
*                                                                  1054 04521000
         BAL   @14,GETQUOTD                                        1054 04522000
*                        ELSE                                      1055 04523000
*                                                                  1055 04524000
*                          CALL ERROR1(BADNUM);                    1055 04525000
*                                                                  1055 04526000
         B     @RC01053                                            1055 04527000
@RF01053 LA    @01,@AL01055                                        1055 04528000
         BAL   @14,ERROR1                                          1055 04529000
*                  END;                                            1056 04530000
*                ELSE                                              1057 04531000
*                                                                  1057 04532000
*                  CALL GETSIMPL;                                  1057 04533000
*                                                                  1057 04534000
         B     @RC01048                                            1057 04535000
@RF01048 BAL   @14,GETSIMPL                                        1057 04536000
*            /********************************************************/ 04537000
*            /*                                                      */ 04538000
*            /*  WHEN THE CONSTANT IS NOT A NUMBER, A HEX    @YL026UL*/ 04539000
*            /*  STRING, OR A BIT STRING, EXTRACT IT AS A    @YL026UL*/ 04540000
*            /*  CHARACTER STRING, CHECKING TO SEE IF IT IS WITHIN   */ 04541000
*            /*  APOSTROPHES.  ALSO CHECK TO SEE IF THE SCALAR IS    */ 04542000
*            /*  A PASSWORD.                                         */ 04543000
*            /*                                                      */ 04544000
*            /********************************************************/ 04545000
*            ELSE                                                  1058 04546000
*              DO;                                                 1058 04547000
         B     @RC01047                                            1058 04548000
@RF01047 DS    0H                                                  1059 04549000
*              OLDERID2 = NEWERID2;                                1059 04550000
         L     @15,GDTTR2(,GDTPTR)                                 1059 04551000
         MVC   @TS00001(95),NEWERID2(@15)                          1059 04552000
         MVC   OLDERID2(95,@15),@TS00001                           1059 04553000
*              NEWID2='RI12';                                      1060 04554000
         MVC   NEWID2(4,@15),@CC01087                              1060 04555000
*              IF PWORD=NEXT                                       1061 04556000
*                THEN                                              1061 04557000
         CH    PWORD,@CH00228                                      1061 04558000
         BNE   @RF01061                                            1061 04559000
*                  PWORD=NOW;                                      1062 04560000
         LA    PWORD,3                                             1062 04561000
*              IF CHAR1=QUOTE                                      1063 04562000
*                THEN                                              1063 04563000
*                                                                  1063 04564000
@RF01061 CLI   CHAR1,C''''                                         1063 04565000
         BNE   @RF01063                                            1063 04566000
*                  CALL GETQUOTD;                                  1064 04567000
*                                                                  1064 04568000
         BAL   @14,GETQUOTD                                        1064 04569000
*                ELSE                                              1065 04570000
*                                                                  1065 04571000
*                  CALL GETSIMPL;                                  1065 04572000
*                                                                  1065 04573000
         B     @RC01063                                            1065 04574000
@RF01063 BAL   @14,GETSIMPL                                        1065 04575000
*              END;                                                1066 04576000
*                                                                  1066 04577000
@RC01063 DS    0H                                                  1067 04578000
*          /**********************************************************/ 04579000
*          /*                                                        */ 04580000
*          /*  ADD THE EXTRACTED SCALAR TO THE FDT AND CHECK TO SEE  */ 04581000
*          /*  IF THE SCALAR VALUE OR VALUES HAVE BEEN COMPLETELY    */ 04582000
*          /*  EXTRACTED.                                            */ 04583000
*          /*                                                        */ 04584000
*          /**********************************************************/ 04585000
*          IF RISTATUS=0 & SCANONLY=NO                             1067 04586000
*            THEN                                                  1067 04587000
*                                                                  1067 04588000
@RC01047 ICM   @04,3,RISTATUS                                      1067 04589000
         BNZ   @RF01067                                            1067 04590000
         TM    SCANONLY,B'00010000'                                1067 04591000
         BNZ   @RF01067                                            1067 04592000
*              CALL BUILDFDT;                                      1068 04593000
         BAL   @14,BUILDFDT                                        1068 04594000
*            ELSE                                                  1069 04595000
*              IF PWORD=NOW                                        1069 04596000
*                THEN                                              1069 04597000
         B     @RC01067                                            1069 04598000
@RF01067 CH    PWORD,@CH00172                                      1069 04599000
         BNE   @RF01069                                            1069 04600000
*                  PWORD=NONE;                                     1070 04601000
*                                                                  1070 04602000
         SLR   PWORD,PWORD                                         1070 04603000
*          IF (SCALAR=YES & PWORD=NONE) | (JUSTONE=YES & PWORD=NONE) |  04604000
*             CHAR1=CLOSING | CHAR1=ENDDELIM | RISTATUS ^= 0       1071 04605000
*            THEN                                                  1071 04606000
@RF01069 DS    0H                                                  1071 04607000
@RC01067 LH    @04,PARMID                                          1071 04608000
         MH    @04,@CH00038                                        1071 04609000
         L     @01,WORKPTR                                         1071 04610000
         AL    @01,@CF01440                                        1071 04611000
         L     @04,PARMPTR(@04,@01)                                1071 04612000
         TM    SCALAR(@04),B'00010000'                             1071 04613000
         BNO   @GL00053                                            1071 04614000
         LTR   PWORD,PWORD                                         1071 04615000
         BZ    @RT01071                                            1071 04616000
@GL00053 TM    JUSTONE,B'00000001'                                 1071 04617000
         BNO   @GL00052                                            1071 04618000
         LTR   PWORD,PWORD                                         1071 04619000
         BZ    @RT01071                                            1071 04620000
@GL00052 CLI   CHAR1,C')'                                          1071 04621000
         BE    @RT01071                                            1071 04622000
         CLI   CHAR1,C';'                                          1071 04623000
         BE    @RT01071                                            1071 04624000
         ICM   @04,3,RISTATUS                                      1071 04625000
         BZ    @RF01071                                            1071 04626000
@RT01071 DS    0H                                                  1072 04627000
*              ENDVALUE=YES;                                       1072 04628000
         OI    ENDVALUE,B'10000000'                                1072 04629000
*        END;                                                      1073 04630000
@RF01071 DS    0H                                                  1073 04631000
@DE01042 TM    ENDVALUE,B'10000000'                                1073 04632000
         BZ    @DL01042                                            1073 04633000
*/********************************************************************/ 04634000
*/*                                                                  */ 04635000
*/*  PROCEDURE NAME -  GETSIMPL                                      */ 04636000
*/*                                                                  */ 04637000
*/*  FUNCTION - THIS ROUTINE EXTRACTS A SCALAR NOT ENCLOSED WITHIN   */ 04638000
*/*             APOSTROPHES AND CHECKS TO SEE IF A PASSWORD ITEM     */ 04639000
*/*             FOLLOWS THE PRIMARY SCALAR.                          */ 04640000
*/*                                                                  */ 04641000
*/*  INPUT -                                                         */ 04642000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 04643000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO NON-ZERO     */ 04644000
*/*                    VALUE WHEN AN ERROR IS DETECTED.              */ 04645000
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED                */ 04646000
*/*          CHAR2 -   INPUT CHARACTER TO BE EXTRACTED NEXT          */ 04647000
*/*          PWORD -   SWITCH INDICATING WHETHER A PASSWORD IS TO BE */ 04648000
*/*                    EXTRACTED NEXT, NOW, OR NOT AT ALL            */ 04649000
*/*          PWORDSW - FLAG SET 'ON' WHEN A PASSWORD MAY APPEAR      */ 04650000
*/*                    LEGITIMATELY                                  */ 04651000
*/*                                                                  */ 04652000
*/*  OUTPUT -                                                        */ 04653000
*/*          EXTRACTED SCALAR ITEM.                                  */ 04654000
*/*          PWORD -   SEE 'INPUT'                                   */ 04655000
*/*                                                                  */ 04656000
*/********************************************************************/ 04657000
*GETSIMPL:PROCEDURE;                                               1074 04658000
         B     @PB00012                                            1074 04659000
GETSIMPL STM   @14,@01,@SA00012                                    1074 04660000
         STM   @03,@04,@SA00012+16                                 1074 04661000
         STM   @06,@12,@SA00012+24                                 1074 04662000
*        /************************************************************/ 04663000
*        /*                                                          */ 04664000
*        /*  ** GETSIMPL **  EXTRACT AN UNQUOTED SCALAR              */ 04665000
*        /*                                                          */ 04666000
*        /************************************************************/ 04667000
*                                                                  1075 04668000
*        /************************************************************/ 04669000
*        /*                                                          */ 04670000
*        /* PICK UP THE UNQUOTED SCALAR                              */ 04671000
*        /*                                                          */ 04672000
*        /************************************************************/ 04673000
*                                                                  1075 04674000
*        CALL NXTFIELD(SIMPSCLR);                                  1075 04675000
         LA    @01,@AL01075                                        1075 04676000
         BAL   @14,NXTFIELD                                        1075 04677000
*        CALL SCANSEP(YES);                                        1076 04678000
*                                                                  1076 04679000
         LA    @01,@AL01076                                        1076 04680000
         BAL   @14,SCANSEP                                         1076 04681000
*        IF RISTATUS=0                                             1077 04682000
*          THEN                                                    1077 04683000
         ICM   @04,3,RISTATUS                                      1077 04684000
         BNZ   @RF01077                                            1077 04685000
*            IF CHAR1=PWDDELIM                                     1078 04686000
*                                                                  1078 04687000
*              /******************************************************/ 04688000
*              /*                                                    */ 04689000
*              /*  WHEN THE ENDING DELIMITER OF THE SCALAR IS THE    */ 04690000
*              /*  DELIMITER INDICATING A FOLLOWING PASSWORD, NOTE   */ 04691000
*              /*  THAT THE PASSWORD IS TO BE EXTRACTED LATER.  ALSO */ 04692000
*              /*  CHECK TO SEE IF THE OCCURRENCE OR LACK OF         */ 04693000
*              /*  OCCURRENCE OF A PASSWORD DELIMITER IS AN ERROR.   */ 04694000
*              /*                                                    */ 04695000
*              /******************************************************/ 04696000
*              THEN                                                1078 04697000
         CLI   CHAR1,C'/'                                          1078 04698000
         BNE   @RF01078                                            1078 04699000
*                IF PWORDSW=ON                                     1079 04700000
*                  THEN                                            1079 04701000
         TM    PWORDSW,B'10000000'                                 1079 04702000
         BNO   @RF01079                                            1079 04703000
*                    DO;                                           1080 04704000
*                                                                  1080 04705000
*                    CALL NEXTCHAR;                                1081 04706000
         BAL   @14,NEXTCHAR                                        1081 04707000
*                    CALL SCANSEP(YES);                            1082 04708000
*                                                                  1082 04709000
         LA    @01,@AL01082                                        1082 04710000
         BAL   @14,SCANSEP                                         1082 04711000
*                    PWORD=NEXT;                                   1083 04712000
         LA    PWORD,1                                             1083 04713000
*                    END;                                          1084 04714000
*                  ELSE                                            1085 04715000
*                                                                  1085 04716000
*                    CALL ERROR2(BADPWD,LENGTH(ERRFIELD),          1085 04717000
*                                ADDR(ERRFIELD));                  1085 04718000
*                                                                  1085 04719000
         B     @RC01079                                            1085 04720000
@RF01079 MVC   @AL00001(8),@AL01085                                1085 04721000
         LA    @04,ERRFIELD                                        1085 04722000
         ST    @04,@AFTEMPS+16                                     1085 04723000
         LA    @04,@AFTEMPS+16                                     1085 04724000
         ST    @04,@AL00001+8                                      1085 04725000
         LA    @01,@AL00001                                        1085 04726000
         BAL   @14,ERROR2                                          1085 04727000
*        END GETSIMPL;                                             1086 04728000
@EL00012 DS    0H                                                  1086 04729000
@EF00012 DS    0H                                                  1086 04730000
@ER00012 LM    @14,@01,@SA00012                                    1086 04731000
         LM    @03,@04,@SA00012+16                                 1086 04732000
         LM    @06,@12,@SA00012+24                                 1086 04733000
         BR    @14                                                 1086 04734000
*/********************************************************************/ 04735000
*/*                                                                  */ 04736000
*/*  PROCEDURE NAME - GETQUOTD                                       */ 04737000
*/*                                                                  */ 04738000
*/*  FUNCTION - THIS ROUTINE EXTRACTS A SCALAR THAT IS WITHIN        */ 04739000
*/*             APOSTROPHES AND CHECKS FOR A FOLLOWING PASSWORD.     */ 04740000
*/*                                                                  */ 04741000
*/*  INPUT -                                                         */ 04742000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 04743000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO NON-ZERO     */ 04744000
*/*                    VALUE WHEN AN ERROR IS DETECTED.              */ 04745000
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED                */ 04746000
*/*          CHAR2 -   INPUT CHARACTER TO BE EXTRACTED NEXT          */ 04747000
*/*          PWORDSW - FLAG SET 'ON' WHEN A PASSWORD MAY APPEAR      */ 04748000
*/*                    LEGITIMATELY                                  */ 04749000
*/*                                                                  */ 04750000
*/*  OUTPUT -                                                        */ 04751000
*/*          EXTRACTED SCALAR ITEM.                                  */ 04752000
*/*          PWORD -   SWITCH INDICATING WHEN A PASSWORD IS TO BE    */ 04753000
*/*                    EXTRACTED NEXT                                */ 04754000
*/*                                                                  */ 04755000
*/********************************************************************/ 04756000
*GETQUOTD:PROCEDURE;                                               1087 04757000
GETQUOTD STM   @14,@01,@SA00013                                    1087 04758000
         STM   @03,@04,@SA00013+16                                 1087 04759000
         STM   @06,@12,@SA00013+24                                 1087 04760000
*        /************************************************************/ 04761000
*        /*                                                          */ 04762000
*        /*  ** GETQUOTD **  EXTRACT SCALAR WITHIN APOSTROPHES       */ 04763000
*        /*                                                          */ 04764000
*        /************************************************************/ 04765000
*        IF GDTDBG = NULLPTR                                       1088 04766000
*          THEN;                                                   1088 04767000
         ICM   @15,15,GDTDBG(GDTPTR)                               1088 04768000
         BZ    @RT01088                                            1088 04769000
*          ELSE                                                    1090 04770000
*            CALL IDCDB010(GDTTBL,'RIGQ');                         1090 04771000
*                                                                  1090 04772000
         ST    GDTPTR,@AL00001                                     1090 04773000
         LA    @15,@CC01095                                        1090 04774000
         ST    @15,@AL00001+4                                      1090 04775000
         MVI   @AL00001+4,X'80'                                    1090 04776000
         L     @15,GDTDBG(,GDTPTR)                                 1090 04777000
         LA    @01,@AL00001                                        1090 04778000
         BALR  @14,@15                                             1090 04779000
*        /************************************************************/ 04780000
*        /*                                                          */ 04781000
*        /* BYPASS THE LEADING APOSTROPHE AND EXTRACT THE SCALAR     */ 04782000
*        /*                                                          */ 04783000
*        /************************************************************/ 04784000
*                                                                  1091 04785000
*        CALL NEXTCHAR;                                            1091 04786000
@RT01088 BAL   @14,NEXTCHAR                                        1091 04787000
*        CALL NXTFIELD(QUOTSCLR);                                  1092 04788000
         LA    @01,@AL01092                                        1092 04789000
         BAL   @14,NXTFIELD                                        1092 04790000
*        CALL SCANSEP(YES);                                        1093 04791000
*                                                                  1093 04792000
         LA    @01,@AL01093                                        1093 04793000
         BAL   @14,SCANSEP                                         1093 04794000
*        IF RISTATUS=0                                             1094 04795000
*          THEN                                                    1094 04796000
*                                                                  1094 04797000
         ICM   @04,3,RISTATUS                                      1094 04798000
         BNZ   @RF01094                                            1094 04799000
*            /********************************************************/ 04800000
*            /*                                                      */ 04801000
*            /* WHEN A DELIMITER INDICATING A FOLLOWING PASSWORD IS  */ 04802000
*            /* FOUND, NOTE THAT THE PASSWORD IS TO BE EXTRACTED     */ 04803000
*            /* LATER.  ALSO CHECK WHETHER THE OCCURRENCE OR LACK OF */ 04804000
*            /* OCCURRENCE OF A PASSWORD DELIMITER IS AN ERROR.      */ 04805000
*            /*                                                      */ 04806000
*            /********************************************************/ 04807000
*            IF CHAR1=PWDDELIM                                     1095 04808000
*              THEN                                                1095 04809000
         CLI   CHAR1,C'/'                                          1095 04810000
         BNE   @RF01095                                            1095 04811000
*                IF PWORDSW=ON                                     1096 04812000
*                  THEN                                            1096 04813000
         TM    PWORDSW,B'10000000'                                 1096 04814000
         BNO   @RF01096                                            1096 04815000
*                    DO;                                           1097 04816000
*                                                                  1097 04817000
*                    CALL NEXTCHAR;                                1098 04818000
         BAL   @14,NEXTCHAR                                        1098 04819000
*                    CALL SCANSEP(YES);                            1099 04820000
*                                                                  1099 04821000
         LA    @01,@AL01099                                        1099 04822000
         BAL   @14,SCANSEP                                         1099 04823000
*                    PWORD=NEXT;                                   1100 04824000
         LA    PWORD,1                                             1100 04825000
*                    END;                                          1101 04826000
*                  ELSE                                            1102 04827000
*                                                                  1102 04828000
*                    CALL ERROR2(BADPWD,LENGTH(ERRFIELD),          1102 04829000
*                                ADDR(ERRFIELD));                  1102 04830000
*                                                                  1102 04831000
         B     @RC01096                                            1102 04832000
@RF01096 MVC   @AL00001(8),@AL01102                                1102 04833000
         LA    @04,ERRFIELD                                        1102 04834000
         ST    @04,@AFTEMPS+20                                     1102 04835000
         LA    @04,@AFTEMPS+20                                     1102 04836000
         ST    @04,@AL00001+8                                      1102 04837000
         LA    @01,@AL00001                                        1102 04838000
         BAL   @14,ERROR2                                          1102 04839000
*        END GETQUOTD;                                             1103 04840000
*                                                                  1103 04841000
*                                                                  1103 04842000
@EL00013 DS    0H                                                  1103 04843000
@EF00013 DS    0H                                                  1103 04844000
@ER00013 LM    @14,@01,@SA00013                                    1103 04845000
         LM    @03,@04,@SA00013+16                                 1103 04846000
         LM    @06,@12,@SA00013+24                                 1103 04847000
         BR    @14                                                 1103 04848000
*        END GETDATA;                                              1104 04849000
@EL00011 DS    0H                                                  1104 04850000
@EF00011 DS    0H                                                  1104 04851000
@ER00011 LM    @14,@04,@SA00011                                    1104 04852000
         LM    @06,@12,@SA00011+28                                 1104 04853000
         BR    @14                                                 1104 04854000
*/********************************************************************/ 04855000
*/*                                                                  */ 04856000
*/*  PROCEDURE NAME - BUILDFDT                                       */ 04857000
*/*                                                                  */ 04858000
*/*  FUNCTION - THIS ROUTINE PLACES EXTRACTED SCALARS INTO THE       */ 04859000
*/*             FUNCTION DATA TABLE (FDT), AFTER CONVERTING THEM IF  */ 04860000
*/*             NECESSARY.  THE ROUTINE IS PERFORMED ONCE FOR EACH   */ 04861000
*/*             SCALAR.  SPACE IS OBTAINED AS NECESSARY IN ORDER TO  */ 04862000
*/*             STORE THE SCALARS.  SEMANTIC CHECKING IS PERFORMED   */ 04863000
*/*             ON THE SCALAR ITEMS USING THE COMMAND DESCRIPTOR.    */ 04864000
*/*                                                                  */ 04865000
*/*  INPUT -                                                         */ 04866000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 04867000
*/*          PWORD -   SWITCH INDICATING WHETHER A PASSWORD IS NOW   */ 04868000
*/*                    BEING PLACED INTO THE FDT.                    */ 04869000
*/*          SYNUNIT - CONTAINS SCALAR ITEM TO BE PLACED INTO THE FDT*/ 04870000
*/*          UNITINDX- LENGTH OF SCALAR TO BE PLACED INTO THE FDT    */ 04871000
*/*          ORGSIGN - CONTAINS CODE INDICATING FORM IN WHICH THE    */ 04872000
*/*                    SCALAR WAS INPUT (HEX OR BINARY CONSTANT OR   */ 04873000
*/*                    NEITHER)                                      */ 04874000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 04875000
*/*                    VALUE WHEN AN ERROR IS DETECTED               */ 04876000
*/*          SCLRCNT - NUMBER OF SCALAR LIST ITEMS EXTRACTED UP UNTIL*/ 04877000
*/*                    NOW                                           */ 04878000
*/*          DATAPTR - POINTER TO SCALAR DATA STRUCTURE FOR CURRENT  */ 04879000
*/*                    PARAMETER                                     */ 04880000
*/*          SPACELFT- SPACE REMAINING FROM THAT ALLOCATED FOR A     */ 04881000
*/*                    SCALAR LIST DATA STRUCTURE                    */ 04882000
*/*          SPACEAMT- AMOUNT OF SPACE REQUIRED FOR EACH SCALAR ITEM */ 04883000
*/*                    IN THE SCALAR LIST DATA STRUCTURE             */ 04884000
*/*                                                                  */ 04885000
*/*  OUTPUT -                                                        */ 04886000
*/*          FUNCTION DATA TABLE (FDT) DATA ENTRIES                  */ 04887000
*/*          PWORD -   SEE 'INPUT'                                   */ 04888000
*/*          SCLRCNT - NUMBER OF SCALAR LIST ITEMS EXTRACTED         */ 04889000
*/*          SPACELFT- SEE 'INPUT'                                   */ 04890000
*/*                                                                  */ 04891000
*/********************************************************************/ 04892000
*BUILDFDT:PROCEDURE;                                               1105 04893000
BUILDFDT STM   @14,@01,@SA00014                                    1105 04894000
         STM   @03,@04,@SA00014+16                                 1105 04895000
         STM   @06,@12,@SA00014+24                                 1105 04896000
*        /************************************************************/ 04897000
*        /*                                                          */ 04898000
*        /* BUILDFDT PROCEDURE DATA DEFINITIONS                      */ 04899000
*        /*                                                          */ 04900000
*        /************************************************************/ 04901000
*                                                                  1106 04902000
*        /*FULLWORD BINARY CONSTANT DATA FORM                @YL026UL*/ 04903000
*                                                                  1106 04904000
*        DCL FULLWORD FIXED(31) BASED(DATAPTR);                    1106 04905000
*                                                                  1106 04906000
*        /*STRING CONSTANT DATA FORM                         @YL026UL*/ 04907000
*                                                                  1107 04908000
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1107 04909000
*              2 STRINGLN FIXED(8),    /*LENGTH OF STRING    @YL026UL*/ 04910000
*              2 STRING   CHAR(*);     /*THE STRING ITEM ITSELF      */ 04911000
*                                                                  1107 04912000
*        /*CHARACTER STRING (W/ PASSWORD) CONSTANT DATA FORM @YL026UL*/ 04913000
*                                                                  1108 04914000
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1108 04915000
*              2 PASSWDLN FIXED(8),    /*LENGTH OF PASSWORD  @YL026UL*/ 04916000
*              2 PASSWORD CHAR(8),     /*THE PASSWORD ITSELF         */ 04917000
*              2 CHARLN   FIXED(8),    /*CHAR. STRING LENGTH @YL026UL*/ 04918000
*              2 CHARS    CHAR(*);     /*THE CHARACTER STRING ITSELF */ 04919000
*                                                                  1108 04920000
*        /*DATA SET NAME CONSTANT DATA FORM                  @YL026UL*/ 04921000
*                                                                  1109 04922000
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1109 04923000
*              2 DSPWDLN  FIXED(8),    /*LENGTH OF PASSWORD  @YL026UL*/ 04924000
*              2 DSPWORD  CHAR(8),     /*PASSWORD                    */ 04925000
*              2 STARPOS  FIXED(8),    /*ASTERISK POSITION   @YL026UL*/ 04926000
*                                      /* IN GENERIC DSNAME  @YL026UL*/ 04927000
*              2 UNQTFLG  BIT(1),      /*SET 'ON' IF DSNAME  @YL026UL*/ 04928000
*                                      /* WAS INPUT WITHIN   @YL026UL*/ 04929000
*                                      /* QUOTES IN THE TSO  @YL026UL*/ 04930000
*                                      /* ENVIRONMENT        @YL026UL*/ 04931000
*              2 MEMNAMLN FIXED(8),    /*MEMBER NAME LENGTH  @YL026UL*/ 04932000
*              2 MEMNAME  CHAR(8),     /*MEMBER NAME                 */ 04933000
*              2 DSNAMELN FIXED(8),    /*LENGTH OF MAIN PART @YL026UL*/ 04934000
*                                      /* OF THE DSNAME      @YL026UL*/ 04935000
*              2 DSNAME   CHAR(44);    /*MAIN PART OF DATA SET NAME  */ 04936000
*                                                                  1109 04937000
*        /*BINARY FULLWORD CONSTANT LIST DATA FORM           @YL026UL*/ 04938000
*                                                                  1110 04939000
*        DCL 1 * BASED(DATAPTR) BDY(WORD),                         1110 04940000
*              2 FULLWDCT FIXED(31),   /*NO. OF FULLWORDS IN THE LIST*/ 04941000
*              2 LFULLWD(*) FIXED(31); /*LIST OF FULLWORDS   @YL026UL*/ 04942000
*                                                                  1110 04943000
*        /*STRING CONSTANT LIST DATA FORM                    @YL026UL*/ 04944000
*                                                                  1111 04945000
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1111 04946000
*              2 STRINGCT FIXED(15),   /*# OF STRINGS LISTED @YL026UL*/ 04947000
*              2 LSTRINGL FIXED(8),    /*LENGTH OF STRING    @YL026UL*/ 04948000
*              2 LSTRING  CHAR(*);     /*SCALAR ITEM                 */ 04949000
*                                                                  1111 04950000
*        /*STRING (W/ PASSWORD) CONSTANT LIST DATA FORM      @YL026UL*/ 04951000
*                                                                  1112 04952000
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1112 04953000
*              2 CHARCT   FIXED(15),   /*# OF STRING SCALARS IN LIST */ 04954000
*              2 LCHRPWDL FIXED(8),    /*LENGTH OF PASSWORD  @YL026UL*/ 04955000
*              2 LCHRPWD  CHAR(8),     /*PASSWORD AT END OF STRING   */ 04956000
*              2 LCHARLN  FIXED(8),    /*LENGTH OF STRING    @YL026UL*/ 04957000
*              2 LCHAR    CHAR(*);     /*CHARACTER STRING ITEM       */ 04958000
*                                                                  1112 04959000
*        /*DATA SET NAME CONSTANT LIST DATA FORM             @YL026UL*/ 04960000
*                                                                  1113 04961000
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        1113 04962000
*              2 DSNAMECT FIXED(15),   /*# OF DSNAMES IN LIST        */ 04963000
*              2 * (*) BDY(HWORD),     /*ARRAY (LIST) OF DATA        */ 04964000
*                3 LDSNPWDL FIXED(8),  /*PASSWORD LENGTH     @YL026UL*/ 04965000
*                3 LDSNPWD  CHAR(8),   /*PASSWORD AT END OF STRING   */ 04966000
*                3 LSTARPOS FIXED(8),  /*ASTERISK POSITION   @YL026UL*/ 04967000
*                                      /* IN GENERIC DSNAME  @YL026UL*/ 04968000
*                3 LUNQTFLG BIT(1),    /*SET 'ON' IF DSNAME  @YL026UL*/ 04969000
*                                      /* WAS INPUT WITHIN   @YL026UL*/ 04970000
*                                      /* QUOTES IN THE TSO  @YL026UL*/ 04971000
*                                      /* ENVIRONMENT        @YL026UL*/ 04972000
*                3 LMEMNAML FIXED(8),  /*MEMBER NAME LENGTH  @YL026UL*/ 04973000
*                3 LMEMNAME CHAR(8),   /*MEMBER NAME (IF ANY)        */ 04974000
*                3 LDSNAMEL FIXED(8),  /*LENGTH OF DSNAME    @YL026UL*/ 04975000
*                3 LDSNAME  CHAR(44);  /*MAIN PART OF DATA SET NAME  */ 04976000
*                                                                  1113 04977000
*        /*STATIC ERROR MESSAGE CODES                                */ 04978000
*                                                                  1114 04979000
*        DCL BADLIST  FIXED(31)        /*TOO MANY SCALARS IN LIST    */ 04980000
*                     CONSTANT(24);                                1114 04981000
*                                                                  1114 04982000
*        /*OTHER VARIABLES                                           */ 04983000
*                                                                  1115 04984000
*        DCL ELTPTR   PTR(31);         /*PTR TO FDT STORAGE AREA FOR    04985000
*                                        SCALAR LIST ELEMENT         */ 04986000
*        DCL DATALEN  FIXED(15);       /*AMOUNT OF EXTRACTED DATA TO    04987000
*                                        MOVE INTO AN FDT SLOT       */ 04988000
*        DCL CHSTRING BIT(1);          /*SET 'ON' IF INPUT   @YL026UL*/ 04989000
*                                      /* CONSTANT IS NOT A  @YL026UL*/ 04990000
*                                      /* DECIMAL, HEX, OR   @YL026UL*/ 04991000
*                                      /* BINARY CONSTANT    @YL026UL*/ 04992000
*        /************************************************************/ 04993000
*        /*                                                          */ 04994000
*        /*  ** BUILDFDT **  PLACE SCALAR INTO FUNCTION DATA TABLE   */ 04995000
*        /*                                                          */ 04996000
*        /************************************************************/ 04997000
*                                                                  1118 04998000
*        /************************************************************/ 04999000
*        /*                                                  @YL026UL*/ 05000000
*        /* DETERMINE THE BASIC FORMAT OF THE CONSTANT.      @YL026UL*/ 05001000
*        /* CONSTANTS ALLOWING PASSWORDS CANNOT BE CODED     @YL026UL*/ 05002000
*        /* IN HEXADECIMAL FORMAT.                           @YL026UL*/ 05003000
*        /*                                                  @YL026UL*/ 05004000
*        /************************************************************/ 05005000
*        IF ANYSTRNG=YES                                           1118 05006000
*          THEN                                                    1118 05007000
         LA    @04,12                                              1118 05008000
         LR    @15,@04                                             1118 05009000
         MH    @15,PARMID                                          1118 05010000
         L     @01,WORKPTR                                         1118 05011000
         AL    @01,@CF01440                                        1118 05012000
         AL    @04,PARMPTR(@15,@01)                                1118 05013000
         TM    ANYSTRNG(@04),B'01000000'                           1118 05014000
         BNO   @RF01118                                            1118 05015000
*            IF ORGSIGN=BLANK                                      1119 05016000
*              THEN                                                1119 05017000
         CLI   ORGSIGN,C' '                                        1119 05018000
         BNE   @RF01119                                            1119 05019000
*                CHSTRING=YES;                             /*@YL026UL*/ 05020000
         OI    CHSTRING,B'10000000'                                1120 05021000
*              ELSE                                                1121 05022000
*                IF PWORDOPT=YES                                   1121 05023000
*                  THEN                                            1121 05024000
         B     @RC01119                                            1121 05025000
@RF01119 LA    @04,12                                              1121 05026000
         LR    @15,@04                                             1121 05027000
         MH    @15,PARMID                                          1121 05028000
         L     @01,WORKPTR                                         1121 05029000
         AL    @01,@CF01440                                        1121 05030000
         AL    @04,PARMPTR(@15,@01)                                1121 05031000
         TM    PWORDOPT(@04),B'00000010'                           1121 05032000
         BNO   @RF01121                                            1121 05033000
*                    DO;                                   /*@YL026UL*/ 05034000
*                                                                  1122 05035000
*                    CALL ERROR2(BADITEM,LENGTH(ERRFIELD),         1123 05036000
*                                ADDR(ERRFIELD));          /*@YL026UL*/ 05037000
*                                                                  1123 05038000
         MVC   @AL00001(8),@AL01123                                1123 05039000
         LA    @04,ERRFIELD                                        1123 05040000
         ST    @04,@AFTEMPS+32                                     1123 05041000
         LA    @04,@AFTEMPS+32                                     1123 05042000
         ST    @04,@AL00001+8                                      1123 05043000
         LA    @01,@AL00001                                        1123 05044000
         BAL   @14,ERROR2                                          1123 05045000
*                    RETURN;                               /*@YL026UL*/ 05046000
@EL00014 DS    0H                                                  1124 05047000
@EF00014 DS    0H                                                  1124 05048000
@ER00014 LM    @14,@01,@SA00014                                    1124 05049000
         LM    @03,@04,@SA00014+16                                 1124 05050000
         LM    @06,@12,@SA00014+24                                 1124 05051000
         BR    @14                                                 1124 05052000
*                    END;                                  /*@YL026UL*/ 05053000
*                  ELSE                                            1126 05054000
*                    CHSTRING=NO;                          /*@YL026UL*/ 05055000
@RF01121 NI    CHSTRING,B'01111111'                                1126 05056000
*          ELSE                                                    1127 05057000
*            CHSTRING=NO;                                  /*@YL026UL*/ 05058000
*                                                                  1127 05059000
         B     @RC01118                                            1127 05060000
@RF01118 NI    CHSTRING,B'01111111'                                1127 05061000
*        IF SCALAR=YES                                             1128 05062000
*                                                                  1128 05063000
*          /**********************************************************/ 05064000
*          /*                                                        */ 05065000
*          /* WHEN A SINGLE SCALAR (AS OPPOSED TO A SCALAR LIST)     */ 05066000
*          /* IS BEING PROCESSED, GET NECESSARY SPACE, CHECK TO SEE  */ 05067000
*          /* WHAT KIND OF SCALAR IT IS, AND STORE THE SCALAR AND    */ 05068000
*          /* ASSOCIATED DATA.                                       */ 05069000
*          /*                                                        */ 05070000
*          /**********************************************************/ 05071000
*          THEN                                                    1128 05072000
@RC01118 LH    @04,PARMID                                          1128 05073000
         MH    @04,@CH00038                                        1128 05074000
         L     @01,WORKPTR                                         1128 05075000
         AL    @01,@CF01440                                        1128 05076000
         L     @04,PARMPTR(@04,@01)                                1128 05077000
         TM    SCALAR(@04),B'00010000'                             1128 05078000
         BNO   @RF01128                                            1128 05079000
*            IF PWORD=NOW                                          1129 05080000
*                                                                  1129 05081000
*              /******************************************************/ 05082000
*              /*                                                    */ 05083000
*              /*  WHEN THE SCALAR IS A PASSWORD, STORE IT IN THE    */ 05084000
*              /*  ALREADY EXISTING DATA STRUCTURE (EITHER A CHAR.   */ 05085000
*              /*  STRING OR DATA SET NAME DATA STRUCTURE), FIRST    */ 05086000
*              /*  CHECKING THAT IT DOESN'T EXCEED THE LENGTH LIMIT. */ 05087000
*              /*  ALSO STORE THE LENGTH OF THE PASSWORD.            */ 05088000
*              /*                                                    */ 05089000
*              /******************************************************/ 05090000
*              THEN                                                1129 05091000
         CH    PWORD,@CH00172                                      1129 05092000
         BNE   @RF01129                                            1129 05093000
*                IF UNITINDX > LENGTH(PASSWORD)                    1130 05094000
*                  THEN                                            1130 05095000
*                                                                  1130 05096000
         CH    UNITINDX,@CH00042                                   1130 05097000
         BNH   @RF01130                                            1130 05098000
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1131 05099000
*                                ADDR(ERRFIELD));                  1131 05100000
*                                                                  1131 05101000
         MVC   @AL00001(8),@AL01131                                1131 05102000
         LA    @04,ERRFIELD                                        1131 05103000
         ST    @04,@AFTEMPS+32                                     1131 05104000
         LA    @04,@AFTEMPS+32                                     1131 05105000
         ST    @04,@AL00001+8                                      1131 05106000
         LA    @01,@AL00001                                        1131 05107000
         BAL   @14,ERROR2                                          1131 05108000
*                  ELSE                                            1132 05109000
*                    IF ANYSTRNG=YES                               1132 05110000
*                      THEN                                        1132 05111000
         B     @RC01130                                            1132 05112000
@RF01130 LA    @04,12                                              1132 05113000
         LR    @15,@04                                             1132 05114000
         MH    @15,PARMID                                          1132 05115000
         L     @01,WORKPTR                                         1132 05116000
         AL    @01,@CF01440                                        1132 05117000
         AL    @04,PARMPTR(@15,@01)                                1132 05118000
         TM    ANYSTRNG(@04),B'01000000'                           1132 05119000
         BNO   @RF01132                                            1132 05120000
*                        DO;                               /*@YL026UL*/ 05121000
*                        PWORD=NONE;                               1134 05122000
         SLR   PWORD,PWORD                                         1134 05123000
*                        PASSWDLN=UNITINDX;                        1135 05124000
         L     @04,DATAPTR                                         1135 05125000
         STC   UNITINDX,PASSWDLN(,@04)                             1135 05126000
*                        PASSWORD=SYNUNIT;                         1136 05127000
         MVC   PASSWORD(8,@04),SYNUNIT                             1136 05128000
*                        END;                                      1137 05129000
*                      ELSE                                        1138 05130000
*                        DO;                                       1138 05131000
         B     @RC01132                                            1138 05132000
@RF01132 DS    0H                                                  1139 05133000
*                        PWORD=NONE;                               1139 05134000
         SLR   PWORD,PWORD                                         1139 05135000
*                        DSPWDLN=UNITINDX;                         1140 05136000
         L     @04,DATAPTR                                         1140 05137000
         STC   UNITINDX,DSPWDLN(,@04)                              1140 05138000
*                        DSPWORD=SYNUNIT;                          1141 05139000
         MVC   DSPWORD(8,@04),SYNUNIT                              1141 05140000
*                        END;                                      1142 05141000
*                                                                  1142 05142000
*              /******************************************************/ 05143000
*              /*                                                    */ 05144000
*              /*  IF NOT A PASSWORD, ALLOCATE SPACE FOR THE SCALAR  */ 05145000
*              /*  AND ITS ASSOCIATED DATA.  THEN STORE THE SCALAR   */ 05146000
*              /*  AND ITS LENGTH INTO THIS DATA AREA BASED UPON     */ 05147000
*              /*  THE TYPE OF SCALAR THAT IT IS, CHECKING THAT THE  */ 05148000
*              /*  SCALAR LENGTH LIMIT IS NOT EXCEEDED.              */ 05149000
*              /*                                                    */ 05150000
*              /******************************************************/ 05151000
*              ELSE                                                1143 05152000
*DOGRP70:        DO;                                               1143 05153000
*                                                                  1143 05154000
         B     @RC01129                                            1143 05155000
@RF01129 DS    0H                                                  1143 05156000
DOGRP70  DS    0H                                                  1144 05157000
*                CALL GETSPACE;                                    1144 05158000
*                                                                  1144 05159000
         BAL   @14,GETSPACE                                        1144 05160000
*                IF CHSTRING=YES & UNITINDX > MAXLNGTH             1145 05161000
*                  THEN                                            1145 05162000
*                                                                  1145 05163000
         TM    CHSTRING,B'10000000'                                1145 05164000
         BNO   @RF01145                                            1145 05165000
         LA    @04,12                                              1145 05166000
         LR    @15,@04                                             1145 05167000
         MH    @15,PARMID                                          1145 05168000
         L     @01,WORKPTR                                         1145 05169000
         AL    @01,@CF01440                                        1145 05170000
         AL    @04,PARMPTR(@15,@01)                                1145 05171000
         SLR   @15,@15                                             1145 05172000
         IC    @15,MAXLNGTH(,@04)                                  1145 05173000
         CR    UNITINDX,@15                                        1145 05174000
         BNH   @RF01145                                            1145 05175000
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1146 05176000
*                               ADDR(ERRFIELD));           /*@YL026UL*/ 05177000
*                                                                  1146 05178000
         MVC   @AL00001(8),@AL01146                                1146 05179000
         LA    @04,ERRFIELD                                        1146 05180000
         ST    @04,@AFTEMPS+32                                     1146 05181000
         LA    @04,@AFTEMPS+32                                     1146 05182000
         ST    @04,@AL00001+8                                      1146 05183000
         LA    @01,@AL00001                                        1146 05184000
         BAL   @14,ERROR2                                          1146 05185000
*                IF RISTATUS=0                                     1147 05186000
*                  THEN                                            1147 05187000
@RF01145 ICM   @04,3,RISTATUS                                      1147 05188000
         BNZ   @RF01147                                            1147 05189000
*DOGRP75:            DO;                                           1148 05190000
DOGRP75  DS    0H                                                  1149 05191000
*                    IF CHSTRING=YES                               1149 05192000
*                                                                  1149 05193000
*                      /**********************************************/ 05194000
*                      /*                                            */ 05195000
*                      /*  WHEN THE SCALAR IS A CHARACTER STRING,    */ 05196000
*                      /*  STORE IT INTO THE FDT IN THE FORM OF A    */ 05197000
*                      /*  STRING OR A CHAR. STRING WITH PASSWORD    */ 05198000
*                      /*                                            */ 05199000
*                      /**********************************************/ 05200000
*                      THEN                                        1149 05201000
         TM    CHSTRING,B'10000000'                                1149 05202000
         BNO   @RF01149                                            1149 05203000
*                        DO;                               /*@YL026UL*/ 05204000
*                        IF PWORDOPT=YES                           1151 05205000
*                          THEN                                    1151 05206000
         LA    @04,12                                              1151 05207000
         LR    @03,@04                                             1151 05208000
         MH    @03,PARMID                                          1151 05209000
         L     @01,WORKPTR                                         1151 05210000
         AL    @01,@CF01440                                        1151 05211000
         AL    @04,PARMPTR(@03,@01)                                1151 05212000
         TM    PWORDOPT(@04),B'00000010'                           1151 05213000
         BNO   @RF01151                                            1151 05214000
*                            DO;                           /*@YL026UL*/ 05215000
*                            CHARLN=UNITINDX;                      1153 05216000
         L     @03,DATAPTR                                         1153 05217000
         STC   UNITINDX,CHARLN(,@03)                               1153 05218000
*                            CHARS(1:MAXLNGTH)=SYNUNIT;    /*@YL026UL*/ 05219000
         SLR   @15,@15                                             1154 05220000
         IC    @15,MAXLNGTH(,@04)                                  1154 05221000
         BCTR  @15,0                                               1154 05222000
         EX    @15,@SM01466                                        1154 05223000
*                            END;                                  1155 05224000
*                          ELSE                                    1156 05225000
*                            DO;                                   1156 05226000
         B     @RC01151                                            1156 05227000
@RF01151 DS    0H                                                  1157 05228000
*                            STRINGLN=UNITINDX;                    1157 05229000
         L     @04,DATAPTR                                         1157 05230000
         STC   UNITINDX,STRINGLN(,@04)                             1157 05231000
*                            STRING(1:MAXLNGTH)=SYNUNIT;   /*@YL026UL*/ 05232000
         LA    @03,12                                              1158 05233000
         LR    @15,@03                                             1158 05234000
         MH    @15,PARMID                                          1158 05235000
         L     @01,WORKPTR                                         1158 05236000
         AL    @01,@CF01440                                        1158 05237000
         AL    @03,PARMPTR(@15,@01)                                1158 05238000
         SLR   @15,@15                                             1158 05239000
         IC    @15,MAXLNGTH(,@03)                                  1158 05240000
         BCTR  @15,0                                               1158 05241000
         EX    @15,@SM01468                                        1158 05242000
*                            END;                                  1159 05243000
*                        END;                                      1160 05244000
*                                                                  1160 05245000
*                      /**********************************************/ 05246000
*                      /*                                            */ 05247000
*                      /*  WHEN THE CONSTANT IS HEX, BINARY, @YL026UL*/ 05248000
*                      /*  OR DECIMAL, THEN PERFORM          @YL026UL*/ 05249000
*                      /*  NECESSARY CONVERSION BEFORE STORING IT    */ 05250000
*                      /*  INTO THE FDT.                             */ 05251000
*                      /*                                            */ 05252000
*                      /**********************************************/ 05253000
*                      ELSE                                        1161 05254000
*                        IF NUMBER=YES | ANYSTRNG=YES              1161 05255000
*                          THEN                                    1161 05256000
*                                                                  1161 05257000
         B     @RC01149                                            1161 05258000
@RF01149 LA    @04,12                                              1161 05259000
         LR    @15,@04                                             1161 05260000
         MH    @15,PARMID                                          1161 05261000
         L     @01,WORKPTR                                         1161 05262000
         AL    @01,@CF01440                                        1161 05263000
         AL    @04,PARMPTR(@15,@01)                                1161 05264000
         TM    NUMBER(@04),B'11000000'                             1161 05265000
         BZ    @RF01161                                            1161 05266000
*                            CALL CONVERT;                         1162 05267000
*                                                                  1162 05268000
         BAL   @14,CONVERT                                         1162 05269000
*                          /******************************************/ 05270000
*                          /*                                        */ 05271000
*                          /* WHEN NONE OF THE ABOVE DATA TYPES, THE */ 05272000
*                          /* SCALAR MUST BE A DATA SET IDENTIFIER.  */ 05273000
*                          /* IT IS STORED IN DSNAME FORM AFTER      */ 05274000
*                          /* CHECKING DSNAME RESTRICTIONS.          */ 05275000
*                          /*                                        */ 05276000
*                          /******************************************/ 05277000
*                          ELSE                                    1163 05278000
*                                                                  1163 05279000
*                            CALL DSIDCHK;                         1163 05280000
*                                                                  1163 05281000
         B     @RC01161                                            1163 05282000
@RF01161 BAL   @14,DSIDCHK                                         1163 05283000
*                    END DOGRP75;                                  1164 05284000
*                END DOGRP70;                                      1165 05285000
*                                                                  1165 05286000
*          /**********************************************************/ 05287000
*          /*                                                        */ 05288000
*          /* WHEN THE SCALAR BEING HANDLED IS PART OF A SCALAR LIST,*/ 05289000
*          /* CHECK THAT THE LIST ELEMENT LIMIT IS NOT EXCEEDED,     */ 05290000
*          /* ALLOCATE SPACE FOR THE LIST DATA (IF NOT ALREADY DONE),*/ 05291000
*          /* CHECK TO SEE WHAT KIND OF SCALAR DATA IT IS, AND STORE */ 05292000
*          /* THE DATA INTO THE APPROPRIATE NEW OR EXISTING FDT AREA */ 05293000
*          /*                                                        */ 05294000
*          /**********************************************************/ 05295000
*          ELSE                                                    1166 05296000
*            IF PWORD^=NOW                                         1166 05297000
*              THEN                                                1166 05298000
*                                                                  1166 05299000
         B     @RC01128                                            1166 05300000
@RF01128 CH    PWORD,@CH00172                                      1166 05301000
         BE    @RF01166                                            1166 05302000
*                /****************************************************/ 05303000
*                /*                                                  */ 05304000
*                /*  THE SCALAR IS NOT A PASSWORD.  IF THIS IS       */ 05305000
*                /*  FIRST SCALAR ENCOUNTERED IN THE LIST, OBTAIN    */ 05306000
*                /*  INITIAL FDT SPACE FOR STORING THE SCALARS AND   */ 05307000
*                /*  THEIR ASSOCIATED DATA.  IF NOT THE FIRST SCALAR,*/ 05308000
*                /*  ADDITIONAL SPACE MAY HAVE TO BE ALLOCATED.      */ 05309000
*                /*  ALSO, CHECK THAT THE SCALAR DOES NOT EXCEED ITS */ 05310000
*                /*  LENGTH LIMIT AND THAT TOO MANY SCALARS HAVE     */ 05311000
*                /*  BEEN CODED IN THIS CURRENT LIST.                */ 05312000
*                /*                                                  */ 05313000
*                /****************************************************/ 05314000
*DOGRP80:        DO;                                               1167 05315000
DOGRP80  DS    0H                                                  1168 05316000
*                SCLRCNT=SCLRCNT+1;                                1168 05317000
         LA    @04,1                                               1168 05318000
         AH    @04,SCLRCNT                                         1168 05319000
         STH   @04,SCLRCNT                                         1168 05320000
*                IF SCLRCNT > LISTMAX                              1169 05321000
*                  THEN                                            1169 05322000
*                                                                  1169 05323000
         LA    @15,12                                              1169 05324000
         LR    @14,@15                                             1169 05325000
         MH    @14,PARMID                                          1169 05326000
         L     @01,WORKPTR                                         1169 05327000
         AL    @01,@CF01440                                        1169 05328000
         AL    @15,PARMPTR(@14,@01)                                1169 05329000
         SLR   @14,@14                                             1169 05330000
         IC    @14,LISTMAX(,@15)                                   1169 05331000
         CR    @04,@14                                             1169 05332000
         BNH   @RF01169                                            1169 05333000
*                    CALL ERROR2(BADLIST,LENGTH(ERRFIELD),         1170 05334000
*                                ADDR(ERRFIELD));                  1170 05335000
*                                                                  1170 05336000
         MVC   @AL00001(8),@AL01170                                1170 05337000
         LA    @04,ERRFIELD                                        1170 05338000
         ST    @04,@AFTEMPS+32                                     1170 05339000
         LA    @04,@AFTEMPS+32                                     1170 05340000
         ST    @04,@AL00001+8                                      1170 05341000
         LA    @01,@AL00001                                        1170 05342000
         BAL   @14,ERROR2                                          1170 05343000
*                  ELSE                                            1171 05344000
*                    IF SCLRCNT=1                                  1171 05345000
*                      THEN                                        1171 05346000
         B     @RC01169                                            1171 05347000
@RF01169 CLC   SCLRCNT(2),@CH00228                                 1171 05348000
         BNE   @RF01171                                            1171 05349000
*                        DO;                                       1172 05350000
*                                                                  1172 05351000
*                        CALL GETSPACE;                            1173 05352000
*                                                                  1173 05353000
         BAL   @14,GETSPACE                                        1173 05354000
*                        ELTPTR=DATAPTR;                           1174 05355000
         MVC   ELTPTR(4),DATAPTR                                   1174 05356000
*                        END;                                      1175 05357000
*                      ELSE                                        1176 05358000
*                        DO;                                       1176 05359000
         B     @RC01171                                            1176 05360000
@RF01171 DS    0H                                                  1177 05361000
*                        SPACELFT=SPACELFT-SPACEAMT;               1177 05362000
         LH    @04,SPACELFT                                        1177 05363000
         SH    @04,SPACEAMT                                        1177 05364000
         STH   @04,SPACELFT                                        1177 05365000
*                        IF SPACELFT < 0                           1178 05366000
*                          THEN                                    1178 05367000
         LTR   @04,@04                                             1178 05368000
         BNM   @RF01178                                            1178 05369000
*                            DO;                                   1179 05370000
*                            ELTPTR=ELTPTR-DATAPTR;                1180 05371000
*                                                                  1180 05372000
         L     @04,ELTPTR                                          1180 05373000
         SL    @04,DATAPTR                                         1180 05374000
         ST    @04,ELTPTR                                          1180 05375000
*                            CALL MORSPACE;                        1181 05376000
*                                                                  1181 05377000
         BAL   @14,MORSPACE                                        1181 05378000
*                            ELTPTR=ELTPTR+DATAPTR;                1182 05379000
         L     @04,ELTPTR                                          1182 05380000
         AL    @04,DATAPTR                                         1182 05381000
         ST    @04,ELTPTR                                          1182 05382000
*                            END;                                  1183 05383000
*                        END;                                      1184 05384000
@RF01178 DS    0H                                                  1185 05385000
*                IF CHSTRING=YES & UNITINDX > MAXLNGTH             1185 05386000
*                  THEN                                            1185 05387000
*                                                                  1185 05388000
@RC01171 DS    0H                                                  1185 05389000
@RC01169 TM    CHSTRING,B'10000000'                                1185 05390000
         BNO   @RF01185                                            1185 05391000
         LA    @04,12                                              1185 05392000
         LR    @15,@04                                             1185 05393000
         MH    @15,PARMID                                          1185 05394000
         L     @01,WORKPTR                                         1185 05395000
         AL    @01,@CF01440                                        1185 05396000
         AL    @04,PARMPTR(@15,@01)                                1185 05397000
         SLR   @15,@15                                             1185 05398000
         IC    @15,MAXLNGTH(,@04)                                  1185 05399000
         CR    UNITINDX,@15                                        1185 05400000
         BNH   @RF01185                                            1185 05401000
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1186 05402000
*                                ADDR(ERRFIELD));          /*@YL026UL*/ 05403000
*                                                                  1186 05404000
         MVC   @AL00001(8),@AL01186                                1186 05405000
         LA    @04,ERRFIELD                                        1186 05406000
         ST    @04,@AFTEMPS+32                                     1186 05407000
         LA    @04,@AFTEMPS+32                                     1186 05408000
         ST    @04,@AL00001+8                                      1186 05409000
         LA    @01,@AL00001                                        1186 05410000
         BAL   @14,ERROR2                                          1186 05411000
*                IF RISTATUS=0                                     1187 05412000
*                                                                  1187 05413000
*                  /**************************************************/ 05414000
*                  /*                                                */ 05415000
*                  /* STORE THE SCALAR INTO THE PROPER DATA STRUCTURE*/ 05416000
*                  /* TOGETHER WITH THE OTHER SCALARS OF THE LIST.   */ 05417000
*                  /*                                                */ 05418000
*                  /**************************************************/ 05419000
*                  THEN                                            1187 05420000
@RF01185 ICM   @04,3,RISTATUS                                      1187 05421000
         BNZ   @RF01187                                            1187 05422000
*                    IF CHSTRING=YES                               1188 05423000
*                                                                  1188 05424000
*                      /**********************************************/ 05425000
*                      /*                                            */ 05426000
*                      /* WHEN THE SCALAR IS IN CHARACTER STRING FORM*/ 05427000
*                      /*  STORE IT INTO THE FDT IN THE FORM OF A    */ 05428000
*                      /*  STRING OR A CHAR. STRING WITH PASSWORD    */ 05429000
*                      /*                                            */ 05430000
*                      /**********************************************/ 05431000
*                      THEN                                        1188 05432000
         TM    CHSTRING,B'10000000'                                1188 05433000
         BNO   @RF01188                                            1188 05434000
*DOGRP85:                DO;                               /*@YL026UL*/ 05435000
DOGRP85  DS    0H                                                  1190 05436000
*                        IF PWORDOPT=YES                           1190 05437000
*                          THEN                                    1190 05438000
         LA    @04,12                                              1190 05439000
         LR    @03,@04                                             1190 05440000
         MH    @03,PARMID                                          1190 05441000
         L     @01,WORKPTR                                         1190 05442000
         AL    @01,@CF01440                                        1190 05443000
         AL    @04,PARMPTR(@03,@01)                                1190 05444000
         TM    PWORDOPT(@04),B'00000010'                           1190 05445000
         BNO   @RF01190                                            1190 05446000
*                            DO;                           /*@YL026UL*/ 05447000
*                            CHARCT=SCLRCNT;                       1192 05448000
         L     @03,DATAPTR                                         1192 05449000
         MVC   CHARCT(2,@03),SCLRCNT                               1192 05450000
*                            ELTPTR->LCHARLN=UNITINDX;             1193 05451000
         L     @03,ELTPTR                                          1193 05452000
         STC   UNITINDX,LCHARLN(,@03)                              1193 05453000
*                            ELTPTR->LCHAR(1:MAXLNGTH)=            1194 05454000
*                                                 SYNUNIT; /*@YL026UL*/ 05455000
         SLR   @15,@15                                             1194 05456000
         IC    @15,MAXLNGTH(,@04)                                  1194 05457000
         BCTR  @15,0                                               1194 05458000
         EX    @15,@SM01470                                        1194 05459000
*                            END;                                  1195 05460000
*                          ELSE                                    1196 05461000
*                            DO;                                   1196 05462000
         B     @RC01190                                            1196 05463000
@RF01190 DS    0H                                                  1197 05464000
*                            STRINGCT=SCLRCNT;                     1197 05465000
         L     @04,DATAPTR                                         1197 05466000
         MVC   STRINGCT(2,@04),SCLRCNT                             1197 05467000
*                            ELTPTR->LSTRINGL=UNITINDX;            1198 05468000
         L     @04,ELTPTR                                          1198 05469000
         STC   UNITINDX,LSTRINGL(,@04)                             1198 05470000
*                            ELTPTR->LSTRING(1:MAXLNGTH)=          1199 05471000
*                                                 SYNUNIT; /*@YL026UL*/ 05472000
         LA    @03,12                                              1199 05473000
         LR    @15,@03                                             1199 05474000
         MH    @15,PARMID                                          1199 05475000
         L     @01,WORKPTR                                         1199 05476000
         AL    @01,@CF01440                                        1199 05477000
         AL    @03,PARMPTR(@15,@01)                                1199 05478000
         SLR   @15,@15                                             1199 05479000
         IC    @15,MAXLNGTH(,@03)                                  1199 05480000
         BCTR  @15,0                                               1199 05481000
         EX    @15,@SM01472                                        1199 05482000
*                            END;                                  1200 05483000
*                        /********************************************/ 05484000
*                        /*                                          */ 05485000
*                        /* IF NO PASSWORD FOLLOWS THIS SCALAR, THEN */ 05486000
*                        /* POINT TO WHERE THE NEXT SCALAR LIST      */ 05487000
*                        /* ELEMENT WILL BE PLACED IN THE FDT.       */ 05488000
*                        /*                                          */ 05489000
*                        /********************************************/ 05490000
*                        IF PWORD ^= NEXT                          1201 05491000
*                          THEN                                    1201 05492000
@RC01190 CH    PWORD,@CH00228                                      1201 05493000
         BE    @RF01201                                            1201 05494000
*                            ELTPTR=ELTPTR+SPACEAMT;               1202 05495000
         LH    @04,SPACEAMT                                        1202 05496000
         AL    @04,ELTPTR                                          1202 05497000
         ST    @04,ELTPTR                                          1202 05498000
*                        END DOGRP85;                              1203 05499000
*                                                                  1203 05500000
*                      /**********************************************/ 05501000
*                      /*                                            */ 05502000
*                      /*  IF THE SCALAR IS A DECIMAL, HEXADECIMAL,  */ 05503000
*                      /*  OR BINARY CONSTANT, THEN PERFORM THE      */ 05504000
*                      /*  NECESSARY CONVERSION BEFORE STORING IT    */ 05505000
*                      /*  INTO THE FDT.                             */ 05506000
*                      /*                                            */ 05507000
*                      /**********************************************/ 05508000
*                      ELSE                                        1204 05509000
*                        IF NUMBER=YES | ANYSTRNG=YES              1204 05510000
*                          THEN                                    1204 05511000
*                                                                  1204 05512000
         B     @RC01188                                            1204 05513000
@RF01188 LA    @04,12                                              1204 05514000
         LR    @15,@04                                             1204 05515000
         MH    @15,PARMID                                          1204 05516000
         L     @01,WORKPTR                                         1204 05517000
         AL    @01,@CF01440                                        1204 05518000
         AL    @04,PARMPTR(@15,@01)                                1204 05519000
         TM    NUMBER(@04),B'11000000'                             1204 05520000
         BZ    @RF01204                                            1204 05521000
*                            CALL CONVERT;                         1205 05522000
*                                                                  1205 05523000
         BAL   @14,CONVERT                                         1205 05524000
*                          /******************************************/ 05525000
*                          /*                                        */ 05526000
*                          /*  WHEN NONE OF THE ABOVE, THE SCALAR IS */ 05527000
*                          /*  A DATA SET NAME AND IS STORED IN      */ 05528000
*                          /*  DSID FORM IN THE FDT.  THE NAME MUST  */ 05529000
*                          /*  CONFORM TO DSNAME RESTRICTIONS.       */ 05530000
*                          /*                                        */ 05531000
*                          /******************************************/ 05532000
*                          ELSE                                    1206 05533000
*                                                                  1206 05534000
*                            CALL DSIDCHK;                         1206 05535000
*                                                                  1206 05536000
         B     @RC01204                                            1206 05537000
@RF01204 BAL   @14,DSIDCHK                                         1206 05538000
*                END DOGRP80;                                      1207 05539000
*                                                                  1207 05540000
*              /******************************************************/ 05541000
*              /*                                                    */ 05542000
*              /*  WHEN THE EXTRACTED SCALAR IS A PASSWORD ATTACHED  */ 05543000
*              /*  TO A SCALAR LIST ELEMENT, STORE IT IN THE DATA    */ 05544000
*              /*  AREA OF THE APPROPRIATE CHAR. STRING OR DSNAME    */ 05545000
*              /*                                                    */ 05546000
*              /******************************************************/ 05547000
*              ELSE                                                1208 05548000
*                DO;                                               1208 05549000
         B     @RC01166                                            1208 05550000
@RF01166 DS    0H                                                  1209 05551000
*                PWORD=NONE;                                       1209 05552000
         SLR   PWORD,PWORD                                         1209 05553000
*                IF UNITINDX > LENGTH(PASSWORD)                    1210 05554000
*                  THEN                                            1210 05555000
*                                                                  1210 05556000
         CH    UNITINDX,@CH00042                                   1210 05557000
         BNH   @RF01210                                            1210 05558000
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1211 05559000
*                                ADDR(ERRFIELD));                  1211 05560000
*                                                                  1211 05561000
         MVC   @AL00001(8),@AL01211                                1211 05562000
         LA    @04,ERRFIELD                                        1211 05563000
         ST    @04,@AFTEMPS+32                                     1211 05564000
         LA    @04,@AFTEMPS+32                                     1211 05565000
         ST    @04,@AL00001+8                                      1211 05566000
         LA    @01,@AL00001                                        1211 05567000
         BAL   @14,ERROR2                                          1211 05568000
*                  ELSE                                            1212 05569000
*                    IF ANYSTRNG=YES                               1212 05570000
*                      THEN                                        1212 05571000
         B     @RC01210                                            1212 05572000
@RF01210 LA    @04,12                                              1212 05573000
         LR    @03,@04                                             1212 05574000
         MH    @03,PARMID                                          1212 05575000
         L     @01,WORKPTR                                         1212 05576000
         AL    @01,@CF01440                                        1212 05577000
         AL    @04,PARMPTR(@03,@01)                                1212 05578000
         TM    ANYSTRNG(@04),B'01000000'                           1212 05579000
         BNO   @RF01212                                            1212 05580000
*                        DO;                               /*@YL026UL*/ 05581000
*                        ELTPTR->LCHRPWDL=UNITINDX;                1214 05582000
         L     @04,ELTPTR                                          1214 05583000
         STC   UNITINDX,LCHRPWDL(,@04)                             1214 05584000
*                        ELTPTR->LCHRPWD=SYNUNIT;                  1215 05585000
         MVC   LCHRPWD(8,@04),SYNUNIT                              1215 05586000
*                        ELTPTR=ELTPTR+SPACEAMT;                   1216 05587000
         AH    @04,SPACEAMT                                        1216 05588000
         ST    @04,ELTPTR                                          1216 05589000
*                        END;                                      1217 05590000
*                      ELSE                                        1218 05591000
*                        DO;                                       1218 05592000
         B     @RC01212                                            1218 05593000
@RF01212 DS    0H                                                  1219 05594000
*                        LDSNPWDL(SCLRCNT)=UNITINDX;               1219 05595000
         L     @04,DATAPTR                                         1219 05596000
         LH    @03,SCLRCNT                                         1219 05597000
         MH    @03,@CH01419                                        1219 05598000
         LA    @01,0(@03,@04)                                      1219 05599000
         AL    @01,@CF01474                                        1219 05600000
         STC   UNITINDX,LDSNPWDL-2(,@01)                           1219 05601000
*                        LDSNPWD(SCLRCNT)=SYNUNIT;                 1220 05602000
         ALR   @04,@03                                             1220 05603000
         AL    @04,@CF01475                                        1220 05604000
         MVC   LDSNPWD-3(8,@04),SYNUNIT                            1220 05605000
*                        END;                                      1221 05606000
*                END;                                              1222 05607000
*/********************************************************************/ 05608000
*/*                                                                  */ 05609000
*/*  PROCEDURE NAME - CONVERT                                        */ 05610000
*/*                                                                  */ 05611000
*/*  FUNCTION - THIS ROUTINE CONVERTS DECIMAL, BINARY, OR HEXADECIMAL*/ 05612000
*/*             CONSTANTS FROM EBCDIC FORM INTO THE PROPER INTERNAL  */ 05613000
*/*             FORM (FULLWORD BINARY OR HEXIDECIMAL DIGIT STRING,   */ 05614000
*/*             BASED UPON THE COMMAND DESCRIPTOR SPECIFICATION).    */ 05615000
*/*             THE CONSTANTS ARE CHECKED TO INSURE THAT THEY ARE    */ 05616000
*/*             SYNTACTICALLY AND SEMANTICALLY CORRECT AND ARE THEN  */ 05617000
*/*             PLACED INTO THE FDT IN CONVERTED FORM.               */ 05618000
*/*                                                                  */ 05619000
*/*  INPUT -                                                         */ 05620000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 05621000
*/*          SYNUNIT - CONTAINS THE CONSTANT IN EBCDIC FORM WHICH IS */ 05622000
*/*                    TO BE CONVERTED.                              */ 05623000
*/*          UNITINDX- LENGTH OF EBCDIC CONSTANT                     */ 05624000
*/*          ORGSIGN - CONTAINS CODE INDICATING FORM IN WHICH THE    */ 05625000
*/*                    SCALAR WAS INPUT (AS A HEX, BINARY OR DECIMAL */ 05626000
*/*                    CONSTANT).                                    */ 05627000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 05628000
*/*                    VALUE WHEN AN ERROR HAS BEEN DETECTED         */ 05629000
*/*                                                                  */ 05630000
*/*  OUTPUT -                                                        */ 05631000
*/*          FUNCTION DATA TABLE DATA ENTRIES.                       */ 05632000
*/*          SYNUNIT - CONSTANT IN CONVERTED FORM                    */ 05633000
*/*          CNVRTFLD- CONSTANT IN BINARY FULLWORD CONVERTED FORM    */ 05634000
*/*                                                                  */ 05635000
*/********************************************************************/ 05636000
*CONVERT:PROCEDURE;                                                1223 05637000
         B     @PB00015                                            1223 05638000
CONVERT  STM   @14,@12,@SA00015                                    1223 05639000
*        /************************************************************/ 05640000
*        /*                                                          */ 05641000
*        /* DATA DEFINITIONS FOR CONVERT ROUTINE                     */ 05642000
*        /*                                                          */ 05643000
*        /************************************************************/ 05644000
*                                                                  1224 05645000
*        DCL HEXTABLE(16) CHAR(1)      /*HEX DIGITS IN EBCDIC FORM   */ 05646000
*                         INIT('0','1','2','3','4','5','6','7',    1224 05647000
*                              '8','9','A','B','C','D','E','F');   1224 05648000
*        DCL WORKVAL  FIXED(31);       /*FULLWORD WORK AREA USED   1225 05649000
*                                        DURING CONVERSION           */ 05650000
*        DCL TWOPOWER FIXED(15);       /*COMPUTED POWER OF 2         */ 05651000
*        DCL CNVRTVAL FIXED(8);        /*1-BYTE WORK AREA USED     1227 05652000
*                                        DURING CONVERSION           */ 05653000
*        DCL DIGTINDX FIXED(15);       /*INDEX INDICATING CURRENT  1228 05654000
*                                        LENGTH OF CONVERTED PORTION    05655000
*                                        OF CONSTANT BEING CONVERTED */ 05656000
*                                                                  1228 05657000
*        DCL ZEROHALF BIT(8)           /*BIT MASK USED TO SET UPPER  */ 05658000
*                CONSTANT('00001111'B);/* HALF OF A BYTE TO ZEROES   */ 05659000
*        /************************************************************/ 05660000
*        /*                                                          */ 05661000
*        /*  ** CONVERT **  CONVERT DIGIT STRINGS TO INTERNAL FORM   */ 05662000
*        /*                                                          */ 05663000
*        /************************************************************/ 05664000
*        IF GDTDBG = NULLPTR                                       1230 05665000
*          THEN;                                                   1230 05666000
         ICM   @04,15,GDTDBG(GDTPTR)                               1230 05667000
         BZ    @RT01230                                            1230 05668000
*          ELSE                                                    1232 05669000
*            CALL IDCDB010(GDTTBL,'RICV');                         1232 05670000
*                                                                  1232 05671000
         ST    GDTPTR,@AL00001                                     1232 05672000
         LA    @04,@CC01181                                        1232 05673000
         ST    @04,@AL00001+4                                      1232 05674000
         MVI   @AL00001+4,X'80'                                    1232 05675000
         L     @15,GDTDBG(,GDTPTR)                                 1232 05676000
         LA    @01,@AL00001                                        1232 05677000
         BALR  @14,@15                                             1232 05678000
*        /************************************************************/ 05679000
*        /*                                                          */ 05680000
*        /* IF THE INPUT DIGIT STRING IS A DECIMAL NUMBER, CONVERT   */ 05681000
*        /* IT TO A BINARY FULLWORD.                                 */ 05682000
*        /*                                                          */ 05683000
*        /************************************************************/ 05684000
*        IF ORGSIGN=BLANK                                          1233 05685000
*          THEN                                                    1233 05686000
*                                                                  1233 05687000
@RT01230 CLI   ORGSIGN,C' '                                        1233 05688000
         BNE   @RF01233                                            1233 05689000
*            CALL PACKCVB;                                         1234 05690000
*                                                                  1234 05691000
         BAL   @14,PACKCVB                                         1234 05692000
*          ELSE                                                    1235 05693000
*DOGRP90:    DO;                                                   1235 05694000
*                                                                  1235 05695000
         B     @RC01233                                            1235 05696000
@RF01233 DS    0H                                                  1235 05697000
DOGRP90  DS    0H                                                  1236 05698000
*            /********************************************************/ 05699000
*            /*                                                      */ 05700000
*            /* IF THE DIGIT STRING IS A BINARY CONSTANT, CONVERT IT */ 05701000
*            /* INTO A STRING OF HEXADECIMAL DIGITS (NO LONGER IN    */ 05702000
*            /* EBCDIC FORM).  BEFORE CONVERSION, CHECK ALL THE      */ 05703000
*            /* DIGITS IN THE CONSTANT TO BE SURE THEY ARE BINARY    */ 05704000
*            /* DIGITS, AND IF THE STRING IS A BINARY NUMBER, THEN   */ 05705000
*            /* CHECK THAT IT DOESN'T EXCEED THE BINARY FULLWORD     */ 05706000
*            /* SIZE LIMIT.                                          */ 05707000
*            /*                                                      */ 05708000
*            /********************************************************/ 05709000
*            IF ORGSIGN=BINSIGN                                    1236 05710000
*              THEN                                                1236 05711000
         CLI   ORGSIGN,C'B'                                        1236 05712000
         BNE   @RF01236                                            1236 05713000
*                IF NUMBER=YES & UNITINDX > 32                     1237 05714000
*                  THEN                                            1237 05715000
*                                                                  1237 05716000
         LA    @04,12                                              1237 05717000
         LR    @02,@04                                             1237 05718000
         MH    @02,PARMID                                          1237 05719000
         L     @01,WORKPTR                                         1237 05720000
         AL    @01,@CF01440                                        1237 05721000
         AL    @04,PARMPTR(@02,@01)                                1237 05722000
         TM    NUMBER(@04),B'10000000'                             1237 05723000
         BNO   @RF01237                                            1237 05724000
         CH    UNITINDX,@CH00230                                   1237 05725000
         BNH   @RF01237                                            1237 05726000
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1238 05727000
*                                ADDR(ERRFIELD));                  1238 05728000
*                                                                  1238 05729000
         MVC   @AL00001(8),@AL01238                                1238 05730000
         LA    @04,ERRFIELD                                        1238 05731000
         ST    @04,@AFTEMPS+24                                     1238 05732000
         LA    @04,@AFTEMPS+24                                     1238 05733000
         ST    @04,@AL00001+8                                      1238 05734000
         LA    @01,@AL00001                                        1238 05735000
         BAL   @14,ERROR2                                          1238 05736000
*                  ELSE                                            1239 05737000
*DOGRP95:            DO;                                           1239 05738000
         B     @RC01237                                            1239 05739000
@RF01237 DS    0H                                                  1239 05740000
DOGRP95  DS    0H                                                  1240 05741000
*                      OLDERID2 = NEWERID2;                        1240 05742000
         L     @04,GDTTR2(,GDTPTR)                                 1240 05743000
         MVC   @TS00001(95),NEWERID2(@04)                          1240 05744000
         MVC   OLDERID2(95,@04),@TS00001                           1240 05745000
*                      NEWID2='RI24';                              1241 05746000
*                                                                  1241 05747000
         MVC   NEWID2(4,@04),@CC01186                              1241 05748000
*                      /**********************************************/ 05749000
*                      /*                                            */ 05750000
*                      /* CHECK THE DIGITS ONE AT A TIME; IF A DIGIT */ 05751000
*                      /* IS A 1 OR 0 (X'F1' OR X'F0' IN EBCDIC) THEN*/ 05752000
*                      /* SET THE HIGHER ORDER 4 BITS TO ZEROES.     */ 05753000
*                      /*                                            */ 05754000
*                      /**********************************************/ 05755000
*                      DO INDEX=1 TO UNITINDX WHILE(RISTATUS=0);   1242 05756000
         LA    @04,1                                               1242 05757000
         B     @DE01242                                            1242 05758000
@DL01242 ICM   @02,3,RISTATUS                                      1242 05759000
         BNZ   @DC01242                                            1242 05760000
*                        IF SYNUNIT(INDEX) ^= '1'  &               1243 05761000
*                           SYNUNIT(INDEX) ^= '0'                  1243 05762000
*                          THEN                                    1243 05763000
*                                                                  1243 05764000
         LA    @02,SYNUNIT-1(@04)                                  1243 05765000
         CLI   0(@02),C'1'                                         1243 05766000
         BE    @RF01243                                            1243 05767000
         LA    @02,SYNUNIT-1(@04)                                  1243 05768000
         CLI   0(@02),C'0'                                         1243 05769000
         BE    @RF01243                                            1243 05770000
*                            CALL ERROR2(BADDIGIT,LENGTH(ERRFIELD),     05771000
*                                        ADDR(ERRFIELD));          1244 05772000
*                                                                  1244 05773000
         MVC   @AL00001(8),@AL01244                                1244 05774000
         LA    @04,ERRFIELD                                        1244 05775000
         ST    @04,@AFTEMPS+24                                     1244 05776000
         LA    @04,@AFTEMPS+24                                     1244 05777000
         ST    @04,@AL00001+8                                      1244 05778000
         LA    @01,@AL00001                                        1244 05779000
         BAL   @14,ERROR2                                          1244 05780000
*                          ELSE                                    1245 05781000
*                            SYNUNIT(INDEX)=SYNUNIT(INDEX) & ZEROHALF;  05782000
         B     @RC01243                                            1245 05783000
@RF01243 LH    @04,INDEX                                           1245 05784000
         LA    @02,SYNUNIT-1(@04)                                  1245 05785000
         NI    0(@02),B'00001111'                                  1245 05786000
*                      END;                                        1246 05787000
@RC01243 LA    @04,1                                               1246 05788000
         AH    @04,INDEX                                           1246 05789000
@DE01242 STH   @04,INDEX                                           1246 05790000
         CR    @04,UNITINDX                                        1246 05791000
         BNH   @DL01242                                            1246 05792000
@DC01242 DS    0H                                                  1247 05793000
*                    IF RISTATUS=0                                 1247 05794000
*                      THEN                                        1247 05795000
*                                                                  1247 05796000
         ICM   @04,3,RISTATUS                                      1247 05797000
         BNZ   @RF01247                                            1247 05798000
*                        /********************************************/ 05799000
*                        /*                                          */ 05800000
*                        /* CONVERT THE MODIFIED STRING INTO A HEX   */ 05801000
*                        /* DIGIT STRING INTERNALLY BY CONVERTING A  */ 05802000
*                        /* EACH BYTE'S WORTH OF BINARY DIGITS INTO A*/ 05803000
*                        /* VALUE BETWEEN 0 AND 255 (MULTIPLY THE    */ 05804000
*                        /* BINARY DIGITS BY POWERS OF 2 INCREASING  */ 05805000
*                        /* LOW ORDER TO HIGH ORDER).  STORE THE     */ 05806000
*                        /* STRING OF 1-BYTE VALUES BACK INTO THE    */ 05807000
*                        /* SAME WORK AREA THAT CONTAINS THE MODIFIED*/ 05808000
*                        /* DIGIT STRING.                            */ 05809000
*                        /*                                          */ 05810000
*                        /********************************************/ 05811000
*DOGRP100:               DO;                                       1248 05812000
DOGRP100 DS    0H                                                  1249 05813000
*                        WORKVAL=UNITINDX//8;                      1249 05814000
         LR    @00,UNITINDX                                        1249 05815000
         SRDA  @00,32                                              1249 05816000
         D     @00,@CF00042                                        1249 05817000
         LR    WORKVAL,@00                                         1249 05818000
*                        DIGTINDX=0;                               1250 05819000
*                                                                  1250 05820000
         SLR   @02,@02                                             1250 05821000
         STH   @02,DIGTINDX                                        1250 05822000
*                        /********************************************/ 05823000
*                        /*                                          */ 05824000
*                        /* IF THE NUMBER OF DIGITS IN THE STRING IS */ 05825000
*                        /* NOT A MULTIPLE OF 8, FIRST CONVERT JUST  */ 05826000
*                        /* THE ODD NUMBER OF DIGITS INTO A VALUE    */ 05827000
*                        /* BETWEEN 0 AND 255.                       */ 05828000
*                        /*                                          */ 05829000
*                        /********************************************/ 05830000
*                        IF WORKVAL ^= 0                           1251 05831000
*                          THEN                                    1251 05832000
         CR    WORKVAL,@02                                         1251 05833000
         BE    @RF01251                                            1251 05834000
*                            DO;                                   1252 05835000
*                              CNVRTVAL=0;                         1253 05836000
         MVI   CNVRTVAL,X'00'                                      1253 05837000
*                              TWOPOWER=1;                         1254 05838000
         LA    TWOPOWER,1                                          1254 05839000
*                              DO INDEX2=WORKVAL TO 1 BY -1;       1255 05840000
         LR    @15,WORKVAL                                         1255 05841000
         STH   @15,INDEX2                                          1255 05842000
         B     @DE01255                                            1255 05843000
@DL01255 DS    0H                                                  1256 05844000
*                                CNVRTVAL=CNVRTVAL+                1256 05845000
*                                         DIGITVAL(INDEX2)*TWOPOWER;    05846000
         LR    @01,TWOPOWER                                        1256 05847000
         SLR   @14,@14                                             1256 05848000
         IC    @14,DIGITVAL-1(@15)                                 1256 05849000
         MR    @00,@14                                             1256 05850000
         SLR   @00,@00                                             1256 05851000
         IC    @00,CNVRTVAL                                        1256 05852000
         ALR   @01,@00                                             1256 05853000
         STC   @01,CNVRTVAL                                        1256 05854000
*                                TWOPOWER=TWOPOWER*2;              1257 05855000
         ALR   TWOPOWER,TWOPOWER                                   1257 05856000
*                              END;                                1258 05857000
         BCTR  @15,0                                               1258 05858000
         STH   @15,INDEX2                                          1258 05859000
@DE01255 LTR   @15,@15                                             1258 05860000
         BP    @DL01255                                            1258 05861000
*                              DIGITVAL(1)=CNVRTVAL;               1259 05862000
         MVC   DIGITVAL(1),CNVRTVAL                                1259 05863000
*                              DIGTINDX=1;                         1260 05864000
         MVC   DIGTINDX(2),@CH00228                                1260 05865000
*                            END;                                  1261 05866000
*                                                                  1261 05867000
*                        /********************************************/ 05868000
*                        /*                                          */ 05869000
*                        /* CONVERT EACH GROUP OF 8 BINARY DIGITS    */ 05870000
*                        /* INTO A ONE-BYTE VALUE, CREATING A STRING */ 05871000
*                        /* OF THESE VALUES.                         */ 05872000
*                        /*                                          */ 05873000
*                        /********************************************/ 05874000
*                        DO INDEX=WORKVAL+1 TO UNITINDX BY 8;      1262 05875000
@RF01251 LA    @02,1                                               1262 05876000
         ALR   @02,WORKVAL                                         1262 05877000
         STH   @02,INDEX                                           1262 05878000
         B     @DE01262                                            1262 05879000
@DL01262 DS    0H                                                  1263 05880000
*                          CNVRTVAL=0;                             1263 05881000
         MVI   CNVRTVAL,X'00'                                      1263 05882000
*                          TWOPOWER=1;                             1264 05883000
         LA    TWOPOWER,1                                          1264 05884000
*                          DO INDEX2=INDEX+7 TO INDEX BY -1;       1265 05885000
         LH    @15,INDEX                                           1265 05886000
         AH    @15,@CH00043                                        1265 05887000
         STH   @15,INDEX2                                          1265 05888000
         B     @DE01265                                            1265 05889000
@DL01265 DS    0H                                                  1266 05890000
*                            CNVRTVAL=CNVRTVAL+                    1266 05891000
*                                     DIGITVAL(INDEX2)*TWOPOWER;   1266 05892000
         LR    @01,TWOPOWER                                        1266 05893000
         SLR   @14,@14                                             1266 05894000
         IC    @14,DIGITVAL-1(@15)                                 1266 05895000
         MR    @00,@14                                             1266 05896000
         SLR   @00,@00                                             1266 05897000
         IC    @00,CNVRTVAL                                        1266 05898000
         ALR   @01,@00                                             1266 05899000
         STC   @01,CNVRTVAL                                        1266 05900000
*                            TWOPOWER=TWOPOWER*2;                  1267 05901000
         ALR   TWOPOWER,TWOPOWER                                   1267 05902000
*                          END;                                    1268 05903000
         BCTR  @15,0                                               1268 05904000
         STH   @15,INDEX2                                          1268 05905000
@DE01265 CH    @15,INDEX                                           1268 05906000
         BNL   @DL01265                                            1268 05907000
*                          DIGTINDX=DIGTINDX+1;                    1269 05908000
         LA    @02,1                                               1269 05909000
         AH    @02,DIGTINDX                                        1269 05910000
         STH   @02,DIGTINDX                                        1269 05911000
*                          DIGITVAL(DIGTINDX)=CNVRTVAL;            1270 05912000
         SLR   @15,@15                                             1270 05913000
         IC    @15,CNVRTVAL                                        1270 05914000
         STC   @15,DIGITVAL-1(@02)                                 1270 05915000
*                        END;                                      1271 05916000
         LA    @02,8                                               1271 05917000
         AH    @02,INDEX                                           1271 05918000
         STH   @02,INDEX                                           1271 05919000
@DE01262 CR    @02,UNITINDX                                        1271 05920000
         BNH   @DL01262                                            1271 05921000
*                        END DOGRP100;                             1272 05922000
*                    END DOGRP95;                                  1273 05923000
*                                                                  1273 05924000
*                /****************************************************/ 05925000
*                /*                                                  */ 05926000
*                /* IF THE INPUT IS NOT A DECIMAL OR BINARY CONSTANT */ 05927000
*                /* THEN IT MUST BE A HEXADECIMAL CONSTANT.          */ 05928000
*                /*                                                  */ 05929000
*                /****************************************************/ 05930000
*                ELSE                                              1274 05931000
*                                                                  1274 05932000
*                  /**************************************************/ 05933000
*                  /*                                                */ 05934000
*                  /* IF THE HEXADECIMAL CONSTANT IS A HEXADECIMAL   */ 05935000
*                  /* NUMBER, AND IT EXCEEDS THE SIZE THAT WOULD     */ 05936000
*                  /* FIT INTO A BINARY FULLWORD AFTER CONVERSION,   */ 05937000
*                  /* THEN IT IS AN ERROR.  OTHERWISE, TAKE THE HEX  */ 05938000
*                  /* DIGITS (IN EBCDIC FORM) TWO AT A TIME AND      */ 05939000
*                  /* CONVERT EACH INTO A ONE-BYTE VALUE BETWEEN 0   */ 05940000
*                  /* AND 255 USING A CONVERSION TABLE.  CREATE A    */ 05941000
*                  /* STRING OF THESE 1-BYTE VALUES, WHICH WILL THEN */ 05942000
*                  /* BE A REPRESENTATION OF THE INPUT VALUE, STORING*/ 05943000
*                  /* THIS STRING BACK WHERE THE EBCDIC DIGITS WERE. */ 05944000
*                  /*                                                */ 05945000
*                  /**************************************************/ 05946000
*                  IF NUMBER=YES & UNITINDX > 8                    1274 05947000
*                    THEN                                          1274 05948000
*                                                                  1274 05949000
         B     @RC01236                                            1274 05950000
@RF01236 LA    @04,12                                              1274 05951000
         LR    @02,@04                                             1274 05952000
         MH    @02,PARMID                                          1274 05953000
         L     @01,WORKPTR                                         1274 05954000
         AL    @01,@CF01440                                        1274 05955000
         AL    @04,PARMPTR(@02,@01)                                1274 05956000
         TM    NUMBER(@04),B'10000000'                             1274 05957000
         BNO   @RF01274                                            1274 05958000
         CH    UNITINDX,@CH00042                                   1274 05959000
         BNH   @RF01274                                            1274 05960000
*                      CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),      1275 05961000
*                                  ADDR(ERRFIELD));                1275 05962000
*                                                                  1275 05963000
         MVC   @AL00001(8),@AL01275                                1275 05964000
         LA    @04,ERRFIELD                                        1275 05965000
         ST    @04,@AFTEMPS+24                                     1275 05966000
         LA    @04,@AFTEMPS+24                                     1275 05967000
         ST    @04,@AL00001+8                                      1275 05968000
         LA    @01,@AL00001                                        1275 05969000
         BAL   @14,ERROR2                                          1275 05970000
*                    ELSE                                          1276 05971000
*DOGRP105:             DO;                                         1276 05972000
         B     @RC01274                                            1276 05973000
@RF01274 DS    0H                                                  1276 05974000
DOGRP105 DS    0H                                                  1277 05975000
*                        OLDERID2 = NEWERID2;                      1277 05976000
         L     @04,GDTTR2(,GDTPTR)                                 1277 05977000
         MVC   @TS00001(95),NEWERID2(@04)                          1277 05978000
         MVC   OLDERID2(95,@04),@TS00001                           1277 05979000
*                        NEWID2='RI27';                            1278 05980000
         MVC   NEWID2(4,@04),@CC01192                              1278 05981000
*                        DIGTINDX=0;                               1279 05982000
*                                                                  1279 05983000
         SLR   @04,@04                                             1279 05984000
         STH   @04,DIGTINDX                                        1279 05985000
*                        /********************************************/ 05986000
*                        /*                                          */ 05987000
*                        /* IF THERE ARE AN ODD NUMBER OF HEX DIGITS */ 05988000
*                        /* IN THE HEX CONSTANT, FIRST CONVERT JUST  */ 05989000
*                        /* THE SINGLE, HIGH-ORDER DIGIT INTO A ONE- */ 05990000
*                        /* BYTE VALUE.                              */ 05991000
*                        /*                                          */ 05992000
*                        /********************************************/ 05993000
*                        IF UNITINDX//2 ^= 0                       1280 05994000
*                          THEN                                    1280 05995000
         LR    @00,UNITINDX                                        1280 05996000
         SRDA  @00,32                                              1280 05997000
         D     @00,@CF00163                                        1280 05998000
         CR    @00,@04                                             1280 05999000
         BE    @RF01280                                            1280 06000000
*                            DO;                                   1281 06001000
*                              FOUND=NO;                           1282 06002000
*                                                                  1282 06003000
         NI    FOUND,B'11011111'                                   1282 06004000
*                              /**************************************/ 06005000
*                              /*                                    */ 06006000
*                              /* MATCH THE HEX DIGIT AGAINST THE    */ 06007000
*                              /* CONVERSION TABLE TO OBTAIN THE     */ 06008000
*                              /* VALUE OF THE DIGIT.  IF NO MATCH   */ 06009000
*                              /* IS FOUND, AN INVALID HEX DIGIT HAS */ 06010000
*                              /* BEEN FOUND.                        */ 06011000
*                              /*                                    */ 06012000
*                              /**************************************/ 06013000
*                              DO LISTINDX=1 TO 16 WHILE(FOUND=NO);     06014000
         LA    @04,1                                               1283 06015000
         STH   @04,LISTINDX                                        1283 06016000
@DL01283 TM    FOUND,B'00100000'                                   1283 06017000
         BNZ   @DC01283                                            1283 06018000
*                                IF SYNUNIT(1)=HEXTABLE(LISTINDX)  1284 06019000
*                                  THEN                            1284 06020000
         LA    @02,HEXTABLE-1(@04)                                 1284 06021000
         CLC   SYNUNIT(1),0(@02)                                   1284 06022000
         BNE   @RF01284                                            1284 06023000
*                                    DO;                           1285 06024000
*                                    FOUND=YES;                    1286 06025000
         OI    FOUND,B'00100000'                                   1286 06026000
*                                    DIGTINDX=1;                   1287 06027000
         MVC   DIGTINDX(2),@CH00228                                1287 06028000
*                                    DIGITVAL(1)=LISTINDX-1;       1288 06029000
         BCTR  @04,0                                               1288 06030000
         STC   @04,DIGITVAL                                        1288 06031000
*                                    END;                          1289 06032000
*                              END;                                1290 06033000
@RF01284 LA    @04,1                                               1290 06034000
         AH    @04,LISTINDX                                        1290 06035000
         STH   @04,LISTINDX                                        1290 06036000
         CH    @04,@CH00482                                        1290 06037000
         BNH   @DL01283                                            1290 06038000
@DC01283 DS    0H                                                  1291 06039000
*                              IF FOUND=NO                         1291 06040000
*                                THEN                              1291 06041000
*                                                                  1291 06042000
         TM    FOUND,B'00100000'                                   1291 06043000
         BNZ   @RF01291                                            1291 06044000
*                                  CALL ERROR2(BADDIGIT,           1292 06045000
*                                              LENGTH(ERRFIELD),   1292 06046000
*                                              ADDR(ERRFIELD));    1292 06047000
*                                                                  1292 06048000
         MVC   @AL00001(8),@AL01292                                1292 06049000
         LA    @04,ERRFIELD                                        1292 06050000
         ST    @04,@AFTEMPS+24                                     1292 06051000
         LA    @04,@AFTEMPS+24                                     1292 06052000
         ST    @04,@AL00001+8                                      1292 06053000
         LA    @01,@AL00001                                        1292 06054000
         BAL   @14,ERROR2                                          1292 06055000
*                            END;                                  1293 06056000
*                                                                  1293 06057000
@RF01291 DS    0H                                                  1294 06058000
*                        /********************************************/ 06059000
*                        /*                                          */ 06060000
*                        /* TAKE THE REMAINING STRING OF HEX DIGITS  */ 06061000
*                        /* TWO AT A TIME, MATCHING EACH DIGIT OF A  */ 06062000
*                        /* PAIR AGAINST THE CONVERSION TABLE TO GET */ 06063000
*                        /* THE VALUE OF THE HEX DIGIT.  MULTIPLY THE*/ 06064000
*                        /* VALUE OF THE HIGHER ORDER DIGIT OF EACH  */ 06065000
*                        /* PAIR BY 16 AND ADD THIS TO THE VALUE OF  */ 06066000
*                        /* THE LOWER ORDER DIGIT TO OBTAIN THE ONE- */ 06067000
*                        /* BYTE VALUE BETWEEN 0 AND 255.            */ 06068000
*                        /*                                          */ 06069000
*                        /********************************************/ 06070000
*DOLOOP15:               DO INDEX=DIGTINDX+1 TO UNITINDX BY 2      1294 06071000
*                           WHILE(RISTATUS=0);                     1294 06072000
@RF01280 DS    0H                                                  1294 06073000
DOLOOP15 LA    @04,1                                               1294 06074000
         AH    @04,DIGTINDX                                        1294 06075000
         STH   @04,INDEX                                           1294 06076000
         B     @DE01294                                            1294 06077000
@DL01294 ICM   @04,3,RISTATUS                                      1294 06078000
         BNZ   @DC01294                                            1294 06079000
*                          FOUND=NO;                               1295 06080000
         NI    FOUND,B'11011111'                                   1295 06081000
*                          DO LISTINDX=1 TO 16 WHILE(FOUND=NO);    1296 06082000
         LA    @04,1                                               1296 06083000
         STH   @04,LISTINDX                                        1296 06084000
@DL01296 TM    FOUND,B'00100000'                                   1296 06085000
         BNZ   @DC01296                                            1296 06086000
*                            IF SYNUNIT(INDEX)=HEXTABLE(LISTINDX)  1297 06087000
*                              THEN                                1297 06088000
         LH    @02,INDEX                                           1297 06089000
         LA    @01,SYNUNIT-1(@02)                                  1297 06090000
         LA    @02,HEXTABLE-1(@04)                                 1297 06091000
         CLC   0(1,@01),0(@02)                                     1297 06092000
         BNE   @RF01297                                            1297 06093000
*                                DO;                               1298 06094000
*                                FOUND=YES;                        1299 06095000
         OI    FOUND,B'00100000'                                   1299 06096000
*                                CNVRTVAL=16*(LISTINDX-1);         1300 06097000
         BCTR  @04,0                                               1300 06098000
         SLA   @04,4                                               1300 06099000
         STC   @04,CNVRTVAL                                        1300 06100000
*                                END;                              1301 06101000
*                          END;                                    1302 06102000
@RF01297 LA    @04,1                                               1302 06103000
         AH    @04,LISTINDX                                        1302 06104000
         STH   @04,LISTINDX                                        1302 06105000
         CH    @04,@CH00482                                        1302 06106000
         BNH   @DL01296                                            1302 06107000
@DC01296 DS    0H                                                  1303 06108000
*                          IF FOUND=NO                             1303 06109000
*                            THEN                                  1303 06110000
*                                                                  1303 06111000
         TM    FOUND,B'00100000'                                   1303 06112000
         BNZ   @RF01303                                            1303 06113000
*                              CALL ERROR2(BADDIGIT,LENGTH(ERRFIELD),   06114000
*                                          ADDR(ERRFIELD));        1304 06115000
*                                                                  1304 06116000
         MVC   @AL00001(8),@AL01304                                1304 06117000
         LA    @04,ERRFIELD                                        1304 06118000
         ST    @04,@AFTEMPS+24                                     1304 06119000
         LA    @04,@AFTEMPS+24                                     1304 06120000
         ST    @04,@AL00001+8                                      1304 06121000
         LA    @01,@AL00001                                        1304 06122000
         BAL   @14,ERROR2                                          1304 06123000
*                            ELSE                                  1305 06124000
*                                                                  1305 06125000
*                              /**************************************/ 06126000
*                              /*                                    */ 06127000
*                              /* IF THE HIGHER ORDER DIGIT OF THE   */ 06128000
*                              /* PAIR WAS CONVERTED OKAY, THEN      */ 06129000
*                              /* CONVERT THE LOWER ORDER DIGIT AND  */ 06130000
*                              /* COMBINE THE TWO INTO A VALUE.      */ 06131000
*                              /*                                    */ 06132000
*                              /**************************************/ 06133000
*                              DO;                                 1305 06134000
         B     @RC01303                                            1305 06135000
@RF01303 DS    0H                                                  1306 06136000
*                                FOUND=NO;                         1306 06137000
         NI    FOUND,B'11011111'                                   1306 06138000
*                                DO LISTINDX=1 TO 16 WHILE(FOUND=NO);   06139000
         LA    @04,1                                               1307 06140000
         STH   @04,LISTINDX                                        1307 06141000
@DL01307 TM    FOUND,B'00100000'                                   1307 06142000
         BNZ   @DC01307                                            1307 06143000
*                                  IF SYNUNIT(INDEX+1)=            1308 06144000
*                                      HEXTABLE(LISTINDX)          1308 06145000
*                                    THEN                          1308 06146000
         LH    @02,INDEX                                           1308 06147000
         LA    @01,SYNUNIT(@02)                                    1308 06148000
         LA    @02,HEXTABLE-1(@04)                                 1308 06149000
         CLC   0(1,@01),0(@02)                                     1308 06150000
         BNE   @RF01308                                            1308 06151000
*                                      DO;                         1309 06152000
*                                      FOUND=YES;                  1310 06153000
         OI    FOUND,B'00100000'                                   1310 06154000
*                                      DIGTINDX=DIGTINDX+1;        1311 06155000
         LA    @02,1                                               1311 06156000
         AH    @02,DIGTINDX                                        1311 06157000
         STH   @02,DIGTINDX                                        1311 06158000
*                                      DIGITVAL(DIGTINDX)=         1312 06159000
*                                        CNVRTVAL+LISTINDX-1;      1312 06160000
         SLR   @15,@15                                             1312 06161000
         IC    @15,CNVRTVAL                                        1312 06162000
         ALR   @04,@15                                             1312 06163000
         BCTR  @04,0                                               1312 06164000
         STC   @04,DIGITVAL-1(@02)                                 1312 06165000
*                                      END;                        1313 06166000
*                                END;                              1314 06167000
@RF01308 LA    @04,1                                               1314 06168000
         AH    @04,LISTINDX                                        1314 06169000
         STH   @04,LISTINDX                                        1314 06170000
         CH    @04,@CH00482                                        1314 06171000
         BNH   @DL01307                                            1314 06172000
@DC01307 DS    0H                                                  1315 06173000
*                                IF FOUND=NO                       1315 06174000
*                                  THEN                            1315 06175000
*                                                                  1315 06176000
         TM    FOUND,B'00100000'                                   1315 06177000
         BNZ   @RF01315                                            1315 06178000
*                                    CALL ERROR2(BADDIGIT,         1316 06179000
*                                                LENGTH(ERRFIELD), 1316 06180000
*                                                ADDR(ERRFIELD));  1316 06181000
*                                                                  1316 06182000
         MVC   @AL00001(8),@AL01316                                1316 06183000
         LA    @04,ERRFIELD                                        1316 06184000
         ST    @04,@AFTEMPS+24                                     1316 06185000
         LA    @04,@AFTEMPS+24                                     1316 06186000
         ST    @04,@AL00001+8                                      1316 06187000
         LA    @01,@AL00001                                        1316 06188000
         BAL   @14,ERROR2                                          1316 06189000
*                              END;                                1317 06190000
@RF01315 DS    0H                                                  1318 06191000
*                        END DOLOOP15;                             1318 06192000
@RC01303 LA    @04,2                                               1318 06193000
         AH    @04,INDEX                                           1318 06194000
         STH   @04,INDEX                                           1318 06195000
@DE01294 CR    @04,UNITINDX                                        1318 06196000
         BNH   @DL01294                                            1318 06197000
@DC01294 DS    0H                                                  1319 06198000
*                      END DOGRP105;                               1319 06199000
*              IF RISTATUS=0                                       1320 06200000
*                THEN                                              1320 06201000
*                                                                  1320 06202000
@RC01274 DS    0H                                                  1320 06203000
@RC01236 ICM   @04,3,RISTATUS                                      1320 06204000
         BNZ   @RF01320                                            1320 06205000
*                  /**************************************************/ 06206000
*                  /*                                                */ 06207000
*                  /* IF THE BINARY OR HEX CONSTANT JUST CONVERTED   */ 06208000
*                  /* IS A NUMBER, MOVE THE CONVERTED NUMBER (STRING */ 06209000
*                  /* OF 1-BYTE VALUES) INTO A BINARY FULLWORD.      */ 06210000
*                  /*                                                */ 06211000
*                  /**************************************************/ 06212000
*                  IF NUMBER=YES                                   1321 06213000
*                    THEN                                          1321 06214000
         LA    @04,12                                              1321 06215000
         LR    @02,@04                                             1321 06216000
         MH    @02,PARMID                                          1321 06217000
         L     @01,WORKPTR                                         1321 06218000
         AL    @01,@CF01440                                        1321 06219000
         AL    @04,PARMPTR(@02,@01)                                1321 06220000
         TM    NUMBER(@04),B'10000000'                             1321 06221000
         BNO   @RF01321                                            1321 06222000
*                      DO;                                         1322 06223000
*                      OLDERID2 = NEWERID2;                        1323 06224000
         L     @04,GDTTR2(,GDTPTR)                                 1323 06225000
         MVC   @TS00001(95),NEWERID2(@04)                          1323 06226000
         MVC   OLDERID2(95,@04),@TS00001                           1323 06227000
*                      NEWID2='RI30';                              1324 06228000
         MVC   NEWID2(4,@04),@CC01195                              1324 06229000
*                      CNVRTFLD=SYNUNIT(1:DIGTINDX);               1325 06230000
         MVI   CNVRTFLD+1,C' '                                     1325 06231000
         MVC   CNVRTFLD+2(8),CNVRTFLD+1                            1325 06232000
         LH    @04,DIGTINDX                                        1325 06233000
         LR    @02,@04                                             1325 06234000
         BCTR  @02,0                                               1325 06235000
         EX    @02,@SM01476                                        1325 06236000
*                      CNVRTWRD=''B;                               1326 06237000
         SLR   @02,@02                                             1326 06238000
         ST    @02,CNVRTWRD                                        1326 06239000
*                      SYNUNIT(LENGTH(CNVRTWRD)+1-DIGTINDX:        1327 06240000
*                              LENGTH(CNVRTWRD))=CNVRTFLD;         1327 06241000
         LCR   @04,@04                                             1327 06242000
         AH    @04,@CH00295                                        1327 06243000
         LA    @02,SYNUNIT-1(@04)                                  1327 06244000
         LCR   @04,@04                                             1327 06245000
         AL    @04,@CF00052                                        1327 06246000
         EX    @04,@SM01478                                        1327 06247000
*                      END;                                        1328 06248000
*            END DOGRP90;                                          1329 06249000
*                                                                  1329 06250000
@RF01321 DS    0H                                                  1329 06251000
@RF01320 DS    0H                                                  1330 06252000
*        /************************************************************/ 06253000
*        /*                                                          */ 06254000
*        /* IF CONVERSION HAS PROCEEDED OKAY TO THIS POINT, THEN     */ 06255000
*        /* PERFORM FINAL SEMANTIC CHECKING OF THE VALUES AND MOVE   */ 06256000
*        /* THEM INTO THE FUNCTION DATA TABLE.                       */ 06257000
*        /*                                                          */ 06258000
*        /************************************************************/ 06259000
*        IF RISTATUS=0                                             1330 06260000
*          THEN                                                    1330 06261000
*                                                                  1330 06262000
@RC01233 ICM   @04,3,RISTATUS                                      1330 06263000
         BNZ   @RF01330                                            1330 06264000
*            /********************************************************/ 06265000
*            /*                                                      */ 06266000
*            /* CHECK THAT THE CONVERTED NUMBER DOES NOT EXCEED THE  */ 06267000
*            /* DESIGNATED VALUE LIMITS FOR THIS PARAMETER.          */ 06268000
*            /*                                                      */ 06269000
*            /********************************************************/ 06270000
*            IF NUMBER=YES                                         1331 06271000
*              THEN                                                1331 06272000
         LA    @04,12                                              1331 06273000
         LR    @02,@04                                             1331 06274000
         MH    @02,PARMID                                          1331 06275000
         L     @01,WORKPTR                                         1331 06276000
         AL    @01,@CF01440                                        1331 06277000
         AL    @04,PARMPTR(@02,@01)                                1331 06278000
         TM    NUMBER(@04),B'10000000'                             1331 06279000
         BNO   @RF01331                                            1331 06280000
*                IF CNVRTWRD > HIVALUE  |  CNVRTWRD < LOWVALUE     1332 06281000
*                  THEN                                            1332 06282000
*                                                                  1332 06283000
         L     @02,CNVRTWRD                                        1332 06284000
         C     @02,HIVALUE(,@04)                                   1332 06285000
         BH    @RT01332                                            1332 06286000
         C     @02,LOWVALUE(,@04)                                  1332 06287000
         BNL   @RF01332                                            1332 06288000
@RT01332 DS    0H                                                  1333 06289000
*                    CALL ERROR2(BADNUMSZ,LENGTH(ERRFIELD),        1333 06290000
*                                ADDR(ERRFIELD));                  1333 06291000
*                                                                  1333 06292000
         MVC   @AL00001(8),@AL01333                                1333 06293000
         LA    @04,ERRFIELD                                        1333 06294000
         ST    @04,@AFTEMPS+24                                     1333 06295000
         LA    @04,@AFTEMPS+24                                     1333 06296000
         ST    @04,@AL00001+8                                      1333 06297000
         LA    @01,@AL00001                                        1333 06298000
         BAL   @14,ERROR2                                          1333 06299000
*                  ELSE                                            1334 06300000
*                    IF SCALAR=YES                                 1334 06301000
*                      THEN                                        1334 06302000
         B     @RC01332                                            1334 06303000
@RF01332 LH    @04,PARMID                                          1334 06304000
         MH    @04,@CH00038                                        1334 06305000
         L     @01,WORKPTR                                         1334 06306000
         AL    @01,@CF01440                                        1334 06307000
         L     @04,PARMPTR(@04,@01)                                1334 06308000
         TM    SCALAR(@04),B'00010000'                             1334 06309000
         BNO   @RF01334                                            1334 06310000
*                        FULLWORD=CNVRTWRD;                        1335 06311000
         L     @04,DATAPTR                                         1335 06312000
         MVC   FULLWORD(4,@04),CNVRTWRD                            1335 06313000
*                      ELSE                                        1336 06314000
*                        DO;                                       1336 06315000
         B     @RC01334                                            1336 06316000
@RF01334 DS    0H                                                  1337 06317000
*                        FULLWDCT=SCLRCNT;                         1337 06318000
         LH    @04,SCLRCNT                                         1337 06319000
         L     @15,DATAPTR                                         1337 06320000
         ST    @04,FULLWDCT(,@15)                                  1337 06321000
*                        LFULLWD(SCLRCNT)=CNVRTWRD;                1338 06322000
         SLA   @04,2                                               1338 06323000
         L     @14,CNVRTWRD                                        1338 06324000
         ST    @14,LFULLWD-4(@04,@15)                              1338 06325000
*                        END;                                      1339 06326000
*                                                                  1339 06327000
*              /******************************************************/ 06328000
*              /*                                                    */ 06329000
*              /* IF THE CONSTANT CONVERTED WAS A BIT STRING OR HEX  */ 06330000
*              /* STRING, CHECK THAT THE CONVERTED HEXADECIMAL DIGIT */ 06331000
*              /* STRING DOES NOT EXCEED THE MAXIMUM SCALAR LENGTH   */ 06332000
*              /* ALLOWED FOR THIS PARAMETER.  THEN PLACE THE STRING */ 06333000
*              /* INTO THE FDT.                                      */ 06334000
*              /*                                                    */ 06335000
*              /******************************************************/ 06336000
*              ELSE                                                1340 06337000
*                IF DIGTINDX > MAXLNGTH                            1340 06338000
*                  THEN                                            1340 06339000
*                                                                  1340 06340000
         B     @RC01331                                            1340 06341000
@RF01331 LA    @04,12                                              1340 06342000
         LR    @02,@04                                             1340 06343000
         MH    @02,PARMID                                          1340 06344000
         L     @01,WORKPTR                                         1340 06345000
         AL    @01,@CF01440                                        1340 06346000
         AL    @04,PARMPTR(@02,@01)                                1340 06347000
         LH    @02,DIGTINDX                                        1340 06348000
         SLR   @15,@15                                             1340 06349000
         IC    @15,MAXLNGTH(,@04)                                  1340 06350000
         CR    @02,@15                                             1340 06351000
         BNH   @RF01340                                            1340 06352000
*                    CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),        1341 06353000
*                                ADDR(ERRFIELD));                  1341 06354000
*                                                                  1341 06355000
         MVC   @AL00001(8),@AL01341                                1341 06356000
         LA    @04,ERRFIELD                                        1341 06357000
         ST    @04,@AFTEMPS+24                                     1341 06358000
         LA    @04,@AFTEMPS+24                                     1341 06359000
         ST    @04,@AL00001+8                                      1341 06360000
         LA    @01,@AL00001                                        1341 06361000
         BAL   @14,ERROR2                                          1341 06362000
*                  ELSE                                            1342 06363000
*                    IF SCALAR=YES                                 1342 06364000
*                      THEN                                        1342 06365000
         B     @RC01340                                            1342 06366000
@RF01340 LA    @04,12                                              1342 06367000
         LR    @15,@04                                             1342 06368000
         MH    @15,PARMID                                          1342 06369000
         L     @01,WORKPTR                                         1342 06370000
         AL    @01,@CF01440                                        1342 06371000
         L     @15,PARMPTR(@15,@01)                                1342 06372000
         TM    SCALAR(@15),B'00010000'                             1342 06373000
         BNO   @RF01342                                            1342 06374000
*                        DO;                                       1343 06375000
*                        STRINGLN=DIGTINDX;                        1344 06376000
         L     @14,DATAPTR                                         1344 06377000
         MVC   STRINGLN(1,@14),DIGTINDX+1                          1344 06378000
*                        WORKPTR3=ADDR(STRING);            /*@YL026UL*/ 06379000
         LA    @03,STRING(,@14)                                    1345 06380000
         ST    @03,WORKPTR3                                        1345 06381000
*                        RFY(DATABLK) BASED(WORKPTR3);     /*@YL026UL*/ 06382000
*                        STRING(1)=BLANK;                  /*@YL026UL*/ 06383000
         MVI   STRING(@14),C' '                                    1347 06384000
*                        IF MAXLNGTH > 1                   /*@ZA14582*/ 06385000
*                          THEN                            /*@ZA14582*/ 06386000
         ALR   @15,@04                                             1348 06387000
         CLI   MAXLNGTH(@15),1                                     1348 06388000
         BNH   @RF01348                                            1348 06389000
*                            STRING(2:MAXLNGTH)=                   1349 06390000
*                               DATABLK(1:MAXLNGTH-1);     /*@YL026UL*/ 06391000
         SLR   @04,@04                                             1349 06392000
         IC    @04,MAXLNGTH(,@15)                                  1349 06393000
         BCTR  @04,0                                               1349 06394000
         BCTR  @04,0                                               1349 06395000
         EX    @04,@SM01480                                        1349 06396000
*                        STRING(1:DIGTINDX)=                       1350 06397000
*                                SYNUNIT(1:DIGTINDX);      /*@YL026UL*/ 06398000
@RF01348 L     @04,DATAPTR                                         1350 06399000
         LH    @15,DIGTINDX                                        1350 06400000
         BCTR  @15,0                                               1350 06401000
         EX    @15,@SM01468                                        1350 06402000
*                        END;                                      1351 06403000
*                      ELSE                                        1352 06404000
*                        DO;                                       1352 06405000
         B     @RC01342                                            1352 06406000
@RF01342 DS    0H                                                  1353 06407000
*                        STRINGCT=SCLRCNT;                         1353 06408000
         L     @04,DATAPTR                                         1353 06409000
         MVC   STRINGCT(2,@04),SCLRCNT                             1353 06410000
*                        WORKPTR3=ADDR(ELTPTR->LSTRING);   /*@YL026UL*/ 06411000
         L     @04,ELTPTR                                          1354 06412000
         LA    @15,LSTRING(,@04)                                   1354 06413000
         ST    @15,WORKPTR3                                        1354 06414000
*                        ELTPTR->LSTRINGL=DIGTINDX;                1355 06415000
         MVC   LSTRINGL(1,@04),DIGTINDX+1                          1355 06416000
*                        ELTPTR->LSTRING(1)=BLANK;         /*@YL026UL*/ 06417000
         MVI   LSTRING(@04),C' '                                   1356 06418000
*                        IF MAXLNGTH > 1                   /*@ZA14582*/ 06419000
*                          THEN                            /*@ZA14582*/ 06420000
         LA    @14,12                                              1357 06421000
         LR    @03,@14                                             1357 06422000
         MH    @03,PARMID                                          1357 06423000
         L     @01,WORKPTR                                         1357 06424000
         AL    @01,@CF01440                                        1357 06425000
         AL    @14,PARMPTR(@03,@01)                                1357 06426000
         CLI   MAXLNGTH(@14),1                                     1357 06427000
         BNH   @RF01357                                            1357 06428000
*                            ELTPTR->LSTRING(2:MAXLNGTH)=          1358 06429000
*                          WORKPTR3->DATABLK(1:MAXLNGTH-1);/*@YL026UL*/ 06430000
         SLR   @03,@03                                             1358 06431000
         IC    @03,MAXLNGTH(,@14)                                  1358 06432000
         BCTR  @03,0                                               1358 06433000
         BCTR  @03,0                                               1358 06434000
         EX    @03,@SM01482                                        1358 06435000
*                        ELTPTR->LSTRING(1:DIGTINDX)=              1359 06436000
*                              SYNUNIT(1:DIGTINDX);        /*@YL026UL*/ 06437000
@RF01357 L     @04,ELTPTR                                          1359 06438000
         LH    @15,DIGTINDX                                        1359 06439000
         BCTR  @15,0                                               1359 06440000
         EX    @15,@SM01472                                        1359 06441000
*                        ELTPTR=ELTPTR+SPACEAMT;                   1360 06442000
         AH    @04,SPACEAMT                                        1360 06443000
         ST    @04,ELTPTR                                          1360 06444000
*                        END;                                      1361 06445000
*                                                                  1361 06446000
*        END CONVERT;                                              1362 06447000
@EL00015 DS    0H                                                  1362 06448000
@EF00015 DS    0H                                                  1362 06449000
@ER00015 LM    @14,@12,@SA00015                                    1362 06450000
         BR    @14                                                 1362 06451000
*/********************************************************************/ 06452000
*/*                                                                  */ 06453000
*/*  PROCEDURE NAME - DSIDCHK                                        */ 06454000
*/*                                                                  */ 06455000
*/*  FUNCTION - THIS ROUTINE CHECKS DSNAME SYNTAX RESTRICTIONS ON    */ 06456000
*/*             AN EXTRACTED DSNAME ITEM, PARSES OUT THE     @YL026UL*/ 06457000
*/*             MEMBER NAME (IF PRESENT), AND STORES THE     @YL026UL*/ 06458000
*/*             NAME(S) INTO THE FDT.                        @YL026UL*/ 06459000
*/*                                                                  */ 06460000
*/*  INPUT -                                                         */ 06461000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 06462000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 06463000
*/*                    VALUE WHEN AN ERROR IS DETECTED               */ 06464000
*/*          SYNUNIT - CONTAINS THE DSNAME TO BE EXAMINED AND STORED */ 06465000
*/*                    INTO THE FDT.                                 */ 06466000
*/*          UNITINDX- LENGTH OF THE DSNAME TO BE CHECKED            */ 06467000
*/*          SCLRCNT - COUNT OF ITEMS FOUND SO FAR IN A SCALAR LIST  */ 06468000
*/*                                                                  */ 06469000
*/*  OUTPUT -                                                        */ 06470000
*/*          FUNCTION DATA TABLE ENTRY.                              */ 06471000
*/*          RISTATUS- SEE 'INPUT'                                   */ 06472000
*/*                                                                  */ 06473000
*/********************************************************************/ 06474000
*DSIDCHK:PROCEDURE;                                                1363 06475000
DSIDCHK  STM   @14,@04,@SA00016                                    1363 06476000
         STM   @06,@12,@SA00016+28                                 1363 06477000
*        /************************************************************/ 06478000
*        /*                                                          */ 06479000
*        /* DSIDCHK DATA DEFINITIONS                                 */ 06480000
*        /*                                                          */ 06481000
*        /************************************************************/ 06482000
*        DCL NATCHAR1 CHAR(1)          /*NATIONAL CHARACTER          */ 06483000
*                     CONSTANT('@');                               1364 06484000
*        DCL NATCHAR2 CHAR(1)          /*NATIONAL CHARACTER          */ 06485000
*                     CONSTANT('#');                               1365 06486000
*        DCL NATCHAR3 CHAR(1)          /*NATIONAL CHARACTER          */ 06487000
*                     CONSTANT('$');                               1366 06488000
*        DCL HYPHEN   CHAR(1)          /*HYPHEN CHARACTER            */ 06489000
*                     CONSTANT('-');                               1367 06490000
*        DCL 1 TWLVZERO CHAR(1) STATIC,/*12-0 PUNCH CODE             */ 06491000
*              2 * FIXED(8) INIT('C0'X);                           1368 06492000
*        DCL PERIOD   CHAR(1)          /*PERIOD CHARACTER            */ 06493000
*                     CONSTANT('.');                               1369 06494000
*        DCL STAR     CHAR(1)          /*ASTERISK CHARACTER  @YL026UL*/ 06495000
*                     CONSTANT('*');                       /*@YL026UL*/ 06496000
*                                                                  1370 06497000
*        DCL SEGSTART FIXED(15);       /*STARTING POSITION OF A DATA    06498000
*                                        SET NAME SEGMENT            */ 06499000
*        DCL SEGEND   FIXED(15);       /*ENDING POSITION OF A DATA 1372 06500000
*                                        SET NAME SEGMENT            */ 06501000
*        DCL SEGLEN   FIXED(15);       /*LENGTH OF DSNAME    @YL026UL*/ 06502000
*                                      /* SEGMENT            @YL026UL*/ 06503000
*        DCL STARLOC  FIXED(8);        /*ASTERISK LOCATION   @YL026UL*/ 06504000
*                                      /* IN GENERIC DSNAME  @YL026UL*/ 06505000
*        DCL MEMBIT   BIT(1);          /*SET 'ON' WHEN A     @YL026UL*/ 06506000
*                                      /* MEMBER NAME IS     @YL026UL*/ 06507000
*                                      /* BEING CHECKED      @YL026UL*/ 06508000
*        DCL ONESTAR  BIT(1);          /*SET 'ON' WHEN AN    @YL026UL*/ 06509000
*                                      /* ASTERISK HAS BEEN  @YL026UL*/ 06510000
*                                      /* FOUND IN A DSNAME  @YL026UL*/ 06511000
*        DCL WITHMEM  BIT(1);          /*SET 'ON' WHEN       @YL026UL*/ 06512000
*                                      /*CHECKING ANY PART   @YL026UL*/ 06513000
*                                      /*OF A DSNAME THAT    @YL026UL*/ 06514000
*                                      /*HAS A MEMBER NAME   @YL026UL*/ 06515000
*        /************************************************************/ 06516000
*        /*                                                          */ 06517000
*        /*  ** DSIDCHK **  CHECK DSNAME SYNTAX RESTRICTIONS         */ 06518000
*        /*                                                          */ 06519000
*        /************************************************************/ 06520000
*        OLDERID2 = NEWERID2;                                      1378 06521000
         L     @04,GDTTR2(,GDTPTR)                                 1378 06522000
         MVC   @TS00001(95),NEWERID2(@04)                          1378 06523000
         MVC   OLDERID2(95,@04),@TS00001                           1378 06524000
*        NEWID2='RIID';                                            1379 06525000
*                                                                  1379 06526000
         MVC   NEWID2(4,@04),@CC01221                              1379 06527000
*        /************************************************************/ 06528000
*        /*                                                          */ 06529000
*        /* IF AN INPUT DSNAME HAS A MEMBER NAME IN PARENS,  @YL026UL*/ 06530000
*        /* FIRST EXTRACT THE MEMBER NAME, CHECK FOR CORRECT @YL026UL*/ 06531000
*        /* SYNTAX, AND STORE IT IN THE FDT.                 @YL026UL*/ 06532000
*        /*                                                          */ 06533000
*        /************************************************************/ 06534000
*        WITHMEM=NO;                                       /*@YL026UL*/ 06535000
         NI    WITHMEM,B'01111111'                                 1380 06536000
*        MEMBIT=NO;                                        /*@YL026UL*/ 06537000
         NI    MEMBIT,B'01111111'                                  1381 06538000
*        IF UNITINDX > 3  &  SYNUNIT(UNITINDX) = CLOSING           1382 06539000
*          THEN                                                    1382 06540000
         CH    UNITINDX,@CH00172                                   1382 06541000
         BNH   @RF01382                                            1382 06542000
         LA    @04,SYNUNIT-1(UNITINDX)                             1382 06543000
         CLI   0(@04),C')'                                         1382 06544000
         BNE   @RF01382                                            1382 06545000
*            DO INDEX2=1 TO UNITINDX WHILE(MEMBIT=NO);     /*@YL026UL*/ 06546000
*                                                                  1383 06547000
         LA    @04,1                                               1383 06548000
         B     @DE01383                                            1383 06549000
@DL01383 TM    MEMBIT,B'10000000'                                  1383 06550000
         BNZ   @DC01383                                            1383 06551000
*              IF SYNUNIT(INDEX2)=OPENING                          1384 06552000
*                THEN                                              1384 06553000
*                                                                  1384 06554000
         LA    @02,SYNUNIT-1(@04)                                  1384 06555000
         CLI   0(@02),C'('                                         1384 06556000
         BNE   @RF01384                                            1384 06557000
*                  /**************************************************/ 06558000
*                  /*                                                */ 06559000
*                  /* UPON FINDING THE OPENING PARENTHESIS   @YL026UL*/ 06560000
*                  /* DELIMITING THE MEMBER NAME, THE NAME   @YL026UL*/ 06561000
*                  /* IS EXTRACTED.                          @YL026UL*/ 06562000
*                  /*                                                */ 06563000
*                  /**************************************************/ 06564000
*DOGRP106:         DO;                                     /*@YL026UL*/ 06565000
DOGRP106 DS    0H                                                  1386 06566000
*                  SEGSTART=INDEX2+1;                      /*@YL026UL*/ 06567000
         LA    @15,1                                               1386 06568000
         LH    SEGSTART,INDEX2                                     1386 06569000
         ALR   SEGSTART,@15                                        1386 06570000
*                  SEGEND=UNITINDX-1;                      /*@YL026UL*/ 06571000
         LR    SEGEND,UNITINDX                                     1387 06572000
         BCTR  SEGEND,0                                            1387 06573000
*                  SEGLEN=SEGEND-SEGSTART+1;               /*@YL026UL*/ 06574000
         LR    @14,SEGEND                                          1388 06575000
         SLR   @14,SEGSTART                                        1388 06576000
         ALR   @14,@15                                             1388 06577000
         STH   @14,SEGLEN                                          1388 06578000
*                  MEMBIT=YES;                             /*@YL026UL*/ 06579000
         OI    MEMBIT,B'10000000'                                  1389 06580000
*                  WITHMEM=YES;                            /*@YL026UL*/ 06581000
*                                                                  1390 06582000
         OI    WITHMEM,B'10000000'                                 1390 06583000
*                  CALL NAMESCAN;                          /*@YL026UL*/ 06584000
*                                                                  1391 06585000
         BAL   @14,NAMESCAN                                        1391 06586000
*                  /**************************************************/ 06587000
*                  /*                                                */ 06588000
*                  /* IF THE MEMBER NAME HAS NO SYNTAX       @YL026UL*/ 06589000
*                  /* ERROR, STORE IT IN THE FDT.            @YL026UL*/ 06590000
*                  /*                                                */ 06591000
*                  /**************************************************/ 06592000
*                  IF RISTATUS=0                                   1392 06593000
*                    THEN                                          1392 06594000
         ICM   @05,3,RISTATUS                                      1392 06595000
         BNZ   @RF01392                                            1392 06596000
*                      IF LIST=YES                                 1393 06597000
*                        THEN                                      1393 06598000
         LH    @05,PARMID                                          1393 06599000
         MH    @05,@CH00038                                        1393 06600000
         L     @01,WORKPTR                                         1393 06601000
         AL    @01,@CF01440                                        1393 06602000
         L     @05,PARMPTR(@05,@01)                                1393 06603000
         TM    LIST(@05),B'00001000'                               1393 06604000
         BNO   @RF01393                                            1393 06605000
*                          DO;                             /*@YL026UL*/ 06606000
*                          DSNAMECT=SCLRCNT;               /*@YL026UL*/ 06607000
         LH    @05,SCLRCNT                                         1395 06608000
         L     @15,DATAPTR                                         1395 06609000
         STH   @05,DSNAMECT(,@15)                                  1395 06610000
*                          LMEMNAML(SCLRCNT)=SEGLEN;       /*@YL026UL*/ 06611000
         MH    @05,@CH01419                                        1396 06612000
         LH    @14,SEGLEN                                          1396 06613000
         LA    @01,0(@05,@15)                                      1396 06614000
         AL    @01,@CF01484                                        1396 06615000
         STC   @14,LMEMNAML-13(,@01)                               1396 06616000
*                          LMEMNAME(SCLRCNT)=                      1397 06617000
*                                SYNUNIT(SEGSTART:SEGEND); /*@YL026UL*/ 06618000
         ALR   @15,@05                                             1397 06619000
         AL    @15,@CF01485                                        1397 06620000
         MVI   LMEMNAME-13(@15),C' '                               1397 06621000
         MVC   LMEMNAME-12(6,@15),LMEMNAME-13(@15)                 1397 06622000
         LR    @05,SEGEND                                          1397 06623000
         SLR   @05,SEGSTART                                        1397 06624000
         LA    @14,SYNUNIT-1(SEGSTART)                             1397 06625000
         EX    @05,@SM01486                                        1397 06626000
*                          END;                            /*@YL026UL*/ 06627000
*                        ELSE                                      1399 06628000
*                          DO;                             /*@YL026UL*/ 06629000
         B     @RC01393                                            1399 06630000
@RF01393 DS    0H                                                  1400 06631000
*                          MEMNAMLN=SEGLEN;                /*@YL026UL*/ 06632000
         L     @05,DATAPTR                                         1400 06633000
         MVC   MEMNAMLN(1,@05),SEGLEN+1                            1400 06634000
*                          MEMNAME=                                1401 06635000
*                               SYNUNIT(SEGSTART:SEGEND);  /*@YL026UL*/ 06636000
         MVI   MEMNAME+1(@05),C' '                                 1401 06637000
         MVC   MEMNAME+2(6,@05),MEMNAME+1(@05)                     1401 06638000
         LR    @15,SEGEND                                          1401 06639000
         SLR   @15,SEGSTART                                        1401 06640000
         LA    @01,SYNUNIT-1(SEGSTART)                             1401 06641000
         EX    @15,@SM01488                                        1401 06642000
*                          END;                            /*@YL026UL*/ 06643000
*                  UNITINDX=SEGSTART-2;                    /*@YL026UL*/ 06644000
@RC01393 DS    0H                                                  1403 06645000
@RF01392 LR    UNITINDX,SEGSTART                                   1403 06646000
         BCTR  UNITINDX,0                                          1403 06647000
         BCTR  UNITINDX,0                                          1403 06648000
*                  END DOGRP106;                           /*@YL026UL*/ 06649000
*            END;                                          /*@YL026UL*/ 06650000
*                                                                  1405 06651000
@RF01384 LA    @04,1                                               1405 06652000
         AH    @04,INDEX2                                          1405 06653000
@DE01383 STH   @04,INDEX2                                          1405 06654000
         CR    @04,UNITINDX                                        1405 06655000
         BNH   @DL01383                                            1405 06656000
@DC01383 DS    0H                                                  1406 06657000
*        /************************************************************/ 06658000
*        /*                                                          */ 06659000
*        /* THE DSNAME, EXCLUDING THE MEMBER NAME, MUST      @YL026UL*/ 06660000
*        /* ADHERE TO DSNAME LENGTH LIMITATIONS.             @YL026UL*/ 06661000
*        /*                                                          */ 06662000
*        /************************************************************/ 06663000
*        IF UNITINDX > MAXLNGTH  |  UNITINDX < 1                   1406 06664000
*          THEN                                                    1406 06665000
@RF01382 LA    @04,12                                              1406 06666000
         LR    @02,@04                                             1406 06667000
         MH    @02,PARMID                                          1406 06668000
         L     @01,WORKPTR                                         1406 06669000
         AL    @01,@CF01440                                        1406 06670000
         AL    @04,PARMPTR(@02,@01)                                1406 06671000
         SLR   @02,@02                                             1406 06672000
         IC    @02,MAXLNGTH(,@04)                                  1406 06673000
         CR    UNITINDX,@02                                        1406 06674000
         BH    @RT01406                                            1406 06675000
         LTR   UNITINDX,UNITINDX                                   1406 06676000
         BP    @RF01406                                            1406 06677000
@RT01406 DS    0H                                                  1407 06678000
*            RISTATUS=BADITEM;                             /*@YL026UL*/ 06679000
*                                                                  1407 06680000
         MVC   RISTATUS(2),@CH00052                                1407 06681000
*        /************************************************************/ 06682000
*        /*                                                          */ 06683000
*        /* A DSNAME MAY CONSIST OF 1 TO 8-CHAR SEGMENTS,    @YL026UL*/ 06684000
*        /* SEPARATED BY PERIODS.  EACH SEGMENT IS CHECKED   @YL026UL*/ 06685000
*        /* FOR SYNTAX ERRORS AFTER THE PERIODS HAVE BEEN    @YL026UL*/ 06686000
*        /* FOUND WHICH DELIMIT THE SEGMENT.                 @YL026UL*/ 06687000
*        /*                                                          */ 06688000
*        /************************************************************/ 06689000
*        STARLOC=0;                                        /*@YL026UL*/ 06690000
@RF01406 MVI   STARLOC,X'00'                                       1408 06691000
*        ONESTAR=NO;                                       /*@YL026UL*/ 06692000
         NI    ONESTAR,B'01111111'                                 1409 06693000
*        SEGEND=-1;                                                1410 06694000
         SLR   SEGEND,SEGEND                                       1410 06695000
         BCTR  SEGEND,0                                            1410 06696000
*        MEMBIT=NO;                                        /*@YL026UL*/ 06697000
*                                                                  1411 06698000
         NI    MEMBIT,B'01111111'                                  1411 06699000
*DOLOOP16:DO WHILE(RISTATUS=0 & SEGEND<UNITINDX);                  1412 06700000
DOLOOP16 B     @DE01412                                            1412 06701000
@DL01412 DS    0H                                                  1413 06702000
*          SEGSTART=SEGEND+2;                                      1413 06703000
         LA    SEGSTART,2                                          1413 06704000
         ALR   SEGSTART,SEGEND                                     1413 06705000
*          DO SEGEND=SEGSTART TO UNITINDX                          1414 06706000
*                               WHILE(SYNUNIT(SEGEND)^=PERIOD);    1414 06707000
         LR    SEGEND,SEGSTART                                     1414 06708000
         B     @DE01414                                            1414 06709000
@DL01414 LA    @01,SYNUNIT-1(SEGEND)                               1414 06710000
         CLI   0(@01),C'.'                                         1414 06711000
         BE    @DC01414                                            1414 06712000
*          END;                                                    1415 06713000
         AL    SEGEND,@CF00228                                     1415 06714000
@DE01414 CR    SEGEND,UNITINDX                                     1415 06715000
         BNH   @DL01414                                            1415 06716000
@DC01414 DS    0H                                                  1416 06717000
*          SEGEND=SEGEND-1;                                        1416 06718000
         BCTR  SEGEND,0                                            1416 06719000
*          SEGLEN=SEGEND-SEGSTART+1;                       /*@YL026UL*/ 06720000
*                                                                  1417 06721000
         LA    @15,1                                               1417 06722000
         LR    @14,SEGEND                                          1417 06723000
         SLR   @14,SEGSTART                                        1417 06724000
         ALR   @14,@15                                             1417 06725000
         STH   @14,SEGLEN                                          1417 06726000
*          /**********************************************************/ 06727000
*          /*                                                        */ 06728000
*          /* IF THIS MAY BE A GENERIC DSNAME, CHECK FOR AN  @YL026UL*/ 06729000
*          /* ASTERISK, BUT ALLOW JUST ONE OF THEM, IN PLACE @YL026UL*/ 06730000
*          /* OF A SINGLE DSNAME LEVEL.                      @YL026UL*/ 06731000
*          /*                                                        */ 06732000
*          /**********************************************************/ 06733000
*          IF SYNUNIT(SEGSTART)=STAR                               1418 06734000
*            THEN                                                  1418 06735000
         LA    @01,SYNUNIT-1(SEGSTART)                             1418 06736000
         CLI   0(@01),C'*'                                         1418 06737000
         BNE   @RF01418                                            1418 06738000
*              IF ONESTAR=NO & GENERIC=YES & SEGLEN=1 & SEGSTART^=1     06739000
*                THEN                                              1419 06740000
         TM    ONESTAR,B'10000000'                                 1419 06741000
         BNZ   @RF01419                                            1419 06742000
         LA    @01,12                                              1419 06743000
         LR    @00,@01                                             1419 06744000
         MH    @00,PARMID                                          1419 06745000
         L     @15,WORKPTR                                         1419 06746000
         LR    @14,@00                                             1419 06747000
         AL    @15,@CF01440                                        1419 06748000
         AL    @01,PARMPTR(@14,@15)                                1419 06749000
         TM    GENERIC(@01),B'00010000'                            1419 06750000
         BNO   @RF01419                                            1419 06751000
         LH    @15,SEGLEN                                          1419 06752000
         LA    @14,1                                               1419 06753000
         CR    @15,@14                                             1419 06754000
         BNE   @RF01419                                            1419 06755000
         CR    SEGSTART,@14                                        1419 06756000
         BE    @RF01419                                            1419 06757000
*                  DO;                                     /*@YL026UL*/ 06758000
*                  ONESTAR=YES;                            /*@YL026UL*/ 06759000
         OI    ONESTAR,B'10000000'                                 1421 06760000
*                  STARLOC=SEGSTART;                       /*@YL026UL*/ 06761000
         STC   SEGSTART,STARLOC                                    1422 06762000
*                  END;                                    /*@YL026UL*/ 06763000
*                ELSE                                              1424 06764000
*                  RISTATUS=BADITEM;                       /*@YL026UL*/ 06765000
         B     @RC01419                                            1424 06766000
@RF01419 MVC   RISTATUS(2),@CH00052                                1424 06767000
*            ELSE                                                  1425 06768000
*                                                                  1425 06769000
*              CALL NAMESCAN;                              /*@YL026UL*/ 06770000
*                                                                  1425 06771000
         B     @RC01418                                            1425 06772000
@RF01418 BAL   @14,NAMESCAN                                        1425 06773000
*        END DOLOOP16;                                     /*@YL026UL*/ 06774000
*                                                                  1426 06775000
@RC01418 DS    0H                                                  1426 06776000
@DE01412 ICM   @02,3,RISTATUS                                      1426 06777000
         BNZ   @DC01412                                            1426 06778000
         CR    SEGEND,UNITINDX                                     1426 06779000
         BL    @DL01412                                            1426 06780000
@DC01412 DS    0H                                                  1427 06781000
*        /************************************************************/ 06782000
*        /*                                                          */ 06783000
*        /* IF THE DSNAME IS SYNTACTICALLY PROPER, STORE IT IN THE   */ 06784000
*        /* FDT--OTHERWISE, PRINT AN ERROR MESSAGE.                  */ 06785000
*        /*                                                          */ 06786000
*        /************************************************************/ 06787000
*        IF RISTATUS=0                                             1427 06788000
*          THEN                                                    1427 06789000
         ICM   @04,3,RISTATUS                                      1427 06790000
         BNZ   @RF01427                                            1427 06791000
*            IF LIST=YES                                           1428 06792000
*              THEN                                                1428 06793000
         LH    @04,PARMID                                          1428 06794000
         MH    @04,@CH00038                                        1428 06795000
         L     @01,WORKPTR                                         1428 06796000
         AL    @01,@CF01440                                        1428 06797000
         L     @04,PARMPTR(@04,@01)                                1428 06798000
         TM    LIST(@04),B'00001000'                               1428 06799000
         BNO   @RF01428                                            1428 06800000
*                DO;                                       /*@YL026UL*/ 06801000
*                DSNAMECT=SCLRCNT;                         /*@YL026UL*/ 06802000
         LH    @04,SCLRCNT                                         1430 06803000
         L     @15,DATAPTR                                         1430 06804000
         STH   @04,DSNAMECT(,@15)                                  1430 06805000
*                LSTARPOS(SCLRCNT)=STARLOC;                /*@YL026UL*/ 06806000
         MH    @04,@CH01419                                        1431 06807000
         SLR   @14,@14                                             1431 06808000
         IC    @14,STARLOC                                         1431 06809000
         LA    @01,0(@04,@15)                                      1431 06810000
         AL    @01,@CF01490                                        1431 06811000
         STC   @14,LSTARPOS-11(,@01)                               1431 06812000
*                LDSNAMEL(SCLRCNT)=UNITINDX;               /*@YL026UL*/ 06813000
         LA    @01,0(@04,@15)                                      1432 06814000
         AL    @01,@CF01491                                        1432 06815000
         STC   UNITINDX,LDSNAMEL-22(,@01)                          1432 06816000
*                LDSNAME(SCLRCNT)=SYNUNIT(1:UNITINDX);     /*@YL026UL*/ 06817000
         ALR   @15,@04                                             1433 06818000
         AL    @15,@CF01492                                        1433 06819000
         MVI   LDSNAME-22(@15),C' '                                1433 06820000
         MVC   LDSNAME-21(42,@15),LDSNAME-22(@15)                  1433 06821000
         LR    @04,UNITINDX                                        1433 06822000
         BCTR  @04,0                                               1433 06823000
         EX    @04,@SM01493                                        1433 06824000
*                END;                                      /*@YL026UL*/ 06825000
*              ELSE                                                1435 06826000
*                DO;                                       /*@YL026UL*/ 06827000
         B     @RC01428                                            1435 06828000
@RF01428 DS    0H                                                  1436 06829000
*                DSNAMELN=UNITINDX;                        /*@YL026UL*/ 06830000
         L     @04,DATAPTR                                         1436 06831000
         STC   UNITINDX,DSNAMELN(,@04)                             1436 06832000
*                STARPOS=STARLOC;                          /*@YL026UL*/ 06833000
         MVC   STARPOS(1,@04),STARLOC                              1437 06834000
*                DSNAME=SYNUNIT(1:UNITINDX);               /*@YL026UL*/ 06835000
         MVI   DSNAME+1(@04),C' '                                  1438 06836000
         MVC   DSNAME+2(42,@04),DSNAME+1(@04)                      1438 06837000
         LR    @15,UNITINDX                                        1438 06838000
         BCTR  @15,0                                               1438 06839000
         EX    @15,@SM01495                                        1438 06840000
*                END;                                      /*@YL026UL*/ 06841000
*          ELSE                                                    1440 06842000
*                                                                  1440 06843000
*            CALL ERROR2(BADITEM,LENGTH(ERRFIELD),                 1440 06844000
*                                    ADDR(ERRFIELD));      /*@YL026UL*/ 06845000
         B     @RC01427                                            1440 06846000
@RF01427 MVC   @AL00001(8),@AL01440                                1440 06847000
         LA    @04,ERRFIELD                                        1440 06848000
         ST    @04,@AFTEMPS+28                                     1440 06849000
         LA    @04,@AFTEMPS+28                                     1440 06850000
         ST    @04,@AL00001+8                                      1440 06851000
         LA    @01,@AL00001                                        1440 06852000
         BAL   @14,ERROR2                                          1440 06853000
*/********************************************************************/ 06854000
*/*                                                                  */ 06855000
*/*  PROCEDURE NAME - NAMESCAN                               @YL026UL*/ 06856000
*/*                                                                  */ 06857000
*/*  FUNCTION - THIS ROUTINE CHECKS THAT DSNAME SEGMENTS AND @YL026UL*/ 06858000
*/*             MEMBER NAMES ADHERE TO RESTRICTIONS UPON     @YL026UL*/ 06859000
*/*             LENGTH AND VALID CHARACTERS.                 @YL026UL*/ 06860000
*/*                                                                  */ 06861000
*/*  INPUT -                                                 @YL026UL*/ 06862000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND          @YL026UL*/ 06863000
*/*          SYNUNIT  - CONTAINS THE SEGMENT OF CHARACTERS   @YL026UL*/ 06864000
*/*                     TO BE CHECKED FOR VALIDITY           @YL026UL*/ 06865000
*/*          SEGSTART - THE POSITION OF THE 1ST SEGMENT CHAR @YL026UL*/ 06866000
*/*          SEGEND -   THE POSITION OF THE 2ND SEGMENT CHAR @YL026UL*/ 06867000
*/*          SEGLEN -   LENGTH OF SEGMENT TO BE CHECKED      @YL026UL*/ 06868000
*/*          MEMBIT -   SET 'ON' IF A MEMBER NAME IS BEING   @YL026UL*/ 06869000
*/*                     CHECKED.                             @YL026UL*/ 06870000
*/*                                                                  */ 06871000
*/*  OUTPUT -                                                @YL026UL*/ 06872000
*/*          RISTATUS - SET TO A NON-ZERO ERROR ID IF NAME   @YL026UL*/ 06873000
*/*                     DOES NOT MEET SYNTAX REQUIREMENTS    @YL026UL*/ 06874000
*/*                                                                  */ 06875000
*/********************************************************************/ 06876000
*NAMESCAN:PROCEDURE;                                       /*@YL026UL*/ 06877000
         B     @PB00017                                            1441 06878000
NAMESCAN STM   @14,@12,@SA00017                                    1441 06879000
*        /************************************************************/ 06880000
*        /*                                                          */ 06881000
*        /*  ** NAMESCAN **  CHECK NAME SEGMENT SYNTAX       @YL026UL*/ 06882000
*        /*                                                          */ 06883000
*        /************************************************************/ 06884000
*        IF GDTDBG = NULLPTR                                       1442 06885000
*          THEN;                                                   1442 06886000
         ICM   @15,15,GDTDBG(GDTPTR)                               1442 06887000
         BZ    @RT01442                                            1442 06888000
*          ELSE                                                    1444 06889000
*            CALL IDCDB010(GDTTBL,'RINS');                         1444 06890000
         ST    GDTPTR,@AL00001                                     1444 06891000
         LA    @15,@CC01230                                        1444 06892000
         ST    @15,@AL00001+4                                      1444 06893000
         MVI   @AL00001+4,X'80'                                    1444 06894000
         L     @15,GDTDBG(,GDTPTR)                                 1444 06895000
         LA    @01,@AL00001                                        1444 06896000
         BALR  @14,@15                                             1444 06897000
*                                                          /*@YL026UL*/ 06898000
*                                                                  1445 06899000
*        /************************************************************/ 06900000
*        /*                                                          */ 06901000
*        /* IF THE SETMENT IS LESS THAN 1 OR GREATER THAN    @YL026UL*/ 06902000
*        /* 8 CHARACTERS LONG OR IF THE BEGINNING CHARACTER  @YL026UL*/ 06903000
*        /* OR THE SEGMENT IS NOT AN ALPHABETIC OR NATIONAL  @YL026UL*/ 06904000
*        /* CHARACTER (OR NOT A DECIMAL DIGIT IF THIS 'NAME' @YL026UL*/ 06905000
*        /* MAY ACTUALLY BE A VOLUME SERIAL NUMBER), THEN    @YL026UL*/ 06906000
*        /* THE DSNAME IS IN ERROR.                          @YL026UL*/ 06907000
*        /*                                                          */ 06908000
*        /************************************************************/ 06909000
*        IF SEGLEN >= 1  &  SEGLEN <= 8  &                         1445 06910000
*           (SYNUNIT(SEGSTART)>='A' & SYNUNIT(SEGSTART)<='Z' |     1445 06911000
*            SYNUNIT(SEGSTART)=NATCHAR1 |                          1445 06912000
*            SYNUNIT(SEGSTART)=NATCHAR2 |                          1445 06913000
*            SYNUNIT(SEGSTART)=NATCHAR3)                           1445 06914000
*          THEN                                                    1445 06915000
*                                                                  1445 06916000
@RT01442 LH    @15,SEGLEN                                          1445 06917000
         CH    @15,@CH00228                                        1445 06918000
         BL    @RF01445                                            1445 06919000
         CH    @15,@CH00042                                        1445 06920000
         BH    @RF01445                                            1445 06921000
         LA    @01,SYNUNIT-1(SEGSTART)                             1445 06922000
         CLI   0(@01),C'A'                                         1445 06923000
         BL    @GL00072                                            1445 06924000
         LA    @01,SYNUNIT-1(SEGSTART)                             1445 06925000
         CLI   0(@01),C'Z'                                         1445 06926000
         BNH   @RT01445                                            1445 06927000
@GL00072 LA    @01,SYNUNIT-1(SEGSTART)                             1445 06928000
         CLI   0(@01),C'@'                                         1445 06929000
         BE    @RT01445                                            1445 06930000
         LA    @01,SYNUNIT-1(SEGSTART)                             1445 06931000
         CLI   0(@01),C'#'                                         1445 06932000
         BE    @RT01445                                            1445 06933000
         LA    @01,SYNUNIT-1(SEGSTART)                             1445 06934000
         CLI   0(@01),C'$'                                         1445 06935000
         BNE   @RF01445                                            1445 06936000
@RT01445 DS    0H                                                  1446 06937000
*            /********************************************************/ 06938000
*            /*                                                      */ 06939000
*            /* CHECK THAT THE REMAINING CHARACTERS IN THE   @YL026UL*/ 06940000
*            /* SEGMENT ARE ALPHABETIC OR NATIONAL CHAR'S    @YL026UL*/ 06941000
*            /* (OR HYPHEN OR TWELVE-ZERO CODE IF THE        @YL026UL*/ 06942000
*            /* SEGMENT IS NOT A MEMBER NAME).               @YL026UL*/ 06943000
*            /*                                                      */ 06944000
*            /********************************************************/ 06945000
*            DO INDEX2=SEGSTART+1 TO SEGEND;               /*@YL026UL*/ 06946000
         LA    @15,1                                               1446 06947000
         ALR   @15,SEGSTART                                        1446 06948000
         B     @DE01446                                            1446 06949000
@DL01446 DS    0H                                                  1447 06950000
*              IF SYNUNIT(INDEX2) >= 'A'  &  SYNUNIT(INDEX2) <= 'Z'  |  06951000
*                 SYNUNIT(INDEX2) >= '0'  &  SYNUNIT(INDEX2) <= '9'  |  06952000
*                 SYNUNIT(INDEX2)=NATCHAR1 |                       1447 06953000
*                 SYNUNIT(INDEX2)=NATCHAR2 |                       1447 06954000
*                 SYNUNIT(INDEX2)=NATCHAR3 |                       1447 06955000
*                 MEMBIT=NO & (SYNUNIT(INDEX2)=HYPHEN |            1447 06956000
*                              SYNUNIT(INDEX2)=TWLVZERO)           1447 06957000
*                THEN;                                     /*@YL026UL*/ 06958000
         LA    @14,SYNUNIT-1(@15)                                  1447 06959000
         CLI   0(@14),C'A'                                         1447 06960000
         BL    @GL00078                                            1447 06961000
         LA    @14,SYNUNIT-1(@15)                                  1447 06962000
         CLI   0(@14),C'Z'                                         1447 06963000
         BNH   @RT01447                                            1447 06964000
@GL00078 LH    @15,INDEX2                                          1447 06965000
         LA    @14,SYNUNIT-1(@15)                                  1447 06966000
         CLI   0(@14),C'0'                                         1447 06967000
         BL    @GL00077                                            1447 06968000
         LA    @14,SYNUNIT-1(@15)                                  1447 06969000
         CLI   0(@14),C'9'                                         1447 06970000
         BNH   @RT01447                                            1447 06971000
@GL00077 LH    @15,INDEX2                                          1447 06972000
         LA    @14,SYNUNIT-1(@15)                                  1447 06973000
         CLI   0(@14),C'@'                                         1447 06974000
         BE    @RT01447                                            1447 06975000
         LA    @14,SYNUNIT-1(@15)                                  1447 06976000
         CLI   0(@14),C'#'                                         1447 06977000
         BE    @RT01447                                            1447 06978000
         LA    @14,SYNUNIT-1(@15)                                  1447 06979000
         CLI   0(@14),C'$'                                         1447 06980000
         BE    @RT01447                                            1447 06981000
         TM    MEMBIT,B'10000000'                                  1447 06982000
         BNZ   @RF01447                                            1447 06983000
         LA    @14,SYNUNIT-1(@15)                                  1447 06984000
         CLI   0(@14),C'-'                                         1447 06985000
         BE    @RT01447                                            1447 06986000
         LA    @14,SYNUNIT-1(@15)                                  1447 06987000
         CLC   0(1,@14),TWLVZERO                                   1447 06988000
         BE    @RT01447                                            1447 06989000
*                ELSE                                              1449 06990000
*                  RISTATUS=BADITEM;                       /*@YL026UL*/ 06991000
@RF01447 MVC   RISTATUS(2),@CH00052                                1449 06992000
*            END;                                          /*@YL026UL*/ 06993000
@RT01447 LA    @15,1                                               1450 06994000
         AH    @15,INDEX2                                          1450 06995000
@DE01446 STH   @15,INDEX2                                          1450 06996000
         CR    @15,SEGEND                                          1450 06997000
         BNH   @DL01446                                            1450 06998000
*          ELSE                                                    1451 06999000
*            RISTATUS=BADITEM;                             /*@YL026UL*/ 07000000
*                                                                  1451 07001000
         B     @RC01445                                            1451 07002000
@RF01445 MVC   RISTATUS(2),@CH00052                                1451 07003000
*        /************************************************************/ 07004000
*        /*                                                  @YL026UL*/ 07005000
*        /* IF THE NAME MAY BE A VOLUME SERIAL NUMBER, THEN  @YL026UL*/ 07006000
*        /* ALLOW ANY CHARACTERS IN THE NAME.                @YL026UL*/ 07007000
*        /*                                                  @YL026UL*/ 07008000
*        /************************************************************/ 07009000
*        IF VOLID=YES  &  UNITINDX <= 6  &  WITHMEM=NO             1452 07010000
*          THEN                                                    1452 07011000
@RC01445 LA    @15,12                                              1452 07012000
         LR    @14,@15                                             1452 07013000
         MH    @14,PARMID                                          1452 07014000
         L     @01,WORKPTR                                         1452 07015000
         AL    @01,@CF01440                                        1452 07016000
         AL    @15,PARMPTR(@14,@01)                                1452 07017000
         TM    VOLID(@15),B'00001000'                              1452 07018000
         BNO   @RF01452                                            1452 07019000
         CH    UNITINDX,@CH00166                                   1452 07020000
         BH    @RF01452                                            1452 07021000
         TM    WITHMEM,B'10000000'                                 1452 07022000
         BNZ   @RF01452                                            1452 07023000
*            RISTATUS=0;                                   /*@YL026UL*/ 07024000
*                                                                  1453 07025000
         SLR   @15,@15                                             1453 07026000
         STH   @15,RISTATUS                                        1453 07027000
*        END NAMESCAN;                                     /*@YL026UL*/ 07028000
*                                                                  1454 07029000
*                                                                  1454 07030000
@EL00017 DS    0H                                                  1454 07031000
@EF00017 DS    0H                                                  1454 07032000
@ER00017 LM    @14,@12,@SA00017                                    1454 07033000
         BR    @14                                                 1454 07034000
*        END DSIDCHK;                                              1455 07035000
@EL00016 DS    0H                                                  1455 07036000
@EF00016 DS    0H                                                  1455 07037000
@ER00016 LM    @14,@04,@SA00016                                    1455 07038000
         LM    @06,@12,@SA00016+28                                 1455 07039000
         BR    @14                                                 1455 07040000
*/********************************************************************/ 07041000
*/*                                                                  */ 07042000
*/*  PROCEDURE NAME - GETSPACE                                       */ 07043000
*/*                                                                  */ 07044000
*/*  FUNCTION - THIS ROUTINE ALLOCATES SPACE FOR FUNCTION DATA       */ 07045000
*/*             TABLE (FDT) SCALAR DATA STRUCTURES, BASED UPON THE   */ 07046000
*/*             DATA TYPE AND DATA LIMITS SPECIFIED FOR THE PARAMETER*/ 07047000
*/*             BEING HANDLED.  THESE VALUES ARE TAKEN FROM THE      */ 07048000
*/*             COMMAND DESCRIPTOR.                                  */ 07049000
*/*                                                                  */ 07050000
*/*  INPUT -                                                         */ 07051000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 07052000
*/*          PARMID -  PARAMETER ID# OF CURRENT PARAMETER            */ 07053000
*/*          BLKLEFT - AMOUNT OF SPACE REMAINING IN LARGE BLOCK OF   */ 07054000
*/*                    STORAGE FROM WHICH SPACE FOR SCALAR DATA      */ 07055000
*/*                    STRUCTURES ARE ALLOCATED.                     */ 07056000
*/*          BLKPTR -  POINTER TO NEXT UNUSED AREA WHICH MAY BE      */ 07057000
*/*                    ALLOCATED FROM LARGE STORAGE AREA.            */ 07058000
*/*                                                                  */ 07059000
*/*  OUTPUT -                                                        */ 07060000
*/*          FUNCTION DATA TABLE POINTER VECTOR ENTRY                */ 07061000
*/*          SPACEAMT- AMOUNT OF STORAGE SPACE REQUIRED FOR STORAGE  */ 07062000
*/*                    OF A SINGLE SCALAR ITEM (AND ASSOCIATED ITEMS */ 07063000
*/*                    LIKE PASSWORD, LENGTH FIELDS, ETC)            */ 07064000
*/*          AMTTOGET- AMOUNT OF SPACE TO ALLOCATE FOR THE ENTIRE    */ 07065000
*/*                    SCALAR DATA STRUCTURE                         */ 07066000
*/*          BLKLEFT - SEE 'INPUT'                                   */ 07067000
*/*          DATAPTR - POINTER TO CURRENT SCALAR DATA STRUCTURE      */ 07068000
*/*          BLKPTR -  SEE 'INPUT'                                   */ 07069000
*/*          FDTPTR -  POINTER IN FDT USED FOR INDEXING TO THE SCALAR*/ 07070000
*/*                    DATA IN THE STRUCTURES BEING BUILT.           */ 07071000
*/*          ARRYPTR - POINTER TO INTERMEDIATE PTR VECTOR WHICH THEN */ 07072000
*/*                    POINTS TO THE SCALAR DATA STRUCTURE           */ 07073000
*/*          PTRLOC -  LOCATION OF FDT POINTER WHICH POINTS TO THE   */ 07074000
*/*                    SCALAR DATA STRUCTURE FOR A SCALAR LIST       */ 07075000
*/*                                                                  */ 07076000
*/********************************************************************/ 07077000
*GETSPACE:PROCEDURE;                                               1456 07078000
GETSPACE STM   @14,@12,@SA00018                                    1456 07079000
*        /************************************************************/ 07080000
*        /*                                                          */ 07081000
*        /*  ** GETSPACE **  ALLOCATE SPACE FOR FDT DATA ELEMENTS    */ 07082000
*        /*                                                          */ 07083000
*        /************************************************************/ 07084000
*                                                                  1457 07085000
*        /************************************************************/ 07086000
*        /*                                                          */ 07087000
*        /* COMPUTE THE SPACE REQUIRED FOR EACH SCALAR AND ITS       */ 07088000
*        /* ASSOCIATED DATA ITEMS (COUNT, LENGTH, ETC.)              */ 07089000
*        /*                                                          */ 07090000
*        /************************************************************/ 07091000
*        IF NUMBER=YES                                             1457 07092000
*          THEN                                                    1457 07093000
         LA    @02,12                                              1457 07094000
         LR    @15,@02                                             1457 07095000
         MH    @15,PARMID                                          1457 07096000
         L     @01,WORKPTR                                         1457 07097000
         AL    @01,@CF01440                                        1457 07098000
         AL    @02,PARMPTR(@15,@01)                                1457 07099000
         TM    NUMBER(@02),B'10000000'                             1457 07100000
         BNO   @RF01457                                            1457 07101000
*            SPACEAMT=0;                                           1458 07102000
         SLR   @02,@02                                             1458 07103000
         STH   @02,SPACEAMT                                        1458 07104000
*          ELSE                                                    1459 07105000
*            IF DSNAM=YES                                          1459 07106000
*              THEN                                                1459 07107000
         B     @RC01457                                            1459 07108000
@RF01457 LA    @02,12                                              1459 07109000
         LR    @15,@02                                             1459 07110000
         MH    @15,PARMID                                          1459 07111000
         L     @01,WORKPTR                                         1459 07112000
         AL    @01,@CF01440                                        1459 07113000
         AL    @02,PARMPTR(@15,@01)                                1459 07114000
         TM    DSNAM(@02),B'00100000'                              1459 07115000
         BNO   @RF01459                                            1459 07116000
*                SPACEAMT=LENGTH(PASSWORD)+LENGTH(MEMNAME)+        1460 07117000
*                         5*LENGTH(DSNAMELN);              /*@YL026UL*/ 07118000
         MVC   SPACEAMT(2),@CH00813                                1460 07119000
*              ELSE                                                1461 07120000
*                DO;                                               1461 07121000
         B     @RC01459                                            1461 07122000
@RF01459 DS    0H                                                  1462 07123000
*                SPACEAMT=LENGTH(CHARLN);                          1462 07124000
         LA    @02,1                                               1462 07125000
         STH   @02,SPACEAMT                                        1462 07126000
*                IF PWORDOPT=YES                           /*@YL026UL*/ 07127000
*                  THEN                                            1463 07128000
         LA    @15,12                                              1463 07129000
         LR    @14,@15                                             1463 07130000
         MH    @14,PARMID                                          1463 07131000
         L     @01,WORKPTR                                         1463 07132000
         AL    @01,@CF01440                                        1463 07133000
         AL    @15,PARMPTR(@14,@01)                                1463 07134000
         TM    PWORDOPT(@15),B'00000010'                           1463 07135000
         BNO   @RF01463                                            1463 07136000
*                    SPACEAMT=SPACEAMT+LENGTH(PASSWORD)+LENGTH(CHARLN); 07137000
         LA    @02,9(,@02)                                         1464 07138000
         STH   @02,SPACEAMT                                        1464 07139000
*                END;                                              1465 07140000
@RF01463 DS    0H                                                  1466 07141000
*        SPACEAMT=SPACEAMT+MAXLNGTH;                               1466 07142000
@RC01459 DS    0H                                                  1466 07143000
@RC01457 LA    @02,12                                              1466 07144000
         LR    @15,@02                                             1466 07145000
         MH    @15,PARMID                                          1466 07146000
         L     @01,WORKPTR                                         1466 07147000
         AL    @01,@CF01440                                        1466 07148000
         L     @15,PARMPTR(@15,@01)                                1466 07149000
         ALR   @02,@15                                             1466 07150000
         SLR   @14,@14                                             1466 07151000
         IC    @14,MAXLNGTH(,@02)                                  1466 07152000
         AH    @14,SPACEAMT                                        1466 07153000
         STH   @14,SPACEAMT                                        1466 07154000
*        IF LIST=YES                                               1467 07155000
*          THEN                                                    1467 07156000
         TM    LIST(@15),B'00001000'                               1467 07157000
         BNO   @RF01467                                            1467 07158000
*            DO;                                                   1468 07159000
*            IF SPACEAMT//2 ^= 0                                   1469 07160000
*              THEN                                                1469 07161000
         LR    @00,@14                                             1469 07162000
         SRDA  @00,32                                              1469 07163000
         D     @00,@CF00163                                        1469 07164000
         LTR   @00,@00                                             1469 07165000
         BZ    @RF01469                                            1469 07166000
*                SPACEAMT=SPACEAMT+1;                              1470 07167000
         LA    @14,1(,@14)                                         1470 07168000
         STH   @14,SPACEAMT                                        1470 07169000
*            AMTTOGET=SPACEAMT*MIN(4,LISTMAX)+FULLNGTH;            1471 07170000
*                                                                  1471 07171000
@RF01469 LA    @02,4                                               1471 07172000
         LA    @15,12                                              1471 07173000
         LR    @14,@15                                             1471 07174000
         MH    @14,PARMID                                          1471 07175000
         L     @01,WORKPTR                                         1471 07176000
         AL    @01,@CF01440                                        1471 07177000
         AL    @15,PARMPTR(@14,@01)                                1471 07178000
         SLR   @01,@01                                             1471 07179000
         IC    @01,LISTMAX(,@15)                                   1471 07180000
         CR    @01,@02                                             1471 07181000
         BNH   *+6                                                      07182000
         LR    @01,@02                                             1471 07183000
         MH    @01,SPACEAMT                                        1471 07184000
         ALR   @01,@02                                             1471 07185000
         ST    @01,AMTTOGET                                        1471 07186000
*            /********************************************************/ 07187000
*            /*                                                      */ 07188000
*            /* REQUEST SPACE FOR THE SCALAR LIST DATA STRUCTURE.    */ 07189000
*            /* SPACE IS OBTAINED EACH TIME A SCALAR LIST IS THE     */ 07190000
*            /* VALUE OF THE PARAMETER BEING SCANNED.                */ 07191000
*            /*                                                      */ 07192000
*            /********************************************************/ 07193000
*            CALL IDCSAGP0(GDTTBL,AMTTOGET,DATAPTR,POOLID,SETZERO);     07194000
         ST    GDTPTR,@AL00001                                     1472 07195000
         LA    @02,AMTTOGET                                        1472 07196000
         ST    @02,@AL00001+4                                      1472 07197000
         LA    @02,DATAPTR                                         1472 07198000
         ST    @02,@AL00001+8                                      1472 07199000
         LA    @02,POOLID                                          1472 07200000
         ST    @02,@AL00001+12                                     1472 07201000
         LA    @02,SETZERO                                         1472 07202000
         ST    @02,@AL00001+16                                     1472 07203000
         MVI   @AL00001+16,X'80'                                   1472 07204000
         L     @15,GDTGPL(,GDTPTR)                                 1472 07205000
         LA    @01,@AL00001                                        1472 07206000
         BALR  @14,@15                                             1472 07207000
*            RESPECIFY RTNREG RSTD;                                1473 07208000
*            TESTRC = RTNREG;                                      1474 07209000
         STH   RTNREG,TESTRC                                       1474 07210000
*            RESPECIFY RTNREG UNRSTD;                              1475 07211000
*                                                                  1475 07212000
*            END;                                                  1476 07213000
*                                                                  1476 07214000
*          /**********************************************************/ 07215000
*          /*                                                        */ 07216000
*          /* SPACE FOR SCALAR (NOT SCALAR LIST) DATA STRUCTURES IS  */ 07217000
*          /* ALLOCATED FROM A LARGE BLOCK OF SPACE ALREADY OBTAINED,*/ 07218000
*          /* RATHER THAN ISSUING A 'GET SPACE' REQUEST FOR EACH     */ 07219000
*          /* STRUCTURE.  IF SPACE IN THE BLOCK HAS ALL BEEN USED,   */ 07220000
*          /* ANOTHER LARGE BLOCK IS OBTAINED.                       */ 07221000
*          /*                                                        */ 07222000
*          /**********************************************************/ 07223000
*          ELSE                                                    1477 07224000
*            DO;                                                   1477 07225000
         B     @RC01467                                            1477 07226000
@RF01467 DS    0H                                                  1478 07227000
*            IF BLKLEFT-SPACEAMT < 0                               1478 07228000
*              THEN                                                1478 07229000
         L     @02,BLKLEFT                                         1478 07230000
         SH    @02,SPACEAMT                                        1478 07231000
         LTR   @02,@02                                             1478 07232000
         BNM   @RF01478                                            1478 07233000
*                DO;                                               1479 07234000
*                BLKLEFT='400'X;                                   1480 07235000
*                                                                  1480 07236000
         LA    @02,1024                                            1480 07237000
         ST    @02,BLKLEFT                                         1480 07238000
*                CALL IDCSAGP0(GDTTBL,BLKLEFT,BLKPTR,POOLID,SETZERO);   07239000
         ST    GDTPTR,@AL00001                                     1481 07240000
         LA    @02,BLKLEFT                                         1481 07241000
         ST    @02,@AL00001+4                                      1481 07242000
         LA    @02,BLKPTR                                          1481 07243000
         ST    @02,@AL00001+8                                      1481 07244000
         LA    @02,POOLID                                          1481 07245000
         ST    @02,@AL00001+12                                     1481 07246000
         LA    @02,SETZERO                                         1481 07247000
         ST    @02,@AL00001+16                                     1481 07248000
         MVI   @AL00001+16,X'80'                                   1481 07249000
         L     @15,GDTGPL(,GDTPTR)                                 1481 07250000
         LA    @01,@AL00001                                        1481 07251000
         BALR  @14,@15                                             1481 07252000
*                RESPECIFY RTNREG RSTD;                            1482 07253000
*                TESTRC = RTNREG;                                  1483 07254000
         STH   RTNREG,TESTRC                                       1483 07255000
*                RESPECIFY RTNREG UNRSTD;                          1484 07256000
*                                                                  1484 07257000
*                END;                                              1485 07258000
*              ELSE                                                1486 07259000
*                TESTRC=0;                                         1486 07260000
         B     @RC01478                                            1486 07261000
@RF01478 SLR   @02,@02                                             1486 07262000
         STH   @02,TESTRC                                          1486 07263000
*            DATAPTR=BLKPTR;                                       1487 07264000
@RC01478 L     @02,BLKPTR                                          1487 07265000
         ST    @02,DATAPTR                                         1487 07266000
*            BLKPTR=BLKPTR+SPACEAMT+(FULLNGTH-SPACEAMT//FULLNGTH); 1488 07267000
         LH    @15,SPACEAMT                                        1488 07268000
         LR    @14,@02                                             1488 07269000
         ALR   @14,@15                                             1488 07270000
         LR    @00,@15                                             1488 07271000
         SRDA  @00,32                                              1488 07272000
         D     @00,@CF00052                                        1488 07273000
         LCR   @00,@00                                             1488 07274000
         AL    @00,@CF00052                                        1488 07275000
         ALR   @14,@00                                             1488 07276000
         ST    @14,BLKPTR                                          1488 07277000
*            BLKLEFT=BLKLEFT-(BLKPTR-DATAPTR);                     1489 07278000
         SLR   @02,@14                                             1489 07279000
         AL    @02,BLKLEFT                                         1489 07280000
         ST    @02,BLKLEFT                                         1489 07281000
*            END;                                                  1490 07282000
*                                                                  1490 07283000
*        /************************************************************/ 07284000
*        /*                                                          */ 07285000
*        /* CHECK THAT THE SPACE WAS ALLOCATED PROPERLY, THEN STORE  */ 07286000
*        /* THE AREA PTR IN THE FDT.  IF THE SCALAR IS ASSOCIATED    */ 07287000
*        /* WITH A PARAMETER IN A REPEATED LIST, CALCULATE THE FDT   */ 07288000
*        /* LOCATION OF THE POINTER WHERE THE SPACE ADDRESS IS TO BE */ 07289000
*        /* STORED.                                                  */ 07290000
*        /*                                                          */ 07291000
*        /************************************************************/ 07292000
*        IF TESTRC ^= 0                                            1491 07293000
*          THEN                                                    1491 07294000
*                                                                  1491 07295000
@RC01467 ICM   @02,3,TESTRC                                        1491 07296000
         BZ    @RF01491                                            1491 07297000
*            CALL ERROR1(NOSPACE);                                 1492 07298000
*                                                                  1492 07299000
         LA    @01,@AL01492                                        1492 07300000
         BAL   @14,ERROR1                                          1492 07301000
*          ELSE                                                    1493 07302000
*            IF OCCURNUM < 2                                       1493 07303000
*              THEN                                                1493 07304000
         B     @RC01491                                            1493 07305000
@RF01491 LH    @02,PARMID                                          1493 07306000
         LR    @15,@02                                             1493 07307000
         MH    @15,@CH00038                                        1493 07308000
         L     @01,WORKPTR                                         1493 07309000
         AL    @01,@CF01440                                        1493 07310000
         L     @01,PARMPTR(@15,@01)                                1493 07311000
         CLC   OCCURNUM(3,@01),@CF00163+1                          1493 07312000
         BNL   @RF01493                                            1493 07313000
*                FDTPTR(PARMID)=DATAPTR;                           1494 07314000
         SLA   @02,2                                               1494 07315000
         L     @15,DATAPTR                                         1494 07316000
         L     @14,FDTADDR                                         1494 07317000
         ST    @15,FDTPTR-4(@02,@14)                               1494 07318000
*              ELSE                                                1495 07319000
*                DO;                                               1495 07320000
         B     @RC01493                                            1495 07321000
@RF01493 DS    0H                                                  1496 07322000
*                ARRYPTR=FDTPTR(PARMID);                           1496 07323000
*                                                                  1496 07324000
         LH    @05,PARMID                                          1496 07325000
         SLA   @05,2                                               1496 07326000
         L     @01,FDTADDR                                         1496 07327000
         L     ARRYPTR,FDTPTR-4(@05,@01)                           1496 07328000
*                CALL DSPLCALC(REPDEPTH);                          1497 07329000
*                                                                  1497 07330000
         LA    @05,REPDEPTH                                        1497 07331000
         ST    @05,@AL00001                                        1497 07332000
         LA    @01,@AL00001                                        1497 07333000
         BAL   @14,DSPLCALC                                        1497 07334000
*                REPPTR=DATAPTR;                                   1498 07335000
         LR    @05,ARRYPTR                                         1498 07336000
         ALR   @05,ARRYDSPL                                        1498 07337000
         MVC   REPPTR(4,@05),DATAPTR                               1498 07338000
*                IF LIST=YES                                       1499 07339000
*                  THEN                                            1499 07340000
         LH    @15,PARMID                                          1499 07341000
         MH    @15,@CH00038                                        1499 07342000
         L     @01,WORKPTR                                         1499 07343000
         AL    @01,@CF01440                                        1499 07344000
         L     @01,PARMPTR(@15,@01)                                1499 07345000
         TM    LIST(@01),B'00001000'                               1499 07346000
         BNO   @RF01499                                            1499 07347000
*                    PTRLOC=ADDR(REPPTR);                          1500 07348000
         ST    @05,PTRLOC                                          1500 07349000
*                END;                                              1501 07350000
@RF01499 DS    0H                                                  1502 07351000
*        SPACELFT=AMTTOGET-FULLNGTH-SPACEAMT;                      1502 07352000
*                                                                  1502 07353000
@RC01493 DS    0H                                                  1502 07354000
@RC01491 L     @02,AMTTOGET                                        1502 07355000
         SL    @02,@CF00052                                        1502 07356000
         SH    @02,SPACEAMT                                        1502 07357000
         STH   @02,SPACELFT                                        1502 07358000
*        END GETSPACE;                                             1503 07359000
@EL00018 DS    0H                                                  1503 07360000
@EF00018 DS    0H                                                  1503 07361000
@ER00018 LM    @14,@12,@SA00018                                    1503 07362000
         BR    @14                                                 1503 07363000
*/********************************************************************/ 07364000
*/*                                                                  */ 07365000
*/*  PROCEDURE NAME - MORSPACE                                       */ 07366000
*/*                                                                  */ 07367000
*/*  FUNCTION - THIS ROUTINE ALLOCATES ADDITIONAL SPACE FOR AN FDT   */ 07368000
*/*             SCALAR LIST DATA STRUCTURE.                          */ 07369000
*/*                                                                  */ 07370000
*/*  INPUT -                                                         */ 07371000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 07372000
*/*          AMTTOGET- AMOUNT OF SPACE LAST ALLOCATED FOR THIS       */ 07373000
*/*                    SCALAR LIST DATA STRUCTURE                    */ 07374000
*/*          SPACELFT- UNUSED SPACE REMAINING FROM LAST ALLOCATION   */ 07375000
*/*          SPACEAMT- AMOUNT OF SPACE REQUIRED FOR EACH LIST ELEMENT*/ 07376000
*/*                    IN THE DATA STRUCTURE                         */ 07377000
*/*          DATAPTR - POINTER TO CURRENT DATA STRUCTURE LOCATION    */ 07378000
*/*                                                                  */ 07379000
*/*  OUTPUT -                                                        */ 07380000
*/*          FUNCTION DATA TABLE POINTER VECTOR ENTRY                */ 07381000
*/*          AMTTOGET- NEW AMOUNT OF SPACE TO BE ALLOCATED, WHICH    */ 07382000
*/*                    ALLOWS FOR LARGER SCALAR LIST DATA STRUCTURE  */ 07383000
*/*          LISTADDR- LOCATION OF NEW BLOCK OF SPACE                */ 07384000
*/*          SPACELFT- AMOUNT OF SPACE REMAINING IN NEW STORAGE BLOCK*/ 07385000
*/*                                                                  */ 07386000
*/********************************************************************/ 07387000
*MORSPACE:PROCEDURE;                                               1504 07388000
MORSPACE STM   @14,@12,@SA00019                                    1504 07389000
*        /************************************************************/ 07390000
*        /*                                                          */ 07391000
*        /* 'MORSPACE' ROUTINE DATA DEFINITIONS                      */ 07392000
*        /*                                                          */ 07393000
*        /************************************************************/ 07394000
*                                                                  1505 07395000
*        DCL OLDPTR   PTR(31);         /*PTR TO DATA TO BE MOVED FROM   07396000
*                                        DATA BLK THAT WAS TOO SMALL */ 07397000
*        DCL FREEPTR  PTR(31);         /*PTR TO OLD BLOCK OF SPACE 1506 07398000
*                                        TO BE FREED UP AFTER ITS  1506 07399000
*                                        DATA HAS BEEN COPIED.       */ 07400000
*        DCL NEWPTR   PTR(31);         /*PTR TO NEWLY ALLOCATED,   1507 07401000
*                                        LARGER DATA BLOCK           */ 07402000
*        DCL MOVELEN  FIXED(15);       /*AMOUNT OF DATA TO BE MOVED     07403000
*                                        IN A SINGLE DATA MOVE       */ 07404000
*        DCL AMTUSED  FIXED(15);       /*AMOUNT OF OLD DATA BLOCK THAT  07405000
*                                        WAS 'STORED INTO' BEFORE  1509 07406000
*                                        SPACE RAN OUT.              */ 07407000
*        /************************************************************/ 07408000
*        /*                                                          */ 07409000
*        /*  ** MORSPACE **  ALLOCATE MORE SPACE FOR FDT DATA        */ 07410000
*        /*                                                          */ 07411000
*        /************************************************************/ 07412000
*        IF GDTDBG = NULLPTR                                       1510 07413000
*          THEN;                                                   1510 07414000
         ICM   @02,15,GDTDBG(GDTPTR)                               1510 07415000
         BZ    @RT01510                                            1510 07416000
*          ELSE                                                    1512 07417000
*            CALL IDCDB010(GDTTBL,'RIMC');                         1512 07418000
*                                                                  1512 07419000
         ST    GDTPTR,@AL00001                                     1512 07420000
         LA    @02,@CC01244                                        1512 07421000
         ST    @02,@AL00001+4                                      1512 07422000
         MVI   @AL00001+4,X'80'                                    1512 07423000
         L     @15,GDTDBG(,GDTPTR)                                 1512 07424000
         LA    @01,@AL00001                                        1512 07425000
         BALR  @14,@15                                             1512 07426000
*        /************************************************************/ 07427000
*        /*                                                          */ 07428000
*        /* COMPUTE AMOUNT OF SPACE USED IN OLD DATA BLOCK AND SIZE  */ 07429000
*        /* OF THE NEW, LARGER BLOCK TO BE OBTAINED.                 */ 07430000
*        /*                                                          */ 07431000
*        /************************************************************/ 07432000
*        AMTUSED=AMTTOGET-SPACELFT-SPACEAMT;                       1513 07433000
@RT01510 LH    @02,SPACEAMT                                        1513 07434000
         L     @15,AMTTOGET                                        1513 07435000
         LR    AMTUSED,@15                                         1513 07436000
         SH    AMTUSED,SPACELFT                                    1513 07437000
         SLR   AMTUSED,@02                                         1513 07438000
*        OLDPTR=DATAPTR;                                           1514 07439000
         L     @05,DATAPTR                                         1514 07440000
         ST    @05,OLDPTR                                          1514 07441000
*        FREEPTR=DATAPTR;                                          1515 07442000
         ST    @05,FREEPTR                                         1515 07443000
*        AMTTOGET=AMTTOGET+SPACEAMT*2;                             1516 07444000
*                                                                  1516 07445000
         ALR   @02,@02                                             1516 07446000
         ALR   @15,@02                                             1516 07447000
         ST    @15,AMTTOGET                                        1516 07448000
*        /************************************************************/ 07449000
*        /*                                                          */ 07450000
*        /* REQUEST THE DESIRED SPACE.  IF OBTAINED OKAY, SET UP     */ 07451000
*        /* POINTER TO THE AREA.                                     */ 07452000
*        /*                                                          */ 07453000
*        /************************************************************/ 07454000
*                                                                  1517 07455000
*        CALL IDCSAGP0(GDTTBL,AMTTOGET,DATAPTR,POOLID,SETZERO);    1517 07456000
         ST    GDTPTR,@AL00001                                     1517 07457000
         LA    @05,AMTTOGET                                        1517 07458000
         ST    @05,@AL00001+4                                      1517 07459000
         LA    @05,DATAPTR                                         1517 07460000
         ST    @05,@AL00001+8                                      1517 07461000
         LA    @05,POOLID                                          1517 07462000
         ST    @05,@AL00001+12                                     1517 07463000
         LA    @05,SETZERO                                         1517 07464000
         ST    @05,@AL00001+16                                     1517 07465000
         MVI   @AL00001+16,X'80'                                   1517 07466000
         L     @15,GDTGPL(,GDTPTR)                                 1517 07467000
         LA    @01,@AL00001                                        1517 07468000
         BALR  @14,@15                                             1517 07469000
*        RESPECIFY RTNREG RSTD;                                    1518 07470000
*        TESTRC = RTNREG;                                          1519 07471000
         STH   RTNREG,TESTRC                                       1519 07472000
*        RESPECIFY RTNREG UNRSTD;                                  1520 07473000
*                                                                  1520 07474000
*        IF TESTRC ^= 0                                            1521 07475000
*          THEN                                                    1521 07476000
*                                                                  1521 07477000
         LH    @05,TESTRC                                          1521 07478000
         LTR   @05,@05                                             1521 07479000
         BZ    @RF01521                                            1521 07480000
*            CALL ERROR1(NOSPACE);                                 1522 07481000
*                                                                  1522 07482000
         LA    @01,@AL01522                                        1522 07483000
         BAL   @14,ERROR1                                          1522 07484000
*          ELSE                                                    1523 07485000
*DOGRP107:   DO;                                                   1523 07486000
         B     @RC01521                                            1523 07487000
@RF01521 DS    0H                                                  1523 07488000
DOGRP107 DS    0H                                                  1524 07489000
*            IF OCCURNUM < 2                                       1524 07490000
*              THEN                                                1524 07491000
         LH    @05,PARMID                                          1524 07492000
         LR    @02,@05                                             1524 07493000
         MH    @02,@CH00038                                        1524 07494000
         L     @01,WORKPTR                                         1524 07495000
         AL    @01,@CF01440                                        1524 07496000
         L     @02,PARMPTR(@02,@01)                                1524 07497000
         CLC   OCCURNUM(3,@02),@CF00163+1                          1524 07498000
         BNL   @RF01524                                            1524 07499000
*                FDTPTR(PARMID)=DATAPTR;                           1525 07500000
         SLA   @05,2                                               1525 07501000
         L     @02,DATAPTR                                         1525 07502000
         L     @01,FDTADDR                                         1525 07503000
         ST    @02,FDTPTR-4(@05,@01)                               1525 07504000
*              ELSE                                                1526 07505000
*                LISTADDR=DATAPTR;                                 1526 07506000
         B     @RC01524                                            1526 07507000
@RF01524 L     @05,PTRLOC                                          1526 07508000
         MVC   LISTADDR(4,@05),DATAPTR                             1526 07509000
*            SPACELFT=AMTTOGET-AMTUSED-SPACEAMT;                   1527 07510000
*                                                                  1527 07511000
@RC01524 L     @02,AMTTOGET                                        1527 07512000
         SLR   @02,AMTUSED                                         1527 07513000
         SH    @02,SPACEAMT                                        1527 07514000
         STH   @02,SPACELFT                                        1527 07515000
*            /********************************************************/ 07516000
*            /*                                                      */ 07517000
*            /* MOVE DATA FROM THE OLD, SMALLER DATA BLOCK INTO THE  */ 07518000
*            /* NEW DATA BLOCK.  THEN FREE THE OLD DATA BLOCK.       */ 07519000
*            /*                                                      */ 07520000
*            /********************************************************/ 07521000
*            NEWPTR=DATAPTR;                                       1528 07522000
         L     NEWPTR,DATAPTR                                      1528 07523000
*            DO WHILE(AMTUSED > 0);                        /*@YL026UL*/ 07524000
         B     @DE01529                                            1529 07525000
@DL01529 DS    0H                                                  1530 07526000
*              MOVELEN=MIN(256,AMTUSED);                   /*@YL026UL*/ 07527000
         LA    MOVELEN,256                                         1530 07528000
         CR    MOVELEN,AMTUSED                                     1530 07529000
         BNH   *+6                                                      07530000
         LR    MOVELEN,AMTUSED                                     1530 07531000
*              NEWPTR->DATABLK(1:MOVELEN)=                         1531 07532000
*                OLDPTR->DATABLK(1:MOVELEN);               /*@YL026UL*/ 07533000
         LR    @15,MOVELEN                                         1531 07534000
         BCTR  @15,0                                               1531 07535000
         L     @14,OLDPTR                                          1531 07536000
         EX    @15,@SM01497                                        1531 07537000
*              NEWPTR=NEWPTR+MOVELEN;                      /*@YL026UL*/ 07538000
         ALR   NEWPTR,MOVELEN                                      1532 07539000
*              OLDPTR=OLDPTR+MOVELEN;                      /*@YL026UL*/ 07540000
         ALR   @14,MOVELEN                                         1533 07541000
         ST    @14,OLDPTR                                          1533 07542000
*              AMTUSED=AMTUSED-MOVELEN;                    /*@YL026UL*/ 07543000
         SLR   AMTUSED,MOVELEN                                     1534 07544000
*            END;                                          /*@YL026UL*/ 07545000
*                                                                  1535 07546000
@DE01529 LTR   AMTUSED,AMTUSED                                     1535 07547000
         BP    @DL01529                                            1535 07548000
*            CALL IDCSAFS0(GDTTBL,FREEPTR);                        1536 07549000
*                                                                  1536 07550000
         ST    GDTPTR,@AL00001                                     1536 07551000
         LA    @02,FREEPTR                                         1536 07552000
         ST    @02,@AL00001+4                                      1536 07553000
         L     @15,GDTFSP(,GDTPTR)                                 1536 07554000
         LA    @01,@AL00001                                        1536 07555000
         BALR  @14,@15                                             1536 07556000
*            END DOGRP107;                                         1537 07557000
*                                                                  1537 07558000
*        END MORSPACE;                                             1538 07559000
*                                                                  1538 07560000
*                                                                  1538 07561000
@EL00019 DS    0H                                                  1538 07562000
@EF00019 DS    0H                                                  1538 07563000
@ER00019 LM    @14,@12,@SA00019                                    1538 07564000
         BR    @14                                                 1538 07565000
*        END BUILDFDT;                                     /*@YL026UL*/ 07566000
         B     @EL00014                                            1539 07567000
*/********************************************************************/ 07568000
*/*                                                                  */ 07569000
*/*  PROCEDURE NAME - INREPEAT                                       */ 07570000
*/*                                                                  */ 07571000
*/*  FUNCTION - THIS ROUTINE IS INVOKED WHEN THE END OF ONE OF THE   */ 07572000
*/*             SUBLISTS OF A REPEATED SUBPARAMETER LIST HAS BEEN    */ 07573000
*/*             REACHED.  DEFAULTS ARE APPLIED TO THE SUBLIST JUST   */ 07574000
*/*             COMPLETED, AND SEMANTIC CHECKING IS PERFORMED ON IT. */ 07575000
*/*             CHECKING IS THEN DONE TO SEE WHETHER ANOTHER SUBLIST */ 07576000
*/*             FOLLOWS OR WHETHER THIS WAS THE LAST OF THE SUBLISTS */ 07577000
*/*             AT THIS LEVEL OF REPEATED SUBLIST NESTING.  COUNTS   */ 07578000
*/*             INDICATING CURRENT SCAN POSITION AND THE SUBLIST     */ 07579000
*/*             OCCURRENCE TOTAL ARE ALSO UPDATED AT THIS TIME.      */ 07580000
*/*                                                                  */ 07581000
*/*  INPUT -                                                         */ 07582000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 07583000
*/*          SUPERID - PARAMETER ID# OF THE PARAMETER WHOSE REPEATED */ 07584000
*/*                    SUBLISTS ARE BEING SCANNED                    */ 07585000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/ 07586000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 07587000
*/*                    CODE WHEN AN ERROR IS FOUND.                  */ 07588000
*/*          CHAR1 -   MOST RECENTLY EXTRACTED INPUT CHARACTER       */ 07589000
*/*          REPCOUNT- NUMBER OF REPETITIONS OF THIS PARAMETER'S     */ 07590000
*/*                    SUBLIST FOUND THUS FAR                        */ 07591000
*/*          REPLIMIT- MAXIMUM REPETITIONS ALLOWED OF THIS PARM'S    */ 07592000
*/*                    SUBPARAMETER LIST                             */ 07593000
*/*          REPDEPTH- LEVEL OF REPEATED SUBLIST NESTING AT WHICH    */ 07594000
*/*                    SCANNING IS CURRENTLY TAKING PLACE            */ 07595000
*/*          PARMLVL - LEVEL OF SUBPARAMETER LIST NESTING AT WHICH   */ 07596000
*/*                    SCANNING IS CURRENTLY TAKING PLACE            */ 07597000
*/*                                                                  */ 07598000
*/*  OUTPUT -                                                        */ 07599000
*/*          PARMID -  PARAMETER ID# OF PARAMETER WHOSE REPEATED     */ 07600000
*/*                    SUBLISTS ARE BEING SCANNED.                   */ 07601000
*/*          PARMFLAG- FLAGS IN 'PARMINFO'; PARMFLAG(N) IS   @YL026UL*/ 07602000
*/*                    SET 'ON' WHEN THE PARM WHOSE ID#=N    @YL026UL*/ 07603000
*/*                    IS INPUT.                             @YL026UL*/ 07604000
*/*          SUBSYET - FLAG SET 'ON' WHEN AT LEAST 1 SUBPARAMETER    */ 07605000
*/*                    HAS BEEN FOUND IN CURRENT SUBPARM. LIST       */ 07606000
*/*          REPCOUNT- SEE 'INPUT'                                   */ 07607000
*/*          ARRYPTR - POINTER TO FDT POINTER VECTOR                 */ 07608000
*/*          PPARMCNT- NUMBER OF POSITIONAL PARAMETERS FOUND IN      */ 07609000
*/*                    CURRENT SUBPARAMETER LIST.                    */ 07610000
*/*          PARMLVL - SEE 'INPUT'                                   */ 07611000
*/*          FUNCTION DATA TABLE DATA ENTRY                          */ 07612000
*/*                                                                  */ 07613000
*/********************************************************************/ 07614000
*INREPEAT:PROCEDURE;                                               1540 07615000
INREPEAT STM   @14,@04,@SA00020                                    1540 07616000
         STM   @06,@12,@SA00020+28                                 1540 07617000
*        /************************************************************/ 07618000
*        /*                                                          */ 07619000
*        /* INREPEAT PROCEDURE DATA DEFINITIONS                      */ 07620000
*        /*                                                          */ 07621000
*        /************************************************************/ 07622000
*                                                                  1541 07623000
*        /* STATIC ERROR MESSAGE CODES                               */ 07624000
*        DCL REPERR   FIXED(31)        /*TOO MANY REPEATED SUBLISTS  */ 07625000
*                     CONSTANT(19);                                1541 07626000
*                                                                  1541 07627000
*        DCL SUBOCCUR FIXED(31);       /*NUMBER OF TIMES A PARAMETER    07628000
*                                        IN A REPEATED SUBLIST MAY 1542 07629000
*                                        APPEAR.                     */ 07630000
*          /**********************************************************/ 07631000
*          /*                                                        */ 07632000
*          /*  ** INREPEAT **  HANDLE REPEATED SUBLIST END           */ 07633000
*          /*                                                        */ 07634000
*          /**********************************************************/ 07635000
*          IF GDTDBG = NULLPTR                                     1543 07636000
*            THEN;                                                 1543 07637000
         ICM   @04,15,GDTDBG(GDTPTR)                               1543 07638000
         BZ    @RT01543                                            1543 07639000
*            ELSE                                                  1545 07640000
*              CALL IDCDB010(GDTTBL,'RIIR');                       1545 07641000
*                                                                  1545 07642000
         ST    GDTPTR,@AL00001                                     1545 07643000
         LA    @04,@CC01253                                        1545 07644000
         ST    @04,@AL00001+4                                      1545 07645000
         MVI   @AL00001+4,X'80'                                    1545 07646000
         L     @15,GDTDBG(,GDTPTR)                                 1545 07647000
         LA    @01,@AL00001                                        1545 07648000
         BALR  @14,@15                                             1545 07649000
*          /**********************************************************/ 07650000
*          /*                                                        */ 07651000
*          /* APPLY DEFAULTS AND PERFORM SEMANTIC CHECKING ON THE    */ 07652000
*          /* REPEATED SUBLIST JUST FINISHED.                        */ 07653000
*          /*                                                        */ 07654000
*          /**********************************************************/ 07655000
*                                                                  1546 07656000
*          CALL DEFAULTS;                                          1546 07657000
@RT01543 BAL   @14,DEFAULTS                                        1546 07658000
*          CALL NEEDNOTS;                                          1547 07659000
         BAL   @14,NEEDNOTS                                        1547 07660000
*          CALL SCANSEP(YES);                                      1548 07661000
*                                                                  1548 07662000
         LA    @01,@AL01548                                        1548 07663000
         BAL   @14,SCANSEP                                         1548 07664000
*          IF RISTATUS^=0 | ONEREP(REPDEPTH)=YES                   1549 07665000
*            THEN                                                  1549 07666000
         ICM   @04,3,RISTATUS                                      1549 07667000
         BNZ   @RT01549                                            1549 07668000
         LH    @04,REPDEPTH                                        1549 07669000
         LA    @02,ONEREP-1(@04)                                   1549 07670000
         TM    0(@02),B'10000000'                                  1549 07671000
         BNO   @RF01549                                            1549 07672000
@RT01549 DS    0H                                                  1550 07673000
*              DO;                                                 1550 07674000
*              REPDEPTH=REPDEPTH-1;                                1551 07675000
         LH    @04,REPDEPTH                                        1551 07676000
         BCTR  @04,0                                               1551 07677000
         STH   @04,REPDEPTH                                        1551 07678000
*              PARMLVL=PARMLVL-1;                                  1552 07679000
         LH    @04,PARMLVL                                         1552 07680000
         BCTR  @04,0                                               1552 07681000
         STH   @04,PARMLVL                                         1552 07682000
*              RETURN;                                             1553 07683000
@EL00020 DS    0H                                                  1553 07684000
@EF00020 DS    0H                                                  1553 07685000
@ER00020 LM    @14,@04,@SA00020                                    1553 07686000
         LM    @06,@12,@SA00020+28                                 1553 07687000
         BR    @14                                                 1553 07688000
*              END;                                                1554 07689000
*                                                                  1554 07690000
*          PARMID=SUPERID(PARMLVL);                                1555 07691000
*                                                                  1555 07692000
@RF01549 LH    @04,PARMLVL                                         1555 07693000
         ALR   @04,@04                                             1555 07694000
         LH    @04,SUPERID-2(@04)                                  1555 07695000
         STH   @04,PARMID                                          1555 07696000
*          /**********************************************************/ 07697000
*          /*                                                        */ 07698000
*          /* RESET PARAMETER OCCURRENCE FLAGS FOR PARAMETERS IN THE */ 07699000
*          /* SUBLIST JUST COMPLETED.                                */ 07700000
*          /*                                                        */ 07701000
*          /**********************************************************/ 07702000
*          DO LISTINDX=1 TO MAXID;                                 1556 07703000
         LA    @04,1                                               1556 07704000
         B     @DE01556                                            1556 07705000
@DL01556 DS    0H                                                  1557 07706000
*            IF PARMPTR(LISTINDX) ^= NULLPTR                       1557 07707000
*              THEN                                                1557 07708000
         LR    @02,@04                                             1557 07709000
         MH    @02,@CH00038                                        1557 07710000
         L     @01,WORKPTR                                         1557 07711000
         AL    @01,@CF01440                                        1557 07712000
         L     @02,PARMPTR(@02,@01)                                1557 07713000
         LTR   @02,@02                                             1557 07714000
         BZ    @RF01557                                            1557 07715000
*                DO;                                               1558 07716000
*                  OLDERID2 = NEWERID2;                            1559 07717000
         L     @02,GDTTR2(,GDTPTR)                                 1559 07718000
         MVC   @TS00001(95),NEWERID2(@02)                          1559 07719000
         MVC   OLDERID2(95,@02),@TS00001                           1559 07720000
*                  NEWID2='RI35';                                  1560 07721000
         MVC   NEWID2(4,@02),@CC01254                              1560 07722000
*                  TESTID=LISTINDX;                                1561 07723000
         LH    @02,LISTINDX                                        1561 07724000
         LR    TESTID,@02                                          1561 07725000
*                  DO WHILE(TESTID^=0);                            1562 07726000
         B     @DE01562                                            1562 07727000
@DL01562 DS    0H                                                  1563 07728000
*                    IF SUPRPARM(TESTID)=PARMID                    1563 07729000
*                      THEN                                        1563 07730000
         L     @02,WORKPTR                                         1563 07731000
         LA    @15,12                                              1563 07732000
         LR    @01,TESTID                                          1563 07733000
         MR    @00,@15                                             1563 07734000
         AL    @01,@CF01441                                        1563 07735000
         LH    @14,SUPRPARM-8(@01,@02)                             1563 07736000
         CH    @14,PARMID                                          1563 07737000
         BNE   @RF01563                                            1563 07738000
*                        PARMFLAG(LISTINDX)=0;                     1564 07739000
         MH    @15,LISTINDX                                        1564 07740000
         SLR   @14,@14                                             1564 07741000
         BCTR  @02,0                                               1564 07742000
         BCTR  @02,0                                               1564 07743000
         STC   @14,PARMFLAG-10(@15,@02)                            1564 07744000
*                    TESTID=SUPRPARM(TESTID);                      1565 07745000
@RF01563 LR    @02,TESTID                                          1565 07746000
         MH    @02,@CH00038                                        1565 07747000
         L     @01,WORKPTR                                         1565 07748000
         AL    @01,@CF01441                                        1565 07749000
         LH    @02,SUPRPARM-8(@02,@01)                             1565 07750000
         LR    TESTID,@02                                          1565 07751000
*                  END;                                            1566 07752000
@DE01562 LTR   TESTID,TESTID                                       1566 07753000
         BNZ   @DL01562                                            1566 07754000
*                END;                                              1567 07755000
*          END;                                                    1568 07756000
*                                                                  1568 07757000
@RF01557 LA    @04,1                                               1568 07758000
         AH    @04,LISTINDX                                        1568 07759000
@DE01556 STH   @04,LISTINDX                                        1568 07760000
         L     @02,DESCPTR                                         1568 07761000
         CH    @04,MAXID(,@02)                                     1568 07762000
         BNH   @DL01556                                            1568 07763000
*          /**********************************************************/ 07764000
*          /*                                                        */ 07765000
*          /* IF ANOTHER SUBLIST FOLLOWS, BYPASS DELIMITERS PREPARING*/ 07766000
*          /* TO SCAN NEW SUBLIST AND UPDATE LIST OCCURRENCE COUNTS. */ 07767000
*          /* ALSO CHECK TO BE SURE THAT TOO MANY SUBLISTS HAVE NOT  */ 07768000
*          /* BEEN INPUT.                                            */ 07769000
*          /*                                                        */ 07770000
*          /**********************************************************/ 07771000
*          IF CHAR1=OPENING                                        1569 07772000
*            THEN                                                  1569 07773000
         CLI   CHAR1,C'('                                          1569 07774000
         BNE   @RF01569                                            1569 07775000
*DOGRP108:     DO;                                                 1570 07776000
*                                                                  1570 07777000
DOGRP108 DS    0H                                                  1571 07778000
*                CALL NEXTCHAR;                                    1571 07779000
         BAL   @14,NEXTCHAR                                        1571 07780000
*                CALL SCANSEP(NO);                                 1572 07781000
*                                                                  1572 07782000
         LA    @01,@AL01572                                        1572 07783000
         BAL   @14,SCANSEP                                         1572 07784000
*                SUBSYET=NO;                                       1573 07785000
         NI    SUBSYET,B'11101111'                                 1573 07786000
*                REPCOUNT(REPDEPTH)=REPCOUNT(REPDEPTH)+1;          1574 07787000
         LH    @04,REPDEPTH                                        1574 07788000
         ALR   @04,@04                                             1574 07789000
         LA    @02,1                                               1574 07790000
         AH    @02,REPCOUNT-2(@04)                                 1574 07791000
         STH   @02,REPCOUNT-2(@04)                                 1574 07792000
*                IF REPCOUNT(REPDEPTH) > REPLIMIT(REPDEPTH)        1575 07793000
*                  THEN                                            1575 07794000
*                                                                  1575 07795000
         CH    @02,REPLIMIT-2(@04)                                 1575 07796000
         BNH   @RF01575                                            1575 07797000
*                    CALL ERROR1(REPERR);                          1576 07798000
*                                                                  1576 07799000
         LA    @01,@AL01576                                        1576 07800000
         BAL   @14,ERROR1                                          1576 07801000
*                  ELSE                                            1577 07802000
*DOGRP109:           DO;                                           1577 07803000
*                                                                  1577 07804000
         B     @RC01575                                            1577 07805000
@RF01575 DS    0H                                                  1577 07806000
DOGRP109 DS    0H                                                  1578 07807000
*                    /************************************************/ 07808000
*                    /*                                              */ 07809000
*                    /* IF THE CURRENT REPEATED LIST IS NOT NESTED   */ 07810000
*                    /* WITHIN ANY OTHER REPEATED SUBLIST, THEN A    */ 07811000
*                    /* LIST OF POINTER BLOCKS IS BEING MAINTAINED   */ 07812000
*                    /* TO POINT TO SCALAR DATA OF PARAMETERS WITHIN */ 07813000
*                    /* THIS REPEATED SUBLIST.  ALLOCATE ANOTHER     */ 07814000
*                    /* BLOCK OF POINTERS FOR EACH SUBPARM IN THE    */ 07815000
*                    /* SUBLIST IF ENOUGH REPETITIONS OF THE SUBLIST */ 07816000
*                    /* HAVE OCCURRED TO REQUIRE THIS.               */ 07817000
*                    /*                                              */ 07818000
*                    /************************************************/ 07819000
*                    SUBOCCUR=REPMAX;                              1578 07820000
         LA    @04,12                                              1578 07821000
         LR    @02,@04                                             1578 07822000
         MH    @02,PARMID                                          1578 07823000
         L     @01,WORKPTR                                         1578 07824000
         AL    @01,@CF01440                                        1578 07825000
         AL    @04,PARMPTR(@02,@01)                                1578 07826000
         SLR   @02,@02                                             1578 07827000
         IC    @02,REPMAX(,@04)                                    1578 07828000
         ST    @02,SUBOCCUR                                        1578 07829000
*                    IF REPDEPTH=1 &                               1579 07830000
*                       REPCOUNT(REPDEPTH)//(VECTRSIZ-1)=1         1579 07831000
*                      THEN                                        1579 07832000
         LH    @04,REPDEPTH                                        1579 07833000
         LA    @02,1                                               1579 07834000
         CR    @04,@02                                             1579 07835000
         BNE   @RF01579                                            1579 07836000
         ALR   @04,@04                                             1579 07837000
         LH    @00,REPCOUNT-2(@04)                                 1579 07838000
         SRDA  @00,32                                              1579 07839000
         D     @00,@CF00042                                        1579 07840000
         CR    @00,@02                                             1579 07841000
         BNE   @RF01579                                            1579 07842000
*DOLOOP17:               DO VLISTID=1 TO MAXID WHILE(RISTATUS=0);  1580 07843000
DOLOOP17 LA    @04,1                                               1580 07844000
         B     @DE01580                                            1580 07845000
@DL01580 SLR   @02,@02                                             1580 07846000
         CH    @02,RISTATUS                                        1580 07847000
         BNE   @DC01580                                            1580 07848000
*                          IF PARMPTR(VLISTID) ^= NULLPTR &        1581 07849000
*                             PARMPTR(VLISTID)->OCCURNUM = SUBOCCUR     07850000
*                            THEN                                  1581 07851000
         MH    @04,@CH00038                                        1581 07852000
         L     @01,WORKPTR                                         1581 07853000
         AL    @01,@CF01440                                        1581 07854000
         L     @04,PARMPTR(@04,@01)                                1581 07855000
         CR    @04,@02                                             1581 07856000
         BE    @RF01581                                            1581 07857000
         SLR   @02,@02                                             1581 07858000
         ICM   @02,7,OCCURNUM(@04)                                 1581 07859000
         C     @02,SUBOCCUR                                        1581 07860000
         BNE   @RF01581                                            1581 07861000
*DOGRP111:                     DO;                                 1582 07862000
DOGRP111 DS    0H                                                  1583 07863000
*                                TESTID=VLISTID;                   1583 07864000
*                                                                  1583 07865000
         LH    TESTID,VLISTID                                      1583 07866000
*                                /************************************/ 07867000
*                                /*                                  */ 07868000
*                                /* DETERMINE WHETHER THIS PARAMETER */ 07869000
*                                /* IS ONE OF THE PARM'S NEEDING MORE*/ 07870000
*                                /* DATA POINTERS & IF SO ADD ANOTHER*/ 07871000
*                                /* BLOCK OF POINTERS TO THE LIST.   */ 07872000
*                                /*                                  */ 07873000
*                                /************************************/ 07874000
*DOLOOP18:                       DO WHILE(TESTID^=0 & RISTATUS=0); 1584 07875000
DOLOOP18 B     @DE01584                                            1584 07876000
@DL01584 DS    0H                                                  1585 07877000
*                                  IF SUPRPARM(TESTID) = PARMID    1585 07878000
*                                    THEN                          1585 07879000
         LR    @02,TESTID                                          1585 07880000
         MH    @02,@CH00038                                        1585 07881000
         L     @01,WORKPTR                                         1585 07882000
         AL    @01,@CF01441                                        1585 07883000
         LH    @02,SUPRPARM-8(@02,@01)                             1585 07884000
         CH    @02,PARMID                                          1585 07885000
         BNE   @RF01585                                            1585 07886000
*                                      DO;                         1586 07887000
*                                        ARRYPTR=FDTPTR(VLISTID);  1587 07888000
         LH    @15,VLISTID                                         1587 07889000
         SLA   @15,2                                               1587 07890000
         L     @01,FDTADDR                                         1587 07891000
         L     ARRYPTR,FDTPTR-4(@15,@01)                           1587 07892000
*                                        DO WHILE(VECTRPTR ^= 0);  1588 07893000
         B     @DE01588                                            1588 07894000
@DL01588 DS    0H                                                  1589 07895000
*                                          ARRYPTR=VECTRPTR;       1589 07896000
         LR    @15,ARRYPTR                                         1589 07897000
         AH    @15,VECTRLEN                                        1589 07898000
         L     @15,VECTRPTR(,@15)                                  1589 07899000
         LR    ARRYPTR,@15                                         1589 07900000
*                                        END;                      1590 07901000
@DE01588 LR    @15,ARRYPTR                                         1590 07902000
         AH    @15,VECTRLEN                                        1590 07903000
         ICM   @14,15,VECTRPTR(@15)                                1590 07904000
         BNZ   @DL01588                                            1590 07905000
*                                        AMTTOGET=VECTRSIZ*PTRLNGTH;    07906000
*                                                                  1591 07907000
         MVC   AMTTOGET(4),@CF01420                                1591 07908000
*                                        CALL IDCSAGP0(GDTTBL,AMTTOGET, 07909000
*                                               VECTRPTR,RIPOOLID, 1592 07910000
*                                               SETZERO);          1592 07911000
         ST    GDTPTR,@AL00001                                     1592 07912000
         LA    @14,AMTTOGET                                        1592 07913000
         ST    @14,@AL00001+4                                      1592 07914000
         ST    @15,@AL00001+8                                      1592 07915000
         LA    @15,RIPOOLID                                        1592 07916000
         ST    @15,@AL00001+12                                     1592 07917000
         LA    @15,SETZERO                                         1592 07918000
         ST    @15,@AL00001+16                                     1592 07919000
         MVI   @AL00001+16,X'80'                                   1592 07920000
         L     @15,GDTGPL(,GDTPTR)                                 1592 07921000
         LA    @01,@AL00001                                        1592 07922000
         BALR  @14,@15                                             1592 07923000
*                                        RESPECIFY RTNREG RSTD;    1593 07924000
*                                        TESTRC = RTNREG;          1594 07925000
         STH   RTNREG,TESTRC                                       1594 07926000
*                                        RESPECIFY RTNREG UNRSTD;  1595 07927000
*                                                                  1595 07928000
*                                        IF TESTRC^=0              1596 07929000
*                                          THEN                    1596 07930000
*                                                                  1596 07931000
         LH    @02,TESTRC                                          1596 07932000
         LTR   @02,@02                                             1596 07933000
         BZ    @RF01596                                            1596 07934000
*                                            CALL ERROR1(NOSPACE); 1597 07935000
*                                                                  1597 07936000
         LA    @01,@AL01597                                        1597 07937000
         BAL   @14,ERROR1                                          1597 07938000
*                                          ELSE                    1598 07939000
*                                            TESTID=0;             1598 07940000
         B     @RC01596                                            1598 07941000
@RF01596 SLR   TESTID,TESTID                                       1598 07942000
*                                      END;                        1599 07943000
*                                    ELSE                          1600 07944000
*                                      TESTID=SUPRPARM(TESTID);    1600 07945000
         B     @RC01585                                            1600 07946000
@RF01585 LR    @02,TESTID                                          1600 07947000
         MH    @02,@CH00038                                        1600 07948000
         L     @01,WORKPTR                                         1600 07949000
         AL    @01,@CF01441                                        1600 07950000
         LH    @02,SUPRPARM-8(@02,@01)                             1600 07951000
         LR    TESTID,@02                                          1600 07952000
*                                END DOLOOP18;                     1601 07953000
@RC01585 DS    0H                                                  1601 07954000
@DE01584 SLR   @02,@02                                             1601 07955000
         CR    TESTID,@02                                          1601 07956000
         BE    @DC01584                                            1601 07957000
         CH    @02,RISTATUS                                        1601 07958000
         BE    @DL01584                                            1601 07959000
@DC01584 DS    0H                                                  1602 07960000
*                              END DOGRP111;                       1602 07961000
*                        END DOLOOP17;                             1603 07962000
*                                                                  1603 07963000
@RF01581 LA    @04,1                                               1603 07964000
         AH    @04,VLISTID                                         1603 07965000
@DE01580 STH   @04,VLISTID                                         1603 07966000
         L     @02,DESCPTR                                         1603 07967000
         CH    @04,MAXID(,@02)                                     1603 07968000
         BNH   @DL01580                                            1603 07969000
@DC01580 DS    0H                                                  1604 07970000
*                    /************************************************/ 07971000
*                    /*                                              */ 07972000
*                    /* INCREMENT THE COUNTER VALUE IN THE FDT THAT  */ 07973000
*                    /* PERTAINS TO THE NUMBER OF REPEATED SUBLIST   */ 07974000
*                    /* REPETITIONS.                                 */ 07975000
*                    /*                                              */ 07976000
*                    /************************************************/ 07977000
*                    ARRYPTR=FDTPTR(SUPERID(PARMLVL));             1604 07978000
@RF01579 LH    @15,PARMLVL                                         1604 07979000
         ALR   @15,@15                                             1604 07980000
         LH    @15,SUPERID-2(@15)                                  1604 07981000
         SLA   @15,2                                               1604 07982000
         L     @01,FDTADDR                                         1604 07983000
         L     ARRYPTR,FDTPTR-4(@15,@01)                           1604 07984000
*                    HWORDARG=REPDEPTH-1;                          1605 07985000
*                                                                  1605 07986000
         LH    @15,REPDEPTH                                        1605 07987000
         BCTR  @15,0                                               1605 07988000
         STH   @15,HWORDARG                                        1605 07989000
*                    CALL DSPLCALC(HWORDARG);                      1606 07990000
*                                                                  1606 07991000
         LA    @15,HWORDARG                                        1606 07992000
         ST    @15,@AL00001                                        1606 07993000
         LA    @01,@AL00001                                        1606 07994000
         BAL   @14,DSPLCALC                                        1606 07995000
*                    REPTOTAL=REPTOTAL+1;                          1607 07996000
         LR    @15,ARRYPTR                                         1607 07997000
         ALR   @15,ARRYDSPL                                        1607 07998000
         LA    @14,1                                               1607 07999000
         L     @01,REPTOTAL(,@15)                                  1607 08000000
         ALR   @01,@14                                             1607 08001000
         ST    @01,REPTOTAL(,@15)                                  1607 08002000
*                    PPARMCNT(PARMLVL)=1;                          1608 08003000
         LH    @04,PARMLVL                                         1608 08004000
         ALR   @04,@04                                             1608 08005000
         STH   @14,PPARMCNT-2(@04)                                 1608 08006000
*                  END DOGRP109;                                   1609 08007000
*              END DOGRP108;                                       1610 08008000
*            ELSE                                                  1611 08009000
*                                                                  1611 08010000
*              /******************************************************/ 08011000
*              /*                                                    */ 08012000
*              /* IF THE CURRENT SUBLIST IS THE LAST REPEATED LIST   */ 08013000
*              /* AT THIS LEVEL, RESET INDEXES AND COUNTS TO CONTINUE*/ 08014000
*              /* SCANNING PARAMETERS AT NEXT HIGHER LEVEL.          */ 08015000
*              /*                                                    */ 08016000
*              /******************************************************/ 08017000
*              IF CHAR1=CLOSING                                    1611 08018000
*                THEN                                              1611 08019000
         B     @RC01569                                            1611 08020000
@RF01569 CLI   CHAR1,C')'                                          1611 08021000
         BNE   @RF01611                                            1611 08022000
*                  DO;                                             1612 08023000
*                    OLDERID2 = NEWERID2;                          1613 08024000
         L     @04,GDTTR2(,GDTPTR)                                 1613 08025000
         MVC   @TS00001(95),NEWERID2(@04)                          1613 08026000
         MVC   OLDERID2(95,@04),@TS00001                           1613 08027000
*                    NEWID2='RI36';                                1614 08028000
         MVC   NEWID2(4,@04),@CC01265                              1614 08029000
*                    REPDEPTH=REPDEPTH-1;                          1615 08030000
*                                                                  1615 08031000
         LH    @04,REPDEPTH                                        1615 08032000
         BCTR  @04,0                                               1615 08033000
         STH   @04,REPDEPTH                                        1615 08034000
*                    CALL NEXTCHAR;                                1616 08035000
         BAL   @14,NEXTCHAR                                        1616 08036000
*                    CALL SCANSEP(YES);                            1617 08037000
*                                                                  1617 08038000
         LA    @01,@AL01617                                        1617 08039000
         BAL   @14,SCANSEP                                         1617 08040000
*                    PARMLVL=PARMLVL-1;                            1618 08041000
         LH    @04,PARMLVL                                         1618 08042000
         BCTR  @04,0                                               1618 08043000
         STH   @04,PARMLVL                                         1618 08044000
*                  END;                                            1619 08045000
*                ELSE                                              1620 08046000
*                                                                  1620 08047000
*                  /**************************************************/ 08048000
*                  /*                                                */ 08049000
*                  /* IF STATEMENT END HAS BEEN REACHED (EVEN THOUGH */ 08050000
*                  /* SOME CLOSING PARENTHESES ARE MISSING), APPLY   */ 08051000
*                  /* DEFAULTS FOR EACH LEVEL NOT EXPLICITLY CLOSED. */ 08052000
*                  /* ISSUE A WARNING MESSAGE ABOUT THE PARENTHESES. */ 08053000
*                  /*                                                */ 08054000
*                  /**************************************************/ 08055000
*                  IF CHAR1=ENDDELIM                               1620 08056000
*                    THEN                                          1620 08057000
         B     @RC01611                                            1620 08058000
@RF01611 CLI   CHAR1,C';'                                          1620 08059000
         BNE   @RF01620                                            1620 08060000
*                      DO;                                         1621 08061000
*                      PARMLVL=PARMLVL-1;                          1622 08062000
         LH    @04,PARMLVL                                         1622 08063000
         BCTR  @04,0                                               1622 08064000
         STH   @04,PARMLVL                                         1622 08065000
*                      REPDEPTH=REPDEPTH-1;                        1623 08066000
         LH    @02,REPDEPTH                                        1623 08067000
         BCTR  @02,0                                               1623 08068000
         STH   @02,REPDEPTH                                        1623 08069000
*                      IF PARMLVL=1                                1624 08070000
*                        THEN                                      1624 08071000
         CH    @04,@CH00228                                        1624 08072000
         BNE   @RF01624                                            1624 08073000
*                          DO;                                     1625 08074000
*                          DARGSMOD=RISTID;                        1626 08075000
         L     @04,DDSTRU                                          1626 08076000
         MVC   DARGSMOD(3,@04),RISTID                              1626 08077000
*                          DARGSENT=TOOFEW;                        1627 08078000
*                                                                  1627 08079000
         MVI   DARGSENT(@04),X'23'                                 1627 08080000
*                          CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);   1628 08081000
*                                                                  1628 08082000
         ST    GDTPTR,@AL00001                                     1628 08083000
         LA    @04,@CF00125                                        1628 08084000
         ST    @04,@AL00001+4                                      1628 08085000
         LA    @04,DDSTRU                                          1628 08086000
         ST    @04,@AL00001+8                                      1628 08087000
         MVI   @AL00001+8,X'80'                                    1628 08088000
         L     @15,GDTPRT(,GDTPTR)                                 1628 08089000
         LA    @01,@AL00001                                        1628 08090000
         BALR  @14,@15                                             1628 08091000
*                          END;                                    1629 08092000
*                      END;                                        1630 08093000
*                    ELSE                                          1631 08094000
*                                                                  1631 08095000
*                      CALL ERROR1(BADELIM4);                      1631 08096000
*                                                                  1631 08097000
         B     @RC01620                                            1631 08098000
@RF01620 LA    @01,@AL01631                                        1631 08099000
         BAL   @14,ERROR1                                          1631 08100000
*        END INREPEAT;                                             1632 08101000
         B     @EL00020                                            1632 08102000
*/********************************************************************/ 08103000
*/*                                                                  */ 08104000
*/*  PROCEDURE NAME - DEFAULTS                                       */ 08105000
*/*                                                                  */ 08106000
*/*  FUNCTION - THIS ROUTINE DETERMINES DEFAULT PARMS IN     @YL026UL*/ 08107000
*/*             ADDITION TO THE PARAMETERS WHICH HAVE ACTUALLY BEEN  */ 08108000
*/*             CODED AS INPUT ON A COMMAND.  THE REQUIRED DEFAULT   */ 08109000
*/*             INFORMATION FOR A COMMAND IS CONTAINED IN THE COMMAND*/ 08110000
*/*             DESCRIPTOR.  A DEFAULT IS APPLIED AS LONG AS THERE   */ 08111000
*/*             IS NO SEMANTIC REQUIREMENT PROHIBITING IT DUE TO A   */ 08112000
*/*             PARAMETER WHICH HAS ALREADY BEEN INPUT.  DEFAULTS    */ 08113000
*/*             ARE APPLIED AT COMMAND END AND AT THE END OF EACH    */ 08114000
*/*             REPETITION OF A REPEATED SUBPARAMETER LIST (IN THE   */ 08115000
*/*             LATTER CASE, ONLY DEFAULTS APPLYING TO THAT SUBLIST  */ 08116000
*/*             ARE APPLIED).                                        */ 08117000
*/*                                                                  */ 08118000
*/*  INPUT -                                                         */ 08119000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND.                 */ 08120000
*/*          SUPERID - SUPERPARAMETER ID# OF PARAMETER WHOSE SUBLIST */ 08121000
*/*                    IS RECEIVING DEFAULTS (ID#=0 IF APPLYING      */ 08122000
*/*                    DEFAULTS FOR ENTIRE COMMAND).                 */ 08123000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 08124000
*/*                    CODE WHEN AN ERROR IS DETECTED.               */ 08125000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/ 08126000
*/*                                                                  */ 08127000
*/*  OUTPUT -                                                        */ 08128000
*/*          PARAMETER ID# OF A PARAMETER TO BE DEFAULTED    @YL026UL*/ 08129000
*/*                                                                  */ 08130000
*/********************************************************************/ 08131000
*DEFAULTS:PROCEDURE;                                               1633 08132000
DEFAULTS STM   @14,@04,@SA00021                                    1633 08133000
         STM   @06,@12,@SA00021+28                                 1633 08134000
*        /************************************************************/ 08135000
*        /*                                                          */ 08136000
*        /*  ** DEFAULTS **  APPLY DEFAULT PARAMETERS                */ 08137000
*        /*                                                          */ 08138000
*        /************************************************************/ 08139000
*        IF GDTDBG = NULLPTR                                       1634 08140000
*          THEN;                                                   1634 08141000
         ICM   @04,15,GDTDBG(GDTPTR)                               1634 08142000
         BZ    @RT01634                                            1634 08143000
*          ELSE                                                    1636 08144000
*            CALL IDCDB010(GDTTBL,'RIDF');                         1636 08145000
*                                                                  1636 08146000
         ST    GDTPTR,@AL00001                                     1636 08147000
         LA    @04,@CC01269                                        1636 08148000
         ST    @04,@AL00001+4                                      1636 08149000
         MVI   @AL00001+4,X'80'                                    1636 08150000
         L     @15,GDTDBG(,GDTPTR)                                 1636 08151000
         LA    @01,@AL00001                                        1636 08152000
         BALR  @14,@15                                             1636 08153000
*        /************************************************************/ 08154000
*        /*                                                          */ 08155000
*        /* UPON ENTRY TO THIS ROUTINE, THE CURRENT SUPERPARAMETER   */ 08156000
*        /* ID NUMBER WILL BE ZERO IF STATEMENT END HAS BEEN REACHED.*/ 08157000
*        /* OTHERWISE, THE ID# WILL BE THAT OF THE PARAMETER WHICH   */ 08158000
*        /* HAS THE REPEATED SUBPARAMETER LIST.                      */ 08159000
*        /*                                                          */ 08160000
*        /************************************************************/ 08161000
*                                                                  1637 08162000
*        /************************************************************/ 08163000
*        /*                                                          */ 08164000
*        /* IF 'DEFAULT GROUPS' ARE SPECIFIED, FIND THE      @YL026UL*/ 08165000
*        /* GROUP(S) WHICH PERTAIN TO THE CURRENT SET OF     @YL026UL*/ 08166000
*        /* PARAMETERS, AND SELECT DEFAULTS IF APPLICABLE.   @YL026UL*/ 08167000
*        /*                                                          */ 08168000
*        /************************************************************/ 08169000
*        IF DGRPDSPL > 0                                           1637 08170000
*          THEN                                                    1637 08171000
@RT01634 L     @04,DESCPTR                                         1637 08172000
         CLI   DGRPDSPL(@04),0                                     1637 08173000
         BNH   @RF01637                                            1637 08174000
*DOGRP110:   DO;                                           /*@YL026UL*/ 08175000
DOGRP110 DS    0H                                                  1639 08176000
*              GRPPTR=ADDR(DGRPTOT)+LENGTH(DGRPTOT);       /*@YL026UL*/ 08177000
*                                                                  1639 08178000
         L     @04,DESCPTR                                         1639 08179000
         SLR   @02,@02                                             1639 08180000
         IC    @02,DGRPDSPL(,@04)                                  1639 08181000
         ALR   @02,@02                                             1639 08182000
         ALR   @04,@02                                             1639 08183000
         AL    @04,@CF00163                                        1639 08184000
         ST    @04,GRPPTR                                          1639 08185000
*              /******************************************************/ 08186000
*              /*                                                    */ 08187000
*              /* EXAMINE EACH 'DEFAULT GROUP' SUBLIST,      @YL026UL*/ 08188000
*              /* CHECKING TO SEE IF THE PARAMETER ELIGIBLE  @YL026UL*/ 08189000
*              /* TO BE DEFAULTED IS PART OF THE SET OF      @YL026UL*/ 08190000
*              /* PARAMETERS NOW BEING HANDLED.              @YL026UL*/ 08191000
*              /*                                                    */ 08192000
*              /******************************************************/ 08193000
*DOLOOP19:     DO LISTINDX=1 TO DGRPTOT;                   /*@YL026UL*/ 08194000
DOLOOP19 LA    @04,1                                               1640 08195000
         B     @DE01640                                            1640 08196000
@DL01640 DS    0H                                                  1641 08197000
*                FOUND=NO;                                 /*@YL026UL*/ 08198000
         NI    FOUND,B'11011111'                                   1641 08199000
*                TESTID=DGRPID(1);                         /*@YL026UL*/ 08200000
         L     @02,GRPPTR                                          1642 08201000
         LH    TESTID,DGRPID(,@02)                                 1642 08202000
*                DO WHILE(TESTID^=0 & FOUND=NO);           /*@YL026UL*/ 08203000
         B     @DE01643                                            1643 08204000
@DL01643 DS    0H                                                  1644 08205000
*                  IF SUPRPARM(TESTID)=SUPERID(PARMLVL)            1644 08206000
*                    THEN                                          1644 08207000
         LR    @02,TESTID                                          1644 08208000
         MH    @02,@CH00038                                        1644 08209000
         LH    @15,PARMLVL                                         1644 08210000
         ALR   @15,@15                                             1644 08211000
         L     @01,WORKPTR                                         1644 08212000
         AL    @01,@CF01441                                        1644 08213000
         LH    @02,SUPRPARM-8(@02,@01)                             1644 08214000
         CH    @02,SUPERID-2(@15)                                  1644 08215000
         BNE   @RF01644                                            1644 08216000
*                      FOUND=YES;                          /*@YL026UL*/ 08217000
         OI    FOUND,B'00100000'                                   1645 08218000
*                    ELSE                                          1646 08219000
*                      DO;                                 /*@YL026UL*/ 08220000
         B     @RC01644                                            1646 08221000
@RF01644 DS    0H                                                  1647 08222000
*                      TESTID=SUPRPARM(TESTID);            /*@YL026UL*/ 08223000
         L     @02,WORKPTR                                         1647 08224000
         LA    @15,12                                              1647 08225000
         LR    @01,TESTID                                          1647 08226000
         MR    @00,@15                                             1647 08227000
         AL    @01,@CF01441                                        1647 08228000
         LH    @14,SUPRPARM-8(@01,@02)                             1647 08229000
         LR    TESTID,@14                                          1647 08230000
*                      IF PARMPTR(TESTID)->REPEATED=YES            1648 08231000
*                        THEN                                      1648 08232000
         MR    @14,TESTID                                          1648 08233000
         AL    @02,@CF01440                                        1648 08234000
         L     @02,PARMPTR(@15,@02)                                1648 08235000
         TM    REPEATED(@02),B'00100000'                           1648 08236000
         BNO   @RF01648                                            1648 08237000
*                          TESTID=0;                       /*@YL026UL*/ 08238000
         SLR   TESTID,TESTID                                       1649 08239000
*                      END;                                /*@YL026UL*/ 08240000
@RF01648 DS    0H                                                  1651 08241000
*                END;                                      /*@YL026UL*/ 08242000
*                                                                  1651 08243000
@RC01644 DS    0H                                                  1651 08244000
@DE01643 LTR   TESTID,TESTID                                       1651 08245000
         BZ    @DC01643                                            1651 08246000
         TM    FOUND,B'00100000'                                   1651 08247000
         BZ    @DL01643                                            1651 08248000
@DC01643 DS    0H                                                  1652 08249000
*                /****************************************************/ 08250000
*                /*                                                  */ 08251000
*                /* IF THE ELIGIBLE PARAMETER IS PART OF THE @YL026UL*/ 08252000
*                /* CURRENT PARAMETER SET, TEST TO SEE IF    @YL026UL*/ 08253000
*                /* ALL THE PARAMETERS IN THE GROUP WERE NOT @YL026UL*/ 08254000
*                /* CODED.  IF NONE WERE INPUT, DEFAULT THE  @YL026UL*/ 08255000
*                /* FIRST PARAMETER IN THE SUBLIST.          @YL026UL*/ 08256000
*                /*                                                  */ 08257000
*                /****************************************************/ 08258000
*                IF FOUND=YES                                      1652 08259000
*                  THEN                                            1652 08260000
         TM    FOUND,B'00100000'                                   1652 08261000
         BNO   @RF01652                                            1652 08262000
*DOGRP113:           DO;                                   /*@YL026UL*/ 08263000
DOGRP113 DS    0H                                                  1654 08264000
*                      FOUND=NO;                           /*@YL026UL*/ 08265000
         NI    FOUND,B'11011111'                                   1654 08266000
*                      DO INDEX3=1 TO DGRPCNT;             /*@YL026UL*/ 08267000
         LA    @04,1                                               1655 08268000
         B     @DE01655                                            1655 08269000
@DL01655 DS    0H                                                  1656 08270000
*                        IF PARMFLAG(DGRPID(INDEX3))^=0            1656 08271000
*                          THEN                                    1656 08272000
         ALR   @04,@04                                             1656 08273000
         L     @02,GRPPTR                                          1656 08274000
         LH    @04,DGRPID-2(@04,@02)                               1656 08275000
         MH    @04,@CH00038                                        1656 08276000
         L     @02,WORKPTR                                         1656 08277000
         BCTR  @02,0                                               1656 08278000
         BCTR  @02,0                                               1656 08279000
         SLR   @15,@15                                             1656 08280000
         IC    @15,PARMFLAG-10(@04,@02)                            1656 08281000
         CH    @15,@CH00125                                        1656 08282000
         BE    @RF01656                                            1656 08283000
*                            FOUND=YES;                    /*@YL026UL*/ 08284000
         OI    FOUND,B'00100000'                                   1657 08285000
*                      END;                                /*@YL026UL*/ 08286000
@RF01656 LA    @04,1                                               1658 08287000
         AH    @04,INDEX3                                          1658 08288000
@DE01655 STH   @04,INDEX3                                          1658 08289000
         L     @02,GRPPTR                                          1658 08290000
         CH    @04,DGRPCNT(,@02)                                   1658 08291000
         BNH   @DL01655                                            1658 08292000
*                      IF FOUND=NO                                 1659 08293000
*                        THEN                                      1659 08294000
*                                                                  1659 08295000
         TM    FOUND,B'00100000'                                   1659 08296000
         BNZ   @RF01659                                            1659 08297000
*                          CALL SETDFLT(DGRPID(1));        /*@YL026UL*/ 08298000
*                                                                  1660 08299000
         L     @04,GRPPTR                                          1660 08300000
         LA    @04,DGRPID(,@04)                                    1660 08301000
         ST    @04,@AL00001                                        1660 08302000
         LA    @01,@AL00001                                        1660 08303000
         BAL   @14,SETDFLT                                         1660 08304000
*                    END DOGRP113;                         /*@YL026UL*/ 08305000
@RF01659 DS    0H                                                  1662 08306000
*                GRPPTR=GRPPTR+LENGTH(DGRPCNT)+                    1662 08307000
*                        DGRPCNT*LENGTH(DGRPID(1));        /*@YL026UL*/ 08308000
@RF01652 L     @04,GRPPTR                                          1662 08309000
         LA    @02,2                                               1662 08310000
         ALR   @02,@04                                             1662 08311000
         LH    @04,DGRPCNT(,@04)                                   1662 08312000
         ALR   @04,@04                                             1662 08313000
         ALR   @02,@04                                             1662 08314000
         ST    @02,GRPPTR                                          1662 08315000
*              END DOLOOP19;                               /*@YL026UL*/ 08316000
         LA    @04,1                                               1663 08317000
         AH    @04,LISTINDX                                        1663 08318000
@DE01640 STH   @04,LISTINDX                                        1663 08319000
         L     @02,DESCPTR                                         1663 08320000
         SLR   @15,@15                                             1663 08321000
         IC    @15,DGRPDSPL(,@02)                                  1663 08322000
         ALR   @15,@15                                             1663 08323000
         AL    @15,DESCPTR                                         1663 08324000
         CH    @04,DGRPTOT(,@15)                                   1663 08325000
         BNH   @DL01640                                            1663 08326000
*            END DOGRP110;                                 /*@YL026UL*/ 08327000
*                                                                  1664 08328000
*        /************************************************************/ 08329000
*        /*                                                          */ 08330000
*        /* EXAMINE EACH PARAMETER TO SEE IF A DEFAULT       @YL026UL*/ 08331000
*        /* CONSTANT IS PROVIDED FOR IT.  IF A DEFAULT IS    @YL026UL*/ 08332000
*        /* PRESENT AND THE PARAMETER IS NOT ALREADY INPUT,  @YL026UL*/ 08333000
*        /* THE PARM IS ELIGIBLE TO BE DEFAULTED.            @YL026UL*/ 08334000
*        /*                                                          */ 08335000
*        /************************************************************/ 08336000
*DOLOOP20:DO INDEX3=1 TO MAXID;                            /*@YL026UL*/ 08337000
@RF01637 DS    0H                                                  1665 08338000
DOLOOP20 LA    @04,1                                               1665 08339000
         B     @DE01665                                            1665 08340000
@DL01665 DS    0H                                                  1666 08341000
*          IF PARMPTR(INDEX3)^=0 & PARMFLAG(INDEX3)=0 &            1666 08342000
*             PARMPTR(INDEX3)->DEFAULT=YES                         1666 08343000
*            THEN                                                  1666 08344000
         SLR   @02,@02                                             1666 08345000
         L     @15,WORKPTR                                         1666 08346000
         MH    @04,@CH00038                                        1666 08347000
         LA    @01,0(@04,@15)                                      1666 08348000
         AL    @01,@CF01440                                        1666 08349000
         L     @14,PARMPTR(,@01)                                   1666 08350000
         CR    @14,@02                                             1666 08351000
         BE    @RF01666                                            1666 08352000
         BCTR  @15,0                                               1666 08353000
         BCTR  @15,0                                               1666 08354000
         SLR   @01,@01                                             1666 08355000
         IC    @01,PARMFLAG-10(@04,@15)                            1666 08356000
         CR    @02,@01                                             1666 08357000
         BNE   @RF01666                                            1666 08358000
         TM    DEFAULT(@14),B'00000100'                            1666 08359000
         BNO   @RF01666                                            1666 08360000
*DOGRP115:     DO;                                         /*@YL026UL*/ 08361000
DOGRP115 DS    0H                                                  1668 08362000
*                TESTID=INDEX3;                            /*@YL026UL*/ 08363000
*                                                                  1668 08364000
         LH    TESTID,INDEX3                                       1668 08365000
*                /****************************************************/ 08366000
*                /*                                                  */ 08367000
*                /* BE SURE THAT THE PARAMETER TO BE DEFAULTED IS    */ 08368000
*                /* PART OF THE SET OF PARAMETERS CURRENTLY BEING    */ 08369000
*                /* HANDLED.  IF SO, THEN SET THE DEFAULT.           */ 08370000
*                /*                                                  */ 08371000
*                /****************************************************/ 08372000
*DOLOOP22:       DO WHILE(TESTID^=0);                      /*@YL026UL*/ 08373000
DOLOOP22 B     @DE01669                                            1669 08374000
@DL01669 DS    0H                                                  1670 08375000
*                  IF SUPRPARM(TESTID)=SUPERID(PARMLVL)            1670 08376000
*                    THEN                                          1670 08377000
         LR    @02,TESTID                                          1670 08378000
         MH    @02,@CH00038                                        1670 08379000
         LH    @15,PARMLVL                                         1670 08380000
         ALR   @15,@15                                             1670 08381000
         L     @01,WORKPTR                                         1670 08382000
         AL    @01,@CF01441                                        1670 08383000
         LH    @02,SUPRPARM-8(@02,@01)                             1670 08384000
         CH    @02,SUPERID-2(@15)                                  1670 08385000
         BNE   @RF01670                                            1670 08386000
*                      DO;                                 /*@YL026UL*/ 08387000
*                      TESTID=0;                           /*@YL026UL*/ 08388000
*                                                                  1672 08389000
         SLR   TESTID,TESTID                                       1672 08390000
*                      CALL SETDFLT(INDEX3);               /*@YL026UL*/ 08391000
*                                                                  1673 08392000
         LA    @02,INDEX3                                          1673 08393000
         ST    @02,@AL00001                                        1673 08394000
         LA    @01,@AL00001                                        1673 08395000
         BAL   @14,SETDFLT                                         1673 08396000
*                      END;                                /*@YL026UL*/ 08397000
*                    ELSE                                          1675 08398000
*                      DO;                                 /*@YL026UL*/ 08399000
         B     @RC01670                                            1675 08400000
@RF01670 DS    0H                                                  1676 08401000
*                      TESTID=SUPRPARM(TESTID);            /*@YL026UL*/ 08402000
         L     @02,WORKPTR                                         1676 08403000
         LA    @15,12                                              1676 08404000
         LR    @01,TESTID                                          1676 08405000
         MR    @00,@15                                             1676 08406000
         AL    @01,@CF01441                                        1676 08407000
         LH    @14,SUPRPARM-8(@01,@02)                             1676 08408000
         LR    TESTID,@14                                          1676 08409000
*                      IF PARMPTR(TESTID)->REPEATED=YES            1677 08410000
*                        THEN                                      1677 08411000
         MR    @14,TESTID                                          1677 08412000
         AL    @02,@CF01440                                        1677 08413000
         L     @02,PARMPTR(@15,@02)                                1677 08414000
         TM    REPEATED(@02),B'00100000'                           1677 08415000
         BNO   @RF01677                                            1677 08416000
*                          TESTID=0;                       /*@YL026UL*/ 08417000
         SLR   TESTID,TESTID                                       1678 08418000
*                      END;                                /*@YL026UL*/ 08419000
@RF01677 DS    0H                                                  1680 08420000
*                END DOLOOP22;                             /*@YL026UL*/ 08421000
@RC01670 DS    0H                                                  1680 08422000
@DE01669 LTR   TESTID,TESTID                                       1680 08423000
         BNZ   @DL01669                                            1680 08424000
*              END DOGRP115;                               /*@YL026UL*/ 08425000
*        END DOLOOP20;                                     /*@YL026UL*/ 08426000
@RF01666 LA    @04,1                                               1682 08427000
         AH    @04,INDEX3                                          1682 08428000
@DE01665 STH   @04,INDEX3                                          1682 08429000
         L     @02,DESCPTR                                         1682 08430000
         CH    @04,MAXID(,@02)                                     1682 08431000
         BNH   @DL01665                                            1682 08432000
*/********************************************************************/ 08433000
*/*                                                                  */ 08434000
*/*  PROCEDURE NAME - SETDFLT                                @YL026UL*/ 08435000
*/*                                                                  */ 08436000
*/*  FUNCTION - THIS ROUTINE CHECKS A PARM THAT IS ELIGIBLE  @YL026UL*/ 08437000
*/*             TO BE DEFAULTED TO SEE IF THE DEFAULT WILL   @YL026UL*/ 08438000
*/*             CAUSE ANY CONFLICT WITH AN EXISTING INPUT    @YL026UL*/ 08439000
*/*             PARAMETER.  IF NOT, THE DEFAULT PARAMETER    @YL026UL*/ 08440000
*/*             IS ADDED TO THE FDT.                         @YL026UL*/ 08441000
*/*                                                                  */ 08442000
*/*  INPUT -                                                 @YL026UL*/ 08443000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND.         @YL026UL*/ 08444000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/ 08445000
*/*          DFLTPARM - THE ID# OF THE PARAMETER TO BE DEFAULTED     */ 08446000
*/*                                                                  */ 08447000
*/*  OUTPUT -                                                        */ 08448000
*/*          ORGSIGN - FORM OF THE CONSTANT (HEX, BINARY     @YL026UL*/ 08449000
*/*                    OR NEITHER) TO BE DEFAULTED.          @YL026UL*/ 08450000
*/*          PWORD -   SET 'OFF' TO SIGNAL THAT THE ITEM     @YL026UL*/ 08451000
*/*                    BEING DEFAULTED IS NOT A PASSWORD.    @YL026UL*/ 08452000
*/*          SYNUNIT - CONTAINS THE ITEM TO BE DEFAULTED.    @YL026UL*/ 08453000
*/*          UNITINDX- LENGTH OF THE ITEM TO BE DEFAULTED.   @YL026UL*/ 08454000
*/*                                                                  */ 08455000
*/********************************************************************/ 08456000
*SETDFLT:PROCEDURE(DFLTPARM);                              /*@YL026UL*/ 08457000
         B     @PB00022                                            1683 08458000
SETDFLT  STM   @14,@04,@SA00022                                    1683 08459000
         STM   @06,@12,@SA00022+28                                 1683 08460000
         MVC   @PC00022(4),0(@01)                                  1683 08461000
*        /************************************************************/ 08462000
*        /*                                                          */ 08463000
*        /* DATA DEFINITIONS FOR SETDFLT ROUTINE             @YL026UL*/ 08464000
*        /*                                                          */ 08465000
*        /************************************************************/ 08466000
*                                                                  1684 08467000
*        DCL DFLTPARM FIXED(15);       /*ID# OF PARM TO BE   @YL026UL*/ 08468000
*                                      /* DEFAULTED.         @YL026UL*/ 08469000
*        DCL WORKVAR2 FIXED(15);       /*VARIABLE TO CONTAIN @YL026UL*/ 08470000
*                                      /*A TEMPORARY VALUE   @YL026UL*/ 08471000
*        DCL DEFLTPTR PTR(31);         /*VARIABLE TO CONTAIN @YL026UL*/ 08472000
*                                      /*PTR TO DEFAULT INFO @YL026UL*/ 08473000
*                                      /*IN THE DESCRIPTOR.  @YL026UL*/ 08474000
*        DCL DFLTOK   BIT(1);          /*SIGNALS THAT PARM   @YL026UL*/ 08475000
*                                      /* IDENTIFIED IN THE  @YL026UL*/ 08476000
*                                      /* ABOVE LIST IS OK   @YL026UL*/ 08477000
*                                      /* TO BE DEFAULTED.   @YL026UL*/ 08478000
*        /************************************************************/ 08479000
*        /*                                                          */ 08480000
*        /*  ** SETDFLT **  APPLY DEFAULT PARAMETERS         @YL026UL*/ 08481000
*        /*                                                          */ 08482000
*        /************************************************************/ 08483000
*        IF GDTDBG = NULLPTR                                       1688 08484000
*          THEN;                                                   1688 08485000
         ICM   @04,15,GDTDBG(GDTPTR)                               1688 08486000
         BZ    @RT01688                                            1688 08487000
*          ELSE                                                    1690 08488000
*            CALL IDCDB010(GDTTBL,'RIST');                         1690 08489000
         ST    GDTPTR,@AL00001                                     1690 08490000
         LA    @04,@CC01291                                        1690 08491000
         ST    @04,@AL00001+4                                      1690 08492000
         MVI   @AL00001+4,X'80'                                    1690 08493000
         L     @15,GDTDBG(,GDTPTR)                                 1690 08494000
         LA    @01,@AL00001                                        1690 08495000
         BALR  @14,@15                                             1690 08496000
*                                                          /*@YL026UL*/ 08497000
*                                                                  1691 08498000
*        /************************************************************/ 08499000
*        /*                                                          */ 08500000
*        /* THE PARAMETER TO BE DEFAULTED IS CHECKED TO      @YL026UL*/ 08501000
*        /* INSURE THAT ITS PRESENCE WILL NOT CREATE A       @YL026UL*/ 08502000
*        /* CONFLICT WITH AN EXISTING INPUT PARAMETER.       @YL026UL*/ 08503000
*        /* SINCE KEYWORD SUPERPARM(S) OF THE DEFAULT PARM   @YL026UL*/ 08504000
*        /* ARE TO BE DEFAULTED (AS NECESSARY) ALONG WITH    @YL026UL*/ 08505000
*        /* IT, THESE SUPERPARM(S) ARE ALSO CHECKED FOR      @YL026UL*/ 08506000
*        /* POTENTIAL CONFLICTS                              @YL026UL*/ 08507000
*        /*                                                          */ 08508000
*        /************************************************************/ 08509000
*        PARMID=DFLTPARM;                                  /*@YL026UL*/ 08510000
@RT01688 L     @04,@PC00022                                        1691 08511000
         MVC   PARMID(2),DFLTPARM(@04)                             1691 08512000
*        DFLTOK=YES;                                       /*@YL026UL*/ 08513000
         OI    DFLTOK,B'10000000'                                  1692 08514000
*        DO WHILE(DFLTOK=YES &                                     1693 08515000
*                   PARMID^=0 & PARMFLAG(PARMID)=0);       /*@YL026UL*/ 08516000
*                                                                  1693 08517000
         B     @DE01693                                            1693 08518000
@DL01693 DS    0H                                                  1694 08519000
*          /**********************************************************/ 08520000
*          /*                                                        */ 08521000
*          /* FIRST, CHECK FOR A LIST OF CONFLICTING PARMS   @YL026UL*/ 08522000
*          /* SPECIFICALLY ASSOCIATED WITH THE DEFAULT PARM, @YL026UL*/ 08523000
*          /* AND BE SURE THAT NO CONFLICTS WOULD EXIST.     @YL026UL*/ 08524000
*          /*                                                        */ 08525000
*          /**********************************************************/ 08526000
*          IF NOTDSPL > 0                                          1694 08527000
*            THEN                                                  1694 08528000
         LH    @04,PARMID                                          1694 08529000
         MH    @04,@CH00038                                        1694 08530000
         L     @02,WORKPTR                                         1694 08531000
         AL    @02,@CF01440                                        1694 08532000
         L     @04,PARMPTR(@04,@02)                                1694 08533000
         CLI   NOTDSPL(@04),0                                      1694 08534000
         BNH   @RF01694                                            1694 08535000
*              DO;                                         /*@YL026UL*/ 08536000
*                WORKVAR2=NOTCOUNT;                        /*@YL026UL*/ 08537000
         SLR   @15,@15                                             1696 08538000
         IC    @15,NOTDSPL(,@04)                                   1696 08539000
         ALR   @15,@15                                             1696 08540000
         ALR   @04,@15                                             1696 08541000
         LH    WORKVAR2,NOTCOUNT(,@04)                             1696 08542000
*                DO INDEX2=1 TO WORKVAR2;                 /*@YL026UL*/  08543000
         LA    @04,1                                               1697 08544000
         B     @DE01697                                            1697 08545000
@DL01697 DS    0H                                                  1698 08546000
*                  IF PARMFLAG(NOTID(INDEX2)) ^= 0                 1698 08547000
*                    THEN                                          1698 08548000
         L     @15,WORKPTR                                         1698 08549000
         LA    @14,12                                              1698 08550000
         ALR   @04,@04                                             1698 08551000
         LR    @01,@14                                             1698 08552000
         MH    @01,PARMID                                          1698 08553000
         AL    @01,@CF01440                                        1698 08554000
         L     @01,PARMPTR(@01,@15)                                1698 08555000
         SLR   @00,@00                                             1698 08556000
         IC    @00,NOTDSPL(,@01)                                   1698 08557000
         ALR   @00,@00                                             1698 08558000
         ALR   @01,@00                                             1698 08559000
         MH    @14,NOTID-2(@04,@01)                                1698 08560000
         BCTR  @15,0                                               1698 08561000
         BCTR  @15,0                                               1698 08562000
         SLR   @04,@04                                             1698 08563000
         IC    @04,PARMFLAG-10(@14,@15)                            1698 08564000
         CH    @04,@CH00125                                        1698 08565000
         BE    @RF01698                                            1698 08566000
*                      DFLTOK=NO;                          /*@YL026UL*/ 08567000
         NI    DFLTOK,B'01111111'                                  1699 08568000
*                END;                                      /*@YL026UL*/ 08569000
@RF01698 LA    @04,1                                               1700 08570000
         AH    @04,INDEX2                                          1700 08571000
@DE01697 STH   @04,INDEX2                                          1700 08572000
         CR    @04,WORKVAR2                                        1700 08573000
         BNH   @DL01697                                            1700 08574000
*              END;                                        /*@YL026UL*/ 08575000
*                                                                  1701 08576000
*          /**********************************************************/ 08577000
*          /*                                                        */ 08578000
*          /* THEN CHECK FOR THE OCCURRENCE OF THIS DEFAULT  @YL026UL*/ 08579000
*          /* PARAMETER IN A 'NOT GROUP' (A SET OF MUTUALLY  @YL026UL*/ 08580000
*          /* EXCLUSIVE PARMS), AND BE SURE THAT NO OTHER    @YL026UL*/ 08581000
*          /* PARAMETER IN THE GROUP IS INPUT                @YL026UL*/ 08582000
*          /*                                                        */ 08583000
*          /**********************************************************/ 08584000
*          IF DFLTOK=YES & NTGRPPTR(PARMID)^=NULLPTR               1702 08585000
*            THEN                                                  1702 08586000
@RF01694 TM    DFLTOK,B'10000000'                                  1702 08587000
         BNO   @RF01702                                            1702 08588000
         LH    @04,PARMID                                          1702 08589000
         MH    @04,@CH00038                                        1702 08590000
         L     @02,WORKPTR                                         1702 08591000
         AL    @02,@CF01499                                        1702 08592000
         L     @04,NTGRPPTR-4(@04,@02)                             1702 08593000
         LTR   @04,@04                                             1702 08594000
         BZ    @RF01702                                            1702 08595000
*              DO;                                         /*@YL026UL*/ 08596000
*                WORKPTR2=GRPPTR;                          /*@YL026UL*/ 08597000
         MVC   WORKPTR2(4),GRPPTR                                  1704 08598000
*                GRPPTR=NTGRPPTR(PARMID);                  /*@YL026UL*/ 08599000
         ST    @04,GRPPTR                                          1705 08600000
*                DO INDEX2=1 TO NTGRPCNT;                  /*@YL026UL*/ 08601000
         LA    @04,1                                               1706 08602000
         B     @DE01706                                            1706 08603000
@DL01706 DS    0H                                                  1707 08604000
*                  IF PARMFLAG(NTGRPID(INDEX2))^=0 &               1707 08605000
*                     NTGRPID(INDEX2)^=PARMID                      1707 08606000
*                    THEN                                          1707 08607000
         ALR   @04,@04                                             1707 08608000
         L     @02,GRPPTR                                          1707 08609000
         LH    @04,NTGRPID-2(@04,@02)                              1707 08610000
         LR    @02,@04                                             1707 08611000
         MH    @02,@CH00038                                        1707 08612000
         L     @01,WORKPTR                                         1707 08613000
         BCTR  @01,0                                               1707 08614000
         BCTR  @01,0                                               1707 08615000
         SLR   @00,@00                                             1707 08616000
         IC    @00,PARMFLAG-10(@02,@01)                            1707 08617000
         CH    @00,@CH00125                                        1707 08618000
         BE    @RF01707                                            1707 08619000
         CH    @04,PARMID                                          1707 08620000
         BE    @RF01707                                            1707 08621000
*                      DFLTOK=NO;                          /*@YL026UL*/ 08622000
         NI    DFLTOK,B'01111111'                                  1708 08623000
*                END;                                      /*@YL026UL*/ 08624000
@RF01707 LA    @04,1                                               1709 08625000
         AH    @04,INDEX2                                          1709 08626000
@DE01706 STH   @04,INDEX2                                          1709 08627000
         L     @02,GRPPTR                                          1709 08628000
         CH    @04,NTGRPCNT(,@02)                                  1709 08629000
         BNH   @DL01706                                            1709 08630000
*                GRPPTR=WORKPTR2;                          /*@YL026UL*/ 08631000
         MVC   GRPPTR(4),WORKPTR2                                  1710 08632000
*              END;                                        /*@YL026UL*/ 08633000
*          PARMID=SUPRPARM(PARMID);                        /*@YL026UL*/ 08634000
@RF01702 LH    @04,PARMID                                          1712 08635000
         MH    @04,@CH00038                                        1712 08636000
         L     @02,WORKPTR                                         1712 08637000
         AL    @02,@CF01441                                        1712 08638000
         LH    @04,SUPRPARM-8(@04,@02)                             1712 08639000
         STH   @04,PARMID                                          1712 08640000
*        END;                                              /*@YL026UL*/ 08641000
*                                                                  1713 08642000
@DE01693 TM    DFLTOK,B'10000000'                                  1713 08643000
         BNO   @DC01693                                            1713 08644000
         LH    @04,PARMID                                          1713 08645000
         SLR   @02,@02                                             1713 08646000
         CR    @04,@02                                             1713 08647000
         BE    @DC01693                                            1713 08648000
         MH    @04,@CH00038                                        1713 08649000
         L     @01,WORKPTR                                         1713 08650000
         BCTR  @01,0                                               1713 08651000
         BCTR  @01,0                                               1713 08652000
         SLR   @00,@00                                             1713 08653000
         IC    @00,PARMFLAG-10(@04,@01)                            1713 08654000
         CR    @02,@00                                             1713 08655000
         BE    @DL01693                                            1713 08656000
@DC01693 DS    0H                                                  1714 08657000
*        /************************************************************/ 08658000
*        /*                                                          */ 08659000
*        /* IF NO CONFLICTS WILL OCCUR BY DEFAULTING THIS    @YL026UL*/ 08660000
*        /* PARAMETER, NOTE THE PARM'S (AND SUPERPARM'S)     @YL026UL*/ 08661000
*        /* OCCURRENCE IN THE PARMFLAG TABLE AND IN THE FDT. @YL026UL*/ 08662000
*        /*                                                          */ 08663000
*        /************************************************************/ 08664000
*        IF DFLTOK=YES                                             1714 08665000
*          THEN                                                    1714 08666000
         TM    DFLTOK,B'10000000'                                  1714 08667000
         BNO   @RF01714                                            1714 08668000
*DOGRP145:   DO;                                           /*@YL026UL*/ 08669000
DOGRP145 DS    0H                                                  1716 08670000
*            OLDERID2 = NEWERID2;                                  1716 08671000
         L     @04,GDTTR2(,GDTPTR)                                 1716 08672000
         MVC   @TS00001(95),NEWERID2(@04)                          1716 08673000
         MVC   OLDERID2(95,@04),@TS00001                           1716 08674000
*            NEWID2='RI44';                                /*@YL026UL*/ 08675000
         MVC   NEWID2(4,@04),@CC01294                              1717 08676000
*            PARMID=DFLTPARM;                              /*@YL026UL*/ 08677000
         L     @04,@PC00022                                        1718 08678000
         MVC   PARMID(2),DFLTPARM(@04)                             1718 08679000
*            DO WHILE(PARMID^=0 & PARMFLAG(PARMID)=0);     /*@YL026UL*/ 08680000
*                                                                  1719 08681000
         B     @DE01719                                            1719 08682000
@DL01719 DS    0H                                                  1720 08683000
*              CALL SETFLAG;                               /*@YL026UL*/ 08684000
*                                                                  1720 08685000
         BAL   @14,SETFLAG                                         1720 08686000
*              PARMID=SUPRPARM(PARMID);                    /*@YL026UL*/ 08687000
         LH    @04,PARMID                                          1721 08688000
         MH    @04,@CH00038                                        1721 08689000
         L     @02,WORKPTR                                         1721 08690000
         AL    @02,@CF01441                                        1721 08691000
         LH    @04,SUPRPARM-8(@04,@02)                             1721 08692000
         STH   @04,PARMID                                          1721 08693000
*            END;                                          /*@YL026UL*/ 08694000
@DE01719 LH    @04,PARMID                                          1722 08695000
         SLR   @02,@02                                             1722 08696000
         CR    @04,@02                                             1722 08697000
         BE    @DC01719                                            1722 08698000
         MH    @04,@CH00038                                        1722 08699000
         L     @01,WORKPTR                                         1722 08700000
         BCTR  @01,0                                               1722 08701000
         BCTR  @01,0                                               1722 08702000
         SLR   @00,@00                                             1722 08703000
         IC    @00,PARMFLAG-10(@04,@01)                            1722 08704000
         CR    @02,@00                                             1722 08705000
         BE    @DL01719                                            1722 08706000
@DC01719 DS    0H                                                  1723 08707000
*            PARMID=DFLTPARM;                              /*@YL026UL*/ 08708000
*                                                                  1723 08709000
         L     @04,@PC00022                                        1723 08710000
         LH    @04,DFLTPARM(,@04)                                  1723 08711000
         STH   @04,PARMID                                          1723 08712000
*            /********************************************************/ 08713000
*            /*                                                      */ 08714000
*            /* IF A DEFAULT CONSTANT IS PROVIDED, PERFORM   @YL026UL*/ 08715000
*            /* NECESSARY CONVERSION AND PLACE IT IN THE FDT @YL026UL*/ 08716000
*            /*                                                      */ 08717000
*            /********************************************************/ 08718000
*            IF DEFAULT=YES & SCANONLY=NO                          1724 08719000
*              THEN                                                1724 08720000
         MH    @04,@CH00038                                        1724 08721000
         L     @02,WORKPTR                                         1724 08722000
         AL    @02,@CF01440                                        1724 08723000
         L     @04,PARMPTR(@04,@02)                                1724 08724000
         TM    DEFAULT(@04),B'00000100'                            1724 08725000
         BNO   @RF01724                                            1724 08726000
         TM    SCANONLY,B'00010000'                                1724 08727000
         BNZ   @RF01724                                            1724 08728000
*DOGRP150:       DO;                                       /*@YL026UL*/ 08729000
DOGRP150 DS    0H                                                  1726 08730000
*                SCLRCNT=0;                                /*@YL026UL*/ 08731000
         SLR   @05,@05                                             1726 08732000
         STH   @05,SCLRCNT                                         1726 08733000
*                ORGSIGN=BLANK;                            /*@YL026UL*/ 08734000
         MVI   ORGSIGN,C' '                                        1727 08735000
*                PWORD=NONE;                               /*@YL026UL*/ 08736000
*                                                                  1728 08737000
         SLR   PWORD,PWORD                                         1728 08738000
*                /****************************************************/ 08739000
*                /*                                                  */ 08740000
*                /* IF THE CONSTANT IS A HEX OR BINARY       @YL026UL*/ 08741000
*                /* CONSTANT, EXTRACT THE BINARY OR HEX      @YL026UL*/ 08742000
*                /* DESIGNATION CHAR. AND REMOVE DELIMITING  @YL026UL*/ 08743000
*                /* APOSTROPHES BEFORE PLACING THE VALUE IN  @YL026UL*/ 08744000
*                /* THE FDT.  OTHERWISE, PLACE THE CONSTANT  @YL026UL*/ 08745000
*                /* INTO THE FDT IN ITS PROVIDED FORM.       @YL026UL*/ 08746000
*                /*                                                  */ 08747000
*                /****************************************************/ 08748000
*                DEFLTPTR=PARMPTR(PARMID)+LENGTH(PARMDATA)+        1729 08749000
*                          LENGTH(DSCRPTR2);               /*@YL026UL*/ 08750000
         LA    @15,12                                              1729 08751000
         LR    @14,@15                                             1729 08752000
         MH    @14,PARMID                                          1729 08753000
         L     @01,WORKPTR                                         1729 08754000
         AL    @01,@CF01440                                        1729 08755000
         L     @14,PARMPTR(@14,@01)                                1729 08756000
         LA    DEFLTPTR,24                                         1729 08757000
         ALR   DEFLTPTR,@14                                        1729 08758000
*                RESPECIFY(DEFLT) BASED(DEFLTPTR);         /*@YL026UL*/ 08759000
*                IF (NUMBER=YES | ANYSTRNG=YES) & DEFLTLEN > 3 &   1731 08760000
*                   (DEFLTVAL(1)=BINSIGN | DEFLTVAL(1)=HEXSIGN) &  1731 08761000
*                   DEFLTVAL(2)=QUOTE & DEFLTVAL(DEFLTLEN)=QUOTE   1731 08762000
*                  THEN                                            1731 08763000
         ALR   @14,@15                                             1731 08764000
         TM    NUMBER(@14),B'11000000'                             1731 08765000
         BZ    @RF01731                                            1731 08766000
         CLI   DEFLTLEN(DEFLTPTR),3                                1731 08767000
         BNH   @RF01731                                            1731 08768000
         CLI   DEFLTVAL(DEFLTPTR),C'B'                             1731 08769000
         BE    @GL00099                                            1731 08770000
         CLI   DEFLTVAL(DEFLTPTR),C'X'                             1731 08771000
         BNE   @RF01731                                            1731 08772000
@GL00099 CLI   DEFLTVAL+1(DEFLTPTR),C''''                          1731 08773000
         BNE   @RF01731                                            1731 08774000
         SLR   @05,@05                                             1731 08775000
         IC    @05,DEFLTLEN(,DEFLTPTR)                             1731 08776000
         ALR   @05,DEFLTPTR                                        1731 08777000
         CLI   DEFLTVAL-1(@05),C''''                               1731 08778000
         BNE   @RF01731                                            1731 08779000
*                    DO;                                   /*@YL026UL*/ 08780000
*                    ORGSIGN=DEFLTVAL(1);                  /*@YL026UL*/ 08781000
         MVC   ORGSIGN(1),DEFLTVAL(DEFLTPTR)                       1733 08782000
*                    SYNUNIT=DEFLTVAL(3:DEFLTLEN-1);       /*@YL026UL*/ 08783000
         MVI   SYNUNIT+1,C' '                                      1734 08784000
         MVC   SYNUNIT+2(253),SYNUNIT+1                            1734 08785000
         SLR   @15,@15                                             1734 08786000
         IC    @15,DEFLTLEN(,DEFLTPTR)                             1734 08787000
         LR    @14,@15                                             1734 08788000
         SL    @14,@CF00052                                        1734 08789000
         EX    @14,@SM01500                                        1734 08790000
*                    UNITINDX=DEFLTLEN-3;                  /*@YL026UL*/ 08791000
         SL    @15,@CF00172                                        1735 08792000
         LR    UNITINDX,@15                                        1735 08793000
*                    END;                                  /*@YL026UL*/ 08794000
*                  ELSE                                            1737 08795000
*                    DO;                                   /*@YL026UL*/ 08796000
         B     @RC01731                                            1737 08797000
@RF01731 DS    0H                                                  1738 08798000
*                    OLDERID2 = NEWERID2;                          1738 08799000
         L     @15,GDTTR2(,GDTPTR)                                 1738 08800000
         MVC   @TS00001(95),NEWERID2(@15)                          1738 08801000
         MVC   OLDERID2(95,@15),@TS00001                           1738 08802000
*                    NEWID2='RI45';                        /*@YL026UL*/ 08803000
         MVC   NEWID2(4,@15),@CC01298                              1739 08804000
*                    SYNUNIT=DEFLTVAL(1:DEFLTLEN);         /*@YL026UL*/ 08805000
         MVI   SYNUNIT+1,C' '                                      1740 08806000
         MVC   SYNUNIT+2(253),SYNUNIT+1                            1740 08807000
         SLR   @15,@15                                             1740 08808000
         IC    @15,DEFLTLEN(,DEFLTPTR)                             1740 08809000
         LR    @14,@15                                             1740 08810000
         BCTR  @14,0                                               1740 08811000
         EX    @14,@SM01502                                        1740 08812000
*                    UNITINDX=DEFLTLEN;                    /*@YL026UL*/ 08813000
         LR    UNITINDX,@15                                        1741 08814000
*                    END;                                          1742 08815000
*                                                                  1742 08816000
*                CALL BUILDFDT;                            /*@YL026UL*/ 08817000
*                                                                  1743 08818000
@RC01731 BAL   @14,BUILDFDT                                        1743 08819000
*                END DOGRP150;                             /*@YL026UL*/ 08820000
*            END DOGRP145;                                 /*@YL026UL*/ 08821000
*                                                                  1745 08822000
*        END SETDFLT;                                      /*@YL026UL*/ 08823000
*                                                                  1746 08824000
*                                                                  1746 08825000
@EL00022 DS    0H                                                  1746 08826000
@EF00022 DS    0H                                                  1746 08827000
@ER00022 LM    @14,@04,@SA00022                                    1746 08828000
         LM    @06,@12,@SA00022+28                                 1746 08829000
         BR    @14                                                 1746 08830000
*        END DEFAULTS;                                     /*@YL026UL*/ 08831000
@EL00021 DS    0H                                                  1747 08832000
@EF00021 DS    0H                                                  1747 08833000
@ER00021 LM    @14,@04,@SA00021                                    1747 08834000
         LM    @06,@12,@SA00021+28                                 1747 08835000
         BR    @14                                                 1747 08836000
*/********************************************************************/ 08837000
*/*                                                                  */ 08838000
*/*  PROCEDURE NAME - NEEDNOTS                                       */ 08839000
*/*                                                                  */ 08840000
*/*  FUNCTION - THIS ROUTINE CHECKS PARAMETERS TO INSURE THAT CERTAIN*/ 08841000
*/*             SEMANTIC REQUIREMENTS HAVE NOT BEEN VIOLATED.  EACH  */ 08842000
*/*             INPUT PARAMETER IS EXAMINED, CHECKING THAT OTHER     */ 08843000
*/*             PARAMETERS HAVE BEEN INPUT WHICH MUST BE PRESENT WHEN*/ 08844000
*/*             THIS PARAMETER IS PRESENT, AND CHECKING THAT CERTAIN */ 08845000
*/*             PARAMETERS ARE NOT INPUT WHICH MUST NOT BE PRESENT   */ 08846000
*/*             WHEN THIS PARAMETER IS PRESENT.  THIS ROUTINE IS     */ 08847000
*/*             CALLED WHEN SCANNING OF A REPEATED SUBPARAMETER LIST */ 08848000
*/*             REPETITION HAS JUST BEEN COMPLETED (ONLY REQUIREMENTS*/ 08849000
*/*             WITHIN THE SUBLIST ARE CHECKED) AND THE ROUTINE IS   */ 08850000
*/*             CALLED AT COMMAND TERMINATION (AT WHICH TIME ALL THE */ 08851000
*/*             PARAMETER RELATIONSHIPS ARE CHECKED EXCEPT THOSE     */ 08852000
*/*             INVOLVING PARAMETERS WITHIN A REPEATED SUBLIST).     */ 08853000
*/*             'NEED' AND 'NOT' RELATIONSHIPS ARE NOT ALLOWED       */ 08854000
*/*             BETWEEN A PARAMETER WITHIN A REPEATED SUBLIST AND A  */ 08855000
*/*             PARAMETER NOT WITHIN THAT SAME SUBLIST. THE SEMANTIC */ 08856000
*/*             REQUIREMENTS ARE CHECKED AFTER DEFAULTS ARE APPLIED. */ 08857000
*/*                                                                  */ 08858000
*/*  INPUT -                                                         */ 08859000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND                  */ 08860000
*/*          SUPERID - ID# OF THE PARAMETER WHOSE SUBLIST IS BEING   */ 08861000
*/*                    CHECKED FOR SEMANTIC CORRECTNESS; ID#=0 IF    */ 08862000
*/*                    CHECKING THE COMMAND AS A WHOLE               */ 08863000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/ 08864000
*/*                                                                  */ 08865000
*/*  OUTPUT -  NONE                                                  */ 08866000
*/*                                                                  */ 08867000
*/********************************************************************/ 08868000
*NEEDNOTS:PROCEDURE;                                               1748 08869000
NEEDNOTS STM   @14,@12,@SA00023                                    1748 08870000
*        /************************************************************/ 08871000
*        /*                                                          */ 08872000
*        /* NEEDNOTS PROCEDURE DATA DEFINITIONS                      */ 08873000
*        /*                                                          */ 08874000
*        /************************************************************/ 08875000
*                                                                  1749 08876000
*        /* STATIC ERROR MESSAGE CODES                               */ 08877000
*        DCL MISSPARM FIXED(31)        /*REQUIRED PARM IS MISSING    */ 08878000
*                     CONSTANT(26);                                1749 08879000
*        DCL BADPARM  FIXED(31)        /*PARAMETER IS PRESENT WHICH  */ 08880000
*                     CONSTANT(27);    /* IS NOT ALLOWED             */ 08881000
*                                                                  1750 08882000
*        DCL WORKVAR3 FIXED(15);       /*VARIABLE TO CONTAIN @YL026UL*/ 08883000
*                                      /*A TEMPORARY VALUE   @YL026UL*/ 08884000
*        DCL FOUNDONE BIT(1);          /*FLAG SET TO AVOID PRINTING     08885000
*                                        THE SAME ERROR MSG TWICE    */ 08886000
*        /************************************************************/ 08887000
*        /*                                                          */ 08888000
*        /*  ** NEEDNOTS **  CHECK 'NEED' AND 'NOT' REQUIREMENTS     */ 08889000
*        /*                                                          */ 08890000
*        /************************************************************/ 08891000
*        IF GDTDBG = NULLPTR                                       1753 08892000
*          THEN;                                                   1753 08893000
         ICM   @02,15,GDTDBG(GDTPTR)                               1753 08894000
         BZ    @RT01753                                            1753 08895000
*          ELSE                                                    1755 08896000
*            CALL IDCDB010(GDTTBL,'RINN');                         1755 08897000
*                                                                  1755 08898000
         ST    GDTPTR,@AL00001                                     1755 08899000
         LA    @02,@CC01308                                        1755 08900000
         ST    @02,@AL00001+4                                      1755 08901000
         MVI   @AL00001+4,X'80'                                    1755 08902000
         L     @15,GDTDBG(,GDTPTR)                                 1755 08903000
         LA    @01,@AL00001                                        1755 08904000
         BALR  @14,@15                                             1755 08905000
*        /************************************************************/ 08906000
*        /*                                                          */ 08907000
*        /* IF AT COMMAND END, CHECK VERB LEVEL 'NEED        @YL026UL*/ 08908000
*        /* GROUPS'.  THAT IS, CHECK FOR GROUPS OF PARMS     @YL026UL*/ 08909000
*        /* (WHICH DON'T APPEAR WITHIN REPEATED SUBLISTS)    @YL026UL*/ 08910000
*        /* ONE OF WHICH MUST BE INPUT.                      @YL026UL*/ 08911000
*        /*                                                          */ 08912000
*        /************************************************************/ 08913000
*        IF SUPERID(PARMLVL)=0 & VNGRPDSP>0                        1756 08914000
*          THEN                                                    1756 08915000
@RT01753 LH    @02,PARMLVL                                         1756 08916000
         ALR   @02,@02                                             1756 08917000
         LH    @02,SUPERID-2(@02)                                  1756 08918000
         LTR   @02,@02                                             1756 08919000
         BNZ   @RF01756                                            1756 08920000
         L     @02,DESCPTR                                         1756 08921000
         CLI   VNGRPDSP(@02),0                                     1756 08922000
         BNH   @RF01756                                            1756 08923000
*DOGRP155:   DO;                                           /*@YL026UL*/ 08924000
DOGRP155 DS    0H                                                  1758 08925000
*              GRPPTR=ADDR(VNGRPTOT)+LENGTH(VNGRPTOT);     /*@YL026UL*/ 08926000
         L     @02,DESCPTR                                         1758 08927000
         SLR   @15,@15                                             1758 08928000
         IC    @15,VNGRPDSP(,@02)                                  1758 08929000
         ALR   @15,@15                                             1758 08930000
         ALR   @02,@15                                             1758 08931000
         AL    @02,@CF00163                                        1758 08932000
         ST    @02,GRPPTR                                          1758 08933000
*DOLOOP35:     DO LISTINDX=1 TO VNGRPTOT;                  /*@YL026UL*/ 08934000
DOLOOP35 LA    @02,1                                               1759 08935000
         B     @DE01759                                            1759 08936000
@DL01759 DS    0H                                                  1760 08937000
*                FOUNDONE=NO;                              /*@YL026UL*/ 08938000
*                                                                  1760 08939000
         NI    FOUNDONE,B'01111111'                                1760 08940000
*                /****************************************************/ 08941000
*                /*                                                  */ 08942000
*                /* CHECK EACH 'NEED GROUP' SUBLIST TO BE    @YL026UL*/ 08943000
*                /* SURE AT LEAST ONE OF THE PARAMETERS OF   @YL026UL*/ 08944000
*                /* IDENTIFIED IN THE SUBLIST IS INPUT.      @YL026UL*/ 08945000
*                /*                                                  */ 08946000
*                /****************************************************/ 08947000
*                DO INDEX2=1 TO VNGRPCNT;                  /*@YL026UL*/ 08948000
         LA    @02,1                                               1761 08949000
         B     @DE01761                                            1761 08950000
@DL01761 DS    0H                                                  1762 08951000
*                  IF PARMFLAG(VNGRPID(INDEX2))^=0                 1762 08952000
*                    THEN                                          1762 08953000
         ALR   @02,@02                                             1762 08954000
         L     @01,GRPPTR                                          1762 08955000
         LH    @02,VNGRPID-2(@02,@01)                              1762 08956000
         MH    @02,@CH00038                                        1762 08957000
         L     @01,WORKPTR                                         1762 08958000
         BCTR  @01,0                                               1762 08959000
         BCTR  @01,0                                               1762 08960000
         SLR   @00,@00                                             1762 08961000
         IC    @00,PARMFLAG-10(@02,@01)                            1762 08962000
         CH    @00,@CH00125                                        1762 08963000
         BE    @RF01762                                            1762 08964000
*                      FOUNDONE=YES;                       /*@YL026UL*/ 08965000
         OI    FOUNDONE,B'10000000'                                1763 08966000
*                END;                                      /*@YL026UL*/ 08967000
@RF01762 LA    @02,1                                               1764 08968000
         AH    @02,INDEX2                                          1764 08969000
@DE01761 STH   @02,INDEX2                                          1764 08970000
         L     @01,GRPPTR                                          1764 08971000
         CH    @02,VNGRPCNT(,@01)                                  1764 08972000
         BNH   @DL01761                                            1764 08973000
*                IF FOUNDONE=NO                                    1765 08974000
*                  THEN                                            1765 08975000
*                                                                  1765 08976000
         TM    FOUNDONE,B'10000000'                                1765 08977000
         BNZ   @RF01765                                            1765 08978000
*                    CALL ERRSETUP(MISSPARM,VNGRPID(1));   /*@YL026UL*/ 08979000
*                                                                  1766 08980000
         LA    @02,@CF01303                                        1766 08981000
         ST    @02,@AL00001                                        1766 08982000
         L     @02,GRPPTR                                          1766 08983000
         LA    @02,VNGRPID(,@02)                                   1766 08984000
         ST    @02,@AL00001+4                                      1766 08985000
         LA    @01,@AL00001                                        1766 08986000
         BAL   @14,ERRSETUP                                        1766 08987000
*                GRPPTR=GRPPTR+LENGTH(VNGRPCNT)+                   1767 08988000
*                            VNGRPCNT*LENGTH(VNGRPID(1));  /*@YL026UL*/ 08989000
@RF01765 L     @02,GRPPTR                                          1767 08990000
         LA    @15,2                                               1767 08991000
         ALR   @15,@02                                             1767 08992000
         LH    @02,VNGRPCNT(,@02)                                  1767 08993000
         ALR   @02,@02                                             1767 08994000
         ALR   @15,@02                                             1767 08995000
         ST    @15,GRPPTR                                          1767 08996000
*              END DOLOOP35;                               /*@YL026UL*/ 08997000
         LA    @02,1                                               1768 08998000
         AH    @02,LISTINDX                                        1768 08999000
@DE01759 STH   @02,LISTINDX                                        1768 09000000
         L     @01,DESCPTR                                         1768 09001000
         SLR   @15,@15                                             1768 09002000
         IC    @15,VNGRPDSP(,@01)                                  1768 09003000
         ALR   @15,@15                                             1768 09004000
         AL    @15,DESCPTR                                         1768 09005000
         CH    @02,VNGRPTOT(,@15)                                  1768 09006000
         BNH   @DL01759                                            1768 09007000
*            END DOGRP155;                                 /*@YL026UL*/ 09008000
*                                                                  1769 09009000
*        /************************************************************/ 09010000
*        /*                                                          */ 09011000
*        /* CHECK EACH PARAMETER TO SEE IF IT IS PART OF THE @YL026UL*/ 09012000
*        /* SET OF PARAMETERS CURRENTLY BEING HANDLED.  IF   @YL026UL*/ 09013000
*        /* SO, CHECK THE LIST(S) OF REQUIRED PARAMETERS     @YL026UL*/ 09014000
*        /* AND CONFLICTING PARAMETERS ASSOCIATED WITH EACH  @YL026UL*/ 09015000
*        /* PARAMETER TO SEE IF ANY ERRORS EXIST.            @YL026UL*/ 09016000
*        /*                                                          */ 09017000
*        /************************************************************/ 09018000
*DOLOOP40:DO PARMID=1 TO MAXID;                            /*@YL026UL*/ 09019000
@RF01756 DS    0H                                                  1770 09020000
DOLOOP40 LA    @02,1                                               1770 09021000
         B     @DE01770                                            1770 09022000
@DL01770 DS    0H                                                  1771 09023000
*          IF PARMFLAG(PARMID)^=0                                  1771 09024000
*            THEN                                                  1771 09025000
         MH    @02,@CH00038                                        1771 09026000
         L     @01,WORKPTR                                         1771 09027000
         BCTR  @01,0                                               1771 09028000
         BCTR  @01,0                                               1771 09029000
         SLR   @00,@00                                             1771 09030000
         IC    @00,PARMFLAG-10(@02,@01)                            1771 09031000
         CH    @00,@CH00125                                        1771 09032000
         BE    @RF01771                                            1771 09033000
*DOGRP170:     DO;                                         /*@YL026UL*/ 09034000
DOGRP170 DS    0H                                                  1773 09035000
*                FOUND=NO;                                 /*@YL026UL*/ 09036000
         NI    FOUND,B'11011111'                                   1773 09037000
*                TESTID=PARMID;                            /*@YL026UL*/ 09038000
         LH    TESTID,PARMID                                       1774 09039000
*                DO WHILE(TESTID^=0 & FOUND=NO);           /*@YL026UL*/ 09040000
         B     @DE01775                                            1775 09041000
@DL01775 DS    0H                                                  1776 09042000
*                  IF SUPRPARM(TESTID)=SUPERID(PARMLVL)            1776 09043000
*                    THEN                                          1776 09044000
         LR    @05,TESTID                                          1776 09045000
         MH    @05,@CH00038                                        1776 09046000
         LH    @02,PARMLVL                                         1776 09047000
         ALR   @02,@02                                             1776 09048000
         L     @01,WORKPTR                                         1776 09049000
         AL    @01,@CF01441                                        1776 09050000
         LH    @05,SUPRPARM-8(@05,@01)                             1776 09051000
         CH    @05,SUPERID-2(@02)                                  1776 09052000
         BNE   @RF01776                                            1776 09053000
*                      FOUND=YES;                          /*@YL026UL*/ 09054000
         OI    FOUND,B'00100000'                                   1777 09055000
*                    ELSE                                          1778 09056000
*                      DO;                                 /*@YL026UL*/ 09057000
         B     @RC01776                                            1778 09058000
@RF01776 DS    0H                                                  1779 09059000
*                      TESTID=SUPRPARM(TESTID);            /*@YL026UL*/ 09060000
         L     @05,WORKPTR                                         1779 09061000
         LA    @02,12                                              1779 09062000
         LR    @01,TESTID                                          1779 09063000
         MR    @00,@02                                             1779 09064000
         AL    @01,@CF01441                                        1779 09065000
         LH    @15,SUPRPARM-8(@01,@05)                             1779 09066000
         LR    TESTID,@15                                          1779 09067000
*                      IF PARMPTR(TESTID)->REPEATED=YES            1780 09068000
*                        THEN                                      1780 09069000
         LR    @01,@02                                             1780 09070000
         MR    @00,TESTID                                          1780 09071000
         AL    @05,@CF01440                                        1780 09072000
         L     @05,PARMPTR(@01,@05)                                1780 09073000
         TM    REPEATED(@05),B'00100000'                           1780 09074000
         BNO   @RF01780                                            1780 09075000
*                          TESTID=0;                       /*@YL026UL*/ 09076000
         SLR   TESTID,TESTID                                       1781 09077000
*                      END;                                /*@YL026UL*/ 09078000
@RF01780 DS    0H                                                  1783 09079000
*                END;                                      /*@YL026UL*/ 09080000
*                                                                  1783 09081000
@RC01776 DS    0H                                                  1783 09082000
@DE01775 LTR   TESTID,TESTID                                       1783 09083000
         BZ    @DC01775                                            1783 09084000
         TM    FOUND,B'00100000'                                   1783 09085000
         BZ    @DL01775                                            1783 09086000
@DC01775 DS    0H                                                  1784 09087000
*                IF FOUND=YES                                      1784 09088000
*                  THEN                                            1784 09089000
         TM    FOUND,B'00100000'                                   1784 09090000
         BNO   @RF01784                                            1784 09091000
*DOGRP160:           DO;                                   /*@YL026UL*/ 09092000
*                                                                  1785 09093000
DOGRP160 DS    0H                                                  1786 09094000
*                    /************************************************/ 09095000
*                    /*                                              */ 09096000
*                    /* IF 'NEED GROUPS' EXIST FOR THIS      @YL026UL*/ 09097000
*                    /* PARAMETER, CHECK TO INSURE THAT AT   @YL026UL*/ 09098000
*                    /* LEAST ONE PARAMETER IN EACH GROUP    @YL026UL*/ 09099000
*                    /* IS INPUT (A 'GROUP' MAY BE JUST A    @YL026UL*/ 09100000
*                    /* SINGLE PARAMETER THAT IS ALWAYS      @YL026UL*/ 09101000
*                    /* REQUIRED).                           @YL026UL*/ 09102000
*                    /*                                              */ 09103000
*                    /************************************************/ 09104000
*                    IF NGRPDSPL > 0                               1786 09105000
*                      THEN                                        1786 09106000
         LH    @02,PARMID                                          1786 09107000
         MH    @02,@CH00038                                        1786 09108000
         L     @01,WORKPTR                                         1786 09109000
         AL    @01,@CF01440                                        1786 09110000
         L     @02,PARMPTR(@02,@01)                                1786 09111000
         CLI   NGRPDSPL(@02),0                                     1786 09112000
         BNH   @RF01786                                            1786 09113000
*DOGRP165:               DO;                               /*@YL026UL*/ 09114000
DOGRP165 DS    0H                                                  1788 09115000
*                          GRPPTR=ADDR(NGRPTOT)+                   1788 09116000
*                                          LENGTH(NGRPTOT);/*@YL026UL*/ 09117000
         LH    @15,PARMID                                          1788 09118000
         MH    @15,@CH00038                                        1788 09119000
         L     @01,WORKPTR                                         1788 09120000
         AL    @01,@CF01440                                        1788 09121000
         L     @15,PARMPTR(@15,@01)                                1788 09122000
         SLR   @14,@14                                             1788 09123000
         IC    @14,NGRPDSPL(,@15)                                  1788 09124000
         ALR   @14,@14                                             1788 09125000
         ALR   @15,@14                                             1788 09126000
         LA    @14,2                                               1788 09127000
         ALR   @14,@15                                             1788 09128000
         ST    @14,GRPPTR                                          1788 09129000
*                          WORKVAR3=NGRPTOT;               /*@YL026UL*/ 09130000
         LH    WORKVAR3,NGRPTOT(,@15)                              1789 09131000
*DOLOOP42:                 DO LISTINDX=1 TO WORKVAR3;      /*@YL026UL*/ 09132000
DOLOOP42 LA    @15,1                                               1790 09133000
         B     @DE01790                                            1790 09134000
@DL01790 DS    0H                                                  1791 09135000
*                            FOUNDONE=NO;                  /*@YL026UL*/ 09136000
         NI    FOUNDONE,B'01111111'                                1791 09137000
*                            DO INDEX2=1 TO NGRPCNT;       /*@YL026UL*/ 09138000
         LA    @15,1                                               1792 09139000
         B     @DE01792                                            1792 09140000
@DL01792 DS    0H                                                  1793 09141000
*                              IF PARMFLAG(NGRPID(INDEX2))^=0      1793 09142000
*                                THEN                              1793 09143000
         ALR   @15,@15                                             1793 09144000
         L     @01,GRPPTR                                          1793 09145000
         LH    @15,NGRPID-2(@15,@01)                               1793 09146000
         MH    @15,@CH00038                                        1793 09147000
         L     @01,WORKPTR                                         1793 09148000
         BCTR  @01,0                                               1793 09149000
         BCTR  @01,0                                               1793 09150000
         SLR   @14,@14                                             1793 09151000
         IC    @14,PARMFLAG-10(@15,@01)                            1793 09152000
         CH    @14,@CH00125                                        1793 09153000
         BE    @RF01793                                            1793 09154000
*                                  FOUNDONE=YES;           /*@YL026UL*/ 09155000
         OI    FOUNDONE,B'10000000'                                1794 09156000
*                            END;                          /*@YL026UL*/ 09157000
@RF01793 LA    @15,1                                               1795 09158000
         AH    @15,INDEX2                                          1795 09159000
@DE01792 STH   @15,INDEX2                                          1795 09160000
         L     @14,GRPPTR                                          1795 09161000
         CH    @15,NGRPCNT(,@14)                                   1795 09162000
         BNH   @DL01792                                            1795 09163000
*                            IF FOUNDONE=NO                        1796 09164000
*                              THEN                                1796 09165000
*                                                                  1796 09166000
         TM    FOUNDONE,B'10000000'                                1796 09167000
         BNZ   @RF01796                                            1796 09168000
*                                CALL ERRSETUP(MISSPARM,           1797 09169000
*                                              NGRPID(1)); /*@YL026UL*/ 09170000
*                                                                  1797 09171000
         LA    @15,@CF01303                                        1797 09172000
         ST    @15,@AL00001                                        1797 09173000
         L     @01,GRPPTR                                          1797 09174000
         LA    @15,NGRPID(,@01)                                    1797 09175000
         ST    @15,@AL00001+4                                      1797 09176000
         LA    @01,@AL00001                                        1797 09177000
         BAL   @14,ERRSETUP                                        1797 09178000
*                            GRPPTR=GRPPTR+LENGTH(NGRPCNT)+        1798 09179000
*                               NGRPCNT*LENGTH(NGRPID(1)); /*@YL026UL*/ 09180000
@RF01796 L     @15,GRPPTR                                          1798 09181000
         LA    @14,2                                               1798 09182000
         ALR   @14,@15                                             1798 09183000
         LH    @15,NGRPCNT(,@15)                                   1798 09184000
         ALR   @15,@15                                             1798 09185000
         ALR   @14,@15                                             1798 09186000
         ST    @14,GRPPTR                                          1798 09187000
*                          END DOLOOP42;                   /*@YL026UL*/ 09188000
         LA    @15,1                                               1799 09189000
         AH    @15,LISTINDX                                        1799 09190000
@DE01790 STH   @15,LISTINDX                                        1799 09191000
         CR    @15,WORKVAR3                                        1799 09192000
         BNH   @DL01790                                            1799 09193000
*                        END DOGRP165;                     /*@YL026UL*/ 09194000
*                                                                  1800 09195000
*                    /************************************************/ 09196000
*                    /*                                              */ 09197000
*                    /* IF A LIST OF PARAMETERS EXISTS       @YL026UL*/ 09198000
*                    /* NOTING PARAMETERS WHICH CONFLICT     @YL026UL*/ 09199000
*                    /* WITH THIS PARTICULAR PARAMETER,      @YL026UL*/ 09200000
*                    /* CHECK THAT NONE OF THEM WERE INPUT   @YL026UL*/ 09201000
*                    /*                                              */ 09202000
*                    /************************************************/ 09203000
*                    FOUNDONE=NO;                          /*@YL026UL*/ 09204000
@RF01786 NI    FOUNDONE,B'01111111'                                1801 09205000
*                    IF NOTDSPL > 0                                1802 09206000
*                      THEN                                        1802 09207000
         LH    @02,PARMID                                          1802 09208000
         MH    @02,@CH00038                                        1802 09209000
         L     @01,WORKPTR                                         1802 09210000
         AL    @01,@CF01440                                        1802 09211000
         L     @02,PARMPTR(@02,@01)                                1802 09212000
         CLI   NOTDSPL(@02),0                                      1802 09213000
         BNH   @RF01802                                            1802 09214000
*                        DO;                               /*@YL026UL*/ 09215000
         ST    @02,@TF00001                                        1803 09216000
*                          WORKVAR3=NOTCOUNT;              /*@YL026UL*/ 09217000
         L     @01,@TF00001                                        1804 09218000
         SLR   @15,@15                                             1804 09219000
         IC    @15,NOTDSPL(,@01)                                   1804 09220000
         ALR   @15,@15                                             1804 09221000
         AL    @15,@TF00001                                        1804 09222000
         LH    WORKVAR3,NOTCOUNT(,@15)                             1804 09223000
*                          DO LISTINDX=1 TO WORKVAR3               1805 09224000
*                                      WHILE(FOUNDONE=NO); /*@YL026UL*/ 09225000
         LA    @15,1                                               1805 09226000
         B     @DE01805                                            1805 09227000
@DL01805 TM    FOUNDONE,B'10000000'                                1805 09228000
         BNZ   @DC01805                                            1805 09229000
*                            IF PARMFLAG(NOTID(LISTINDX)) ^= 0     1806 09230000
*                              THEN                                1806 09231000
*                                                                  1806 09232000
         L     @14,WORKPTR                                         1806 09233000
         LA    @05,12                                              1806 09234000
         ALR   @15,@15                                             1806 09235000
         LR    @04,@05                                             1806 09236000
         MH    @04,PARMID                                          1806 09237000
         AL    @04,@CF01440                                        1806 09238000
         L     @04,PARMPTR(@04,@14)                                1806 09239000
         SLR   @01,@01                                             1806 09240000
         IC    @01,NOTDSPL(,@04)                                   1806 09241000
         ALR   @01,@01                                             1806 09242000
         ALR   @04,@01                                             1806 09243000
         MH    @05,NOTID-2(@15,@04)                                1806 09244000
         BCTR  @14,0                                               1806 09245000
         BCTR  @14,0                                               1806 09246000
         SLR   @15,@15                                             1806 09247000
         IC    @15,PARMFLAG-10(@05,@14)                            1806 09248000
         CH    @15,@CH00125                                        1806 09249000
         BE    @RF01806                                            1806 09250000
*                                CALL ERRSETUP(BADPARM,            1807 09251000
*                                              PARMID);    /*@YL026UL*/ 09252000
*                                                                  1807 09253000
         LA    @15,@CF01305                                        1807 09254000
         ST    @15,@AL00001                                        1807 09255000
         LA    @15,PARMID                                          1807 09256000
         ST    @15,@AL00001+4                                      1807 09257000
         LA    @01,@AL00001                                        1807 09258000
         BAL   @14,ERRSETUP                                        1807 09259000
*                          END;                            /*@YL026UL*/ 09260000
@RF01806 LA    @15,1                                               1808 09261000
         AH    @15,LISTINDX                                        1808 09262000
@DE01805 STH   @15,LISTINDX                                        1808 09263000
         CR    @15,WORKVAR3                                        1808 09264000
         BNH   @DL01805                                            1808 09265000
@DC01805 DS    0H                                                  1809 09266000
*                        END;                              /*@YL026UL*/ 09267000
*                                                                  1809 09268000
*                    /************************************************/ 09269000
*                    /*                                              */ 09270000
*                    /* IF THE CURRENT PARAMETER IS ONE OF   @YL026UL*/ 09271000
*                    /* THE PARMS IDENTIFIED IN A 'NOT       @YL026UL*/ 09272000
*                    /* GROUPS' SUBLIST (A SET OF MUTUALLY   @YL026UL*/ 09273000
*                    /* EXCLUSIVE PARAMETERS), THEN CHECK TO @YL026UL*/ 09274000
*                    /* BE SURE NONE OF THE OTHER PARAMETERS @YL026UL*/ 09275000
*                    /* IDENTIFIED IN THE SUBLIST WERE INPUT @YL026UL*/ 09276000
*                    /*                                              */ 09277000
*                    /************************************************/ 09278000
*                    IF NTGRPPTR(PARMID) ^= 0                      1810 09279000
*                      THEN                                        1810 09280000
@RF01802 LH    @02,PARMID                                          1810 09281000
         MH    @02,@CH00038                                        1810 09282000
         L     @01,WORKPTR                                         1810 09283000
         AL    @01,@CF01499                                        1810 09284000
         L     @02,NTGRPPTR-4(@02,@01)                             1810 09285000
         LTR   @02,@02                                             1810 09286000
         BZ    @RF01810                                            1810 09287000
*                        DO;                               /*@YL026UL*/ 09288000
*                          GRPPTR=NTGRPPTR(PARMID);        /*@YL026UL*/ 09289000
         ST    @02,GRPPTR                                          1812 09290000
*                          DO LISTINDX=1 TO NTGRPCNT               1813 09291000
*                                      WHILE(FOUNDONE=NO); /*@YL026UL*/ 09292000
         LA    @02,1                                               1813 09293000
         B     @DE01813                                            1813 09294000
@DL01813 TM    FOUNDONE,B'10000000'                                1813 09295000
         BNZ   @DC01813                                            1813 09296000
*                            IF PARMFLAG(NTGRPID(LISTINDX)) ^= 0  &     09297000
*                               NTGRPID(LISTINDX) ^= PARMID        1814 09298000
*                              THEN                                1814 09299000
*                                                                  1814 09300000
         ALR   @02,@02                                             1814 09301000
         L     @01,GRPPTR                                          1814 09302000
         LH    @02,NTGRPID-2(@02,@01)                              1814 09303000
         LR    @15,@02                                             1814 09304000
         MH    @15,@CH00038                                        1814 09305000
         L     @01,WORKPTR                                         1814 09306000
         BCTR  @01,0                                               1814 09307000
         BCTR  @01,0                                               1814 09308000
         SLR   @14,@14                                             1814 09309000
         IC    @14,PARMFLAG-10(@15,@01)                            1814 09310000
         CH    @14,@CH00125                                        1814 09311000
         BE    @RF01814                                            1814 09312000
         CH    @02,PARMID                                          1814 09313000
         BE    @RF01814                                            1814 09314000
*                                CALL ERRSETUP(BADPARM,            1815 09315000
*                                               PARMID);   /*@YL026UL*/ 09316000
*                                                                  1815 09317000
         LA    @02,@CF01305                                        1815 09318000
         ST    @02,@AL00001                                        1815 09319000
         LA    @02,PARMID                                          1815 09320000
         ST    @02,@AL00001+4                                      1815 09321000
         LA    @01,@AL00001                                        1815 09322000
         BAL   @14,ERRSETUP                                        1815 09323000
*                          END;                            /*@YL026UL*/ 09324000
@RF01814 LA    @02,1                                               1816 09325000
         AH    @02,LISTINDX                                        1816 09326000
@DE01813 STH   @02,LISTINDX                                        1816 09327000
         L     @01,GRPPTR                                          1816 09328000
         CH    @02,NTGRPCNT(,@01)                                  1816 09329000
         BNH   @DL01813                                            1816 09330000
@DC01813 DS    0H                                                  1817 09331000
*                        END;                              /*@YL026UL*/ 09332000
*                    END DOGRP160;                         /*@YL026UL*/ 09333000
@RF01810 DS    0H                                                  1819 09334000
*              END DOGRP170;                               /*@YL026UL*/ 09335000
@RF01784 DS    0H                                                  1820 09336000
*        END DOLOOP40;                                     /*@YL026UL*/ 09337000
@RF01771 LA    @02,1                                               1820 09338000
         AH    @02,PARMID                                          1820 09339000
@DE01770 STH   @02,PARMID                                          1820 09340000
         L     @01,DESCPTR                                         1820 09341000
         CH    @02,MAXID(,@01)                                     1820 09342000
         BNH   @DL01770                                            1820 09343000
*/********************************************************************/ 09344000
*/*                                                                  */ 09345000
*/*  PROCEDURE NAME - ERRSETUP                                       */ 09346000
*/*                                                                  */ 09347000
*/*  FUNCTION - THIS ROUTINE SEARCHES FOR A KEYWORD TO BE INSERTED   */ 09348000
*/*             INTO AN ERROR MESSAGE CONCERNING REQUIRED PARAMETERS */ 09349000
*/*             WHICH ARE MISSING OR INVALID COMBINATIONS OF PARM'S. */ 09350000
*/*                                                                  */ 09351000
*/*  INPUT -                                                         */ 09352000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND.                 */ 09353000
*/*          ERRPRMID- PARAMETER ID# OF PARAMETER WHICH IS IN ERROR  */ 09354000
*/*          ERRMSGID- MESSAGE ID# OF MESSAGE INTO WHICH THE KEYWORD */ 09355000
*/*                    IS TO BE INSERTED                             */ 09356000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/ 09357000
*/*                                                                  */ 09358000
*/*  OUTPUT -                                                        */ 09359000
*/*          ERRMSGID- SEE 'INPUT'                                   */ 09360000
*/*          ERRFIELD- CONTAINS THE KEYWORD TO BE INSERTED INTO THE  */ 09361000
*/*                    ERROR MESSAGE                                 */ 09362000
*/*                                                                  */ 09363000
*/********************************************************************/ 09364000
*ERRSETUP:PROCEDURE(ERRMSGID,          /*STATIC ERROR MESSAGE CODE   */ 09365000
*                   ERRPRMID);         /*PARM ID# OF INVALID PARM.   */ 09366000
         B     @PB00024                                            1821 09367000
ERRSETUP STM   @14,@12,@SA00024                                    1821 09368000
         MVC   @PC00024(8),0(@01)                                  1821 09369000
*        /************************************************************/ 09370000
*        /*                                                          */ 09371000
*        /* ERRSETUP ROUTINE DATA DEFINITIONS                        */ 09372000
*        /*                                                          */ 09373000
*        /************************************************************/ 09374000
*        DCL ERRMSGID FIXED(31);       /*STATIC ERROR MESSAGE CODE   */ 09375000
*        DCL ERRPRMID FIXED(15);       /*PARAMETER ID# OR MISSING OR    09376000
*                                        INCONSISTENT PARAMETER      */ 09377000
*        /************************************************************/ 09378000
*        /*                                                          */ 09379000
*        /*  ** ERRSETUP **  SET UP KEYWORD NAME FOR ERROR MESSAGE   */ 09380000
*        /*                                                          */ 09381000
*        /************************************************************/ 09382000
*                                                                  1824 09383000
*        FOUNDONE=YES;                                             1824 09384000
         OI    FOUNDONE,B'10000000'                                1824 09385000
*        TESTID=PARMID;                                            1825 09386000
         LH    TESTID,PARMID                                       1825 09387000
*        PARMID=ERRPRMID;                                          1826 09388000
         L     @05,@PC00024+4                                      1826 09389000
         MVC   PARMID(2),ERRPRMID(@05)                             1826 09390000
*        DO WHILE(PARMID ^= 0);                                    1827 09391000
         B     @DE01827                                            1827 09392000
@DL01827 DS    0H                                                  1828 09393000
*          IF KWDDSPL ^= 0                                         1828 09394000
*            THEN                                                  1828 09395000
         LH    @05,PARMID                                          1828 09396000
         MH    @05,@CH00038                                        1828 09397000
         L     @02,WORKPTR                                         1828 09398000
         AL    @02,@CF01440                                        1828 09399000
         L     @05,PARMPTR(@05,@02)                                1828 09400000
         CLI   KWDDSPL(@05),0                                      1828 09401000
         BE    @RF01828                                            1828 09402000
*              DO;                                                 1829 09403000
*              KWDPTR=ADDR(KWDCOUNT)+LENGTH(KWDCOUNT);             1830 09404000
         SLR   KWDPTR,KWDPTR                                       1830 09405000
         IC    KWDPTR,KWDDSPL(,@05)                                1830 09406000
         ALR   KWDPTR,KWDPTR                                       1830 09407000
         ALR   @05,KWDPTR                                          1830 09408000
         AL    @05,@CF00228                                        1830 09409000
         LR    KWDPTR,@05                                          1830 09410000
*              ERRFIELD=BLANK;                                     1831 09411000
         MVI   ERRFIELD+1,C' '                                     1831 09412000
         MVC   ERRFIELD+2(18),ERRFIELD+1                           1831 09413000
         MVI   ERRFIELD,C' '                                       1831 09414000
*              ERRFIELD=KWDITEM(1:KWDLEN);                         1832 09415000
         MVI   ERRFIELD+1,C' '                                     1832 09416000
         MVC   ERRFIELD+2(18),ERRFIELD+1                           1832 09417000
         SLR   @05,@05                                             1832 09418000
         IC    @05,KWDLEN(,KWDPTR)                                 1832 09419000
         BCTR  @05,0                                               1832 09420000
         EX    @05,@SM01504                                        1832 09421000
*              PARMID=0;                                           1833 09422000
         SLR   @05,@05                                             1833 09423000
         STH   @05,PARMID                                          1833 09424000
*              END;                                                1834 09425000
*            ELSE                                                  1835 09426000
*              PARMID=SUPRPARM(PARMID);                            1835 09427000
         B     @RC01828                                            1835 09428000
@RF01828 LH    @05,PARMID                                          1835 09429000
         MH    @05,@CH00038                                        1835 09430000
         L     @02,WORKPTR                                         1835 09431000
         AL    @02,@CF01441                                        1835 09432000
         LH    @05,SUPRPARM-8(@05,@02)                             1835 09433000
         STH   @05,PARMID                                          1835 09434000
*        END;                                                      1836 09435000
*                                                                  1836 09436000
@RC01828 DS    0H                                                  1836 09437000
@DE01827 ICM   @05,3,PARMID                                        1836 09438000
         BNZ   @DL01827                                            1836 09439000
*        CALL ERROR2(ERRMSGID,LENGTH(ERRFIELD),ADDR(ERRFIELD));    1837 09440000
*                                                                  1837 09441000
         L     @05,@PC00024                                        1837 09442000
         ST    @05,@AL00001                                        1837 09443000
         LA    @05,@CF00786                                        1837 09444000
         ST    @05,@AL00001+4                                      1837 09445000
         LA    @05,ERRFIELD                                        1837 09446000
         ST    @05,@AFTEMPS+36                                     1837 09447000
         LA    @05,@AFTEMPS+36                                     1837 09448000
         ST    @05,@AL00001+8                                      1837 09449000
         LA    @01,@AL00001                                        1837 09450000
         BAL   @14,ERROR2                                          1837 09451000
*        PARMID=TESTID;                                            1838 09452000
*                                                                  1838 09453000
         STH   TESTID,PARMID                                       1838 09454000
*        END ERRSETUP;                                             1839 09455000
*                                                                  1839 09456000
*                                                                  1839 09457000
@EL00024 DS    0H                                                  1839 09458000
@EF00024 DS    0H                                                  1839 09459000
@ER00024 LM    @14,@12,@SA00024                                    1839 09460000
         BR    @14                                                 1839 09461000
*        END NEEDNOTS;                                             1840 09462000
@EL00023 DS    0H                                                  1840 09463000
@EF00023 DS    0H                                                  1840 09464000
@ER00023 LM    @14,@12,@SA00023                                    1840 09465000
         BR    @14                                                 1840 09466000
*/********************************************************************/ 09467000
*/*                                                                  */ 09468000
*/*  PROCEDURE NAME - SKIPCMD                                        */ 09469000
*/*                                                                  */ 09470000
*/*  FUNCTION - THIS ROUTINE BYPASSES CHARACTERS UNTIL A COMMAND-END */ 09471000
*/*             DELIMITER IS FOUND WHICH DOES NOT APPEAR WITHIN A    */ 09472000
*/*             COMMENT.  IT IS INVOKED WHEN A SYNTAX OR SEMANTIC    */ 09473000
*/*             ERROR HAS BEEN FOUND WHICH REQUIRES THAT THE CURRENT */ 09474000
*/*             COMMAND BE BYPASSED.                                 */ 09475000
*/*                                                                  */ 09476000
*/*  INPUT -                                                         */ 09477000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 09478000
*/*                    CODE WHEN AN ERROR IS DETECTED.               */ 09479000
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED.               */ 09480000
*/*          CHAR2 -   NEXT INPUT CHARACTER TO BE EXTRACTED.         */ 09481000
*/*                                                                  */ 09482000
*/*  OUTPUT -                                                        */ 09483000
*/*          SKIPPAST- FLAG SET 'ON' TO SIGNAL THAT THE COMMAND HAS  */ 09484000
*/*                    BEEN BYPASSED.                                */ 09485000
*/*                                                                  */ 09486000
*/********************************************************************/ 09487000
*SKIPCMD:PROCEDURE;                                                1841 09488000
SKIPCMD  STM   @14,@12,@SA00025                                    1841 09489000
*        /************************************************************/ 09490000
*        /*                                                          */ 09491000
*        /* SKIPCMD PROCEDURE DATA DEFINITIONS                       */ 09492000
*        /*                                                          */ 09493000
*        /************************************************************/ 09494000
*        DCL SKIPDONE BIT(1);          /*THE COMMAND HAS BEEN      1842 09495000
*                                        COMPLETELY BYPASSED.        */ 09496000
*        /************************************************************/ 09497000
*        /*                                                          */ 09498000
*        /*  ** SKIPCMD **  BYPASS CURRENT COMMAND                   */ 09499000
*        /*                                                          */ 09500000
*        /************************************************************/ 09501000
*        IF GDTDBG = NULLPTR                                       1843 09502000
*          THEN;                                                   1843 09503000
         ICM   @02,15,GDTDBG(GDTPTR)                               1843 09504000
         BZ    @RT01843                                            1843 09505000
*          ELSE                                                    1845 09506000
*            CALL IDCDB010(GDTTBL,'RISK');                         1845 09507000
*                                                                  1845 09508000
         ST    GDTPTR,@AL00001                                     1845 09509000
         LA    @02,@CC01335                                        1845 09510000
         ST    @02,@AL00001+4                                      1845 09511000
         MVI   @AL00001+4,X'80'                                    1845 09512000
         L     @15,GDTDBG(,GDTPTR)                                 1845 09513000
         LA    @01,@AL00001                                        1845 09514000
         BALR  @14,@15                                             1845 09515000
*        COMMENT=NO;                                               1846 09516000
@RT01843 NI    COMMENT,B'10111111'                                 1846 09517000
*        SKIPDONE=NO;                                              1847 09518000
         NI    SKIPDONE,B'01111111'                                1847 09519000
*        SKIPPAST=YES;                                             1848 09520000
*                                                                  1848 09521000
         OI    SKIPPAST,B'00001000'                                1848 09522000
*        /************************************************************/ 09523000
*        /*                                                          */ 09524000
*        /* SCAN PAST CHARACTERS UNTIL THE COMMAND-END DELIMITER IS  */ 09525000
*        /* FOUND.  THE DELIMITER WILL NEVER BE WITHIN A COMMENT.    */ 09526000
*        /*                                                          */ 09527000
*        /************************************************************/ 09528000
*        DO WHILE(SKIPDONE=NO & RISTATUS^=EOFILE & RISTATUS^=SKIPREST); 09529000
         B     @DE01849                                            1849 09530000
@DL01849 DS    0H                                                  1850 09531000
*          IF COMMENT=NO                                           1850 09532000
*            THEN                                                  1850 09533000
         TM    COMMENT,B'01000000'                                 1850 09534000
         BNZ   @RF01850                                            1850 09535000
*              IF CHAR1=ENDDELIM                                   1851 09536000
*                THEN                                              1851 09537000
         CLI   CHAR1,C';'                                          1851 09538000
         BNE   @RF01851                                            1851 09539000
*                  SKIPDONE=YES;                                   1852 09540000
*                                                                  1852 09541000
         OI    SKIPDONE,B'10000000'                                1852 09542000
*                /****************************************************/ 09543000
*                /*                                                  */ 09544000
*                /* IF NOT COMMAND END, THEN CONTINUE SCANNING,      */ 09545000
*                /* CHECKING TO SEE IF THE BEGINNING OF A COMMENT    */ 09546000
*                /* HAS BEEN FOUND.                                  */ 09547000
*                /*                                                  */ 09548000
*                /****************************************************/ 09549000
*                ELSE                                              1853 09550000
*                  IF CHAR1=COMSTART(1) & CHAR2=COMSTART(2)        1853 09551000
*                    THEN                                          1853 09552000
         B     @RC01851                                            1853 09553000
@RF01851 CLC   CHAR1(1),COMSTART                                   1853 09554000
         BNE   @RF01853                                            1853 09555000
         CLC   CHAR2(1),COMSTART+1                                 1853 09556000
         BNE   @RF01853                                            1853 09557000
*                      DO;                                         1854 09558000
*                                                                  1854 09559000
*                      CALL NEXTCHAR;                              1855 09560000
*                                                                  1855 09561000
         BAL   @14,NEXTCHAR                                        1855 09562000
*                      COMMENT=YES;                                1856 09563000
         OI    COMMENT,B'01000000'                                 1856 09564000
*                      END;                                        1857 09565000
*                    ELSE;                                         1858 09566000
@RF01853 DS    0H                                                  1859 09567000
*            ELSE                                                  1859 09568000
*                                                                  1859 09569000
*              /******************************************************/ 09570000
*              /*                                                    */ 09571000
*              /* IF CURRENTLY BYPASSING CHARACTERS WITHIN A COMMENT,*/ 09572000
*              /* CHECK FOR THE COMMENT-END DELIMITER WHICH SIGNALS  */ 09573000
*              /* END OF COMMENT.  IF AN R/I-GENERATED SEMICOLON IS  */ 09574000
*              /* FOUND IN MID-COMMENT, CONSIDER THAT TO BE THE END  */ 09575000
*              /* OF THE COMMAND.                                    */ 09576000
*              /*                                                    */ 09577000
*              /******************************************************/ 09578000
*              IF CHAR1=COMEND(1) & CHAR2=COMEND(2)                1859 09579000
*                THEN                                              1859 09580000
         B     @RC01850                                            1859 09581000
@RF01850 CLC   CHAR1(1),COMEND                                     1859 09582000
         BNE   @RF01859                                            1859 09583000
         CLC   CHAR2(1),COMEND+1                                   1859 09584000
         BNE   @RF01859                                            1859 09585000
*                  DO;                                             1860 09586000
*                  COMMENT=NO;                                     1861 09587000
*                                                                  1861 09588000
         NI    COMMENT,B'10111111'                                 1861 09589000
*                  CALL NEXTCHAR;                                  1862 09590000
*                                                                  1862 09591000
         BAL   @14,NEXTCHAR                                        1862 09592000
*                  END;                                            1863 09593000
*                ELSE                                              1864 09594000
*                  IF CHAR1=ENDDELIM &                             1864 09595000
*                     (OPTSFLAG=ON | MORTOCOM=NO) &                1864 09596000
*                     SCANINDX >= SCNLIMIT                         1864 09597000
*                    THEN                                          1864 09598000
         B     @RC01859                                            1864 09599000
@RF01859 CLI   CHAR1,C';'                                          1864 09600000
         BNE   @RF01864                                            1864 09601000
         TM    OPTSFLAG,B'00100000'                                1864 09602000
         BO    @GL00108                                            1864 09603000
         TM    MORTOCOM,B'00010000'                                1864 09604000
         BNZ   @RF01864                                            1864 09605000
@GL00108 LH    @02,SCANINDX                                        1864 09606000
         CH    @02,SCNLIMIT                                        1864 09607000
         BL    @RF01864                                            1864 09608000
*                      SKIPDONE=YES;                               1865 09609000
*                                                                  1865 09610000
         OI    SKIPDONE,B'10000000'                                1865 09611000
*          /**********************************************************/ 09612000
*          /*                                                        */ 09613000
*          /* IF THE END OF THE COMMAND HAS NOT YET BEEN FOUND, GET  */ 09614000
*          /* THE NEXT INPUT CHARACTER.                              */ 09615000
*          /*                                                        */ 09616000
*          /**********************************************************/ 09617000
*          IF SKIPDONE=NO                                          1866 09618000
*            THEN                                                  1866 09619000
*                                                                  1866 09620000
@RF01864 DS    0H                                                  1866 09621000
@RC01859 DS    0H                                                  1866 09622000
@RC01850 TM    SKIPDONE,B'10000000'                                1866 09623000
         BNZ   @RF01866                                            1866 09624000
*              CALL NEXTCHAR;                                      1867 09625000
*                                                                  1867 09626000
         BAL   @14,NEXTCHAR                                        1867 09627000
*        END;                                                      1868 09628000
*                                                                  1868 09629000
@RF01866 DS    0H                                                  1868 09630000
@DE01849 TM    SKIPDONE,B'10000000'                                1868 09631000
         BNZ   @DC01849                                            1868 09632000
         LH    @02,RISTATUS                                        1868 09633000
         CH    @02,@CH00157                                        1868 09634000
         BE    @DC01849                                            1868 09635000
         CH    @02,@CH00042                                        1868 09636000
         BNE   @DL01849                                            1868 09637000
@DC01849 DS    0H                                                  1869 09638000
*        END SKIPCMD;                                              1869 09639000
@EL00025 DS    0H                                                  1869 09640000
@EF00025 DS    0H                                                  1869 09641000
@ER00025 LM    @14,@12,@SA00025                                    1869 09642000
         BR    @14                                                 1869 09643000
*/********************************************************************/ 09644000
*/*                                                                  */ 09645000
*/*  PROCEDURE NAME - SETFLAG                                        */ 09646000
*/*                                                                  */ 09647000
*/*  FUNCTION - THIS PROCEDURE SETS A FLAG IN AN ARRAY OF FLAGS TO   */ 09648000
*/*             TO NOTE THAT A GIVEN PARAMETER HAS BEEN INPUT.  THE  */ 09649000
*/*             NTH FLAG IS SET 'ON' WHEN THE PARAMETER WHOSE ID#=N  */ 09650000
*/*             HAS BEEN FOUND AS INPUT (EITHER EXTRACTED FROM THE   */ 09651000
*/*             INPUT RECORD OR INPUT BY DEFAULT).  ALSO, THE FDT    */ 09652000
*/*             VECTOR POINTER FOR THE PARAMETER IS SET TO A NON-NULL*/ 09653000
*/*             VALUE TO SIGNAL THE FSR THAT THE PARAMETER IS INPUT. */ 09654000
*/*                                                                  */ 09655000
*/*  INPUT -                                                         */ 09656000
*/*          COMMAND DESCRIPTOR FOR CURRENT COMMAND.                 */ 09657000
*/*          PARMID -  ID# OF THE PARAMETER BEING ACKNOWLEDGED       */ 09658000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/ 09659000
*/*                                                                  */ 09660000
*/*  OUTPUT -                                                        */ 09661000
*/*          PARMINFO- PARAMETER INFORMATION TABLE.          @YL026UL*/ 09662000
*/*          FUNCTION DATA TABLE POINTER VECTOR ENTRY                */ 09663000
*/*          ARRYPTR - POINTER TO FDT PTR VECTOR FOR THIS PARAMETER  */ 09664000
*/*                                                                  */ 09665000
*/********************************************************************/ 09666000
*SETFLAG:PROCEDURE;                                                1870 09667000
SETFLAG  STM   @14,@12,@SA00026                                    1870 09668000
*        /************************************************************/ 09669000
*        /*                                                          */ 09670000
*        /*  ** SETFLAG **  SET PARAMETER OCCURRENCE FLAG            */ 09671000
*        /*                                                          */ 09672000
*        /************************************************************/ 09673000
*        IF GDTDBG = NULLPTR                                       1871 09674000
*          THEN;                                                   1871 09675000
         ICM   @02,15,GDTDBG(GDTPTR)                               1871 09676000
         BZ    @RT01871                                            1871 09677000
*          ELSE                                                    1873 09678000
*            CALL IDCDB010(GDTTBL,'RISF');                         1873 09679000
*                                                                  1873 09680000
         ST    GDTPTR,@AL00001                                     1873 09681000
         LA    @02,@CC01339                                        1873 09682000
         ST    @02,@AL00001+4                                      1873 09683000
         MVI   @AL00001+4,X'80'                                    1873 09684000
         L     @15,GDTDBG(,GDTPTR)                                 1873 09685000
         LA    @01,@AL00001                                        1873 09686000
         BALR  @14,@15                                             1873 09687000
*        /************************************************************/ 09688000
*        /*                                                          */ 09689000
*        /* IF THE FLAG IS ALREADY SET, THE PARAMETER HAS ALREADY    */ 09690000
*        /* BEEN INPUT AND AN ERROR HAS OCCURRED.                    */ 09691000
*        /*                                                          */ 09692000
*        /************************************************************/ 09693000
*        IF PARMFLAG(PARMID)=1                                     1874 09694000
*          THEN                                                    1874 09695000
*                                                                  1874 09696000
@RT01871 LH    @02,PARMID                                          1874 09697000
         MH    @02,@CH00038                                        1874 09698000
         L     @01,WORKPTR                                         1874 09699000
         BCTR  @01,0                                               1874 09700000
         BCTR  @01,0                                               1874 09701000
         SLR   @00,@00                                             1874 09702000
         IC    @00,PARMFLAG-10(@02,@01)                            1874 09703000
         CH    @00,@CH00228                                        1874 09704000
         BNE   @RF01874                                            1874 09705000
*            CALL ERROR2(BADKWD3,LENGTH(ERRFIELD),ADDR(ERRFIELD)); 1875 09706000
*                                                                  1875 09707000
         MVC   @AL00001(8),@AL01875                                1875 09708000
         LA    @02,ERRFIELD                                        1875 09709000
         ST    @02,@AFTEMPS+40                                     1875 09710000
         LA    @02,@AFTEMPS+40                                     1875 09711000
         ST    @02,@AL00001+8                                      1875 09712000
         LA    @01,@AL00001                                        1875 09713000
         BAL   @14,ERROR2                                          1875 09714000
*          ELSE                                                    1876 09715000
*            PARMFLAG(PARMID)=1;                                   1876 09716000
*                                                                  1876 09717000
         B     @RC01874                                            1876 09718000
@RF01874 LH    @02,PARMID                                          1876 09719000
         MH    @02,@CH00038                                        1876 09720000
         LA    @15,1                                               1876 09721000
         L     @14,WORKPTR                                         1876 09722000
         BCTR  @14,0                                               1876 09723000
         BCTR  @14,0                                               1876 09724000
         STC   @15,PARMFLAG-10(@02,@14)                            1876 09725000
*        /************************************************************/ 09726000
*        /*                                                          */ 09727000
*        /* SET THE PARAMETER'S DATA POINTER TO A NON-ZERO VALUE TO  */ 09728000
*        /* SIGNAL THE FSR THAT THE PARAMETER HAS BEEN INPUT.        */ 09729000
*        /* CALCULATE THE POINTER LOCATION FOR PARAMETERS THAT ARE   */ 09730000
*        /* PART OF A REPEATED SUBPARAMETER LIST.                    */ 09731000
*        /*                                                          */ 09732000
*        /************************************************************/ 09733000
*        IF OCCURNUM > 1                                           1877 09734000
*          THEN                                                    1877 09735000
@RC01874 LH    @02,PARMID                                          1877 09736000
         LR    @15,@02                                             1877 09737000
         MH    @15,@CH00038                                        1877 09738000
         L     @01,WORKPTR                                         1877 09739000
         AL    @01,@CF01440                                        1877 09740000
         L     @01,PARMPTR(@15,@01)                                1877 09741000
         CLC   OCCURNUM(3,@01),@CF00228+1                          1877 09742000
         BNH   @RF01877                                            1877 09743000
*            DO;                                                   1878 09744000
*            ARRYPTR=FDTPTR(PARMID);                               1879 09745000
*                                                                  1879 09746000
         LH    @05,PARMID                                          1879 09747000
         SLA   @05,2                                               1879 09748000
         L     @01,FDTADDR                                         1879 09749000
         L     ARRYPTR,FDTPTR-4(@05,@01)                           1879 09750000
*            CALL DSPLCALC(REPDEPTH);                              1880 09751000
*                                                                  1880 09752000
         LA    @05,REPDEPTH                                        1880 09753000
         ST    @05,@AL00001                                        1880 09754000
         LA    @01,@AL00001                                        1880 09755000
         BAL   @14,DSPLCALC                                        1880 09756000
*            REPPTR=ADDR(REPPTR);                                  1881 09757000
         LR    @05,ARRYPTR                                         1881 09758000
         ALR   @05,ARRYDSPL                                        1881 09759000
         ST    @05,REPPTR(,@05)                                    1881 09760000
*            END;                                                  1882 09761000
*          ELSE                                                    1883 09762000
*            IF REPEATED=NO                                        1883 09763000
*              THEN                                                1883 09764000
         B     @RC01877                                            1883 09765000
@RF01877 LH    @02,PARMID                                          1883 09766000
         LR    @15,@02                                             1883 09767000
         MH    @15,@CH00038                                        1883 09768000
         L     @01,WORKPTR                                         1883 09769000
         AL    @01,@CF01440                                        1883 09770000
         L     @01,PARMPTR(@15,@01)                                1883 09771000
         TM    REPEATED(@01),B'00100000'                           1883 09772000
         BNZ   @RF01883                                            1883 09773000
*                FDTPTR(PARMID)=ADDR(FDTPTR(PARMID));              1884 09774000
*                                                                  1884 09775000
         L     @15,FDTADDR                                         1884 09776000
         SLA   @02,2                                               1884 09777000
         LA    @14,FDTPTR-4(@02,@15)                               1884 09778000
         ST    @14,FDTPTR-4(@02,@15)                               1884 09779000
*        END SETFLAG;                                              1885 09780000
@EL00026 DS    0H                                                  1885 09781000
@EF00026 DS    0H                                                  1885 09782000
@ER00026 LM    @14,@12,@SA00026                                    1885 09783000
         BR    @14                                                 1885 09784000
*/********************************************************************/ 09785000
*/*                                                                  */ 09786000
*/*  PROCEDURE NAME - PACKCVB                                        */ 09787000
*/*                                                                  */ 09788000
*/*  FUNCTION - THIS ROUTINE CONVERTS DECIMAL DIGITS IN EBCDIC FORM  */ 09789000
*/*             INTO FULLWORD BINARY FORM, AFTER CHECKING THAT THE   */ 09790000
*/*             DECIMAL NUMBER IS SPECIFIED CORRECTLY.               */ 09791000
*/*                                                                  */ 09792000
*/*  INPUT -                                                         */ 09793000
*/*          SYNUNIT - CONTAINS DECIMAL NUMBER IN EBCDIC FORM        */ 09794000
*/*          UNITINDX- LENGTH OF DECIMAL NUMBER IN EBCDIC FORM       */ 09795000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 09796000
*/*                    CODE WHEN AN ERROR IS FOUND.                  */ 09797000
*/*                                                                  */ 09798000
*/*  OUTPUT -                                                        */ 09799000
*/*          CNVRTWRD- CONVERTED NUMBER IN FULLWORD BINARY FORM      */ 09800000
*/*                                                                  */ 09801000
*/********************************************************************/ 09802000
*PACKCVB:PROCEDURE;                                                1886 09803000
PACKCVB  STM   @14,@12,@SA00027                                    1886 09804000
*        /************************************************************/ 09805000
*        /*                                                          */ 09806000
*        /* PACKCVB PROCEDURE DATA DEFINITIONS                       */ 09807000
*        /*                                                          */ 09808000
*        /************************************************************/ 09809000
*        DCL CVBNUM FIXED(31) REG(8);  /*REGISTER TO CONTAIN CONVERTED  09810000
*                                        FULLWORD NUMBERS            */ 09811000
*        /************************************************************/ 09812000
*        /*                                                          */ 09813000
*        /* ** PACKCVB **  CONVERT DECIMAL NUMBER TO BINARY FULLWORD */ 09814000
*        /*                                                          */ 09815000
*        /************************************************************/ 09816000
*        IF GDTDBG = NULLPTR                                       1888 09817000
*          THEN;                                                   1888 09818000
         ICM   @04,15,GDTDBG(GDTPTR)                               1888 09819000
         BZ    @RT01888                                            1888 09820000
*          ELSE                                                    1890 09821000
*            CALL IDCDB010(GDTTBL,'RIPC');                         1890 09822000
*                                                                  1890 09823000
         ST    GDTPTR,@AL00001                                     1890 09824000
         LA    @04,@CC01344                                        1890 09825000
         ST    @04,@AL00001+4                                      1890 09826000
         MVI   @AL00001+4,X'80'                                    1890 09827000
         L     @15,GDTDBG(,GDTPTR)                                 1890 09828000
         LA    @01,@AL00001                                        1890 09829000
         BALR  @14,@15                                             1890 09830000
*        ERRFIELD=SYNUNIT(1:UNITINDX);                             1891 09831000
@RT01888 MVI   ERRFIELD+1,C' '                                     1891 09832000
         MVC   ERRFIELD+2(18),ERRFIELD+1                           1891 09833000
         LR    @04,UNITINDX                                        1891 09834000
         BCTR  @04,0                                               1891 09835000
         EX    @04,@SM01506                                        1891 09836000
*        /************************************************************/ 09837000
*        /*                                                          */ 09838000
*        /* RIGHT-JUSTIFY THE DECIMAL DIGITS IN 'CNVRTFLD'; THEN     */ 09839000
*        /* CHECK THE DIGITS TO BE SURE THEY REPRESENT AN ACCEPTABLE */ 09840000
*        /* DECIMAL NUMBER.                                          */ 09841000
*        /*                                                          */ 09842000
*        /************************************************************/ 09843000
*        CNVRTFLD=BLANK;                                           1892 09844000
         MVI   CNVRTFLD+1,C' '                                     1892 09845000
         MVC   CNVRTFLD+2(8),CNVRTFLD+1                            1892 09846000
         MVI   CNVRTFLD,C' '                                       1892 09847000
*        IF UNITINDX <= LENGTH(MXDECNUM)                           1893 09848000
*          THEN                                                    1893 09849000
         LA    @04,10                                              1893 09850000
         CR    UNITINDX,@04                                        1893 09851000
         BH    @RF01893                                            1893 09852000
*            DO;                                                   1894 09853000
*            CNVRTFLD(LENGTH(MXDECNUM)-UNITINDX+1:LENGTH(MXDECNUM))=    09854000
*                  SYNUNIT(1:UNITINDX);                            1895 09855000
         LA    @02,10                                              1895 09856000
         SLR   @02,UNITINDX                                        1895 09857000
         LA    @01,CNVRTFLD(@02)                                   1895 09858000
         SLR   @04,UNITINDX                                        1895 09859000
         LA    @02,9                                               1895 09860000
         SLR   @02,@04                                             1895 09861000
         EX    @02,@SM01447                                        1895 09862000
*            IF CNVRTFLD <= MXDECNUM                               1896 09863000
*              THEN                                                1896 09864000
         CLC   CNVRTFLD(10),@CC00782                               1896 09865000
         BH    @RF01896                                            1896 09866000
*                DO INDEX=LENGTH(MXDECNUM)-UNITINDX+1 TO           1897 09867000
*                        LENGTH(MXDECNUM) WHILE(RISTATUS=0);       1897 09868000
         AL    @04,@CF00228                                        1897 09869000
         B     @DE01897                                            1897 09870000
@DL01897 ICM   @02,3,RISTATUS                                      1897 09871000
         BNZ   @DC01897                                            1897 09872000
*                  IF CNVRTFLD(INDEX) < '0' |                      1898 09873000
*                     CNVRTFLD(INDEX) > '9'                        1898 09874000
*                    THEN                                          1898 09875000
*                                                                  1898 09876000
         LA    @02,CNVRTFLD-1(@04)                                 1898 09877000
         CLI   0(@02),C'0'                                         1898 09878000
         BL    @RT01898                                            1898 09879000
         LA    @02,CNVRTFLD-1(@04)                                 1898 09880000
         CLI   0(@02),C'9'                                         1898 09881000
         BNH   @RF01898                                            1898 09882000
@RT01898 DS    0H                                                  1899 09883000
*                      CALL ERROR2(BADDIGIT,LENGTH(ERRFIELD),      1899 09884000
*                                  ADDR(ERRFIELD));                1899 09885000
*                                                                  1899 09886000
         MVC   @AL00001(8),@AL01899                                1899 09887000
         LA    @04,ERRFIELD                                        1899 09888000
         ST    @04,@AFTEMPS+44                                     1899 09889000
         LA    @04,@AFTEMPS+44                                     1899 09890000
         ST    @04,@AL00001+8                                      1899 09891000
         LA    @01,@AL00001                                        1899 09892000
         BAL   @14,ERROR2                                          1899 09893000
*                END;                                              1900 09894000
@RF01898 LA    @04,1                                               1900 09895000
         AH    @04,INDEX                                           1900 09896000
@DE01897 STH   @04,INDEX                                           1900 09897000
         CH    @04,@CH00040                                        1900 09898000
         BNH   @DL01897                                            1900 09899000
@DC01897 DS    0H                                                  1901 09900000
*              ELSE                                                1901 09901000
*                                                                  1901 09902000
*                CALL ERROR2(BADNUMSZ,LENGTH(ERRFIELD),ADDR(ERRFIELD)); 09903000
*                                                                  1901 09904000
         B     @RC01896                                            1901 09905000
@RF01896 MVC   @AL00001(8),@AL01901                                1901 09906000
         LA    @04,ERRFIELD                                        1901 09907000
         ST    @04,@AFTEMPS+44                                     1901 09908000
         LA    @04,@AFTEMPS+44                                     1901 09909000
         ST    @04,@AL00001+8                                      1901 09910000
         LA    @01,@AL00001                                        1901 09911000
         BAL   @14,ERROR2                                          1901 09912000
*            END;                                                  1902 09913000
*          ELSE                                                    1903 09914000
*                                                                  1903 09915000
*            CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),ADDR(ERRFIELD));     09916000
*                                                                  1903 09917000
         B     @RC01893                                            1903 09918000
@RF01893 MVC   @AL00001(8),@AL01903                                1903 09919000
         LA    @04,ERRFIELD                                        1903 09920000
         ST    @04,@AFTEMPS+44                                     1903 09921000
         LA    @04,@AFTEMPS+44                                     1903 09922000
         ST    @04,@AL00001+8                                      1903 09923000
         LA    @01,@AL00001                                        1903 09924000
         BAL   @14,ERROR2                                          1903 09925000
*        IF RISTATUS=0                                             1904 09926000
*          THEN                                                    1904 09927000
*                                                                  1904 09928000
@RC01893 ICM   @04,3,RISTATUS                                      1904 09929000
         BNZ   @RF01904                                            1904 09930000
*            /********************************************************/ 09931000
*            /*                                                      */ 09932000
*            /* PERFORM THE CONVERSION FROM EBCDIC TO BINARY FULLWORD*/ 09933000
*            /*                                                      */ 09934000
*            /********************************************************/ 09935000
*            DO;                                                   1905 09936000
*            SYNUNIT=CNVRTFLD;                                     1906 09937000
         MVI   SYNUNIT+10,C' '                                     1906 09938000
         MVC   SYNUNIT+11(244),SYNUNIT+10                          1906 09939000
         MVC   SYNUNIT(10),CNVRTFLD                                1906 09940000
*            RESPECIFY(CVBNUM) RSTD;                               1907 09941000
*            GEN(PACK   CNVRTFLD(8),SYNUNIT(10));                  1908 09942000
         PACK   CNVRTFLD(8),SYNUNIT(10)                                 09943000
*            GEN(CVB    CVBNUM,CNVRTFLD);                          1909 09944000
         CVB    CVBNUM,CNVRTFLD                                         09945000
*            CNVRTWRD=CVBNUM;                                      1910 09946000
         ST    CVBNUM,CNVRTWRD                                     1910 09947000
*            RESPECIFY(CVBNUM) UNRSTD;                             1911 09948000
*            END;                                                  1912 09949000
*                                                                  1912 09950000
*        END PACKCVB;                                              1913 09951000
@EL00027 DS    0H                                                  1913 09952000
@EF00027 DS    0H                                                  1913 09953000
@ER00027 LM    @14,@12,@SA00027                                    1913 09954000
         BR    @14                                                 1913 09955000
*/********************************************************************/ 09956000
*/*                                                                  */ 09957000
*/*  PROCEDURE NAME - NXTFIELD                                       */ 09958000
*/*                                                                  */ 09959000
*/*  FUNCTION - THIS ROUTINE EXTRACTS THE NEXT FIELD (VERB, KEYWORD, */ 09960000
*/*             OR SCALAR) FROM THE INPUT COMMAND.  CHECKS ARE MADE  */ 09961000
*/*             TO INSURE THAT LENGTH LIMITS ARE NOT EXCEEDED.       */ 09962000
*/*                                                                  */ 09963000
*/*  INPUT -                                                         */ 09964000
*/*          FLDTYPE - CONTAINS CODE INDICATING THE TYPE OF FIELD    */ 09965000
*/*                    TO BE EXTRACTED                               */ 09966000
*/*          CHAR1 -   MOST RECENTLY EXTRACTED CHARACTER             */ 09967000
*/*          CHAR2 -   NEXT INPUT CHARACTER TO BE EXTRACTED.         */ 09968000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 09969000
*/*                    CODE WHEN AN ERROR IS FOUND.                  */ 09970000
*/*                                                                  */ 09971000
*/*  OUTPUT -                                                        */ 09972000
*/*          SYNUNIT - THE EXTRACTED SYNTACTIC UNIT (FIELD)          */ 09973000
*/*          UNITINDX- LENGTH OF THE EXTRACTED FIELD                 */ 09974000
*/*          EOFOK -   FLAG SET 'ON' WHEN INPUT END-OF-FILE MAY      */ 09975000
*/*                    LEGITIMATELY BE ENCOUNTERED.                  */ 09976000
*/*          ERRFIELD- FIRST 20 CHARACTERS OF EXTRACTED FIELD WHICH  */ 09977000
*/*                    MAY BE USED IN AN ERROR MESSAGE LATER         */ 09978000
*/*                                                                  */ 09979000
*/********************************************************************/ 09980000
*NXTFIELD:PROCEDURE(FLDTYPE);          /*PARAMETER INDICATES THE TYPE   09981000
*                                        OF FIELD TO BE EXTRACTED.   */ 09982000
NXTFIELD STM   @14,@04,@SA00028                                    1914 09983000
         STM   @06,@12,@SA00028+28                                 1914 09984000
         MVC   @PC00028(4),0(@01)                                  1914 09985000
*        /************************************************************/ 09986000
*        /*                                                          */ 09987000
*        /* NXTFIELD PROCEDURE DATA DEFINITIONS                      */ 09988000
*        /*                                                          */ 09989000
*        /************************************************************/ 09990000
*        DCL FLDTYPE  FIXED(31);       /*TYPE OF DATA FIELD EXPECTED    09991000
*                                        TO BE EXTRACTED NEXT        */ 09992000
*        DCL PARENCNT FIXED(15);       /*NO. OF UNMATCHED    @YL026UL*/ 09993000
*                                      /* LEFT PARENTHESES   @YL026UL*/ 09994000
*                                      /* FOUND IN DSNAME    @YL026UL*/ 09995000
*                                      /* NOW BEING SCANNED  @YL026UL*/ 09996000
*                                                                  1917 09997000
*        /* STATIC ERROR MESSAGE CODE                                */ 09998000
*        DCL QUOTSEMI FIXED(31)        /*SEMICOLON APPEARS WITHIN A  */ 09999000
*                     CONSTANT(23);    /* QUOTED STRING              */ 10000000
*        /************************************************************/ 10001000
*        /*                                                          */ 10002000
*        /*  ** NXTFIELD **  EXTRACT NEXT FIELD FROM INPUT RECORD    */ 10003000
*        /*                                                          */ 10004000
*        /************************************************************/ 10005000
*                                                                  1918 10006000
*        DELIM=NO;                                                 1918 10007000
         NI    DELIM,B'11110111'                                   1918 10008000
*        UNITINDX=0;                                               1919 10009000
         SLR   UNITINDX,UNITINDX                                   1919 10010000
*        SYNUNIT=BLANK;                                            1920 10011000
         MVI   SYNUNIT+1,C' '                                      1920 10012000
         MVC   SYNUNIT+2(253),SYNUNIT+1                            1920 10013000
         MVI   SYNUNIT,C' '                                        1920 10014000
*        IF RISTATUS=0                                             1921 10015000
*          THEN                                                    1921 10016000
         ICM   @04,3,RISTATUS                                      1921 10017000
         BNZ   @RF01921                                            1921 10018000
*            EOFOK=NO;                                             1922 10019000
*                                                                  1922 10020000
         NI    EOFOK,B'10111111'                                   1922 10021000
*        /************************************************************/ 10022000
*        /*                                                          */ 10023000
*        /* IF A SIMPLE SCALAR FIELD IS TO BE EXTRACTED, THEN EXTRACT*/ 10024000
*        /* CHARACTERS UNTIL THE FIELD IS DELIMITED BY END-OF-FILE   */ 10025000
*        /* OR BY A DELIMITING CHARACTER                             */ 10026000
*        /*                                                          */ 10027000
*        /************************************************************/ 10028000
*        IF FLDTYPE=SIMPSCLR                                       1923 10029000
*          THEN                                                    1923 10030000
@RF01921 L     @04,@PC00028                                        1923 10031000
         CLC   FLDTYPE(4,@04),@CF00172                             1923 10032000
         BNE   @RF01923                                            1923 10033000
*            DO;                                                   1924 10034000
*            OLDERID2 = NEWERID2;                                  1925 10035000
         L     @04,GDTTR2(,GDTPTR)                                 1925 10036000
         MVC   @TS00001(95),NEWERID2(@04)                          1925 10037000
         MVC   OLDERID2(95,@04),@TS00001                           1925 10038000
*            NEWID2='RI49';                                        1926 10039000
         MVC   NEWID2(4,@04),@CC01353                              1926 10040000
*            PARENCNT=0;                                   /*@YL026UL*/ 10041000
         SLR   PARENCNT,PARENCNT                                   1927 10042000
*            DO WHILE(DELIM=NO & RISTATUS=0);                      1928 10043000
         B     @DE01928                                            1928 10044000
@DL01928 DS    0H                                                  1929 10045000
*              IF CHAR1=BLANK |                                    1929 10046000
*                 CHAR1=COMMA |                                    1929 10047000
*                 CHAR1=OPENING & DSNAM=NO |                       1929 10048000
*                 CHAR1=CLOSING & PARENCNT=0 |                     1929 10049000
*                 CHAR1=ENDDELIM |                                 1929 10050000
*                 CHAR1=PWDDELIM |                                 1929 10051000
*                 CHAR1=COMSTART(1) & CHAR2=COMSTART(2)            1929 10052000
*                THEN                                              1929 10053000
         CLI   CHAR1,C' '                                          1929 10054000
         BE    @RT01929                                            1929 10055000
         CLI   CHAR1,C','                                          1929 10056000
         BE    @RT01929                                            1929 10057000
         CLI   CHAR1,C'('                                          1929 10058000
         BNE   @GL00117                                            1929 10059000
         LA    @04,12                                              1929 10060000
         LR    @15,@04                                             1929 10061000
         MH    @15,PARMID                                          1929 10062000
         L     @01,WORKPTR                                         1929 10063000
         AL    @01,@CF01440                                        1929 10064000
         AL    @04,PARMPTR(@15,@01)                                1929 10065000
         TM    DSNAM(@04),B'00100000'                              1929 10066000
         BZ    @RT01929                                            1929 10067000
@GL00117 CLI   CHAR1,C')'                                          1929 10068000
         BNE   @GL00116                                            1929 10069000
         LTR   PARENCNT,PARENCNT                                   1929 10070000
         BZ    @RT01929                                            1929 10071000
@GL00116 CLI   CHAR1,C';'                                          1929 10072000
         BE    @RT01929                                            1929 10073000
         CLI   CHAR1,C'/'                                          1929 10074000
         BE    @RT01929                                            1929 10075000
         CLC   CHAR1(1),COMSTART                                   1929 10076000
         BNE   @RF01929                                            1929 10077000
         CLC   CHAR2(1),COMSTART+1                                 1929 10078000
         BNE   @RF01929                                            1929 10079000
@RT01929 DS    0H                                                  1930 10080000
*                  DELIM=YES;                              /*@YL026UL*/ 10081000
         OI    DELIM,B'00001000'                                   1930 10082000
*                ELSE                                              1931 10083000
*                  DO;                                             1931 10084000
         B     @RC01929                                            1931 10085000
@RF01929 DS    0H                                                  1932 10086000
*                    UNITINDX=UNITINDX+1;                          1932 10087000
         AL    UNITINDX,@CF00228                                   1932 10088000
*                    IF UNITINDX > UNITMAX                         1933 10089000
*                      THEN                                        1933 10090000
*                                                                  1933 10091000
         CH    UNITINDX,@CH00790                                   1933 10092000
         BNH   @RF01933                                            1933 10093000
*                        CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD),    1934 10094000
*                                    ADDR(SYNUNIT));               1934 10095000
*                                                                  1934 10096000
         MVC   @AL00001(8),@AL01934                                1934 10097000
         LA    @04,SYNUNIT                                         1934 10098000
         ST    @04,@AFTEMPS+48                                     1934 10099000
         LA    @04,@AFTEMPS+48                                     1934 10100000
         ST    @04,@AL00001+8                                      1934 10101000
         LA    @01,@AL00001                                        1934 10102000
         BAL   @14,ERROR2                                          1934 10103000
*                      ELSE                                        1935 10104000
*                                                                  1935 10105000
*                        /********************************************/ 10106000
*                        /*                                          */ 10107000
*                        /* SAVE THE CHARACTER AND NOTE IF   @YL026UL*/ 10108000
*                        /* IT IS A MEMBER NAME DELIMITER    @YL026UL*/ 10109000
*                        /* (A PARENTHESIS)                  @YL026UL*/ 10110000
*                        /*                                          */ 10111000
*                        /********************************************/ 10112000
*                        DO;                                       1935 10113000
         B     @RC01933                                            1935 10114000
@RF01933 DS    0H                                                  1936 10115000
*                        SYNUNIT(UNITINDX)=CHAR1;                  1936 10116000
         LA    @04,SYNUNIT-1(UNITINDX)                             1936 10117000
         MVC   0(1,@04),CHAR1                                      1936 10118000
*                        IF CHAR1=OPENING                          1937 10119000
*                          THEN                                    1937 10120000
         CLI   CHAR1,C'('                                          1937 10121000
         BNE   @RF01937                                            1937 10122000
*                            PARENCNT=PARENCNT+1;          /*@YL026UL*/ 10123000
         AL    PARENCNT,@CF00228                                   1938 10124000
*                          ELSE                                    1939 10125000
*                            IF CHAR1=CLOSING                      1939 10126000
*                              THEN                                1939 10127000
         B     @RC01937                                            1939 10128000
@RF01937 CLI   CHAR1,C')'                                          1939 10129000
         BNE   @RF01939                                            1939 10130000
*                                PARENCNT=PARENCNT-1;      /*@YL026UL*/ 10131000
*                                                                  1940 10132000
         BCTR  PARENCNT,0                                          1940 10133000
*                        CALL NEXTCHAR;                            1941 10134000
*                                                                  1941 10135000
@RF01939 DS    0H                                                  1941 10136000
@RC01937 BAL   @14,NEXTCHAR                                        1941 10137000
*                        END;                                      1942 10138000
*                  END;                                            1943 10139000
@RC01933 DS    0H                                                  1944 10140000
*            END;                                                  1944 10141000
@RC01929 DS    0H                                                  1944 10142000
@DE01928 TM    DELIM,B'00001000'                                   1944 10143000
         BNZ   @DC01928                                            1944 10144000
         ICM   @04,3,RISTATUS                                      1944 10145000
         BZ    @DL01928                                            1944 10146000
@DC01928 DS    0H                                                  1945 10147000
*            END;                                                  1945 10148000
*                                                                  1945 10149000
*          /**********************************************************/ 10150000
*          /*                                                        */ 10151000
*          /* IF A KEYWORD FIELD IS TO BE EXTRACTED, THEN PICK UP    */ 10152000
*          /* CHARACTERS UNTIL THE FIELD IS DELIMITED BY END-OF-FILE */ 10153000
*          /* OR BY A DELIMITING CHARACTER.  CHECK THAT THE MAXIMUM  */ 10154000
*          /* KEYWORD LENGTH IS NOT EXCEEDED.                        */ 10155000
*          /*                                                        */ 10156000
*          /**********************************************************/ 10157000
*          ELSE                                                    1946 10158000
*            IF FLDTYPE=KEYWORD                                    1946 10159000
*              THEN                                                1946 10160000
         B     @RC01923                                            1946 10161000
@RF01923 L     @04,@PC00028                                        1946 10162000
         CLC   FLDTYPE(4,@04),@CF00163                             1946 10163000
         BNE   @RF01946                                            1946 10164000
*                DO;                                               1947 10165000
*                OLDERID2 = NEWERID2;                              1948 10166000
         L     @04,GDTTR2(,GDTPTR)                                 1948 10167000
         MVC   @TS00001(95),NEWERID2(@04)                          1948 10168000
         MVC   OLDERID2(95,@04),@TS00001                           1948 10169000
*                NEWID2='RI50';                                    1949 10170000
         MVC   NEWID2(4,@04),@CC01354                              1949 10171000
*                DO WHILE(DELIM=NO & RISTATUS=0);                  1950 10172000
         B     @DE01950                                            1950 10173000
@DL01950 DS    0H                                                  1951 10174000
*                  IF CHAR1=BLANK | CHAR1=COMMA |                  1951 10175000
*                     CHAR1=OPENING | CHAR1=CLOSING |              1951 10176000
*                     CHAR1=COMSTART(1) & CHAR2=COMSTART(2) |      1951 10177000
*                     CHAR1=ENDDELIM                               1951 10178000
*                    THEN                                          1951 10179000
         CLI   CHAR1,C' '                                          1951 10180000
         BE    @RT01951                                            1951 10181000
         CLI   CHAR1,C','                                          1951 10182000
         BE    @RT01951                                            1951 10183000
         CLI   CHAR1,C'('                                          1951 10184000
         BE    @RT01951                                            1951 10185000
         CLI   CHAR1,C')'                                          1951 10186000
         BE    @RT01951                                            1951 10187000
         CLC   CHAR1(1),COMSTART                                   1951 10188000
         BNE   @GL00124                                            1951 10189000
         CLC   CHAR2(1),COMSTART+1                                 1951 10190000
         BE    @RT01951                                            1951 10191000
@GL00124 CLI   CHAR1,C';'                                          1951 10192000
         BNE   @RF01951                                            1951 10193000
@RT01951 DS    0H                                                  1952 10194000
*                      DELIM=YES;                                  1952 10195000
         OI    DELIM,B'00001000'                                   1952 10196000
*                    ELSE                                          1953 10197000
*                      DO;                                         1953 10198000
         B     @RC01951                                            1953 10199000
@RF01951 DS    0H                                                  1954 10200000
*                        UNITINDX=UNITINDX+1;                      1954 10201000
         AL    UNITINDX,@CF00228                                   1954 10202000
*                        IF UNITINDX > KWDMAX                      1955 10203000
*                          THEN                                    1955 10204000
*                                                                  1955 10205000
         CH    UNITINDX,@CH00786                                   1955 10206000
         BNH   @RF01955                                            1955 10207000
*                            CALL ERROR2(BADKWD2,LENGTH(ERRFIELD), 1956 10208000
*                                        ADDR(SYNUNIT));           1956 10209000
*                                                                  1956 10210000
         MVC   @AL00001(8),@AL01956                                1956 10211000
         LA    @04,SYNUNIT                                         1956 10212000
         ST    @04,@AFTEMPS+48                                     1956 10213000
         LA    @04,@AFTEMPS+48                                     1956 10214000
         ST    @04,@AL00001+8                                      1956 10215000
         LA    @01,@AL00001                                        1956 10216000
         BAL   @14,ERROR2                                          1956 10217000
*                          ELSE                                    1957 10218000
*                            DO;                                   1957 10219000
         B     @RC01955                                            1957 10220000
@RF01955 DS    0H                                                  1958 10221000
*                            SYNUNIT(UNITINDX)=CHAR1;              1958 10222000
*                                                                  1958 10223000
         LA    @04,SYNUNIT-1(UNITINDX)                             1958 10224000
         MVC   0(1,@04),CHAR1                                      1958 10225000
*                            CALL NEXTCHAR;                        1959 10226000
*                                                                  1959 10227000
         BAL   @14,NEXTCHAR                                        1959 10228000
*                            END;                                  1960 10229000
*                      END;                                        1961 10230000
@RC01955 DS    0H                                                  1962 10231000
*                END;                                              1962 10232000
@RC01951 DS    0H                                                  1962 10233000
@DE01950 TM    DELIM,B'00001000'                                   1962 10234000
         BNZ   @DC01950                                            1962 10235000
         ICM   @04,3,RISTATUS                                      1962 10236000
         BZ    @DL01950                                            1962 10237000
@DC01950 DS    0H                                                  1963 10238000
*                END;                                              1963 10239000
*                                                                  1963 10240000
*              /******************************************************/ 10241000
*              /*                                                    */ 10242000
*              /* IF A SCALAR FIELD DELIMITED BY APOSTROPHES IS TO BE*/ 10243000
*              /* EXTRACTED, THEN PICK UP CHARACTERS UNTIL THE FIELD */ 10244000
*              /* IS DELIMITED BY END-OF-FILE OR BY A DELIMITING     */ 10245000
*              /* INPUT CHARACTER.                                   */ 10246000
*              /*                                                    */ 10247000
*              /******************************************************/ 10248000
*              ELSE                                                1964 10249000
*                IF FLDTYPE=QUOTSCLR                               1964 10250000
*                  THEN                                            1964 10251000
         B     @RC01946                                            1964 10252000
@RF01946 L     @04,@PC00028                                        1964 10253000
         CLC   FLDTYPE(4,@04),@CF00052                             1964 10254000
         BNE   @RF01964                                            1964 10255000
*DOGRP182:           DO;                                           1965 10256000
DOGRP182 DS    0H                                                  1966 10257000
*                    OLDERID2 = NEWERID2;                          1966 10258000
         L     @04,GDTTR2(,GDTPTR)                                 1966 10259000
         MVC   @TS00001(95),NEWERID2(@04)                          1966 10260000
         MVC   OLDERID2(95,@04),@TS00001                           1966 10261000
*                    NEWID2='RI51';                                1967 10262000
         MVC   NEWID2(4,@04),@CC01357                              1967 10263000
*                    DO WHILE(DELIM=NO & RISTATUS=0);              1968 10264000
*                                                                  1968 10265000
         B     @DE01968                                            1968 10266000
@DL01968 DS    0H                                                  1969 10267000
*                      IF CHAR1=QUOTE & CHAR2^=QUOTE               1969 10268000
*                        THEN                                      1969 10269000
         CLI   CHAR1,C''''                                         1969 10270000
         BNE   @RF01969                                            1969 10271000
         CLI   CHAR2,C''''                                         1969 10272000
         BE    @RF01969                                            1969 10273000
*                          DELIM=YES;                              1970 10274000
         OI    DELIM,B'00001000'                                   1970 10275000
*                        ELSE                                      1971 10276000
*                                                                  1971 10277000
*                          /******************************************/ 10278000
*                          /*                                        */ 10279000
*                          /* ACCEPT THE CHARACTER AS PART OF THE    */ 10280000
*                          /* SCALAR.  ISSUE AN ERROR MESSAGE IF THE */ 10281000
*                          /* SCALAR HAS EXCEEDED THE LENGTH LIMIT.  */ 10282000
*                          /* ISSUE A WARNING MESSAGE IF THE CHAR.   */ 10283000
*                          /* IS A SEMICOLON.                        */ 10284000
*                          /*                                        */ 10285000
*                          /******************************************/ 10286000
*                          DO;                                     1971 10287000
         B     @RC01969                                            1971 10288000
@RF01969 DS    0H                                                  1972 10289000
*                            IF CHAR1=ENDDELIM                     1972 10290000
*                              THEN                                1972 10291000
         CLI   CHAR1,C';'                                          1972 10292000
         BNE   @RF01972                                            1972 10293000
*                                DO;                               1973 10294000
*                                DARGSMOD=RISTID;                  1974 10295000
         L     @04,DDSTRU                                          1974 10296000
         MVC   DARGSMOD(3,@04),RISTID                              1974 10297000
*                                DARGSENT=QUOTSEMI;                1975 10298000
*                                                                  1975 10299000
         MVI   DARGSENT(@04),X'17'                                 1975 10300000
*                                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);  10301000
*                                                                  1976 10302000
         ST    GDTPTR,@AL00001                                     1976 10303000
         LA    @04,@CF00125                                        1976 10304000
         ST    @04,@AL00001+4                                      1976 10305000
         LA    @04,DDSTRU                                          1976 10306000
         ST    @04,@AL00001+8                                      1976 10307000
         MVI   @AL00001+8,X'80'                                    1976 10308000
         L     @15,GDTPRT(,GDTPTR)                                 1976 10309000
         LA    @01,@AL00001                                        1976 10310000
         BALR  @14,@15                                             1976 10311000
*                                END;                              1977 10312000
*                            UNITINDX=UNITINDX+1;                  1978 10313000
@RF01972 AL    UNITINDX,@CF00228                                   1978 10314000
*                            IF UNITINDX > UNITMAX                 1979 10315000
*                              THEN                                1979 10316000
*                                                                  1979 10317000
         CH    UNITINDX,@CH00790                                   1979 10318000
         BNH   @RF01979                                            1979 10319000
*                                CALL ERROR2(BADSCLR1,LENGTH(ERRFIELD), 10320000
*                                            ADDR(SYNUNIT));       1980 10321000
*                                                                  1980 10322000
         MVC   @AL00001(8),@AL01980                                1980 10323000
         LA    @04,SYNUNIT                                         1980 10324000
         ST    @04,@AFTEMPS+48                                     1980 10325000
         LA    @04,@AFTEMPS+48                                     1980 10326000
         ST    @04,@AL00001+8                                      1980 10327000
         LA    @01,@AL00001                                        1980 10328000
         BAL   @14,ERROR2                                          1980 10329000
*                              ELSE                                1981 10330000
*                                SYNUNIT(UNITINDX)=CHAR1;          1981 10331000
         B     @RC01979                                            1981 10332000
@RF01979 LA    @04,SYNUNIT-1(UNITINDX)                             1981 10333000
         MVC   0(1,@04),CHAR1                                      1981 10334000
*                          END;                                    1982 10335000
*                                                                  1982 10336000
@RC01979 DS    0H                                                  1983 10337000
*                      /**********************************************/ 10338000
*                      /*                                            */ 10339000
*                      /* IF A DOUBLE APOSTROPHE IS FOUND, SKIP PAST */ 10340000
*                      /* BOTH OF THEM AND THEN CONTINUE SCANNING.   */ 10341000
*                      /*                                            */ 10342000
*                      /**********************************************/ 10343000
*                      IF CHAR1=QUOTE & CHAR2=QUOTE                1983 10344000
*                        THEN                                      1983 10345000
*                                                                  1983 10346000
@RC01969 CLI   CHAR1,C''''                                         1983 10347000
         BNE   @RF01983                                            1983 10348000
         CLI   CHAR2,C''''                                         1983 10349000
         BNE   @RF01983                                            1983 10350000
*                          CALL NEXTCHAR;                          1984 10351000
*                                                                  1984 10352000
         BAL   @14,NEXTCHAR                                        1984 10353000
*                      /**********************************************/ 10354000
*                      /*                                            */ 10355000
*                      /* BYPASS THE CHARACTER JUST EXTRACTED, UNLESS*/ 10356000
*                      /* AN ERROR CONDITION HAS BEEN ENCOUNTERED OR */ 10357000
*                      /* THE END OF THE CURRENT COMMAND HAS JUST    */ 10358000
*                      /* BEEN REACHED.                              */ 10359000
*                      /*                                            */ 10360000
*                      /**********************************************/ 10361000
*                      IF RISTATUS=0                               1985 10362000
*                        THEN                                      1985 10363000
@RF01983 ICM   @04,3,RISTATUS                                      1985 10364000
         BNZ   @RF01985                                            1985 10365000
*                          IF CHAR1=ENDDELIM &                     1986 10366000
*                             (OPTSFLAG=ON | MORTOCOM=NO) &        1986 10367000
*                             SCANINDX >= SCNLIMIT                 1986 10368000
*                            THEN                                  1986 10369000
         CLI   CHAR1,C';'                                          1986 10370000
         BNE   @RF01986                                            1986 10371000
         TM    OPTSFLAG,B'00100000'                                1986 10372000
         BO    @GL00133                                            1986 10373000
         TM    MORTOCOM,B'00010000'                                1986 10374000
         BNZ   @RF01986                                            1986 10375000
@GL00133 LH    @04,SCANINDX                                        1986 10376000
         CH    @04,SCNLIMIT                                        1986 10377000
         BL    @RF01986                                            1986 10378000
*                              DELIM=YES;                          1987 10379000
         OI    DELIM,B'00001000'                                   1987 10380000
*                            ELSE                                  1988 10381000
*                                                                  1988 10382000
*                              CALL NEXTCHAR;                      1988 10383000
*                                                                  1988 10384000
         B     @RC01986                                            1988 10385000
@RF01986 BAL   @14,NEXTCHAR                                        1988 10386000
*                    END;                                          1989 10387000
@RC01986 DS    0H                                                  1989 10388000
@RF01985 DS    0H                                                  1989 10389000
@DE01968 TM    DELIM,B'00001000'                                   1989 10390000
         BNZ   @DC01968                                            1989 10391000
         ICM   @04,3,RISTATUS                                      1989 10392000
         BZ    @DL01968                                            1989 10393000
@DC01968 DS    0H                                                  1990 10394000
*                    END DOGRP182;                                 1990 10395000
*                                                                  1990 10396000
*                  /**************************************************/ 10397000
*                  /*                                                */ 10398000
*                  /* WHEN A VERB FIELD IS TO BE EXTRACTED, PICK     */ 10399000
*                  /* UP CHARACTERS UNTIL THE FIELD IS DELIMITED BY  */ 10400000
*                  /* END-OF-FILE OR BY A DELIMITING CHARACTER.      */ 10401000
*                  /* CHECK THAT THE MAXIMUM VERB LENGTH HAS NOT     */ 10402000
*                  /* BEEN EXCEEDED.                                 */ 10403000
*                  /*                                                */ 10404000
*                  /**************************************************/ 10405000
*                  ELSE                                            1991 10406000
*                    DO WHILE(DELIM=NO & RISTATUS=0);              1991 10407000
         B     @RC01964                                            1991 10408000
@RF01964 B     @DE01991                                            1991 10409000
@DL01991 DS    0H                                                  1992 10410000
*                      IF CHAR1=BLANK | CHAR1=COMMA |              1992 10411000
*                         CHAR1=COMSTART(1) & CHAR2=COMSTART(2) |  1992 10412000
*                         CHAR1=ENDDELIM                           1992 10413000
*                        THEN                                      1992 10414000
         CLI   CHAR1,C' '                                          1992 10415000
         BE    @RT01992                                            1992 10416000
         CLI   CHAR1,C','                                          1992 10417000
         BE    @RT01992                                            1992 10418000
         CLC   CHAR1(1),COMSTART                                   1992 10419000
         BNE   @GL00137                                            1992 10420000
         CLC   CHAR2(1),COMSTART+1                                 1992 10421000
         BE    @RT01992                                            1992 10422000
@GL00137 CLI   CHAR1,C';'                                          1992 10423000
         BNE   @RF01992                                            1992 10424000
@RT01992 DS    0H                                                  1993 10425000
*                          DELIM=YES;                              1993 10426000
         OI    DELIM,B'00001000'                                   1993 10427000
*                        ELSE                                      1994 10428000
*                          DO;                                     1994 10429000
         B     @RC01992                                            1994 10430000
@RF01992 DS    0H                                                  1995 10431000
*                            UNITINDX=UNITINDX+1;                  1995 10432000
         AL    UNITINDX,@CF00228                                   1995 10433000
*                            IF UNITINDX > UNITMAX                 1996 10434000
*                              THEN                                1996 10435000
*                                                                  1996 10436000
         CH    UNITINDX,@CH00790                                   1996 10437000
         BNH   @RF01996                                            1996 10438000
*                                CALL ERROR2(BADVERB2,LENGTH(ERRFIELD), 10439000
*                                            ADDR(SYNUNIT));       1997 10440000
*                                                                  1997 10441000
         MVC   @AL00001(8),@AL01997                                1997 10442000
         LA    @04,SYNUNIT                                         1997 10443000
         ST    @04,@AFTEMPS+48                                     1997 10444000
         LA    @04,@AFTEMPS+48                                     1997 10445000
         ST    @04,@AL00001+8                                      1997 10446000
         LA    @01,@AL00001                                        1997 10447000
         BAL   @14,ERROR2                                          1997 10448000
*                              ELSE                                1998 10449000
*                                DO;                               1998 10450000
         B     @RC01996                                            1998 10451000
@RF01996 DS    0H                                                  1999 10452000
*                                SYNUNIT(UNITINDX)=CHAR1;          1999 10453000
*                                                                  1999 10454000
         LA    @04,SYNUNIT-1(UNITINDX)                             1999 10455000
         MVC   0(1,@04),CHAR1                                      1999 10456000
*                                CALL NEXTCHAR;                    2000 10457000
*                                                                  2000 10458000
         BAL   @14,NEXTCHAR                                        2000 10459000
*                                END;                              2001 10460000
*                          END;                                    2002 10461000
@RC01996 DS    0H                                                  2003 10462000
*                    END;                                          2003 10463000
*                                                                  2003 10464000
@RC01992 DS    0H                                                  2003 10465000
@DE01991 TM    DELIM,B'00001000'                                   2003 10466000
         BNZ   @DC01991                                            2003 10467000
         ICM   @04,3,RISTATUS                                      2003 10468000
         BZ    @DL01991                                            2003 10469000
@DC01991 DS    0H                                                  2004 10470000
*        /************************************************************/ 10471000
*        /*                                                          */ 10472000
*        /* AN ERROR HAS OCCURRED WHEN NO CHARACTERS OF THE          */ 10473000
*        /* SYNTACTICAL UNIT WERE FOUND BEFORE HITTING A DELIMITER   */ 10474000
*        /*                                                          */ 10475000
*        /************************************************************/ 10476000
*        IF UNITINDX=0 & RISTATUS=0                                2004 10477000
*          THEN                                                    2004 10478000
@RC01964 DS    0H                                                  2004 10479000
@RC01946 DS    0H                                                  2004 10480000
@RC01923 SLR   @04,@04                                             2004 10481000
         CR    UNITINDX,@04                                        2004 10482000
         BNE   @RF02004                                            2004 10483000
         CH    @04,RISTATUS                                        2004 10484000
         BNE   @RF02004                                            2004 10485000
*            IF FLDTYPE^=VERBFLD                                   2005 10486000
*              THEN                                                2005 10487000
*                                                                  2005 10488000
         L     @04,@PC00028                                        2005 10489000
         CLC   FLDTYPE(4,@04),@CF00228                             2005 10490000
         BE    @RF02005                                            2005 10491000
*                CALL ERROR2(BADELIM1,LENGTH(CHAR1),ADDR(CHAR1));  2006 10492000
*                                                                  2006 10493000
         MVC   @AL00001(8),@AL02006                                2006 10494000
         LA    @04,CHAR1                                           2006 10495000
         ST    @04,@AFTEMPS+48                                     2006 10496000
         LA    @04,@AFTEMPS+48                                     2006 10497000
         ST    @04,@AL00001+8                                      2006 10498000
         LA    @01,@AL00001                                        2006 10499000
         BAL   @14,ERROR2                                          2006 10500000
*              ELSE;                                               2007 10501000
*                                                                  2007 10502000
@RF02005 DS    0H                                                  2008 10503000
*          /**********************************************************/ 10504000
*          /*                                                        */ 10505000
*          /* IF CHARACTERS WERE EXTRACTED FOR THIS UNIT, SAVE UP TO */ 10506000
*          /* THE FIRST 20 OF THEM FOR POSSIBLE LATER USE IN AN      */ 10507000
*          /* ERROR MESSAGE.                                         */ 10508000
*          /*                                                        */ 10509000
*          /**********************************************************/ 10510000
*          ELSE                                                    2008 10511000
*            ERRFIELD=SYNUNIT;                                     2008 10512000
*                                                                  2008 10513000
*                                                                  2008 10514000
         B     @RC02004                                            2008 10515000
@RF02004 MVC   ERRFIELD(20),SYNUNIT                                2008 10516000
*        END NXTFIELD;                                             2009 10517000
@EL00028 DS    0H                                                  2009 10518000
@EF00028 DS    0H                                                  2009 10519000
@ER00028 LM    @14,@04,@SA00028                                    2009 10520000
         LM    @06,@12,@SA00028+28                                 2009 10521000
         BR    @14                                                 2009 10522000
*/********************************************************************/ 10523000
*/*                                                                  */ 10524000
*/*  PROCEDURE NAME - SCANSEP                                        */ 10525000
*/*                                                                  */ 10526000
*/*  FUNCTION - THIS ROUTINE SCANS PAST THE COMMA(S) AND/OR BLANK(S) */ 10527000
*/*             AND/OR COMMENT(S) WHICH OPTIONALLY SEPARATE COMMAND  */ 10528000
*/*             SYNTACTIC UNITS.                                     */ 10529000
*/*                                                                  */ 10530000
*/*  INPUT -                                                         */ 10531000
*/*          WITHCOM - FLAG SET 'OFF' WHEN A COMMA SHOULD NOT APPEAR */ 10532000
*/*                    AS PART OF THE SEPARATOR                      */ 10533000
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED                */ 10534000
*/*          CHAR2 -   INPUT CHARACTER TO BE EXTRACTED NEXT          */ 10535000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 10536000
*/*                    CODE WHEN AN ERROR IS FOUND                   */ 10537000
*/*          SCANONLY- FLAG SET 'ON' WHEN THE CURRENT COMMAND IS     */ 10538000
*/*                    BEING SCANNED FOR SYNTAX CHECKING ONLY.       */ 10539000
*/*                                                                  */ 10540000
*/*  OUTPUT - NONE                                                   */ 10541000
*/*                                                                  */ 10542000
*/********************************************************************/ 10543000
*SCANSEP:PROCEDURE(WITHCOM);           /*PARAMETER SIGNALS WHETHER 2010 10544000
*                                        A COMMA IS TO BE CONSIDERED    10545000
*                                        PART OF THE SEPARATOR OR NOT*/ 10546000
SCANSEP  STM   @14,@12,@SA00029                                    2010 10547000
         MVC   @PC00029(4),0(@01)                                  2010 10548000
*        /************************************************************/ 10549000
*        /*                                                          */ 10550000
*        /* SCANSEP PROCEDURE DATA DEFINITIONS                       */ 10551000
*        /*                                                          */ 10552000
*        /************************************************************/ 10553000
*                                                                  2011 10554000
*        /* STATIC ERROR MESSAGE CODE                                */ 10555000
*        DCL COMMAERR FIXED(31)        /*DOUBLE COMMA                */ 10556000
*                     CONSTANT(7);                                 2011 10557000
*                                                                  2011 10558000
*        DCL COMMASW  BIT(1);          /*SIGNALS THAT A COMMA HAS BEEN  10559000
*                                        FOUND IN THIS SEPARATOR     */ 10560000
*        DCL WITHCOM  BIT(1);          /*SIGNALS THAT A COMMA MAY  2013 10561000
*                                        APPEAR IN THIS SEPARATOR    */ 10562000
*        /************************************************************/ 10563000
*        /*                                                          */ 10564000
*        /*  ** SCANSEP **  SCAN PAST SEPARATOR CHARACTERS           */ 10565000
*        /*                                                          */ 10566000
*        /************************************************************/ 10567000
*        IF WITHCOM=YES                                            2014 10568000
*          THEN                                                    2014 10569000
         L     @02,@PC00029                                        2014 10570000
         TM    WITHCOM(@02),B'10000000'                            2014 10571000
         BNO   @RF02014                                            2014 10572000
*            COMMASW=OFF;                                          2015 10573000
         NI    COMMASW,B'01111111'                                 2015 10574000
*          ELSE                                                    2016 10575000
*            COMMASW=ON;                                           2016 10576000
         B     @RC02014                                            2016 10577000
@RF02014 OI    COMMASW,B'10000000'                                 2016 10578000
*        DELIM=NO;                                                 2017 10579000
@RC02014 NI    DELIM,B'11110111'                                   2017 10580000
*        COMMENT=NO;                                               2018 10581000
         NI    COMMENT,B'10111111'                                 2018 10582000
*        DO WHILE(DELIM=NO & RISTATUS=0);                          2019 10583000
*                                                                  2019 10584000
         B     @DE02019                                            2019 10585000
@DL02019 DS    0H                                                  2020 10586000
*          /**********************************************************/ 10587000
*          /*                                                        */ 10588000
*          /* IF NOT CURRENTLY BYPASSING A COMMENT, LOOK FOR A CHAR. */ 10589000
*          /* OTHER THAN A SEPARATOR CHARACTER OR THE BEGINNING OF A */ 10590000
*          /* COMMENT TO SIGNAL THE BEGINNING OF THE NEXT SYNTACTIC  */ 10591000
*          /* UNIT.  IF MORE THAN ONE COMMA HAS BEEN FOUND, ISSUE A  */ 10592000
*          /* WARNING MESSAGE STATING THAT IT WILL BE IGNORED.       */ 10593000
*          /*                                                        */ 10594000
*          /**********************************************************/ 10595000
*          IF COMMENT=NO                                           2020 10596000
*            THEN                                                  2020 10597000
         TM    COMMENT,B'01000000'                                 2020 10598000
         BNZ   @RF02020                                            2020 10599000
*              IF CHAR1 ^= BLANK                                   2021 10600000
*                THEN                                              2021 10601000
         CLI   CHAR1,C' '                                          2021 10602000
         BE    @RF02021                                            2021 10603000
*                  IF CHAR1=COMMA                                  2022 10604000
*                    THEN                                          2022 10605000
         CLI   CHAR1,C','                                          2022 10606000
         BNE   @RF02022                                            2022 10607000
*                      IF COMMASW=ON                               2023 10608000
*                        THEN                                      2023 10609000
         TM    COMMASW,B'10000000'                                 2023 10610000
         BNO   @RF02023                                            2023 10611000
*                          DO;                                     2024 10612000
*                          DARGSMOD=RISTID;                        2025 10613000
         L     @02,DDSTRU                                          2025 10614000
         MVC   DARGSMOD(3,@02),RISTID                              2025 10615000
*                          DARGSENT=COMMAERR;                      2026 10616000
*                                                                  2026 10617000
         MVI   DARGSENT(@02),X'07'                                 2026 10618000
*                          CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);   2027 10619000
*                                                                  2027 10620000
         ST    GDTPTR,@AL00001                                     2027 10621000
         LA    @02,@CF00125                                        2027 10622000
         ST    @02,@AL00001+4                                      2027 10623000
         LA    @02,DDSTRU                                          2027 10624000
         ST    @02,@AL00001+8                                      2027 10625000
         MVI   @AL00001+8,X'80'                                    2027 10626000
         L     @15,GDTPRT(,GDTPTR)                                 2027 10627000
         LA    @01,@AL00001                                        2027 10628000
         BALR  @14,@15                                             2027 10629000
*                          END;                                    2028 10630000
*                        ELSE                                      2029 10631000
*                          COMMASW=ON;                             2029 10632000
         B     @RC02023                                            2029 10633000
@RF02023 OI    COMMASW,B'10000000'                                 2029 10634000
*                    ELSE                                          2030 10635000
*                      IF CHAR1=COMSTART(1) & CHAR2=COMSTART(2)    2030 10636000
*                        THEN                                      2030 10637000
         B     @RC02022                                            2030 10638000
@RF02022 CLC   CHAR1(1),COMSTART                                   2030 10639000
         BNE   @RF02030                                            2030 10640000
         CLC   CHAR2(1),COMSTART+1                                 2030 10641000
         BNE   @RF02030                                            2030 10642000
*                          DO;                                     2031 10643000
*                          COMMENT=YES;                            2032 10644000
*                                                                  2032 10645000
         OI    COMMENT,B'01000000'                                 2032 10646000
*                          CALL NEXTCHAR;                          2033 10647000
*                                                                  2033 10648000
         BAL   @14,NEXTCHAR                                        2033 10649000
*                          END;                                    2034 10650000
*                        ELSE                                      2035 10651000
*                          DELIM=YES;                              2035 10652000
         B     @RC02030                                            2035 10653000
@RF02030 OI    DELIM,B'00001000'                                   2035 10654000
*                ELSE;                                             2036 10655000
*                                                                  2036 10656000
@RF02021 DS    0H                                                  2037 10657000
*            /********************************************************/ 10658000
*            /*                                                      */ 10659000
*            /* IF CURRENTLY BYPASSING A COMMENT, LOOK FOR THE ENDING*/ 10660000
*            /* COMMENT DELIMITER.  ALSO TEST TO SEE IF THE END OF   */ 10661000
*            /* THE CURRENT COMMAND HAS BEEN FOUND WHILE SCANNING    */ 10662000
*            /* WITHIN THE COMMENT.                                  */ 10663000
*            /*                                                      */ 10664000
*            /********************************************************/ 10665000
*            ELSE                                                  2037 10666000
*              IF CHAR1=COMEND(1) & CHAR2=COMEND(2)                2037 10667000
*                THEN                                              2037 10668000
         B     @RC02020                                            2037 10669000
@RF02020 CLC   CHAR1(1),COMEND                                     2037 10670000
         BNE   @RF02037                                            2037 10671000
         CLC   CHAR2(1),COMEND+1                                   2037 10672000
         BNE   @RF02037                                            2037 10673000
*                  DO;                                             2038 10674000
*                  COMMENT=NO;                                     2039 10675000
*                                                                  2039 10676000
         NI    COMMENT,B'10111111'                                 2039 10677000
*                  CALL NEXTCHAR;                                  2040 10678000
*                                                                  2040 10679000
         BAL   @14,NEXTCHAR                                        2040 10680000
*                  END;                                            2041 10681000
*                ELSE                                              2042 10682000
*                  IF CHAR1=ENDDELIM &                             2042 10683000
*                     (OPTSFLAG=ON | MORTOCOM=NO) &                2042 10684000
*                     SCANINDX >= SCNLIMIT                         2042 10685000
*                    THEN                                          2042 10686000
         B     @RC02037                                            2042 10687000
@RF02037 CLI   CHAR1,C';'                                          2042 10688000
         BNE   @RF02042                                            2042 10689000
         TM    OPTSFLAG,B'00100000'                                2042 10690000
         BO    @GL00145                                            2042 10691000
         TM    MORTOCOM,B'00010000'                                2042 10692000
         BNZ   @RF02042                                            2042 10693000
@GL00145 LH    @02,SCANINDX                                        2042 10694000
         CH    @02,SCNLIMIT                                        2042 10695000
         BL    @RF02042                                            2042 10696000
*                      DELIM=YES;                                  2043 10697000
*                                                                  2043 10698000
         OI    DELIM,B'00001000'                                   2043 10699000
*          /**********************************************************/ 10700000
*          /*                                                        */ 10701000
*          /* SCAN THE INPUT CHARACTERS ONE AT A TIME -- IF, AFTER   */ 10702000
*          /* A CHARACTER HAS BEEN CHECKED, THE NEXT SYNTACTIC UNIT  */ 10703000
*          /* HAS NOT BEEN REACHED, PICK UP THE NEXT CHARACTER.      */ 10704000
*          /*                                                        */ 10705000
*          /**********************************************************/ 10706000
*          IF DELIM=NO                                             2044 10707000
*            THEN                                                  2044 10708000
*                                                                  2044 10709000
@RF02042 DS    0H                                                  2044 10710000
@RC02037 DS    0H                                                  2044 10711000
@RC02020 TM    DELIM,B'00001000'                                   2044 10712000
         BNZ   @RF02044                                            2044 10713000
*              CALL NEXTCHAR;                                      2045 10714000
*                                                                  2045 10715000
         BAL   @14,NEXTCHAR                                        2045 10716000
*        END;                                                      2046 10717000
*                                                                  2046 10718000
@RF02044 DS    0H                                                  2046 10719000
@DE02019 TM    DELIM,B'00001000'                                   2046 10720000
         BNZ   @DC02019                                            2046 10721000
         ICM   @02,3,RISTATUS                                      2046 10722000
         BZ    @DL02019                                            2046 10723000
@DC02019 DS    0H                                                  2047 10724000
*        END SCANSEP;                                              2047 10725000
@EL00029 DS    0H                                                  2047 10726000
@EF00029 DS    0H                                                  2047 10727000
@ER00029 LM    @14,@12,@SA00029                                    2047 10728000
         BR    @14                                                 2047 10729000
*/********************************************************************/ 10730000
*/*                                                                  */ 10731000
*/*  PROCEDURE NAME - NEXTCHAR                                       */ 10732000
*/*                                                                  */ 10733000
*/*  FUNCTION - THIS ROUTINE EXTRACTS THE NEXT CHARACTER (PRIMARY    */ 10734000
*/*             CHARACTER) FROM THE INPUT STREAM AND MAKES THE       */ 10735000
*/*             CHARACTER LOGICALLY FOLLOWING IT (SECONDARY CHAR.)   */ 10736000
*/*             AVAILABLE FOR REFERENCE. (THE NEXT INVOCATION OF     */ 10737000
*/*             'NEXTCHAR' WILL TREAT THIS SECONDARY CHARACTER AS THE*/ 10738000
*/*             PRIMARY CHARACTER). A NEW RECORD IS OBTAINED, IF     */ 10739000
*/*             NECESSARY, TO PICK UP THE SECONDARY CHAR., AND THIS  */ 10740000
*/*             NEW RECORD IS PREPARED FOR SCANNING BEFORE PROCESSING*/ 10741000
*/*             OF IT BEGINS.                                        */ 10742000
*/*                                                                  */ 10743000
*/*  INPUT -                                                         */ 10744000
*/*          FINALCHR- FLAG SET 'ON' WHEN INPUT END-OF-FILE HAS BEEN */ 10745000
*/*                    REACHED.                                      */ 10746000
*/*          FIRSTCHR- FLAG SET 'ON' WHEN THE LOCATION AND LENGTH OF */ 10747000
*/*                    THE INPUT CHARACTERS TO BE SCANNED ARE        */ 10748000
*/*                    SPECIFIED IN THE R/I HISTORICAL DATA AREA.    */ 10749000
*/*          INRECPTR- PTR IN R/I HDA POINTING TO INPUT CHARACTERS   */ 10750000
*/*                    NOT COMPLETELY SCANNED BY PREVIOUS INVOCATION */ 10751000
*/*                    OF THE READER/INTERPRETER.                    */ 10752000
*/*          INRECLEN- LENGTH OF ABOVE UNSCANNED STRING.             */ 10753000
*/*          SCANINDX- INDEX INDICATING THE OFFSET INTO THE CURRENT  */ 10754000
*/*                    INPUT RECORD OF THE LAST CHARACTER EXTRACTED. */ 10755000
*/*          SCNLIMIT- OFFSET INTO THE CURRENT INPUT RECORD OF THE   */ 10756000
*/*                    FINAL CHARACTER IN THE RECORD TO BE EXTRACTED.*/ 10757000
*/*          INREC -   CONTAINS THE CURRENT INPUT RECORD             */ 10758000
*/*          OPTSFLAG- FLAG SET 'ON' WHEN CURRENTLY SCANNING WITHIN  */ 10759000
*/*                    THE PARAMETER OPTIONS STRING                  */ 10760000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 10761000
*/*                    VALUE WHEN AN ERROR IS FOUND.                 */ 10762000
*/*                                                                  */ 10763000
*/*  OUTPUT -                                                        */ 10764000
*/*          CHAR1 -   INPUT CHARACTER JUST EXTRACTED.               */ 10765000
*/*          CHAR2 -   INPUT CHARACTER WHICH LOGICALLY FOLLOWS THE   */ 10766000
*/*                    CHARACTER JUST EXTRACTED.                     */ 10767000
*/*          FINALCHR- SEE 'INPUT'                                   */ 10768000
*/*          RISTATUS- SEE 'INPUT'                                   */ 10769000
*/*          FIRSTCHR- SEE 'INPUT'                                   */ 10770000
*/*          RECRDPTR- POINTER TO CURRENT INPUT RECORD               */ 10771000
*/*          SCNLIMIT- SEE 'INPUT'                                   */ 10772000
*/*          SCANINDX- SEE 'INPUT'                                   */ 10773000
*/*                                                                  */ 10774000
*/********************************************************************/ 10775000
*NEXTCHAR:PROCEDURE;                                               2048 10776000
NEXTCHAR STM   @14,@12,@SA00030                                    2048 10777000
*        /************************************************************/ 10778000
*        /*                                                          */ 10779000
*        /*  ** NEXTCHAR **  GET NEXT COMMAND CHARACTER              */ 10780000
*        /*                                                          */ 10781000
*        /************************************************************/ 10782000
*                                                                  2049 10783000
*        /************************************************************/ 10784000
*        /*                                                          */ 10785000
*        /* NOTE WHETHER END-OF-FILE HAS BEEN REACHED OR NOT         */ 10786000
*        /*                                                          */ 10787000
*        /************************************************************/ 10788000
*        IF FINALCHR=YES                                           2049 10789000
*          THEN                                                    2049 10790000
         TM    FINALCHR,B'00000010'                                2049 10791000
         BNO   @RF02049                                            2049 10792000
*            DO;                                                   2050 10793000
*            OLDERID2 = NEWERID2;                                  2051 10794000
         L     @02,GDTTR2(,GDTPTR)                                 2051 10795000
         MVC   @TS00001(95),NEWERID2(@02)                          2051 10796000
         MVC   OLDERID2(95,@02),@TS00001                           2051 10797000
*            NEWID2='RI56';                                        2052 10798000
         MVC   NEWID2(4,@02),@CC01368                              2052 10799000
*            RISTATUS=EOFILE;                                      2053 10800000
         MVC   RISTATUS(2),@CH00157                                2053 10801000
*            END;                                                  2054 10802000
*          ELSE                                                    2055 10803000
*DOGRP185:   DO;                                                   2055 10804000
*                                                                  2055 10805000
         B     @RC02049                                            2055 10806000
@RF02049 DS    0H                                                  2055 10807000
DOGRP185 DS    0H                                                  2056 10808000
*            /********************************************************/ 10809000
*            /*                                                      */ 10810000
*            /* IF THE FIRST CHARACTER OF A NEW COMMAND IS TO BE     */ 10811000
*            /* EXTRACTED, THEN PREPARE TO OBTAIN THE NEXT INPUT     */ 10812000
*            /* RECORD (PREPARATION INCLUDES WRITING A BLANK OUTPUT  */ 10813000
*            /* RECORD, UNLESS A NULL COMMAND WAS JUST ENCOUNTERED). */ 10814000
*            /* OTHERWISE, JUST POINT TO THE NEXT CHARACTER OF THE   */ 10815000
*            /* CURRENT RECORD.                                      */ 10816000
*            /*                                                      */ 10817000
*            /********************************************************/ 10818000
*            IF FIRSTCHR=YES                                       2056 10819000
*              THEN                                                2056 10820000
         TM    FIRSTCHR,B'00000100'                                2056 10821000
         BNO   @RF02056                                            2056 10822000
*                DO;                                               2057 10823000
*                OLDERID2 = NEWERID2;                              2058 10824000
         L     @02,GDTTR2(,GDTPTR)                                 2058 10825000
         MVC   @TS00001(95),NEWERID2(@02)                          2058 10826000
         MVC   OLDERID2(95,@02),@TS00001                           2058 10827000
*                NEWID2='RI57';                                    2059 10828000
         MVC   NEWID2(4,@02),@CC01371                              2059 10829000
*                FIRSTCHR=NO;                                      2060 10830000
         NI    FIRSTCHR,B'11111011'                                2060 10831000
*                SCNLIMIT=0;                                       2061 10832000
         SLR   @02,@02                                             2061 10833000
         STH   @02,SCNLIMIT                                        2061 10834000
*                SCANINDX=1;                                       2062 10835000
         MVC   SCANINDX(2),@CH00228                                2062 10836000
*                MORTOCOM=YES;                                     2063 10837000
*                                                                  2063 10838000
         OI    MORTOCOM,B'00010000'                                2063 10839000
*                IF NULLCMD=NO                                     2064 10840000
*                  THEN                                            2064 10841000
         TM    NULLCMD,B'01000000'                                 2064 10842000
         BNZ   @RF02064                                            2064 10843000
*                    DO;                                           2065 10844000
*                    DARGSMOD=RISTID;                              2066 10845000
         L     @02,DDSTRU                                          2066 10846000
         MVC   DARGSMOD(3,@02),RISTID                              2066 10847000
*                    DARGSENT=INRECID;                             2067 10848000
         MVI   DARGSENT(@02),X'27'                                 2067 10849000
*                    BLANKFLD=BLANK;                               2068 10850000
         MVI   BLANKFLD+1,C' '                                     2068 10851000
         MVC   BLANKFLD+2(8),BLANKFLD+1                            2068 10852000
         MVI   BLANKFLD,C' '                                       2068 10853000
*                    DARGDBP=ADDR(BLANKFLD);                       2069 10854000
         LA    @15,BLANKFLD                                        2069 10855000
         ST    @15,DARGDBP(,@02)                                   2069 10856000
*                    DARGILP=LENGTH(BLANKFLD);                     2070 10857000
*                                                                  2070 10858000
         MVC   DARGILP(2,@02),@CH00040                             2070 10859000
*                    CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         2071 10860000
*                                                                  2071 10861000
         ST    GDTPTR,@AL00001                                     2071 10862000
         LA    @02,@CF00125                                        2071 10863000
         ST    @02,@AL00001+4                                      2071 10864000
         LA    @02,DDSTRU                                          2071 10865000
         ST    @02,@AL00001+8                                      2071 10866000
         MVI   @AL00001+8,X'80'                                    2071 10867000
         L     @15,GDTPRT(,GDTPTR)                                 2071 10868000
         LA    @01,@AL00001                                        2071 10869000
         BALR  @14,@15                                             2071 10870000
*                    END;                                          2072 10871000
*                  ELSE                                            2073 10872000
*                    NULLCMD=NO;                                   2073 10873000
         B     @RC02064                                            2073 10874000
@RF02064 NI    NULLCMD,B'10111111'                                 2073 10875000
*                END;                                              2074 10876000
*              ELSE                                                2075 10877000
*                SCANINDX=SCANINDX+1;                              2075 10878000
*                                                                  2075 10879000
         B     @RC02056                                            2075 10880000
@RF02056 LH    @02,SCANINDX                                        2075 10881000
         LA    @02,1(,@02)                                         2075 10882000
         STH   @02,SCANINDX                                        2075 10883000
*            /********************************************************/ 10884000
*            /*                                                      */ 10885000
*            /* EXTRACT THE NEXT INPUT CHARACTER & ALSO OBTAIN THE   */ 10886000
*            /* INPUT CHARACTER WHICH LOGICALLY FOLLOWS THIS NEXT    */ 10887000
*            /* CHARACTER (GET THE NEXT RECORD IF NECESSARY).        */ 10888000
*            /*                                                      */ 10889000
*            /********************************************************/ 10890000
*            IF SCNLIMIT > 0                                       2076 10891000
*              THEN                                                2076 10892000
@RC02056 ICM   @02,3,SCNLIMIT                                      2076 10893000
         BNP   @RF02076                                            2076 10894000
*                CHAR1=INREC(SCANINDX);                            2077 10895000
         LH    @02,SCANINDX                                        2077 10896000
         L     @01,RECRDPTR                                        2077 10897000
         ALR   @01,@02                                             2077 10898000
         BCTR  @01,0                                               2077 10899000
         MVC   CHAR1(1),INREC(@01)                                 2077 10900000
*            IF SCANINDX >= SCNLIMIT                               2078 10901000
*              THEN                                                2078 10902000
*                                                                  2078 10903000
@RF02076 LH    @02,SCANINDX                                        2078 10904000
         CH    @02,SCNLIMIT                                        2078 10905000
         BL    @RF02078                                            2078 10906000
*                /****************************************************/ 10907000
*                /*                                                  */ 10908000
*                /* OBTAIN THE NEXT INPUT RECORD IN ORDER TO PICK UP */ 10909000
*                /* THE SECOND INPUT CHARACTER                       */ 10910000
*                /*                                                  */ 10911000
*                /****************************************************/ 10912000
*DOGRP190:       DO;                                               2079 10913000
*                                                                  2079 10914000
DOGRP190 DS    0H                                                  2080 10915000
*                  /**************************************************/ 10916000
*                  /*                                                */ 10917000
*                  /* FABRICATE A COMMAND-END DELIMITER IF SCANNING  */ 10918000
*                  /* HAS REACHED THE END OF A NON-CONTINUED COMMAND.*/ 10919000
*                  /*                                                */ 10920000
*                  /**************************************************/ 10921000
*                  IF OPTSFLAG=ON | MORTOCOM=NO                    2080 10922000
*                    THEN                                          2080 10923000
         TM    OPTSFLAG,B'00100000'                                2080 10924000
         BO    @RT02080                                            2080 10925000
         TM    MORTOCOM,B'00010000'                                2080 10926000
         BNZ   @RF02080                                            2080 10927000
@RT02080 DS    0H                                                  2081 10928000
*                      DO;                                         2081 10929000
*                      CHAR1=ENDDELIM;                             2082 10930000
         MVI   CHAR1,C';'                                          2082 10931000
*                      CHAR2=BLANK;                                2083 10932000
         MVI   CHAR2,C' '                                          2083 10933000
*                      END;                                        2084 10934000
*                    ELSE                                          2085 10935000
*                      IF SCANINDX > SCNLIMIT                      2085 10936000
*                        THEN                                      2085 10937000
         B     @RC02080                                            2085 10938000
@RF02080 LH    @02,SCANINDX                                        2085 10939000
         CH    @02,SCNLIMIT                                        2085 10940000
         BNH   @RF02085                                            2085 10941000
*                          CHAR1=BLANK;                            2086 10942000
*                                                                  2086 10943000
         MVI   CHAR1,C' '                                          2086 10944000
*                  /**************************************************/ 10945000
*                  /*                                                */ 10946000
*                  /* READ IN RECORD(S), STRIPPING CHARACTERS NOT TO */ 10947000
*                  /* BE SCANNED FROM BOTH ENDS OF THE NEW RECORD -- */ 10948000
*                  /* READ IN RECORDS UNTIL ONE IS READ WHICH HAS    */ 10949000
*                  /* CHARACTERS LEFT TO BE SCANNED AFTER STRIPPING. */ 10950000
*                  /* READ NO MORE RECORDS IF A 'READ' CONDITION HAS */ 10951000
*                  /* BEEN FOUND OR IF THE CURRENT COMMAND IS NOT    */ 10952000
*                  /* CONTINUED ON TO THE NEXT INPUT RECORD.         */ 10953000
*                  /*                                                */ 10954000
*                  /**************************************************/ 10955000
*                  INCOMM=NO;                                      2087 10956000
@RF02085 DS    0H                                                  2087 10957000
@RC02080 NI    INCOMM,B'11011111'                                  2087 10958000
*                  DO WHILE(SCNLIMIT-SCANINDX <= 0 &               2088 10959000
*                           OPTSFLAG=OFF & MORTOCOM=YES &          2088 10960000
*                           RISTATUS^=EOFILE & RISTATUS^=SKIPREST);     10961000
*                                                                  2088 10962000
         B     @DE02088                                            2088 10963000
@DL02088 DS    0H                                                  2089 10964000
*                    CALL GETRECRD;                                2089 10965000
*                                                                  2089 10966000
         BAL   @14,GETRECRD                                        2089 10967000
*                  END;                                            2090 10968000
*                                                                  2090 10969000
@DE02088 LH    @02,SCNLIMIT                                        2090 10970000
         SH    @02,SCANINDX                                        2090 10971000
         LTR   @02,@02                                             2090 10972000
         BP    @DC02088                                            2090 10973000
         TM    OPTSFLAG,B'00100000'                                2090 10974000
         BNZ   @DC02088                                            2090 10975000
         TM    MORTOCOM,B'00010000'                                2090 10976000
         BNO   @DC02088                                            2090 10977000
         LH    @02,RISTATUS                                        2090 10978000
         CH    @02,@CH00157                                        2090 10979000
         BE    @DC02088                                            2090 10980000
         CH    @02,@CH00042                                        2090 10981000
         BNE   @DL02088                                            2090 10982000
@DC02088 DS    0H                                                  2091 10983000
*                  /**************************************************/ 10984000
*                  /*                                                */ 10985000
*                  /* IF NO MORE INPUT RECORDS REMAIN, SET VALUES TO */ 10986000
*                  /* INDICATE THIS CONDITION.                       */ 10987000
*                  /*                                                */ 10988000
*                  /**************************************************/ 10989000
*                  IF RISTATUS = EOFILE                            2091 10990000
*                    THEN                                          2091 10991000
         CLC   RISTATUS(2),@CH00157                                2091 10992000
         BNE   @RF02091                                            2091 10993000
*                      DO;                                         2092 10994000
*                      OLDERID2 = NEWERID2;                        2093 10995000
         L     @02,GDTTR2(,GDTPTR)                                 2093 10996000
         MVC   @TS00001(95),NEWERID2(@02)                          2093 10997000
         MVC   OLDERID2(95,@02),@TS00001                           2093 10998000
*                      NEWID2='RI59';                              2094 10999000
         MVC   NEWID2(4,@02),@CC01375                              2094 11000000
*                      CHAR2=BLANK;                                2095 11001000
         MVI   CHAR2,C' '                                          2095 11002000
*                      FINALCHR=YES;                               2096 11003000
         OI    FINALCHR,B'00000010'                                2096 11004000
*                      RISTATUS=0;                                 2097 11005000
         SLR   @02,@02                                             2097 11006000
         STH   @02,RISTATUS                                        2097 11007000
*                      END;                                        2098 11008000
*                END DOGRP190;                                     2099 11009000
*                                                                  2099 11010000
@RF02091 DS    0H                                                  2100 11011000
*            /********************************************************/ 11012000
*            /*                                                      */ 11013000
*            /* EXTRACT THE 2ND INPUT CHARACTER FROM THE RECORD NOW  */ 11014000
*            /* POINTED TO, UNLESS A NEW RECORD WAS NOT OBTAINED     */ 11015000
*            /*                                                      */ 11016000
*            /********************************************************/ 11017000
*            IF FINALCHR=NO  &  SCANINDX < SCNLIMIT                2100 11018000
*              THEN                                                2100 11019000
@RF02078 TM    FINALCHR,B'00000010'                                2100 11020000
         BNZ   @RF02100                                            2100 11021000
         LH    @02,SCANINDX                                        2100 11022000
         CH    @02,SCNLIMIT                                        2100 11023000
         BNL   @RF02100                                            2100 11024000
*                CHAR2=INREC(SCANINDX+1);                          2101 11025000
         L     @01,RECRDPTR                                        2101 11026000
         ALR   @01,@02                                             2101 11027000
         MVC   CHAR2(1),INREC(@01)                                 2101 11028000
*            END DOGRP185;                                         2102 11029000
*/********************************************************************/ 11030000
*/*                                                                  */ 11031000
*/*  PROCEDURE NAME - GETRECRD                                       */ 11032000
*/*                                                                  */ 11033000
*/*  FUNCTION - THIS ROUTINE OBTAINS THE NEXT INPUT RECORD, PRINTS   */ 11034000
*/*             THE RECORD AND SETS UP REFERENCE TO IT TO ALLOW      */ 11035000
*/*             SCANNING TO CONTINUE.  IF NO INPUT RECORDS REMAIN,   */ 11036000
*/*             THE R/I INTERNAL STATUS CODE IS SET TO SIGNAL EOF.   */ 11037000
*/*                                                                  */ 11038000
*/*  INPUT -                                                         */ 11039000
*/*          IOCDAD -  ADDRESS OF RECORD JUST READ                   */ 11040000
*/*          IOCDLN -  LENGTH OF RECORD JUST READ                    */ 11041000
*/*                                                                  */ 11042000
*/*  OUTPUT -                                                        */ 11043000
*/*          RECRDPTR- POINTER TO RECORD JUST READ                   */ 11044000
*/*          SCNLIMIT- LENGTH OF RECORD JUST READ                    */ 11045000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO A NON-ZERO   */ 11046000
*/*                    CODE IF EOF OR AN I/O ERROR OCCURS.           */ 11047000
*/*          LASTCC -  LAST SYSTEM CONDITION CODE                    */ 11048000
*/*                                                                  */ 11049000
*/********************************************************************/ 11050000
*                                                                  2103 11051000
*GETRECRD:PROCEDURE;                                               2103 11052000
         B     @PB00031                                            2103 11053000
GETRECRD STM   @14,@12,@SA00031                                    2103 11054000
*        /************************************************************/ 11055000
*        /*                                                          */ 11056000
*        /*  ** GETRECRD **  GET NEXT INPUT RECORD                   */ 11057000
*        /*                                                          */ 11058000
*        /************************************************************/ 11059000
*        IF GDTDBG = NULLPTR                                       2104 11060000
*          THEN;                                                   2104 11061000
         ICM   @02,15,GDTDBG(GDTPTR)                               2104 11062000
         BZ    @RT02104                                            2104 11063000
*          ELSE                                                    2106 11064000
*            CALL IDCDB010(GDTTBL,'RIGR');                         2106 11065000
*                                                                  2106 11066000
         ST    GDTPTR,@AL00001                                     2106 11067000
         LA    @02,@CC01379                                        2106 11068000
         ST    @02,@AL00001+4                                      2106 11069000
         MVI   @AL00001+4,X'80'                                    2106 11070000
         L     @15,GDTDBG(,GDTPTR)                                 2106 11071000
         LA    @01,@AL00001                                        2106 11072000
         BALR  @14,@15                                             2106 11073000
*        /************************************************************/ 11074000
*        /*                                                          */ 11075000
*        /*  REQUEST NEXT RECORD AND NOTE IF THE RECORD COULD NOT    */ 11076000
*        /*  BE OBTAINED.  ANY ABNORMAL CONDITION OTHER THAN END-OF- */ 11077000
*        /*  FILE IS TREATED AS AN I/O ERROR                         */ 11078000
*        /*                                                          */ 11079000
*        /************************************************************/ 11080000
*                                                                  2107 11081000
*        CALL IDCIOGT0(GDTTBL,ADDRIOCS);                           2107 11082000
@RT02104 ST    GDTPTR,@AL00001                                     2107 11083000
         L     @02,GDTRIH(,GDTPTR)                                 2107 11084000
         LA    @02,ADDRIOCS(,@02)                                  2107 11085000
         ST    @02,@AL00001+4                                      2107 11086000
         MVI   @AL00001+4,X'80'                                    2107 11087000
         L     @15,GDTGET(,GDTPTR)                                 2107 11088000
         LA    @01,@AL00001                                        2107 11089000
         BALR  @14,@15                                             2107 11090000
*        RESPECIFY RTNREG RSTD;                                    2108 11091000
*        TESTRC = RTNREG;                                          2109 11092000
         STH   RTNREG,TESTRC                                       2109 11093000
*        RESPECIFY RTNREG UNRSTD;                                  2110 11094000
*                                                                  2110 11095000
*        IF TESTRC^=0                                              2111 11096000
*          THEN                                                    2111 11097000
         LH    @02,TESTRC                                          2111 11098000
         LTR   @02,@02                                             2111 11099000
         BZ    @RF02111                                            2111 11100000
*            IF TESTRC=16                                          2112 11101000
*              THEN                                                2112 11102000
         CH    @02,@CH00482                                        2112 11103000
         BNE   @RF02112                                            2112 11104000
*                RISTATUS=EOFILE;                                  2113 11105000
         MVC   RISTATUS(2),@CH00157                                2113 11106000
*              ELSE                                                2114 11107000
*                DO;                                               2114 11108000
         B     @RC02112                                            2114 11109000
@RF02112 DS    0H                                                  2115 11110000
*                LASTCC=TERMERR;                                   2115 11111000
         MVC   LASTCC(2),@CH00482                                  2115 11112000
*                RISTATUS=SKIPREST;                                2116 11113000
         MVC   RISTATUS(2),@CH00042                                2116 11114000
*                END;                                              2117 11115000
*                                                                  2117 11116000
*          /**********************************************************/ 11117000
*          /*                                                        */ 11118000
*          /*  WHEN RECORD IS OBTAINED, PRINT IT AND SET IT UP FOR   */ 11119000
*          /*  SCANNING                                              */ 11120000
*          /*                                                        */ 11121000
*          /**********************************************************/ 11122000
*          ELSE                                                    2118 11123000
*            DO;                                                   2118 11124000
         B     @RC02111                                            2118 11125000
@RF02111 DS    0H                                                  2119 11126000
*            RECRDPTR=ADDRIOCS->IOCDAD;                            2119 11127000
         L     @02,GDTRIH(,GDTPTR)                                 2119 11128000
         L     @02,ADDRIOCS(,@02)                                  2119 11129000
         L     @15,IOCDAD(,@02)                                    2119 11130000
         ST    @15,RECRDPTR                                        2119 11131000
*            SCNLIMIT=ADDRIOCS->IOCDLN;                            2120 11132000
*                                                                  2120 11133000
         L     @02,IOCDLN(,@02)                                    2120 11134000
         STH   @02,SCNLIMIT                                        2120 11135000
*            /********************************************************/ 11136000
*            /*                                                      */ 11137000
*            /* SET UP PRINT ROUTINE DATA STRUCTURES                 */ 11138000
*            /*                                                      */ 11139000
*            /********************************************************/ 11140000
*            DARGDBP=RECRDPTR;                                     2121 11141000
         L     @14,DDSTRU                                          2121 11142000
         ST    @15,DARGDBP(,@14)                                   2121 11143000
*            DARGILP=SCNLIMIT;                                     2122 11144000
         STH   @02,DARGILP(,@14)                                   2122 11145000
*            DARGSMOD=RISTID;                                      2123 11146000
         MVC   DARGSMOD(3,@14),RISTID                              2123 11147000
*            DARGSENT=INRECID;                                     2124 11148000
*                                                                  2124 11149000
         MVI   DARGSENT(@14),X'27'                                 2124 11150000
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                 2125 11151000
*                                                                  2125 11152000
         ST    GDTPTR,@AL00001                                     2125 11153000
         LA    @02,@CF00125                                        2125 11154000
         ST    @02,@AL00001+4                                      2125 11155000
         LA    @02,DDSTRU                                          2125 11156000
         ST    @02,@AL00001+8                                      2125 11157000
         MVI   @AL00001+8,X'80'                                    2125 11158000
         L     @15,GDTPRT(,GDTPTR)                                 2125 11159000
         LA    @01,@AL00001                                        2125 11160000
         BALR  @14,@15                                             2125 11161000
*            CALL SCANENDS;                                        2126 11162000
*                                                                  2126 11163000
         BAL   @14,SCANENDS                                        2126 11164000
*            END;                                                  2127 11165000
*/********************************************************************/ 11166000
*/*                                                                  */ 11167000
*/*  PROCEDURE NAME - SCANENDS                                       */ 11168000
*/*                                                                  */ 11169000
*/*  FUNCTION - THIS ROUTINE SCANS BOTH ENDS OF A NEW INPUT RECORD,  */ 11170000
*/*             CHECKING FOR CHARACTERS WHICH SHOULD NOT BE INCLUDED */ 11171000
*/*             IN THE NORMAL COMMAND SCANNING.  ONLY THOSE CHAR'S   */ 11172000
*/*             WITHIN THE SPECIFIED SOURCE MARGINS ARE ELIGIBLE FOR */ 11173000
*/*             SCANNING.  ALSO, LEADING BLANKS AND COMMENTS ARE     */ 11174000
*/*             IGNORED IF THE PREVIOUS RECORD ENDED WITH A FIELD    */ 11175000
*/*             CONTINUATION CHARACTER (A PLUS SIGN); IF THE NEW     */ 11176000
*/*             RECORD ENDS WITH A CONTINUATION CHARACTER, THEN ALL  */ 11177000
*/*             CHARACTERS INCLUDING AND FOLLOWING IT ARE IGNORED.   */ 11178000
*/*                                                                  */ 11179000
*/*  INPUT -                                                         */ 11180000
*/*          LEFTMGN - LEFT INPUT COMMAND SOURCE MARGIN              */ 11181000
*/*          RIGHTMGN- RIGHT INPUT COMMAND SOURCE MARGIN             */ 11182000
*/*          SCNLIMIT- LENGTH OF NEW INPUT RECORD                    */ 11183000
*/*          CONTNEXT- FLAG SET 'ON' IF PREVIOUS RECORD ENDED WITH   */ 11184000
*/*                    A FIELD CONTINUATION DELIMITER                */ 11185000
*/*          INREC -   CONTAINS THE NEW INPUT RECORD                 */ 11186000
*/*                                                                  */ 11187000
*/*  OUTPUT -                                                        */ 11188000
*/*          SCANINDX- OFFSET INTO NEW RECORD AT WHICH NORMAL        */ 11189000
*/*                    SCANNING IS TO BEGIN                          */ 11190000
*/*          SCNLIMIT- OFFSET INTO NEW RECORD AT WHICH NORMAL        */ 11191000
*/*                    SCANNING IS TO END                            */ 11192000
*/*          CONTNEXT- FLAG SET 'ON' IF NEW RECORD ENDS WITH THE     */ 11193000
*/*                    FIELD CONTINUATION DELIMITER                  */ 11194000
*/*          MORTOCOM- FLAG SET 'ON' WHEN THE NEW RECORD IS TO BE    */ 11195000
*/*                    CONTINUED ON TO THE NEXT INPUT RECORD.        */ 11196000
*/*                                                                  */ 11197000
*/********************************************************************/ 11198000
*                                                                  2128 11199000
*SCANENDS:PROCEDURE;                                               2128 11200000
         B     @PB00032                                            2128 11201000
SCANENDS STM   @14,@12,@SA00032                                    2128 11202000
*        /************************************************************/ 11203000
*        /*                                                          */ 11204000
*        /* SCANENDS PROCEDURE DATA DEFINITIONS                      */ 11205000
*        /*                                                          */ 11206000
*        /************************************************************/ 11207000
*        DCL ENDFOUND BIT(1);          /*SIGNALS THAT THE FINAL CHAR.   11208000
*                                        TO BE SCANNED IN THE NEW  2129 11209000
*                                        RECORD HAS BEEN DETERMINED. */ 11210000
*        DCL SKIPLEAD BIT(1);          /*SIGNALS THAT LEADING BLANKS    11211000
*                                        ARE TO BE SKIPPED BEFORE  2130 11212000
*                                        SCANNING THE NEW RECORD.    */ 11213000
*        /************************************************************/ 11214000
*        /*                                                          */ 11215000
*        /*  ** SCANENDS **  SCAN RECORD FOR CONTINUATION INDICATION */ 11216000
*        /*                                                          */ 11217000
*        /************************************************************/ 11218000
*        IF GDTDBG = NULLPTR                                       2131 11219000
*          THEN;                                                   2131 11220000
         ICM   @02,15,GDTDBG(GDTPTR)                               2131 11221000
         BZ    @RT02131                                            2131 11222000
*          ELSE                                                    2133 11223000
*            CALL IDCDB010(GDTTBL,'RISE');                         2133 11224000
*                                                                  2133 11225000
         ST    GDTPTR,@AL00001                                     2133 11226000
         LA    @02,@CC01386                                        2133 11227000
         ST    @02,@AL00001+4                                      2133 11228000
         MVI   @AL00001+4,X'80'                                    2133 11229000
         L     @15,GDTDBG(,GDTPTR)                                 2133 11230000
         LA    @01,@AL00001                                        2133 11231000
         BALR  @14,@15                                             2133 11232000
*        /************************************************************/ 11233000
*        /*                                                          */ 11234000
*        /* INITIALIZE LEFT AND RIGHT SCANNING LIMITS OF NEW RECORD. */ 11235000
*        /* THEN SCAN BACKWARD FROM THE END OF THE NEW RECORD,       */ 11236000
*        /* CHECKING FOR A CONTINUATION DELIMITER                    */ 11237000
*        /*                                                          */ 11238000
*        /************************************************************/ 11239000
*        SCANINDX=LEFTMGN;                                         2134 11240000
@RT02131 L     @02,GDTRIH(,GDTPTR)                                 2134 11241000
         MVC   SCANINDX(2),LEFTMGN(@02)                            2134 11242000
*        SCNLIMIT=MIN(RIGHTMGN,SCNLIMIT);                          2135 11243000
         LH    @02,RIGHTMGN(,@02)                                  2135 11244000
         LH    @15,SCNLIMIT                                        2135 11245000
         CR    @02,@15                                             2135 11246000
         BNH   *+6                                                      11247000
         LR    @02,@15                                             2135 11248000
         STH   @02,SCNLIMIT                                        2135 11249000
*        IF CONTNEXT=YES                                           2136 11250000
*          THEN                                                    2136 11251000
         TM    CONTNEXT,B'00001000'                                2136 11252000
         BNO   @RF02136                                            2136 11253000
*            DO;                                                   2137 11254000
*            SKIPLEAD=YES;                                         2138 11255000
         OI    SKIPLEAD,B'10000000'                                2138 11256000
*            CONTNEXT=NO;                                          2139 11257000
         NI    CONTNEXT,B'11110111'                                2139 11258000
*            END;                                                  2140 11259000
*          ELSE                                                    2141 11260000
*            SKIPLEAD=NO;                                          2141 11261000
         B     @RC02136                                            2141 11262000
@RF02136 NI    SKIPLEAD,B'01111111'                                2141 11263000
*        MORTOCOM=NO;                                              2142 11264000
@RC02136 NI    MORTOCOM,B'11101111'                                2142 11265000
*        ENDFOUND=NO;                                              2143 11266000
         NI    ENDFOUND,B'01111111'                                2143 11267000
*        DO INDEX=SCNLIMIT TO SCANINDX BY -1 WHILE(ENDFOUND=NO);   2144 11268000
*                                                                  2144 11269000
         LH    @02,SCNLIMIT                                        2144 11270000
         STH   @02,INDEX                                           2144 11271000
         B     @DE02144                                            2144 11272000
@DL02144 TM    ENDFOUND,B'10000000'                                2144 11273000
         BNZ   @DC02144                                            2144 11274000
*          /**********************************************************/ 11275000
*          /*                                                        */ 11276000
*          /* SEARCH FOR THE LAST NON-BLANK CHARACTER OF THE NEW     */ 11277000
*          /* RECORD, WHICH MAY INDICATE FIELD AND/OR COMMAND        */ 11278000
*          /* CONTINUATION OR SIMPLY THE SCANNING LIMIT OF THE RECORD*/ 11279000
*          /*                                                        */ 11280000
*          /**********************************************************/ 11281000
*          IF INREC(INDEX) ^= BLANK                                2145 11282000
*            THEN                                                  2145 11283000
         L     @15,RECRDPTR                                        2145 11284000
         ALR   @02,@15                                             2145 11285000
         BCTR  @02,0                                               2145 11286000
         CLI   INREC(@02),C' '                                     2145 11287000
         BE    @RF02145                                            2145 11288000
*              IF INREC(INDEX) = CMDCONT  |  INREC(INDEX) = FLDCONT     11289000
*                                                                  2146 11290000
*                /****************************************************/ 11291000
*                /*                                                  */ 11292000
*                /* A CONTINUATION DELIMITER DENOTES THAT THIS       */ 11293000
*                /* COMMAND CONTINUES ON TO THE NEXT RECORD.         */ 11294000
*                /*                                                  */ 11295000
*                /****************************************************/ 11296000
*                THEN                                              2146 11297000
         LH    @02,INDEX                                           2146 11298000
         ALR   @02,@15                                             2146 11299000
         BCTR  @02,0                                               2146 11300000
         CLI   INREC(@02),C'-'                                     2146 11301000
         BE    @RT02146                                            2146 11302000
         LH    @02,INDEX                                           2146 11303000
         ALR   @15,@02                                             2146 11304000
         BCTR  @15,0                                               2146 11305000
         CLI   INREC(@15),C'+'                                     2146 11306000
         BNE   @RF02146                                            2146 11307000
@RT02146 DS    0H                                                  2147 11308000
*                  DO;                                             2147 11309000
*                                                                  2147 11310000
*                  /**************************************************/ 11311000
*                  /*                                                */ 11312000
*                  /* IF FIELD CONTINUATION IS INDICATED, NOTE THAT  */ 11313000
*                  /* LEADING COMMENTS AND BLANKS ARE TO BE IGNORED  */ 11314000
*                  /* IN THE NEXT RECORD(S) UNTIL A NON-BLANK OR     */ 11315000
*                  /* COMMAND TERMINATION IS FOUND, UNLESS THE SCAN  */ 11316000
*                  /* IS ALREADY IN MID-COMMENT.                     */ 11317000
*                  /*                                                */ 11318000
*                  /**************************************************/ 11319000
*                  IF INREC(INDEX)=FLDCONT                         2148 11320000
*                    THEN                                          2148 11321000
         LH    @02,INDEX                                           2148 11322000
         L     @01,RECRDPTR                                        2148 11323000
         ALR   @01,@02                                             2148 11324000
         BCTR  @01,0                                               2148 11325000
         CLI   INREC(@01),C'+'                                     2148 11326000
         BNE   @RF02148                                            2148 11327000
*                      CONTNEXT=YES;                               2149 11328000
         OI    CONTNEXT,B'00001000'                                2149 11329000
*                  MORTOCOM=YES;                                   2150 11330000
@RF02148 OI    MORTOCOM,B'00010000'                                2150 11331000
*                  ENDFOUND=YES;                                   2151 11332000
         OI    ENDFOUND,B'10000000'                                2151 11333000
*                  SCNLIMIT=INDEX-1;                               2152 11334000
         LH    @02,INDEX                                           2152 11335000
         BCTR  @02,0                                               2152 11336000
         STH   @02,SCNLIMIT                                        2152 11337000
*                  END;                                            2153 11338000
*                                                                  2153 11339000
*                /****************************************************/ 11340000
*                /*                                                  */ 11341000
*                /* WHEN NOT ONE OF THE ABOVE DELIMITERS, THE SCAN   */ 11342000
*                /* LIMIT HAS BEEN FOUND.                            */ 11343000
*                /*                                                  */ 11344000
*                /****************************************************/ 11345000
*                ELSE                                              2154 11346000
*                  ENDFOUND=YES;                                   2154 11347000
         B     @RC02146                                            2154 11348000
@RF02146 OI    ENDFOUND,B'10000000'                                2154 11349000
*        END;                                                      2155 11350000
*                                                                  2155 11351000
@RC02146 DS    0H                                                  2155 11352000
@RF02145 SLR   @02,@02                                             2155 11353000
         BCTR  @02,0                                               2155 11354000
         AH    @02,INDEX                                           2155 11355000
         STH   @02,INDEX                                           2155 11356000
@DE02144 CH    @02,SCANINDX                                        2155 11357000
         BNL   @DL02144                                            2155 11358000
@DC02144 DS    0H                                                  2156 11359000
*        /************************************************************/ 11360000
*        /*                                                          */ 11361000
*        /* BYPASS LEADING BLANKS AND/OR COMMENTS IF A FIELD         */ 11362000
*        /* CONTINUATION DELIMITER WAS FOUND ENDING THE PRECEDING    */ 11363000
*        /* INPUT RECORD.                                            */ 11364000
*        /*                                                          */ 11365000
*        /************************************************************/ 11366000
*        IF SKIPLEAD=YES & COMMENT=NO                              2156 11367000
*          THEN                                                    2156 11368000
         TM    SKIPLEAD,B'10000000'                                2156 11369000
         BNO   @RF02156                                            2156 11370000
         TM    COMMENT,B'01000000'                                 2156 11371000
         BNZ   @RF02156                                            2156 11372000
*DOGRP195:   DO;                                                   2157 11373000
DOGRP195 DS    0H                                                  2158 11374000
*              OLDERID2 = NEWERID2;                                2158 11375000
         L     @02,GDTTR2(,GDTPTR)                                 2158 11376000
         MVC   @TS00001(95),NEWERID2(@02)                          2158 11377000
         MVC   OLDERID2(95,@02),@TS00001                           2158 11378000
*              NEWID2='RI60';                                      2159 11379000
         MVC   NEWID2(4,@02),@CC01389                              2159 11380000
*DOLOOP45:     DO INDEX=SCANINDX TO SCNLIMIT WHILE(SKIPLEAD=YES);  2160 11381000
DOLOOP45 LH    @02,SCANINDX                                        2160 11382000
         B     @DE02160                                            2160 11383000
@DL02160 TM    SKIPLEAD,B'10000000'                                2160 11384000
         BNO   @DC02160                                            2160 11385000
*                IF INREC(INDEX) ^= BLANK                          2161 11386000
*                  THEN                                            2161 11387000
*                                                                  2161 11388000
         L     @15,RECRDPTR                                        2161 11389000
         ALR   @02,@15                                             2161 11390000
         BCTR  @02,0                                               2161 11391000
         CLI   INREC(@02),C' '                                     2161 11392000
         BE    @RF02161                                            2161 11393000
*                    /************************************************/ 11394000
*                    /*                                              */ 11395000
*                    /* IF BYPASSING A LEADING COMMENT, LOOK FOR THE */ 11396000
*                    /* DELIMITER WHICH ENDS THE COMMENT.            */ 11397000
*                    /*                                              */ 11398000
*                    /************************************************/ 11399000
*                    IF INCOMM=YES                                 2162 11400000
*                      THEN                                        2162 11401000
         TM    INCOMM,B'00100000'                                  2162 11402000
         BNO   @RF02162                                            2162 11403000
*                        IF INDEX < SCNLIMIT &                     2163 11404000
*                           INREC(INDEX:INDEX+1) = COMEND          2163 11405000
*                          THEN                                    2163 11406000
         LH    @02,INDEX                                           2163 11407000
         CH    @02,SCNLIMIT                                        2163 11408000
         BNL   @RF02163                                            2163 11409000
         ALR   @15,@02                                             2163 11410000
         BCTR  @15,0                                               2163 11411000
         CLC   INREC(2,@15),COMEND                                 2163 11412000
         BNE   @RF02163                                            2163 11413000
*                            DO;                                   2164 11414000
*                            OLDERID2 = NEWERID2;                  2165 11415000
         L     @15,GDTTR2(,GDTPTR)                                 2165 11416000
         MVC   @TS00001(95),NEWERID2(@15)                          2165 11417000
         MVC   OLDERID2(95,@15),@TS00001                           2165 11418000
*                            NEWID2='RI61';                        2166 11419000
         MVC   NEWID2(4,@15),@CC01392                              2166 11420000
*                            INDEX=INDEX+1;                        2167 11421000
         LA    @02,1(,@02)                                         2167 11422000
         STH   @02,INDEX                                           2167 11423000
*                            INCOMM=NO;                            2168 11424000
         NI    INCOMM,B'11011111'                                  2168 11425000
*                            END;                                  2169 11426000
*                          ELSE;                                   2170 11427000
*                                                                  2170 11428000
@RF02163 DS    0H                                                  2171 11429000
*                      /**********************************************/ 11430000
*                      /*                                            */ 11431000
*                      /* WHEN BYPASSING LEADING BLANKS, CHECK FOR   */ 11432000
*                      /* LEADING COMMENTS AND FOR A NON-BLANK       */ 11433000
*                      /* CHARACTER INDICATING STARTING SCAN POSITION*/ 11434000
*                      /*                                            */ 11435000
*                      /**********************************************/ 11436000
*                      ELSE                                        2171 11437000
*                        IF INDEX < SCNLIMIT &                     2171 11438000
*                           INREC(INDEX:INDEX+1) = COMSTART        2171 11439000
*                          THEN                                    2171 11440000
         B     @RC02162                                            2171 11441000
@RF02162 LH    @02,INDEX                                           2171 11442000
         CH    @02,SCNLIMIT                                        2171 11443000
         BNL   @RF02171                                            2171 11444000
         L     @01,RECRDPTR                                        2171 11445000
         ALR   @01,@02                                             2171 11446000
         BCTR  @01,0                                               2171 11447000
         CLC   INREC(2,@01),COMSTART                               2171 11448000
         BNE   @RF02171                                            2171 11449000
*                            DO;                                   2172 11450000
*                            OLDERID2 = NEWERID2;                  2173 11451000
         L     @15,GDTTR2(,GDTPTR)                                 2173 11452000
         MVC   @TS00001(95),NEWERID2(@15)                          2173 11453000
         MVC   OLDERID2(95,@15),@TS00001                           2173 11454000
*                            NEWID2='RI62';                        2174 11455000
         MVC   NEWID2(4,@15),@CC01393                              2174 11456000
*                            INCOMM=YES;                           2175 11457000
         OI    INCOMM,B'00100000'                                  2175 11458000
*                            INDEX=INDEX+1;                        2176 11459000
         LA    @02,1(,@02)                                         2176 11460000
         STH   @02,INDEX                                           2176 11461000
*                            END;                                  2177 11462000
*                          ELSE                                    2178 11463000
*                            DO;                                   2178 11464000
         B     @RC02171                                            2178 11465000
@RF02171 DS    0H                                                  2179 11466000
*                            SKIPLEAD=NO;                          2179 11467000
         NI    SKIPLEAD,B'01111111'                                2179 11468000
*                            SCANINDX=INDEX;                       2180 11469000
         MVC   SCANINDX(2),INDEX                                   2180 11470000
*                            END;                                  2181 11471000
*              END DOLOOP45;                                       2182 11472000
@RC02171 DS    0H                                                  2182 11473000
@RC02162 DS    0H                                                  2182 11474000
@RF02161 LA    @02,1                                               2182 11475000
         AH    @02,INDEX                                           2182 11476000
@DE02160 STH   @02,INDEX                                           2182 11477000
         CH    @02,SCNLIMIT                                        2182 11478000
         BNH   @DL02160                                            2182 11479000
@DC02160 DS    0H                                                  2183 11480000
*              /******************************************************/ 11481000
*              /*                                                    */ 11482000
*              /* IF ONLY BLANKS AND COMMENTS WERE FOUND IN THIS     */ 11483000
*              /* RECORD FOLLOWING FIELD CONTINUATION, THEN CHECK TO */ 11484000
*              /* SEE IF THE RECORD IS CONTINUED.  IF SO, NOTE THAT  */ 11485000
*              /* IT SHOULD STILL BE CONSIDERED FIELD CONTINUATION.  */ 11486000
*              /* IF NOT CONTINUED, SET 'CHAR2' TO BE BLANK UNTIL THE*/ 11487000
*              /* NEXT CALL TO 'NEXTCHAR' CAN FABRICATE A SEMICOLON. */ 11488000
*              /*                                                    */ 11489000
*              /******************************************************/ 11490000
*              IF SKIPLEAD=YES                                     2183 11491000
*                THEN                                              2183 11492000
         TM    SKIPLEAD,B'10000000'                                2183 11493000
         BNO   @RF02183                                            2183 11494000
*                  DO;                                             2184 11495000
*                  SCANINDX=INDEX+1;                               2185 11496000
         LH    @02,INDEX                                           2185 11497000
         LA    @02,1(,@02)                                         2185 11498000
         STH   @02,SCANINDX                                        2185 11499000
*                  IF MORTOCOM=YES                                 2186 11500000
*                    THEN                                          2186 11501000
         TM    MORTOCOM,B'00010000'                                2186 11502000
         BNO   @RF02186                                            2186 11503000
*                      CONTNEXT=YES;                               2187 11504000
         OI    CONTNEXT,B'00001000'                                2187 11505000
*                    ELSE                                          2188 11506000
*                      CHAR2=BLANK;                                2188 11507000
         B     @RC02186                                            2188 11508000
@RF02186 MVI   CHAR2,C' '                                          2188 11509000
*                  END;                                            2189 11510000
@RC02186 DS    0H                                                  2190 11511000
*            END DOGRP195;                                         2190 11512000
*                                                                  2190 11513000
@RF02183 DS    0H                                                  2191 11514000
*        /************************************************************/ 11515000
*        /*                                                          */ 11516000
*        /* ADJUST STARTING SCAN POSITION IN PREPARATION FOR         */ 11517000
*        /* INCREMENTING OF THE SCAN POSITION POINTER.  ADJUST ENDING*/ 11518000
*        /* SCAN LIMIT IF COMMAND CONTINUATION IS NOT INDICATED IN   */ 11519000
*        /* PREPARATION FOR FABRICATING A COMMAND-ENDING DELIMITER.  */ 11520000
*        /*                                                          */ 11521000
*        /************************************************************/ 11522000
*        SCANINDX=SCANINDX-1;                                      2191 11523000
@RF02156 LH    @02,SCANINDX                                        2191 11524000
         BCTR  @02,0                                               2191 11525000
         STH   @02,SCANINDX                                        2191 11526000
*        IF MORTOCOM=NO                                            2192 11527000
*          THEN                                                    2192 11528000
         TM    MORTOCOM,B'00010000'                                2192 11529000
         BNZ   @RF02192                                            2192 11530000
*            SCNLIMIT=SCNLIMIT+1;                                  2193 11531000
*                                                                  2193 11532000
         LH    @02,SCNLIMIT                                        2193 11533000
         LA    @02,1(,@02)                                         2193 11534000
         STH   @02,SCNLIMIT                                        2193 11535000
*        END SCANENDS;                                             2194 11536000
*                                                                  2194 11537000
*                                                                  2194 11538000
@EL00032 DS    0H                                                  2194 11539000
@EF00032 DS    0H                                                  2194 11540000
@ER00032 LM    @14,@12,@SA00032                                    2194 11541000
         BR    @14                                                 2194 11542000
*        END GETRECRD;                                     /*@YL026UL*/ 11543000
*                                                                  2195 11544000
*                                                                  2195 11545000
@EL00031 DS    0H                                                  2195 11546000
@EF00031 DS    0H                                                  2195 11547000
@ER00031 LM    @14,@12,@SA00031                                    2195 11548000
         BR    @14                                                 2195 11549000
*        END NEXTCHAR;                                     /*@YL026UL*/ 11550000
@EL00030 DS    0H                                                  2196 11551000
@EF00030 DS    0H                                                  2196 11552000
@ER00030 LM    @14,@12,@SA00030                                    2196 11553000
         BR    @14                                                 2196 11554000
*/********************************************************************/ 11555000
*/*                                                                  */ 11556000
*/*  PROCEDURE NAME - DSPLCALC                                       */ 11557000
*/*                                                                  */ 11558000
*/*  FUNCTION - THIS ROUTINE CALCULATES THE OFFSET INTO THE CURRENT  */ 11559000
*/*             PARAMETER'S FDT POINTER VECTOR AT WHICH A VALUE IS   */ 11560000
*/*             TO BE INSERTED.  THE VALUE IS ONE WHICH IS RELATED   */ 11561000
*/*             THE FDT POINTER STRUCTURE USED FOR REPEATED SUBLISTS */ 11562000
*/*             AND THE OFFSET IS BASED UPON THE CURRENT REPEATED    */ 11563000
*/*             SUBLIST NESTING LEVEL AND THE MAXIMUM NUMBER OF      */ 11564000
*/*             SUBLIST REPETITIONS ALLOWED.                         */ 11565000
*/*                                                                  */ 11566000
*/*  INPUT -                                                         */ 11567000
*/*          DEPTH -   CURRENT LEVEL OF REPEATED SUBLIST NESTING     */ 11568000
*/*          REPLIMIT- LIST CONTAINING THE MAXIMUM NUMBER OF SUBLIST */ 11569000
*/*                    REPETITIONS ALLOWED AT EACH REPEATEDNESS LEVEL*/ 11570000
*/*          ARRYPTR - POINTER IN MAIN FDT POINTER VECTOR WHICH      */ 11571000
*/*                    POINTS TO CURRENT PARAMETER'S SECONDARY PTR   */ 11572000
*/*                    VECTOR.                                       */ 11573000
*/*                                                                  */ 11574000
*/*  OUTPUT -                                                        */ 11575000
*/*          ARRYPTR - POINTER TO SECONDARY POINTER VECTOR, THE      */ 11576000
*/*                    DISPLACEMENT INTO WHICH A VALUE WILL BE       */ 11577000
*/*                    INSERTED AFTER THE RETURN FROM 'DSPLCALC'     */ 11578000
*/*          ARRYDSPL- THE CALCULATED DISPLACEMENT                   */ 11579000
*/*                                                                  */ 11580000
*/********************************************************************/ 11581000
*DSPLCALC:PROCEDURE(DEPTH);                                        2197 11582000
DSPLCALC STM   @14,@01,@SA00033                                    2197 11583000
         ST    @03,@SA00033+16                                     2197 11584000
         STM   @05,@12,@SA00033+20                                 2197 11585000
         MVC   @PC00033(4),0(@01)                                  2197 11586000
*        /************************************************************/ 11587000
*        /*                                                          */ 11588000
*        /* DSPLCALC PROCEDURE DATA DEFINITIONS                      */ 11589000
*        /*                                                          */ 11590000
*        /************************************************************/ 11591000
*        DCL DEPTH FIXED(15);          /*DEPTH OF REPEATED LIST    2198 11592000
*                                        NESTING WITH WHICH THE COUNT   11593000
*                                        OR POINTER IS ASSOCIATED    */ 11594000
*        DCL FACTOR   FIXED(15);       /*MULTIPLICATION FACTOR USED IN  11595000
*                                        CALCULATING ARRAY OFFSETS   */ 11596000
*        /************************************************************/ 11597000
*        /*                                                          */ 11598000
*        /*  ** DSPLCALC ** CALCULATE DISPLACEMENT INTO PTR ARRAY    */ 11599000
*        /*                                                          */ 11600000
*        /************************************************************/ 11601000
*        IF GDTDBG = NULLPTR                                       2200 11602000
*          THEN;                                                   2200 11603000
         ICM   @15,15,GDTDBG(GDTPTR)                               2200 11604000
         BZ    @RT02200                                            2200 11605000
*          ELSE                                                    2202 11606000
*            CALL IDCDB010(GDTTBL,'RIDC');                         2202 11607000
*                                                                  2202 11608000
         ST    GDTPTR,@AL00001                                     2202 11609000
         LA    @15,@CC01400                                        2202 11610000
         ST    @15,@AL00001+4                                      2202 11611000
         MVI   @AL00001+4,X'80'                                    2202 11612000
         L     @15,GDTDBG(,GDTPTR)                                 2202 11613000
         LA    @01,@AL00001                                        2202 11614000
         BALR  @14,@15                                             2202 11615000
*        ARRYDSPL=0;                                               2203 11616000
@RT02200 SLR   ARRYDSPL,ARRYDSPL                                   2203 11617000
*        IF DEPTH=0                                                2204 11618000
*          THEN                                                    2204 11619000
         L     @05,@PC00033                                        2204 11620000
         ICM   @15,3,DEPTH(@05)                                    2204 11621000
         BNZ   @RF02204                                            2204 11622000
*            ARRYPTR=ADDR(FDTPTR(PARMID));                 /*@YL026UL*/ 11623000
         LH    @05,PARMID                                          2205 11624000
         SLA   @05,2                                               2205 11625000
         L     ARRYPTR,FDTADDR                                     2205 11626000
         LA    ARRYPTR,FDTPTR-4(@05,ARRYPTR)                       2205 11627000
*          ELSE                                                    2206 11628000
*            DO INDEX=1 TO DEPTH;                          /*@YL026UL*/ 11629000
         B     @RC02204                                            2206 11630000
@RF02204 LA    @05,1                                               2206 11631000
         B     @DE02206                                            2206 11632000
@DL02206 DS    0H                                                  2207 11633000
*              FACTOR=1;                                   /*@YL026UL*/ 11634000
         LA    @15,1                                               2207 11635000
         LR    FACTOR,@15                                          2207 11636000
*              DO LISTINDX=(INDEX+1) TO DEPTH;             /*@YL026UL*/ 11637000
         LH    @14,INDEX                                           2208 11638000
         ALR   @14,@15                                             2208 11639000
         B     @DE02208                                            2208 11640000
@DL02208 DS    0H                                                  2209 11641000
*                FACTOR=FACTOR*REPLIMIT(LISTINDX);         /*@YL026UL*/ 11642000
         LR    @15,@14                                             2209 11643000
         ALR   @15,@15                                             2209 11644000
         LR    @01,FACTOR                                          2209 11645000
         MH    @01,REPLIMIT-2(@15)                                 2209 11646000
         LR    FACTOR,@01                                          2209 11647000
*              END;                                        /*@YL026UL*/ 11648000
         AL    @14,@CF00228                                        2210 11649000
@DE02208 STH   @14,LISTINDX                                        2210 11650000
         L     @15,@PC00033                                        2210 11651000
         CH    @14,DEPTH(,@15)                                     2210 11652000
         BNH   @DL02208                                            2210 11653000
*              ARRYDSPL=ARRYDSPL+FACTOR*PTRLNGTH*(REPCOUNT(INDEX)-1);   11654000
         LR    @01,FACTOR                                          2211 11655000
         SLA   @01,2                                               2211 11656000
         LH    @15,INDEX                                           2211 11657000
         LR    @14,@15                                             2211 11658000
         ALR   @14,@14                                             2211 11659000
         LH    @14,REPCOUNT-2(@14)                                 2211 11660000
         BCTR  @14,0                                               2211 11661000
         MR    @00,@14                                             2211 11662000
         ALR   ARRYDSPL,@01                                        2211 11663000
*            END;                                          /*@YL026UL*/ 11664000
*                                                                  2212 11665000
         AL    @15,@CF00228                                        2212 11666000
         LR    @05,@15                                             2212 11667000
@DE02206 STH   @05,INDEX                                           2212 11668000
         L     @15,@PC00033                                        2212 11669000
         CH    @05,DEPTH(,@15)                                     2212 11670000
         BNH   @DL02206                                            2212 11671000
*        /************************************************************/ 11672000
*        /*                                                          */ 11673000
*        /* IF THE DATA POINTER IS FOR A PARAMETER IN A REPEATED     */ 11674000
*        /* PARAMETER LIST (1ST LEVEL OF REPEATEDNESS), THEN THE     */ 11675000
*        /* POINTER VECTOR IS BEING MAINTAINED AS A LIST OF VECTOR   */ 11676000
*        /* BLOCKS.  SET UP TO POINT TO THE PROPER DATA POINTER IN   */ 11677000
*        /* THE PROPER BLOCK IN THE LIST.                            */ 11678000
*        /*                                                          */ 11679000
*        /************************************************************/ 11680000
*        IF DEPTH=1                                                2213 11681000
*          THEN                                                    2213 11682000
@RC02204 LA    @05,1                                               2213 11683000
         L     @15,@PC00033                                        2213 11684000
         CH    @05,DEPTH(,@15)                                     2213 11685000
         BNE   @RF02213                                            2213 11686000
*            DO;                                                   2214 11687000
*              OLDERID2 = NEWERID2;                                2215 11688000
         L     @15,GDTTR2(,GDTPTR)                                 2215 11689000
         MVC   @TS00001(95),NEWERID2(@15)                          2215 11690000
         MVC   OLDERID2(95,@15),@TS00001                           2215 11691000
*              NEWID2='RI66';                                      2216 11692000
         MVC   NEWID2(4,@15),@CC01401                              2216 11693000
*              VECTRNUM=ARRYDSPL/VECTRLEN+1;                       2217 11694000
         LH    @15,VECTRLEN                                        2217 11695000
         LR    @00,ARRYDSPL                                        2217 11696000
         SRDA  @00,32                                              2217 11697000
         DR    @00,@15                                             2217 11698000
         ALR   @01,@05                                             2217 11699000
         STH   @01,VECTRNUM                                        2217 11700000
*              ARRYDSPL=ARRYDSPL//VECTRLEN;                        2218 11701000
         LR    @00,ARRYDSPL                                        2218 11702000
         SRDA  @00,32                                              2218 11703000
         DR    @00,@15                                             2218 11704000
         LR    ARRYDSPL,@00                                        2218 11705000
*              DO INDEX2=1 TO VECTRNUM-1;                          2219 11706000
         B     @DE02219                                            2219 11707000
@DL02219 DS    0H                                                  2220 11708000
*                ARRYPTR=VECTRPTR;                                 2220 11709000
         LR    @15,ARRYPTR                                         2220 11710000
         AH    @15,VECTRLEN                                        2220 11711000
         L     @15,VECTRPTR(,@15)                                  2220 11712000
         LR    ARRYPTR,@15                                         2220 11713000
*              END;                                                2221 11714000
         AL    @05,@CF00228                                        2221 11715000
@DE02219 STH   @05,INDEX2                                          2221 11716000
         LH    @15,VECTRNUM                                        2221 11717000
         BCTR  @15,0                                               2221 11718000
         CR    @05,@15                                             2221 11719000
         BNH   @DL02219                                            2221 11720000
*            END;                                                  2222 11721000
*                                                                  2222 11722000
*        END DSPLCALC;                                             2223 11723000
@EL00033 DS    0H                                                  2223 11724000
@EF00033 DS    0H                                                  2223 11725000
@ER00033 LM    @14,@01,@SA00033                                    2223 11726000
         L     @03,@SA00033+16                                     2223 11727000
         LM    @05,@12,@SA00033+20                                 2223 11728000
         BR    @14                                                 2223 11729000
*/********************************************************************/ 11730000
*/*                                                                  */ 11731000
*/*  PROCEDURE NAME - ERROR1                                         */ 11732000
*/*                                                                  */ 11733000
*/*  FUNCTION - THIS ROUTINE HANDLES A SYNTAX OR SEMANTIC ERROR WHICH*/ 11734000
*/*             REQUIRES SKIPPING OF THE CURRENT INPUT COMMAND. THIS */ 11735000
*/*             TYPE OF ERROR WILL ALLOW SCANNING TO CONTINUE WITH   */ 11736000
*/*             THE NEXT COMMAND.  THE ERROR MESSAGE CONSISTS        */ 11737000
*/*             ENTIRELY OF STATIC TEXT.                             */ 11738000
*/*                                                                  */ 11739000
*/*  INPUT -                                                         */ 11740000
*/*          ERRCODE1- ERROR CODE WHICH IDENTIFIES THE ERROR AND     */ 11741000
*/*                    WILL BE USED AS PART OF THE MESSAGE ID        */ 11742000
*/*          SCANONLY- FLAG SET 'ON' WHEN CURRENT RECORD IS BEING    */ 11743000
*/*                    SCANNED FOR SYNTAX CHECKING PURPOSES ONLY     */ 11744000
*/*          SKIPPAST- FLAG SET 'ON' TO SIGNAL THAT CURRENT COMMAND  */ 11745000
*/*                    HAS BEEN SKIPPED                              */ 11746000
*/*                                                                  */ 11747000
*/*  OUTPUT -                                                        */ 11748000
*/*          PRINTED ERROR MESSAGE.                                  */ 11749000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO THE ERROR    */ 11750000
*/*                    CODE VALUE                                    */ 11751000
*/*          LASTCC -  LAST SYSTEM CONDITION CODE                    */ 11752000
*/*          SCANONLY- SEE 'INPUT'                                   */ 11753000
*/*                                                                  */ 11754000
*/********************************************************************/ 11755000
*ERROR1: PROCEDURE(ERRCODE1);                                      2224 11756000
ERROR1   STM   @14,@12,@SA00034                                    2224 11757000
         MVC   @PC00034(4),0(@01)                                  2224 11758000
*        /************************************************************/ 11759000
*        /*                                                          */ 11760000
*        /* ERROR1 PROCEDURE DATA DEFINITIONS                        */ 11761000
*        /*                                                          */ 11762000
*        /************************************************************/ 11763000
*        DCL ERRCODE1 FIXED(31);       /*STATIC ERROR MESSAGE CODE   */ 11764000
*        /************************************************************/ 11765000
*        /*                                                          */ 11766000
*        /*  ** ERROR1 **  HANDLE SYNTAX OR SEMANTIC ERROR           */ 11767000
*        /*                                                          */ 11768000
*        /************************************************************/ 11769000
*        IF GDTDBG = NULLPTR                                       2226 11770000
*          THEN;                                                   2226 11771000
         ICM   @02,15,GDTDBG(GDTPTR)                               2226 11772000
         BZ    @RT02226                                            2226 11773000
*          ELSE                                                    2228 11774000
*            CALL IDCDB010(GDTTBL,'RIE1');                         2228 11775000
*                                                                  2228 11776000
         ST    GDTPTR,@AL00001                                     2228 11777000
         LA    @02,@CC01407                                        2228 11778000
         ST    @02,@AL00001+4                                      2228 11779000
         MVI   @AL00001+4,X'80'                                    2228 11780000
         L     @15,GDTDBG(,GDTPTR)                                 2228 11781000
         LA    @01,@AL00001                                        2228 11782000
         BALR  @14,@15                                             2228 11783000
*        IF SCANONLY=NO                                            2229 11784000
*          THEN                                                    2229 11785000
@RT02226 TM    SCANONLY,B'00010000'                                2229 11786000
         BNZ   @RF02229                                            2229 11787000
*            LASTCC=BADERROR;                                      2230 11788000
         MVC   LASTCC(2),@CH00038                                  2230 11789000
*        RISTATUS=ERRCODE1;                                        2231 11790000
@RF02229 L     @02,@PC00034                                        2231 11791000
         L     @02,ERRCODE1(,@02)                                  2231 11792000
         STH   @02,RISTATUS                                        2231 11793000
*        IF ERRCODE1^=NOSPACE                                      2232 11794000
*          THEN                                                    2232 11795000
         CH    @02,@CH00811                                        2232 11796000
         BE    @RF02232                                            2232 11797000
*            DO;                                                   2233 11798000
*            DARGSMOD=RISTID;                                      2234 11799000
         L     @15,DDSTRU                                          2234 11800000
         MVC   DARGSMOD(3,@15),RISTID                              2234 11801000
*            DARGSENT=ERRCODE1;                                    2235 11802000
         STC   @02,DARGSENT(,@15)                                  2235 11803000
*            END;                                                  2236 11804000
*          ELSE                                                    2237 11805000
*            DO;                                                   2237 11806000
         B     @RC02232                                            2237 11807000
@RF02232 DS    0H                                                  2238 11808000
*            DARGSMOD='UV0';                                       2238 11809000
         L     @02,DDSTRU                                          2238 11810000
         MVC   DARGSMOD(3,@02),@CC01408                            2238 11811000
*            DARGSENT=4;                                           2239 11812000
         MVI   DARGSENT(@02),X'04'                                 2239 11813000
*            END;                                                  2240 11814000
*                                                                  2240 11815000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                     2241 11816000
*                                                                  2241 11817000
@RC02232 ST    GDTPTR,@AL00001                                     2241 11818000
         LA    @02,@CF00125                                        2241 11819000
         ST    @02,@AL00001+4                                      2241 11820000
         LA    @02,DDSTRU                                          2241 11821000
         ST    @02,@AL00001+8                                      2241 11822000
         MVI   @AL00001+8,X'80'                                    2241 11823000
         L     @15,GDTPRT(,GDTPTR)                                 2241 11824000
         LA    @01,@AL00001                                        2241 11825000
         BALR  @14,@15                                             2241 11826000
*        /************************************************************/ 11827000
*        /*                                                          */ 11828000
*        /* SCAN UP TO THE NEXT COMMAND FOLLOWING THE COMMAND THAT   */ 11829000
*        /* CONTAINS THE ERROR, IF THIS HAS NOT ALREADY BEEN DONE.   */ 11830000
*        /*                                                          */ 11831000
*        /************************************************************/ 11832000
*        IF SKIPPAST=NO                                            2242 11833000
*          THEN                                                    2242 11834000
         TM    SKIPPAST,B'00001000'                                2242 11835000
         BNZ   @RF02242                                            2242 11836000
*            DO;                                                   2243 11837000
*                                                                  2243 11838000
*              CALL SKIPCMD;                                       2244 11839000
*                                                                  2244 11840000
         BAL   @14,SKIPCMD                                         2244 11841000
*              DO WHILE(MORTOCOM=YES & RISTATUS^=EOFILE &          2245 11842000
*                       RISTATUS^=SKIPREST);                       2245 11843000
*                                                                  2245 11844000
         B     @DE02245                                            2245 11845000
@DL02245 DS    0H                                                  2246 11846000
*                CALL NEXTCHAR;                                    2246 11847000
         BAL   @14,NEXTCHAR                                        2246 11848000
*                CALL SKIPCMD;                                     2247 11849000
*                                                                  2247 11850000
         BAL   @14,SKIPCMD                                         2247 11851000
*              END;                                                2248 11852000
@DE02245 TM    MORTOCOM,B'00010000'                                2248 11853000
         BNO   @DC02245                                            2248 11854000
         LH    @02,RISTATUS                                        2248 11855000
         CH    @02,@CH00157                                        2248 11856000
         BE    @DC02245                                            2248 11857000
         CH    @02,@CH00042                                        2248 11858000
         BNE   @DL02245                                            2248 11859000
@DC02245 DS    0H                                                  2249 11860000
*            END;                                                  2249 11861000
*                                                                  2249 11862000
*        END ERROR1;                                               2250 11863000
@EL00034 DS    0H                                                  2250 11864000
@EF00034 DS    0H                                                  2250 11865000
@ER00034 LM    @14,@12,@SA00034                                    2250 11866000
         BR    @14                                                 2250 11867000
*/********************************************************************/ 11868000
*/*                                                                  */ 11869000
*/*  PROCEDURE NAME - ERROR2                                         */ 11870000
*/*                                                                  */ 11871000
*/*  FUNCTION - THIS ROUTINE HANDLES A SYNTAX OR SEMANTIC ERROR      */ 11872000
*/*             WHICH REQUIRES SKIPPING OF THE CURRENT INPUT COMMAND.*/ 11873000
*/*             THIS TYPE OF ERROR WILL ALLOW SCANNING TO CONTINUE   */ 11874000
*/*             WITH THE NEXT COMMAND.  THE ERROR MESSAGE CONSISTS   */ 11875000
*/*             OF STATIC TEXT WITH AN ITEM FROM THE COMMAND TO HELP */ 11876000
*/*             IDENTIFY THE SOURCE OF THE ERROR.                    */ 11877000
*/*                                                                  */ 11878000
*/*  INPUT -                                                         */ 11879000
*/*          ERRCODE2- ERROR CODE WHICH IDENTIFIES THE ERROR AND     */ 11880000
*/*                    WHICH IS USED AS PART OF THE MESSAGE ID.      */ 11881000
*/*          INSRTLEN- LENGTH OF THE COMMAND ITEM TO BE INSERTED     */ 11882000
*/*                    INTO THE MESSAGE                              */ 11883000
*/*          INSRTPTR- POINTER TO THE COMMAND ITEM TO BE INSERTED    */ 11884000
*/*                    INTO THE MESSAGE.                             */ 11885000
*/*          SCANONLY- FLAG SET 'ON' WHEN CURRENT RECORD IS BEING    */ 11886000
*/*                    SCANNED FOR SYNTAX CHECKING PURPOSES ONLY.    */ 11887000
*/*          SKIPPAST- FLAG SET 'ON' TO SIGNAL THAT CURRENT COMMAND  */ 11888000
*/*                    HAS BEEN SKIPPED.                             */ 11889000
*/*                                                                  */ 11890000
*/*  OUTPUT -                                                        */ 11891000
*/*          PRINTED ERROR MESSAGE.                                  */ 11892000
*/*          RISTATUS- R/I INTERNAL STATUS CODE; SET TO THE NON-ZERO */ 11893000
*/*                    ERROR MESSAGE CODE VALUE                      */ 11894000
*/*          LASTCC -  LAST SYSTEM CONDITION CODE                    */ 11895000
*/*          SCANONLY- SEE 'INPUT'                                   */ 11896000
*/*                                                                  */ 11897000
*/********************************************************************/ 11898000
*ERROR2: PROCEDURE(ERRCODE2,           /*STATIC ERROR MESSAGE ID#    */ 11899000
*                  INSRTLEN,           /*INSERT DATA ITEM LENGTH     */ 11900000
*                  INSRTPTR);          /*INSERT DATA ITEM ADDRESS    */ 11901000
ERROR2   STM   @14,@12,@SA00035                                    2251 11902000
         MVC   @PC00035(12),0(@01)                                 2251 11903000
*        /************************************************************/ 11904000
*        /*                                                          */ 11905000
*        /* ERROR2 PROCEDURE DATA DEFINITIONS                        */ 11906000
*        /*                                                          */ 11907000
*        /************************************************************/ 11908000
*        DCL ERRCODE2 FIXED(31);       /*STATIC ERROR MESSAGE CODE   */ 11909000
*        DCL INSRTLEN FIXED(31);       /*LENGTH OF DATA ITEM TO BE 2253 11910000
*                                        INSERTED INTO ERROR MESSAGE */ 11911000
*        DCL INSRTPTR PTR(31);         /*PTR TO DATA ITEM TO BE    2254 11912000
*                                        INSERTED INTO ERROR MESSAGE */ 11913000
*        /************************************************************/ 11914000
*        /*                                                          */ 11915000
*        /*  ** ERROR2 **  HANDLE SYNTAX OR SEMANTIC ERROR           */ 11916000
*        /*                                                          */ 11917000
*        /************************************************************/ 11918000
*        IF GDTDBG = NULLPTR                                       2255 11919000
*          THEN;                                                   2255 11920000
         ICM   @02,15,GDTDBG(GDTPTR)                               2255 11921000
         BZ    @RT02255                                            2255 11922000
*          ELSE                                                    2257 11923000
*            CALL IDCDB010(GDTTBL,'RIE2');                         2257 11924000
*                                                                  2257 11925000
         ST    GDTPTR,@AL00001                                     2257 11926000
         LA    @02,@CC01418                                        2257 11927000
         ST    @02,@AL00001+4                                      2257 11928000
         MVI   @AL00001+4,X'80'                                    2257 11929000
         L     @15,GDTDBG(,GDTPTR)                                 2257 11930000
         LA    @01,@AL00001                                        2257 11931000
         BALR  @14,@15                                             2257 11932000
*        IF SCANONLY=NO                                            2258 11933000
*          THEN                                                    2258 11934000
@RT02255 TM    SCANONLY,B'00010000'                                2258 11935000
         BNZ   @RF02258                                            2258 11936000
*            LASTCC=BADERROR;                                      2259 11937000
         MVC   LASTCC(2),@CH00038                                  2259 11938000
*        RISTATUS=ERRCODE2;                                        2260 11939000
@RF02258 L     @02,@PC00035                                        2260 11940000
         L     @02,ERRCODE2(,@02)                                  2260 11941000
         STH   @02,RISTATUS                                        2260 11942000
*        DARGDBP=INSRTPTR;                                         2261 11943000
         L     @15,DDSTRU                                          2261 11944000
         L     @14,@PC00035+8                                      2261 11945000
         MVC   DARGDBP(4,@15),INSRTPTR(@14)                        2261 11946000
*        DARGILP=INSRTLEN;                                         2262 11947000
         L     @14,@PC00035+4                                      2262 11948000
         MVC   DARGILP(2,@15),INSRTLEN+2(@14)                      2262 11949000
*        DARGSMOD=RISTID;                                          2263 11950000
         MVC   DARGSMOD(3,@15),RISTID                              2263 11951000
*        DARGSENT=ERRCODE2;                                        2264 11952000
*                                                                  2264 11953000
         STC   @02,DARGSENT(,@15)                                  2264 11954000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                     2265 11955000
*                                                                  2265 11956000
         ST    GDTPTR,@AL00001                                     2265 11957000
         LA    @02,@CF00125                                        2265 11958000
         ST    @02,@AL00001+4                                      2265 11959000
         LA    @02,DDSTRU                                          2265 11960000
         ST    @02,@AL00001+8                                      2265 11961000
         MVI   @AL00001+8,X'80'                                    2265 11962000
         L     @15,GDTPRT(,GDTPTR)                                 2265 11963000
         LA    @01,@AL00001                                        2265 11964000
         BALR  @14,@15                                             2265 11965000
*        /************************************************************/ 11966000
*        /*                                                          */ 11967000
*        /* SCAN UP TO THE NEXT COMMAND FOLLOWING THE COMMAND THAT   */ 11968000
*        /* CONTAINS THE ERROR, IF THIS HAS NOT ALREADY BEEN DONE.   */ 11969000
*        /*                                                          */ 11970000
*        /************************************************************/ 11971000
*        IF SKIPPAST=NO                                            2266 11972000
*          THEN                                                    2266 11973000
         TM    SKIPPAST,B'00001000'                                2266 11974000
         BNZ   @RF02266                                            2266 11975000
*            DO;                                                   2267 11976000
*                                                                  2267 11977000
*              CALL SKIPCMD;                                       2268 11978000
*                                                                  2268 11979000
         BAL   @14,SKIPCMD                                         2268 11980000
*              DO WHILE(MORTOCOM=YES & RISTATUS^=EOFILE &          2269 11981000
*                       RISTATUS^=SKIPREST);                       2269 11982000
*                                                                  2269 11983000
         B     @DE02269                                            2269 11984000
@DL02269 DS    0H                                                  2270 11985000
*                CALL NEXTCHAR;                                    2270 11986000
         BAL   @14,NEXTCHAR                                        2270 11987000
*                CALL SKIPCMD;                                     2271 11988000
*                                                                  2271 11989000
         BAL   @14,SKIPCMD                                         2271 11990000
*              END;                                                2272 11991000
@DE02269 TM    MORTOCOM,B'00010000'                                2272 11992000
         BNO   @DC02269                                            2272 11993000
         LH    @02,RISTATUS                                        2272 11994000
         CH    @02,@CH00157                                        2272 11995000
         BE    @DC02269                                            2272 11996000
         CH    @02,@CH00042                                        2272 11997000
         BNE   @DL02269                                            2272 11998000
@DC02269 DS    0H                                                  2273 11999000
*            END;                                                  2273 12000000
*                                                                  2273 12001000
*        END ERROR2;                                               2274 12002000
*                                                                  2274 12003000
*                                                                  2274 12004000
@EL00035 DS    0H                                                  2274 12005000
@EF00035 DS    0H                                                  2274 12006000
@ER00035 LM    @14,@12,@SA00035                                    2274 12007000
         BR    @14                                                 2274 12008000
*        END IDCRI01                                               2275 12009000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 12010000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 12011000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 12012000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 12013000
*/*%INCLUDE SYSLIB  (AMSDF25 )                                        * 12014000
*/*%INCLUDE SYSLIB  (AMSDF26 )                                        * 12015000
*;                                                                 2275 12016000
@DATA    DS    0H                                                       12017000
@CH00295 DC    H'5'                                                     12018000
@CH00043 DC    H'7'                                                     12019000
@CH00482 DC    H'16'                                                    12020000
@CH00970 DC    H'28'                                                    12021000
@CH00972 DC    H'29'                                                    12022000
@CH00974 DC    H'30'                                                    12023000
@CH00054 DC    H'31'                                                    12024000
@CH00230 DC    H'32'                                                    12025000
@CH00977 DC    H'33'                                                    12026000
@CH00979 DC    H'38'                                                    12027000
@CH01419 DC    H'66'                                                    12028000
@CH00914 DC    H'72'                                                    12029000
@CH00157 DC    H'100'                                                   12030000
@CH00790 DC    H'255'                                                   12031000
@SM01442 MVC   DATABLK(0,@15),DATABLK(@02)                              12032000
@SM01447 MVC   0(0,@01),SYNUNIT                                         12033000
@SC01449 CLC   RELATION(0),MAXCCSYM(@15)                                12034000
@SC01451 CLC   RELATION(0),LSTCCSYM(@15)                                12035000
@SM01453 MVC   SYNUNIT(0),0(@01)                                        12036000
@SC01455 CLC   RELATION(0),MAXCCSYM(@02)                                12037000
@SM01457 MVC   RELOPER(0),0(@01)                                        12038000
@SC01463 CLC   KWDITEM(0,KWDPTR),SYNUNIT                                12039000
@SM01466 MVC   CHARS(0,@03),SYNUNIT                                     12040000
@SM01468 MVC   STRING(0,@04),SYNUNIT                                    12041000
@SM01470 MVC   LCHAR(0,@03),SYNUNIT                                     12042000
@SM01472 MVC   LSTRING(0,@04),SYNUNIT                                   12043000
@SM01476 MVC   CNVRTFLD(0),SYNUNIT                                      12044000
@SM01478 MVC   0(0,@02),CNVRTFLD                                        12045000
@SM01480 MVC   STRING+1(0,@14),DATABLK(@03)                             12046000
@SM01482 MVC   LSTRING+1(0,@04),DATABLK(@15)                            12047000
@SM01486 MVC   LMEMNAME-14(0,@15),0(@14)                                12048000
@SM01488 MVC   MEMNAME(0,@05),0(@01)                                    12049000
@SM01493 MVC   LDSNAME-23(0,@15),SYNUNIT                                12050000
@SM01495 MVC   DSNAME(0,@04),SYNUNIT                                    12051000
@SM01497 MVC   DATABLK(0,NEWPTR),DATABLK(@14)                           12052000
@SM01500 MVC   SYNUNIT(0),DEFLTVAL+2(DEFLTPTR)                          12053000
@SM01502 MVC   SYNUNIT(0),DEFLTVAL(DEFLTPTR)                            12054000
@SM01504 MVC   ERRFIELD(0),KWDITEM(KWDPTR)                              12055000
@SM01506 MVC   ERRFIELD(0),SYNUNIT                                      12056000
         DS    0F                                                       12057000
@AL00384 EQU   *                       LIST WITH   1 ARGUMENT(S)        12058000
@AL00539 EQU   *                       LIST WITH   1 ARGUMENT(S)        12059000
@AL00541 EQU   *                       LIST WITH   1 ARGUMENT(S)        12060000
@AL00634 EQU   *                       LIST WITH   1 ARGUMENT(S)        12061000
@AL00650 EQU   *                       LIST WITH   1 ARGUMENT(S)        12062000
@AL00736 EQU   *                       LIST WITH   1 ARGUMENT(S)        12063000
@AL00804 EQU   *                       LIST WITH   1 ARGUMENT(S)        12064000
@AL00810 EQU   *                       LIST WITH   1 ARGUMENT(S)        12065000
@AL00851 EQU   *                       LIST WITH   1 ARGUMENT(S)        12066000
@AL00882 EQU   *                       LIST WITH   1 ARGUMENT(S)        12067000
@AL00940 EQU   *                       LIST WITH   1 ARGUMENT(S)        12068000
@AL00945 EQU   *                       LIST WITH   1 ARGUMENT(S)        12069000
@AL00971 EQU   *                       LIST WITH   1 ARGUMENT(S)        12070000
@AL01000 EQU   *                       LIST WITH   1 ARGUMENT(S)        12071000
@AL01572 DC    A(@CB00583)             LIST WITH   1 ARGUMENT(S)        12072000
@AL00477 EQU   *                       LIST WITH   1 ARGUMENT(S)        12073000
@AL00497 EQU   *                       LIST WITH   1 ARGUMENT(S)        12074000
@AL00632 EQU   *                       LIST WITH   1 ARGUMENT(S)        12075000
@AL00957 EQU   *                       LIST WITH   1 ARGUMENT(S)        12076000
@AL00985 EQU   *                       LIST WITH   1 ARGUMENT(S)        12077000
@AL01013 EQU   *                       LIST WITH   1 ARGUMENT(S)        12078000
@AL01076 EQU   *                       LIST WITH   1 ARGUMENT(S)        12079000
@AL01082 EQU   *                       LIST WITH   1 ARGUMENT(S)        12080000
@AL01093 EQU   *                       LIST WITH   1 ARGUMENT(S)        12081000
@AL01099 EQU   *                       LIST WITH   1 ARGUMENT(S)        12082000
@AL01548 EQU   *                       LIST WITH   1 ARGUMENT(S)        12083000
@AL01617 DC    A(@CB00581)             LIST WITH   1 ARGUMENT(S)        12084000
@AL00490 EQU   *                       LIST WITH   2 ARGUMENT(S)        12085000
@AL02006 DC    A(@CF00166)             LIST WITH   2 ARGUMENT(S)        12086000
         DC    A(@CF00228)                                              12087000
@AL00516 EQU   *                       LIST WITH   2 ARGUMENT(S)        12088000
@AL00540 EQU   *                       LIST WITH   1 ARGUMENT(S)        12089000
@AL00633 EQU   *                       LIST WITH   1 ARGUMENT(S)        12090000
@AL00649 EQU   *                       LIST WITH   1 ARGUMENT(S)        12091000
@AL00735 EQU   *                       LIST WITH   1 ARGUMENT(S)        12092000
@AL00803 EQU   *                       LIST WITH   1 ARGUMENT(S)        12093000
@AL00809 EQU   *                       LIST WITH   1 ARGUMENT(S)        12094000
@AL00850 DC    A(@CF00228)             LIST WITH   1 ARGUMENT(S)        12095000
@AL00638 EQU   *                       LIST WITH   2 ARGUMENT(S)        12096000
@AL01997 DC    A(@CF00786)             LIST WITH   2 ARGUMENT(S)        12097000
         DC    A(@CF00786)                                              12098000
@AL00942 DC    A(@CF00041)             LIST WITH   2 ARGUMENT(S)        12099000
         DC    A(@CF00786)                                              12100000
@AL00954 EQU   *                       LIST WITH   2 ARGUMENT(S)        12101000
@AL01010 DC    A(@CF00040)             LIST WITH   2 ARGUMENT(S)        12102000
         DC    A(@CF00786)                                              12103000
@AL00987 EQU   *                       LIST WITH   2 ARGUMENT(S)        12104000
@AL01956 DC    A(@CF00038)             LIST WITH   2 ARGUMENT(S)        12105000
         DC    A(@CF00786)                                              12106000
@AL01016 DC    A(@CF00807)             LIST WITH   2 ARGUMENT(S)        12107000
         DC    A(@CF00786)                                              12108000
@AL01055 DC    A(@CF00237)             LIST WITH   1 ARGUMENT(S)        12109000
@AL01075 DC    A(@CF00172)             LIST WITH   1 ARGUMENT(S)        12110000
@AL01085 EQU   *                       LIST WITH   2 ARGUMENT(S)        12111000
@AL01102 EQU   *                       LIST WITH   2 ARGUMENT(S)        12112000
@AL00457 EQU   *                       LIST WITH   1 ARGUMENT(S)        12113000
@AL01492 EQU   *                       LIST WITH   1 ARGUMENT(S)        12114000
@AL01522 EQU   *                       LIST WITH   1 ARGUMENT(S)        12115000
@AL01597 DC    A(@CF00811)             LIST WITH   1 ARGUMENT(S)        12116000
         DC    A(@CF00786)                                              12117000
@AL01123 EQU   *                       LIST WITH   2 ARGUMENT(S)        12118000
@AL01440 EQU   *                       LIST WITH   2 ARGUMENT(S)        12119000
@AL01092 DC    A(@CF00052)             LIST WITH   1 ARGUMENT(S)        12120000
         DC    A(@CF00786)                                              12121000
@AL01131 EQU   *                       LIST WITH   2 ARGUMENT(S)        12122000
@AL01146 EQU   *                       LIST WITH   2 ARGUMENT(S)        12123000
@AL01186 EQU   *                       LIST WITH   2 ARGUMENT(S)        12124000
@AL01211 EQU   *                       LIST WITH   2 ARGUMENT(S)        12125000
@AL01238 EQU   *                       LIST WITH   2 ARGUMENT(S)        12126000
@AL01275 EQU   *                       LIST WITH   2 ARGUMENT(S)        12127000
@AL01341 EQU   *                       LIST WITH   2 ARGUMENT(S)        12128000
@AL01903 EQU   *                       LIST WITH   2 ARGUMENT(S)        12129000
@AL01934 EQU   *                       LIST WITH   2 ARGUMENT(S)        12130000
@AL01980 EQU   *                       LIST WITH   2 ARGUMENT(S)        12131000
@AL00894 DC    A(@CF00163)             LIST WITH   1 ARGUMENT(S)        12132000
         DC    A(@CF00786)                                              12133000
@AL01170 DC    A(@CF00319)             LIST WITH   2 ARGUMENT(S)        12134000
         DC    A(@CF00786)                                              12135000
@AL01244 EQU   *                       LIST WITH   2 ARGUMENT(S)        12136000
@AL01292 EQU   *                       LIST WITH   2 ARGUMENT(S)        12137000
@AL01304 EQU   *                       LIST WITH   2 ARGUMENT(S)        12138000
@AL01316 EQU   *                       LIST WITH   2 ARGUMENT(S)        12139000
@AL01899 DC    A(@CF00813)             LIST WITH   2 ARGUMENT(S)        12140000
         DC    A(@CF00786)                                              12141000
@AL01333 EQU   *                       LIST WITH   2 ARGUMENT(S)        12142000
@AL01901 DC    A(@CF00815)             LIST WITH   2 ARGUMENT(S)        12143000
         DC    A(@CF00786)                                              12144000
@AL01576 DC    A(@CF01251)             LIST WITH   1 ARGUMENT(S)        12145000
@AL01631 DC    A(@CF00039)             LIST WITH   1 ARGUMENT(S)        12146000
@AL01875 DC    A(@CF00809)             LIST WITH   2 ARGUMENT(S)        12147000
         DC    A(@CF00786)                                              12148000
@DATD    DSECT                                                          12149000
         DS    0F                                                       12150000
@SA00001 DS    18F                                                      12151000
@PC00001 DS    6F                                                       12152000
@SA00002 DS    15F                                                      12153000
@SA00003 DS    13F                                                      12154000
@SA00004 DS    13F                                                      12155000
@SA00029 DS    15F                                                      12156000
@PC00029 DS    1F                                                       12157000
@SA00034 DS    15F                                                      12158000
@PC00034 DS    1F                                                       12159000
@SA00035 DS    15F                                                      12160000
@PC00035 DS    3F                                                       12161000
@SA00021 DS    14F                                                      12162000
@SA00023 DS    15F                                                      12163000
@SA00030 DS    15F                                                      12164000
@SA00025 DS    15F                                                      12165000
@SA00009 DS    14F                                                      12166000
@SA00010 DS    14F                                                      12167000
@SA00020 DS    14F                                                      12168000
@SA00028 DS    14F                                                      12169000
@PC00028 DS    1F                                                       12170000
@SA00006 DS    13F                                                      12171000
@SA00005 DS    13F                                                      12172000
@SA00008 DS    15F                                                      12173000
@SA00007 DS    14F                                                      12174000
@SA00027 DS    15F                                                      12175000
@SA00026 DS    15F                                                      12176000
@SA00011 DS    14F                                                      12177000
@SA00033 DS    13F                                                      12178000
@PC00033 DS    1F                                                       12179000
@SA00013 DS    13F                                                      12180000
@SA00012 DS    13F                                                      12181000
@SA00014 DS    13F                                                      12182000
@SA00018 DS    15F                                                      12183000
@SA00015 DS    15F                                                      12184000
@SA00016 DS    14F                                                      12185000
@SA00019 DS    15F                                                      12186000
@SA00017 DS    15F                                                      12187000
@SA00022 DS    14F                                                      12188000
@PC00022 DS    1F                                                       12189000
@SA00024 DS    15F                                                      12190000
@PC00024 DS    2F                                                       12191000
@SA00031 DS    15F                                                      12192000
@SA00032 DS    15F                                                      12193000
@AL00001 DS    5A                                                       12194000
@TF00001 DS    F                                                        12195000
@AFTEMPS DS    13F                                                      12196000
IDCRI01  CSECT                                                          12197000
         DS    0F                                                       12198000
@CF00125 DC    F'0'                                                     12199000
@CH00125 EQU   @CF00125+2                                               12200000
@CF00228 DC    F'1'                                                     12201000
@CH00228 EQU   @CF00228+2                                               12202000
@CF00163 DC    F'2'                                                     12203000
@CH00163 EQU   @CF00163+2                                               12204000
@CF00172 DC    F'3'                                                     12205000
@CH00172 EQU   @CF00172+2                                               12206000
@CF00052 DC    F'4'                                                     12207000
@CH00052 EQU   @CF00052+2                                               12208000
@CF00166 DC    F'6'                                                     12209000
@CH00166 EQU   @CF00166+2                                               12210000
@CF00042 DC    F'8'                                                     12211000
@CH00042 EQU   @CF00042+2                                               12212000
@CF00041 DC    F'9'                                                     12213000
@CF00040 DC    F'10'                                                    12214000
@CH00040 EQU   @CF00040+2                                               12215000
@CF00039 DC    F'11'                                                    12216000
@CF00038 DC    F'12'                                                    12217000
@CH00038 EQU   @CF00038+2                                               12218000
@CF00807 DC    F'13'                                                    12219000
@CF00809 DC    F'14'                                                    12220000
@CF00237 DC    F'15'                                                    12221000
@CF00811 DC    F'18'                                                    12222000
@CH00811 EQU   @CF00811+2                                               12223000
@CF01251 DC    F'19'                                                    12224000
@CF00786 DC    F'20'                                                    12225000
@CH00786 EQU   @CF00786+2                                               12226000
@CF00813 DC    F'21'                                                    12227000
@CH00813 EQU   @CF00813+2                                               12228000
@CF00815 DC    F'22'                                                    12229000
@CF00319 DC    F'24'                                                    12230000
@CF01303 DC    F'26'                                                    12231000
@CF01305 DC    F'27'                                                    12232000
@CF01420 DC    F'36'                                                    12233000
@CF00794 DC    F'48'                                                    12234000
@CF01474 DC    F'-64'                                                   12235000
@CF01475 DC    F'-63'                                                   12236000
@CF01490 DC    F'-55'                                                   12237000
@CF01484 DC    F'-53'                                                   12238000
@CF01485 DC    F'-52'                                                   12239000
@CF01491 DC    F'-44'                                                   12240000
@CF01492 DC    F'-43'                                                   12241000
@CF01440 DC    F'-12'                                                   12242000
@CF01499 DC    F'-8'                                                    12243000
@CF01441 DC    F'-4'                                                    12244000
@DATD    DSECT                                                          12245000
         DS    0D                                                       12246000
LISTSCAN DS    A                                                        12247000
IOCSPTR  DS    A                                                        12248000
DDSTRU   DS    A                                                        12249000
FSADDR   DS    A                                                        12250000
ERCNVADR DS    A                                                        12251000
DMPINDEX DS    A                                                        12252000
GRPPTR   DS    A                                                        12253000
DATAPTR  DS    A                                                        12254000
PTRLOC   DS    A                                                        12255000
AMTTOGET DS    F                                                        12256000
BLKLEFT  DS    F                                                        12257000
BLKPTR   DS    A                                                        12258000
WORKPTR2 DS    A                                                        12259000
WORKPTR3 DS    A                                                        12260000
SETUPERR DS    F                                                        12261000
ELTPTR   DS    A                                                        12262000
OLDPTR   DS    A                                                        12263000
FREEPTR  DS    A                                                        12264000
SUBOCCUR DS    F                                                        12265000
LISTPTR  DS    A                                                        12266000
TESTRC   DS    H                                                        12267000
PARMID   DS    H                                                        12268000
VECTRNUM DS    H                                                        12269000
SCLRCNT  DS    H                                                        12270000
PARMLVL  DS    H                                                        12271000
REPDEPTH DS    H                                                        12272000
SPACELFT DS    H                                                        12273000
SPACEAMT DS    H                                                        12274000
INDEX    DS    H                                                        12275000
INDEX2   DS    H                                                        12276000
INDEX3   DS    H                                                        12277000
LISTINDX DS    H                                                        12278000
HWORDARG DS    H                                                        12279000
CCVALUE  DS    H                                                        12280000
DIGITPOS DS    H                                                        12281000
SUBTOTAL DS    H                                                        12282000
DIGTINDX DS    H                                                        12283000
SEGLEN   DS    H                                                        12284000
DATALEN  DS    H                                                        12285000
SETRC    DS    H                                                        12286000
CNVRTVAL DS    FL1                                                      12287000
STARLOC  DS    FL1                                                      12288000
LISTLN   DS    FL1                                                      12289000
@TS00001 DS    CL95                                                     12290000
         DS    CL2                                                      12291000
COMMAREA DS    CL55                                                     12292000
         ORG   COMMAREA                                                 12293000
RECRDPTR DS    AL4                                                      12294000
FDTADDR  DS    AL4                                                      12295000
DESCPTR  DS    AL4                                                      12296000
WORKPTR  DS    AL4                                                      12297000
RISTATUS DS    FL2                                                      12298000
SCANINDX DS    FL2                                                      12299000
SCNLIMIT DS    FL2                                                      12300000
LASTCC   DS    FL2                                                      12301000
MAXCC    DS    FL2                                                      12302000
FSRLNAME DS    CL8                                                      12303000
POOLID   DS    CL4                                                      12304000
VERBNAME DS    CL8                                                      12305000
DESCNAME DS    CL8                                                      12306000
GOODCMD  DS    BL1                                                      12307000
EOFOK    EQU   COMMAREA+54                                              12308000
OPTSFLAG EQU   COMMAREA+54                                              12309000
SCANONLY EQU   COMMAREA+54                                              12310000
SKIPPAST EQU   COMMAREA+54                                              12311000
@NM00037 EQU   COMMAREA+54                                              12312000
         ORG   COMMAREA+55                                              12313000
         DS    CL1                                                      12314000
RIPOOLID DS    CL4                                                      12315000
         ORG   RIPOOLID                                                 12316000
VLISTID1 DS    CL2                                                      12317000
VLISTID  DS    FL2                                                      12318000
         ORG   RIPOOLID+4                                               12319000
ORGSIGN  DS    CL1                                                      12320000
         DS    CL3                                                      12321000
SYNUNIT  DS    CL255                                                    12322000
BLANKFLD DS    CL10                                                     12323000
ERRFIELD DS    CL20                                                     12324000
CHAR1    DS    CL1                                                      12325000
CHAR2    DS    CL1                                                      12326000
         DS    CL5                                                      12327000
CNVRTFLD DS    CL10                                                     12328000
SCANSWS  DS    CL2                                                      12329000
         ORG   SCANSWS                                                  12330000
PWORDSW  DS    BL1                                                      12331000
COMMENT  EQU   SCANSWS+0                                                12332000
INCOMM   EQU   SCANSWS+0                                                12333000
MORTOCOM EQU   SCANSWS+0                                                12334000
CONTNEXT EQU   SCANSWS+0                                                12335000
FIRSTCHR EQU   SCANSWS+0                                                12336000
FINALCHR EQU   SCANSWS+0                                                12337000
JUSTONE  EQU   SCANSWS+0                                                12338000
ENDPAREN DS    BL1                                                      12339000
NULLCMD  EQU   SCANSWS+1                                                12340000
FOUND    EQU   SCANSWS+1                                                12341000
SUBSYET  EQU   SCANSWS+1                                                12342000
DELIM    EQU   SCANSWS+1                                                12343000
         ORG   SCANSWS+2                                                12344000
OPENAREA DS    BL32                                                     12345000
PRNTAREA DS    BL20                                                     12346000
STMTEND  DS    BL1                                                      12347000
RELATION DS    CL32                                                     12348000
@NM00065 DS    CL1                                                      12349000
         ORG   @NM00065                                                 12350000
NONMODAL DS    BL1                                                      12351000
REDOLVL0 EQU   @NM00065+0                                               12352000
EXPREND  EQU   @NM00065+0                                               12353000
SINGLCMD EQU   @NM00065+0                                               12354000
IFNEXT   EQU   @NM00065+0                                               12355000
GETVERB  EQU   @NM00065+0                                               12356000
         ORG   @NM00065+1                                               12357000
RELOPER  DS    CL2                                                      12358000
KWDMATCH DS    BL1                                                      12359000
ENDVALUE DS    BL1                                                      12360000
CHSTRING DS    BL1                                                      12361000
MEMBIT   DS    BL1                                                      12362000
ONESTAR  DS    BL1                                                      12363000
WITHMEM  DS    BL1                                                      12364000
DFLTOK   DS    BL1                                                      12365000
FOUNDONE DS    BL1                                                      12366000
SKIPDONE DS    BL1                                                      12367000
COMMASW  DS    BL1                                                      12368000
ENDFOUND DS    BL1                                                      12369000
SKIPLEAD DS    BL1                                                      12370000
PRMFOUND DS    BL1                                                      12371000
         DS    CL1                                                      12372000
SUPERID  DS    10H                                                      12373000
PPARMCNT DS    10H                                                      12374000
REPCOUNT DS    3H                                                       12375000
REPLIMIT DS    3H                                                       12376000
ONEREP   DS    3BL1                                                     12377000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                12378000
@ENDDATD EQU   *                                                        12379000
IDCRI01  CSECT                                                          12380000
         DS    0F                                                       12381000
@SIZDATD DC    AL1(0)                                                   12382000
         DC    AL3(@ENDDATD-@DATD)                                      12383000
@CV00621 DC    V(IDCRI02)                                               12384000
@CV00622 DC    V(IDCRI03)                                               12385000
         DS    0D                                                       12386000
VECTRLEN DC    AL2(4*9-4)                                               12387000
@CC00782 DC    C'2147483647'                                            12388000
@CC00820 DC    C'RI01'                                                  12389000
@CC00901 DC    C'RIEX'                                                  12390000
@CC00930 DC    C'RISC'                                                  12391000
@CC00951 DC    C'RI02'                                                  12392000
@CC00957 DC    C'RI03'                                                  12393000
@CC00987 DC    C'RIGN'                                                  12394000
@CC00997 DC    C'RI04'                                                  12395000
@CC01000 DC    C'RI05'                                                  12396000
@CC01004 DC    C'RIMS'                                                  12397000
@CC01036 DC    C'RIMI'                                                  12398000
@CC01046 DC    C'RIME'                                                  12399000
@CC01050 DC    C'RIBT'                                                  12400000
@CC01060 DC    C'RI09'                                                  12401000
@CC01075 DC    C'RIPP'                                                  12402000
@CC01084 DC    C'RI11'                                                  12403000
@CC01087 DC    C'RI12'                                                  12404000
@CC01095 DC    C'RIGQ'                                                  12405000
@CC01181 DC    C'RICV'                                                  12406000
@CC01186 DC    C'RI24'                                                  12407000
@CC01192 DC    C'RI27'                                                  12408000
@CC01195 DC    C'RI30'                                                  12409000
@CC01221 DC    C'RIID'                                                  12410000
@CC01230 DC    C'RINS'                                                  12411000
@CC01244 DC    C'RIMC'                                                  12412000
@CC01253 DC    C'RIIR'                                                  12413000
@CC01254 DC    C'RI35'                                                  12414000
@CC01265 DC    C'RI36'                                                  12415000
@CC01269 DC    C'RIDF'                                                  12416000
@CC01291 DC    C'RIST'                                                  12417000
@CC01294 DC    C'RI44'                                                  12418000
@CC01298 DC    C'RI45'                                                  12419000
@CC01308 DC    C'RINN'                                                  12420000
@CC01335 DC    C'RISK'                                                  12421000
@CC01339 DC    C'RISF'                                                  12422000
@CC01344 DC    C'RIPC'                                                  12423000
@CC01353 DC    C'RI49'                                                  12424000
@CC01354 DC    C'RI50'                                                  12425000
@CC01357 DC    C'RI51'                                                  12426000
@CC01368 DC    C'RI56'                                                  12427000
@CC01371 DC    C'RI57'                                                  12428000
@CC01375 DC    C'RI59'                                                  12429000
@CC01379 DC    C'RIGR'                                                  12430000
@CC01386 DC    C'RISE'                                                  12431000
@CC01389 DC    C'RI60'                                                  12432000
@CC01392 DC    C'RI61'                                                  12433000
@CC01393 DC    C'RI62'                                                  12434000
@CC01400 DC    C'RIDC'                                                  12435000
@CC01401 DC    C'RI66'                                                  12436000
@CC01407 DC    C'RIE1'                                                  12437000
@CC01418 DC    C'RIE2'                                                  12438000
@CC01408 DC    C'UV0'                                                   12439000
@CC00902 EQU   @CC00820                                                 12440000
@CC00968 DC    C'EQ'                                                    12441000
@CC01019 DC    C'GT'                                                    12442000
@CC01023 DC    C'LT'                                                    12443000
@CC01025 DC    C'^='                                                    12444000
@CC01027 DC    C'NE'                                                    12445000
@CC01029 DC    C'>='                                                    12446000
@CC01031 DC    C'GE'                                                    12447000
@CC01033 DC    C'<='                                                    12448000
@CC01035 DC    C'LE'                                                    12449000
@CB00581 DC    B'10000000'                                              12450000
@CB00583 DC    B'00000000'                                              12451000
ALL      DC    CL3'ALL'                                                 12452000
FORMAT   DC    CL4'FORM'                                                12453000
HSECOND  DC    CL4'HSEC'                                                12454000
CLOCK    DC    CL4'KLOK'                                                12455000
SETZERO  DC    CL4'ZERO'                                                12456000
SETBLANK DC    CL4'BLNK'                                                12457000
NOSET    DC    CL4'NSET'                                                12458000
OVERRIDE DC    CL4'OVRD'                                                12459000
ACQUIRE  DC    CL8'ACQUIRE '                                            12460000
RELINQ   DC    CL8'RELINQ  '                                            12461000
MOUNT    DC    CL8'MOUNT   '                                            12462000
DEMOUNT  DC    CL8'DEMOUNT '                                            12463000
DEFINE   DC    CL8'DEFINE  '                                            12464000
MOVE     DC    CL8'MOVE    '                                            12465000
TRACEQ   DC    CL8'TRACEQ  '                                            12466000
COPYTABL DC    CL8'COPYTABL'                                            12467000
COPYCRTG DC    CL8'COPYCRTG'                                            12468000
COPYVOL  DC    CL8'COPYVOL '                                            12469000
VVIC     DC    CL8'VVIC    '                                            12470000
TUNE     DC    CL8'TUNE    '                                            12471000
NAMES    DC    CL4'NAME'                                                12472000
UNIT     DC    CL4'UNIT'                                                12473000
SHR      DC    CL4'SHR '                                                12474000
EXCL     DC    CL4'EXCL'                                                12475000
NOWAIT   DC    CL4'NWAI'                                                12476000
WAIT     DC    CL4'WAIT'                                                12477000
COMSTART DC    CL2'/*'                                                  12478000
COMEND   DC    CL2'*/'                                                  12479000
MODID    DC    CL4'RI01'                                                12480000
FIXAREA  DS    CL1024                                                   12481000
         ORG   FIXAREA                                                  12482000
@NM00057 DS    CL256                                                    12483000
         ORG   @NM00057                                                 12484000
@NM00058 DC    256X'00'                                                 12485000
         ORG   FIXAREA+256                                              12486000
@NM00059 DS    CL256                                                    12487000
         ORG   @NM00059                                                 12488000
@NM00060 DC    256X'00'                                                 12489000
         ORG   FIXAREA+512                                              12490000
@NM00061 DS    CL256                                                    12491000
         ORG   @NM00061                                                 12492000
@NM00062 DC    256X'00'                                                 12493000
         ORG   FIXAREA+768                                              12494000
@NM00063 DS    CL256                                                    12495000
         ORG   @NM00063                                                 12496000
@NM00064 DC    256X'00'                                                 12497000
         ORG   FIXAREA+1024                                             12498000
LTBLNAME DC    CL8'IDCRILT '                                            12499000
KTBLNAME DC    CL8'IDCRIKT '                                            12500000
TWLVZERO DS    CL1                                                      12501000
         ORG   TWLVZERO                                                 12502000
@NM00074 DC    XL1'C0'                                                  12503000
         ORG   TWLVZERO+1                                               12504000
HEXTABLE DC    CL1'0'                                                   12505000
         DC    CL1'1'                                                   12506000
         DC    CL1'2'                                                   12507000
         DC    CL1'3'                                                   12508000
         DC    CL1'4'                                                   12509000
         DC    CL1'5'                                                   12510000
         DC    CL1'6'                                                   12511000
         DC    CL1'7'                                                   12512000
         DC    CL1'8'                                                   12513000
         DC    CL1'9'                                                   12514000
         DC    CL1'A'                                                   12515000
         DC    CL1'B'                                                   12516000
         DC    CL1'C'                                                   12517000
         DC    CL1'D'                                                   12518000
         DC    CL1'E'                                                   12519000
         DC    CL1'F'                                                   12520000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       12521000
@01      EQU   01                                                       12522000
@02      EQU   02                                                       12523000
@03      EQU   03                                                       12524000
@04      EQU   04                                                       12525000
@05      EQU   05                                                       12526000
@06      EQU   06                                                       12527000
@07      EQU   07                                                       12528000
@08      EQU   08                                                       12529000
@09      EQU   09                                                       12530000
@10      EQU   10                                                       12531000
@11      EQU   11                                                       12532000
@12      EQU   12                                                       12533000
@13      EQU   13                                                       12534000
@14      EQU   14                                                       12535000
@15      EQU   15                                                       12536000
FACTOR   EQU   @05                                                      12537000
PARENCNT EQU   @02                                                      12538000
WORKVAR3 EQU   @02                                                      12539000
DEFLTPTR EQU   @04                                                      12540000
WORKVAR2 EQU   @02                                                      12541000
AMTUSED  EQU   @04                                                      12542000
MOVELEN  EQU   @02                                                      12543000
NEWPTR   EQU   @05                                                      12544000
SEGEND   EQU   @04                                                      12545000
SEGSTART EQU   @02                                                      12546000
TWOPOWER EQU   @02                                                      12547000
WORKVAL  EQU   @04                                                      12548000
WORKVAR1 EQU   @04                                                      12549000
PART1LEN EQU   @04                                                      12550000
RELSIZE  EQU   @02                                                      12551000
GDTPTR   EQU   @03                                                      12552000
PWORD    EQU   @02                                                      12553000
UNITINDX EQU   @05                                                      12554000
REPNEST  EQU   @02                                                      12555000
ARRYDSPL EQU   @04                                                      12556000
ARRYPTR  EQU   @02                                                      12557000
TESTID   EQU   @04                                                      12558000
KWDPTR   EQU   @02                                                      12559000
OPNPTR   EQU   @02                                                      12560000
RTNREG   EQU   @15                                                      12561000
CVBNUM   EQU   @08                                                      12562000
REG0     EQU   @00                                                      12563000
REG1     EQU   @01                                                      12564000
REG10    EQU   @10                                                      12565000
REG11    EQU   @11                                                      12566000
REG12    EQU   @12                                                      12567000
REG13    EQU   @13                                                      12568000
REG14    EQU   @14                                                      12569000
REG15    EQU   @15                                                      12570000
REG2     EQU   @02                                                      12571000
REG3     EQU   @03                                                      12572000
REG4     EQU   @04                                                      12573000
REG5     EQU   @05                                                      12574000
REG6     EQU   @06                                                      12575000
REG7     EQU   @07                                                      12576000
REG8     EQU   @08                                                      12577000
REG9     EQU   @09                                                      12578000
GDTTBL   EQU   0                                                        12579000
GDTPRM   EQU   GDTTBL+4                                                 12580000
GDTTR1   EQU   GDTTBL+8                                                 12581000
GDTTR2   EQU   GDTTBL+12                                                12582000
GDTRIH   EQU   GDTTBL+24                                                12583000
GDTDBG   EQU   GDTTBL+40                                                12584000
GDTSTC   EQU   GDTTBL+44                                                12585000
GDTPRT   EQU   GDTTBL+48                                                12586000
GDTESS   EQU   GDTTBL+52                                                12587000
GDTESA   EQU   GDTTBL+56                                                12588000
GDTRST   EQU   GDTTBL+60                                                12589000
GDTRES   EQU   GDTTBL+64                                                12590000
GDTCAL   EQU   GDTTBL+68                                                12591000
GDTGSP   EQU   GDTTBL+72                                                12592000
GDTFSP   EQU   GDTTBL+76                                                12593000
GDTGPL   EQU   GDTTBL+80                                                12594000
GDTFPL   EQU   GDTTBL+84                                                12595000
GDTLOD   EQU   GDTTBL+88                                                12596000
GDTDEL   EQU   GDTTBL+92                                                12597000
GDTPRL   EQU   GDTTBL+96                                                12598000
GDTEPL   EQU   GDTTBL+100                                               12599000
GDTTIM   EQU   GDTTBL+104                                               12600000
GDTIIO   EQU   GDTTBL+108                                               12601000
GDTTIO   EQU   GDTTBL+112                                               12602000
GDTOPN   EQU   GDTTBL+124                                               12603000
GDTCLS   EQU   GDTTBL+128                                               12604000
GDTGET   EQU   GDTTBL+132                                               12605000
GDTPUT   EQU   GDTTBL+136                                               12606000
GDTPOS   EQU   GDTTBL+140                                               12607000
GDTCPY   EQU   GDTTBL+144                                               12608000
GDTCAT   EQU   GDTTBL+148                                               12609000
GDTSNP   EQU   GDTTBL+164                                               12610000
GDTVFY   EQU   GDTTBL+172                                               12611000
GDTUID   EQU   GDTTBL+192                                               12612000
GDTPMT   EQU   GDTTBL+196                                               12613000
GDTCIR   EQU   GDTTBL+200                                               12614000
GDTLNK   EQU   GDTTBL+204                                               12615000
GDTALC   EQU   GDTTBL+208                                               12616000
GDTDLC   EQU   GDTTBL+212                                               12617000
GDTQAL   EQU   GDTTBL+216                                               12618000
GDTSTW   EQU   GDTTBL+220                                               12619000
GDTSSC   EQU   GDTTBL+224                                               12620000
GDTENQ   EQU   GDTTBL+228                                               12621000
GDTRSV   EQU   GDTTBL+232                                               12622000
GDTDEQ   EQU   GDTTBL+236                                               12623000
GDTSFO   EQU   GDTTBL+240                                               12624000
GDTWTO   EQU   GDTTBL+244                                               12625000
GDTSCR   EQU   GDTTBL+248                                               12626000
GDTUNT   EQU   GDTTBL+252                                               12627000
GDTRCT   EQU   GDTTBL+256                                               12628000
GDTIFO   EQU   GDTTBL+260                                               12629000
GDTEXP   EQU   GDTTBL+264                                               12630000
GDTSTA   EQU   GDTTBL+268                                               12631000
GDTERR   EQU   GDTTBL+272                                               12632000
GDTUNC   EQU   GDTTBL+276                                               12633000
GDTLOC   EQU   GDTTBL+280                                               12634000
IDCSALD0 EQU   0                                                        12635000
IDCSAEP0 EQU   0                                                        12636000
IDCSAGS0 EQU   0                                                        12637000
IDCSAFS0 EQU   0                                                        12638000
IDCSAGP0 EQU   0                                                        12639000
IDCSAFP0 EQU   0                                                        12640000
TRACE1   EQU   0                                                        12641000
OLDERID1 EQU   TRACE1                                                   12642000
TRACE2   EQU   0                                                        12643000
OLDERID2 EQU   TRACE2                                                   12644000
NEWID2   EQU   TRACE2+95                                                12645000
NEWERID2 EQU   5                                                        12646000
CIRAGL   EQU   0                                                        12647000
CIRTYPE  EQU   CIRAGL                                                   12648000
ALLAGL   EQU   0                                                        12649000
ALLSTS   EQU   ALLAGL+24                                                12650000
ALLDSP   EQU   ALLAGL+25                                                12651000
ALLORG   EQU   ALLAGL+26                                                12652000
ALLOPT   EQU   ALLAGL+28                                                12653000
UNITABL  EQU   0                                                        12654000
UNITADR  EQU   UNITABL+4                                                12655000
@NM00010 EQU   UNITADR                                                  12656000
UNITSTAT EQU   UNITABL+6                                                12657000
IDCIOOP0 EQU   0                                                        12658000
IDCIOGT0 EQU   0                                                        12659000
IOCSTR   EQU   0                                                        12660000
IOCDAD   EQU   IOCSTR                                                   12661000
IOCDLN   EQU   IOCSTR+4                                                 12662000
IOCDSO   EQU   IOCSTR+16                                                12663000
IOCRFM   EQU   IOCSTR+17                                                12664000
IOCMAC   EQU   IOCSTR+18                                                12665000
IOCMAC2  EQU   IOCSTR+19                                                12666000
IOCCHP   EQU   IOCSTR+20                                                12667000
IOCMSG   EQU   IOCSTR+21                                                12668000
IOCRBA   EQU   IOCSTR+40                                                12669000
IOCTTR   EQU   IOCRBA                                                   12670000
IOCMEM   EQU   IOCSTR+44                                                12671000
IOCNWM   EQU   IOCSTR+48                                                12672000
OPNAGL   EQU   0                                                        12673000
OPNOPT   EQU   OPNAGL                                                   12674000
OPNRFM   EQU   OPNAGL+1                                                 12675000
OPNTYP   EQU   OPNAGL+2                                                 12676000
OPNTYPSI EQU   OPNTYP                                                   12677000
OPNMOD   EQU   OPNAGL+3                                                 12678000
OPNIOC   EQU   OPNAGL+4                                                 12679000
OPNDEV   EQU   OPNAGL+24                                                12680000
OPNDSO   EQU   OPNAGL+41                                                12681000
OPNOPT2  EQU   OPNAGL+42                                                12682000
IOINFOPT EQU   0                                                        12683000
UVOLLIST EQU   0                                                        12684000
UVOLENT  EQU   UVOLLIST+2                                               12685000
AMSTP011 EQU   0                                                        12686000
DARGLIST EQU   0                                                        12687000
DARGDBP  EQU   DARGLIST                                                 12688000
DARGSTID EQU   DARGLIST+8                                               12689000
DARGSMOD EQU   DARGSTID                                                 12690000
DARGSENT EQU   DARGSTID+3                                               12691000
DARGILP  EQU   DARGLIST+12                                              12692000
DARGARY  EQU   DARGLIST+20                                              12693000
DARGINS  EQU   DARGARY                                                  12694000
DARGINL  EQU   DARGARY+2                                                12695000
FMTLIST  EQU   0                                                        12696000
FMTFLGS  EQU   FMTLIST                                                  12697000
FMTSPF   EQU   FMTLIST+2                                                12698000
FMTRFNO  EQU   FMTSPF                                                   12699000
FMTILEN  EQU   FMTRFNO                                                  12700000
FMTIOFF  EQU   FMTLIST+4                                                12701000
FMTTRBC  EQU   FMTIOFF                                                  12702000
FMTSTO   EQU   FMTTRBC                                                  12703000
FMTOCOL  EQU   FMTLIST+6                                                12704000
FMTCNVF  EQU   FMTLIST+10                                               12705000
ERCNVTAB EQU   0                                                        12706000
ERTYPE   EQU   ERCNVTAB                                                 12707000
EROPER   EQU   ERCNVTAB+1                                               12708000
EROSOPER EQU   ERCNVTAB+2                                               12709000
IDCDB010 EQU   0                                                        12710000
DMPITM   EQU   0                                                        12711000
DMPARY   EQU   0                                                        12712000
HDAREA   EQU   0                                                        12713000
LEFTMGN  EQU   HDAREA                                                   12714000
RIGHTMGN EQU   HDAREA+2                                                 12715000
LOADTPTR EQU   HDAREA+4                                                 12716000
KWTBLPTR EQU   HDAREA+8                                                 12717000
ADDRIOCS EQU   HDAREA+12                                                12718000
NESTLVL  EQU   HDAREA+16                                                12719000
MODLFLGS EQU   HDAREA+18                                                12720000
NULLDO   EQU   MODLFLGS                                                 12721000
DOFLAG   EQU   MODLFLGS+1                                               12722000
THENFLAG EQU   MODLFLGS+1                                               12723000
ELSEFLAG EQU   MODLFLGS+1                                               12724000
SKIPFLAG EQU   MODLFLGS+1                                               12725000
VERBDATA EQU   0                                                        12726000
MAXID    EQU   VERBDATA+10                                              12727000
POSDSPL  EQU   VERBDATA+20                                              12728000
DGRPDSPL EQU   VERBDATA+21                                              12729000
VNGRPDSP EQU   VERBDATA+22                                              12730000
NTGRPDSP EQU   VERBDATA+23                                              12731000
@NM00039 EQU   0                                                        12732000
VPOSCNT  EQU   @NM00039                                                 12733000
VPOSID   EQU   @NM00039+2                                               12734000
DGRPTOT  EQU   0                                                        12735000
@NM00040 EQU   0                                                        12736000
DGRPCNT  EQU   @NM00040                                                 12737000
DGRPID   EQU   @NM00040+2                                               12738000
VNGRPTOT EQU   0                                                        12739000
@NM00041 EQU   0                                                        12740000
VNGRPCNT EQU   @NM00041                                                 12741000
VNGRPID  EQU   @NM00041+2                                               12742000
@NM00042 EQU   0                                                        12743000
NTGRPCNT EQU   @NM00042                                                 12744000
NTGRPID  EQU   @NM00042+2                                               12745000
PARMDATA EQU   0                                                        12746000
OCCURNUM EQU   PARMDATA+1                                               12747000
IDDSPL   EQU   PARMDATA+4                                               12748000
KWDDSPL  EQU   PARMDATA+5                                               12749000
NOTDSPL  EQU   PARMDATA+6                                               12750000
NGRPDSPL EQU   PARMDATA+7                                               12751000
PDEDSPL  EQU   PARMDATA+8                                               12752000
SCLRDATA EQU   PARMDATA+11                                              12753000
LEVEL1   EQU   PARMDATA+11                                              12754000
REPEATED EQU   PARMDATA+11                                              12755000
SCALAR   EQU   PARMDATA+11                                              12756000
LIST     EQU   PARMDATA+11                                              12757000
DEFAULT  EQU   PARMDATA+11                                              12758000
SUBLIST  EQU   PARMDATA+11                                              12759000
DSCRPTR1 EQU   0                                                        12760000
SUBDSPL  EQU   DSCRPTR1+2                                               12761000
REPMAX   EQU   DSCRPTR1+3                                               12762000
DSCRPTR2 EQU   0                                                        12763000
HIVALUE  EQU   DSCRPTR2                                                 12764000
LOWVALUE EQU   DSCRPTR2+4                                               12765000
MAXLNGTH EQU   DSCRPTR2+8                                               12766000
LISTMAX  EQU   DSCRPTR2+9                                               12767000
NUMBER   EQU   DSCRPTR2+11                                              12768000
ANYSTRNG EQU   DSCRPTR2+11                                              12769000
DSNAM    EQU   DSCRPTR2+11                                              12770000
GENERIC  EQU   DSCRPTR2+11                                              12771000
VOLID    EQU   DSCRPTR2+11                                              12772000
PWORDOPT EQU   DSCRPTR2+11                                              12773000
DEFLT    EQU   0                                                        12774000
DEFLTLEN EQU   DEFLT                                                    12775000
DEFLTVAL EQU   DEFLT+1                                                  12776000
@NM00047 EQU   0                                                        12777000
@NM00048 EQU   @NM00047+2                                               12778000
KWDCOUNT EQU   0                                                        12779000
@NM00049 EQU   0                                                        12780000
KWDLEN   EQU   @NM00049                                                 12781000
KWDITEM  EQU   @NM00049+1                                               12782000
@NM00050 EQU   0                                                        12783000
SUBCOUNT EQU   @NM00050                                                 12784000
@NM00051 EQU   @NM00050+2                                               12785000
PARMTYPE EQU   @NM00051                                                 12786000
SUBID    EQU   @NM00051+2                                               12787000
NGRPTOT  EQU   0                                                        12788000
@NM00052 EQU   0                                                        12789000
NGRPCNT  EQU   @NM00052                                                 12790000
NGRPID   EQU   @NM00052+2                                               12791000
@NM00053 EQU   0                                                        12792000
NOTCOUNT EQU   @NM00053                                                 12793000
NOTID    EQU   @NM00053+2                                               12794000
@NM00054 EQU   0                                                        12795000
@NM00055 EQU   @NM00054+2                                               12796000
FDTTBL   EQU   0                                                        12797000
FDTPTR   EQU   FDTTBL+8                                                 12798000
PARMINFO EQU   0                                                        12799000
PARMPTR  EQU   PARMINFO                                                 12800000
NTGRPPTR EQU   PARMINFO+4                                               12801000
SUPRPARM EQU   PARMINFO+8                                               12802000
PARMFLAG EQU   PARMINFO+10                                              12803000
LISTADDR EQU   0                                                        12804000
REPTOTAL EQU   0                                                        12805000
REPPTR   EQU   0                                                        12806000
VECTRPTR EQU   0                                                        12807000
KWDTABLE EQU   0                                                        12808000
PARMSYM  EQU   KWDTABLE+1                                               12809000
SETSYM   EQU   KWDTABLE+11                                              12810000
IFSYM    EQU   KWDTABLE+21                                              12811000
THENSYM  EQU   KWDTABLE+31                                              12812000
ELSESYM  EQU   KWDTABLE+41                                              12813000
DOSYM    EQU   KWDTABLE+51                                              12814000
ENDSYM   EQU   KWDTABLE+61                                              12815000
LSTCCLN  EQU   KWDTABLE+70                                              12816000
LSTCCSYM EQU   KWDTABLE+71                                              12817000
MAXCCLN  EQU   KWDTABLE+80                                              12818000
MAXCCSYM EQU   KWDTABLE+81                                              12819000
DATABLK  EQU   0                                                        12820000
INREC    EQU   0                                                        12821000
OPTSPTR  EQU   0                                                        12822000
PARMOPTS EQU   0                                                        12823000
OPTSLEN  EQU   PARMOPTS                                                 12824000
FULLWORD EQU   0                                                        12825000
@NM00066 EQU   0                                                        12826000
STRINGLN EQU   @NM00066                                                 12827000
STRING   EQU   @NM00066+1                                               12828000
@NM00067 EQU   0                                                        12829000
PASSWDLN EQU   @NM00067                                                 12830000
PASSWORD EQU   @NM00067+1                                               12831000
CHARLN   EQU   @NM00067+9                                               12832000
CHARS    EQU   @NM00067+10                                              12833000
@NM00068 EQU   0                                                        12834000
DSPWDLN  EQU   @NM00068                                                 12835000
DSPWORD  EQU   @NM00068+1                                               12836000
STARPOS  EQU   @NM00068+9                                               12837000
MEMNAMLN EQU   @NM00068+11                                              12838000
MEMNAME  EQU   @NM00068+12                                              12839000
DSNAMELN EQU   @NM00068+20                                              12840000
DSNAME   EQU   @NM00068+21                                              12841000
@NM00069 EQU   0                                                        12842000
FULLWDCT EQU   @NM00069                                                 12843000
LFULLWD  EQU   @NM00069+4                                               12844000
@NM00070 EQU   0                                                        12845000
STRINGCT EQU   @NM00070                                                 12846000
LSTRINGL EQU   @NM00070+2                                               12847000
LSTRING  EQU   @NM00070+3                                               12848000
@NM00071 EQU   0                                                        12849000
CHARCT   EQU   @NM00071                                                 12850000
LCHRPWDL EQU   @NM00071+2                                               12851000
LCHRPWD  EQU   @NM00071+3                                               12852000
LCHARLN  EQU   @NM00071+11                                              12853000
LCHAR    EQU   @NM00071+12                                              12854000
@NM00072 EQU   0                                                        12855000
DSNAMECT EQU   @NM00072                                                 12856000
@NM00073 EQU   @NM00072+2                                               12857000
LDSNPWDL EQU   @NM00073                                                 12858000
LDSNPWD  EQU   @NM00073+1                                               12859000
LSTARPOS EQU   @NM00073+9                                               12860000
LMEMNAML EQU   @NM00073+11                                              12861000
LMEMNAME EQU   @NM00073+12                                              12862000
LDSNAMEL EQU   @NM00073+20                                              12863000
LDSNAME  EQU   @NM00073+21                                              12864000
AMSTP041 EQU   0                                                        12865000
AMSTP042 EQU   0                                                        12866000
AMSTP043 EQU   0                                                        12867000
AMSTP044 EQU   0                                                        12868000
DMPTRM   EQU   0                                                        12869000
IDCIOCL0 EQU   0                                                        12870000
IDCIOCO0 EQU   0                                                        12871000
IDCIOIT0 EQU   0                                                        12872000
IDCIOPO0 EQU   0                                                        12873000
IDCIOPT0 EQU   0                                                        12874000
IDCIOSI0 EQU   0                                                        12875000
IDCIOST0 EQU   0                                                        12876000
IDCIOTM0 EQU   0                                                        12877000
IDCIOVY0 EQU   0                                                        12878000
IDCIO050 EQU   0                                                        12879000
IDCSAAL0 EQU   0                                                        12880000
IDCSACA0 EQU   0                                                        12881000
IDCSACL0 EQU   0                                                        12882000
IDCSACR0 EQU   0                                                        12883000
IDCSADE0 EQU   0                                                        12884000
IDCSADL0 EQU   0                                                        12885000
IDCSADQ0 EQU   0                                                        12886000
IDCSAID0 EQU   0                                                        12887000
IDCSALC0 EQU   0                                                        12888000
IDCSALK0 EQU   0                                                        12889000
IDCSANQ0 EQU   0                                                        12890000
IDCSAPR0 EQU   0                                                        12891000
IDCSAPT0 EQU   0                                                        12892000
IDCSAQL0 EQU   0                                                        12893000
IDCSARC0 EQU   0                                                        12894000
IDCSARV0 EQU   0                                                        12895000
IDCSASC0 EQU   0                                                        12896000
IDCSASI0 EQU   0                                                        12897000
IDCSASN0 EQU   0                                                        12898000
IDCSASS0 EQU   0                                                        12899000
IDCSAST0 EQU   0                                                        12900000
IDCSATI0 EQU   0                                                        12901000
IDCSAUC0 EQU   0                                                        12902000
IDCSAWO0 EQU   0                                                        12903000
IDCSA060 EQU   0                                                        12904000
IDCST010 EQU   0                                                        12905000
IDCTPER0 EQU   0                                                        12906000
LISTTEST EQU   0                                                        12907000
NEWERID1 EQU   5                                                        12908000
NTGRPTOT EQU   0                                                        12909000
GDTTBLX  EQU   0                                                        12910000
FDTLOC   EQU   0                                                        12911000
SPACEID  EQU   0                                                        12912000
AMSMAX   EQU   0                                                        12913000
AMSLAST  EQU   0                                                        12914000
FUNCNAME EQU   0                                                        12915000
DFLTPARM EQU   0                                                        12916000
ERRMSGID EQU   0                                                        12917000
ERRPRMID EQU   0                                                        12918000
FLDTYPE  EQU   0                                                        12919000
WITHCOM  EQU   0                                                        12920000
DEPTH    EQU   0                                                        12921000
ERRCODE1 EQU   0                                                        12922000
ERRCODE2 EQU   0                                                        12923000
INSRTLEN EQU   0                                                        12924000
INSRTPTR EQU   0                                                        12925000
RISTID   EQU   MODID                                                    12926000
DIGITVAL EQU   SYNUNIT                                                  12927000
CNVRTWRD EQU   SYNUNIT                                                  12928000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    12929000
LUNQTFLG EQU   @NM00073+10                                              12930000
UNQTFLG  EQU   @NM00068+10                                              12931000
ENDSMLN  EQU   KWDTABLE+60                                              12932000
DOSMLN   EQU   KWDTABLE+50                                              12933000
ELSESMLN EQU   KWDTABLE+40                                              12934000
THENSMLN EQU   KWDTABLE+30                                              12935000
IFSMLN   EQU   KWDTABLE+20                                              12936000
SETSMLN  EQU   KWDTABLE+10                                              12937000
PARMSMLN EQU   KWDTABLE                                                 12938000
@NM00056 EQU   PARMINFO+11                                              12939000
FDTVERB  EQU   FDTTBL                                                   12940000
PDEOFST2 EQU   @NM00055+4                                               12941000
PDEPCLID EQU   @NM00055+2                                               12942000
PDEPRMID EQU   @NM00055                                                 12943000
PDECNT   EQU   @NM00054                                                 12944000
PDEOFST1 EQU   @NM00048+2                                               12945000
IDNUM    EQU   @NM00048                                                 12946000
IDCOUNT  EQU   @NM00047                                                 12947000
@NM00046 EQU   DSCRPTR2+11                                              12948000
USERID   EQU   DSCRPTR2+11                                              12949000
@NM00045 EQU   DSCRPTR2+10                                              12950000
PCLDSPL2 EQU   DSCRPTR1                                                 12951000
@NM00044 EQU   PARMDATA+11                                              12952000
@NM00043 EQU   PARMDATA+10                                              12953000
KWDGRPID EQU   PARMDATA+9                                               12954000
PDEFLEN  EQU   PARMDATA                                                 12955000
LOADNAME EQU   VERBDATA+12                                              12956000
PARMCNT  EQU   VERBDATA+8                                               12957000
VDATALEN EQU   VERBDATA+6                                               12958000
PCLDSPL1 EQU   VERBDATA+4                                               12959000
DESCID   EQU   VERBDATA                                                 12960000
@NM00038 EQU   MODLFLGS+1                                               12961000
@NM00036 EQU   DMPARY+15                                                12962000
DMPARYTP EQU   DMPARY+14                                                12963000
DMPARYEX EQU   DMPARY+12                                                12964000
DMPARYIC EQU   DMPARY+10                                                12965000
DMPARYSZ EQU   DMPARY+8                                                 12966000
DMPARYNM EQU   DMPARY                                                   12967000
@NM00035 EQU   DMPITM+15                                                12968000
DMPITMTP EQU   DMPITM+14                                                12969000
DMPITMLN EQU   DMPITM+12                                                12970000
DMPITMPT EQU   DMPITM+8                                                 12971000
DMPITMNM EQU   DMPITM                                                   12972000
@NM00034 EQU   ERCNVTAB+24                                              12973000
ERCPLPT  EQU   ERCNVTAB+20                                              12974000
ERCATRC  EQU   ERCNVTAB+16                                              12975000
ERDSNM   EQU   ERCNVTAB+12                                              12976000
@NM00033 EQU   ERCNVTAB+4                                               12977000
@NM00032 EQU   ERCNVTAB+3                                               12978000
@NM00031 EQU   EROSOPER                                                 12979000
EROSUCDX EQU   EROSOPER                                                 12980000
EROSCATL EQU   EROSOPER                                                 12981000
@NM00030 EQU   EROPER                                                   12982000
ERCATAL  EQU   EROPER                                                   12983000
ERCATDL  EQU   EROPER                                                   12984000
ERCATDE  EQU   EROPER                                                   12985000
ERCATLC  EQU   EROPER                                                   12986000
@NM00029 EQU   ERTYPE                                                   12987000
EROSCAT  EQU   ERTYPE                                                   12988000
ERCATLG  EQU   ERTYPE                                                   12989000
@NM00028 EQU   FMTCNVF+1                                                12990000
FMTAR    EQU   FMTCNVF+1                                                12991000
FMTBS    EQU   FMTCNVF+1                                                12992000
FMTSS    EQU   FMTCNVF+1                                                12993000
FMTAL    EQU   FMTCNVF+1                                                12994000
FMTZS    EQU   FMTCNVF+1                                                12995000
@NM00027 EQU   FMTCNVF                                                  12996000
FMTPU    EQU   FMTCNVF                                                  12997000
FMTBD    EQU   FMTCNVF                                                  12998000
FMTBHD   EQU   FMTCNVF                                                  12999000
FMTBHA   EQU   FMTCNVF                                                  13000000
FMTBH    EQU   FMTCNVF                                                  13001000
FMTOLEN  EQU   FMTLIST+8                                                13002000
FMTRIO   EQU   FMTOCOL                                                  13003000
FMTSPT   EQU   FMTSTO                                                   13004000
FMTSTL   EQU   FMTILEN                                                  13005000
@NM00026 EQU   FMTFLGS+1                                                13006000
FMTHDF   EQU   FMTFLGS                                                  13007000
FMTDFF   EQU   FMTFLGS                                                  13008000
FMTSTF   EQU   FMTFLGS                                                  13009000
FMTREPF  EQU   FMTFLGS                                                  13010000
FMTBDF   EQU   FMTFLGS                                                  13011000
FMTIDF   EQU   FMTFLGS                                                  13012000
FMTSCF   EQU   FMTFLGS                                                  13013000
FMTEOLF  EQU   FMTFLGS                                                  13014000
DARGDTM  EQU   DARGARY+4                                                13015000
DARGPCT  EQU   DARGINL                                                  13016000
DARGREP  EQU   DARGINS                                                  13017000
@NM00025 EQU   DARGLIST+19                                              13018000
DARGIND  EQU   DARGLIST+18                                              13019000
DARGRETL EQU   DARGLIST+16                                              13020000
DARGCNT  EQU   DARGLIST+14                                              13021000
DARGRETP EQU   DARGLIST+4                                               13022000
UVOLVOL  EQU   UVOLENT+4                                                13023000
UVOLDEV  EQU   UVOLENT                                                  13024000
UVOLCNT  EQU   UVOLLIST                                                 13025000
@NM00024 EQU   IOINFOPT                                                 13026000
IOINFTMS EQU   IOINFOPT                                                 13027000
IOINFSUP EQU   IOINFOPT                                                 13028000
IOINFDSN EQU   IOINFOPT                                                 13029000
IOINFVOL EQU   IOINFOPT                                                 13030000
IOINFDVT EQU   IOINFOPT                                                 13031000
OPNVOL   EQU   OPNAGL+44                                                13032000
@NM00023 EQU   OPNAGL+43                                                13033000
@NM00022 EQU   OPNOPT2                                                  13034000
OPNOPTJM EQU   OPNOPT2                                                  13035000
OPNOPTNM EQU   OPNOPT2                                                  13036000
OPNOPTAS EQU   OPNOPT2                                                  13037000
@NM00021 EQU   OPNDSO                                                   13038000
OPNDSOPO EQU   OPNDSO                                                   13039000
OPNDSOIS EQU   OPNDSO                                                   13040000
OPNDSOPS EQU   OPNDSO                                                   13041000
OPNDSOAM EQU   OPNDSO                                                   13042000
OPNKYL   EQU   OPNAGL+40                                                13043000
OPNBLK   EQU   OPNAGL+36                                                13044000
OPNREC   EQU   OPNAGL+32                                                13045000
OPNDEVIX EQU   OPNDEV+4                                                 13046000
OPNDEVDT EQU   OPNDEV                                                   13047000
OPNCBP   EQU   OPNAGL+20                                                13048000
OPNDSN   EQU   OPNAGL+16                                                13049000
OPNPWA   EQU   OPNAGL+12                                                13050000
OPNDDN   EQU   OPNAGL+8                                                 13051000
OPNMODRP EQU   OPNMOD                                                   13052000
OPNMODUB EQU   OPNMOD                                                   13053000
OPNMODRS EQU   OPNMOD                                                   13054000
OPNMODAX EQU   OPNMOD                                                   13055000
OPNMODRR EQU   OPNMOD                                                   13056000
OPNMODRC EQU   OPNMOD                                                   13057000
OPNMODAC EQU   OPNMOD                                                   13058000
OPNMODPD EQU   OPNMOD                                                   13059000
@NM00020 EQU   OPNTYP                                                   13060000
OPNTYPRV EQU   OPNTYP                                                   13061000
OPNTYPEX EQU   OPNTYP                                                   13062000
OPNTYPRA EQU   OPNTYP                                                   13063000
OPNTYPXM EQU   OPNTYP                                                   13064000
OPNTYPCI EQU   OPNTYP                                                   13065000
OPNTYPSO EQU   OPNTYP                                                   13066000
@NM00019 EQU   OPNRFM                                                   13067000
OPNRFMBK EQU   OPNRFM                                                   13068000
OPNRFMSF EQU   OPNRFM                                                   13069000
OPNRFMUN EQU   OPNRFM                                                   13070000
OPNRFMVR EQU   OPNRFM                                                   13071000
OPNRFMFX EQU   OPNRFM                                                   13072000
OPNOPTSK EQU   OPNOPT                                                   13073000
OPNOPTDR EQU   OPNOPT                                                   13074000
OPNOPTCR EQU   OPNOPT                                                   13075000
OPNOPTKS EQU   OPNOPT                                                   13076000
OPNOPTBK EQU   OPNOPT                                                   13077000
OPNOPTUP EQU   OPNOPT                                                   13078000
OPNOPTOT EQU   OPNOPT                                                   13079000
OPNOPTIN EQU   OPNOPT                                                   13080000
IOCEXT   EQU   IOCSTR+64                                                13081000
IOCREL   EQU   IOCSTR+60                                                13082000
IOCWORK  EQU   IOCSTR+56                                                13083000
IOCRRN   EQU   IOCSTR+52                                                13084000
IOCPNM   EQU   IOCNWM+2                                                 13085000
IOCPTL   EQU   IOCNWM                                                   13086000
IOCKYA   EQU   IOCMEM                                                   13087000
IOCVRC   EQU   IOCTTR                                                   13088000
IOCCBP   EQU   IOCSTR+36                                                13089000
IOCDSN   EQU   IOCSTR+32                                                13090000
IOCHURBA EQU   IOCSTR+28                                                13091000
IOCVOLSR EQU   IOCSTR+22                                                13092000
@NM00018 EQU   IOCMSG                                                   13093000
IOCMSGAE EQU   IOCMSG                                                   13094000
IOCMSGCE EQU   IOCMSG                                                   13095000
IOCMSGOE EQU   IOCMSG                                                   13096000
IOCMSGOP EQU   IOCMSG                                                   13097000
@NM00017 EQU   IOCMSG                                                   13098000
IOCCHPSY EQU   IOCCHP                                                   13099000
IOCCHPAS EQU   IOCCHP                                                   13100000
IOCCHPBK EQU   IOCCHP                                                   13101000
IOCCHPCR EQU   IOCCHP                                                   13102000
IOCCHPKS EQU   IOCCHP                                                   13103000
IOCCHPSK EQU   IOCCHP                                                   13104000
IOCCHPDR EQU   IOCCHP                                                   13105000
IOCCHPSQ EQU   IOCCHP                                                   13106000
@NM00016 EQU   IOCMAC2                                                  13107000
IOCMACPA EQU   IOCMAC2                                                  13108000
@NM00015 EQU   IOCMAC2                                                  13109000
IOCMACCP EQU   IOCMAC2                                                  13110000
IOCMACRR EQU   IOCMAC2                                                  13111000
IOCMACAS EQU   IOCMAC2                                                  13112000
IOCMACSK EQU   IOCMAC2                                                  13113000
@NM00014 EQU   IOCMAC                                                   13114000
IOCMACCC EQU   IOCMAC                                                   13115000
IOCMACDR EQU   IOCMAC                                                   13116000
IOCMACBK EQU   IOCMAC                                                   13117000
IOCMACCR EQU   IOCMAC                                                   13118000
IOCMACUP EQU   IOCMAC                                                   13119000
IOCMACOT EQU   IOCMAC                                                   13120000
IOCMACIN EQU   IOCMAC                                                   13121000
@NM00013 EQU   IOCRFM                                                   13122000
IOCRFMBK EQU   IOCRFM                                                   13123000
IOCRFMSF EQU   IOCRFM                                                   13124000
IOCRFMUN EQU   IOCRFM                                                   13125000
IOCRFMVR EQU   IOCRFM                                                   13126000
IOCRFMFX EQU   IOCRFM                                                   13127000
@NM00012 EQU   IOCDSO                                                   13128000
IOCDSOPO EQU   IOCDSO                                                   13129000
IOCDSOIS EQU   IOCDSO                                                   13130000
IOCDSOPS EQU   IOCDSO                                                   13131000
IOCDSOAM EQU   IOCDSO                                                   13132000
IOCRKP   EQU   IOCSTR+13                                                13133000
IOCKYL   EQU   IOCSTR+12                                                13134000
IOCTRN   EQU   IOCSTR+8                                                 13135000
UNITVTOC EQU   UNITABL+7                                                13136000
@NM00011 EQU   UNITSTAT                                                 13137000
UNITUSHR EQU   UNITSTAT                                                 13138000
UNITXSHR EQU   UNITSTAT                                                 13139000
UNITISHR EQU   UNITSTAT                                                 13140000
UNITUA   EQU   @NM00010+1                                               13141000
UNITCHA  EQU   @NM00010                                                 13142000
UNITUCB  EQU   UNITABL                                                  13143000
ALLUNCNT EQU   ALLAGL+30                                                13144000
ALLVLCNT EQU   ALLAGL+29                                                13145000
@NM00009 EQU   ALLOPT                                                   13146000
ALLOPTUN EQU   ALLOPT                                                   13147000
ALLOPTPV EQU   ALLOPT                                                   13148000
ALLOPTDS EQU   ALLOPT                                                   13149000
ALLOPTVL EQU   ALLOPT                                                   13150000
@NM00008 EQU   ALLORG+1                                                 13151000
ALLORGVS EQU   ALLORG+1                                                 13152000
@NM00007 EQU   ALLORG+1                                                 13153000
ALLORGGS EQU   ALLORG+1                                                 13154000
ALLORGUN EQU   ALLORG                                                   13155000
ALLORGPO EQU   ALLORG                                                   13156000
ALLORGMQ EQU   ALLORG                                                   13157000
ALLORGCQ EQU   ALLORG                                                   13158000
ALLORGCX EQU   ALLORG                                                   13159000
ALLORGDA EQU   ALLORG                                                   13160000
ALLORGPS EQU   ALLORG                                                   13161000
ALLORGIS EQU   ALLORG                                                   13162000
ALLDSPUN EQU   ALLDSP                                                   13163000
ALLDSPCG EQU   ALLDSP                                                   13164000
ALLDSPDE EQU   ALLDSP                                                   13165000
ALLDSPKP EQU   ALLDSP                                                   13166000
@NM00006 EQU   ALLDSP                                                   13167000
ALLSTSOD EQU   ALLSTS                                                   13168000
ALLSTSMD EQU   ALLSTS                                                   13169000
ALLSTSNW EQU   ALLSTS                                                   13170000
ALLSTSSR EQU   ALLSTS                                                   13171000
@NM00005 EQU   ALLSTS                                                   13172000
ALLPWD   EQU   ALLAGL+20                                                13173000
ALLVLP   EQU   ALLAGL+16                                                13174000
ALLULP   EQU   ALLAGL+12                                                13175000
ALLDDN   EQU   ALLAGL+4                                                 13176000
ALLDSN   EQU   ALLAGL                                                   13177000
CIRPID   EQU   CIRAGL+28                                                13178000
CIRPWD   EQU   CIRAGL+24                                                13179000
CIRCAT   EQU   CIRAGL+20                                                13180000
CIRWKP   EQU   CIRAGL+16                                                13181000
CIRTLR   EQU   CIRAGL+12                                                13182000
CIRHDR   EQU   CIRAGL+8                                                 13183000
CIRTLN   EQU   CIRAGL+6                                                 13184000
CIRHLN   EQU   CIRAGL+4                                                 13185000
@NM00004 EQU   CIRAGL+1                                                 13186000
@NM00003 EQU   CIRTYPE                                                  13187000
CIRTYPAQ EQU   CIRTYPE                                                  13188000
CIRTYP1Q EQU   CIRTYPE                                                  13189000
NEWID1   EQU   TRACE1+95                                                13190000
CALLID   EQU   OLDERID1+90                                              13191000
@NM00002 EQU   OLDERID1                                                 13192000
GDTECT   EQU   GDTTBL+188                                               13193000
GDTPSB   EQU   GDTTBL+184                                               13194000
GDTUPT   EQU   GDTTBL+180                                               13195000
GDTCMB   EQU   GDTTBL+176                                               13196000
GDTSPR   EQU   GDTTBL+168                                               13197000
@NM00001 EQU   GDTTBL+160                                               13198000
GDTABH   EQU   GDTTBL+156                                               13199000
GDTABT   EQU   GDTTBL+152                                               13200000
GDTTOH   EQU   GDTTBL+120                                               13201000
GDTRIP   EQU   GDTTBL+116                                               13202000
GDTIOH   EQU   GDTTBL+36                                                13203000
GDTSAH   EQU   GDTTBL+32                                                13204000
GDTTPH   EQU   GDTTBL+28                                                13205000
GDTSTH   EQU   GDTTBL+20                                                13206000
GDTDBH   EQU   GDTTBL+16                                                13207000
GDTHDR   EQU   GDTTBL                                                   13208000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      13209000
@RC00319 EQU   @EL00002                                                 13210000
@RF00342 EQU   @EL00002                                                 13211000
@RC00337 EQU   @EL00002                                                 13212000
@RC00481 EQU   @RC00467                                                 13213000
@RT00479 EQU   @RC00467                                                 13214000
@RC00489 EQU   @RC00488                                                 13215000
@RC00495 EQU   @RC00488                                                 13216000
@RF00494 EQU   @RC00488                                                 13217000
@RC00509 EQU   @RC00505                                                 13218000
@RC00556 EQU   @RC00549                                                 13219000
@RC00554 EQU   @RC00549                                                 13220000
@RC00552 EQU   @RC00549                                                 13221000
@RC00550 EQU   @RC00549                                                 13222000
@RC00563 EQU   @RC00562                                                 13223000
@RC00582 EQU   @RC00581                                                 13224000
@RC00593 EQU   @RC00579                                                 13225000
@RF00678 EQU   @RC00673                                                 13226000
@RF00697 EQU   @EL00005                                                 13227000
@RF00700 EQU   @EL00005                                                 13228000
@RF00768 EQU   @RC00763                                                 13229000
@RC00806 EQU   @RC00805                                                 13230000
@RC00811 EQU   @RC00805                                                 13231000
@RC00818 EQU   @RC00805                                                 13232000
@RT00830 EQU   @EL00006                                                 13233000
@RF00829 EQU   @EL00006                                                 13234000
@RT00865 EQU   @EL00007                                                 13235000
@RF00864 EQU   @EL00007                                                 13236000
@RF00877 EQU   @EL00008                                                 13237000
@PB00008 EQU   @EL00004                                                 13238000
@RT00936 EQU   @EL00009                                                 13239000
@RF00895 EQU   @EL00009                                                 13240000
@RC00933 EQU   @EL00009                                                 13241000
@RT01001 EQU   @EL00010                                                 13242000
@RC00997 EQU   @EL00010                                                 13243000
@PB00010 EQU   @EL00003                                                 13244000
@RC01048 EQU   @RC01047                                                 13245000
@RC01079 EQU   @EL00012                                                 13246000
@RF01078 EQU   @EL00012                                                 13247000
@RF01077 EQU   @EL00012                                                 13248000
@RC01096 EQU   @EL00013                                                 13249000
@RF01095 EQU   @EL00013                                                 13250000
@RF01094 EQU   @EL00013                                                 13251000
@PB00013 EQU   @EL00011                                                 13252000
@RC01119 EQU   @RC01118                                                 13253000
@RC01237 EQU   @RC01236                                                 13254000
@RF01247 EQU   @RC01236                                                 13255000
@RC01342 EQU   @EL00015                                                 13256000
@RC01340 EQU   @EL00015                                                 13257000
@RC01331 EQU   @EL00015                                                 13258000
@RF01330 EQU   @EL00015                                                 13259000
@RC01419 EQU   @RC01418                                                 13260000
@RF01452 EQU   @EL00017                                                 13261000
@PB00017 EQU   @EL00016                                                 13262000
@RC01521 EQU   @EL00019                                                 13263000
@PB00019 EQU   @EL00014                                                 13264000
@RC01596 EQU   @RC01585                                                 13265000
@RC01620 EQU   @EL00020                                                 13266000
@RC01611 EQU   @EL00020                                                 13267000
@RC01569 EQU   @EL00020                                                 13268000
@RF01714 EQU   @EL00022                                                 13269000
@RF01724 EQU   @EL00022                                                 13270000
@PB00022 EQU   @EL00021                                                 13271000
@PB00024 EQU   @EL00023                                                 13272000
@RC01851 EQU   @RC01850                                                 13273000
@RF01883 EQU   @EL00026                                                 13274000
@RC01877 EQU   @EL00026                                                 13275000
@RC01896 EQU   @RC01893                                                 13276000
@RF01904 EQU   @EL00027                                                 13277000
@RC02004 EQU   @EL00028                                                 13278000
@RC02021 EQU   @RC02020                                                 13279000
@RC02064 EQU   @RC02056                                                 13280000
@RF02192 EQU   @EL00032                                                 13281000
@PB00032 EQU   @EL00031                                                 13282000
@PB00031 EQU   @EL00030                                                 13283000
@RF02213 EQU   @EL00033                                                 13284000
@RF02242 EQU   @EL00034                                                 13285000
@RF02266 EQU   @EL00035                                                 13286000
@PB00035 EQU   @EL00001                                                 13287000
@RF00585 EQU   @RC00582                                                 13288000
@PB00007 EQU   @PB00008                                                 13289000
@RC00938 EQU   @RC00933                                                 13290000
@PB00009 EQU   @PB00010                                                 13291000
@RC01003 EQU   @RC00997                                                 13292000
@RC01053 EQU   @RC01048                                                 13293000
@RF01052 EQU   @RC01048                                                 13294000
@PB00012 EQU   @PB00013                                                 13295000
@RC01334 EQU   @RC01331                                                 13296000
@RC01332 EQU   @RC01331                                                 13297000
@RC01427 EQU   @PB00017                                                 13298000
@PB00018 EQU   @PB00019                                                 13299000
@RC01575 EQU   @RC01569                                                 13300000
@RF01624 EQU   @RC01620                                                 13301000
@RC02030 EQU   @RC02021                                                 13302000
@RC02022 EQU   @RC02021                                                 13303000
@RC02049 EQU   @PB00031                                                 13304000
@RF02100 EQU   @PB00031                                                 13305000
@RC02111 EQU   @PB00032                                                 13306000
@PB00034 EQU   @PB00035                                                 13307000
@PB00006 EQU   @PB00007                                                 13308000
@PB00004 EQU   @PB00009                                                 13309000
@RC00941 EQU   @RC00938                                                 13310000
@RC00947 EQU   @RC00938                                                 13311000
@RF00946 EQU   @RC00938                                                 13312000
@RF00965 EQU   @RC00938                                                 13313000
@RC01007 EQU   @RC01003                                                 13314000
@RF01006 EQU   @RC01003                                                 13315000
@RC01428 EQU   @RC01427                                                 13316000
@PB00016 EQU   @PB00018                                                 13317000
@RC02023 EQU   @RC02022                                                 13318000
@RC02112 EQU   @RC02111                                                 13319000
@PB00033 EQU   @PB00034                                                 13320000
@PB00005 EQU   @PB00006                                                 13321000
@RC00951 EQU   @RC00947                                                 13322000
@RF00950 EQU   @RC00947                                                 13323000
@RC01008 EQU   @RC01007                                                 13324000
@PB00015 EQU   @PB00016                                                 13325000
@PB00030 EQU   @PB00033                                                 13326000
@RC00952 EQU   @RC00951                                                 13327000
@RC01166 EQU   @PB00015                                                 13328000
@RC01128 EQU   @PB00015                                                 13329000
@RC01212 EQU   @PB00015                                                 13330000
@RC01210 EQU   @PB00015                                                 13331000
@PB00029 EQU   @PB00030                                                 13332000
@RC01129 EQU   @RC01128                                                 13333000
@RF01147 EQU   @RC01128                                                 13334000
@RC01161 EQU   @RC01128                                                 13335000
@RC01149 EQU   @RC01128                                                 13336000
@RC01204 EQU   @RC01166                                                 13337000
@RC01188 EQU   @RC01166                                                 13338000
@RF01187 EQU   @RC01166                                                 13339000
@PB00028 EQU   @PB00029                                                 13340000
@RC01132 EQU   @RC01129                                                 13341000
@RC01130 EQU   @RC01129                                                 13342000
@RC01151 EQU   @RC01149                                                 13343000
@RF01201 EQU   @RC01188                                                 13344000
@PB00027 EQU   @PB00028                                                 13345000
@PB00026 EQU   @PB00027                                                 13346000
@PB00025 EQU   @PB00026                                                 13347000
@PB00023 EQU   @PB00025                                                 13348000
@PB00021 EQU   @PB00023                                                 13349000
@PB00020 EQU   @PB00021                                                 13350000
@PB00014 EQU   @PB00020                                                 13351000
@PB00011 EQU   @PB00014                                                 13352000
@PB00003 EQU   @PB00011                                                 13353000
@PB00002 EQU   @PB00003                                                 13354000
@ENDDATA EQU   *                                                        13355000
         END   IDCRI01,(C'PLS1833',0701,76310)                          13356000
