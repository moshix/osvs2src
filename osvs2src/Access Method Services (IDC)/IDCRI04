         TITLE '*********  IDCRI04: READER/INTERPRETER - TSO MODULE   **00001000
               *********'                                               00002000
         MACRO                                                          00003000
         GETMAIN &R,&LV=                                                00004000
         L     REG15,0(REG1)           GDTTBL ADDRESS                   00005000
         L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS             00006000
         CNOP  2,4                     BOUNDARY ALIGNMENT               00007000
         LA    REG14,*+14              RETURN ADDRESS                   00008000
         BALR  REG1,REG15              LINKAGE TO PROL ROUTINE          00009000
         DC    A(MODID)                MODULE ID ADDRESS                00010000
         DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS   00011000
         MEND                                                           00012000
IDCRI04  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCRI04   76.335'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @11,4095(,@12)                                      0002 00022000
         LA    @10,4095(,@11)                                      0002 00023000
         LA    @09,4095(,@10)                                      0002 00024000
         USING @PSTART,@12                                         0002 00025000
         USING @PSTART+4095,@11                                    0002 00026000
         USING @PSTART+8190,@10                                    0002 00027000
         USING @PSTART+12285,@09                                   0002 00028000
         L     @00,@SIZDATD                                        0002 00029000
         GETMAIN  R,LV=(0)                                              00030000
         LR    @08,@01                                             0002 00031000
         USING @DATD,@08                                           0002 00032000
         ST    @13,@SA00001+4                                      0002 00033000
         LM    @00,@01,20(@13)                                     0002 00034000
         ST    @08,8(,@13)                                         0002 00035000
         LR    @13,@08                                             0002 00036000
         MVC   @PC00001(24),0(@01)                                 0002 00037000
*        GDTPTR=ADDR(GDTTBLX);                             /*@YL026UL*/ 00038000
*                                                                  0244 00039000
         L     GDTPTR,@PC00001                                     0244 00040000
*        /************************************************************/ 00041000
*        /*                                                  @YL026UL*/ 00042000
*        /* SET UP TO PROCESS THE INPUT COMMAND, UNLESS THE  @YL026UL*/ 00043000
*        /* COMMAND HAS ALREADY BEEN PROCESSED.              @YL026UL*/ 00044000
*        /*                                                  @YL026UL*/ 00045000
*        /************************************************************/ 00046000
*        SETRC=0;                                          /*@YL026UL*/ 00047000
         SLR   @05,@05                                             0245 00048000
         STH   @05,SETRC                                           0245 00049000
*        IF GDTRIH = NULLPTR                                       0246 00050000
*          THEN                                                    0246 00051000
*                                                                  0246 00052000
         C     @05,GDTRIH(,GDTPTR)                                 0246 00053000
         BNE   @RF00246                                            0246 00054000
*            CALL RISETUP;                                 /*@YL026UL*/ 00055000
*                                                                  0247 00056000
         BAL   @14,RISETUP                                         0247 00057000
*        /************************************************************/ 00058000
*        /*                                                  @YL026UL*/ 00059000
*        /* IF PROCESSING SET-UP WAS SUCCESSFUL, PROCESS     @YL026UL*/ 00060000
*        /* ALL COMMAND PARAMETERS EXCEPT THOSE CODED IN     @YL026UL*/ 00061000
*        /* REPEATED SUBPARAMETER LISTS.                     @YL026UL*/ 00062000
*        /*                                                  @YL026UL*/ 00063000
*        /************************************************************/ 00064000
*        IF LASTCC=0 & GDTRIH=NULLPTR & MAXID>0                    0248 00065000
*          THEN                                                    0248 00066000
*                                                                  0248 00067000
@RF00246 SLR   @05,@05                                             0248 00068000
         L     @02,@PC00001+16                                     0248 00069000
         CH    @05,LASTCC(,@02)                                    0248 00070000
         BNE   @RF00248                                            0248 00071000
         C     @05,GDTRIH(,GDTPTR)                                 0248 00072000
         BNE   @RF00248                                            0248 00073000
         L     @02,DESCPTR                                         0248 00074000
         CH    @05,MAXID(,@02)                                     0248 00075000
         BNL   @RF00248                                            0248 00076000
*            CALL MAINSCAN;                                /*@YL026UL*/ 00077000
*                                                                  0249 00078000
         BAL   @14,MAINSCAN                                        0249 00079000
*        /************************************************************/ 00080000
*        /*                                                  @YL026UL*/ 00081000
*        /* IF PROCESSING IS OKAY TO THIS POINT, THEN        @YL026UL*/ 00082000
*        /* PROCESS PARAMETERS CODED IN REPEATED SUBPARM     @YL026UL*/ 00083000
*        /* LISTS IF ANY EXIST.  HOWEVER, DON'T PROCESS A    @YL026UL*/ 00084000
*        /* SUBLIST OF A PARAMETER WHICH HAS SINCE BEEN      @YL026UL*/ 00085000
*        /* REQUESTED BY THE USER TO BE IGNORED.             @YL026UL*/ 00086000
*        /*                                                  @YL026UL*/ 00087000
*        /************************************************************/ 00088000
*        IF LASTCC=0 & GDTRIH=NULLPTR & MAXID > 0                  0250 00089000
*          THEN                                                    0250 00090000
@RF00248 SLR   @05,@05                                             0250 00091000
         L     @02,@PC00001+16                                     0250 00092000
         CH    @05,LASTCC(,@02)                                    0250 00093000
         BNE   @RF00250                                            0250 00094000
         C     @05,GDTRIH(,GDTPTR)                                 0250 00095000
         BNE   @RF00250                                            0250 00096000
         L     @02,DESCPTR                                         0250 00097000
         CH    @05,MAXID(,@02)                                     0250 00098000
         BNL   @RF00250                                            0250 00099000
*            DO REPINDEX=1 TO RSICOUNT WHILE(LASTCC=0);    /*@YL026UL*/ 00100000
         LA    @05,1                                               0251 00101000
         B     @DE00251                                            0251 00102000
@DL00251 L     @02,@PC00001+16                                     0251 00103000
         LH    @02,LASTCC(,@02)                                    0251 00104000
         LTR   @02,@02                                             0251 00105000
         BNZ   @DC00251                                            0251 00106000
*              IF SBLSTIN(REPINDEX)=YES                            0252 00107000
*                THEN                                              0252 00108000
*                                                                  0252 00109000
         MH    @05,@CH00038                                        0252 00110000
         L     @02,RSIPTR                                          0252 00111000
         ALR   @02,@05                                             0252 00112000
         AL    @02,@CF01813                                        0252 00113000
         TM    SBLSTIN-9(@02),B'10000000'                          0252 00114000
         BNO   @RF00252                                            0252 00115000
*                  CALL SUBSCAN;                           /*@YL026UL*/ 00116000
*                                                                  0253 00117000
         BAL   @14,SUBSCAN                                         0253 00118000
*            END;                                          /*@YL026UL*/ 00119000
*                                                                  0254 00120000
@RF00252 LA    @05,1                                               0254 00121000
         AH    @05,REPINDEX                                        0254 00122000
@DE00251 STH   @05,REPINDEX                                        0254 00123000
         CH    @05,RSICOUNT                                        0254 00124000
         BNH   @DL00251                                            0254 00125000
@DC00251 DS    0H                                                  0255 00126000
*        /************************************************************/ 00127000
*        /*                                                  @YL026UL*/ 00128000
*        /* PERFORM TERMINATION FUNCTIONS.                   @YL026UL*/ 00129000
*        /*                                                  @YL026UL*/ 00130000
*        /************************************************************/ 00131000
*        CALL RITERM;                                      /*@YL026UL*/ 00132000
*                                                                  0255 00133000
@RF00250 BAL   @14,RITERM                                          0255 00134000
*        CALL IDCSAEP0(GDTTBL,MODID,SETRC);                        0256 00135000
         ST    GDTPTR,@AL00001                                     0256 00136000
         LA    @07,MODID                                           0256 00137000
         ST    @07,@AL00001+4                                      0256 00138000
         LA    @07,SETRC                                           0256 00139000
         ST    @07,@AL00001+8                                      0256 00140000
         MVI   @AL00001+8,X'80'                                    0256 00141000
         L     @15,GDTEPL(,GDTPTR)                                 0256 00142000
         LA    @01,@AL00001                                        0256 00143000
         BALR  @14,@15                                             0256 00144000
*        /*@YL026UL*/                                              0257 00145000
*                                                                  0257 00146000
*/********************************************************************/ 00147000
*/*                                                          @YL026UL*/ 00148000
*/*  PROCEDURE NAME - RISETUP                                @YL026UL*/ 00149000
*/*                                                          @YL026UL*/ 00150000
*/*  FUNCTION - THIS ROUTINE PREPARES FOR PROCESSING OF      @YL026UL*/ 00151000
*/*             THE INPUT COMMAND.  THE COMMAND DESCRIPTOR   @YL026UL*/ 00152000
*/*             LOAD MODULE NAME TABLE IS LOADED AND USED    @YL026UL*/ 00153000
*/*             TO OBTAIN THE COMMAND DESCRIPTOR FOR THE     @YL026UL*/ 00154000
*/*             CURRENT INPUT COMMAND.  USING THE DESCRIPTOR @YL026UL*/ 00155000
*/*             THE 'PARMINFO' TABLE IS BUILT, AND SPACE IS  @YL026UL*/ 00156000
*/*             ALLOCATED AND INITIALIZED FOR THE REPEATED   @YL026UL*/ 00157000
*/*             SUBLIST INDEX (RSI), AND FOR THE INITIAL     @YL026UL*/ 00158000
*/*             FDT SECTION(S).  ALSO, THE STATIC PARTS OF   @YL026UL*/ 00159000
*/*             THE UPRINT DATA ARGUMENT LIST AND 'PARSE'    @YL026UL*/ 00160000
*/*             PARAMETER LIST ARE INITIALLY SET UP.         @YL026UL*/ 00161000
*/*                                                          @YL026UL*/ 00162000
*/*  INPUT -                                                 @YL026UL*/ 00163000
*/*            IDCRILT -  DESCRIPTOR LOAD MODULE NAME TABLE. @YL026UL*/ 00164000
*/*            ECTPCMD -  COMMAND VERB NAME.                 @YL026UL*/ 00165000
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/ 00166000
*/*            SPACEID -  SUBPOOL ID USED WHEN OBTAINING     @YL026UL*/ 00167000
*/*                       SPACE FOR THE FDT.                 @YL026UL*/ 00168000
*/*            GDTUPT -   PTR TO TSO USER PROFILE TABLE      @YL026UL*/ 00169000
*/*            GDTECT -   PTR TO TSO ENVIR. CONTROL TABLE    @YL026UL*/ 00170000
*/*                                                          @YL026UL*/ 00171000
*/*  OUTPUT -                                                @YL026UL*/ 00172000
*/*            DARGLIST - INITIALIZED UPRINT DATA ARGUMENT   @YL026UL*/ 00173000
*/*                       LIST                               @YL026UL*/ 00174000
*/*            PARMINFO - PARAMETER INFORMATION TABLE        @YL026UL*/ 00175000
*/*            FDTADDR -  ADDRESS OF FDT                     @YL026UL*/ 00176000
*/*            FUNCTION DATA TABLE - INITIALIZED             @YL026UL*/ 00177000
*/*            PPL -  PARSE PARAMETER LIST - INITIALIZED     @YL026UL*/ 00178000
*/*                                                          @YL026UL*/ 00179000
*/********************************************************************/ 00180000
*RISETUP:PROCEDURE;                                        /*@YL026UL*/ 00181000
@EL00001 L     @13,4(,@13)                                         0257 00182000
@EF00001 L     @00,@SIZDATD                                        0257 00183000
         LR    @01,@08                                             0257 00184000
         FREEMAIN R,LV=(0),A=(1)                                        00185000
@ER00001 LM    @14,@12,12(@13)                                     0257 00186000
         BR    @14                                                 0257 00187000
RISETUP  STM   @14,@03,@SA00002                                    0257 00188000
         STM   @05,@12,@SA00002+24                                 0257 00189000
*        /************************************************************/ 00190000
*        /*                                                  @YL026UL*/ 00191000
*        /*  ** RISETUP **  DATA DEFINITIONS                 @YL026UL*/ 00192000
*        /*                                                  @YL026UL*/ 00193000
*        /************************************************************/ 00194000
*                                                                  0258 00195000
*        /*COMMAND DESCRIPTOR LOAD MODULE NAME TABLE         @ZA07563*/ 00196000
*        DCL 1 RILT BASED(SETUPPTR) BDY(WORD),                     0258 00197000
*              2 * (*) BDY(WORD),                         /* @ZA07563*/ 00198000
*                3 TBLVERB  CHAR(8),   /*VERB NAME           @ZA07563*/ 00199000
*                3 TBLLNAME CHAR(8);   /*CORRESPONDING CMD.  @ZA07563*/ 00200000
*                                      /*DESCRIPTOR LOAD     @YL026UL*/ 00201000
*                                      /*MODULE NAME         @YL026UL*/ 00202000
*                                                                  0259 00203000
*        /* LOAD MODULE NAME TABLE TERMINATOR                @ZA07563*/ 00204000
*        DCL TBLEND CHAR(8) CONSTANT('FFFFFFFF');         /* @ZA07563*/ 00205000
*                                                                  0259 00206000
*        DCL SETUPPTR PTR(31);         /*WORK PTR USED FOR   @YL026UL*/ 00207000
*                                      /*PROCESSING SET-UP   @YL026UL*/ 00208000
*                                                                  0261 00209000
*        DCL LTBLNAME CHAR(8)          /*NAME OF DESCRIPTOR  @YL026UL*/ 00210000
*                CONSTANT('IDCRILT '); /*LOAD NAME TABLE     @YL026UL*/ 00211000
*        DCL BADPARMS FIXED(15)        /*MSG ID INDICATING   @YL026UL*/ 00212000
*                     CONSTANT(16);    /*UNNEEDED PARMS      @YL026UL*/ 00213000
*        /************************************************************/ 00214000
*        /*                                                  @YL026UL*/ 00215000
*        /*  ** RISETUP **  PREPARE TO PROCESS COMMAND       @YL026UL*/ 00216000
*        /*                                                  @YL026UL*/ 00217000
*        /************************************************************/ 00218000
*        OLDERID2 = NEWERID2;                                      0263 00219000
         L     @07,GDTTR2(,GDTPTR)                                 0263 00220000
         MVC   @TS00001(95),NEWERID2(@07)                          0263 00221000
         MVC   OLDERID2(95,@07),@TS00001                           0263 00222000
*        NEWID2='RI10';                                    /*@YL026UL*/ 00223000
*                                                                  0264 00224000
         MVC   NEWID2(4,@07),@CC01529                              0264 00225000
*        BLKLEFT=0;                    /*INITIALLY, NO FDT   @YL026UL*/ 00226000
         SLR   @07,@07                                             0265 00227000
         ST    @07,BLKLEFT                                         0265 00228000
*                                      /*DATA SPACE HAS      @YL026UL*/ 00229000
*                                      /*BEEN ALLOCATED      @YL026UL*/ 00230000
*                                                                  0266 00231000
*        /************************************************************/ 00232000
*        /*                                                  @YL026UL*/ 00233000
*        /* INITIALIZE THE UPRINT DATA ARGUMENT LIST         @YL026UL*/ 00234000
*        /*                                                  @YL026UL*/ 00235000
*        /************************************************************/ 00236000
*        DDSTRU=ADDR(PRNTAREA);                            /*@YL026UL*/ 00237000
         LA    @07,PRNTAREA                                        0266 00238000
         ST    @07,DDSTRU                                          0266 00239000
*        PRNTAREA=''B;                                     /*@YL026UL*/ 00240000
         XC    PRNTAREA(20),PRNTAREA                               0267 00241000
*        DARGSMOD=RISTID;                                  /*@YL026UL*/ 00242000
*                                                                  0268 00243000
         MVC   DARGSMOD(3,@07),@CC01472                            0268 00244000
*        /************************************************************/ 00245000
*        /*                                                  @YL026UL*/ 00246000
*        /* LOAD THE DESCRIPTOR LOAD NAME TABLE AND SEARCH   @YL026UL*/ 00247000
*        /* IT FOR A VERB MATCHING THE EXTRACTED VERB NAME.  @YL026UL*/ 00248000
*        /* WHEN A MATCH IS FOUND, LOAD THE CORRESPONDING    @YL026UL*/ 00249000
*        /* COMMAND DESCRIPTOR.                              @YL026UL*/ 00250000
*        /*                                                  @YL026UL*/ 00251000
*        /************************************************************/ 00252000
*                                                                  0269 00253000
*        CALL IDCSALD0(GDTTBL,LTBLNAME,SETUPPTR);          /*@YL026UL*/ 00254000
*                                                                  0269 00255000
         ST    GDTPTR,@AL00001                                     0269 00256000
         LA    @07,@CC01527                                        0269 00257000
         ST    @07,@AL00001+4                                      0269 00258000
         LA    @07,SETUPPTR                                        0269 00259000
         ST    @07,@AL00001+8                                      0269 00260000
         L     @15,GDTLOD(,GDTPTR)                                 0269 00261000
         LA    @01,@AL00001                                        0269 00262000
         BALR  @14,@15                                             0269 00263000
*        FOUND=NO;                                         /*@YL026UL*/ 00264000
         NI    FOUND,B'11111101'                                   0270 00265000
*        DO INDEX2=1 BY 1                                  /*@ZA07563*/ 00266000
*           WHILE(FOUND=NO & TBLVERB(INDEX2)^=TBLEND);     /*@ZA07563*/ 00267000
         LA    INDEX2,1                                            0271 00268000
         B     @DE00271                                            0271 00269000
@DL00271 DS    0H                                                  0272 00270000
*          IF TBLVERB(INDEX2) = ECTPCMD                            0272 00271000
*            THEN                                                  0272 00272000
         L     @07,SETUPPTR                                        0272 00273000
         LR    @05,INDEX2                                          0272 00274000
         SLA   @05,4                                               0272 00275000
         L     @03,ECTPTR(,GDTPTR)                                 0272 00276000
         ST    @05,@TF00001                                        0272 00277000
         ALR   @05,@07                                             0272 00278000
         AL    @05,@CF01815                                        0272 00279000
         CLC   TBLVERB(8,@05),ECTPCMD(@03)                         0272 00280000
         BNE   @RF00272                                            0272 00281000
*              DO;                                         /*@YL026UL*/ 00282000
*              FOUND=YES;                                  /*@YL026UL*/ 00283000
*                                                                  0274 00284000
         OI    FOUND,B'00000010'                                   0274 00285000
*              CALL IDCSALD0(GDTTBL,TBLLNAME(INDEX2),DESCPTR);/*   0275 00286000
*                                                            @YL026UL*/ 00287000
*                                                                  0275 00288000
         ST    GDTPTR,@AL00001                                     0275 00289000
         L     @05,@TF00001                                        0275 00290000
         AL    @07,@CF01817                                        0275 00291000
         LA    @07,TBLLNAME-8(@05,@07)                             0275 00292000
         ST    @07,@AL00001+4                                      0275 00293000
         LA    @07,DESCPTR                                         0275 00294000
         ST    @07,@AL00001+8                                      0275 00295000
         L     @15,GDTLOD(,GDTPTR)                                 0275 00296000
         LA    @01,@AL00001                                        0275 00297000
         BALR  @14,@15                                             0275 00298000
*              END;                                        /*@YL026UL*/ 00299000
*        END;                                              /*@YL026UL*/ 00300000
@RF00272 AL    INDEX2,@CF00227                                     0277 00301000
@DE00271 TM    FOUND,B'00000010'                                   0277 00302000
         BNZ   @DC00271                                            0277 00303000
         LR    @07,INDEX2                                          0277 00304000
         SLA   @07,4                                               0277 00305000
         L     @05,SETUPPTR                                        0277 00306000
         ALR   @05,@07                                             0277 00307000
         AL    @05,@CF01815                                        0277 00308000
         CLC   TBLVERB(8,@05),@CC01525                             0277 00309000
         BNE   @DL00271                                            0277 00310000
@DC00271 DS    0H                                                  0278 00311000
*        /************************************************************/ 00312000
*        /*                                                  @YL026UL*/ 00313000
*        /* CREATE AND SET UP THE 'PARMINFO' TABLE IF THIS   @YL026UL*/ 00314000
*        /* COMMAND IS DEFINED TO HAVE PARAMETERS.  ALSO GET @YL026UL*/ 00315000
*        /* SPACE FOR THE 'RSI'.  IF INSUFFICIENT SPACE IS   @YL026UL*/ 00316000
*        /* AVAILABLE, DISCONTINUE PROCESSING.               @YL026UL*/ 00317000
*        /*                                                  @YL026UL*/ 00318000
*        /************************************************************/ 00319000
*        IF MAXID > 0                                              0278 00320000
*          THEN                                                    0278 00321000
         L     @07,DESCPTR                                         0278 00322000
         LH    @07,MAXID(,@07)                                     0278 00323000
         LTR   @07,@07                                             0278 00324000
         BNP   @RF00278                                            0278 00325000
*DOGRP5:     DO;                                           /*@YL026UL*/ 00326000
DOGRP5   DS    0H                                                  0280 00327000
*            AMTTOGET=MAXID*LENGTH(PARMINFO)+                      0280 00328000
*                     INITALLO*LENGTH(RSI);                /*@YL026UL*/ 00329000
*                                                                  0280 00330000
         L     @07,DESCPTR                                         0280 00331000
         LH    @07,MAXID(,@07)                                     0280 00332000
         MH    @07,@CH00038                                        0280 00333000
         AL    @07,@CF01802                                        0280 00334000
         ST    @07,AMTTOGET                                        0280 00335000
*            CALL IDCSAGP0(GDTTBL,AMTTOGET,PINFOPTR,RIPOOLID,      0281 00336000
*                   SETZERO);                              /*@YL026UL*/ 00337000
         ST    GDTPTR,@AL00001                                     0281 00338000
         LA    @07,AMTTOGET                                        0281 00339000
         ST    @07,@AL00001+4                                      0281 00340000
         LA    @07,PINFOPTR                                        0281 00341000
         ST    @07,@AL00001+8                                      0281 00342000
         LA    @07,MODID                                           0281 00343000
         ST    @07,@AL00001+12                                     0281 00344000
         LA    @07,SETZERO                                         0281 00345000
         ST    @07,@AL00001+16                                     0281 00346000
         MVI   @AL00001+16,X'80'                                   0281 00347000
         L     @15,GDTGPL(,GDTPTR)                                 0281 00348000
         LA    @01,@AL00001                                        0281 00349000
         BALR  @14,@15                                             0281 00350000
*            RESPECIFY RTNREG RSTD;                                0282 00351000
*            TESTRC = RTNREG;                                      0283 00352000
         LR    TESTRC,RTNREG                                       0283 00353000
*            RESPECIFY RTNREG UNRSTD;                      /*@YL026UL*/ 00354000
*                                                                  0284 00355000
*            /********************************************************/ 00356000
*            /*                                              @Y30SSFR*/ 00357000
*            /*  IF CORE COULD NOT BE OBTAINED, CALL         @Y30SSFR*/ 00358000
*            /*  FAILSPAC TO HANDLE THE ERROR.               @Y30SSFR*/ 00359000
*            /*                                              @Y30SSFR*/ 00360000
*            /********************************************************/ 00361000
*            IF TESTRC^=0                                          0285 00362000
*              THEN                                                0285 00363000
         LTR   TESTRC,TESTRC                                       0285 00364000
         BZ    @RF00285                                            0285 00365000
*                DO;                                       /*@YL026UL*/ 00366000
*                                                                  0286 00367000
*                CALL FAILSPAC;                            /*@YL026UL*/ 00368000
*                                                                  0287 00369000
         BAL   @14,FAILSPAC                                        0287 00370000
*                RETURN;                                   /*@YL026UL*/ 00371000
@EL00002 DS    0H                                                  0288 00372000
@EF00002 DS    0H                                                  0288 00373000
@ER00002 LM    @14,@03,@SA00002                                    0288 00374000
         LM    @05,@12,@SA00002+24                                 0288 00375000
         BR    @14                                                 0288 00376000
*                END;                                      /*@YL026UL*/ 00377000
*                                                                  0289 00378000
*            /********************************************************/ 00379000
*            /*                                              @YL026UL*/ 00380000
*            /* EXAMINE THE LIST OF PARM ID#S ASSOCIATED     @YL026UL*/ 00381000
*            /* WITH EACH 'PARMDATA' DESCRIPTOR SECTION.     @YL026UL*/ 00382000
*            /* FOR EACH ID#=N, SET 'PARMPTR(N)' TO POINT    @YL026UL*/ 00383000
*            /* TO THE 'PARMDATA' SECTION CONTAINING ID# N.  @YL026UL*/ 00384000
*            /*  SINCE THE READER/INTERPRETER USES THE       @Y30SSFR*/ 00385000
*            /*  CONVENTION THAT LENGTHS ARE STORED AS       @Y30SSFR*/ 00386000
*            /*  NUMBERS OF HALF WORDS, ALL LENGTHS FROM     @Y30SSFR*/ 00387000
*            /*  THE COMMAND DESCRIPTOR MUST BE DOUBLED.     @Y30SSFR*/ 00388000
*            /*                                              @YL026UL*/ 00389000
*            /********************************************************/ 00390000
*            SETUPPTR=DESCPTR+2*VDATALEN;                  /*@YL026UL*/ 00391000
@RF00285 L     @07,DESCPTR                                         0290 00392000
         LH    @05,VDATALEN(,@07)                                  0290 00393000
         ALR   @05,@05                                             0290 00394000
         ALR   @07,@05                                             0290 00395000
         ST    @07,SETUPPTR                                        0290 00396000
*            RESPECIFY(PARMDATA) BASED(SETUPPTR);          /*@YL026UL*/ 00397000
*            DO INDEX2=1 TO PARMCNT;                       /*@YL026UL*/ 00398000
         LA    INDEX2,1                                            0292 00399000
         B     @DE00292                                            0292 00400000
@DL00292 DS    0H                                                  0293 00401000
*              DO INDEX3=1 TO (SETUPPTR+2*IDDSPL)->IDCOUNT;/*@YL026UL*/ 00402000
         LA    INDEX3,1                                            0293 00403000
         B     @DE00293                                            0293 00404000
@DL00293 DS    0H                                                  0294 00405000
*                PARMPTR((SETUPPTR+2*IDDSPL)->IDNUM(INDEX3))=      0294 00406000
*                                      SETUPPTR;           /*@YL026UL*/ 00407000
         L     @07,SETUPPTR                                        0294 00408000
         LR    @05,INDEX3                                          0294 00409000
         SLA   @05,2                                               0294 00410000
         SLR   @15,@15                                             0294 00411000
         IC    @15,IDDSPL(,@07)                                    0294 00412000
         ALR   @15,@15                                             0294 00413000
         ALR   @15,@07                                             0294 00414000
         BCTR  @15,0                                               0294 00415000
         BCTR  @15,0                                               0294 00416000
         LH    @05,IDNUM-2(@05,@15)                                0294 00417000
         MH    @05,@CH00038                                        0294 00418000
         L     @01,PINFOPTR                                        0294 00419000
         AL    @01,@CF01818                                        0294 00420000
         ST    @07,PARMPTR(@05,@01)                                0294 00421000
*              END;                                        /*@YL026UL*/ 00422000
         AL    INDEX3,@CF00227                                     0295 00423000
@DE00293 L     @07,SETUPPTR                                        0295 00424000
         SLR   @05,@05                                             0295 00425000
         IC    @05,IDDSPL(,@07)                                    0295 00426000
         ALR   @05,@05                                             0295 00427000
         AL    @05,SETUPPTR                                        0295 00428000
         CH    INDEX3,IDCOUNT(,@05)                                0295 00429000
         BNH   @DL00293                                            0295 00430000
*              SETUPPTR=SETUPPTR+2*PDEFLEN;                /*@YL026UL*/ 00431000
         L     @07,SETUPPTR                                        0296 00432000
         SLR   @05,@05                                             0296 00433000
         IC    @05,PDEFLEN(,@07)                                   0296 00434000
         ALR   @05,@05                                             0296 00435000
         ALR   @07,@05                                             0296 00436000
         ST    @07,SETUPPTR                                        0296 00437000
*            END;                                          /*@YL026UL*/ 00438000
         AL    INDEX2,@CF00227                                     0297 00439000
@DE00292 L     @07,DESCPTR                                         0297 00440000
         CH    INDEX2,PARMCNT(,@07)                                0297 00441000
         BNH   @DL00292                                            0297 00442000
*            RESPECIFY(PARMDATA) BASED(PARMPTR(PARMID));   /*@YL026UL*/ 00443000
*                                                                  0298 00444000
*            /********************************************************/ 00445000
*            /*                                              @YL026UL*/ 00446000
*            /* DETERMINE THE ID# OF EACH PARM'S SUPERPARM   @YL026UL*/ 00447000
*            /* BY EXAMINING ALL THE SUBPARM LISTS IN THE    @YL026UL*/ 00448000
*            /* COMMAND DESCRIPTOR.  STORE EACH SUPERPARM    @YL026UL*/ 00449000
*            /* IN THE 'PARMINFO' TABLE.                     @YL026UL*/ 00450000
*            /*                                              @YL026UL*/ 00451000
*            /********************************************************/ 00452000
*            DO PARMID=1 TO MAXID;                         /*@YL026UL*/ 00453000
         LA    @07,1                                               0299 00454000
         B     @DE00299                                            0299 00455000
@DL00299 DS    0H                                                  0300 00456000
*              IF PARMPTR(PARMID) ^= NULLPTR & SUBLIST=YES         0300 00457000
*                THEN                                              0300 00458000
         MH    @07,@CH00038                                        0300 00459000
         L     @05,PINFOPTR                                        0300 00460000
         AL    @05,@CF01818                                        0300 00461000
         L     @07,PARMPTR(@07,@05)                                0300 00462000
         LTR   @07,@07                                             0300 00463000
         BZ    @RF00300                                            0300 00464000
         TM    SUBLIST(@07),B'00000010'                            0300 00465000
         BNO   @RF00300                                            0300 00466000
*                  DO INDEX2=1 TO SUBCOUNT;                /*@YL026UL*/ 00467000
         LA    INDEX2,1                                            0301 00468000
         B     @DE00301                                            0301 00469000
@DL00301 DS    0H                                                  0302 00470000
*                    SUPRPARM(SUBID(INDEX2))=PARMID;       /*@YL026UL*/ 00471000
         LH    @07,PARMID                                          0302 00472000
         L     @05,PINFOPTR                                        0302 00473000
         LA    @03,12                                              0302 00474000
         LR    @15,INDEX2                                          0302 00475000
         SLA   @15,2                                               0302 00476000
         LR    @01,@07                                             0302 00477000
         MR    @00,@03                                             0302 00478000
         AL    @01,@CF01818                                        0302 00479000
         L     @14,PARMPTR(@01,@05)                                0302 00480000
         LR    @01,@14                                             0302 00481000
         ALR   @01,@03                                             0302 00482000
         SLR   @00,@00                                             0302 00483000
         IC    @00,SUBDSPL(,@01)                                   0302 00484000
         ALR   @00,@00                                             0302 00485000
         ALR   @14,@00                                             0302 00486000
         MH    @03,SUBID-4(@15,@14)                                0302 00487000
         AL    @05,@CF01819                                        0302 00488000
         STH   @07,SUPRPARM-8(@03,@05)                             0302 00489000
*                  END;                                    /*@YL026UL*/ 00490000
         AL    INDEX2,@CF00227                                     0303 00491000
@DE00301 LH    @07,PARMID                                          0303 00492000
         MH    @07,@CH00038                                        0303 00493000
         LH    @05,PARMID                                          0303 00494000
         MH    @05,@CH00038                                        0303 00495000
         L     @03,PINFOPTR                                        0303 00496000
         AL    @03,@CF01818                                        0303 00497000
         L     @05,PARMPTR(@05,@03)                                0303 00498000
         SLR   @03,@03                                             0303 00499000
         IC    @03,SUBDSPL+12(,@05)                                0303 00500000
         ALR   @03,@03                                             0303 00501000
         L     @05,PINFOPTR                                        0303 00502000
         AL    @05,@CF01818                                        0303 00503000
         AL    @03,PARMPTR(@07,@05)                                0303 00504000
         CH    INDEX2,SUBCOUNT(,@03)                               0303 00505000
         BNH   @DL00301                                            0303 00506000
*            END;                                          /*@YL026UL*/ 00507000
*                                                                  0304 00508000
@RF00300 LA    @07,1                                               0304 00509000
         AH    @07,PARMID                                          0304 00510000
@DE00299 STH   @07,PARMID                                          0304 00511000
         L     @05,DESCPTR                                         0304 00512000
         CH    @07,MAXID(,@05)                                     0304 00513000
         BNH   @DL00299                                            0304 00514000
*            /********************************************************/ 00515000
*            /*                                              @YL026UL*/ 00516000
*            /* CHECK TO SEE WHICH PARAMETER ID#S APPEAR IN  @YL026UL*/ 00517000
*            /* 'NOT GROUP' SUBLISTS                         @YL026UL*/ 00518000
*            /*                                              @YL026UL*/ 00519000
*            /********************************************************/ 00520000
*            IF NTGRPDSP > 0                                       0305 00521000
*              THEN                                                0305 00522000
         L     @07,DESCPTR                                         0305 00523000
         CLI   NTGRPDSP(@07),0                                     0305 00524000
         BNH   @RF00305                                            0305 00525000
*DOGRP10:        DO;                                       /*@YL026UL*/ 00526000
DOGRP10  DS    0H                                                  0307 00527000
*                  GRPPTR=ADDR(NTGRPTOT)+LENGTH(NTGRPTOT); /*@YL026UL*/ 00528000
         L     @07,DESCPTR                                         0307 00529000
         SLR   GRPPTR,GRPPTR                                       0307 00530000
         IC    GRPPTR,NTGRPDSP(,@07)                               0307 00531000
         ALR   GRPPTR,GRPPTR                                       0307 00532000
         ALR   @07,GRPPTR                                          0307 00533000
         AL    @07,@CF00161                                        0307 00534000
         LR    GRPPTR,@07                                          0307 00535000
*                  DO INDEX2=1 TO NTGRPTOT;                /*@YL026UL*/ 00536000
*                                                                  0308 00537000
         LA    INDEX2,1                                            0308 00538000
         B     @DE00308                                            0308 00539000
@DL00308 DS    0H                                                  0309 00540000
*                    /************************************************/ 00541000
*                    /*                                      @YL026UL*/ 00542000
*                    /* FOR EACH ID# IN A 'NOT GROUP'        @YL026UL*/ 00543000
*                    /* SUBLIST, SAVE THE ADDRESS OF THE     @YL026UL*/ 00544000
*                    /* SUBLIST IN THE 'PARMINFO' TABLE      @YL026UL*/ 00545000
*                    /*                                      @YL026UL*/ 00546000
*                    /************************************************/ 00547000
*                    DO INDEX3=1 TO NTGRPCNT;              /*@YL026UL*/ 00548000
         LA    INDEX3,1                                            0309 00549000
         B     @DE00309                                            0309 00550000
@DL00309 DS    0H                                                  0310 00551000
*                      NTGRPPTR(NTGRPID(INDEX3))=GRPPTR;   /*@YL026UL*/ 00552000
         LR    @07,INDEX3                                          0310 00553000
         ALR   @07,@07                                             0310 00554000
         LH    @07,NTGRPID-2(@07,GRPPTR)                           0310 00555000
         MH    @07,@CH00038                                        0310 00556000
         L     @05,PINFOPTR                                        0310 00557000
         AL    @05,@CF01817                                        0310 00558000
         ST    GRPPTR,NTGRPPTR-4(@07,@05)                          0310 00559000
*                    END;                                  /*@YL026UL*/ 00560000
         AL    INDEX3,@CF00227                                     0311 00561000
@DE00309 CH    INDEX3,NTGRPCNT(,GRPPTR)                            0311 00562000
         BNH   @DL00309                                            0311 00563000
*                    GRPPTR=GRPPTR+LENGTH(NTGRPCNT)+               0312 00564000
*                           NTGRPCNT*LENGTH(NTGRPID);      /*@YL026UL*/ 00565000
         LA    @07,2                                               0312 00566000
         ALR   @07,GRPPTR                                          0312 00567000
         LH    @05,NTGRPCNT(,GRPPTR)                               0312 00568000
         ALR   @05,@05                                             0312 00569000
         ALR   @07,@05                                             0312 00570000
         LR    GRPPTR,@07                                          0312 00571000
*                  END;                                    /*@YL026UL*/ 00572000
         AL    INDEX2,@CF00227                                     0313 00573000
@DE00308 L     @07,DESCPTR                                         0313 00574000
         SLR   @05,@05                                             0313 00575000
         IC    @05,NTGRPDSP(,@07)                                  0313 00576000
         ALR   @05,@05                                             0313 00577000
         AL    @05,DESCPTR                                         0313 00578000
         CH    INDEX2,NTGRPTOT(,@05)                               0313 00579000
         BNH   @DL00308                                            0313 00580000
*                END DOGRP10;                              /*@YL026UL*/ 00581000
*                                                                  0314 00582000
*            /********************************************************/ 00583000
*            /*                                              @YL026UL*/ 00584000
*            /* SET UP THE REPEATED SUBLIST INDEX (RSI)      @YL026UL*/ 00585000
*            /*                                              @YL026UL*/ 00586000
*            /********************************************************/ 00587000
*            RSIPTR=PINFOPTR+MAXID*LENGTH(PARMINFO);       /*@YL026UL*/ 00588000
@RF00305 L     @07,DESCPTR                                         0315 00589000
         LH    @07,MAXID(,@07)                                     0315 00590000
         MH    @07,@CH00038                                        0315 00591000
         AL    @07,PINFOPTR                                        0315 00592000
         ST    @07,RSIPTR                                          0315 00593000
*            RSICOUNT=0;                                   /*@YL026UL*/ 00594000
*                                                                  0316 00595000
         SLR   @07,@07                                             0316 00596000
         STH   @07,RSICOUNT                                        0316 00597000
*            END DOGRP5;                                   /*@YL026UL*/ 00598000
*                                                                  0317 00599000
*          /**********************************************************/ 00600000
*          /*                                                @YL026UL*/ 00601000
*          /* NO PARAMETERS MAY APPEAR WITH THIS COMMAND.    @YL026UL*/ 00602000
*          /* IF ANY WERE CODED, IGNORE THEM AND PRINT A     @YL026UL*/ 00603000
*          /* WARNING MESSAGE.                               @YL026UL*/ 00604000
*          /*                                                @YL026UL*/ 00605000
*          /**********************************************************/ 00606000
*          ELSE                                                    0318 00607000
*            IF ECTNOPD=NO                                         0318 00608000
*              THEN                                                0318 00609000
         B     @RC00278                                            0318 00610000
@RF00278 L     @07,ECTPTR(,GDTPTR)                                 0318 00611000
         TM    ECTNOPD(@07),B'10000000'                            0318 00612000
         BNZ   @RF00318                                            0318 00613000
*                DO;                                       /*@YL026UL*/ 00614000
*                DARGSENT=BADPARMS;                        /*@YL026UL*/ 00615000
*                                                                  0320 00616000
         L     @07,DDSTRU                                          0320 00617000
         MVI   DARGSENT(@07),X'10'                                 0320 00618000
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     /*@YL026UL*/ 00619000
*                                                                  0321 00620000
         ST    GDTPTR,@AL00001                                     0321 00621000
         LA    @07,@CF00123                                        0321 00622000
         ST    @07,@AL00001+4                                      0321 00623000
         LA    @07,DDSTRU                                          0321 00624000
         ST    @07,@AL00001+8                                      0321 00625000
         MVI   @AL00001+8,X'80'                                    0321 00626000
         L     @15,GDTPRT(,GDTPTR)                                 0321 00627000
         LA    @01,@AL00001                                        0321 00628000
         BALR  @14,@15                                             0321 00629000
*                END;                                      /*@YL026UL*/ 00630000
*                                                                  0322 00631000
*        /************************************************************/ 00632000
*        /*                                                  @YL026UL*/ 00633000
*        /* ALLOCATE AND INITIALIZE SPACE FOR THE PRIMARY    @YL026UL*/ 00634000
*        /* FDT POINTER VECTOR (PRIMARY DATA POINTERS AND    @YL026UL*/ 00635000
*        /* VERB NAME).  IF INSUFFICIENT SPACE IS            @YL026UL*/ 00636000
*        /* AVAILABLE, DISCONTINUE PROCESSING.               @YL026UL*/ 00637000
*        /*                                                  @YL026UL*/ 00638000
*        /************************************************************/ 00639000
*        AMTTOGET=MAXID*PTRLNGTH+LENGTH(FDTVERB);          /*@YL026UL*/ 00640000
*                                                                  0323 00641000
@RF00318 DS    0H                                                  0323 00642000
@RC00278 L     @07,DESCPTR                                         0323 00643000
         LH    @07,MAXID(,@07)                                     0323 00644000
         SLA   @07,2                                               0323 00645000
         AL    @07,@CF00187                                        0323 00646000
         ST    @07,AMTTOGET                                        0323 00647000
*        CALL IDCSAGP0(GDTTBL,AMTTOGET,FDTADDR,SPACEID,            0324 00648000
*               SETZERO);                                  /*@YL026UL*/ 00649000
         ST    GDTPTR,@AL00001                                     0324 00650000
         LA    @07,AMTTOGET                                        0324 00651000
         ST    @07,@AL00001+4                                      0324 00652000
         L     @07,@PC00001+4                                      0324 00653000
         ST    @07,@AL00001+8                                      0324 00654000
         L     @07,@PC00001+8                                      0324 00655000
         ST    @07,@AL00001+12                                     0324 00656000
         LA    @07,SETZERO                                         0324 00657000
         ST    @07,@AL00001+16                                     0324 00658000
         MVI   @AL00001+16,X'80'                                   0324 00659000
         L     @15,GDTGPL(,GDTPTR)                                 0324 00660000
         LA    @01,@AL00001                                        0324 00661000
         BALR  @14,@15                                             0324 00662000
*        RESPECIFY RTNREG RSTD;                                    0325 00663000
*        TESTRC = RTNREG;                                          0326 00664000
         LR    TESTRC,RTNREG                                       0326 00665000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UL*/ 00666000
*                                                                  0327 00667000
*        /************************************************************/ 00668000
*        /*                                                  @Y30SSFR*/ 00669000
*        /*  IF STORAGE COULD NOT BE OBTAINED, CALL          @Y30SSFR*/ 00670000
*        /*  FAILSPAC TO HANDLE THE ERROR.                   @Y30SSFR*/ 00671000
*        /*                                                  @Y30SSFR*/ 00672000
*        /************************************************************/ 00673000
*        IF TESTRC ^= 0                                            0328 00674000
*          THEN                                                    0328 00675000
         LTR   TESTRC,TESTRC                                       0328 00676000
         BZ    @RF00328                                            0328 00677000
*            DO;                                           /*@YL026UL*/ 00678000
*                                                                  0329 00679000
*            CALL FAILSPAC;                                /*@YL026UL*/ 00680000
*                                                                  0330 00681000
         BAL   @14,FAILSPAC                                        0330 00682000
*            RETURN;                                       /*@YL026UL*/ 00683000
         B     @EL00002                                            0331 00684000
*            END;                                          /*@YL026UL*/ 00685000
*        FDTVERB=ECTPCMD;                                  /*@YL026UL*/ 00686000
*                                                                  0333 00687000
@RF00328 L     @07,@PC00001+4                                      0333 00688000
         L     @07,FDTADDR(,@07)                                   0333 00689000
         L     @05,ECTPTR(,GDTPTR)                                 0333 00690000
         MVC   FDTVERB(8,@07),ECTPCMD(@05)                         0333 00691000
*        /************************************************************/ 00692000
*        /*                                                  @YL026UL*/ 00693000
*        /* ALLOCATE AND INITIALIZE SPACE FOR REPEATED LIST  @YL026UL*/ 00694000
*        /* FDT COUNT VECTORS.  A REPEATED PARAMETER WITH A  @YL026UL*/ 00695000
*        /* REPEATED SUBLIST HAS SUCH A COUNT VECTOR.        @YL026UL*/ 00696000
*        /*                                                  @YL026UL*/ 00697000
*        /************************************************************/ 00698000
*DOLOOP3:DO PARMID=1 TO MAXID;                             /*@YL026UL*/ 00699000
DOLOOP3  LA    @07,1                                               0334 00700000
         B     @DE00334                                            0334 00701000
@DL00334 DS    0H                                                  0335 00702000
*          IF PARMPTR(PARMID)^=0 &                                 0335 00703000
*             REPEATED=YES & OCCURNUM > 1                          0335 00704000
*            THEN                                                  0335 00705000
         LR    @05,@07                                             0335 00706000
         MH    @05,@CH00038                                        0335 00707000
         L     @01,PINFOPTR                                        0335 00708000
         AL    @01,@CF01818                                        0335 00709000
         L     @05,PARMPTR(@05,@01)                                0335 00710000
         LTR   @05,@05                                             0335 00711000
         BZ    @RF00335                                            0335 00712000
         TM    REPEATED(@05),B'00100000'                           0335 00713000
         BNO   @RF00335                                            0335 00714000
         L     @05,OCCURNUM-1(,@05)                                0335 00715000
         LA    @05,0(,@05)                                         0335 00716000
         C     @05,@CF00227                                        0335 00717000
         BNH   @RF00335                                            0335 00718000
*              DO;                                         /*@YL026UL*/ 00719000
         ST    @05,@TF00001                                        0336 00720000
*              AMTTOGET=OCCURNUM*PTRLNGTH;                 /*@YL026UL*/ 00721000
*                                                                  0337 00722000
         L     @15,@TF00001                                        0337 00723000
         SLA   @15,2                                               0337 00724000
         ST    @15,AMTTOGET                                        0337 00725000
*              CALL IDCSAGP0(GDTTBL,AMTTOGET,FDTPTR(PARMID),       0338 00726000
*                     SPACEID,SETZERO);                    /*@YL026UL*/ 00727000
         ST    GDTPTR,@AL00001                                     0338 00728000
         LA    @15,AMTTOGET                                        0338 00729000
         ST    @15,@AL00001+4                                      0338 00730000
         SLA   @07,2                                               0338 00731000
         L     @15,@PC00001+4                                      0338 00732000
         L     @01,FDTADDR(,@15)                                   0338 00733000
         LA    @07,FDTPTR-4(@07,@01)                               0338 00734000
         ST    @07,@AL00001+8                                      0338 00735000
         L     @07,@PC00001+8                                      0338 00736000
         ST    @07,@AL00001+12                                     0338 00737000
         LA    @07,SETZERO                                         0338 00738000
         ST    @07,@AL00001+16                                     0338 00739000
         MVI   @AL00001+16,X'80'                                   0338 00740000
         L     @15,GDTGPL(,GDTPTR)                                 0338 00741000
         LA    @01,@AL00001                                        0338 00742000
         BALR  @14,@15                                             0338 00743000
*              RESPECIFY RTNREG RSTD;                              0339 00744000
*              TESTRC = RTNREG;                                    0340 00745000
         LR    TESTRC,RTNREG                                       0340 00746000
*              RESPECIFY RTNREG UNRSTD;                    /*@YL026UL*/ 00747000
*                                                                  0341 00748000
*              /******************************************************/ 00749000
*              /*                                            @Y30SSFR*/ 00750000
*              /*  IF STORAGE COULD NOT BE OBTAINED, CALL    @Y30SSFR*/ 00751000
*              /*  FAILSPAC TO HANDLE THE ERROR.             @Y30SSFR*/ 00752000
*              /*                                            @Y30SSFR*/ 00753000
*              /******************************************************/ 00754000
*              IF TESTRC ^= 0                                      0342 00755000
*                THEN                                              0342 00756000
         LTR   TESTRC,TESTRC                                       0342 00757000
         BZ    @RF00342                                            0342 00758000
*                  DO;                                     /*#YL026UL*/ 00759000
*                                                                  0343 00760000
*                  CALL FAILSPAC;                          /*#YL026UL*/ 00761000
*                                                                  0344 00762000
         BAL   @14,FAILSPAC                                        0344 00763000
*                  RETURN;                                 /*#YL026UL*/ 00764000
         B     @EL00002                                            0345 00765000
*                  END;                                    /*#YL026UL*/ 00766000
*                                                                  0346 00767000
*              END;                                        /*#YL026UL*/ 00768000
@RF00342 DS    0H                                                  0348 00769000
*        END DOLOOP3;                                      /*#YL026UL*/ 00770000
*                                                                  0348 00771000
@RF00335 LA    @07,1                                               0348 00772000
         AH    @07,PARMID                                          0348 00773000
@DE00334 STH   @07,PARMID                                          0348 00774000
         L     @05,DESCPTR                                         0348 00775000
         CH    @07,MAXID(,@05)                                     0348 00776000
         BNH   @DL00334                                            0348 00777000
*        /************************************************************/ 00778000
*        /*                                                  @YL026UL*/ 00779000
*        /* BUILD THE STATIC PART OF THE PARSE PARAMETER     @YL026UL*/ 00780000
*        /* LIST                                             @YL026UL*/ 00781000
*        /*                                                  @YL026UL*/ 00782000
*        /************************************************************/ 00783000
*        PPLPTR=ADDR(PPLAREA);                             /*@YL026UL*/ 00784000
         LA    @07,PPLAREA                                         0349 00785000
         ST    @07,PPLPTR                                          0349 00786000
*        PPLUPT=GDTUPT;                                    /*@YL026UL*/ 00787000
         L     @05,GDTUPT(,GDTPTR)                                 0350 00788000
         ST    @05,PPLUPT(,@07)                                    0350 00789000
*        PPLECT=GDTECT;                                    /*@YL026UL*/ 00790000
         L     @05,GDTECT(,GDTPTR)                                 0351 00791000
         ST    @05,PPLECT(,@07)                                    0351 00792000
*        PPLECB=ADDR(PARSECB);                             /*@YL026UL*/ 00793000
         LA    @05,PARSECB                                         0352 00794000
         ST    @05,PPLECB(,@07)                                    0352 00795000
*        PPLANS=ADDR(PDLPTR);                              /*@YL026UL*/ 00796000
         LA    @05,PDLPTR                                          0353 00797000
         ST    @05,PPLANS(,@07)                                    0353 00798000
*        PPLUWA=NULLPTR;                                   /*@YL026UL*/ 00799000
*                                                                  0354 00800000
*                                                                  0354 00801000
         SLR   @05,@05                                             0354 00802000
         ST    @05,PPLUWA(,@07)                                    0354 00803000
*        END RISETUP;                                      /*@YL026UL*/ 00804000
*                                                                  0355 00805000
         B     @EL00002                                            0355 00806000
*/********************************************************************/ 00807000
*/*                                                          @YL026UL*/ 00808000
*/*  PROCEDURE NAME - MAINSCAN                               @YL026UL*/ 00809000
*/*                                                          @YL026UL*/ 00810000
*/*  FUNCTION - THIS ROUTINE CONTROLS THE PROCESSING OF ALL  @YL026UL*/ 00811000
*/*             COMMAND PARAMETERS NOT APPEARING WITHIN      @YL026UL*/ 00812000
*/*             REPEATED SUBPARAMETER LISTS.  CONTROL IS     @YL026UL*/ 00813000
*/*             GIVEN TO ROUTINES WHICH PARSE THE PARMS,     @YL026UL*/ 00814000
*/*             TRANSLATE THE ENCODED PARMS FROM PDL FORM    @YL026UL*/ 00815000
*/*             INTO FDT FORM, AND CHECK FOR SEMANTIC ERRORS @YL026UL*/ 00816000
*/*                                                          @YL026UL*/ 00817000
*/*  INPUT -                                                 @YL026UL*/ 00818000
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/ 00819000
*/*            GDTCMD - POINTER TO INPUT COMMAND.            @YL026UL*/ 00820000
*/*                                                          @YL026UL*/ 00821000
*/*  OUTPUT -                                                @YL026UL*/ 00822000
*/*            FDT -    ENCODED DATA FOR PARAMETERS NOT      @YL026UL*/ 00823000
*/*                     APPEARING WITHIN REPEATED SUBPARM    @YL026UL*/ 00824000
*/*                     LISTS                                @YL026UL*/ 00825000
*/*            LASTCC -  AMS CONDITION CODE; SET TO A NON-   @YL026UL*/ 00826000
*/*                      ZERO VALUE IF PROCESSING OF THE     @YL026UL*/ 00827000
*/*                      COMMAND CANNOT CONTINUE.            @YL026UL*/ 00828000
*/*                                                          @YL026UL*/ 00829000
*/********************************************************************/ 00830000
*MAINSCAN:PROCEDURE;                                       /*@YL026UL*/ 00831000
MAINSCAN STM   @14,@02,@SA00003                                    0356 00832000
         STM   @05,@06,@SA00003+20                                 0356 00833000
         STM   @08,@12,@SA00003+28                                 0356 00834000
*        /************************************************************/ 00835000
*        /*                                                  @YL026UL*/ 00836000
*        /*  ** MAINSCAN **  PROCESS MAIN SET OF PARAMETERS  @YL026UL*/ 00837000
*        /*                                                  @YL026UL*/ 00838000
*        /************************************************************/ 00839000
*        OLDERID2 = NEWERID2;                                      0357 00840000
         L     @05,GDTTR2(,GDTPTR)                                 0357 00841000
         MVC   @TS00001(95),NEWERID2(@05)                          0357 00842000
         MVC   OLDERID2(95,@05),@TS00001                           0357 00843000
*        NEWID2='RI12';                                    /*@YL026UL*/ 00844000
*                                                                  0358 00845000
         MVC   NEWID2(4,@05),@CC01544                              0358 00846000
*        PRMSETID=0;                                       /*@YL026UL*/ 00847000
         SLR   @05,@05                                             0359 00848000
         STH   @05,PRMSETID                                        0359 00849000
*        SUPERID=0;                                        /*@YL026UL*/ 00850000
*                                                                  0360 00851000
         STH   @05,SUPERID                                         0360 00852000
*        /************************************************************/ 00853000
*        /*                                                  @YL026UL*/ 00854000
*        /* SET UP THE PARSE PARAMETER LIST IN PREPARATION   @YL026UL*/ 00855000
*        /* FOR PARSING ALL COMMAND PARAMETERS NOT WITHIN    @YL026UL*/ 00856000
*        /* REPEATED SUBLISTS.  THEN CALL THE TSO 'PARSE'    @YL026UL*/ 00857000
*        /* SERVICE ROUTINE TO ENCODE THE COMMAND INTO A PDL @YL026UL*/ 00858000
*        /*                                                  @YL026UL*/ 00859000
*        /************************************************************/ 00860000
*        PPLPCL=DESCPTR+PCLDSPL1;                          /*@YL026UL*/ 00861000
         L     @02,PPLPTR                                          0361 00862000
         L     @15,DESCPTR                                         0361 00863000
         LH    @14,PCLDSPL1(,@15)                                  0361 00864000
         ALR   @14,@15                                             0361 00865000
         ST    @14,PPLPCL(,@02)                                    0361 00866000
*        PPLCBUF=GDTCMB;                                   /*@YL026UL*/ 00867000
         L     @15,GDTCMB(,GDTPTR)                                 0362 00868000
         ST    @15,PPLCBUF(,@02)                                   0362 00869000
*        PARSECB=0;                                        /*@YL026UL*/ 00870000
*                                                                  0363 00871000
         ST    @05,PARSECB                                         0363 00872000
*        DO; /*CALLTSSR EP(IKJPARS)MF(E,PPL)*/                     0364 00873000
*          RESPECIFY GPR01P RSTD;                                  0365 00874000
*          GPR01P = ADDR(PPL);                                     0366 00875000
         LR    GPR01P,@02                                          0366 00876000
*          IF CVTPARS = 0                                          0367 00877000
*            THEN                                                  0367 00878000
         L     @02,CVTPTR                                          0367 00879000
         C     @05,CVTPARS(,@02)                                   0367 00880000
         BNE   @RF00367                                            0367 00881000
*              GEN(LINK EP=IKJPARS);                               0368 00882000
         LINK EP=IKJPARS                                                00883000
*            ELSE                                                  0369 00884000
*              CALL CVTPARS;                                       0369 00885000
         B     @RC00367                                            0369 00886000
@RF00367 L     @05,CVTPTR                                          0369 00887000
         L     @15,CVTPARS(,@05)                                   0369 00888000
         BALR  @14,@15                                             0369 00889000
*          RESPECIFY GPR01P UNRSTD;                                0370 00890000
@RC00367 DS    0H                                                  0371 00891000
*        END;                  /* @Z40GSJG*/                       0371 00892000
*                                                                  0371 00893000
*        RESPECIFY RTNREG RSTD;                                    0372 00894000
*        TESTRC = RTNREG;                                          0373 00895000
         LR    TESTRC,RTNREG                                       0373 00896000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UL*/ 00897000
*                                                                  0374 00898000
*        /************************************************************/ 00899000
*        /*                                                  @YL026UL*/ 00900000
*        /* CHECK THE RETURN CODE FROM 'PARSE'.  IF PARSING  @YL026UL*/ 00901000
*        /* WAS NOT SUCCESSFUL, DISCONTINUE PROCESSING.      @YL026UL*/ 00902000
*        /*                                                  @YL026UL*/ 00903000
*        /************************************************************/ 00904000
*        IF TESTRC^=0                                              0375 00905000
*          THEN                                                    0375 00906000
         LTR   TESTRC,TESTRC                                       0375 00907000
         BZ    @RF00375                                            0375 00908000
*            DO;                                           /*@YL026UL*/ 00909000
*            IF TESTRC=BADSPACE                                    0377 00910000
*              THEN                                                0377 00911000
*                                                                  0377 00912000
         C     TESTRC,@CF00487                                     0377 00913000
         BNE   @RF00377                                            0377 00914000
*                CALL FAILSPAC;                            /*@YL026UL*/ 00915000
*                                                                  0378 00916000
         BAL   @14,FAILSPAC                                        0378 00917000
*              ELSE                                                0379 00918000
*                LASTCC=LASTCC12;                          /*@YL026UL*/ 00919000
         B     @RC00377                                            0379 00920000
@RF00377 L     @05,@PC00001+16                                     0379 00921000
         MVC   LASTCC(2,@05),@CH00038                              0379 00922000
*            RETURN;                                       /*@YL026UL*/ 00923000
@EL00003 DS    0H                                                  0380 00924000
@EF00003 DS    0H                                                  0380 00925000
@ER00003 LM    @14,@02,@SA00003                                    0380 00926000
         LM    @05,@06,@SA00003+20                                 0380 00927000
         LM    @08,@12,@SA00003+28                                 0380 00928000
         BR    @14                                                 0380 00929000
*            END;                                          /*@YL026UL*/ 00930000
*                                                                  0381 00931000
*        /************************************************************/ 00932000
*        /*                                                  @YL026UL*/ 00933000
*        /* TRANSLATE THE ENCODED PARAMETERS FROM PDL FORM   @YL026UL*/ 00934000
*        /* INTO FDT FORM, CHECKING FOR SEMANTIC ERRORS THAT @YL026UL*/ 00935000
*        /* MAY EXIST IN CONSTANTS THAT WERE CODED           @YL026UL*/ 00936000
*        /*                                                  @YL026UL*/ 00937000
*        /************************************************************/ 00938000
*        PROMPT=NO;                                        /*@YL026UL*/ 00939000
@RF00375 DS    0H                                                  0383 00940000
*        SINGLPRM=NO;                                      /*@YL026UL*/ 00941000
*                                                                  0383 00942000
         NI    PROMPT,B'00111111'                                  0383 00943000
*        CALL TRNSLATE;                                    /*@YL026UL*/ 00944000
*                                                                  0384 00945000
         BAL   @14,TRNSLATE                                        0384 00946000
*        IF LASTCC^=0                                              0385 00947000
*          THEN                                                    0385 00948000
         L     @05,@PC00001+16                                     0385 00949000
         LH    @05,LASTCC(,@05)                                    0385 00950000
         LTR   @05,@05                                             0385 00951000
         BNZ   @RT00385                                            0385 00952000
*            RETURN;                                       /*@YL026UL*/ 00953000
*                                                                  0386 00954000
*        /************************************************************/ 00955000
*        /*                                                  @YL026UL*/ 00956000
*        /* CHECK FOR CONFLICTING PARAMETERS, APPLY DEFAULT  @YL026UL*/ 00957000
*        /* PARAMETERS, AND PROMPT FOR MISSING PARAMETERS.   @YL026UL*/ 00958000
*        /*                                                  @YL026UL*/ 00959000
*        /************************************************************/ 00960000
*        GOODCMD=NO;                                       /*@YL026UL*/ 00961000
         NI    GOODCMD,B'11101111'                                 0387 00962000
*        DO WHILE(GOODCMD=NO & LASTCC=0);                  /*@YL026UL*/ 00963000
*                                                                  0388 00964000
         B     @DE00388                                            0388 00965000
@DL00388 DS    0H                                                  0389 00966000
*          CALL NOTPARMS;                                  /*@YL026UL*/ 00967000
*                                                                  0389 00968000
         BAL   @14,NOTPARMS                                        0389 00969000
*          IF LASTCC=0                                             0390 00970000
*            THEN                                                  0390 00971000
*                                                                  0390 00972000
         L     @05,@PC00001+16                                     0390 00973000
         LH    @05,LASTCC(,@05)                                    0390 00974000
         LTR   @05,@05                                             0390 00975000
         BNZ   @RF00390                                            0390 00976000
*              CALL DEFAULTS;                              /*@YL026UL*/ 00977000
*                                                                  0391 00978000
         BAL   @14,DEFAULTS                                        0391 00979000
*          IF LASTCC=0                                             0392 00980000
*            THEN                                                  0392 00981000
*                                                                  0392 00982000
@RF00390 L     @05,@PC00001+16                                     0392 00983000
         LH    @05,LASTCC(,@05)                                    0392 00984000
         LTR   @05,@05                                             0392 00985000
         BNZ   @RF00392                                            0392 00986000
*              CALL NEEDPRMS;                              /*@YL026UL*/ 00987000
*                                                                  0393 00988000
         BAL   @14,NEEDPRMS                                        0393 00989000
*            /********************************************************/ 00990000
*            /*                                              @Y30SSFR*/ 00991000
*            /*  RETURN TO THE TOPLEVEL OF RI04 IF A LOWER   @Y30SSFR*/ 00992000
*            /*  LEVEL PROCEDURE HAS FOUND AN ERROR.         @Y30SSFR*/ 00993000
*            /*                                              @Y30SSFR*/ 00994000
*            /********************************************************/ 00995000
*            ELSE                                                  0394 00996000
*              RETURN;                                     /*@YL026UL*/ 00997000
*                                                                  0394 00998000
*        END;                                              /*@YL026UL*/ 00999000
*                                                                  0395 01000000
*                                                                  0395 01001000
@DE00388 TM    GOODCMD,B'00010000'                                 0395 01002000
         BNZ   @DC00388                                            0395 01003000
         L     @05,@PC00001+16                                     0395 01004000
         LH    @05,LASTCC(,@05)                                    0395 01005000
         LTR   @05,@05                                             0395 01006000
         BZ    @DL00388                                            0395 01007000
@DC00388 DS    0H                                                  0396 01008000
*        END MAINSCAN;                                     /*@YL026UL*/ 01009000
*                                                                  0396 01010000
         B     @EL00003                                            0396 01011000
*/********************************************************************/ 01012000
*/*                                                          @YL026UL*/ 01013000
*/*  PROCEDURE NAME - SUBSCAN                                @YL026UL*/ 01014000
*/*                                                          @YL026UL*/ 01015000
*/*  FUNCTION - THIS ROUTINE CONTROLS THE PROCESSING OF ALL  @YL026UL*/ 01016000
*/*             COMMAND PARAMETERS APPEARING WITHIN A SINGLE @YL026UL*/ 01017000
*/*             REPEATED SUBPARAMETER LIST.  CONTROL IS      @YL026UL*/ 01018000
*/*             GIVEN TO ROUTINES WHICH PARSE THE PARMS,     @YL026UL*/ 01019000
*/*             TRANSLATE THE ENCODED PARMS FROM PDL FORM    @YL026UL*/ 01020000
*/*             INTO FDT FORM, AND CHECK FOR SEMANTIC ERRORS @YL026UL*/ 01021000
*/*                                                          @YL026UL*/ 01022000
*/*  INPUT -                                                 @YL026UL*/ 01023000
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/ 01024000
*/*            RSI -     REPEATED SUBLIST INDEX.             @YL026UL*/ 01025000
*/*            REPINDEX- INDEX POINTING TO THE RSI ENTRY     @YL026UL*/ 01026000
*/*                      DESCRIBING THE SUBLIST TO BE        @YL026UL*/ 01027000
*/*                      PROCESSED.                          @YL026UL*/ 01028000
*/*                                                          @YL026UL*/ 01029000
*/*  OUTPUT -                                                @YL026UL*/ 01030000
*/*            FDT -     ENCODED DATA FOR PARAMETERS THAT    @YL026UL*/ 01031000
*/*                      WERE CODED WITHIN A REPETITION OF   @YL026UL*/ 01032000
*/*                      A REPEATED SUBPARAMETER LIST.       @YL026UL*/ 01033000
*/*            LASTCC -  AMS CONDITION CODE; SET TO A NON-   @YL026UL*/ 01034000
*/*                      ZERO VALUE IF PROCESSING OF THE     @YL026UL*/ 01035000
*/*                      COMMAND CANNOT CONTINUE.            @YL026UL*/ 01036000
*/*                                                          @YL026UL*/ 01037000
*/********************************************************************/ 01038000
*SUBSCAN:PROCEDURE;                                        /*@YL026UL*/ 01039000
SUBSCAN  STM   @14,@02,@SA00004                                    0397 01040000
         STM   @05,@06,@SA00004+20                                 0397 01041000
         STM   @08,@12,@SA00004+28                                 0397 01042000
*        /************************************************************/ 01043000
*        /*                                                  @YL026UL*/ 01044000
*        /*  ** SUBSCAN **  PROCESS REP'D SUBLIST PARAMETERS @YL026UL*/ 01045000
*        /*                                                  @YL026UL*/ 01046000
*        /************************************************************/ 01047000
*        OLDERID2 = NEWERID2;                                      0398 01048000
         L     @02,GDTTR2(,GDTPTR)                                 0398 01049000
         MVC   @TS00001(95),NEWERID2(@02)                          0398 01050000
         MVC   OLDERID2(95,@02),@TS00001                           0398 01051000
*        NEWID2='RI14';                                    /*@YL026UL*/ 01052000
*                                                                  0399 01053000
         MVC   NEWID2(4,@02),@CC01552                              0399 01054000
*        /************************************************************/ 01055000
*        /*                                                  @YL026UL*/ 01056000
*        /* OBTAIN THE ID# OF THE PARAMETER WHOSE REPEATED   @YL026UL*/ 01057000
*        /* SUBLIST REPETITION IS TO BE PROCESSED NEXT.      @YL026UL*/ 01058000
*        /*                                                  @YL026UL*/ 01059000
*        /************************************************************/ 01060000
*        PRMSETID=SBLSTID(REPINDEX);                       /*@YL026UL*/ 01061000
         L     @02,RSIPTR                                          0400 01062000
         LA    @15,12                                              0400 01063000
         LR    @14,@15                                             0400 01064000
         MH    @14,REPINDEX                                        0400 01065000
         LA    @01,0(@14,@02)                                      0400 01066000
         AL    @01,@CF01821                                        0400 01067000
         LH    @01,SBLSTID-6(,@01)                                 0400 01068000
         STH   @01,PRMSETID                                        0400 01069000
*        SUPERID=PRMSETID;                                 /*@YL026UL*/ 01070000
         STH   @01,SUPERID                                         0401 01071000
*        PARMID=SUPERID;                                   /*@YL026UL*/ 01072000
*                                                                  0402 01073000
         STH   @01,PARMID                                          0402 01074000
*        /************************************************************/ 01075000
*        /*                                                  @YL026UL*/ 01076000
*        /* SET UP THE PARSE PARM LIST IN PREPARATION FOR    @YL026UL*/ 01077000
*        /* PROCESSING THE PARMS OF THE SUBLIST REPETITION.  @YL026UL*/ 01078000
*        /* OBTAIN SPACE FOR A COMMAND BUFFER IN WHICH TO    @YL026UL*/ 01079000
*        /* PUT THE SUBPARAMETERS TO BE PARSED.              @YL026UL*/ 01080000
*        /*                                                  @YL026UL*/ 01081000
*        /************************************************************/ 01082000
*        PPLPCL=DESCPTR+PCLDSPL2;                          /*@YL026UL*/ 01083000
         MR    @00,@15                                             0403 01084000
         L     @02,PINFOPTR                                        0403 01085000
         AL    @02,@CF01818                                        0403 01086000
         AL    @15,PARMPTR(@01,@02)                                0403 01087000
         LH    @02,PCLDSPL2(,@15)                                  0403 01088000
         N     @02,@CF01822                                        0403 01089000
         AL    @02,DESCPTR                                         0403 01090000
         L     @01,PPLPTR                                          0403 01091000
         ST    @02,PPLPCL(,@01)                                    0403 01092000
*        PARSECB=0;                                        /*@YL026UL*/ 01093000
         SLR   @02,@02                                             0404 01094000
         ST    @02,PARSECB                                         0404 01095000
*        AMTTOGET=SBLSTLEN(REPINDEX)+2*LENGTH(PSETLEN)+1;  /*@YL026UL*/ 01096000
*                                                                  0405 01097000
         L     @02,RSIPTR                                          0405 01098000
         LA    @15,5                                               0405 01099000
         AL    @02,@CF01817                                        0405 01100000
         AH    @15,SBLSTLEN-4(@14,@02)                             0405 01101000
         ST    @15,AMTTOGET                                        0405 01102000
*        CALL IDCSAGP0(GDTTBL,AMTTOGET,BUFFPTR ,                   0406 01103000
*               SPACEID,SETZERO);                          /*@YL026UL*/ 01104000
         ST    GDTPTR,@AL00001                                     0406 01105000
         LA    @02,AMTTOGET                                        0406 01106000
         ST    @02,@AL00001+4                                      0406 01107000
         LA    @02,BUFFPTR                                         0406 01108000
         ST    @02,@AL00001+8                                      0406 01109000
         L     @02,@PC00001+8                                      0406 01110000
         ST    @02,@AL00001+12                                     0406 01111000
         LA    @02,SETZERO                                         0406 01112000
         ST    @02,@AL00001+16                                     0406 01113000
         MVI   @AL00001+16,X'80'                                   0406 01114000
         L     @15,GDTGPL(,GDTPTR)                                 0406 01115000
         LA    @01,@AL00001                                        0406 01116000
         BALR  @14,@15                                             0406 01117000
*        RESPECIFY RTNREG RSTD;                                    0407 01118000
*        TESTRC = RTNREG;                                          0408 01119000
         LR    TESTRC,RTNREG                                       0408 01120000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UL*/ 01121000
*                                                                  0409 01122000
*        IF TESTRC^=0                                              0410 01123000
*          THEN                                                    0410 01124000
         LTR   TESTRC,TESTRC                                       0410 01125000
         BZ    @RF00410                                            0410 01126000
*            DO;                                           /*@YL026UL*/ 01127000
*                                                                  0411 01128000
*            CALL FAILSPAC;                                /*@YL026UL*/ 01129000
*                                                                  0412 01130000
         BAL   @14,FAILSPAC                                        0412 01131000
*            RETURN;                                       /*@YL026UL*/ 01132000
@EL00004 DS    0H                                                  0413 01133000
@EF00004 DS    0H                                                  0413 01134000
@ER00004 LM    @14,@02,@SA00004                                    0413 01135000
         LM    @05,@06,@SA00004+20                                 0413 01136000
         LM    @08,@12,@SA00004+28                                 0413 01137000
         BR    @14                                                 0413 01138000
*            END;                                          /*@YL026UL*/ 01139000
*                                                                  0414 01140000
*          ELSE                                                    0415 01141000
*            PPLCBUF=BUFFPTR ;                             /*@YL026UL*/ 01142000
*                                                                  0415 01143000
@RF00410 L     @05,BUFFPTR                                         0415 01144000
         L     @02,PPLPTR                                          0415 01145000
         ST    @05,PPLCBUF(,@02)                                   0415 01146000
*        /************************************************************/ 01147000
*        /*                                                  @YL026UL*/ 01148000
*        /* MOVE THE PARAMETERS OF THE SUBLIST REPETITION    @YL026UL*/ 01149000
*        /* FROM THE ORIGINAL COMMAND OR PROMPT RESPONSE     @YL026UL*/ 01150000
*        /* BUFFER INTO THE PARSE BUFFER.  IF EACH REP IS    @YL026UL*/ 01151000
*        /* DEFINED TO BE JUST A SIMPLE LIST OF CONSTANTS,   @YL026UL*/ 01152000
*        /* INSERT A LEFT PARENTHESIS PRECEDING THE PARM SET @YL026UL*/ 01153000
*        /*                                                  @YL026UL*/ 01154000
*        /************************************************************/ 01155000
*        IF SUBCOUNT=1 & PARMTYPE(1)='P ' &                        0416 01156000
*           PARMPTR(SUBID(1))->LIST=YES                            0416 01157000
*          THEN                                                    0416 01158000
         LA    @02,1                                               0416 01159000
         L     @15,PINFOPTR                                        0416 01160000
         LA    @14,12                                              0416 01161000
         LR    @01,@14                                             0416 01162000
         MH    @01,PARMID                                          0416 01163000
         AL    @01,@CF01818                                        0416 01164000
         L     @01,PARMPTR(@01,@15)                                0416 01165000
         LR    @00,@01                                             0416 01166000
         ALR   @00,@14                                             0416 01167000
         LR    @05,@00                                             0416 01168000
         SLR   @00,@00                                             0416 01169000
         IC    @00,SUBDSPL(,@05)                                   0416 01170000
         ALR   @00,@00                                             0416 01171000
         ALR   @01,@00                                             0416 01172000
         CH    @02,SUBCOUNT(,@01)                                  0416 01173000
         BNE   @RF00416                                            0416 01174000
         CLC   PARMTYPE(2,@01),@CC01553                            0416 01175000
         BNE   @RF00416                                            0416 01176000
         LR    @05,@14                                             0416 01177000
         MH    @05,SUBID(,@01)                                     0416 01178000
         AL    @15,@CF01818                                        0416 01179000
         L     @05,PARMPTR(@05,@15)                                0416 01180000
         TM    LIST(@05),B'00001000'                               0416 01181000
         BNO   @RF00416                                            0416 01182000
*            DO;                                           /*@YL026UL*/ 01183000
*            PSETLEN=SBLSTLEN(REPINDEX)+1;                 /*@YL026UL*/ 01184000
         L     @05,BUFFPTR                                         0418 01185000
         L     @15,RSIPTR                                          0418 01186000
         MH    @14,REPINDEX                                        0418 01187000
         LA    @01,0(@14,@15)                                      0418 01188000
         AL    @01,@CF01817                                        0418 01189000
         AH    @02,SBLSTLEN-4(,@01)                                0418 01190000
         STH   @02,PSETLEN(,@05)                                   0418 01191000
*            PARMSET(1)=PAREN;                             /*@YL026UL*/ 01192000
         MVI   PARMSET(@05),C'('                                   0419 01193000
*            PARMSET(2:PSETLEN)=SBLSTPTR(REPINDEX)->               0420 01194000
*                               DATABLK(1:PSETLEN-1);      /*@YL026UL*/ 01195000
         BCTR  @02,0                                               0420 01196000
         BCTR  @02,0                                               0420 01197000
         AL    @15,@CF01818                                        0420 01198000
         L     @01,SBLSTPTR(@14,@15)                               0420 01199000
         EX    @02,@SM01823                                        0420 01200000
*            END;                                          /*@YL026UL*/ 01201000
*          ELSE                                                    0422 01202000
*            DO;                                           /*@YL026UL*/ 01203000
         B     @RC00416                                            0422 01204000
@RF00416 DS    0H                                                  0423 01205000
*            PSETLEN=SBLSTLEN(REPINDEX);                   /*@YL026UL*/ 01206000
         L     @05,BUFFPTR                                         0423 01207000
         L     @02,RSIPTR                                          0423 01208000
         LH    @15,REPINDEX                                        0423 01209000
         MH    @15,@CH00038                                        0423 01210000
         LA    @01,0(@15,@02)                                      0423 01211000
         AL    @01,@CF01817                                        0423 01212000
         LH    @14,SBLSTLEN-4(,@01)                                0423 01213000
         STH   @14,PSETLEN(,@05)                                   0423 01214000
*            PARMSET(1:PSETLEN)=SBLSTPTR(REPINDEX)->               0424 01215000
*                               DATABLK(1:PSETLEN);        /*@YL026UL*/ 01216000
         BCTR  @14,0                                               0424 01217000
         AL    @02,@CF01818                                        0424 01218000
         L     @02,SBLSTPTR(@15,@02)                               0424 01219000
         EX    @14,@SM01825                                        0424 01220000
*            END;                                          /*@YL026UL*/ 01221000
*        PSETLEN=PSETLEN+LENGTH(CBUFF);                    /*@YL026UL*/ 01222000
*                                                                  0426 01223000
@RC00416 L     @05,BUFFPTR                                         0426 01224000
         LA    @02,4                                               0426 01225000
         AH    @02,PSETLEN(,@05)                                   0426 01226000
         STH   @02,PSETLEN(,@05)                                   0426 01227000
*        /************************************************************/ 01228000
*        /*                                                  @YL026UL*/ 01229000
*        /* CALL 'PARSE' TO ENCODE THE PARAMETERS.  IF       @YL026UL*/ 01230000
*        /* 'PARSE' IS UNSUCCESSFUL, DISCONTINUE PROCESSING. @YL026UL*/ 01231000
*        /*                                                  @YL026UL*/ 01232000
*        /************************************************************/ 01233000
*                                                                  0427 01234000
*        DO; /*CALLTSSR EP(IKJPARS)MF(E,PPL)*/                     0427 01235000
*          RESPECIFY GPR01P RSTD;                                  0428 01236000
*          GPR01P = ADDR(PPL);                                     0429 01237000
         L     GPR01P,PPLPTR                                       0429 01238000
*          IF CVTPARS = 0                                          0430 01239000
*            THEN                                                  0430 01240000
         L     @05,CVTPTR                                          0430 01241000
         L     @05,CVTPARS(,@05)                                   0430 01242000
         LTR   @05,@05                                             0430 01243000
         BNZ   @RF00430                                            0430 01244000
*              GEN(LINK EP=IKJPARS);                               0431 01245000
         LINK EP=IKJPARS                                                01246000
*            ELSE                                                  0432 01247000
*              CALL CVTPARS;                                       0432 01248000
         B     @RC00430                                            0432 01249000
@RF00430 L     @05,CVTPTR                                          0432 01250000
         L     @15,CVTPARS(,@05)                                   0432 01251000
         BALR  @14,@15                                             0432 01252000
*          RESPECIFY GPR01P UNRSTD;                                0433 01253000
@RC00430 DS    0H                                                  0434 01254000
*        END;                   /*@Z40GSJG*/                       0434 01255000
*                                                                  0434 01256000
*        RESPECIFY RTNREG RSTD;                                    0435 01257000
*        TESTRC = RTNREG;                                          0436 01258000
         LR    TESTRC,RTNREG                                       0436 01259000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UL*/ 01260000
*                                                                  0437 01261000
*        IF TESTRC^=0                                              0438 01262000
*          THEN                                                    0438 01263000
         LTR   TESTRC,TESTRC                                       0438 01264000
         BZ    @RF00438                                            0438 01265000
*            DO;                                           /*@YL026UL*/ 01266000
*            IF TESTRC=BADSPACE                                    0440 01267000
*              THEN                                                0440 01268000
*                                                                  0440 01269000
         C     TESTRC,@CF00487                                     0440 01270000
         BNE   @RF00440                                            0440 01271000
*                CALL FAILSPAC;                            /*@YL026UL*/ 01272000
*                                                                  0441 01273000
         BAL   @14,FAILSPAC                                        0441 01274000
*              ELSE                                                0442 01275000
*                LASTCC=LASTCC12;                          /*@YL026UL*/ 01276000
         B     @RC00440                                            0442 01277000
@RF00440 L     @05,@PC00001+16                                     0442 01278000
         MVC   LASTCC(2,@05),@CH00038                              0442 01279000
*            RETURN;                                       /*@YL026UL*/ 01280000
         B     @EL00004                                            0443 01281000
*            END;                                          /*@YL026UL*/ 01282000
*                                                                  0444 01283000
*        /************************************************************/ 01284000
*        /*                                                  @YL026UL*/ 01285000
*        /* RESET THE PARAMETER OCCURRENCE FLAGS TO ZEROS.   @YL026UL*/ 01286000
*        /* THEN TRANSLATE THE ENCODED PARAMETERS FROM PDL   @YL026UL*/ 01287000
*        /* FORM INTO FDT FORM, CHECKING FOR SEMANTIC ERRORS @YL026UL*/ 01288000
*        /* THAT MAY EXIST IN THE CONSTANTS THAT WERE CODED  @YL026UL*/ 01289000
*        /*                                                  @YL026UL*/ 01290000
*        /************************************************************/ 01291000
*        DO INDEX2=1 TO MAXID;                             /*@YL026UL*/ 01292000
@RF00438 LA    INDEX2,1                                            0445 01293000
         B     @DE00445                                            0445 01294000
@DL00445 DS    0H                                                  0446 01295000
*          PARMFLAG(INDEX2)=0;                             /*@YL026UL*/ 01296000
         LR    @05,INDEX2                                          0446 01297000
         MH    @05,@CH00038                                        0446 01298000
         SLR   @15,@15                                             0446 01299000
         L     @14,PINFOPTR                                        0446 01300000
         BCTR  @14,0                                               0446 01301000
         BCTR  @14,0                                               0446 01302000
         STC   @15,PARMFLAG-10(@05,@14)                            0446 01303000
*        END;                                              /*@YL026UL*/ 01304000
         AL    INDEX2,@CF00227                                     0447 01305000
@DE00445 L     @05,DESCPTR                                         0447 01306000
         CH    INDEX2,MAXID(,@05)                                  0447 01307000
         BNH   @DL00445                                            0447 01308000
*        PROMPT=NO;                                        /*@YL026UL*/ 01309000
*        SINGLPRM=NO;                                      /*@YL026UL*/ 01310000
*                                                                  0449 01311000
         NI    PROMPT,B'00111111'                                  0449 01312000
*        CALL TRNSLATE;                                    /*@YL026UL*/ 01313000
*                                                                  0450 01314000
         BAL   @14,TRNSLATE                                        0450 01315000
*        IF LASTCC^=0                                              0451 01316000
*          THEN                                                    0451 01317000
         L     @05,@PC00001+16                                     0451 01318000
         LH    @05,LASTCC(,@05)                                    0451 01319000
         LTR   @05,@05                                             0451 01320000
         BNZ   @RT00451                                            0451 01321000
*            RETURN;                                       /*@YL026UL*/ 01322000
*                                                                  0452 01323000
*        /************************************************************/ 01324000
*        /*                                                  @YL026UL*/ 01325000
*        /* CHECK FOR CONFLICTING PARAMETERS, APPLY DEFAULT  @YL026UL*/ 01326000
*        /* PARAMETERS, AND PROMPT FOR MISSING PARAMETERS.   @YL026UL*/ 01327000
*        /* PERFORM THESE FUNCTIONS ONLY UPON PARMS DEFINED  @YL026UL*/ 01328000
*        /* AS PART OF THE CURRENT REPEATED SUBLIST PARM SET @YL026UL*/ 01329000
*        /*                                                  @YL026UL*/ 01330000
*        /************************************************************/ 01331000
*        GOODCMD=NO;                                       /*@YL026UL*/ 01332000
         NI    GOODCMD,B'11101111'                                 0453 01333000
*        DO WHILE(GOODCMD=NO & LASTCC=0);                  /*@YL026UL*/ 01334000
*                                                                  0454 01335000
         B     @DE00454                                            0454 01336000
@DL00454 DS    0H                                                  0455 01337000
*          /**********************************************************/ 01338000
*          /*                                                @Y30SSFR*/ 01339000
*          /*  CALL NOTPARMS TO CHECK FOR ANY CONFLICTING    @Y30SSFR*/ 01340000
*          /*  PARAMTETERS.                                  @Y30SSFR*/ 01341000
*          /*                                                @Y30SSFR*/ 01342000
*          /**********************************************************/ 01343000
*          CALL NOTPARMS;                                  /*@YL026UL*/ 01344000
*                                                                  0455 01345000
         BAL   @14,NOTPARMS                                        0455 01346000
*          /**********************************************************/ 01347000
*          /*                                                @Y30SSFR*/ 01348000
*          /*  IF NOTPARMS COMPLETES SUCCESSFULLY, CALL      @Y30SSFR*/ 01349000
*          /*  DEFAULTS TO SET UP THE DEFAULTED PARAMETERS.  @Y30SSFR*/ 01350000
*          /*                                                @Y30SSFR*/ 01351000
*          /**********************************************************/ 01352000
*          IF LASTCC=0                                             0456 01353000
*            THEN                                                  0456 01354000
*                                                                  0456 01355000
         L     @05,@PC00001+16                                     0456 01356000
         LH    @05,LASTCC(,@05)                                    0456 01357000
         LTR   @05,@05                                             0456 01358000
         BNZ   @RF00456                                            0456 01359000
*              CALL DEFAULTS;                              /*@YL026UL*/ 01360000
*                                                                  0457 01361000
         BAL   @14,DEFAULTS                                        0457 01362000
*          /**********************************************************/ 01363000
*          /*                                                @Y30SSFR*/ 01364000
*          /*  IF DEFAULTS COMPLETES SUCCESSFULLY, CALL      @Y30SSFR*/ 01365000
*          /*  NEEDPARMS TO PROMPT FOR ANY MISSING, BUT      @Y30SSFR*/ 01366000
*          /*  REQUIRED PARAMETERS.                          @Y30SSFR*/ 01367000
*          /*                                                @Y30SSFR*/ 01368000
*          /**********************************************************/ 01369000
*          IF LASTCC=0                                             0458 01370000
*            THEN                                                  0458 01371000
*                                                                  0458 01372000
@RF00456 L     @05,@PC00001+16                                     0458 01373000
         LH    @05,LASTCC(,@05)                                    0458 01374000
         LTR   @05,@05                                             0458 01375000
         BNZ   @RF00458                                            0458 01376000
*              CALL NEEDPRMS;                              /*@YL026UL*/ 01377000
*                                                                  0459 01378000
         BAL   @14,NEEDPRMS                                        0459 01379000
*            /********************************************************/ 01380000
*            /*                                              @Y30SSFR*/ 01381000
*            /*  ONE OF NOTPARMS, DEFAULTS, OR NEEDPARMS     @Y30SSFR*/ 01382000
*            /*  HAS FAILED.  RETURN TO THE CALLER OF        @Y30SSFR*/ 01383000
*            /*  SUBSCAN.                                    @Y30SSFR*/ 01384000
*            /*                                              @Y30SSFR*/ 01385000
*            /********************************************************/ 01386000
*            ELSE                                                  0460 01387000
*              RETURN;                                     /*#YL026UL*/ 01388000
*        END;                                              /*@YL026UL*/ 01389000
*                                                                  0461 01390000
*                                                                  0461 01391000
@DE00454 TM    GOODCMD,B'00010000'                                 0461 01392000
         BNZ   @DC00454                                            0461 01393000
         L     @05,@PC00001+16                                     0461 01394000
         LH    @05,LASTCC(,@05)                                    0461 01395000
         LTR   @05,@05                                             0461 01396000
         BZ    @DL00454                                            0461 01397000
@DC00454 DS    0H                                                  0462 01398000
*        END SUBSCAN;                                      /*@YL026UL*/ 01399000
*                                                                  0462 01400000
         B     @EL00004                                            0462 01401000
*/********************************************************************/ 01402000
*/*                                                          @YL026UL*/ 01403000
*/*  PROCEDURE NAME - TRNSLATE                               @YL026UL*/ 01404000
*/*                                                          @YL026UL*/ 01405000
*/*  FUNCTION - THIS ROUTINE CONTROLS THE TRANSLATION OF ALL @YL026UL*/ 01406000
*/*             INPUT PARAMETERS FROM THE ENCODED PDL FORM   @YL026UL*/ 01407000
*/*             INTO THE ENCODED FDT FORM.  'TRNSLATE' USES  @YL026UL*/ 01408000
*/*             THE ID# OF THE 'CURRENT' SUPERPARAMETER TO   @YL026UL*/ 01409000
*/*             DETERMINE THE SET OF PARAMETERS WHICH MAY BE @YL026UL*/ 01410000
*/*             ENCODED IN THE PDL TO BE TRANSLATED DURING   @YL026UL*/ 01411000
*/*             THE CURRENT INVOCATION.  PARAMETERS FOUND TO @YL026UL*/ 01412000
*/*             BE INPUT AND ENCODED IN THE PDL ARE CHECKED  @YL026UL*/ 01413000
*/*             TO SEE IF THEY HAVE A REPEATED SUBLIST--IF   @YL026UL*/ 01414000
*/*             SO, SUBLIST INFORMATION IS SAVED IN ORDER TO @YL026UL*/ 01415000
*/*             LATER PROCESS THE SUBLIST.  IF NOT A SUBLIST @YL026UL*/ 01416000
*/*             THEN THE DATA IS ENCODED INTO THE FDT.       @YL026UL*/ 01417000
*/*                                                          @YL026UL*/ 01418000
*/*  INPUT -                                                 @YL026UL*/ 01419000
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/ 01420000
*/*            SINGLPRM- FLAG SET 'ON' WHEN JUST A SINGLE    @YL026UL*/ 01421000
*/*                      PARM IS TO BE TRANSLATED FROM PDL   @YL026UL*/ 01422000
*/*                      FORM INTO FDT FORM.                 @YL026UL*/ 01423000
*/*            PDLPTR -  POINTER TO THE PDL CONTAINING THE   @YL026UL*/ 01424000
*/*                      PARSE-ENCODED DATA TO BE TRANSLATED @YL026UL*/ 01425000
*/*                      INTO FDT FORM.                      @YL026UL*/ 01426000
*/*            PARMPTR - POINTER TO DESCRIPTOR SECTION THAT  @YL026UL*/ 01427000
*/*                      DESCRIBES THE PARM CURRENTLY BEING  @YL026UL*/ 01428000
*/*                      TRANSLATED (FROM 'PARMINFO')        @YL026UL*/ 01429000
*/*            SUPRPARM- PARM ID# OF THE SUPERPARAMETER OF   @YL026UL*/ 01430000
*/*                      THE PARM CURRENTLY BEING EXAMINED   @YL026UL*/ 01431000
*/*                      (FROM 'PARMINFO')                   @YL026UL*/ 01432000
*/*                                                          @YL026UL*/ 01433000
*/*  OUTPUT -                                                @YL026UL*/ 01434000
*/*            PARMFLAG- CODE INDICATING IF A PARAMETER MAY  @YL026UL*/ 01435000
*/*                      BE INPUT OR ACTUALLY IS INPUT       @YL026UL*/ 01436000
*/*                      (FROM 'PARMINFO')                   @YL026UL*/ 01437000
*/*            LASTCC -  AMS CONDITION CODE; SET TO A NON-   @YL026UL*/ 01438000
*/*                      ZERO VALUE IF PROCESSING OF THE     @YL026UL*/ 01439000
*/*                      COMMAND CANNOT CONTINUE.            @YL026UL*/ 01440000
*/*            FDT -     FUNCTION DATA TABLE ENTRIES FOR     @YL026UL*/ 01441000
*/*                      KEYWORDS WHICH HAVE BEEN INPUT AND  @YL026UL*/ 01442000
*/*                      WHICH HAVE NO SUBFIELDS.            @YL026UL*/ 01443000
*/*                                                          @YL026UL*/ 01444000
*/********************************************************************/ 01445000
*TRNSLATE:PROCEDURE;                                       /*@YL026UL*/ 01446000
TRNSLATE STM   @14,@02,@SA00005                                    0463 01447000
         STM   @04,@06,@SA00005+20                                 0463 01448000
         STM   @08,@12,@SA00005+32                                 0463 01449000
*        /************************************************************/ 01450000
*        /*                                                  @YL026UL*/ 01451000
*        /*  ** TRNSLATE **  DATA DEFINITIONS                @YL026UL*/ 01452000
*        /*                                                  @YL026UL*/ 01453000
*        /************************************************************/ 01454000
*                                                                  0464 01455000
*        DCL PDEPTR   PTR(31);         /*PTR TO THE PDE NOW  @YL026UL*/ 01456000
*                                      /*BEING EXAMINED      @YL026UL*/ 01457000
*                                                                  0465 01458000
*        /*PDE FORMAT FOR A NUMERIC CONSTANT OR FOR A        @YL026UL*/ 01459000
*        /*STRING CONSTANT WITHOUT PASSWORD                  @YL026UL*/ 01460000
*        DCL 1 PDE1 BDY(WORD) BASED(PDEPTR),                       0465 01461000
*              2 CONSTPTR PTR(31),     /*PTR TO THE CONSTANT @YL026UL*/ 01462000
*              2 CONSTLEN FIXED(15),   /*LENGTH OF CONSTANT  @YL026UL*/ 01463000
*              2 CONSTIN  BIT(1),      /*FLAG SET 'ON' IF    @YL026UL*/ 01464000
*                                      /*CONSTANT WAS INPUT  @YL026UL*/ 01465000
*              2 *        BIT(7),      /*RESERVED            @YL026UL*/ 01466000
*              2 *        BIT(8),      /*RESERVED            @YL026UL*/ 01467000
*              2 NXTCPDE  PTR(31);     /*PTR TO NEXT PDE IF  @YL026UL*/ 01468000
*                                      /*THE CURRENT PARM IS @YL026UL*/ 01469000
*                                      /*A LIST OF CONSTANTS @YL026UL*/ 01470000
*                                                                  0466 01471000
*        /*PDE FORMAT FOR A DATA SET NAME CONSTANT OR FOR A  @YL026UL*/ 01472000
*        /*STRING CONSTANT WITH OPTIONAL PASSWORD            @YL026UL*/ 01473000
*        DCL 1 PDE2 BDY(WORD) BASED(PDEPTR),                       0466 01474000
*              2 DSNPTR   PTR(31),     /*PTR TO THE NAME     @YL026UL*/ 01475000
*              2 DSNLEN   FIXED(15),   /*LENGTH OF NAME      @YL026UL*/ 01476000
*              2 DSNIN    BIT(1),      /*FLAG SET 'ON' IF    @YL026UL*/ 01477000
*                                      /*NAME WAS INPUT      @YL026UL*/ 01478000
*              2 DSNQUOTE BIT(1),      /*FLAG SET 'ON' IF    @YL026UL*/ 01479000
*                                      /*INPUT NAME WAS      @YL026UL*/ 01480000
*                                      /*CODED WITHIN QUOTES @YL026UL*/ 01481000
*              2 *        BIT(6),      /*RESERVED            @YL026UL*/ 01482000
*              2 *        BIT(8),      /*RESERVED            @YL026UL*/ 01483000
*              2 MEMPTR   PTR(31),     /*PTR TO MEMBER NAME  @YL026UL*/ 01484000
*              2 MEMLEN   FIXED(15),   /*MEMBER NAME LENGTH  @YL026UL*/ 01485000
*              2 MEMIN    BIT(1),      /*FLAG SET 'ON' IF    @YL026UL*/ 01486000
*                                      /*THE DSNAME HAS A    @YL026UL*/ 01487000
*                                      /*MEMBER NAME         @YL026UL*/ 01488000
*              2 *        BIT(7),      /*RESERVED            @YL026UL*/ 01489000
*              2 *        BIT(8),      /*RESERVED            @YL026UL*/ 01490000
*              2 PWDPTR   PTR(31),     /*PTR TO PASSWORD     @YL026UL*/ 01491000
*              2 PWDLEN   FIXED(15),   /*LENGTH OF PASSWORD  @YL026UL*/ 01492000
*              2 PWDIN    BIT(1),      /*FLAG SET 'ON' IF    @YL026UL*/ 01493000
*                                      /*PASSWORD WAS GIVEN  @YL026UL*/ 01494000
*              2 *        BIT(7),      /*RESERVED            @YL026UL*/ 01495000
*              2 *        BIT(8),      /*RESERVED            @YL026UL*/ 01496000
*              2 NXTDPDE  PTR(31);     /*PTR TO NEXT PDE IF  @YL026UL*/ 01497000
*                                      /*CURRENT PARM IS A   @YL026UL*/ 01498000
*                                      /*LIST OF NAMES       @YL026UL*/ 01499000
*                                                                  0467 01500000
*        /*PDE FORMAT FOR A KEYWORD                          @YL026UL*/ 01501000
*        DCL KWDID    FIXED(15) BASED(PDEPTR);             /*@YL026UL*/ 01502000
*                                                                  0467 01503000
*        DCL PDENUMBR FIXED(31)        /*INPUT NUMBER        @YL026UL*/ 01504000
*                     BASED(CONSTPTR);                     /*@YL026UL*/ 01505000
*        DCL PDESTRNG CHAR(*)          /*INPUT STRING        @YL026UL*/ 01506000
*                     BASED(CONSTPTR);                     /*@YL026UL*/ 01507000
*        DCL PDEDSN   CHAR(*)          /*INPUT DSNAME OR     @YL026UL*/ 01508000
*                     BASED(DSNPTR);   /*STRING W/ OPTIONAL  @YL026UL*/ 01509000
*                                      /*PASSWORD            @YL026UL*/ 01510000
*        DCL PDEMEM   CHAR(*)          /*INPUT MEMBER NAME   @YL026UL*/ 01511000
*                     BASED(MEMPTR);                       /*@YL026UL*/ 01512000
*        DCL PDEPWD   CHAR(*)          /*INPUT PASSWORD      @YL026UL*/ 01513000
*                     BASED(PWDPTR);                       /*@YL026UL*/ 01514000
*        DCL CODED    BIT(1)           /*PDE FLAG SET 'ON'   @YL026UL*/ 01515000
*                     BASED(PDEPTR+6); /*IF PRIMARY CONSTANT @YL026UL*/ 01516000
*                                      /*IS INPUT.           @YL026UL*/ 01517000
*                                                                  0474 01518000
*        DCL REPCOUNT FIXED(15);       /*COUNT OF SUBLIST    @YL026UL*/ 01519000
*                                      /*REPETITIONS.        @YL026UL*/ 01520000
*        DCL LISTTOTL FIXED(15);       /*COUNT OF CONSTANTS  @YL026UL*/ 01521000
*                                      /*IN DATA LIST        @YL026UL*/ 01522000
*        DCL BASEPTR  PTR(31);         /*PTR FOR TEMPORARILY @YL026UL*/ 01523000
*                                      /*SAVING AN ADDRESS   @YL026UL*/ 01524000
*        DCL MOVELEN  FIXED(15);       /*AMT OF DATA AREA TO @YL026UL*/ 01525000
*                                      /*BE MOVED            @YL026UL*/ 01526000
*        DCL PDLHDR   FIXED(15)        /*PDL HEADER LENGTH   @YL026UL*/ 01527000
*                     CONSTANT(8);                         /*@YL026UL*/ 01528000
*                                                                  0478 01529000
*        /************************************************************/ 01530000
*        /*                                                  @YL026UL*/ 01531000
*        /*  ** TRNSLATE **  TRANSLATE FROM PDL TO FDT       @YL026UL*/ 01532000
*        /*                                                  @YL026UL*/ 01533000
*        /************************************************************/ 01534000
*        OLDERID2 = NEWERID2;                                      0479 01535000
         L     @02,GDTTR2(,GDTPTR)                                 0479 01536000
         MVC   @TS00001(95),NEWERID2(@02)                          0479 01537000
         MVC   OLDERID2(95,@02),@TS00001                           0479 01538000
*        NEWID2='RI16';                                    /*@YL026UL*/ 01539000
*                                                                  0480 01540000
         MVC   NEWID2(4,@02),@CC01595                              0480 01541000
*        /************************************************************/ 01542000
*        /*                                                  @YL026UL*/ 01543000
*        /* IF 'TRNSLATE' HAS BEEN INVOKED TO TRANSLATE JUST @YL026UL*/ 01544000
*        /* A SINGLE PARAMETER, THEN THE PARM'S ID# IS KNOWN @YL026UL*/ 01545000
*        /* UPON ENTRY.  THE FACT THAT IT IS INPUT IS NOTED  @YL026UL*/ 01546000
*        /* IN THE PARM OCCURRENCE TABLE AND THE PDE WITH    @YL026UL*/ 01547000
*        /* THE ENCODED VALUE(S) IS POINTED TO.              @YL026UL*/ 01548000
*        /*                                                  @YL026UL*/ 01549000
*        /************************************************************/ 01550000
*        IF SINGLPRM=YES                                           0481 01551000
*          THEN                                                    0481 01552000
         TM    SINGLPRM,B'01000000'                                0481 01553000
         BNO   @RF00481                                            0481 01554000
*DOGRP20:    DO;                                           /*@YL026UL*/ 01555000
DOGRP20  DS    0H                                                  0483 01556000
*            PARMFLAG(PARMID)=INPUT;                       /*@YL026UL*/ 01557000
         L     @02,PINFOPTR                                        0483 01558000
         LH    @15,PARMID                                          0483 01559000
         MH    @15,@CH00038                                        0483 01560000
         LA    @14,2                                               0483 01561000
         LA    @01,0(@15,@02)                                      0483 01562000
         BCTR  @01,0                                               0483 01563000
         BCTR  @01,0                                               0483 01564000
         STC   @14,PARMFLAG-10(,@01)                               0483 01565000
*            PDEPTR=PDLPTR+PDLHDR;                         /*@YL026UL*/ 01566000
*                                                                  0484 01567000
         LA    PDEPTR,8                                            0484 01568000
         AL    PDEPTR,PDLPTR                                       0484 01569000
*            /********************************************************/ 01570000
*            /*                                              @YL026UL*/ 01571000
*            /* IF THE 'VALUE' OF THE PARM IS A REPETITION   @YL026UL*/ 01572000
*            /* OF A REPEATED SUBPARAMETER LIST, THEN SAVE   @YL026UL*/ 01573000
*            /* INFORMATION ABOUT THE REPETITION FOR LATER   @YL026UL*/ 01574000
*            /* PROCESSING.  IF NOT A SUBLIST REP., MOVE THE @YL026UL*/ 01575000
*            /* ITEM INTO THE FDT.                           @YL026UL*/ 01576000
*            /*                                              @YL026UL*/ 01577000
*            /********************************************************/ 01578000
*            IF REPEATED=YES                                       0485 01579000
*              THEN                                                0485 01580000
*                                                                  0485 01581000
         AL    @02,@CF01818                                        0485 01582000
         L     @02,PARMPTR(@15,@02)                                0485 01583000
         TM    REPEATED(@02),B'00100000'                           0485 01584000
         BNO   @RF00485                                            0485 01585000
*                CALL REPLIST;                             /*@YL026UL*/ 01586000
*                                                                  0486 01587000
         BAL   @14,REPLIST                                         0486 01588000
*              ELSE                                                0487 01589000
*                                                                  0487 01590000
*                CALL BUILDFDT;                            /*@YL026UL*/ 01591000
*                                                                  0487 01592000
         B     @RC00485                                            0487 01593000
@RF00485 BAL   @14,BUILDFDT                                        0487 01594000
*            /********************************************************/ 01595000
*            /*                                              @Y30SSFR*/ 01596000
*            /*  IF EITHER REPLIST OR BUILDFDT HAS FAILED,   @Y30SSFR*/ 01597000
*            /*  RETURN TO THE CALLER OF TRNSLATE.           @Y30SSFR*/ 01598000
*            /*                                              @Y30SSFR*/ 01599000
*            /********************************************************/ 01600000
*            IF LASTCC^=0                                          0488 01601000
*              THEN                                                0488 01602000
@RC00485 L     @02,@PC00001+16                                     0488 01603000
         LH    @02,LASTCC(,@02)                                    0488 01604000
         LTR   @02,@02                                             0488 01605000
         BNZ   @RT00488                                            0488 01606000
*                RETURN;                                   /*@YL026UL*/ 01607000
*            END DOGRP20;                                  /*@YL026UL*/ 01608000
*                                                                  0490 01609000
*          /**********************************************************/ 01610000
*          /*                                                @YL026UL*/ 01611000
*          /* IF A SET OF PARAMETERS IS TO BE TRANSLATED,    @YL026UL*/ 01612000
*          /* THEN EVERY PARAMETER DEFINED IN THE COMMAND    @YL026UL*/ 01613000
*          /* DESCRIPTOR IS CHECKED TO SEE IF IT IS PART     @YL026UL*/ 01614000
*          /* OF THAT SET AND IF IT WAS ACTUALLY INPUT.      @YL026UL*/ 01615000
*          /*                                                @YL026UL*/ 01616000
*          /**********************************************************/ 01617000
*          ELSE                                                    0491 01618000
*DOLOOP5:    DO PARMID=1 TO MAXID WHILE(LASTCC=0);         /*@YL026UL*/ 01619000
         B     @RC00481                                            0491 01620000
@RF00481 DS    0H                                                  0491 01621000
DOLOOP5  LA    @02,1                                               0491 01622000
         B     @DE00491                                            0491 01623000
@DL00491 SLR   @15,@15                                             0491 01624000
         L     @14,@PC00001+16                                     0491 01625000
         CH    @15,LASTCC(,@14)                                    0491 01626000
         BNE   @DC00491                                            0491 01627000
*              IF PARMPTR(PARMID)^=NULLPTR                         0492 01628000
*                THEN                                              0492 01629000
*                                                                  0492 01630000
         MH    @02,@CH00038                                        0492 01631000
         L     @01,PINFOPTR                                        0492 01632000
         AL    @01,@CF01818                                        0492 01633000
         C     @15,PARMPTR(@02,@01)                                0492 01634000
         BE    @RF00492                                            0492 01635000
*                  /**************************************************/ 01636000
*                  /*                                        @YL026UL*/ 01637000
*                  /* UPON ENTRY, 'SUPERID' IDENTIFIES THE   @YL026UL*/ 01638000
*                  /* PARM WHOSE SUBPARMS ARE CURRENTLY      @YL026UL*/ 01639000
*                  /* BEING PROCESSED.  THESE SUBPARMS,      @YL026UL*/ 01640000
*                  /* EXCEPT FOR THOSE IN NESTED REPEATED    @YL026UL*/ 01641000
*                  /* SUBLISTS, CONSTITUTE THE SET OF PARMS  @YL026UL*/ 01642000
*                  /* ELIGIBLE TO BE ENCODED IN THE PDL.     @YL026UL*/ 01643000
*                  /*                                        @YL026UL*/ 01644000
*                  /**************************************************/ 01645000
*DOGRP25:          DO;                                     /*@YL026UL*/ 01646000
DOGRP25  DS    0H                                                  0494 01647000
*                    FOUND=NO;                             /*@YL026UL*/ 01648000
         NI    FOUND,B'11111101'                                   0494 01649000
*                    TESTID=PARMID;                        /*@YL026UL*/ 01650000
         LH    TESTID,PARMID                                       0495 01651000
*                    DO WHILE(TESTID^=0 & FOUND=NO);       /*@YL026UL*/ 01652000
         B     @DE00496                                            0496 01653000
@DL00496 DS    0H                                                  0497 01654000
*                      IF SUPRPARM(TESTID)=SUPERID                 0497 01655000
*                        THEN                                      0497 01656000
         LR    @15,TESTID                                          0497 01657000
         MH    @15,@CH00038                                        0497 01658000
         L     @01,PINFOPTR                                        0497 01659000
         AL    @01,@CF01819                                        0497 01660000
         LH    @15,SUPRPARM-8(@15,@01)                             0497 01661000
         CH    @15,SUPERID                                         0497 01662000
         BNE   @RF00497                                            0497 01663000
*                          FOUND=YES;                      /*@YL026UL*/ 01664000
         OI    FOUND,B'00000010'                                   0498 01665000
*                        ELSE                                      0499 01666000
*                          DO;                             /*@YL026UL*/ 01667000
         B     @RC00497                                            0499 01668000
@RF00497 DS    0H                                                  0500 01669000
*                          TESTID=SUPRPARM(TESTID);        /*@YL026UL*/ 01670000
         L     @15,PINFOPTR                                        0500 01671000
         LA    @14,12                                              0500 01672000
         LR    @01,TESTID                                          0500 01673000
         MR    @00,@14                                             0500 01674000
         AL    @01,@CF01819                                        0500 01675000
         LH    @05,SUPRPARM-8(@01,@15)                             0500 01676000
         LR    TESTID,@05                                          0500 01677000
*                          IF PARMPTR(TESTID)->REPEATED=YES        0501 01678000
*                            THEN                                  0501 01679000
         LR    @01,@14                                             0501 01680000
         MR    @00,TESTID                                          0501 01681000
         AL    @15,@CF01818                                        0501 01682000
         L     @01,PARMPTR(@01,@15)                                0501 01683000
         TM    REPEATED(@01),B'00100000'                           0501 01684000
         BNO   @RF00501                                            0501 01685000
*                              TESTID=0;                   /*@YL026UL*/ 01686000
         SLR   TESTID,TESTID                                       0502 01687000
*                          END;                            /*@YL026UL*/ 01688000
@RF00501 DS    0H                                                  0504 01689000
*                    END;                                  /*@YL026UL*/ 01690000
@RC00497 DS    0H                                                  0504 01691000
@DE00496 LTR   TESTID,TESTID                                       0504 01692000
         BZ    @DC00496                                            0504 01693000
         TM    FOUND,B'00000010'                                   0504 01694000
         BZ    @DL00496                                            0504 01695000
@DC00496 DS    0H                                                  0505 01696000
*                    IF FOUND=YES                                  0505 01697000
*                      THEN                                        0505 01698000
*                                                                  0505 01699000
         TM    FOUND,B'00000010'                                   0505 01700000
         BNO   @RF00505                                            0505 01701000
*                        /********************************************/ 01702000
*                        /*                                  @YL026UL*/ 01703000
*                        /* WHEN AN 'ELIGIBLE' PARM IS FOUND @YL026UL*/ 01704000
*                        /* ITS PDE IS FOUND AND EXAMINED TO @YL026UL*/ 01705000
*                        /* SEE IF THE PARM WAS CODED.       @YL026UL*/ 01706000
*                        /*                                  @YL026UL*/ 01707000
*                        /********************************************/ 01708000
*DOGRP30:                DO;                               /*@YL026UL*/ 01709000
DOGRP30  DS    0H                                                  0507 01710000
*                        PARMFLAG(PARMID)=PARTOSET;        /*@YL026UL*/ 01711000
*                                                                  0507 01712000
         LH    @02,PARMID                                          0507 01713000
         MH    @02,@CH00038                                        0507 01714000
         LA    @15,1                                               0507 01715000
         L     @14,PINFOPTR                                        0507 01716000
         BCTR  @14,0                                               0507 01717000
         BCTR  @14,0                                               0507 01718000
         STC   @15,PARMFLAG-10(@02,@14)                            0507 01719000
*                        CALL FINDPDE;                     /*@YL026UL*/ 01720000
*                                                                  0508 01721000
         BAL   @14,FINDPDE                                         0508 01722000
*                        /********************************************/ 01723000
*                        /*                                  @YL026UL*/ 01724000
*                        /* IF THE PARM WAS CODED, THE VALUE @YL026UL*/ 01725000
*                        /* TYPE IS CHECKED.  IF THE PARM    @YL026UL*/ 01726000
*                        /* HAS CONSTANT(S), THEY ARE THEN   @YL026UL*/ 01727000
*                        /* TRANSLATED TO FDT FORM--IF THE   @YL026UL*/ 01728000
*                        /* PARM HAS REPEATED SUBLISTS, THE  @YL026UL*/ 01729000
*                        /* SUBLIST INFO IS SAVED.           @YL026UL*/ 01730000
*                        /*                                  @YL026UL*/ 01731000
*                        /********************************************/ 01732000
*                        IF SCLRDATA=YES | REPEATED=YES            0509 01733000
*                          THEN                                    0509 01734000
         LA    @02,12                                              0509 01735000
         LR    @15,@02                                             0509 01736000
         MH    @15,PARMID                                          0509 01737000
         L     @01,PINFOPTR                                        0509 01738000
         AL    @01,@CF01818                                        0509 01739000
         L     @15,PARMPTR(@15,@01)                                0509 01740000
         TM    SCLRDATA(@15),B'10100000'                           0509 01741000
         BZ    @RF00509                                            0509 01742000
*                            IF CODED=YES |                        0510 01743000
*                               (ANYSTRNG=YES & PWORDOPT=YES  |    0510 01744000
*                                DSNAM=YES) & MEMIN=YES            0510 01745000
*                              THEN                                0510 01746000
         TM    CODED+6(PDEPTR),B'10000000'                         0510 01747000
         BO    @RT00510                                            0510 01748000
         ALR   @15,@02                                             0510 01749000
         TM    ANYSTRNG(@15),B'01000010'                           0510 01750000
         BO    @GL00015                                            0510 01751000
         TM    DSNAM(@15),B'00100000'                              0510 01752000
         BNO   @RF00510                                            0510 01753000
@GL00015 TM    MEMIN(PDEPTR),B'10000000'                           0510 01754000
         BNO   @RF00510                                            0510 01755000
@RT00510 DS    0H                                                  0511 01756000
*                                DO;                       /*@YL026UL*/ 01757000
*                                PARMFLAG(PARMID)=INPUT;   /*@YL026UL*/ 01758000
         L     @02,PINFOPTR                                        0512 01759000
         LH    @15,PARMID                                          0512 01760000
         MH    @15,@CH00038                                        0512 01761000
         LA    @14,2                                               0512 01762000
         LA    @01,0(@15,@02)                                      0512 01763000
         BCTR  @01,0                                               0512 01764000
         BCTR  @01,0                                               0512 01765000
         STC   @14,PARMFLAG-10(,@01)                               0512 01766000
*                                IF REPEATED=YES                   0513 01767000
*                                  THEN                            0513 01768000
*                                                                  0513 01769000
         AL    @02,@CF01818                                        0513 01770000
         L     @02,PARMPTR(@15,@02)                                0513 01771000
         TM    REPEATED(@02),B'00100000'                           0513 01772000
         BNO   @RF00513                                            0513 01773000
*                                    CALL REPLIST;         /*@YL026UL*/ 01774000
*                                                                  0514 01775000
         BAL   @14,REPLIST                                         0514 01776000
*                                  ELSE                            0515 01777000
*                                                                  0515 01778000
*                                    CALL BUILDFDT;        /*@YL026UL*/ 01779000
*                                                                  0515 01780000
         B     @RC00513                                            0515 01781000
@RF00513 BAL   @14,BUILDFDT                                        0515 01782000
*                                /************************************/ 01783000
*                                /*                          @Y30SSFR*/ 01784000
*                                /*  IF EITHER REPLIST OR    @Y30SSFR*/ 01785000
*                                /*  BUILDFDT HAS FAILED,    @Y30SSFR*/ 01786000
*                                /*  RETURN TO THE CALLER    @Y30SSFR*/ 01787000
*                                /*  OF TRNSLATE.            @Y30SSFR*/ 01788000
*                                /*                          @Y30SSFR*/ 01789000
*                                /************************************/ 01790000
*                                IF LASTCC^=0                      0516 01791000
*                                  THEN                            0516 01792000
@RC00513 L     @02,@PC00001+16                                     0516 01793000
         LH    @02,LASTCC(,@02)                                    0516 01794000
         LTR   @02,@02                                             0516 01795000
         BNZ   @RT00516                                            0516 01796000
*                                    RETURN;               /*#YL026UL*/ 01797000
*                                END;                      /*#YL026UL*/ 01798000
*                              ELSE;                       /*@YL026UL*/ 01799000
@RF00510 DS    0H                                                  0520 01800000
*                          ELSE                                    0520 01801000
*                                                                  0520 01802000
*                            /****************************************/ 01803000
*                            /*                              @YL026UL*/ 01804000
*                            /* IF THE PARM IS A KEYWORD NOT @YL026UL*/ 01805000
*                            /* HAVING A CONSTANT ASSOCIATED @YL026UL*/ 01806000
*                            /* WITH IT, THE PDE IS CHECKED  @YL026UL*/ 01807000
*                            /* TO SEE IF THE KEYWORD WAS    @YL026UL*/ 01808000
*                            /* ACTUALLY INPUT.  IF SO, ITS  @YL026UL*/ 01809000
*                            /* PRESENCE IS NOTED IN THE     @YL026UL*/ 01810000
*                            /* OCCURRENCE FLAG TABLE AND IN @YL026UL*/ 01811000
*                            /* THE FDT.                     @YL026UL*/ 01812000
*                            /*                              @YL026UL*/ 01813000
*                            /****************************************/ 01814000
*                            IF KWDGRPID=KWDID                     0520 01815000
*                              THEN                                0520 01816000
         B     @RC00509                                            0520 01817000
@RF00509 L     @02,PINFOPTR                                        0520 01818000
         LH    @15,PARMID                                          0520 01819000
         LA    @14,12                                              0520 01820000
         LR    @01,@15                                             0520 01821000
         MR    @00,@14                                             0520 01822000
         LA    @05,0(@01,@02)                                      0520 01823000
         AL    @05,@CF01818                                        0520 01824000
         L     @05,PARMPTR(,@05)                                   0520 01825000
         SLR   @04,@04                                             0520 01826000
         IC    @04,KWDGRPID(,@05)                                  0520 01827000
         CH    @04,KWDID(,PDEPTR)                                  0520 01828000
         BNE   @RF00520                                            0520 01829000
*                                DO;                       /*@YL026UL*/ 01830000
*                                PARMFLAG(PARMID)=INPUT;   /*@YL026UL*/ 01831000
         LA    @00,2                                               0522 01832000
         LA    @05,0(@01,@02)                                      0522 01833000
         BCTR  @05,0                                               0522 01834000
         BCTR  @05,0                                               0522 01835000
         STC   @00,PARMFLAG-10(,@05)                               0522 01836000
*                                IF OCCURNUM > 1                   0523 01837000
*                                  THEN                            0523 01838000
         AL    @02,@CF01818                                        0523 01839000
         L     @02,PARMPTR(@01,@02)                                0523 01840000
         CLC   OCCURNUM(3,@02),@CF00227+1                          0523 01841000
         BNH   @RF00523                                            0523 01842000
*                                    VECTRVAL=                     0524 01843000
*                                          ADDR(VECTRVAL); /*@YL026UL*/ 01844000
         SLA   @15,2                                               0524 01845000
         L     @02,@PC00001+4                                      0524 01846000
         L     @02,FDTADDR(,@02)                                   0524 01847000
         MH    @14,REPINDEX                                        0524 01848000
         L     @01,RSIPTR                                          0524 01849000
         BCTR  @01,0                                               0524 01850000
         BCTR  @01,0                                               0524 01851000
         LH    @14,VECTRDSP-10(@14,@01)                            0524 01852000
         AL    @14,FDTPTR-4(@15,@02)                               0524 01853000
         ST    @14,VECTRVAL(,@14)                                  0524 01854000
*                                  ELSE                            0525 01855000
*                                    FDTPTR(PARMID)=               0525 01856000
*                                     ADDR(FDTPTR(PARMID));/*@YL026UL*/ 01857000
         B     @RC00523                                            0525 01858000
@RF00523 LH    @02,PARMID                                          0525 01859000
         SLA   @02,2                                               0525 01860000
         L     @15,@PC00001+4                                      0525 01861000
         L     @15,FDTADDR(,@15)                                   0525 01862000
         LA    @14,FDTPTR-4(@02,@15)                               0525 01863000
         ST    @14,FDTPTR-4(@02,@15)                               0525 01864000
*                                END;                      /*@YL026UL*/ 01865000
@RC00523 DS    0H                                                  0527 01866000
*                        END DOGRP30;                      /*@YL026UL*/ 01867000
@RF00520 DS    0H                                                  0527 01868000
@RC00509 DS    0H                                                  0528 01869000
*                  END DOGRP25;                            /*@YL026UL*/ 01870000
@RF00505 DS    0H                                                  0529 01871000
*            END DOLOOP5;                                  /*@YL026UL*/ 01872000
*                                                                  0529 01873000
@RF00492 LA    @02,1                                               0529 01874000
         AH    @02,PARMID                                          0529 01875000
@DE00491 STH   @02,PARMID                                          0529 01876000
         L     @01,DESCPTR                                         0529 01877000
         CH    @02,MAXID(,@01)                                     0529 01878000
         BNH   @DL00491                                            0529 01879000
@DC00491 DS    0H                                                  0530 01880000
*/********************************************************************/ 01881000
*/*                                                          @YL026UL*/ 01882000
*/*  PROCEDURE NAME - FINDPDE                                @YL026UL*/ 01883000
*/*                                                          @YL026UL*/ 01884000
*/*  FUNCTION - THIS ROUTINE SEARCHES THE DESCRIPTOR SECTION @YL026UL*/ 01885000
*/*             FOR THE CURRENT PARAMETER TO FIND THE PDE    @YL026UL*/ 01886000
*/*             OFFSET WHICH PERTAINS TO THE PDL GENERATED   @YL026UL*/ 01887000
*/*             FOR THE SET OF PARMS NOW BEING PROCESSED.    @YL026UL*/ 01888000
*/*                                                          @YL026UL*/ 01889000
*/*  INPUT -                                                 @YL026UL*/ 01890000
*/*            PARMID -  PARAMETER ID# OF THE PARAMETER      @YL026UL*/ 01891000
*/*                      WHOSE PDE LOCATION IS BEING SOUGHT  @YL026UL*/ 01892000
*/*            PROMPT -  FLAG SET 'ON' WHEN THE PDL THAT     @YL026UL*/ 01893000
*/*                      CONTAINS THE PDE OF INTEREST IS THE @YL026UL*/ 01894000
*/*                      RESULT OF A RESPONSE TO A PROMPT.   @YL026UL*/ 01895000
*/*            SUPERID - ID# OF THE PARAMETER WITHIN WHOSE   @YL026UL*/ 01896000
*/*                      SUBPARAMETER LIST THE CURRENT PARM  @YL026UL*/ 01897000
*/*                      OF INTEREST WAS CODED.              @YL026UL*/ 01898000
*/*            PDLPTR -  POINTER TO THE PDL CONTAINING THE   @YL026UL*/ 01899000
*/*                      PDE BEING SOUGHT.                   @YL026UL*/ 01900000
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/ 01901000
*/*                                                          @YL026UL*/ 01902000
*/*  OUTPUT -                                                @YL026UL*/ 01903000
*/*            PDEPTR -  POINTER TO THE PDE FOR THE PARM     @YL026UL*/ 01904000
*/*                      CURRENTLY BEING PROCESSED.          @YL026UL*/ 01905000
*/*                                                          @YL026UL*/ 01906000
*/********************************************************************/ 01907000
*FINDPDE:PROCEDURE;                                        /*@YL026UL*/ 01908000
         B     @PB00006                                            0530 01909000
FINDPDE  STM   @14,@02,12(@13)                                     0530 01910000
         STM   @04,@12,36(@13)                                     0530 01911000
*        /************************************************************/ 01912000
*        /*                                                  @YL026UL*/ 01913000
*        /*  ** FINDPDE **  FIND PDE OFFSET FOR CURRENT PARM @YL026UL*/ 01914000
*        /*                                                  @YL026UL*/ 01915000
*        /************************************************************/ 01916000
*        OLDERID2 = NEWERID2;                                      0531 01917000
         L     @07,GDTTR2(,GDTPTR)                                 0531 01918000
         MVC   @TS00001(95),NEWERID2(@07)                          0531 01919000
         MVC   OLDERID2(95,@07),@TS00001                           0531 01920000
*        NEWID2='RI18';                                    /*@YL026UL*/ 01921000
*                                                                  0532 01922000
         MVC   NEWID2(4,@07),@CC01610                              0532 01923000
*        /************************************************************/ 01924000
*        /*                                                  @YL026UL*/ 01925000
*        /* IF THE PDL IS NOT THE RESULT OF A PROMPT, USE    @YL026UL*/ 01926000
*        /* THE MAIN PDE OFFSET GIVEN IN THE PARAMETER'S     @YL026UL*/ 01927000
*        /* DESCRIPTOR SECTION.  OTHERWISE, SEARCH FOR THE   @YL026UL*/ 01928000
*        /* PDE OFFSET ASSOCIATED WITH THE PARAMETER WHOSE   @YL026UL*/ 01929000
*        /* SUBPARMS ARE BEING PROMPTED FOR.                 @YL026UL*/ 01930000
*        /*                                                  @YL026UL*/ 01931000
*        /************************************************************/ 01932000
*        IF PROMPT=NO                                              0533 01933000
*          THEN                                                    0533 01934000
         TM    PROMPT,B'10000000'                                  0533 01935000
         BNZ   @RF00533                                            0533 01936000
*            DO INDEX4=1 TO IDCOUNT;                       /*@YL026UL*/ 01937000
         LA    INDEX4,1                                            0534 01938000
         B     @DE00534                                            0534 01939000
@DL00534 DS    0H                                                  0535 01940000
*              IF IDNUM(INDEX4)=PARMID                             0535 01941000
*                THEN                                              0535 01942000
         LH    @07,PARMID                                          0535 01943000
         LR    @15,INDEX4                                          0535 01944000
         SLA   @15,2                                               0535 01945000
         LR    @14,@07                                             0535 01946000
         MH    @14,@CH00038                                        0535 01947000
         L     @01,PINFOPTR                                        0535 01948000
         AL    @01,@CF01818                                        0535 01949000
         L     @14,PARMPTR(@14,@01)                                0535 01950000
         SLR   @05,@05                                             0535 01951000
         IC    @05,IDDSPL(,@14)                                    0535 01952000
         ALR   @05,@05                                             0535 01953000
         ALR   @14,@05                                             0535 01954000
         LA    @01,0(@15,@14)                                      0535 01955000
         BCTR  @01,0                                               0535 01956000
         BCTR  @01,0                                               0535 01957000
         CH    @07,IDNUM-2(,@01)                                   0535 01958000
         BNE   @RF00535                                            0535 01959000
*                  PDEPTR=PDLPTR+PDEOFST1(INDEX4);         /*@YL026UL*/ 01960000
         LH    PDEPTR,PDEOFST1-4(@15,@14)                          0536 01961000
         AL    PDEPTR,PDLPTR                                       0536 01962000
*            END;                                          /*@YL026UL*/ 01963000
@RF00535 AL    INDEX4,@CF00227                                     0537 01964000
@DE00534 LH    @07,PARMID                                          0537 01965000
         MH    @07,@CH00038                                        0537 01966000
         LH    @15,PARMID                                          0537 01967000
         MH    @15,@CH00038                                        0537 01968000
         L     @01,PINFOPTR                                        0537 01969000
         AL    @01,@CF01818                                        0537 01970000
         L     @01,PARMPTR(@15,@01)                                0537 01971000
         SLR   @15,@15                                             0537 01972000
         IC    @15,IDDSPL(,@01)                                    0537 01973000
         ALR   @15,@15                                             0537 01974000
         L     @14,PINFOPTR                                        0537 01975000
         AL    @14,@CF01818                                        0537 01976000
         AL    @15,PARMPTR(@07,@14)                                0537 01977000
         CH    INDEX4,IDCOUNT(,@15)                                0537 01978000
         BNH   @DL00534                                            0537 01979000
*          ELSE                                                    0538 01980000
*            DO;                                           /*@YL026UL*/ 01981000
         B     @RC00533                                            0538 01982000
@RF00533 DS    0H                                                  0539 01983000
*              FOUND=NO;                                   /*@YL026UL*/ 01984000
         NI    FOUND,B'11111101'                                   0539 01985000
*              DO INDEX4=1 TO PDECNT WHILE(FOUND=NO);      /*@YL026UL*/ 01986000
         LA    INDEX4,1                                            0540 01987000
         B     @DE00540                                            0540 01988000
@DL00540 TM    FOUND,B'00000010'                                   0540 01989000
         BNZ   @DC00540                                            0540 01990000
*                IF PDEPRMID(INDEX4)=PARMID &                      0541 01991000
*                   PDEPCLID(INDEX4)=SUPERID                       0541 01992000
*                  THEN                                            0541 01993000
         LH    @07,PARMID                                          0541 01994000
         LR    @15,INDEX4                                          0541 01995000
         MH    @15,@CH00164                                        0541 01996000
         LR    @14,@07                                             0541 01997000
         MH    @14,@CH00038                                        0541 01998000
         L     @01,PINFOPTR                                        0541 01999000
         AL    @01,@CF01818                                        0541 02000000
         L     @14,PARMPTR(@14,@01)                                0541 02001000
         SLR   @05,@05                                             0541 02002000
         IC    @05,PDEDSPL(,@14)                                   0541 02003000
         ALR   @05,@05                                             0541 02004000
         ALR   @14,@05                                             0541 02005000
         LA    @01,0(@15,@14)                                      0541 02006000
         AL    @01,@CF01819                                        0541 02007000
         CH    @07,PDEPRMID-2(,@01)                                0541 02008000
         BNE   @RF00541                                            0541 02009000
         LA    @07,0(@15,@14)                                      0541 02010000
         BCTR  @07,0                                               0541 02011000
         BCTR  @07,0                                               0541 02012000
         LH    @07,PDEPCLID-4(,@07)                                0541 02013000
         CH    @07,SUPERID                                         0541 02014000
         BNE   @RF00541                                            0541 02015000
*                    DO;                                   /*@YL026UL*/ 02016000
*                    PDEPTR=PDLPTR+PDEOFST2(INDEX4);       /*@YL026UL*/ 02017000
         LH    PDEPTR,PDEOFST2-6(@15,@14)                          0543 02018000
         AL    PDEPTR,PDLPTR                                       0543 02019000
*                    FOUND=YES;                            /*@YL026UL*/ 02020000
         OI    FOUND,B'00000010'                                   0544 02021000
*                    END;                                  /*@YL026UL*/ 02022000
*              END;                                        /*@YL026UL*/ 02023000
@RF00541 AL    INDEX4,@CF00227                                     0546 02024000
@DE00540 LH    @07,PARMID                                          0546 02025000
         MH    @07,@CH00038                                        0546 02026000
         LH    @15,PARMID                                          0546 02027000
         MH    @15,@CH00038                                        0546 02028000
         L     @01,PINFOPTR                                        0546 02029000
         AL    @01,@CF01818                                        0546 02030000
         L     @01,PARMPTR(@15,@01)                                0546 02031000
         SLR   @15,@15                                             0546 02032000
         IC    @15,PDEDSPL(,@01)                                   0546 02033000
         ALR   @15,@15                                             0546 02034000
         L     @14,PINFOPTR                                        0546 02035000
         AL    @14,@CF01818                                        0546 02036000
         AL    @15,PARMPTR(@07,@14)                                0546 02037000
         CH    INDEX4,PDECNT(,@15)                                 0546 02038000
         BNH   @DL00540                                            0546 02039000
@DC00540 DS    0H                                                  0547 02040000
*            END;                                          /*@YL026UL*/ 02041000
*                                                                  0547 02042000
*        END FINDPDE;                                      /*@YL026UL*/ 02043000
*                                                                  0548 02044000
@EL00006 DS    0H                                                  0548 02045000
@EF00006 DS    0H                                                  0548 02046000
@ER00006 LM    @14,@02,12(@13)                                     0548 02047000
         LM    @04,@12,36(@13)                                     0548 02048000
         BR    @14                                                 0548 02049000
*/********************************************************************/ 02050000
*/*                                                          @YL026UL*/ 02051000
*/*  PROCEDURE NAME - REPLIST                                @YL026UL*/ 02052000
*/*                                                          @YL026UL*/ 02053000
*/*  FUNCTION - THIS ROUTINE HANDLES REPEATED SUBPARAMETER   @YL026UL*/ 02054000
*/*             LISTS WHOSE PARAMETERS ARE YET TO BE PARSED. @YL026UL*/ 02055000
*/*             FIRST, THE NUMBER OF SUBLIST REPETITIONS IS  @YL026UL*/ 02056000
*/*             COUNTED AND STORED IN THE FDT, AND THEN THE  @YL026UL*/ 02057000
*/*             SECONDARY POINTER VECTOR OFFSET IS FIGURED   @YL026UL*/ 02058000
*/*             FOR PARAMETERS APPEARING WITHIN THE SUBLIST. @YL026UL*/ 02059000
*/*             AN ENTRY IS ADDED TO THE REPEATED SUBLIST    @YL026UL*/ 02060000
*/*             INDEX (RSI) FOR EACH SUBLIST REPETITION TO   @YL026UL*/ 02061000
*/*             PROVIDE REFERENCE TO IT FOR LATER PROCESSING @YL026UL*/ 02062000
*/*             OF ITS PARAMETERS.  FINALLY, SECONDARY PTR   @YL026UL*/ 02063000
*/*             VECTORS ARE ALLOCATED AND INITIALIZED FOR    @YL026UL*/ 02064000
*/*             PARAMETERS DEFINED WITHIN THE REPEATED       @YL026UL*/ 02065000
*/*             SUBPARAMETER LIST.                           @YL026UL*/ 02066000
*/*                                                          @YL026UL*/ 02067000
*/*  INPUT -                                                 @YL026UL*/ 02068000
*/*            PDEPTR -  POINTER TO THE PDE CONTAINING THE   @YL026UL*/ 02069000
*/*                      UNPARSED SUBLIST REPETITIONS.       @YL026UL*/ 02070000
*/*            PARMID -  PARAMETER ID# OF THE PARM WHOSE     @YL026UL*/ 02071000
*/*                      SUBLIST REPS ARE BEING SAVED.       @YL026UL*/ 02072000
*/*            SINGLPRM- FLAG SET 'ON' IF THE PDE CONTAINS   @YL026UL*/ 02073000
*/*                      JUST A SINGLE SUBLIST REPETITION    @YL026UL*/ 02074000
*/*                      ENTERED AS A RESULT OF A PROMPT     @YL026UL*/ 02075000
*/*            RSI -     REPEATED SUBLIST INDEX ENTRY FOR    @YL026UL*/ 02076000
*/*                      PARAMETER WHOSE REPEATED SUBLISTS   @YL026UL*/ 02077000
*/*                      ARE BEING SAVED IN THE RSI (THIS IS @YL026UL*/ 02078000
*/*                      FOR NESTED REPEATED SUBLISTS ONLY)  @YL026UL*/ 02079000
*/*            PARMINFO- PARAMETER INFO TABLE.               @YL026UL*/ 02080000
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/ 02081000
*/*                                                          @YL026UL*/ 02082000
*/*  OUTPUT -                                                @YL026UL*/ 02083000
*/*            REPCOUNT- NUMBER OF SUBLISTS IN THIS          @YL026UL*/ 02084000
*/*                      REPEATED LIST.                      @YL026UL*/ 02085000
*/*            FDT -     DATA ENTRY FOR SUBLIST COUNT.       @YL026UL*/ 02086000
*/*            RSICOUNT- COUNT OF RSI ENTRIES                @YL026UL*/ 02087000
*/*            RSI -     REPEATED SUBLIST INDEX ENTRIES FOR  @YL026UL*/ 02088000
*/*                      EACH OF THE SUBLISTS IN THE LISTS   @YL026UL*/ 02089000
*/*            FDT -     INITIALIZED SECONDARY PTR VECTORS   @YL026UL*/ 02090000
*/*                      FOR PARAMETERS WHICH MAY APPEAR     @YL026UL*/ 02091000
*/*                      WITHIN THE SUBLISTS JUST SAVED.     @YL026UL*/ 02092000
*/*            LASTCC -  AMS CONDITION CODE; SET TO A NON-   @YL026UL*/ 02093000
*/*                      ZERO VALUE IF PROCESSING CANNOT     @YL026UL*/ 02094000
*/*                      BE CONTINUED                        @YL026UL*/ 02095000
*/*                                                          @YL026UL*/ 02096000
*/********************************************************************/ 02097000
*REPLIST:PROCEDURE;                                        /*@YL026UL*/ 02098000
REPLIST  STM   @14,@02,@SA00007                                    0549 02099000
         STM   @04,@12,@SA00007+20                                 0549 02100000
*        /************************************************************/ 02101000
*        /*                                                  @YL026UL*/ 02102000
*        /*  ** REPLIST  **  DATA DEFINITIONS                @YL026UL*/ 02103000
*        /*                                                  @YL026UL*/ 02104000
*        /************************************************************/ 02105000
*                                                                  0550 02106000
*        DCL VECTROFF FIXED(15);       /*OFFSET INTO SECOND. @YL026UL*/ 02107000
*                                      /*PTR VECTOR APPLYING @YL026UL*/ 02108000
*                                      /*TO PARMS APPEARING  @YL026UL*/ 02109000
*                                      /*IN CURRENT SUBLIST  @YL026UL*/ 02110000
*                                      /*REPETITION.         @YL026UL*/ 02111000
*        DCL OLDPTR   PTR(31);         /*PTR TO OLD RSI AREA @YL026UL*/ 02112000
*        DCL NEWPTR   PTR(31);         /*PTR TO NEW RSI AREA @YL026UL*/ 02113000
*        DCL MOVEAMT  FIXED(15);       /*AMOUNT OF RSI TO BE @YL026UL*/ 02114000
*                                      /*MOVED               @YL026UL*/ 02115000
*        /************************************************************/ 02116000
*        /*                                                  @YL026UL*/ 02117000
*        /*  ** REPLIST **  HANDLE REPEATED SUBPARM LISTS    @YL026UL*/ 02118000
*        /*                                                  @YL026UL*/ 02119000
*        /************************************************************/ 02120000
*        OLDERID2 = NEWERID2;                                      0554 02121000
         L     @07,GDTTR2(,GDTPTR)                                 0554 02122000
         MVC   @TS00001(95),NEWERID2(@07)                          0554 02123000
         MVC   OLDERID2(95,@07),@TS00001                           0554 02124000
*        NEWID2='RI20';                                    /*@YL026UL*/ 02125000
*                                                                  0555 02126000
         MVC   NEWID2(4,@07),@CC01618                              0555 02127000
*        /************************************************************/ 02128000
*        /*                                                  @YL026UL*/ 02129000
*        /* COUNT THE NUMBER OF SUBLIST REPETITIONS (NUMBER  @YL026UL*/ 02130000
*        /* OF PDE STRUCTURES CHAINED TOGETHER).  IF TOO     @YL026UL*/ 02131000
*        /* MANY REPS HAVE BEEN CODED, IGNORE EXCESS IF USER @YL026UL*/ 02132000
*        /* AGREES; OTHERWISE, DISCONTINUE PROCESSING.       @YL026UL*/ 02133000
*        /*                                                  @YL026UL*/ 02134000
*        /************************************************************/ 02135000
*        BASEPTR=PDEPTR;                                   /*@YL026UL*/ 02136000
         LR    BASEPTR,PDEPTR                                      0556 02137000
*        REPCOUNT=1;                                       /*@YL026UL*/ 02138000
         MVC   REPCOUNT(2),@CH00227                                0557 02139000
*        IF SINGLPRM=YES                                           0558 02140000
*          THEN                                                    0558 02141000
         TM    SINGLPRM,B'01000000'                                0558 02142000
         BNO   @RF00558                                            0558 02143000
*            CNTDONE=YES;                                  /*@YL026UL*/ 02144000
         OI    CNTDONE,B'00000100'                                 0559 02145000
*          ELSE                                                    0560 02146000
*            CNTDONE=NO;                                   /*@YL026UL*/ 02147000
         B     @RC00558                                            0560 02148000
@RF00558 NI    CNTDONE,B'11111011'                                 0560 02149000
*        DO WHILE(CNTDONE=NO & NXTCPDE^=CHAINEND);         /*@YL026UL*/ 02150000
@RC00558 B     @DE00561                                            0561 02151000
@DL00561 DS    0H                                                  0562 02152000
*          REPCOUNT=REPCOUNT+1;                            /*@YL026UL*/ 02153000
         LA    @07,1                                               0562 02154000
         AH    @07,REPCOUNT                                        0562 02155000
         STH   @07,REPCOUNT                                        0562 02156000
*          IF REPCOUNT > REPMAX                                    0563 02157000
*            THEN                                                  0563 02158000
         LA    @05,12                                              0563 02159000
         LR    @02,@05                                             0563 02160000
         MH    @02,PARMID                                          0563 02161000
         L     @01,PINFOPTR                                        0563 02162000
         AL    @01,@CF01818                                        0563 02163000
         AL    @05,PARMPTR(@02,@01)                                0563 02164000
         SLR   @02,@02                                             0563 02165000
         IC    @02,REPMAX(,@05)                                    0563 02166000
         CR    @07,@02                                             0563 02167000
         BNH   @RF00563                                            0563 02168000
*              DO;                                         /*@YL026UL*/ 02169000
*              PDEPTR=NXTCPDE;                             /*@YL026UL*/ 02170000
         L     PDEPTR,NXTCPDE(,PDEPTR)                             0565 02171000
*              CNTDONE=YES;                                /*@YL026UL*/ 02172000
*                                                                  0566 02173000
         OI    CNTDONE,B'00000100'                                 0566 02174000
*              CALL TOOMANY;                               /*@YL026UL*/ 02175000
*                                                                  0567 02176000
         BAL   @14,TOOMANY                                         0567 02177000
*              /******************************************************/ 02178000
*              /*                                            @Y30SSFR*/ 02179000
*              /*  IF THE CALL TO TOOMANY HAS FAILED OR IF   @Y30SSFR*/ 02180000
*              /*  THE USER WILL NOT ACCEPT THE DISCARD OF   @Y30SSFR*/ 02181000
*              /*  THE EXCESS PARAMETERS, RETURN TO THE      @Y30SSFR*/ 02182000
*              /*  CALLLER.                                  @Y30SSFR*/ 02183000
*              /*                                            @Y30SSFR*/ 02184000
*              /******************************************************/ 02185000
*              IF LASTCC ^= 0                                      0568 02186000
*                THEN                                              0568 02187000
         L     @07,@PC00001+16                                     0568 02188000
         LH    @07,LASTCC(,@07)                                    0568 02189000
         LTR   @07,@07                                             0568 02190000
         BNZ   @RT00568                                            0568 02191000
*                  RETURN;                                 /*#YL026UL*/ 02192000
*              END;                                        /*#YL026UL*/ 02193000
*            ELSE                                                  0571 02194000
*              PDEPTR=NXTCPDE;                             /*#YL026UL*/ 02195000
         B     @RC00563                                            0571 02196000
@RF00563 L     PDEPTR,NXTCPDE(,PDEPTR)                             0571 02197000
*        END;                                              /*#YL026UL*/ 02198000
@RC00563 DS    0H                                                  0572 02199000
@DE00561 TM    CNTDONE,B'00000100'                                 0572 02200000
         BNZ   @DC00561                                            0572 02201000
         CLC   NXTCPDE(4,PDEPTR),CHAINEND                          0572 02202000
         BNE   @DL00561                                            0572 02203000
@DC00561 DS    0H                                                  0573 02204000
*        PDEPTR=BASEPTR;                                   /*#YL026UL*/ 02205000
*                                                                  0573 02206000
         LR    PDEPTR,BASEPTR                                      0573 02207000
*        /************************************************************/ 02208000
*        /*                                                  @YL026UL*/ 02209000
*        /* STORE THE COUNT OF SUBLIST REPETITIONS IN THE    @YL026UL*/ 02210000
*        /* FDT AND COMPUTE THE SECONDARY POINTER VECTOR     @YL026UL*/ 02211000
*        /* OFFSET APPLYING TO PARAMETERS THAT APPEAR WITHIN @YL026UL*/ 02212000
*        /* THE FIRST SUBLIST REPETITION.                    @YL026UL*/ 02213000
*        /*                                                  @YL026UL*/ 02214000
*        /************************************************************/ 02215000
*        IF OCCURNUM=1                                             0574 02216000
*          THEN                                                    0574 02217000
         LH    @07,PARMID                                          0574 02218000
         LR    @02,@07                                             0574 02219000
         MH    @02,@CH00038                                        0574 02220000
         L     @01,PINFOPTR                                        0574 02221000
         AL    @01,@CF01818                                        0574 02222000
         L     @02,PARMPTR(@02,@01)                                0574 02223000
         CLC   OCCURNUM(3,@02),@CF00227+1                          0574 02224000
         BNE   @RF00574                                            0574 02225000
*            DO;                                           /*@YL026UL*/ 02226000
*            FDTPTR(PARMID)=REPCOUNT;                      /*@YL026UL*/ 02227000
         SLA   @07,2                                               0576 02228000
         L     @02,@PC00001+4                                      0576 02229000
         L     @02,FDTADDR(,@02)                                   0576 02230000
         LH    @15,REPCOUNT                                        0576 02231000
         ST    @15,FDTPTR-4(@07,@02)                               0576 02232000
*            VECTROFF=0;                                   /*@YL026UL*/ 02233000
         SLR   @07,@07                                             0577 02234000
         STH   @07,VECTROFF                                        0577 02235000
*            END;                                          /*@YL026UL*/ 02236000
*          ELSE                                                    0579 02237000
*            DO;                                           /*@YL026UL*/ 02238000
         B     @RC00574                                            0579 02239000
@RF00574 DS    0H                                                  0580 02240000
*            VECTRVAL=REPCOUNT;                            /*@YL026UL*/ 02241000
         LH    @07,PARMID                                          0580 02242000
         LR    @02,@07                                             0580 02243000
         SLA   @02,2                                               0580 02244000
         L     @15,@PC00001+4                                      0580 02245000
         L     @01,FDTADDR(,@15)                                   0580 02246000
         L     @15,RSIPTR                                          0580 02247000
         LA    @14,12                                              0580 02248000
         LR    @05,@14                                             0580 02249000
         MH    @05,REPINDEX                                        0580 02250000
         LA    @04,0(@05,@15)                                      0580 02251000
         BCTR  @04,0                                               0580 02252000
         BCTR  @04,0                                               0580 02253000
         LH    @04,VECTRDSP-10(,@04)                               0580 02254000
         L     @02,FDTPTR-4(@02,@01)                               0580 02255000
         ALR   @02,@04                                             0580 02256000
         LH    @01,REPCOUNT                                        0580 02257000
         ST    @01,VECTRVAL(,@02)                                  0580 02258000
*            VECTROFF=VECTRDSP(REPINDEX)+                  /*@YL026UL*/ 02259000
*                 4*(SBLSTNUM(REPINDEX)-1)*(REPMAX-1);     /*@YL026UL*/ 02260000
         AL    @15,@CF01819                                        0581 02261000
         SLR   @01,@01                                             0581 02262000
         IC    @01,SBLSTNUM-8(@05,@15)                             0581 02263000
         BCTR  @01,0                                               0581 02264000
         SLA   @01,2                                               0581 02265000
         LR    @05,@07                                             0581 02266000
         ST    @04,@TF00001                                        0581 02267000
         MR    @04,@14                                             0581 02268000
         L     @07,PINFOPTR                                        0581 02269000
         AL    @07,@CF01818                                        0581 02270000
         AL    @14,PARMPTR(@05,@07)                                0581 02271000
         SLR   @07,@07                                             0581 02272000
         IC    @07,REPMAX(,@14)                                    0581 02273000
         BCTR  @07,0                                               0581 02274000
         MR    @00,@07                                             0581 02275000
         AL    @01,@TF00001                                        0581 02276000
         STH   @01,VECTROFF                                        0581 02277000
*            END;                                          /*@YL026UL*/ 02278000
*                                                                  0582 02279000
*        /************************************************************/ 02280000
*        /*                                                  @YL026UL*/ 02281000
*        /* FOR EACH SUBLIST REPETITION, ADD AN ENTRY TO THE @YL026UL*/ 02282000
*        /* RSI (OBTAIN MORE RSI SPACE IF NECESSARY)         @YL026UL*/ 02283000
*        /*                                                  @YL026UL*/ 02284000
*        /************************************************************/ 02285000
*DOLOOP10:DO INDEX5=1 TO REPCOUNT;                         /*@YL026UL*/ 02286000
@RC00574 DS    0H                                                  0583 02287000
DOLOOP10 LA    @07,1                                               0583 02288000
         B     @DE00583                                            0583 02289000
@DL00583 DS    0H                                                  0584 02290000
*          RSICOUNT=RSICOUNT+1;                            /*@YL026UL*/ 02291000
         LA    @07,1                                               0584 02292000
         LH    @02,RSICOUNT                                        0584 02293000
         ALR   @02,@07                                             0584 02294000
         STH   @02,RSICOUNT                                        0584 02295000
*          IF RSICOUNT//INITALLO = 1  &                            0585 02296000
*             RSICOUNT ^= 1                                        0585 02297000
*            THEN                                                  0585 02298000
*                                                                  0585 02299000
         LR    @00,@02                                             0585 02300000
         SRDA  @00,32                                              0585 02301000
         D     @00,@CF01449                                        0585 02302000
         CR    @00,@07                                             0585 02303000
         BNE   @RF00585                                            0585 02304000
         CR    @02,@07                                             0585 02305000
         BE    @RF00585                                            0585 02306000
*              /******************************************************/ 02307000
*              /*                                            @YL026UL*/ 02308000
*              /* WHEN THE CURRENT RSI IS TOO SMALL, OBTAIN  @YL026UL*/ 02309000
*              /* A LARGER AREA AND MOVE THE CURRENT RSI     @YL026UL*/ 02310000
*              /* INTO THE FIRST PART OF THE NEW AREA.       @YL026UL*/ 02311000
*              /*                                            @YL026UL*/ 02312000
*              /******************************************************/ 02313000
*DOGRP35:      DO;                                         /*@YL026UL*/ 02314000
DOGRP35  DS    0H                                                  0587 02315000
*              MOVELEN=(RSICOUNT-1)*LENGTH(RSI);           /*@YL026UL*/ 02316000
         LH    MOVELEN,RSICOUNT                                    0587 02317000
         BCTR  MOVELEN,0                                           0587 02318000
         MH    MOVELEN,@CH00038                                    0587 02319000
*              AMTTOGET=MOVELEN+LENGTH(RSI)*INITALLO;      /*@YL026UL*/ 02320000
         LA    @02,240                                             0588 02321000
         ALR   @02,MOVELEN                                         0588 02322000
         ST    @02,AMTTOGET                                        0588 02323000
*              OLDPTR=RSIPTR;                              /*@YL026UL*/ 02324000
*                                                                  0589 02325000
         L     OLDPTR,RSIPTR                                       0589 02326000
*              CALL IDCSAGP0(GDTTBL,AMTTOGET,RSIPTR,               0590 02327000
*                     RIPOOLID,SETZERO);                   /*@YL026UL*/ 02328000
         ST    GDTPTR,@AL00001                                     0590 02329000
         LA    @02,AMTTOGET                                        0590 02330000
         ST    @02,@AL00001+4                                      0590 02331000
         LA    @02,RSIPTR                                          0590 02332000
         ST    @02,@AL00001+8                                      0590 02333000
         LA    @02,MODID                                           0590 02334000
         ST    @02,@AL00001+12                                     0590 02335000
         LA    @02,SETZERO                                         0590 02336000
         ST    @02,@AL00001+16                                     0590 02337000
         MVI   @AL00001+16,X'80'                                   0590 02338000
         L     @15,GDTGPL(,GDTPTR)                                 0590 02339000
         LA    @01,@AL00001                                        0590 02340000
         BALR  @14,@15                                             0590 02341000
*              RESPECIFY RTNREG RSTD;                              0591 02342000
*              TESTRC = RTNREG;                                    0592 02343000
         LR    TESTRC,RTNREG                                       0592 02344000
*              RESPECIFY RTNREG UNRSTD;                    /*@YL026UL*/ 02345000
*                                                                  0593 02346000
*              IF TESTRC ^= 0                                      0594 02347000
*                THEN                                              0594 02348000
         LTR   TESTRC,TESTRC                                       0594 02349000
         BZ    @RF00594                                            0594 02350000
*                  DO;                                     /*@YL026UL*/ 02351000
*                                                                  0595 02352000
*                  CALL FAILSPAC;                          /*@YL026UL*/ 02353000
*                                                                  0596 02354000
         BAL   @14,FAILSPAC                                        0596 02355000
*                  RETURN;                                 /*@YL026UL*/ 02356000
@EL00007 DS    0H                                                  0597 02357000
@EF00007 DS    0H                                                  0597 02358000
@ER00007 LM    @14,@02,@SA00007                                    0597 02359000
         LM    @04,@12,@SA00007+20                                 0597 02360000
         BR    @14                                                 0597 02361000
*                  END;                                    /*@YL026UL*/ 02362000
*                                                                  0598 02363000
*              NEWPTR=RSIPTR;                              /*@YL026UL*/ 02364000
@RF00594 L     NEWPTR,RSIPTR                                       0599 02365000
*              DO WHILE(MOVELEN > 0);                      /*@YL026UL*/ 02366000
         B     @DE00600                                            0600 02367000
@DL00600 DS    0H                                                  0601 02368000
*                MOVEAMT=MIN(256,MOVELEN);                 /*@YL026UL*/ 02369000
         LA    MOVEAMT,256                                         0601 02370000
         CR    MOVEAMT,MOVELEN                                     0601 02371000
         BNH   *+6                                                      02372000
         LR    MOVEAMT,MOVELEN                                     0601 02373000
*                NEWPTR->DATABLK(1:MOVEAMT)=                       0602 02374000
*                      OLDPTR->DATABLK(1:MOVEAMT);         /*@YL026UL*/ 02375000
         LR    @15,MOVEAMT                                         0602 02376000
         BCTR  @15,0                                               0602 02377000
         EX    @15,@SM01829                                        0602 02378000
*                NEWPTR=NEWPTR+MOVEAMT;                    /*@YL026UL*/ 02379000
         ALR   NEWPTR,MOVEAMT                                      0603 02380000
*                OLDPTR=OLDPTR+MOVEAMT;                    /*@YL026UL*/ 02381000
         ALR   OLDPTR,MOVEAMT                                      0604 02382000
*                MOVELEN=MOVELEN-MOVEAMT;                  /*@YL026UL*/ 02383000
         SLR   MOVELEN,MOVEAMT                                     0605 02384000
*              END;                                        /*@YL026UL*/ 02385000
*                                                                  0606 02386000
@DE00600 LTR   MOVELEN,MOVELEN                                     0606 02387000
         BP    @DL00600                                            0606 02388000
*              END DOGRP35;                                /*@YL026UL*/ 02389000
*                                                                  0607 02390000
*          /**********************************************************/ 02391000
*          /*                                                @YL026UL*/ 02392000
*          /* BE SURE THAT A NULL SUBLIST HAS NOT BEEN CODED @YL026UL*/ 02393000
*          /*                                                @YL026UL*/ 02394000
*          /**********************************************************/ 02395000
*          NAMEPDE=NO;                                     /*@YL026UL*/ 02396000
@RF00585 NI    NAMEPDE,B'11110111'                                 0608 02397000
*          DO WHILE(CONSTLEN=0);                           /*@YL026UL*/ 02398000
*                                                                  0609 02399000
         B     @DE00609                                            0609 02400000
@DL00609 DS    0H                                                  0610 02401000
*            /********************************************************/ 02402000
*            /*                                              @Y30SSFR*/ 02403000
*            /*  CALL NEWPARM TO PROMPT FOR THE MISSING      @Y30SSFR*/ 02404000
*            /*  SUBPARAMETER LIST.                          @Y30SSFR*/ 02405000
*            /*                                              @Y30SSFR*/ 02406000
*            /********************************************************/ 02407000
*            CALL NEWPARM(BADLEN,ADDR(REPPCL));            /*#YL026UL*/ 02408000
*                                                                  0610 02409000
         LA    @07,@CH00170                                        0610 02410000
         ST    @07,@AL00001                                        0610 02411000
         L     @07,@CV01509                                        0610 02412000
         ST    @07,@AFTEMPS                                        0610 02413000
         LA    @07,@AFTEMPS                                        0610 02414000
         ST    @07,@AL00001+4                                      0610 02415000
         LA    @01,@AL00001                                        0610 02416000
         BAL   @14,NEWPARM                                         0610 02417000
*            /********************************************************/ 02418000
*            /*                                              @Y30SSFR*/ 02419000
*            /*  IF THE PROMPT FAILS, RETURN TO THE CALLER   @Y30SSFR*/ 02420000
*            /*  OF REPLIST.                                 @Y30SSFR*/ 02421000
*            /*                                              @Y30SSFR*/ 02422000
*            /********************************************************/ 02423000
*            IF LASTCC^=0                                          0611 02424000
*              THEN                                                0611 02425000
         L     @07,@PC00001+16                                     0611 02426000
         LH    @07,LASTCC(,@07)                                    0611 02427000
         LTR   @07,@07                                             0611 02428000
         BNZ   @RT00611                                            0611 02429000
*                RETURN;                                   /*#YL026UL*/ 02430000
*          END;                                            /*#YL026UL*/ 02431000
*                                                                  0613 02432000
@DE00609 LH    @07,CONSTLEN(,PDEPTR)                               0613 02433000
         LTR   @07,@07                                             0613 02434000
         BZ    @DL00609                                            0613 02435000
*          /**********************************************************/ 02436000
*          /*                                                #YL026UL*/ 02437000
*          /* STORE INTO THE RSI THE LENGTH OF THE CURRENT   #YL026UL*/ 02438000
*          /* REPETITION, THE PTR TO THE REP, THE ID# OF THE @YL026UL*/ 02439000
*          /* PARM WHOSE SUBLIST THIS IS, AND CURRENT REP'S  @YL026UL*/ 02440000
*          /* POSITION IN THE LIST OF SUBLISTS.  ALSO STORE  @YL026UL*/ 02441000
*          /* THE POINTER VECTOR OFFSET APPLYING TO          @YL026UL*/ 02442000
*          /* SUBPARAMETERS WITHIN THIS REPETITION (THE      @YL026UL*/ 02443000
*          /* OFFSET IS ONE PTR FURTHER FOR EACH SUCCESSIVE  @YL026UL*/ 02444000
*          /* SUBLIST REPETITION).                           @YL026UL*/ 02445000
*          /*                                                @YL026UL*/ 02446000
*          /**********************************************************/ 02447000
*          SBLSTIN(RSICOUNT)=YES;                          /*@YL026UL*/ 02448000
         L     @02,RSIPTR                                          0614 02449000
         LH    @15,RSICOUNT                                        0614 02450000
         MH    @15,@CH00038                                        0614 02451000
         ST    @15,@TF00001                                        0614 02452000
         ALR   @15,@02                                             0614 02453000
         AL    @15,@CF01813                                        0614 02454000
         OI    SBLSTIN-9(@15),B'10000000'                          0614 02455000
*          SBLSTLEN(RSICOUNT)=CONSTLEN;                    /*@YL026UL*/ 02456000
         L     @01,@TF00001                                        0615 02457000
         AL    @01,@CF01817                                        0615 02458000
         STH   @07,SBLSTLEN-4(@01,@02)                             0615 02459000
*          SBLSTPTR(RSICOUNT)=CONSTPTR;                    /*@YL026UL*/ 02460000
         L     @07,CONSTPTR(,PDEPTR)                               0616 02461000
         L     @01,@TF00001                                        0616 02462000
         AL    @01,@CF01818                                        0616 02463000
         ST    @07,SBLSTPTR(@01,@02)                               0616 02464000
*          SBLSTID(RSICOUNT)=PARMID;                       /*@YL026UL*/ 02465000
         LH    @07,PARMID                                          0617 02466000
         L     @01,@TF00001                                        0617 02467000
         AL    @01,@CF01821                                        0617 02468000
         STH   @07,SBLSTID-6(@01,@02)                              0617 02469000
*          SBLSTNUM(RSICOUNT)=INDEX5;                      /*@YL026UL*/ 02470000
         LH    @07,INDEX5                                          0618 02471000
         L     @01,@TF00001                                        0618 02472000
         AL    @01,@CF01819                                        0618 02473000
         STC   @07,SBLSTNUM-8(@01,@02)                             0618 02474000
*          VECTRDSP(RSICOUNT)=VECTROFF+                            0619 02475000
*                             PTRLNGTH*(INDEX5-1);         /*@YL026UL*/ 02476000
*                                                                  0619 02477000
         LR    @15,@07                                             0619 02478000
         BCTR  @15,0                                               0619 02479000
         SLA   @15,2                                               0619 02480000
         AH    @15,VECTROFF                                        0619 02481000
         L     @14,@TF00001                                        0619 02482000
         BCTR  @02,0                                               0619 02483000
         BCTR  @02,0                                               0619 02484000
         STH   @15,VECTRDSP-10(@14,@02)                            0619 02485000
*          /*POINT TO THE NEXT SUBLIST                       @YL026UL*/ 02486000
*          PDEPTR=NXTCPDE;                                 /*@YL026UL*/ 02487000
*                                                                  0620 02488000
         L     PDEPTR,NXTCPDE(,PDEPTR)                             0620 02489000
*        END DOLOOP10;                                     /*@YL026UL*/ 02490000
*                                                                  0621 02491000
         AL    @07,@CF00227                                        0621 02492000
@DE00583 STH   @07,INDEX5                                          0621 02493000
         CH    @07,REPCOUNT                                        0621 02494000
         BNH   @DL00583                                            0621 02495000
*        /************************************************************/ 02496000
*        /*                                                  @YL026UL*/ 02497000
*        /* CALCULATE THE AMOUNT OF SPACE NEEDED FOR THE     @YL026UL*/ 02498000
*        /* SECONDARY POINTER VECTORS FOR PARAMETERS DEFINED @YL026UL*/ 02499000
*        /* TO BE WITHIN THIS REPEATED SUBLIST.              @YL026UL*/ 02500000
*        /*                                                  @YL026UL*/ 02501000
*        /************************************************************/ 02502000
*        IF OCCURNUM=1                                             0622 02503000
*          THEN                                                    0622 02504000
         LH    @07,PARMID                                          0622 02505000
         MH    @07,@CH00038                                        0622 02506000
         L     @02,PINFOPTR                                        0622 02507000
         AL    @02,@CF01818                                        0622 02508000
         L     @07,PARMPTR(@07,@02)                                0622 02509000
         CLC   OCCURNUM(3,@07),@CF00227+1                          0622 02510000
         BNE   @RF00622                                            0622 02511000
*            AMTTOGET=PTRLNGTH*REPCOUNT;                   /*@YL026UL*/ 02512000
         LH    @07,REPCOUNT                                        0623 02513000
         SLA   @07,2                                               0623 02514000
         ST    @07,AMTTOGET                                        0623 02515000
*          ELSE                                                    0624 02516000
*            AMTTOGET=PTRLNGTH*OCCURNUM*REPMAX;            /*@YL026UL*/ 02517000
*                                                                  0624 02518000
         B     @RC00622                                            0624 02519000
@RF00622 LA    @07,12                                              0624 02520000
         LR    @02,@07                                             0624 02521000
         MH    @02,PARMID                                          0624 02522000
         L     @01,PINFOPTR                                        0624 02523000
         AL    @01,@CF01818                                        0624 02524000
         L     @02,PARMPTR(@02,@01)                                0624 02525000
         L     @01,OCCURNUM-1(,@02)                                0624 02526000
         LA    @01,0(,@01)                                         0624 02527000
         SLA   @01,2                                               0624 02528000
         ALR   @02,@07                                             0624 02529000
         SLR   @07,@07                                             0624 02530000
         IC    @07,REPMAX(,@02)                                    0624 02531000
         MR    @00,@07                                             0624 02532000
         ST    @01,AMTTOGET                                        0624 02533000
*        /************************************************************/ 02534000
*        /*                                                  @YL026UL*/ 02535000
*        /* EXAMINE THE COMMAND DESCRIPTOR TO FIND ALL PARMS @YL026UL*/ 02536000
*        /* WHICH ARE DEFINED AS BEING PART OF THE CURRENT   @YL026UL*/ 02537000
*        /* REPEATED SUBPARM LIST SET.  FOR EACH SUCH PARM,  @YL026UL*/ 02538000
*        /* ALLOCATE THE SECONDARY FDT POINTER VECTOR.       @YL026UL*/ 02539000
*        /* DISCONTINUE PROCESSING IF SPACE ISN'T AVAILABLE  @YL026UL*/ 02540000
*        /*                                                  @YL026UL*/ 02541000
*        /************************************************************/ 02542000
*DOLOOP15:DO INDEX6=1 TO MAXID;                            /*@YL026UL*/ 02543000
*                                                                  0625 02544000
@RC00622 DS    0H                                                  0625 02545000
DOLOOP15 LA    INDEX6,1                                            0625 02546000
         B     @DE00625                                            0625 02547000
@DL00625 DS    0H                                                  0626 02548000
*          /**********************************************************/ 02549000
*          /*                                                @YL026UL*/ 02550000
*          /* A PARAMETER IS PART OF THE CURRENT REPEATED    @YL026UL*/ 02551000
*          /* SUBPARAMETER LIST IF IT IS SUBORDINATE TO THE  @YL026UL*/ 02552000
*          /* PARAMETER WHOSE SUBLIST IS REPEATED. HOWEVER   @YL026UL*/ 02553000
*          /* SUCH A PARM MUST NOT HAVE REPEATED SUBLISTS    @YL026UL*/ 02554000
*          /* ITSELF AND MUST NOT BE NESTED WITHIN A SUBLIST @YL026UL*/ 02555000
*          /* THAT IS REPEATED WITHIN THE CURRENT SUBLIST.   @YL026UL*/ 02556000
*          /*                                                @YL026UL*/ 02557000
*          /**********************************************************/ 02558000
*          IF PARMPTR(INDEX6)^=0 &                                 0626 02559000
*             PARMPTR(INDEX6)->REPEATED=NO                         0626 02560000
*            THEN                                                  0626 02561000
         LR    @07,INDEX6                                          0626 02562000
         MH    @07,@CH00038                                        0626 02563000
         L     @05,PINFOPTR                                        0626 02564000
         AL    @05,@CF01818                                        0626 02565000
         L     @07,PARMPTR(@07,@05)                                0626 02566000
         LTR   @07,@07                                             0626 02567000
         BZ    @RF00626                                            0626 02568000
         TM    REPEATED(@07),B'00100000'                           0626 02569000
         BNZ   @RF00626                                            0626 02570000
*DOGRP40:      DO;                                         /*@YL026UL*/ 02571000
DOGRP40  DS    0H                                                  0628 02572000
*                TESTID=INDEX6;                            /*@YL026UL*/ 02573000
         LR    TESTID,INDEX6                                       0628 02574000
*                DO WHILE(TESTID^=0);                      /*@YL026UL*/ 02575000
         B     @DE00629                                            0629 02576000
@DL00629 DS    0H                                                  0630 02577000
*                  IF SUPRPARM(TESTID)=PARMID                      0630 02578000
*                    THEN                                          0630 02579000
         LR    @07,TESTID                                          0630 02580000
         MH    @07,@CH00038                                        0630 02581000
         L     @05,PINFOPTR                                        0630 02582000
         AL    @05,@CF01819                                        0630 02583000
         LH    @07,SUPRPARM-8(@07,@05)                             0630 02584000
         CH    @07,PARMID                                          0630 02585000
         BNE   @RF00630                                            0630 02586000
*                      DO;                                 /*@YL026UL*/ 02587000
*                                                                  0631 02588000
*                      CALL IDCSAGP0(GDTTBL,AMTTOGET,FDTPTR(INDEX6),    02589000
*                             SPACEID,SETZERO);            /*@YL026UL*/ 02590000
         ST    GDTPTR,@AL00001                                     0632 02591000
         LA    @07,AMTTOGET                                        0632 02592000
         ST    @07,@AL00001+4                                      0632 02593000
         LR    @07,INDEX6                                          0632 02594000
         SLA   @07,2                                               0632 02595000
         L     @02,@PC00001+4                                      0632 02596000
         L     @02,FDTADDR(,@02)                                   0632 02597000
         LA    @07,FDTPTR-4(@07,@02)                               0632 02598000
         ST    @07,@AL00001+8                                      0632 02599000
         L     @07,@PC00001+8                                      0632 02600000
         ST    @07,@AL00001+12                                     0632 02601000
         LA    @07,SETZERO                                         0632 02602000
         ST    @07,@AL00001+16                                     0632 02603000
         MVI   @AL00001+16,X'80'                                   0632 02604000
         L     @15,GDTGPL(,GDTPTR)                                 0632 02605000
         LA    @01,@AL00001                                        0632 02606000
         BALR  @14,@15                                             0632 02607000
*                      RESPECIFY RTNREG RSTD;                      0633 02608000
*                      TESTRC = RTNREG;                            0634 02609000
         LR    TESTRC,RTNREG                                       0634 02610000
*                      RESPECIFY RTNREG UNRSTD;            /*@YL026UL*/ 02611000
*                                                                  0635 02612000
*                      /**********************************************/ 02613000
*                      /*                                    @Y30SSFR*/ 02614000
*                      /*  IF THE RETURN CODE FROM UGPOOL IS @Y30SSFR*/ 02615000
*                      /*  NON-ZERO, CALL FAILSPAC TO HANDLE @Y30SSFR*/ 02616000
*                      /*  THE ERROR AND THEN RETURN.        @Y30SSFR*/ 02617000
*                      /*                                    @Y30SSFR*/ 02618000
*                      /**********************************************/ 02619000
*                      IF TESTRC^=0                                0636 02620000
*                        THEN                                      0636 02621000
         LTR   TESTRC,TESTRC                                       0636 02622000
         BZ    @RF00636                                            0636 02623000
*                          DO;                             /*@YL026UL*/ 02624000
*                                                                  0637 02625000
*                          CALL FAILSPAC;                  /*@YL026UL*/ 02626000
*                                                                  0638 02627000
         BAL   @14,FAILSPAC                                        0638 02628000
*                          RETURN;                         /*@YL026UL*/ 02629000
         B     @EL00007                                            0639 02630000
*                          END;                            /*@YL026UL*/ 02631000
*                                                                  0640 02632000
*                      TESTID=0;                           /*@YL026UL*/ 02633000
@RF00636 SLR   TESTID,TESTID                                       0641 02634000
*                      END;                                /*@YL026UL*/ 02635000
*                    ELSE                                          0643 02636000
*                      DO;                                 /*@YL026UL*/ 02637000
*                                                                  0643 02638000
         B     @RC00630                                            0643 02639000
@RF00630 DS    0H                                                  0644 02640000
*                      /**********************************************/ 02641000
*                      /*                                    @Y30SSFR*/ 02642000
*                      /*  IF THE SUPERPARAMETER HAS THE     @Y30SSFR*/ 02643000
*                      /*  REPEATED BIT ON, EXIT FROM THE    @Y30SSFR*/ 02644000
*                      /*  LOOP BY SETTING TESTID TO ZERO.   @Y30SSFR*/ 02645000
*                      /*                                    @Y30SSFR*/ 02646000
*                      /**********************************************/ 02647000
*                      TESTID=SUPRPARM(TESTID);            /*@YL026UL*/ 02648000
         L     @07,PINFOPTR                                        0644 02649000
         LA    @05,12                                              0644 02650000
         LR    @01,TESTID                                          0644 02651000
         MR    @00,@05                                             0644 02652000
         AL    @01,@CF01819                                        0644 02653000
         LH    @15,SUPRPARM-8(@01,@07)                             0644 02654000
         LR    TESTID,@15                                          0644 02655000
*                      IF PARMPTR(TESTID)->REPEATED=YES            0645 02656000
*                        THEN                                      0645 02657000
         LR    @01,@05                                             0645 02658000
         MR    @00,TESTID                                          0645 02659000
         AL    @07,@CF01818                                        0645 02660000
         L     @07,PARMPTR(@01,@07)                                0645 02661000
         TM    REPEATED(@07),B'00100000'                           0645 02662000
         BNO   @RF00645                                            0645 02663000
*                          TESTID=0;                       /*@YL026UL*/ 02664000
         SLR   TESTID,TESTID                                       0646 02665000
*                      END;                                /*@YL026UL*/ 02666000
@RF00645 DS    0H                                                  0648 02667000
*                END;                                      /*@YL026UL*/ 02668000
@RC00630 DS    0H                                                  0648 02669000
@DE00629 LTR   TESTID,TESTID                                       0648 02670000
         BNZ   @DL00629                                            0648 02671000
*              END DOGRP40;                                /*@YL026UL*/ 02672000
*        END DOLOOP15;                                     /*@YL026UL*/ 02673000
*                                                                  0650 02674000
*                                                                  0650 02675000
@RF00626 AL    INDEX6,@CF00227                                     0650 02676000
@DE00625 L     @07,DESCPTR                                         0650 02677000
         CH    INDEX6,MAXID(,@07)                                  0650 02678000
         BNH   @DL00625                                            0650 02679000
*        END REPLIST;                                      /*@YL026UL*/ 02680000
         B     @EL00007                                            0651 02681000
*/********************************************************************/ 02682000
*/*                                                          @YL026UL*/ 02683000
*/*  PROCEDURE NAME - BUILDFDT                               @YL026UL*/ 02684000
*/*                                                          @YL026UL*/ 02685000
*/*  FUNCTION - THIS ROUTINE BUILDS FDT DATA SUBSTRUCTURES   @YL026UL*/ 02686000
*/*             BY MOVING DATA FROM THE PDE FOR THE PARM     @YL026UL*/ 02687000
*/*             CURRENTLY BEING PROCESSED INTO SPACE JUST    @YL026UL*/ 02688000
*/*             ALLOCATED FOR THE FDT.  'BUILDFDT' IS CALLED @YL026UL*/ 02689000
*/*             ONCE FOR EACH PARAMETER, EVEN IF THE PARM    @YL026UL*/ 02690000
*/*             CONSISTS OF A LIST OF ITEMS.  THE DATA ITEMS @YL026UL*/ 02691000
*/*             ARE CHECKED FOR SEMANTIC CORRECTNESS BEFORE  @YL026UL*/ 02692000
*/*             BEING PLACED IN THE FDT--IF AN ITEM IS NOT   @YL026UL*/ 02693000
*/*             CORRECT, A REPLACEMENT VALUE IS PROMPTED FOR @YL026UL*/ 02694000
*/*             AND THEN IT IS CHECKED FOR CORRECTNESS.  THE @YL026UL*/ 02695000
*/*             SEMANTIC REQUIREMENTS AND DATA SUBSTRUCTURE  @YL026UL*/ 02696000
*/*             FORMAT FOR A PARTICULAR PARAMETER ARE FOUND  @YL026UL*/ 02697000
*/*             BY EXAMINING THE COMMAND DESCRIPTOR ENTRY.   @YL026UL*/ 02698000
*/*                                                          @YL026UL*/ 02699000
*/*  INPUT -                                                 @YL026UL*/ 02700000
*/*            COMMAND DESCRIPTOR SECTION FOR CURRENT PARM.  @YL026UL*/ 02701000
*/*            PDE -     PARM DESCRIPTOR ENTRY CONTAINING    @YL026UL*/ 02702000
*/*                      PARSE-ENCODED DATA FOR CURRENT PARM @YL026UL*/ 02703000
*/*            NAMEPDE - FLAG SET SO AS TO IDENTIFY THE      @YL026UL*/ 02704000
*/*                      FORMAT OF THE PDE.                  @YL026UL*/ 02705000
*/*                                                          @YL026UL*/ 02706000
*/*  OUTPUT -                                                @YL026UL*/ 02707000
*/*            FDT -     DATA SUBSTRUCTURE ENTRY (AND PTR    @YL026UL*/ 02708000
*/*                      TO IT) FOR CURRENT PARAMETER        @YL026UL*/ 02709000
*/*            LASTCC -  AMS CONDITION CODE; SET TO A NON-   @YL026UL*/ 02710000
*/*                      ZERO VALUE IF PROCESSING CANNOT     @YL026UL*/ 02711000
*/*                      BE CONTINUED.                       @YL026UL*/ 02712000
*/*                                                          @YL026UL*/ 02713000
*/********************************************************************/ 02714000
*BUILDFDT:PROCEDURE;                                       /*@YL026UL*/ 02715000
BUILDFDT STM   @14,@02,@SA00008                                    0652 02716000
         STM   @04,@06,@SA00008+20                                 0652 02717000
         STM   @08,@12,@SA00008+32                                 0652 02718000
*        /************************************************************/ 02719000
*        /*                                                  @YL026UL*/ 02720000
*        /*  ** BUILDFDT **  DATA DEFINITIONS                @YL026UL*/ 02721000
*        /*                                                  @YL026UL*/ 02722000
*        /************************************************************/ 02723000
*                                                                  0653 02724000
*        DCL BLKPTR   PTR(31);         /*PTR TO STORAGE AREA @YL026UL*/ 02725000
*                                      /*FROM WHICH FDT DATA @YL026UL*/ 02726000
*                                      /*STRUCTURES ARE TO   @YL026UL*/ 02727000
*                                      /*BE ALLOCATED        @YL026UL*/ 02728000
*        DCL DATAPTR  PTR(31);         /*PTR TO FDT DATA     @YL026UL*/ 02729000
*                                      /*AREA CURRENTLY      @YL026UL*/ 02730000
*                                      /*BEING BUILT.        @YL026UL*/ 02731000
*                                                                  0655 02732000
*        DCL NUMBRCNT FIXED(31)        /*COUNT FOR LIST OF   @YL026UL*/ 02733000
*                     BASED(DATAPTR);  /*NUMERIC CONSTANTS   @YL026UL*/ 02734000
*        DCL STRNGCNT FIXED(15)        /*COUNT FOR LIST OF   @YL026UL*/ 02735000
*                     BASED(DATAPTR);  /*STRING OR DSNAME    @YL026UL*/ 02736000
*                                      /*CONSTANTS           @YL026UL*/ 02737000
*                                                                  0657 02738000
*        /*FDT FORMAT FOR NUMERIC CONSTANT                   @YL026UL*/ 02739000
*        DCL FULLWORD FIXED(31) BASED(DATAPTR);            /*@YL026UL*/ 02740000
*                                                                  0657 02741000
*        /*FDT FORMAT FOR STRING CONSTANT                    @YL026UL*/ 02742000
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        0658 02743000
*              2 STRNG1LN FIXED(8),    /*STRING LENGTH       @YL026UL*/ 02744000
*              2 STRNG1   CHAR(*);     /*STRING CONSTANT     @YL026UL*/ 02745000
*                                                                  0658 02746000
*        /*FDT FORMAT FOR STRING CONSTANT WITH PASSWORD      @YL026UL*/ 02747000
*        DCL 1 * BASED(DATAPTR) BDY(HWORD),                        0659 02748000
*              2 STRPWLEN FIXED(8),    /*PASSWORD LENGTH     @YL026UL*/ 02749000
*              2 STRPWORD CHAR(8),     /*PASSWORD CONSTANT   @YL026UL*/ 02750000
*              2 STRNG2LN FIXED(8),    /*STRING LENGTH       @YL026UL*/ 02751000
*              2 STRNG2   CHAR(*);     /*STRING CONSTANT     @YL026UL*/ 02752000
*                                                                  0659 02753000
*        /*FDT FORMAT FOR DATA SET NAME                      @YL026UL*/ 02754000
*        DCL 1 DSNSTRCT BASED(DATAPTR) BDY(HWORD),                 0660 02755000
*              2 PWORDLEN FIXED(8),    /*PASSWORD LENGTH     @YL026UL*/ 02756000
*              2 PWORD    CHAR(8),     /*PASSWORD CONSTANT   @YL026UL*/ 02757000
*              2 STARPOS  FIXED(8),    /*ASTERISK POSITION   @YL026UL*/ 02758000
*              2 UNQUOTED BIT(1),      /*'UNQUOTED' FLAG     @YL026UL*/ 02759000
*              2 *        BIT(7),      /*RESERVED            @YL026UL*/ 02760000
*              2 MEMBRLEN FIXED(8),    /*MEMBER NAME LENGTH  @YL026UL*/ 02761000
*              2 MEMBR    CHAR(8),     /*MEMBER NAME         @YL026UL*/ 02762000
*              2 DSNAMELN FIXED(8),    /*DSNAME LENGTH       @YL026UL*/ 02763000
*              2 DSNAME   CHAR(44);    /*DATA SET NAME       @YL026UL*/ 02764000
*                                                                  0660 02765000
*        DCL STARCNT  FIXED(15);       /*NUMBER OF ASTERISKS @YL026UL*/ 02766000
*                                      /*FOUND IN A DSNAME   @YL026UL*/ 02767000
*        DCL WORKPTR1 PTR(31);         /*PTR WORK VARIABLE   @YL026UL*/ 02768000
*                                                                  0662 02769000
*        DCL STAR     CHAR(1)          /*ASTERISK CHARACTER  @YL026UL*/ 02770000
*                     CONSTANT('*');                       /*@YL026UL*/ 02771000
*                                                                  0663 02772000
*        /*ERROR MESSAGE ID NUMBERS                          @YL026UL*/ 02773000
*        DCL OUTARANG FIXED(15)        /*NUMBER IS OUT OF    @YL026UL*/ 02774000
*                     CONSTANT(1);     /*ALLOWED VALUE RANGE @YL026UL*/ 02775000
*        DCL BADNAME  FIXED(15)        /*NAME DOESN'T ADHERE @YL026UL*/ 02776000
*                     CONSTANT(2);     /*NAMING RESTRICTIONS @YL026UL*/ 02777000
*        /************************************************************/ 02778000
*        /*                                                  @YL026UL*/ 02779000
*        /*  ** BUILDFDT **  BUILD FDT DATA SUBSTRUCTURE     @YL026UL*/ 02780000
*        /*                                                  @YL026UL*/ 02781000
*        /************************************************************/ 02782000
*        OLDERID2 = NEWERID2;                                      0666 02783000
         L     @02,GDTTR2(,GDTPTR)                                 0666 02784000
         MVC   @TS00001(95),NEWERID2(@02)                          0666 02785000
         MVC   OLDERID2(95,@02),@TS00001                           0666 02786000
*        NEWID2='RI22';                                    /*@YL026UL*/ 02787000
*                                                                  0667 02788000
         MVC   NEWID2(4,@02),@CC01663                              0667 02789000
*        /************************************************************/ 02790000
*        /*                                                  @YL026UL*/ 02791000
*        /*DETERMINE THE PDE FORMAT FOR THE CURRENT PARM     @YL026UL*/ 02792000
*        /*                                                  @YL026UL*/ 02793000
*        /************************************************************/ 02794000
*        IF NUMBER=YES | (ANYSTRNG=YES & PWORDOPT=NO)              0668 02795000
*          THEN                                                    0668 02796000
         LA    @02,12                                              0668 02797000
         LR    @15,@02                                             0668 02798000
         MH    @15,PARMID                                          0668 02799000
         L     @01,PINFOPTR                                        0668 02800000
         AL    @01,@CF01818                                        0668 02801000
         AL    @02,PARMPTR(@15,@01)                                0668 02802000
         TM    NUMBER(@02),B'10000000'                             0668 02803000
         BO    @RT00668                                            0668 02804000
         TM    ANYSTRNG(@02),B'01000000'                           0668 02805000
         BNO   @RF00668                                            0668 02806000
         TM    PWORDOPT(@02),B'00000010'                           0668 02807000
         BNZ   @RF00668                                            0668 02808000
@RT00668 DS    0H                                                  0669 02809000
*            NAMEPDE=NO;                                   /*@YL026UL*/ 02810000
         NI    NAMEPDE,B'11110111'                                 0669 02811000
*          ELSE                                                    0670 02812000
*            NAMEPDE=YES;                                  /*@YL026UL*/ 02813000
*                                                                  0670 02814000
         B     @RC00668                                            0670 02815000
@RF00668 OI    NAMEPDE,B'00001000'                                 0670 02816000
*        /************************************************************/ 02817000
*        /*                                                  @YL026UL*/ 02818000
*        /* OBTAIN SPACE FOR THE FDT SUBSTRUCTURE FOR THIS   @YL026UL*/ 02819000
*        /* PARAMETER.  COUNT THE NUMBER OF LIST ELEMENTS IF @YL026UL*/ 02820000
*        /* THIS PARAMETER IS A LIST, STORING THE COUNT INTO @YL026UL*/ 02821000
*        /* THE FDT SUBSTRUCTURE.                            @YL026UL*/ 02822000
*        /*                                                  @YL026UL*/ 02823000
*        /************************************************************/ 02824000
*                                                                  0671 02825000
*        CALL GETSPACE;                                    /*@YL026UL*/ 02826000
*                                                                  0671 02827000
@RC00668 BAL   @14,GETSPACE                                        0671 02828000
*        /************************************************************/ 02829000
*        /*                                                  @Y30SSFR*/ 02830000
*        /*  IF GETSPACE FAILS TO OBTAIN THE STORAGE NEEDED, @Y30SSFR*/ 02831000
*        /*  RETURN TO THE CALLER OF BUILDFDT.               @Y30SSFR*/ 02832000
*        /*                                                  @Y30SSFR*/ 02833000
*        /************************************************************/ 02834000
*        IF LASTCC^=0                                              0672 02835000
*          THEN                                                    0672 02836000
         L     @02,@PC00001+16                                     0672 02837000
         LH    @02,LASTCC(,@02)                                    0672 02838000
         LTR   @02,@02                                             0672 02839000
         BNZ   @RT00672                                            0672 02840000
*            RETURN;                                       /*#YL026UL*/ 02841000
*                                                                  0673 02842000
*        IF LIST=YES                                               0674 02843000
*          THEN                                                    0674 02844000
         LA    @02,12                                              0674 02845000
         LR    @15,@02                                             0674 02846000
         MH    @15,PARMID                                          0674 02847000
         L     @01,PINFOPTR                                        0674 02848000
         AL    @01,@CF01818                                        0674 02849000
         L     @15,PARMPTR(@15,@01)                                0674 02850000
         TM    LIST(@15),B'00001000'                               0674 02851000
         BNO   @RF00674                                            0674 02852000
*            IF NUMBER=YES                                         0675 02853000
*              THEN                                                0675 02854000
         ALR   @15,@02                                             0675 02855000
         TM    NUMBER(@15),B'10000000'                             0675 02856000
         BNO   @RF00675                                            0675 02857000
*                DO;                                       /*#YL026UL*/ 02858000
*                NUMBRCNT=LISTTOTL;                        /*#YL026UL*/ 02859000
         LH    @02,LISTTOTL                                        0677 02860000
         ST    @02,NUMBRCNT(,DATAPTR)                              0677 02861000
*                DATAPTR=DATAPTR+LENGTH(NUMBRCNT);         /*#YL026UL*/ 02862000
         AL    DATAPTR,@CF00050                                    0678 02863000
*                END;                                      /*#YL026UL*/ 02864000
*              ELSE                                                0680 02865000
*                DO;                                       /*#YL026UL*/ 02866000
         B     @RC00675                                            0680 02867000
@RF00675 DS    0H                                                  0681 02868000
*                STRNGCNT=LISTTOTL;                        /*#YL026UL*/ 02869000
         LH    @02,LISTTOTL                                        0681 02870000
         STH   @02,STRNGCNT(,DATAPTR)                              0681 02871000
*                DATAPTR=DATAPTR+LENGTH(STRNGCNT);         /*#YL026UL*/ 02872000
         AL    DATAPTR,@CF00161                                    0682 02873000
*                END;                                      /*#YL026UL*/ 02874000
*                                                                  0683 02875000
*        /************************************************************/ 02876000
*        /*                                                  #YL026UL*/ 02877000
*        /* FOR EACH ELEMENT OF THE PDE (ONLY ONE IF NOT A   #YL026UL*/ 02878000
*        /* LIST), CHECK FOR SEMANTIC ERRORS AND MOVE THE    #YL026UL*/ 02879000
*        /* DATA ITEM(S) INTO THE FDT SUBSTRUCTURE.          #YL026UL*/ 02880000
*        /*                                                  #YL026UL*/ 02881000
*        /************************************************************/ 02882000
*DOLOOP20:DO INDEX7=1 TO LISTTOTL;                         /*#YL026UL*/ 02883000
@RC00675 DS    0H                                                  0684 02884000
@RF00674 DS    0H                                                  0684 02885000
DOLOOP20 LA    INDEX7,1                                            0684 02886000
         B     @DE00684                                            0684 02887000
@DL00684 DS    0H                                                  0685 02888000
*          ALLOK=NO;                                       /*#YL026UL*/ 02889000
*                                                                  0685 02890000
         NI    ALLOK,B'11011111'                                   0685 02891000
*          /**********************************************************/ 02892000
*          /*                                                #YL026UL*/ 02893000
*          /* IF THE PARAMETER IS NUMERIC, CHECK THAT THE    #YL026UL*/ 02894000
*          /* VALUE IS WITHIN THE ALLOWABLE VALUE LIMITS.    #YL026UL*/ 02895000
*          /* PROMPT FOR A REPLACEMENT VALUE IF NECESSARY.   #YL026UL*/ 02896000
*          /* STORE THE NUMBER INTO THE FDT.                 #YL026UL*/ 02897000
*          /*                                                #YL026UL*/ 02898000
*          /**********************************************************/ 02899000
*          IF NUMBER=YES                                           0686 02900000
*            THEN                                                  0686 02901000
         LA    @04,12                                              0686 02902000
         LR    @02,@04                                             0686 02903000
         MH    @02,PARMID                                          0686 02904000
         L     @01,PINFOPTR                                        0686 02905000
         AL    @01,@CF01818                                        0686 02906000
         AL    @04,PARMPTR(@02,@01)                                0686 02907000
         TM    NUMBER(@04),B'10000000'                             0686 02908000
         BNO   @RF00686                                            0686 02909000
*              DO WHILE(ALLOK=NO);                         /*#YL026UL*/ 02910000
         B     @DE00687                                            0687 02911000
@DL00687 DS    0H                                                  0688 02912000
*                IF PDENUMBR > HIVALUE  |  PDENUMBR < LOWVALUE     0688 02913000
*                  THEN                                            0688 02914000
*                                                                  0688 02915000
         L     @04,CONSTPTR(,PDEPTR)                               0688 02916000
         L     @04,PDENUMBR(,@04)                                  0688 02917000
         LA    @02,12                                              0688 02918000
         LR    @15,@02                                             0688 02919000
         MH    @15,PARMID                                          0688 02920000
         L     @01,PINFOPTR                                        0688 02921000
         AL    @01,@CF01818                                        0688 02922000
         AL    @02,PARMPTR(@15,@01)                                0688 02923000
         C     @04,HIVALUE(,@02)                                   0688 02924000
         BH    @RT00688                                            0688 02925000
         C     @04,LOWVALUE(,@02)                                  0688 02926000
         BNL   @RF00688                                            0688 02927000
@RT00688 DS    0H                                                  0689 02928000
*                    CALL NEWPARM(OUTARANG,ADDR(NUMPCL));  /*#YL026UL*/ 02929000
*                                                                  0689 02930000
         LA    @04,@CH00227                                        0689 02931000
         ST    @04,@AL00001                                        0689 02932000
         L     @04,@CV01498                                        0689 02933000
         ST    @04,@AFTEMPS+4                                      0689 02934000
         LA    @04,@AFTEMPS+4                                      0689 02935000
         ST    @04,@AL00001+4                                      0689 02936000
         LA    @01,@AL00001                                        0689 02937000
         BAL   @14,NEWPARM                                         0689 02938000
*                  ELSE                                            0690 02939000
*                    DO;                                   /*#YL026UL*/ 02940000
         B     @RC00688                                            0690 02941000
@RF00688 DS    0H                                                  0691 02942000
*                    ALLOK=YES;                            /*#YL026UL*/ 02943000
         OI    ALLOK,B'00100000'                                   0691 02944000
*                    FULLWORD=PDENUMBR;                    /*#YL026UL*/ 02945000
         L     @04,CONSTPTR(,PDEPTR)                               0692 02946000
         L     @04,PDENUMBR(,@04)                                  0692 02947000
         ST    @04,FULLWORD(,DATAPTR)                              0692 02948000
*                    END;                                  /*#YL026UL*/ 02949000
*                                                                  0693 02950000
*                /****************************************************/ 02951000
*                /*                                          @Y30SSFR*/ 02952000
*                /*  IF THE PROMPTING FOR A REPLACEMENT      @Y30SSFR*/ 02953000
*                /*  PARAMETER HAS FAILED, RETURN TO THE     @Y30SSFR*/ 02954000
*                /*  CALLER OF BUILDFDT.                     @Y30SSFR*/ 02955000
*                /*                                          @Y30SSFR*/ 02956000
*                /****************************************************/ 02957000
*                IF LASTCC^=0                                      0694 02958000
*                  THEN                                            0694 02959000
@RC00688 L     @04,@PC00001+16                                     0694 02960000
         LH    @04,LASTCC(,@04)                                    0694 02961000
         LTR   @04,@04                                             0694 02962000
         BNZ   @RT00694                                            0694 02963000
*                    RETURN;                               /*#YL026UL*/ 02964000
*              END;                                        /*#YL026UL*/ 02965000
@DE00687 TM    ALLOK,B'00100000'                                   0696 02966000
         BZ    @DL00687                                            0696 02967000
*            ELSE                                                  0697 02968000
*              IF ANYSTRNG=YES                                     0697 02969000
*                THEN                                              0697 02970000
         B     @RC00686                                            0697 02971000
@RF00686 LA    @04,12                                              0697 02972000
         LR    @02,@04                                             0697 02973000
         MH    @02,PARMID                                          0697 02974000
         L     @01,PINFOPTR                                        0697 02975000
         AL    @01,@CF01818                                        0697 02976000
         AL    @04,PARMPTR(@02,@01)                                0697 02977000
         TM    ANYSTRNG(@04),B'01000000'                           0697 02978000
         BNO   @RF00697                                            0697 02979000
*DOLOOP25:         DO WHILE(ALLOK=NO);                     /*#YL026UL*/ 02980000
*                                                                  0698 02981000
DOLOOP25 B     @DE00698                                            0698 02982000
@DL00698 DS    0H                                                  0699 02983000
*                    /************************************************/ 02984000
*                    /*                                      @YL026UL*/ 02985000
*                    /* IF THE PARM IS A STRING CONSTANT     @YL026UL*/ 02986000
*                    /* WITH A POSSIBLE PASSWORD, IT HAS     @YL026UL*/ 02987000
*                    /* BEEN DEFINED TO 'PARSE' AS A DSNAME. @YL026UL*/ 02988000
*                    /* CHECK THAT NO 'MEMBER NAME' WAS      @YL026UL*/ 02989000
*                    /* CODED WITHIN THE STRING AND          @YL026UL*/ 02990000
*                    /* THAT THE LENGTH LIMIT HASN'T BEEN    @YL026UL*/ 02991000
*                    /* EXCEEDED.  PROMPT FOR REPLACEMENT    @YL026UL*/ 02992000
*                    /* VALUE IF THE CURRENT ONE IS BAD;     @YL026UL*/ 02993000
*                    /* OTHERWISE, STORE THE CONSTANT INTO   @YL026UL*/ 02994000
*                    /* THE FDT.                             @YL026UL*/ 02995000
*                    /*                                      @YL026UL*/ 02996000
*                    /************************************************/ 02997000
*                    IF PWORDOPT=YES                               0699 02998000
*                      THEN                                        0699 02999000
         LA    @04,12                                              0699 03000000
         LR    @02,@04                                             0699 03001000
         MH    @02,PARMID                                          0699 03002000
         L     @01,PINFOPTR                                        0699 03003000
         AL    @01,@CF01818                                        0699 03004000
         AL    @04,PARMPTR(@02,@01)                                0699 03005000
         TM    PWORDOPT(@04),B'00000010'                           0699 03006000
         BNO   @RF00699                                            0699 03007000
*                        IF MEMIN=YES  |                           0700 03008000
*                           DSNLEN > MAXLNGTH  |  DSNLEN = 0       0700 03009000
*                          THEN                                    0700 03010000
*                                                                  0700 03011000
         TM    MEMIN(PDEPTR),B'10000000'                           0700 03012000
         BO    @RT00700                                            0700 03013000
         LH    @02,DSNLEN(,PDEPTR)                                 0700 03014000
         SLR   @15,@15                                             0700 03015000
         IC    @15,MAXLNGTH(,@04)                                  0700 03016000
         CR    @02,@15                                             0700 03017000
         BH    @RT00700                                            0700 03018000
         LTR   @02,@02                                             0700 03019000
         BNZ   @RF00700                                            0700 03020000
@RT00700 DS    0H                                                  0701 03021000
*                            CALL NEWPARM(BADNAME,                 0701 03022000
*                                         ADDR(DDNPCL));   /*@YL026UL*/ 03023000
*                                                                  0701 03024000
         LA    @04,@CH00161                                        0701 03025000
         ST    @04,@AL00001                                        0701 03026000
         L     @04,@CV01500                                        0701 03027000
         ST    @04,@AFTEMPS+4                                      0701 03028000
         LA    @04,@AFTEMPS+4                                      0701 03029000
         ST    @04,@AL00001+4                                      0701 03030000
         LA    @01,@AL00001                                        0701 03031000
         BAL   @14,NEWPARM                                         0701 03032000
*                          ELSE                                    0702 03033000
*DOGRP45:                    DO;                           /*@YL026UL*/ 03034000
         B     @RC00700                                            0702 03035000
@RF00700 DS    0H                                                  0702 03036000
DOGRP45  DS    0H                                                  0703 03037000
*                            ALLOK=YES;                    /*@YL026UL*/ 03038000
         OI    ALLOK,B'00100000'                                   0703 03039000
*                            STRNG2LN=DSNLEN;              /*@YL026UL*/ 03040000
         LH    @04,DSNLEN(,PDEPTR)                                 0704 03041000
         STC   @04,STRNG2LN(,DATAPTR)                              0704 03042000
*                            WORKPTR1=ADDR(STRNG2);        /*@YL026UL*/ 03043000
         LA    @02,STRNG2(,DATAPTR)                                0705 03044000
         ST    @02,WORKPTR1                                        0705 03045000
*                            RESPECIFY (DATABLK)                   0706 03046000
*                                 BASED(WORKPTR1);         /*@YL026UL*/ 03047000
*                            STRNG2(1)=' ';                /*@YL026UL*/ 03048000
         MVI   STRNG2(DATAPTR),C' '                                0707 03049000
*                            STRNG2(2:MAXLNGTH)=                   0708 03050000
*                                 DATABLK(1:MAXLNGTH-1);   /*@YL026UL*/ 03051000
         LA    @15,12                                              0708 03052000
         LR    @14,@15                                             0708 03053000
         MH    @14,PARMID                                          0708 03054000
         L     @01,PINFOPTR                                        0708 03055000
         AL    @01,@CF01818                                        0708 03056000
         AL    @15,PARMPTR(@14,@01)                                0708 03057000
         SLR   @14,@14                                             0708 03058000
         IC    @14,MAXLNGTH(,@15)                                  0708 03059000
         BCTR  @14,0                                               0708 03060000
         BCTR  @14,0                                               0708 03061000
         EX    @14,@SM01836                                        0708 03062000
*                            STRNG2(1:DSNLEN)=                     0709 03063000
*                                 PDEDSN(1:DSNLEN);        /*@YL026UL*/ 03064000
*                                                                  0709 03065000
         BCTR  @04,0                                               0709 03066000
         L     @02,DSNPTR(,PDEPTR)                                 0709 03067000
         EX    @04,@SM01838                                        0709 03068000
*                            /****************************************/ 03069000
*                            /*                              @YL026UL*/ 03070000
*                            /* IF THE STRING HAS A PASSWORD @YL026UL*/ 03071000
*                            /* STORE IT INTO THE FDT.       @YL026UL*/ 03072000
*                            /*                              @YL026UL*/ 03073000
*                            /****************************************/ 03074000
*                            IF PWDLEN > 0                         0710 03075000
*                              THEN                                0710 03076000
         LH    @04,PWDLEN(,PDEPTR)                                 0710 03077000
         LTR   @04,@04                                             0710 03078000
         BNP   @RF00710                                            0710 03079000
*                                DO;                       /*@YL026UL*/ 03080000
*                                STRPWLEN=PWDLEN;          /*@YL026UL*/ 03081000
         STC   @04,STRPWLEN(,DATAPTR)                              0712 03082000
*                                STRPWORD=                         0713 03083000
*                                    PDEPWD(1:PWDLEN);     /*@YL026UL*/ 03084000
         MVI   STRPWORD+1(DATAPTR),C' '                            0713 03085000
         MVC   STRPWORD+2(6,DATAPTR),STRPWORD+1(DATAPTR)           0713 03086000
         BCTR  @04,0                                               0713 03087000
         L     @02,PWDPTR(,PDEPTR)                                 0713 03088000
         EX    @04,@SM01840                                        0713 03089000
*                                END;                      /*@YL026UL*/ 03090000
*                            END DOGRP45;                  /*@YL026UL*/ 03091000
*                      ELSE                                        0716 03092000
*                                                                  0716 03093000
*                        /********************************************/ 03094000
*                        /*                                  @YL026UL*/ 03095000
*                        /* IF THE PARM IS A STRING CONSTANT @YL026UL*/ 03096000
*                        /* CHECK THAT THE LENGTH LIMIT HAS  @YL026UL*/ 03097000
*                        /* NOT BEEN EXCEEDED--PROMPT FOR A  @YL026UL*/ 03098000
*                        /* REPLACEMENT VALUE IF NECESSARY.  @YL026UL*/ 03099000
*                        /* STORE THE CONSTANT INTO THE FDT. @YL026UL*/ 03100000
*                        /*                                  @YL026UL*/ 03101000
*                        /********************************************/ 03102000
*                        IF CONSTLEN > MAXLNGTH  |  CONSTLEN = 0   0716 03103000
*                          THEN                                    0716 03104000
*                                                                  0716 03105000
         B     @RC00699                                            0716 03106000
@RF00699 LH    @04,CONSTLEN(,PDEPTR)                               0716 03107000
         LA    @02,12                                              0716 03108000
         LR    @15,@02                                             0716 03109000
         MH    @15,PARMID                                          0716 03110000
         L     @01,PINFOPTR                                        0716 03111000
         AL    @01,@CF01818                                        0716 03112000
         AL    @02,PARMPTR(@15,@01)                                0716 03113000
         SLR   @15,@15                                             0716 03114000
         IC    @15,MAXLNGTH(,@02)                                  0716 03115000
         CR    @04,@15                                             0716 03116000
         BH    @RT00716                                            0716 03117000
         LTR   @04,@04                                             0716 03118000
         BNZ   @RF00716                                            0716 03119000
@RT00716 DS    0H                                                  0717 03120000
*                            CALL NEWPARM(BADLEN,                  0717 03121000
*                                         ADDR(STRPCL));   /*@YL026UL*/ 03122000
*                                                                  0717 03123000
         LA    @04,@CH00170                                        0717 03124000
         ST    @04,@AL00001                                        0717 03125000
         L     @04,@CV01499                                        0717 03126000
         ST    @04,@AFTEMPS+4                                      0717 03127000
         LA    @04,@AFTEMPS+4                                      0717 03128000
         ST    @04,@AL00001+4                                      0717 03129000
         LA    @01,@AL00001                                        0717 03130000
         BAL   @14,NEWPARM                                         0717 03131000
*                          ELSE                                    0718 03132000
*                            DO;                           /*@YL026UL*/ 03133000
         B     @RC00716                                            0718 03134000
@RF00716 DS    0H                                                  0719 03135000
*                            ALLOK=YES;                    /*@YL026UL*/ 03136000
         OI    ALLOK,B'00100000'                                   0719 03137000
*                            STRNG1LN=CONSTLEN;            /*@YL026UL*/ 03138000
         LH    @04,CONSTLEN(,PDEPTR)                               0720 03139000
         STC   @04,STRNG1LN(,DATAPTR)                              0720 03140000
*                            WORKPTR1=ADDR(STRNG1);        /*@YL026UL*/ 03141000
         LA    @02,STRNG1(,DATAPTR)                                0721 03142000
         ST    @02,WORKPTR1                                        0721 03143000
*                            RESPECIFY (DATABLK)                   0722 03144000
*                                   BASED(WORKPTR1);       /*@YL026UL*/ 03145000
*                            STRNG1(1)=' ';                /*@YL026UL*/ 03146000
         MVI   STRNG1(DATAPTR),C' '                                0723 03147000
*                            STRNG1(2:MAXLNGTH)=                   0724 03148000
*                                   DATABLK(1:MAXLNGTH-1); /*@YL026UL*/ 03149000
         LA    @15,12                                              0724 03150000
         LR    @14,@15                                             0724 03151000
         MH    @14,PARMID                                          0724 03152000
         L     @01,PINFOPTR                                        0724 03153000
         AL    @01,@CF01818                                        0724 03154000
         AL    @15,PARMPTR(@14,@01)                                0724 03155000
         SLR   @14,@14                                             0724 03156000
         IC    @14,MAXLNGTH(,@15)                                  0724 03157000
         BCTR  @14,0                                               0724 03158000
         BCTR  @14,0                                               0724 03159000
         EX    @14,@SM01842                                        0724 03160000
*                            STRNG1(1:STRNG1LN)=                   0725 03161000
*                                   PDESTRNG(1:STRNG1LN);  /*@YL026UL*/ 03162000
         BCTR  @04,0                                               0725 03163000
         L     @02,CONSTPTR(,PDEPTR)                               0725 03164000
         EX    @04,@SM01844                                        0725 03165000
*                            END;                          /*@YL026UL*/ 03166000
*                                                                  0726 03167000
*                    /************************************************/ 03168000
*                    /*                                      @Y30SSFR*/ 03169000
*                    /*  IF THE PROMPTING FOR A REPLACEMENT  @Y30SSFR*/ 03170000
*                    /*  PARAMETER HAS FAILED, RETURN TO THE @Y30SSFR*/ 03171000
*                    /*  CALLER OF BUILDFDT.                 @Y30SSFR*/ 03172000
*                    /*                                      @Y30SSFR*/ 03173000
*                    /************************************************/ 03174000
*                    IF LASTCC^=0                                  0727 03175000
*                      THEN                                        0727 03176000
@RC00716 DS    0H                                                  0727 03177000
@RC00699 L     @04,@PC00001+16                                     0727 03178000
         LH    @04,LASTCC(,@04)                                    0727 03179000
         LTR   @04,@04                                             0727 03180000
         BNZ   @RT00727                                            0727 03181000
*                        RETURN;                           /*@YL026UL*/ 03182000
*                  END DOLOOP25;                           /*@YL026UL*/ 03183000
@DE00698 TM    ALLOK,B'00100000'                                   0729 03184000
         BZ    @DL00698                                            0729 03185000
*                ELSE                                              0730 03186000
*                                                                  0730 03187000
*                  /**************************************************/ 03188000
*                  /*                                        @YL026UL*/ 03189000
*                  /* IF THE PARAMETER IS A DSNAME, CHECK    @YL026UL*/ 03190000
*                  /* THAT A NULL DSNAME WASN'T CODED.  IF   @YL026UL*/ 03191000
*                  /* THE NAME MAY BE GENERIC, CHECK THAT    @YL026UL*/ 03192000
*                  /* JUST A SINGLE ASTERISK WAS CODED AND   @YL026UL*/ 03193000
*                  /* THAT IT WASN'T CODED AS THE 1ST CHAR.  @YL026UL*/ 03194000
*                  /* PROMPT FOR A REPLACEMENT NAME IF THE   @YL026UL*/ 03195000
*                  /* CURRENT ONE IS INVALID.                @YL026UL*/ 03196000
*                  /*                                        @YL026UL*/ 03197000
*                  /**************************************************/ 03198000
*DOLOOP30:         DO WHILE(ALLOK=NO);                     /*@YL026UL*/ 03199000
         B     @RC00697                                            0730 03200000
@RF00697 DS    0H                                                  0730 03201000
DOLOOP30 B     @DE00730                                            0730 03202000
@DL00730 DS    0H                                                  0731 03203000
*                    STARPOS=0;                            /*@YL026UL*/ 03204000
         MVI   STARPOS(DATAPTR),X'00'                              0731 03205000
*                    STARCNT=0;                            /*@YL026UL*/ 03206000
         SLR   STARCNT,STARCNT                                     0732 03207000
*                    IF GENERIC=YES                                0733 03208000
*                      THEN                                        0733 03209000
         LA    @04,12                                              0733 03210000
         LR    @15,@04                                             0733 03211000
         MH    @15,PARMID                                          0733 03212000
         L     @01,PINFOPTR                                        0733 03213000
         AL    @01,@CF01818                                        0733 03214000
         AL    @04,PARMPTR(@15,@01)                                0733 03215000
         TM    GENERIC(@04),B'00010000'                            0733 03216000
         BNO   @RF00733                                            0733 03217000
*                        DO INDEX8=1 TO DSNLEN;            /*@YL026UL*/ 03218000
         LA    INDEX8,1                                            0734 03219000
         B     @DE00734                                            0734 03220000
@DL00734 DS    0H                                                  0735 03221000
*                          IF PDEDSN(INDEX8)=STAR                  0735 03222000
*                            THEN                                  0735 03223000
         L     @01,DSNPTR(,PDEPTR)                                 0735 03224000
         ALR   @01,INDEX8                                          0735 03225000
         BCTR  @01,0                                               0735 03226000
         CLI   PDEDSN(@01),C'*'                                    0735 03227000
         BNE   @RF00735                                            0735 03228000
*                              DO;                         /*@YL026UL*/ 03229000
*                              STARPOS=INDEX8;             /*@YL026UL*/ 03230000
         STC   INDEX8,STARPOS(,DATAPTR)                            0737 03231000
*                              STARCNT=STARCNT+1;          /*@YL026UL*/ 03232000
         AL    STARCNT,@CF00227                                    0738 03233000
*                              END;                        /*@YL026UL*/ 03234000
*                        END;                              /*@YL026UL*/ 03235000
*                                                                  0740 03236000
@RF00735 AL    INDEX8,@CF00227                                     0740 03237000
@DE00734 CH    INDEX8,DSNLEN(,PDEPTR)                              0740 03238000
         BNH   @DL00734                                            0740 03239000
*                    /************************************************/ 03240000
*                    /*                                      @YL026UL*/ 03241000
*                    /* IF THE NAME IS INVALID, SELECT A     @YL026UL*/ 03242000
*                    /* 'STANDARD' PCL BASED UPON THE DATA   @YL026UL*/ 03243000
*                    /* TYPE OF THE NAME AND PROMPT FOR A    @YL026UL*/ 03244000
*                    /* NEW VALUE.                           @YL026UL*/ 03245000
*                    /*                                      @YL026UL*/ 03246000
*                    /************************************************/ 03247000
*                    IF STARCNT>1 | STARPOS=1 | DSNIN=NO | DSNLEN=0     03248000
*                      THEN                                        0741 03249000
@RF00733 C     STARCNT,@CF00227                                    0741 03250000
         BH    @RT00741                                            0741 03251000
         CLI   STARPOS(DATAPTR),1                                  0741 03252000
         BE    @RT00741                                            0741 03253000
         TM    DSNIN(PDEPTR),B'10000000'                           0741 03254000
         BZ    @RT00741                                            0741 03255000
         LH    @04,DSNLEN(,PDEPTR)                                 0741 03256000
         LTR   @04,@04                                             0741 03257000
         BNZ   @RF00741                                            0741 03258000
@RT00741 DS    0H                                                  0742 03259000
*                        DO;                               /*@YL026UL*/ 03260000
*                                                                  0742 03261000
*                        /********************************************/ 03262000
*                        /*                                  @Y30SSFR*/ 03263000
*                        /*  IF WE ARE LOOKING FOR A VOLSER, @Y30SSFR*/ 03264000
*                        /*  USE THE GENERIC PROMPT IF       @Y30SSFR*/ 03265000
*                        /*  ACCEPTABLE, AND OTHERWISE, USE  @Y30SSFR*/ 03266000
*                        /*  THE NON-GENERIC PROMPT.         @Y30SSFR*/ 03267000
*                        /*                                  @Y30SSFR*/ 03268000
*                        /********************************************/ 03269000
*                        IF VOLID=YES                              0743 03270000
*                          THEN                                    0743 03271000
         LA    @04,12                                              0743 03272000
         LR    @02,@04                                             0743 03273000
         MH    @02,PARMID                                          0743 03274000
         L     @01,PINFOPTR                                        0743 03275000
         AL    @01,@CF01818                                        0743 03276000
         AL    @04,PARMPTR(@02,@01)                                0743 03277000
         TM    VOLID(@04),B'00001000'                              0743 03278000
         BNO   @RF00743                                            0743 03279000
*                            IF GENERIC=YES                        0744 03280000
*                              THEN                                0744 03281000
         TM    GENERIC(@04),B'00010000'                            0744 03282000
         BNO   @RF00744                                            0744 03283000
*                                WORKPTR1=ADDR(DSGVPCL);   /*@YL026UL*/ 03284000
         L     @04,@CV01504                                        0745 03285000
         ST    @04,WORKPTR1                                        0745 03286000
*                              ELSE                                0746 03287000
*                                WORKPTR1=ADDR(DSVPCL);    /*@YL026UL*/ 03288000
*                                                                  0746 03289000
         B     @RC00744                                            0746 03290000
@RF00744 L     @04,@CV01502                                        0746 03291000
         ST    @04,WORKPTR1                                        0746 03292000
*                          /******************************************/ 03293000
*                          /*                                @Y30SSFR*/ 03294000
*                          /*  PROMPT FOR A DATA SET NAME.   @Y30SSFR*/ 03295000
*                          /*  USE THE GENERIC PROMPT IF     @Y30SSFR*/ 03296000
*                          /*  POSSIBLE.                     @Y30SSFR*/ 03297000
*                          /*                                @Y30SSFR*/ 03298000
*                          /******************************************/ 03299000
*                          ELSE                                    0747 03300000
*                            IF GENERIC=YES                        0747 03301000
*                              THEN                                0747 03302000
         B     @RC00743                                            0747 03303000
@RF00743 LA    @04,12                                              0747 03304000
         LR    @02,@04                                             0747 03305000
         MH    @02,PARMID                                          0747 03306000
         L     @01,PINFOPTR                                        0747 03307000
         AL    @01,@CF01818                                        0747 03308000
         AL    @04,PARMPTR(@02,@01)                                0747 03309000
         TM    GENERIC(@04),B'00010000'                            0747 03310000
         BNO   @RF00747                                            0747 03311000
*                                WORKPTR1=ADDR(DSGPCL);    /*@YL026UL*/ 03312000
         L     @04,@CV01503                                        0748 03313000
         ST    @04,WORKPTR1                                        0748 03314000
*                              ELSE                                0749 03315000
*                                WORKPTR1=ADDR(DSNPCL);    /*@YL026UL*/ 03316000
*                                                                  0749 03317000
         B     @RC00747                                            0749 03318000
@RF00747 L     @04,@CV01501                                        0749 03319000
         ST    @04,WORKPTR1                                        0749 03320000
*                        /********************************************/ 03321000
*                        /*                                  @YL026UL*/ 03322000
*                        /* IF THE NAME IS NOT TO BE         @YL026UL*/ 03323000
*                        /* PREFIXED, POINT TO THE PCL THAT  @YL026UL*/ 03324000
*                        /* THAT IS IDENTICAL EXCEPT FOR     @YL026UL*/ 03325000
*                        /* THE PREFIXING REQUEST.           @YL026UL*/ 03326000
*                        /*                                  @YL026UL*/ 03327000
*                        /********************************************/ 03328000
*                        IF USERID=NO                              0750 03329000
*                          THEN                                    0750 03330000
@RC00747 DS    0H                                                  0750 03331000
@RC00743 LA    @04,12                                              0750 03332000
         LR    @02,@04                                             0750 03333000
         MH    @02,PARMID                                          0750 03334000
         L     @01,PINFOPTR                                        0750 03335000
         AL    @01,@CF01818                                        0750 03336000
         AL    @04,PARMPTR(@02,@01)                                0750 03337000
         TM    USERID(@04),B'00000100'                             0750 03338000
         BNZ   @RF00750                                            0750 03339000
*                            WORKPTR1=WORKPTR1 +                   0751 03340000
*                              ADDR(DSNPCL2)-ADDR(DSNPCL); /*@YL026UL*/ 03341000
*                                                                  0751 03342000
         L     @04,@CV01505                                        0751 03343000
         AL    @04,WORKPTR1                                        0751 03344000
         L     @02,@CV01501                                        0751 03345000
         SLR   @04,@02                                             0751 03346000
         ST    @04,WORKPTR1                                        0751 03347000
*                        CALL NEWPARM(BADNAME,WORKPTR1);   /*@YL026UL*/ 03348000
*                                                                  0752 03349000
@RF00750 LA    @04,@CH00161                                        0752 03350000
         ST    @04,@AL00001                                        0752 03351000
         LA    @04,WORKPTR1                                        0752 03352000
         ST    @04,@AL00001+4                                      0752 03353000
         LA    @01,@AL00001                                        0752 03354000
         BAL   @14,NEWPARM                                         0752 03355000
*                        END;                              /*@YL026UL*/ 03356000
*                                                                  0753 03357000
*                      /**********************************************/ 03358000
*                      /*                                    @YL026UL*/ 03359000
*                      /* IF THE DSNAME IS VALID, MOVE THE   @YL026UL*/ 03360000
*                      /* INPUT CONSTANT(S) AND LENGTH(S)    @YL026UL*/ 03361000
*                      /* INTO THE FDT.  IF THE DSNAME WAS   @YL026UL*/ 03362000
*                      /* NOT ENTERED IN QUOTES, SET THE     @YL026UL*/ 03363000
*                      /* 'UNQUOTED' FLAG OF THE FDT 'ON'    @YL026UL*/ 03364000
*                      /*                                    @YL026UL*/ 03365000
*                      /**********************************************/ 03366000
*                      ELSE                                        0754 03367000
*DOGRP55:                DO;                               /*@YL026UL*/ 03368000
         B     @RC00741                                            0754 03369000
@RF00741 DS    0H                                                  0754 03370000
DOGRP55  DS    0H                                                  0755 03371000
*                        ALLOK=YES;                        /*@YL026UL*/ 03372000
         OI    ALLOK,B'00100000'                                   0755 03373000
*                        IF PWDIN=YES                              0756 03374000
*                          THEN                                    0756 03375000
         TM    PWDIN(PDEPTR),B'10000000'                           0756 03376000
         BNO   @RF00756                                            0756 03377000
*                            DO;                           /*@YL026UL*/ 03378000
*                            PWORDLEN=PWDLEN;              /*@YL026UL*/ 03379000
         LH    @04,PWDLEN(,PDEPTR)                                 0758 03380000
         STC   @04,PWORDLEN(,DATAPTR)                              0758 03381000
*                            PWORD=PDEPWD(1:PWDLEN);       /*@YL026UL*/ 03382000
         MVI   PWORD+1(DATAPTR),C' '                               0759 03383000
         MVC   PWORD+2(6,DATAPTR),PWORD+1(DATAPTR)                 0759 03384000
         BCTR  @04,0                                               0759 03385000
         L     @01,PWDPTR(,PDEPTR)                                 0759 03386000
         EX    @04,@SM01846                                        0759 03387000
*                            END;                          /*@YL026UL*/ 03388000
*                        IF MEMIN=YES                              0761 03389000
*                          THEN                                    0761 03390000
@RF00756 TM    MEMIN(PDEPTR),B'10000000'                           0761 03391000
         BNO   @RF00761                                            0761 03392000
*                            DO;                           /*@YL026UL*/ 03393000
*                            MEMBRLEN=MEMLEN;              /*@YL026UL*/ 03394000
         LH    @04,MEMLEN(,PDEPTR)                                 0763 03395000
         STC   @04,MEMBRLEN(,DATAPTR)                              0763 03396000
*                            MEMBR=PDEMEM(1:MEMLEN);       /*@YL026UL*/ 03397000
         MVI   MEMBR+1(DATAPTR),C' '                               0764 03398000
         MVC   MEMBR+2(6,DATAPTR),MEMBR+1(DATAPTR)                 0764 03399000
         BCTR  @04,0                                               0764 03400000
         L     @01,MEMPTR(,PDEPTR)                                 0764 03401000
         EX    @04,@SM01848                                        0764 03402000
*                            END;                          /*@YL026UL*/ 03403000
*                        DSNAMELN=DSNLEN;                  /*@YL026UL*/ 03404000
@RF00761 LH    @04,DSNLEN(,PDEPTR)                                 0766 03405000
         STC   @04,DSNAMELN(,DATAPTR)                              0766 03406000
*                        DSNAME=PDEDSN(1:DSNLEN);          /*@YL026UL*/ 03407000
         MVI   DSNAME+1(DATAPTR),C' '                              0767 03408000
         MVC   DSNAME+2(42,DATAPTR),DSNAME+1(DATAPTR)              0767 03409000
         BCTR  @04,0                                               0767 03410000
         L     @01,DSNPTR(,PDEPTR)                                 0767 03411000
         EX    @04,@SM01850                                        0767 03412000
*                        IF DSNQUOTE=NO & STARCNT=0                0768 03413000
*                          THEN                                    0768 03414000
         TM    DSNQUOTE(PDEPTR),B'01000000'                        0768 03415000
         BNZ   @RF00768                                            0768 03416000
         LTR   STARCNT,STARCNT                                     0768 03417000
         BNZ   @RF00768                                            0768 03418000
*                            UNQUOTED=YES;                 /*@YL026UL*/ 03419000
         OI    UNQUOTED(DATAPTR),B'10000000'                       0769 03420000
*                        END DOGRP55;                      /*@YL026UL*/ 03421000
*                                                                  0770 03422000
@RF00768 DS    0H                                                  0771 03423000
*                    /************************************************/ 03424000
*                    /*                                      @Y30SSFR*/ 03425000
*                    /*  IF A PROMPT FOR A REPLACEMENT       @Y30SSFR*/ 03426000
*                    /*  PARAMETER FAILED, RETURN TO THE     @Y30SSFR*/ 03427000
*                    /*  CALLER.                             @Y30SSFR*/ 03428000
*                    /*                                      @Y30SSFR*/ 03429000
*                    /************************************************/ 03430000
*                    IF LASTCC^=0                                  0771 03431000
*                      THEN                                        0771 03432000
@RC00741 L     @04,@PC00001+16                                     0771 03433000
         LH    @04,LASTCC(,@04)                                    0771 03434000
         LTR   @04,@04                                             0771 03435000
         BNZ   @RT00771                                            0771 03436000
*                        RETURN;                           /*#YL026UL*/ 03437000
*                  END DOLOOP30;                           /*#YL026UL*/ 03438000
*                                                                  0773 03439000
@DE00730 TM    ALLOK,B'00100000'                                   0773 03440000
         BZ    @DL00730                                            0773 03441000
*          /**********************************************************/ 03442000
*          /*                                                @YL026UL*/ 03443000
*          /* PREPARE MOVE THE NEXT LIST ELEMENT (IN CASE    @YL026UL*/ 03444000
*          /* THERE IS ONE) FROM THE PDE INTO THE FDT.       @YL026UL*/ 03445000
*          /*                                                @YL026UL*/ 03446000
*          /**********************************************************/ 03447000
*          IF LIST=YES                                             0774 03448000
*            THEN                                                  0774 03449000
@RC00697 DS    0H                                                  0774 03450000
@RC00686 LH    @04,PARMID                                          0774 03451000
         MH    @04,@CH00038                                        0774 03452000
         L     @02,PINFOPTR                                        0774 03453000
         AL    @02,@CF01818                                        0774 03454000
         L     @04,PARMPTR(@04,@02)                                0774 03455000
         TM    LIST(@04),B'00001000'                               0774 03456000
         BNO   @RF00774                                            0774 03457000
*              DO;                                         /*@YL026UL*/ 03458000
*              DATAPTR=DATAPTR+SPACEAMT;                   /*@YL026UL*/ 03459000
         AL    DATAPTR,SPACEAMT                                    0776 03460000
*              IF NAMEPDE=NO                                       0777 03461000
*                THEN                                              0777 03462000
         TM    NAMEPDE,B'00001000'                                 0777 03463000
         BNZ   @RF00777                                            0777 03464000
*                  PDEPTR=NXTCPDE;                         /*@YL026UL*/ 03465000
         L     PDEPTR,NXTCPDE(,PDEPTR)                             0778 03466000
*                ELSE                                              0779 03467000
*                  PDEPTR=NXTDPDE;                         /*@YL026UL*/ 03468000
         B     @RC00777                                            0779 03469000
@RF00777 L     PDEPTR,NXTDPDE(,PDEPTR)                             0779 03470000
*              END;                                        /*@YL026UL*/ 03471000
*                                                                  0780 03472000
@RC00777 DS    0H                                                  0781 03473000
*        END DOLOOP20;                                     /*@YL026UL*/ 03474000
*                                                                  0781 03475000
@RF00774 AL    INDEX7,@CF00227                                     0781 03476000
@DE00684 CH    INDEX7,LISTTOTL                                     0781 03477000
         BNH   @DL00684                                            0781 03478000
*/********************************************************************/ 03479000
*/*                                                          @YL026UL*/ 03480000
*/*  PROCEDURE NAME - GETSPACE                               @YL026UL*/ 03481000
*/*                                                          @YL026UL*/ 03482000
*/*  FUNCTION - THIS ROUTINE ALLOCATES STORAGE SPACE FOR FDT @YL026UL*/ 03483000
*/*             DATA SUBSTRUCTURES, BASED UPON THE TYPE OF   @YL026UL*/ 03484000
*/*             PARAMETER CURRENTLY BEING TRANSLATED TO FDT  @YL026UL*/ 03485000
*/*             FORM.  IF THE PARAMETER IS A LIST, THEN THE  @YL026UL*/ 03486000
*/*             NUMBER OF ELEMENTS IN THE LIST IS COUNTED    @YL026UL*/ 03487000
*/*             AND SPACE ENOUGH IS ALLOCATED FOR THEM ALL.  @YL026UL*/ 03488000
*/*                                                          @YL026UL*/ 03489000
*/*  INPUT -                                                 @YL026UL*/ 03490000
*/*            COMMAND DESCRIPTOR ENTRY FOR CURRENT PARM.    @YL026UL*/ 03491000
*/*            SINGLPRM- FLAG SET 'ON' IF THE INPUT PARM     @YL026UL*/ 03492000
*/*                      HAS JUST A SINGLE ITEM OF DATA.     @YL026UL*/ 03493000
*/*            PDEPTR -  POINTER TO PDE FOR CURRENT PARM.    @YL026UL*/ 03494000
*/*            NAMEPDE - FLAG SET SO AS TO IDENTIFY THE      @YL026UL*/ 03495000
*/*                      FORMAT OF THE PDE.                  @YL026UL*/ 03496000
*/*            BLKLEFT - AMOUNT OF SPACE REMAINING IN DATA   @YL026UL*/ 03497000
*/*                      BLOCK FROM WHICH FDT SUBSTRUCTURE   @YL026UL*/ 03498000
*/*                      SPACE IS TO BE ALLOCATED.           @YL026UL*/ 03499000
*/*                                                          @YL026UL*/ 03500000
*/*  OUTPUT -                                                @YL026UL*/ 03501000
*/*            SPACEAMT- AMOUNT OF SPACE REQUIRED FOR A      @YL026UL*/ 03502000
*/*                      SINGLE DATA ITEM (AND ITS ASSOC'D   @YL026UL*/ 03503000
*/*                      LENGTHS, FLAGS, ETC.) OF THE DATA   @YL026UL*/ 03504000
*/*                      TYPE OF THE CURRENT PARAMETER.      @YL026UL*/ 03505000
*/*            LISTTOTL- NUMBER OF INPUT LIST ELEMENTS IF    @YL026UL*/ 03506000
*/*                      CURRENT PARM MAY BE A LIST.         @YL026UL*/ 03507000
*/*            BLKPTR -  POINTER TO NEXT AVAILABLE LOCATION  @YL026UL*/ 03508000
*/*                      FROM WHICH SPACE MAY BE ALLOCATED   @YL026UL*/ 03509000
*/*                      FOR FDT DATA SUBSTRUCTURES.         @YL026UL*/ 03510000
*/*            BLKLEFT - AMOUNT OF SPACE AVAILABLE IN DATA   @YL026UL*/ 03511000
*/*                      BLOCK AFTER CURRENT ALLOCATION IS   @YL026UL*/ 03512000
*/*                      DONE.                               @YL026UL*/ 03513000
*/*            DATAPTR - POINTER TO SPACE ALLOCATED FOR      @YL026UL*/ 03514000
*/*                      CURRENT DATA SUBSTRUCTURE.          @YL026UL*/ 03515000
*/*            FDT -     FDT POINTER TO DATA SUBSTRUCTURE.   @YL026UL*/ 03516000
*/*            LASTCC -  AMS CONDITION CODE.                 @YL026UL*/ 03517000
*/*                                                          @YL026UL*/ 03518000
*/********************************************************************/ 03519000
*GETSPACE:PROCEDURE;                                       /*@YL026UL*/ 03520000
         B     @PB00009                                            0782 03521000
GETSPACE STM   @14,@02,@SA00009                                    0782 03522000
         STM   @04,@06,@SA00009+20                                 0782 03523000
         STM   @08,@12,@SA00009+32                                 0782 03524000
*        /************************************************************/ 03525000
*        /*                                                  @YL026UL*/ 03526000
*        /*  ** GETSPACE **  DATA DECLARATIONS               @YL026UL*/ 03527000
*        /*                                                  @YL026UL*/ 03528000
*        /************************************************************/ 03529000
*                                                                  0783 03530000
*        DCL NEXTPDE  PTR(31);         /*PTR TO NEXT PDE IN  @YL026UL*/ 03531000
*                                      /*A PDE CHAIN         @YL026UL*/ 03532000
*        /************************************************************/ 03533000
*        /*                                                  @YL026UL*/ 03534000
*        /*  ** GETSPACE **  GET SPACE FOR FDT SUBSTRUCTURES @YL026UL*/ 03535000
*        /*                                                  @YL026UL*/ 03536000
*        /************************************************************/ 03537000
*        OLDERID2 = NEWERID2;                                      0784 03538000
         L     @02,GDTTR2(,GDTPTR)                                 0784 03539000
         MVC   @TS00001(95),NEWERID2(@02)                          0784 03540000
         MVC   OLDERID2(95,@02),@TS00001                           0784 03541000
*        NEWID2='RI24';                                    /*@YL026UL*/ 03542000
*                                                                  0785 03543000
         MVC   NEWID2(4,@02),@CC01681                              0785 03544000
*        /************************************************************/ 03545000
*        /*                                                  @YL026UL*/ 03546000
*        /* USE THE CURRENT PARAMETER'S DATA TYPE TO FIGURE  @YL026UL*/ 03547000
*        /* THE AMOUNT OF SPACE THE DATA SUBSTRUCTURE WILL   @YL026UL*/ 03548000
*        /* REQUIRE FOR A SINGLE ITEM OF THAT DATA TYPE.     @YL026UL*/ 03549000
*        /*                                                  @YL026UL*/ 03550000
*        /************************************************************/ 03551000
*        IF NUMBER=YES                                             0786 03552000
*          THEN                                                    0786 03553000
         LA    @02,12                                              0786 03554000
         LR    @15,@02                                             0786 03555000
         MH    @15,PARMID                                          0786 03556000
         L     @01,PINFOPTR                                        0786 03557000
         AL    @01,@CF01818                                        0786 03558000
         AL    @02,PARMPTR(@15,@01)                                0786 03559000
         TM    NUMBER(@02),B'10000000'                             0786 03560000
         BNO   @RF00786                                            0786 03561000
*            SPACEAMT=LENGTH(FULLWORD);                    /*@YL026UL*/ 03562000
         MVC   SPACEAMT(4),@CF00050                                0787 03563000
*          ELSE                                                    0788 03564000
*            IF DSNAM=YES                                          0788 03565000
*              THEN                                                0788 03566000
         B     @RC00786                                            0788 03567000
@RF00786 LA    @02,12                                              0788 03568000
         LR    @15,@02                                             0788 03569000
         MH    @15,PARMID                                          0788 03570000
         L     @01,PINFOPTR                                        0788 03571000
         AL    @01,@CF01818                                        0788 03572000
         AL    @02,PARMPTR(@15,@01)                                0788 03573000
         TM    DSNAM(@02),B'00100000'                              0788 03574000
         BNO   @RF00788                                            0788 03575000
*                SPACEAMT=LENGTH(DSNSTRCT);                /*@YL026UL*/ 03576000
         MVC   SPACEAMT(4),@CF01803                                0789 03577000
*              ELSE                                                0790 03578000
*                IF ANYSTRNG=YES                                   0790 03579000
*                  THEN                                            0790 03580000
         B     @RC00788                                            0790 03581000
@RF00788 LA    @02,12                                              0790 03582000
         LR    @15,@02                                             0790 03583000
         MH    @15,PARMID                                          0790 03584000
         L     @01,PINFOPTR                                        0790 03585000
         AL    @01,@CF01818                                        0790 03586000
         AL    @02,PARMPTR(@15,@01)                                0790 03587000
         TM    ANYSTRNG(@02),B'01000000'                           0790 03588000
         BNO   @RF00790                                            0790 03589000
*                    DO;                                   /*@YL026UL*/ 03590000
*                    SPACEAMT=LENGTH(STRNG1LN)+MAXLNGTH;   /*@YL026UL*/ 03591000
         LA    @15,1                                               0792 03592000
         SLR   @14,@14                                             0792 03593000
         IC    @14,MAXLNGTH(,@02)                                  0792 03594000
         ALR   @15,@14                                             0792 03595000
         ST    @15,SPACEAMT                                        0792 03596000
*                    IF PWORDOPT=YES                               0793 03597000
*                      THEN                                        0793 03598000
         TM    PWORDOPT(@02),B'00000010'                           0793 03599000
         BNO   @RF00793                                            0793 03600000
*                        SPACEAMT=SPACEAMT+LENGTH(PWORD)+          0794 03601000
*                             LENGTH(STRPWLEN);            /*@YL026UL*/ 03602000
         AL    @15,@CF00041                                        0794 03603000
         ST    @15,SPACEAMT                                        0794 03604000
*                    END;                                  /*@YL026UL*/ 03605000
@RF00793 DS    0H                                                  0796 03606000
*        SPACEAMT=SPACEAMT+SPACEAMT//2;                    /*@YL026UL*/ 03607000
*                                                                  0796 03608000
@RF00790 DS    0H                                                  0796 03609000
@RC00788 DS    0H                                                  0796 03610000
@RC00786 L     @02,SPACEAMT                                        0796 03611000
         LR    @00,@02                                             0796 03612000
         SRDA  @00,32                                              0796 03613000
         D     @00,@CF00161                                        0796 03614000
         ALR   @02,@00                                             0796 03615000
         ST    @02,SPACEAMT                                        0796 03616000
*        /************************************************************/ 03617000
*        /*                                                  @YL026UL*/ 03618000
*        /* IF THE PARAMETER MAY BE A LIST OF ITEMS, COUNT   @YL026UL*/ 03619000
*        /* THE NUMBER OF ITEMS IN THE LIST AND ALLOCATE     @YL026UL*/ 03620000
*        /* SPACE ENOUGH FOR ALL OF THEM.  COUNT THEM BY     @YL026UL*/ 03621000
*        /* STEPPING THROUGH THE PDE CHAIN UNTIL THE CHAIN-  @YL026UL*/ 03622000
*        /* END POINTER IS FOUND.  IF NO LIST IS INPUT, THE  @YL026UL*/ 03623000
*        /* COUNT IS 1.                                      @YL026UL*/ 03624000
*        /*                                                  @YL026UL*/ 03625000
*        /************************************************************/ 03626000
*        LISTTOTL=1;                                       /*@YL026UL*/ 03627000
         MVC   LISTTOTL(2),@CH00227                                0797 03628000
*        IF LIST=NO | (LIST=YES & SINGLPRM=YES)                    0798 03629000
*          THEN                                                    0798 03630000
         LH    @02,PARMID                                          0798 03631000
         MH    @02,@CH00038                                        0798 03632000
         L     @01,PINFOPTR                                        0798 03633000
         AL    @01,@CF01818                                        0798 03634000
         L     @02,PARMPTR(@02,@01)                                0798 03635000
         TM    LIST(@02),B'00001000'                               0798 03636000
         BZ    @RT00798                                            0798 03637000
         TM    LIST(@02),B'00001000'                               0798 03638000
         BNO   @RF00798                                            0798 03639000
         TM    SINGLPRM,B'01000000'                                0798 03640000
         BNO   @RF00798                                            0798 03641000
@RT00798 DS    0H                                                  0799 03642000
*            AMTTOGET=SPACEAMT+LENGTH(NUMBRCNT);           /*@YL026UL*/ 03643000
         LA    @02,4                                               0799 03644000
         AL    @02,SPACEAMT                                        0799 03645000
         ST    @02,AMTTOGET                                        0799 03646000
*          ELSE                                                    0800 03647000
*            DO;                                           /*@YL026UL*/ 03648000
         B     @RC00798                                            0800 03649000
@RF00798 DS    0H                                                  0801 03650000
*              BASEPTR=PDEPTR;                             /*@YL026UL*/ 03651000
         LR    BASEPTR,PDEPTR                                      0801 03652000
*              IF NAMEPDE=NO                                       0802 03653000
*                THEN                                              0802 03654000
         TM    NAMEPDE,B'00001000'                                 0802 03655000
         BNZ   @RF00802                                            0802 03656000
*                  NEXTPDE=NXTCPDE;                        /*@YL026UL*/ 03657000
         L     NEXTPDE,NXTCPDE(,PDEPTR)                            0803 03658000
*                ELSE                                              0804 03659000
*                  NEXTPDE=NXTDPDE;                        /*@YL026UL*/ 03660000
*                                                                  0804 03661000
         B     @RC00802                                            0804 03662000
@RF00802 L     NEXTPDE,NXTDPDE(,PDEPTR)                            0804 03663000
*              CNTDONE=NO;                                 /*@YL026UL*/ 03664000
@RC00802 NI    CNTDONE,B'11111011'                                 0805 03665000
*DOLOOP32:     DO WHILE(CNTDONE=NO & NEXTPDE^=CHAINEND);   /*@YL026UL*/ 03666000
DOLOOP32 B     @DE00806                                            0806 03667000
@DL00806 DS    0H                                                  0807 03668000
*                LISTTOTL=LISTTOTL+1;                      /*@YL026UL*/ 03669000
*                                                                  0807 03670000
         LA    @05,1                                               0807 03671000
         AH    @05,LISTTOTL                                        0807 03672000
         STH   @05,LISTTOTL                                        0807 03673000
*                /****************************************************/ 03674000
*                /*                                          @YL026UL*/ 03675000
*                /* IF THE LIST HAS MORE ELEMENTS THAN THIS  @YL026UL*/ 03676000
*                /* PARAMETER ALLOWS, IGNORE THE EXCESS IF   @YL026UL*/ 03677000
*                /* THE USER SO INDICATES; OTHERWISE,        @YL026UL*/ 03678000
*                /* DISCONTINUE PROCESSING.                  @YL026UL*/ 03679000
*                /*                                          @YL026UL*/ 03680000
*                /****************************************************/ 03681000
*                IF LISTTOTL > LISTMAX                             0808 03682000
*                  THEN                                            0808 03683000
         LA    @03,12                                              0808 03684000
         LR    @15,@03                                             0808 03685000
         MH    @15,PARMID                                          0808 03686000
         L     @01,PINFOPTR                                        0808 03687000
         AL    @01,@CF01818                                        0808 03688000
         AL    @03,PARMPTR(@15,@01)                                0808 03689000
         SLR   @15,@15                                             0808 03690000
         IC    @15,LISTMAX(,@03)                                   0808 03691000
         CR    @05,@15                                             0808 03692000
         BNH   @RF00808                                            0808 03693000
*                    DO;                                   /*@YL026UL*/ 03694000
*                    PDEPTR=NEXTPDE;                       /*@YL026UL*/ 03695000
         LR    PDEPTR,NEXTPDE                                      0810 03696000
*                    CNTDONE=YES;                          /*@YL026UL*/ 03697000
*                                                                  0811 03698000
         OI    CNTDONE,B'00000100'                                 0811 03699000
*                    CALL TOOMANY;                         /*@YL026UL*/ 03700000
*                                                                  0812 03701000
         BAL   @14,TOOMANY                                         0812 03702000
*                    /************************************************/ 03703000
*                    /*                                      @Y30SSFR*/ 03704000
*                    /*  THE USER WILL NOT PERMIT THE        @Y30SSFR*/ 03705000
*                    /*  DISCARD OF EXCESS OF EXCESS         @Y30SSFR*/ 03706000
*                    /*  PARAMETERS.  RETURN TO THE CALLER.  @Y30SSFR*/ 03707000
*                    /*                                      @Y30SSFR*/ 03708000
*                    /************************************************/ 03709000
*                    IF LASTCC ^= 0                                0813 03710000
*                      THEN                                        0813 03711000
         L     @05,@PC00001+16                                     0813 03712000
         LH    @05,LASTCC(,@05)                                    0813 03713000
         LTR   @05,@05                                             0813 03714000
         BNZ   @RT00813                                            0813 03715000
*                        RETURN;                           /*#YL026UL*/ 03716000
*                    END;                                  /*#YL026UL*/ 03717000
*                                                                  0815 03718000
*                  /**************************************************/ 03719000
*                  /*                                        #YL026UL*/ 03720000
*                  /* POINT TO THE NEXT PDE OF THE CHAIN     #YL026UL*/ 03721000
*                  /*                                        #YL026UL*/ 03722000
*                  /**************************************************/ 03723000
*                  ELSE                                            0816 03724000
*                    DO;                                   /*#YL026UL*/ 03725000
         B     @RC00808                                            0816 03726000
@RF00808 DS    0H                                                  0817 03727000
*                    PDEPTR=NEXTPDE;                       /*#YL026UL*/ 03728000
         LR    PDEPTR,NEXTPDE                                      0817 03729000
*                    IF NAMEPDE=NO                                 0818 03730000
*                      THEN                                        0818 03731000
         TM    NAMEPDE,B'00001000'                                 0818 03732000
         BNZ   @RF00818                                            0818 03733000
*                        NEXTPDE=NXTCPDE;                  /*#YL026UL*/ 03734000
         L     NEXTPDE,NXTCPDE(,PDEPTR)                            0819 03735000
*                      ELSE                                        0820 03736000
*                        NEXTPDE=NXTDPDE;                  /*#YL026UL*/ 03737000
         B     @RC00818                                            0820 03738000
@RF00818 L     NEXTPDE,NXTDPDE(,PDEPTR)                            0820 03739000
*                    END;                                  /*#YL026UL*/ 03740000
*                                                                  0821 03741000
@RC00818 DS    0H                                                  0822 03742000
*              END DOLOOP32;                               /*#YL026UL*/ 03743000
@RC00808 DS    0H                                                  0822 03744000
@DE00806 TM    CNTDONE,B'00000100'                                 0822 03745000
         BNZ   @DC00806                                            0822 03746000
         CL    NEXTPDE,CHAINEND                                    0822 03747000
         BNE   @DL00806                                            0822 03748000
@DC00806 DS    0H                                                  0823 03749000
*              PDEPTR=BASEPTR;                             /*#YL026UL*/ 03750000
         LR    PDEPTR,BASEPTR                                      0823 03751000
*              AMTTOGET=SPACEAMT*LISTTOTL+LENGTH(NUMBRCNT);/*#YL026UL*/ 03752000
         L     @02,SPACEAMT                                        0824 03753000
         MH    @02,LISTTOTL                                        0824 03754000
         AL    @02,@CF00050                                        0824 03755000
         ST    @02,AMTTOGET                                        0824 03756000
*            END;                                          /*@YL026UL*/ 03757000
*                                                                  0825 03758000
*        /************************************************************/ 03759000
*        /*                                                  @YL026UL*/ 03760000
*        /* ALLOCATE THE SPACE FROM THE MAIN BLOCK OF CORE   @YL026UL*/ 03761000
*        /* PREVIOUSLY ALLOCATED.  IF INSUFFICIENT SPACE     @YL026UL*/ 03762000
*        /* REMAINS IN THIS BLOCK OF STORAGE, ALLOCATE       @YL026UL*/ 03763000
*        /* ANOTHER ONE.                                     @YL026UL*/ 03764000
*        /*                                                  @YL026UL*/ 03765000
*        /************************************************************/ 03766000
*        IF BLKLEFT-AMTTOGET < 0                                   0826 03767000
*          THEN                                                    0826 03768000
@RC00798 L     @02,AMTTOGET                                        0826 03769000
         L     @15,BLKLEFT                                         0826 03770000
         SLR   @15,@02                                             0826 03771000
         LTR   @15,@15                                             0826 03772000
         BNM   @RF00826                                            0826 03773000
*            DO;                                           /*@YL026UL*/ 03774000
*              IF AMTTOGET >'400'X THEN /* NEED GT 1024      @ZA15054*/ 03775000
         C     @02,@CF01684                                        0828 03776000
         BNH   @RF00828                                            0828 03777000
*                BLKLEFT=AMTTOGET;      /* YES,GET EXACT AMT @ZA15054*/ 03778000
         ST    @02,BLKLEFT                                         0829 03779000
*              ELSE                     /* NO, GET 1024      @ZA15054*/ 03780000
*            BLKLEFT='400'X;                               /*@YL026UL*/ 03781000
*                                                                  0830 03782000
         B     @RC00828                                            0830 03783000
@RF00828 LA    @02,1024                                            0830 03784000
         ST    @02,BLKLEFT                                         0830 03785000
*            CALL IDCSAGP0(GDTTBL,BLKLEFT,BLKPTR,                  0831 03786000
*                   SPACEID,SETZERO);                      /*@YL026UL*/ 03787000
@RC00828 ST    GDTPTR,@AL00001                                     0831 03788000
         LA    @04,BLKLEFT                                         0831 03789000
         ST    @04,@AL00001+4                                      0831 03790000
         LA    @04,BLKPTR                                          0831 03791000
         ST    @04,@AL00001+8                                      0831 03792000
         L     @04,@PC00001+8                                      0831 03793000
         ST    @04,@AL00001+12                                     0831 03794000
         LA    @04,SETZERO                                         0831 03795000
         ST    @04,@AL00001+16                                     0831 03796000
         MVI   @AL00001+16,X'80'                                   0831 03797000
         L     @15,GDTGPL(,GDTPTR)                                 0831 03798000
         LA    @01,@AL00001                                        0831 03799000
         BALR  @14,@15                                             0831 03800000
*            RESPECIFY RTNREG RSTD;                                0832 03801000
*            TESTRC = RTNREG;                                      0833 03802000
         LR    TESTRC,RTNREG                                       0833 03803000
*            RESPECIFY RTNREG UNRSTD;                      /*@YL026UL*/ 03804000
*                                                                  0834 03805000
*            /********************************************************/ 03806000
*            /*                                              @Y30SSFR*/ 03807000
*            /*  IF UGPOOL WAS NOT ABLE TO OBTAIN THE        @Y30SSFR*/ 03808000
*            /*  NECESSARY STORAGE, CALL FAILSPAC TO         @Y30SSFR*/ 03809000
*            /*  HANDLE THE ERROR, AND RETURN TO THE CALLER. @Y30SSFR*/ 03810000
*            /*                                              @Y30SSFR*/ 03811000
*            /********************************************************/ 03812000
*            IF TESTRC^=0                                          0835 03813000
*              THEN                                                0835 03814000
         LTR   TESTRC,TESTRC                                       0835 03815000
         BZ    @RF00835                                            0835 03816000
*                DO;                                       /*@YL026UL*/ 03817000
*                                                                  0836 03818000
*                CALL FAILSPAC;                            /*@YL026UL*/ 03819000
*                                                                  0837 03820000
         BAL   @14,FAILSPAC                                        0837 03821000
*                RETURN;                                   /*@YL026UL*/ 03822000
@EL00009 DS    0H                                                  0838 03823000
@EF00009 DS    0H                                                  0838 03824000
@ER00009 LM    @14,@02,@SA00009                                    0838 03825000
         LM    @04,@06,@SA00009+20                                 0838 03826000
         LM    @08,@12,@SA00009+32                                 0838 03827000
         BR    @14                                                 0838 03828000
*                END;                                      /*@YL026UL*/ 03829000
*                                                                  0839 03830000
*            END;                                          /*@YL026UL*/ 03831000
@RF00835 DS    0H                                                  0841 03832000
*        DATAPTR=BLKPTR;                                   /*@YL026UL*/ 03833000
@RF00826 L     @02,BLKPTR                                          0841 03834000
         LR    DATAPTR,@02                                         0841 03835000
*        BLKPTR=BLKPTR+AMTTOGET+(4-AMTTOGET//4);           /*@YL026UL*/ 03836000
         L     @15,AMTTOGET                                        0842 03837000
         ALR   @02,@15                                             0842 03838000
         LR    @00,@15                                             0842 03839000
         SRDA  @00,32                                              0842 03840000
         D     @00,@CF00050                                        0842 03841000
         LCR   @00,@00                                             0842 03842000
         AL    @00,@CF00050                                        0842 03843000
         ALR   @02,@00                                             0842 03844000
         ST    @02,BLKPTR                                          0842 03845000
*        BLKLEFT=BLKLEFT-(BLKPTR-DATAPTR);                 /*@YL026UL*/ 03846000
*                                                                  0843 03847000
         LCR   @02,@02                                             0843 03848000
         ALR   @02,DATAPTR                                         0843 03849000
         AL    @02,BLKLEFT                                         0843 03850000
         ST    @02,BLKLEFT                                         0843 03851000
*        /************************************************************/ 03852000
*        /*                                                  @YL026UL*/ 03853000
*        /* PLACE THE POINTER TO THE FDT DATA SUBSTRUCTURE   @YL026UL*/ 03854000
*        /* JUST ALLOCATED INTO THE PRIMARY OR SECONDARY FDT @YL026UL*/ 03855000
*        /* POINTER LOCATION FOR THE CURRENT PARAMETER.      @YL026UL*/ 03856000
*        /*                                                  @YL026UL*/ 03857000
*        /************************************************************/ 03858000
*        IF OCCURNUM > 1                                           0844 03859000
*          THEN                                                    0844 03860000
         LH    @02,PARMID                                          0844 03861000
         LA    @15,12                                              0844 03862000
         LR    @01,@02                                             0844 03863000
         MR    @00,@15                                             0844 03864000
         L     @14,PINFOPTR                                        0844 03865000
         AL    @14,@CF01818                                        0844 03866000
         L     @01,PARMPTR(@01,@14)                                0844 03867000
         CLC   OCCURNUM(3,@01),@CF00227+1                          0844 03868000
         BNH   @RF00844                                            0844 03869000
*            VECTRVAL=DATAPTR;                             /*@YL026UL*/ 03870000
         SLA   @02,2                                               0845 03871000
         L     @14,@PC00001+4                                      0845 03872000
         L     @01,FDTADDR(,@14)                                   0845 03873000
         MH    @15,REPINDEX                                        0845 03874000
         L     @14,RSIPTR                                          0845 03875000
         BCTR  @14,0                                               0845 03876000
         BCTR  @14,0                                               0845 03877000
         LH    @15,VECTRDSP-10(@15,@14)                            0845 03878000
         AL    @15,FDTPTR-4(@02,@01)                               0845 03879000
         ST    DATAPTR,VECTRVAL(,@15)                              0845 03880000
*          ELSE                                                    0846 03881000
*            FDTPTR(PARMID)=DATAPTR;                       /*@YL026UL*/ 03882000
*                                                                  0846 03883000
         B     @RC00844                                            0846 03884000
@RF00844 LH    @02,PARMID                                          0846 03885000
         SLA   @02,2                                               0846 03886000
         L     @15,@PC00001+4                                      0846 03887000
         L     @01,FDTADDR(,@15)                                   0846 03888000
         ST    DATAPTR,FDTPTR-4(@02,@01)                           0846 03889000
*        END GETSPACE;                                     /*@YL026UL*/ 03890000
*                                                                  0847 03891000
*                                                                  0847 03892000
         B     @EL00009                                            0847 03893000
*        END BUILDFDT;                                     /*@YL026UL*/ 03894000
@EL00008 DS    0H                                                  0848 03895000
@EF00008 DS    0H                                                  0848 03896000
@ER00008 LM    @14,@02,@SA00008                                    0848 03897000
         LM    @04,@06,@SA00008+20                                 0848 03898000
         LM    @08,@12,@SA00008+32                                 0848 03899000
         BR    @14                                                 0848 03900000
*/********************************************************************/ 03901000
*/*                                                          @YL026UL*/ 03902000
*/*  PROCEDURE NAME - NEWPARM                                @YL026UL*/ 03903000
*/*                                                          @YL026UL*/ 03904000
*/*  FUNCTION - THIS ROUTINE PROMPTS FOR A NEW CONSTANT OR   @YL026UL*/ 03905000
*/*             REPEATED SUBPARAMETER LIST REPETITION TO     @YL026UL*/ 03906000
*/*             REPLACE ONE THAT HAS BEEN FOUND TO BE        @YL026UL*/ 03907000
*/*             SEMANTICALLY INVALID.                        @YL026UL*/ 03908000
*/*                                                          @YL026UL*/ 03909000
*/*  INPUT -                                                 @YL026UL*/ 03910000
*/*            COMMAND DESCRIPTOR ENTRY FOR CURRENT PARM.    @YL026UL*/ 03911000
*/*            PDE -     ENTRY CONTAINING INVALID DATA.      @YL026UL*/ 03912000
*/*            NAMEPDE - FLAG SET TO INDICATE THE FORMAT     @YL026UL*/ 03913000
*/*                      OF THE PDE FOR THE CURRENT PARM.    @YL026UL*/ 03914000
*/*            PARMID -  PARM ID# OF PARM WITH INVALID DATA  @YL026UL*/ 03915000
*/*            ERRORID - TEXT ID# FOR ERROR MSG PERTAINING   @YL026UL*/ 03916000
*/*                      TO CURRENT INVALID DATA.            @YL026UL*/ 03917000
*/*            ERRORPCL- PTR TO PCL DESCRIBING A SINGLE ITEM @YL026UL*/ 03918000
*/*                      OF THE DATA TYPE WHICH IS IN ERROR. @YL026UL*/ 03919000
*/*            PDLPTR -  PTR TO PDL CONTAINING BAD DATA ITEM @YL026UL*/ 03920000
*/*                                                          @YL026UL*/ 03921000
*/*  OUTPUT -                                                @YL026UL*/ 03922000
*/*            PDE -     NEW PDE SECTION CONTAINING NEW DATA @YL026UL*/ 03923000
*/*                      ITEM REPLACING THE INVALID DATA.    @YL026UL*/ 03924000
*/*            LASTCC -  AMS CONDITION CODE.                 @YL026UL*/ 03925000
*/*                                                          @YL026UL*/ 03926000
*/********************************************************************/ 03927000
*NEWPARM:PROCEDURE(ERRORID,ERRORPCL);                      /*@YL026UL*/ 03928000
NEWPARM  STM   @14,@12,@SA00010                                    0849 03929000
         MVC   @PC00010(8),0(@01)                                  0849 03930000
*        /************************************************************/ 03931000
*        /*                                                  @YL026UL*/ 03932000
*        /*  ** NEWPARM  **  DATA DEFINITIONS                @YL026UL*/ 03933000
*        /*                                                  @YL026UL*/ 03934000
*        /************************************************************/ 03935000
*                                                                  0850 03936000
*        DCL ERRORID  FIXED(15);       /*ID# OF THE PARM     @YL026UL*/ 03937000
*                                      /*HAVING THE IMPROPER @YL026UL*/ 03938000
*                                      /*VALUE               @YL026UL*/ 03939000
*        DCL ERRORPCL PTR(31);         /*PTR TO THE PROPER   @YL026UL*/ 03940000
*                                      /*'STANDARD' PCL TO   @YL026UL*/ 03941000
*                                      /*BE PASSED TO PARSE  @YL026UL*/ 03942000
*                                      /*WITH THE NEW VALUE  @YL026UL*/ 03943000
*        DCL ORIGPDL  PTR(31);         /*PTR TO THE PDL THAT @YL026UL*/ 03944000
*                                      /*CONTAINED THE OLD,  @YL026UL*/ 03945000
*                                      /*INVALID VALUE       @YL026UL*/ 03946000
*        DCL NAMEPOS  FIXED(15);       /*INDEX USED FOR      @YL026UL*/ 03947000
*                                      /*RECONSTRUCTING A    @YL026UL*/ 03948000
*                                      /*DSNAME FROM A PDE.  @YL026UL*/ 03949000
*        DCL PROMPT1  FIXED(15)        /*MSG ID OF PROMPT    @YL026UL*/ 03950000
*                     CONSTANT(9);     /*FOR NEW DATA ITEM   @YL026UL*/ 03951000
*        /************************************************************/ 03952000
*        /*                                                  @YL026UL*/ 03953000
*        /*  ** NEWPARM **  OBTAIN REPLACEMENT PARM VALUE    @YL026UL*/ 03954000
*        /*                                                  @YL026UL*/ 03955000
*        /************************************************************/ 03956000
*        OLDERID2 = NEWERID2;                                      0855 03957000
         L     @07,GDTTR2(,GDTPTR)                                 0855 03958000
         MVC   @TS00001(95),NEWERID2(@07)                          0855 03959000
         MVC   OLDERID2(95,@07),@TS00001                           0855 03960000
*        NEWID2='RI26';                                    /*@YL026UL*/ 03961000
*                                                                  0856 03962000
         MVC   NEWID2(4,@07),@CC01695                              0856 03963000
*        /************************************************************/ 03964000
*        /*                                                  @YL026UL*/ 03965000
*        /* IF THE INVALID PARAMETER APPEARS WITHIN A        @YL026UL*/ 03966000
*        /* REPEATED SUBLIST, PRINT A MESSAGE IDENTIFYING    @YL026UL*/ 03967000
*        /* WHICH REPETITION CONTAINS THE ERROR.             @YL026UL*/ 03968000
*        /*                                                  @YL026UL*/ 03969000
*        /************************************************************/ 03970000
*        IF OCCURNUM > 1                                           0857 03971000
*          THEN                                                    0857 03972000
         LA    @07,12                                              0857 03973000
         LR    @02,@07                                             0857 03974000
         MH    @02,PARMID                                          0857 03975000
         L     @01,PINFOPTR                                        0857 03976000
         AL    @01,@CF01818                                        0857 03977000
         L     @02,PARMPTR(@02,@01)                                0857 03978000
         CLC   OCCURNUM(3,@02),@CF00227+1                          0857 03979000
         BNH   @RF00857                                            0857 03980000
*            DO;                                           /*@YL026UL*/ 03981000
*            EFIELD3=SBLSTNUM(REPINDEX);                   /*@YL026UL*/ 03982000
         MH    @07,REPINDEX                                        0859 03983000
         L     @02,RSIPTR                                          0859 03984000
         AL    @02,@CF01819                                        0859 03985000
         SLR   @15,@15                                             0859 03986000
         IC    @15,SBLSTNUM-8(@07,@02)                             0859 03987000
         ST    @15,EFIELD3                                         0859 03988000
*            DARGDBP=ADDR(EFIELD3);                        /*@YL026UL*/ 03989000
         L     @07,DDSTRU                                          0860 03990000
         LA    @02,EFIELD3                                         0860 03991000
         ST    @02,DARGDBP(,@07)                                   0860 03992000
*            DARGILP=LENGTH(EFIELD3);                      /*@YL026UL*/ 03993000
         MVC   DARGILP(2,@07),@CH00050                             0861 03994000
*            DARGSENT=INREP;                               /*@YL026UL*/ 03995000
*                                                                  0862 03996000
         MVI   DARGSENT(@07),X'0F'                                 0862 03997000
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         /*@YL026UL*/ 03998000
*                                                                  0863 03999000
         ST    GDTPTR,@AL00001                                     0863 04000000
         LA    @07,@CF00123                                        0863 04001000
         ST    @07,@AL00001+4                                      0863 04002000
         LA    @07,DDSTRU                                          0863 04003000
         ST    @07,@AL00001+8                                      0863 04004000
         MVI   @AL00001+8,X'80'                                    0863 04005000
         L     @15,GDTPRT(,GDTPTR)                                 0863 04006000
         LA    @01,@AL00001                                        0863 04007000
         BALR  @14,@15                                             0863 04008000
*            END;                                          /*@YL026UL*/ 04009000
*                                                                  0864 04010000
*        /************************************************************/ 04011000
*        /*                                                  @YL026UL*/ 04012000
*        /* MOVE THE INVALID CONSTANT FROM THE PDE INTO      @YL026UL*/ 04013000
*        /* THE SECOND MESSAGE INSERT FIELD.                 @YL026UL*/ 04014000
*        /*                                                  @YL026UL*/ 04015000
*        /************************************************************/ 04016000
*        EFIELD2=BLANK;                                    /*@YL026UL*/ 04017000
*                                                                  0865 04018000
@RF00857 MVI   EFIELD2+1,C' '                                      0865 04019000
         MVC   EFIELD2+2(62),EFIELD2+1                             0865 04020000
         MVI   EFIELD2,C' '                                        0865 04021000
*        /************************************************************/ 04022000
*        /*                                                  @Y30SSFR*/ 04023000
*        /*  IF THE INVALID CONSTANT IS A NUMBER, PUT THE    @Y30SSFR*/ 04024000
*        /*  NUMBER INTO THE MESSAGE.                        @Y30SSFR*/ 04025000
*        /*                                                  @Y30SSFR*/ 04026000
*        /************************************************************/ 04027000
*        IF NUMBER=YES                                             0866 04028000
*          THEN                                                    0866 04029000
         LA    @07,12                                              0866 04030000
         LR    @02,@07                                             0866 04031000
         MH    @02,PARMID                                          0866 04032000
         L     @01,PINFOPTR                                        0866 04033000
         AL    @01,@CF01818                                        0866 04034000
         AL    @07,PARMPTR(@02,@01)                                0866 04035000
         TM    NUMBER(@07),B'10000000'                             0866 04036000
         BNO   @RF00866                                            0866 04037000
*            EFIELD3=PDENUMBR;                             /*@YL026UL*/ 04038000
         L     @07,CONSTPTR(,PDEPTR)                               0867 04039000
         L     @07,PDENUMBR(,@07)                                  0867 04040000
         ST    @07,EFIELD3                                         0867 04041000
*          ELSE                                                    0868 04042000
*                                                                  0868 04043000
*            /********************************************************/ 04044000
*            /*                                              @Y30SSFR*/ 04045000
*            /*  IF THE INVALID CONSTANT IS NOT A DATA SET   @Y30SSFR*/ 04046000
*            /*  NAME AND HAS A LENGTH GREATER THAN 0,       @Y30SSFR*/ 04047000
*            /*  PUT THE CONSTANT STRING INTO THE MESSAGE.   @Y30SSFR*/ 04048000
*            /*                                              @Y30SSFR*/ 04049000
*            /********************************************************/ 04050000
*            IF NAMEPDE=NO                                         0868 04051000
*              THEN                                                0868 04052000
         B     @RC00866                                            0868 04053000
@RF00866 TM    NAMEPDE,B'00001000'                                 0868 04054000
         BNZ   @RF00868                                            0868 04055000
*                IF CONSTLEN > 0                                   0869 04056000
*                  THEN                                            0869 04057000
         LH    @07,CONSTLEN(,PDEPTR)                               0869 04058000
         LTR   @07,@07                                             0869 04059000
         BNP   @RF00869                                            0869 04060000
*                    EFIELD2=PDESTRNG(1:                           0870 04061000
*                          MIN(LENGTH(EFIELD2),CONSTLEN)); /*@YL026UL*/ 04062000
         MVI   EFIELD2+1,C' '                                      0870 04063000
         MVC   EFIELD2+2(62),EFIELD2+1                             0870 04064000
         LA    @02,64                                              0870 04065000
         CR    @07,@02                                             0870 04066000
         BNH   *+6                                                      04067000
         LR    @07,@02                                             0870 04068000
         BCTR  @07,0                                               0870 04069000
         L     @02,CONSTPTR(,PDEPTR)                               0870 04070000
         EX    @07,@SM01852                                        0870 04071000
*                  ELSE                                    /*@YL026UL*/ 04072000
*                                                                  0871 04073000
*                    /************************************************/ 04074000
*                    /*                                      @Y30SSFR*/ 04075000
*                    /*  IF LENGTH OF THE CONSTANT IS ZERO,  @Y30SSFR*/ 04076000
*                    /*  PROMPT WITH QUOTES FOR A            @Y30SSFR*/ 04077000
*                    /*  NON-REPEATED OBJECT WITH QUOTES,    @Y30SSFR*/ 04078000
*                    /*  AND FOR A REPEATED ONE WITH PARENS. @Y30SSFR*/ 04079000
*                    /*                                      @Y30SSFR*/ 04080000
*                    /************************************************/ 04081000
*                    IF REPEATED=NO                                0871 04082000
*                      THEN                                        0871 04083000
         B     @RC00869                                            0871 04084000
@RF00869 LH    @07,PARMID                                          0871 04085000
         MH    @07,@CH00038                                        0871 04086000
         L     @02,PINFOPTR                                        0871 04087000
         AL    @02,@CF01818                                        0871 04088000
         L     @07,PARMPTR(@07,@02)                                0871 04089000
         TM    REPEATED(@07),B'00100000'                           0871 04090000
         BNZ   @RF00871                                            0871 04091000
*                        DO;                               /*#YL026UL*/ 04092000
*                        EFIELD2(1)=QUOTE;                 /*#YL026UL*/ 04093000
         MVI   EFIELD2,C''''                                       0873 04094000
*                        EFIELD2(2)=QUOTE;                 /*#YL026UL*/ 04095000
         MVI   EFIELD2+1,C''''                                     0874 04096000
*                        END;                              /*#YL026UL*/ 04097000
*                      ELSE                                        0876 04098000
*                        DO;                               /*#YL026UL*/ 04099000
         B     @RC00871                                            0876 04100000
@RF00871 DS    0H                                                  0877 04101000
*                        EFIELD2(1)=PAREN;                 /*#YL026UL*/ 04102000
         MVI   EFIELD2,C'('                                        0877 04103000
*                        EFIELD2(2)=PAREN2;                /*#YL026UL*/ 04104000
         MVI   EFIELD2+1,C')'                                      0878 04105000
*                        END;                              /*#YL026UL*/ 04106000
*              ELSE                                                0880 04107000
*                                                                  0880 04108000
*                /****************************************************/ 04109000
*                /*                                          #YL026UL*/ 04110000
*                /* IF THE INVALID CONSTANT IS A DSNAME,     #YL026UL*/ 04111000
*                /* RECONSTRUCT IT -- THAT IS, APPEND THE    #YL026UL*/ 04112000
*                /* MEMBER NAME AND PASSWORD IF THEY WERE    #YL026UL*/ 04113000
*                /* CODED.                                   #YL026UL*/ 04114000
*                /*                                          #YL026UL*/ 04115000
*                /****************************************************/ 04116000
*                DO;                                       /*#YL026UL*/ 04117000
         B     @RC00868                                            0880 04118000
@RF00868 DS    0H                                                  0881 04119000
*                NAMEPOS=1;                                /*#YL026UL*/ 04120000
         LA    NAMEPOS,1                                           0881 04121000
*                IF DSNLEN > 0                                     0882 04122000
*                  THEN                                            0882 04123000
         LH    @07,DSNLEN(,PDEPTR)                                 0882 04124000
         LTR   @07,@07                                             0882 04125000
         BNP   @RF00882                                            0882 04126000
*                    DO;                                   /*#YL026UL*/ 04127000
*                    EFIELD2=PDEDSN(1:DSNLEN);             /*#YL026UL*/ 04128000
         MVI   EFIELD2+1,C' '                                      0884 04129000
         MVC   EFIELD2+2(62),EFIELD2+1                             0884 04130000
         LR    @15,@07                                             0884 04131000
         BCTR  @15,0                                               0884 04132000
         L     @01,DSNPTR(,PDEPTR)                                 0884 04133000
         EX    @15,@SM01854                                        0884 04134000
*                    NAMEPOS=NAMEPOS+DSNLEN;               /*#YL026UL*/ 04135000
         ALR   NAMEPOS,@07                                         0885 04136000
*                    END;                                  /*#YL026UL*/ 04137000
*                IF MEMIN=YES                                      0887 04138000
*                  THEN                                            0887 04139000
@RF00882 TM    MEMIN(PDEPTR),B'10000000'                           0887 04140000
         BNO   @RF00887                                            0887 04141000
*                    DO;                                   /*#YL026UL*/ 04142000
*                    EFIELD2(NAMEPOS)=PAREN;               /*#YL026UL*/ 04143000
         LA    @07,EFIELD2-1(NAMEPOS)                              0889 04144000
         MVI   0(@07),C'('                                         0889 04145000
*                    EFIELD2(NAMEPOS+1:NAMEPOS+MEMLEN)=            0890 04146000
*                                       PDEMEM(1:MEMLEN);  /*#YL026UL*/ 04147000
         LA    @07,EFIELD2(NAMEPOS)                                0890 04148000
         LH    @15,MEMLEN(,PDEPTR)                                 0890 04149000
         LR    @14,@15                                             0890 04150000
         BCTR  @14,0                                               0890 04151000
         L     @01,MEMPTR(,PDEPTR)                                 0890 04152000
         EX    @14,@SM01856                                        0890 04153000
*                    EFIELD2(NAMEPOS+MEMLEN+1)=PAREN2;     /*#YL026UL*/ 04154000
         ALR   @15,NAMEPOS                                         0891 04155000
         LA    @07,EFIELD2(@15)                                    0891 04156000
         MVI   0(@07),C')'                                         0891 04157000
*                    NAMEPOS=NAMEPOS+MEMLEN+2;             /*#YL026UL*/ 04158000
         AL    @15,@CF00161                                        0892 04159000
         LR    NAMEPOS,@15                                         0892 04160000
*                    END;                                  /*#YL026UL*/ 04161000
*                EFIELD2(NAMEPOS)=QUOTE;                   /*#YL026UL*/ 04162000
@RF00887 LA    @07,EFIELD2-1(NAMEPOS)                              0894 04163000
         MVI   0(@07),C''''                                        0894 04164000
*                NAMEPOS=NAMEPOS+1;                        /*#YL026UL*/ 04165000
         AL    NAMEPOS,@CF00227                                    0895 04166000
*                IF PWDIN=YES                                      0896 04167000
*                  THEN                                            0896 04168000
         TM    PWDIN(PDEPTR),B'10000000'                           0896 04169000
         BNO   @RF00896                                            0896 04170000
*                    DO;                                   /*#YL026UL*/ 04171000
*                    EFIELD2(NAMEPOS)=SLASH;               /*#YL026UL*/ 04172000
         LA    @07,EFIELD2-1(NAMEPOS)                              0898 04173000
         MVI   0(@07),C'/'                                         0898 04174000
*                    EFIELD2(NAMEPOS+1:NAMEPOS+PWDLEN)=            0899 04175000
*                                       PDEPWD(1:PWDLEN);  /*#YL026UL*/ 04176000
         LA    @07,EFIELD2(NAMEPOS)                                0899 04177000
         LH    @15,PWDLEN(,PDEPTR)                                 0899 04178000
         BCTR  @15,0                                               0899 04179000
         L     @01,PWDPTR(,PDEPTR)                                 0899 04180000
         EX    @15,@SM01858                                        0899 04181000
*                    END;                                  /*#YL026UL*/ 04182000
*                END;                                      /*#YL026UL*/ 04183000
*                                                                  0901 04184000
@RF00896 DS    0H                                                  0902 04185000
*        /************************************************************/ 04186000
*        /*                                                  @YL026UL*/ 04187000
*        /* MOVE THE KEYWORD MOST CLOSELY ASSOCIATED WITH    @YL026UL*/ 04188000
*        /* THE BAD CONSTANT INTO THE FIRST INSERT FIELD.    @YL026UL*/ 04189000
*        /* THEN PRINT THE ERROR MESSAGE IDENTIFYING THE     @YL026UL*/ 04190000
*        /* BAD CONSTANT.                                    @YL026UL*/ 04191000
*        /*                                                  @YL026UL*/ 04192000
*        /************************************************************/ 04193000
*        EFIELD1=BLANK;                                    /*@YL026UL*/ 04194000
*                                                                  0902 04195000
@RC00868 DS    0H                                                  0902 04196000
@RC00866 MVI   EFIELD1+1,C' '                                      0902 04197000
         MVC   EFIELD1+2(18),EFIELD1+1                             0902 04198000
         MVI   EFIELD1,C' '                                        0902 04199000
*        CALL MSGKWD(PARMID,ADDR(EFIELD1));                /*@YL026UL*/ 04200000
*                                                                  0903 04201000
         LA    @07,PARMID                                          0903 04202000
         ST    @07,@AL00001                                        0903 04203000
         LA    @07,EFIELD1                                         0903 04204000
         ST    @07,@AFTEMPS+8                                      0903 04205000
         LA    @07,@AFTEMPS+8                                      0903 04206000
         ST    @07,@AL00001+4                                      0903 04207000
         LA    @01,@AL00001                                        0903 04208000
         BAL   @14,MSGKWD                                          0903 04209000
*        DARGDBP=ADDR(EFIELD);                             /*@YL026UL*/ 04210000
         L     @07,DDSTRU                                          0904 04211000
         LA    @04,EFIELD                                          0904 04212000
         ST    @04,DARGDBP(,@07)                                   0904 04213000
*        DARGILP=LENGTH(EFIELD);                           /*@YL026UL*/ 04214000
         MVC   DARGILP(2,@07),@CH01804                             0905 04215000
*        DARGSENT=ERRORID;                                 /*@YL026UL*/ 04216000
*                                                                  0906 04217000
         L     @04,@PC00010                                        0906 04218000
         LH    @04,ERRORID(,@04)                                   0906 04219000
         STC   @04,DARGSENT(,@07)                                  0906 04220000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/ 04221000
*                                                                  0907 04222000
         ST    GDTPTR,@AL00001                                     0907 04223000
         LA    @07,@CF00123                                        0907 04224000
         ST    @07,@AL00001+4                                      0907 04225000
         LA    @07,DDSTRU                                          0907 04226000
         ST    @07,@AL00001+8                                      0907 04227000
         MVI   @AL00001+8,X'80'                                    0907 04228000
         L     @15,GDTPRT(,GDTPTR)                                 0907 04229000
         LA    @01,@AL00001                                        0907 04230000
         BALR  @14,@15                                             0907 04231000
*        /************************************************************/ 04232000
*        /*                                                  @YL026UL*/ 04233000
*        /* OBTAIN FORMATTED PROMPT MESSAGE FROM THE TEXT    @YL026UL*/ 04234000
*        /* PROCESSOR AND SEND THE MESSAGE TO THE USER,      @YL026UL*/ 04235000
*        /* PROMPTING FOR A REPLACEMENT VALUE.               @YL026UL*/ 04236000
*        /*                                                  @YL026UL*/ 04237000
*        /************************************************************/ 04238000
*        DARGSENT=PROMPT1;                                 /*@YL026UL*/ 04239000
         L     @07,DDSTRU                                          0908 04240000
         MVI   DARGSENT(@07),X'09'                                 0908 04241000
*        DARGRETP=ADDR(MSGBUFF);                           /*@YL026UL*/ 04242000
         LA    @04,MSGBUFF                                         0909 04243000
         ST    @04,DARGRETP(,@07)                                  0909 04244000
*        DARGRETL=LENGTH(MSGBUFF);                         /*@YL026UL*/ 04245000
*                                                                  0910 04246000
         MVC   DARGRETL(2,@07),@CH01454                            0910 04247000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/ 04248000
*                                                                  0911 04249000
         ST    GDTPTR,@AL00001                                     0911 04250000
         LA    @07,@CF00123                                        0911 04251000
         ST    @07,@AL00001+4                                      0911 04252000
         LA    @07,DDSTRU                                          0911 04253000
         ST    @07,@AL00001+8                                      0911 04254000
         MVI   @AL00001+8,X'80'                                    0911 04255000
         L     @15,GDTPRT(,GDTPTR)                                 0911 04256000
         LA    @01,@AL00001                                        0911 04257000
         BALR  @14,@15                                             0911 04258000
*        PMSGPTR=DARGRETP;                                 /*@YL026UL*/ 04259000
         L     @07,DDSTRU                                          0912 04260000
         L     @04,DARGRETP(,@07)                                  0912 04261000
         ST    @04,PMSGPTR                                         0912 04262000
*        PMSGLEN=DARGRETL;                                 /*@YL026UL*/ 04263000
         LH    @04,DARGRETL(,@07)                                  0913 04264000
         STH   @04,PMSGLEN                                         0913 04265000
*        DARGRETP=NULLPTR;                                 /*@YL026UL*/ 04266000
         SLR   @04,@04                                             0914 04267000
         ST    @04,DARGRETP(,@07)                                  0914 04268000
*        DARGRETL=0;                                       /*@YL026UL*/ 04269000
*                                                                  0915 04270000
         STH   @04,DARGRETL(,@07)                                  0915 04271000
*        /************************************************************/ 04272000
*        /*                                                  @Y30SSFR*/ 04273000
*        /*  ISSUE A UPROMPT TO PROMPT THE USER FOR          @Y30SSFR*/ 04274000
*        /*  ADDITIONAL INFORMATION.  IF THE UPROMPT FAILS   @Y30SSFR*/ 04275000
*        /*  SET A LASTCC OF 12, AND RETURN TO THE CALLER.   @Y30SSFR*/ 04276000
*        /*                                                  @Y30SSFR*/ 04277000
*        /************************************************************/ 04278000
*        CALL IDCSAPT0(GDTTBL,PMSGPTR,PMSGLEN,RPLYPTR,RPLYLEN);/*  0916 04279000
*                                                            #YL026UL*/ 04280000
         ST    GDTPTR,@AL00001                                     0916 04281000
         LA    @07,PMSGPTR                                         0916 04282000
         ST    @07,@AL00001+4                                      0916 04283000
         LA    @07,PMSGLEN                                         0916 04284000
         ST    @07,@AL00001+8                                      0916 04285000
         LA    @07,RPLYPTR                                         0916 04286000
         ST    @07,@AL00001+12                                     0916 04287000
         LA    @07,RPLYLEN                                         0916 04288000
         ST    @07,@AL00001+16                                     0916 04289000
         MVI   @AL00001+16,X'80'                                   0916 04290000
         L     @15,GDTPMT(,GDTPTR)                                 0916 04291000
         LA    @01,@AL00001                                        0916 04292000
         BALR  @14,@15                                             0916 04293000
*        RESPECIFY RTNREG RSTD;                                    0917 04294000
*        TESTRC = RTNREG;                                          0918 04295000
         LR    TESTRC,RTNREG                                       0918 04296000
*        RESPECIFY RTNREG UNRSTD;                          /*#YL026UL*/ 04297000
*                                                                  0919 04298000
*        IF TESTRC^=0                                              0920 04299000
*          THEN                                                    0920 04300000
         LTR   TESTRC,TESTRC                                       0920 04301000
         BZ    @RF00920                                            0920 04302000
*            DO;                                           /*@YL026UL*/ 04303000
*            LASTCC=LASTCC12;                              /*@YL026UL*/ 04304000
         L     @07,@PC00001+16                                     0922 04305000
         MVC   LASTCC(2,@07),@CH00038                              0922 04306000
*            RETURN;                                       /*@YL026UL*/ 04307000
@EL00010 DS    0H                                                  0923 04308000
@EF00010 DS    0H                                                  0923 04309000
@ER00010 LM    @14,@12,@SA00010                                    0923 04310000
         BR    @14                                                 0923 04311000
*            END;                                          /*@YL026UL*/ 04312000
*                                                                  0924 04313000
*        /************************************************************/ 04314000
*        /*                                                  @YL026UL*/ 04315000
*        /* IF THE USER GIVES A NULL REPLY AND A DEFAULT     @YL026UL*/ 04316000
*        /* VALUE EXISTS, THEN ALLOW THE DEFAULT TO BE USED  @YL026UL*/ 04317000
*        /* INSTEAD OF RE-PROMPTING FOR A REPLACEMENT VALUE. @YL026UL*/ 04318000
*        /*                                                  @YL026UL*/ 04319000
*        /************************************************************/ 04320000
*        IF RPLYLEN=0 & SUBLIST=NO & DEFAULT=YES                   0925 04321000
*          THEN                                                    0925 04322000
@RF00920 LH    @07,RPLYLEN                                         0925 04323000
         LTR   @07,@07                                             0925 04324000
         BNZ   @RF00925                                            0925 04325000
         L     @07,PINFOPTR                                        0925 04326000
         LH    @02,PARMID                                          0925 04327000
         MH    @02,@CH00038                                        0925 04328000
         LA    @01,0(@02,@07)                                      0925 04329000
         AL    @01,@CF01818                                        0925 04330000
         L     @01,PARMPTR(,@01)                                   0925 04331000
         TM    DEFAULT(@01),B'00000100'                            0925 04332000
         BNO   @RF00925                                            0925 04333000
         TM    SUBLIST(@01),B'00000010'                            0925 04334000
         BNZ   @RF00925                                            0925 04335000
*            DO;                                           /*@YL026UL*/ 04336000
*            PARMFLAG(PARMID)=PARTOSET;                    /*@YL026UL*/ 04337000
         LA    @15,1                                               0927 04338000
         BCTR  @07,0                                               0927 04339000
         BCTR  @07,0                                               0927 04340000
         STC   @15,PARMFLAG-10(@02,@07)                            0927 04341000
*            ALLOK=YES;                                    /*@YL026UL*/ 04342000
         OI    ALLOK,B'00100000'                                   0928 04343000
*            RETURN;                                       /*@YL026UL*/ 04344000
         B     @EL00010                                            0929 04345000
*            END;                                          /*@YL026UL*/ 04346000
*                                                                  0930 04347000
*        /************************************************************/ 04348000
*        /*                                                  @YL026UL*/ 04349000
*        /* SEND THE USER'S REPLY TO 'PARSE' TOGETHER WITH   @YL026UL*/ 04350000
*        /* A 'STANDARD' PCL DESCRIBING JUST THE SINGLE      @YL026UL*/ 04351000
*        /* REPLACEMENT CONSTANT.                            @YL026UL*/ 04352000
*        /*                                                  @YL026UL*/ 04353000
*        /************************************************************/ 04354000
*        PPLCBUF=RPLYPTR;                                  /*@YL026UL*/ 04355000
@RF00925 L     @02,PPLPTR                                          0931 04356000
         L     @15,RPLYPTR                                         0931 04357000
         ST    @15,PPLCBUF(,@02)                                   0931 04358000
*        ORIGPDL=PDLPTR;                                   /*@YL026UL*/ 04359000
         L     ORIGPDL,PDLPTR                                      0932 04360000
*        PPLPCL=ERRORPCL;                                  /*@YL026UL*/ 04361000
         L     @15,@PC00010+4                                      0933 04362000
         L     @15,ERRORPCL(,@15)                                  0933 04363000
         ST    @15,PPLPCL(,@02)                                    0933 04364000
*        PARSECB=0;                                        /*@YL026UL*/ 04365000
*                                                                  0934 04366000
         SLR   @15,@15                                             0934 04367000
         ST    @15,PARSECB                                         0934 04368000
*        DO; /*CALLTSSR EP(IKJPARS)MF(E,PPL)*/                     0935 04369000
*          RESPECIFY GPR01P RSTD;                                  0936 04370000
*          GPR01P = ADDR(PPL);                                     0937 04371000
         LR    GPR01P,@02                                          0937 04372000
*          IF CVTPARS = 0                                          0938 04373000
*            THEN                                                  0938 04374000
         L     @02,CVTPTR                                          0938 04375000
         C     @15,CVTPARS(,@02)                                   0938 04376000
         BNE   @RF00938                                            0938 04377000
*              GEN(LINK EP=IKJPARS);                               0939 04378000
         LINK EP=IKJPARS                                                04379000
*            ELSE                                                  0940 04380000
*              CALL CVTPARS;                                       0940 04381000
         B     @RC00938                                            0940 04382000
@RF00938 L     @02,CVTPTR                                          0940 04383000
         L     @15,CVTPARS(,@02)                                   0940 04384000
         BALR  @14,@15                                             0940 04385000
*          RESPECIFY GPR01P UNRSTD;                                0941 04386000
@RC00938 DS    0H                                                  0942 04387000
*        END;                   /*@Z40GSJG*/                       0942 04388000
*                                                                  0942 04389000
*        RESPECIFY RTNREG RSTD;                                    0943 04390000
*        TESTRC = RTNREG;                                          0944 04391000
         LR    TESTRC,RTNREG                                       0944 04392000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UL*/ 04393000
*                                                                  0945 04394000
*        /************************************************************/ 04395000
*        /*                                                  @YL026UL*/ 04396000
*        /* IF 'PARSE' IS UNSUCESSFUL, DISCONTINUE AMS       @YL026UL*/ 04397000
*        /* PROCESSING.  PRINT AN ERROR MESSAGE IF LACK OF   @YL026UL*/ 04398000
*        /* WORK SPACE CAUSED THE PROBLEM.                   @YL026UL*/ 04399000
*        /*                                                  @YL026UL*/ 04400000
*        /************************************************************/ 04401000
*        IF TESTRC^=0                                              0946 04402000
*          THEN                                                    0946 04403000
         LTR   TESTRC,TESTRC                                       0946 04404000
         BZ    @RF00946                                            0946 04405000
*            DO;                                           /*@YL026UL*/ 04406000
*            IF TESTRC=BADSPACE                                    0948 04407000
*              THEN                                                0948 04408000
*                                                                  0948 04409000
         C     TESTRC,@CF00487                                     0948 04410000
         BNE   @RF00948                                            0948 04411000
*                CALL FAILSPAC;                            /*@YL026UL*/ 04412000
*                                                                  0949 04413000
         BAL   @14,FAILSPAC                                        0949 04414000
*              ELSE                                                0950 04415000
*                LASTCC=LASTCC12;                          /*@YL026UL*/ 04416000
         B     @RC00948                                            0950 04417000
@RF00948 L     @07,@PC00001+16                                     0950 04418000
         MVC   LASTCC(2,@07),@CH00038                              0950 04419000
*            RETURN;                                       /*@YL026UL*/ 04420000
         B     @EL00010                                            0951 04421000
*            END;                                          /*@YL026UL*/ 04422000
*                                                                  0952 04423000
*        /************************************************************/ 04424000
*        /*                                                  @YL026UL*/ 04425000
*        /* MOVE THE ENCODED INFORMATION FROM THE PDE THAT   @YL026UL*/ 04426000
*        /* RESULTED FROM THE PROMPT INTO THE PDE FOR THE    @YL026UL*/ 04427000
*        /* OLD VALUE.                                       @YL026UL*/ 04428000
*        /*                                                  @YL026UL*/ 04429000
*        /************************************************************/ 04430000
*        IF NAMEPDE=NO                                             0953 04431000
*          THEN                                                    0953 04432000
@RF00946 TM    NAMEPDE,B'00001000'                                 0953 04433000
         BNZ   @RF00953                                            0953 04434000
*            MOVELEN=LENGTH(PDE1)-PTRLNGTH;                /*@YL026UL*/ 04435000
         LA    MOVELEN,8                                           0954 04436000
*          ELSE                                                    0955 04437000
*            MOVELEN=LENGTH(PDE2)-PTRLNGTH;                /*@YL026UL*/ 04438000
         B     @RC00953                                            0955 04439000
@RF00953 LA    MOVELEN,24                                          0955 04440000
*        PDEPTR->DATABLK(1:MOVELEN)=                               0956 04441000
*                    (PDLPTR+PDLHDR)->DATABLK(1:MOVELEN);  /*@YL026UL*/ 04442000
@RC00953 LR    @05,MOVELEN                                         0956 04443000
         BCTR  @05,0                                               0956 04444000
         L     @02,PDLPTR                                          0956 04445000
         EX    @05,@SM01860                                        0956 04446000
*        PDLPTR=ORIGPDL;                                   /*@YL026UL*/ 04447000
*                                                                  0957 04448000
         ST    ORIGPDL,PDLPTR                                      0957 04449000
*        END NEWPARM;                                      /*@YL026UL*/ 04450000
         B     @EL00010                                            0958 04451000
*/********************************************************************/ 04452000
*/*                                                          @YL026UL*/ 04453000
*/*  PROCEDURE NAME - TOOMANY                                @YL026UL*/ 04454000
*/*                                                          @YL026UL*/ 04455000
*/*  FUNCTION - THIS ROUTINE SENDS A MESSAGE TO THE TERMINAL @YL026UL*/ 04456000
*/*             IDENTIFYING A LIST WHICH CONTAINS TOO MANY   @YL026UL*/ 04457000
*/*             ELEMENTS.  THE USER IS THEN PROMPTED FOR A   @YL026UL*/ 04458000
*/*             REPLY INDICATING WHETHER OR NOT HE WISHES TO @YL026UL*/ 04459000
*/*             CONTINUE WITH THE EXCESS ELEMENTS BEING      @YL026UL*/ 04460000
*/*             IGNORED.                                     @YL026UL*/ 04461000
*/*                                                          @YL026UL*/ 04462000
*/*  INPUT -                                                 @YL026UL*/ 04463000
*/*            PARMID -  ID# OF PARM WHOSE LIST IS TOO LONG  @YL026UL*/ 04464000
*/*            PDE -     ENCODED LIST ELEMENTS               @YL026UL*/ 04465000
*/*            COMMAND DESCRIPTOR ENTRY FOR THIS PARM.       @YL026UL*/ 04466000
*/*            NAMEPDE - FLAG SET TO INDICATE THE FORMAT OF  @YL026UL*/ 04467000
*/*                      THIS PARM'S PDE.                    @YL026UL*/ 04468000
*/*            LISTTOTL- ELEMENT NUMBER AT WHICH DATA LIST   @YL026UL*/ 04469000
*/*                      BECOMES TOO LONG.                   @YL026UL*/ 04470000
*/*            REPCOUNT- ELEMENT NUMBER AT WHICH LIST OF     @YL026UL*/ 04471000
*/*                      SUBPARM LISTS BECOMES TOO LONG.     @YL026UL*/ 04472000
*/*                                                          @YL026UL*/ 04473000
*/*  OUTPUT -                                                @YL026UL*/ 04474000
*/*            LASTCC -  AMS CONDITION CODE; SET TO A NON-   @YL026UL*/ 04475000
*/*                      ZERO VALUE IF PROCESSING CANNOT     @YL026UL*/ 04476000
*/*                      BE CONTINUED.                       @YL026UL*/ 04477000
*/*                                                          @YL026UL*/ 04478000
*/********************************************************************/ 04479000
*TOOMANY:PROCEDURE;                                        /*@YL026UL*/ 04480000
TOOMANY  STM   @14,@12,@SA00011                                    0959 04481000
*        /************************************************************/ 04482000
*        /*                                                  @YL026UL*/ 04483000
*        /*  ** TOOMANY  **  DATA DEFINITIONS                @YL026UL*/ 04484000
*        /*                                                  @YL026UL*/ 04485000
*        /************************************************************/ 04486000
*                                                                  0960 04487000
*        DCL FOLDMASK BIT(16)          /*BIT MASK USED TO    @YL026UL*/ 04488000
*            CONSTANT('4040'X);        /*FOLD ALPHABETICS    @YL026UL*/ 04489000
*                                      /*FROM LOWER TO UPPER @YL026UL*/ 04490000
*                                      /*CASE                @YL026UL*/ 04491000
*        DCL LISTRPLY CHAR(4)          /*REPLY INDICATING    @YL026UL*/ 04492000
*                     INIT('''OK''');  /*THAT EXCESS LIST    @YL026UL*/ 04493000
*                                      /*ELEMENTS ARE TO     @YL026UL*/ 04494000
*                                      /*BE IGNORED          @YL026UL*/ 04495000
*        DCL TRUNCATE BIT(1);          /*FLAG SET 'ON' IF    @YL026UL*/ 04496000
*                                      /*USER SAYS HE WANTS  @YL026UL*/ 04497000
*                                      /*TO HAVE EXCESS LIST @YL026UL*/ 04498000
*                                      /*ELEMENTS IGNORED    @YL026UL*/ 04499000
*                                                                  0963 04500000
*        /*TEXT STRUCTURE ERROR MESSAGE ID NUMBERS           @YL026UL*/ 04501000
*        DCL BADLIST1 FIXED(15)        /*TOO LONG A LIST     @YL026UL*/ 04502000
*                     CONSTANT(4);     /*OF STRING ITEMS     @YL026UL*/ 04503000
*        DCL BADLIST2 FIXED(15)        /*TOO LONG A LIST     @YL026UL*/ 04504000
*                     CONSTANT(7);     /*OF NUMERIC ITEMS    @YL026UL*/ 04505000
*        DCL PROMPT3  FIXED(15)        /*PROMPT TO ASK IF    @YL026UL*/ 04506000
*                     CONSTANT(10);    /*EXCESS LIST ITEMS   @YL026UL*/ 04507000
*                                      /*MAY BE IGNORED      @YL026UL*/ 04508000
*        /************************************************************/ 04509000
*        /*                                                  @YL026UL*/ 04510000
*        /*  ** TOOMANY **  HANDLE 'TOO LONG A LIST' ERROR   @YL026UL*/ 04511000
*        /*                                                  @YL026UL*/ 04512000
*        /************************************************************/ 04513000
*        OLDERID2 = NEWERID2;                                      0966 04514000
         L     @07,GDTTR2(,GDTPTR)                                 0966 04515000
         MVC   @TS00001(95),NEWERID2(@07)                          0966 04516000
         MVC   OLDERID2(95,@07),@TS00001                           0966 04517000
*        NEWID2='RI28';                                    /*@YL026UL*/ 04518000
*                                                                  0967 04519000
         MVC   NEWID2(4,@07),@CC01708                              0967 04520000
*        /************************************************************/ 04521000
*        /*                                                  @YL026UL*/ 04522000
*        /* IF THE INVALID PARAMETER APPEARS WITHIN A        @YL026UL*/ 04523000
*        /* REPEATED SUBLIST, PRINT A MESSAGE IDENTIFYING    @YL026UL*/ 04524000
*        /* WHICH REPETITION CONTAINS THE ERROR.             @YL026UL*/ 04525000
*        /*                                                  @YL026UL*/ 04526000
*        /************************************************************/ 04527000
*        IF OCCURNUM > 1                                           0968 04528000
*          THEN                                                    0968 04529000
         LA    @07,12                                              0968 04530000
         LR    @02,@07                                             0968 04531000
         MH    @02,PARMID                                          0968 04532000
         L     @01,PINFOPTR                                        0968 04533000
         AL    @01,@CF01818                                        0968 04534000
         L     @02,PARMPTR(@02,@01)                                0968 04535000
         CLC   OCCURNUM(3,@02),@CF00227+1                          0968 04536000
         BNH   @RF00968                                            0968 04537000
*            DO;                                           /*@YL026UL*/ 04538000
*            EFIELD3=SBLSTNUM(REPINDEX);                   /*@YL026UL*/ 04539000
         MH    @07,REPINDEX                                        0970 04540000
         L     @02,RSIPTR                                          0970 04541000
         AL    @02,@CF01819                                        0970 04542000
         SLR   @15,@15                                             0970 04543000
         IC    @15,SBLSTNUM-8(@07,@02)                             0970 04544000
         ST    @15,EFIELD3                                         0970 04545000
*            DARGDBP=ADDR(EFIELD3);                        /*@YL026UL*/ 04546000
         L     @07,DDSTRU                                          0971 04547000
         LA    @02,EFIELD3                                         0971 04548000
         ST    @02,DARGDBP(,@07)                                   0971 04549000
*            DARGILP=LENGTH(EFIELD3);                      /*@YL026UL*/ 04550000
         MVC   DARGILP(2,@07),@CH00050                             0972 04551000
*            DARGSENT=INREP;                               /*@YL026UL*/ 04552000
*                                                                  0973 04553000
         MVI   DARGSENT(@07),X'0F'                                 0973 04554000
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         /*@YL026UL*/ 04555000
*                                                                  0974 04556000
         ST    GDTPTR,@AL00001                                     0974 04557000
         LA    @07,@CF00123                                        0974 04558000
         ST    @07,@AL00001+4                                      0974 04559000
         LA    @07,DDSTRU                                          0974 04560000
         ST    @07,@AL00001+8                                      0974 04561000
         MVI   @AL00001+8,X'80'                                    0974 04562000
         L     @15,GDTPRT(,GDTPTR)                                 0974 04563000
         LA    @01,@AL00001                                        0974 04564000
         BALR  @14,@15                                             0974 04565000
*            END;                                          /*@YL026UL*/ 04566000
*                                                                  0975 04567000
*        /************************************************************/ 04568000
*        /*                                                  @YL026UL*/ 04569000
*        /* BUILD A MESSAGE IDENTIFYING THE LIST IN ERROR    @YL026UL*/ 04570000
*        /* AND SEND IT TO THE TERMINAL USER.                @YL026UL*/ 04571000
*        /*                                                  @YL026UL*/ 04572000
*        /************************************************************/ 04573000
*        DARGDBP=ADDR(EFIELD);                             /*@YL026UL*/ 04574000
@RF00968 L     @07,DDSTRU                                          0976 04575000
         LA    @02,EFIELD                                          0976 04576000
         ST    @02,DARGDBP(,@07)                                   0976 04577000
*        DARGILP=LENGTH(EFIELD);                           /*@YL026UL*/ 04578000
         MVC   DARGILP(2,@07),@CH01804                             0977 04579000
*        EFIELD1=BLANK;                                    /*@YL026UL*/ 04580000
*                                                                  0978 04581000
         MVI   EFIELD1+1,C' '                                      0978 04582000
         MVC   EFIELD1+2(18),EFIELD1+1                             0978 04583000
         MVI   EFIELD1,C' '                                        0978 04584000
*        CALL MSGKWD(PARMID,ADDR(EFIELD1));                /*@YL026UL*/ 04585000
*                                                                  0979 04586000
         LA    @07,PARMID                                          0979 04587000
         ST    @07,@AL00001                                        0979 04588000
         LA    @07,EFIELD1                                         0979 04589000
         ST    @07,@AFTEMPS+12                                     0979 04590000
         LA    @07,@AFTEMPS+12                                     0979 04591000
         ST    @07,@AL00001+4                                      0979 04592000
         LA    @01,@AL00001                                        0979 04593000
         BAL   @14,MSGKWD                                          0979 04594000
*        /************************************************************/ 04595000
*        /*                                                  @YL026UL*/ 04596000
*        /* SUPPLY TO THE MESSAGE THE LIST ELEMENT AT WHICH  @YL026UL*/ 04597000
*        /* THE LIST BECOMES TOO LONG.  USE THE DATA TYPE    @YL026UL*/ 04598000
*        /* TO DETERMINE THE FORMAT OF THE PDE FROM WHICH    @YL026UL*/ 04599000
*        /* TO EXTRACT THE ITEM.  PRINT THE ERROR MESSAGE.   @YL026UL*/ 04600000
*        /*                                                  @YL026UL*/ 04601000
*        /************************************************************/ 04602000
*        EFIELD2=BLANK;                                    /*@YL026UL*/ 04603000
         MVI   EFIELD2+1,C' '                                      0980 04604000
         MVC   EFIELD2+2(62),EFIELD2+1                             0980 04605000
         MVI   EFIELD2,C' '                                        0980 04606000
*        IF NUMBER=YES                                             0981 04607000
*          THEN                                                    0981 04608000
         LA    @07,12                                              0981 04609000
         LR    @02,@07                                             0981 04610000
         MH    @02,PARMID                                          0981 04611000
         L     @01,PINFOPTR                                        0981 04612000
         AL    @01,@CF01818                                        0981 04613000
         AL    @07,PARMPTR(@02,@01)                                0981 04614000
         TM    NUMBER(@07),B'10000000'                             0981 04615000
         BNO   @RF00981                                            0981 04616000
*            DO;                                           /*@YL026UL*/ 04617000
*            DARGSENT=BADLIST2;                            /*@YL026UL*/ 04618000
         L     @07,DDSTRU                                          0983 04619000
         MVI   DARGSENT(@07),X'07'                                 0983 04620000
*            EFIELD3=PDENUMBR;                             /*@YL026UL*/ 04621000
         L     @07,CONSTPTR(,PDEPTR)                               0984 04622000
         L     @07,PDENUMBR(,@07)                                  0984 04623000
         ST    @07,EFIELD3                                         0984 04624000
*            END;                                          /*@YL026UL*/ 04625000
*          ELSE                                                    0986 04626000
*            DO;                                           /*@YL026UL*/ 04627000
         B     @RC00981                                            0986 04628000
@RF00981 DS    0H                                                  0987 04629000
*            DARGSENT=BADLIST1;                            /*@YL026UL*/ 04630000
*                                                                  0987 04631000
         L     @07,DDSTRU                                          0987 04632000
         MVI   DARGSENT(@07),X'04'                                 0987 04633000
*            /********************************************************/ 04634000
*            /*                                              @YL026UL*/ 04635000
*            /* MOVE INTO THE ERROR MESSAGE THE LIST ELEMENT @YL026UL*/ 04636000
*            /* AT WHICH THE LIST BECAME TOO LONG.  IF THE   @YL026UL*/ 04637000
*            /* LIST IS A LIST OF PARAMETER SETS (PSTRINGS), @YL026UL*/ 04638000
*            /* PLACE A LEADING LEFT PAREN AHEAD OF THE      @YL026UL*/ 04639000
*            /* LIST ELEMENT.                                @YL026UL*/ 04640000
*            /*                                              @YL026UL*/ 04641000
*            /********************************************************/ 04642000
*            IF REPEATED=YES                                       0988 04643000
*              THEN                                                0988 04644000
         LH    @07,PARMID                                          0988 04645000
         MH    @07,@CH00038                                        0988 04646000
         L     @02,PINFOPTR                                        0988 04647000
         AL    @02,@CF01818                                        0988 04648000
         L     @07,PARMPTR(@07,@02)                                0988 04649000
         TM    REPEATED(@07),B'00100000'                           0988 04650000
         BNO   @RF00988                                            0988 04651000
*                DO;                                       /*@YL026UL*/ 04652000
*                EFIELD2(1)=PAREN;                         /*@YL026UL*/ 04653000
         MVI   EFIELD2,C'('                                        0990 04654000
*                MOVELEN=MIN(LENGTH(EFIELD2)-1,CONSTLEN);  /*@YL026UL*/ 04655000
         LH    MOVELEN,CONSTLEN(,PDEPTR)                           0991 04656000
         LA    @07,63                                              0991 04657000
         CR    MOVELEN,@07                                         0991 04658000
         BNH   *+6                                                      04659000
         LR    MOVELEN,@07                                         0991 04660000
*                IF MOVELEN > 0                                    0992 04661000
*                  THEN                                            0992 04662000
         LTR   MOVELEN,MOVELEN                                     0992 04663000
         BNP   @RF00992                                            0992 04664000
*                    EFIELD2(2:MOVELEN+1)=                         0993 04665000
*                            PDESTRNG(1:MOVELEN);          /*@YL026UL*/ 04666000
         LR    @07,MOVELEN                                         0993 04667000
         BCTR  @07,0                                               0993 04668000
         L     @05,CONSTPTR(,PDEPTR)                               0993 04669000
         EX    @07,@SM01862                                        0993 04670000
*                  ELSE                                            0994 04671000
*                    EFIELD2(2)=PAREN2;                    /*@YL026UL*/ 04672000
         B     @RC00992                                            0994 04673000
@RF00992 MVI   EFIELD2+1,C')'                                      0994 04674000
*                END;                                      /*@YL026UL*/ 04675000
*              ELSE                                                0996 04676000
*                IF NAMEPDE=NO                                     0996 04677000
*                  THEN                                            0996 04678000
         B     @RC00988                                            0996 04679000
@RF00988 TM    NAMEPDE,B'00001000'                                 0996 04680000
         BNZ   @RF00996                                            0996 04681000
*                    IF CONSTLEN > 0                               0997 04682000
*                      THEN                                        0997 04683000
         LH    @07,CONSTLEN(,PDEPTR)                               0997 04684000
         LTR   @07,@07                                             0997 04685000
         BNP   @RF00997                                            0997 04686000
*                        EFIELD2=PDESTRNG(1:MIN(                   0998 04687000
*                             LENGTH(EFIELD2),CONSTLEN));  /*@YL026UL*/ 04688000
         MVI   EFIELD2+1,C' '                                      0998 04689000
         MVC   EFIELD2+2(62),EFIELD2+1                             0998 04690000
         LA    @02,64                                              0998 04691000
         CR    @07,@02                                             0998 04692000
         BNH   *+6                                                      04693000
         LR    @07,@02                                             0998 04694000
         BCTR  @07,0                                               0998 04695000
         L     @02,CONSTPTR(,PDEPTR)                               0998 04696000
         EX    @07,@SM01852                                        0998 04697000
*                      ELSE                                /*@YL026UL*/ 04698000
*                        DO;                               /*@YL026UL*/ 04699000
         B     @RC00997                                            0999 04700000
@RF00997 DS    0H                                                  1000 04701000
*                        EFIELD2(1)=QUOTE;                 /*@YL026UL*/ 04702000
         MVI   EFIELD2,C''''                                       1000 04703000
*                        EFIELD2(2)=QUOTE;                 /*@YL026UL*/ 04704000
         MVI   EFIELD2+1,C''''                                     1001 04705000
*                        END;                              /*@YL026UL*/ 04706000
*                  ELSE                                            1003 04707000
*                    IF DSNLEN > 0                                 1003 04708000
*                      THEN                                        1003 04709000
         B     @RC00996                                            1003 04710000
@RF00996 LH    @07,DSNLEN(,PDEPTR)                                 1003 04711000
         LTR   @07,@07                                             1003 04712000
         BNP   @RF01003                                            1003 04713000
*                        EFIELD2=PDEDSN(1:MIN(                     1004 04714000
*                             LENGTH(EFIELD2),DSNLEN));    /*@YL026UL*/ 04715000
         MVI   EFIELD2+1,C' '                                      1004 04716000
         MVC   EFIELD2+2(62),EFIELD2+1                             1004 04717000
         LA    @02,64                                              1004 04718000
         CR    @07,@02                                             1004 04719000
         BNH   *+6                                                      04720000
         LR    @07,@02                                             1004 04721000
         BCTR  @07,0                                               1004 04722000
         L     @02,DSNPTR(,PDEPTR)                                 1004 04723000
         EX    @07,@SM01864                                        1004 04724000
*                      ELSE                                        1005 04725000
*                        EFIELD2(1)=PAREN;                 /*@YL026UL*/ 04726000
         B     @RC01003                                            1005 04727000
@RF01003 MVI   EFIELD2,C'('                                        1005 04728000
*            END;                                          /*@YL026UL*/ 04729000
*                                                                  1006 04730000
@RC01003 DS    0H                                                  1006 04731000
@RC00996 DS    0H                                                  1006 04732000
@RC00988 DS    0H                                                  1007 04733000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/ 04734000
*                                                                  1007 04735000
@RC00981 ST    GDTPTR,@AL00001                                     1007 04736000
         LA    @07,@CF00123                                        1007 04737000
         ST    @07,@AL00001+4                                      1007 04738000
         LA    @07,DDSTRU                                          1007 04739000
         ST    @07,@AL00001+8                                      1007 04740000
         MVI   @AL00001+8,X'80'                                    1007 04741000
         L     @15,GDTPRT(,GDTPTR)                                 1007 04742000
         LA    @01,@AL00001                                        1007 04743000
         BALR  @14,@15                                             1007 04744000
*        /************************************************************/ 04745000
*        /*                                                  @YL026UL*/ 04746000
*        /* OBTAIN A FORMATTED, STATIC TEXT MESSAGE TO       @YL026UL*/ 04747000
*        /* PROMPT THE USER FOR A REPLY INDICATING WHETHER   @YL026UL*/ 04748000
*        /* OR NOT PROCESSING SHOULD BE CONTINUED WITH THE   @YL026UL*/ 04749000
*        /* THE EXCESS LIST ITEMS BEING IGNORED.             @YL026UL*/ 04750000
*        /*                                                  @YL026UL*/ 04751000
*        /************************************************************/ 04752000
*                                                                  1008 04753000
*        DARGSENT=PROMPT3;                                 /*@YL026UL*/ 04754000
         L     @07,DDSTRU                                          1008 04755000
         MVI   DARGSENT(@07),X'0A'                                 1008 04756000
*        DARGRETP=ADDR(MSGBUFF);                           /*@YL026UL*/ 04757000
         LA    @04,MSGBUFF                                         1009 04758000
         ST    @04,DARGRETP(,@07)                                  1009 04759000
*        DARGRETL=LENGTH(MSGBUFF);                         /*@YL026UL*/ 04760000
*                                                                  1010 04761000
         MVC   DARGRETL(2,@07),@CH01454                            1010 04762000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/ 04763000
*                                                                  1011 04764000
         ST    GDTPTR,@AL00001                                     1011 04765000
         LA    @07,@CF00123                                        1011 04766000
         ST    @07,@AL00001+4                                      1011 04767000
         LA    @07,DDSTRU                                          1011 04768000
         ST    @07,@AL00001+8                                      1011 04769000
         MVI   @AL00001+8,X'80'                                    1011 04770000
         L     @15,GDTPRT(,GDTPTR)                                 1011 04771000
         LA    @01,@AL00001                                        1011 04772000
         BALR  @14,@15                                             1011 04773000
*        PMSGPTR=DARGRETP;                                 /*@YL026UL*/ 04774000
         L     @07,DDSTRU                                          1012 04775000
         L     @04,DARGRETP(,@07)                                  1012 04776000
         ST    @04,PMSGPTR                                         1012 04777000
*        PMSGLEN=DARGRETL;                                 /*@YL026UL*/ 04778000
         LH    @04,DARGRETL(,@07)                                  1013 04779000
         STH   @04,PMSGLEN                                         1013 04780000
*        DARGRETP=NULLPTR;                                 /*@YL026UL*/ 04781000
         SLR   @04,@04                                             1014 04782000
         ST    @04,DARGRETP(,@07)                                  1014 04783000
*        DARGRETL=0;                                       /*@YL026UL*/ 04784000
*                                                                  1015 04785000
         STH   @04,DARGRETL(,@07)                                  1015 04786000
*        /************************************************************/ 04787000
*        /*                                                  @Y30SSFR*/ 04788000
*        /*  ISSSUE A UPROMPT TO PROMPT THE USER FOR         @Y30SSFR*/ 04789000
*        /*  ADDITIONAL INFORMATION.  IF THE UPROMPT FAILS   @Y30SSFR*/ 04790000
*        /*  SET A LASTCC OF 12, AND RETURN TO THE CALLER.   @Y30SSFR*/ 04791000
*        /*                                                  @Y30SSFR*/ 04792000
*        /************************************************************/ 04793000
*        CALL IDCSAPT0(GDTTBL,PMSGPTR,PMSGLEN,RPLYPTR,RPLYLEN);/*  1016 04794000
*                                                            #YL026UL*/ 04795000
         ST    GDTPTR,@AL00001                                     1016 04796000
         LA    @07,PMSGPTR                                         1016 04797000
         ST    @07,@AL00001+4                                      1016 04798000
         LA    @07,PMSGLEN                                         1016 04799000
         ST    @07,@AL00001+8                                      1016 04800000
         LA    @07,RPLYPTR                                         1016 04801000
         ST    @07,@AL00001+12                                     1016 04802000
         LA    @07,RPLYLEN                                         1016 04803000
         ST    @07,@AL00001+16                                     1016 04804000
         MVI   @AL00001+16,X'80'                                   1016 04805000
         L     @15,GDTPMT(,GDTPTR)                                 1016 04806000
         LA    @01,@AL00001                                        1016 04807000
         BALR  @14,@15                                             1016 04808000
*        RESPECIFY RTNREG RSTD;                                    1017 04809000
*        TESTRC = RTNREG;                                          1018 04810000
         LR    TESTRC,RTNREG                                       1018 04811000
*        RESPECIFY RTNREG UNRSTD;                          /*#YL026UL*/ 04812000
*                                                                  1019 04813000
*        IF TESTRC^=0                                              1020 04814000
*          THEN                                                    1020 04815000
         LTR   TESTRC,TESTRC                                       1020 04816000
         BZ    @RF01020                                            1020 04817000
*            DO;                                           /*#YL026UL*/ 04818000
*            LASTCC=LASTCC12;                              /*#YL026UL*/ 04819000
         L     @07,@PC00001+16                                     1022 04820000
         MVC   LASTCC(2,@07),@CH00038                              1022 04821000
*            RETURN;                                       /*#YL026UL*/ 04822000
@EL00011 DS    0H                                                  1023 04823000
@EF00011 DS    0H                                                  1023 04824000
@ER00011 LM    @14,@12,@SA00011                                    1023 04825000
         BR    @14                                                 1023 04826000
*            END;                                          /*#YL026UL*/ 04827000
*                                                                  1024 04828000
*        /************************************************************/ 04829000
*        /*                                                  #YL026UL*/ 04830000
*        /* CHECK FOR A VALID REPLY INDICATING THAT THE USER #YL026UL*/ 04831000
*        /* WISHES THE EXCESS LIST ELEMENTS TO BE IGNORED.   #YL026UL*/ 04832000
*        /*                                                  #YL026UL*/ 04833000
*        /************************************************************/ 04834000
*        RESPECIFY(DATABLK) BASED(RPLYPTR+4);              /*#YL026UL*/ 04835000
@RF01020 DS    0H                                                  1026 04836000
*        TRUNCATE=NO;                                      /*#YL026UL*/ 04837000
         NI    TRUNCATE,B'01111111'                                1026 04838000
*        IF RPLYLEN=2                                              1027 04839000
*          THEN                                                    1027 04840000
         CLC   RPLYLEN(2),@CH00161                                 1027 04841000
         BNE   @RF01027                                            1027 04842000
*            DO;                                           /*#YL026UL*/ 04843000
*            DATABLK(1:2)=DATABLK(1:2) | FOLDMASK;         /*#YL026UL*/ 04844000
         LA    @07,4                                               1029 04845000
         AL    @07,RPLYPTR                                         1029 04846000
         OC    DATABLK(2,@07),@CB01701                             1029 04847000
*            IF DATABLK(1:2)=LISTRPLY(2:3)                         1030 04848000
*              THEN                                                1030 04849000
         CLC   DATABLK(2,@07),LISTRPLY+1                           1030 04850000
         BNE   @RF01030                                            1030 04851000
*                TRUNCATE=YES;                             /*#YL026UL*/ 04852000
         OI    TRUNCATE,B'10000000'                                1031 04853000
*            END;                                          /*#YL026UL*/ 04854000
*          ELSE                                                    1033 04855000
*            IF RPLYLEN=4                                          1033 04856000
*              THEN                                                1033 04857000
         B     @RC01027                                            1033 04858000
@RF01027 LA    @07,4                                               1033 04859000
         CH    @07,RPLYLEN                                         1033 04860000
         BNE   @RF01033                                            1033 04861000
*                DO;                                       /*#YL026UL*/ 04862000
*                DATABLK(2:3)=DATABLK(2:3) | FOLDMASK;     /*#YL026UL*/ 04863000
         AL    @07,RPLYPTR                                         1035 04864000
         OC    DATABLK+1(2,@07),@CB01701                           1035 04865000
*                IF DATABLK(1:4)=LISTRPLY                          1036 04866000
*                  THEN                                            1036 04867000
         CLC   DATABLK(4,@07),LISTRPLY                             1036 04868000
         BNE   @RF01036                                            1036 04869000
*                    TRUNCATE=YES;                         /*#YL026UL*/ 04870000
         OI    TRUNCATE,B'10000000'                                1037 04871000
*                END;                                      /*#YL026UL*/ 04872000
*                                                                  1038 04873000
@RF01036 DS    0H                                                  1039 04874000
*        /************************************************************/ 04875000
*        /*                                                  #YL026UL*/ 04876000
*        /* IF THE USER REQUESTS CONTINUED PROCESSING THEN   #YL026UL*/ 04877000
*        /* RESET THE LIST COUNT SO THAT THE EXCESS LIST     #YL026UL*/ 04878000
*        /* ITEMS WILL BE IGNORED                            #YL026UL*/ 04879000
*        /*                                                  #YL026UL*/ 04880000
*        /************************************************************/ 04881000
*        IF TRUNCATE=YES                                           1039 04882000
*          THEN                                                    1039 04883000
@RF01033 DS    0H                                                  1039 04884000
@RC01027 TM    TRUNCATE,B'10000000'                                1039 04885000
         BNO   @RF01039                                            1039 04886000
*            IF REPEATED=NO                                        1040 04887000
*              THEN                                                1040 04888000
         LH    @07,PARMID                                          1040 04889000
         MH    @07,@CH00038                                        1040 04890000
         L     @02,PINFOPTR                                        1040 04891000
         AL    @02,@CF01818                                        1040 04892000
         L     @07,PARMPTR(@07,@02)                                1040 04893000
         TM    REPEATED(@07),B'00100000'                           1040 04894000
         BNZ   @RF01040                                            1040 04895000
*                LISTTOTL=LISTTOTL-1;                      /*#YL026UL*/ 04896000
         LH    @07,LISTTOTL                                        1041 04897000
         BCTR  @07,0                                               1041 04898000
         STH   @07,LISTTOTL                                        1041 04899000
*              ELSE                                                1042 04900000
*                REPCOUNT=REPCOUNT-1;                      /*#YL026UL*/ 04901000
         B     @RC01040                                            1042 04902000
@RF01040 LH    @07,REPCOUNT                                        1042 04903000
         BCTR  @07,0                                               1042 04904000
         STH   @07,REPCOUNT                                        1042 04905000
*          ELSE                                                    1043 04906000
*            LASTCC=LASTCC12;                              /*#YL026UL*/ 04907000
*                                                                  1043 04908000
         B     @RC01039                                            1043 04909000
@RF01039 L     @07,@PC00001+16                                     1043 04910000
         MVC   LASTCC(2,@07),@CH00038                              1043 04911000
*        END TOOMANY;                                      /*#YL026UL*/ 04912000
*                                                                  1044 04913000
*                                                                  1044 04914000
         B     @EL00011                                            1044 04915000
*        END TRNSLATE;                                     /*@YL026UL*/ 04916000
@EL00005 DS    0H                                                  1045 04917000
@EF00005 DS    0H                                                  1045 04918000
@ER00005 LM    @14,@02,@SA00005                                    1045 04919000
         LM    @04,@06,@SA00005+20                                 1045 04920000
         LM    @08,@12,@SA00005+32                                 1045 04921000
         BR    @14                                                 1045 04922000
*/********************************************************************/ 04923000
*/*                                                          @YL026UL*/ 04924000
*/*  PROCEDURE NAME - NOTPARMS                               @YL026UL*/ 04925000
*/*                                                          @YL026UL*/ 04926000
*/*  FUNCTION - THIS ROUTINE CHECKS FOR CONFLICTS AMONG A    @YL026UL*/ 04927000
*/*             SET OF PARAMETERS.  THE SET IS EITHER THE    @YL026UL*/ 04928000
*/*             MAIN SET OF PARAMETERS, OR THE PARAMETERS    @YL026UL*/ 04929000
*/*             OF A REPEATED SUBLIST REPETITION.  WHEN TWO  @YL026UL*/ 04930000
*/*             PARMS ARE FOUND TO BE IN CONFLICT, THE USER  @YL026UL*/ 04931000
*/*             IS PROMPTED TO SPECIFY WHICH PARM HE WISHES  @YL026UL*/ 04932000
*/*             TO RETAIN; THE OTHER PARM (AND ITS SUBPARMS) @YL026UL*/ 04933000
*/*             ARE THEN NULLIFIED.                          @YL026UL*/ 04934000
*/*                                                          @YL026UL*/ 04935000
*/*  INPUT -                                                 @YL026UL*/ 04936000
*/*            PARMFLAG- FLAGS IN 'PARMINFO' INDICATING      @YL026UL*/ 04937000
*/*                      WHICH PARAMETERS HAVE BEEN INPUT.   @YL026UL*/ 04938000
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/ 04939000
*/*                                                          @YL026UL*/ 04940000
*/*  OUTPUT -                                                @YL026UL*/ 04941000
*/*            PARMFLAG- ADJUSTED FLAGS REFLECTING CHANGES   @YL026UL*/ 04942000
*/*                      MADE TO FDT TO RESOLVE CONFLICTS.   @YL026UL*/ 04943000
*/*            SBLSTIN - RSI FLAG(S) SET TO NOTE IF CERTAIN  @YL026UL*/ 04944000
*/*                      SUBLISTS SHOULD NOT BE PROCESSED    @YL026UL*/ 04945000
*/*                      SINCE THEIR SUPERPARM(S) WERE IN    @YL026UL*/ 04946000
*/*                      CONFLICT.                           @YL026UL*/ 04947000
*/*            FDT -     ADJUSTED TO RESOLVE CONFLICTS.      @YL026UL*/ 04948000
*/*            LASTCC -  AMS CONDITION CODE.                 @YL026UL*/ 04949000
*/*                                                          @YL026UL*/ 04950000
*/********************************************************************/ 04951000
*NOTPARMS:PROCEDURE;                                       /*@YL026UL*/ 04952000
NOTPARMS STM   @14,@12,@SA00012                                    1046 04953000
*        /************************************************************/ 04954000
*        /*                                                  @YL026UL*/ 04955000
*        /*  ** NOTPARMS **  DATA DEFINITIONS                @YL026UL*/ 04956000
*        /*                                                  @YL026UL*/ 04957000
*        /************************************************************/ 04958000
*                                                                  1047 04959000
*        DCL ERASEID  FIXED(15);       /*ID# OF PARM TO BE   @YL026UL*/ 04960000
*                                      /*NULLIFIED           @YL026UL*/ 04961000
*        /************************************************************/ 04962000
*        /*                                                  @YL026UL*/ 04963000
*        /*  ** NOTPARMS **  CHECK FOR CONFLICTING PARMS     @YL026UL*/ 04964000
*        /*                                                  @YL026UL*/ 04965000
*        /************************************************************/ 04966000
*        OLDERID2 = NEWERID2;                                      1048 04967000
         L     @07,GDTTR2(,GDTPTR)                                 1048 04968000
         MVC   @TS00001(95),NEWERID2(@07)                          1048 04969000
         MVC   OLDERID2(95,@07),@TS00001                           1048 04970000
*        NEWID2='RI30';                                    /*@YL026UL*/ 04971000
*                                                                  1049 04972000
         MVC   NEWID2(4,@07),@CC01715                              1049 04973000
*        /************************************************************/ 04974000
*        /*                                                  @YL026UL*/ 04975000
*        /* CHECK EVERY PARAMETER OF THE COMMAND TO SEE IF   @YL026UL*/ 04976000
*        /* THAT PARM WAS INPUT AS PART OF THE CURRENT SET   @YL026UL*/ 04977000
*        /* OF PARMS BEING PROCESSED.                        @YL026UL*/ 04978000
*        /*                                                  @YL026UL*/ 04979000
*        /************************************************************/ 04980000
*DOLOOP35:DO PARMID=1 TO MAXID;                            /*@YL026UL*/ 04981000
DOLOOP35 LA    @07,1                                               1050 04982000
         B     @DE01050                                            1050 04983000
@DL01050 DS    0H                                                  1051 04984000
*          IF PARMFLAG(PARMID)=INPUT                               1051 04985000
*            THEN                                                  1051 04986000
*                                                                  1051 04987000
         L     @15,PINFOPTR                                        1051 04988000
         MH    @07,@CH00038                                        1051 04989000
         LA    @01,0(@07,@15)                                      1051 04990000
         BCTR  @01,0                                               1051 04991000
         BCTR  @01,0                                               1051 04992000
         SLR   @00,@00                                             1051 04993000
         IC    @00,PARMFLAG-10(,@01)                               1051 04994000
         C     @00,@CF00161                                        1051 04995000
         BNE   @RF01051                                            1051 04996000
*              /******************************************************/ 04997000
*              /*                                            @YL026UL*/ 04998000
*              /* IF A PARAMETER HAS A LIST OF 'NOTPARMS',   @YL026UL*/ 04999000
*              /* CHECK THAT NONE OF THESE CONFLICTING PARMS @YL026UL*/ 05000000
*              /* HAVE BEEN CODED.  IF A CONFLICT EXISTS,    @YL026UL*/ 05001000
*              /* PROMPT THE USER TO INDICATE WHICH PARM     @YL026UL*/ 05002000
*              /* IS TO BE IGNORED.                          @YL026UL*/ 05003000
*              /*                                            @YL026UL*/ 05004000
*              /******************************************************/ 05005000
*              IF NOTDSPL^=0                                       1052 05006000
*                THEN                                              1052 05007000
         AL    @15,@CF01818                                        1052 05008000
         L     @07,PARMPTR(@07,@15)                                1052 05009000
         CLI   NOTDSPL(@07),0                                      1052 05010000
         BE    @RF01052                                            1052 05011000
*                  DO INDEX9=1 TO NOTCOUNT                 /*@YL026UL*/ 05012000
*                            WHILE(PARMFLAG(PARMID)=INPUT);/*@YL026UL*/ 05013000
         LA    @07,1                                               1053 05014000
         B     @DE01053                                            1053 05015000
@DL01053 LA    @15,2                                               1053 05016000
         L     @14,PINFOPTR                                        1053 05017000
         LA    @05,12                                              1053 05018000
         LR    @04,@05                                             1053 05019000
         MH    @04,PARMID                                          1053 05020000
         LA    @01,0(@04,@14)                                      1053 05021000
         BCTR  @01,0                                               1053 05022000
         BCTR  @01,0                                               1053 05023000
         SLR   @00,@00                                             1053 05024000
         IC    @00,PARMFLAG-10(,@01)                               1053 05025000
         CR    @15,@00                                             1053 05026000
         BNE   @DC01053                                            1053 05027000
*                    IF PARMFLAG(NOTID(INDEX9))=INPUT              1054 05028000
*                      THEN                                        1054 05029000
         ALR   @07,@07                                             1054 05030000
         AL    @04,@CF01818                                        1054 05031000
         L     @04,PARMPTR(@04,@14)                                1054 05032000
         SLR   @03,@03                                             1054 05033000
         IC    @03,NOTDSPL(,@04)                                   1054 05034000
         ALR   @03,@03                                             1054 05035000
         ALR   @04,@03                                             1054 05036000
         MH    @05,NOTID-2(@07,@04)                                1054 05037000
         BCTR  @14,0                                               1054 05038000
         BCTR  @14,0                                               1054 05039000
         SLR   @03,@03                                             1054 05040000
         IC    @03,PARMFLAG-10(@05,@14)                            1054 05041000
         CR    @15,@03                                             1054 05042000
         BNE   @RF01054                                            1054 05043000
*                        DO;                               /*@YL026UL*/ 05044000
*                                                                  1055 05045000
*                        CALL RESOLVE(PARMID,                      1056 05046000
*                                     NOTID(INDEX9));      /*@YL026UL*/ 05047000
*                                                                  1056 05048000
         LA    @05,PARMID                                          1056 05049000
         ST    @05,@AL00001                                        1056 05050000
         LA    @07,NOTID-2(@07,@04)                                1056 05051000
         ST    @07,@AL00001+4                                      1056 05052000
         LA    @01,@AL00001                                        1056 05053000
         BAL   @14,RESOLVE                                         1056 05054000
*                        /********************************************/ 05055000
*                        /*                                  @Y30SSFR*/ 05056000
*                        /*  IF THE PROMPT WAS NOT ABLE TO   @Y30SSFR*/ 05057000
*                        /*  RESOLVE THE CONFLICTS, RETURN   @Y30SSFR*/ 05058000
*                        /*  TO THE CALLER.                  @Y30SSFR*/ 05059000
*                        /*                                  @Y30SSFR*/ 05060000
*                        /********************************************/ 05061000
*                        IF LASTCC^=0                              1057 05062000
*                          THEN                                    1057 05063000
         L     @07,@PC00001+16                                     1057 05064000
         LH    @07,LASTCC(,@07)                                    1057 05065000
         LTR   @07,@07                                             1057 05066000
         BNZ   @RT01057                                            1057 05067000
*                            RETURN;                       /*@YL026UL*/ 05068000
*                        END;                              /*@YL026UL*/ 05069000
*                  END;                                    /*@YL026UL*/ 05070000
*                                                                  1060 05071000
@RF01054 LA    @07,1                                               1060 05072000
         AH    @07,INDEX9                                          1060 05073000
@DE01053 STH   @07,INDEX9                                          1060 05074000
         LH    @15,PARMID                                          1060 05075000
         MH    @15,@CH00038                                        1060 05076000
         LH    @14,PARMID                                          1060 05077000
         MH    @14,@CH00038                                        1060 05078000
         L     @01,PINFOPTR                                        1060 05079000
         AL    @01,@CF01818                                        1060 05080000
         L     @01,PARMPTR(@14,@01)                                1060 05081000
         SLR   @14,@14                                             1060 05082000
         IC    @14,NOTDSPL(,@01)                                   1060 05083000
         ALR   @14,@14                                             1060 05084000
         L     @01,PINFOPTR                                        1060 05085000
         AL    @01,@CF01818                                        1060 05086000
         AL    @14,PARMPTR(@15,@01)                                1060 05087000
         CH    @07,NOTCOUNT(,@14)                                  1060 05088000
         BNH   @DL01053                                            1060 05089000
@DC01053 DS    0H                                                  1061 05090000
*        END DOLOOP35;                                     /*@YL026UL*/ 05091000
*                                                                  1061 05092000
@RF01052 DS    0H                                                  1061 05093000
@RF01051 LA    @07,1                                               1061 05094000
         AH    @07,PARMID                                          1061 05095000
@DE01050 STH   @07,PARMID                                          1061 05096000
         L     @01,DESCPTR                                         1061 05097000
         CH    @07,MAXID(,@01)                                     1061 05098000
         BNH   @DL01050                                            1061 05099000
*          /**********************************************************/ 05100000
*          /*                                                @YL026UL*/ 05101000
*          /* FOR PARAMETERS TO BE IGNORED, MAKE SURE THAT   @YL026UL*/ 05102000
*          /* UNSCANNED, REPEATED SUBLISTS SUBORDINATE TO    @YL026UL*/ 05103000
*          /* THEM ARE ALSO IGNORED.                         @YL026UL*/ 05104000
*          /*                                                @YL026UL*/ 05105000
*          /**********************************************************/ 05106000
*          DO INDEX9=1 TO RSICOUNT;                        /*@YL026UL*/ 05107000
         LA    @07,1                                               1062 05108000
         B     @DE01062                                            1062 05109000
@DL01062 DS    0H                                                  1063 05110000
*            IF PARMFLAG(SBLSTID(INDEX9))=PARTOSET                 1063 05111000
*              THEN                                                1063 05112000
         LA    @15,12                                              1063 05113000
         L     @14,RSIPTR                                          1063 05114000
         LR    @01,@07                                             1063 05115000
         MR    @00,@15                                             1063 05116000
         LA    @07,0(@01,@14)                                      1063 05117000
         AL    @07,@CF01821                                        1063 05118000
         MH    @15,SBLSTID-6(,@07)                                 1063 05119000
         L     @07,PINFOPTR                                        1063 05120000
         BCTR  @07,0                                               1063 05121000
         BCTR  @07,0                                               1063 05122000
         SLR   @00,@00                                             1063 05123000
         IC    @00,PARMFLAG-10(@15,@07)                            1063 05124000
         C     @00,@CF00227                                        1063 05125000
         BNE   @RF01063                                            1063 05126000
*                SBLSTIN(INDEX9)=NO;                       /*@YL026UL*/ 05127000
         ALR   @14,@01                                             1064 05128000
         AL    @14,@CF01813                                        1064 05129000
         NI    SBLSTIN-9(@14),B'01111111'                          1064 05130000
*          END;                                            /*@YL026UL*/ 05131000
*                                                                  1065 05132000
@RF01063 LA    @07,1                                               1065 05133000
         AH    @07,INDEX9                                          1065 05134000
@DE01062 STH   @07,INDEX9                                          1065 05135000
         CH    @07,RSICOUNT                                        1065 05136000
         BNH   @DL01062                                            1065 05137000
*/********************************************************************/ 05138000
*/*                                                          @YL026UL*/ 05139000
*/*  PROCEDURE NAME - RESOLVE                                @YL026UL*/ 05140000
*/*                                                          @YL026UL*/ 05141000
*/*  FUNCTION - THIS ROUTINE SENDS A MESSAGE TO THE TSO USER @YL026UL*/ 05142000
*/*             IDENTIFYING THE TWO PARAMETERS IN CONFLICT   @YL026UL*/ 05143000
*/*             AND REQUESTING THAT THE PARM TO BE RETAINED  @YL026UL*/ 05144000
*/*             BE SPECIFIED (USING A CODE DESCRIBED IN THE  @YL026UL*/ 05145000
*/*             MESSAGE).  THE PARAMETER NOT CHOSEN (AND ALL @YL026UL*/ 05146000
*/*             ITS SUBPARAMETERS) ARE THEN NULLIFIED BY     @YL026UL*/ 05147000
*/*             ALTERING THEIR PRESENCE FROM THE FDT AND     @YL026UL*/ 05148000
*/*             FROM THE PARAMETER OCCURRENCE TABLE.         @YL026UL*/ 05149000
*/*                                                          @YL026UL*/ 05150000
*/*  INPUT -                                                 @YL026UL*/ 05151000
*/*            ID1 -     PARM ID# OF FIRST OF THE TWO PARMS  @YL026UL*/ 05152000
*/*                      IN CONFLICT.                        @YL026UL*/ 05153000
*/*            ID2 -     PARM ID# OF SECOND OF THE TWO       @YL026UL*/ 05154000
*/*                      PARMS IN CONFLICT.                  @YL026UL*/ 05155000
*/*            PARMFLAG- FLAGS IN 'PARMINFO' INDICATING      @YL026UL*/ 05156000
*/*                      WHICH PARAMETERS HAVE BEEN INPUT.   @YL026UL*/ 05157000
*/*            SUPRPARM- 'PARMINFO' FIELD INDICATING EACH    @YL026UL*/ 05158000
*/*                      PARAMETER'S SUPERPARM ID#.          @YL026UL*/ 05159000
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/ 05160000
*/*                                                          @YL026UL*/ 05161000
*/*  OUTPUT -                                                @YL026UL*/ 05162000
*/*            FDT -     ADJUST TO RESOLVE CONFLICTS.        @YL026UL*/ 05163000
*/*            PARMFLAG- ADJUSTED FLAGS REFLECTING CHANGES   @YL026UL*/ 05164000
*/*                      MADE TO FDT.                        @YL026UL*/ 05165000
*/*            LASTCC -  AMS CONDITION CODE.                 @YL026UL*/ 05166000
*/*                                                          @YL026UL*/ 05167000
*/********************************************************************/ 05168000
*RESOLVE:PROCEDURE(ID1,ID2);                               /*@YL026UL*/ 05169000
         B     @PB00013                                            1066 05170000
RESOLVE  STM   @14,@12,@SA00013                                    1066 05171000
         MVC   @PC00013(8),0(@01)                                  1066 05172000
*        /************************************************************/ 05173000
*        /*                                                  @YL026UL*/ 05174000
*        /*  ** RESOLVE  **  DATA DEFINITIONS                @YL026UL*/ 05175000
*        /*                                                  @YL026UL*/ 05176000
*        /************************************************************/ 05177000
*                                                                  1067 05178000
*        DCL ID1      FIXED(15);       /*ID# OF THE 1ST PARM @YL026UL*/ 05179000
*                                      /*OF THE CONFLICT     @YL026UL*/ 05180000
*        DCL ID2      FIXED(15);       /*ID# OF THE 2ND PARM @YL026UL*/ 05181000
*                                      /*IN CONFLICT         @YL026UL*/ 05182000
*        DCL KEEP1ST  BIT(1);          /*SET 'ON' WHEN THE   @YL026UL*/ 05183000
*                                      /*1ST PARM IS CHOSEN  @YL026UL*/ 05184000
*                                      /*TO BE RETAINED      @YL026UL*/ 05185000
*        DCL RETAIN1  CHAR(3)          /*REPLY INDICATING    @YL026UL*/ 05186000
*                     INIT('''1''');   /*THAT THE 1ST PARM   @YL026UL*/ 05187000
*                                      /*IS TO BE RETAINED   @YL026UL*/ 05188000
*        DCL RETAIN2  CHAR(3)          /*REPLY INDICATING    @YL026UL*/ 05189000
*                     INIT('''2''');   /*THAT THE 2ND PARM   @YL026UL*/ 05190000
*                                      /*IS TO BE RETAINED   @YL026UL*/ 05191000
*                                                                  1072 05192000
*        /*TEXT STRUCTURE ERROR MESSAGE ID NUMBERS           @YL026UL*/ 05193000
*        DCL CONFLICT FIXED(15)        /*MSG ID (PART 1) FOR @YL026UL*/ 05194000
*                     CONSTANT(5);     /*CONFLICTING PARMS   @YL026UL*/ 05195000
*        DCL CNFLCT2  FIXED(15)        /*MSG ID (PART 2) FOR @YL026UL*/ 05196000
*                     CONSTANT(11);    /*CONFLICTING PARMS   @YL026UL*/ 05197000
*        DCL PROMPT2  FIXED(15)        /*MSG ID OF PROMPT    @YL026UL*/ 05198000
*                     CONSTANT(8);     /*ASKING FOR CHOICE   @YL026UL*/ 05199000
*                                      /*BETWEEN PARMS       @YL026UL*/ 05200000
*        /************************************************************/ 05201000
*        /*                                                  @YL026UL*/ 05202000
*        /*  ** RESOLVE **  RESOLVE THE CONFLICT OF PARMS    @YL026UL*/ 05203000
*        /*                                                  @YL026UL*/ 05204000
*        /************************************************************/ 05205000
*        OLDERID2 = NEWERID2;                                      1075 05206000
         L     @07,GDTTR2(,GDTPTR)                                 1075 05207000
         MVC   @TS00001(95),NEWERID2(@07)                          1075 05208000
         MVC   OLDERID2(95,@07),@TS00001                           1075 05209000
*        NEWID2='RI32';                                    /*@YL026UL*/ 05210000
*                                                                  1076 05211000
         MVC   NEWID2(4,@07),@CC01734                              1076 05212000
*        /************************************************************/ 05213000
*        /*                                                  @YL026UL*/ 05214000
*        /* IF THE INVALID PARAMETERS APPEAR WITHIN A        @YL026UL*/ 05215000
*        /* REPEATED SUBLIST, PRINT A MESSAGE IDENTIFYING    @YL026UL*/ 05216000
*        /* WHICH REPETITION CONTAINS THE ERROR.             @YL026UL*/ 05217000
*        /*                                                  @YL026UL*/ 05218000
*        /************************************************************/ 05219000
*        IF PARMPTR(ID1)->OCCURNUM > 1                             1077 05220000
*          THEN                                                    1077 05221000
         LA    @07,12                                              1077 05222000
         L     @15,@PC00013                                        1077 05223000
         LR    @14,@07                                             1077 05224000
         MH    @14,ID1(,@15)                                       1077 05225000
         L     @01,PINFOPTR                                        1077 05226000
         AL    @01,@CF01818                                        1077 05227000
         L     @01,PARMPTR(@14,@01)                                1077 05228000
         CLC   OCCURNUM(3,@01),@CF00227+1                          1077 05229000
         BNH   @RF01077                                            1077 05230000
*            DO;                                           /*@YL026UL*/ 05231000
*            EFIELD3=SBLSTNUM(REPINDEX);                   /*@YL026UL*/ 05232000
         MH    @07,REPINDEX                                        1079 05233000
         L     @01,RSIPTR                                          1079 05234000
         AL    @01,@CF01819                                        1079 05235000
         SLR   @00,@00                                             1079 05236000
         IC    @00,SBLSTNUM-8(@07,@01)                             1079 05237000
         ST    @00,EFIELD3                                         1079 05238000
*            DARGDBP=ADDR(EFIELD3);                        /*@YL026UL*/ 05239000
         L     @07,DDSTRU                                          1080 05240000
         LA    @15,EFIELD3                                         1080 05241000
         ST    @15,DARGDBP(,@07)                                   1080 05242000
*            DARGILP=LENGTH(EFIELD3);                      /*@YL026UL*/ 05243000
         MVC   DARGILP(2,@07),@CH00050                             1081 05244000
*            DARGSENT=INREP;                               /*@YL026UL*/ 05245000
*                                                                  1082 05246000
         MVI   DARGSENT(@07),X'0F'                                 1082 05247000
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         /*@YL026UL*/ 05248000
*                                                                  1083 05249000
         ST    GDTPTR,@AL00001                                     1083 05250000
         LA    @07,@CF00123                                        1083 05251000
         ST    @07,@AL00001+4                                      1083 05252000
         LA    @07,DDSTRU                                          1083 05253000
         ST    @07,@AL00001+8                                      1083 05254000
         MVI   @AL00001+8,X'80'                                    1083 05255000
         L     @15,GDTPRT(,GDTPTR)                                 1083 05256000
         LA    @01,@AL00001                                        1083 05257000
         BALR  @14,@15                                             1083 05258000
*            END;                                          /*@YL026UL*/ 05259000
*                                                                  1084 05260000
*        /************************************************************/ 05261000
*        /*                                                  @YL026UL*/ 05262000
*        /* SEND MESSAGES TO THE TERMINAL USER IDENTIFYING   @YL026UL*/ 05263000
*        /* THE TWO PARAMETERS IN CONFLICT.                  @YL026UL*/ 05264000
*        /*                                                  @YL026UL*/ 05265000
*        /************************************************************/ 05266000
*        EFIELD1=BLANK;                                    /*@YL026UL*/ 05267000
@RF01077 MVI   EFIELD1+1,C' '                                      1085 05268000
         MVC   EFIELD1+2(18),EFIELD1+1                             1085 05269000
         MVI   EFIELD1,C' '                                        1085 05270000
*        DARGDBP=ADDR(EFIELD1);                            /*@YL026UL*/ 05271000
         L     @07,DDSTRU                                          1086 05272000
         LA    @15,EFIELD1                                         1086 05273000
         ST    @15,DARGDBP(,@07)                                   1086 05274000
*        DARGILP=LENGTH(EFIELD1);                          /*@YL026UL*/ 05275000
*                                                                  1087 05276000
         MVC   DARGILP(2,@07),@CH01449                             1087 05277000
*        CALL MSGKWD(ID1,ADDR(EFIELD1));                   /*@YL026UL*/ 05278000
*                                                                  1088 05279000
         L     @07,@PC00013                                        1088 05280000
         ST    @07,@AL00001                                        1088 05281000
         ST    @15,@AFTEMPS+16                                     1088 05282000
         LA    @07,@AFTEMPS+16                                     1088 05283000
         ST    @07,@AL00001+4                                      1088 05284000
         LA    @01,@AL00001                                        1088 05285000
         BAL   @14,MSGKWD                                          1088 05286000
*        DARGSENT=CONFLICT;                                /*@YL026UL*/ 05287000
*                                                                  1089 05288000
         L     @07,DDSTRU                                          1089 05289000
         MVI   DARGSENT(@07),X'05'                                 1089 05290000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/ 05291000
*                                                                  1090 05292000
         ST    GDTPTR,@AL00001                                     1090 05293000
         LA    @07,@CF00123                                        1090 05294000
         ST    @07,@AL00001+4                                      1090 05295000
         LA    @07,DDSTRU                                          1090 05296000
         ST    @07,@AL00001+8                                      1090 05297000
         MVI   @AL00001+8,X'80'                                    1090 05298000
         L     @15,GDTPRT(,GDTPTR)                                 1090 05299000
         LA    @01,@AL00001                                        1090 05300000
         BALR  @14,@15                                             1090 05301000
*        CALL MSGKWD(ID2,ADDR(EFIELD1));                   /*@YL026UL*/ 05302000
*                                                                  1091 05303000
         L     @07,@PC00013+4                                      1091 05304000
         ST    @07,@AL00001                                        1091 05305000
         LA    @07,EFIELD1                                         1091 05306000
         ST    @07,@AFTEMPS+16                                     1091 05307000
         LA    @07,@AFTEMPS+16                                     1091 05308000
         ST    @07,@AL00001+4                                      1091 05309000
         LA    @01,@AL00001                                        1091 05310000
         BAL   @14,MSGKWD                                          1091 05311000
*        DARGSENT=CNFLCT2;                                 /*@YL026UL*/ 05312000
*                                                                  1092 05313000
         L     @07,DDSTRU                                          1092 05314000
         MVI   DARGSENT(@07),X'0B'                                 1092 05315000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/ 05316000
*                                                                  1093 05317000
         ST    GDTPTR,@AL00001                                     1093 05318000
         LA    @07,@CF00123                                        1093 05319000
         ST    @07,@AL00001+4                                      1093 05320000
         LA    @07,DDSTRU                                          1093 05321000
         ST    @07,@AL00001+8                                      1093 05322000
         MVI   @AL00001+8,X'80'                                    1093 05323000
         L     @15,GDTPRT(,GDTPTR)                                 1093 05324000
         LA    @01,@AL00001                                        1093 05325000
         BALR  @14,@15                                             1093 05326000
*        /************************************************************/ 05327000
*        /*                                                  @YL026UL*/ 05328000
*        /* OBTAIN AND SEND A MESSAGE TO THE USER ASKING     @YL026UL*/ 05329000
*        /* THAT HE SPECIFY (USING A CODE AS DESCRIBED IN    @YL026UL*/ 05330000
*        /* ABOVE ERROR MESSAGE) WHICH PARAMETER SHOULD BE   @YL026UL*/ 05331000
*        /* RETAINED.                                        @YL026UL*/ 05332000
*        /*                                                  @YL026UL*/ 05333000
*        /************************************************************/ 05334000
*        DARGSENT=PROMPT2;                                 /*@YL026UL*/ 05335000
         L     @07,DDSTRU                                          1094 05336000
         MVI   DARGSENT(@07),X'08'                                 1094 05337000
*        DARGRETP=ADDR(MSGBUFF);                           /*@YL026UL*/ 05338000
         LA    @15,MSGBUFF                                         1095 05339000
         ST    @15,DARGRETP(,@07)                                  1095 05340000
*        DARGRETL=LENGTH(MSGBUFF);                         /*@YL026UL*/ 05341000
*                                                                  1096 05342000
         MVC   DARGRETL(2,@07),@CH01454                            1096 05343000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/ 05344000
*                                                                  1097 05345000
         ST    GDTPTR,@AL00001                                     1097 05346000
         LA    @07,@CF00123                                        1097 05347000
         ST    @07,@AL00001+4                                      1097 05348000
         LA    @07,DDSTRU                                          1097 05349000
         ST    @07,@AL00001+8                                      1097 05350000
         MVI   @AL00001+8,X'80'                                    1097 05351000
         L     @15,GDTPRT(,GDTPTR)                                 1097 05352000
         LA    @01,@AL00001                                        1097 05353000
         BALR  @14,@15                                             1097 05354000
*        PMSGPTR=DARGRETP;                                 /*@YL026UL*/ 05355000
         L     @07,DDSTRU                                          1098 05356000
         L     @15,DARGRETP(,@07)                                  1098 05357000
         ST    @15,PMSGPTR                                         1098 05358000
*        PMSGLEN=DARGRETL;                                 /*@YL026UL*/ 05359000
         LH    @15,DARGRETL(,@07)                                  1099 05360000
         STH   @15,PMSGLEN                                         1099 05361000
*        DARGRETP=NULLPTR;                                 /*@YL026UL*/ 05362000
         SLR   @15,@15                                             1100 05363000
         ST    @15,DARGRETP(,@07)                                  1100 05364000
*        DARGRETL=0;                                       /*@YL026UL*/ 05365000
*                                                                  1101 05366000
         STH   @15,DARGRETL(,@07)                                  1101 05367000
*        ALLOK=NO;                                         /*@YL026UL*/ 05368000
*                                                                  1102 05369000
         NI    ALLOK,B'11011111'                                   1102 05370000
*        /************************************************************/ 05371000
*        /*                                                  @YL026UL*/ 05372000
*        /* PROMPT UNTIL THE USER HAS RESPONDED WITH A       @YL026UL*/ 05373000
*        /* PROPER CODE.                                     @YL026UL*/ 05374000
*        /*                                                  @YL026UL*/ 05375000
*        /************************************************************/ 05376000
*DOLOOP40:DO WHILE(ALLOK=NO);                              /*@YL026UL*/ 05377000
DOLOOP40 B     @DE01103                                            1103 05378000
@DL01103 DS    0H                                                  1104 05379000
*          KEEP1ST=NO;                                     /*@YL026UL*/ 05380000
*                                                                  1104 05381000
         NI    KEEP1ST,B'01111111'                                 1104 05382000
*          /**********************************************************/ 05383000
*          /*                                                @Y30SSFR*/ 05384000
*          /*  ISSUE A UPROMPT AND TEST THE RETURN CODE.     @Y30SSFR*/ 05385000
*          /*  IF THE UPROMPT FAILED, SET LASTCC TO 12, AND  @Y30SSFR*/ 05386000
*          /*  RETURN.                                       @Y30SSFR*/ 05387000
*          /*                                                @Y30SSFR*/ 05388000
*          /**********************************************************/ 05389000
*          CALL IDCSAPT0(GDTTBL,PMSGPTR,PMSGLEN,RPLYPTR,RPLYLEN);/*     05390000
*                                                            @YL026UL*/ 05391000
         ST    GDTPTR,@AL00001                                     1105 05392000
         LA    @07,PMSGPTR                                         1105 05393000
         ST    @07,@AL00001+4                                      1105 05394000
         LA    @07,PMSGLEN                                         1105 05395000
         ST    @07,@AL00001+8                                      1105 05396000
         LA    @07,RPLYPTR                                         1105 05397000
         ST    @07,@AL00001+12                                     1105 05398000
         LA    @07,RPLYLEN                                         1105 05399000
         ST    @07,@AL00001+16                                     1105 05400000
         MVI   @AL00001+16,X'80'                                   1105 05401000
         L     @15,GDTPMT(,GDTPTR)                                 1105 05402000
         LA    @01,@AL00001                                        1105 05403000
         BALR  @14,@15                                             1105 05404000
*          RESPECIFY RTNREG RSTD;                                  1106 05405000
*          TESTRC = RTNREG;                                        1107 05406000
         LR    TESTRC,RTNREG                                       1107 05407000
*          RESPECIFY RTNREG UNRSTD;                        /*@YL026UL*/ 05408000
*                                                                  1108 05409000
*          IF TESTRC^=0                                            1109 05410000
*            THEN                                                  1109 05411000
         LTR   TESTRC,TESTRC                                       1109 05412000
         BZ    @RF01109                                            1109 05413000
*              DO;                                         /*@YL026UL*/ 05414000
*              LASTCC=LASTCC12;                            /*@YL026UL*/ 05415000
         L     @07,@PC00001+16                                     1111 05416000
         MVC   LASTCC(2,@07),@CH00038                              1111 05417000
*              RETURN;                                     /*@YL026UL*/ 05418000
@EL00013 DS    0H                                                  1112 05419000
@EF00013 DS    0H                                                  1112 05420000
@ER00013 LM    @14,@12,@SA00013                                    1112 05421000
         BR    @14                                                 1112 05422000
*              END;                                        /*@YL026UL*/ 05423000
*                                                                  1113 05424000
*          RESPECIFY (DATABLK) BASED(RPLYPTR+4);           /*@YL026UL*/ 05425000
*                                                                  1114 05426000
@RF01109 DS    0H                                                  1115 05427000
*          /**********************************************************/ 05428000
*          /*                                                @Y30SSFR*/ 05429000
*          /*  IF THE REPLY LENGTH IS 1, DETERMINE WHICH     @Y30SSFR*/ 05430000
*          /*  PARAMETER TO KEEP ON THE BASIS OF THE USER'S  @Y30SSFR*/ 05431000
*          /*  RESPONSE TO THE PROMPT.                       @Y30SSFR*/ 05432000
*          /*                                                @Y30SSFR*/ 05433000
*          /**********************************************************/ 05434000
*          IF RPLYLEN=1                                            1115 05435000
*            THEN                                                  1115 05436000
         CLC   RPLYLEN(2),@CH00227                                 1115 05437000
         BNE   @RF01115                                            1115 05438000
*              IF DATABLK(1)=RETAIN1(2)                            1116 05439000
*                THEN                                              1116 05440000
         L     @07,RPLYPTR                                         1116 05441000
         CLC   DATABLK+4(1,@07),RETAIN1+1                          1116 05442000
         BNE   @RF01116                                            1116 05443000
*                  DO;                                     /*@YL026UL*/ 05444000
*                                                                  1117 05445000
*                  /**************************************************/ 05446000
*                  /*                                        @Y30SSFR*/ 05447000
*                  /*  RETAIN THE FIRST PARAMETER.           @Y30SSFR*/ 05448000
*                  /*                                        @Y30SSFR*/ 05449000
*                  /**************************************************/ 05450000
*                  KEEP1ST=YES;                            /*@YL026UL*/ 05451000
         OI    KEEP1ST,B'10000000'                                 1118 05452000
*                  ALLOK=YES;                              /*@YL026UL*/ 05453000
         OI    ALLOK,B'00100000'                                   1119 05454000
*                  END;                                    /*@YL026UL*/ 05455000
*                ELSE                                              1121 05456000
*                                                                  1121 05457000
*                  /**************************************************/ 05458000
*                  /*                                        @Y30SSFR*/ 05459000
*                  /*  IF THE REPLY IS 2, KEEP THE SECOND    @Y30SSFR*/ 05460000
*                  /*  PARAMETER.                            @Y30SSFR*/ 05461000
*                  /*                                        @Y30SSFR*/ 05462000
*                  /**************************************************/ 05463000
*                  IF DATABLK(1)=RETAIN2(2)                        1121 05464000
*                    THEN                                          1121 05465000
         B     @RC01116                                            1121 05466000
@RF01116 L     @07,RPLYPTR                                         1121 05467000
         CLC   DATABLK+4(1,@07),RETAIN2+1                          1121 05468000
         BNE   @RF01121                                            1121 05469000
*                      ALLOK=YES;                          /*@YL026UL*/ 05470000
         OI    ALLOK,B'00100000'                                   1122 05471000
*                    ELSE;                                 /*@YL026UL*/ 05472000
*                                                                  1123 05473000
@RF01121 DS    0H                                                  1124 05474000
*            /********************************************************/ 05475000
*            /*                                              @Y30SSFR*/ 05476000
*            /*  IF THE USER'S RESPONSE HAS LENGTH 3,        @Y30SSFR*/ 05477000
*            /*  DETERMINE WHICH PARAMETER TO KEEP ON THE    @Y30SSFR*/ 05478000
*            /*  BASIS OF THAT RESPONSE.                     @Y30SSFR*/ 05479000
*            /*                                              @Y30SSFR*/ 05480000
*            /********************************************************/ 05481000
*            ELSE                                                  1124 05482000
*              IF RPLYLEN=3                                        1124 05483000
*                THEN                                              1124 05484000
*                                                                  1124 05485000
         B     @RC01115                                            1124 05486000
@RF01115 CLC   RPLYLEN(2),@CH00170                                 1124 05487000
         BNE   @RF01124                                            1124 05488000
*                  /**************************************************/ 05489000
*                  /*                                        @Y30SSFR*/ 05490000
*                  /*  IF THE REPLY IS 1, RETAIN THE FIRST   @Y30SSFR*/ 05491000
*                  /*  PARAMETER.  OTHERWISE, IF THE REPLY   @Y30SSFR*/ 05492000
*                  /*  IS 2, RETAIN THE SECOND.              @Y30SSFR*/ 05493000
*                  /*                                        @Y30SSFR*/ 05494000
*                  /**************************************************/ 05495000
*                  IF DATABLK(1:3)=RETAIN1                         1125 05496000
*                    THEN                                          1125 05497000
         L     @07,RPLYPTR                                         1125 05498000
         CLC   DATABLK+4(3,@07),RETAIN1                            1125 05499000
         BNE   @RF01125                                            1125 05500000
*                      DO;                                 /*@YL026UL*/ 05501000
*                      KEEP1ST=YES;                        /*@YL026UL*/ 05502000
         OI    KEEP1ST,B'10000000'                                 1127 05503000
*                      ALLOK=YES;                          /*@YL026UL*/ 05504000
         OI    ALLOK,B'00100000'                                   1128 05505000
*                      END;                                /*@YL026UL*/ 05506000
*                    ELSE                                          1130 05507000
*                      IF DATABLK(1:3)=RETAIN2                     1130 05508000
*                        THEN                                      1130 05509000
         B     @RC01125                                            1130 05510000
@RF01125 L     @07,RPLYPTR                                         1130 05511000
         CLC   DATABLK+4(3,@07),RETAIN2                            1130 05512000
         BNE   @RF01130                                            1130 05513000
*                          ALLOK=YES;                      /*@YL026UL*/ 05514000
         OI    ALLOK,B'00100000'                                   1131 05515000
*        END DOLOOP40;                                     /*@YL026UL*/ 05516000
*                                                                  1132 05517000
@RF01130 DS    0H                                                  1132 05518000
@RC01125 DS    0H                                                  1132 05519000
@RF01124 DS    0H                                                  1132 05520000
@RC01115 DS    0H                                                  1132 05521000
@DE01103 TM    ALLOK,B'00100000'                                   1132 05522000
         BZ    @DL01103                                            1132 05523000
*        IF KEEP1ST=NO                                             1133 05524000
*          THEN                                                    1133 05525000
         TM    KEEP1ST,B'10000000'                                 1133 05526000
         BNZ   @RF01133                                            1133 05527000
*            ERASEID=ID1;                                  /*@YL026UL*/ 05528000
         L     @07,@PC00013                                        1134 05529000
         LH    ERASEID,ID1(,@07)                                   1134 05530000
*          ELSE                                                    1135 05531000
*            ERASEID=ID2;                                  /*@YL026UL*/ 05532000
*                                                                  1135 05533000
         B     @RC01133                                            1135 05534000
@RF01133 L     @07,@PC00013+4                                      1135 05535000
         LH    ERASEID,ID2(,@07)                                   1135 05536000
*        /************************************************************/ 05537000
*        /*                                                  @YL026UL*/ 05538000
*        /* FOR THE PARAMETER NOT CHOSEN, ELIMINATE ALL      @YL026UL*/ 05539000
*        /* PRESENCE OF IT AND ITS SUBPARMS FROM THE FDT     @YL026UL*/ 05540000
*        /* AND FROM THE PARM OCCURRENCE TABLE.              @YL026UL*/ 05541000
*        /*                                                  @YL026UL*/ 05542000
*        /************************************************************/ 05543000
*        INDEX10=PARMID;                                   /*@YL026UL*/ 05544000
@RC01133 LH    @07,PARMID                                          1136 05545000
         STH   @07,INDEX10                                         1136 05546000
*DOLOOP45:DO PARMID=1 TO MAXID;                            /*@YL026UL*/ 05547000
DOLOOP45 LA    @07,1                                               1137 05548000
         B     @DE01137                                            1137 05549000
@DL01137 DS    0H                                                  1138 05550000
*          TESTID=PARMID;                                  /*@YL026UL*/ 05551000
         LR    TESTID,@07                                          1138 05552000
*          DO WHILE(PARMFLAG(PARMID)=INPUT & TESTID^=0);   /*@YL026UL*/ 05553000
         B     @DE01139                                            1139 05554000
@DL01139 DS    0H                                                  1140 05555000
*            IF TESTID=ERASEID                                     1140 05556000
*              THEN                                                1140 05557000
         CR    TESTID,ERASEID                                      1140 05558000
         BNE   @RF01140                                            1140 05559000
*                DO;                                       /*@YL026UL*/ 05560000
*                PARMFLAG(PARMID)=PARTOSET;                /*@YL026UL*/ 05561000
         L     @07,PINFOPTR                                        1142 05562000
         LH    @15,PARMID                                          1142 05563000
         LR    @14,@15                                             1142 05564000
         MH    @14,@CH00038                                        1142 05565000
         LA    @05,1                                               1142 05566000
         LA    @04,0(@14,@07)                                      1142 05567000
         BCTR  @04,0                                               1142 05568000
         BCTR  @04,0                                               1142 05569000
         STC   @05,PARMFLAG-10(,@04)                               1142 05570000
*                IF OCCURNUM=1                                     1143 05571000
*                  THEN                                            1143 05572000
         AL    @07,@CF01818                                        1143 05573000
         L     @07,PARMPTR(@14,@07)                                1143 05574000
         CLC   OCCURNUM(3,@07),@CF00227+1                          1143 05575000
         BNE   @RF01143                                            1143 05576000
*                    FDTPTR(PARMID)=0;                     /*@YL026UL*/ 05577000
         SLA   @15,2                                               1144 05578000
         L     @07,@PC00001+4                                      1144 05579000
         L     @07,FDTADDR(,@07)                                   1144 05580000
         SLR   @14,@14                                             1144 05581000
         ST    @14,FDTPTR-4(@15,@07)                               1144 05582000
*                  ELSE                                            1145 05583000
*                    VECTRVAL=0;                           /*@YL026UL*/ 05584000
         B     @RC01143                                            1145 05585000
@RF01143 LH    @07,PARMID                                          1145 05586000
         SLA   @07,2                                               1145 05587000
         L     @15,@PC00001+4                                      1145 05588000
         L     @01,FDTADDR(,@15)                                   1145 05589000
         LH    @15,REPINDEX                                        1145 05590000
         MH    @15,@CH00038                                        1145 05591000
         L     @14,RSIPTR                                          1145 05592000
         BCTR  @14,0                                               1145 05593000
         BCTR  @14,0                                               1145 05594000
         LH    @15,VECTRDSP-10(@15,@14)                            1145 05595000
         AL    @15,FDTPTR-4(@07,@01)                               1145 05596000
         SLR   @07,@07                                             1145 05597000
         ST    @07,VECTRVAL(,@15)                                  1145 05598000
*                END;                                      /*@YL026UL*/ 05599000
*              ELSE                                                1147 05600000
*                TESTID=SUPRPARM(TESTID);                  /*@YL026UL*/ 05601000
         B     @RC01140                                            1147 05602000
@RF01140 LR    @07,TESTID                                          1147 05603000
         MH    @07,@CH00038                                        1147 05604000
         L     @01,PINFOPTR                                        1147 05605000
         AL    @01,@CF01819                                        1147 05606000
         LH    @07,SUPRPARM-8(@07,@01)                             1147 05607000
         LR    TESTID,@07                                          1147 05608000
*          END;                                            /*@YL026UL*/ 05609000
@RC01140 DS    0H                                                  1148 05610000
@DE01139 LH    @07,PARMID                                          1148 05611000
         MH    @07,@CH00038                                        1148 05612000
         L     @01,PINFOPTR                                        1148 05613000
         BCTR  @01,0                                               1148 05614000
         BCTR  @01,0                                               1148 05615000
         SLR   @00,@00                                             1148 05616000
         IC    @00,PARMFLAG-10(@07,@01)                            1148 05617000
         C     @00,@CF00161                                        1148 05618000
         BNE   @DC01139                                            1148 05619000
         LTR   TESTID,TESTID                                       1148 05620000
         BNZ   @DL01139                                            1148 05621000
@DC01139 DS    0H                                                  1149 05622000
*        END DOLOOP45;                                     /*@YL026UL*/ 05623000
         LA    @07,1                                               1149 05624000
         AH    @07,PARMID                                          1149 05625000
@DE01137 STH   @07,PARMID                                          1149 05626000
         L     @02,DESCPTR                                         1149 05627000
         CH    @07,MAXID(,@02)                                     1149 05628000
         BNH   @DL01137                                            1149 05629000
*        PARMID=INDEX10;                                   /*@YL026UL*/ 05630000
*                                                                  1150 05631000
         LH    @07,INDEX10                                         1150 05632000
         STH   @07,PARMID                                          1150 05633000
*        END RESOLVE;                                      /*@YL026UL*/ 05634000
*                                                                  1151 05635000
*                                                                  1151 05636000
         B     @EL00013                                            1151 05637000
*        END NOTPARMS;                                     /*@YL026UL*/ 05638000
@EL00012 DS    0H                                                  1152 05639000
@EF00012 DS    0H                                                  1152 05640000
@ER00012 LM    @14,@12,@SA00012                                    1152 05641000
         BR    @14                                                 1152 05642000
*/********************************************************************/ 05643000
*/*                                                          @YL026UL*/ 05644000
*/*  PROCEDURE NAME - DEFAULTS                               @YL026UL*/ 05645000
*/*                                                          @YL026UL*/ 05646000
*/*  FUNCTION - THIS ROUTINE SELECTS UNCODED PARAMETERS FROM @YL026UL*/ 05647000
*/*             THE PARAMETER SET CURRENTLY BEING PROCESSED  @YL026UL*/ 05648000
*/*             WHICH ARE ELIGIBLE TO BE DEFAULTED.  A SUB-  @YL026UL*/ 05649000
*/*             ROUTINE IS THEN CALLED WHICH ACTUALLY        @YL026UL*/ 05650000
*/*             ADDS THE DEFAULTS TO THE FDT.                @YL026UL*/ 05651000
*/*                                                          @YL026UL*/ 05652000
*/*  INPUT -                                                 @YL026UL*/ 05653000
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/ 05654000
*/*            PARMFLAG- FLAGS IN 'PARMINFO' INDICATING      @YL026UL*/ 05655000
*/*                      WHICH PARMS MIGHT BE INPUT AND      @YL026UL*/ 05656000
*/*                      WHICH ONES ARE ACTUALLY INPUT.      @YL026UL*/ 05657000
*/*                                                          @YL026UL*/ 05658000
*/*  OUTPUT -                                                @YL026UL*/ 05659000
*/*            FDT -     DEFAULT PARMS ARE ADDED TO THOSE    @YL026UL*/ 05660000
*/*                      EXPLICITLY CODED.                   @YL026UL*/ 05661000
*/*            LASTCC -  AMS CONDITION CODE.                 @YL026UL*/ 05662000
*/*                                                          @YL026UL*/ 05663000
*/********************************************************************/ 05664000
*DEFAULTS:PROCEDURE;                                       /*@YL026UL*/ 05665000
DEFAULTS STM   @14,@02,@SA00014                                    1153 05666000
         STM   @05,@06,@SA00014+20                                 1153 05667000
         STM   @08,@12,@SA00014+28                                 1153 05668000
*        /************************************************************/ 05669000
*        /*                                                  @YL026UL*/ 05670000
*        /*  ** DEFAULTS **  APPLY DEFAULT PARAMETERS        @YL026UL*/ 05671000
*        /*                                                  @YL026UL*/ 05672000
*        /************************************************************/ 05673000
*        OLDERID2 = NEWERID2;                                      1154 05674000
         L     @05,GDTTR2(,GDTPTR)                                 1154 05675000
         MVC   @TS00001(95),NEWERID2(@05)                          1154 05676000
         MVC   OLDERID2(95,@05),@TS00001                           1154 05677000
*        NEWID2='RI34';                                    /*@YL026UL*/ 05678000
*                                                                  1155 05679000
         MVC   NEWID2(4,@05),@CC01744                              1155 05680000
*        /************************************************************/ 05681000
*        /*                                                  @YL026UL*/ 05682000
*        /* IF 'DEFAULT' GROUPS ARE SPECIFIED, FIND THE      @YL026UL*/ 05683000
*        /* GROUP(S) WHICH PERTAIN TO THE PARAMETER SET      @YL026UL*/ 05684000
*        /* CURRENTLY BEING PROCESSED.  (IF THE 1ST PARM IN  @YL026UL*/ 05685000
*        /* A GROUP PERTAINS, THEN THE WHOLE GROUP DOES).    @YL026UL*/ 05686000
*        /*                                                  @YL026UL*/ 05687000
*        /************************************************************/ 05688000
*        IF DGRPDSPL^=0                                            1156 05689000
*          THEN                                                    1156 05690000
         L     @05,DESCPTR                                         1156 05691000
         CLI   DGRPDSPL(@05),0                                     1156 05692000
         BE    @RF01156                                            1156 05693000
*DOGRP65:    DO;                                           /*@YL026UL*/ 05694000
DOGRP65  DS    0H                                                  1158 05695000
*            GRPPTR=ADDR(DGRPTOT)+LENGTH(DGRPTOT);         /*@YL026UL*/ 05696000
         L     @02,DESCPTR                                         1158 05697000
         SLR   GRPPTR,GRPPTR                                       1158 05698000
         IC    GRPPTR,DGRPDSPL(,@02)                               1158 05699000
         ALR   GRPPTR,GRPPTR                                       1158 05700000
         ALR   @02,GRPPTR                                          1158 05701000
         AL    @02,@CF00161                                        1158 05702000
         LR    GRPPTR,@02                                          1158 05703000
*DOLOOP50:   DO INDEX10=1 TO DGRPTOT;                      /*@YL026UL*/ 05704000
DOLOOP50 LA    @05,1                                               1159 05705000
         B     @DE01159                                            1159 05706000
@DL01159 DS    0H                                                  1160 05707000
*              IF PARMFLAG(DGRPID(1))=PARTOSET                     1160 05708000
*                THEN                                              1160 05709000
*                                                                  1160 05710000
         LA    @05,1                                               1160 05711000
         LH    @02,DGRPID(,GRPPTR)                                 1160 05712000
         MH    @02,@CH00038                                        1160 05713000
         L     @01,PINFOPTR                                        1160 05714000
         BCTR  @01,0                                               1160 05715000
         BCTR  @01,0                                               1160 05716000
         SLR   @00,@00                                             1160 05717000
         IC    @00,PARMFLAG-10(@02,@01)                            1160 05718000
         CR    @05,@00                                             1160 05719000
         BNE   @RF01160                                            1160 05720000
*                  /**************************************************/ 05721000
*                  /*                                        @YL026UL*/ 05722000
*                  /* IF NONE OF THE PARMS OF A GROUP WERE   @YL026UL*/ 05723000
*                  /* CODED, DEFAULT THE 1ST PARM IDENTIFIED @YL026UL*/ 05724000
*                  /* IN THE SUBLIST OF ID#S                 @YL026UL*/ 05725000
*                  /*                                        @YL026UL*/ 05726000
*                  /**************************************************/ 05727000
*                  DO;                                     /*@YL026UL*/ 05728000
*                    FOUND=NO;                             /*@YL026UL*/ 05729000
         NI    FOUND,B'11111101'                                   1162 05730000
*                    DO INDEX9=1 TO DGRPCNT;               /*@YL026UL*/ 05731000
         B     @DE01163                                            1163 05732000
@DL01163 DS    0H                                                  1164 05733000
*                      IF PARMFLAG(DGRPID(INDEX9))=INPUT           1164 05734000
*                        THEN                                      1164 05735000
         ALR   @05,@05                                             1164 05736000
         LH    @05,DGRPID-2(@05,GRPPTR)                            1164 05737000
         MH    @05,@CH00038                                        1164 05738000
         L     @02,PINFOPTR                                        1164 05739000
         BCTR  @02,0                                               1164 05740000
         BCTR  @02,0                                               1164 05741000
         SLR   @15,@15                                             1164 05742000
         IC    @15,PARMFLAG-10(@05,@02)                            1164 05743000
         C     @15,@CF00161                                        1164 05744000
         BNE   @RF01164                                            1164 05745000
*                          FOUND=YES;                      /*@YL026UL*/ 05746000
         OI    FOUND,B'00000010'                                   1165 05747000
*                    END;                                  /*@YL026UL*/ 05748000
@RF01164 LA    @05,1                                               1166 05749000
         AH    @05,INDEX9                                          1166 05750000
@DE01163 STH   @05,INDEX9                                          1166 05751000
         CH    @05,DGRPCNT(,GRPPTR)                                1166 05752000
         BNH   @DL01163                                            1166 05753000
*                    IF FOUND=NO                                   1167 05754000
*                      THEN                                        1167 05755000
         TM    FOUND,B'00000010'                                   1167 05756000
         BNZ   @RF01167                                            1167 05757000
*                        DO;                               /*@YL026UL*/ 05758000
*                                                                  1168 05759000
*                        /********************************************/ 05760000
*                        /*                                  @Y30SSFR*/ 05761000
*                        /*  CALL SETDFLT TO SET UP THE      @Y30SSFR*/ 05762000
*                        /*  DEFAULT VALUES FOR THIS GROUP   @Y30SSFR*/ 05763000
*                        /*  OF PARAMETERS.                  @Y30SSFR*/ 05764000
*                        /*  IF SETDFLT FAILS, RETURN TO     @Y30SSFR*/ 05765000
*                        /*  THE CALLER.                     @Y30SSFR*/ 05766000
*                        /*                                  @Y30SSFR*/ 05767000
*                        /********************************************/ 05768000
*                        CALL SETDFLT(DGRPID(1));          /*@YL026UL*/ 05769000
*                                                                  1169 05770000
         LA    @05,DGRPID(,GRPPTR)                                 1169 05771000
         ST    @05,@AL00001                                        1169 05772000
         LA    @01,@AL00001                                        1169 05773000
         BAL   @14,SETDFLT                                         1169 05774000
*                        IF LASTCC^=0                              1170 05775000
*                          THEN                                    1170 05776000
         L     @05,@PC00001+16                                     1170 05777000
         LH    @05,LASTCC(,@05)                                    1170 05778000
         LTR   @05,@05                                             1170 05779000
         BNZ   @RT01170                                            1170 05780000
*                            RETURN;                       /*@YL026UL*/ 05781000
*                        END;                              /*@YL026UL*/ 05782000
*                  END;                                    /*@YL026UL*/ 05783000
@RF01167 DS    0H                                                  1174 05784000
*              GRPPTR=GRPPTR+LENGTH(DGRPCNT)+                      1174 05785000
*                     DGRPCNT*LENGTH(DGRPID);              /*@YL026UL*/ 05786000
@RF01160 LA    @05,2                                               1174 05787000
         ALR   @05,GRPPTR                                          1174 05788000
         LH    @02,DGRPCNT(,GRPPTR)                                1174 05789000
         ALR   @02,@02                                             1174 05790000
         ALR   @05,@02                                             1174 05791000
         LR    GRPPTR,@05                                          1174 05792000
*            END DOLOOP50;                                 /*@YL026UL*/ 05793000
         LA    @05,1                                               1175 05794000
         AH    @05,INDEX10                                         1175 05795000
@DE01159 STH   @05,INDEX10                                         1175 05796000
         L     @02,DESCPTR                                         1175 05797000
         SLR   @15,@15                                             1175 05798000
         IC    @15,DGRPDSPL(,@02)                                  1175 05799000
         ALR   @15,@15                                             1175 05800000
         AL    @15,DESCPTR                                         1175 05801000
         CH    @05,DGRPTOT(,@15)                                   1175 05802000
         BNH   @DL01159                                            1175 05803000
*            END DOGRP65;                                  /*@YL026UL*/ 05804000
*                                                                  1176 05805000
*        /************************************************************/ 05806000
*        /*                                                  @YL026UL*/ 05807000
*        /* EXAMINE EACH PARAMETER DEFINED AS PART OF THE    @YL026UL*/ 05808000
*        /* CURRENT PARM SET TO SEE IF A DEFAULT CONSTANT    @YL026UL*/ 05809000
*        /* IS PROVIDED FOR IT.  IF A CONSTANT IS PRESENT    @YL026UL*/ 05810000
*        /* AND THE PARM IS NOT ALREADY CODED, THEN IT IS    @YL026UL*/ 05811000
*        /* ELIGIBLE TO BE DEFAULTED.                        @YL026UL*/ 05812000
*        /*                                                  @YL026UL*/ 05813000
*        /************************************************************/ 05814000
*        DO INDEX9=1 TO MAXID;                             /*@YL026UL*/ 05815000
@RF01156 LA    @05,1                                               1177 05816000
         B     @DE01177                                            1177 05817000
@DL01177 DS    0H                                                  1178 05818000
*          IF PARMFLAG(INDEX9)=PARTOSET &                          1178 05819000
*             PARMPTR(INDEX9)->DEFAULT=YES                         1178 05820000
*            THEN                                                  1178 05821000
         L     @02,PINFOPTR                                        1178 05822000
         MH    @05,@CH00038                                        1178 05823000
         LA    @01,0(@05,@02)                                      1178 05824000
         BCTR  @01,0                                               1178 05825000
         BCTR  @01,0                                               1178 05826000
         SLR   @00,@00                                             1178 05827000
         IC    @00,PARMFLAG-10(,@01)                               1178 05828000
         C     @00,@CF00227                                        1178 05829000
         BNE   @RF01178                                            1178 05830000
         AL    @02,@CF01818                                        1178 05831000
         L     @05,PARMPTR(@05,@02)                                1178 05832000
         TM    DEFAULT(@05),B'00000100'                            1178 05833000
         BNO   @RF01178                                            1178 05834000
*              DO;                                         /*@YL026UL*/ 05835000
*                                                                  1179 05836000
*              CALL SETDFLT(INDEX9);                       /*@YL026UL*/ 05837000
*                                                                  1180 05838000
         LA    @05,INDEX9                                          1180 05839000
         ST    @05,@AL00001                                        1180 05840000
         LA    @01,@AL00001                                        1180 05841000
         BAL   @14,SETDFLT                                         1180 05842000
*              IF LASTCC^=0                                        1181 05843000
*                THEN                                              1181 05844000
         L     @05,@PC00001+16                                     1181 05845000
         LH    @05,LASTCC(,@05)                                    1181 05846000
         LTR   @05,@05                                             1181 05847000
         BNZ   @RT01181                                            1181 05848000
*                  RETURN;                                 /*@YL026UL*/ 05849000
*              END;                                        /*@YL026UL*/ 05850000
*        END;                                              /*@YL026UL*/ 05851000
*                                                                  1184 05852000
@RF01178 LA    @05,1                                               1184 05853000
         AH    @05,INDEX9                                          1184 05854000
@DE01177 STH   @05,INDEX9                                          1184 05855000
         L     @02,DESCPTR                                         1184 05856000
         CH    @05,MAXID(,@02)                                     1184 05857000
         BNH   @DL01177                                            1184 05858000
*/********************************************************************/ 05859000
*/*                                                          @YL026UL*/ 05860000
*/*  PROCEDURE NAME - SETDFLT                                @YL026UL*/ 05861000
*/*                                                          @YL026UL*/ 05862000
*/*  FUNCTION - THIS ROUTINE CHECKS A PARAMETER WHICH IS     @YL026UL*/ 05863000
*/*             ELIGIBLE TO BE DEFAULTED TO SEE IF THE       @YL026UL*/ 05864000
*/*             DEFAULT WILL CAUSE ANY CONFLICT WITH AN      @YL026UL*/ 05865000
*/*             EXISTING INPUT PARAMETER.  IF NOT, THE PARM  @YL026UL*/ 05866000
*/*             IS ADDED TO THE FDT (VIA THE 'TRNSLATE' AND  @YL026UL*/ 05867000
*/*             'PARSE' ROUTINES IF A DEFAULT CONSTANT IS    @YL026UL*/ 05868000
*/*             PROVIDED).                                   @YL026UL*/ 05869000
*/*                                                          @YL026UL*/ 05870000
*/*  INPUT -                                                 @YL026UL*/ 05871000
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/ 05872000
*/*            DFLTPARM- PARM ID# OF PARM WHICH IS ELIGIBLE  @YL026UL*/ 05873000
*/*                      TO BE DEFAULTED.                    @YL026UL*/ 05874000
*/*            PARMINFO- PARM INFORMATION TABLE.             @YL026UL*/ 05875000
*/*                                                          @YL026UL*/ 05876000
*/*  OUTPUT -                                                @YL026UL*/ 05877000
*/*            PARMFLAG- FLAG(S) IN 'PARMINFO' SET TO NOTE   @YL026UL*/ 05878000
*/*                      THE NEW PARMS WHICH WERE DEFAULTED  @YL026UL*/ 05879000
*/*            FDT -     POINTER VECTOR AND DATA STRUCTURE   @YL026UL*/ 05880000
*/*                      ENTRIES FOR THE DEFAULT PARM(S).    @YL026UL*/ 05881000
*/*            LASTCC -  AMS CONDITION CODE.                 @YL026UL*/ 05882000
*/*                                                          @YL026UL*/ 05883000
*/********************************************************************/ 05884000
*SETDFLT:PROCEDURE(DFLTPARM);                              /*@YL026UL*/ 05885000
         B     @PB00015                                            1185 05886000
SETDFLT  STM   @14,@02,@SA00015                                    1185 05887000
         STM   @05,@06,@SA00015+20                                 1185 05888000
         STM   @08,@12,@SA00015+28                                 1185 05889000
         MVC   @PC00015(4),0(@01)                                  1185 05890000
*        /************************************************************/ 05891000
*        /*                                                  @YL026UL*/ 05892000
*        /*  ** SETDFLT  **  DATA DEFINITIONS                @YL026UL*/ 05893000
*        /*                                                  @YL026UL*/ 05894000
*        /************************************************************/ 05895000
*                                                                  1186 05896000
*        DCL DFLTPARM FIXED(15);       /*ID# OF PARM TO BE   @YL026UL*/ 05897000
*                                      /*DEFAULTED           @YL026UL*/ 05898000
*        DCL DFLTOK   BIT(1);          /*SET 'ON' IF PARM    @YL026UL*/ 05899000
*                                      /*MAY BE DEFAULTED    @YL026UL*/ 05900000
*        DCL WORKPTR2 PTR(31);         /*VARIABLE TO SAVE A  @YL026UL*/ 05901000
*                                      /*PTR TEMPORARILY     @YL026UL*/ 05902000
*        /************************************************************/ 05903000
*        /*                                                  @YL026UL*/ 05904000
*        /*  ** SETDFLT **  ADD DEFAULTS TO THE FDT          @YL026UL*/ 05905000
*        /*                                                  @YL026UL*/ 05906000
*        /************************************************************/ 05907000
*        OLDERID2 = NEWERID2;                                      1189 05908000
         L     @05,GDTTR2(,GDTPTR)                                 1189 05909000
         MVC   @TS00001(95),NEWERID2(@05)                          1189 05910000
         MVC   OLDERID2(95,@05),@TS00001                           1189 05911000
*        NEWID2='RI36';                                    /*@YL026UL*/ 05912000
*                                                                  1190 05913000
         MVC   NEWID2(4,@05),@CC01757                              1190 05914000
*        /************************************************************/ 05915000
*        /*                                                  @YL026UL*/ 05916000
*        /* THE PARAMETER TO BE DEFAULTED IS CHECKED TO      @YL026UL*/ 05917000
*        /* INSURE THAT ITS PRESENCE WILL NOT CREATE A       @YL026UL*/ 05918000
*        /* CONFLICT WITH AN EXISTING INPUT PARAMETER.       @YL026UL*/ 05919000
*        /* SINCE KEYWORD SUPERPARM(S) OF THE DEFAULT PARM   @YL026UL*/ 05920000
*        /* ARE TO BE DEFAULTED (AS NECESSARY) ALONG WITH    @YL026UL*/ 05921000
*        /* IT, THESE SUPERPARM(S) ARE ALSO CHECKED FOR      @YL026UL*/ 05922000
*        /* POTENTIAL CONFLICTS                              @YL026UL*/ 05923000
*        /*                                                  @YL026UL*/ 05924000
*        /************************************************************/ 05925000
*        PARMID=DFLTPARM;                                  /*@YL026UL*/ 05926000
         L     @05,@PC00015                                        1191 05927000
         LH    @05,DFLTPARM(,@05)                                  1191 05928000
         STH   @05,PARMID                                          1191 05929000
*        DFLTOK=YES;                                       /*@YL026UL*/ 05930000
         OI    DFLTOK,B'10000000'                                  1192 05931000
*DOLOOP55:DO WHILE(DFLTOK=YES & PARMID^=0 &                        1193 05932000
*                  PARMFLAG(PARMID)=PARTOSET);             /*@YL026UL*/ 05933000
*                                                                  1193 05934000
DOLOOP55 B     @DE01193                                            1193 05935000
@DL01193 DS    0H                                                  1194 05936000
*          /**********************************************************/ 05937000
*          /*                                                @YL026UL*/ 05938000
*          /* FIRST, CHECK FOR A LIST OF CONFLICTING PARMS   @YL026UL*/ 05939000
*          /* SPECIFICALLY ASSOCIATED WITH THE DEFAULT PARM, @YL026UL*/ 05940000
*          /* AND BE SURE THAT NO CONFLICTS WOULD EXIST.     @YL026UL*/ 05941000
*          /*                                                @YL026UL*/ 05942000
*          /**********************************************************/ 05943000
*          IF NOTDSPL > 0                                          1194 05944000
*            THEN                                                  1194 05945000
         LH    @05,PARMID                                          1194 05946000
         MH    @05,@CH00038                                        1194 05947000
         L     @02,PINFOPTR                                        1194 05948000
         AL    @02,@CF01818                                        1194 05949000
         L     @05,PARMPTR(@05,@02)                                1194 05950000
         CLI   NOTDSPL(@05),0                                      1194 05951000
         BNH   @RF01194                                            1194 05952000
*              DO INDEX11=1 TO NOTCOUNT;                   /*@YL026UL*/ 05953000
         LA    INDEX11,1                                           1195 05954000
         B     @DE01195                                            1195 05955000
@DL01195 DS    0H                                                  1196 05956000
*                IF PARMFLAG(NOTID(INDEX11))=INPUT                 1196 05957000
*                  THEN                                            1196 05958000
         L     @05,PINFOPTR                                        1196 05959000
         LA    @15,12                                              1196 05960000
         LR    @14,INDEX11                                         1196 05961000
         ALR   @14,@14                                             1196 05962000
         LR    @01,@15                                             1196 05963000
         MH    @01,PARMID                                          1196 05964000
         AL    @01,@CF01818                                        1196 05965000
         L     @01,PARMPTR(@01,@05)                                1196 05966000
         SLR   @00,@00                                             1196 05967000
         IC    @00,NOTDSPL(,@01)                                   1196 05968000
         ALR   @00,@00                                             1196 05969000
         ALR   @01,@00                                             1196 05970000
         MH    @15,NOTID-2(@14,@01)                                1196 05971000
         BCTR  @05,0                                               1196 05972000
         BCTR  @05,0                                               1196 05973000
         SLR   @14,@14                                             1196 05974000
         IC    @14,PARMFLAG-10(@15,@05)                            1196 05975000
         C     @14,@CF00161                                        1196 05976000
         BNE   @RF01196                                            1196 05977000
*                    DFLTOK=NO;                            /*@YL026UL*/ 05978000
         NI    DFLTOK,B'01111111'                                  1197 05979000
*              END;                                        /*@YL026UL*/ 05980000
*                                                                  1198 05981000
@RF01196 AL    INDEX11,@CF00227                                    1198 05982000
@DE01195 LH    @05,PARMID                                          1198 05983000
         MH    @05,@CH00038                                        1198 05984000
         LH    @15,PARMID                                          1198 05985000
         MH    @15,@CH00038                                        1198 05986000
         L     @01,PINFOPTR                                        1198 05987000
         AL    @01,@CF01818                                        1198 05988000
         L     @01,PARMPTR(@15,@01)                                1198 05989000
         SLR   @15,@15                                             1198 05990000
         IC    @15,NOTDSPL(,@01)                                   1198 05991000
         ALR   @15,@15                                             1198 05992000
         L     @14,PINFOPTR                                        1198 05993000
         AL    @14,@CF01818                                        1198 05994000
         AL    @15,PARMPTR(@05,@14)                                1198 05995000
         CH    INDEX11,NOTCOUNT(,@15)                              1198 05996000
         BNH   @DL01195                                            1198 05997000
*          /**********************************************************/ 05998000
*          /*                                                @YL026UL*/ 05999000
*          /* THEN CHECK FOR THE OCCURRENCE OF THIS DEFAULT  @YL026UL*/ 06000000
*          /* PARAMETER IN A 'NOT GROUP' (A SET OF MUTUALLY  @YL026UL*/ 06001000
*          /* EXCLUSIVE PARMS), AND BE SURE THAT NO OTHER    @YL026UL*/ 06002000
*          /* PARAMETER IN THE GROUP IS INPUT                @YL026UL*/ 06003000
*          /*                                                @YL026UL*/ 06004000
*          /**********************************************************/ 06005000
*          IF DFLTOK=YES & NTGRPPTR(PARMID)^=NULLPTR               1199 06006000
*            THEN                                                  1199 06007000
@RF01194 TM    DFLTOK,B'10000000'                                  1199 06008000
         BNO   @RF01199                                            1199 06009000
         LH    @05,PARMID                                          1199 06010000
         MH    @05,@CH00038                                        1199 06011000
         L     @02,PINFOPTR                                        1199 06012000
         AL    @02,@CF01817                                        1199 06013000
         L     @05,NTGRPPTR-4(@05,@02)                             1199 06014000
         LTR   @05,@05                                             1199 06015000
         BZ    @RF01199                                            1199 06016000
*              DO;                                         /*@YL026UL*/ 06017000
         ST    @05,@TF00001                                        1200 06018000
*                WORKPTR2=GRPPTR;                          /*@YL026UL*/ 06019000
         LR    WORKPTR2,GRPPTR                                     1201 06020000
*                GRPPTR=NTGRPPTR(PARMID);                  /*@YL026UL*/ 06021000
         L     GRPPTR,@TF00001                                     1202 06022000
*                DO INDEX11=1 TO NTGRPCNT;                 /*@YL026UL*/ 06023000
         LA    INDEX11,1                                           1203 06024000
         B     @DE01203                                            1203 06025000
@DL01203 DS    0H                                                  1204 06026000
*                  IF PARMFLAG(NTGRPID(INDEX11))=INPUT &           1204 06027000
*                     NTGRPID(INDEX11)^=PARMID                     1204 06028000
*                    THEN                                          1204 06029000
         LR    @15,INDEX11                                         1204 06030000
         ALR   @15,@15                                             1204 06031000
         LH    @15,NTGRPID-2(@15,GRPPTR)                           1204 06032000
         LR    @14,@15                                             1204 06033000
         MH    @14,@CH00038                                        1204 06034000
         L     @01,PINFOPTR                                        1204 06035000
         BCTR  @01,0                                               1204 06036000
         BCTR  @01,0                                               1204 06037000
         SLR   @00,@00                                             1204 06038000
         IC    @00,PARMFLAG-10(@14,@01)                            1204 06039000
         C     @00,@CF00161                                        1204 06040000
         BNE   @RF01204                                            1204 06041000
         CH    @15,PARMID                                          1204 06042000
         BE    @RF01204                                            1204 06043000
*                      DFLTOK=NO;                          /*@YL026UL*/ 06044000
         NI    DFLTOK,B'01111111'                                  1205 06045000
*                END;                                      /*@YL026UL*/ 06046000
@RF01204 AL    INDEX11,@CF00227                                    1206 06047000
@DE01203 CH    INDEX11,NTGRPCNT(,GRPPTR)                           1206 06048000
         BNH   @DL01203                                            1206 06049000
*                GRPPTR=WORKPTR2;                          /*@YL026UL*/ 06050000
         LR    GRPPTR,WORKPTR2                                     1207 06051000
*              END;                                        /*@YL026UL*/ 06052000
*          PARMID=SUPRPARM(PARMID);                        /*@YL026UL*/ 06053000
@RF01199 LH    @05,PARMID                                          1209 06054000
         MH    @05,@CH00038                                        1209 06055000
         L     @02,PINFOPTR                                        1209 06056000
         AL    @02,@CF01819                                        1209 06057000
         LH    @05,SUPRPARM-8(@05,@02)                             1209 06058000
         STH   @05,PARMID                                          1209 06059000
*        END DOLOOP55;                                     /*@YL026UL*/ 06060000
*                                                                  1210 06061000
@DE01193 TM    DFLTOK,B'10000000'                                  1210 06062000
         BNO   @DC01193                                            1210 06063000
         LH    @05,PARMID                                          1210 06064000
         LTR   @05,@05                                             1210 06065000
         BZ    @DC01193                                            1210 06066000
         MH    @05,@CH00038                                        1210 06067000
         L     @02,PINFOPTR                                        1210 06068000
         BCTR  @02,0                                               1210 06069000
         BCTR  @02,0                                               1210 06070000
         SLR   @15,@15                                             1210 06071000
         IC    @15,PARMFLAG-10(@05,@02)                            1210 06072000
         C     @15,@CF00227                                        1210 06073000
         BE    @DL01193                                            1210 06074000
@DC01193 DS    0H                                                  1211 06075000
*        /************************************************************/ 06076000
*        /*                                                  @YL026UL*/ 06077000
*        /* IF NO CONFLICTS WILL OCCUR BY DEFAULTING THIS    @YL026UL*/ 06078000
*        /* PARAMETER, NOTE THE PARM'S (AND SUPERPARM'S)     @YL026UL*/ 06079000
*        /* OCCURRENCE IN THE PARMFLAG TABLE AND IN THE FDT. @YL026UL*/ 06080000
*        /*                                                  @YL026UL*/ 06081000
*        /************************************************************/ 06082000
*        IF DFLTOK=YES                                             1211 06083000
*          THEN                                                    1211 06084000
         TM    DFLTOK,B'10000000'                                  1211 06085000
         BNO   @RF01211                                            1211 06086000
*DOGRP70:    DO;                                           /*@YL026UL*/ 06087000
DOGRP70  DS    0H                                                  1213 06088000
*              PARMID=DFLTPARM;                            /*@YL026UL*/ 06089000
         L     @05,@PC00015                                        1213 06090000
         LH    @05,DFLTPARM(,@05)                                  1213 06091000
         STH   @05,PARMID                                          1213 06092000
*DOLOOP60:     DO WHILE(PARMID^=0 &                                1214 06093000
*                       PARMFLAG(PARMID)=PARTOSET);        /*@YL026UL*/ 06094000
DOLOOP60 B     @DE01214                                            1214 06095000
@DL01214 DS    0H                                                  1215 06096000
*                PARMFLAG(PARMID)=INPUT;                   /*@YL026UL*/ 06097000
*                                                                  1215 06098000
         L     @05,PINFOPTR                                        1215 06099000
         LH    @02,PARMID                                          1215 06100000
         LR    @15,@02                                             1215 06101000
         MH    @15,@CH00038                                        1215 06102000
         LA    @14,2                                               1215 06103000
         LA    @01,0(@15,@05)                                      1215 06104000
         BCTR  @01,0                                               1215 06105000
         BCTR  @01,0                                               1215 06106000
         STC   @14,PARMFLAG-10(,@01)                               1215 06107000
*                /****************************************************/ 06108000
*                /*                                          @YL026UL*/ 06109000
*                /* IF NO DEFAULT CONSTANT IS PROVIDED, NOTE @YL026UL*/ 06110000
*                /* IN THE FDT THAT THE PARM IS INPUT BY     @YL026UL*/ 06111000
*                /* SETTING THE FDT PTR TO POINT TO ITSELF.  @YL026UL*/ 06112000
*                /*                                          @YL026UL*/ 06113000
*                /****************************************************/ 06114000
*                IF DEFAULT=NO                                     1216 06115000
*                  THEN                                            1216 06116000
         AL    @05,@CF01818                                        1216 06117000
         L     @05,PARMPTR(@15,@05)                                1216 06118000
         TM    DEFAULT(@05),B'00000100'                            1216 06119000
         BNZ   @RF01216                                            1216 06120000
*                    IF OCCURNUM=1                                 1217 06121000
*                      THEN                                        1217 06122000
         CLC   OCCURNUM(3,@05),@CF00227+1                          1217 06123000
         BNE   @RF01217                                            1217 06124000
*                        FDTPTR(PARMID)=                           1218 06125000
*                                ADDR(FDTPTR(PARMID));     /*@YL026UL*/ 06126000
         SLA   @02,2                                               1218 06127000
         L     @05,@PC00001+4                                      1218 06128000
         L     @05,FDTADDR(,@05)                                   1218 06129000
         LA    @15,FDTPTR-4(@02,@05)                               1218 06130000
         ST    @15,FDTPTR-4(@02,@05)                               1218 06131000
*                      ELSE                                        1219 06132000
*                        VECTRVAL=ADDR(VECTRVAL);          /*@YL026UL*/ 06133000
         B     @RC01217                                            1219 06134000
@RF01217 LH    @05,PARMID                                          1219 06135000
         SLA   @05,2                                               1219 06136000
         L     @02,@PC00001+4                                      1219 06137000
         L     @02,FDTADDR(,@02)                                   1219 06138000
         LH    @15,REPINDEX                                        1219 06139000
         MH    @15,@CH00038                                        1219 06140000
         L     @01,RSIPTR                                          1219 06141000
         BCTR  @01,0                                               1219 06142000
         BCTR  @01,0                                               1219 06143000
         LH    @15,VECTRDSP-10(@15,@01)                            1219 06144000
         AL    @15,FDTPTR-4(@05,@02)                               1219 06145000
         ST    @15,VECTRVAL(,@15)                                  1219 06146000
*                  ELSE                                            1220 06147000
*                                                                  1220 06148000
*                    /************************************************/ 06149000
*                    /*                                      @YL026UL*/ 06150000
*                    /* IF A DEFAULT CONSTANT IS PROVIDED TO @YL026UL*/ 06151000
*                    /* BE ADDED TO THE FDT, THEN FIRST MOVE @YL026UL*/ 06152000
*                    /* IT INTO A COMMAND BUFFER IN PREP.    @YL026UL*/ 06153000
*                    /* FOR PARSING AND TRANSLATING IT.      @YL026UL*/ 06154000
*                    /*                                      @YL026UL*/ 06155000
*                    /************************************************/ 06156000
*DOGRP75:            DO;                                   /*@YL026UL*/ 06157000
         B     @RC01216                                            1220 06158000
@RF01216 DS    0H                                                  1220 06159000
DOGRP75  DS    0H                                                  1221 06160000
*                    AMTTOGET=DEFLTLEN+2*LENGTH(PSETLEN)+1;/*@YL026UL*/ 06161000
*                                                                  1221 06162000
         LH    @02,PARMID                                          1221 06163000
         MH    @02,@CH00038                                        1221 06164000
         L     @01,PINFOPTR                                        1221 06165000
         AL    @01,@CF01818                                        1221 06166000
         L     @02,PARMPTR(@02,@01)                                1221 06167000
         LA    @15,5                                               1221 06168000
         SLR   @14,@14                                             1221 06169000
         IC    @14,DEFLTLEN+24(,@02)                               1221 06170000
         ALR   @15,@14                                             1221 06171000
         ST    @15,AMTTOGET                                        1221 06172000
*                    CALL IDCSAGP0(GDTTBL,AMTTOGET,BUFFPTR,        1222 06173000
*                           SPACEID,SETZERO);              /*@YL026UL*/ 06174000
         ST    GDTPTR,@AL00001                                     1222 06175000
         LA    @02,AMTTOGET                                        1222 06176000
         ST    @02,@AL00001+4                                      1222 06177000
         LA    @02,BUFFPTR                                         1222 06178000
         ST    @02,@AL00001+8                                      1222 06179000
         L     @02,@PC00001+8                                      1222 06180000
         ST    @02,@AL00001+12                                     1222 06181000
         LA    @02,SETZERO                                         1222 06182000
         ST    @02,@AL00001+16                                     1222 06183000
         MVI   @AL00001+16,X'80'                                   1222 06184000
         L     @15,GDTGPL(,GDTPTR)                                 1222 06185000
         LA    @01,@AL00001                                        1222 06186000
         BALR  @14,@15                                             1222 06187000
*                    RESPECIFY RTNREG RSTD;                        1223 06188000
*                    TESTRC = RTNREG;                              1224 06189000
         LR    TESTRC,RTNREG                                       1224 06190000
*                    RESPECIFY RTNREG UNRSTD;              /*@YL026UL*/ 06191000
*                                                                  1225 06192000
*                    IF TESTRC^=0                                  1226 06193000
*                      THEN                                        1226 06194000
         LTR   TESTRC,TESTRC                                       1226 06195000
         BZ    @RF01226                                            1226 06196000
*                        DO;                               /*@YL026UL*/ 06197000
*                                                                  1227 06198000
*                        CALL FAILSPAC;                    /*@YL026UL*/ 06199000
*                                                                  1228 06200000
         BAL   @14,FAILSPAC                                        1228 06201000
*                        RETURN;                           /*@YL026UL*/ 06202000
@EL00015 DS    0H                                                  1229 06203000
@EF00015 DS    0H                                                  1229 06204000
@ER00015 LM    @14,@02,@SA00015                                    1229 06205000
         LM    @05,@06,@SA00015+20                                 1229 06206000
         LM    @08,@12,@SA00015+28                                 1229 06207000
         BR    @14                                                 1229 06208000
*                        END;                              /*@YL026UL*/ 06209000
*                                                                  1230 06210000
*                      ELSE                                        1231 06211000
*                        PPLCBUF=BUFFPTR ;                 /*@YL026UL*/ 06212000
@RF01226 L     @05,BUFFPTR                                         1231 06213000
         L     @02,PPLPTR                                          1231 06214000
         ST    @05,PPLCBUF(,@02)                                   1231 06215000
*                    PSETLEN=DEFLTLEN+LENGTH(CBUFF);       /*@YL026UL*/ 06216000
         LA    @15,12                                              1232 06217000
         LR    @14,@15                                             1232 06218000
         MH    @14,PARMID                                          1232 06219000
         L     @01,PINFOPTR                                        1232 06220000
         AL    @01,@CF01818                                        1232 06221000
         L     @14,PARMPTR(@14,@01)                                1232 06222000
         LA    @01,24                                              1232 06223000
         ALR   @01,@14                                             1232 06224000
         SLR   @00,@00                                             1232 06225000
         IC    @00,DEFLTLEN(,@01)                                  1232 06226000
         LA    @02,4                                               1232 06227000
         ALR   @02,@00                                             1232 06228000
         STH   @02,PSETLEN(,@05)                                   1232 06229000
*                    PARMSET(1:DEFLTLEN)=                          1233 06230000
*                               DEFLTVAL(1:DEFLTLEN);      /*@YL026UL*/ 06231000
*                                                                  1233 06232000
         BCTR  @00,0                                               1233 06233000
         LR    @02,@00                                             1233 06234000
         EX    @02,@SM01867                                        1233 06235000
*                    /************************************************/ 06236000
*                    /*                                      @YL026UL*/ 06237000
*                    /* USE THE DATA TYPE OF THE DEFAULT     @YL026UL*/ 06238000
*                    /* CONSTANT TO SELECT A 'STANDARD' PCL  @YL026UL*/ 06239000
*                    /* DESCRIBING A CONSTANT OF THAT TYPE.  @YL026UL*/ 06240000
*                    /*                                      @YL026UL*/ 06241000
*                    /************************************************/ 06242000
*                    IF NUMBER=YES                                 1234 06243000
*                      THEN                                        1234 06244000
         ALR   @14,@15                                             1234 06245000
         TM    NUMBER(@14),B'10000000'                             1234 06246000
         BNO   @RF01234                                            1234 06247000
*                        PPLPCL=ADDR(NUMPCL);              /*@YL026UL*/ 06248000
         L     @05,PPLPTR                                          1235 06249000
         L     @02,@CV01498                                        1235 06250000
         ST    @02,PPLPCL(,@05)                                    1235 06251000
*                      ELSE                                        1236 06252000
*                        IF ANYSTRNG=YES                           1236 06253000
*                          THEN                                    1236 06254000
         B     @RC01234                                            1236 06255000
@RF01234 LA    @05,12                                              1236 06256000
         LR    @02,@05                                             1236 06257000
         MH    @02,PARMID                                          1236 06258000
         L     @01,PINFOPTR                                        1236 06259000
         AL    @01,@CF01818                                        1236 06260000
         AL    @05,PARMPTR(@02,@01)                                1236 06261000
         TM    ANYSTRNG(@05),B'01000000'                           1236 06262000
         BNO   @RF01236                                            1236 06263000
*                            IF PWORDOPT=YES                       1237 06264000
*                              THEN                                1237 06265000
         TM    PWORDOPT(@05),B'00000010'                           1237 06266000
         BNO   @RF01237                                            1237 06267000
*                                PPLPCL=ADDR(DDNPCL);      /*@YL026UL*/ 06268000
         L     @05,@CV01500                                        1238 06269000
         L     @02,PPLPTR                                          1238 06270000
         ST    @05,PPLPCL(,@02)                                    1238 06271000
*                              ELSE                                1239 06272000
*                                PPLPCL=ADDR(STRPCL);      /*@YL026UL*/ 06273000
*                                                                  1239 06274000
         B     @RC01237                                            1239 06275000
@RF01237 L     @05,@CV01499                                        1239 06276000
         L     @02,PPLPTR                                          1239 06277000
         ST    @05,PPLPCL(,@02)                                    1239 06278000
*                    /************************************************/ 06279000
*                    /*                                      @YL026UL*/ 06280000
*                    /* PASS THE CONSTANT TO 'PARSE' TO BE   @YL026UL*/ 06281000
*                    /* ENCODED.  IF PARSING IS UNSUCCESSFUL @YL026UL*/ 06282000
*                    /* THEN DISCONTINUE PROCESSING.         @YL026UL*/ 06283000
*                    /*                                      @YL026UL*/ 06284000
*                    /************************************************/ 06285000
*                    PARSECB=0;                            /*@YL026UL*/ 06286000
*                                                                  1240 06287000
@RC01237 DS    0H                                                  1240 06288000
@RF01236 DS    0H                                                  1240 06289000
@RC01234 SLR   @05,@05                                             1240 06290000
         ST    @05,PARSECB                                         1240 06291000
*                    DO; /*CALLTSSR EP(IKJPARS)MF(E,PPL)*/         1241 06292000
*                      RESPECIFY GPR01P RSTD;                      1242 06293000
*                      GPR01P = ADDR(PPL);                         1243 06294000
         L     GPR01P,PPLPTR                                       1243 06295000
*                      IF CVTPARS = 0                              1244 06296000
*                        THEN                                      1244 06297000
         L     @02,CVTPTR                                          1244 06298000
         C     @05,CVTPARS(,@02)                                   1244 06299000
         BNE   @RF01244                                            1244 06300000
*                          GEN(LINK EP=IKJPARS);                   1245 06301000
         LINK EP=IKJPARS                                                06302000
*                        ELSE                                      1246 06303000
*                          CALL CVTPARS;                           1246 06304000
         B     @RC01244                                            1246 06305000
@RF01244 L     @05,CVTPTR                                          1246 06306000
         L     @15,CVTPARS(,@05)                                   1246 06307000
         BALR  @14,@15                                             1246 06308000
*                      RESPECIFY GPR01P UNRSTD;                    1247 06309000
@RC01244 DS    0H                                                  1248 06310000
*                    END;       /*@Z40GSJG*/                       1248 06311000
*                                                                  1248 06312000
*                    RESPECIFY RTNREG RSTD;                        1249 06313000
*                    TESTRC = RTNREG;                              1250 06314000
         LR    TESTRC,RTNREG                                       1250 06315000
*                    RESPECIFY RTNREG UNRSTD;              /*@YL026UL*/ 06316000
*                                                                  1251 06317000
*                    /************************************************/ 06318000
*                    /*                                      @Y30SSFR*/ 06319000
*                    /*  IF THE RETURN CODE FROM IKJPARS IS  @Z40GSJG*/ 06320000
*                    /*  NON-ZERO, WE WERE UNABLE TO PARSE   @Z40GSJG*/ 06321000
*                    /*  THE DEFAULT.  IF THE RETURN CODE    @Z40GSJG*/ 06322000
*                    /*  INDICATES THAT THERE WAS NOT ENOUGH @Y30SSFR*/ 06323000
*                    /*  STORAGE, CALL FAILSPACE TO HANDLE   @Y30SSFR*/ 06324000
*                    /*  THE ERROR.  OTHERWISE, SET LASTCC   @Y30SSFR*/ 06325000
*                    /*  TO 12.  RETURN TO THE CALLER.       @Y30SSFR*/ 06326000
*                    /*                                      @Y30SSFR*/ 06327000
*                    /************************************************/ 06328000
*                    IF TESTRC^=0                                  1252 06329000
*                      THEN                                        1252 06330000
         LTR   TESTRC,TESTRC                                       1252 06331000
         BZ    @RF01252                                            1252 06332000
*                        DO;                               /*@YL026UL*/ 06333000
*                        IF TESTRC=BADSPACE                        1254 06334000
*                          THEN                                    1254 06335000
*                                                                  1254 06336000
         C     TESTRC,@CF00487                                     1254 06337000
         BNE   @RF01254                                            1254 06338000
*                            CALL FAILSPAC;                /*@YL026UL*/ 06339000
*                                                                  1255 06340000
         BAL   @14,FAILSPAC                                        1255 06341000
*                          ELSE                                    1256 06342000
*                            LASTCC=LASTCC12;              /*@YL026UL*/ 06343000
         B     @RC01254                                            1256 06344000
@RF01254 L     @05,@PC00001+16                                     1256 06345000
         MVC   LASTCC(2,@05),@CH00038                              1256 06346000
*                        RETURN;                           /*@YL026UL*/ 06347000
         B     @EL00015                                            1257 06348000
*                        END;                              /*@YL026UL*/ 06349000
*                                                                  1258 06350000
*                    /************************************************/ 06351000
*                    /*                                      @YL026UL*/ 06352000
*                    /* TRANSLATE THE ENCODED DEFAULT VALUE  @YL026UL*/ 06353000
*                    /* INTO AN FDT ENTRY.                   @YL026UL*/ 06354000
*                    /*                                      @YL026UL*/ 06355000
*                    /************************************************/ 06356000
*                    SINGLPRM=YES;                         /*@YL026UL*/ 06357000
*                                                                  1259 06358000
@RF01252 OI    SINGLPRM,B'01000000'                                1259 06359000
*                    CALL TRNSLATE;                        /*@YL026UL*/ 06360000
*                                                                  1260 06361000
         BAL   @14,TRNSLATE                                        1260 06362000
*                    /************************************************/ 06363000
*                    /*                                      @Y30SSFR*/ 06364000
*                    /*  IF TRNSLATE FAILS FOR SOME REASON,  @Y30SSFR*/ 06365000
*                    /*  RETURN TO THE CALLER.               @Y30SSFR*/ 06366000
*                    /*                                      @Y30SSFR*/ 06367000
*                    /************************************************/ 06368000
*                    IF LASTCC^=0                                  1261 06369000
*                      THEN                                        1261 06370000
         L     @05,@PC00001+16                                     1261 06371000
         LH    @05,LASTCC(,@05)                                    1261 06372000
         LTR   @05,@05                                             1261 06373000
         BNZ   @RT01261                                            1261 06374000
*                        RETURN;                           /*@YL026UL*/ 06375000
*                    END DOGRP75;                          /*@YL026UL*/ 06376000
*                                                                  1263 06377000
*                PARMID=SUPRPARM(PARMID);                  /*@YL026UL*/ 06378000
@RC01216 LH    @05,PARMID                                          1264 06379000
         MH    @05,@CH00038                                        1264 06380000
         L     @02,PINFOPTR                                        1264 06381000
         AL    @02,@CF01819                                        1264 06382000
         LH    @05,SUPRPARM-8(@05,@02)                             1264 06383000
         STH   @05,PARMID                                          1264 06384000
*              END DOLOOP60;                               /*@YL026UL*/ 06385000
@DE01214 LH    @05,PARMID                                          1265 06386000
         LTR   @05,@05                                             1265 06387000
         BZ    @DC01214                                            1265 06388000
         MH    @05,@CH00038                                        1265 06389000
         L     @02,PINFOPTR                                        1265 06390000
         BCTR  @02,0                                               1265 06391000
         BCTR  @02,0                                               1265 06392000
         SLR   @15,@15                                             1265 06393000
         IC    @15,PARMFLAG-10(@05,@02)                            1265 06394000
         C     @15,@CF00227                                        1265 06395000
         BE    @DL01214                                            1265 06396000
@DC01214 DS    0H                                                  1266 06397000
*            END DOGRP70;                                  /*@YL026UL*/ 06398000
*                                                                  1266 06399000
*        END SETDFLT;                                      /*@YL026UL*/ 06400000
*                                                                  1267 06401000
*                                                                  1267 06402000
         B     @EL00015                                            1267 06403000
*        END DEFAULTS;                                     /*@YL026UL*/ 06404000
@EL00014 DS    0H                                                  1268 06405000
@EF00014 DS    0H                                                  1268 06406000
@ER00014 LM    @14,@02,@SA00014                                    1268 06407000
         LM    @05,@06,@SA00014+20                                 1268 06408000
         LM    @08,@12,@SA00014+28                                 1268 06409000
         BR    @14                                                 1268 06410000
*/********************************************************************/ 06411000
*/*                                                          @YL026UL*/ 06412000
*/*  PROCEDURE NAME - NEEDPRMS                               @YL026UL*/ 06413000
*/*                                                          @YL026UL*/ 06414000
*/*  FUNCTION - THIS ROUTINE CHECKS FOR PARAMETERS WHICH ARE @YL026UL*/ 06415000
*/*             REQUIRED FOR THE CURRENT SET OF PARAMETERS   @YL026UL*/ 06416000
*/*             BEING PROCESSED, BUT WHICH ARE MISSING.  IF  @YL026UL*/ 06417000
*/*             A PARM IS MISSING, THE USER IS SENT A MSG    @YL026UL*/ 06418000
*/*             IDENTIFYING THE PARM AND REQUESTING THAT ITS @YL026UL*/ 06419000
*/*             SUBFIELD BE ENTERED.  THE USER'S RESPONSE    @YL026UL*/ 06420000
*/*             IS THEN PARSED AND TRANSLATED INTO FDT FORM  @YL026UL*/ 06421000
*/*                                                          @YL026UL*/ 06422000
*/*  INPUT -                                                 @YL026UL*/ 06423000
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/ 06424000
*/*            PRMSETID- PARM ID# INDICATING WHETHER THE     @YL026UL*/ 06425000
*/*                      MAIN SET OF PARMS OR A SUBLIST OF   @YL026UL*/ 06426000
*/*                      PARMS ARE BEING PROCESSED.          @YL026UL*/ 06427000
*/*            PARMFLAG- FLAGS IN 'PARMINFO' INDICATING      @YL026UL*/ 06428000
*/*                      WHICH PARAMETERS HAVE BEEN INPUT.   @YL026UL*/ 06429000
*/*                                                          @YL026UL*/ 06430000
*/*  OUTPUT -                                                @YL026UL*/ 06431000
*/*            FDT -     NEW POINTER VECTOR AND DATA         @YL026UL*/ 06432000
*/*                      SUBSTRUCTURE ENTRIES FOR THE NEW    @YL026UL*/ 06433000
*/*                      DATA BEING ENTERED.                 @YL026UL*/ 06434000
*/*            GOODCMD - FLAG INDICATING WHETHER OR NOT NEW  @YL026UL*/ 06435000
*/*                      PARMS HAVE BEEN INPUT.              @YL026UL*/ 06436000
*/*            LASTCC -  AMS CONDITION CODE.                 @YL026UL*/ 06437000
*/*                                                          @YL026UL*/ 06438000
*/********************************************************************/ 06439000
*NEEDPRMS:PROCEDURE;                                       /*@YL026UL*/ 06440000
NEEDPRMS STM   @14,@02,@SA00016                                    1269 06441000
         STM   @05,@06,@SA00016+20                                 1269 06442000
         STM   @08,@12,@SA00016+28                                 1269 06443000
*        /************************************************************/ 06444000
*        /*                                                  @YL026UL*/ 06445000
*        /*  ** NEEDPRMS **  CHECK FOR MISSING PARAMETERS    @YL026UL*/ 06446000
*        /*                                                  @YL026UL*/ 06447000
*        /************************************************************/ 06448000
*        OLDERID2 = NEWERID2;                                      1270 06449000
         L     @05,GDTTR2(,GDTPTR)                                 1270 06450000
         MVC   @TS00001(95),NEWERID2(@05)                          1270 06451000
         MVC   OLDERID2(95,@05),@TS00001                           1270 06452000
*        NEWID2='RI38';                                    /*@YL026UL*/ 06453000
*                                                                  1271 06454000
         MVC   NEWID2(4,@05),@CC01769                              1271 06455000
*        GOODCMD=YES;                                      /*@YL026UL*/ 06456000
         OI    GOODCMD,B'00010000'                                 1272 06457000
*        /************************************************************/ 06458000
*        /*                                                  @YL026UL*/ 06459000
*        /* IF CURRENTLY CHECKING THE MAIN SET OF PARMS,     @YL026UL*/ 06460000
*        /* CHECK FOR MISSING PARAMETERS WHICH MUST BE CODED @YL026UL*/ 06461000
*        /* WHENEVER THE COMMAND IS CODED.  REQUIRED PARMS   @YL026UL*/ 06462000
*        /* ARE DESCRIBED IN A GROUP; AT LEAST ONE PARM IN   @YL026UL*/ 06463000
*        /* EACH GROUP MUST BE CODED (A GROUP MAY CONSIST OF @YL026UL*/ 06464000
*        /* JUST A SINGLE PARAMETER ID#).                    @YL026UL*/ 06465000
*        /*                                                  @YL026UL*/ 06466000
*        /************************************************************/ 06467000
*        IF PRMSETID=0 & VNGRPDSP^=0                               1273 06468000
*          THEN                                                    1273 06469000
         LH    @05,PRMSETID                                        1273 06470000
         LTR   @05,@05                                             1273 06471000
         BNZ   @RF01273                                            1273 06472000
         L     @05,DESCPTR                                         1273 06473000
         CLI   VNGRPDSP(@05),0                                     1273 06474000
         BE    @RF01273                                            1273 06475000
*DOGRP80:    DO;                                           /*@YL026UL*/ 06476000
DOGRP80  DS    0H                                                  1275 06477000
*              GRPPTR=ADDR(VNGRPTOT)+LENGTH(VNGRPTOT);     /*@YL026UL*/ 06478000
         L     @02,DESCPTR                                         1275 06479000
         SLR   GRPPTR,GRPPTR                                       1275 06480000
         IC    GRPPTR,VNGRPDSP(,@02)                               1275 06481000
         ALR   GRPPTR,GRPPTR                                       1275 06482000
         ALR   @02,GRPPTR                                          1275 06483000
         AL    @02,@CF00161                                        1275 06484000
         LR    GRPPTR,@02                                          1275 06485000
*              DO INDEX9=1 TO VNGRPTOT;                    /*@YL026UL*/ 06486000
         LA    @05,1                                               1276 06487000
         B     @DE01276                                            1276 06488000
@DL01276 DS    0H                                                  1277 06489000
*                FOUND=NO;                                 /*@YL026UL*/ 06490000
         NI    FOUND,B'11111101'                                   1277 06491000
*                DO INDEX10=1 TO VNGRPCNT;                 /*@YL026UL*/ 06492000
         LA    @05,1                                               1278 06493000
         B     @DE01278                                            1278 06494000
@DL01278 DS    0H                                                  1279 06495000
*                  IF PARMFLAG(VNGRPID(INDEX10))=INPUT             1279 06496000
*                    THEN                                          1279 06497000
         ALR   @05,@05                                             1279 06498000
         LH    @05,VNGRPID-2(@05,GRPPTR)                           1279 06499000
         MH    @05,@CH00038                                        1279 06500000
         L     @02,PINFOPTR                                        1279 06501000
         BCTR  @02,0                                               1279 06502000
         BCTR  @02,0                                               1279 06503000
         SLR   @15,@15                                             1279 06504000
         IC    @15,PARMFLAG-10(@05,@02)                            1279 06505000
         C     @15,@CF00161                                        1279 06506000
         BNE   @RF01279                                            1279 06507000
*                      FOUND=YES;                          /*@YL026UL*/ 06508000
         OI    FOUND,B'00000010'                                   1280 06509000
*                END;                                      /*@YL026UL*/ 06510000
*                                                                  1281 06511000
@RF01279 LA    @05,1                                               1281 06512000
         AH    @05,INDEX10                                         1281 06513000
@DE01278 STH   @05,INDEX10                                         1281 06514000
         CH    @05,VNGRPCNT(,GRPPTR)                               1281 06515000
         BNH   @DL01278                                            1281 06516000
*                /****************************************************/ 06517000
*                /*                                          @YL026UL*/ 06518000
*                /* IF NO PARMS IN A GROUP HAVE BEEN CODED,  @YL026UL*/ 06519000
*                /* PROMPT FOR THE SUBFIELD OF THE 1ST PARM  @YL026UL*/ 06520000
*                /* IDENTIFIED IN THE GROUP.                 @YL026UL*/ 06521000
*                /*                                          @YL026UL*/ 06522000
*                /****************************************************/ 06523000
*                IF FOUND=NO                                       1282 06524000
*                  THEN                                            1282 06525000
         TM    FOUND,B'00000010'                                   1282 06526000
         BNZ   @RF01282                                            1282 06527000
*                    DO;                                   /*@YL026UL*/ 06528000
*                    SUPERID=VNGRPID(1);                   /*@YL026UL*/ 06529000
*                                                                  1284 06530000
         LH    @05,VNGRPID(,GRPPTR)                                1284 06531000
         STH   @05,SUPERID                                         1284 06532000
*                    CALL ADDPARM;                         /*@YL026UL*/ 06533000
*                                                                  1285 06534000
         BAL   @14,ADDPARM                                         1285 06535000
*                    IF LASTCC^=0                                  1286 06536000
*                      THEN                                        1286 06537000
         L     @05,@PC00001+16                                     1286 06538000
         LH    @05,LASTCC(,@05)                                    1286 06539000
         LTR   @05,@05                                             1286 06540000
         BNZ   @RT01286                                            1286 06541000
*                        RETURN;                           /*@YL026UL*/ 06542000
*                    END;                                  /*@YL026UL*/ 06543000
*                GRPPTR=GRPPTR+LENGTH(VNGRPCNT)+                   1289 06544000
*                     VNGRPCNT*LENGTH(VNGRPID);            /*@YL026UL*/ 06545000
@RF01282 LA    @05,2                                               1289 06546000
         ALR   @05,GRPPTR                                          1289 06547000
         LH    @02,VNGRPCNT(,GRPPTR)                               1289 06548000
         ALR   @02,@02                                             1289 06549000
         ALR   @05,@02                                             1289 06550000
         LR    GRPPTR,@05                                          1289 06551000
*              END;                                        /*@YL026UL*/ 06552000
*                                                                  1290 06553000
         LA    @05,1                                               1290 06554000
         AH    @05,INDEX9                                          1290 06555000
@DE01276 STH   @05,INDEX9                                          1290 06556000
         L     @02,DESCPTR                                         1290 06557000
         SLR   @15,@15                                             1290 06558000
         IC    @15,VNGRPDSP(,@02)                                  1290 06559000
         ALR   @15,@15                                             1290 06560000
         AL    @15,DESCPTR                                         1290 06561000
         CH    @05,VNGRPTOT(,@15)                                  1290 06562000
         BNH   @DL01276                                            1290 06563000
*            END DOGRP80;                                  /*@YL026UL*/ 06564000
*                                                                  1291 06565000
*        /************************************************************/ 06566000
*        /*                                                  @YL026UL*/ 06567000
*        /* CHECK EACH PARAMETER THAT WAS CODED FOR THE      @YL026UL*/ 06568000
*        /* CURRENT SET OF PARMS BEING PROCESSED.  IF A      @YL026UL*/ 06569000
*        /* PARAMETER HAS OTHER PARMS WHICH IT REQUIRES      @YL026UL*/ 06570000
*        /* WHENEVER IT'S CODED, THEN CHECK THAT AT LEAST    @YL026UL*/ 06571000
*        /* ONE PARM IN EACH 'NEED GROUP' HAS BEEN INPUT.    @YL026UL*/ 06572000
*        /*                                                  @YL026UL*/ 06573000
*        /************************************************************/ 06574000
*        DO PARMID=1 TO MAXID;                             /*@YL026UL*/ 06575000
@RF01273 LA    @05,1                                               1292 06576000
         B     @DE01292                                            1292 06577000
@DL01292 DS    0H                                                  1293 06578000
*          IF PARMFLAG(PARMID)=INPUT & NGRPDSPL^=0                 1293 06579000
*            THEN                                                  1293 06580000
         L     @02,PINFOPTR                                        1293 06581000
         MH    @05,@CH00038                                        1293 06582000
         LA    @01,0(@05,@02)                                      1293 06583000
         BCTR  @01,0                                               1293 06584000
         BCTR  @01,0                                               1293 06585000
         SLR   @00,@00                                             1293 06586000
         IC    @00,PARMFLAG-10(,@01)                               1293 06587000
         C     @00,@CF00161                                        1293 06588000
         BNE   @RF01293                                            1293 06589000
         AL    @02,@CF01818                                        1293 06590000
         L     @05,PARMPTR(@05,@02)                                1293 06591000
         CLI   NGRPDSPL(@05),0                                     1293 06592000
         BE    @RF01293                                            1293 06593000
*DOGRP85:      DO;                                         /*@YL026UL*/ 06594000
DOGRP85  DS    0H                                                  1295 06595000
*                GRPPTR=ADDR(NGRPTOT)+LENGTH(NGRPTOT);     /*@YL026UL*/ 06596000
         LH    @02,PARMID                                          1295 06597000
         MH    @02,@CH00038                                        1295 06598000
         L     @01,PINFOPTR                                        1295 06599000
         AL    @01,@CF01818                                        1295 06600000
         L     @02,PARMPTR(@02,@01)                                1295 06601000
         SLR   GRPPTR,GRPPTR                                       1295 06602000
         IC    GRPPTR,NGRPDSPL(,@02)                               1295 06603000
         ALR   GRPPTR,GRPPTR                                       1295 06604000
         ALR   @02,GRPPTR                                          1295 06605000
         AL    @02,@CF00161                                        1295 06606000
         LR    GRPPTR,@02                                          1295 06607000
*                DO INDEX9=1 TO NGRPTOT;                   /*@YL026UL*/ 06608000
         LA    @05,1                                               1296 06609000
         B     @DE01296                                            1296 06610000
@DL01296 DS    0H                                                  1297 06611000
*                  FOUND=NO;                               /*@YL026UL*/ 06612000
         NI    FOUND,B'11111101'                                   1297 06613000
*                  DO INDEX10=1 TO NGRPCNT;                /*@YL026UL*/ 06614000
         LA    @05,1                                               1298 06615000
         B     @DE01298                                            1298 06616000
@DL01298 DS    0H                                                  1299 06617000
*                    IF PARMFLAG(NGRPID(INDEX10))=INPUT            1299 06618000
*                      THEN                                        1299 06619000
         ALR   @05,@05                                             1299 06620000
         LH    @05,NGRPID-2(@05,GRPPTR)                            1299 06621000
         MH    @05,@CH00038                                        1299 06622000
         L     @02,PINFOPTR                                        1299 06623000
         BCTR  @02,0                                               1299 06624000
         BCTR  @02,0                                               1299 06625000
         SLR   @15,@15                                             1299 06626000
         IC    @15,PARMFLAG-10(@05,@02)                            1299 06627000
         C     @15,@CF00161                                        1299 06628000
         BNE   @RF01299                                            1299 06629000
*                        FOUND=YES;                        /*@YL026UL*/ 06630000
         OI    FOUND,B'00000010'                                   1300 06631000
*                  END;                                    /*@YL026UL*/ 06632000
*                                                                  1301 06633000
@RF01299 LA    @05,1                                               1301 06634000
         AH    @05,INDEX10                                         1301 06635000
@DE01298 STH   @05,INDEX10                                         1301 06636000
         CH    @05,NGRPCNT(,GRPPTR)                                1301 06637000
         BNH   @DL01298                                            1301 06638000
*                  /**************************************************/ 06639000
*                  /*                                        @YL026UL*/ 06640000
*                  /* IF NO PARMS IN A GROUP HAVE BEEN       @YL026UL*/ 06641000
*                  /* CODED, PROMPT FOR THE SUBFIELD OF THE  @YL026UL*/ 06642000
*                  /* 1ST PARM IDENTIFIED IN THE GROUP.      @YL026UL*/ 06643000
*                  /*                                        @YL026UL*/ 06644000
*                  /**************************************************/ 06645000
*                  IF FOUND=NO                                     1302 06646000
*                    THEN                                          1302 06647000
         TM    FOUND,B'00000010'                                   1302 06648000
         BNZ   @RF01302                                            1302 06649000
*                      DO;                                 /*@YL026UL*/ 06650000
*                      SUPERID=NGRPID(1);                  /*@YL026UL*/ 06651000
*                                                                  1304 06652000
         LH    @05,NGRPID(,GRPPTR)                                 1304 06653000
         STH   @05,SUPERID                                         1304 06654000
*                      CALL ADDPARM;                       /*@YL026UL*/ 06655000
*                                                                  1305 06656000
         BAL   @14,ADDPARM                                         1305 06657000
*                      IF LASTCC^=0                                1306 06658000
*                        THEN                                      1306 06659000
         L     @05,@PC00001+16                                     1306 06660000
         LH    @05,LASTCC(,@05)                                    1306 06661000
         LTR   @05,@05                                             1306 06662000
         BNZ   @RT01306                                            1306 06663000
*                          RETURN;                         /*@YL026UL*/ 06664000
*                      END;                                /*@YL026UL*/ 06665000
*                  GRPPTR=GRPPTR+LENGTH(NGRPCNT)+                  1309 06666000
*                      NGRPCNT*LENGTH(NGRPID);             /*@YL026UL*/ 06667000
@RF01302 LA    @05,2                                               1309 06668000
         ALR   @05,GRPPTR                                          1309 06669000
         LH    @02,NGRPCNT(,GRPPTR)                                1309 06670000
         ALR   @02,@02                                             1309 06671000
         ALR   @05,@02                                             1309 06672000
         LR    GRPPTR,@05                                          1309 06673000
*                END;                                      /*@YL026UL*/ 06674000
         LA    @05,1                                               1310 06675000
         AH    @05,INDEX9                                          1310 06676000
@DE01296 STH   @05,INDEX9                                          1310 06677000
         LH    @02,PARMID                                          1310 06678000
         MH    @02,@CH00038                                        1310 06679000
         LH    @15,PARMID                                          1310 06680000
         MH    @15,@CH00038                                        1310 06681000
         L     @01,PINFOPTR                                        1310 06682000
         AL    @01,@CF01818                                        1310 06683000
         L     @01,PARMPTR(@15,@01)                                1310 06684000
         SLR   @15,@15                                             1310 06685000
         IC    @15,NGRPDSPL(,@01)                                  1310 06686000
         ALR   @15,@15                                             1310 06687000
         L     @14,PINFOPTR                                        1310 06688000
         AL    @14,@CF01818                                        1310 06689000
         AL    @15,PARMPTR(@02,@14)                                1310 06690000
         CH    @05,NGRPTOT(,@15)                                   1310 06691000
         BNH   @DL01296                                            1310 06692000
*              END DOGRP85;                                /*@YL026UL*/ 06693000
*        END;                                              /*@YL026UL*/ 06694000
*                                                                  1312 06695000
@RF01293 LA    @05,1                                               1312 06696000
         AH    @05,PARMID                                          1312 06697000
@DE01292 STH   @05,PARMID                                          1312 06698000
         L     @02,DESCPTR                                         1312 06699000
         CH    @05,MAXID(,@02)                                     1312 06700000
         BNH   @DL01292                                            1312 06701000
*/********************************************************************/ 06702000
*/*                                                          @YL026UL*/ 06703000
*/*  PROCEDURE NAME - ADDPARM                                @YL026UL*/ 06704000
*/*                                                          @YL026UL*/ 06705000
*/*  FUNCTION - THIS ROUTINE SENDS A MESSAGE TO THE TERMINAL @YL026UL*/ 06706000
*/*             USER TELLING HIM THAT A PARM IS MISSING      @YL026UL*/ 06707000
*/*             BUT IS REQUIRED.  THE USER IS THEN PROMPTED  @YL026UL*/ 06708000
*/*             TO ENTER THE SUBFIELD OF THE MISSING PARM.   @YL026UL*/ 06709000
*/*             A PCL IS OBTAINED (FROM THE DESCRIPTOR OR    @YL026UL*/ 06710000
*/*             FROM THE SET OF 'STANDARD' PCLS) DESCRIBING  @YL026UL*/ 06711000
*/*             JUST THE SET OF SUBPARMS THAT WERE PROMPTED  @YL026UL*/ 06712000
*/*             FOR, AND THIS IS SENT TO 'PARSE' TOGETHER    @YL026UL*/ 06713000
*/*             WITH THE USER'S REPLY.  THE ENCODED SET OF   @YL026UL*/ 06714000
*/*             PARMS IS THEN ADDED TO THE FDT.              @YL026UL*/ 06715000
*/*             IF THE MISSING PARM HAS NO SUBFIELD, IT IS   @YL026UL*/ 06716000
*/*             SIMPLY ADDED TO THE FDT AS IF IT WERE INPUT. @YL026UL*/ 06717000
*/*                                                          @YL026UL*/ 06718000
*/*  INPUT -                                                 @YL026UL*/ 06719000
*/*            SUPERID - ID# OF THE MISSING PARAMETER.       @YL026UL*/ 06720000
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/ 06721000
*/*                                                          @YL026UL*/ 06722000
*/*  OUTPUT -                                                @YL026UL*/ 06723000
*/*            PARMFLAG- FLAGS IN 'PARMINFO' INDICATING      @YL026UL*/ 06724000
*/*                      WHICH PARAMETERS HAVE BEEN INPUT.   @YL026UL*/ 06725000
*/*            GOODCMD - FLAG SET 'OFF' TO NOTE THAT NEW     @YL026UL*/ 06726000
*/*                      PARAMETERS ARE BEING ADDED.         @YL026UL*/ 06727000
*/*            FDT -     ENCODED DATA ENTRIES FOR THE PARMS  @YL026UL*/ 06728000
*/*                      BEING ADDED.                        @YL026UL*/ 06729000
*/*            LASTCC -  AMS CONDITION CODE.                 @YL026UL*/ 06730000
*/*                                                          @YL026UL*/ 06731000
*/********************************************************************/ 06732000
*ADDPARM:PROCEDURE;                                        /*@YL026UL*/ 06733000
         B     @PB00017                                            1313 06734000
ADDPARM  STM   @14,@02,@SA00017                                    1313 06735000
         STM   @04,@06,@SA00017+20                                 1313 06736000
         STM   @08,@12,@SA00017+32                                 1313 06737000
*        /************************************************************/ 06738000
*        /*                                                  @YL026UL*/ 06739000
*        /*  ** ADDPARM **  DATA DEFINITIONS                 @YL026UL*/ 06740000
*        /*                                                  @YL026UL*/ 06741000
*        /************************************************************/ 06742000
*                                                                  1314 06743000
*        DCL MISSING  FIXED(15)        /*ERROR MSG ID FOR A  @YL026UL*/ 06744000
*                     CONSTANT(6);     /*MISSING PARM        @YL026UL*/ 06745000
*        DCL NOPMISS FIXED(15) CONSTANT(17);               /*@Y30SSFR*/ 06746000
*                                      /*MSG ID FOR MISSING  @Y30SSFR*/ 06747000
*                                      /*PARM IN NOPROMPT    @Y30SSFR*/ 06748000
*                                      /*CASE                @Y30SSFR*/ 06749000
*        /************************************************************/ 06750000
*        /*                                                  @YL026UL*/ 06751000
*        /*  ** ADDPARM **  PROMPT FOR A MISSING PARAMETER   @YL026UL*/ 06752000
*        /*                                                  @YL026UL*/ 06753000
*        /************************************************************/ 06754000
*        OLDERID2 = NEWERID2;                                      1316 06755000
         L     @02,GDTTR2(,GDTPTR)                                 1316 06756000
         MVC   @TS00001(95),NEWERID2(@02)                          1316 06757000
         MVC   OLDERID2(95,@02),@TS00001                           1316 06758000
*        NEWID2='RI40';                                    /*@YL026UL*/ 06759000
*                                                                  1317 06760000
         MVC   NEWID2(4,@02),@CC01781                              1317 06761000
*        GOODCMD=NO;                                       /*@YL026UL*/ 06762000
         NI    GOODCMD,B'11101111'                                 1318 06763000
*        INDEX10=PARMID;                                   /*@YL026UL*/ 06764000
         LH    @02,PARMID                                          1319 06765000
         STH   @02,INDEX10                                         1319 06766000
*        PARMID=SUPERID;                                   /*@YL026UL*/ 06767000
*                                                                  1320 06768000
         LH    @02,SUPERID                                         1320 06769000
         STH   @02,PARMID                                          1320 06770000
*        /************************************************************/ 06771000
*        /*                                                  @YL026UL*/ 06772000
*        /* IF THE REQUIRED MISSING PARAMETER IS A KEYWORD   @YL026UL*/ 06773000
*        /* WITH NO SUBFIELD, JUST ADD THE PARAMETER TO THE  @YL026UL*/ 06774000
*        /* FDT AS IF IT HAD BEEN CODED.                     @YL026UL*/ 06775000
*        /*                                                  @YL026UL*/ 06776000
*        /************************************************************/ 06777000
*        IF SUBLIST=NO & SCLRDATA=NO                               1321 06778000
*          THEN                                                    1321 06779000
         L     @15,PINFOPTR                                        1321 06780000
         LR    @14,@02                                             1321 06781000
         MH    @14,@CH00038                                        1321 06782000
         LA    @01,0(@14,@15)                                      1321 06783000
         AL    @01,@CF01818                                        1321 06784000
         L     @01,PARMPTR(,@01)                                   1321 06785000
         TM    SUBLIST(@01),B'10000010'                            1321 06786000
         BNZ   @RF01321                                            1321 06787000
*            DO;                                           /*@YL026UL*/ 06788000
*            PARMFLAG(PARMID)=INPUT;                       /*@YL026UL*/ 06789000
         LA    @05,2                                               1323 06790000
         LA    @04,0(@14,@15)                                      1323 06791000
         BCTR  @04,0                                               1323 06792000
         BCTR  @04,0                                               1323 06793000
         STC   @05,PARMFLAG-10(,@04)                               1323 06794000
*            IF OCCURNUM=1                                         1324 06795000
*              THEN                                                1324 06796000
         AL    @15,@CF01818                                        1324 06797000
         L     @01,PARMPTR(@14,@15)                                1324 06798000
         CLC   OCCURNUM(3,@01),@CF00227+1                          1324 06799000
         BNE   @RF01324                                            1324 06800000
*                FDTPTR(PARMID)=ADDR(FDTPTR(PARMID));      /*@YL026UL*/ 06801000
         SLA   @02,2                                               1325 06802000
         L     @15,@PC00001+4                                      1325 06803000
         L     @15,FDTADDR(,@15)                                   1325 06804000
         LA    @14,FDTPTR-4(@02,@15)                               1325 06805000
         ST    @14,FDTPTR-4(@02,@15)                               1325 06806000
*              ELSE                                                1326 06807000
*                VECTRVAL=ADDR(VECTRVAL);                  /*@YL026UL*/ 06808000
         B     @RC01324                                            1326 06809000
@RF01324 LH    @02,PARMID                                          1326 06810000
         SLA   @02,2                                               1326 06811000
         L     @15,@PC00001+4                                      1326 06812000
         L     @01,FDTADDR(,@15)                                   1326 06813000
         LH    @15,REPINDEX                                        1326 06814000
         MH    @15,@CH00038                                        1326 06815000
         L     @14,RSIPTR                                          1326 06816000
         BCTR  @14,0                                               1326 06817000
         BCTR  @14,0                                               1326 06818000
         LH    @15,VECTRDSP-10(@15,@14)                            1326 06819000
         AL    @15,FDTPTR-4(@02,@01)                               1326 06820000
         ST    @15,VECTRVAL(,@15)                                  1326 06821000
*            PARMID=INDEX10;                               /*@YL026UL*/ 06822000
@RC01324 LH    @02,INDEX10                                         1327 06823000
         STH   @02,PARMID                                          1327 06824000
*            RETURN;                                       /*@YL026UL*/ 06825000
@EL00017 DS    0H                                                  1328 06826000
@EF00017 DS    0H                                                  1328 06827000
@ER00017 LM    @14,@02,@SA00017                                    1328 06828000
         LM    @04,@06,@SA00017+20                                 1328 06829000
         LM    @08,@12,@SA00017+32                                 1328 06830000
         BR    @14                                                 1328 06831000
*            END;                                          /*@YL026UL*/ 06832000
*                                                                  1329 06833000
*        /************************************************************/ 06834000
*        /*                                                  @YL026UL*/ 06835000
*        /* IF THE MISSING PARAMETER IS DEFINED WITHIN A     @YL026UL*/ 06836000
*        /* REPEATED SUBLIST, PRINT A MESSAGE IDENTIFYING    @YL026UL*/ 06837000
*        /* WHICH REPETITION NEEDS THE PARAMETER.            @YL026UL*/ 06838000
*        /*                                                  @YL026UL*/ 06839000
*        /************************************************************/ 06840000
*        IF OCCURNUM > 1                                           1330 06841000
*          THEN                                                    1330 06842000
@RF01321 LA    @02,12                                              1330 06843000
         LR    @15,@02                                             1330 06844000
         MH    @15,PARMID                                          1330 06845000
         L     @01,PINFOPTR                                        1330 06846000
         AL    @01,@CF01818                                        1330 06847000
         L     @01,PARMPTR(@15,@01)                                1330 06848000
         CLC   OCCURNUM(3,@01),@CF00227+1                          1330 06849000
         BNH   @RF01330                                            1330 06850000
*            DO;                                           /*@YL026UL*/ 06851000
*            EFIELD3=SBLSTNUM(REPINDEX);                   /*@YL026UL*/ 06852000
         MH    @02,REPINDEX                                        1332 06853000
         L     @01,RSIPTR                                          1332 06854000
         AL    @01,@CF01819                                        1332 06855000
         SLR   @00,@00                                             1332 06856000
         IC    @00,SBLSTNUM-8(@02,@01)                             1332 06857000
         ST    @00,EFIELD3                                         1332 06858000
*            DARGDBP=ADDR(EFIELD3);                        /*@YL026UL*/ 06859000
         L     @02,DDSTRU                                          1333 06860000
         LA    @15,EFIELD3                                         1333 06861000
         ST    @15,DARGDBP(,@02)                                   1333 06862000
*            DARGILP=LENGTH(EFIELD3);                      /*@YL026UL*/ 06863000
         MVC   DARGILP(2,@02),@CH00050                             1334 06864000
*            DARGSENT=INREP;                               /*@YL026UL*/ 06865000
*                                                                  1335 06866000
         MVI   DARGSENT(@02),X'0F'                                 1335 06867000
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         /*@YL026UL*/ 06868000
*                                                                  1336 06869000
         ST    GDTPTR,@AL00001                                     1336 06870000
         LA    @02,@CF00123                                        1336 06871000
         ST    @02,@AL00001+4                                      1336 06872000
         LA    @02,DDSTRU                                          1336 06873000
         ST    @02,@AL00001+8                                      1336 06874000
         MVI   @AL00001+8,X'80'                                    1336 06875000
         L     @15,GDTPRT(,GDTPTR)                                 1336 06876000
         LA    @01,@AL00001                                        1336 06877000
         BALR  @14,@15                                             1336 06878000
*            END;                                          /*@YL026UL*/ 06879000
*                                                                  1337 06880000
*        /************************************************************/ 06881000
*        /*                                                  @YL026UL*/ 06882000
*        /* OBTAIN A FORMATTED, STATIC TEXT MESSAGE WHICH    @YL026UL*/ 06883000
*        /* IDENTIFIES THE MISSING REQUIRED PARAMETER AND    @YL026UL*/ 06884000
*        /* USE IT TO PROMPT FOR THE PARM'S SUBFIELD.        @YL026UL*/ 06885000
*        /*                                                  @YL026UL*/ 06886000
*        /************************************************************/ 06887000
*        EFIELD1=BLANK;                                    /*@YL026UL*/ 06888000
*                                                                  1338 06889000
@RF01330 MVI   EFIELD1+1,C' '                                      1338 06890000
         MVC   EFIELD1+2(18),EFIELD1+1                             1338 06891000
         MVI   EFIELD1,C' '                                        1338 06892000
*        CALL MSGKWD(SUPERID,ADDR(EFIELD1));               /*@YL026UL*/ 06893000
*                                                                  1339 06894000
         LA    @02,SUPERID                                         1339 06895000
         ST    @02,@AL00001                                        1339 06896000
         LA    @02,EFIELD1                                         1339 06897000
         ST    @02,@AFTEMPS+20                                     1339 06898000
         LA    @02,@AFTEMPS+20                                     1339 06899000
         ST    @02,@AL00001+4                                      1339 06900000
         LA    @01,@AL00001                                        1339 06901000
         BAL   @14,MSGKWD                                          1339 06902000
*        DARGDBP=ADDR(EFIELD);                             /*@YL026UL*/ 06903000
         L     @04,DDSTRU                                          1340 06904000
         LA    @02,EFIELD                                          1340 06905000
         ST    @02,DARGDBP(,@04)                                   1340 06906000
*        DARGILP=LENGTH(EFIELD1);                          /*@YL026UL*/ 06907000
         MVC   DARGILP(2,@04),@CH01449                             1341 06908000
*        DARGSENT=MISSING;                                 /*@YL026UL*/ 06909000
         MVI   DARGSENT(@04),X'06'                                 1342 06910000
*        DARGRETP=ADDR(MSGBUFF);                           /*@YL026UL*/ 06911000
         LA    @02,MSGBUFF                                         1343 06912000
         ST    @02,DARGRETP(,@04)                                  1343 06913000
*        DARGRETL=LENGTH(MSGBUFF);                         /*@YL026UL*/ 06914000
*                                                                  1344 06915000
         MVC   DARGRETL(2,@04),@CH01454                            1344 06916000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/ 06917000
*                                                                  1345 06918000
         ST    GDTPTR,@AL00001                                     1345 06919000
         LA    @04,@CF00123                                        1345 06920000
         ST    @04,@AL00001+4                                      1345 06921000
         LA    @04,DDSTRU                                          1345 06922000
         ST    @04,@AL00001+8                                      1345 06923000
         MVI   @AL00001+8,X'80'                                    1345 06924000
         L     @15,GDTPRT(,GDTPTR)                                 1345 06925000
         LA    @01,@AL00001                                        1345 06926000
         BALR  @14,@15                                             1345 06927000
*        PMSGPTR=DARGRETP;                                 /*@YL026UL*/ 06928000
         L     @04,DDSTRU                                          1346 06929000
         L     @02,DARGRETP(,@04)                                  1346 06930000
         ST    @02,PMSGPTR                                         1346 06931000
*        PMSGLEN=DARGRETL;                                 /*@YL026UL*/ 06932000
         LH    @02,DARGRETL(,@04)                                  1347 06933000
         STH   @02,PMSGLEN                                         1347 06934000
*        DARGRETP=NULLPTR;                                 /*@YL026UL*/ 06935000
         SLR   @02,@02                                             1348 06936000
         ST    @02,DARGRETP(,@04)                                  1348 06937000
*        DARGRETL=0;                                       /*@YL026UL*/ 06938000
*                                                                  1349 06939000
         STH   @02,DARGRETL(,@04)                                  1349 06940000
*        /************************************************************/ 06941000
*        /*                                                  @Y30SSFR*/ 06942000
*        /*  ISSUE A UPROMPT TO PROMPT FOR THE MISSING       @Y30SSFR*/ 06943000
*        /*  PARAMETER.  IF THE RETURN CODE FROM UPROMPT IS  @Y30SSFR*/ 06944000
*        /*  NON-ZERO, THEN ISSUE A SPECIAL MESSAGE TO THE   @Y30SSFR*/ 06945000
*        /*  USER IF PROFILE(NOPROMPT) HAS BEEN SPECIFIED.   @Y30SSFR*/ 06946000
*        /*  SET LASTCC TO 12 AND RETURN TO THE CALLER.      @Y30SSFR*/ 06947000
*        /*                                                  @Y30SSFR*/ 06948000
*        /************************************************************/ 06949000
*        CALL IDCSAPT0(GDTTBL,PMSGPTR,PMSGLEN,RPLYPTR,RPLYLEN);/*  1350 06950000
*                                                            #YL026UL*/ 06951000
         ST    GDTPTR,@AL00001                                     1350 06952000
         LA    @04,PMSGPTR                                         1350 06953000
         ST    @04,@AL00001+4                                      1350 06954000
         LA    @04,PMSGLEN                                         1350 06955000
         ST    @04,@AL00001+8                                      1350 06956000
         LA    @04,RPLYPTR                                         1350 06957000
         ST    @04,@AL00001+12                                     1350 06958000
         LA    @04,RPLYLEN                                         1350 06959000
         ST    @04,@AL00001+16                                     1350 06960000
         MVI   @AL00001+16,X'80'                                   1350 06961000
         L     @15,GDTPMT(,GDTPTR)                                 1350 06962000
         LA    @01,@AL00001                                        1350 06963000
         BALR  @14,@15                                             1350 06964000
*        RESPECIFY RTNREG RSTD;                                    1351 06965000
*        TESTRC = RTNREG;                                          1352 06966000
         LR    TESTRC,RTNREG                                       1352 06967000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UL*/ 06968000
*                                                                  1353 06969000
*        IF TESTRC=LASTCC08                                /*@Y30SSFR*/ 06970000
*          THEN                                            /*@Y30SSFR*/ 06971000
         C     TESTRC,@CF00187                                     1354 06972000
         BNE   @RF01354                                            1354 06973000
*            DO;                                           /*@Y30SSFR*/ 06974000
*                                                                  1355 06975000
*            /********************************************************/ 06976000
*            /*                                              @Y30SSFR*/ 06977000
*            /*  THE NOPROMPT OPTION IS IN EFFECT.  PRINT    @Y30SSFR*/ 06978000
*            /*  A MESSAGE INDICATING THAT A KEYWORD IS      @Y30SSFR*/ 06979000
*            /*  MISSING, AND RETURN.                        @Y30SSFR*/ 06980000
*            /*                                              @Y30SSFR*/ 06981000
*            /********************************************************/ 06982000
*                                                                  1356 06983000
*            DARGSENT=NOPMISS;                             /*@Y30SSFR*/ 06984000
         L     @02,DDSTRU                                          1356 06985000
         MVI   DARGSENT(@02),X'11'                                 1356 06986000
*            DARGILP=LENGTH(EFIELD1);                      /*@Y30SSFR*/ 06987000
         MVC   DARGILP(2,@02),@CH01449                             1357 06988000
*            DARGDBP=ADDR(EFIELD);                         /*@Y30SSFR*/ 06989000
*                                                                  1358 06990000
         LA    @15,EFIELD                                          1358 06991000
         ST    @15,DARGDBP(,@02)                                   1358 06992000
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         /*@Y30SSFR*/ 06993000
*                                                                  1359 06994000
         ST    GDTPTR,@AL00001                                     1359 06995000
         LA    @02,@CF00123                                        1359 06996000
         ST    @02,@AL00001+4                                      1359 06997000
         LA    @02,DDSTRU                                          1359 06998000
         ST    @02,@AL00001+8                                      1359 06999000
         MVI   @AL00001+8,X'80'                                    1359 07000000
         L     @15,GDTPRT(,GDTPTR)                                 1359 07001000
         LA    @01,@AL00001                                        1359 07002000
         BALR  @14,@15                                             1359 07003000
*            LASTCC=LASTCC12;                              /*@Y30SSFR*/ 07004000
         L     @02,@PC00001+16                                     1360 07005000
         MVC   LASTCC(2,@02),@CH00038                              1360 07006000
*            RETURN;                                       /*@Y30SSFR*/ 07007000
         B     @EL00017                                            1361 07008000
*            END;                                          /*@Y30SSFR*/ 07009000
*          ELSE                                            /*@Y30SSFR*/ 07010000
*            IF TESTRC^=0                                  /*@Y30SSFR*/ 07011000
*              THEN                                        /*@Y30SSFR*/ 07012000
@RF01354 LTR   TESTRC,TESTRC                                       1363 07013000
         BZ    @RF01363                                            1363 07014000
*                DO;                                       /*@Y30SSFR*/ 07015000
*                LASTCC=LASTCC12;                          /*@Y30SSFR*/ 07016000
         L     @02,@PC00001+16                                     1365 07017000
         MVC   LASTCC(2,@02),@CH00038                              1365 07018000
*                RETURN;                                   /*@Y30SSFR*/ 07019000
         B     @EL00017                                            1366 07020000
*                END;                                      /*@Y30SSFR*/ 07021000
*                                                                  1367 07022000
*        /************************************************************/ 07023000
*        /*                                                  @YL026UL*/ 07024000
*        /* SET UP THE PARSE PARM LIST.  SELECT A PCL THAT   @YL026UL*/ 07025000
*        /* DESCRIBES JUST THE PARMS WHICH WERE PROMPTED     @YL026UL*/ 07026000
*        /* FOR.  IF THE SUBFIELD IS A SUBPARM LIST, A PCL   @YL026UL*/ 07027000
*        /* IS PROVIDED IN THE DESCRIPTOR; OTHERWISE, USE A  @YL026UL*/ 07028000
*        /* 'STANDARD' PCL SELECTED ON THE BASIS OF THE      @YL026UL*/ 07029000
*        /* DATA TYPE OF THE SUBFIELD.                       @YL026UL*/ 07030000
*        /*                                                  @YL026UL*/ 07031000
*        /************************************************************/ 07032000
*        PPLCBUF=RPLYPTR;                                  /*@YL026UL*/ 07033000
@RF01363 L     @02,RPLYPTR                                         1368 07034000
         L     @01,PPLPTR                                          1368 07035000
         ST    @02,PPLCBUF(,@01)                                   1368 07036000
*        PARSECB=0;                                        /*@YL026UL*/ 07037000
         SLR   @02,@02                                             1369 07038000
         ST    @02,PARSECB                                         1369 07039000
*        SINGLPRM=YES;                                     /*@YL026UL*/ 07040000
         OI    SINGLPRM,B'01000000'                                1370 07041000
*        IF SUBLIST=YES                                            1371 07042000
*          THEN                                                    1371 07043000
         L     @02,PINFOPTR                                        1371 07044000
         LH    @15,PARMID                                          1371 07045000
         LR    @14,@15                                             1371 07046000
         MH    @14,@CH00038                                        1371 07047000
         LA    @01,0(@14,@02)                                      1371 07048000
         AL    @01,@CF01818                                        1371 07049000
         L     @05,PARMPTR(,@01)                                   1371 07050000
         TM    SUBLIST(@05),B'00000010'                            1371 07051000
         BNO   @RF01371                                            1371 07052000
*            IF REPEATED=NO                                        1372 07053000
*              THEN                                                1372 07054000
         TM    REPEATED(@05),B'00100000'                           1372 07055000
         BNZ   @RF01372                                            1372 07056000
*                /****************************************************/ 07057000
*                /*                                          @YL026UL*/ 07058000
*                /* IF THE MISSING PARM HAS A SUBPARM LIST,  @YL026UL*/ 07059000
*                /* THEN FIRST ADD THE PARM ITSELF TO THE    @YL026UL*/ 07060000
*                /* FDT AND PARM OCCURRENCE TABLE.           @YL026UL*/ 07061000
*                /*                                          @YL026UL*/ 07062000
*                /****************************************************/ 07063000
*                DO;                                       /*@YL026UL*/ 07064000
*                PARMFLAG(PARMID)=INPUT;                   /*@YL026UL*/ 07065000
         LA    @05,2                                               1374 07066000
         LA    @04,0(@14,@02)                                      1374 07067000
         BCTR  @04,0                                               1374 07068000
         BCTR  @04,0                                               1374 07069000
         STC   @05,PARMFLAG-10(,@04)                               1374 07070000
*                IF OCCURNUM=1                                     1375 07071000
*                  THEN                                            1375 07072000
         AL    @02,@CF01818                                        1375 07073000
         L     @02,PARMPTR(@14,@02)                                1375 07074000
         CLC   OCCURNUM(3,@02),@CF00227+1                          1375 07075000
         BNE   @RF01375                                            1375 07076000
*                    FDTPTR(PARMID)=ADDR(FDTPTR(PARMID));  /*@YL026UL*/ 07077000
         SLA   @15,2                                               1376 07078000
         L     @02,@PC00001+4                                      1376 07079000
         L     @02,FDTADDR(,@02)                                   1376 07080000
         LA    @14,FDTPTR-4(@15,@02)                               1376 07081000
         ST    @14,FDTPTR-4(@15,@02)                               1376 07082000
*                  ELSE                                            1377 07083000
*                    VECTRVAL=ADDR(VECTRVAL);              /*@YL026UL*/ 07084000
         B     @RC01375                                            1377 07085000
@RF01375 LH    @02,PARMID                                          1377 07086000
         SLA   @02,2                                               1377 07087000
         L     @15,@PC00001+4                                      1377 07088000
         L     @01,FDTADDR(,@15)                                   1377 07089000
         LH    @15,REPINDEX                                        1377 07090000
         MH    @15,@CH00038                                        1377 07091000
         L     @14,RSIPTR                                          1377 07092000
         BCTR  @14,0                                               1377 07093000
         BCTR  @14,0                                               1377 07094000
         LH    @15,VECTRDSP-10(@15,@14)                            1377 07095000
         AL    @15,FDTPTR-4(@02,@01)                               1377 07096000
         ST    @15,VECTRVAL(,@15)                                  1377 07097000
*                SINGLPRM=NO;                              /*@YL026UL*/ 07098000
@RC01375 NI    SINGLPRM,B'10111111'                                1378 07099000
*                PPLPCL=DESCPTR+PCLDSPL2;                  /*@YL026UL*/ 07100000
         LA    @02,12                                              1379 07101000
         LR    @15,@02                                             1379 07102000
         MH    @15,PARMID                                          1379 07103000
         L     @01,PINFOPTR                                        1379 07104000
         AL    @01,@CF01818                                        1379 07105000
         AL    @02,PARMPTR(@15,@01)                                1379 07106000
         LH    @02,PCLDSPL2(,@02)                                  1379 07107000
         N     @02,@CF01822                                        1379 07108000
         AL    @02,DESCPTR                                         1379 07109000
         L     @01,PPLPTR                                          1379 07110000
         ST    @02,PPLPCL(,@01)                                    1379 07111000
*                END;                                      /*@YL026UL*/ 07112000
*              ELSE                                                1381 07113000
*                PPLPCL=ADDR(REPPCL);                      /*@YL026UL*/ 07114000
         B     @RC01372                                            1381 07115000
@RF01372 L     @02,@CV01509                                        1381 07116000
         L     @01,PPLPTR                                          1381 07117000
         ST    @02,PPLPCL(,@01)                                    1381 07118000
*          ELSE                                                    1382 07119000
*                                                                  1382 07120000
*            /********************************************************/ 07121000
*            /*                                              @YL026UL*/ 07122000
*            /* IF THE SUBFIELD IS A SINGLE CONSTANT, SELECT @YL026UL*/ 07123000
*            /* A 'STANDARD' PCL BASED UPON THE DATA TYPE    @YL026UL*/ 07124000
*            /* OF THAT CONSTANT.                            @YL026UL*/ 07125000
*            /*                                              @YL026UL*/ 07126000
*            /********************************************************/ 07127000
*                                                                  1382 07128000
*            /********************************************************/ 07129000
*            /*                                              @Y30SSFR*/ 07130000
*            /*  IF THE PARAMETER TO BE OBTAINED IS A        @Y30SSFR*/ 07131000
*            /*  NUMBER, PROMPT FOR A NUMBER.                @Y30SSFR*/ 07132000
*            /*                                              @Y30SSFR*/ 07133000
*            /********************************************************/ 07134000
*            IF NUMBER=YES                                         1382 07135000
*              THEN                                                1382 07136000
         B     @RC01371                                            1382 07137000
@RF01371 LA    @02,12                                              1382 07138000
         LR    @15,@02                                             1382 07139000
         MH    @15,PARMID                                          1382 07140000
         L     @01,PINFOPTR                                        1382 07141000
         AL    @01,@CF01818                                        1382 07142000
         AL    @02,PARMPTR(@15,@01)                                1382 07143000
         TM    NUMBER(@02),B'10000000'                             1382 07144000
         BNO   @RF01382                                            1382 07145000
*                PPLPCL=ADDR(NUMPCL);                      /*@YL026UL*/ 07146000
         L     @02,@CV01498                                        1383 07147000
         L     @01,PPLPTR                                          1383 07148000
         ST    @02,PPLPCL(,@01)                                    1383 07149000
*              ELSE                                                1384 07150000
*                                                                  1384 07151000
*                /****************************************************/ 07152000
*                /*                                          @Y30SSFR*/ 07153000
*                /*  IF THE DESIRED PARAMETER IS ANYTHING    @Y30SSFR*/ 07154000
*                /*  OTHER THAN A DATA SET NAME, THEN        @Y30SSFR*/ 07155000
*                /*  PROMPT FOR IT AS A DDNAME IF A PASS-    @Y30SSFR*/ 07156000
*                /*  WORD CAN BE SPECIFIED AND AS A GENERAL  @Y30SSFR*/ 07157000
*                /*  STRING OTHERWISE.                       @Y30SSFR*/ 07158000
*                /*                                          @Y30SSFR*/ 07159000
*                /****************************************************/ 07160000
*                IF ANYSTRNG=YES                                   1384 07161000
*                  THEN                                            1384 07162000
         B     @RC01382                                            1384 07163000
@RF01382 LA    @02,12                                              1384 07164000
         LR    @15,@02                                             1384 07165000
         MH    @15,PARMID                                          1384 07166000
         L     @01,PINFOPTR                                        1384 07167000
         AL    @01,@CF01818                                        1384 07168000
         AL    @02,PARMPTR(@15,@01)                                1384 07169000
         TM    ANYSTRNG(@02),B'01000000'                           1384 07170000
         BNO   @RF01384                                            1384 07171000
*                    IF PWORDOPT=YES                               1385 07172000
*                      THEN                                        1385 07173000
         TM    PWORDOPT(@02),B'00000010'                           1385 07174000
         BNO   @RF01385                                            1385 07175000
*                        PPLPCL=ADDR(DDNPCL );             /*@YL026UL*/ 07176000
         L     @02,@CV01500                                        1386 07177000
         L     @01,PPLPTR                                          1386 07178000
         ST    @02,PPLPCL(,@01)                                    1386 07179000
*                      ELSE                                        1387 07180000
*                        PPLPCL=ADDR(STRPCL );             /*@YL026UL*/ 07181000
*                                                                  1387 07182000
         B     @RC01385                                            1387 07183000
@RF01385 L     @02,@CV01499                                        1387 07184000
         L     @01,PPLPTR                                          1387 07185000
         ST    @02,PPLPCL(,@01)                                    1387 07186000
*                  /**************************************************/ 07187000
*                  /*                                        @Y30SSFR*/ 07188000
*                  /*  PROMPT FOR A DATA SET NAME.           @Y30SSFR*/ 07189000
*                  /*                                        @Y30SSFR*/ 07190000
*                  /**************************************************/ 07191000
*                  ELSE                                            1388 07192000
*                    DO;                                   /*@YL026UL*/ 07193000
*                                                                  1388 07194000
         B     @RC01384                                            1388 07195000
@RF01384 DS    0H                                                  1389 07196000
*                    /************************************************/ 07197000
*                    /*                                      @Y30SSFR*/ 07198000
*                    /*  IF GENERIC NAMES ARE ALLOWED PROMPT @Y30SSFR*/ 07199000
*                    /*  FOR ONE.  CHOOSE THE PROPER PCL ON  @Y30SSFR*/ 07200000
*                    /*  THE BASIS OF WHETHER VOLSERS ARE    @Y30SSFR*/ 07201000
*                    /*  ACCEPTABLE.                         @Y30SSFR*/ 07202000
*                    /*                                      @Y30SSFR*/ 07203000
*                    /************************************************/ 07204000
*                    IF GENERIC=YES                                1389 07205000
*                      THEN                                        1389 07206000
         LA    @02,12                                              1389 07207000
         LR    @15,@02                                             1389 07208000
         MH    @15,PARMID                                          1389 07209000
         L     @01,PINFOPTR                                        1389 07210000
         AL    @01,@CF01818                                        1389 07211000
         AL    @02,PARMPTR(@15,@01)                                1389 07212000
         TM    GENERIC(@02),B'00010000'                            1389 07213000
         BNO   @RF01389                                            1389 07214000
*                        IF VOLID=YES                              1390 07215000
*                          THEN                                    1390 07216000
         TM    VOLID(@02),B'00001000'                              1390 07217000
         BNO   @RF01390                                            1390 07218000
*                            PPLPCL=ADDR(DSGVPCL );        /*@YL026UL*/ 07219000
         L     @02,@CV01504                                        1391 07220000
         L     @01,PPLPTR                                          1391 07221000
         ST    @02,PPLPCL(,@01)                                    1391 07222000
*                          ELSE                                    1392 07223000
*                            PPLPCL=ADDR(DSGPCL );         /*@YL026UL*/ 07224000
         B     @RC01390                                            1392 07225000
@RF01390 L     @02,@CV01503                                        1392 07226000
         L     @01,PPLPTR                                          1392 07227000
         ST    @02,PPLPCL(,@01)                                    1392 07228000
*                      ELSE                                        1393 07229000
*                                                                  1393 07230000
*                      /**********************************************/ 07231000
*                      /*                                    @Y30SSFR*/ 07232000
*                      /*  GENERIC NAMES ARE NOT ALLOWED.    @Y30SSFR*/ 07233000
*                      /*  CHOOSE THE PCL ON THE BASIS OF    @Y30SSFR*/ 07234000
*                      /*  THE ACCEPTABILITY OF VOLSERS.     @Y30SSFR*/ 07235000
*                      /*                                    @Y30SSFR*/ 07236000
*                      /**********************************************/ 07237000
*                        IF VOLID=YES                              1393 07238000
*                          THEN                                    1393 07239000
         B     @RC01389                                            1393 07240000
@RF01389 LA    @02,12                                              1393 07241000
         LR    @15,@02                                             1393 07242000
         MH    @15,PARMID                                          1393 07243000
         L     @01,PINFOPTR                                        1393 07244000
         AL    @01,@CF01818                                        1393 07245000
         AL    @02,PARMPTR(@15,@01)                                1393 07246000
         TM    VOLID(@02),B'00001000'                              1393 07247000
         BNO   @RF01393                                            1393 07248000
*                            PPLPCL=ADDR(DSVPCL );         /*@YL026UL*/ 07249000
         L     @02,@CV01502                                        1394 07250000
         L     @01,PPLPTR                                          1394 07251000
         ST    @02,PPLPCL(,@01)                                    1394 07252000
*                          ELSE                                    1395 07253000
*                            PPLPCL=ADDR(DSNPCL );         /*@YL026UL*/ 07254000
*                                                                  1395 07255000
         B     @RC01393                                            1395 07256000
@RF01393 L     @02,@CV01501                                        1395 07257000
         L     @01,PPLPTR                                          1395 07258000
         ST    @02,PPLPCL(,@01)                                    1395 07259000
*                    /************************************************/ 07260000
*                    /*                                      @YL026UL*/ 07261000
*                    /* IF THE NAME IS NOT TO BE PREFIXED,   @YL026UL*/ 07262000
*                    /* POINT TO THE PCL THAT IS IDENTICAL   @YL026UL*/ 07263000
*                    /* EXCEPT FOR THE PREFIXING REQUEST.    @YL026UL*/ 07264000
*                    /*                                      @YL026UL*/ 07265000
*                    /************************************************/ 07266000
*                    IF USERID=NO                                  1396 07267000
*                      THEN                                        1396 07268000
@RC01393 DS    0H                                                  1396 07269000
@RC01389 LA    @02,12                                              1396 07270000
         LR    @15,@02                                             1396 07271000
         MH    @15,PARMID                                          1396 07272000
         L     @01,PINFOPTR                                        1396 07273000
         AL    @01,@CF01818                                        1396 07274000
         AL    @02,PARMPTR(@15,@01)                                1396 07275000
         TM    USERID(@02),B'00000100'                             1396 07276000
         BNZ   @RF01396                                            1396 07277000
*                        PPLPCL=PPLPCL+                            1397 07278000
*                               ADDR(DSNPCL2)-ADDR(DSNPCL);/*@YL026UL*/ 07279000
         L     @02,PPLPTR                                          1397 07280000
         L     @15,@CV01505                                        1397 07281000
         AL    @15,PPLPCL(,@02)                                    1397 07282000
         L     @14,@CV01501                                        1397 07283000
         SLR   @15,@14                                             1397 07284000
         ST    @15,PPLPCL(,@02)                                    1397 07285000
*                    END;                                  /*@YL026UL*/ 07286000
*                                                                  1398 07287000
@RF01396 DS    0H                                                  1399 07288000
*        /************************************************************/ 07289000
*        /*                                                  @YL026UL*/ 07290000
*        /* SEND THE USER'S RESPONSE TO 'PARSE', TOGETHER    @YL026UL*/ 07291000
*        /* WITH THE PCL.  IF 'PARSE' IS NOT SUCCESSFUL,     @YL026UL*/ 07292000
*        /* DISCONTINUE PROCESSING.                          @YL026UL*/ 07293000
*        /*                                                  @YL026UL*/ 07294000
*        /************************************************************/ 07295000
*                                                                  1399 07296000
*        DO; /*CALLTSSR EP(IKJPARS)MF(E,PPL)*/                     1399 07297000
@RC01384 DS    0H                                                  1399 07298000
@RC01382 DS    0H                                                  1399 07299000
@RC01371 DS    0H                                                  1400 07300000
*          RESPECIFY GPR01P RSTD;                                  1400 07301000
*          GPR01P = ADDR(PPL);                                     1401 07302000
         L     GPR01P,PPLPTR                                       1401 07303000
*          IF CVTPARS = 0                                          1402 07304000
*            THEN                                                  1402 07305000
         L     @02,CVTPTR                                          1402 07306000
         L     @02,CVTPARS(,@02)                                   1402 07307000
         LTR   @02,@02                                             1402 07308000
         BNZ   @RF01402                                            1402 07309000
*              GEN(LINK EP=IKJPARS);                               1403 07310000
         LINK EP=IKJPARS                                                07311000
*            ELSE                                                  1404 07312000
*              CALL CVTPARS;                                       1404 07313000
         B     @RC01402                                            1404 07314000
@RF01402 L     @02,CVTPTR                                          1404 07315000
         L     @15,CVTPARS(,@02)                                   1404 07316000
         BALR  @14,@15                                             1404 07317000
*          RESPECIFY GPR01P UNRSTD;                                1405 07318000
@RC01402 DS    0H                                                  1406 07319000
*        END;                   /*@Z40GSJG*/                       1406 07320000
*        RESPECIFY RTNREG RSTD;                                    1407 07321000
*        TESTRC = RTNREG;                                          1408 07322000
         LR    TESTRC,RTNREG                                       1408 07323000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UL*/ 07324000
*                                                                  1409 07325000
*        /************************************************************/ 07326000
*        /*                                                  @Y30SSFR*/ 07327000
*        /*  IF THE IKJPARS FAILS DUE TO INSUFFICIENT MAIN   @Z40GSJG*/ 07328000
*        /*  STORAGE, CALL FAILSPAC TO HANDLE THE ERROR.     @Y30SSFR*/ 07329000
*        /*  OTHERWISE, SET LASTCC TO 12.  RETURN TO THE     @Y30SSFR*/ 07330000
*        /*  CALLER.                                         @Y30SSFR*/ 07331000
*        /*                                                  @Y30SSFR*/ 07332000
*        /************************************************************/ 07333000
*        IF TESTRC^=0                                              1410 07334000
*          THEN                                                    1410 07335000
         LTR   TESTRC,TESTRC                                       1410 07336000
         BZ    @RF01410                                            1410 07337000
*            DO;                                           /*@YL026UL*/ 07338000
*            IF TESTRC=BADSPACE                                    1412 07339000
*              THEN                                                1412 07340000
*                                                                  1412 07341000
         C     TESTRC,@CF00487                                     1412 07342000
         BNE   @RF01412                                            1412 07343000
*                CALL FAILSPAC;                            /*@YL026UL*/ 07344000
*                                                                  1413 07345000
         BAL   @14,FAILSPAC                                        1413 07346000
*              ELSE                                                1414 07347000
*                LASTCC=LASTCC12;                          /*@YL026UL*/ 07348000
         B     @RC01412                                            1414 07349000
@RF01412 L     @02,@PC00001+16                                     1414 07350000
         MVC   LASTCC(2,@02),@CH00038                              1414 07351000
*            RETURN;                                       /*@YL026UL*/ 07352000
         B     @EL00017                                            1415 07353000
*            END;                                          /*@YL026UL*/ 07354000
*                                                                  1416 07355000
*        /************************************************************/ 07356000
*        /*                                                  @YL026UL*/ 07357000
*        /* TRANSLATE THE SUBFIELD PARAMETER(S) INTO FDT     @YL026UL*/ 07358000
*        /* ENTRIE(S).                                       @YL026UL*/ 07359000
*        /*                                                  @YL026UL*/ 07360000
*        /************************************************************/ 07361000
*        PROMPT=YES;                                       /*@YL026UL*/ 07362000
*                                                                  1417 07363000
@RF01410 OI    PROMPT,B'10000000'                                  1417 07364000
*        CALL TRNSLATE;                                    /*@YL026UL*/ 07365000
*                                                                  1418 07366000
         BAL   @14,TRNSLATE                                        1418 07367000
*        PARMID=INDEX10;                                   /*@YL026UL*/ 07368000
*                                                                  1419 07369000
         LH    @02,INDEX10                                         1419 07370000
         STH   @02,PARMID                                          1419 07371000
*        END ADDPARM;                                      /*@YL026UL*/ 07372000
*                                                                  1420 07373000
*                                                                  1420 07374000
         B     @EL00017                                            1420 07375000
*        END NEEDPRMS;                                     /*@YL026UL*/ 07376000
@EL00016 DS    0H                                                  1421 07377000
@EF00016 DS    0H                                                  1421 07378000
@ER00016 LM    @14,@02,@SA00016                                    1421 07379000
         LM    @05,@06,@SA00016+20                                 1421 07380000
         LM    @08,@12,@SA00016+28                                 1421 07381000
         BR    @14                                                 1421 07382000
*/********************************************************************/ 07383000
*/*                                                          @YL026UL*/ 07384000
*/*  PROCEDURE NAME - MSGKWD                                 @YL026UL*/ 07385000
*/*                                                          @YL026UL*/ 07386000
*/*  FUNCTION - THIS ROUTINE SEARCHES THE DESCRIPTOR TO FIND @YL026UL*/ 07387000
*/*             THE KEYWORD MOST CLOSELY ASSOCIATED WITH A   @YL026UL*/ 07388000
*/*             GIVEN PARAMETER ID#.                         @YL026UL*/ 07389000
*/*                                                          @YL026UL*/ 07390000
*/*  INPUT -                                                 @YL026UL*/ 07391000
*/*            ERRKWDID- ID# OF THE PARAMETER FOR WHICH THE  @YL026UL*/ 07392000
*/*                      'NEAREST' KEYWORD IS TO BE FOUND.   @YL026UL*/ 07393000
*/*            PARMINFO- PARAMETER INFO TABLE.               @YL026UL*/ 07394000
*/*            COMMAND DESCRIPTOR FOR CURRENT COMMAND.       @YL026UL*/ 07395000
*/*            FDTVERB - CURRENT COMMAND'S VERB NAME.        @YL026UL*/ 07396000
*/*                                                          @YL026UL*/ 07397000
*/*  OUTPUT -                                                @YL026UL*/ 07398000
*/*            ERRFIELD- KEYWORD MOST CLOSELY ASSOCIATED     @YL026UL*/ 07399000
*/*                      WITH THE INPUT PARAMETER.           @YL026UL*/ 07400000
*/*                                                          @YL026UL*/ 07401000
*/********************************************************************/ 07402000
*MSGKWD: PROCEDURE(ERRKWDID,FLDPTR);                       /*@YL026UL*/ 07403000
MSGKWD   STM   @14,@12,12(@13)                                     1422 07404000
         MVC   @PC00018(8),0(@01)                                  1422 07405000
*        /************************************************************/ 07406000
*        /*                                                  @YL026UL*/ 07407000
*        /*  ** MSGKWD **    DATA DEFINITIONS                @YL026UL*/ 07408000
*        /*                                                  @YL026UL*/ 07409000
*        /************************************************************/ 07410000
*                                                                  1423 07411000
*        DCL ERRKWDID FIXED(15);       /*ID# OF PARM FOR     @YL026UL*/ 07412000
*                                      /*WHICH A KEYWORD IS  @YL026UL*/ 07413000
*                                      /*TO BE FOUND         @YL026UL*/ 07414000
*        DCL FLDPTR   PTR(31);         /*PTR TO FIELD INTO   @YL026UL*/ 07415000
*                                      /*WHICH KEYWORD IS TO @YL026UL*/ 07416000
*                                      /*BE PLACED           @YL026UL*/ 07417000
*        DCL ERRFIELD CHAR(20)         /*FIELD TO PUT KWD IN @YL026UL*/ 07418000
*                     BASED(FLDPTR);                       /*@YL026UL*/ 07419000
*        DCL NOKWD    CHAR(12)         /*DUMMY INSERT WHEN   @YL026UL*/ 07420000
*            INIT('''POSITIONAL''');   /*NO KEYWORD EXISTS   @YL026UL*/ 07421000
*        /************************************************************/ 07422000
*        /*                                                  @YL026UL*/ 07423000
*        /*  ** MSGKWD **  FIND KEYWORD FOR ERROR MESSAGE    @YL026UL*/ 07424000
*        /*                                                  @YL026UL*/ 07425000
*        /************************************************************/ 07426000
*        OLDERID2 = NEWERID2;                                      1427 07427000
         L     @07,GDTTR2(,GDTPTR)                                 1427 07428000
         MVC   @TS00001(95),NEWERID2(@07)                          1427 07429000
         MVC   OLDERID2(95,@07),@TS00001                           1427 07430000
*        NEWID2='RI42';                                    /*@YL026UL*/ 07431000
*                                                                  1428 07432000
         MVC   NEWID2(4,@07),@CC01793                              1428 07433000
*        TESTID=PARMID;                                    /*@YL026UL*/ 07434000
         LH    TESTID,PARMID                                       1429 07435000
*        PARMID=ERRKWDID;                                  /*@YL026UL*/ 07436000
         L     @07,@PC00018                                        1430 07437000
         LH    @07,ERRKWDID(,@07)                                  1430 07438000
         STH   @07,PARMID                                          1430 07439000
*        FOUND=NO;                                         /*@YL026UL*/ 07440000
*                                                                  1431 07441000
         NI    FOUND,B'11111101'                                   1431 07442000
*        /************************************************************/ 07443000
*        /*                                                  @YL026UL*/ 07444000
*        /* SEARCH THE DESCRIPTOR TO FIND THE KEYWORD THAT   @YL026UL*/ 07445000
*        /* IS MOST CLOSELY ASSOCIATED WITH THE INPUT PARM.  @YL026UL*/ 07446000
*        /* THIS WOULD BE THE PARM'S OWN KEYWORD OR ELSE A   @YL026UL*/ 07447000
*        /* SUPERPARM'S KEYWORD.  IF THE PARM IS A FIRST-    @YL026UL*/ 07448000
*        /* LEVEL POSITIONAL, THEN RETURN THE VERB NAME.     @YL026UL*/ 07449000
*        /*                                                  @YL026UL*/ 07450000
*        /************************************************************/ 07451000
*        DO WHILE(PARMID^=0);                              /*@YL026UL*/ 07452000
         B     @DE01432                                            1432 07453000
@DL01432 DS    0H                                                  1433 07454000
*          IF KWDDSPL^=0                                           1433 07455000
*            THEN                                                  1433 07456000
         LH    @07,PARMID                                          1433 07457000
         MH    @07,@CH00038                                        1433 07458000
         L     @03,PINFOPTR                                        1433 07459000
         AL    @03,@CF01818                                        1433 07460000
         L     @07,PARMPTR(@07,@03)                                1433 07461000
         CLI   KWDDSPL(@07),0                                      1433 07462000
         BE    @RF01433                                            1433 07463000
*              DO;                                         /*@YL026UL*/ 07464000
*              KWDPTR=ADDR(KWDCOUNT)+LENGTH(KWDCOUNT);     /*@YL026UL*/ 07465000
         SLR   KWDPTR,KWDPTR                                       1435 07466000
         IC    KWDPTR,KWDDSPL(,@07)                                1435 07467000
         ALR   KWDPTR,KWDPTR                                       1435 07468000
         ALR   @07,KWDPTR                                          1435 07469000
         AL    @07,@CF00227                                        1435 07470000
         LR    KWDPTR,@07                                          1435 07471000
*              ERRFIELD=KWDITEM(1:KWDLEN);                 /*@YL026UL*/ 07472000
         L     @07,@PC00018+4                                      1436 07473000
         L     @07,FLDPTR(,@07)                                    1436 07474000
         MVI   ERRFIELD+1(@07),C' '                                1436 07475000
         MVC   ERRFIELD+2(18,@07),ERRFIELD+1(@07)                  1436 07476000
         SLR   @15,@15                                             1436 07477000
         IC    @15,KWDLEN(,KWDPTR)                                 1436 07478000
         BCTR  @15,0                                               1436 07479000
         EX    @15,@SM01872                                        1436 07480000
*              FOUND=YES;                                  /*@YL026UL*/ 07481000
         OI    FOUND,B'00000010'                                   1437 07482000
*              PARMID=0;                                   /*@YL026UL*/ 07483000
         SLR   @07,@07                                             1438 07484000
         STH   @07,PARMID                                          1438 07485000
*              END;                                        /*@YL026UL*/ 07486000
*            ELSE                                                  1440 07487000
*              PARMID=SUPRPARM(PARMID);                    /*@YL026UL*/ 07488000
         B     @RC01433                                            1440 07489000
@RF01433 LH    @07,PARMID                                          1440 07490000
         MH    @07,@CH00038                                        1440 07491000
         L     @03,PINFOPTR                                        1440 07492000
         AL    @03,@CF01819                                        1440 07493000
         LH    @07,SUPRPARM-8(@07,@03)                             1440 07494000
         STH   @07,PARMID                                          1440 07495000
*        END;                                              /*@YL026UL*/ 07496000
*                                                                  1441 07497000
@RC01433 DS    0H                                                  1441 07498000
@DE01432 LH    @07,PARMID                                          1441 07499000
         LTR   @07,@07                                             1441 07500000
         BNZ   @DL01432                                            1441 07501000
*        /************************************************************/ 07502000
*        /*                                                  @Y30SSFR*/ 07503000
*        /*  IF NO KEYWORD CAN BE FOUND, SET THE KEYWORD     @Y30SSFR*/ 07504000
*        /*  FIELD TO A DUMMY VALUE.                         @Y30SSFR*/ 07505000
*        /*                                                  @Y30SSFR*/ 07506000
*        /************************************************************/ 07507000
*        IF FOUND=NO                                               1442 07508000
*          THEN                                                    1442 07509000
         TM    FOUND,B'00000010'                                   1442 07510000
         BNZ   @RF01442                                            1442 07511000
*            ERRFIELD=NOKWD;                               /*@YL026UL*/ 07512000
         L     @07,@PC00018+4                                      1443 07513000
         L     @07,FLDPTR(,@07)                                    1443 07514000
         MVI   ERRFIELD+12(@07),C' '                               1443 07515000
         MVC   ERRFIELD+13(7,@07),ERRFIELD+12(@07)                 1443 07516000
         MVC   ERRFIELD(12,@07),NOKWD                              1443 07517000
*        PARMID=TESTID;                                    /*@YL026UL*/ 07518000
*                                                                  1444 07519000
@RF01442 STH   TESTID,PARMID                                       1444 07520000
*        END MSGKWD;                                       /*@YL026UL*/ 07521000
@EL00018 DS    0H                                                  1445 07522000
@EF00018 DS    0H                                                  1445 07523000
@ER00018 LM    @14,@12,12(@13)                                     1445 07524000
         BR    @14                                                 1445 07525000
*/********************************************************************/ 07526000
*/*                                                          @YL026UL*/ 07527000
*/*  PROCEDURE NAME - FAILSPAC                               @YL026UL*/ 07528000
*/*                                                          @YL026UL*/ 07529000
*/*  FUNCTION - THIS ROUTINE SETS UP AND ISSUES AN ERROR     @YL026UL*/ 07530000
*/*             MESSAGE TO THE TERMINAL USER TELLING HIM     @YL026UL*/ 07531000
*/*             THAT INSUFFICIENT SPACE IS AVAILABLE TO      @YL026UL*/ 07532000
*/*             CONTINUE PROCESSING OF THE CURRENT AMS       @YL026UL*/ 07533000
*/*             COMMAND.                                     @YL026UL*/ 07534000
*/*                                                          @YL026UL*/ 07535000
*/*  INPUT - NONE                                            @YL026UL*/ 07536000
*/*                                                          @YL026UL*/ 07537000
*/*  OUTPUT -                                                @YL026UL*/ 07538000
*/*            LASTCC - AMS CONDITION CODE.                  @YL026UL*/ 07539000
*/*                                                          @YL026UL*/ 07540000
*/********************************************************************/ 07541000
*FAILSPAC:PROCEDURE;                                       /*@YL026UL*/ 07542000
FAILSPAC STM   @14,@12,@SA00019                                    1446 07543000
*        /************************************************************/ 07544000
*        /*                                                  @YL026UL*/ 07545000
*        /*  ** FAILSPAC **  PRINT 'NO SPACE' ERROR MESSAGE  @YL026UL*/ 07546000
*        /*                                                  @YL026UL*/ 07547000
*        /************************************************************/ 07548000
*        OLDERID2 = NEWERID2;                                      1447 07549000
         L     @07,GDTTR2(,GDTPTR)                                 1447 07550000
         MVC   @TS00001(95),NEWERID2(@07)                          1447 07551000
         MVC   OLDERID2(95,@07),@TS00001                           1447 07552000
*        NEWID2='RI44';                                    /*@YL026UL*/ 07553000
*                                                                  1448 07554000
         MVC   NEWID2(4,@07),@CC01797                              1448 07555000
*        LASTCC=LASTCC12;                                  /*@YL026UL*/ 07556000
         L     @07,@PC00001+16                                     1449 07557000
         MVC   LASTCC(2,@07),@CH00038                              1449 07558000
*        DARGSTID=NOSPACE;                                 /*@YL026UL*/ 07559000
*                                                                  1450 07560000
         L     @07,NOSPACE                                         1450 07561000
         L     @01,DDSTRU                                          1450 07562000
         ST    @07,DARGSTID(,@01)                                  1450 07563000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*@YL026UL*/ 07564000
*                                                                  1451 07565000
         ST    GDTPTR,@AL00001                                     1451 07566000
         LA    @07,@CF00123                                        1451 07567000
         ST    @07,@AL00001+4                                      1451 07568000
         LA    @07,DDSTRU                                          1451 07569000
         ST    @07,@AL00001+8                                      1451 07570000
         MVI   @AL00001+8,X'80'                                    1451 07571000
         L     @15,GDTPRT(,GDTPTR)                                 1451 07572000
         LA    @01,@AL00001                                        1451 07573000
         BALR  @14,@15                                             1451 07574000
*        END FAILSPAC;                                     /*@YL026UL*/ 07575000
*                                                                  1452 07576000
@EL00019 DS    0H                                                  1452 07577000
@EF00019 DS    0H                                                  1452 07578000
@ER00019 LM    @14,@12,@SA00019                                    1452 07579000
         BR    @14                                                 1452 07580000
*/********************************************************************/ 07581000
*/*                                                          @YL026UL*/ 07582000
*/*  PROCEDURE NAME - RITERM                                 @YL026UL*/ 07583000
*/*                                                          @YL026UL*/ 07584000
*/*  FUNCTION - THIS ROUTINE PERFORMS EITHER COMMAND         @YL026UL*/ 07585000
*/*             TERMINATION OR AMS TERMINATION FUNCTIONS.    @YL026UL*/ 07586000
*/*             PREPARATION IS MADE TO RETURN TO THE AMS     @YL026UL*/ 07587000
*/*             EXECUTIVE AND WORK SPACE IS FREED.           @YL026UL*/ 07588000
*/*                                                          @YL026UL*/ 07589000
*/*  INPUT -                                                 @YL026UL*/ 07590000
*/*            GDTRIH -  POINTER USED TO INDICATE WHETHER    @YL026UL*/ 07591000
*/*                      AN FDT IS READY TO BE PASSED TO AN  @YL026UL*/ 07592000
*/*                      FSR FOR EXECUTION OR WHETHER THAT   @YL026UL*/ 07593000
*/*                      HAS BEEN DONE PREVIOUSLY.           @YL026UL*/ 07594000
*/*            LASTCC -  AMS CONDITION CODE FOR CURRENT      @YL026UL*/ 07595000
*/*                      COMMAND.                            @YL026UL*/ 07596000
*/*            RIPOOLID- STORAGE SPACE ID FOR R/I WORK AREA  @YL026UL*/ 07597000
*/*            SPACEID - STORAGE SPACE ID FOR STORAGE        @YL026UL*/ 07598000
*/*                      ALLOCATED TO BUILD FDT.             @YL026UL*/ 07599000
*/*            LOADNAME- LOAD MODULE NAME OF FSR TO BE       @YL026UL*/ 07600000
*/*                      INVOKED BY THE EXECUTIVE AND PASSED @YL026UL*/ 07601000
*/*                      THE COMPLETED FDT.                  @YL026UL*/ 07602000
*/*                                                          @YL026UL*/ 07603000
*/*  OUTPUT -                                                @YL026UL*/ 07604000
*/*            SETRC -   RETURN CODE INDICATING WHETHER OR   @YL026UL*/ 07605000
*/*                      NOT THE R/I SHOULD BE CALLED AGAIN. @YL026UL*/ 07606000
*/*            MAXCC -   MAXIMUM AMS SYSTEM CONDITION CODE.  @YL026UL*/ 07607000
*/*            GDTRIH -  SEE 'INPUT'                         @YL026UL*/ 07608000
*/*            FSRNAME - SAME AS 'LOADNAME' ABOVE.           @YL026UL*/ 07609000
*/*                                                          @YL026UL*/ 07610000
*/********************************************************************/ 07611000
*RITERM: PROCEDURE;                                        /*@YL026UL*/ 07612000
RITERM   STM   @14,@12,@SA00020                                    1453 07613000
*        /************************************************************/ 07614000
*        /*                                                  @YL026UL*/ 07615000
*        /*  ** RITERM **  PERFORM TERMINATION FUNCTIONS     @YL026UL*/ 07616000
*        /*                                                  @YL026UL*/ 07617000
*        /************************************************************/ 07618000
*        OLDERID2 = NEWERID2;                                      1454 07619000
         L     @07,GDTTR2(,GDTPTR)                                 1454 07620000
         MVC   @TS00001(95),NEWERID2(@07)                          1454 07621000
         MVC   OLDERID2(95,@07),@TS00001                           1454 07622000
*        NEWID2='RI46';                                    /*@YL026UL*/ 07623000
*                                                                  1455 07624000
         MVC   NEWID2(4,@07),@CC01801                              1455 07625000
*        /************************************************************/ 07626000
*        /*                                                  @YL026UL*/ 07627000
*        /* IF THE AMS SYSTEM IS TO BE TERMINATED DUE TO AN  @YL026UL*/ 07628000
*        /* ERROR OR BECAUSE THE COMMAND HAS BEEN EXECUTED,  @YL026UL*/ 07629000
*        /* SET A RETURN CODE SIGNALLING TO THE EXECUTIVE    @YL026UL*/ 07630000
*        /* THAT NO MORE PROCESSING SHOULD BE DONE.          @YL026UL*/ 07631000
*        /* ANY REMAINING WORK SPACE IS ALSO RELEASED.       @YL026UL*/ 07632000
*        /*                                                  @YL026UL*/ 07633000
*        /************************************************************/ 07634000
*        IF GDTRIH^=NULLPTR | LASTCC^=0                            1456 07635000
*          THEN                                                    1456 07636000
         SLR   @07,@07                                             1456 07637000
         C     @07,GDTRIH(,GDTPTR)                                 1456 07638000
         BNE   @RT01456                                            1456 07639000
         L     @15,@PC00001+16                                     1456 07640000
         CH    @07,LASTCC(,@15)                                    1456 07641000
         BE    @RF01456                                            1456 07642000
@RT01456 DS    0H                                                  1457 07643000
*            DO;                                           /*@YL026UL*/ 07644000
*            SETRC=4;                                      /*@YL026UL*/ 07645000
         MVC   SETRC(2),@CH00050                                   1458 07646000
*            MAXCC=LASTCC;                                 /*@YL026UL*/ 07647000
*                                                                  1459 07648000
         L     @07,@PC00001+12                                     1459 07649000
         L     @15,@PC00001+16                                     1459 07650000
         LH    @14,LASTCC(,@15)                                    1459 07651000
         STH   @14,MAXCC(,@07)                                     1459 07652000
*            /********************************************************/ 07653000
*            /*                                              @Y30SSFR*/ 07654000
*            /*  IF THE READER/INTERPRETER DETECTED AN ERROR @Y30SSFR*/ 07655000
*            /*  SET UP AND PRINT THE LASTCC MESSAGE.        @Y30SSFR*/ 07656000
*            /*                                              @Y30SSFR*/ 07657000
*            /********************************************************/ 07658000
*                                                                  1460 07659000
*            IF (GDTRIH=NULLPTR) & (LASTCC^=0)                     1460 07660000
*              THEN                                                1460 07661000
         SLR   @07,@07                                             1460 07662000
         C     @07,GDTRIH(,GDTPTR)                                 1460 07663000
         BNE   @RF01460                                            1460 07664000
         CR    @14,@07                                             1460 07665000
         BE    @RF01460                                            1460 07666000
*                DO;                                       /*@Y30SSFR*/ 07667000
*                DARGSTID=TSOFAIL;                         /*@Y30SSFR*/ 07668000
         L     @07,DDSTRU                                          1462 07669000
         L     @14,TSOFAIL                                         1462 07670000
         ST    @14,DARGSTID(,@07)                                  1462 07671000
*                DARGILP=2;                                /*@Y30SSFR*/ 07672000
         MVC   DARGILP(2,@07),@CH00161                             1463 07673000
*                DARGDBP=ADDR(LASTCC);                     /*@Y30SSFR*/ 07674000
*                                                                  1464 07675000
         ST    @15,DARGDBP(,@07)                                   1464 07676000
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     /*@Y30SSFR*/ 07677000
*                                                                  1465 07678000
         ST    GDTPTR,@AL00001                                     1465 07679000
         LA    @07,@CF00123                                        1465 07680000
         ST    @07,@AL00001+4                                      1465 07681000
         LA    @07,DDSTRU                                          1465 07682000
         ST    @07,@AL00001+8                                      1465 07683000
         MVI   @AL00001+8,X'80'                                    1465 07684000
         L     @15,GDTPRT(,GDTPTR)                                 1465 07685000
         LA    @01,@AL00001                                        1465 07686000
         BALR  @14,@15                                             1465 07687000
*                END;                                      /*@Y30SSFR*/ 07688000
*                                                                  1466 07689000
*            CALL IDCSAFP0(GDTTBL,RIPOOLID);               /*#YL026UL*/ 07690000
@RF01460 ST    GDTPTR,@AL00001                                     1467 07691000
         LA    @07,MODID                                           1467 07692000
         ST    @07,@AL00001+4                                      1467 07693000
         MVI   @AL00001+4,X'80'                                    1467 07694000
         L     @15,GDTFPL(,GDTPTR)                                 1467 07695000
         LA    @01,@AL00001                                        1467 07696000
         BALR  @14,@15                                             1467 07697000
*            CALL IDCSAFP0(GDTTBL,SPACEID);                /*#YL026UL*/ 07698000
*                                                                  1468 07699000
         ST    GDTPTR,@AL00001                                     1468 07700000
         L     @07,@PC00001+8                                      1468 07701000
         ST    @07,@AL00001+4                                      1468 07702000
         MVI   @AL00001+4,X'80'                                    1468 07703000
         L     @15,GDTFPL(,GDTPTR)                                 1468 07704000
         LA    @01,@AL00001                                        1468 07705000
         BALR  @14,@15                                             1468 07706000
*            END;                                          /*#YL026UL*/ 07707000
*          /**********************************************************/ 07708000
*          /*                                                #YL026UL*/ 07709000
*          /* IF AT COMMAND TERMINATION, FREE UP WORK SPACE, #YL026UL*/ 07710000
*          /* SET 'GDTRIH' TO A NONZERO VALUE TO SIGNAL THAT #YL026UL*/ 07711000
*          /* TERMINATION HAS BEEN PERFORMED, AND OBTAIN THE #YL026UL*/ 07712000
*          /* NAME OF THE FSR MODULE TO BE PASSED THE FDT.   #YL026UL*/ 07713000
*          /*                                                #YL026UL*/ 07714000
*          /**********************************************************/ 07715000
*          ELSE                                                    1470 07716000
*            DO;                                           /*@YL026UL*/ 07717000
         B     @RC01456                                            1470 07718000
@RF01456 DS    0H                                                  1471 07719000
*            GDTRIH=ADDR(GDTRIH);                          /*@YL026UL*/ 07720000
         LA    @07,GDTRIH(,GDTPTR)                                 1471 07721000
         ST    @07,GDTRIH(,GDTPTR)                                 1471 07722000
*            FSRNAME=LOADNAME;                             /*@YL026UL*/ 07723000
*                                                                  1472 07724000
         L     @07,@PC00001+20                                     1472 07725000
         L     @01,DESCPTR                                         1472 07726000
         MVC   FSRNAME(8,@07),LOADNAME(@01)                        1472 07727000
*            CALL IDCSAFP0(GDTTBL,RIPOOLID);               /*@YL026UL*/ 07728000
*                                                                  1473 07729000
         ST    GDTPTR,@AL00001                                     1473 07730000
         LA    @07,MODID                                           1473 07731000
         ST    @07,@AL00001+4                                      1473 07732000
         MVI   @AL00001+4,X'80'                                    1473 07733000
         L     @15,GDTFPL(,GDTPTR)                                 1473 07734000
         LA    @01,@AL00001                                        1473 07735000
         BALR  @14,@15                                             1473 07736000
*            END;                                          /*@YL026UL*/ 07737000
*                                                                  1474 07738000
*        END RITERM;                                       /*@YL026UL*/ 07739000
*                                                                  1475 07740000
*                                                                  1475 07741000
@EL00020 DS    0H                                                  1475 07742000
@EF00020 DS    0H                                                  1475 07743000
@ER00020 LM    @14,@12,@SA00020                                    1475 07744000
         BR    @14                                                 1475 07745000
*        END IDCRI04                                       /*@YL026UL*/ 07746000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 07747000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 07748000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 07749000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 07750000
*/*%INCLUDE SYSLIB  (CVT     )                                        * 07751000
*/*%INCLUDE SYSLIB  (AMSDF26 )                                        * 07752000
*/*%INCLUDE SYSLIB  (IKJPPL  )                                        * 07753000
*/*%INCLUDE SYSLIB  (IKJECT  )                                        * 07754000
*;                                                                 1476 07755000
@DATA    DS    0H                                                       07756000
@CH00170 DC    H'3'                                                     07757000
@CH00164 DC    H'6'                                                     07758000
@CH00038 DC    H'12'                                                    07759000
@CH01454 DC    H'72'                                                    07760000
@CH01804 DC    H'84'                                                    07761000
@SM01823 MVC   PARMSET+1(0,@05),DATABLK(@01)                            07762000
@SM01825 MVC   PARMSET(0,@05),DATABLK(@02)                              07763000
@SM01829 MVC   DATABLK(0,NEWPTR),DATABLK(OLDPTR)                        07764000
@SM01836 MVC   STRNG2+1(0,DATAPTR),DATABLK(@02)                         07765000
@SM01838 MVC   STRNG2(0,DATAPTR),PDEDSN(@02)                            07766000
@SM01840 MVC   STRPWORD(0,DATAPTR),PDEPWD(@02)                          07767000
@SM01842 MVC   STRNG1+1(0,DATAPTR),DATABLK(@02)                         07768000
@SM01844 MVC   STRNG1(0,DATAPTR),PDESTRNG(@02)                          07769000
@SM01846 MVC   PWORD(0,DATAPTR),PDEPWD(@01)                             07770000
@SM01848 MVC   MEMBR(0,DATAPTR),PDEMEM(@01)                             07771000
@SM01850 MVC   DSNAME(0,DATAPTR),PDEDSN(@01)                            07772000
@SM01852 MVC   EFIELD2(0),PDESTRNG(@02)                                 07773000
@SM01854 MVC   EFIELD2(0),PDEDSN(@01)                                   07774000
@SM01856 MVC   0(0,@07),PDEMEM(@01)                                     07775000
@SM01858 MVC   0(0,@07),PDEPWD(@01)                                     07776000
@SM01860 MVC   DATABLK(0,PDEPTR),DATABLK+8(@02)                         07777000
@SM01862 MVC   EFIELD2+1(0),PDESTRNG(@05)                               07778000
@SM01864 MVC   EFIELD2(0),PDEDSN(@02)                                   07779000
@SM01867 MVC   PARMSET(0,@05),DEFLTVAL(@01)                             07780000
@SM01872 MVC   ERRFIELD(0,@07),KWDITEM(KWDPTR)                          07781000
@DATD    DSECT                                                          07782000
         DS    0F                                                       07783000
@SA00001 DS    18F                                                      07784000
@PC00001 DS    6F                                                       07785000
@SA00002 DS    14F                                                      07786000
@SA00003 DS    12F                                                      07787000
@SA00004 DS    12F                                                      07788000
@SA00020 DS    15F                                                      07789000
@SA00019 DS    15F                                                      07790000
@SA00005 DS    13F                                                      07791000
@SA00012 DS    15F                                                      07792000
@SA00014 DS    12F                                                      07793000
@SA00016 DS    12F                                                      07794000
@SA00007 DS    14F                                                      07795000
@SA00008 DS    13F                                                      07796000
@SA00011 DS    15F                                                      07797000
@SA00010 DS    15F                                                      07798000
@PC00010 DS    2F                                                       07799000
@SA00009 DS    13F                                                      07800000
@PC00018 DS    2F                                                       07801000
@SA00013 DS    15F                                                      07802000
@PC00013 DS    2F                                                       07803000
@SA00015 DS    12F                                                      07804000
@PC00015 DS    1F                                                       07805000
@SA00017 DS    13F                                                      07806000
@AL00001 DS    5A                                                       07807000
@TF00001 DS    F                                                        07808000
@AFTEMPS DS    6F                                                       07809000
IDCRI04  CSECT                                                          07810000
         DS    0F                                                       07811000
@CF00123 DC    F'0'                                                     07812000
@CF00227 DC    F'1'                                                     07813000
@CH00227 EQU   @CF00227+2                                               07814000
@CF00161 DC    F'2'                                                     07815000
@CH00161 EQU   @CF00161+2                                               07816000
@CF00050 DC    F'4'                                                     07817000
@CH00050 EQU   @CF00050+2                                               07818000
@CF00187 DC    F'8'                                                     07819000
@CF00041 DC    F'9'                                                     07820000
@CF00487 DC    F'16'                                                    07821000
@CF01449 DC    F'20'                                                    07822000
@CH01449 EQU   @CF01449+2                                               07823000
@CF01803 DC    F'65'                                                    07824000
@CF01802 DC    F'240'                                                   07825000
@CF01815 DC    F'-16'                                                   07826000
@CF01818 DC    F'-12'                                                   07827000
@CF01817 DC    F'-8'                                                    07828000
@CF01821 DC    F'-6'                                                    07829000
@CF01819 DC    F'-4'                                                    07830000
@CF01813 DC    F'-3'                                                    07831000
@CF01822 DC    XL4'0000FFFF'                                            07832000
@CF01684 DC    XL4'400'                                                 07833000
@DATD    DSECT                                                          07834000
         DS    0D                                                       07835000
LISTSCAN DS    A                                                        07836000
IOCSPTR  DS    A                                                        07837000
OPNPTR   DS    A                                                        07838000
DDSTRU   DS    A                                                        07839000
FSADDR   DS    A                                                        07840000
ERCNVADR DS    A                                                        07841000
DMPINDEX DS    A                                                        07842000
DESCPTR  DS    A                                                        07843000
PINFOPTR DS    A                                                        07844000
RSIPTR   DS    A                                                        07845000
PPLPTR   DS    A                                                        07846000
PDLPTR   DS    A                                                        07847000
PARSECB  DS    F                                                        07848000
BUFFPTR  DS    A                                                        07849000
SPACEAMT DS    F                                                        07850000
AMTTOGET DS    F                                                        07851000
BLKLEFT  DS    F                                                        07852000
PMSGPTR  DS    A                                                        07853000
RPLYPTR  DS    A                                                        07854000
SETUPPTR DS    A                                                        07855000
BLKPTR   DS    A                                                        07856000
WORKPTR1 DS    A                                                        07857000
LISTPTR  DS    A                                                        07858000
SETRC    DS    H                                                        07859000
PARMID   DS    H                                                        07860000
RSICOUNT DS    H                                                        07861000
REPINDEX DS    H                                                        07862000
SUPERID  DS    H                                                        07863000
PRMSETID DS    H                                                        07864000
INDEX5   DS    H                                                        07865000
INDEX9   DS    H                                                        07866000
INDEX10  DS    H                                                        07867000
PMSGLEN  DS    H                                                        07868000
RPLYLEN  DS    H                                                        07869000
REPCOUNT DS    H                                                        07870000
LISTTOTL DS    H                                                        07871000
VECTROFF DS    H                                                        07872000
INDEX1   DS    H                                                        07873000
LISTLN   DS    FL1                                                      07874000
@TS00001 DS    CL95                                                     07875000
         DS    CL2                                                      07876000
PPLAREA  DS    CL28                                                     07877000
PRNTAREA DS    BL20                                                     07878000
EFIELD   DS    CL84                                                     07879000
         ORG   EFIELD                                                   07880000
EFIELD1  DS    CL20                                                     07881000
EFIELD2  DS    CL64                                                     07882000
         ORG   EFIELD2                                                  07883000
EFIELD3  DS    FL4                                                      07884000
         ORG   EFIELD+84                                                07885000
MSGBUFF  DS    CL72                                                     07886000
MISCFLGS DS    CL1                                                      07887000
         ORG   MISCFLGS                                                 07888000
PROMPT   DS    BL1                                                      07889000
SINGLPRM EQU   MISCFLGS+0                                               07890000
ALLOK    EQU   MISCFLGS+0                                               07891000
GOODCMD  EQU   MISCFLGS+0                                               07892000
NAMEPDE  EQU   MISCFLGS+0                                               07893000
CNTDONE  EQU   MISCFLGS+0                                               07894000
FOUND    EQU   MISCFLGS+0                                               07895000
         ORG   MISCFLGS+1                                               07896000
TRUNCATE DS    BL1                                                      07897000
KEEP1ST  DS    BL1                                                      07898000
DFLTOK   DS    BL1                                                      07899000
IDCRI04  CSECT                                                          07900000
         DS    0F                                                       07901000
@SIZDATD DC    AL1(0)                                                   07902000
         DC    AL3(@ENDDATD-@DATD)                                      07903000
@CV01498 DC    V(NUMPCL)                                                07904000
@CV01499 DC    V(STRPCL)                                                07905000
@CV01500 DC    V(DDNPCL)                                                07906000
@CV01501 DC    V(DSNPCL)                                                07907000
@CV01502 DC    V(DSVPCL)                                                07908000
@CV01503 DC    V(DSGPCL)                                                07909000
@CV01504 DC    V(DSGVPCL)                                               07910000
@CV01505 DC    V(DSNPCL2)                                               07911000
@CV01509 DC    V(REPPCL)                                                07912000
@CV01507 DC    V(DSGPCL2)                                               07913000
@CV01508 DC    V(DSGVPCL2)                                              07914000
@CV01506 DC    V(DSVPCL2)                                               07915000
         DS    0D                                                       07916000
CHAINEND DC    XL4'FF000000'                                            07917000
NOSPACE  DS    FL4                                                      07918000
         ORG   NOSPACE                                                  07919000
@NM00059 DC    CL3'UV0'                                                 07920000
@NM00060 DC    AL1(4)                                                   07921000
         ORG   NOSPACE+4                                                07922000
TSOFAIL  DS    FL4                                                      07923000
         ORG   TSOFAIL                                                  07924000
@NM00061 DC    CL3'UV0'                                                 07925000
@NM00062 DC    AL1(15)                                                  07926000
         ORG   TSOFAIL+4                                                07927000
@CC01525 DC    C'FFFFFFFF'                                              07928000
@CC01527 DC    C'IDCRILT '                                              07929000
@CC01529 DC    C'RI10'                                                  07930000
@CC01544 DC    C'RI12'                                                  07931000
@CC01552 DC    C'RI14'                                                  07932000
@CC01595 DC    C'RI16'                                                  07933000
@CC01610 DC    C'RI18'                                                  07934000
@CC01618 DC    C'RI20'                                                  07935000
@CC01663 DC    C'RI22'                                                  07936000
@CC01681 DC    C'RI24'                                                  07937000
@CC01695 DC    C'RI26'                                                  07938000
@CC01708 DC    C'RI28'                                                  07939000
@CC01715 DC    C'RI30'                                                  07940000
@CC01734 DC    C'RI32'                                                  07941000
@CC01744 DC    C'RI34'                                                  07942000
@CC01757 DC    C'RI36'                                                  07943000
@CC01769 DC    C'RI38'                                                  07944000
@CC01781 DC    C'RI40'                                                  07945000
@CC01793 DC    C'RI42'                                                  07946000
@CC01797 DC    C'RI44'                                                  07947000
@CC01801 DC    C'RI46'                                                  07948000
@CC01472 EQU   @CC01529                                                 07949000
@CC01553 DC    C'P '                                                    07950000
@CB01701 DC    X'4040'                                                  07951000
ALL      DC    CL3'ALL'                                                 07952000
FORMAT   DC    CL4'FORM'                                                07953000
HSECOND  DC    CL4'HSEC'                                                07954000
CLOCK    DC    CL4'KLOK'                                                07955000
SETZERO  DC    CL4'ZERO'                                                07956000
SETBLANK DC    CL4'BLNK'                                                07957000
NOSET    DC    CL4'NSET'                                                07958000
OVERRIDE DC    CL4'OVRD'                                                07959000
ACQUIRE  DC    CL8'ACQUIRE '                                            07960000
RELINQ   DC    CL8'RELINQ  '                                            07961000
MOUNT    DC    CL8'MOUNT   '                                            07962000
DEMOUNT  DC    CL8'DEMOUNT '                                            07963000
DEFINE   DC    CL8'DEFINE  '                                            07964000
MOVE     DC    CL8'MOVE    '                                            07965000
TRACEQ   DC    CL8'TRACEQ  '                                            07966000
COPYTABL DC    CL8'COPYTABL'                                            07967000
COPYCRTG DC    CL8'COPYCRTG'                                            07968000
COPYVOL  DC    CL8'COPYVOL '                                            07969000
VVIC     DC    CL8'VVIC    '                                            07970000
TUNE     DC    CL8'TUNE    '                                            07971000
NAMES    DC    CL4'NAME'                                                07972000
UNIT     DC    CL4'UNIT'                                                07973000
SHR      DC    CL4'SHR '                                                07974000
EXCL     DC    CL4'EXCL'                                                07975000
NOWAIT   DC    CL4'NWAI'                                                07976000
WAIT     DC    CL4'WAIT'                                                07977000
MODID    DC    CL4'RI04'                                                07978000
FIXAREA  DS    CL256                                                    07979000
         ORG   FIXAREA                                                  07980000
@NM00063 DC    256X'00'                                                 07981000
         ORG   FIXAREA+256                                              07982000
LISTRPLY DC    CL4'''OK'''                                              07983000
RETAIN1  DC    CL3'''1'''                                               07984000
RETAIN2  DC    CL3'''2'''                                               07985000
NOKWD    DC    CL12'''POSITIONAL'''                                     07986000
@DATD    DSECT                                                          07987000
IDCRI04  CSECT                                                          07988000
*                                                                       07989000
*  PCL DESCRIBING A NUMERIC CONSTANT                                    07990000
NUMPCL   IKJPARM DSECT=STDPCL1                                          07991000
NUM      IKJIDENT 'NUMERIC CONSTANT',INTEG,                            *07992000
               PROMPT='REQUESTED NUMERIC CONSTANT'                      07993000
         IKJENDP                                                        07994000
*                                                                       07995000
*  PCL DESCRIBING A STRING CONSTANT                                     07996000
STRPCL   IKJPARM DSECT=STDPCL2                                          07997000
STR      IKJIDENT 'STRING CONSTANT',HEX,                               *07998000
               PROMPT='REQUESTED STRING CONSTANT'                       07999000
         IKJENDP                                                        08000000
*                                                                       08001000
*  PCL DESCRIBING A STRING CONSTANT WITH PASSWORD                       08002000
DDNPCL   IKJPARM DSECT=STDPCL3                                          08003000
DDN      IKJPOSIT DSNAME,PROMPT='REQUESTED STRING CONSTANT'             08004000
         IKJENDP                                                        08005000
*                                                                       08006000
*  PCL DESCRIBING STANDARD DATA SET NAME WITH PREFIX                    08007000
DSNPCL   IKJPARM DSECT=STDPCL4                                          08008000
DSN      IKJPOSIT DSNAME,USID,                                         *08009000
               PROMPT='REQUESTED DATA SET NAME'                         08010000
         IKJENDP                                                        08011000
*                                                                       08012000
*  PCL DESCRIBING STANDARD DATA SET NAME WITH PREFIX OR VOLID           08013000
DSVPCL   IKJPARM DSECT=STDPCL5                                          08014000
DSV      IKJPOSIT DSNAME,USID,VOLSER,                                  *08015000
               PROMPT='REQUESTED DATA SET NAME OR VOLUME NAME'          08016000
         IKJENDP                                                        08017000
*                                                                       08018000
*  PCL DESCRIBING STANDARD OR GENERIC DATA SET NAME WITH PREFIX         08019000
DSGPCL   IKJPARM DSECT=STDPCL6                                          08020000
DSG      IKJPOSIT DSTHING,USID,                                        *08021000
               PROMPT='REQUESTED DATA SET NAME'                         08022000
         IKJENDP                                                        08023000
*                                                                       08024000
*  PCL DESCRIBING STANDARD OR GENERIC DSNAME WITH PREFIX OR VOLID       08025000
DSGVPCL  IKJPARM DSECT=STDPCL7                                          08026000
DSGV     IKJPOSIT DSTHING,USID,VOLSER,                                 *08027000
               PROMPT='REQUESTED DATA SET NAME OR VOLUME NAME'          08028000
         IKJENDP                                                        08029000
*                                                                       08030000
*  PCL DESCRIBING STANDARD DATA SET NAME WITHOUT PREFIX                 08031000
DSNPCL2  IKJPARM DSECT=STDPCL8                                          08032000
DSN2     IKJPOSIT DSNAME,                                              *08033000
               PROMPT='REQUESTED DATA SET NAME'                         08034000
         IKJENDP                                                        08035000
*                                                                       08036000
*  PCL DESCRIBING STANDARD DATA SET NAME WITHOUT PREFIX OR VOLID        08037000
DSVPCL2  IKJPARM DSECT=STDPCL9                                          08038000
DSV2     IKJPOSIT DSNAME,VOLSER,                                       *08039000
               PROMPT='REQUESTED DATA SET NAME OR VOLUME NAME'          08040000
         IKJENDP                                                        08041000
*                                                                       08042000
*  PCL DESCRIBING STANDARD OR GENERIC DATA SET NAME WITHOUT PREFIX      08043000
DSGPCL2  IKJPARM DSECT=STDPCL10                                         08044000
DSG2     IKJPOSIT DSTHING,                                             *08045000
               PROMPT='REQUESTED DATA SET NAME'                         08046000
         IKJENDP                                                        08047000
*                                                                       08048000
*  PCL DESCRIBING STANDARD OR GENERIC DSNAME WITHOUT PREFIX OR VOLID    08049000
DSGVPCL2 IKJPARM DSECT=STDPCL11                                         08050000
DSGV2    IKJPOSIT DSTHING,VOLSER,                                      *08051000
               PROMPT='REQUESTED DATA SET NAME OR VOLUME NAME'          08052000
         IKJENDP                                                        08053000
*                                                                       08054000
*  PCL DESCRIBING A PSTRING (REPEATED SUBLIST)                          08055000
REPPCL   IKJPARM DSECT=STDPCL12                                         08056000
REP      IKJPOSIT PSTRING,PROMPT='PARENTHESIZED SUBPARAMETER LIST'      08057000
         IKJENDP                                                        08058000
@DATAD   DSECT                                                          08059000
@DATD    DSECT                                                          08060000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                08061000
@ENDDATD EQU   *                                                        08062000
IDCRI04  CSECT                                                          08063000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       08064000
@01      EQU   01                                                       08065000
@02      EQU   02                                                       08066000
@03      EQU   03                                                       08067000
@04      EQU   04                                                       08068000
@05      EQU   05                                                       08069000
@06      EQU   06                                                       08070000
@07      EQU   07                                                       08071000
@08      EQU   08                                                       08072000
@09      EQU   09                                                       08073000
@10      EQU   10                                                       08074000
@11      EQU   11                                                       08075000
@12      EQU   12                                                       08076000
@13      EQU   13                                                       08077000
@14      EQU   14                                                       08078000
@15      EQU   15                                                       08079000
WORKPTR2 EQU   @05                                                      08080000
ERASEID  EQU   @03                                                      08081000
NAMEPOS  EQU   @02                                                      08082000
ORIGPDL  EQU   @07                                                      08083000
NEXTPDE  EQU   @02                                                      08084000
STARCNT  EQU   @02                                                      08085000
DATAPTR  EQU   @07                                                      08086000
MOVEAMT  EQU   @02                                                      08087000
NEWPTR   EQU   @05                                                      08088000
OLDPTR   EQU   @07                                                      08089000
MOVELEN  EQU   @04                                                      08090000
BASEPTR  EQU   @04                                                      08091000
PDEPTR   EQU   @03                                                      08092000
INDEX11  EQU   @02                                                      08093000
INDEX8   EQU   @04                                                      08094000
INDEX7   EQU   @05                                                      08095000
INDEX6   EQU   @04                                                      08096000
INDEX4   EQU   @02                                                      08097000
INDEX3   EQU   @03                                                      08098000
INDEX2   EQU   @02                                                      08099000
TESTID   EQU   @02                                                      08100000
KWDPTR   EQU   @03                                                      08101000
GRPPTR   EQU   @04                                                      08102000
TESTRC   EQU   @05                                                      08103000
RTNREG   EQU   @15                                                      08104000
GPR01P   EQU   @01                                                      08105000
GDTPTR   EQU   @06                                                      08106000
GPR00F   EQU   @00                                                      08107000
GPR00P   EQU   @00                                                      08108000
GPR01F   EQU   @01                                                      08109000
GPR14F   EQU   @14                                                      08110000
GPR14P   EQU   @14                                                      08111000
GPR15F   EQU   @15                                                      08112000
GPR15P   EQU   @15                                                      08113000
REG0     EQU   @00                                                      08114000
REG1     EQU   @01                                                      08115000
REG10    EQU   @10                                                      08116000
REG11    EQU   @11                                                      08117000
REG12    EQU   @12                                                      08118000
REG13    EQU   @13                                                      08119000
REG14    EQU   @14                                                      08120000
REG15    EQU   @15                                                      08121000
REG2     EQU   @02                                                      08122000
REG3     EQU   @03                                                      08123000
REG4     EQU   @04                                                      08124000
REG5     EQU   @05                                                      08125000
REG6     EQU   @06                                                      08126000
REG7     EQU   @07                                                      08127000
REG8     EQU   @08                                                      08128000
REG9     EQU   @09                                                      08129000
CVTPTR   EQU   16                                                       08130000
GDTTBL   EQU   0                                                        08131000
GDTTR1   EQU   GDTTBL+8                                                 08132000
GDTTR2   EQU   GDTTBL+12                                                08133000
GDTRIH   EQU   GDTTBL+24                                                08134000
GDTDBG   EQU   GDTTBL+40                                                08135000
GDTSTC   EQU   GDTTBL+44                                                08136000
GDTPRT   EQU   GDTTBL+48                                                08137000
GDTESS   EQU   GDTTBL+52                                                08138000
GDTESA   EQU   GDTTBL+56                                                08139000
GDTRST   EQU   GDTTBL+60                                                08140000
GDTRES   EQU   GDTTBL+64                                                08141000
GDTCAL   EQU   GDTTBL+68                                                08142000
GDTGSP   EQU   GDTTBL+72                                                08143000
GDTFSP   EQU   GDTTBL+76                                                08144000
GDTGPL   EQU   GDTTBL+80                                                08145000
GDTFPL   EQU   GDTTBL+84                                                08146000
GDTLOD   EQU   GDTTBL+88                                                08147000
GDTDEL   EQU   GDTTBL+92                                                08148000
GDTPRL   EQU   GDTTBL+96                                                08149000
GDTEPL   EQU   GDTTBL+100                                               08150000
GDTTIM   EQU   GDTTBL+104                                               08151000
GDTIIO   EQU   GDTTBL+108                                               08152000
GDTTIO   EQU   GDTTBL+112                                               08153000
GDTOPN   EQU   GDTTBL+124                                               08154000
GDTCLS   EQU   GDTTBL+128                                               08155000
GDTGET   EQU   GDTTBL+132                                               08156000
GDTPUT   EQU   GDTTBL+136                                               08157000
GDTPOS   EQU   GDTTBL+140                                               08158000
GDTCPY   EQU   GDTTBL+144                                               08159000
GDTCAT   EQU   GDTTBL+148                                               08160000
GDTSNP   EQU   GDTTBL+164                                               08161000
GDTVFY   EQU   GDTTBL+172                                               08162000
GDTCMB   EQU   GDTTBL+176                                               08163000
GDTUPT   EQU   GDTTBL+180                                               08164000
GDTECT   EQU   GDTTBL+188                                               08165000
GDTUID   EQU   GDTTBL+192                                               08166000
GDTPMT   EQU   GDTTBL+196                                               08167000
GDTCIR   EQU   GDTTBL+200                                               08168000
GDTLNK   EQU   GDTTBL+204                                               08169000
GDTALC   EQU   GDTTBL+208                                               08170000
GDTDLC   EQU   GDTTBL+212                                               08171000
GDTQAL   EQU   GDTTBL+216                                               08172000
GDTSTW   EQU   GDTTBL+220                                               08173000
GDTSSC   EQU   GDTTBL+224                                               08174000
GDTENQ   EQU   GDTTBL+228                                               08175000
GDTRSV   EQU   GDTTBL+232                                               08176000
GDTDEQ   EQU   GDTTBL+236                                               08177000
GDTSFO   EQU   GDTTBL+240                                               08178000
GDTWTO   EQU   GDTTBL+244                                               08179000
GDTSCR   EQU   GDTTBL+248                                               08180000
GDTUNT   EQU   GDTTBL+252                                               08181000
GDTRCT   EQU   GDTTBL+256                                               08182000
GDTIFO   EQU   GDTTBL+260                                               08183000
GDTEXP   EQU   GDTTBL+264                                               08184000
GDTSTA   EQU   GDTTBL+268                                               08185000
GDTERR   EQU   GDTTBL+272                                               08186000
GDTUNC   EQU   GDTTBL+276                                               08187000
GDTLOC   EQU   GDTTBL+280                                               08188000
IDCSALD0 EQU   0                                                        08189000
IDCSAEP0 EQU   0                                                        08190000
IDCSAGP0 EQU   0                                                        08191000
IDCSAFP0 EQU   0                                                        08192000
IDCSAPT0 EQU   0                                                        08193000
TRACE1   EQU   0                                                        08194000
OLDERID1 EQU   TRACE1                                                   08195000
TRACE2   EQU   0                                                        08196000
OLDERID2 EQU   TRACE2                                                   08197000
NEWID2   EQU   TRACE2+95                                                08198000
NEWERID2 EQU   5                                                        08199000
CIRAGL   EQU   0                                                        08200000
CIRTYPE  EQU   CIRAGL                                                   08201000
ALLAGL   EQU   0                                                        08202000
ALLSTS   EQU   ALLAGL+24                                                08203000
ALLDSP   EQU   ALLAGL+25                                                08204000
ALLORG   EQU   ALLAGL+26                                                08205000
ALLOPT   EQU   ALLAGL+28                                                08206000
UNITABL  EQU   0                                                        08207000
UNITADR  EQU   UNITABL+4                                                08208000
@NM00010 EQU   UNITADR                                                  08209000
UNITSTAT EQU   UNITABL+6                                                08210000
IOCSTR   EQU   0                                                        08211000
IOCDSO   EQU   IOCSTR+16                                                08212000
IOCRFM   EQU   IOCSTR+17                                                08213000
IOCMAC   EQU   IOCSTR+18                                                08214000
IOCMAC2  EQU   IOCSTR+19                                                08215000
IOCCHP   EQU   IOCSTR+20                                                08216000
IOCMSG   EQU   IOCSTR+21                                                08217000
IOCRBA   EQU   IOCSTR+40                                                08218000
IOCTTR   EQU   IOCRBA                                                   08219000
IOCMEM   EQU   IOCSTR+44                                                08220000
IOCNWM   EQU   IOCSTR+48                                                08221000
IOCREL   EQU   IOCSTR+60                                                08222000
OPNAGL   EQU   0                                                        08223000
OPNOPT   EQU   OPNAGL                                                   08224000
OPNRFM   EQU   OPNAGL+1                                                 08225000
OPNTYP   EQU   OPNAGL+2                                                 08226000
OPNMOD   EQU   OPNAGL+3                                                 08227000
OPNDEV   EQU   OPNAGL+24                                                08228000
OPNDSO   EQU   OPNAGL+41                                                08229000
OPNOPT2  EQU   OPNAGL+42                                                08230000
IOINFOPT EQU   0                                                        08231000
UVOLLIST EQU   0                                                        08232000
UVOLENT  EQU   UVOLLIST+2                                               08233000
AMSTP011 EQU   0                                                        08234000
DARGLIST EQU   0                                                        08235000
DARGDBP  EQU   DARGLIST                                                 08236000
DARGRETP EQU   DARGLIST+4                                               08237000
DARGSTID EQU   DARGLIST+8                                               08238000
DARGSMOD EQU   DARGSTID                                                 08239000
DARGSENT EQU   DARGSTID+3                                               08240000
DARGILP  EQU   DARGLIST+12                                              08241000
DARGRETL EQU   DARGLIST+16                                              08242000
DARGARY  EQU   DARGLIST+20                                              08243000
DARGINS  EQU   DARGARY                                                  08244000
DARGINL  EQU   DARGARY+2                                                08245000
FMTLIST  EQU   0                                                        08246000
FMTFLGS  EQU   FMTLIST                                                  08247000
FMTSPF   EQU   FMTLIST+2                                                08248000
FMTRFNO  EQU   FMTSPF                                                   08249000
FMTILEN  EQU   FMTRFNO                                                  08250000
FMTIOFF  EQU   FMTLIST+4                                                08251000
FMTTRBC  EQU   FMTIOFF                                                  08252000
FMTSTO   EQU   FMTTRBC                                                  08253000
FMTOCOL  EQU   FMTLIST+6                                                08254000
FMTCNVF  EQU   FMTLIST+10                                               08255000
ERCNVTAB EQU   0                                                        08256000
ERTYPE   EQU   ERCNVTAB                                                 08257000
EROPER   EQU   ERCNVTAB+1                                               08258000
EROSOPER EQU   ERCNVTAB+2                                               08259000
ERCATRC  EQU   ERCNVTAB+16                                              08260000
ERCPLPT  EQU   ERCNVTAB+20                                              08261000
DMPITM   EQU   0                                                        08262000
DMPARY   EQU   0                                                        08263000
CVTMAP   EQU   0                                                        08264000
CVTDAR   EQU   CVTMAP+72                                                08265000
CVTFLGS1 EQU   CVTDAR                                                   08266000
CVTDCB   EQU   CVTMAP+116                                               08267000
CVTIERLC EQU   CVTMAP+144                                               08268000
CVTOPTA  EQU   CVTMAP+182                                               08269000
CVTOPTB  EQU   CVTMAP+183                                               08270000
CVTGTF   EQU   CVTMAP+236                                               08271000
CVTGTFST EQU   CVTGTF                                                   08272000
CVTGTFS  EQU   CVTGTFST                                                 08273000
CVTSTATE EQU   CVTGTFST                                                 08274000
CVTTMODE EQU   CVTGTFST                                                 08275000
CVTFORM  EQU   CVTGTFST                                                 08276000
CVTAQAVT EQU   CVTMAP+240                                               08277000
CVTTCMFG EQU   CVTAQAVT                                                 08278000
CVTVOLM2 EQU   CVTMAP+244                                               08279000
CVTTATA  EQU   CVTVOLM2                                                 08280000
CVTTSKS  EQU   CVTTATA                                                  08281000
CVTVOLF2 EQU   CVTTSKS                                                  08282000
CVTTAT   EQU   CVTTATA+1                                                08283000
CVTATER  EQU   CVTMAP+248                                               08284000
CVTEXT1  EQU   CVTMAP+252                                               08285000
CVTPURG  EQU   CVTMAP+260                                               08286000
CVTQMSG  EQU   CVTMAP+268                                               08287000
CVTDMSR  EQU   CVTMAP+272                                               08288000
CVTRSV37 EQU   CVTDMSR                                                  08289000
CVTDMSRF EQU   CVTRSV37                                                 08290000
CVTERPV  EQU   CVTMAP+316                                               08291000
CVTINTLA EQU   CVTMAP+320                                               08292000
CVTAPF   EQU   CVTMAP+324                                               08293000
CVTEXT2  EQU   CVTMAP+328                                               08294000
CVTHJES  EQU   CVTMAP+332                                               08295000
CVTPGSIA EQU   CVTMAP+348                                               08296000
CVTA1F1  EQU   CVTMAP+356                                               08297000
CVTSYSK  EQU   CVTMAP+357                                               08298000
CVTVOLM1 EQU   CVTMAP+380                                               08299000
CVTVOLF1 EQU   CVTVOLM1                                                 08300000
CVTATMCT EQU   CVTMAP+388                                               08301000
CVTXTNT1 EQU   0                                                        08302000
CVTXTNT2 EQU   0                                                        08303000
CVTDSSV  EQU   CVTXTNT2                                                 08304000
CVTFLGBT EQU   CVTXTNT2+5                                               08305000
CVTQID   EQU   CVTXTNT2+24                                              08306000
CVTRV400 EQU   CVTXTNT2+52                                              08307000
CVTRV409 EQU   CVTXTNT2+53                                              08308000
CVTATCVT EQU   CVTXTNT2+64                                              08309000
CVTRV429 EQU   CVTXTNT2+84                                              08310000
CVTRV438 EQU   CVTXTNT2+85                                              08311000
CVTRV457 EQU   CVTXTNT2+112                                             08312000
CVTRV466 EQU   CVTXTNT2+113                                             08313000
CVTFIX   EQU   0                                                        08314000
CVTRELNO EQU   CVTFIX+252                                               08315000
VERBDATA EQU   0                                                        08316000
PCLDSPL1 EQU   VERBDATA+4                                               08317000
VDATALEN EQU   VERBDATA+6                                               08318000
PARMCNT  EQU   VERBDATA+8                                               08319000
MAXID    EQU   VERBDATA+10                                              08320000
LOADNAME EQU   VERBDATA+12                                              08321000
POSDSPL  EQU   VERBDATA+20                                              08322000
DGRPDSPL EQU   VERBDATA+21                                              08323000
VNGRPDSP EQU   VERBDATA+22                                              08324000
NTGRPDSP EQU   VERBDATA+23                                              08325000
@NM00034 EQU   0                                                        08326000
DGRPTOT  EQU   0                                                        08327000
@NM00035 EQU   0                                                        08328000
DGRPCNT  EQU   @NM00035                                                 08329000
DGRPID   EQU   @NM00035+2                                               08330000
VNGRPTOT EQU   0                                                        08331000
@NM00036 EQU   0                                                        08332000
VNGRPCNT EQU   @NM00036                                                 08333000
VNGRPID  EQU   @NM00036+2                                               08334000
NTGRPTOT EQU   0                                                        08335000
@NM00037 EQU   0                                                        08336000
NTGRPCNT EQU   @NM00037                                                 08337000
NTGRPID  EQU   @NM00037+2                                               08338000
PARMDATA EQU   0                                                        08339000
PDEFLEN  EQU   PARMDATA                                                 08340000
OCCURNUM EQU   PARMDATA+1                                               08341000
IDDSPL   EQU   PARMDATA+4                                               08342000
KWDDSPL  EQU   PARMDATA+5                                               08343000
NOTDSPL  EQU   PARMDATA+6                                               08344000
NGRPDSPL EQU   PARMDATA+7                                               08345000
PDEDSPL  EQU   PARMDATA+8                                               08346000
KWDGRPID EQU   PARMDATA+9                                               08347000
SCLRDATA EQU   PARMDATA+11                                              08348000
REPEATED EQU   PARMDATA+11                                              08349000
LIST     EQU   PARMDATA+11                                              08350000
DEFAULT  EQU   PARMDATA+11                                              08351000
SUBLIST  EQU   PARMDATA+11                                              08352000
DSCRPTR1 EQU   0                                                        08353000
PCLDSPL2 EQU   DSCRPTR1                                                 08354000
SUBDSPL  EQU   DSCRPTR1+2                                               08355000
REPMAX   EQU   DSCRPTR1+3                                               08356000
DSCRPTR2 EQU   0                                                        08357000
HIVALUE  EQU   DSCRPTR2                                                 08358000
LOWVALUE EQU   DSCRPTR2+4                                               08359000
MAXLNGTH EQU   DSCRPTR2+8                                               08360000
LISTMAX  EQU   DSCRPTR2+9                                               08361000
NUMBER   EQU   DSCRPTR2+11                                              08362000
ANYSTRNG EQU   DSCRPTR2+11                                              08363000
DSNAM    EQU   DSCRPTR2+11                                              08364000
GENERIC  EQU   DSCRPTR2+11                                              08365000
VOLID    EQU   DSCRPTR2+11                                              08366000
USERID   EQU   DSCRPTR2+11                                              08367000
PWORDOPT EQU   DSCRPTR2+11                                              08368000
DEFLT    EQU   0                                                        08369000
DEFLTLEN EQU   DEFLT                                                    08370000
DEFLTVAL EQU   DEFLT+1                                                  08371000
@NM00042 EQU   0                                                        08372000
IDCOUNT  EQU   @NM00042                                                 08373000
@NM00043 EQU   @NM00042+2                                               08374000
IDNUM    EQU   @NM00043                                                 08375000
PDEOFST1 EQU   @NM00043+2                                               08376000
KWDCOUNT EQU   0                                                        08377000
@NM00044 EQU   0                                                        08378000
KWDLEN   EQU   @NM00044                                                 08379000
KWDITEM  EQU   @NM00044+1                                               08380000
@NM00045 EQU   0                                                        08381000
SUBCOUNT EQU   @NM00045                                                 08382000
@NM00046 EQU   @NM00045+2                                               08383000
PARMTYPE EQU   @NM00046                                                 08384000
SUBID    EQU   @NM00046+2                                               08385000
NGRPTOT  EQU   0                                                        08386000
@NM00047 EQU   0                                                        08387000
NGRPCNT  EQU   @NM00047                                                 08388000
NGRPID   EQU   @NM00047+2                                               08389000
@NM00048 EQU   0                                                        08390000
NOTCOUNT EQU   @NM00048                                                 08391000
NOTID    EQU   @NM00048+2                                               08392000
@NM00049 EQU   0                                                        08393000
PDECNT   EQU   @NM00049                                                 08394000
@NM00050 EQU   @NM00049+2                                               08395000
PDEPRMID EQU   @NM00050                                                 08396000
PDEPCLID EQU   @NM00050+2                                               08397000
PDEOFST2 EQU   @NM00050+4                                               08398000
FDTTBL   EQU   0                                                        08399000
FDTVERB  EQU   FDTTBL                                                   08400000
FDTPTR   EQU   FDTTBL+8                                                 08401000
PARMINFO EQU   0                                                        08402000
PARMPTR  EQU   PARMINFO                                                 08403000
NTGRPPTR EQU   PARMINFO+4                                               08404000
SUPRPARM EQU   PARMINFO+8                                               08405000
PARMFLAG EQU   PARMINFO+10                                              08406000
RSI      EQU   0                                                        08407000
SBLSTPTR EQU   RSI                                                      08408000
SBLSTLEN EQU   RSI+4                                                    08409000
SBLSTID  EQU   RSI+6                                                    08410000
SBLSTNUM EQU   RSI+8                                                    08411000
SBLSTIN  EQU   RSI+9                                                    08412000
VECTRDSP EQU   RSI+10                                                   08413000
VECTRVAL EQU   0                                                        08414000
PPL      EQU   0                                                        08415000
PPLUPT   EQU   PPL                                                      08416000
PPLECT   EQU   PPL+4                                                    08417000
PPLECB   EQU   PPL+8                                                    08418000
PPLPCL   EQU   PPL+12                                                   08419000
PPLANS   EQU   PPL+16                                                   08420000
PPLCBUF  EQU   PPL+20                                                   08421000
PPLUWA   EQU   PPL+24                                                   08422000
ECT      EQU   0                                                        08423000
ECTPCMD  EQU   ECT+12                                                   08424000
ECTSWS   EQU   ECT+28                                                   08425000
ECTNOPD  EQU   ECTSWS                                                   08426000
ECTSWS2  EQU   ECT+40                                                   08427000
ECTSWS21 EQU   ECTSWS2                                                  08428000
CBUFF    EQU   0                                                        08429000
PSETLEN  EQU   CBUFF                                                    08430000
PARMSET  EQU   CBUFF+4                                                  08431000
DATABLK  EQU   0                                                        08432000
RIPOOLID EQU   0                                                        08433000
RILT     EQU   0                                                        08434000
@NM00064 EQU   RILT                                                     08435000
TBLVERB  EQU   @NM00064                                                 08436000
TBLLNAME EQU   @NM00064+8                                               08437000
PDE1     EQU   0                                                        08438000
CONSTPTR EQU   PDE1                                                     08439000
CONSTLEN EQU   PDE1+4                                                   08440000
NXTCPDE  EQU   PDE1+8                                                   08441000
PDE2     EQU   0                                                        08442000
DSNPTR   EQU   PDE2                                                     08443000
DSNLEN   EQU   PDE2+4                                                   08444000
DSNIN    EQU   PDE2+6                                                   08445000
DSNQUOTE EQU   PDE2+6                                                   08446000
MEMPTR   EQU   PDE2+8                                                   08447000
MEMLEN   EQU   PDE2+12                                                  08448000
MEMIN    EQU   PDE2+14                                                  08449000
PWDPTR   EQU   PDE2+16                                                  08450000
PWDLEN   EQU   PDE2+20                                                  08451000
PWDIN    EQU   PDE2+22                                                  08452000
NXTDPDE  EQU   PDE2+24                                                  08453000
KWDID    EQU   0                                                        08454000
PDENUMBR EQU   0                                                        08455000
PDESTRNG EQU   0                                                        08456000
PDEDSN   EQU   0                                                        08457000
PDEMEM   EQU   0                                                        08458000
PDEPWD   EQU   0                                                        08459000
CODED    EQU   0                                                        08460000
NUMBRCNT EQU   0                                                        08461000
STRNGCNT EQU   0                                                        08462000
FULLWORD EQU   0                                                        08463000
@NM00073 EQU   0                                                        08464000
STRNG1LN EQU   @NM00073                                                 08465000
STRNG1   EQU   @NM00073+1                                               08466000
@NM00074 EQU   0                                                        08467000
STRPWLEN EQU   @NM00074                                                 08468000
STRPWORD EQU   @NM00074+1                                               08469000
STRNG2LN EQU   @NM00074+9                                               08470000
STRNG2   EQU   @NM00074+10                                              08471000
DSNSTRCT EQU   0                                                        08472000
PWORDLEN EQU   DSNSTRCT                                                 08473000
PWORD    EQU   DSNSTRCT+1                                               08474000
STARPOS  EQU   DSNSTRCT+9                                               08475000
UNQUOTED EQU   DSNSTRCT+10                                              08476000
MEMBRLEN EQU   DSNSTRCT+11                                              08477000
MEMBR    EQU   DSNSTRCT+12                                              08478000
DSNAMELN EQU   DSNSTRCT+20                                              08479000
DSNAME   EQU   DSNSTRCT+21                                              08480000
ERRFIELD EQU   0                                                        08481000
AMSTP041 EQU   0                                                        08482000
AMSTP042 EQU   0                                                        08483000
AMSTP043 EQU   0                                                        08484000
AMSTP044 EQU   0                                                        08485000
DMPTRM   EQU   0                                                        08486000
IDCDB010 EQU   0                                                        08487000
IDCIOCL0 EQU   0                                                        08488000
IDCIOCO0 EQU   0                                                        08489000
IDCIOGT0 EQU   0                                                        08490000
IDCIOIT0 EQU   0                                                        08491000
IDCIOOP0 EQU   0                                                        08492000
IDCIOPO0 EQU   0                                                        08493000
IDCIOPT0 EQU   0                                                        08494000
IDCIOSI0 EQU   0                                                        08495000
IDCIOST0 EQU   0                                                        08496000
IDCIOTM0 EQU   0                                                        08497000
IDCIOVY0 EQU   0                                                        08498000
IDCIO050 EQU   0                                                        08499000
IDCSAAL0 EQU   0                                                        08500000
IDCSACA0 EQU   0                                                        08501000
IDCSACL0 EQU   0                                                        08502000
IDCSACR0 EQU   0                                                        08503000
IDCSADE0 EQU   0                                                        08504000
IDCSADL0 EQU   0                                                        08505000
IDCSADQ0 EQU   0                                                        08506000
IDCSAFS0 EQU   0                                                        08507000
IDCSAGS0 EQU   0                                                        08508000
IDCSAID0 EQU   0                                                        08509000
IDCSALC0 EQU   0                                                        08510000
IDCSALK0 EQU   0                                                        08511000
IDCSANQ0 EQU   0                                                        08512000
IDCSAPR0 EQU   0                                                        08513000
IDCSAQL0 EQU   0                                                        08514000
IDCSARC0 EQU   0                                                        08515000
IDCSARV0 EQU   0                                                        08516000
IDCSASC0 EQU   0                                                        08517000
IDCSASI0 EQU   0                                                        08518000
IDCSASN0 EQU   0                                                        08519000
IDCSASS0 EQU   0                                                        08520000
IDCSAST0 EQU   0                                                        08521000
IDCSATI0 EQU   0                                                        08522000
IDCSAUC0 EQU   0                                                        08523000
IDCSAWO0 EQU   0                                                        08524000
IDCSA060 EQU   0                                                        08525000
IDCST010 EQU   0                                                        08526000
IDCTPER0 EQU   0                                                        08527000
IKEBC    EQU   0                                                        08528000
IKEBF15  EQU   0                                                        08529000
IKEBF31  EQU   0                                                        08530000
IKEBP15  EQU   0                                                        08531000
IKEBP31  EQU   0                                                        08532000
IKEBP8   EQU   0                                                        08533000
LISTTEST EQU   0                                                        08534000
NEWERID1 EQU   5                                                        08535000
GDTTBLX  EQU   0                                                        08536000
FDTADDR  EQU   0                                                        08537000
SPACEID  EQU   0                                                        08538000
MAXCC    EQU   0                                                        08539000
LASTCC   EQU   0                                                        08540000
FSRNAME  EQU   0                                                        08541000
ERRORID  EQU   0                                                        08542000
ERRORPCL EQU   0                                                        08543000
ID1      EQU   0                                                        08544000
ID2      EQU   0                                                        08545000
DFLTPARM EQU   0                                                        08546000
ERRKWDID EQU   0                                                        08547000
FLDPTR   EQU   0                                                        08548000
CVTS01   EQU   CVTPGSIA                                                 08549000
CVTLPDIA EQU   CVTS01+12                                                08550000
CVTDIRST EQU   CVTLPDIA                                                 08551000
CVTSLIDA EQU   CVTS01+24                                                08552000
CVTCTLFG EQU   CVTS01+50                                                08553000
CVTPARS  EQU   CVTS01+176                                               08554000
CVTRV210 EQU   CVTS01+424                                               08555000
CVTRV219 EQU   CVTS01+425                                               08556000
CVTRV228 EQU   CVTS01+426                                               08557000
CVTRV237 EQU   CVTS01+427                                               08558000
CVTMFRTR EQU   CVTS01+452                                               08559000
CVTRV262 EQU   CVTS01+468                                               08560000
CVTRV271 EQU   CVTS01+469                                               08561000
CVTRV280 EQU   CVTS01+470                                               08562000
CVTRV289 EQU   CVTS01+471                                               08563000
CVTGSDA  EQU   CVTS01+600                                               08564000
ECTPTR   EQU   GDTECT                                                   08565000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    08566000
CVTRV628 EQU   CVTS01+728                                               08567000
CVTRV627 EQU   CVTS01+724                                               08568000
CVTRV626 EQU   CVTS01+720                                               08569000
CVTRV625 EQU   CVTS01+716                                               08570000
CVTRV624 EQU   CVTS01+712                                               08571000
CVTRV623 EQU   CVTS01+708                                               08572000
CVTRV622 EQU   CVTS01+704                                               08573000
CVTRV621 EQU   CVTS01+700                                               08574000
CVTIHASU EQU   CVTS01+696                                               08575000
CVTSUSP  EQU   CVTS01+692                                               08576000
CVTT6SVC EQU   CVTS01+688                                               08577000
CVTCDAL  EQU   CVTS01+684                                               08578000
CVTTCTL  EQU   CVTS01+680                                               08579000
CVTRSUME EQU   CVTS01+676                                               08580000
CVTJTERM EQU   CVTS01+672                                               08581000
CVTASMRM EQU   CVTS01+668                                               08582000
CVTTCASP EQU   CVTS01+664                                               08583000
CVT0PT03 EQU   CVTS01+660                                               08584000
CVT0PT0E EQU   CVTS01+656                                               08585000
CVTRV609 EQU   CVTS01+652                                               08586000
CVTCGK   EQU   CVTS01+648                                               08587000
CVTRAC   EQU   CVTS01+644                                               08588000
CVTRV606 EQU   CVTS01+640                                               08589000
CVTRV605 EQU   CVTS01+636                                               08590000
CVTRV604 EQU   CVTS01+632                                               08591000
CVTEFF02 EQU   CVTS01+628                                               08592000
CVTCBBR  EQU   CVTS01+624                                               08593000
CVTSSCR  EQU   CVTS01+620                                               08594000
CVTEVENT EQU   CVTS01+616                                               08595000
CVTCRCA  EQU   CVTS01+612                                               08596000
CVTTPIO  EQU   CVTS01+608                                               08597000
CVTADV   EQU   CVTS01+604                                               08598000
CVTGSDAB EQU   CVTGSDA                                                  08599000
CVTQV3   EQU   CVTS01+596                                               08600000
CVTQV2   EQU   CVTS01+592                                               08601000
CVTQV1   EQU   CVTS01+588                                               08602000
CVTRPT   EQU   CVTS01+584                                               08603000
CVTSSRB  EQU   CVTS01+580                                               08604000
CVTCSDRL EQU   CVTS01+576                                               08605000
CVTEXP1  EQU   CVTS01+572                                               08606000
CVTRMPMT EQU   CVTS01+568                                               08607000
CVTRMPTT EQU   CVTS01+564                                               08608000
CVTVPSA  EQU   CVTS01+560                                               08609000
CVTVSTOP EQU   CVTS01+556                                               08610000
CVTGTFR8 EQU   CVTS01+552                                               08611000
CVTQUIT  EQU   CVTS01+548                                               08612000
CVTVACR  EQU   CVTS01+544                                               08613000
CVTWTCB  EQU   CVTS01+540                                               08614000
CVTSTPRS EQU   CVTS01+536                                               08615000
CVT0PT02 EQU   CVTS01+532                                               08616000
CVTDARCM EQU   CVTS01+528                                               08617000
CVTIRECM EQU   CVTS01+524                                               08618000
CVTJRECM EQU   CVTS01+520                                               08619000
CVTVEMS0 EQU   CVTS01+516                                               08620000
CVTSPFRR EQU   CVTS01+512                                               08621000
CVTRLSTG EQU   CVTS01+508                                               08622000
CVT0TC0A EQU   CVTS01+504                                               08623000
CVTGMBR  EQU   CVTS01+500                                               08624000
CVTLFRM  EQU   CVTS01+496                                               08625000
CVTRMBR  EQU   CVTS01+492                                               08626000
CVTVIOP  EQU   CVTS01+488                                               08627000
CVTRV307 EQU   CVTS01+486                                               08628000
CVTRV306 EQU   CVTS01+484                                               08629000
CVTRV305 EQU   CVTS01+482                                               08630000
CVTRV304 EQU   CVTS01+480                                               08631000
CVTRV303 EQU   CVTS01+478                                               08632000
CVTRV302 EQU   CVTS01+476                                               08633000
CVTTRCA  EQU   CVTS01+472                                               08634000
CVTRV297 EQU   CVTRV289                                                 08635000
CVTRV296 EQU   CVTRV289                                                 08636000
CVTRV295 EQU   CVTRV289                                                 08637000
CVTRV294 EQU   CVTRV289                                                 08638000
CVTRV293 EQU   CVTRV289                                                 08639000
CVTRV292 EQU   CVTRV289                                                 08640000
CVTRV291 EQU   CVTRV289                                                 08641000
CVTRV290 EQU   CVTRV289                                                 08642000
CVTRV288 EQU   CVTRV280                                                 08643000
CVTRV287 EQU   CVTRV280                                                 08644000
CVTRV286 EQU   CVTRV280                                                 08645000
CVTRV285 EQU   CVTRV280                                                 08646000
CVTRV284 EQU   CVTRV280                                                 08647000
CVTRV283 EQU   CVTRV280                                                 08648000
CVTRV282 EQU   CVTRV280                                                 08649000
CVTRV281 EQU   CVTRV280                                                 08650000
CVTRV279 EQU   CVTRV271                                                 08651000
CVTRV278 EQU   CVTRV271                                                 08652000
CVTRV277 EQU   CVTRV271                                                 08653000
CVTRV276 EQU   CVTRV271                                                 08654000
CVTRV275 EQU   CVTRV271                                                 08655000
CVTRV274 EQU   CVTRV271                                                 08656000
CVTRV273 EQU   CVTRV271                                                 08657000
CVTRV272 EQU   CVTRV271                                                 08658000
CVTRV270 EQU   CVTRV262                                                 08659000
CVTRV269 EQU   CVTRV262                                                 08660000
CVTRV268 EQU   CVTRV262                                                 08661000
CVTRV267 EQU   CVTRV262                                                 08662000
CVTRV266 EQU   CVTRV262                                                 08663000
CVTRV265 EQU   CVTRV262                                                 08664000
CVTRV264 EQU   CVTRV262                                                 08665000
CVTRV263 EQU   CVTRV262                                                 08666000
CVTVFP   EQU   CVTS01+464                                               08667000
CVTVSI   EQU   CVTS01+460                                               08668000
CVTVPSIB EQU   CVTS01+456                                               08669000
CVTMFACT EQU   CVTMFRTR                                                 08670000
CVTMFCTL EQU   CVTS01+448                                               08671000
CVTPVBP  EQU   CVTS01+444                                               08672000
CVTPWI   EQU   CVTS01+440                                               08673000
CVTRV254 EQU   CVTS01+438                                               08674000
CVTRV253 EQU   CVTS01+436                                               08675000
CVTRV252 EQU   CVTS01+434                                               08676000
CVTRV251 EQU   CVTS01+433                                               08677000
CVTRV250 EQU   CVTS01+432                                               08678000
CVTRV249 EQU   CVTS01+431                                               08679000
CVTRV248 EQU   CVTS01+430                                               08680000
CVTRV247 EQU   CVTS01+429                                               08681000
CVTRV246 EQU   CVTS01+428                                               08682000
CVTRV245 EQU   CVTRV237                                                 08683000
CVTRV244 EQU   CVTRV237                                                 08684000
CVTRV243 EQU   CVTRV237                                                 08685000
CVTRV242 EQU   CVTRV237                                                 08686000
CVTRV241 EQU   CVTRV237                                                 08687000
CVTRV240 EQU   CVTRV237                                                 08688000
CVTRV239 EQU   CVTRV237                                                 08689000
CVTRV238 EQU   CVTRV237                                                 08690000
CVTRV236 EQU   CVTRV228                                                 08691000
CVTRV235 EQU   CVTRV228                                                 08692000
CVTRV234 EQU   CVTRV228                                                 08693000
CVTRV233 EQU   CVTRV228                                                 08694000
CVTRV232 EQU   CVTRV228                                                 08695000
CVTRV231 EQU   CVTRV228                                                 08696000
CVTRV230 EQU   CVTRV228                                                 08697000
CVTRV229 EQU   CVTRV228                                                 08698000
CVTRV227 EQU   CVTRV219                                                 08699000
CVTRV226 EQU   CVTRV219                                                 08700000
CVTRV225 EQU   CVTRV219                                                 08701000
CVTRV224 EQU   CVTRV219                                                 08702000
CVTRV223 EQU   CVTRV219                                                 08703000
CVTRV222 EQU   CVTRV219                                                 08704000
CVTRV221 EQU   CVTRV219                                                 08705000
CVTRV220 EQU   CVTRV219                                                 08706000
CVTRV218 EQU   CVTRV210                                                 08707000
CVTRV217 EQU   CVTRV210                                                 08708000
CVTRV216 EQU   CVTRV210                                                 08709000
CVTRV215 EQU   CVTRV210                                                 08710000
CVTRV214 EQU   CVTRV210                                                 08711000
CVTRV213 EQU   CVTRV210                                                 08712000
CVTRV212 EQU   CVTRV210                                                 08713000
CVTRV211 EQU   CVTRV210                                                 08714000
CVTLCCAT EQU   CVTS01+420                                               08715000
CVTPCCAT EQU   CVTS01+416                                               08716000
CVTIPCRP EQU   CVTS01+412                                               08717000
CVTIPCRI EQU   CVTS01+408                                               08718000
CVTIPCDS EQU   CVTS01+404                                               08719000
CVTAIDVT EQU   CVTS01+400                                               08720000
CVTSSAP  EQU   CVTS01+396                                               08721000
CVTEHCIR EQU   CVTS01+392                                               08722000
CVTEHDEF EQU   CVTS01+388                                               08723000
CVTDAIR  EQU   CVTS01+384                                               08724000
CVTPERFM EQU   CVTS01+380                                               08725000
CVT044R2 EQU   CVTS01+376                                               08726000
CVTFETCH EQU   CVTS01+372                                               08727000
CVTRSTWD EQU   CVTS01+368                                               08728000
CVTSPOST EQU   CVTS01+364                                               08729000
CVTIOBP  EQU   CVTS01+360                                               08730000
CVTASMVT EQU   CVTS01+356                                               08731000
CVTRECRQ EQU   CVTS01+352                                               08732000
CVTWSAC  EQU   CVTS01+348                                               08733000
CVTRV149 EQU   CVTS01+344                                               08734000
CVTWSAL  EQU   CVTS01+340                                               08735000
CVTSPSA  EQU   CVTS01+336                                               08736000
CVTGLMN  EQU   CVTS01+332                                               08737000
CVTVEAC0 EQU   CVTS01+328                                               08738000
CVT062R1 EQU   CVTS01+324                                               08739000
CVTRPOST EQU   CVTS01+320                                               08740000
CVTDQIQE EQU   CVTS01+316                                               08741000
CVTCSD   EQU   CVTS01+312                                               08742000
CVTLKRMA EQU   CVTS01+308                                               08743000
CVTRSPIE EQU   CVTS01+304                                               08744000
CVTRENQ  EQU   CVTS01+300                                               08745000
CVTLQCB  EQU   CVTS01+296                                               08746000
CVTFQCB  EQU   CVTS01+292                                               08747000
CVTQCS01 EQU   CVTS01+288                                               08748000
CVTAPFT  EQU   CVTS01+284                                               08749000
CVTPARRL EQU   CVTS01+280                                               08750000
CVTVWAIT EQU   CVTS01+276                                               08751000
CVTGSPL  EQU   CVTS01+272                                               08752000
CVTLSMQ  EQU   CVTS01+268                                               08753000
CVTGSMQ  EQU   CVTS01+264                                               08754000
CVTEXPRO EQU   CVTS01+260                                               08755000
CVTOPCTP EQU   CVTS01+256                                               08756000
CVTSIC   EQU   CVTS01+252                                               08757000
CVTTPIOS EQU   CVTS01+248                                               08758000
CVTRTMS  EQU   CVTS01+244                                               08759000
CVTSDBF  EQU   CVTS01+240                                               08760000
CVTSCBP  EQU   CVTS01+236                                               08761000
CVTSDMP  EQU   CVTS01+232                                               08762000
CVTSV60  EQU   CVTS01+228                                               08763000
CVTRTMCT EQU   CVTS01+224                                               08764000
CVTASCBL EQU   CVTS01+220                                               08765000
CVTASCBH EQU   CVTS01+216                                               08766000
CVTGDA   EQU   CVTS01+212                                               08767000
CVTASVT  EQU   CVTS01+208                                               08768000
CVTVVMDI EQU   CVTS01+204                                               08769000
CVTAQTOP EQU   CVTS01+200                                               08770000
CVTIOSCS EQU   CVTS01+196                                               08771000
CVTSDRM  EQU   CVTS01+192                                               08772000
CVTOPTE  EQU   CVTS01+188                                               08773000
CVTSTXU  EQU   CVTS01+184                                               08774000
CVTQUIS  EQU   CVTS01+180                                               08775000
CVTS1EE  EQU   CVTS01+172                                               08776000
CVTFRAS  EQU   CVTS01+168                                               08777000
CVTQSAS  EQU   CVTS01+164                                               08778000
CVTCRAS  EQU   CVTS01+160                                               08779000
CVTCRMN  EQU   CVTS01+156                                               08780000
CVTDELCP EQU   CVTS01+152                                               08781000
CVTFRECL EQU   CVTS01+148                                               08782000
CVTGETCL EQU   CVTS01+144                                               08783000
CVTBLDCP EQU   CVTS01+140                                               08784000
CVTAUTHL EQU   CVTS01+136                                               08785000
CVTSCAN  EQU   CVTS01+132                                               08786000
CVTRV144 EQU   CVTS01+130                                               08787000
CVTMAXMP EQU   CVTS01+128                                               08788000
CVTSTCK  EQU   CVTS01+124                                               08789000
CVTRV139 EQU   CVTS01+123                                               08790000
CVTDSSAC EQU   CVTS01+122                                               08791000
CVTRV513 EQU   CVTS01+121                                               08792000
CVTIOSPL EQU   CVTS01+120                                               08793000
CVTPTGT  EQU   CVTS01+116                                               08794000
CVTCSPIE EQU   CVTS01+112                                               08795000
CVTSMFEX EQU   CVTS01+108                                               08796000
CVTOLT0A EQU   CVTS01+104                                               08797000
CVTSRBRT EQU   CVTS01+100                                               08798000
CVTPUTL  EQU   CVTS01+96                                                08799000
CVTASCRL EQU   CVTS01+92                                                08800000
CVTASCRF EQU   CVTS01+88                                                08801000
CVTRV326 EQU   CVTS01+84                                                08802000
CVTRV325 EQU   CVTS01+80                                                08803000
CVTRV324 EQU   CVTS01+76                                                08804000
CVT0VL01 EQU   CVTS01+72                                                08805000
CVTSHRVM EQU   CVTS01+68                                                08806000
CVTRV332 EQU   CVTS01+64                                                08807000
CVTTAS   EQU   CVTS01+60                                                08808000
CVTRSCN  EQU   CVTS01+56                                                08809000
CVTTRAC2 EQU   CVTS01+54                                                08810000
CVTTRACE EQU   CVTS01+52                                                08811000
CVTAPG   EQU   CVTS01+51                                                08812000
CVTSDTRC EQU   CVTCTLFG                                                 08813000
CVTGTRCE EQU   CVTCTLFG                                                 08814000
CVTNOMP  EQU   CVTCTLFG                                                 08815000
CVTRSV79 EQU   CVTCTLFG                                                 08816000
CVTDSTAT EQU   CVTCTLFG                                                 08817000
CVTRSV78 EQU   CVTCTLFG                                                 08818000
CVTRV333 EQU   CVTCTLFG                                                 08819000
CVTRV323 EQU   CVTCTLFG                                                 08820000
CVTSPVLK EQU   CVTS01+49                                                08821000
CVTRSV77 EQU   CVTS01+48                                                08822000
CVTRV331 EQU   CVTS01+44                                                08823000
CVTRV330 EQU   CVTS01+40                                                08824000
CVTRV329 EQU   CVTS01+36                                                08825000
CVTRV328 EQU   CVTS01+32                                                08826000
CVTRV322 EQU   CVTS01+28                                                08827000
CVTSLID  EQU   CVTSLIDA+1                                               08828000
CVTSYLK  EQU   CVTSLIDA                                                 08829000
CVTRV321 EQU   CVTS01+20                                                08830000
CVTRV320 EQU   CVTS01+16                                                08831000
CVTLPDIR EQU   CVTLPDIA+1                                               08832000
CVTRSV69 EQU   CVTDIRST                                                 08833000
CVTRSV68 EQU   CVTDIRST                                                 08834000
CVTRSV67 EQU   CVTDIRST                                                 08835000
CVTRSV66 EQU   CVTDIRST                                                 08836000
CVTRSV65 EQU   CVTDIRST                                                 08837000
CVTRSV64 EQU   CVTDIRST                                                 08838000
CVTRSV63 EQU   CVTDIRST                                                 08839000
CVTDICOM EQU   CVTDIRST                                                 08840000
CVTPVTP  EQU   CVTS01+8                                                 08841000
CVTLPDSR EQU   CVTS01+4                                                 08842000
CVTGETL  EQU   CVTS01                                                   08843000
@NM00075 EQU   DSNSTRCT+10                                              08844000
@NM00072 EQU   PDE2+23                                                  08845000
@NM00071 EQU   PDE2+22                                                  08846000
@NM00070 EQU   PDE2+15                                                  08847000
@NM00069 EQU   PDE2+14                                                  08848000
@NM00068 EQU   PDE2+7                                                   08849000
@NM00067 EQU   PDE2+6                                                   08850000
@NM00066 EQU   PDE1+7                                                   08851000
@NM00065 EQU   PDE1+6                                                   08852000
CONSTIN  EQU   PDE1+6                                                   08853000
POFFSET  EQU   CBUFF+2                                                  08854000
@NM00058 EQU   ECT+52                                                   08855000
@NM00057 EQU   ECT+48                                                   08856000
@NM00056 EQU   ECT+44                                                   08857000
@NM00055 EQU   ECTSWS2+1                                                08858000
@NM00054 EQU   ECTSWS21                                                 08859000
ECTTABND EQU   ECTSWS21                                                 08860000
ECTDEFCS EQU   ECTSWS21                                                 08861000
ECTBKPB  EQU   ECT+36                                                   08862000
ECTUSER  EQU   ECT+32                                                   08863000
ECTDDNUM EQU   ECT+29                                                   08864000
ECTATTN  EQU   ECTSWS                                                   08865000
ECTBKGRD EQU   ECTSWS                                                   08866000
ECTNNOT  EQU   ECTSWS                                                   08867000
ECTNMAL  EQU   ECTSWS                                                   08868000
ECTLOGF  EQU   ECTSWS                                                   08869000
ECTATRM  EQU   ECTSWS                                                   08870000
@NM00053 EQU   ECTSWS                                                   08871000
ECTSCMD  EQU   ECT+20                                                   08872000
ECTSMSG  EQU   ECT+9                                                    08873000
ECTMSGF  EQU   ECT+8                                                    08874000
ECTIOWA  EQU   ECT+4                                                    08875000
ECTRTCD  EQU   ECT+1                                                    08876000
ECTRCDF  EQU   ECT                                                      08877000
@NM00052 EQU   RSI+9                                                    08878000
@NM00051 EQU   PARMINFO+11                                              08879000
@NM00041 EQU   DSCRPTR2+11                                              08880000
@NM00040 EQU   DSCRPTR2+10                                              08881000
@NM00039 EQU   PARMDATA+11                                              08882000
SCALAR   EQU   PARMDATA+11                                              08883000
LEVEL1   EQU   PARMDATA+11                                              08884000
@NM00038 EQU   PARMDATA+10                                              08885000
VPOSID   EQU   @NM00034+2                                               08886000
VPOSCNT  EQU   @NM00034                                                 08887000
DESCID   EQU   VERBDATA                                                 08888000
CVTLEVL  EQU   CVTRELNO+2                                               08889000
CVTNUMB  EQU   CVTRELNO                                                 08890000
CVTMDL   EQU   CVTFIX+250                                               08891000
@NM00033 EQU   CVTFIX+248                                               08892000
@NM00032 EQU   CVTFIX                                                   08893000
CVTRV482 EQU   CVTXTNT2+128                                             08894000
CVTRV481 EQU   CVTXTNT2+124                                             08895000
CVTRV480 EQU   CVTXTNT2+120                                             08896000
CVTRV479 EQU   CVTXTNT2+118                                             08897000
CVTRV478 EQU   CVTXTNT2+117                                             08898000
CVTRV477 EQU   CVTXTNT2+116                                             08899000
CVTRV476 EQU   CVTXTNT2+115                                             08900000
CVTRV475 EQU   CVTXTNT2+114                                             08901000
CVTRV474 EQU   CVTRV466                                                 08902000
CVTRV473 EQU   CVTRV466                                                 08903000
CVTRV472 EQU   CVTRV466                                                 08904000
CVTRV471 EQU   CVTRV466                                                 08905000
CVTRV470 EQU   CVTRV466                                                 08906000
CVTRV469 EQU   CVTRV466                                                 08907000
CVTRV468 EQU   CVTRV466                                                 08908000
CVTRV467 EQU   CVTRV466                                                 08909000
CVTRV465 EQU   CVTRV457                                                 08910000
CVTRV464 EQU   CVTRV457                                                 08911000
CVTRV463 EQU   CVTRV457                                                 08912000
CVTRV462 EQU   CVTRV457                                                 08913000
CVTRV461 EQU   CVTRV457                                                 08914000
CVTRV460 EQU   CVTRV457                                                 08915000
CVTRV459 EQU   CVTRV457                                                 08916000
CVTRV458 EQU   CVTRV457                                                 08917000
CVTRV456 EQU   CVTXTNT2+108                                             08918000
CVTRV455 EQU   CVTXTNT2+104                                             08919000
CVTRV454 EQU   CVTXTNT2+100                                             08920000
CVTRV453 EQU   CVTXTNT2+96                                              08921000
CVTRV452 EQU   CVTXTNT2+94                                              08922000
CVTRV451 EQU   CVTXTNT2+92                                              08923000
CVTRV450 EQU   CVTXTNT2+90                                              08924000
CVTRV449 EQU   CVTXTNT2+88                                              08925000
CVTRV448 EQU   CVTXTNT2+87                                              08926000
CVTRV447 EQU   CVTXTNT2+86                                              08927000
CVTRV446 EQU   CVTRV438                                                 08928000
CVTRV445 EQU   CVTRV438                                                 08929000
CVTRV444 EQU   CVTRV438                                                 08930000
CVTRV443 EQU   CVTRV438                                                 08931000
CVTRV442 EQU   CVTRV438                                                 08932000
CVTRV441 EQU   CVTRV438                                                 08933000
CVTRV440 EQU   CVTRV438                                                 08934000
CVTRV439 EQU   CVTRV438                                                 08935000
CVTRV437 EQU   CVTRV429                                                 08936000
CVTRV436 EQU   CVTRV429                                                 08937000
CVTRV435 EQU   CVTRV429                                                 08938000
CVTRV434 EQU   CVTRV429                                                 08939000
CVTRV433 EQU   CVTRV429                                                 08940000
CVTRV432 EQU   CVTRV429                                                 08941000
CVTRV431 EQU   CVTRV429                                                 08942000
CVTRV430 EQU   CVTRV429                                                 08943000
CVTRV428 EQU   CVTXTNT2+80                                              08944000
CVTRV427 EQU   CVTXTNT2+76                                              08945000
CVTRV426 EQU   CVTXTNT2+72                                              08946000
CVTRV425 EQU   CVTXTNT2+68                                              08947000
CVTATACT EQU   CVTATCVT                                                 08948000
CVTRV423 EQU   CVTXTNT2+62                                              08949000
CVTRV422 EQU   CVTXTNT2+60                                              08950000
CVTRV421 EQU   CVTXTNT2+58                                              08951000
CVTRV420 EQU   CVTXTNT2+56                                              08952000
CVTRV419 EQU   CVTXTNT2+55                                              08953000
CVTRV418 EQU   CVTXTNT2+54                                              08954000
CVTRV417 EQU   CVTRV409                                                 08955000
CVTRV416 EQU   CVTRV409                                                 08956000
CVTRV415 EQU   CVTRV409                                                 08957000
CVTRV414 EQU   CVTRV409                                                 08958000
CVTRV413 EQU   CVTRV409                                                 08959000
CVTRV412 EQU   CVTRV409                                                 08960000
CVTRV411 EQU   CVTRV409                                                 08961000
CVTRV410 EQU   CVTRV409                                                 08962000
CVTRV408 EQU   CVTRV400                                                 08963000
CVTRV407 EQU   CVTRV400                                                 08964000
CVTRV406 EQU   CVTRV400                                                 08965000
CVTRV405 EQU   CVTRV400                                                 08966000
CVTRV404 EQU   CVTRV400                                                 08967000
CVTRV403 EQU   CVTRV400                                                 08968000
CVTRV402 EQU   CVTRV400                                                 08969000
CVTRV401 EQU   CVTRV400                                                 08970000
CVTICB   EQU   CVTXTNT2+48                                              08971000
CVTSKTA  EQU   CVTXTNT2+44                                              08972000
CVTRSV99 EQU   CVTXTNT2+40                                              08973000
CVTRSV98 EQU   CVTXTNT2+36                                              08974000
CVTRSV97 EQU   CVTXTNT2+34                                              08975000
CVTRSV96 EQU   CVTXTNT2+32                                              08976000
CVTOLTEP EQU   CVTXTNT2+28                                              08977000
CVTQIDA  EQU   CVTQID+1                                                 08978000
CVTRSV95 EQU   CVTQID                                                   08979000
CVTRSV94 EQU   CVTXTNT2+20                                              08980000
CVTRSV93 EQU   CVTXTNT2+16                                              08981000
CVTRSV92 EQU   CVTXTNT2+12                                              08982000
CVTDEBVR EQU   CVTXTNT2+8                                               08983000
CVTRSV91 EQU   CVTXTNT2+6                                               08984000
CVTRSV9H EQU   CVTFLGBT                                                 08985000
CVTRSV9G EQU   CVTFLGBT                                                 08986000
CVTRSV9F EQU   CVTFLGBT                                                 08987000
CVTRSV9E EQU   CVTFLGBT                                                 08988000
CVTRSV9D EQU   CVTFLGBT                                                 08989000
CVTRSV9C EQU   CVTFLGBT                                                 08990000
CVTVME   EQU   CVTFLGBT                                                 08991000
CVTNPE   EQU   CVTFLGBT                                                 08992000
CVTNUCLS EQU   CVTXTNT2+4                                               08993000
CVTDSSVA EQU   CVTDSSV+1                                                08994000
CVTRSV89 EQU   CVTDSSV                                                  08995000
CVTRSV88 EQU   CVTXTNT1+8                                               08996000
CVTRSV87 EQU   CVTXTNT1+4                                               08997000
CVTFACHN EQU   CVTXTNT1                                                 08998000
CVTRV488 EQU   CVTMAP+412                                               08999000
CVTRV487 EQU   CVTMAP+408                                               09000000
CVTRV486 EQU   CVTMAP+404                                               09001000
CVTRV485 EQU   CVTMAP+400                                               09002000
CVTACTAP EQU   CVTMAP+396                                               09003000
CVTAUTH  EQU   CVTMAP+392                                               09004000
CVTATMCA EQU   CVTATMCT+1                                               09005000
CVTATMST EQU   CVTATMCT                                                 09006000
CVTRSV61 EQU   CVTMAP+384                                               09007000
CVTVOLT1 EQU   CVTVOLM1+1                                               09008000
CVTVOLI1 EQU   CVTVOLF1                                                 09009000
CVTSTOA  EQU   CVTMAP+376                                               09010000
CVTRSV58 EQU   CVTMAP+374                                               09011000
CVTRSV57 EQU   CVTMAP+372                                               09012000
CVTDDCE  EQU   CVTMAP+368                                               09013000
CVTPNWFR EQU   CVTMAP+364                                               09014000
CVTSMF   EQU   CVTMAP+360                                               09015000
CVTSULK  EQU   CVTMAP+358                                               09016000
CVTSLKO  EQU   CVTSYSK                                                  09017000
CVTSLKP  EQU   CVTSYSK                                                  09018000
CVTSLKQ  EQU   CVTSYSK                                                  09019000
CVTSLKR  EQU   CVTSYSK                                                  09020000
CVTRSV56 EQU   CVTSYSK                                                  09021000
CVTRSV55 EQU   CVTSYSK                                                  09022000
CVTRSV54 EQU   CVTSYSK                                                  09023000
CVTRSV53 EQU   CVTSYSK                                                  09024000
CVTRSV52 EQU   CVTA1F1                                                  09025000
CVTRSV51 EQU   CVTA1F1                                                  09026000
CVTRSV50 EQU   CVTA1F1                                                  09027000
CVTRSV49 EQU   CVTA1F1                                                  09028000
CVTRSV48 EQU   CVTA1F1                                                  09029000
CVTRSV47 EQU   CVTA1F1                                                  09030000
CVTSRSW  EQU   CVTA1F1                                                  09031000
CVTPFSW  EQU   CVTA1F1                                                  09032000
CVTPCVT  EQU   CVTMAP+352                                               09033000
CVTRSV46 EQU   CVTMAP+344                                               09034000
CVTRSV45 EQU   CVTMAP+340                                               09035000
CVTRSV44 EQU   CVTMAP+338                                               09036000
CVTRSV43 EQU   CVTMAP+336                                               09037000
CVTHJESA EQU   CVTHJES+1                                                09038000
CVTRSV42 EQU   CVTHJES                                                  09039000
CVTEXT2A EQU   CVTEXT2+1                                                09040000
CVTRSV41 EQU   CVTEXT2                                                  09041000
CVTAPFA  EQU   CVTAPF+1                                                 09042000
CVTRSV40 EQU   CVTAPF                                                   09043000
CVTRV518 EQU   CVTINTLA                                                 09044000
CVTRV517 EQU   CVTERPV                                                  09045000
CVTEORM  EQU   CVTMAP+312                                               09046000
CVTMCHPR EQU   CVTMAP+308                                               09047000
CVTTZ    EQU   CVTMAP+304                                               09048000
CVTJEPS  EQU   CVTMAP+300                                               09049000
CVTJESCT EQU   CVTMAP+296                                               09050000
CVTMODE  EQU   CVTMAP+292                                               09051000
CVTPTRV  EQU   CVTMAP+288                                               09052000
CVTREAL  EQU   CVTMAP+284                                               09053000
CVTRSV39 EQU   CVTMAP+280                                               09054000
CVTRSV38 EQU   CVTMAP+276                                               09055000
CVTDMSRA EQU   CVTDMSR+1                                                09056000
CVTRV634 EQU   CVTDMSRF                                                 09057000
CVTRV633 EQU   CVTDMSRF                                                 09058000
CVTRV632 EQU   CVTDMSRF                                                 09059000
CVTRV631 EQU   CVTDMSRF                                                 09060000
CVTRV630 EQU   CVTDMSRF                                                 09061000
CVTRV629 EQU   CVTDMSRF                                                 09062000
CVTUDUMP EQU   CVTDMSRF                                                 09063000
CVTSDUMP EQU   CVTDMSRF                                                 09064000
CVTQMSGA EQU   CVTQMSG+1                                                09065000
CVTRSV36 EQU   CVTQMSG                                                  09066000
CVTAMFF  EQU   CVTMAP+264                                               09067000
CVTPURGA EQU   CVTPURG+1                                                09068000
CVTRSV35 EQU   CVTPURG                                                  09069000
CVTCBSP  EQU   CVTMAP+256                                               09070000
CVTATERA EQU   CVTATER+1                                                09071000
CVTSYST  EQU   CVTATER                                                  09072000
CVTVOLT2 EQU   CVTTAT                                                   09073000
CVTVOLI2 EQU   CVTVOLF2                                                 09074000
CVTAQAVB EQU   CVTAQAVT+1                                               09075000
CVTRSV34 EQU   CVTTCMFG                                                 09076000
CVTRSV33 EQU   CVTTCMFG                                                 09077000
CVTRSV32 EQU   CVTTCMFG                                                 09078000
CVTRSV31 EQU   CVTTCMFG                                                 09079000
CVTRSV30 EQU   CVTTCMFG                                                 09080000
CVTRSV29 EQU   CVTTCMFG                                                 09081000
CVTRSV28 EQU   CVTTCMFG                                                 09082000
CVTTCRDY EQU   CVTTCMFG                                                 09083000
CVTGTFA  EQU   CVTGTF+1                                                 09084000
CVTRSV27 EQU   CVTGTFST                                                 09085000
CVTRNIO  EQU   CVTGTFST                                                 09086000
CVTUSR   EQU   CVTGTFST                                                 09087000
CVTRV318 EQU   CVTFORM                                                  09088000
CVTRV317 EQU   CVTTMODE                                                 09089000
CVTRV316 EQU   CVTSTATE                                                 09090000
CVTRV315 EQU   CVTGTFS                                                  09091000
CVTGTFAV EQU   CVTGTFS                                                  09092000
CVT0SCR1 EQU   CVTMAP+232                                               09093000
CVTRV515 EQU   CVTMAP+228                                               09094000
CVTRMS   EQU   CVTMAP+224                                               09095000
CVTPATCH EQU   CVTMAP+220                                               09096000
CVTTSCE  EQU   CVTMAP+216                                               09097000
CVTLNKSC EQU   CVTMAP+214                                               09098000
CVTQABST EQU   CVTMAP+212                                               09099000
CVTMDLDS EQU   CVTMAP+208                                               09100000
CVTUSER  EQU   CVTMAP+204                                               09101000
CVTABEND EQU   CVTMAP+200                                               09102000
CVTSMCA  EQU   CVTMAP+196                                               09103000
CVTRSV18 EQU   CVTMAP+192                                               09104000
CVTQLPAQ EQU   CVTMAP+188                                               09105000
CVTQCDSR EQU   CVTMAP+184                                               09106000
CVTRSV17 EQU   CVTOPTB                                                  09107000
CVTRSV16 EQU   CVTOPTB                                                  09108000
CVTFP    EQU   CVTOPTB                                                  09109000
CVTAPTHR EQU   CVTOPTB                                                  09110000
CVTNLOG  EQU   CVTOPTB                                                  09111000
CVTTOD   EQU   CVTOPTB                                                  09112000
CVTCTIMS EQU   CVTOPTB                                                  09113000
CVTPROT  EQU   CVTOPTB                                                  09114000
CVTXPFP  EQU   CVTOPTA                                                  09115000
CVTASCII EQU   CVTOPTA                                                  09116000
CVTRSV13 EQU   CVTOPTA                                                  09117000
CVTRSV12 EQU   CVTOPTA                                                  09118000
CVTNIP   EQU   CVTOPTA                                                  09119000
CVTDDR   EQU   CVTOPTA                                                  09120000
CVTAPR   EQU   CVTOPTA                                                  09121000
CVTCCH   EQU   CVTOPTA                                                  09122000
CVTSNCTR EQU   CVTMAP+180                                               09123000
CVTQMWR  EQU   CVTMAP+176                                               09124000
CVTQOCR  EQU   CVTMAP+172                                               09125000
CVT1EF00 EQU   CVTMAP+168                                               09126000
CVTMZ00  EQU   CVTMAP+164                                               09127000
CVTHEAD  EQU   CVTMAP+160                                               09128000
CVTRSV11 EQU   CVTMAP+156                                               09129000
CVT0PT01 EQU   CVTMAP+152                                               09130000
CVTMSER  EQU   CVTMAP+148                                               09131000
CVTRV516 EQU   CVTIERLC                                                 09132000
CVTILCH  EQU   CVTMAP+140                                               09133000
CVT0DS   EQU   CVTMAP+136                                               09134000
CVTFBOSV EQU   CVTMAP+132                                               09135000
CVTNUCB  EQU   CVTMAP+128                                               09136000
CVTIXAVL EQU   CVTMAP+124                                               09137000
CVTIOQET EQU   CVTMAP+120                                               09138000
CVTDCBA  EQU   CVTMAP+117                                               09139000
CVTMVS2  EQU   CVTDCB                                                   09140000
CVT6DAT  EQU   CVTDCB                                                   09141000
CVT4MPS  EQU   CVTDCB                                                   09142000
CVTRSV09 EQU   CVTDCB                                                   09143000
CVT4MS1  EQU   CVTDCB                                                   09144000
CVT2SPS  EQU   CVTDCB                                                   09145000
CVT1SSS  EQU   CVTDCB                                                   09146000
CVTRSV08 EQU   CVTDCB                                                   09147000
CVTSTB   EQU   CVTMAP+112                                               09148000
CVTQTD00 EQU   CVTMAP+108                                               09149000
CVTQTE00 EQU   CVTMAP+104                                               09150000
CVTCUCB  EQU   CVTMAP+100                                               09151000
CVTSJQ   EQU   CVTMAP+96                                                09152000
CVTPBLDL EQU   CVTMAP+92                                                09153000
CVTTPC   EQU   CVTMAP+88                                                09154000
CVTSVDCB EQU   CVTMAP+84                                                09155000
CVTBRET  EQU   CVTMAP+82                                                09156000
CVTEXIT  EQU   CVTMAP+80                                                09157000
CVT0FN00 EQU   CVTMAP+76                                                09158000
CVTDARA  EQU   CVTDAR+1                                                 09159000
CVTRSV07 EQU   CVTFLGS1                                                 09160000
CVTRSV06 EQU   CVTFLGS1                                                 09161000
CVTRSV05 EQU   CVTFLGS1                                                 09162000
CVTRSV04 EQU   CVTFLGS1                                                 09163000
CVTRSV03 EQU   CVTFLGS1                                                 09164000
CVTRSV02 EQU   CVTFLGS1                                                 09165000
CVTRSV01 EQU   CVTFLGS1                                                 09166000
CVTDMPLK EQU   CVTFLGS1                                                 09167000
CVTXITP  EQU   CVTMAP+68                                                09168000
CVTZDTAB EQU   CVTMAP+64                                                09169000
CVTMSLT  EQU   CVTMAP+60                                                09170000
CVTDATE  EQU   CVTMAP+56                                                09171000
CVTBTERM EQU   CVTMAP+52                                                09172000
CVTSYSAD EQU   CVTMAP+48                                                09173000
CVTXTLER EQU   CVTMAP+44                                                09174000
CVTILK2  EQU   CVTMAP+40                                                09175000
CVTILK1  EQU   CVTMAP+36                                                09176000
CVTPRLTV EQU   CVTMAP+32                                                09177000
CVTPCNVT EQU   CVTMAP+28                                                09178000
CVT0VL00 EQU   CVTMAP+24                                                09179000
CVTXAPG  EQU   CVTMAP+20                                                09180000
CVTBUF   EQU   CVTMAP+16                                                09181000
CVTJOB   EQU   CVTMAP+12                                                09182000
CVTLINK  EQU   CVTMAP+8                                                 09183000
CVT0EF00 EQU   CVTMAP+4                                                 09184000
CVTTCBP  EQU   CVTMAP                                                   09185000
CVT      EQU   CVTMAP                                                   09186000
@NM00031 EQU   DMPARY+15                                                09187000
DMPARYTP EQU   DMPARY+14                                                09188000
DMPARYEX EQU   DMPARY+12                                                09189000
DMPARYIC EQU   DMPARY+10                                                09190000
DMPARYSZ EQU   DMPARY+8                                                 09191000
DMPARYNM EQU   DMPARY                                                   09192000
@NM00030 EQU   DMPITM+15                                                09193000
DMPITMTP EQU   DMPITM+14                                                09194000
DMPITMLN EQU   DMPITM+12                                                09195000
DMPITMPT EQU   DMPITM+8                                                 09196000
DMPITMNM EQU   DMPITM                                                   09197000
@NM00029 EQU   ERCNVTAB+24                                              09198000
ERDARBPT EQU   ERCPLPT                                                  09199000
ERDYNRC  EQU   ERCATRC                                                  09200000
ERDSNM   EQU   ERCNVTAB+12                                              09201000
@NM00028 EQU   ERCNVTAB+4                                               09202000
@NM00027 EQU   ERCNVTAB+3                                               09203000
@NM00026 EQU   EROSOPER                                                 09204000
EROSUCDX EQU   EROSOPER                                                 09205000
EROSCATL EQU   EROSOPER                                                 09206000
@NM00025 EQU   EROPER                                                   09207000
ERCATAL  EQU   EROPER                                                   09208000
ERCATDL  EQU   EROPER                                                   09209000
ERCATDE  EQU   EROPER                                                   09210000
ERCATLC  EQU   EROPER                                                   09211000
@NM00024 EQU   ERTYPE                                                   09212000
ERDYNAL  EQU   ERTYPE                                                   09213000
EROSCAT  EQU   ERTYPE                                                   09214000
ERCATLG  EQU   ERTYPE                                                   09215000
@NM00023 EQU   FMTCNVF+1                                                09216000
FMTAR    EQU   FMTCNVF+1                                                09217000
FMTBS    EQU   FMTCNVF+1                                                09218000
FMTSS    EQU   FMTCNVF+1                                                09219000
FMTAL    EQU   FMTCNVF+1                                                09220000
FMTZS    EQU   FMTCNVF+1                                                09221000
@NM00022 EQU   FMTCNVF                                                  09222000
FMTPU    EQU   FMTCNVF                                                  09223000
FMTBD    EQU   FMTCNVF                                                  09224000
FMTBHD   EQU   FMTCNVF                                                  09225000
FMTBHA   EQU   FMTCNVF                                                  09226000
FMTBH    EQU   FMTCNVF                                                  09227000
FMTOLEN  EQU   FMTLIST+8                                                09228000
FMTRIO   EQU   FMTOCOL                                                  09229000
FMTSPT   EQU   FMTSTO                                                   09230000
FMTSTL   EQU   FMTILEN                                                  09231000
@NM00021 EQU   FMTFLGS+1                                                09232000
FMTSMSG  EQU   FMTFLGS+1                                                09233000
FMTHDF   EQU   FMTFLGS                                                  09234000
FMTDFF   EQU   FMTFLGS                                                  09235000
FMTSTF   EQU   FMTFLGS                                                  09236000
FMTREPF  EQU   FMTFLGS                                                  09237000
FMTBDF   EQU   FMTFLGS                                                  09238000
FMTIDF   EQU   FMTFLGS                                                  09239000
FMTSCF   EQU   FMTFLGS                                                  09240000
FMTEOLF  EQU   FMTFLGS                                                  09241000
DARGDTM  EQU   DARGARY+4                                                09242000
DARGPCT  EQU   DARGINL                                                  09243000
DARGREP  EQU   DARGINS                                                  09244000
@NM00020 EQU   DARGLIST+19                                              09245000
DARGIND  EQU   DARGLIST+18                                              09246000
DARGCNT  EQU   DARGLIST+14                                              09247000
UVOLVOL  EQU   UVOLENT+4                                                09248000
UVOLDEV  EQU   UVOLENT                                                  09249000
UVOLCNT  EQU   UVOLLIST                                                 09250000
@NM00019 EQU   IOINFOPT                                                 09251000
IOINFLUB EQU   IOINFOPT                                                 09252000
IOINFTMS EQU   IOINFOPT                                                 09253000
IOINFSUP EQU   IOINFOPT                                                 09254000
IOINFDSN EQU   IOINFOPT                                                 09255000
IOINFVOL EQU   IOINFOPT                                                 09256000
IOINFDVT EQU   IOINFOPT                                                 09257000
OPNVOL   EQU   OPNAGL+44                                                09258000
OPNSTRNO EQU   OPNAGL+43                                                09259000
@NM00018 EQU   OPNOPT2                                                  09260000
OPNOPTJM EQU   OPNOPT2                                                  09261000
OPNOPTNM EQU   OPNOPT2                                                  09262000
OPNOPTAS EQU   OPNOPT2                                                  09263000
@NM00017 EQU   OPNDSO                                                   09264000
OPNDSOPO EQU   OPNDSO                                                   09265000
OPNDSOIS EQU   OPNDSO                                                   09266000
OPNDSOPS EQU   OPNDSO                                                   09267000
OPNDSOAM EQU   OPNDSO                                                   09268000
OPNKYL   EQU   OPNAGL+40                                                09269000
OPNBLK   EQU   OPNAGL+36                                                09270000
OPNREC   EQU   OPNAGL+32                                                09271000
OPNDEVIX EQU   OPNDEV+4                                                 09272000
OPNDEVDT EQU   OPNDEV                                                   09273000
OPNCBP   EQU   OPNAGL+20                                                09274000
OPNDSN   EQU   OPNAGL+16                                                09275000
OPNPWA   EQU   OPNAGL+12                                                09276000
OPNDDN   EQU   OPNAGL+8                                                 09277000
OPNIOC   EQU   OPNAGL+4                                                 09278000
OPNMODRP EQU   OPNMOD                                                   09279000
OPNMODUB EQU   OPNMOD                                                   09280000
OPNMODRS EQU   OPNMOD                                                   09281000
OPNMODAX EQU   OPNMOD                                                   09282000
OPNMODRR EQU   OPNMOD                                                   09283000
OPNMODRC EQU   OPNMOD                                                   09284000
OPNMODAC EQU   OPNMOD                                                   09285000
OPNMODPD EQU   OPNMOD                                                   09286000
OPNTYPSY EQU   OPNTYP                                                   09287000
OPNTYPRV EQU   OPNTYP                                                   09288000
OPNTYPEX EQU   OPNTYP                                                   09289000
OPNTYPRA EQU   OPNTYP                                                   09290000
OPNTYPXM EQU   OPNTYP                                                   09291000
OPNTYPCI EQU   OPNTYP                                                   09292000
OPNTYPSO EQU   OPNTYP                                                   09293000
OPNTYPSI EQU   OPNTYP                                                   09294000
@NM00016 EQU   OPNRFM                                                   09295000
OPNRFMBK EQU   OPNRFM                                                   09296000
OPNRFMSF EQU   OPNRFM                                                   09297000
OPNRFMUN EQU   OPNRFM                                                   09298000
OPNRFMVR EQU   OPNRFM                                                   09299000
OPNRFMFX EQU   OPNRFM                                                   09300000
OPNOPTSK EQU   OPNOPT                                                   09301000
OPNOPTDR EQU   OPNOPT                                                   09302000
OPNOPTCR EQU   OPNOPT                                                   09303000
OPNOPTKS EQU   OPNOPT                                                   09304000
OPNOPTBK EQU   OPNOPT                                                   09305000
OPNOPTUP EQU   OPNOPT                                                   09306000
OPNOPTOT EQU   OPNOPT                                                   09307000
OPNOPTIN EQU   OPNOPT                                                   09308000
IOCEXT   EQU   IOCSTR+64                                                09309000
IOCTSML  EQU   IOCREL+2                                                 09310000
IOCTPML  EQU   IOCREL                                                   09311000
IOCWORK  EQU   IOCSTR+56                                                09312000
IOCRRN   EQU   IOCSTR+52                                                09313000
IOCPNM   EQU   IOCNWM+2                                                 09314000
IOCPTL   EQU   IOCNWM                                                   09315000
IOCKYA   EQU   IOCMEM                                                   09316000
IOCVRC   EQU   IOCTTR                                                   09317000
IOCCBP   EQU   IOCSTR+36                                                09318000
IOCDSN   EQU   IOCSTR+32                                                09319000
IOCHURBA EQU   IOCSTR+28                                                09320000
IOCVOLSR EQU   IOCSTR+22                                                09321000
@NM00015 EQU   IOCMSG                                                   09322000
IOCMSGSM EQU   IOCMSG                                                   09323000
IOCMSGAE EQU   IOCMSG                                                   09324000
IOCMSGCE EQU   IOCMSG                                                   09325000
IOCMSGOE EQU   IOCMSG                                                   09326000
IOCMSGOP EQU   IOCMSG                                                   09327000
IOCCHPKG EQU   IOCMSG                                                   09328000
IOCCHPKE EQU   IOCMSG                                                   09329000
IOCCHPNU EQU   IOCCHP                                                   09330000
IOCCHPUP EQU   IOCCHP                                                   09331000
IOCCHPBK EQU   IOCCHP                                                   09332000
IOCCHPCR EQU   IOCCHP                                                   09333000
IOCCHPKS EQU   IOCCHP                                                   09334000
IOCCHPSK EQU   IOCCHP                                                   09335000
IOCCHPDR EQU   IOCCHP                                                   09336000
IOCCHPSQ EQU   IOCCHP                                                   09337000
IOCMACNT EQU   IOCMAC2                                                  09338000
IOCMACER EQU   IOCMAC2                                                  09339000
IOCMACPA EQU   IOCMAC2                                                  09340000
IOCMACEN EQU   IOCMAC2                                                  09341000
IOCMACCP EQU   IOCMAC2                                                  09342000
IOCMACRR EQU   IOCMAC2                                                  09343000
IOCMACAS EQU   IOCMAC2                                                  09344000
IOCMACSK EQU   IOCMAC2                                                  09345000
@NM00014 EQU   IOCMAC                                                   09346000
IOCMACCC EQU   IOCMAC                                                   09347000
IOCMACDR EQU   IOCMAC                                                   09348000
IOCMACBK EQU   IOCMAC                                                   09349000
IOCMACCR EQU   IOCMAC                                                   09350000
IOCMACUP EQU   IOCMAC                                                   09351000
IOCMACOT EQU   IOCMAC                                                   09352000
IOCMACIN EQU   IOCMAC                                                   09353000
@NM00013 EQU   IOCRFM                                                   09354000
IOCRFMBK EQU   IOCRFM                                                   09355000
IOCRFMSF EQU   IOCRFM                                                   09356000
IOCRFMUN EQU   IOCRFM                                                   09357000
IOCRFMVR EQU   IOCRFM                                                   09358000
IOCRFMFX EQU   IOCRFM                                                   09359000
@NM00012 EQU   IOCDSO                                                   09360000
IOCDSOPO EQU   IOCDSO                                                   09361000
IOCDSOIS EQU   IOCDSO                                                   09362000
IOCDSOPS EQU   IOCDSO                                                   09363000
IOCDSOAM EQU   IOCDSO                                                   09364000
IOCRKP   EQU   IOCSTR+13                                                09365000
IOCKYL   EQU   IOCSTR+12                                                09366000
IOCTRN   EQU   IOCSTR+8                                                 09367000
IOCDLN   EQU   IOCSTR+4                                                 09368000
IOCDAD   EQU   IOCSTR                                                   09369000
UNITVTOC EQU   UNITABL+7                                                09370000
@NM00011 EQU   UNITSTAT                                                 09371000
UNITUSHR EQU   UNITSTAT                                                 09372000
UNITXSHR EQU   UNITSTAT                                                 09373000
UNITISHR EQU   UNITSTAT                                                 09374000
UNITUA   EQU   @NM00010+1                                               09375000
UNITCHA  EQU   @NM00010                                                 09376000
UNITUCB  EQU   UNITABL                                                  09377000
ALLUNCNT EQU   ALLAGL+30                                                09378000
ALLVLCNT EQU   ALLAGL+29                                                09379000
@NM00009 EQU   ALLOPT                                                   09380000
ALLOPTUN EQU   ALLOPT                                                   09381000
ALLOPTPV EQU   ALLOPT                                                   09382000
ALLOPTDS EQU   ALLOPT                                                   09383000
ALLOPTVL EQU   ALLOPT                                                   09384000
@NM00008 EQU   ALLORG+1                                                 09385000
ALLORGVS EQU   ALLORG+1                                                 09386000
@NM00007 EQU   ALLORG+1                                                 09387000
ALLORGGS EQU   ALLORG+1                                                 09388000
ALLORGUN EQU   ALLORG                                                   09389000
ALLORGPO EQU   ALLORG                                                   09390000
ALLORGMQ EQU   ALLORG                                                   09391000
ALLORGCQ EQU   ALLORG                                                   09392000
ALLORGCX EQU   ALLORG                                                   09393000
ALLORGDA EQU   ALLORG                                                   09394000
ALLORGPS EQU   ALLORG                                                   09395000
ALLORGIS EQU   ALLORG                                                   09396000
ALLDSPUN EQU   ALLDSP                                                   09397000
ALLDSPCG EQU   ALLDSP                                                   09398000
ALLDSPDE EQU   ALLDSP                                                   09399000
ALLDSPKP EQU   ALLDSP                                                   09400000
@NM00006 EQU   ALLDSP                                                   09401000
ALLSTSOD EQU   ALLSTS                                                   09402000
ALLSTSMD EQU   ALLSTS                                                   09403000
ALLSTSNW EQU   ALLSTS                                                   09404000
ALLSTSSR EQU   ALLSTS                                                   09405000
@NM00005 EQU   ALLSTS                                                   09406000
ALLPWD   EQU   ALLAGL+20                                                09407000
ALLVLP   EQU   ALLAGL+16                                                09408000
ALLULP   EQU   ALLAGL+12                                                09409000
ALLDDN   EQU   ALLAGL+4                                                 09410000
ALLDSN   EQU   ALLAGL                                                   09411000
CIRPID   EQU   CIRAGL+28                                                09412000
CIRPWD   EQU   CIRAGL+24                                                09413000
CIRCAT   EQU   CIRAGL+20                                                09414000
CIRWKP   EQU   CIRAGL+16                                                09415000
CIRTLR   EQU   CIRAGL+12                                                09416000
CIRHDR   EQU   CIRAGL+8                                                 09417000
CIRTLN   EQU   CIRAGL+6                                                 09418000
CIRHLN   EQU   CIRAGL+4                                                 09419000
@NM00004 EQU   CIRAGL+1                                                 09420000
@NM00003 EQU   CIRTYPE                                                  09421000
CIRTYPAQ EQU   CIRTYPE                                                  09422000
CIRTYP1Q EQU   CIRTYPE                                                  09423000
NEWID1   EQU   TRACE1+95                                                09424000
CALLID   EQU   OLDERID1+90                                              09425000
@NM00002 EQU   OLDERID1                                                 09426000
GDTPSB   EQU   GDTTBL+184                                               09427000
GDTSPR   EQU   GDTTBL+168                                               09428000
@NM00001 EQU   GDTTBL+160                                               09429000
GDTABH   EQU   GDTTBL+156                                               09430000
GDTABT   EQU   GDTTBL+152                                               09431000
GDTTOH   EQU   GDTTBL+120                                               09432000
GDTRIP   EQU   GDTTBL+116                                               09433000
GDTIOH   EQU   GDTTBL+36                                                09434000
GDTSAH   EQU   GDTTBL+32                                                09435000
GDTTPH   EQU   GDTTBL+28                                                09436000
GDTSTH   EQU   GDTTBL+20                                                09437000
GDTDBH   EQU   GDTTBL+16                                                09438000
GDTPRM   EQU   GDTTBL+4                                                 09439000
GDTHDR   EQU   GDTTBL                                                   09440000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      09441000
@RC00377 EQU   @EL00003                                                 09442000
@RT00385 EQU   @EL00003                                                 09443000
@RF00392 EQU   @EL00003                                                 09444000
@RC00440 EQU   @EL00004                                                 09445000
@RT00451 EQU   @EL00004                                                 09446000
@RF00458 EQU   @EL00004                                                 09447000
@RT00488 EQU   @EL00005                                                 09448000
@RT00516 EQU   @EL00005                                                 09449000
@RC00533 EQU   @EL00006                                                 09450000
@RT00568 EQU   @EL00007                                                 09451000
@RT00611 EQU   @EL00007                                                 09452000
@RT00672 EQU   @EL00008                                                 09453000
@RT00694 EQU   @EL00008                                                 09454000
@RC00700 EQU   @RC00699                                                 09455000
@RF00710 EQU   @RC00699                                                 09456000
@RT00727 EQU   @EL00008                                                 09457000
@RC00744 EQU   @RC00743                                                 09458000
@RT00771 EQU   @EL00008                                                 09459000
@RT00813 EQU   @EL00009                                                 09460000
@RC00844 EQU   @EL00009                                                 09461000
@PB00009 EQU   @EL00008                                                 09462000
@RC00871 EQU   @RC00868                                                 09463000
@RC00869 EQU   @RC00868                                                 09464000
@RC00948 EQU   @EL00010                                                 09465000
@RC00992 EQU   @RC00988                                                 09466000
@RC00997 EQU   @RC00996                                                 09467000
@RF01030 EQU   @RC01027                                                 09468000
@RC01039 EQU   @EL00011                                                 09469000
@PB00011 EQU   @EL00005                                                 09470000
@RT01057 EQU   @EL00012                                                 09471000
@RC01116 EQU   @RC01115                                                 09472000
@RC01143 EQU   @RC01140                                                 09473000
@PB00013 EQU   @EL00012                                                 09474000
@RT01170 EQU   @EL00014                                                 09475000
@RT01181 EQU   @EL00014                                                 09476000
@RC01217 EQU   @RC01216                                                 09477000
@RC01254 EQU   @EL00015                                                 09478000
@RT01261 EQU   @EL00015                                                 09479000
@RF01211 EQU   @EL00015                                                 09480000
@PB00015 EQU   @EL00014                                                 09481000
@RT01286 EQU   @EL00016                                                 09482000
@RT01306 EQU   @EL00016                                                 09483000
@RC01372 EQU   @RC01371                                                 09484000
@RC01385 EQU   @RC01384                                                 09485000
@RC01390 EQU   @RC01389                                                 09486000
@RC01412 EQU   @EL00017                                                 09487000
@PB00017 EQU   @EL00016                                                 09488000
@RC01456 EQU   @EL00020                                                 09489000
@PB00020 EQU   @EL00001                                                 09490000
@PB00010 EQU   @PB00011                                                 09491000
@RC01040 EQU   @RC01039                                                 09492000
@PB00019 EQU   @PB00020                                                 09493000
@PB00008 EQU   @PB00010                                                 09494000
@PB00018 EQU   @PB00019                                                 09495000
@PB00007 EQU   @PB00008                                                 09496000
@PB00016 EQU   @PB00018                                                 09497000
@PB00006 EQU   @PB00007                                                 09498000
@PB00014 EQU   @PB00016                                                 09499000
@RC00481 EQU   @PB00006                                                 09500000
@PB00012 EQU   @PB00014                                                 09501000
@PB00005 EQU   @PB00012                                                 09502000
@PB00004 EQU   @PB00005                                                 09503000
@PB00003 EQU   @PB00004                                                 09504000
@PB00002 EQU   @PB00003                                                 09505000
@ENDDATA EQU   *                                                        09506000
         END   IDCRI04,(C'PLS0626',0701,76335)                          09507000
