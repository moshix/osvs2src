         TITLE '********** IDCRM01:  IMPORTRA FUNCTION SUPPORT ROUTINE *00001000
                ********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCRM01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCRM01   78.177'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @11,4095(,@12)                                      0002 00022000
         LA    @10,4095(,@11)                                      0002 00023000
         LA    @09,4095(,@10)                                      0002 00024000
         LA    @08,4095(,@09)                                      0002 00025000
         LA    @07,4095(,@08)                                      0002 00026000
         LA    @06,4095(,@07)                                      0002 00027000
         USING @PSTART,@12                                         0002 00028000
         USING @PSTART+4095,@11                                    0002 00029000
         USING @PSTART+8190,@10                                    0002 00030000
         USING @PSTART+12285,@09                                   0002 00031000
         USING @PSTART+16380,@08                                   0002 00032000
         USING @PSTART+20475,@07                                   0002 00033000
         USING @PSTART+24570,@06                                   0002 00034000
         L     @00,@SIZDATD                                        0002 00035000
         GETMAIN  R,LV=(0)                                              00036000
         LR    @05,@01                                             0002 00037000
         USING @DATD,@05                                           0002 00038000
         ST    @13,@SA00001+4                                      0002 00039000
         LM    @00,@01,20(@13)                                     0002 00040000
         ST    @05,8(,@13)                                         0002 00041000
         LR    @13,@05                                             0002 00042000
         MVC   @PC00001(12),0(@01)                                 0002 00043000
*                                                                  0366 00044000
*        /************************************************************/ 00045000
*        /*                                                          */ 00046000
*        /*   THIS IS THE HIGHEST LEVEL OF PROCESSING FOR THE        */ 00047000
*        /*   IMPORTRA ROUTINE.                                      */ 00048000
*        /*                                                          */ 00049000
*        /************************************************************/ 00050000
*                                                                  0367 00051000
*        OLDERID2 = NEWERID2;                                      0367 00052000
         L     @04,@PC00001                                        0367 00053000
         L     @04,GDTTR2(,@04)                                    0367 00054000
         MVC   @TS00001(95),NEWERID2(@04)                          0367 00055000
         MVC   OLDERID2(95,@04),@TS00001                           0367 00056000
*        NEWID2 = 'RMBG';                                          0368 00057000
*                                                                  0368 00058000
         MVC   NEWID2(4,@04),@CC01300                              0368 00059000
*        /************************************************************/ 00060000
*        /*                                                          */ 00061000
*        /*  INITIALIZE FIELDS FOR MESSAGE OUTPUT                    */ 00062000
*        /*                                                          */ 00063000
*        /************************************************************/ 00064000
*                                                                  0369 00065000
*        DDSTRU = ADDR(PRINTTAB);                                  0369 00066000
         LA    @04,PRINTTAB                                        0369 00067000
         ST    @04,DDSTRU                                          0369 00068000
*        DARGLIST = ''B;                                           0370 00069000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0370 00070000
*        DEFSTID = 0;                                              0371 00071000
         MVI   DEFSTID,X'00'                                       0371 00072000
*        DARGSMOD = 'MP0';                                         0372 00073000
*                                                                  0372 00074000
         MVC   DARGSMOD(3,@04),@CC00945                            0372 00075000
*        SETRC = 0;                                                0373 00076000
*                                                                  0373 00077000
         SLR   @04,@04                                             0373 00078000
         STH   @04,SETRC                                           0373 00079000
*        /************************************************************/ 00080000
*        /*                                                          */ 00081000
*        /*  INITIALIZE POINTER TO INPUT IOCS AND SET ENDFLAG TO OFF */ 00082000
*        /*                                                          */ 00083000
*        /************************************************************/ 00084000
*                                                                  0374 00085000
*        PINIOCS = NULLPTR;            /*INPUT IOCS                  */ 00086000
         ST    @04,PINIOCS                                         0374 00087000
*        ENDFLAG = OFF;                /*INITIALIZE ENDFLAG TO OFF   */ 00088000
*                                                                  0375 00089000
         NI    ENDFLAG,B'01111111'                                 0375 00090000
*        /************************************************************/ 00091000
*        /*                                                          */ 00092000
*        /*  SET POUTIOCS TO NULLPTR IN CASE WE NEVER ENTER          */ 00093000
*        /*  THE MAIN LOOP.                                          */ 00094000
*        /*                                                          */ 00095000
*        /************************************************************/ 00096000
*                                                                  0376 00097000
*        POUTIOCS = NULLPTR;                                       0376 00098000
*                                                                  0376 00099000
         ST    @04,POUTIOCS                                        0376 00100000
*        /************************************************************/ 00101000
*        /*                                                          */ 00102000
*        /*  SET AN INITIAL VALUE FOR THE BLOCKSIZE OF THE           */ 00103000
*        /*  PORTABLE DATA SET.                                      */ 00104000
*        /*                                                          */ 00105000
*        /************************************************************/ 00106000
*                                                                  0377 00107000
*        BLKSIZ = 2048;                                            0377 00108000
         MVC   BLKSIZ(4),@CF01302                                  0377 00109000
*        IF ADDR(OUTDD) ^= NULLPTR                                 0378 00110000
*          THEN                                                    0378 00111000
         L     @15,@PC00001+4                                      0378 00112000
         C     @04,FDTPTR+4(,@15)                                  0378 00113000
         BE    @RF00378                                            0378 00114000
*UIO:        DO;                                                   0379 00115000
*                                                                  0379 00116000
UIO      DS    0H                                                  0380 00117000
*            /********************************************************/ 00118000
*            /*                                                      */ 00119000
*            /*  SET UP ADDRESSABILITY TO THE UIOINFO OPTION BYTE AND*/ 00120000
*            /*  ZERO IT OUT.                                        */ 00121000
*            /*                                                      */ 00122000
*            /********************************************************/ 00123000
*                                                                  0380 00124000
*            RESPECIFY IOINFOPT BASED(IOINFPTR);                   0380 00125000
*            IOINFPTR = ADDR(IOINFBYT);                            0381 00126000
         LA    @04,IOINFBYT                                        0381 00127000
         ST    @04,IOINFPTR                                        0381 00128000
*            IOINFBYT = ''B;                                       0382 00129000
*                                                                  0382 00130000
         MVI   IOINFBYT,X'00'                                      0382 00131000
*            /********************************************************/ 00132000
*            /*                                                      */ 00133000
*            /*  ZERO OUT THE RETURN AREA FOR THE DATA SET NAME, AND */ 00134000
*            /*  SET THE LENGTH OF THE AREA IN THE FIRST TWO BYTES.  */ 00135000
*            /*                                                      */ 00136000
*            /********************************************************/ 00137000
*                                                                  0383 00138000
*            DSNRET = ''B;                                         0383 00139000
         XC    DSNRET(52),DSNRET                                   0383 00140000
*            DSNRETAL = LENGTH(DSNRET);                            0384 00141000
*                                                                  0384 00142000
         MVC   DSNRETAL(2),@CH01741                                0384 00143000
*            /********************************************************/ 00144000
*            /*                                                      */ 00145000
*            /*  ISSUE A UIOINFO TO GET THE DUMMY NAME TO BE USED TO */ 00146000
*            /*  OPEN ANY VSAM OBJECTS BEING IMPORTED.  THE          */ 00147000
*            /*  PARAMETERS PASSED TO UIOINFO ARE:                   */ 00148000
*            /*                                                      */ 00149000
*            /*  (1) THE GDT                                         */ 00150000
*            /*  (2) AN OPTION BYTE WITH THE DATA SET NAME BIT ON    */ 00151000
*            /*  (3) A WORD CONTAINING THE ADDRESS OF A RETURN AREA  */ 00152000
*            /*      FOR THE DATA SET NAME                           */ 00153000
*            /*  (4) THE ADDRESS OF THE DDNAME FOR THE DD CARD FOR   */ 00154000
*            /*      OBJECTS BEING IMPORTED                          */ 00155000
*            /*                                                      */ 00156000
*            /********************************************************/ 00157000
*                                                                  0385 00158000
*            IOINFDSN = ON;                                        0385 00159000
         OI    IOINFDSN(@04),B'00100000'                           0385 00160000
*            DSNRETPT = ADDR(DSNRET);                              0386 00161000
*                                                                  0386 00162000
         LA    @15,DSNRET                                          0386 00163000
         ST    @15,DSNRETPT                                        0386 00164000
*            /********************************************************/ 00165000
*            /*                                                      */ 00166000
*            /*  ISSUE THE UIOINFO, AND TEST THE CONDITION CODE      */ 00167000
*            /*                                                      */ 00168000
*            /********************************************************/ 00169000
*                                                                  0387 00170000
*            CALL IDCIOSI0(GDTTBL,IOINFOPT,DSNRETPT,OUTDDVAL);     0387 00171000
*                                                                  0387 00172000
         L     @15,@PC00001                                        0387 00173000
         ST    @15,@AL00001                                        0387 00174000
         ST    @04,@AL00001+4                                      0387 00175000
         LA    @04,DSNRETPT                                        0387 00176000
         ST    @04,@AL00001+8                                      0387 00177000
         L     @04,@PC00001+4                                      0387 00178000
         L     @04,FDTPTR+4(,@04)                                  0387 00179000
         LA    @04,OUTDDVAL(,@04)                                  0387 00180000
         ST    @04,@AL00001+12                                     0387 00181000
         MVI   @AL00001+12,X'80'                                   0387 00182000
         L     @15,GDTIFO(,@15)                                    0387 00183000
         LA    @01,@AL00001                                        0387 00184000
         BALR  @14,@15                                             0387 00185000
*            RESPECIFY RTNREG RSTD;                                0388 00186000
*            TESTRC = RTNREG;                                      0389 00187000
         STH   RTNREG,TESTRC                                       0389 00188000
*            RESPECIFY RTNREG UNRSTD;                              0390 00189000
*            IF TESTRC ^= 0                                        0391 00190000
*              THEN                                                0391 00191000
         LH    @04,TESTRC                                          0391 00192000
         LTR   @04,@04                                             0391 00193000
         BZ    @RF00391                                            0391 00194000
*                DO;                                               0392 00195000
*                ENDFLAG = ON;                                     0393 00196000
         OI    ENDFLAG,B'10000000'                                 0393 00197000
*                DARGSMOD = IMPMSG;                                0394 00198000
         L     @04,DDSTRU                                          0394 00199000
         MVC   DARGSMOD(3,@04),@CC00945                            0394 00200000
*                DARGSENT = IOINFMSG;                              0395 00201000
         MVI   DARGSENT(@04),X'18'                                 0395 00202000
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             0396 00203000
         L     @04,@PC00001                                        0396 00204000
         ST    @04,@AL00001                                        0396 00205000
         LA    @15,@CF00119                                        0396 00206000
         ST    @15,@AL00001+4                                      0396 00207000
         LA    @15,DDSTRU                                          0396 00208000
         ST    @15,@AL00001+8                                      0396 00209000
         MVI   @AL00001+8,X'80'                                    0396 00210000
         L     @15,GDTPRT(,@04)                                    0396 00211000
         LA    @01,@AL00001                                        0396 00212000
         BALR  @14,@15                                             0396 00213000
*                SETRC = LASTCC12;                                 0397 00214000
         MVC   SETRC(2),@CH00035                                   0397 00215000
*                END;                                              0398 00216000
*            END UIO;                                              0399 00217000
*                                                                  0399 00218000
@RF00391 DS    0H                                                  0400 00219000
*        RESPECIFY IDAAMDSB BASED(DSCCATPT);                       0400 00220000
*                                                                  0400 00221000
@RF00378 DS    0H                                                  0401 00222000
*        /************************************************************/ 00223000
*        /*                                                          */ 00224000
*        /*  IF INDATASET WAS SPECIFIED BY THE USER, OBTAIN THE      */ 00225000
*        /*  FULLY QUALIFIED NAME OF THE DATASET BY ISSUING THE      */ 00226000
*        /*  UQUAL MACRO.                                            */ 00227000
*        /*                                                          */ 00228000
*        /************************************************************/ 00229000
*                                                                  0401 00230000
*        IF INDSFUQ = ON & ADDR(INDS) ^= NULLPTR                   0401 00231000
*          THEN                                                    0401 00232000
         L     @04,@PC00001+4                                      0401 00233000
         L     @04,FDTPTR+92(,@04)                                 0401 00234000
         TM    INDSFUQ(@04),B'10000000'                            0401 00235000
         BNO   @RF00401                                            0401 00236000
         LTR   @04,@04                                             0401 00237000
         BZ    @RF00401                                            0401 00238000
*            DO;                                                   0402 00239000
*                                                                  0402 00240000
*            /********************************************************/ 00241000
*            /*                                                      */ 00242000
*            /*  CLEAR THE STORAGE TO BE USED FOR THE PARAMETER      */ 00243000
*            /*  LIST PASSED TO UQUAL AND SET THE ENTRY NAME AND     */ 00244000
*            /*  PASSWORD POINTERS IN THE UQUAL PARAMETER LIST.      */ 00245000
*            /*                                                      */ 00246000
*            /********************************************************/ 00247000
*                                                                  0403 00248000
*            QUALLIST = ''B;                                       0403 00249000
         XC    QUALLIST(12),QUALLIST                               0403 00250000
*            QUALADDR = ADDR(INDSVAL);                             0404 00251000
         LA    @15,INDSVAL(,@04)                                   0404 00252000
         ST    @15,QUALADDR                                        0404 00253000
*            IF INDSPLN ^= 0                                       0405 00254000
*              THEN                                                0405 00255000
         CLI   INDSPLN(@04),0                                      0405 00256000
         BE    @RF00405                                            0405 00257000
*                QUALPAS = ADDR(INDSPAS);                          0406 00258000
         LA    @04,INDSPAS(,@04)                                   0406 00259000
         ST    @04,QUALPAS                                         0406 00260000
*            QUALLEN = INDSLEN;                            /*@OZ19704*/ 00261000
*                                                                  0407 00262000
@RF00405 L     @04,@PC00001+4                                      0407 00263000
         L     @04,FDTPTR+92(,@04)                                 0407 00264000
         SLR   @15,@15                                             0407 00265000
         IC    @15,INDSLEN(,@04)                                   0407 00266000
         STH   @15,QUALLEN                                         0407 00267000
*            /********************************************************/ 00268000
*            /*                                                      */ 00269000
*            /*  ISSUE THE UQUAL TO OBTAIN THE FULLY QUALIFIED       */ 00270000
*            /*  NAME FOR THE DATASET.  TEST THE RETURN CODE FROM    */ 00271000
*            /*  UQUAL TO DETERMINE IF PROCESSING IS TO CONTINUE.    */ 00272000
*            /*                                                      */ 00273000
*            /********************************************************/ 00274000
*                                                                  0408 00275000
*            CALL IDCSAQL0(GDTTBL,QUALADDR,QUALLEN,QUALCAT,QUALPAS);/*  00276000
*                                                             OZ19704*/ 00277000
*                                                                  0408 00278000
         L     @04,@PC00001                                        0408 00279000
         ST    @04,@AL00001                                        0408 00280000
         LA    @15,QUALADDR                                        0408 00281000
         ST    @15,@AL00001+4                                      0408 00282000
         LA    @15,QUALLEN                                         0408 00283000
         ST    @15,@AL00001+8                                      0408 00284000
         LA    @15,QUALCAT                                         0408 00285000
         ST    @15,@AL00001+12                                     0408 00286000
         LA    @15,QUALPAS                                         0408 00287000
         ST    @15,@AL00001+16                                     0408 00288000
         MVI   @AL00001+16,X'80'                                   0408 00289000
         L     @15,GDTQAL(,@04)                                    0408 00290000
         LA    @01,@AL00001                                        0408 00291000
         BALR  @14,@15                                             0408 00292000
*            RESPECIFY RTNREG RSTD;                                0409 00293000
*            TESTRC = RTNREG;                                      0410 00294000
         STH   RTNREG,TESTRC                                       0410 00295000
*            RESPECIFY RTNREG UNRSTD;                              0411 00296000
*            IF TESTRC ^= 0                                        0412 00297000
*              THEN                                                0412 00298000
         LH    @04,TESTRC                                          0412 00299000
         LTR   @04,@04                                             0412 00300000
         BZ    @RF00412                                            0412 00301000
*                DO;                                               0413 00302000
*                SETRC = LASTCC12;                                 0414 00303000
         MVC   SETRC(2),@CH00035                                   0414 00304000
*                ENDFLAG = ON;                                     0415 00305000
         OI    ENDFLAG,B'10000000'                                 0415 00306000
*                END;                                              0416 00307000
*            END;                                                  0417 00308000
*                                                                  0417 00309000
@RF00412 DS    0H                                                  0418 00310000
*        /************************************************************/ 00311000
*        /*                                                          */ 00312000
*        /*  OPEN INPUT DATA SET - THE PORTABILITY VOLUME AS         */ 00313000
*        /*  SPECIFIED IN THE IN OR THE INDS PARAMETER               */ 00314000
*        /*                                                          */ 00315000
*        /************************************************************/ 00316000
*                                                                  0418 00317000
*        IF ADDR(IN) ^= NULLPTR                                    0418 00318000
*          THEN                                                    0418 00319000
@RF00401 L     @04,@PC00001+4                                      0418 00320000
         L     @15,FDTPTR(,@04)                                    0418 00321000
         LTR   @15,@15                                             0418 00322000
         BZ    @RF00418                                            0418 00323000
*            CALL OPENPROC('I',ADDR(INDDVAL),NULLPARM,0,           0419 00324000
*              BLKSIZ,ADDR(PINIOCS));                              0419 00325000
         LA    @15,@CC00753                                        0419 00326000
         ST    @15,@AL00001                                        0419 00327000
         L     @04,FDTPTR+56(,@04)                                 0419 00328000
         LA    @04,INDDVAL(,@04)                                   0419 00329000
         ST    @04,@AFTEMPS+36                                     0419 00330000
         LA    @04,@AFTEMPS+36                                     0419 00331000
         ST    @04,@AL00001+4                                      0419 00332000
         LA    @04,NULLPARM                                        0419 00333000
         ST    @04,@AL00001+8                                      0419 00334000
         LA    @04,@CF00119                                        0419 00335000
         ST    @04,@AL00001+12                                     0419 00336000
         LA    @04,BLKSIZ                                          0419 00337000
         ST    @04,@AL00001+16                                     0419 00338000
         LA    @04,PINIOCS                                         0419 00339000
         ST    @04,@AFTEMPS+40                                     0419 00340000
         LA    @04,@AFTEMPS+40                                     0419 00341000
         ST    @04,@AL00001+20                                     0419 00342000
         LA    @01,@AL00001                                        0419 00343000
         BAL   @14,OPENPROC                                        0419 00344000
*          ELSE                                                    0420 00345000
*            CALL OPENPROC('I',NULLPARM,ADDR(INDSVAL),0,           0420 00346000
*               BLKSIZ,ADDR(PINIOCS));                             0420 00347000
*                                                                  0420 00348000
         B     @RC00418                                            0420 00349000
@RF00418 LA    @04,@CC00753                                        0420 00350000
         ST    @04,@AL00001                                        0420 00351000
         LA    @04,NULLPARM                                        0420 00352000
         ST    @04,@AL00001+4                                      0420 00353000
         L     @04,@PC00001+4                                      0420 00354000
         L     @04,FDTPTR+92(,@04)                                 0420 00355000
         LA    @04,INDSVAL(,@04)                                   0420 00356000
         ST    @04,@AFTEMPS+36                                     0420 00357000
         LA    @04,@AFTEMPS+36                                     0420 00358000
         ST    @04,@AL00001+8                                      0420 00359000
         LA    @04,@CF00119                                        0420 00360000
         ST    @04,@AL00001+12                                     0420 00361000
         LA    @04,BLKSIZ                                          0420 00362000
         ST    @04,@AL00001+16                                     0420 00363000
         LA    @04,PINIOCS                                         0420 00364000
         ST    @04,@AFTEMPS+40                                     0420 00365000
         LA    @04,@AFTEMPS+40                                     0420 00366000
         ST    @04,@AL00001+20                                     0420 00367000
         LA    @01,@AL00001                                        0420 00368000
         BAL   @14,OPENPROC                                        0420 00369000
*        /************************************************************/ 00370000
*        /*                                                          */ 00371000
*        /*  TEST FOR SUCCESSFUL OPEN.  IF OPEN UNSUCCESSFUL         */ 00372000
*        /*  RETURN TO CALLING PROCESSOR                             */ 00373000
*        /*                                                          */ 00374000
*        /************************************************************/ 00375000
*                                                                  0421 00376000
*        RESPECIFY RTNREG RSTD;                                    0421 00377000
@RC00418 DS    0H                                                  0422 00378000
*        TESTRC = RTNREG;                                          0422 00379000
         STH   RTNREG,TESTRC                                       0422 00380000
*        RESPECIFY RTNREG UNRSTD;                                  0423 00381000
*        IF TESTRC ^= 0                                            0424 00382000
*          THEN                                                    0424 00383000
         LH    @04,TESTRC                                          0424 00384000
         LTR   @04,@04                                             0424 00385000
         BZ    @RF00424                                            0424 00386000
*            DO;                                                   0425 00387000
*            DARGSENT = ERROPENP;                                  0426 00388000
         L     @04,DDSTRU                                          0426 00389000
         MVI   DARGSENT(@04),X'0E'                                 0426 00390000
*            DARGSMOD = IMPMSG;                                    0427 00391000
         MVC   DARGSMOD(3,@04),@CC00945                            0427 00392000
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                 0428 00393000
         L     @04,@PC00001                                        0428 00394000
         ST    @04,@AL00001                                        0428 00395000
         LA    @15,@CF00119                                        0428 00396000
         ST    @15,@AL00001+4                                      0428 00397000
         LA    @15,DDSTRU                                          0428 00398000
         ST    @15,@AL00001+8                                      0428 00399000
         MVI   @AL00001+8,X'80'                                    0428 00400000
         L     @15,GDTPRT(,@04)                                    0428 00401000
         LA    @01,@AL00001                                        0428 00402000
         BALR  @14,@15                                             0428 00403000
*            ENDFLAG = ON;                                         0429 00404000
         OI    ENDFLAG,B'10000000'                                 0429 00405000
*            SETRC = LASTCC12;                                     0430 00406000
         MVC   SETRC(2),@CH00035                                   0430 00407000
*            END;                                                  0431 00408000
*                                                                  0431 00409000
*        /************************************************************/ 00410000
*        /*                                                          */ 00411000
*        /*  LOOP READING CATALOG INFORMATION FROM THE PORTABLE      */ 00412000
*        /*  DATA SET WHILE A PHYSICAL END OF FILE IS FOUND.         */ 00413000
*        /*                                                          */ 00414000
*        /************************************************************/ 00415000
*                                                                  0432 00416000
*MPLOOP: DO WHILE ENDFLAG = OFF;                                   0432 00417000
*                                                                  0432 00418000
@RF00424 DS    0H                                                  0432 00419000
MPLOOP   B     @DE00432                                            0432 00420000
@DL00432 DS    0H                                                  0433 00421000
*          /**********************************************************/ 00422000
*          /*                                                        */ 00423000
*          /*  INITIALIZATIONS FOR THIS ITERATION OF THE IMPORTRA    */ 00424000
*          /*                                                        */ 00425000
*          /**********************************************************/ 00426000
*                                                                  0433 00427000
*          POUTIOCS = NULLPTR;           /*OUTPUT IOCS               */ 00428000
         SLR   @04,@04                                             0433 00429000
         ST    @04,POUTIOCS                                        0433 00430000
*          IMPFLG2 = '00'X;            /*IMPORT FLAGS                */ 00431000
         MVI   IMPFLG2,X'00'                                       0434 00432000
*          IMPMFLAG = '00'X;           /*IMPORT MESSAGE FLAGS@OZ17068*/ 00433000
         MVI   IMPMFLAG,X'00'                                      0435 00434000
*          CPSWD = NULLPTR;            /*OBJECT PASSWORD POINTER     */ 00435000
         ST    @04,CPSWD                                           0436 00436000
*          CATRCVWK = ''B;             /*RECOVERY VOLSER             */ 00437000
         XC    CATRCVWK(10),CATRCVWK                               0437 00438000
*          RCVLN = LENGTH(CATRCVWK);   /*SET THE LENGTH OF THE       */ 00439000
         MVC   RCVLN(2),@CH00037                                   0438 00440000
*                                      /*RECOVERY WORK AREA          */ 00441000
*                                                                  0439 00442000
*          /**********************************************************/ 00443000
*          /*                                                        */ 00444000
*          /*  SET ADDRESSABILITY FOR THE ALLAGL.  INITIALIZE        */ 00445000
*          /*  VARIABLES USED TO CONTROL THE DYNAMIC ALLOCATION      */ 00446000
*          /*  OF VOLUMES.                                           */ 00447000
*          /*                                                        */ 00448000
*          /**********************************************************/ 00449000
*                                                                  0439 00450000
*          RESPECIFY ALLAGL BASED(ALLPTR);                         0439 00451000
*          DEALLOC = OFF;                                          0440 00452000
         NI    DEALLOC,B'01111111'                                 0440 00453000
*          UNIQD = OFF;                                            0441 00454000
         NI    UNIQD,B'01111111'                                   0441 00455000
*          UNIQI = OFF;                                            0442 00456000
         NI    UNIQI,B'01111111'                                   0442 00457000
*          DALCINDX = 0;                                           0443 00458000
*                                                                  0443 00459000
         ST    @04,DALCINDX                                        0443 00460000
*          DO I = 1 TO CMPNUM;                                     0444 00461000
         LA    @04,1                                               0444 00462000
         ST    @04,I                                               0444 00463000
@DL00444 DS    0H                                                  0445 00464000
*            FVTPTR(I) = NULLPTR;        /*ZERO FVT POINTERS         */ 00465000
         LR    @15,@04                                             0445 00466000
         SLA   @15,2                                               0445 00467000
         SLR   @14,@14                                             0445 00468000
         ST    @14,FVTPTR-4(@15)                                   0445 00469000
*          END;                                                    0446 00470000
*                                                                  0446 00471000
         AL    @04,@CF00221                                        0446 00472000
         ST    @04,I                                               0446 00473000
         C     @04,@CF00165                                        0446 00474000
         BNH   @DL00444                                            0446 00475000
*          PFVTPTR = NULLPTR;            /*ZERO PATH FVT             */ 00476000
         SLR   @04,@04                                             0447 00477000
         ST    @04,PFVTPTR                                         0447 00478000
*                                        /*POINTER                   */ 00479000
*          PTRCTACB = NULLPTR;         /*ZERO OUT CATALOG ACB        */ 00480000
         ST    @04,PTRCTACB                                        0448 00481000
*                                      /*POINTER                     */ 00482000
*                                                                  0449 00483000
*          /**********************************************************/ 00484000
*          /*                                                        */ 00485000
*          /*  INITIALIZE ALL OF THE SPECIAL FVT POINTERS USED FOR   */ 00486000
*          /*  USERCATALOGS, ALIASES, GDG BASES, AND NON-VSAMS TO 0. */ 00487000
*          /*                                                        */ 00488000
*          /**********************************************************/ 00489000
*                                                                  0449 00490000
*          UCFVTPTR = NULLPTR;                                     0449 00491000
         ST    @04,UCFVTPTR                                        0449 00492000
*          ALFVTPTR = NULLPTR;                                     0450 00493000
         ST    @04,ALFVTPTR                                        0450 00494000
*          GDFVTPTR = NULLPTR;                                     0451 00495000
         ST    @04,GDFVTPTR                                        0451 00496000
*          NVFVTPTR = NULLPTR;                                     0452 00497000
*                                                                  0452 00498000
         ST    @04,NVFVTPTR                                        0452 00499000
*          /**********************************************************/ 00500000
*          /*                                                        */ 00501000
*          /*  PROCESS THE TIME STAMP RECORD WHICH IS THE FIRST      */ 00502000
*          /*  RECORD ON THE PORTABILITY VOLUME  THIS RECORD GIVES   */ 00503000
*          /*  THE TIME AND DATE THE DATA SET WAS EXPORTED.          */ 00504000
*          /*                                                        */ 00505000
*          /**********************************************************/ 00506000
*                                                                  0453 00507000
*          /**********************************************************/ 00508000
*          /*                                                        */ 00509000
*          /*  READ THE TIME STAMP RECORD FROM THE PORTABLE DATA SET */ 00510000
*          /*                                                        */ 00511000
*          /**********************************************************/ 00512000
*                                                                  0453 00513000
*          IOCSPTR = PINIOCS;                                      0453 00514000
*                                                                  0453 00515000
         L     @04,PINIOCS                                         0453 00516000
         ST    @04,IOCSPTR                                         0453 00517000
*          CALL IDCIOGT0 (GDTTBL,IOCSPTR);                         0454 00518000
*                                                                  0454 00519000
         L     @04,@PC00001                                        0454 00520000
         ST    @04,@AL00001                                        0454 00521000
         LA    @15,IOCSPTR                                         0454 00522000
         ST    @15,@AL00001+4                                      0454 00523000
         MVI   @AL00001+4,X'80'                                    0454 00524000
         L     @15,GDTGET(,@04)                                    0454 00525000
         LA    @01,@AL00001                                        0454 00526000
         BALR  @14,@15                                             0454 00527000
*          RESPECIFY RTNREG RSTD;                                  0455 00528000
*          TESTRC = RTNREG;                                        0456 00529000
         STH   RTNREG,TESTRC                                       0456 00530000
*          RESPECIFY RTNREG UNRSTD;                                0457 00531000
*          IF TESTRC ^= 0                                          0458 00532000
*            THEN                                                  0458 00533000
*                                                                  0458 00534000
         LH    @04,TESTRC                                          0458 00535000
         LTR   @04,@04                                             0458 00536000
         BZ    @RF00458                                            0458 00537000
*              /******************************************************/ 00538000
*              /*                                                    */ 00539000
*              /*  COULD NOT READ RECORD FROM PORTABILITY VOLUME.    */ 00540000
*              /*  INDICATE ERROR  AND RETURN TO CALLING PROCESSOR   */ 00541000
*              /*  THIS MAY BE THE END OF FILE.  IF SO, THIS IS THE  */ 00542000
*              /*  THE NORMAL METHOD OF TERMINATING A RECOVERY       */ 00543000
*              /*  IMPORT COMMAND.                                   */ 00544000
*              /*                                                    */ 00545000
*              /******************************************************/ 00546000
*                                                                  0459 00547000
*              ENDFLAG = ON;                                       0459 00548000
*                                                                  0459 00549000
         OI    ENDFLAG,B'10000000'                                 0459 00550000
*          /**********************************************************/ 00551000
*          /*                                                        */ 00552000
*          /*  IF THE VALUE OF ENDFLAG IS OFF, THEN PROCEED WITH     */ 00553000
*          /*  WITH THE IMPORTATION OF THE CURRENT OBJECT.           */ 00554000
*          /*                                                        */ 00555000
*          /**********************************************************/ 00556000
*                                                                  0460 00557000
*          IF ENDFLAG = OFF                                        0460 00558000
*            THEN                                                  0460 00559000
@RF00458 TM    ENDFLAG,B'10000000'                                 0460 00560000
         BNZ   @RF00460                                            0460 00561000
*NOTEND:       DO;                                                 0461 00562000
*                                                                  0461 00563000
NOTEND   DS    0H                                                  0462 00564000
*              /******************************************************/ 00565000
*              /*                                                    */ 00566000
*              /*  SAVE INFORMATION PASSED BY EXPORT GIVING NUMBER OF*/ 00567000
*              /*  COMPONENTS IN CLUSTER AND FLAG BYTE INDICATING    */ 00568000
*              /*  WHETHER INHIBITTARGET WAS SPECIFIED AT EXPORT TIME*/ 00569000
*              /*                                                    */ 00570000
*              /******************************************************/ 00571000
*                                                                  0462 00572000
*              CONRCPTR = IOCDAD;                                  0462 00573000
*                                                                  0462 00574000
         L     @04,IOCSPTR                                         0462 00575000
         L     @04,IOCDAD(,@04)                                    0462 00576000
         ST    @04,CONRCPTR                                        0462 00577000
*              /******************************************************/ 00578000
*              /*                                                    */ 00579000
*              /*  CHECK TO SEE THAT THIS IS A PORTABLE DATA SET -   */ 00580000
*              /*  CHECK FOR TIME STAMP FLAGS SET IN FIRST RECORD.   */ 00581000
*              /*  IF FLAGS INCORRECT, RETURN WITH ERROR             */ 00582000
*              /*                                                    */ 00583000
*              /******************************************************/ 00584000
*                                                                  0463 00585000
*              IF HEADFLG1 ^= HDFL1CAT | HEADFLG2 ^=HDFL2TSP       0463 00586000
*                THEN                                              0463 00587000
         CLI   HEADFLG1(@04),X'FF'                                 0463 00588000
         BNE   @RT00463                                            0463 00589000
         CLI   HEADFLG2(@04),X'FF'                                 0463 00590000
         BE    @RF00463                                            0463 00591000
@RT00463 DS    0H                                                  0464 00592000
*                  DO;                                             0464 00593000
*                  DEFSTID = PORTERR;                              0465 00594000
         MVI   DEFSTID,X'01'                                       0465 00595000
*                  ENDFLAG = ON;                                   0466 00596000
         OI    ENDFLAG,B'10000000'                                 0466 00597000
*                  END;                                            0467 00598000
*                                                                  0467 00599000
*                                                                  0467 00600000
*              NUMOBJ = TEXOJCT;                                   0468 00601000
@RF00463 LA    @04,8                                               0468 00602000
         L     @15,CONRCPTR                                        0468 00603000
         ALR   @15,@04                                             0468 00604000
         SLR   @14,@14                                             0468 00605000
         IC    @14,TEXOJCT(,@15)                                   0468 00606000
         STH   @14,NUMOBJ                                          0468 00607000
*              IMPFLG = TEXFLG;                                    0469 00608000
*                                                                  0469 00609000
         MVC   IMPFLG(1),TEXFLG(@15)                               0469 00610000
*              /******************************************************/ 00611000
*              /*                                                    */ 00612000
*              /*  LIST EXPORT TIME STAMP INFORMATION USING TEXT     */ 00613000
*              /*  PROCESSOR INTERFACE                               */ 00614000
*              /*                                                    */ 00615000
*              /******************************************************/ 00616000
*                                                                  0470 00617000
*              DARGCNT = 2;                                        0470 00618000
         LA    @14,2                                               0470 00619000
         L     @03,DDSTRU                                          0470 00620000
         STH   @14,DARGCNT(,@03)                                   0470 00621000
*              DARGINS(1) = 1;                                     0471 00622000
         MVC   DARGINS(2,@03),@CH00221                             0471 00623000
*              DARGINL(1) = LENGTH(TIMEDATE);                      0472 00624000
         STH   @04,DARGINL(,@03)                                   0472 00625000
*              DARGDTM(1) = ADDR(TIMEDATE);                        0473 00626000
         LA    @02,TIMEDATE(,@15)                                  0473 00627000
         ST    @02,DARGDTM(,@03)                                   0473 00628000
*              DARGINS(2) = 2;                                     0474 00629000
         STH   @14,DARGINS+8(,@03)                                 0474 00630000
*              DARGINL(2) = LENGTH(TIMEODAY);                      0475 00631000
         STH   @04,DARGINL+8(,@03)                                 0475 00632000
*              DARGDTM(2) = ADDR(TIMEODAY);                        0476 00633000
         LA    @04,TIMEODAY(,@15)                                  0476 00634000
         ST    @04,DARGDTM+8(,@03)                                 0476 00635000
*              DARGSENT = TIMEMSG;                                 0477 00636000
*                                                                  0477 00637000
         MVI   DARGSENT(@03),X'0C'                                 0477 00638000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);               0478 00639000
         L     @04,@PC00001                                        0478 00640000
         ST    @04,@AL00001                                        0478 00641000
         LA    @15,@CF00119                                        0478 00642000
         ST    @15,@AL00001+4                                      0478 00643000
         LA    @15,DDSTRU                                          0478 00644000
         ST    @15,@AL00001+8                                      0478 00645000
         MVI   @AL00001+8,X'80'                                    0478 00646000
         L     @15,GDTPRT(,@04)                                    0478 00647000
         LA    @01,@AL00001                                        0478 00648000
         BALR  @14,@15                                             0478 00649000
*              DARGLIST = ''B;                                     0479 00650000
         L     @04,DDSTRU                                          0479 00651000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0479 00652000
*              DARGSMOD = IMPMSG;                                  0480 00653000
*                                                                  0480 00654000
         MVC   DARGSMOD(3,@04),@CC00945                            0480 00655000
*              /******************************************************/ 00656000
*              /*                                                    */ 00657000
*              /*  SET GETEOF TO OFF TO INDICATE THAT NO LOWER LEVEL */ 00658000
*              /*  PROCESSOR HAS GOTTEN AN END OF FILE.              */ 00659000
*              /*                                                    */ 00660000
*              /******************************************************/ 00661000
*                                                                  0481 00662000
*              GETEOF = OFF;                                       0481 00663000
*                                                                  0481 00664000
         NI    GETEOF,B'01111111'                                  0481 00665000
*              /******************************************************/ 00666000
*              /*                                                    */ 00667000
*              /*  NOW TEST THE TIME STAMP TO DETERMINE IF THE OBJECT*/ 00668000
*              /*  TO BE IMPORTED IS A NONVSAM.                      */ 00669000
*              /*                                                    */ 00670000
*              /******************************************************/ 00671000
*                                                                  0482 00672000
*              IF TEXNVS = ON                                      0482 00673000
*                THEN                                              0482 00674000
         L     @04,CONRCPTR                                        0482 00675000
         TM    TEXNVS+8(@04),B'00000100'                           0482 00676000
         BNO   @RF00482                                            0482 00677000
*NVSAM:            DO;                                             0483 00678000
*                                                                  0483 00679000
NVSAM    DS    0H                                                  0484 00680000
*                  /**************************************************/ 00681000
*                  /*                                                */ 00682000
*                  /*  INDICATE THAT NVSMPROC IS TO READ A           */ 00683000
*                  /*  CONTROL RECORD FROM THE PORTABLE DATA         */ 00684000
*                  /*  SET.                                          */ 00685000
*                  /*                                                */ 00686000
*                  /**************************************************/ 00687000
*                                                                  0484 00688000
*                  NVSMRDSW = OFF;                                 0484 00689000
*                                                                  0484 00690000
         NI    NVSMRDSW,B'01111111'                                0484 00691000
*                  /**************************************************/ 00692000
*                  /*                                                */ 00693000
*                  /*  WE HAVE A NON-VSAM OBJECT TO IMPORT.  CALL    */ 00694000
*                  /*  NVSMPROC TO HANDLE THE ACTUAL IMPORTATION.    */ 00695000
*                  /*                                                */ 00696000
*                  /**************************************************/ 00697000
*                                                                  0485 00698000
*                  CALL NVSMPROC;                                  0485 00699000
         BAL   @14,NVSMPROC                                        0485 00700000
*                  RESPECIFY RTNREG RSTD;                          0486 00701000
*                  TESTRC = RTNREG;                                0487 00702000
         STH   RTNREG,TESTRC                                       0487 00703000
*                  RESPECIFY RTNREG UNRSTD;                        0488 00704000
*                                                                  0488 00705000
*                  /**************************************************/ 00706000
*                  /*                                                */ 00707000
*                  /*  IF THE RETURN CODE FROM NVSMPROC IS 12, THEN A*/ 00708000
*                  /*  TERMINATING ERROR HAS BEEN DETECTED, SO THAT  */ 00709000
*                  /*  ENDFLAG MUST BE SET TO ON.  OTHERWISE, SETRC  */ 00710000
*                  /*  BECOMES THE MAXIMUM OF ITS CURRENT VALUE, AND */ 00711000
*                  /*  THAT OF TESTRC.                               */ 00712000
*                  /*                                                */ 00713000
*                  /**************************************************/ 00714000
*                                                                  0489 00715000
*                  IF TESTRC ^= 0                                  0489 00716000
*                    THEN                                          0489 00717000
         LH    @04,TESTRC                                          0489 00718000
         LTR   @04,@04                                             0489 00719000
         BZ    @RF00489                                            0489 00720000
*                      IF TESTRC = LASTCC12                        0490 00721000
*                        THEN                                      0490 00722000
         C     @04,@CF00035                                        0490 00723000
         BNE   @RF00490                                            0490 00724000
*                          DO;                                     0491 00725000
*                          ENDFLAG = ON;                           0492 00726000
         OI    ENDFLAG,B'10000000'                                 0492 00727000
*                          SETRC = MAX(TESTRC,SETRC);              0493 00728000
         LH    @15,SETRC                                           0493 00729000
         CR    @04,@15                                             0493 00730000
         BNL   *+6                                                      00731000
         LR    @04,@15                                             0493 00732000
         STH   @04,SETRC                                           0493 00733000
*                          END;                                    0494 00734000
*                        ELSE                                      0495 00735000
*                          DO;                                     0495 00736000
         B     @RC00490                                            0495 00737000
@RF00490 DS    0H                                                  0496 00738000
*                          SETRC = MAX(SETRC,TESTRC);              0496 00739000
*                                                                  0496 00740000
         LH    @04,SETRC                                           0496 00741000
         LH    @15,TESTRC                                          0496 00742000
         CR    @04,@15                                             0496 00743000
         BNL   *+6                                                      00744000
         LR    @04,@15                                             0496 00745000
         STH   @04,SETRC                                           0496 00746000
*                      /**********************************************/ 00747000
*                      /*                                            */ 00748000
*                      /*  DO REPEATED GETS UNTIL AN EOF IS FOUND.   */ 00749000
*                      /*  THIS REORIENTS THE PROCESSOR TO THE       */ 00750000
*                      /*  BEGINNING OF THE NEXT VALID ITEM IF ANY.  */ 00751000
*                      /*                                            */ 00752000
*                      /**********************************************/ 00753000
*                                                                  0497 00754000
*                          DO WHILE GETEOF = OFF;                  0497 00755000
         B     @DE00497                                            0497 00756000
@DL00497 DS    0H                                                  0498 00757000
*                            CALL IDCIOGT0(GDTTBL,PINIOCS);        0498 00758000
         L     @04,@PC00001                                        0498 00759000
         ST    @04,@AL00001                                        0498 00760000
         LA    @15,PINIOCS                                         0498 00761000
         ST    @15,@AL00001+4                                      0498 00762000
         MVI   @AL00001+4,X'80'                                    0498 00763000
         L     @15,GDTGET(,@04)                                    0498 00764000
         LA    @01,@AL00001                                        0498 00765000
         BALR  @14,@15                                             0498 00766000
*                            RESPECIFY RTNREG RSTD;                0499 00767000
*                            TESTRC = RTNREG;                      0500 00768000
         STH   RTNREG,TESTRC                                       0500 00769000
*                            RESPECIFY RTNREG UNRSTD;              0501 00770000
*                            IF TESTRC = 16                        0502 00771000
*                              THEN                                0502 00772000
         LH    @04,TESTRC                                          0502 00773000
         C     @04,@CF00483                                        0502 00774000
         BNE   @RF00502                                            0502 00775000
*                                GETEOF = ON;                      0503 00776000
         OI    GETEOF,B'10000000'                                  0503 00777000
*                          END;                                    0504 00778000
@RF00502 DS    0H                                                  0504 00779000
@DE00497 TM    GETEOF,B'10000000'                                  0504 00780000
         BZ    @DL00497                                            0504 00781000
*                          END;                                    0505 00782000
*                  END NVSAM;                                      0506 00783000
*                                                                  0506 00784000
*                ELSE                                              0507 00785000
*                  /**************************************************/ 00786000
*                  /*                                                */ 00787000
*                  /*  TEST THE TIMESTAMP TO DETERMINE IF THE OBJECT */ 00788000
*                  /*  IS A GDG BASE.                                */ 00789000
*                  /*                                                */ 00790000
*                  /**************************************************/ 00791000
*                                                                  0507 00792000
*                  IF TEXGDG = ON                                  0507 00793000
*                    THEN                                          0507 00794000
         B     @RC00482                                            0507 00795000
@RF00482 L     @04,CONRCPTR                                        0507 00796000
         TM    TEXGDG+8(@04),B'00000010'                           0507 00797000
         BNO   @RF00507                                            0507 00798000
*GDGBASE:              DO;                                         0508 00799000
*                                                                  0508 00800000
GDGBASE  DS    0H                                                  0509 00801000
*                      /**********************************************/ 00802000
*                      /*                                            */ 00803000
*                      /*  CALL GDGPROC TO HANDLE GDG BASES.         */ 00804000
*                      /*                                            */ 00805000
*                      /**********************************************/ 00806000
*                                                                  0509 00807000
*                      CALL GDGPROC;                               0509 00808000
         BAL   @14,GDGPROC                                         0509 00809000
*                      RESPECIFY RTNREG RSTD;                      0510 00810000
*                      TESTRC = RTNREG;                            0511 00811000
         STH   RTNREG,TESTRC                                       0511 00812000
*                      RESPECIFY RTNREG UNRSTD;                    0512 00813000
*                                                                  0512 00814000
*                      /**********************************************/ 00815000
*                      /*                                            */ 00816000
*                      /*  TEST THE RETURN CODE FROM GDGPROC.  IF IT */ 00817000
*                      /*  IS 12, THEN SET ENDFLAG TO BE ON TO       */ 00818000
*                      /*  TERMINATE FURTHER PROCESSING.  OTHERWISE, */ 00819000
*                      /*  SET THE VALUE OF SETRC TO BE THE MAXIMUM  */ 00820000
*                      /*  OF ITS CURRENT VALUE, AND THE VALUE OF    */ 00821000
*                      /*  TESTRC.                                   */ 00822000
*                      /*                                            */ 00823000
*                      /**********************************************/ 00824000
*                                                                  0513 00825000
*                      RESPECIFY RTNREG RSTD;                      0513 00826000
*                      TESTRC = RTNREG;                            0514 00827000
         STH   RTNREG,TESTRC                                       0514 00828000
*                      RESPECIFY RTNREG UNRSTD;                    0515 00829000
*                      IF TESTRC ^= 0                              0516 00830000
*                        THEN                                      0516 00831000
         LH    @04,TESTRC                                          0516 00832000
         LTR   @04,@04                                             0516 00833000
         BZ    @RF00516                                            0516 00834000
*                          IF TESTRC = LASTCC12                    0517 00835000
*                            THEN                                  0517 00836000
         C     @04,@CF00035                                        0517 00837000
         BNE   @RF00517                                            0517 00838000
*                              DO;                                 0518 00839000
*                              ENDFLAG = ON;                       0519 00840000
         OI    ENDFLAG,B'10000000'                                 0519 00841000
*                              SETRC = MAX(TESTRC,SETRC);          0520 00842000
         LH    @15,SETRC                                           0520 00843000
         CR    @04,@15                                             0520 00844000
         BNL   *+6                                                      00845000
         LR    @04,@15                                             0520 00846000
         STH   @04,SETRC                                           0520 00847000
*                              END;                                0521 00848000
*                            ELSE                                  0522 00849000
*                              DO;                                 0522 00850000
         B     @RC00517                                            0522 00851000
@RF00517 DS    0H                                                  0523 00852000
*                              SETRC = MAX(TESTRC,SETRC);          0523 00853000
*                                                                  0523 00854000
         LH    @04,TESTRC                                          0523 00855000
         LH    @15,SETRC                                           0523 00856000
         CR    @04,@15                                             0523 00857000
         BNL   *+6                                                      00858000
         LR    @04,@15                                             0523 00859000
         STH   @04,SETRC                                           0523 00860000
*                          /******************************************/ 00861000
*                          /*                                        */ 00862000
*                          /*  DO REPEATED GETS UNTIL AN EOF IS      */ 00863000
*                          /*  FOUND.  THIS REORIENTS THE PROCESSOR  */ 00864000
*                          /*  TO THE BEGINNING OF THE NEXT VALID    */ 00865000
*                          /*  ITEM ON THE PORTABLE DATA SET.        */ 00866000
*                          /*                                        */ 00867000
*                          /******************************************/ 00868000
*                                                                  0524 00869000
*                              DO WHILE GETEOF = OFF;              0524 00870000
         B     @DE00524                                            0524 00871000
@DL00524 DS    0H                                                  0525 00872000
*                                CALL IDCIOGT0(GDTTBL,PINIOCS);    0525 00873000
         L     @04,@PC00001                                        0525 00874000
         ST    @04,@AL00001                                        0525 00875000
         LA    @15,PINIOCS                                         0525 00876000
         ST    @15,@AL00001+4                                      0525 00877000
         MVI   @AL00001+4,X'80'                                    0525 00878000
         L     @15,GDTGET(,@04)                                    0525 00879000
         LA    @01,@AL00001                                        0525 00880000
         BALR  @14,@15                                             0525 00881000
*                                RESPECIFY RTNREG RSTD;            0526 00882000
*                                TESTRC = RTNREG;                  0527 00883000
         STH   RTNREG,TESTRC                                       0527 00884000
*                                RESPECIFY RTNREG UNRSTD;          0528 00885000
*                                IF TESTRC = 16                    0529 00886000
*                                  THEN                            0529 00887000
         LH    @04,TESTRC                                          0529 00888000
         C     @04,@CF00483                                        0529 00889000
         BNE   @RF00529                                            0529 00890000
*                                    GETEOF = ON;                  0530 00891000
         OI    GETEOF,B'10000000'                                  0530 00892000
*                              END;                                0531 00893000
@RF00529 DS    0H                                                  0531 00894000
@DE00524 TM    GETEOF,B'10000000'                                  0531 00895000
         BZ    @DL00524                                            0531 00896000
*                              END;                                0532 00897000
*                                                                  0532 00898000
*                      END GDGBASE;                                0533 00899000
*                                                                  0533 00900000
*                    ELSE                                          0534 00901000
*                                                                  0534 00902000
*                      /**********************************************/ 00903000
*                      /*                                            */ 00904000
*                      /*  IF THE TIMESTAMP INDICATES THAT WE HAVE   */ 00905000
*                      /*  A USERCATALOG POINTER TO REESTABLISH      */ 00906000
*                      /*  IN THE CATALOG, CALL UCATPROC TO HANDLE   */ 00907000
*                      /*  THE USER CATALOG, AND ITS ALIASES IF ANY. */ 00908000
*                      /*                                            */ 00909000
*                      /**********************************************/ 00910000
*                                                                  0534 00911000
*                      IF TEXUCT = ON                              0534 00912000
*                        THEN                                      0534 00913000
         B     @RC00507                                            0534 00914000
@RF00507 L     @04,CONRCPTR                                        0534 00915000
         TM    TEXUCT+8(@04),B'00000001'                           0534 00916000
         BNO   @RF00534                                            0534 00917000
*USERCAT:                  DO;                                     0535 00918000
USERCAT  DS    0H                                                  0536 00919000
*                          CALL UCATPROC;                          0536 00920000
*                                                                  0536 00921000
         BAL   @14,UCATPROC                                        0536 00922000
*                          /******************************************/ 00923000
*                          /*                                        */ 00924000
*                          /*  TEST THE RETURN CODE FROM UCATPROC.   */ 00925000
*                          /*  IF IS IS 12, THEN UCATPROC ENCOUNTERED*/ 00926000
*                          /*  A TERMINATING ERROR.  SET ENDFLAG     */ 00927000
*                          /*  TO ESCAPE THE CURRENT LOOP.  OTHERWISE*/ 00928000
*                          /*  MAKE SETRC EQUAL TO THE MAXIMUM OF ITS*/ 00929000
*                          /*  PRESENT VALUE AND THAT OF TESTRC.     */ 00930000
*                          /*                                        */ 00931000
*                          /******************************************/ 00932000
*                                                                  0537 00933000
*                          RESPECIFY RTNREG RSTD;                  0537 00934000
*                          TESTRC = RTNREG;                        0538 00935000
         STH   RTNREG,TESTRC                                       0538 00936000
*                          RESPECIFY RTNREG UNRSTD;                0539 00937000
*                                                                  0539 00938000
*                          IF TESTRC ^= 0                          0540 00939000
*                            THEN                                  0540 00940000
         LH    @04,TESTRC                                          0540 00941000
         LTR   @04,@04                                             0540 00942000
         BZ    @RF00540                                            0540 00943000
*                              IF TESTRC = LASTCC12                0541 00944000
*                                THEN                              0541 00945000
         C     @04,@CF00035                                        0541 00946000
         BNE   @RF00541                                            0541 00947000
*                                  DO;                             0542 00948000
*                                  ENDFLAG = ON;                   0543 00949000
         OI    ENDFLAG,B'10000000'                                 0543 00950000
*                                  SETRC = MAX(TESTRC,SETRC);      0544 00951000
         LH    @15,SETRC                                           0544 00952000
         CR    @04,@15                                             0544 00953000
         BNL   *+6                                                      00954000
         LR    @04,@15                                             0544 00955000
         STH   @04,SETRC                                           0544 00956000
*                                  END;                            0545 00957000
*                                ELSE                              0546 00958000
*                                  DO;                             0546 00959000
         B     @RC00541                                            0546 00960000
@RF00541 DS    0H                                                  0547 00961000
*                                  SETRC = MAX(TESTRC,SETRC);      0547 00962000
*                                                                  0547 00963000
         LH    @04,TESTRC                                          0547 00964000
         LH    @15,SETRC                                           0547 00965000
         CR    @04,@15                                             0547 00966000
         BNL   *+6                                                      00967000
         LR    @04,@15                                             0547 00968000
         STH   @04,SETRC                                           0547 00969000
*                              /**************************************/ 00970000
*                              /*                                    */ 00971000
*                              /*  DO REPEATED GETS TO REACH AN EOF. */ 00972000
*                              /*                                    */ 00973000
*                              /**************************************/ 00974000
*                                                                  0548 00975000
*                                  DO WHILE GETEOF = OFF;          0548 00976000
         B     @DE00548                                            0548 00977000
@DL00548 DS    0H                                                  0549 00978000
*                                    CALL IDCIOGT0(GDTTBL,PINIOCS);     00979000
         L     @04,@PC00001                                        0549 00980000
         ST    @04,@AL00001                                        0549 00981000
         LA    @15,PINIOCS                                         0549 00982000
         ST    @15,@AL00001+4                                      0549 00983000
         MVI   @AL00001+4,X'80'                                    0549 00984000
         L     @15,GDTGET(,@04)                                    0549 00985000
         LA    @01,@AL00001                                        0549 00986000
         BALR  @14,@15                                             0549 00987000
*                                    RESPECIFY RTNREG RSTD;        0550 00988000
*                                    TESTRC = RTNREG;              0551 00989000
         STH   RTNREG,TESTRC                                       0551 00990000
*                                    RESPECIFY RTNREG UNRSTD;      0552 00991000
*                                    IF TESTRC = 16                0553 00992000
*                                      THEN                        0553 00993000
         LH    @04,TESTRC                                          0553 00994000
         C     @04,@CF00483                                        0553 00995000
         BNE   @RF00553                                            0553 00996000
*                                        GETEOF = ON;              0554 00997000
         OI    GETEOF,B'10000000'                                  0554 00998000
*                                  END;                            0555 00999000
@RF00553 DS    0H                                                  0555 01000000
@DE00548 TM    GETEOF,B'10000000'                                  0555 01001000
         BZ    @DL00548                                            0555 01002000
*                                  END;                            0556 01003000
*                          END USERCAT;                            0557 01004000
*                                                                  0557 01005000
*                        ELSE                                      0558 01006000
*                                                                  0558 01007000
*VSAM:                     DO;                                     0558 01008000
*                                                                  0558 01009000
         B     @RC00534                                            0558 01010000
@RF00534 DS    0H                                                  0558 01011000
VSAM     DS    0H                                                  0559 01012000
*                          /******************************************/ 01013000
*                          /*                                        */ 01014000
*                          /*     PROCESS IMPORTATION OF A           */ 01015000
*                          /*  CLUSTER OR AN AIX.                    */ 01016000
*                          /*                                        */ 01017000
*                          /******************************************/ 01018000
*                                                                  0559 01019000
*                          CALL CLUSPROC;                          0559 01020000
         BAL   @14,CLUSPROC                                        0559 01021000
*                          RESPECIFY RTNREG RSTD;                  0560 01022000
*                          TESTRC = RTNREG;                        0561 01023000
         STH   RTNREG,TESTRC                                       0561 01024000
*                          RESPECIFY RTNREG UNRSTD;                0562 01025000
*                                                                  0562 01026000
*                          IF TESTRC ^= 0                          0563 01027000
*                            THEN                                  0563 01028000
         LH    @04,TESTRC                                          0563 01029000
         LTR   @04,@04                                             0563 01030000
         BZ    @RF00563                                            0563 01031000
*                              IF TESTRC = LASTCC12                0564 01032000
*                                THEN                              0564 01033000
         C     @04,@CF00035                                        0564 01034000
         BNE   @RF00564                                            0564 01035000
*                                  DO;                             0565 01036000
*                                  ENDFLAG = ON;                   0566 01037000
         OI    ENDFLAG,B'10000000'                                 0566 01038000
*                                  SETRC = MAX(TESTRC,SETRC);      0567 01039000
         LH    @15,SETRC                                           0567 01040000
         CR    @04,@15                                             0567 01041000
         BNL   *+6                                                      01042000
         LR    @04,@15                                             0567 01043000
         STH   @04,SETRC                                           0567 01044000
*                                  END;                            0568 01045000
*                                ELSE                              0569 01046000
*                                  DO;                             0569 01047000
         B     @RC00564                                            0569 01048000
@RF00564 DS    0H                                                  0570 01049000
*                                  SETRC = MAX(TESTRC,SETRC);      0570 01050000
*                                                                  0570 01051000
         LH    @04,TESTRC                                          0570 01052000
         LH    @15,SETRC                                           0570 01053000
         CR    @04,@15                                             0570 01054000
         BNL   *+6                                                      01055000
         LR    @04,@15                                             0570 01056000
         STH   @04,SETRC                                           0570 01057000
*                              /**************************************/ 01058000
*                              /*                                    */ 01059000
*                              /*  DO REPEATED GETS TO REACH AN EOF. */ 01060000
*                              /*                                    */ 01061000
*                              /**************************************/ 01062000
*                                                                  0571 01063000
*                                  DO WHILE GETEOF = OFF;          0571 01064000
         B     @DE00571                                            0571 01065000
@DL00571 DS    0H                                                  0572 01066000
*                                    CALL IDCIOGT0(GDTTBL,PINIOCS);     01067000
         L     @04,@PC00001                                        0572 01068000
         ST    @04,@AL00001                                        0572 01069000
         LA    @15,PINIOCS                                         0572 01070000
         ST    @15,@AL00001+4                                      0572 01071000
         MVI   @AL00001+4,X'80'                                    0572 01072000
         L     @15,GDTGET(,@04)                                    0572 01073000
         LA    @01,@AL00001                                        0572 01074000
         BALR  @14,@15                                             0572 01075000
*                                    RESPECIFY RTNREG RSTD;        0573 01076000
*                                    TESTRC = RTNREG;              0574 01077000
         STH   RTNREG,TESTRC                                       0574 01078000
*                                    RESPECIFY RTNREG UNRSTD;      0575 01079000
*                                    IF TESTRC = 16                0576 01080000
*                                      THEN                        0576 01081000
         LH    @04,TESTRC                                          0576 01082000
         C     @04,@CF00483                                        0576 01083000
         BNE   @RF00576                                            0576 01084000
*                                        GETEOF = ON;              0577 01085000
         OI    GETEOF,B'10000000'                                  0577 01086000
*                                  END;                            0578 01087000
@RF00576 DS    0H                                                  0578 01088000
@DE00571 TM    GETEOF,B'10000000'                                  0578 01089000
         BZ    @DL00571                                            0578 01090000
*                                  END;                            0579 01091000
*                                                                  0579 01092000
*                          /******************************************/ 01093000
*                          /*                                        */ 01094000
*                          /*  IF CLUSPROC HAS SET THE IMPF2DEL BIT, */ 01095000
*                          /*  THEN THE OBJECT THAT WAS DEFINED MUST */ 01096000
*                          /*  BE DELETED.                           */ 01097000
*                          /*                                        */ 01098000
*                          /******************************************/ 01099000
*                                                                  0580 01100000
*                          IF IMPF2DEL = ON                        0580 01101000
*                            THEN                                  0580 01102000
@RC00564 DS    0H                                                  0580 01103000
@RF00563 TM    IMPF2DEL,B'01000000'                                0580 01104000
         BNO   @RF00580                                            0580 01105000
*DELVSAM:                      DO;                                 0581 01106000
*                                                                  0581 01107000
DELVSAM  DS    0H                                                  0582 01108000
*                              /**************************************/ 01109000
*                              /*                                    */ 01110000
*                              /*  CTGPLPTR AND CTGFVPTR POINT TO    */ 01111000
*                              /*  THE CPL AND THE FVT FOR THE OBJECT*/ 01112000
*                              /*  DEFINED.  PRINT A MESSAGE         */ 01113000
*                              /*  INDICATING THAT THE OBJECT IS TO  */ 01114000
*                              /*  BE DELETED.                       */ 01115000
*                              /*                                    */ 01116000
*                              /**************************************/ 01117000
*                                                                  0582 01118000
*                              CTGPLPTR = PTRCPL;                  0582 01119000
         L     @04,PTRCPL                                          0582 01120000
         ST    @04,CTGPLPTR                                        0582 01121000
*                              CTGFVPTR = CTGFVT;                  0583 01122000
         L     @04,CTGFVT(,@04)                                    0583 01123000
         ST    @04,CTGFVPTR                                        0583 01124000
*                              DARGSMOD = IMPMSG;                  0584 01125000
         L     @04,DDSTRU                                          0584 01126000
         MVC   DARGSMOD(3,@04),@CC00945                            0584 01127000
*                              DARGSENT = IDELFAIL;                0585 01128000
*                                                                  0585 01129000
         MVI   DARGSENT(@04),X'09'                                 0585 01130000
*                              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);    01131000
*                                                                  0586 01132000
         L     @04,@PC00001                                        0586 01133000
         ST    @04,@AL00001                                        0586 01134000
         LA    @15,@CF00119                                        0586 01135000
         ST    @15,@AL00001+4                                      0586 01136000
         LA    @15,DDSTRU                                          0586 01137000
         ST    @15,@AL00001+8                                      0586 01138000
         MVI   @AL00001+8,X'80'                                    0586 01139000
         L     @15,GDTPRT(,@04)                                    0586 01140000
         LA    @01,@AL00001                                        0586 01141000
         BALR  @14,@15                                             0586 01142000
*                              DARGLIST = ''B;                     0587 01143000
         L     @04,DDSTRU                                          0587 01144000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0587 01145000
*                              DARGSMOD = IMPMSG;                  0588 01146000
*                                                                  0588 01147000
         MVC   DARGSMOD(3,@04),@CC00945                            0588 01148000
*                              /**************************************/ 01149000
*                              /*                                    */ 01150000
*                              /*  CALL CPLPROC TO BUILD A CPL FOR   */ 01151000
*                              /*  THE CMS DELETE OPERATION.         */ 01152000
*                              /*  THEN CALL DELTPROC TO DELETE THE  */ 01153000
*                              /*  OBJECT.                           */ 01154000
*                              /*                                    */ 01155000
*                              /**************************************/ 01156000
*                                                                  0589 01157000
*                              CALL CPLPROC('D',DCPLPTR,CTGFVENT,  0589 01158000
*                                 NULLPARM,CPSWD);                 0589 01159000
*                                                                  0589 01160000
         LA    @04,@CC00751                                        0589 01161000
         ST    @04,@AL00001                                        0589 01162000
         LA    @04,DCPLPTR                                         0589 01163000
         ST    @04,@AL00001+4                                      0589 01164000
         L     @04,CTGPLPTR                                        0589 01165000
         L     @04,CTGFVT(,@04)                                    0589 01166000
         LA    @04,CTGFVENT(,@04)                                  0589 01167000
         ST    @04,@AL00001+8                                      0589 01168000
         LA    @04,NULLPARM                                        0589 01169000
         ST    @04,@AL00001+12                                     0589 01170000
         LA    @04,CPSWD                                           0589 01171000
         ST    @04,@AL00001+16                                     0589 01172000
         LA    @01,@AL00001                                        0589 01173000
         BAL   @14,CPLPROC                                         0589 01174000
*                              RESPECIFY RTNREG RSTD;              0590 01175000
*                              TESTRC = RTNREG;                    0591 01176000
         STH   RTNREG,TESTRC                                       0591 01177000
*                              RESPECIFY RTNREG UNRSTD;            0592 01178000
*                              IF TESTRC ^= 0                      0593 01179000
*                                THEN                              0593 01180000
         LH    @04,TESTRC                                          0593 01181000
         LTR   @04,@04                                             0593 01182000
         BZ    @RF00593                                            0593 01183000
*                                  DO;                             0594 01184000
*                                  ENDFLAG = ON;                   0595 01185000
         OI    ENDFLAG,B'10000000'                                 0595 01186000
*                                  SETRC = MAX(SETRC,TESTRC);      0596 01187000
         LH    @15,SETRC                                           0596 01188000
         CR    @15,@04                                             0596 01189000
         BNL   *+6                                                      01190000
         LR    @15,@04                                             0596 01191000
         STH   @15,SETRC                                           0596 01192000
*                                  END;                            0597 01193000
*                                                                  0597 01194000
*                              /**************************************/ 01195000
*                              /*                                    */ 01196000
*                              /*  SET THE CTGTYPE FIELD OF THE      */ 01197000
*                              /*  CPL.                              */ 01198000
*                              /*                                    */ 01199000
*                              /**************************************/ 01200000
*                                                                  0598 01201000
*                              DCPLPTR -> CTGTYPE = FVTPTR(1)->    0598 01202000
*                                 CTGFVTYP;                        0598 01203000
@RF00593 L     @04,DCPLPTR                                         0598 01204000
         L     @01,FVTPTR                                          0598 01205000
         MVC   CTGTYPE(1,@04),CTGFVTYP(@01)                        0598 01206000
*                              CALL DELTPROC(DCPLPTR);             0599 01207000
*                                                                  0599 01208000
         LA    @04,DCPLPTR                                         0599 01209000
         ST    @04,@AL00001                                        0599 01210000
         LA    @01,@AL00001                                        0599 01211000
         BAL   @14,DELTPROC                                        0599 01212000
*                              RESPECIFY RTNREG RSTD;              0600 01213000
*                              TESTRC = RTNREG;                    0601 01214000
         STH   RTNREG,TESTRC                                       0601 01215000
*                              RESPECIFY RTNREG UNRSTD;            0602 01216000
*                              IF TESTRC ^= 0                      0603 01217000
*                                THEN                              0603 01218000
         LH    @04,TESTRC                                          0603 01219000
         LTR   @04,@04                                             0603 01220000
         BZ    @RF00603                                            0603 01221000
*                                  SETRC = MAX(SETRC,TESTRC);      0604 01222000
         LH    @15,SETRC                                           0604 01223000
         CR    @15,@04                                             0604 01224000
         BNL   *+6                                                      01225000
         LR    @15,@04                                             0604 01226000
         STH   @15,SETRC                                           0604 01227000
*                              END DELVSAM;                        0605 01228000
@RF00603 DS    0H                                                  0606 01229000
*                          /*********************************@OZ17068*/ 01230000
*                          /*                                @OZ17068*/ 01231000
*                          /*  TEST THE IMPORTRA MESSAGE     @OZ17068*/ 01232000
*                          /*  FLAGS AND PRINT THE MESSAGES  @OZ17068*/ 01233000
*                          /*  INDICATED. THESE MESSAGES ARE @OZ17068*/ 01234000
*                          /*  TO BE PRINTED AFTER THE DELETE@OZ17068*/ 01235000
*                          /*  MESSAGE IF IMPF2DEL IS ON.    @OZ17068*/ 01236000
*                          /*                                @OZ17068*/ 01237000
*                          /*********************************@OZ17068*/ 01238000
*                                                          /*@OZ17068*/ 01239000
*                          IF IMPMFIMF = ON /*IMPORTRA FAILED@OZ17068*/ 01240000
*                            THEN                          /*@OZ17068*/ 01241000
@RF00580 TM    IMPMFIMF,B'10000000'                                0606 01242000
         BNO   @RF00606                                            0606 01243000
*                              DO;                         /*@OZ17068*/ 01244000
*                              CTGPLPTR = PTRCPL;          /*@OZ17068*/ 01245000
         L     @04,PTRCPL                                          0608 01246000
         ST    @04,CTGPLPTR                                        0608 01247000
*                              CTGFVPTR = CTGFVT;          /*@OZ17068*/ 01248000
         L     @04,CTGFVT(,@04)                                    0609 01249000
         ST    @04,CTGFVPTR                                        0609 01250000
*                              DARGLIST = ''B;             /*@OZ17068*/ 01251000
         L     @04,DDSTRU                                          0610 01252000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0610 01253000
*                              DARGSMOD = IMPMSG;          /*@OZ17068*/ 01254000
         MVC   DARGSMOD(3,@04),@CC00945                            0611 01255000
*                              DARGSENT = MPRAFAIL;        /*@OZ17068*/ 01256000
         MVI   DARGSENT(@04),X'15'                                 0612 01257000
*                              DARGILP = LENGTH(FENTNAME); /*@OZ17068*/ 01258000
         MVC   DARGILP(2,@04),@CH00605                             0613 01259000
*                              DARGDBP =                   /*@OZ17068*/ 01260000
*                                  FVTPTR(1)->CTGFVENT;    /*@OZ17068*/ 01261000
         L     @01,FVTPTR                                          0614 01262000
         L     @15,CTGFVENT(,@01)                                  0614 01263000
         ST    @15,DARGDBP(,@04)                                   0614 01264000
*                                                          /*@OZ17068*/ 01265000
*                              CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);   01266000
         L     @04,@PC00001                                        0615 01267000
         ST    @04,@AL00001                                        0615 01268000
         LA    @15,@CF00119                                        0615 01269000
         ST    @15,@AL00001+4                                      0615 01270000
         LA    @15,DDSTRU                                          0615 01271000
         ST    @15,@AL00001+8                                      0615 01272000
         MVI   @AL00001+8,X'80'                                    0615 01273000
         L     @15,GDTPRT(,@04)                                    0615 01274000
         LA    @01,@AL00001                                        0615 01275000
         BALR  @14,@15                                             0615 01276000
*                                                          /*@OZ17068*/ 01277000
*                              DARGLIST = ''B;             /*@OZ17068*/ 01278000
         L     @04,DDSTRU                                          0616 01279000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0616 01280000
*                              DARGSMOD = IMPMSG;          /*@OZ17068*/ 01281000
         MVC   DARGSMOD(3,@04),@CC00945                            0617 01282000
*                              END;                        /*@OZ17068*/ 01283000
*                                                          /*@OZ17068*/ 01284000
*                          IF IMPMFDNM = ON /*DUMMY NAME IN  @OZ17068*/ 01285000
*                            THEN           /*CATALOG        @OZ17068*/ 01286000
@RF00606 TM    IMPMFDNM,B'01000000'                                0619 01287000
         BNO   @RF00619                                            0619 01288000
*                              DO;                         /*@OZ17068*/ 01289000
*                              DARGLIST = ''B;             /*@OZ17068*/ 01290000
         L     @04,DDSTRU                                          0621 01291000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0621 01292000
*                              DARGSMOD = IMPMSG;          /*@OZ17068*/ 01293000
         MVC   DARGSMOD(3,@04),@CC00945                            0622 01294000
*                              DARGSENT = DNMINCAT;        /*@OZ17068*/ 01295000
         MVI   DARGSENT(@04),X'1C'                                 0623 01296000
*                                                          /*@OZ17068*/ 01297000
*                              CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);   01298000
         L     @04,@PC00001                                        0624 01299000
         ST    @04,@AL00001                                        0624 01300000
         LA    @15,@CF00119                                        0624 01301000
         ST    @15,@AL00001+4                                      0624 01302000
         LA    @15,DDSTRU                                          0624 01303000
         ST    @15,@AL00001+8                                      0624 01304000
         MVI   @AL00001+8,X'80'                                    0624 01305000
         L     @15,GDTPRT(,@04)                                    0624 01306000
         LA    @01,@AL00001                                        0624 01307000
         BALR  @14,@15                                             0624 01308000
*                                                          /*@OZ17068*/ 01309000
*                              DARGLIST = ''B;             /*@OZ17068*/ 01310000
         L     @04,DDSTRU                                          0625 01311000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0625 01312000
*                              DARGSMOD = IMPMSG;          /*@OZ17068*/ 01313000
         MVC   DARGSMOD(3,@04),@CC00945                            0626 01314000
*                              END;                        /*@OZ17068*/ 01315000
*                        END VSAM;                                 0628 01316000
@RF00619 DS    0H                                                  0629 01317000
*              END NOTEND;                                         0629 01318000
@RC00534 DS    0H                                                  0629 01319000
@RC00507 DS    0H                                                  0629 01320000
@RC00482 DS    0H                                                  0630 01321000
*          /**********************************************************/ 01322000
*          /*                                                        */ 01323000
*          /*  IF THE DEALLOC BIT IS SET, THERE IS SOMETHING TO      */ 01324000
*          /*  DYNAMICALLY UNALLOCATE.  ISSUE THE UDEALLOC MACRO.    */ 01325000
*          /*                                                        */ 01326000
*          /**********************************************************/ 01327000
*                                                                  0630 01328000
*          IF DEALLOC = ON                                         0630 01329000
*            THEN                                                  0630 01330000
@RF00460 TM    DEALLOC,B'10000000'                                 0630 01331000
         BNO   @RF00630                                            0630 01332000
*              CALL IDCSADL0(GDTTBL,ALLAGL);                       0631 01333000
*                                                                  0631 01334000
         L     @04,@PC00001                                        0631 01335000
         ST    @04,@AL00001                                        0631 01336000
         L     @01,ALLPTR                                          0631 01337000
         ST    @01,@AL00001+4                                      0631 01338000
         MVI   @AL00001+4,X'80'                                    0631 01339000
         L     @15,GDTDLC(,@04)                                    0631 01340000
         LA    @01,@AL00001                                        0631 01341000
         BALR  @14,@15                                             0631 01342000
*          /*************************************************@OZ16022*/ 01343000
*          /*                                                @OZ16022*/ 01344000
*          /*  TEST FOR ANY SPECIAL MESSAGES TO BE LISTED    @OZ16022*/ 01345000
*          /*  ERROR OR INFORMATIONAL                        @OZ16022*/ 01346000
*          /*                                                @OZ16022*/ 01347000
*          /*************************************************@OZ16022*/ 01348000
*                                                          /*@OZ16022*/ 01349000
*          IF DEFSTID ^= NORMSTAT                          /*@OZ16022*/ 01350000
*            THEN                                          /*@OZ16022*/ 01351000
@RF00630 CLI   DEFSTID,0                                           0632 01352000
         BE    @RF00632                                            0632 01353000
*              DO;                                         /*@OZ16022*/ 01354000
*              DARGSENT = DEFSTID;                         /*@OZ16022*/ 01355000
         IC    @04,DEFSTID                                         0634 01356000
         L     @01,DDSTRU                                          0634 01357000
         STC   @04,DARGSENT(,@01)                                  0634 01358000
*                                                          /*@OZ16022*/ 01359000
*              CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);      /*@OZ16022*/ 01360000
         L     @04,@PC00001                                        0635 01361000
         ST    @04,@AL00001                                        0635 01362000
         LA    @15,@CF00119                                        0635 01363000
         ST    @15,@AL00001+4                                      0635 01364000
         LA    @15,DDSTRU                                          0635 01365000
         ST    @15,@AL00001+8                                      0635 01366000
         MVI   @AL00001+8,X'80'                                    0635 01367000
         L     @15,GDTPRT(,@04)                                    0635 01368000
         LA    @01,@AL00001                                        0635 01369000
         BALR  @14,@15                                             0635 01370000
*                                                          /*@OZ16022*/ 01371000
*              END;                                        /*@OZ16022*/ 01372000
*                                                          /*@OZ16022*/ 01373000
*          /**********************************************************/ 01374000
*          /*                                                        */ 01375000
*          /*  RESET THE VALUES IN THE DARGLIST.                     */ 01376000
*          /*                                                        */ 01377000
*          /**********************************************************/ 01378000
*                                                                  0637 01379000
*          DARGLIST = ''B;                                         0637 01380000
@RF00632 L     @04,DDSTRU                                          0637 01381000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0637 01382000
*          DARGSMOD = IMPMSG;                                      0638 01383000
         MVC   DARGSMOD(3,@04),@CC00945                            0638 01384000
*          DEFSTID = NORMSTAT;                                     0639 01385000
*                                                                  0639 01386000
         MVI   DEFSTID,X'00'                                       0639 01387000
*          /**********************************************************/ 01388000
*          /*                                                        */ 01389000
*          /*  FREE ANY STORAGE GOTTEN DURING THIS ITERATION THAT    */ 01390000
*          /*  HAS NOT ALREADY BEEN FREED.                           */ 01391000
*          /*                                                        */ 01392000
*          /**********************************************************/ 01393000
*                                                                  0640 01394000
*          CALL IDCSAFP0(GDTTBL,GPID);                             0640 01395000
*                                                                  0640 01396000
         L     @04,@PC00001                                        0640 01397000
         ST    @04,@AL00001                                        0640 01398000
         LA    @15,GPID                                            0640 01399000
         ST    @15,@AL00001+4                                      0640 01400000
         MVI   @AL00001+4,X'80'                                    0640 01401000
         L     @15,GDTFPL(,@04)                                    0640 01402000
         LA    @01,@AL00001                                        0640 01403000
         BALR  @14,@15                                             0640 01404000
*        END MPLOOP;                                               0641 01405000
@DE00432 TM    ENDFLAG,B'10000000'                                 0641 01406000
         BZ    @DL00432                                            0641 01407000
*        OLDERID2 = NEWERID2;                                      0642 01408000
         L     @04,@PC00001                                        0642 01409000
         L     @15,GDTTR2(,@04)                                    0642 01410000
         MVC   @TS00001(95),NEWERID2(@15)                          0642 01411000
         MVC   OLDERID2(95,@15),@TS00001                           0642 01412000
*        NEWID2 = 'RMEL';                                          0643 01413000
*                                                                  0643 01414000
         MVC   NEWID2(4,@15),@CC01330                              0643 01415000
*        /************************************************************/ 01416000
*        /*                                                          */ 01417000
*        /*   TERMINATION PROCESSING WILL LIST APPROPRIATE ERROR     */ 01418000
*        /*   MESSAGES, AND INDICATE THE FINAL STATUS OF IMPORT      */ 01419000
*        /*   IN LASTCC.                                             */ 01420000
*        /*                                                          */ 01421000
*        /************************************************************/ 01422000
*                                                                  0644 01423000
*        IF GDTDBG = NULLPTR                                       0644 01424000
*          THEN;                                                   0644 01425000
         L     @04,GDTDBG(,@04)                                    0644 01426000
         LTR   @04,@04                                             0644 01427000
         BZ    @RT00644                                            0644 01428000
*          ELSE                                                    0646 01429000
*            CALL IDCDB010 (GDTTBL,'RMFN');                        0646 01430000
*                                                                  0646 01431000
         L     @04,@PC00001                                        0646 01432000
         ST    @04,@AL00001                                        0646 01433000
         LA    @15,@CC01331                                        0646 01434000
         ST    @15,@AL00001+4                                      0646 01435000
         MVI   @AL00001+4,X'80'                                    0646 01436000
         L     @15,GDTDBG(,@04)                                    0646 01437000
         LA    @01,@AL00001                                        0646 01438000
         BALR  @14,@15                                             0646 01439000
*        /************************************************************/ 01440000
*        /*                                                          */ 01441000
*        /*  CLOSE ANY OPEN DATA SETS                                */ 01442000
*        /*                                                          */ 01443000
*        /************************************************************/ 01444000
*                                                                  0647 01445000
*        IF POUTIOCS ^= NULLPTR                                    0647 01446000
*          THEN                                                    0647 01447000
@RT00644 L     @04,POUTIOCS                                        0647 01448000
         LTR   @04,@04                                             0647 01449000
         BZ    @RF00647                                            0647 01450000
*            CALL IDCIOCL0 (GDTTBL,POUTIOCS);/*                    0648 01451000
*                                        OUTPUT - THE CLUSTER        */ 01452000
*                                                                  0648 01453000
         L     @04,@PC00001                                        0648 01454000
         ST    @04,@AL00001                                        0648 01455000
         LA    @15,POUTIOCS                                        0648 01456000
         ST    @15,@AL00001+4                                      0648 01457000
         MVI   @AL00001+4,X'80'                                    0648 01458000
         L     @15,GDTCLS(,@04)                                    0648 01459000
         LA    @01,@AL00001                                        0648 01460000
         BALR  @14,@15                                             0648 01461000
*        IF PINIOCS ^= NULLPTR         /*INPUT - PORTABLE DATA SET   */ 01462000
*          THEN                                                    0649 01463000
@RF00647 L     @04,PINIOCS                                         0649 01464000
         LTR   @04,@04                                             0649 01465000
         BZ    @RF00649                                            0649 01466000
*            CALL IDCIOCL0 (GDTTBL,PINIOCS);                       0650 01467000
*                                                                  0650 01468000
         L     @04,@PC00001                                        0650 01469000
         ST    @04,@AL00001                                        0650 01470000
         LA    @15,PINIOCS                                         0650 01471000
         ST    @15,@AL00001+4                                      0650 01472000
         MVI   @AL00001+4,X'80'                                    0650 01473000
         L     @15,GDTCLS(,@04)                                    0650 01474000
         LA    @01,@AL00001                                        0650 01475000
         BALR  @14,@15                                             0650 01476000
*        /************************************************************/ 01477000
*        /*                                                          */ 01478000
*        /*  ISSUE FINAL COMPLETION MESSAGE INDICATING WHETHER       */ 01479000
*        /*  IMPORT WAS SUCCESSFUL OR NOT.                           */ 01480000
*        /*  SET LASTCC TO INDICATE SUCCESS OR FAILURE TO THE        */ 01481000
*        /*  AMS EXECUTIVE                                           */ 01482000
*        /*                                                          */ 01483000
*        /************************************************************/ 01484000
*                                                                  0651 01485000
*        IF (SETRC > LASTCC00) & (GDTECT ^= NULLPTR)               0651 01486000
*          THEN                                                    0651 01487000
@RF00649 SLR   @04,@04                                             0651 01488000
         CH    @04,SETRC                                           0651 01489000
         BNL   @RF00651                                            0651 01490000
         L     @15,@PC00001                                        0651 01491000
         C     @04,GDTECT(,@15)                                    0651 01492000
         BE    @RF00651                                            0651 01493000
*            DARGSENT = TSOFAIL;       /*IMPORTRA FAILED             */ 01494000
         L     @04,DDSTRU                                          0652 01495000
         MVI   DARGSENT(@04),X'0F'                                 0652 01496000
*          ELSE                                                    0653 01497000
*            IF SETRC < LASTCC12                           /*@ZA16093*/ 01498000
*              THEN                                                0653 01499000
         B     @RC00651                                            0653 01500000
@RF00651 LH    @04,SETRC                                           0653 01501000
         C     @04,@CF00035                                        0653 01502000
         BNL   @RF00653                                            0653 01503000
*                DARGSENT = IMPTGOOD;  /*IMPORTRA SUCCESSFUL         */ 01504000
         L     @04,DDSTRU                                          0654 01505000
         MVI   DARGSENT(@04),X'01'                                 0654 01506000
*              ELSE                                                0655 01507000
*                DARGSENT = IMPTFAIL;                              0655 01508000
*                                                                  0655 01509000
         B     @RC00653                                            0655 01510000
@RF00653 L     @04,DDSTRU                                          0655 01511000
         MVI   DARGSENT(@04),X'03'                                 0655 01512000
*        LASTCC = SETRC;                                           0656 01513000
@RC00653 DS    0H                                                  0656 01514000
@RC00651 L     @04,@PC00001+8                                      0656 01515000
         LH    @15,SETRC                                           0656 01516000
         STH   @15,LASTCC(,@04)                                    0656 01517000
*        DARGSMOD = UNIVMSG;                                       0657 01518000
         L     @15,DDSTRU                                          0657 01519000
         MVC   DARGSMOD(3,@15),@CC00981                            0657 01520000
*        DARGDBP = ADDR(LASTCC);                                   0658 01521000
         ST    @04,DARGDBP(,@15)                                   0658 01522000
*        DARGILP = LENGTH(LASTCC);                                 0659 01523000
*                                                                  0659 01524000
         MVC   DARGILP(2,@15),@CH00157                             0659 01525000
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0660 01526000
*                                                                  0660 01527000
         L     @04,@PC00001                                        0660 01528000
         ST    @04,@AL00001                                        0660 01529000
         LA    @15,@CF00119                                        0660 01530000
         ST    @15,@AL00001+4                                      0660 01531000
         LA    @15,DDSTRU                                          0660 01532000
         ST    @15,@AL00001+8                                      0660 01533000
         MVI   @AL00001+8,X'80'                                    0660 01534000
         L     @15,GDTPRT(,@04)                                    0660 01535000
         LA    @01,@AL00001                                        0660 01536000
         BALR  @14,@15                                             0660 01537000
*        /************************************************************/ 01538000
*        /*                                                          */ 01539000
*        /*  ISSUE THE UEPIL MACRO TO RETURN TO THE AMS EXECUTIVE.   */ 01540000
*        /*                                                          */ 01541000
*        /************************************************************/ 01542000
*                                                                  0661 01543000
*        CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                       0661 01544000
         L     @04,@PC00001                                        0661 01545000
         ST    @04,@AL00001                                        0661 01546000
         LA    @15,MODID                                           0661 01547000
         ST    @15,@AL00001+4                                      0661 01548000
         L     @15,@PC00001+8                                      0661 01549000
         ST    @15,@AL00001+8                                      0661 01550000
         MVI   @AL00001+8,X'80'                                    0661 01551000
         L     @15,GDTEPL(,@04)                                    0661 01552000
         LA    @01,@AL00001                                        0661 01553000
         BALR  @14,@15                                             0661 01554000
*        /************************************************************/ 01555000
*        /*                                                          */ 01556000
*        /*  PROCEDURE NAME - CLUSPROC                               */ 01557000
*        /*                                                          */ 01558000
*        /*  FUNCTION - READ CATALOG AND DATA RECORDS FROM THE       */ 01559000
*        /*  PORTABILITY VOLUME, USE CATALOG INFORMATION FROM THE    */ 01560000
*        /*  FROM CATALOG RECORDS PLUS INFORMATION FROM THE AMS      */ 01561000
*        /*  COMMAND TO PERFORM A CATALOG DEFINE FOR THE             */ 01562000
*        /*  OBJECT, COPY DATA INTO THE DATA SET AFTER SUCCESSFUL    */ 01563000
*        /*  DEFINITION IN THE CATALOG                               */ 01564000
*        /*  CLUSPROC PROCESSES EXPORTED KSDS'S, RRDS'S,             */ 01565000
*        /*  ESDS'S, AND AIX'S AS WELL AS THEIR ASSOCIATED           */ 01566000
*        /*  PATHS.                                                  */ 01567000
*        /*                                                          */ 01568000
*        /*  INPUT - FUNCTION DEFINITION TABLE                       */ 01569000
*        /*                                                          */ 01570000
*        /*  OUTPUT- A RECREATED CLUSTER OR AIX                      */ 01571000
*        /*                                                          */ 01572000
*        /************************************************************/ 01573000
*                                                                  0662 01574000
*CLUSPROC: PROCEDURE;                                              0662 01575000
*                                                                  0662 01576000
@EL00001 L     @13,4(,@13)                                         0662 01577000
@EF00001 L     @00,@SIZDATD                                        0662 01578000
         LR    @01,@05                                             0662 01579000
         FREEMAIN R,LV=(0),A=(1)                                        01580000
@ER00001 LM    @14,@12,12(@13)                                     0662 01581000
         BR    @14                                                 0662 01582000
CLUSPROC STM   @14,@12,@SA00002                                    0662 01583000
*        /************************************************************/ 01584000
*        /*                                                          */ 01585000
*        /*  PERFORM INITIALIZATION                                  */ 01586000
*        /*                                                          */ 01587000
*        /************************************************************/ 01588000
*                                                                  0663 01589000
*        OLDERID2 = NEWERID2;                                      0663 01590000
         L     @04,@PC00001                                        0663 01591000
         L     @04,GDTTR2(,@04)                                    0663 01592000
         MVC   @TS00001(95),NEWERID2(@04)                          0663 01593000
         MVC   OLDERID2(95,@04),@TS00001                           0663 01594000
*        NEWID2 = 'RMCP';                                          0664 01595000
*                                                                  0664 01596000
         MVC   NEWID2(4,@04),@CC01335                              0664 01597000
*        /************************************************************/ 01598000
*        /*                                                          */ 01599000
*        /*  COMPUTE HOW MANY OBJECTS THERE ARE TO BE                */ 01600000
*        /*  IMPORTED EXCLUSIVE OF PATHS AND SET THE                 */ 01601000
*        /*  KSDSFLAG ACCORDINGLY.                                   */ 01602000
*        /*                                                          */ 01603000
*        /************************************************************/ 01604000
*                                                                  0665 01605000
*        IF IMPASSOC = OFF                                         0665 01606000
*          THEN                                                    0665 01607000
*                                                                  0665 01608000
         TM    IMPASSOC,B'00100000'                                0665 01609000
         BNZ   @RF00665                                            0665 01610000
*            /********************************************************/ 01611000
*            /*                                                      */ 01612000
*            /*  THERE ARE NO PATH ASSOCIATIONS PRESENT.             */ 01613000
*            /*  THE NUMBER OF COMPONENTS IS EQUAL TO                */ 01614000
*            /*  THE NUMBER OF OBJECTS PRESENT IN THE                */ 01615000
*            /*  PORTABILITY DATA SET.                               */ 01616000
*            /*                                                      */ 01617000
*            /********************************************************/ 01618000
*                                                                  0666 01619000
*            NUMCOMP = NUMOBJ;                                     0666 01620000
*                                                                  0666 01621000
         LH    @04,NUMOBJ                                          0666 01622000
         STH   @04,NUMCOMP                                         0666 01623000
*          ELSE                                                    0667 01624000
*                                                                  0667 01625000
*            /********************************************************/ 01626000
*            /*                                                      */ 01627000
*            /*  THERE ARE PATH ASSOCIATIONS PRESENT.  USE           */ 01628000
*            /*  THE IMPBASE BIT TO DETERMINE IF AN INDEX            */ 01629000
*            /*  COMPONENT HAS BEEN EXPORTED.                        */ 01630000
*            /*                                                      */ 01631000
*            /********************************************************/ 01632000
*                                                                  0667 01633000
*            IF IMPBASE = ON                                       0667 01634000
*              THEN                                                0667 01635000
*                                                                  0667 01636000
         B     @RC00665                                            0667 01637000
@RF00665 TM    IMPBASE,B'00010000'                                 0667 01638000
         BNO   @RF00667                                            0667 01639000
*                /****************************************************/ 01640000
*                /*                                                  */ 01641000
*                /*  THERE IS AN INDEX COMPONENT ON THE              */ 01642000
*                /*  PORTABILITY DATA SET.  SET THE VALUE            */ 01643000
*                /*  OF NUMCOMP TO BE THREE.                         */ 01644000
*                /*                                                  */ 01645000
*                /****************************************************/ 01646000
*                                                                  0668 01647000
*                NUMCOMP = 3;                                      0668 01648000
*                                                                  0668 01649000
         MVC   NUMCOMP(2),@CH00165                                 0668 01650000
*              ELSE                                                0669 01651000
*                                                                  0669 01652000
*                /****************************************************/ 01653000
*                /*                                                  */ 01654000
*                /*  IMPBASE IS OFF, INDICATING THAT THERE           */ 01655000
*                /*  IS NO INDEX COMPONENT.  SET NUMCOMP TO          */ 01656000
*                /*  BE TWO.                                         */ 01657000
*                /*                                                  */ 01658000
*                /****************************************************/ 01659000
*                                                                  0669 01660000
*                NUMCOMP = 2;                                      0669 01661000
*                                                                  0669 01662000
         B     @RC00667                                            0669 01663000
@RF00667 MVC   NUMCOMP(2),@CH00157                                 0669 01664000
*        /************************************************************/ 01665000
*        /*                                                          */ 01666000
*        /*  IF NUMCOMP IS 3, WE ARE IMPORTING A KSDS, SO            */ 01667000
*        /*  THE KSDSFLAG IS SET TO ON.  OTHERWISE                   */ 01668000
*        /*  THE OBJECT BEING IMPORTED IS NOT A KSDS, AND            */ 01669000
*        /*  THE KSDSFLAG MUST BE SET TO OFF.                        */ 01670000
*        /*                                                          */ 01671000
*        /************************************************************/ 01672000
*                                                                  0670 01673000
*        IF NUMCOMP = 3                                            0670 01674000
*          THEN                                                    0670 01675000
@RC00667 DS    0H                                                  0670 01676000
@RC00665 CLC   NUMCOMP(2),@CH00165                                 0670 01677000
         BNE   @RF00670                                            0670 01678000
*            KSDSFLAG = ON;                                        0671 01679000
         OI    KSDSFLAG,B'10000000'                                0671 01680000
*          ELSE                                                    0672 01681000
*            KSDSFLAG = OFF;                                       0672 01682000
*                                                                  0672 01683000
*                                                                  0672 01684000
         B     @RC00670                                            0672 01685000
@RF00670 NI    KSDSFLAG,B'01111111'                                0672 01686000
*        /************************************************************/ 01687000
*        /*                                                          */ 01688000
*        /*  SET ADDRESS OF  CONTROL RECORD BUFFER WHICH WILL        */ 01689000
*        /*  CONTAIN DICTIONARY FOR CATALOG RECORDS                  */ 01690000
*        /*                                                          */ 01691000
*        /************************************************************/ 01692000
*                                                                  0673 01693000
*        CONRCPTR = ADDR(CONRCARE);                                0673 01694000
*                                                                  0673 01695000
@RC00670 LA    @04,CONRCARE                                        0673 01696000
         ST    @04,CONRCPTR                                        0673 01697000
*        /************************************************************/ 01698000
*        /*                                                          */ 01699000
*        /*  ZERO OUT THE AREA THAT HOLDS THE CONTROL RECORD         */ 01700000
*        /*  BEGIN BY INITIALIZING THE VALUES OF ZSIZE, ZPTR         */ 01701000
*        /*  AND ZCNTRL.                                             */ 01702000
*        /*                                                          */ 01703000
*        /************************************************************/ 01704000
*                                                                  0674 01705000
*        ZSIZE = LENGTH(CONRCARE);                                 0674 01706000
         MVC   ZSIZE(2),@CH00920                                   0674 01707000
*        ZPTR = CONRCPTR;                                          0675 01708000
         ST    @04,ZPTR                                            0675 01709000
*        ZCNTRL = ON;                                              0676 01710000
*                                                                  0676 01711000
         OI    ZCNTRL,B'10000000'                                  0676 01712000
*        /************************************************************/ 01713000
*        /*                                                          */ 01714000
*        /*  LOOP CLEARING OUT THE BUFFER FOR THE CONTROL            */ 01715000
*        /*  RECORD.                                                 */ 01716000
*        /*                                                          */ 01717000
*        /************************************************************/ 01718000
*                                                                  0677 01719000
*        DO WHILE (ZCNTRL = ON);                                   0677 01720000
         B     @DE00677                                            0677 01721000
@DL00677 DS    0H                                                  0678 01722000
*          IF ZSIZE > 256                                          0678 01723000
*            THEN                                                  0678 01724000
         LH    @04,ZSIZE                                           0678 01725000
         LA    @15,256                                             0678 01726000
         CR    @04,@15                                             0678 01727000
         BNH   @RF00678                                            0678 01728000
*              DO;                                                 0679 01729000
*              ZAREA(1:256) = ZER(1:256);                          0680 01730000
         L     @14,ZPTR                                            0680 01731000
         MVC   ZAREA(256,@14),ZER                                  0680 01732000
*              ZSIZE = ZSIZE - 256;                                0681 01733000
         SLR   @04,@15                                             0681 01734000
         STH   @04,ZSIZE                                           0681 01735000
*              ZPTR = ZPTR + 256;                                  0682 01736000
         ALR   @14,@15                                             0682 01737000
         ST    @14,ZPTR                                            0682 01738000
*              END;                                                0683 01739000
*            ELSE                                                  0684 01740000
*              DO;                                                 0684 01741000
         B     @RC00678                                            0684 01742000
@RF00678 DS    0H                                                  0685 01743000
*              ZAREA(1:ZSIZE) = ZER(1:ZSIZE);                      0685 01744000
         L     @04,ZPTR                                            0685 01745000
         LH    @15,ZSIZE                                           0685 01746000
         BCTR  @15,0                                               0685 01747000
         EX    @15,@SM01777                                        0685 01748000
*              ZCNTRL = OFF;                                       0686 01749000
         NI    ZCNTRL,B'01111111'                                  0686 01750000
*              END;                                                0687 01751000
*        END;                                                      0688 01752000
*                                                                  0688 01753000
@RC00678 DS    0H                                                  0688 01754000
@DE00677 TM    ZCNTRL,B'10000000'                                  0688 01755000
         BO    @DL00677                                            0688 01756000
*        /************************************************************/ 01757000
*        /*                                                          */ 01758000
*        /*  PROCESS CATALOG INFORMATION FROM THE PORTABILITY VOLUME */ 01759000
*        /*                                                          */ 01760000
*        /************************************************************/ 01761000
*                                                                  0689 01762000
*        OLDERID2 = NEWERID2;                                      0689 01763000
         L     @04,@PC00001                                        0689 01764000
         L     @04,GDTTR2(,@04)                                    0689 01765000
         MVC   @TS00001(95),NEWERID2(@04)                          0689 01766000
         MVC   OLDERID2(95,@04),@TS00001                           0689 01767000
*        NEWID2 = 'RMCT';                                          0690 01768000
*                                                                  0690 01769000
         MVC   NEWID2(4,@04),@CC01336                              0690 01770000
*        /************************************************************/ 01771000
*        /*                                                          */ 01772000
*        /*  CONSTRUCT THE CPL TO BE EMPLOYED FOR THE DEFINE         */ 01773000
*        /*  FUNCTION.  IF NOT CONSTRUCTED SUCCESSFULLY, RETURN TO   */ 01774000
*        /*  THE CALLING PROCESSOR WITH AN ERROR INDICATOR           */ 01775000
*        /*                                                          */ 01776000
*        /************************************************************/ 01777000
*                                                                  0691 01778000
*        CALL CPLPROC('F',PTRCPL,NULLPARM,NULLPARM,NULLPARM);      0691 01779000
         MVC   @AL00001(20),@AL00691                               0691 01780000
         LA    @04,PTRCPL                                          0691 01781000
         ST    @04,@AL00001+4                                      0691 01782000
         LA    @01,@AL00001                                        0691 01783000
         BAL   @14,CPLPROC                                         0691 01784000
*        RESPECIFY RTNREG RSTD;                                    0692 01785000
*        TESTRC = RTNREG;                                          0693 01786000
         STH   RTNREG,TESTRC                                       0693 01787000
*        RESPECIFY RTNREG UNRSTD;                                  0694 01788000
*        IF TESTRC ^= 0                                            0695 01789000
*          THEN                                                    0695 01790000
         LH    @04,TESTRC                                          0695 01791000
         LTR   @04,@04                                             0695 01792000
         BZ    @RF00695                                            0695 01793000
*            RETURN CODE(LASTCC12);                                0696 01794000
         LA    @15,12                                              0696 01795000
         L     @14,@SA00002                                        0696 01796000
         LM    @00,@12,@SA00002+8                                  0696 01797000
         BR    @14                                                 0696 01798000
*        CTGPLPTR = PTRCPL;                                        0697 01799000
*                                                                  0697 01800000
*                                                                  0697 01801000
@RF00695 L     @04,PTRCPL                                          0697 01802000
         ST    @04,CTGPLPTR                                        0697 01803000
*CATLOOP:  DO I = 1 TO NUMCOMP;                                    0698 01804000
*                                                                  0698 01805000
CATLOOP  LA    @04,1                                               0698 01806000
         B     @DE00698                                            0698 01807000
@DL00698 DS    0H                                                  0699 01808000
*        /************************************************************/ 01809000
*        /*                                                          */ 01810000
*        /*  READ CONTROL RECORD FROM PORTABLE DATA SET, CONTAINING  */ 01811000
*        /*  DICTIONARY FOR CATALOG INFORMATION.                     */ 01812000
*        /*  IF UNSUCCESSFUL, RETURN TO CALLING PROCESSOR.           */ 01813000
*        /*                                                          */ 01814000
*        /************************************************************/ 01815000
*                                                                  0699 01816000
*        CALL IDCIOGT0 (GDTTBL,PINIOCS);                           0699 01817000
*                                                                  0699 01818000
         L     @04,@PC00001                                        0699 01819000
         ST    @04,@AL00001                                        0699 01820000
         LA    @15,PINIOCS                                         0699 01821000
         ST    @15,@AL00001+4                                      0699 01822000
         MVI   @AL00001+4,X'80'                                    0699 01823000
         L     @15,GDTGET(,@04)                                    0699 01824000
         LA    @01,@AL00001                                        0699 01825000
         BALR  @14,@15                                             0699 01826000
*        RESPECIFY RTNREG RSTD;                                    0700 01827000
*        TESTRC = RTNREG;                                          0701 01828000
         STH   RTNREG,TESTRC                                       0701 01829000
*        RESPECIFY RTNREG UNRSTD;                                  0702 01830000
*        IF TESTRC ^= 0                                            0703 01831000
*          THEN                                                    0703 01832000
         LH    @04,TESTRC                                          0703 01833000
         LTR   @04,@04                                             0703 01834000
         BZ    @RF00703                                            0703 01835000
*            RETURN CODE(LASTCC12);                                0704 01836000
*                                                                  0704 01837000
         LA    @15,12                                              0704 01838000
         L     @14,@SA00002                                        0704 01839000
         LM    @00,@12,@SA00002+8                                  0704 01840000
         BR    @14                                                 0704 01841000
*        /************************************************************/ 01842000
*        /*                                                          */ 01843000
*        /*  MOVE CONTROL RECORD JUST READ INTO BUFFER               */ 01844000
*        /*                                                          */ 01845000
*        /************************************************************/ 01846000
*                                                                  0705 01847000
*        TFVTLEN = IOCDAD -> HEADLN;                               0705 01848000
*                                                                  0705 01849000
@RF00703 L     @04,IOCSPTR                                         0705 01850000
         L     @01,IOCDAD(,@04)                                    0705 01851000
         LH    @15,HEADLN(,@01)                                    0705 01852000
         STH   @15,TFVTLEN                                         0705 01853000
*        CALL MVDAPROC(TFVTLEN,IOCDAD,CONRCPTR);                   0706 01854000
*                                                                  0706 01855000
         LA    @15,TFVTLEN                                         0706 01856000
         ST    @15,@AL00001                                        0706 01857000
         ST    @04,@AL00001+4                                      0706 01858000
         LA    @04,CONRCPTR                                        0706 01859000
         ST    @04,@AL00001+8                                      0706 01860000
         LA    @01,@AL00001                                        0706 01861000
         BAL   @14,MVDAPROC                                        0706 01862000
*        IF HEADFLG1 = HDFL1CAT                                    0707 01863000
*          THEN                                                    0707 01864000
         L     @04,CONRCPTR                                        0707 01865000
         CLI   HEADFLG1(@04),X'FF'                                 0707 01866000
         BNE   @RF00707                                            0707 01867000
*HDCAT:      DO;                                                   0708 01868000
*                                                                  0708 01869000
HDCAT    DS    0H                                                  0709 01870000
*            /********************************************************/ 01871000
*            /*                                                      */ 01872000
*            /*  GET A BUFFER FOR THE NEXT RECORD WHICH WILL BE      */ 01873000
*            /*  A DATA RECORD CONTAINING CATALOG LOCATE WORK AREA   */ 01874000
*            /*  IF CORE IS NOT OBTAINED SUCCESSFULLY, RETURN TO     */ 01875000
*            /*  THE CALLING PROCEDURE                               */ 01876000
*            /*                                                      */ 01877000
*            /********************************************************/ 01878000
*                                                                  0709 01879000
*                                                                  0709 01880000
*            TOTLEN = ASSRECLN;                                    0709 01881000
*                                                                  0709 01882000
         L     @04,CONRCPTR                                        0709 01883000
         LH    @04,ASSRECLN(,@04)                                  0709 01884000
         ST    @04,TOTLEN                                          0709 01885000
*            CALL IDCSAGP0 (GDTTBL,TOTLEN,WORKAR(I),GPID,SETZERO); 0710 01886000
*                                                                  0710 01887000
         L     @04,@PC00001                                        0710 01888000
         ST    @04,@AL00001                                        0710 01889000
         LA    @15,TOTLEN                                          0710 01890000
         ST    @15,@AL00001+4                                      0710 01891000
         L     @15,I                                               0710 01892000
         SLA   @15,2                                               0710 01893000
         LA    @15,WORKAR-4(@15)                                   0710 01894000
         ST    @15,@AL00001+8                                      0710 01895000
         LA    @15,GPID                                            0710 01896000
         ST    @15,@AL00001+12                                     0710 01897000
         LA    @15,SETZERO                                         0710 01898000
         ST    @15,@AL00001+16                                     0710 01899000
         MVI   @AL00001+16,X'80'                                   0710 01900000
         L     @15,GDTGPL(,@04)                                    0710 01901000
         LA    @01,@AL00001                                        0710 01902000
         BALR  @14,@15                                             0710 01903000
*            RESPECIFY RTNREG RSTD;                                0711 01904000
*            TESTRC = RTNREG;                                      0712 01905000
         STH   RTNREG,TESTRC                                       0712 01906000
*            RESPECIFY RTNREG UNRSTD;                              0713 01907000
*            IF TESTRC ^= 0                                        0714 01908000
*              THEN                                                0714 01909000
         LH    @04,TESTRC                                          0714 01910000
         LTR   @04,@04                                             0714 01911000
         BZ    @RF00714                                            0714 01912000
*                DO;                                               0715 01913000
*                DEFSTID = NOSTORAG;                               0716 01914000
         MVI   DEFSTID,X'04'                                       0716 01915000
*                DARGSMOD = UNIVMSG;                               0717 01916000
         L     @04,DDSTRU                                          0717 01917000
         MVC   DARGSMOD(3,@04),@CC00981                            0717 01918000
*                RETURN CODE(LASTCC12);                            0718 01919000
         LA    @15,12                                              0718 01920000
         L     @14,@SA00002                                        0718 01921000
         LM    @00,@12,@SA00002+8                                  0718 01922000
         BR    @14                                                 0718 01923000
*                END;                                              0719 01924000
*                                                                  0719 01925000
*            /********************************************************/ 01926000
*            /*                                                      */ 01927000
*            /*  NOW READ A DATA RECORD WHICH WILL CONTAIN THE       */ 01928000
*            /*  CATALOG FIELD INFORMATION WHICH IS REFERENCED BY    */ 01929000
*            /*  THE DICTIONARY CONTAINED IN THE CONTROL RECORD      */ 01930000
*            /*  IF AN ERROR IS ENCOUNTERED, RETURN TO CALLING       */ 01931000
*            /*  PROCESSOR                                           */ 01932000
*            /*                                                      */ 01933000
*            /********************************************************/ 01934000
*                                                                  0720 01935000
*            CALL GETPROC(WORKAR(I),ASSRECLN);                     0720 01936000
*                                                                  0720 01937000
@RF00714 L     @04,I                                               0720 01938000
         SLA   @04,2                                               0720 01939000
         LA    @04,WORKAR-4(@04)                                   0720 01940000
         ST    @04,@AL00001                                        0720 01941000
         L     @04,CONRCPTR                                        0720 01942000
         LA    @04,ASSRECLN(,@04)                                  0720 01943000
         ST    @04,@AL00001+4                                      0720 01944000
         LA    @01,@AL00001                                        0720 01945000
         BAL   @14,GETPROC                                         0720 01946000
*            RESPECIFY RTNREG RSTD;                                0721 01947000
*            TESTRC = RTNREG;                                      0722 01948000
         STH   RTNREG,TESTRC                                       0722 01949000
*            RESPECIFY RTNREG UNRSTD;                              0723 01950000
*            IF TESTRC ^= 0                                        0724 01951000
*              THEN                                                0724 01952000
         LH    @04,TESTRC                                          0724 01953000
         LTR   @04,@04                                             0724 01954000
         BZ    @RF00724                                            0724 01955000
*                RETURN CODE(LASTCC12);                            0725 01956000
*                                                                  0725 01957000
         LA    @15,12                                              0725 01958000
         L     @14,@SA00002                                        0725 01959000
         LM    @00,@12,@SA00002+8                                  0725 01960000
         BR    @14                                                 0725 01961000
*            /********************************************************/ 01962000
*            /*                                                      */ 01963000
*            /*  BUILD AN FVT TO CORRESPOND TO THIS RECORD OF        */ 01964000
*            /*  CATALOG INFORMATION.  FVTPROC WILL GET CORE         */ 01965000
*            /*  AND BUILD FPLS FROM INFORMATION IN THE DICTIONARY   */ 01966000
*            /*  AND WORK AREA.                                      */ 01967000
*            /*  IF AN ERROR IS ENCOUNTERED, RETURN TO CALLING       */ 01968000
*            /*  PROCESSOR                                           */ 01969000
*            /*                                                      */ 01970000
*            /********************************************************/ 01971000
*                                                                  0726 01972000
*            DICTPTR = ADDR(VARDATA);                              0726 01973000
*                                                                  0726 01974000
@RF00724 L     @04,CONRCPTR                                        0726 01975000
         LA    @04,VARDATA(,@04)                                   0726 01976000
         ST    @04,DICTPTR                                         0726 01977000
*            CALL FVTPROC(DICTPTR,WORKAR(I),FVTPTR(I));            0727 01978000
*                                                                  0727 01979000
         LA    @04,DICTPTR                                         0727 01980000
         ST    @04,@AL00001                                        0727 01981000
         L     @04,I                                               0727 01982000
         SLA   @04,2                                               0727 01983000
         LA    @15,WORKAR-4(@04)                                   0727 01984000
         ST    @15,@AL00001+4                                      0727 01985000
         LA    @04,FVTPTR-4(@04)                                   0727 01986000
         ST    @04,@AL00001+8                                      0727 01987000
         LA    @01,@AL00001                                        0727 01988000
         BAL   @14,FVTPROC                                         0727 01989000
*            RESPECIFY RTNREG RSTD;                                0728 01990000
*            TESTRC = RTNREG;                                      0729 01991000
         STH   RTNREG,TESTRC                                       0729 01992000
*            RESPECIFY RTNREG UNRSTD;                              0730 01993000
*            IF TESTRC ^= 0                                        0731 01994000
*              THEN                                                0731 01995000
         LH    @04,TESTRC                                          0731 01996000
         LTR   @04,@04                                             0731 01997000
         BZ    @RF00731                                            0731 01998000
*                RETURN CODE(LASTCC12);                            0732 01999000
*                                                                  0732 02000000
         LA    @15,12                                              0732 02001000
         L     @14,@SA00002                                        0732 02002000
         LM    @00,@12,@SA00002+8                                  0732 02003000
         BR    @14                                                 0732 02004000
*            /********************************************************/ 02005000
*            /*                                                      */ 02006000
*            /*  PLACE THE FVT POINTER IN   PROPER FIELD.THE CLUSTER */ 02007000
*            /*  FVT POINTER WILL BE PLACED IN THE CPL.  THE DATA OR */ 02008000
*            /*  INDEX OBJECT FVT POINTERS WILL BE PLACED IN CLUSTER */ 02009000
*            /*  OR AIX FVT.                                         */ 02010000
*            /*                                                      */ 02011000
*            /********************************************************/ 02012000
*                                                                  0733 02013000
*            RESPECIFY CTGFV BASED(CTGFVPTR);                      0733 02014000
@RF00731 DS    0H                                                  0734 02015000
*            CTGFVPTR = FVTPTR(I);                                 0734 02016000
         L     @04,I                                               0734 02017000
         SLA   @04,2                                               0734 02018000
         L     @04,FVTPTR-4(@04)                                   0734 02019000
         ST    @04,CTGFVPTR                                        0734 02020000
*            IF CTGFVTYP = CTGTCL | CTGFVTYP = CTGTAIX             0735 02021000
*              THEN                                                0735 02022000
         CLI   CTGFVTYP(@04),C'C'                                  0735 02023000
         BE    @RT00735                                            0735 02024000
         CLI   CTGFVTYP(@04),C'G'                                  0735 02025000
         BNE   @RF00735                                            0735 02026000
@RT00735 DS    0H                                                  0736 02027000
*                DO;                                               0736 02028000
*                CTGFVT = FVTPTR(I);                               0737 02029000
*                                                                  0737 02030000
         L     @04,I                                               0737 02031000
         SLA   @04,2                                               0737 02032000
         L     @04,FVTPTR-4(@04)                                   0737 02033000
         L     @01,CTGPLPTR                                        0737 02034000
         ST    @04,CTGFVT(,@01)                                    0737 02035000
*                /****************************************************/ 02036000
*                /*                                                  */ 02037000
*                /*  SET POINTER TO MASTER PASSWORD FOR CLUSTER IF   */ 02038000
*                /*  PROTECTION INFORMATION EXISTS.                  */ 02039000
*                /*                                                  */ 02040000
*                /****************************************************/ 02041000
*                                                                  0738 02042000
*                IF CTGFVSTY ^= NULLPTR                            0738 02043000
*                  THEN                                            0738 02044000
         L     @04,CTGFVPTR                                        0738 02045000
         L     @04,CTGFVSTY(,@04)                                  0738 02046000
         LTR   @04,@04                                             0738 02047000
         BZ    @RF00738                                            0738 02048000
*                    CPSWD = CTGFVSTY -> CTGFLPT(1);               0739 02049000
*                                                                  0739 02050000
         L     @04,CTGFLPT(,@04)                                   0739 02051000
         ST    @04,CPSWD                                           0739 02052000
*                END;                                              0740 02053000
*              ELSE                                                0741 02054000
*                DO;                                               0741 02055000
         B     @RC00735                                            0741 02056000
@RF00735 DS    0H                                                  0742 02057000
*                IF CTGFVTYP = CTGTDATA                            0742 02058000
*                  THEN                                            0742 02059000
         L     @04,CTGFVPTR                                        0742 02060000
         CLI   CTGFVTYP(@04),C'D'                                  0742 02061000
         BNE   @RF00742                                            0742 02062000
*                    DO;                                           0743 02063000
*                    CTGFVPTR = CTGFVT;                            0744 02064000
         L     @04,CTGPLPTR                                        0744 02065000
         L     @04,CTGFVT(,@04)                                    0744 02066000
         ST    @04,CTGFVPTR                                        0744 02067000
*                    CTGFVDCH = FVTPTR(I);                         0745 02068000
         L     @15,I                                               0745 02069000
         SLA   @15,2                                               0745 02070000
         L     @15,FVTPTR-4(@15)                                   0745 02071000
         ST    @15,CTGFVDCH(,@04)                                  0745 02072000
*                    END;                                          0746 02073000
*                  ELSE                                            0747 02074000
*                    DO;                                           0747 02075000
         B     @RC00742                                            0747 02076000
@RF00742 DS    0H                                                  0748 02077000
*                    CTGFVPTR = CTGFVT;                            0748 02078000
         L     @04,CTGPLPTR                                        0748 02079000
         L     @04,CTGFVT(,@04)                                    0748 02080000
         ST    @04,CTGFVPTR                                        0748 02081000
*                    CTGFVICH = FVTPTR(I);                         0749 02082000
         L     @15,I                                               0749 02083000
         SLA   @15,2                                               0749 02084000
         L     @15,FVTPTR-4(@15)                                   0749 02085000
         ST    @15,CTGFVICH(,@04)                                  0749 02086000
*                    END;                                          0750 02087000
*                END;                                              0751 02088000
@RC00742 DS    0H                                                  0752 02089000
*            END HDCAT;                                            0752 02090000
@RC00735 DS    0H                                                  0753 02091000
*        END CATLOOP;                                              0753 02092000
*                                                                  0753 02093000
@RF00707 LA    @04,1                                               0753 02094000
         AL    @04,I                                               0753 02095000
@DE00698 ST    @04,I                                               0753 02096000
         CH    @04,NUMCOMP                                         0753 02097000
         BNH   @DL00698                                            0753 02098000
*        /************************************************************/ 02099000
*        /*                                                          */ 02100000
*        /*  IF A DATA SET WAS A UNIQUE DATA SET (HAVING ITS OWN     */ 02101000
*        /*  DATA SPACE) PRIOR TO EXPORT, IT WILL AGAIN BE DEFINED   */ 02102000
*        /*  AS A UNIQUE DATA SET.    IUNIQPRC WILL DETERMINE IF THE */ 02103000
*        /*  DATA SET WAS UNIQUE AND IF SO, CONSTRUCT THE NULL SPACE */ 02104000
*        /*  FVT REQUIRED FOR DEFINE                                 */ 02105000
*        /*  IF IUNIQPRC DOES NOT COMPLETE SUCCESSFULLY, CONTROL     */ 02106000
*        /*  WILL BE RETURNED TO THE CALLING PROCESSOR               */ 02107000
*        /*                                                          */ 02108000
*        /************************************************************/ 02109000
*                                                                  0754 02110000
*        CALL IUNIQPRC;                                            0754 02111000
*                                                                  0754 02112000
         BAL   @14,IUNIQPRC                                        0754 02113000
*        RESPECIFY RTNREG RSTD;                                    0755 02114000
*        TESTRC = RTNREG;                                          0756 02115000
         STH   RTNREG,TESTRC                                       0756 02116000
*        RESPECIFY RTNREG UNRSTD;                                  0757 02117000
*        IF TESTRC ^= 0                                            0758 02118000
*          THEN                                                    0758 02119000
         LH    @04,TESTRC                                          0758 02120000
         LTR   @04,@04                                             0758 02121000
         BZ    @RF00758                                            0758 02122000
*            RETURN CODE(LASTCC12);                                0759 02123000
         LA    @15,12                                              0759 02124000
         L     @14,@SA00002                                        0759 02125000
         LM    @00,@12,@SA00002+8                                  0759 02126000
         BR    @14                                                 0759 02127000
*        /************************************************************/ 02128000
*        /*                                                          */ 02129000
*        /*  MODIFY FVT'S WITH INFORMATION FROM THE AMS COMMAND      */ 02130000
*        /*  PARAMETER - OBJECT.  THE ENTRYNAME MAY BE MODIFIED VIA  */ 02131000
*        /*  THE NEWNAME PARAMETER. LISTVOLS AND DNAME  ARE          */ 02132000
*        /*  CONSTRUCTED FROM INFORMATION IN THE AMS COMMAND.        */ 02133000
*        /*                                                          */ 02134000
*        /************************************************************/ 02135000
*                                                                  0760 02136000
*        CTGFVPTR = CTGFVT;                                        0760 02137000
*                                                                  0760 02138000
@RF00758 L     @04,CTGPLPTR                                        0760 02139000
         L     @04,CTGFVT(,@04)                                    0760 02140000
         ST    @04,CTGFVPTR                                        0760 02141000
*        /************************************************************/ 02142000
*        /*                                                          */ 02143000
*        /*  MATCH OBJECT PARAMETER WITH CORRECT FVT BY MATCHING     */ 02144000
*        /*  ENTRYNAME FROM ENTNAME FPL WITH OBJECTNAME              */ 02145000
*        /*                                                          */ 02146000
*        /************************************************************/ 02147000
*                                                                  0761 02148000
*        IF ADDR(OBJTS) ^= NULLPTR                                 0761 02149000
*          THEN                                                    0761 02150000
         L     @04,@PC00001+4                                      0761 02151000
         L     @04,FDTPTR+8(,@04)                                  0761 02152000
         LTR   @04,@04                                             0761 02153000
         BZ    @RF00761                                            0761 02154000
*OBJCTLP:  DO FX = 1 TO NUMCOMP;                                   0762 02155000
OBJCTLP  LA    @04,1                                               0762 02156000
         B     @DE00762                                            0762 02157000
@DL00762 DS    0H                                                  0763 02158000
*              CTGFVPTR = FVTPTR(FX);                              0763 02159000
         SLA   @04,2                                               0763 02160000
         L     @04,FVTPTR-4(@04)                                   0763 02161000
         ST    @04,CTGFVPTR                                        0763 02162000
*OBJENTLP:     DO IX = 1 TO OBJTSCNT;                              0764 02163000
*                                                                  0764 02164000
OBJENTLP LA    @04,1                                               0764 02165000
         B     @DE00764                                            0764 02166000
@DL00764 DS    0H                                                  0765 02167000
*              /******************************************************/ 02168000
*              /*                                                    */ 02169000
*              /*  IF A MATCH IS FOUND BETWEEN THE FVT AND THE       */ 02170000
*              /*  NAME IN THE OBJECTS PARAMETER, PROCESS THE        */ 02171000
*              /*  INPUT INFORMATION SPECIFIED FOR THAT OBJECT.      */ 02172000
*              /*                                                    */ 02173000
*              /******************************************************/ 02174000
*                                                                  0765 02175000
*              IF OBJNMPTR(IX)->OBJNMVAL(1:44) = FENTNAME(1:44)    0765 02176000
*                THEN                                              0765 02177000
         SLA   @04,2                                               0765 02178000
         L     @15,@PC00001+4                                      0765 02179000
         L     @01,FDTPTR+12(,@15)                                 0765 02180000
         AL    @01,@CF01779                                        0765 02181000
         L     @04,OBJNMPTR(@04,@01)                               0765 02182000
         L     @01,CTGFVPTR                                        0765 02183000
         L     @01,CTGFVENT(,@01)                                  0765 02184000
         CLC   OBJNMVAL(44,@04),FENTNAME(@01)                      0765 02185000
         BNE   @RF00765                                            0765 02186000
*OBJMATCH:         DO;                                             0766 02187000
OBJMATCH DS    0H                                                  0767 02188000
*                  IMPF2OBJ = ON;                                  0767 02189000
*                                                                  0767 02190000
         OI    IMPF2OBJ,B'00100000'                                0767 02191000
*                  /**************************************************/ 02192000
*                  /*                                                */ 02193000
*                  /*   PROCESS  THE FILE PARAMETER                  */ 02194000
*                  /*                                                */ 02195000
*                  /**************************************************/ 02196000
*                                                                  0768 02197000
*                  IF OBJFLPTR(IX) ^= NULLPTR                      0768 02198000
*                    THEN                                          0768 02199000
         L     @04,IX                                              0768 02200000
         SLA   @04,2                                               0768 02201000
         L     @15,@PC00001+4                                      0768 02202000
         L     @01,FDTPTR+20(,@15)                                 0768 02203000
         AL    @01,@CF01779                                        0768 02204000
         L     @04,OBJFLPTR(@04,@01)                               0768 02205000
         LTR   @04,@04                                             0768 02206000
         BZ    @RF00768                                            0768 02207000
*                      CTGFVIND=ADDR(OBJFLPTR(IX) -> OBJFLVAL);    0769 02208000
*                                                                  0769 02209000
         LA    @04,OBJFLVAL(,@04)                                  0769 02210000
         L     @01,CTGFVPTR                                        0769 02211000
         ST    @04,CTGFVIND(,@01)                                  0769 02212000
*                  /**************************************************/ 02213000
*                  /*                                                */ 02214000
*                  /*  CALL LVLRPROC TO CONSTRUCT THE LIST OF VOLUME */ 02215000
*                  /*  SERIAL NUMBERS IF VOLUMES SPECIFIED IN THE    */ 02216000
*                  /*  AMS COMMAND FOR THIS OBJECT                   */ 02217000
*                  /*                                                */ 02218000
*                  /**************************************************/ 02219000
*                                                                  0770 02220000
*                  IF LISTVPTR(IX) ^= NULLPTR                      0770 02221000
*                    THEN                                          0770 02222000
@RF00768 SLR   @04,@04                                             0770 02223000
         L     @15,IX                                              0770 02224000
         SLA   @15,2                                               0770 02225000
         L     @14,@PC00001+4                                      0770 02226000
         L     @01,FDTPTR+24(,@14)                                 0770 02227000
         AL    @01,@CF01779                                        0770 02228000
         C     @04,LISTVPTR(@15,@01)                               0770 02229000
         BE    @RF00770                                            0770 02230000
*                      DO;                                         0771 02231000
*                                                                  0771 02232000
*                      /**********************************************/ 02233000
*                      /*  IF VOLUMES IS SPECIFIED AT THE CLUSTER    */ 02234000
*                      /*  LEVEL, REMOVE THE DATA AND IF APPLICABLE  */ 02235000
*                      /*  INDEX FVT VOLUME LIST POINTERS(S).  THIS  */ 02236000
*                      /*  WILL ALLOW PROPAGATION OF THE CLUSTER      / 02237000
*                      /*  LEVEL VOLUME LIST.  IF VOLUMES IS NOT     */ 02238000
*                      /*  SPECIFIED ATH THE DATA/INDEX LEVEL(S).    */ 02239000
*                      /*                                            */ 02240000
*                      /**********************************************/ 02241000
*                                                                  0772 02242000
*                      IF FX = 1                           /*@OZ32365*/ 02243000
*                        THEN                              /*@OZ32365*/ 02244000
         CLC   FX(4),@CF00221                                      0772 02245000
         BNE   @RF00772                                            0772 02246000
*                          DO;                             /*@OZ32365*/ 02247000
*                          FVTPTR(2)->CTGFVVLT = NULLPTR;  /*@OZ32365*/ 02248000
         L     @01,FVTPTR+4                                        0774 02249000
         ST    @04,CTGFVVLT(,@01)                                  0774 02250000
*                          IF FVTPTR(3) ^= NULLPTR         /*@OZ32365*/ 02251000
*                            THEN                          /*@OZ32365*/ 02252000
         L     @15,FVTPTR+8                                        0775 02253000
         CR    @15,@04                                             0775 02254000
         BE    @RF00775                                            0775 02255000
*                              FVTPTR(3)->CTGFVVLT=NULLPTR;/*@OZ32365*/ 02256000
         ST    @04,CTGFVVLT(,@15)                                  0776 02257000
*                            ELSE;                         /*@OZ32365*/ 02258000
@RF00775 DS    0H                                                  0778 02259000
*                          END;                            /*@OZ32365*/ 02260000
*                        ELSE;                             /*@OZ32365*/ 02261000
*                                                                  0779 02262000
@RF00772 DS    0H                                                  0780 02263000
*                      /**********************************************/ 02264000
*                      /*                                            */ 02265000
*                      /*  CONSTRUCT VOLUMES SERIAL LIST.  IF        */ 02266000
*                      /*  UNSUCCESSFUL, RETURN TO CALLING PROCESSOR */ 02267000
*                      /*                                            */ 02268000
*                      /**********************************************/ 02269000
*                                                                  0780 02270000
*                      CALL LVLRPROC(IX,NULLPARM,NULLPARM,FVTPTR(FX),   02271000
*                         FVTPTR(1)->CTGFVTYP);                    0780 02272000
*                                                                  0780 02273000
         LA    @04,IX                                              0780 02274000
         ST    @04,@AL00001                                        0780 02275000
         LA    @04,NULLPARM                                        0780 02276000
         ST    @04,@AL00001+4                                      0780 02277000
         LA    @04,NULLPARM                                        0780 02278000
         ST    @04,@AL00001+8                                      0780 02279000
         L     @04,FX                                              0780 02280000
         SLA   @04,2                                               0780 02281000
         LA    @04,FVTPTR-4(@04)                                   0780 02282000
         ST    @04,@AL00001+12                                     0780 02283000
         L     @04,FVTPTR                                          0780 02284000
         ST    @04,@AL00001+16                                     0780 02285000
         LA    @01,@AL00001                                        0780 02286000
         BAL   @14,LVLRPROC                                        0780 02287000
*                      RESPECIFY RTNREG RSTD;                      0781 02288000
*                      TESTRC = RTNREG;                            0782 02289000
         STH   RTNREG,TESTRC                                       0782 02290000
*                      RESPECIFY RTNREG UNRSTD;                    0783 02291000
*                      IF TESTRC ^= 0                              0784 02292000
*                        THEN                                      0784 02293000
         LH    @04,TESTRC                                          0784 02294000
         LTR   @04,@04                                             0784 02295000
         BZ    @RF00784                                            0784 02296000
*                          RETURN CODE(LASTCC12);                  0785 02297000
*                                                                  0785 02298000
         LA    @15,12                                              0785 02299000
         L     @14,@SA00002                                        0785 02300000
         LM    @00,@12,@SA00002+8                                  0785 02301000
         BR    @14                                                 0785 02302000
*                      END;                                        0786 02303000
@RF00784 DS    0H                                                  0787 02304000
*                  END OBJMATCH;                                   0787 02305000
@RF00770 DS    0H                                                  0788 02306000
*              END OBJENTLP;                                       0788 02307000
@RF00765 LA    @04,1                                               0788 02308000
         AL    @04,IX                                              0788 02309000
@DE00764 ST    @04,IX                                              0788 02310000
         L     @15,@PC00001+4                                      0788 02311000
         LA    @15,FDTPTR+8(,@15)                                  0788 02312000
         C     @04,OBJTSCNT(,@15)                                  0788 02313000
         BNH   @DL00764                                            0788 02314000
*        END OBJCTLP;                                              0789 02315000
*                                                                  0789 02316000
         LA    @04,1                                               0789 02317000
         AL    @04,FX                                              0789 02318000
@DE00762 ST    @04,FX                                              0789 02319000
         CH    @04,NUMCOMP                                         0789 02320000
         BNH   @DL00762                                            0789 02321000
*        /************************************************************/ 02322000
*        /*                                                          */ 02323000
*        /*  MIGRATE THE FILE INFORMATION JUST OBTAINED              */ 02324000
*        /*  FROM THE SCAN OF THE OBJECTS LIST TO THE PROPER         */ 02325000
*        /*  LEVEL.  BEGIN BY TESTING TO DETERMINE IF THERE          */ 02326000
*        /*  IS FILE INFORMATION AT THE CLUSTER OR AIX               */ 02327000
*        /*  LEVEL.                                                  */ 02328000
*        /*                                                          */ 02329000
*        /************************************************************/ 02330000
*                                                                  0790 02331000
*        IF (FVTPTR(1) -> CTGFVIND) ^= NULLPTR                     0790 02332000
*          THEN                                                    0790 02333000
@RF00761 SLR   @04,@04                                             0790 02334000
         L     @01,FVTPTR                                          0790 02335000
         L     @15,CTGFVIND(,@01)                                  0790 02336000
         CR    @15,@04                                             0790 02337000
         BE    @RF00790                                            0790 02338000
*            DO;                                                   0791 02339000
*                                                                  0791 02340000
*            /********************************************************/ 02341000
*            /*                                                      */ 02342000
*            /*  FILE INFORMATION WAS SPECIFIED AT THE               */ 02343000
*            /*  CLUSTER OR AIX LEVEL.  TEST TO DETERMINE            */ 02344000
*            /*  IF THIS INFORMATION NEEDS TO BE MIGRATED            */ 02345000
*            /*  TO THE DATA OR INDEX LEVEL.                         */ 02346000
*            /*                                                      */ 02347000
*            /********************************************************/ 02348000
*                                                                  0792 02349000
*            IF (FVTPTR(2) -> CTGFVIND) = NULLPTR                  0792 02350000
*              THEN                                                0792 02351000
         L     @14,FVTPTR+4                                        0792 02352000
         C     @04,CTGFVIND(,@14)                                  0792 02353000
         BNE   @RF00792                                            0792 02354000
*                FVTPTR(2) -> CTGFVIND = FVTPTR(1) ->              0793 02355000
*                   CTGFVIND;                                      0793 02356000
*                                                                  0793 02357000
         ST    @15,CTGFVIND(,@14)                                  0793 02358000
*            /********************************************************/ 02359000
*            /*                                                      */ 02360000
*            /*  TEST FOR THE EXISTENCE OF AN INDEX PRIOR            */ 02361000
*            /*  TO TESTING FOR THE PRESENCE OF FILE INFOR-          */ 02362000
*            /*  MATION.                                             */ 02363000
*            /*                                                      */ 02364000
*            /********************************************************/ 02365000
*                                                                  0794 02366000
*            IF FVTPTR(3) ^= NULLPTR                               0794 02367000
*              THEN                                                0794 02368000
@RF00792 SLR   @04,@04                                             0794 02369000
         L     @15,FVTPTR+8                                        0794 02370000
         CR    @15,@04                                             0794 02371000
         BE    @RF00794                                            0794 02372000
*                IF (FVTPTR(3) -> CTGFVIND) = NULLPTR              0795 02373000
*                  THEN                                            0795 02374000
         C     @04,CTGFVIND(,@15)                                  0795 02375000
         BNE   @RF00795                                            0795 02376000
*                    FVTPTR(3) -> CTGFVIND =                       0796 02377000
*                       FVTPTR(1) -> CTGFVIND;                     0796 02378000
         L     @04,FVTPTR                                          0796 02379000
         L     @04,CTGFVIND(,@04)                                  0796 02380000
         ST    @04,CTGFVIND(,@15)                                  0796 02381000
*            END;                                                  0797 02382000
*                                                                  0797 02383000
@RF00795 DS    0H                                                  0797 02384000
@RF00794 DS    0H                                                  0798 02385000
*        /************************************************************/ 02386000
*        /*                                                          */ 02387000
*        /*  IF THERE IS STILL NO FILE INFORMATION AT THE            */ 02388000
*        /*  DATA AND INDEX LEVELS, ATTEMPT TO SUPPLY                */ 02389000
*        /*  DEFAULT INFORMATION USING THE OUTFILE PARAMETER         */ 02390000
*        /*  IF THAT WAS SPECIFIED BY THE USER.                      */ 02391000
*        /*                                                          */ 02392000
*        /************************************************************/ 02393000
*                                                                  0798 02394000
*        IF FVTPTR(2) -> CTGFVIND = NULLPTR                        0798 02395000
*           & ADDR(OUTDD) ^= NULLPTR                               0798 02396000
*          THEN                                                    0798 02397000
@RF00790 SLR   @04,@04                                             0798 02398000
         L     @15,FVTPTR+4                                        0798 02399000
         C     @04,CTGFVIND(,@15)                                  0798 02400000
         BNE   @RF00798                                            0798 02401000
         L     @14,@PC00001+4                                      0798 02402000
         L     @14,FDTPTR+4(,@14)                                  0798 02403000
         CR    @14,@04                                             0798 02404000
         BE    @RF00798                                            0798 02405000
*            FVTPTR(2) -> CTGFVIND = ADDR(OUTDDVAL);               0799 02406000
*                                                                  0799 02407000
         LA    @04,OUTDDVAL(,@14)                                  0799 02408000
         ST    @04,CTGFVIND(,@15)                                  0799 02409000
*        IF FVTPTR(3) ^= NULLPTR                                   0800 02410000
*          THEN                                                    0800 02411000
@RF00798 SLR   @04,@04                                             0800 02412000
         L     @15,FVTPTR+8                                        0800 02413000
         CR    @15,@04                                             0800 02414000
         BE    @RF00800                                            0800 02415000
*            IF FVTPTR(3) -> CTGFVIND = NULLPTR                    0801 02416000
*               & ADDR(OUTDD) ^= NULLPTR                           0801 02417000
*              THEN                                                0801 02418000
         C     @04,CTGFVIND(,@15)                                  0801 02419000
         BNE   @RF00801                                            0801 02420000
         L     @14,@PC00001+4                                      0801 02421000
         L     @14,FDTPTR+4(,@14)                                  0801 02422000
         CR    @14,@04                                             0801 02423000
         BE    @RF00801                                            0801 02424000
*                FVTPTR(3) -> CTGFVIND = ADDR(OUTDDVAL);           0802 02425000
         LA    @04,OUTDDVAL(,@14)                                  0802 02426000
         ST    @04,CTGFVIND(,@15)                                  0802 02427000
*                                                                  0803 02428000
*        /************************************************************/ 02429000
*        /*                                                          */ 02430000
*        /*  PUT THE VOLUME INFORMATION INTO THE FVTS AT             */ 02431000
*        /*  THE PROPER LEVEL--DATA AND POSSIBLY INDEX.              */ 02432000
*        /* FIRST CHECK THE DATA FVT TO SEE IF CTGFVVLT IS ZERO      */ 02433000
*        /* IF IT IS- REPRODUCE THE VOLUME LIST REFERENCED FROM      */ 02434000
*        /* THE CLUSTER FVT AND POINT TO IT FROM THE DATA FVT        */ 02435000
*        /* IF AN INDEX FVT ALSO EXISTS DO THE SAME.                 */ 02436000
*        /*                                                          */ 02437000
*        /************************************************************/ 02438000
*                                                                  0803 02439000
*        IF FVTPTR(2) -> CTGFVVLT = NULLPTR                        0803 02440000
*          THEN                                                    0803 02441000
*                                                                  0803 02442000
@RF00801 DS    0H                                                  0803 02443000
@RF00800 L     @04,FVTPTR+4                                        0803 02444000
         L     @15,CTGFVVLT(,@04)                                  0803 02445000
         LTR   @15,@15                                             0803 02446000
         BNZ   @RF00803                                            0803 02447000
*            /******************************************************/   02448000
*            /*                                                    */   02449000
*            /* THERE IS NO VOLLIST FROM DATA SO MOVE THAT AT      */   02450000
*            /* THE CLUSTER.                                       */   02451000
*            /*                                                    */   02452000
*            /******************************************************/   02453000
*                                                                  0804 02454000
*            DO;                                                   0804 02455000
*                                                                  0804 02456000
*            TOTLEN = (FVTPTR(1) -> CTGFVVLT->FLISTLN) + 2;        0805 02457000
*                                                                  0805 02458000
         L     @01,FVTPTR                                          0805 02459000
         L     @01,CTGFVVLT(,@01)                                  0805 02460000
         LA    @00,2                                               0805 02461000
         AH    @00,FLISTLN(,@01)                                   0805 02462000
         ST    @00,TOTLEN                                          0805 02463000
*            CTGFVPTR = FVTPTR(2);                                 0806 02464000
*                                                                  0806 02465000
         ST    @04,CTGFVPTR                                        0806 02466000
*            CALL IDCSAGP0(                                        0807 02467000
*             GDTTBL,                                              0807 02468000
*             TOTLEN,               /* LENGTH OF STORAGE         */     02469000
*             CTGFVVLT,             /* ADDRESS OF STORAGE        */     02470000
*             GPID,                                                0807 02471000
*             SETZERO);                                            0807 02472000
*                                                                  0807 02473000
         L     @15,@PC00001                                        0807 02474000
         ST    @15,@AL00001                                        0807 02475000
         LA    @14,TOTLEN                                          0807 02476000
         ST    @14,@AL00001+4                                      0807 02477000
         LA    @04,CTGFVVLT(,@04)                                  0807 02478000
         ST    @04,@AL00001+8                                      0807 02479000
         LA    @04,GPID                                            0807 02480000
         ST    @04,@AL00001+12                                     0807 02481000
         LA    @04,SETZERO                                         0807 02482000
         ST    @04,@AL00001+16                                     0807 02483000
         MVI   @AL00001+16,X'80'                                   0807 02484000
         L     @15,GDTGPL(,@15)                                    0807 02485000
         LA    @01,@AL00001                                        0807 02486000
         BALR  @14,@15                                             0807 02487000
*            RESPECIFY RTNREG RSTD;                                0808 02488000
*            TESTRC = RTNREG;                                      0809 02489000
         STH   RTNREG,TESTRC                                       0809 02490000
*            RESPECIFY RTNREG UNRSTD;                              0810 02491000
*                                                                  0810 02492000
*            /****************************************************/     02493000
*            /*                                                  */     02494000
*            /* STORAGE REQUEST FAILED FOR VOL LIST              */     02495000
*            /*                                                  */     02496000
*            /****************************************************/     02497000
*                                                                  0811 02498000
*            IF TESTRC ^= 0                                        0811 02499000
*              THEN                                                0811 02500000
         LH    @04,TESTRC                                          0811 02501000
         LTR   @04,@04                                             0811 02502000
         BZ    @RF00811                                            0811 02503000
*                DO;                                               0812 02504000
*                                                                  0812 02505000
*                DEFSTID = NOSTORAG;                               0813 02506000
         MVI   DEFSTID,X'04'                                       0813 02507000
*                DARGSMOD = UNIVMSG;                               0814 02508000
         L     @04,DDSTRU                                          0814 02509000
         MVC   DARGSMOD(3,@04),@CC00981                            0814 02510000
*                RETURN CODE(LASTCC12);                            0815 02511000
*                                                                  0815 02512000
         LA    @15,12                                              0815 02513000
         L     @14,@SA00002                                        0815 02514000
         LM    @00,@12,@SA00002+8                                  0815 02515000
         BR    @14                                                 0815 02516000
*                END;                                              0816 02517000
*                                                                  0816 02518000
*            /****************************************************/     02519000
*            /*                                                  */     02520000
*            /* MOVE THE VOLUME LIST FROM THE CLUSTER TO THE     */     02521000
*            /* DATA FVT VOLUME LIST CREATED BY ABOVE UGPOOL     */     02522000
*            /*                                                  */     02523000
*            /****************************************************/     02524000
*                                                                  0817 02525000
*            FVTPTR(2)->CTGFVVLT->FLISTVOL(1 : TOTLEN) =           0817 02526000
*              FVTPTR(1) -> CTGFVVLT->FLISTVOL(1 : TOTLEN);        0817 02527000
*                                                                  0817 02528000
@RF00811 L     @04,FVTPTR+4                                        0817 02529000
         L     @01,CTGFVVLT(,@04)                                  0817 02530000
         L     @15,TOTLEN                                          0817 02531000
         BCTR  @15,0                                               0817 02532000
         L     @14,FVTPTR                                          0817 02533000
         L     @14,CTGFVVLT(,@14)                                  0817 02534000
         EX    @15,@SM01780                                        0817 02535000
*              IF FVTPTR(2) -> CTGFVIND = NULLPTR & UNIQD = ON     0818 02536000
*                THEN                                              0818 02537000
         L     @15,CTGFVIND(,@04)                                  0818 02538000
         LTR   @15,@15                                             0818 02539000
         BNZ   @RF00818                                            0818 02540000
         TM    UNIQD,B'10000000'                                   0818 02541000
         BNO   @RF00818                                            0818 02542000
*                  DO;                                             0819 02543000
*                                                                  0819 02544000
*                    /**********************************************/   02545000
*                    /*                                          */     02546000
*                    /* DYNAMICALLY ALLOCATE THE DATA COMPONENT  */     02547000
*                    /* VOLUMES AS REFERENCED FROM DATA FVT      */     02548000
*                    /*                                          */     02549000
*                    /********************************************/     02550000
*                                                                  0820 02551000
*                    CALL DALCPROC ('A',                           0820 02552000
*                      FVTPTR(2)->CTGFVVLT,                        0820 02553000
*                      FVTPTR(2)->CTGFVIND,                        0820 02554000
*                      DALCINDX);                                  0820 02555000
*                                                                  0820 02556000
         LA    @15,@CC00755                                        0820 02557000
         ST    @15,@AL00001                                        0820 02558000
         LA    @15,CTGFVVLT(,@04)                                  0820 02559000
         ST    @15,@AL00001+4                                      0820 02560000
         LA    @04,CTGFVIND(,@04)                                  0820 02561000
         ST    @04,@AL00001+8                                      0820 02562000
         LA    @04,DALCINDX                                        0820 02563000
         ST    @04,@AL00001+12                                     0820 02564000
         LA    @01,@AL00001                                        0820 02565000
         BAL   @14,DALCPROC                                        0820 02566000
*                    IF DEFSTID ^= NORMSTAT                        0821 02567000
*                      THEN                                        0821 02568000
         CLI   DEFSTID,0                                           0821 02569000
         BE    @RF00821                                            0821 02570000
*                        /****************************************/     02571000
*                        /*                                      */     02572000
*                        /* ALLOCATION FAILED FOR DATA VOLUMES   */     02573000
*                        /* LIST.                                */     02574000
*                        /*                                      */     02575000
*                        /****************************************/     02576000
*                        DO;                                       0822 02577000
*                                                                  0822 02578000
*                        DARGSMOD = DEFMODID;                      0823 02579000
         L     @04,DDSTRU                                          0823 02580000
         MVC   DARGSMOD(3,@04),@CC00996                            0823 02581000
*                        RETURN CODE(LASTCC12);                    0824 02582000
*                                                                  0824 02583000
         LA    @15,12                                              0824 02584000
         L     @14,@SA00002                                        0824 02585000
         LM    @00,@12,@SA00002+8                                  0824 02586000
         BR    @14                                                 0824 02587000
*                        END;                                      0825 02588000
*                    END;                                          0826 02589000
*                END;                                              0827 02590000
*            ELSE                                                  0828 02591000
*                                                                  0828 02592000
*            IF UNIQD = ON                                         0828 02593000
*              THEN                                                0828 02594000
         B     @RC00803                                            0828 02595000
@RF00803 TM    UNIQD,B'10000000'                                   0828 02596000
         BNO   @RF00828                                            0828 02597000
*                IF FVTPTR(2) -> CTGFVIND = NULLPTR                0829 02598000
*                  THEN                                            0829 02599000
         L     @04,FVTPTR+4                                        0829 02600000
         L     @15,CTGFVIND(,@04)                                  0829 02601000
         LTR   @15,@15                                             0829 02602000
         BNZ   @RF00829                                            0829 02603000
*                    DO;                                           0830 02604000
*                    /********************************************/     02605000
*                    /*                                          */     02606000
*                    /* DYNAMICALLY ALLOCATE THE DATA COMPONENT  */     02607000
*                    /* VOLUMES AS REFERENCED FROM DATA FVT      */     02608000
*                    /*                                          */     02609000
*                    /********************************************/     02610000
*                                                                  0831 02611000
*                    CALL DALCPROC ('A',                           0831 02612000
*                      FVTPTR(2)->CTGFVVLT,                        0831 02613000
*                      FVTPTR(2)->CTGFVIND,                        0831 02614000
*                      DALCINDX);                                  0831 02615000
*                                                                  0831 02616000
         LA    @15,@CC00755                                        0831 02617000
         ST    @15,@AL00001                                        0831 02618000
         LA    @15,CTGFVVLT(,@04)                                  0831 02619000
         ST    @15,@AL00001+4                                      0831 02620000
         LA    @04,CTGFVIND(,@04)                                  0831 02621000
         ST    @04,@AL00001+8                                      0831 02622000
         LA    @04,DALCINDX                                        0831 02623000
         ST    @04,@AL00001+12                                     0831 02624000
         LA    @01,@AL00001                                        0831 02625000
         BAL   @14,DALCPROC                                        0831 02626000
*                    IF DEFSTID ^= NORMSTAT                        0832 02627000
*                      THEN                                        0832 02628000
         CLI   DEFSTID,0                                           0832 02629000
         BE    @RF00832                                            0832 02630000
*                        /****************************************/     02631000
*                        /*                                      */     02632000
*                        /* ALLOCATION FAILED FOR DATA VOLUMES   */     02633000
*                        /* LIST.                                */     02634000
*                        /*                                      */     02635000
*                        /****************************************/     02636000
*                        DO;                                       0833 02637000
*                                                                  0833 02638000
*                        DARGSMOD = DEFMODID;                      0834 02639000
         L     @04,DDSTRU                                          0834 02640000
         MVC   DARGSMOD(3,@04),@CC00996                            0834 02641000
*                        RETURN CODE(LASTCC12);                    0835 02642000
*                                                                  0835 02643000
         LA    @15,12                                              0835 02644000
         L     @14,@SA00002                                        0835 02645000
         LM    @00,@12,@SA00002+8                                  0835 02646000
         BR    @14                                                 0835 02647000
*                        END;                                      0836 02648000
*                    END;                                          0837 02649000
@RF00832 DS    0H                                                  0838 02650000
*          /********************************************************/   02651000
*          /*                                                      */   02652000
*          /* INDEX FVT MIGRATION - MOVE CLUSTER VOL LIST IF THERE */   02653000
*          /* IS NONE AT INDEX FVT - IF THERE IS AN INDEX FVT      */   02654000
*          /*                                                      */   02655000
*          /********************************************************/   02656000
*                                                                  0838 02657000
*          IF FVTPTR(3) ^= NULLPTR                                 0838 02658000
*            THEN                                                  0838 02659000
@RF00829 DS    0H                                                  0838 02660000
@RF00828 DS    0H                                                  0838 02661000
@RC00803 SLR   @04,@04                                             0838 02662000
         L     @15,FVTPTR+8                                        0838 02663000
         CR    @15,@04                                             0838 02664000
         BE    @RF00838                                            0838 02665000
*              DO;                                                 0839 02666000
*                                                                  0839 02667000
*                IF FVTPTR(3) -> CTGFVVLT = NULLPTR                0840 02668000
*                  THEN                                            0840 02669000
         C     @04,CTGFVVLT(,@15)                                  0840 02670000
         BNE   @RF00840                                            0840 02671000
*                    /********************************************/     02672000
*                    /*                                          */     02673000
*                    /* THE INDEX FVT HAS NO VOL LIST MOVE IT    */     02674000
*                    /* FROM THE CLUSTER .                       */     02675000
*                    /*                                          */     02676000
*                    /********************************************/     02677000
*                    DO;                                           0841 02678000
*                                                                  0841 02679000
*                    TOTLEN = (FVTPTR(1)->CTGFVVLT->FLISTLN) + 2;  0842 02680000
         L     @04,FVTPTR                                          0842 02681000
         L     @04,CTGFVVLT(,@04)                                  0842 02682000
         LA    @14,2                                               0842 02683000
         AH    @14,FLISTLN(,@04)                                   0842 02684000
         ST    @14,TOTLEN                                          0842 02685000
*                    CTGFVPTR = FVTPTR(3);                         0843 02686000
*                                                                  0843 02687000
         ST    @15,CTGFVPTR                                        0843 02688000
*                    CALL IDCSAGP0 (GDTTBL,                        0844 02689000
*                     TOTLEN,                                      0844 02690000
*                     CTGFVVLT,                                    0844 02691000
*                     GPID,                                        0844 02692000
*                     SETZERO);                                    0844 02693000
*                                                                  0844 02694000
         L     @04,@PC00001                                        0844 02695000
         ST    @04,@AL00001                                        0844 02696000
         LA    @14,TOTLEN                                          0844 02697000
         ST    @14,@AL00001+4                                      0844 02698000
         LA    @15,CTGFVVLT(,@15)                                  0844 02699000
         ST    @15,@AL00001+8                                      0844 02700000
         LA    @15,GPID                                            0844 02701000
         ST    @15,@AL00001+12                                     0844 02702000
         LA    @15,SETZERO                                         0844 02703000
         ST    @15,@AL00001+16                                     0844 02704000
         MVI   @AL00001+16,X'80'                                   0844 02705000
         L     @15,GDTGPL(,@04)                                    0844 02706000
         LA    @01,@AL00001                                        0844 02707000
         BALR  @14,@15                                             0844 02708000
*                     RESPECIFY RTNREG RSTD;                       0845 02709000
*                     TESTRC = RTNREG;                             0846 02710000
         STH   RTNREG,TESTRC                                       0846 02711000
*                     RESPECIFY RTNREG UNRSTD;                     0847 02712000
*                                                                  0847 02713000
*                     IF TESTRC ^= 0                               0848 02714000
*                       THEN                                       0848 02715000
         LH    @04,TESTRC                                          0848 02716000
         LTR   @04,@04                                             0848 02717000
         BZ    @RF00848                                            0848 02718000
*                         /****************************************/    02719000
*                         /*                                      */    02720000
*                         /* STORAGE REQUEST FAILED FOR INDEX VOL */    02721000
*                         /* LIST.                                */    02722000
*                         /*                                      */    02723000
*                         /****************************************/    02724000
*                         DO;                                      0849 02725000
*                                                                  0849 02726000
*                           DEFSTID = NOSTORAG;                    0850 02727000
         MVI   DEFSTID,X'04'                                       0850 02728000
*                           DARGSMOD = UNIVMSG;                    0851 02729000
         L     @04,DDSTRU                                          0851 02730000
         MVC   DARGSMOD(3,@04),@CC00981                            0851 02731000
*                           RETURN CODE(LASTCC);                   0852 02732000
*                                                                  0852 02733000
         L     @04,@PC00001+8                                      0852 02734000
         LH    @15,LASTCC(,@04)                                    0852 02735000
         L     @14,@SA00002                                        0852 02736000
         LM    @00,@12,@SA00002+8                                  0852 02737000
         BR    @14                                                 0852 02738000
*                         END;                                     0853 02739000
*                     /********************************************/    02740000
*                     /*                                          */    02741000
*                     /* MOVE THE VOL LIST FROM THE CLUSTER TO THE*/    02742000
*                     /* INDEX FVT VOL LIST CREATED BY ABOVE      */    02743000
*                     /* UGPOOL                                   */    02744000
*                     /*                                          */    02745000
*                     /********************************************/    02746000
*                                                                  0854 02747000
*                     FVTPTR(3)->CTGFVVLT->FLISTVOL(1 : TOTLEN)=   0854 02748000
*                     FVTPTR(1)->CTGFVVLT->FLISTVOL(1:TOTLEN);     0854 02749000
*                                                                  0854 02750000
@RF00848 L     @04,FVTPTR+8                                        0854 02751000
         L     @01,CTGFVVLT(,@04)                                  0854 02752000
         L     @15,TOTLEN                                          0854 02753000
         BCTR  @15,0                                               0854 02754000
         L     @14,FVTPTR                                          0854 02755000
         L     @14,CTGFVVLT(,@14)                                  0854 02756000
         EX    @15,@SM01780                                        0854 02757000
*                IF FVTPTR(3) -> CTGFVIND = NULLPTR & UNIQI = ON   0855 02758000
*                  THEN                                            0855 02759000
         L     @15,CTGFVIND(,@04)                                  0855 02760000
         LTR   @15,@15                                             0855 02761000
         BNZ   @RF00855                                            0855 02762000
         TM    UNIQI,B'10000000'                                   0855 02763000
         BNO   @RF00855                                            0855 02764000
*                    DO;                                           0856 02765000
*                    /********************************************/     02766000
*                    /*                                          */     02767000
*                    /* DYNAMICALLY ALLOCATE THE INDEX COMPONENT */     02768000
*                    /* VOLUMES AS REFERENCED FROM INDEX FVT     */     02769000
*                    /*                                          */     02770000
*                    /********************************************/     02771000
*                                                                  0857 02772000
*                    CALL DALCPROC ('A',                           0857 02773000
*                      FVTPTR(3)->CTGFVVLT,                        0857 02774000
*                      FVTPTR(3)->CTGFVIND,                        0857 02775000
*                      DALCINDX);                                  0857 02776000
*                                                                  0857 02777000
         LA    @15,@CC00755                                        0857 02778000
         ST    @15,@AL00001                                        0857 02779000
         LA    @15,CTGFVVLT(,@04)                                  0857 02780000
         ST    @15,@AL00001+4                                      0857 02781000
         LA    @04,CTGFVIND(,@04)                                  0857 02782000
         ST    @04,@AL00001+8                                      0857 02783000
         LA    @04,DALCINDX                                        0857 02784000
         ST    @04,@AL00001+12                                     0857 02785000
         LA    @01,@AL00001                                        0857 02786000
         BAL   @14,DALCPROC                                        0857 02787000
*                    IF DEFSTID ^= NORMSTAT                        0858 02788000
*                      THEN                                        0858 02789000
         CLI   DEFSTID,0                                           0858 02790000
         BE    @RF00858                                            0858 02791000
*                        /****************************************/     02792000
*                        /*                                      */     02793000
*                        /* ALLOCATION FAILED FOR INDEX VOLUMES  */     02794000
*                        /* LIST.                                */     02795000
*                        /*                                      */     02796000
*                        /****************************************/     02797000
*                        DO;                                       0859 02798000
*                                                                  0859 02799000
*                        DARGSMOD = DEFMODID;                      0860 02800000
         L     @04,DDSTRU                                          0860 02801000
         MVC   DARGSMOD(3,@04),@CC00996                            0860 02802000
*                        RETURN CODE(LASTCC12);                    0861 02803000
*                                                                  0861 02804000
         LA    @15,12                                              0861 02805000
         L     @14,@SA00002                                        0861 02806000
         LM    @00,@12,@SA00002+8                                  0861 02807000
         BR    @14                                                 0861 02808000
*                        END;                                      0862 02809000
*                    END;                                          0863 02810000
*                END;                                              0864 02811000
*            ELSE                                                  0865 02812000
*              IF FVTPTR(3) -> CTGFVIND = NULLPTR & UNIQI = ON     0865 02813000
*                THEN                                              0865 02814000
         B     @RC00840                                            0865 02815000
@RF00840 L     @04,FVTPTR+8                                        0865 02816000
         L     @15,CTGFVIND(,@04)                                  0865 02817000
         LTR   @15,@15                                             0865 02818000
         BNZ   @RF00865                                            0865 02819000
         TM    UNIQI,B'10000000'                                   0865 02820000
         BNO   @RF00865                                            0865 02821000
*                  DO;                                             0866 02822000
*                    /********************************************/     02823000
*                    /*                                          */     02824000
*                    /* DYNAMICALLY ALLOCATE THE INDEX COMPONENT */     02825000
*                    /* VOLUMES AS REFERENCED FROM INDEX FVT     */     02826000
*                    /*                                          */     02827000
*                    /********************************************/     02828000
*                                                                  0867 02829000
*                    CALL DALCPROC ('A',                           0867 02830000
*                      FVTPTR(3)->CTGFVVLT,                        0867 02831000
*                      FVTPTR(3)->CTGFVIND,                        0867 02832000
*                      DALCINDX);                                  0867 02833000
*                                                                  0867 02834000
         LA    @15,@CC00755                                        0867 02835000
         ST    @15,@AL00001                                        0867 02836000
         LA    @15,CTGFVVLT(,@04)                                  0867 02837000
         ST    @15,@AL00001+4                                      0867 02838000
         LA    @04,CTGFVIND(,@04)                                  0867 02839000
         ST    @04,@AL00001+8                                      0867 02840000
         LA    @04,DALCINDX                                        0867 02841000
         ST    @04,@AL00001+12                                     0867 02842000
         LA    @01,@AL00001                                        0867 02843000
         BAL   @14,DALCPROC                                        0867 02844000
*                    IF DEFSTID ^= NORMSTAT                        0868 02845000
*                      THEN                                        0868 02846000
         CLI   DEFSTID,0                                           0868 02847000
         BE    @RF00868                                            0868 02848000
*                        /****************************************/     02849000
*                        /*                                      */     02850000
*                        /* ALLOCATION FAILED FOR INDEX VOLUMES  */     02851000
*                        /* LIST.                                */     02852000
*                        /*                                      */     02853000
*                        /****************************************/     02854000
*                        DO;                                       0869 02855000
*                                                                  0869 02856000
*                        DARGSMOD = DEFMODID;                      0870 02857000
         L     @04,DDSTRU                                          0870 02858000
         MVC   DARGSMOD(3,@04),@CC00996                            0870 02859000
*                        RETURN CODE(LASTCC12);                    0871 02860000
*                                                                  0871 02861000
         LA    @15,12                                              0871 02862000
         L     @14,@SA00002                                        0871 02863000
         LM    @00,@12,@SA00002+8                                  0871 02864000
         BR    @14                                                 0871 02865000
*                        END;                                      0872 02866000
*                    END;                                          0873 02867000
@RF00868 DS    0H                                                  0874 02868000
*            END;                                                  0874 02869000
*                                                                  0874 02870000
@RF00865 DS    0H                                                  0874 02871000
@RC00840 DS    0H                                                  0875 02872000
*        /************************************************************/ 02873000
*        /*                                                          */ 02874000
*        /* ZERO OUT THE VOLUME LIST POINTER AT CLUSTER FVT          */ 02875000
*        /*                                                          */ 02876000
*        /************************************************************/ 02877000
*                                                                  0875 02878000
*        FVTPTR(1) -> CTGFVVLT = NULLPTR;                          0875 02879000
*                                                                  0875 02880000
@RF00838 L     @04,FVTPTR                                          0875 02881000
         SLR   @15,@15                                             0875 02882000
         ST    @15,CTGFVVLT(,@04)                                  0875 02883000
*        /************************************************************/ 02884000
*        /*                                                          */ 02885000
*        /*  SET CTGFVWKA TO POINT TO A WORK AREA FOR THE            */ 02886000
*        /*  VOLUME SERIAL NUMBER OF THE CATALOG RECOVERY            */ 02887000
*        /*  VOLUME.                                                 */ 02888000
*        /*                                                          */ 02889000
*        /************************************************************/ 02890000
*                                                                  0876 02891000
*        FVTPTR(1) -> CTGFVWKA = ADDR(CATRCVWK);                   0876 02892000
*                                                                  0876 02893000
         LA    @15,CATRCVWK                                        0876 02894000
         ST    @15,CTGFVWKA(,@04)                                  0876 02895000
*        /************************************************************/ 02896000
*        /*                                                          */ 02897000
*        /*  SAVE CPL, FVTS, AND FPLS PRIOR TO INVOKING CATALOG      */ 02898000
*        /*  MANAGEMENT BECAUSE THESE CONTROL BLOCKS MAY BE ALTERED  */ 02899000
*        /*  BY CATALOG MANAGEMENT.  IF THE OBJECT NAME IS A         */ 02900000
*        /*  DUPLICATE, IT MAY BE DELETED THEN REDEFINED, IN WHICH   */ 02901000
*        /*  CASE IT WILL BE NECESSARY TO RESTORE THE CONTROL BLOCKS */ 02902000
*        /*                                                          */ 02903000
*        /************************************************************/ 02904000
*                                                                  0877 02905000
*        TFVTLEN = LENGTH(CTGFV) + (LENGTH(CTGFL) + 8) * CFPLNUM + 0877 02906000
*          LENGTH(IDAAMDSB);                                       0877 02907000
*                                                                  0877 02908000
         LH    @04,CFPLNUM                                         0877 02909000
         MH    @04,@CH00312                                        0877 02910000
         LA    @04,188(,@04)                                       0877 02911000
         STH   @04,TFVTLEN                                         0877 02912000
*        SAVCPL = PTRCPL -> FIELDR(1:LENGTH(CTGPL) + 16);          0878 02913000
*                                                                  0878 02914000
         L     @04,PTRCPL                                          0878 02915000
         MVC   SAVCPL(44),FIELDR(@04)                              0878 02916000
*        /************************************************************/ 02917000
*        /*                                                          */ 02918000
*        /*  WHEN THE FVT'S WERE CONSTRUCTED, DOUBLE THE AREA NEEDED */ 02919000
*        /*  WAS OBTAINED FOR THE FVT SAVE AREA                      */ 02920000
*        /*                                                          */ 02921000
*        /************************************************************/ 02922000
*                                                                  0879 02923000
*        DO I = 1 TO NUMCOMP;                                      0879 02924000
         LA    @04,1                                               0879 02925000
         B     @DE00879                                            0879 02926000
@DL00879 DS    0H                                                  0880 02927000
*          SAVFVT(I) = FVTPTR(I) + TFVTLEN;                        0880 02928000
*                                                                  0880 02929000
         SLA   @04,2                                               0880 02930000
         LH    @15,TFVTLEN                                         0880 02931000
         AL    @15,FVTPTR-4(@04)                                   0880 02932000
         ST    @15,SAVFVT-4(@04)                                   0880 02933000
*          CALL MVDAPROC(TFVTLEN,FVTPTR(I),SAVFVT(I));             0881 02934000
*                                                                  0881 02935000
         LA    @15,TFVTLEN                                         0881 02936000
         ST    @15,@AL00001                                        0881 02937000
         LA    @15,FVTPTR-4(@04)                                   0881 02938000
         ST    @15,@AL00001+4                                      0881 02939000
         LA    @04,SAVFVT-4(@04)                                   0881 02940000
         ST    @04,@AL00001+8                                      0881 02941000
         LA    @01,@AL00001                                        0881 02942000
         BAL   @14,MVDAPROC                                        0881 02943000
*        END;                                                      0882 02944000
*                                                                  0882 02945000
         LA    @04,1                                               0882 02946000
         AL    @04,I                                               0882 02947000
@DE00879 ST    @04,I                                               0882 02948000
         CH    @04,NUMCOMP                                         0882 02949000
         BNH   @DL00879                                            0882 02950000
*        /************************************************************/ 02951000
*        /*                                                          */ 02952000
*        /*  INVOKE CATALOG MANAGEMENT TO DEFINE THE CLUSTER         */ 02953000
*        /*  OR AIX AND ITS COMPONENTS.                              */ 02954000
*        /*  SET IMPF2NER TO BE ON TO INDICATE THAT CTLGPROC         */ 02955000
*        /*  IS NOT TO PRINT ANY MESSAGES FOR A VSAM                 */ 02956000
*        /*  CATALOG RETURN CODE OF 8.                               */ 02957000
*        /*                                                          */ 02958000
*        /************************************************************/ 02959000
*                                                                  0883 02960000
*        IMPF2NER = ON;                                            0883 02961000
         OI    IMPF2NER,B'00001000'                                0883 02962000
*        CALL CTLGPROC(PTRCPL);                                    0884 02963000
         LA    @04,PTRCPL                                          0884 02964000
         ST    @04,@AL00001                                        0884 02965000
         LA    @01,@AL00001                                        0884 02966000
         BAL   @14,CTLGPROC                                        0884 02967000
*        RESPECIFY RTNREG RSTD;                                    0885 02968000
*        TESTRC = RTNREG;                                          0886 02969000
         STH   RTNREG,TESTRC                                       0886 02970000
*        RESPECIFY RTNREG UNRSTD;                                  0887 02971000
*                                                                  0887 02972000
*        /************************************************************/ 02973000
*        /*                                                          */ 02974000
*        /*  RESET IMPF2NER TO BE OFF.  ALL CATALOG ERROR            */ 02975000
*        /*  MESSAGES ARE TO BE PRINTED ON ALL OTHER CALLS           */ 02976000
*        /*  TO VSAM CATALOG MANAGEMENT.                             */ 02977000
*        /*                                                          */ 02978000
*        /************************************************************/ 02979000
*                                                                  0888 02980000
*        IMPF2NER = OFF;                                           0888 02981000
         NI    IMPF2NER,B'11110111'                                0888 02982000
*        IF TESTRC ^= 0                                            0889 02983000
*          THEN                                                    0889 02984000
         LH    @04,TESTRC                                          0889 02985000
         LTR   @04,@04                                             0889 02986000
         BZ    @RF00889                                            0889 02987000
*DEFERR:     DO;                                                   0890 02988000
*                                                                  0890 02989000
DEFERR   DS    0H                                                  0891 02990000
*            /********************************************************/ 02991000
*            /*                                                      */ 02992000
*            /*  IF THE CATALOG RETURN CODE INDICATES A DUPLICATE    */ 02993000
*            /*  ENTRY NAME EXISTS, CALL CPLPROC TO BUILD A CPL      */ 02994000
*            /*  FOR A CMS DELETE OPERATION.  IF THIS IS SUCCESSFUL  */ 02995000
*            /*  CALL DELTPROC TO INVOKE CATALOG MANAGEMENT.         */ 02996000
*            /*  IF THE CATALOG DEFINE FAILED FOR ANY OTHER REASON,  */ 02997000
*            /*  RETURN TO THE CALLING PROCESSOR                     */ 02998000
*            /*                                                      */ 02999000
*            /********************************************************/ 03000000
*                                                                  0891 03001000
*            IF CATLGRC ^= DUPNAME                                 0891 03002000
*              THEN                                                0891 03003000
         CLC   CATLGRC(2),@CH00039                                 0891 03004000
         BE    @RF00891                                            0891 03005000
*                DO;                                               0892 03006000
*                DARGSMOD = IMPMSG;                                0893 03007000
         L     @04,DDSTRU                                          0893 03008000
         MVC   DARGSMOD(3,@04),@CC00945                            0893 03009000
*                DARGSENT = MPRAFAIL;                              0894 03010000
         MVI   DARGSENT(@04),X'15'                                 0894 03011000
*                DARGILP = LENGTH(FENTNAME);                       0895 03012000
         MVC   DARGILP(2,@04),@CH00605                             0895 03013000
*                DARGDBP = FVTPTR(1) -> CTGFVENT;                  0896 03014000
*                                                                  0896 03015000
         L     @01,FVTPTR                                          0896 03016000
         L     @15,CTGFVENT(,@01)                                  0896 03017000
         ST    @15,DARGDBP(,@04)                                   0896 03018000
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             0897 03019000
*                                                                  0897 03020000
         L     @04,@PC00001                                        0897 03021000
         ST    @04,@AL00001                                        0897 03022000
         LA    @15,@CF00119                                        0897 03023000
         ST    @15,@AL00001+4                                      0897 03024000
         LA    @15,DDSTRU                                          0897 03025000
         ST    @15,@AL00001+8                                      0897 03026000
         MVI   @AL00001+8,X'80'                                    0897 03027000
         L     @15,GDTPRT(,@04)                                    0897 03028000
         LA    @01,@AL00001                                        0897 03029000
         BALR  @14,@15                                             0897 03030000
*                DARGLIST = ''B;                                   0898 03031000
         L     @04,DDSTRU                                          0898 03032000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0898 03033000
*                DARGSMOD = IMPMSG;                                0899 03034000
         MVC   DARGSMOD(3,@04),@CC00945                            0899 03035000
*                RETURN CODE(LASTCC08);                            0900 03036000
         LA    @15,8                                               0900 03037000
         L     @14,@SA00002                                        0900 03038000
         LM    @00,@12,@SA00002+8                                  0900 03039000
         BR    @14                                                 0900 03040000
*                END;                                              0901 03041000
*              ELSE                                                0902 03042000
*DUPENT:         DO;                                               0902 03043000
@RF00891 DS    0H                                                  0902 03044000
DUPENT   DS    0H                                                  0903 03045000
*                OLDERID2 = NEWERID2;                              0903 03046000
         L     @04,@PC00001                                        0903 03047000
         L     @04,GDTTR2(,@04)                                    0903 03048000
         MVC   @TS00001(95),NEWERID2(@04)                          0903 03049000
         MVC   OLDERID2(95,@04),@TS00001                           0903 03050000
*                NEWID2 = 'RMDV';                                  0904 03051000
*                                                                  0904 03052000
         MVC   NEWID2(4,@04),@CC01359                              0904 03053000
*                /****************************************************/ 03054000
*                /*                                                  */ 03055000
*                /*  CALL CPLPROC TO BUILD THE CPL.  IF IT SHOULD    */ 03056000
*                /*  FAIL FOR ANY REASON RETURN TO THE CALLER WITH   */ 03057000
*                /*  A TERMINAL ERROR INDICATED.                     */ 03058000
*                /*                                                  */ 03059000
*                /****************************************************/ 03060000
*                                                                  0905 03061000
*                CALL CPLPROC('D',DCPLPTR,FVTPTR(1)->CTGFVENT,     0905 03062000
*                   NULLPARM,CPSWD);                               0905 03063000
*                                                                  0905 03064000
         LA    @04,@CC00751                                        0905 03065000
         ST    @04,@AL00001                                        0905 03066000
         LA    @04,DCPLPTR                                         0905 03067000
         ST    @04,@AL00001+4                                      0905 03068000
         L     @04,FVTPTR                                          0905 03069000
         LA    @04,CTGFVENT(,@04)                                  0905 03070000
         ST    @04,@AL00001+8                                      0905 03071000
         LA    @04,NULLPARM                                        0905 03072000
         ST    @04,@AL00001+12                                     0905 03073000
         LA    @04,CPSWD                                           0905 03074000
         ST    @04,@AL00001+16                                     0905 03075000
         LA    @01,@AL00001                                        0905 03076000
         BAL   @14,CPLPROC                                         0905 03077000
*                RESPECIFY RTNREG RSTD;                            0906 03078000
*                TESTRC = RTNREG;                                  0907 03079000
         STH   RTNREG,TESTRC                                       0907 03080000
*                RESPECIFY RTNREG UNRSTD;                          0908 03081000
*                IF TESTRC ^= 0                                    0909 03082000
*                  THEN                                            0909 03083000
         LH    @04,TESTRC                                          0909 03084000
         LTR   @04,@04                                             0909 03085000
         BZ    @RF00909                                            0909 03086000
*                    RETURN CODE(LASTCC12);                        0910 03087000
*                                                                  0910 03088000
         LA    @15,12                                              0910 03089000
         L     @14,@SA00002                                        0910 03090000
         LM    @00,@12,@SA00002+8                                  0910 03091000
         BR    @14                                                 0910 03092000
*                /****************************************************/ 03093000
*                /*                                                  */ 03094000
*                /*  SET THE CTGTYPE FIELD OF THE CPL.               */ 03095000
*                /*                                                  */ 03096000
*                /****************************************************/ 03097000
*                                                                  0911 03098000
*                DCPLPTR -> CTGTYPE = FVTPTR(1) -> CTGFVTYP;       0911 03099000
*                                                                  0911 03100000
@RF00909 L     @04,DCPLPTR                                         0911 03101000
         L     @01,FVTPTR                                          0911 03102000
         MVC   CTGTYPE(1,@04),CTGFVTYP(@01)                        0911 03103000
*                /****************************************************/ 03104000
*                /*                                                  */ 03105000
*                /*  CALL DELTPROC TO INVOKE VSAM CATALOG MANAGEMENT */ 03106000
*                /*                                                  */ 03107000
*                /****************************************************/ 03108000
*                                                                  0912 03109000
*                CALL DELTPROC(DCPLPTR);                           0912 03110000
*                                                                  0912 03111000
         LA    @04,DCPLPTR                                         0912 03112000
         ST    @04,@AL00001                                        0912 03113000
         LA    @01,@AL00001                                        0912 03114000
         BAL   @14,DELTPROC                                        0912 03115000
*                RESPECIFY RTNREG RSTD;                            0913 03116000
*                TESTRC = RTNREG;                                  0914 03117000
         STH   RTNREG,TESTRC                                       0914 03118000
*                RESPECIFY RTNREG UNRSTD;                          0915 03119000
*                IF TESTRC ^= 0                                    0916 03120000
*                  THEN                                            0916 03121000
*                                                                  0916 03122000
         LH    @04,TESTRC                                          0916 03123000
         LTR   @04,@04                                             0916 03124000
         BZ    @RF00916                                            0916 03125000
*                    /************************************************/ 03126000
*                    /*                                              */ 03127000
*                    /*  THE DELETE OF THE DUPLICATE ENTRY           */ 03128000
*                    /*  HAS FAILED.  RETURN WITH ERROR INDICATED.   */ 03129000
*                    /*                                              */ 03130000
*                    /************************************************/ 03131000
*                                                                  0917 03132000
*                    DO;                                           0917 03133000
*                    DARGSMOD = IMPMSG;                            0918 03134000
         L     @04,DDSTRU                                          0918 03135000
         MVC   DARGSMOD(3,@04),@CC00945                            0918 03136000
*                    DARGSENT = MPRAFAIL;                          0919 03137000
         MVI   DARGSENT(@04),X'15'                                 0919 03138000
*                    DARGILP = LENGTH(FENTNAME);                   0920 03139000
         MVC   DARGILP(2,@04),@CH00605                             0920 03140000
*                    DARGDBP = FVTPTR(1) -> CTGFVENT;              0921 03141000
*                                                                  0921 03142000
         L     @01,FVTPTR                                          0921 03143000
         L     @15,CTGFVENT(,@01)                                  0921 03144000
         ST    @15,DARGDBP(,@04)                                   0921 03145000
*                    CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         0922 03146000
*                                                                  0922 03147000
         L     @04,@PC00001                                        0922 03148000
         ST    @04,@AL00001                                        0922 03149000
         LA    @15,@CF00119                                        0922 03150000
         ST    @15,@AL00001+4                                      0922 03151000
         LA    @15,DDSTRU                                          0922 03152000
         ST    @15,@AL00001+8                                      0922 03153000
         MVI   @AL00001+8,X'80'                                    0922 03154000
         L     @15,GDTPRT(,@04)                                    0922 03155000
         LA    @01,@AL00001                                        0922 03156000
         BALR  @14,@15                                             0922 03157000
*                    DARGLIST = ''B;                               0923 03158000
         L     @04,DDSTRU                                          0923 03159000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0923 03160000
*                    DARGSMOD = IMPMSG;                            0924 03161000
         MVC   DARGSMOD(3,@04),@CC00945                            0924 03162000
*                    RETURN CODE(LASTCC08);                        0925 03163000
         LA    @15,8                                               0925 03164000
         L     @14,@SA00002                                        0925 03165000
         LM    @00,@12,@SA00002+8                                  0925 03166000
         BR    @14                                                 0925 03167000
*                    END;                                          0926 03168000
*                                                                  0926 03169000
*                /**************************************************/   03170000
*                /*                                                  */ 03171000
*                /*  THE PREVIOUSLY EXISTING ENTRY HAS               */ 03172000
*                /*  BEEN DELETED.  RESTORE THE CPL TO               */ 03173000
*                /*  ITS STATE PRIOR TO INVOKING                     */ 03174000
*                /*  CATALOG MANAGEMENT DEFINE.                      */ 03175000
*                /*                                                  */ 03176000
*                /***************************************************/  03177000
*                                                                  0927 03178000
*                SAVCPLLN = LENGTH(CTGPL) + 16;                    0927 03179000
@RF00916 LA    @04,44                                              0927 03180000
         ST    @04,SAVCPLLN                                        0927 03181000
*                PTRCPL -> FIELDR(1:SAVCPLLN)                      0928 03182000
*                   = SAVCPL;                                      0928 03183000
*                                                                  0928 03184000
         L     @01,PTRCPL                                          0928 03185000
         BCTR  @04,0                                               0928 03186000
         EX    @04,@SM01784                                        0928 03187000
*                DO I = 1 TO NUMCOMP;                              0929 03188000
*                                                                  0929 03189000
         LA    @04,1                                               0929 03190000
         B     @DE00929                                            0929 03191000
@DL00929 DS    0H                                                  0930 03192000
*                  CALL MVDAPROC(TFVTLEN,SAVFVT(I),                0930 03193000
*                      FVTPTR(I));                                 0930 03194000
*                                                                  0930 03195000
         LA    @15,TFVTLEN                                         0930 03196000
         ST    @15,@AL00001                                        0930 03197000
         SLA   @04,2                                               0930 03198000
         LA    @15,SAVFVT-4(@04)                                   0930 03199000
         ST    @15,@AL00001+4                                      0930 03200000
         LA    @04,FVTPTR-4(@04)                                   0930 03201000
         ST    @04,@AL00001+8                                      0930 03202000
         LA    @01,@AL00001                                        0930 03203000
         BAL   @14,MVDAPROC                                        0930 03204000
*                  /*************************************************/  03205000
*                  /*                                                */ 03206000
*                  /*  REINITIALIZE VOLUME SERIAL LIST               */ 03207000
*                  /*  RETURN CODE FIELDS FOR DATA AND               */ 03208000
*                  /*  INDEX COMPONENTS (IF EXISTANT).               */ 03209000
*                  /*                                                */ 03210000
*                  /*************************************************/  03211000
*                                                                  0931 03212000
*                  CTGFVPTR = FVTPTR(I);                           0931 03213000
         L     @04,I                                               0931 03214000
         SLA   @04,2                                               0931 03215000
         L     @04,FVTPTR-4(@04)                                   0931 03216000
         ST    @04,CTGFVPTR                                        0931 03217000
*                  IF  CTGFVVLT ^= NULLPTR                         0932 03218000
*                    THEN                                          0932 03219000
         L     @04,CTGFVVLT(,@04)                                  0932 03220000
         LTR   @04,@04                                             0932 03221000
         BZ    @RF00932                                            0932 03222000
*                      DO J = 1 TO                                 0933 03223000
*                         (FLISTLN/LENGTH(FVOLSERL));              0933 03224000
         LA    @04,1                                               0933 03225000
         B     @DE00933                                            0933 03226000
@DL00933 DS    0H                                                  0934 03227000
*                        FVOLRTN(J) = 0;                           0934 03228000
         LR    @15,@04                                             0934 03229000
         SLA   @15,3                                               0934 03230000
         L     @01,CTGFVPTR                                        0934 03231000
         L     @01,CTGFVVLT(,@01)                                  0934 03232000
         ALR   @01,@15                                             0934 03233000
         AL    @01,@CF01786                                        0934 03234000
         SLR   @00,@00                                             0934 03235000
         STCM  @00,3,FVOLRTN-2(@01)                                0934 03236000
*                      END;                                        0935 03237000
*                                                                  0935 03238000
         AL    @04,@CF00221                                        0935 03239000
@DE00933 ST    @04,J                                               0935 03240000
         L     @01,CTGFVPTR                                        0935 03241000
         L     @01,CTGFVVLT(,@01)                                  0935 03242000
         LH    @00,FLISTLN(,@01)                                   0935 03243000
         SRDA  @00,32                                              0935 03244000
         D     @00,@CF00039                                        0935 03245000
         CR    @04,@01                                             0935 03246000
         BNH   @DL00933                                            0935 03247000
*                  /**************************************************/ 03248000
*                  /*                                                */ 03249000
*                  /*  IF A UNIQUE DATA SET DEFINED,                 */ 03250000
*                  /*  RESTORE THE VOLUME FVT.                       */ 03251000
*                  /*                                                */ 03252000
*                  /**************************************************/ 03253000
*                                                                  0936 03254000
*                  IF (FVTPTR(1) -> CTGFVVCH) ^= NULLPTR           0936 03255000
*                    THEN                                          0936 03256000
@RF00932 L     @04,FVTPTR                                          0936 03257000
         L     @04,CTGFVVCH(,@04)                                  0936 03258000
         LTR   @04,@04                                             0936 03259000
         BZ    @RF00936                                            0936 03260000
*                      DO;                                         0937 03261000
*                      IUNIQFVT = ''B;                             0938 03262000
         XC    IUNIQFVT(92),IUNIQFVT                               0938 03263000
*                      FVTPTR(1) -> CTGFVVCH -> CTGFVTYP           0939 03264000
*                         = CTGFVVOL;                              0939 03265000
         MVI   CTGFVTYP(@04),C'V'                                  0939 03266000
*                      END;                                        0940 03267000
*                                                                  0940 03268000
*                END;                                              0941 03269000
*                                                                  0941 03270000
@RF00936 LA    @04,1                                               0941 03271000
         AL    @04,I                                               0941 03272000
@DE00929 ST    @04,I                                               0941 03273000
         CH    @04,NUMCOMP                                         0941 03274000
         BNH   @DL00929                                            0941 03275000
*                /****************************************************/ 03276000
*                /*                                                  */ 03277000
*                /*  INVOKE CATALOG MANAGEMENT TO DEFINE             */ 03278000
*                /*  THE OBJECT.  IF DEFINE FAILS RETURN             */ 03279000
*                /*  TO CALLING PROCESSOR.                           */ 03280000
*                /*                                                  */ 03281000
*                /****************************************************/ 03282000
*                                                                  0942 03283000
*                CTGPLPTR = PTRCPL;                                0942 03284000
*                                                                  0942 03285000
         L     @04,PTRCPL                                          0942 03286000
         ST    @04,CTGPLPTR                                        0942 03287000
*                CALL CTLGPROC(PTRCPL);                            0943 03288000
*                                                                  0943 03289000
         LA    @04,PTRCPL                                          0943 03290000
         ST    @04,@AL00001                                        0943 03291000
         LA    @01,@AL00001                                        0943 03292000
         BAL   @14,CTLGPROC                                        0943 03293000
*                RESPECIFY RTNREG RSTD;                            0944 03294000
*                TESTRC = RTNREG;                                  0945 03295000
         STH   RTNREG,TESTRC                                       0945 03296000
*                RESPECIFY RTNREG UNRSTD;                          0946 03297000
*                IF TESTRC ^= 0                                    0947 03298000
*                  THEN                                            0947 03299000
         LH    @04,TESTRC                                          0947 03300000
         LTR   @04,@04                                             0947 03301000
         BZ    @RF00947                                            0947 03302000
*                    DO;                                           0948 03303000
*                    DARGSMOD = IMPMSG;                            0949 03304000
         L     @04,DDSTRU                                          0949 03305000
         MVC   DARGSMOD(3,@04),@CC00945                            0949 03306000
*                    DARGSENT = MPRAFAIL;                          0950 03307000
         MVI   DARGSENT(@04),X'15'                                 0950 03308000
*                    DARGILP = LENGTH(FENTNAME);                   0951 03309000
         MVC   DARGILP(2,@04),@CH00605                             0951 03310000
*                    DARGDBP = FVTPTR(1) -> CTGFVENT;              0952 03311000
*                                                                  0952 03312000
         L     @01,FVTPTR                                          0952 03313000
         L     @15,CTGFVENT(,@01)                                  0952 03314000
         ST    @15,DARGDBP(,@04)                                   0952 03315000
*                    CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         0953 03316000
*                                                                  0953 03317000
         L     @04,@PC00001                                        0953 03318000
         ST    @04,@AL00001                                        0953 03319000
         LA    @15,@CF00119                                        0953 03320000
         ST    @15,@AL00001+4                                      0953 03321000
         LA    @15,DDSTRU                                          0953 03322000
         ST    @15,@AL00001+8                                      0953 03323000
         MVI   @AL00001+8,X'80'                                    0953 03324000
         L     @15,GDTPRT(,@04)                                    0953 03325000
         LA    @01,@AL00001                                        0953 03326000
         BALR  @14,@15                                             0953 03327000
*                    DARGLIST = ''B;                               0954 03328000
         L     @04,DDSTRU                                          0954 03329000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0954 03330000
*                    DARGSMOD = IMPMSG;                            0955 03331000
         MVC   DARGSMOD(3,@04),@CC00945                            0955 03332000
*                    RETURN CODE(LASTCC08);                        0956 03333000
         LA    @15,8                                               0956 03334000
         L     @14,@SA00002                                        0956 03335000
         LM    @00,@12,@SA00002+8                                  0956 03336000
         BR    @14                                                 0956 03337000
*                    END;                                          0957 03338000
*                                                                  0957 03339000
*                /****************************************************/ 03340000
*                /*                                                  */ 03341000
*                /*  RESET THE VALUE OF DEFSTID TO NORMSTAT TO       */ 03342000
*                /*  INDICATE THAT THE ORIGINAL DEFINE ERROR HAS     */ 03343000
*                /*  BEEN CLEARED.                                   */ 03344000
*                /*                                                  */ 03345000
*                /****************************************************/ 03346000
*                                                                  0958 03347000
*                DEFSTID = NORMSTAT;                               0958 03348000
*                                                                  0958 03349000
@RF00947 MVI   DEFSTID,X'00'                                       0958 03350000
*                END DUPENT;                                       0959 03351000
*            END DEFERR;                                           0960 03352000
*                                                                  0960 03353000
*                                                                  0960 03354000
*        /********************************************************/     03355000
*        /*                                                      */     03356000
*        /*  CHECK TO SEE IF A RECOVERY VOLSER HAS BEEN          */     03357000
*        /*  RETURNED BY CATALOG.  IF SO, PRINT IT.              */     03358000
*        /*                                                      */     03359000
*        /********************************************************/     03360000
*                                                                  0961 03361000
*        DARGSMOD = DEFMODID;                                      0961 03362000
@RF00889 L     @04,DDSTRU                                          0961 03363000
         MVC   DARGSMOD(3,@04),@CC00996                            0961 03364000
*        IF CATRCWKA ^= ZEROS                                      0962 03365000
*          THEN                                                    0962 03366000
         CLC   CATRCWKA(6),ZEROS                                   0962 03367000
         BE    @RF00962                                            0962 03368000
*            DO;                                                   0963 03369000
*            DARGSENT = RCVYVOLM;                                  0964 03370000
         MVI   DARGSENT(@04),X'15'                                 0964 03371000
*            DARGILP = LENGTH(CATRCWKA);                           0965 03372000
         MVC   DARGILP(2,@04),@CH00041                             0965 03373000
*            DARGDBP = ADDR(CATRCWKA);                             0966 03374000
*                                                                  0966 03375000
         LA    @15,CATRCWKA                                        0966 03376000
         ST    @15,DARGDBP(,@04)                                   0966 03377000
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                 0967 03378000
*                                                                  0967 03379000
         L     @04,@PC00001                                        0967 03380000
         ST    @04,@AL00001                                        0967 03381000
         LA    @15,@CF00119                                        0967 03382000
         ST    @15,@AL00001+4                                      0967 03383000
         LA    @15,DDSTRU                                          0967 03384000
         ST    @15,@AL00001+8                                      0967 03385000
         MVI   @AL00001+8,X'80'                                    0967 03386000
         L     @15,GDTPRT(,@04)                                    0967 03387000
         LA    @01,@AL00001                                        0967 03388000
         BALR  @14,@15                                             0967 03389000
*            END;                                                  0968 03390000
*                                                                  0968 03391000
*        /********************************************************/     03392000
*        /*                                                      */     03393000
*        /*  CLUSTER HAS BEEN DEFINED SUCCESSFULLY.              */     03394000
*        /*  ISSUE ALLOCATION MESSAGES                           */     03395000
*        /*                                                      */     03396000
*        /********************************************************/     03397000
*                                                                  0969 03398000
*        DARGSENT = VOLDATA;                                       0969 03399000
@RF00962 L     @04,DDSTRU                                          0969 03400000
         MVI   DARGSENT(@04),X'09'                                 0969 03401000
*        CTGFVPTR = CTGFVT -> CTGFVDCH;                            0970 03402000
*                                                                  0970 03403000
         L     @04,CTGPLPTR                                        0970 03404000
         L     @04,CTGFVT(,@04)                                    0970 03405000
         L     @04,CTGFVDCH(,@04)                                  0970 03406000
         ST    @04,CTGFVPTR                                        0970 03407000
*        /********************************************************/     03408000
*        /*                                                      */     03409000
*        /*  FIRST ISSUE THE VOLUME ALLOCATION MESSAGE           */     03410000
*        /*  FOR THE DATA COMPONENT AND THEN FOR THE             */     03411000
*        /*  INDEX IF ANY EXISTS.  ONE CALL TO THE TEXT          */     03412000
*        /*  PROCESSOR WILL PRINT THE ENTIRE VOLUME              */     03413000
*        /*  FOR ONE COMPONENT.                                  */     03414000
*        /*                                                      */     03415000
*        /********************************************************/     03416000
*                                                                  0971 03417000
*        DO I = 2 TO NUMCOMP;                                      0971 03418000
         LA    @04,2                                               0971 03419000
         B     @DE00971                                            0971 03420000
@DL00971 DS    0H                                                  0972 03421000
*          IF CTGFVVLT ^= NULLPTR                                  0972 03422000
*            THEN                                                  0972 03423000
         L     @04,CTGFVPTR                                        0972 03424000
         L     @04,CTGFVVLT(,@04)                                  0972 03425000
         LTR   @04,@04                                             0972 03426000
         BZ    @RF00972                                            0972 03427000
*              DO;                                                 0973 03428000
*              DARGDBP = CTGFVVLT + 2;                             0974 03429000
         L     @15,DDSTRU                                          0974 03430000
         LA    @14,2                                               0974 03431000
         ALR   @14,@04                                             0974 03432000
         ST    @14,DARGDBP(,@15)                                   0974 03433000
*              DARGILP = CTGFVVLT -> FLISTLN;                      0975 03434000
         LH    @04,FLISTLN(,@04)                                   0975 03435000
         STH   @04,DARGILP(,@15)                                   0975 03436000
*              DARGCNT = 1;                                        0976 03437000
         LA    @14,1                                               0976 03438000
         STH   @14,DARGCNT(,@15)                                   0976 03439000
*              DARGINS(1) = 1;                                     0977 03440000
         STH   @14,DARGINS(,@15)                                   0977 03441000
*              DARGPCT(1) = DARGILP/8;                             0978 03442000
*                                                                  0978 03443000
         LR    @00,@04                                             0978 03444000
         SRDA  @00,32                                              0978 03445000
         D     @00,@CF00039                                        0978 03446000
         STH   @01,DARGPCT(,@15)                                   0978 03447000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);               0979 03448000
*                                                                  0979 03449000
         L     @04,@PC00001                                        0979 03450000
         ST    @04,@AL00001                                        0979 03451000
         LA    @15,@CF00119                                        0979 03452000
         ST    @15,@AL00001+4                                      0979 03453000
         LA    @15,DDSTRU                                          0979 03454000
         ST    @15,@AL00001+8                                      0979 03455000
         MVI   @AL00001+8,X'80'                                    0979 03456000
         L     @15,GDTPRT(,@04)                                    0979 03457000
         LA    @01,@AL00001                                        0979 03458000
         BALR  @14,@15                                             0979 03459000
*              END;                                                0980 03460000
*          CTGFVPTR = CTGFVT -> CTGFVICH;                          0981 03461000
@RF00972 L     @04,CTGPLPTR                                        0981 03462000
         L     @04,CTGFVT(,@04)                                    0981 03463000
         L     @04,CTGFVICH(,@04)                                  0981 03464000
         ST    @04,CTGFVPTR                                        0981 03465000
*          DARGSENT = VOLINDEX;                                    0982 03466000
         L     @04,DDSTRU                                          0982 03467000
         MVI   DARGSENT(@04),X'0A'                                 0982 03468000
*        END;                                                      0983 03469000
*                                                                  0983 03470000
*                                                                  0983 03471000
         LA    @04,1                                               0983 03472000
         AL    @04,I                                               0983 03473000
@DE00971 ST    @04,I                                               0983 03474000
         CH    @04,NUMCOMP                                         0983 03475000
         BNH   @DL00971                                            0983 03476000
*        DARGSMOD=IMPMSG;                                          0984 03477000
*                                                                  0984 03478000
         L     @04,DDSTRU                                          0984 03479000
         MVC   DARGSMOD(3,@04),@CC00945                            0984 03480000
*        /************************************************************/ 03481000
*        /*                                                          */ 03482000
*        /*  DEALLOCATE VOLUMES WHICH HAVE BEEN DYNAMICALLY          */ 03483000
*        /*  ALLOCATED.                                              */ 03484000
*        /*                                                          */ 03485000
*        /************************************************************/ 03486000
*                                                                  0985 03487000
*        IF DALCINDX > 0                                           0985 03488000
*          THEN                                                    0985 03489000
         L     @04,DALCINDX                                        0985 03490000
         LTR   @04,@04                                             0985 03491000
         BNP   @RF00985                                            0985 03492000
*            CALL DALCPROC('D',NULLPARM,NULLPARM,DALCINDX);        0986 03493000
*                                                                  0986 03494000
         MVC   @AL00001(12),@AL00986                               0986 03495000
         LA    @04,DALCINDX                                        0986 03496000
         ST    @04,@AL00001+12                                     0986 03497000
         LA    @01,@AL00001                                        0986 03498000
         BAL   @14,DALCPROC                                        0986 03499000
*        /************************************************************/ 03500000
*        /*                                                          */ 03501000
*        /*  ALLOCATE THE CLUSTER IF IT WAS NOT ALLOCATED BY JCL.    */ 03502000
*        /*                                                          */ 03503000
*        /************************************************************/ 03504000
*                                                                  0987 03505000
*        IF ADDR(OUTDD) = NULLPTR                                  0987 03506000
*          THEN                                                    0987 03507000
@RF00985 L     @04,@PC00001+4                                      0987 03508000
         L     @04,FDTPTR+4(,@04)                                  0987 03509000
         LTR   @04,@04                                             0987 03510000
         BNZ   @RF00987                                            0987 03511000
*            DO;                                                   0988 03512000
*            ALLPTR = ADDR(ALLLIST);                               0989 03513000
         LA    @04,ALLLIST                                         0989 03514000
         ST    @04,ALLPTR                                          0989 03515000
*            ALLAGL = ''B;                                         0990 03516000
         XC    ALLAGL(31,@04),ALLAGL(@04)                          0990 03517000
*            ALLDSN = FVTPTR(1) -> CTGFVENT;                       0991 03518000
         L     @01,FVTPTR                                          0991 03519000
         L     @15,CTGFVENT(,@01)                                  0991 03520000
         ST    @15,ALLDSN(,@04)                                    0991 03521000
*            ALLOPTVL = OFF;                                       0992 03522000
*            ALLOPTDS = ON;                                        0993 03523000
         OI    ALLOPTDS(@04),B'01000000'                           0993 03524000
         NI    ALLOPTVL(@04),B'01111111'                           0993 03525000
*            ALLSTSOD = ON;                                        0994 03526000
         OI    ALLSTSOD(@04),B'00000001'                           0994 03527000
*            ALLDSPKP = ON;                                        0995 03528000
*                                                                  0995 03529000
         OI    ALLDSPKP(@04),B'00001000'                           0995 03530000
*            CALL IDCSAAL0(GDTTBL,ALLAGL);                         0996 03531000
*                                                                  0996 03532000
         L     @15,@PC00001                                        0996 03533000
         ST    @15,@AL00001                                        0996 03534000
         ST    @04,@AL00001+4                                      0996 03535000
         MVI   @AL00001+4,X'80'                                    0996 03536000
         L     @15,GDTALC(,@15)                                    0996 03537000
         LA    @01,@AL00001                                        0996 03538000
         BALR  @14,@15                                             0996 03539000
*            IF TESTRC = 0                                         0997 03540000
*              THEN                                                0997 03541000
         LH    @04,TESTRC                                          0997 03542000
         LTR   @04,@04                                             0997 03543000
         BNZ   @RF00997                                            0997 03544000
*                DEALLOC = ON;                                     0998 03545000
         OI    DEALLOC,B'10000000'                                 0998 03546000
*              ELSE                                                0999 03547000
*                RETURN CODE(LASTCC12);                            0999 03548000
         B     @RC00997                                            0999 03549000
@RF00997 LA    @15,12                                              0999 03550000
         L     @14,@SA00002                                        0999 03551000
         LM    @00,@12,@SA00002+8                                  0999 03552000
         BR    @14                                                 0999 03553000
*            END;                                                  1000 03554000
@RC00997 DS    0H                                                  1001 03555000
*        /************************************************************/ 03556000
*        /*                                                          */ 03557000
*        /*  LOOP DEFINING THE PATHS THAT WERE EXPORTED WITH         */ 03558000
*        /*  THE DATA SET.  SHOULD ANY CMS DEFINE FAIL,              */ 03559000
*        /*  SIMPLY GO ON TO THE NEXT PATH.                          */ 03560000
*        /*                                                          */ 03561000
*        /************************************************************/ 03562000
*                                                                  1001 03563000
*        /************************************************************/ 03564000
*        /*                                                          */ 03565000
*        /*  INITIALIZE THE GETREO FLAG TO OFF. THIS FLAG IS         */ 03566000
*        /*  USED TO INDICATE THAT THE LOOP USED TO DEFINE PATHS     */ 03567000
*        /*  IS TO TERMINATE EARLY, FOR EXPORTRA WAS NOT ABLE        */ 03568000
*        /*  TO WRITE OUT ALL OF THE PATH INFORMATION FOR ALL        */ 03569000
*        /*  OF THE PATHS ASSOCIATED WITH THE VSAM OBJECT.           */ 03570000
*        /*                                                          */ 03571000
*        /************************************************************/ 03572000
*                                                                  1001 03573000
*        GETREO = OFF;                                     /*@OZ10871*/ 03574000
*                                                                  1001 03575000
@RF00987 NI    GETREO,B'01111111'                                  1001 03576000
*        /************************************************************/ 03577000
*        /*                                                          */ 03578000
*        /*  TEST FOR THE PRESENCE OF PATH ASSOCIATIONS ON           */ 03579000
*        /*  THE PORTABILITY DATA SET.                               */ 03580000
*        /*                                                          */ 03581000
*        /************************************************************/ 03582000
*                                                                  1002 03583000
*        IF IMPASSOC = ON                                          1002 03584000
*          THEN                                                    1002 03585000
         TM    IMPASSOC,B'00100000'                                1002 03586000
         BNO   @RF01002                                            1002 03587000
*PATHDEF:    DO;                                                   1003 03588000
PATHDEF  DS    0H                                                  1004 03589000
*            OLDERID2 = NEWERID2;                                  1004 03590000
         L     @04,@PC00001                                        1004 03591000
         L     @04,GDTTR2(,@04)                                    1004 03592000
         MVC   @TS00001(95),NEWERID2(@04)                          1004 03593000
         MVC   OLDERID2(95,@04),@TS00001                           1004 03594000
*            NEWID2 = 'RMPT';                                      1005 03595000
*                                                                  1005 03596000
         MVC   NEWID2(4,@04),@CC01362                              1005 03597000
*            /********************************************************/ 03598000
*            /*                                                      */ 03599000
*            /*  BUILD AND SAVE THE CPL USED TO DEFINE               */ 03600000
*            /*  ALL OF THE PATHS ON THE PORTABILITY                 */ 03601000
*            /*  DATA SET.                                           */ 03602000
*            /*                                                      */ 03603000
*            /********************************************************/ 03604000
*                                                                  1006 03605000
*            CALL CPLPROC('F',PPTRCPL,NULLPARM,NULLPARM,           1006 03606000
*               NULLPARM);                                         1006 03607000
*                                                                  1006 03608000
         MVC   @AL00001(20),@AL01006                               1006 03609000
         LA    @04,PPTRCPL                                         1006 03610000
         ST    @04,@AL00001+4                                      1006 03611000
         LA    @01,@AL00001                                        1006 03612000
         BAL   @14,CPLPROC                                         1006 03613000
*            RESPECIFY RTNREG RSTD;                                1007 03614000
*            TESTRC = RTNREG;                                      1008 03615000
         STH   RTNREG,TESTRC                                       1008 03616000
*            RESPECIFY RTNREG UNRSTD;                              1009 03617000
*                                                                  1009 03618000
*            IF TESTRC ^= 0                                        1010 03619000
*              THEN                                                1010 03620000
         LH    @04,TESTRC                                          1010 03621000
         LTR   @04,@04                                             1010 03622000
         BZ    @RF01010                                            1010 03623000
*                RETURN CODE(LASTCC12);                            1011 03624000
*                                                                  1011 03625000
         LA    @15,12                                              1011 03626000
         L     @14,@SA00002                                        1011 03627000
         LM    @00,@12,@SA00002+8                                  1011 03628000
         BR    @14                                                 1011 03629000
*            CTGPLPTR = PPTRCPL;                                   1012 03630000
@RF01010 L     @04,PPTRCPL                                         1012 03631000
         ST    @04,CTGPLPTR                                        1012 03632000
*            PSAVCPL = CTGPL;                                      1013 03633000
*                                                                  1013 03634000
         MVC   PSAVCPL(28),CTGPL(@04)                              1013 03635000
*            /********************************************************/ 03636000
*            /*                                                      */ 03637000
*            /*  SET THE TOTAL LENGTH OF THE WORK AREA TO 0,         */ 03638000
*            /*  AND TURN OFF THE FLAG INDICATING THAT CORE          */ 03639000
*            /*  HAS BEEN GOTTEN FOR IT.                             */ 03640000
*            /*                                                      */ 03641000
*            /********************************************************/ 03642000
*                                                                  1014 03643000
*            TOTLEN = 0;                                           1014 03644000
         SLR   @04,@04                                             1014 03645000
         ST    @04,TOTLEN                                          1014 03646000
*            PCOREFLG = OFF;                                       1015 03647000
*                                                                  1015 03648000
         NI    PCOREFLG,B'01111111'                                1015 03649000
*            /********************************************************/ 03650000
*            /*                                                      */ 03651000
*            /*  DEFINE EACH PATH FROM THE PORTABILITY DATA          */ 03652000
*            /*  SET.  SHOULD ANY DEFINE FAIL, GO ON TO THE          */ 03653000
*            /*  NEXT PATH.                                          */ 03654000
*            /*                                                      */ 03655000
*            /********************************************************/ 03656000
*                                                                  1016 03657000
*PATHLOOP:   DO I = NUMCOMP+1 TO NUMOBJ WHILE GETREO = OFF;        1016 03658000
*                                                                  1016 03659000
PATHLOOP LA    @04,1                                               1016 03660000
         AH    @04,NUMCOMP                                         1016 03661000
         B     @DE01016                                            1016 03662000
@DL01016 TM    GETREO,B'10000000'                                  1016 03663000
         BNZ   @DC01016                                            1016 03664000
*              /******************************************************/ 03665000
*              /*                                                    */ 03666000
*              /*  RESET THE FLAG THAT INDICATES THE CATALOG         */ 03667000
*              /*  DEFINE OPERATION IS TO BE SKIPPED                 */ 03668000
*              /*                                                    */ 03669000
*              /******************************************************/ 03670000
*                                                                  1017 03671000
*              IMPF2NOD = OFF;                                     1017 03672000
*                                                                  1017 03673000
         NI    IMPF2NOD,B'11101111'                                1017 03674000
*              /******************************************************/ 03675000
*              /*                                                    */ 03676000
*              /*  RESTORE THE CPL AND READ IN THE CONTROL           */ 03677000
*              /*  RECORD FOR THE PATH TO BE DEFINED.                */ 03678000
*              /*                                                    */ 03679000
*              /******************************************************/ 03680000
*                                                                  1018 03681000
*              CTGPL = PSAVCPL;                                    1018 03682000
*                                                                  1018 03683000
         L     @04,CTGPLPTR                                        1018 03684000
         MVC   CTGPL(28,@04),PSAVCPL                               1018 03685000
*              CALL IDCIOGT0(GDTTBL,PINIOCS);                      1019 03686000
*                                                                  1019 03687000
         L     @04,@PC00001                                        1019 03688000
         ST    @04,@AL00001                                        1019 03689000
         LA    @15,PINIOCS                                         1019 03690000
         ST    @15,@AL00001+4                                      1019 03691000
         MVI   @AL00001+4,X'80'                                    1019 03692000
         L     @15,GDTGET(,@04)                                    1019 03693000
         LA    @01,@AL00001                                        1019 03694000
         BALR  @14,@15                                             1019 03695000
*              RESPECIFY RTNREG RSTD;                              1020 03696000
*              TESTRC = RTNREG;                                    1021 03697000
         STH   RTNREG,TESTRC                                       1021 03698000
*              RESPECIFY RTNREG UNRSTD;                            1022 03699000
*                                                                  1022 03700000
*              IF TESTRC ^= 0                                      1023 03701000
*                THEN                                              1023 03702000
         LH    @04,TESTRC                                          1023 03703000
         LTR   @04,@04                                             1023 03704000
         BZ    @RF01023                                            1023 03705000
*                  RETURN CODE(LASTCC12);                          1024 03706000
*                                                                  1024 03707000
         LA    @15,12                                              1024 03708000
         L     @14,@SA00002                                        1024 03709000
         LM    @00,@12,@SA00002+8                                  1024 03710000
         BR    @14                                                 1024 03711000
*              /******************************************************/ 03712000
*              /*                                                    */ 03713000
*              /*  MOVE THE CONTROL RECORD                           */ 03714000
*              /*                                                    */ 03715000
*              /******************************************************/ 03716000
*                                                                  1025 03717000
*              TFVTLEN = IOCDAD -> HEADLN;                         1025 03718000
*                                                                  1025 03719000
@RF01023 L     @04,IOCSPTR                                         1025 03720000
         L     @01,IOCDAD(,@04)                                    1025 03721000
         LH    @15,HEADLN(,@01)                                    1025 03722000
         STH   @15,TFVTLEN                                         1025 03723000
*              CALL MVDAPROC(TFVTLEN,IOCDAD,CONRCPTR);             1026 03724000
*                                                                  1026 03725000
         LA    @15,TFVTLEN                                         1026 03726000
         ST    @15,@AL00001                                        1026 03727000
         ST    @04,@AL00001+4                                      1026 03728000
         LA    @04,CONRCPTR                                        1026 03729000
         ST    @04,@AL00001+8                                      1026 03730000
         LA    @01,@AL00001                                        1026 03731000
         BAL   @14,MVDAPROC                                        1026 03732000
*              /******************************************************/ 03733000
*              /*                                                    */ 03734000
*              /*  TEST THE HEADER FLAG TO MAKE SURE THAT            */ 03735000
*              /*  WE HAVE A CATALOG RECORD.                         */ 03736000
*              /*                                                    */ 03737000
*              /******************************************************/ 03738000
*                                                                  1027 03739000
*              IF HEADFLG1 = HDFL1CAT                              1027 03740000
*                THEN                                              1027 03741000
         L     @04,CONRCPTR                                        1027 03742000
         CLI   HEADFLG1(@04),X'FF'                                 1027 03743000
         BNE   @RF01027                                            1027 03744000
*CATHDFLG:         DO;                                             1028 03745000
*                                                                  1028 03746000
CATHDFLG DS    0H                                                  1029 03747000
*                  /**************************************************/ 03748000
*                  /*                                                */ 03749000
*                  /*  GET STORAGE FOR THE CATALOG WORK AREA         */ 03750000
*                  /*  IF THE CURRENT WORK AREA IS TOO SMALL         */ 03751000
*                  /*                                                */ 03752000
*                  /**************************************************/ 03753000
*                                                                  1029 03754000
*                  IF ASSRECLN > TOTLEN                            1029 03755000
*                    THEN                                          1029 03756000
         L     @04,CONRCPTR                                        1029 03757000
         LH    @04,ASSRECLN(,@04)                                  1029 03758000
         C     @04,TOTLEN                                          1029 03759000
         BNH   @RF01029                                            1029 03760000
*                      DO;                                         1030 03761000
*                                                                  1030 03762000
*                      /**********************************************/ 03763000
*                      /*                                            */ 03764000
*                      /*  IF CORE HAS BEEN GOTTEN FOR THE           */ 03765000
*                      /*  WORK AREA PREVIOUSLY, FREE IT.            */ 03766000
*                      /*                                            */ 03767000
*                      /**********************************************/ 03768000
*                                                                  1031 03769000
*                      IF PCOREFLG = ON                            1031 03770000
*                        THEN                                      1031 03771000
         TM    PCOREFLG,B'10000000'                                1031 03772000
         BNO   @RF01031                                            1031 03773000
*                          CALL IDCSAFS0(GDTTBL,PWORKAR);          1032 03774000
*                                                                  1032 03775000
         L     @04,@PC00001                                        1032 03776000
         ST    @04,@AL00001                                        1032 03777000
         LA    @15,PWORKAR                                         1032 03778000
         ST    @15,@AL00001+4                                      1032 03779000
         L     @15,GDTFSP(,@04)                                    1032 03780000
         LA    @01,@AL00001                                        1032 03781000
         BALR  @14,@15                                             1032 03782000
*                      PCOREFLG = ON;                              1033 03783000
@RF01031 OI    PCOREFLG,B'10000000'                                1033 03784000
*                      TOTLEN = ASSRECLN;                          1034 03785000
*                                                                  1034 03786000
         L     @04,CONRCPTR                                        1034 03787000
         LH    @04,ASSRECLN(,@04)                                  1034 03788000
         ST    @04,TOTLEN                                          1034 03789000
*                      CALL IDCSAGP0(GDTTBL,TOTLEN,PWORKAR,GPID,   1035 03790000
*                       SETZERO);                                  1035 03791000
*                                                                  1035 03792000
         L     @04,@PC00001                                        1035 03793000
         ST    @04,@AL00001                                        1035 03794000
         LA    @15,TOTLEN                                          1035 03795000
         ST    @15,@AL00001+4                                      1035 03796000
         LA    @15,PWORKAR                                         1035 03797000
         ST    @15,@AL00001+8                                      1035 03798000
         LA    @15,GPID                                            1035 03799000
         ST    @15,@AL00001+12                                     1035 03800000
         LA    @15,SETZERO                                         1035 03801000
         ST    @15,@AL00001+16                                     1035 03802000
         MVI   @AL00001+16,X'80'                                   1035 03803000
         L     @15,GDTGPL(,@04)                                    1035 03804000
         LA    @01,@AL00001                                        1035 03805000
         BALR  @14,@15                                             1035 03806000
*                      RESPECIFY RTNREG RSTD;                      1036 03807000
*                      TESTRC = RTNREG;                            1037 03808000
         STH   RTNREG,TESTRC                                       1037 03809000
*                      RESPECIFY RTNREG UNRSTD;                    1038 03810000
*                                                                  1038 03811000
*                      IF TESTRC ^= 0                              1039 03812000
*                        THEN                                      1039 03813000
         LH    @04,TESTRC                                          1039 03814000
         LTR   @04,@04                                             1039 03815000
         BZ    @RF01039                                            1039 03816000
*                          DO;                                     1040 03817000
*                          DARGSMOD = UNIVMSG;                     1041 03818000
         L     @04,DDSTRU                                          1041 03819000
         MVC   DARGSMOD(3,@04),@CC00981                            1041 03820000
*                          DEFSTID = NOSTORAG;                     1042 03821000
         MVI   DEFSTID,X'04'                                       1042 03822000
*                          RETURN CODE(LASTCC12);                  1043 03823000
         LA    @15,12                                              1043 03824000
         L     @14,@SA00002                                        1043 03825000
         LM    @00,@12,@SA00002+8                                  1043 03826000
         BR    @14                                                 1043 03827000
*                          END;                                    1044 03828000
*                                                                  1044 03829000
*                      END;                                        1045 03830000
*                                                                  1045 03831000
@RF01039 DS    0H                                                  1046 03832000
*                  /**************************************************/ 03833000
*                  /*                                                */ 03834000
*                  /*  READ IN THE CATALOG WORK AREA AND             */ 03835000
*                  /*  CALL FVTPROC TO BUILD THE FVT AND             */ 03836000
*                  /*  FPL'S NEEDED TO DO THE DEFINE.                */ 03837000
*                  /*                                                */ 03838000
*                  /**************************************************/ 03839000
*                                                                  1046 03840000
*                  CALL GETPROC(PWORKAR,ASSRECLN);                 1046 03841000
*                                                                  1046 03842000
@RF01029 LA    @04,PWORKAR                                         1046 03843000
         ST    @04,@AL00001                                        1046 03844000
         L     @04,CONRCPTR                                        1046 03845000
         LA    @04,ASSRECLN(,@04)                                  1046 03846000
         ST    @04,@AL00001+4                                      1046 03847000
         LA    @01,@AL00001                                        1046 03848000
         BAL   @14,GETPROC                                         1046 03849000
*                  RESPECIFY RTNREG RSTD;                          1047 03850000
*                  TESTRC = RTNREG;                                1048 03851000
         STH   RTNREG,TESTRC                                       1048 03852000
*                  RESPECIFY RTNREG UNRSTD;                        1049 03853000
*                                                                  1049 03854000
*                  IF TESTRC ^= 0                                  1050 03855000
*                    THEN                                          1050 03856000
         LH    @04,TESTRC                                          1050 03857000
         LTR   @04,@04                                             1050 03858000
         BZ    @RF01050                                            1050 03859000
*                      RETURN CODE(LASTCC12);                      1051 03860000
*                                                                  1051 03861000
         LA    @15,12                                              1051 03862000
         L     @14,@SA00002                                        1051 03863000
         LM    @00,@12,@SA00002+8                                  1051 03864000
         BR    @14                                                 1051 03865000
*                  DICTPTR = ADDR(VARDATA);                        1052 03866000
*                                                                  1052 03867000
@RF01050 L     @04,CONRCPTR                                        1052 03868000
         LA    @04,VARDATA(,@04)                                   1052 03869000
         ST    @04,DICTPTR                                         1052 03870000
*                  CALL FVTPROC(DICTPTR,PWORKAR,PFVTPTR);          1053 03871000
*                                                                  1053 03872000
         LA    @04,DICTPTR                                         1053 03873000
         ST    @04,@AL00001                                        1053 03874000
         LA    @04,PWORKAR                                         1053 03875000
         ST    @04,@AL00001+4                                      1053 03876000
         LA    @04,PFVTPTR                                         1053 03877000
         ST    @04,@AL00001+8                                      1053 03878000
         LA    @01,@AL00001                                        1053 03879000
         BAL   @14,FVTPROC                                         1053 03880000
*                  RESPECIFY RTNREG RSTD;                          1054 03881000
*                  TESTRC = RTNREG;                                1055 03882000
         STH   RTNREG,TESTRC                                       1055 03883000
*                  RESPECIFY RTNREG UNRSTD;                        1056 03884000
*                                                                  1056 03885000
*                  IF TESTRC ^= 0                                  1057 03886000
*                    THEN                                          1057 03887000
         LH    @04,TESTRC                                          1057 03888000
         LTR   @04,@04                                             1057 03889000
         BZ    @RF01057                                            1057 03890000
*                      RETURN CODE(LASTCC12);                      1058 03891000
*                                                                  1058 03892000
         LA    @15,12                                              1058 03893000
         L     @14,@SA00002                                        1058 03894000
         LM    @00,@12,@SA00002+8                                  1058 03895000
         BR    @14                                                 1058 03896000
*                  /**************************************************/ 03897000
*                  /*                                                */ 03898000
*                  /*  SET THE POINTER TO FVT IN THE CPL             */ 03899000
*                  /*                                                */ 03900000
*                  /**************************************************/ 03901000
*                                                                  1059 03902000
*                  CTGFVT = PFVTPTR;                               1059 03903000
@RF01057 L     @04,PFVTPTR                                         1059 03904000
         L     @01,CTGPLPTR                                        1059 03905000
         ST    @04,CTGFVT(,@01)                                    1059 03906000
*                  CTGFVPTR = PFVTPTR;                             1060 03907000
*                                                                  1060 03908000
         ST    @04,CTGFVPTR                                        1060 03909000
*                  /**************************************************/ 03910000
*                  /*                                                */ 03911000
*                  /*  SCAN THE OBJECTS LIST FOR A MATCH TO          */ 03912000
*                  /*  THE PATH BEING DEFINED.                       */ 03913000
*                  /*                                                */ 03914000
*                  /**************************************************/ 03915000
*                                                                  1061 03916000
*POBJLOOP:         DO IX = 1 TO OBJTSCNT;                          1061 03917000
*                                                                  1061 03918000
POBJLOOP LA    @04,1                                               1061 03919000
         B     @DE01061                                            1061 03920000
@DL01061 DS    0H                                                  1062 03921000
*                    IF OBJNMPTR(IX) -> OBJNMVAL(1:44) =           1062 03922000
*                       FENTNAME(1:44)                             1062 03923000
*                      THEN                                        1062 03924000
*                                                                  1062 03925000
         SLA   @04,2                                               1062 03926000
         L     @15,@PC00001+4                                      1062 03927000
         L     @01,FDTPTR+12(,@15)                                 1062 03928000
         AL    @01,@CF01779                                        1062 03929000
         L     @01,OBJNMPTR(@04,@01)                               1062 03930000
         L     @14,CTGFVPTR                                        1062 03931000
         L     @03,CTGFVENT(,@14)                                  1062 03932000
         CLC   OBJNMVAL(44,@01),FENTNAME(@03)                      1062 03933000
         BNE   @RF01062                                            1062 03934000
*                        /********************************************/ 03935000
*                        /*                                          */ 03936000
*                        /*  TEST FOR THE PRESENCE OF                */ 03937000
*                        /*  THE FILE PARAMETER.  IF                 */ 03938000
*                        /*  SPECIFIED, SET A POINTER                */ 03939000
*                        /*  TO IT IN THE FVT.                       */ 03940000
*                        /*                                          */ 03941000
*                        /********************************************/ 03942000
*                                                                  1063 03943000
*                        IF OBJFLPTR(IX) ^= NULLPTR                1063 03944000
*                          THEN                                    1063 03945000
         L     @01,FDTPTR+20(,@15)                                 1063 03946000
         AL    @01,@CF01779                                        1063 03947000
         L     @04,OBJFLPTR(@04,@01)                               1063 03948000
         LTR   @04,@04                                             1063 03949000
         BZ    @RF01063                                            1063 03950000
*                            CTGFVIND = ADDR(OBJFLPTR(IX)->OBJFLVAL);   03951000
*                                                                  1064 03952000
         LA    @04,OBJFLVAL(,@04)                                  1064 03953000
         ST    @04,CTGFVIND(,@14)                                  1064 03954000
*                  END POBJLOOP;                                   1065 03955000
*                                                                  1065 03956000
@RF01063 DS    0H                                                  1065 03957000
@RF01062 LA    @04,1                                               1065 03958000
         AL    @04,IX                                              1065 03959000
@DE01061 ST    @04,IX                                              1065 03960000
         L     @15,@PC00001+4                                      1065 03961000
         LA    @15,FDTPTR+8(,@15)                                  1065 03962000
         C     @04,OBJTSCNT(,@15)                                  1065 03963000
         BNH   @DL01061                                            1065 03964000
*                  /**************************************************/ 03965000
*                  /*                                                */ 03966000
*                  /*  IF THE USER SPECIFIED OUTFILE AND             */ 03967000
*                  /*  DID NOT EXPLICITLY GIVE A FILE                */ 03968000
*                  /*  PARAMETER FOR THE PATH, SET                   */ 03969000
*                  /*  CTGFVIND TO POINT THE OUTFILE DD              */ 03970000
*                  /*  STATEMENT.                                    */ 03971000
*                  /*                                                */ 03972000
*                  /**************************************************/ 03973000
*                                                                  1066 03974000
*                  IF CTGFVIND = NULLPTR &                         1066 03975000
*                     ADDR(OUTDD) ^= NULLPTR                       1066 03976000
*                    THEN                                          1066 03977000
         SLR   @04,@04                                             1066 03978000
         L     @15,CTGFVPTR                                        1066 03979000
         C     @04,CTGFVIND(,@15)                                  1066 03980000
         BNE   @RF01066                                            1066 03981000
         L     @14,@PC00001+4                                      1066 03982000
         L     @14,FDTPTR+4(,@14)                                  1066 03983000
         CR    @14,@04                                             1066 03984000
         BE    @RF01066                                            1066 03985000
*                      CTGFVIND = ADDR(OUTDDVAL);                  1067 03986000
*                                                                  1067 03987000
         LA    @04,OUTDDVAL(,@14)                                  1067 03988000
         ST    @04,CTGFVIND(,@15)                                  1067 03989000
*                  /**************************************************/ 03990000
*                  /*                                                */ 03991000
*                  /*  SET THE CTGFVWKA FIELD OF THE FVT             */ 03992000
*                  /*  TO POINT THE WORK AREA FOR THE                */ 03993000
*                  /*  RECOVERY VOLUME SERIAL NUMBER.                */ 03994000
*                  /*                                                */ 03995000
*                  /**************************************************/ 03996000
*                                                                  1068 03997000
*                  PFVTPTR -> CTGFVWKA = ADDR(CATRCVWK);           1068 03998000
*                                                                  1068 03999000
@RF01066 LA    @04,CATRCVWK                                        1068 04000000
         L     @01,PFVTPTR                                         1068 04001000
         ST    @04,CTGFVWKA(,@01)                                  1068 04002000
*                  /**************************************************/ 04003000
*                  /*                                                */ 04004000
*                  /*  TEST TO DETERMINE IF IMPF2NOD IS SET          */ 04005000
*                  /*  IF IT IS, THEN SKIP THE DEFINE OF             */ 04006000
*                  /*  THE PRESENT PATH, AND PROCEED TO THE          */ 04007000
*                  /*  NEXT.  OTHERWISE, DO A CMS DEFINE.            */ 04008000
*                  /*                                                */ 04009000
*                  /**************************************************/ 04010000
*                                                                  1069 04011000
*                  IF IMPF2NOD ^= ON                               1069 04012000
*                    THEN                                          1069 04013000
         TM    IMPF2NOD,B'00010000'                                1069 04014000
         BO    @RF01069                                            1069 04015000
*                      DO;                                         1070 04016000
*                                                                  1070 04017000
*                      /**********************************************/ 04018000
*                      /*                                            */ 04019000
*                      /*  CALL CATALOG MANAGEMENT TO DO             */ 04020000
*                      /*  A CMS DEFINE                              */ 04021000
*                      /*                                            */ 04022000
*                      /**********************************************/ 04023000
*                                                                  1071 04024000
*                      CALL CTLGPROC(PPTRCPL);                     1071 04025000
*                                                                  1071 04026000
         LA    @04,PPTRCPL                                         1071 04027000
         ST    @04,@AL00001                                        1071 04028000
         LA    @01,@AL00001                                        1071 04029000
         BAL   @14,CTLGPROC                                        1071 04030000
*                      RESPECIFY RTNREG RSTD;                      1072 04031000
*                      TESTRC = RTNREG;                            1073 04032000
         STH   RTNREG,TESTRC                                       1073 04033000
*                      RESPECIFY RTNREG UNRSTD;                    1074 04034000
*                                                                  1074 04035000
*                      IF TESTRC ^= 0                              1075 04036000
*                        THEN                                      1075 04037000
         LH    @04,TESTRC                                          1075 04038000
         LTR   @04,@04                                             1075 04039000
         BZ    @RF01075                                            1075 04040000
*                          DO;                                     1076 04041000
*                                                                  1076 04042000
*                          /******************************************/ 04043000
*                          /*                                        */ 04044000
*                          /*  THE DEFINE OF THE PATH HAS            */ 04045000
*                          /*  FAILED.  PRINT AN ERROR               */ 04046000
*                          /*  MESSAGE, BUT CONTINUE                 */ 04047000
*                          /*  PROCESSING WITH THE NEXT              */ 04048000
*                          /*  PATH.                                 */ 04049000
*                          /*                                        */ 04050000
*                          /******************************************/ 04051000
*                                                                  1077 04052000
*                          DARGSMOD = IMPMSG;                      1077 04053000
         L     @04,DDSTRU                                          1077 04054000
         MVC   DARGSMOD(3,@04),@CC00945                            1077 04055000
*                          DARGSENT = BADPTMP;                     1078 04056000
         MVI   DARGSENT(@04),X'10'                                 1078 04057000
*                          DARGILP = LENGTH(FENTNAME);             1079 04058000
         MVC   DARGILP(2,@04),@CH00605                             1079 04059000
*                          DARGDBP = ADDR(FENTNAME);               1080 04060000
*                                                                  1080 04061000
         L     @01,CTGFVPTR                                        1080 04062000
         L     @15,CTGFVENT(,@01)                                  1080 04063000
         ST    @15,DARGDBP(,@04)                                   1080 04064000
*                          CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);   1081 04065000
*                                                                  1081 04066000
         L     @04,@PC00001                                        1081 04067000
         ST    @04,@AL00001                                        1081 04068000
         LA    @15,@CF00119                                        1081 04069000
         ST    @15,@AL00001+4                                      1081 04070000
         LA    @15,DDSTRU                                          1081 04071000
         ST    @15,@AL00001+8                                      1081 04072000
         MVI   @AL00001+8,X'80'                                    1081 04073000
         L     @15,GDTPRT(,@04)                                    1081 04074000
         LA    @01,@AL00001                                        1081 04075000
         BALR  @14,@15                                             1081 04076000
*                          SETRC = LASTCC08;                       1082 04077000
         MVC   SETRC(2),@CH00039                                   1082 04078000
*                          DEFSTID = 0;                            1083 04079000
         MVI   DEFSTID,X'00'                                       1083 04080000
*                          END;                                    1084 04081000
*                                                                  1084 04082000
*                  END;                                            1085 04083000
*                                                                  1085 04084000
@RF01075 DS    0H                                                  1086 04085000
*                  /**************************************************/ 04086000
*                  /*                                                */ 04087000
*                  /*  FREE CORE GOTTEN BY FVTPROC FOR THE           */ 04088000
*                  /*  FVT AND FPL'S USED TO DEFINE THE              */ 04089000
*                  /*  PATH.                                         */ 04090000
*                  /*                                                */ 04091000
*                  /**************************************************/ 04092000
*                                                                  1086 04093000
*                  CALL IDCSAFS0(GDTTBL,PFVTPTR);                  1086 04094000
*                                                                  1086 04095000
@RF01069 L     @04,@PC00001                                        1086 04096000
         ST    @04,@AL00001                                        1086 04097000
         LA    @15,PFVTPTR                                         1086 04098000
         ST    @15,@AL00001+4                                      1086 04099000
         L     @15,GDTFSP(,@04)                                    1086 04100000
         LA    @01,@AL00001                                        1086 04101000
         BALR  @14,@15                                             1086 04102000
*                  END CATHDFLG;                                   1087 04103000
*                                                                  1087 04104000
*              ELSE                                                1088 04105000
*                                                                  1088 04106000
*                /****************************************************/ 04107000
*                /*                                                  */ 04108000
*                /*  TEST FOR THE SPECIAL RECORD THAT FOLLOWS THE    */ 04109000
*                /*  CATALOG INFORMATION FOR A VSAM DATA SET.        */ 04110000
*                /*  IF PRESENT, INDICATE THAT PATHLOOP IS TO END    */ 04111000
*                /*  BY TURNING ON GETREO.                           */ 04112000
*                /*                                                  */ 04113000
*                /****************************************************/ 04114000
*                                                                  1088 04115000
*                IF HEADFLG1 = HDFL1REO                            1088 04116000
*                  THEN                                            1088 04117000
         B     @RC01027                                            1088 04118000
@RF01027 L     @04,CONRCPTR                                        1088 04119000
         CLI   HEADFLG1(@04),X'01'                                 1088 04120000
         BNE   @RF01088                                            1088 04121000
*                    GETREO = ON;                                  1089 04122000
         OI    GETREO,B'10000000'                                  1089 04123000
*                  ELSE                                            1090 04124000
*                    DO;                                           1090 04125000
         B     @RC01088                                            1090 04126000
@RF01088 DS    0H                                                  1091 04127000
*                    DEFSTID = PORTERR;                            1091 04128000
         MVI   DEFSTID,X'01'                                       1091 04129000
*                    RETURN CODE(LASTCC12);                        1092 04130000
         LA    @15,12                                              1092 04131000
         L     @14,@SA00002                                        1092 04132000
         LM    @00,@12,@SA00002+8                                  1092 04133000
         BR    @14                                                 1092 04134000
*                    END;                                          1093 04135000
*                                                                  1093 04136000
*            END PATHLOOP;                                         1094 04137000
*                                                                  1094 04138000
@RC01088 DS    0H                                                  1094 04139000
@RC01027 LA    @04,1                                               1094 04140000
         AL    @04,I                                               1094 04141000
@DE01016 ST    @04,I                                               1094 04142000
         CH    @04,NUMOBJ                                          1094 04143000
         BNH   @DL01016                                            1094 04144000
@DC01016 DS    0H                                                  1095 04145000
*            /********************************************************/ 04146000
*            /*                                                      */ 04147000
*            /*  FREE UP ANY CORE USED BY THE WORKAREA               */ 04148000
*            /*  EMPLOYED TO DO THE PATH DEFINES.                    */ 04149000
*            /*                                                      */ 04150000
*            /********************************************************/ 04151000
*                                                                  1095 04152000
*            IF PCOREFLG = ON                                      1095 04153000
*              THEN                                                1095 04154000
         TM    PCOREFLG,B'10000000'                                1095 04155000
         BNO   @RF01095                                            1095 04156000
*                CALL IDCSAFS0(GDTTBL,PWORKAR);                    1096 04157000
*                                                                  1096 04158000
         L     @04,@PC00001                                        1096 04159000
         ST    @04,@AL00001                                        1096 04160000
         LA    @15,PWORKAR                                         1096 04161000
         ST    @15,@AL00001+4                                      1096 04162000
         L     @15,GDTFSP(,@04)                                    1096 04163000
         LA    @01,@AL00001                                        1096 04164000
         BALR  @14,@15                                             1096 04165000
*            END PATHDEF;                                          1097 04166000
@RF01095 DS    0H                                                  1098 04167000
*        /************************************************************/ 04168000
*        /*                                                          */ 04169000
*        /*  GET THE RECORD FROM THE PORTABLE DATA SET WHICH         */ 04170000
*        /*  DESCRIBES THE FORMAT OF THE DATA TO BE WRITTEN INTO     */ 04171000
*        /*  THE CLUSTER PROVIDED THAT THE RECORD HAS NOT BEEN READ  */ 04172000
*        /*  IF THE GET FAILS, RETURN TO THE CALLING PROCESSOR.      */ 04173000
*        /*                                                          */ 04174000
*        /************************************************************/ 04175000
*                                                                  1098 04176000
*        IF GETREO = OFF                                           1098 04177000
*          THEN                                                    1098 04178000
@RF01002 TM    GETREO,B'10000000'                                  1098 04179000
         BNZ   @RF01098                                            1098 04180000
*            DO;                                                   1099 04181000
*            CALL IDCIOGT0(GDTTBL,PINIOCS);                        1100 04182000
*                                                                  1100 04183000
         L     @04,@PC00001                                        1100 04184000
         ST    @04,@AL00001                                        1100 04185000
         LA    @15,PINIOCS                                         1100 04186000
         ST    @15,@AL00001+4                                      1100 04187000
         MVI   @AL00001+4,X'80'                                    1100 04188000
         L     @15,GDTGET(,@04)                                    1100 04189000
         LA    @01,@AL00001                                        1100 04190000
         BALR  @14,@15                                             1100 04191000
*            RESPECIFY RTNREG RSTD;                                1101 04192000
*            TESTRC = RTNREG;                                      1102 04193000
         STH   RTNREG,TESTRC                                       1102 04194000
*            RESPECIFY RTNREG UNRSTD;                              1103 04195000
*            IF TESTRC ^= 0                                        1104 04196000
*              THEN                                                1104 04197000
         LH    @04,TESTRC                                          1104 04198000
         LTR   @04,@04                                             1104 04199000
         BZ    @RF01104                                            1104 04200000
*                RETURN CODE(LASTCC12);                            1105 04201000
*                                                                  1105 04202000
         LA    @15,12                                              1105 04203000
         L     @14,@SA00002                                        1105 04204000
         LM    @00,@12,@SA00002+8                                  1105 04205000
         BR    @14                                                 1105 04206000
*            CONRCPTR = IOCDAD;                                    1106 04207000
*                                                                  1106 04208000
@RF01104 L     @04,IOCSPTR                                         1106 04209000
         L     @04,IOCDAD(,@04)                                    1106 04210000
         ST    @04,CONRCPTR                                        1106 04211000
*            IF  HEADFLG1 ^= HDFL1REO                              1107 04212000
*              THEN                                                1107 04213000
         CLI   HEADFLG1(@04),X'01'                                 1107 04214000
         BE    @RF01107                                            1107 04215000
*                DO;                                               1108 04216000
*                                                                  1108 04217000
*                /****************************************************/ 04218000
*                /*                                                  */ 04219000
*                /*  IF THE CONTROL RECORD IS NOT FOR A DATA RECORD, */ 04220000
*                /*  THEN THE PORTABILITY VOLUME IS IN ERROR         */ 04221000
*                /*  RETURN TO THE CALLING PROCESSOR.                */ 04222000
*                /*                                                  */ 04223000
*                /****************************************************/ 04224000
*                                                                  1109 04225000
*                DEFSTID = PORTERR;                                1109 04226000
         MVI   DEFSTID,X'01'                                       1109 04227000
*                RETURN CODE(LASTCC12);                            1110 04228000
         LA    @15,12                                              1110 04229000
         L     @14,@SA00002                                        1110 04230000
         LM    @00,@12,@SA00002+8                                  1110 04231000
         BR    @14                                                 1110 04232000
*                END;                                              1111 04233000
*            END;                                                  1112 04234000
*                                                                  1112 04235000
@RF01107 DS    0H                                                  1113 04236000
*        /************************************************************/ 04237000
*        /*                                                          */ 04238000
*        /*  CALL RECPROC TO OPEN THE VSAM CLUSTER JUST DEFINED, AND */ 04239000
*        /*  COPY THE DATA INTO IT RECORD BY RECORD FROM THE         */ 04240000
*        /*  PORTABILITY DATA SET.                                   */ 04241000
*        /*  IF ANY ERRORS ARE ENCOUNTERED, RETURN TO THE CALLING    */ 04242000
*        /*  PROCESSOR,AFTER SETTING THE DELETE CLUSTER FLAG.        */ 04243000
*        /*                                                          */ 04244000
*        /************************************************************/ 04245000
*                                                                  1113 04246000
*        CALL RECPROC;                                             1113 04247000
*                                                                  1113 04248000
@RF01098 BAL   @14,RECPROC                                         1113 04249000
*        RESPECIFY RTNREG RSTD;                                    1114 04250000
*        TESTRC = RTNREG;                                          1115 04251000
         STH   RTNREG,TESTRC                                       1115 04252000
*        RESPECIFY RTNREG UNRSTD;                                  1116 04253000
*        IF TESTRC ^= 0                                            1117 04254000
*          THEN                                                    1117 04255000
         LH    @04,TESTRC                                          1117 04256000
         LTR   @04,@04                                             1117 04257000
         BZ    @RF01117                                            1117 04258000
*            RETURN CODE(TESTRC);                          /*@OZ17068*/ 04259000
*                                                                  1118 04260000
         LR    @15,@04                                             1118 04261000
         L     @14,@SA00002                                        1118 04262000
         LM    @00,@12,@SA00002+8                                  1118 04263000
         BR    @14                                                 1118 04264000
*        OLDERID2 = NEWERID2;                                      1119 04265000
@RF01117 L     @04,@PC00001                                        1119 04266000
         L     @15,GDTTR2(,@04)                                    1119 04267000
         MVC   @TS00001(95),NEWERID2(@15)                          1119 04268000
         MVC   OLDERID2(95,@15),@TS00001                           1119 04269000
*        NEWID2 = 'RMCE';                                          1120 04270000
*                                                                  1120 04271000
         MVC   NEWID2(4,@15),@CC01370                              1120 04272000
*        /************************************************************/ 04273000
*        /*                                                          */ 04274000
*        /*  PRINT A MESSAGE TO INDICATE WHAT HAS BEEN IMPORTED      */ 04275000
*        /*  SUCCESSFULLY.                                           */ 04276000
*        /*                                                          */ 04277000
*        /************************************************************/ 04278000
*                                                                  1121 04279000
*        DARGSMOD = IMPMSG;                                        1121 04280000
         L     @15,DDSTRU                                          1121 04281000
         MVC   DARGSMOD(3,@15),@CC00945                            1121 04282000
*        DARGSENT = MPRASUCC;                                      1122 04283000
         MVI   DARGSENT(@15),X'1A'                                 1122 04284000
*        DARGILP = LENGTH(FENTNAME);                               1123 04285000
         MVC   DARGILP(2,@15),@CH00605                             1123 04286000
*        DARGDBP = FVTPTR(1) -> CTGFVENT;                          1124 04287000
         L     @01,FVTPTR                                          1124 04288000
         L     @14,CTGFVENT(,@01)                                  1124 04289000
         ST    @14,DARGDBP(,@15)                                   1124 04290000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                     1125 04291000
         ST    @04,@AL00001                                        1125 04292000
         LA    @15,@CF00119                                        1125 04293000
         ST    @15,@AL00001+4                                      1125 04294000
         LA    @15,DDSTRU                                          1125 04295000
         ST    @15,@AL00001+8                                      1125 04296000
         MVI   @AL00001+8,X'80'                                    1125 04297000
         L     @15,GDTPRT(,@04)                                    1125 04298000
         LA    @01,@AL00001                                        1125 04299000
         BALR  @14,@15                                             1125 04300000
*        DARGLIST = ''B;                                           1126 04301000
         L     @04,DDSTRU                                          1126 04302000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1126 04303000
*        DARGSMOD = IMPMSG;                                        1127 04304000
*                                                                  1127 04305000
         MVC   DARGSMOD(3,@04),@CC00945                            1127 04306000
*        /************************************************************/ 04307000
*        /*                                                          */ 04308000
*        /*  RETURN TO MAIN PROCEDURE, INDICATING THAT ENTIRE        */ 04309000
*        /*  FUNCTION COMPLETED SUCCESSFULLY                         */ 04310000
*        /*                                                          */ 04311000
*        /************************************************************/ 04312000
*                                                                  1128 04313000
*        RETURN CODE(0);                                           1128 04314000
         SLR   @15,@15                                             1128 04315000
         L     @14,@SA00002                                        1128 04316000
         LM    @00,@12,@SA00002+8                                  1128 04317000
         BR    @14                                                 1128 04318000
*END CLUSPROC;                                                     1129 04319000
*        /************************************************************/ 04320000
*        /*                                                          */ 04321000
*        /*  PROCEDURE NAME - CPLPROC                                */ 04322000
*        /*                                                          */ 04323000
*        /*  FUNCTION - CONSTRUCT A CATALOG PARAMETER LIST (CPL)     */ 04324000
*        /*  WHICH IS THE PRIMARY CONTROL BLOCK FOR ORGANIZING A     */ 04325000
*        /*  REQUEST FOR CATALOG MANAGEMENT SERVICES                 */ 04326000
*        /*  THE CPL CONSTRUCTED IN THIS PROCEDURE WILL BE USED FOR  */ 04327000
*        /*  A CATALOG DEFINE, ALTER, DELETE OR LOCATE OPERATION.    */ 04328000
*        /*                                                          */ 04329000
*        /*  INPUT -                                                 */ 04330000
*        /*    CTYPE - TYPE INDICATOR (DELETE,ALTER,LOCATE,DEFINE    */ 04331000
*        /*    CPTRCPL - RETURN CELL FOR CPL CONSTRUCTED             */ 04332000
*        /*    CNAME - NAME OF CLUSTER FOR DELETE OR LOCATE          */ 04333000
*        /*    CINUM - CONTROL INTERVAL NUMBER FOR LOCATE OF         */ 04334000
*        /*            CLUSTER COMPONENT                             */ 04335000
*        /*    CCPSWD - OBJECT PASSWORD OR ZERO                      */ 04336000
*        /*                                                          */ 04337000
*        /*  OUTPUT - AN INITIALIZED CPL                             */ 04338000
*        /*                                                          */ 04339000
*        /************************************************************/ 04340000
*                                                                  1130 04341000
*CPLPROC: PROCEDURE(CTYPE,             /*TYPE OF CPL TO BE BUILT     */ 04342000
*                   CPTRCPL,           /*RETURN CELL FOR CPL POINTER */ 04343000
*                   CNAME,             /*ADDRESS OF ENTRYNAME OR 0   */ 04344000
*                   CINUM,             /*CONTROL INTERVAL NUMBER OR 0*/ 04345000
*                   CCPSWD);           /*ADDRESS OF 8-BYTE PASSWORD  */ 04346000
*                                                                  1130 04347000
CPLPROC  STM   @14,@12,@SA00003                                    1130 04348000
         MVC   @PC00003(20),0(@01)                                 1130 04349000
*        /************************************************************/ 04350000
*        /*                                                          */ 04351000
*        /*  ARGUMENTS OF INVOCATION                                 */ 04352000
*        /*                                                          */ 04353000
*        /************************************************************/ 04354000
*                                                                  1131 04355000
*        DCL                                                       1131 04356000
*          CTYPE    CHAR(1),                                       1131 04357000
*          CPTRCPL  PTR(31),                                       1131 04358000
*          CNAME    PTR(31),                                       1131 04359000
*          CINUM    CHAR(3),                                       1131 04360000
*          CCPSWD   PTR(31);                                       1131 04361000
*                                                                  1131 04362000
*        /************************************************************/ 04363000
*        /*                                                          */ 04364000
*        /* LOCAL DECLARATIONS                                       */ 04365000
*        /*                                                          */ 04366000
*        /************************************************************/ 04367000
*                                                                  1132 04368000
*        DCL LENWKA FIXED(15) CONSTANT(49);                        1132 04369000
*                                      /*LENGTH WORK AREA NEEDED FOR */ 04370000
*                                      /*ALTER, LOCATE, DEFINE       */ 04371000
*        DCL 1 DELTWKA BDY(WORD),                                  1133 04372000
*          2 *     FIXED(15),                                      1133 04373000
*          2 *     FIXED(15),                                      1133 04374000
*          2 *(12) CHAR(45);                                       1133 04375000
*                                      /*WORK AREA FOR DELETE        */ 04376000
*                                                                  1134 04377000
*        DCL CPLPROCI FIXED(31);       /*INDEX USED TO CLEAR         */ 04378000
*                                      /*CATALOG WORK AREA           */ 04379000
*                                                                  1135 04380000
*        OLDERID2 = NEWERID2;                                      1135 04381000
         L     @04,@PC00001                                        1135 04382000
         L     @15,GDTTR2(,@04)                                    1135 04383000
         MVC   @TS00001(95),NEWERID2(@15)                          1135 04384000
         MVC   OLDERID2(95,@15),@TS00001                           1135 04385000
*        NEWID2 = 'RMPL';                                          1136 04386000
*                                                                  1136 04387000
         MVC   NEWID2(4,@15),@CC01392                              1136 04388000
*        /************************************************************/ 04389000
*        /*                                                          */ 04390000
*        /*  GET CORE FOR CATALOG PARAMETER LIST(CPL)                */ 04391000
*        /*  IF CORE IS NOT OBTAINED SUCCESSFULLY, RETURN TO THE     */ 04392000
*        /*  CALLING PROCEDURE                                       */ 04393000
*        /*                                                          */ 04394000
*        /************************************************************/ 04395000
*                                                                  1137 04396000
*        CALL IDCSAGP0 (GDTTBL,(LENGTH(CTGPL)+16+LENWKA),CPTRCPL,GPID,S 04397000
*TZERO);                                                           1137 04398000
*                                                                  1137 04399000
         ST    @04,@AL00001                                        1137 04400000
         LA    @15,93                                              1137 04401000
         ST    @15,@AFTEMPS                                        1137 04402000
         LA    @15,@AFTEMPS                                        1137 04403000
         ST    @15,@AL00001+4                                      1137 04404000
         L     @15,@PC00003+4                                      1137 04405000
         ST    @15,@AL00001+8                                      1137 04406000
         LA    @15,GPID                                            1137 04407000
         ST    @15,@AL00001+12                                     1137 04408000
         LA    @15,SETZERO                                         1137 04409000
         ST    @15,@AL00001+16                                     1137 04410000
         MVI   @AL00001+16,X'80'                                   1137 04411000
         L     @15,GDTGPL(,@04)                                    1137 04412000
         LA    @01,@AL00001                                        1137 04413000
         BALR  @14,@15                                             1137 04414000
*        RESPECIFY RTNREG RSTD;                                    1138 04415000
*        TESTRC = RTNREG;                                          1139 04416000
         STH   RTNREG,TESTRC                                       1139 04417000
*        RESPECIFY RTNREG UNRSTD;                                  1140 04418000
*        IF TESTRC ^= 0                                            1141 04419000
*          THEN                                                    1141 04420000
         LH    @04,TESTRC                                          1141 04421000
         LTR   @04,@04                                             1141 04422000
         BZ    @RF01141                                            1141 04423000
*            DO;                                                   1142 04424000
*            DARGSMOD = UNIVMSG;                                   1143 04425000
         L     @04,DDSTRU                                          1143 04426000
         MVC   DARGSMOD(3,@04),@CC00981                            1143 04427000
*            DEFSTID = NOSTORAG;                                   1144 04428000
         MVI   DEFSTID,X'04'                                       1144 04429000
*            RETURN CODE(LASTCC12);                                1145 04430000
         LA    @15,12                                              1145 04431000
         L     @14,@SA00003                                        1145 04432000
         LM    @00,@12,@SA00003+8                                  1145 04433000
         BR    @14                                                 1145 04434000
*            END;                                                  1146 04435000
*                                                                  1146 04436000
*        /************************************************************/ 04437000
*        /*                                                          */ 04438000
*        /*  INITIALIZE CPL WITH INFORMATION COMMON TO ALL 4 CATALOG */ 04439000
*        /*  MANAGEMENT FUNCTIONS                                    */ 04440000
*        /*                                                          */ 04441000
*        /************************************************************/ 04442000
*                                                                  1147 04443000
*        CTGPLPTR = CPTRCPL;           /*SET CPL BASE POINTER        */ 04444000
@RF01141 L     @04,@PC00003+4                                      1147 04445000
         L     @04,CPTRCPL(,@04)                                   1147 04446000
         ST    @04,CTGPLPTR                                        1147 04447000
*        CTGWKA = CTGPLPTR + (LENGTH(CTGPL)+16);                   1148 04448000
         LA    @15,44                                              1148 04449000
         ALR   @15,@04                                             1148 04450000
         ST    @15,CTGWKA(,@04)                                    1148 04451000
*                                      /*SET WORK AREA ADDRESS       */ 04452000
*        AREALN = LENWKA;              /*SET WORK AREA LENGTH        */ 04453000
         MVC   AREALN(2,@15),@CH01385                              1149 04454000
*        CTGAM0 = ON;                  /*VSAM REQUEST                */ 04455000
         OI    CTGAM0(@04),B'00000001'                             1150 04456000
*        IF CTYPE ^= 'L'                                           1151 04457000
*          THEN                                                    1151 04458000
         L     @15,@PC00003                                        1151 04459000
         CLI   CTYPE(@15),C'L'                                     1151 04460000
         BE    @RF01151                                            1151 04461000
*            CTGFUNC = CTGCMS;         /*CMS FUNCTION                */ 04462000
         NI    CTGFUNC(@04),B'10011111'                            1152 04463000
         OI    CTGFUNC(@04),B'10000000'                            1152 04464000
*        IF PTRCTACB ^= NULLPTR                                    1153 04465000
*          THEN                                                    1153 04466000
@RF01151 L     @04,PTRCTACB                                        1153 04467000
         LTR   @04,@04                                             1153 04468000
         BZ    @RF01153                                            1153 04469000
*            CTGCAT = ADDR(PTRCTACB);  /*SET CATALOG ACB ADDR        */ 04470000
         LA    @04,PTRCTACB                                        1154 04471000
         L     @01,CTGPLPTR                                        1154 04472000
         ST    @04,CTGCAT(,@01)                                    1154 04473000
*          ELSE                                                    1155 04474000
*            DO;                                           /*@OZ14579*/ 04475000
         B     @RC01153                                            1155 04476000
@RF01153 DS    0H                                                  1156 04477000
*            CTGCNAME = ON;            /*NO CATALOG ACB PASSED       */ 04478000
         L     @04,CTGPLPTR                                        1156 04479000
         OI    CTGCNAME(@04),B'00000010'                           1156 04480000
*            IF ADDR(CAT) ^= NULLPTR                       /*@OZ14579*/ 04481000
*              THEN                                        /*@OZ14579*/ 04482000
         L     @15,@PC00001+4                                      1157 04483000
         L     @15,FDTPTR+128(,@15)                                1157 04484000
         LTR   @15,@15                                             1157 04485000
         BZ    @RF01157                                            1157 04486000
*                CTGCAT = ADDR(CATVAL);/* SET PTR TO CATALOG @OZ14579*/ 04487000
         LA    @15,CATVAL(,@15)                                    1158 04488000
         ST    @15,CTGCAT(,@04)                                    1158 04489000
*            END;                      /* NAME               @OZ14579*/ 04490000
*                                                                  1159 04491000
@RF01157 DS    0H                                                  1160 04492000
*        /************************************************************/ 04493000
*        /*                                                          */ 04494000
*        /*  IF THE CATALOG PASSWORD IS SPECIFIED IN THE AMS COMMAND,*/ 04495000
*        /*  PASS IT TO CATALOG MANAGEMENT.  OTHERWISE SEE IF AN     */ 04496000
*        /*  OBJECT PASSWORD HAS BEEN SUPPLIED BY THE CALLER OF THE  */ 04497000
*        /*  PROCEDURE                                               */ 04498000
*        /*                                                          */ 04499000
*        /************************************************************/ 04500000
*                                                                  1160 04501000
*        IF ADDR(CAT) ^= NULLPTR & CATPLN > 0                      1160 04502000
*          THEN                                                    1160 04503000
@RC01153 L     @04,@PC00001+4                                      1160 04504000
         L     @04,FDTPTR+128(,@04)                                1160 04505000
         LTR   @04,@04                                             1160 04506000
         BZ    @RF01160                                            1160 04507000
         CLI   CATPLN(@04),0                                       1160 04508000
         BNH   @RF01160                                            1160 04509000
*            CTGPSWD = ADDR(CATPAS);                               1161 04510000
         LA    @04,CATPAS(,@04)                                    1161 04511000
         L     @01,CTGPLPTR                                        1161 04512000
         ST    @04,CTGPSWD(,@01)                                   1161 04513000
*          ELSE                                                    1162 04514000
*            IF CCPSWD ^= NULLPTR                                  1162 04515000
*              THEN                                                1162 04516000
         B     @RC01160                                            1162 04517000
@RF01160 L     @04,@PC00003+16                                     1162 04518000
         L     @04,CCPSWD(,@04)                                    1162 04519000
         LTR   @04,@04                                             1162 04520000
         BZ    @RF01162                                            1162 04521000
*                CTGPSWD = CCPSWD;                                 1163 04522000
*                                                                  1163 04523000
         L     @01,CTGPLPTR                                        1163 04524000
         ST    @04,CTGPSWD(,@01)                                   1163 04525000
*        /************************************************************/ 04526000
*        /*                                                          */ 04527000
*        /*  SET THE APPROPRIATE FLAGS FOR EACH PARTICULAR FUNCTION  */ 04528000
*        /*                                                          */ 04529000
*        /************************************************************/ 04530000
*                                                                  1164 04531000
*        /************************************************************/ 04532000
*        /*                                                          */ 04533000
*        /*  CATALOG DEFINE FUNCTION                                 */ 04534000
*        /*                                                          */ 04535000
*        /************************************************************/ 04536000
*                                                                  1164 04537000
*        IF CTYPE = 'F'                                            1164 04538000
*          THEN                                                    1164 04539000
@RF01162 DS    0H                                                  1164 04540000
@RC01160 L     @04,@PC00003                                        1164 04541000
         CLI   CTYPE(@04),C'F'                                     1164 04542000
         BNE   @RF01164                                            1164 04543000
*            DO;                                                   1165 04544000
*        /* IF SAVRAC DONT RACF-DEFINE PROFILES              @Z40RSSA*/ 04545000
*          IF ADDR(SRAC) ^= 0 THEN                         /*@Z40RSSA*/ 04546000
         L     @04,@PC00001+4                                      1166 04547000
         L     @04,FDTPTR+132(,@04)                                1166 04548000
         LTR   @04,@04                                             1166 04549000
         BZ    @RF01166                                            1166 04550000
*          CTGNPROF = ON;                                  /*@Z40RSSA*/ 04551000
         L     @04,CTGPLPTR                                        1167 04552000
         OI    CTGNPROF(@04),B'00100000'                           1167 04553000
*       /* SET OTHER DEFINE FLAGS                            @Z40RSSA*/ 04554000
*            CTGNAME = ON;             /*ENTRY NAME SUPPLIED         */ 04555000
@RF01166 L     @04,CTGPLPTR                                        1168 04556000
         OI    CTGNAME(@04),B'00000100'                            1168 04557000
*            CTGOPTNS = CTGDEFIN;      /*DEFINE FUNCTION             */ 04558000
         NI    CTGOPTNS(@04),B'00001111'                           1169 04559000
         OI    CTGOPTNS(@04),B'00001000'                           1169 04560000
*            CTGMAST = ON;             /*VERIFY MASTER PASSWORD      */ 04561000
         OI    CTGMAST(@04),B'01000000'                            1170 04562000
*            END;                                                  1171 04563000
*                                                                  1171 04564000
*        /************************************************************/ 04565000
*        /*                                                          */ 04566000
*        /*  CATALOG LOCATE FUNCTION                                 */ 04567000
*        /*                                                          */ 04568000
*        /************************************************************/ 04569000
*                                                                  1172 04570000
*        IF CTYPE = 'L'                                            1172 04571000
*          THEN                                                    1172 04572000
@RF01164 L     @04,@PC00003                                        1172 04573000
         CLI   CTYPE(@04),C'L'                                     1172 04574000
         BNE   @RF01172                                            1172 04575000
*            CTGFUNC = CTGLOC;         /*CATALOG LOCATE FUNCTION     */ 04576000
*                                                                  1173 04577000
         L     @04,CTGPLPTR                                        1173 04578000
         NI    CTGFUNC(@04),B'00111111'                            1173 04579000
         OI    CTGFUNC(@04),B'00100000'                            1173 04580000
*        /************************************************************/ 04581000
*        /*                                                          */ 04582000
*        /*  CATALOG ALTER  FUNCTION                                 */ 04583000
*        /*                                                          */ 04584000
*        /************************************************************/ 04585000
*                                                                  1174 04586000
*        IF CTYPE = 'A'                                            1174 04587000
*          THEN                                                    1174 04588000
@RF01172 L     @04,@PC00003                                        1174 04589000
         CLI   CTYPE(@04),C'A'                                     1174 04590000
         BNE   @RF01174                                            1174 04591000
*            DO;                                                   1175 04592000
*            CTGNAME = ON;             /*ENTRY NAME SUPPLIED         */ 04593000
         L     @04,CTGPLPTR                                        1176 04594000
         OI    CTGNAME(@04),B'00000100'                            1176 04595000
*            CTGOPTNS = CTGALTER;      /*ALTER FUNCTION              */ 04596000
         NI    CTGOPTNS(@04),B'00010111'                           1177 04597000
         OI    CTGOPTNS(@04),B'00010000'                           1177 04598000
*            CTGNUM = ON;              /*SEARCH ONE CATALOG          */ 04599000
         OI    CTGNUM(@04),B'00000010'                             1178 04600000
*            END;                                                  1179 04601000
*                                                                  1179 04602000
*        /************************************************************/ 04603000
*        /*                                                          */ 04604000
*        /*  CATALOG DELETE FUNCTION                                 */ 04605000
*        /*                                                          */ 04606000
*        /************************************************************/ 04607000
*                                                                  1180 04608000
*        IF CTYPE = 'D'                                            1180 04609000
*          THEN                                                    1180 04610000
@RF01174 L     @04,@PC00003                                        1180 04611000
         CLI   CTYPE(@04),C'D'                                     1180 04612000
         BNE   @RF01180                                            1180 04613000
*            DO;                                                   1181 04614000
*        /* IF SAVRAC DONT RACF-DELETE PROFILES              @Z40RSSA*/ 04615000
*        IF ADDR(SRAC) ^= 0 THEN                           /*@Z40RSSA*/ 04616000
         L     @04,@PC00001+4                                      1182 04617000
         L     @04,FDTPTR+132(,@04)                                1182 04618000
         LTR   @04,@04                                             1182 04619000
         BZ    @RF01182                                            1182 04620000
*          CTGNPROF = ON;                                  /*@Z40RSSA*/ 04621000
         L     @04,CTGPLPTR                                        1183 04622000
         OI    CTGNPROF(@04),B'00100000'                           1183 04623000
*       /* SET OTHER DELETE FLAGS                            @Z40RSSA*/ 04624000
*            CTGOPTNS = CTGDELET;      /*DELETE FUNCTION             */ 04625000
@RF01182 L     @04,CTGPLPTR                                        1184 04626000
         NI    CTGOPTNS(@04),B'00011111'                           1184 04627000
         OI    CTGOPTNS(@04),B'00011000'                           1184 04628000
*            CTGNAME = ON;             /*ENTRY NAME SUPPLIED         */ 04629000
         OI    CTGNAME(@04),B'00000100'                            1185 04630000
*            IF ADDR(OUTDD) ^= NULLPTR                             1186 04631000
*              THEN                                                1186 04632000
         L     @15,@PC00001+4                                      1186 04633000
         L     @15,FDTPTR+4(,@15)                                  1186 04634000
         LTR   @15,@15                                             1186 04635000
         BZ    @RF01186                                            1186 04636000
*                CTGDDNM = ADDR(OUTDDVAL); /*DDNAME POINTER          */ 04637000
*                                                                  1187 04638000
         LA    @15,OUTDDVAL(,@15)                                  1187 04639000
         ST    @15,CTGDDNM(,@04)                                   1187 04640000
*            /********************************************************/ 04641000
*            /*                                                      */ 04642000
*            /*  SET DELETE OPTIONS FOR IMPORTRA.  THE OBJECT IS     */ 04643000
*            /*  NOT TO BE ERASED, SO THAT CTGOVRID IS SET ON, AND   */ 04644000
*            /*  CTGERASE IS SET TO OFF.  ALSO, CTGPURG IS SET TO    */ 04645000
*            /*  ON TO INDICATE THAT THE OBJECT IS TO BE DELETED     */ 04646000
*            /*  EVEN THOUGH ITS EXPIRATION DATE HAS NOT BEEN        */ 04647000
*            /*  REACHED.                                            */ 04648000
*            /*                                                      */ 04649000
*            /********************************************************/ 04650000
*                                                                  1188 04651000
*            CTGOVRID = ON;                                        1188 04652000
@RF01186 DS    0H                                                  1189 04653000
*            CTGERASE = OFF;                                       1189 04654000
*            CTGPURG = ON;                                         1190 04655000
*                                                                  1190 04656000
         L     @04,CTGPLPTR                                        1190 04657000
         OI    CTGOVRID(@04),B'00100100'                           1190 04658000
         NI    CTGERASE(@04),B'10111111'                           1190 04659000
*            CTGWKA = ADDR(DELTWKA);   /*SET WORK AREA ADDRESS       */ 04660000
         LA    @15,DELTWKA                                         1191 04661000
         ST    @15,CTGWKA(,@04)                                    1191 04662000
*            AREALN = LENGTH(DELTWKA); /*WORK AREA LENGTH            */ 04663000
         MVC   AREALN(2,@15),@CH01749                              1192 04664000
*            RETURNLN = 0;             /*RETURN LENGTH FROM          */ 04665000
         SLR   @04,@04                                             1193 04666000
         STH   @04,RETURNLN(,@15)                                  1193 04667000
*                                      /*CATALOG MANAGEMENT          */ 04668000
*                                                                  1194 04669000
*            /********************************************************/ 04670000
*            /*                                                      */ 04671000
*            /*  CLEAR THE REST OF THE WORK AREA FOR VSAM            */ 04672000
*            /*  CATALOG MANAGEMENT DELETE                           */ 04673000
*            /*                                                      */ 04674000
*            /********************************************************/ 04675000
*                                                                  1194 04676000
*            DO CPLPROCI = 1 TO 12;                                1194 04677000
         LA    @04,1                                               1194 04678000
         ST    @04,CPLPROCI                                        1194 04679000
@DL01194 DS    0H                                                  1195 04680000
*              ENTITEM(CPLPROCI) = ''B;                            1195 04681000
         LR    @15,@04                                             1195 04682000
         MH    @15,@CH01390                                        1195 04683000
         L     @01,CTGPLPTR                                        1195 04684000
         L     @01,CTGWKA(,@01)                                    1195 04685000
         ALR   @01,@15                                             1195 04686000
         AL    @01,@CF01798                                        1195 04687000
         XC    ENTITEM-4(45,@01),ENTITEM-4(@01)                    1195 04688000
*            END;                                                  1196 04689000
*                                                                  1196 04690000
         AL    @04,@CF00221                                        1196 04691000
         ST    @04,CPLPROCI                                        1196 04692000
         C     @04,@CF00035                                        1196 04693000
         BNH   @DL01194                                            1196 04694000
*           END;                                                   1197 04695000
*                                                                  1197 04696000
*        /************************************************************/ 04697000
*        /*                                                          */ 04698000
*        /*  FOR DELETE OR LOCATE, SUPPLY ENTRYNAME                  */ 04699000
*        /*                                                          */ 04700000
*        /************************************************************/ 04701000
*                                                                  1198 04702000
*        IF CTYPE = 'L' | CTYPE ='D'                               1198 04703000
*          THEN                                                    1198 04704000
@RF01180 L     @04,@PC00003                                        1198 04705000
         CLI   CTYPE(@04),C'L'                                     1198 04706000
         BE    @RT01198                                            1198 04707000
         CLI   CTYPE(@04),C'D'                                     1198 04708000
         BNE   @RF01198                                            1198 04709000
@RT01198 DS    0H                                                  1199 04710000
*            DO;                                                   1199 04711000
*            IF CNAME ^= NULLPTR                                   1200 04712000
*              THEN                                                1200 04713000
         L     @04,@PC00003+8                                      1200 04714000
         L     @04,CNAME(,@04)                                     1200 04715000
         LTR   @04,@04                                             1200 04716000
         BZ    @RF01200                                            1200 04717000
*                DO;                                               1201 04718000
*                CTGENT = CNAME;       /*SET POINTER TO ENTRY NAME   */ 04719000
         L     @15,CTGPLPTR                                        1202 04720000
         ST    @04,CTGENT(,@15)                                    1202 04721000
*                CTGNAME = ON;         /*ENTRY NAME SUPPLIED         */ 04722000
         OI    CTGNAME(@15),B'00000100'                            1203 04723000
*                END;                                              1204 04724000
*              ELSE                                                1205 04725000
*                CTGENT = ADDR(CINUM); /*SET CONTROL INTERVAL NUMBER */ 04726000
         B     @RC01200                                            1205 04727000
@RF01200 L     @04,@PC00003+12                                     1205 04728000
         L     @01,CTGPLPTR                                        1205 04729000
         ST    @04,CTGENT(,@01)                                    1205 04730000
*            END;                                                  1206 04731000
*                                                                  1206 04732000
@RC01200 DS    0H                                                  1207 04733000
*        IF GDTDBG = NULLPTR                                       1207 04734000
*          THEN;                                                   1207 04735000
@RF01198 L     @04,@PC00001                                        1207 04736000
         L     @04,GDTDBG(,@04)                                    1207 04737000
         LTR   @04,@04                                             1207 04738000
         BZ    @RT01207                                            1207 04739000
*          ELSE                                                    1209 04740000
*            CALL IDCDB010(GDTTBL,'RMCL');                         1209 04741000
*                                                                  1209 04742000
         L     @04,@PC00001                                        1209 04743000
         ST    @04,@AL00001                                        1209 04744000
         LA    @15,@CC01394                                        1209 04745000
         ST    @15,@AL00001+4                                      1209 04746000
         MVI   @AL00001+4,X'80'                                    1209 04747000
         L     @15,GDTDBG(,@04)                                    1209 04748000
         LA    @01,@AL00001                                        1209 04749000
         BALR  @14,@15                                             1209 04750000
*        /************************************************************/ 04751000
*        /*                                                          */ 04752000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 04753000
*        /*                                                          */ 04754000
*        /************************************************************/ 04755000
*                                                                  1210 04756000
*        RETURN CODE(0);                                           1210 04757000
@RT01207 SLR   @15,@15                                             1210 04758000
         L     @14,@SA00003                                        1210 04759000
         LM    @00,@12,@SA00003+8                                  1210 04760000
         BR    @14                                                 1210 04761000
*END CPLPROC;                                                      1211 04762000
*        /************************************************************/ 04763000
*        /*                                                          */ 04764000
*        /*  PROCEDURE NAME - IUNIQPRC                               */ 04765000
*        /*                                                          */ 04766000
*        /*  FUNCTION - CHECK THE DSATTR FIELDS TO SEE IF THE DATA   */ 04767000
*        /*  SET BEING DEFINED IS A UNIQUE DATA SET.  IF SO, A NULL  */ 04768000
*        /*  SPACE(VOLUME) FVT MUST BE SUPPLIED FOR CATALOG DEFINE   */ 04769000
*        /*                                                          */ 04770000
*        /*  INPUT - NONE                                            */ 04771000
*        /*                                                          */ 04772000
*        /*  OUTPUT - FOR A UNIQUE DATA SET, A NULL VOLUME FVT WILL  */ 04773000
*        /*  HAVE BEEN CONSTRUCTED AND A POINTER TO IT PLACED IN THE */ 04774000
*        /*  CLUSTER FVT                                             */ 04775000
*        /*                                                          */ 04776000
*        /************************************************************/ 04777000
*                                                                  1212 04778000
*IUNIQPRC: PROCEDURE;                                              1212 04779000
*                                                                  1212 04780000
IUNIQPRC STM   @14,@12,12(@13)                                     1212 04781000
*        /************************************************************/ 04782000
*        /*                                                          */ 04783000
*        /*  GET THE DATA FVT AND CHECK THE DSATTR FIELD FOR UNIQUE  */ 04784000
*        /*                                                          */ 04785000
*        /************************************************************/ 04786000
*                                                                  1213 04787000
*        CTGPLPTR = PTRCPL;                                        1213 04788000
         L     @04,PTRCPL                                          1213 04789000
         ST    @04,CTGPLPTR                                        1213 04790000
*        CTGFVPTR = CTGFVT;            /*FVT BASE- CLUSTER           */ 04791000
         L     @04,CTGFVT(,@04)                                    1214 04792000
         ST    @04,CTGFVPTR                                        1214 04793000
*        CTGFVPTR = CTGFVDCH;          /*FVT BASE - DATA COMPONENT   */ 04794000
         L     @04,CTGFVDCH(,@04)                                  1215 04795000
         ST    @04,CTGFVPTR                                        1215 04796000
*        IF CTGFVATR ^= NULLPTR                                    1216 04797000
*          THEN                                                    1216 04798000
         L     @04,CTGFVATR(,@04)                                  1216 04799000
         LTR   @04,@04                                             1216 04800000
         BZ    @RF01216                                            1216 04801000
*            DO;                                                   1217 04802000
*            CTGFLPTR = CTGFVATR;      /*SET FPL BASE TO DSATTR FPL  */ 04803000
         ST    @04,CTGFLPTR                                        1218 04804000
*            IF FDSUNIQ = ON                                       1219 04805000
*              THEN                                                1219 04806000
         L     @04,CTGFLPT(,@04)                                   1219 04807000
         TM    FDSUNIQ(@04),B'01000000'                            1219 04808000
         BNO   @RF01219                                            1219 04809000
*                DO;                                               1220 04810000
*                UNIQD = ON;                                       1221 04811000
         OI    UNIQD,B'10000000'                                   1221 04812000
*                IMPUNIQ = ON;         /*SET IMPORT UNIQUE FLAG      */ 04813000
         OI    IMPUNIQ,B'10000000'                                 1222 04814000
*                END;                                              1223 04815000
*            END;                                                  1224 04816000
*                                                                  1224 04817000
@RF01219 DS    0H                                                  1225 04818000
*        /************************************************************/ 04819000
*        /*                                                          */ 04820000
*        /*  IF AN INDEX FVT IS EXISTANT, CHECK IT ITS DSATTR FIELD  */ 04821000
*        /*                                                          */ 04822000
*        /************************************************************/ 04823000
*                                                                  1225 04824000
*        CTGFVPTR = CTGFVT;            /*SET FVT BASE- CLUSTER FVT   */ 04825000
@RF01216 L     @04,CTGPLPTR                                        1225 04826000
         L     @04,CTGFVT(,@04)                                    1225 04827000
         ST    @04,CTGFVPTR                                        1225 04828000
*        IF CTGFVICH ^= NULLPTR                                    1226 04829000
*          THEN                                                    1226 04830000
         SLR   @15,@15                                             1226 04831000
         L     @04,CTGFVICH(,@04)                                  1226 04832000
         CR    @04,@15                                             1226 04833000
         BE    @RF01226                                            1226 04834000
*            DO;                                                   1227 04835000
*            CTGFVPTR = CTGFVICH;      /*SET FVT BASE- INDEX FVT     */ 04836000
         ST    @04,CTGFVPTR                                        1228 04837000
*            IF CTGFVATR ^= NULLPTR                                1229 04838000
*              THEN                                                1229 04839000
         L     @04,CTGFVATR(,@04)                                  1229 04840000
         CR    @04,@15                                             1229 04841000
         BE    @RF01229                                            1229 04842000
*                DO;                                               1230 04843000
*                CTGFLPTR = CTGFVATR;  /*SET FPL BASE- DSATTR FPL    */ 04844000
         ST    @04,CTGFLPTR                                        1231 04845000
*                IF FDSUNIQ = ON                                   1232 04846000
*                  THEN                                            1232 04847000
         L     @04,CTGFLPT(,@04)                                   1232 04848000
         TM    FDSUNIQ(@04),B'01000000'                            1232 04849000
         BNO   @RF01232                                            1232 04850000
*                    DO;                                           1233 04851000
*                    UNIQI = ON;                                   1234 04852000
         OI    UNIQI,B'10000000'                                   1234 04853000
*                    IMPUNIQ = ON;     /*SET IMPORT UNIQUE FLAG      */ 04854000
         OI    IMPUNIQ,B'10000000'                                 1235 04855000
*                    END;                                          1236 04856000
*                END;                                              1237 04857000
@RF01232 DS    0H                                                  1238 04858000
*            END;                                                  1238 04859000
*                                                                  1238 04860000
@RF01229 DS    0H                                                  1239 04861000
*        /***********************************************************/  04862000
*        /*                                                          */ 04863000
*        /*  IF A DATA SET WAS A UNIQUE DATA SET (HAVING ITS OWN     */ 04864000
*        /*  DATA SPACE) PRIOR TO EXPORT, IT WILL AGAIN BE DEFINED   */ 04865000
*        /*  AS A UNIQUE DATA SET.  THIS ENTAILS SUPPLYING A NULL    */ 04866000
*        /*  SPACE (VOLUME) FVT FOR CATALOG DEFINE                   */ 04867000
*        /*                                                          */ 04868000
*        /************************************************************/ 04869000
*                                                                  1239 04870000
*        IF IMPUNIQ = ON                                           1239 04871000
*          THEN                                                    1239 04872000
@RF01226 TM    IMPUNIQ,B'10000000'                                 1239 04873000
         BNO   @RF01239                                            1239 04874000
*            DO;                                                   1240 04875000
*            OLDERID2 = NEWERID2;                                  1241 04876000
         L     @04,@PC00001                                        1241 04877000
         L     @04,GDTTR2(,@04)                                    1241 04878000
         MVC   @TS00001(95),NEWERID2(@04)                          1241 04879000
         MVC   OLDERID2(95,@04),@TS00001                           1241 04880000
*            NEWID2 = 'RMUQ';                                      1242 04881000
         MVC   NEWID2(4,@04),@CC01398                              1242 04882000
*            CTGFVPTR = CTGFVT;        /*SET FVT BASE - CLUSTER FVT  */ 04883000
         L     @04,CTGPLPTR                                        1243 04884000
         L     @04,CTGFVT(,@04)                                    1243 04885000
         ST    @04,CTGFVPTR                                        1243 04886000
*            CTGFVVCH = ADDR(IUNIQFVT);/*SET VOLUME FVT ADDRESS      */ 04887000
         LA    @15,IUNIQFVT                                        1244 04888000
         ST    @15,CTGFVVCH(,@04)                                  1244 04889000
*            IUNIQFVT = ''B;           /*ZERO VOLUME FVT             */ 04890000
*                                                                  1245 04891000
         XC    IUNIQFVT(92),IUNIQFVT                               1245 04892000
*            /********************************************************/ 04893000
*            /*                                                      */ 04894000
*            /*  SET VOLUME INDICATOR IN VOLUME FVT                  */ 04895000
*            /*                                                      */ 04896000
*            /********************************************************/ 04897000
*                                                                  1246 04898000
*            CTGFVPTR = CTGFVVCH;      /*SET FVT BASE - VOLUME FVT   */ 04899000
         ST    @15,CTGFVPTR                                        1246 04900000
*            CTGFVTYP = CTGFVVOL;      /*SET TYPE FLAG = VOLUME      */ 04901000
         MVI   CTGFVTYP(@15),C'V'                                  1247 04902000
*            END;                                                  1248 04903000
*                                                                  1248 04904000
*        /************************************************************/ 04905000
*        /*                                                          */ 04906000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 04907000
*        /*                                                          */ 04908000
*        /************************************************************/ 04909000
*                                                                  1249 04910000
*        RETURN CODE(0);                                           1249 04911000
@RF01239 SLR   @15,@15                                             1249 04912000
         L     @14,12(,@13)                                        1249 04913000
         LM    @00,@12,20(@13)                                     1249 04914000
         BR    @14                                                 1249 04915000
*END IUNIQPRC;                                                     1250 04916000
*        /************************************************************/ 04917000
*        /*                                                          */ 04918000
*        /*  PROCEDURE NAME - ALTRPROC                               */ 04919000
*        /*                                                          */ 04920000
*        /*  FUNCTION - ALTRPROC WILL CONSTRUCT A CPL AND FVT TO BE  */ 04921000
*        /*  EMPLOYED BY THE CATALOG ALTER INTERFACE TO ALTER THE    */ 04922000
*        /*  THE NAME OF THE OBJECT DEFINED TO THE NAME THAT APPEARS */ 04923000
*        /*  ON THE DD CARD USED TO OPEN THE OBJECT FOR LOADING.     */ 04924000
*        /*  CATALOG MANAGEMENT IS ACTUALLY INVOKED BY CTLGPROC.     */ 04925000
*        /*  THIS PROCEDURE IS ALSO CALLED AT CLOSE TIME TO          */ 04926000
*        /*  TO ALTER THE NAME OF THE OBJECT JUST LOADED BACK TO     */ 04927000
*        /*  THE NAME THAT IT WAS DEFINED UNDER.                     */ 04928000
*        /*                                                          */ 04929000
*        /*  INPUT - A FLAG INDICATING WHETHER THE NAME IS TO        */ 04930000
*        /*  CHANGED TO THE DUMMY NAME OR BACK TO THE REAL NAME      */ 04931000
*        /*                                                          */ 04932000
*        /*  OUTPUT - AN ALTERED CATALOG ENTRY                       */ 04933000
*        /*                                                          */ 04934000
*        /************************************************************/ 04935000
*                                                                  1251 04936000
*ALTRPROC: PROCEDURE(ALTERTYP);                                    1251 04937000
*                                                                  1251 04938000
ALTRPROC STM   @14,@12,@SA00005                                    1251 04939000
         MVC   @PC00005(4),0(@01)                                  1251 04940000
*        /************************************************************/ 04941000
*        /*                                                          */ 04942000
*        /*  ARGUMENTS OF INVOCATION                                 */ 04943000
*        /*                                                          */ 04944000
*        /************************************************************/ 04945000
*                                                                  1252 04946000
*        DCL ALTERTYP CHAR(1);         /*ALTERTYP = 'F' ALTER TO     */ 04947000
*                                      /*DUMMY NAME                  */ 04948000
*                                      /*ALTERTYP = 'S' ALTER TO     */ 04949000
*                                      /*REAL NAME                   */ 04950000
*                                                                  1253 04951000
*        OLDERID2 = NEWERID2;                                      1253 04952000
         L     @04,@PC00001                                        1253 04953000
         L     @04,GDTTR2(,@04)                                    1253 04954000
         MVC   @TS00001(95),NEWERID2(@04)                          1253 04955000
         MVC   OLDERID2(95,@04),@TS00001                           1253 04956000
*        NEWID2 = 'RMAT';                                          1254 04957000
*                                                                  1254 04958000
         MVC   NEWID2(4,@04),@CC01405                              1254 04959000
*        /************************************************************/ 04960000
*        /*                                                          */ 04961000
*        /*  LOCAL DECLARATIONS                                      */ 04962000
*        /*                                                          */ 04963000
*        /************************************************************/ 04964000
*                                                                  1255 04965000
*        DCL AFVT CHAR(LENGTH(CTGFV)); /*ALTER FVT                   */ 04966000
*        DCL APSWD PTR(31);            /*POINTER TO PASSWORD         */ 04967000
*                                                                  1256 04968000
*        /************************************************************/ 04969000
*        /*                                                          */ 04970000
*        /*  CONSTRUCT CPL AND FVT FOR ALTER INTERFACE IN ORDER TO   */ 04971000
*        /*  ALTER THE NAME OF THE OBJECT.                           */ 04972000
*        /*                                                          */ 04973000
*        /************************************************************/ 04974000
*                                                                  1257 04975000
*        CTGPLPTR = PTRCPL;            /*SET CPL BASE -DEFINE CLUSTER*/ 04976000
         L     @04,PTRCPL                                          1257 04977000
         ST    @04,CTGPLPTR                                        1257 04978000
*        CTGFVPTR = CTGFVT;            /*SET FVT BASE - CLUSTER FVT  */ 04979000
*                                                                  1258 04980000
         L     @04,CTGFVT(,@04)                                    1258 04981000
         ST    @04,CTGFVPTR                                        1258 04982000
*        /************************************************************/ 04983000
*        /*                                                          */ 04984000
*        /*  SET POINTER TO FVT. SET THE TYPE FIELD IN THE FVT,      */ 04985000
*        /*  THE ENTNAME FIELD TO THE ENTNAME FPL                    */ 04986000
*        /*                                                          */ 04987000
*        /************************************************************/ 04988000
*                                                                  1259 04989000
*        AFVTPTR = ADDR(AFVT);                                     1259 04990000
         LA    @15,AFVT                                            1259 04991000
         ST    @15,AFVTPTR                                         1259 04992000
*        AFVT = ''B;                                               1260 04993000
*                                                                  1260 04994000
         XC    AFVT(92),AFVT                                       1260 04995000
*        /************************************************************/ 04996000
*        /*                                                          */ 04997000
*        /*  SET TYPE FIELD                                          */ 04998000
*        /*                                                          */ 04999000
*        /************************************************************/ 05000000
*                                                                  1261 05001000
*        AFVTPTR -> CTGFVTYP = CTGFVTYP;  /*SET TYPE FIELD       */     05002000
*                                                                  1261 05003000
         MVC   CTGFVTYP(1,@15),CTGFVTYP(@04)                       1261 05004000
*        /************************************************************/ 05005000
*        /*                                                          */ 05006000
*        /*  IF THE FLAG IS 'F', THEN SET THE VALUE OF THE PRESENT   */ 05007000
*        /*  NAME TO BE THE NAME USED IN THE DEFINE.  OTHERWISE,     */ 05008000
*        /*  SET IT TO THE DUMMY NAME.                               */ 05009000
*        /*                                                          */ 05010000
*        /************************************************************/ 05011000
*                                                                  1262 05012000
*        IF ALTERTYP = 'F'                                         1262 05013000
*          THEN                                                    1262 05014000
         L     @14,@PC00005                                        1262 05015000
         CLI   ALTERTYP(@14),C'F'                                  1262 05016000
         BNE   @RF01262                                            1262 05017000
*            AFVTPTR -> CTGFVENT = CTGFVENT;                       1263 05018000
         L     @04,CTGFVENT(,@04)                                  1263 05019000
         ST    @04,CTGFVENT(,@15)                                  1263 05020000
*          ELSE                                                    1264 05021000
*            AFVTPTR -> CTGFVENT = ADDR(DSNRETNM);                 1264 05022000
*                                                                  1264 05023000
         B     @RC01262                                            1264 05024000
@RF01262 LA    @04,DSNRETNM                                        1264 05025000
         L     @01,AFVTPTR                                         1264 05026000
         ST    @04,CTGFVENT(,@01)                                  1264 05027000
*        /************************************************************/ 05028000
*        /*                                                          */ 05029000
*        /*  SET THE VALUE OF THE DDNAME IN THE FVT FOR THE ALTER    */ 05030000
*        /*                                                          */ 05031000
*        /************************************************************/ 05032000
*                                                                  1265 05033000
*        AFVTPTR -> CTGFVIND = ADDR(OUTDDVAL);                     1265 05034000
*                                                                  1265 05035000
@RC01262 L     @04,@PC00001+4                                      1265 05036000
         L     @04,FDTPTR+4(,@04)                                  1265 05037000
         LA    @04,OUTDDVAL(,@04)                                  1265 05038000
         L     @01,AFVTPTR                                         1265 05039000
         ST    @04,CTGFVIND(,@01)                                  1265 05040000
*        /************************************************************/ 05041000
*        /*                                                          */ 05042000
*        /*  SET SECURITY INFORMATION IN THE FVT FOR THE RENAME      */ 05043000
*        /*  OPERATION.                                              */ 05044000
*        /*                                                          */ 05045000
*        /************************************************************/ 05046000
*                                                                  1266 05047000
*        IF CTGFVSTY ^= NULLPTR                                    1266 05048000
*          THEN                                                    1266 05049000
         L     @04,CTGFVPTR                                        1266 05050000
         L     @04,CTGFVSTY(,@04)                                  1266 05051000
         LTR   @04,@04                                             1266 05052000
         BZ    @RF01266                                            1266 05053000
*            APSWD = CTGFVSTY -> CTGFLPT(1);                       1267 05054000
         L     @04,CTGFLPT(,@04)                                   1267 05055000
         ST    @04,APSWD                                           1267 05056000
*          ELSE                                                    1268 05057000
*            APSWD = CPSWD;                                        1268 05058000
*                                                                  1268 05059000
         B     @RC01266                                            1268 05060000
@RF01266 L     @04,CPSWD                                           1268 05061000
         ST    @04,APSWD                                           1268 05062000
*        /************************************************************/ 05063000
*        /*                                                          */ 05064000
*        /*  NOW BUILD CPL FOR THE CATALOG ALTER                     */ 05065000
*        /*  IF NOT SUCCESSFUL, RETURN TO CALLING PROCESSOR          */ 05066000
*        /*                                                        */   05067000
*        /************************************************************/ 05068000
*                                                                  1269 05069000
*        CALL CPLPROC('A',ACPLPTR,NULLPARM,NULLPARM,NULLPARM,      1269 05070000
*           APSWD);                                                1269 05071000
*                                                                  1269 05072000
@RC01266 MVC   @AL00001(20),@AL01269                               1269 05073000
         LA    @04,ACPLPTR                                         1269 05074000
         ST    @04,@AL00001+4                                      1269 05075000
         LA    @04,APSWD                                           1269 05076000
         ST    @04,@AL00001+20                                     1269 05077000
         LA    @01,@AL00001                                        1269 05078000
         BAL   @14,CPLPROC                                         1269 05079000
*        RESPECIFY RTNREG RSTD;                                    1270 05080000
*        TESTRC = RTNREG;                                          1271 05081000
         STH   RTNREG,TESTRC                                       1271 05082000
*        RESPECIFY RTNREG UNRSTD;                                  1272 05083000
*        IF TESTRC ^= 0                                            1273 05084000
*          THEN                                                    1273 05085000
         LH    @04,TESTRC                                          1273 05086000
         LTR   @04,@04                                             1273 05087000
         BZ    @RF01273                                            1273 05088000
*            RETURN CODE(LASTCC12);                                1274 05089000
*                                                                  1274 05090000
         LA    @15,12                                              1274 05091000
         L     @14,@SA00005                                        1274 05092000
         LM    @00,@12,@SA00005+8                                  1274 05093000
         BR    @14                                                 1274 05094000
*        /************************************************************/ 05095000
*        /*                                                          */ 05096000
*        /*  SET THE VALUE OF THE FVT FIELD OF THE CPL TO POINT TO   */ 05097000
*        /*  THE ALTER FVT.                                          */ 05098000
*        /*                                                          */ 05099000
*        /************************************************************/ 05100000
*                                                                  1275 05101000
*        ACPLPTR -> CTGFVT = AFVTPTR;                              1275 05102000
*                                                                  1275 05103000
@RF01273 L     @04,ACPLPTR                                         1275 05104000
         L     @15,AFVTPTR                                         1275 05105000
         ST    @15,CTGFVT(,@04)                                    1275 05106000
*        /************************************************************/ 05107000
*        /*                                                          */ 05108000
*        /*  IF ALTERTYP IS F, THEN THE NEW NAME IS THE DUMMY        */ 05109000
*        /*  NAME RETURNED BY UIOINFO.  OTHERWISE, THE NEW NAME IS   */ 05110000
*        /*  THE NAME USED TO DO THE DEFINE.                         */ 05111000
*        /*                                                          */ 05112000
*        /************************************************************/ 05113000
*                                                                  1276 05114000
*        IF ALTERTYP = 'F'                                         1276 05115000
*          THEN                                                    1276 05116000
         L     @15,@PC00005                                        1276 05117000
         CLI   ALTERTYP(@15),C'F'                                  1276 05118000
         BNE   @RF01276                                            1276 05119000
*            ACPLPTR -> CTGNEWNM = ADDR(DSNRETNM);                 1277 05120000
         LA    @15,DSNRETNM                                        1277 05121000
         ST    @15,CTGNEWNM(,@04)                                  1277 05122000
*          ELSE                                                    1278 05123000
*            ACPLPTR -> CTGNEWNM = CTGFVENT;                       1278 05124000
*                                                                  1278 05125000
         B     @RC01276                                            1278 05126000
@RF01276 L     @04,CTGFVPTR                                        1278 05127000
         L     @04,CTGFVENT(,@04)                                  1278 05128000
         L     @01,ACPLPTR                                         1278 05129000
         ST    @04,CTGNEWNM(,@01)                                  1278 05130000
*        /************************************************************/ 05131000
*        /*                                                          */ 05132000
*        /*  INVOKE CATALOG MANAGEMENT  TO RENAME THE OBJECT         */ 05133000
*        /*  IF ALTER FAILS, RETURN TO CALLER WITH FAILURE           */ 05134000
*        /*  INDICATED.                                              */ 05135000
*        /*                                                          */ 05136000
*        /************************************************************/ 05137000
*                                                                  1279 05138000
*        CALL CTLGPROC(ACPLPTR);                                   1279 05139000
*                                                                  1279 05140000
@RC01276 LA    @04,ACPLPTR                                         1279 05141000
         ST    @04,@AL00001                                        1279 05142000
         LA    @01,@AL00001                                        1279 05143000
         BAL   @14,CTLGPROC                                        1279 05144000
*        RESPECIFY RTNREG RSTD;                                    1280 05145000
*        TESTRC = RTNREG;                                          1281 05146000
         STH   RTNREG,TESTRC                                       1281 05147000
*        RESPECIFY RTNREG UNRSTD;                                  1282 05148000
*        IF TESTRC ^= 0                                            1283 05149000
*          THEN                                                    1283 05150000
         LH    @04,TESTRC                                          1283 05151000
         LTR   @04,@04                                             1283 05152000
         BZ    @RF01283                                            1283 05153000
*            DO;                                                   1284 05154000
*            IF DEFSTID ^= NORMSTAT                        /*@OZ17068*/ 05155000
*              THEN                                        /*@OZ17068*/ 05156000
         CLI   DEFSTID,0                                           1285 05157000
         BE    @RF01285                                            1285 05158000
*                DO;                                       /*@OZ17068*/ 05159000
*                DARGSENT = DEFSTID;                       /*@OZ17068*/ 05160000
         IC    @04,DEFSTID                                         1287 05161000
         L     @01,DDSTRU                                          1287 05162000
         STC   @04,DARGSENT(,@01)                                  1287 05163000
*                                                          /*@OZ17068*/ 05164000
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     /*@OZ17068*/ 05165000
         L     @04,@PC00001                                        1288 05166000
         ST    @04,@AL00001                                        1288 05167000
         LA    @15,@CF00119                                        1288 05168000
         ST    @15,@AL00001+4                                      1288 05169000
         LA    @15,DDSTRU                                          1288 05170000
         ST    @15,@AL00001+8                                      1288 05171000
         MVI   @AL00001+8,X'80'                                    1288 05172000
         L     @15,GDTPRT(,@04)                                    1288 05173000
         LA    @01,@AL00001                                        1288 05174000
         BALR  @14,@15                                             1288 05175000
*                                                          /*@OZ17068*/ 05176000
*                DEFSTID = NORMSTAT;                       /*@OZ17068*/ 05177000
         MVI   DEFSTID,X'00'                                       1289 05178000
*                END;                                      /*@OZ17068*/ 05179000
*              ELSE;                                       /*@OZ17068*/ 05180000
@RF01285 DS    0H                                                  1292 05181000
*            DARGLIST =''B;                                /*@OZ17068*/ 05182000
         L     @04,DDSTRU                                          1292 05183000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1292 05184000
*            DARGSMOD = IMPMSG;                                    1293 05185000
         MVC   DARGSMOD(3,@04),@CC00945                            1293 05186000
*            DARGSENT = ALTFAIL;                           /*@OZ17068*/ 05187000
         MVI   DARGSENT(@04),X'13'                                 1294 05188000
*                                                          /*@OZ17068*/ 05189000
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         /*@OZ17068*/ 05190000
*                                                                  1295 05191000
         L     @04,@PC00001                                        1295 05192000
         ST    @04,@AL00001                                        1295 05193000
         LA    @15,@CF00119                                        1295 05194000
         ST    @15,@AL00001+4                                      1295 05195000
         LA    @15,DDSTRU                                          1295 05196000
         ST    @15,@AL00001+8                                      1295 05197000
         MVI   @AL00001+8,X'80'                                    1295 05198000
         L     @15,GDTPRT(,@04)                                    1295 05199000
         LA    @01,@AL00001                                        1295 05200000
         BALR  @14,@15                                             1295 05201000
*            RETURN CODE(LASTCC12);                                1296 05202000
         LA    @15,12                                              1296 05203000
         L     @14,@SA00005                                        1296 05204000
         LM    @00,@12,@SA00005+8                                  1296 05205000
         BR    @14                                                 1296 05206000
*            END;                                                  1297 05207000
*                                                                  1297 05208000
*        /************************************************************/ 05209000
*        /*                                                          */ 05210000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 05211000
*        /*                                                          */ 05212000
*        /************************************************************/ 05213000
*                                                                  1298 05214000
*        RETURN CODE(0);                                           1298 05215000
@RF01283 SLR   @15,@15                                             1298 05216000
         L     @14,@SA00005                                        1298 05217000
         LM    @00,@12,@SA00005+8                                  1298 05218000
         BR    @14                                                 1298 05219000
*END ALTRPROC;                                                     1299 05220000
*          /**********************************************************/ 05221000
*          /*                                                        */ 05222000
*          /*  PROCEDURE NAME - UCATPROC                             */ 05223000
*          /*                                                        */ 05224000
*          /*  FUNCTION - READ CATALOG AND DATA RECORDS FROM THE     */ 05225000
*          /*  PORTABILITY VOLUME, AND PERFORM A DEFINE OF           */ 05226000
*          /*  OF A USERCATALOG POINTER AND ITS ASSOCIATED ALIASES   */ 05227000
*          /*  INTO THE MASTERCATALOG.                               */ 05228000
*          /*                                                        */ 05229000
*          /*  INPUT - FUNCTION DEFINITION TABLE                     */ 05230000
*          /*                                                        */ 05231000
*          /*  OUTPUT - A RECREATED USERCATALOG POINTER AND ITS      */ 05232000
*          /*  ALIASES                                               */ 05233000
*          /*                                                        */ 05234000
*          /**********************************************************/ 05235000
*                                                                  1300 05236000
*UCATPROC: PROCEDURE;                                              1300 05237000
*                                                                  1300 05238000
UCATPROC STM   @14,@12,@SA00006                                    1300 05239000
*          OLDERID2 = NEWERID2;                                    1301 05240000
         L     @04,@PC00001                                        1301 05241000
         L     @04,GDTTR2(,@04)                                    1301 05242000
         MVC   @TS00001(95),NEWERID2(@04)                          1301 05243000
         MVC   OLDERID2(95,@04),@TS00001                           1301 05244000
*          NEWID2 = 'RMUC';                                        1302 05245000
*                                                                  1302 05246000
         MVC   NEWID2(4,@04),@CC01411                              1302 05247000
*          /**********************************************************/ 05248000
*          /*                                                        */ 05249000
*          /*  SET THE ADDRESS OF THE CONTROL RECORD BUFFER WHICH    */ 05250000
*          /*  WILL CONTAIN THE DICTIONARY FOR THE CATALOG RECORD    */ 05251000
*          /*                                                        */ 05252000
*          /**********************************************************/ 05253000
*                                                                  1303 05254000
*          CONRCPTR = ADDR(CONRCARE);                              1303 05255000
*                                                                  1303 05256000
         LA    @04,CONRCARE                                        1303 05257000
         ST    @04,CONRCPTR                                        1303 05258000
*          /**********************************************************/ 05259000
*          /*                                                        */ 05260000
*          /*  ZERO OUT THE AREA THAT HOLDS THE CONTROL RECORDS      */ 05261000
*          /*  BEGIN BY INITIALIZING THE VALUES OF ZSIZE, ZPTR,      */ 05262000
*          /*  AND ZCNTRL.                                           */ 05263000
*          /*                                                        */ 05264000
*          /**********************************************************/ 05265000
*                                                                  1304 05266000
*          ZSIZE = LENGTH(CONRCARE);                               1304 05267000
         MVC   ZSIZE(2),@CH00920                                   1304 05268000
*          ZPTR = CONRCPTR;                                        1305 05269000
         ST    @04,ZPTR                                            1305 05270000
*          ZCNTRL = ON;                                            1306 05271000
*                                                                  1306 05272000
         OI    ZCNTRL,B'10000000'                                  1306 05273000
*          /*********************************************************** 05274000
*          /*                                                         * 05275000
*          /*  LOOP CLEARING THE  AREA THAT IS TO HOLD THE CONTROL    * 05276000
*          /*  RECORD.                                                * 05277000
*          /*                                                         * 05278000
*          /*********************************************************** 05279000
*                                                                  1307 05280000
*          DO WHILE (ZCNTRL = ON);                                 1307 05281000
         B     @DE01307                                            1307 05282000
@DL01307 DS    0H                                                  1308 05283000
*            IF ZSIZE > 256                                        1308 05284000
*              THEN                                                1308 05285000
         LH    @04,ZSIZE                                           1308 05286000
         LA    @15,256                                             1308 05287000
         CR    @04,@15                                             1308 05288000
         BNH   @RF01308                                            1308 05289000
*                DO;                                               1309 05290000
*                ZAREA(1:256) = ZER(1:256);                        1310 05291000
         L     @14,ZPTR                                            1310 05292000
         MVC   ZAREA(256,@14),ZER                                  1310 05293000
*                ZSIZE = ZSIZE - 256;                              1311 05294000
         SLR   @04,@15                                             1311 05295000
         STH   @04,ZSIZE                                           1311 05296000
*                ZPTR = ZPTR + 256;                                1312 05297000
         ALR   @14,@15                                             1312 05298000
         ST    @14,ZPTR                                            1312 05299000
*                END;                                              1313 05300000
*              ELSE                                                1314 05301000
*                DO;                                               1314 05302000
         B     @RC01308                                            1314 05303000
@RF01308 DS    0H                                                  1315 05304000
*                ZAREA (1:ZSIZE) = ZER(1:ZSIZE);                   1315 05305000
         L     @04,ZPTR                                            1315 05306000
         LH    @15,ZSIZE                                           1315 05307000
         BCTR  @15,0                                               1315 05308000
         EX    @15,@SM01777                                        1315 05309000
*                ZCNTRL = OFF;                                     1316 05310000
         NI    ZCNTRL,B'01111111'                                  1316 05311000
*                END;                                              1317 05312000
*          END;                                                    1318 05313000
*                                                                  1318 05314000
@RC01308 DS    0H                                                  1318 05315000
@DE01307 TM    ZCNTRL,B'10000000'                                  1318 05316000
         BO    @DL01307                                            1318 05317000
*          /**********************************************************/ 05318000
*          /*                                                        */ 05319000
*          /*  CONSTRUCT THE CPL TO BE USED FOR THE DEFINE FUNCTION  */ 05320000
*          /*  IF THE CONSTRUCTION FAILS, RETURN TO THE CALLING      */ 05321000
*          /*  PROCESSOR WITH AN ERROR INDICATOR.                    */ 05322000
*          /*                                                        */ 05323000
*          /*                                                        */ 05324000
*          /**********************************************************/ 05325000
*                                                                  1319 05326000
*          CALL CPLPROC('F',UCPTRCPL,NULLPARM,NULLPARM,NULLPARM);  1319 05327000
*                                                                  1319 05328000
         MVC   @AL00001(20),@AL01319                               1319 05329000
         LA    @04,UCPTRCPL                                        1319 05330000
         ST    @04,@AL00001+4                                      1319 05331000
         LA    @01,@AL00001                                        1319 05332000
         BAL   @14,CPLPROC                                         1319 05333000
*          RESPECIFY RTNREG RSTD;                                  1320 05334000
*          TESTRC = RTNREG;                                        1321 05335000
         STH   RTNREG,TESTRC                                       1321 05336000
*          RESPECIFY RTNREG UNRSTD;                                1322 05337000
*          IF TESTRC ^= 0                                          1323 05338000
*            THEN                                                  1323 05339000
         LH    @04,TESTRC                                          1323 05340000
         LTR   @04,@04                                             1323 05341000
         BZ    @RF01323                                            1323 05342000
*              RETURN CODE(LASTCC12);                              1324 05343000
*                                                                  1324 05344000
         LA    @15,12                                              1324 05345000
         L     @14,@SA00006                                        1324 05346000
         LM    @00,@12,@SA00006+8                                  1324 05347000
         BR    @14                                                 1324 05348000
*          /**********************************************************/ 05349000
*          /*                                                        */ 05350000
*          /*  SET CTGPLPTR TO BE UCPTRCPL, SO THAT IT POINTS TO THE */ 05351000
*          /*  CPL BUILT FOR THE USERCATALOG.                        */ 05352000
*          /*                                                        */ 05353000
*          /*                                                        */ 05354000
*          /**********************************************************/ 05355000
*                                                                  1325 05356000
*          CTGPLPTR = UCPTRCPL;                                    1325 05357000
*                                                                  1325 05358000
@RF01323 L     @04,UCPTRCPL                                        1325 05359000
         ST    @04,CTGPLPTR                                        1325 05360000
*          /**********************************************************/ 05361000
*          /*                                                        */ 05362000
*          /*  NOW GET THE CONTROL RECORD, AND PUT IT INTO THE BUFFER*/ 05363000
*          /*                                                        */ 05364000
*          /**********************************************************/ 05365000
*                                                                  1326 05366000
*          CALL IDCIOGT0(GDTTBL,PINIOCS);                          1326 05367000
*                                                                  1326 05368000
         L     @04,@PC00001                                        1326 05369000
         ST    @04,@AL00001                                        1326 05370000
         LA    @15,PINIOCS                                         1326 05371000
         ST    @15,@AL00001+4                                      1326 05372000
         MVI   @AL00001+4,X'80'                                    1326 05373000
         L     @15,GDTGET(,@04)                                    1326 05374000
         LA    @01,@AL00001                                        1326 05375000
         BALR  @14,@15                                             1326 05376000
*          RESPECIFY RTNREG RSTD;                                  1327 05377000
*          TESTRC = RTNREG;                                        1328 05378000
         STH   RTNREG,TESTRC                                       1328 05379000
*          RESPECIFY RTNREG UNRSTD;                                1329 05380000
*          IF TESTRC ^= 0                                          1330 05381000
*            THEN                                                  1330 05382000
         LH    @04,TESTRC                                          1330 05383000
         LTR   @04,@04                                             1330 05384000
         BZ    @RF01330                                            1330 05385000
*              RETURN CODE(LASTCC12);                              1331 05386000
*                                                                  1331 05387000
         LA    @15,12                                              1331 05388000
         L     @14,@SA00006                                        1331 05389000
         LM    @00,@12,@SA00006+8                                  1331 05390000
         BR    @14                                                 1331 05391000
*          TFVTLEN = IOCDAD -> HEADLN;                             1332 05392000
@RF01330 L     @04,IOCSPTR                                         1332 05393000
         L     @01,IOCDAD(,@04)                                    1332 05394000
         LH    @15,HEADLN(,@01)                                    1332 05395000
         STH   @15,TFVTLEN                                         1332 05396000
*          CALL MVDAPROC(TFVTLEN,IOCDAD,CONRCPTR);                 1333 05397000
*                                                                  1333 05398000
         LA    @15,TFVTLEN                                         1333 05399000
         ST    @15,@AL00001                                        1333 05400000
         ST    @04,@AL00001+4                                      1333 05401000
         LA    @04,CONRCPTR                                        1333 05402000
         ST    @04,@AL00001+8                                      1333 05403000
         LA    @01,@AL00001                                        1333 05404000
         BAL   @14,MVDAPROC                                        1333 05405000
*          /**********************************************************/ 05406000
*          /*                                                        */ 05407000
*          /*  TEST TO DETERMINE THAT WE GOT A CATALOG CONTROL RECORD*/ 05408000
*          /*  IF WE DID NOT, THEN RETURN TO THE CALLING PROCESSOOR  */ 05409000
*          /*  FOR THE PORTABLE DATA SET IS IN ERROR.                */ 05410000
*          /*                                                        */ 05411000
*          /**********************************************************/ 05412000
*                                                                  1334 05413000
*          IF HEADFLG1 ^= HDFL1CAT | (HEADFLG2 ^= HDFL2UCT)        1334 05414000
*            THEN                                                  1334 05415000
         L     @04,CONRCPTR                                        1334 05416000
         CLI   HEADFLG1(@04),X'FF'                                 1334 05417000
         BNE   @RT01334                                            1334 05418000
         CLI   HEADFLG2(@04),C'U'                                  1334 05419000
         BE    @RF01334                                            1334 05420000
@RT01334 DS    0H                                                  1335 05421000
*              DO;                                                 1335 05422000
*              DEFSTID = PORTERR;                                  1336 05423000
         MVI   DEFSTID,X'01'                                       1336 05424000
*              RETURN CODE(LASTCC12);                              1337 05425000
         LA    @15,12                                              1337 05426000
         L     @14,@SA00006                                        1337 05427000
         LM    @00,@12,@SA00006+8                                  1337 05428000
         BR    @14                                                 1337 05429000
*              END;                                                1338 05430000
*                                                                  1338 05431000
*          /**********************************************************/ 05432000
*          /*                                                        */ 05433000
*          /*  THE PORTABLE DATA SET IS ALL RIGHT SO FAR.  COMPUTE   */ 05434000
*          /*  THE AMOUNT OF SPACE NEEDED TO HOLD THE DATA RECORD    */ 05435000
*          /*  ASSOCIATED WITH THE PRESENT CONTROL RECORD.           */ 05436000
*          /*                                                        */ 05437000
*          /**********************************************************/ 05438000
*                                                                  1339 05439000
*          TOTLEN = ASSRECLN;                                      1339 05440000
*                                                                  1339 05441000
@RF01334 L     @04,CONRCPTR                                        1339 05442000
         LH    @04,ASSRECLN(,@04)                                  1339 05443000
         ST    @04,TOTLEN                                          1339 05444000
*          /**********************************************************/ 05445000
*          /*                                                        */ 05446000
*          /*  ISSUE A UGPOOL TO GET THE BUFFER FOR THE DATA RECORD. */ 05447000
*          /*  SHOULD THIS FAIL RETURN TO THE CALLING PROCESSOR WITH */ 05448000
*          /*  AN ERROR INDICATION.                                  */ 05449000
*          /*                                                        */ 05450000
*          /**********************************************************/ 05451000
*                                                                  1340 05452000
*          CALL IDCSAGP0(GDTTBL,TOTLEN,UCWORKAR,GPID,SETZERO);     1340 05453000
         L     @04,@PC00001                                        1340 05454000
         ST    @04,@AL00001                                        1340 05455000
         LA    @15,TOTLEN                                          1340 05456000
         ST    @15,@AL00001+4                                      1340 05457000
         LA    @15,UCWORKAR                                        1340 05458000
         ST    @15,@AL00001+8                                      1340 05459000
         LA    @15,GPID                                            1340 05460000
         ST    @15,@AL00001+12                                     1340 05461000
         LA    @15,SETZERO                                         1340 05462000
         ST    @15,@AL00001+16                                     1340 05463000
         MVI   @AL00001+16,X'80'                                   1340 05464000
         L     @15,GDTGPL(,@04)                                    1340 05465000
         LA    @01,@AL00001                                        1340 05466000
         BALR  @14,@15                                             1340 05467000
*          RESPECIFY RTNREG RSTD;                                  1341 05468000
*          TESTRC = RTNREG;                                        1342 05469000
         STH   RTNREG,TESTRC                                       1342 05470000
*          RESPECIFY RTNREG UNRSTD;                                1343 05471000
*          IF TESTRC ^= 0                                          1344 05472000
*            THEN                                                  1344 05473000
         LH    @04,TESTRC                                          1344 05474000
         LTR   @04,@04                                             1344 05475000
         BZ    @RF01344                                            1344 05476000
*              DO;                                                 1345 05477000
*              DEFSTID = NOSTORAG;                                 1346 05478000
         MVI   DEFSTID,X'04'                                       1346 05479000
*              DARGSMOD = UNIVMSG;                                 1347 05480000
         L     @04,DDSTRU                                          1347 05481000
         MVC   DARGSMOD(3,@04),@CC00981                            1347 05482000
*              RETURN CODE(LASTCC12);                              1348 05483000
         LA    @15,12                                              1348 05484000
         L     @14,@SA00006                                        1348 05485000
         LM    @00,@12,@SA00006+8                                  1348 05486000
         BR    @14                                                 1348 05487000
*              END;                                                1349 05488000
*                                                                  1349 05489000
*          /**********************************************************/ 05490000
*          /*                                                        */ 05491000
*          /*  GET THE DATA RECORD, USING GETPROC TO ASSEMBLE IT     */ 05492000
*          /*  IN THE BUFFER.                                        */ 05493000
*          /*                                                        */ 05494000
*          /**********************************************************/ 05495000
*                                                                  1350 05496000
*          CALL GETPROC(UCWORKAR,ASSRECLN);                        1350 05497000
@RF01344 LA    @04,UCWORKAR                                        1350 05498000
         ST    @04,@AL00001                                        1350 05499000
         L     @04,CONRCPTR                                        1350 05500000
         LA    @04,ASSRECLN(,@04)                                  1350 05501000
         ST    @04,@AL00001+4                                      1350 05502000
         LA    @01,@AL00001                                        1350 05503000
         BAL   @14,GETPROC                                         1350 05504000
*          RESPECIFY RTNREG RSTD;                                  1351 05505000
*          TESTRC = RTNREG;                                        1352 05506000
         STH   RTNREG,TESTRC                                       1352 05507000
*          RESPECIFY RTNREG UNRSTD;                                1353 05508000
*          IF TESTRC ^= 0                                          1354 05509000
*            THEN                                                  1354 05510000
         LH    @04,TESTRC                                          1354 05511000
         LTR   @04,@04                                             1354 05512000
         BZ    @RF01354                                            1354 05513000
*              RETURN CODE(LASTCC12);                              1355 05514000
*                                                                  1355 05515000
         LA    @15,12                                              1355 05516000
         L     @14,@SA00006                                        1355 05517000
         LM    @00,@12,@SA00006+8                                  1355 05518000
         BR    @14                                                 1355 05519000
*          DICTPTR = ADDR(VARDATA);                                1356 05520000
*                                                                  1356 05521000
@RF01354 L     @04,CONRCPTR                                        1356 05522000
         LA    @04,VARDATA(,@04)                                   1356 05523000
         ST    @04,DICTPTR                                         1356 05524000
*          /**********************************************************/ 05525000
*          /*                                                        */ 05526000
*          /*  CALL NFVTPROC TO BUILD THE FVT TO BE USED TO DEFINE   */ 05527000
*          /*  THE USERCATALOG POINTER.                              */ 05528000
*          /*                                                        */ 05529000
*          /**********************************************************/ 05530000
*                                                                  1357 05531000
*          CALL NFVTPROC(DICTPTR,UCWORKAR,UCFVTPTR,NULLPARM);      1357 05532000
*                                                                  1357 05533000
         LA    @04,DICTPTR                                         1357 05534000
         ST    @04,@AL00001                                        1357 05535000
         LA    @04,UCWORKAR                                        1357 05536000
         ST    @04,@AL00001+4                                      1357 05537000
         LA    @04,UCFVTPTR                                        1357 05538000
         ST    @04,@AL00001+8                                      1357 05539000
         LA    @04,NULLPARM                                        1357 05540000
         ST    @04,@AL00001+12                                     1357 05541000
         LA    @01,@AL00001                                        1357 05542000
         BAL   @14,NFVTPROC                                        1357 05543000
*          /**********************************************************/ 05544000
*          /*                                                        */ 05545000
*          /*  TEST THE RETURN CODE, AND RETURN TO THE CALLING       */ 05546000
*          /*  PROCESSOR IF AN ERROR IS INDICATED.                   */ 05547000
*          /*                                                        */ 05548000
*          /**********************************************************/ 05549000
*                                                                  1358 05550000
*          RESPECIFY RTNREG RSTD;                                  1358 05551000
*          TESTRC = RTNREG;                                        1359 05552000
         STH   RTNREG,TESTRC                                       1359 05553000
*          RESPECIFY RTNREG UNRSTD;                                1360 05554000
*          IF TESTRC ^= 0                                          1361 05555000
*            THEN                                                  1361 05556000
         LH    @04,TESTRC                                          1361 05557000
         LTR   @04,@04                                             1361 05558000
         BZ    @RF01361                                            1361 05559000
*              RETURN CODE(LASTCC12);                              1362 05560000
*                                                                  1362 05561000
         LA    @15,12                                              1362 05562000
         L     @14,@SA00006                                        1362 05563000
         LM    @00,@12,@SA00006+8                                  1362 05564000
         BR    @14                                                 1362 05565000
*          /**********************************************************/ 05566000
*          /*                                                        */ 05567000
*          /*  SET CTGFVT TO POINT TO THE FVT CONSTRUCTED FOR THE    */ 05568000
*          /*  USERCATALOG CONNECT.  ALSO SET CTGFVPTR TO POINT      */ 05569000
*          /*  TO THE FVT.                                           */ 05570000
*          /*                                                        */ 05571000
*          /**********************************************************/ 05572000
*                                                                  1363 05573000
*          CTGFVT = UCFVTPTR;                                      1363 05574000
@RF01361 L     @04,UCFVTPTR                                        1363 05575000
         L     @15,CTGPLPTR                                        1363 05576000
         ST    @04,CTGFVT(,@15)                                    1363 05577000
*          CTGFVPTR = UCFVTPTR;                                    1364 05578000
*                                                                  1364 05579000
         ST    @04,CTGFVPTR                                        1364 05580000
*          /**********************************************************/ 05581000
*          /*                                                        */ 05582000
*          /*  SET CTGTYPE TO 'U' TO INDICATE A USERCATALOG CONNECT  */ 05583000
*          /*                                                        */ 05584000
*          /**********************************************************/ 05585000
*                                                                  1365 05586000
*          CTGTYPE = CTGTUCAT;                                     1365 05587000
*                                                                  1365 05588000
         MVI   CTGTYPE(@15),C'U'                                   1365 05589000
*          /**********************************************************/ 05590000
*          /*                                                        */ 05591000
*          /*  SET CTGFVTYP TO 'A' TO INDICATE A CONNECT, AND        */ 05592000
*          /*  PLACE A POINTER TO THE CPL TO THE FVT.                */ 05593000
*          /*                                                        */ 05594000
*          /**********************************************************/ 05595000
*                                                                  1366 05596000
*          CTGFVTYP = CTGTALIN;                                    1366 05597000
*                                                                  1366 05598000
         MVI   CTGFVTYP(@04),C'A'                                  1366 05599000
*          /**********************************************************/ 05600000
*          /*                                                        */ 05601000
*          /*  LOOK FOR DEVICETYPE AND VOLUMES INFORMATION FROM      */ 05602000
*          /*  THE OBJECTS PARAMETER.  SCAN THE OBJECTS LIST LOOKING */ 05603000
*          /*  FOR A MATCH.  WHEN FOUND,  CALL FOR THE APPROPRIATE   */ 05604000
*          /*  PROCESSING.                                           */ 05605000
*          /*                                                        */ 05606000
*          /**********************************************************/ 05607000
*                                                                  1367 05608000
*          IF ADDR(OBJTS) ^= NULLPTR                               1367 05609000
*            THEN                                                  1367 05610000
         L     @04,@PC00001+4                                      1367 05611000
         L     @04,FDTPTR+8(,@04)                                  1367 05612000
         LTR   @04,@04                                             1367 05613000
         BZ    @RF01367                                            1367 05614000
*UCOBNTLP:     DO IX = 1 TO OBJTSCNT;                              1368 05615000
*                                                                  1368 05616000
UCOBNTLP LA    @04,1                                               1368 05617000
         B     @DE01368                                            1368 05618000
@DL01368 DS    0H                                                  1369 05619000
*              /******************************************************/ 05620000
*              /*                                                    */ 05621000
*              /*  TEST FOR A MATCH BETWEEN OBJECT NAME, AND THE NAME*/ 05622000
*              /*  OF THE OBJECT BEING DEFINED.                      */ 05623000
*              /*                                                    */ 05624000
*              /******************************************************/ 05625000
*                                                                  1369 05626000
*                IF OBJNMPTR(IX)->OBJNMVAL(1:44) = FENTNAME(1:44)  1369 05627000
*                  THEN                                            1369 05628000
         SLA   @04,2                                               1369 05629000
         L     @15,@PC00001+4                                      1369 05630000
         L     @01,FDTPTR+12(,@15)                                 1369 05631000
         AL    @01,@CF01779                                        1369 05632000
         L     @04,OBJNMPTR(@04,@01)                               1369 05633000
         L     @01,CTGFVPTR                                        1369 05634000
         L     @01,CTGFVENT(,@01)                                  1369 05635000
         CLC   OBJNMVAL(44,@04),FENTNAME(@01)                      1369 05636000
         BNE   @RF01369                                            1369 05637000
*UCOBJMAT:           DO;                                           1370 05638000
UCOBJMAT DS    0H                                                  1371 05639000
*                    IMPF2OBJ = ON;                                1371 05640000
*                                                                  1371 05641000
         OI    IMPF2OBJ,B'00100000'                                1371 05642000
*                    /************************************************/ 05643000
*                    /*                                              */ 05644000
*                    /*  TEST FOR A VOLUMES LIST SPECIFICATION       */ 05645000
*                    /*                                              */ 05646000
*                    /************************************************/ 05647000
*                                                                  1372 05648000
*                    IF LISTVPTR(IX) ^= NULLPTR |                  1372 05649000
*                       DEVTPTR(IX) ^= NULLPTR                     1372 05650000
*                      THEN                                        1372 05651000
         SLR   @04,@04                                             1372 05652000
         L     @15,IX                                              1372 05653000
         SLA   @15,2                                               1372 05654000
         L     @14,@PC00001+4                                      1372 05655000
         L     @01,FDTPTR+24(,@14)                                 1372 05656000
         AL    @01,@CF01779                                        1372 05657000
         C     @04,LISTVPTR(@15,@01)                               1372 05658000
         BNE   @RT01372                                            1372 05659000
         L     @01,FDTPTR+32(,@14)                                 1372 05660000
         AL    @01,@CF01779                                        1372 05661000
         C     @04,DEVTPTR(@15,@01)                                1372 05662000
         BE    @RF01372                                            1372 05663000
@RT01372 DS    0H                                                  1373 05664000
*                        DO;                                       1373 05665000
*                                                                  1373 05666000
*                        /********************************************/ 05667000
*                        /*                                          */ 05668000
*                        /*  CALL LVLRPROC TO CONSTRUCT THE VOLUME   */ 05669000
*                        /*  SERIAL LIST.                            */ 05670000
*                        /*                                          */ 05671000
*                        /********************************************/ 05672000
*                                                                  1374 05673000
*                        CALL LVLRPROC(IX,NULLPARM,NULLPARM,UCFVTPTR,   05674000
*                           CTGTUCAT);                             1374 05675000
*                                                                  1374 05676000
         MVC   @AL00001+4(16),@AL01374                             1374 05677000
         LA    @04,IX                                              1374 05678000
         ST    @04,@AL00001                                        1374 05679000
         LA    @04,UCFVTPTR                                        1374 05680000
         ST    @04,@AL00001+12                                     1374 05681000
         LA    @01,@AL00001                                        1374 05682000
         BAL   @14,LVLRPROC                                        1374 05683000
*                        RESPECIFY RTNREG RSTD;                    1375 05684000
*                        TESTRC = RTNREG;                          1376 05685000
         STH   RTNREG,TESTRC                                       1376 05686000
*                        RESPECIFY RTNREG UNRSTD;                  1377 05687000
*                        IF TESTRC ^= 0                            1378 05688000
*                          THEN                                    1378 05689000
         LH    @04,TESTRC                                          1378 05690000
         LTR   @04,@04                                             1378 05691000
         BZ    @RF01378                                            1378 05692000
*                            RETURN CODE(LASTCC12);                1379 05693000
         LA    @15,12                                              1379 05694000
         L     @14,@SA00006                                        1379 05695000
         LM    @00,@12,@SA00006+8                                  1379 05696000
         BR    @14                                                 1379 05697000
*                        END;                                      1380 05698000
*                                                                  1380 05699000
@RF01378 DS    0H                                                  1381 05700000
*                    END UCOBJMAT;                                 1381 05701000
@RF01372 DS    0H                                                  1382 05702000
*          END UCOBNTLP;                                           1382 05703000
*                                                                  1382 05704000
@RF01369 LA    @04,1                                               1382 05705000
         AL    @04,IX                                              1382 05706000
@DE01368 ST    @04,IX                                              1382 05707000
         L     @15,@PC00001+4                                      1382 05708000
         LA    @15,FDTPTR+8(,@15)                                  1382 05709000
         C     @04,OBJTSCNT(,@15)                                  1382 05710000
         BNH   @DL01368                                            1382 05711000
*          /**********************************************************/ 05712000
*          /*                                                        */ 05713000
*          /*  SAVE THE CPL, FVT, AND THE FPL'S PRIOR TO INVOKING    */ 05714000
*          /*  CATALOG MANAGEMENT.  IF THE USERCATALOG NAME IS A     */ 05715000
*          /*  DUPLICATE, IT IS DELETED, AND REDEFINED INTO THE      */ 05716000
*          /*  CATALOG.                                              */ 05717000
*          /*                                                        */ 05718000
*          /**********************************************************/ 05719000
*                                                                  1383 05720000
*          TFVTLEN = LENGTH(CTGFV) + (LENGTH(CTGFL)+8)*NVNUMFLD +  1383 05721000
*             LENGTH(IDAAMDSB);                                    1383 05722000
@RF01367 LA    @04,380                                             1383 05723000
         STH   @04,TFVTLEN                                         1383 05724000
*          SAVCPL = UCPTRCPL -> FIELDR(1:LENGTH(CTGPL)+16);        1384 05725000
*                                                                  1384 05726000
         L     @01,UCPTRCPL                                        1384 05727000
         MVC   SAVCPL(44),FIELDR(@01)                              1384 05728000
*          /**********************************************************/ 05729000
*          /*                                                        */ 05730000
*          /*  POINT TO THE SAVE AREA FOR THE FVT, WHICH FOLLOWS     */ 05731000
*          /*  THE AREA FOR THE FVT ITSELF.  THIS LOCATION IN CORE   */ 05732000
*          /*  HOLDS THE FVT, THE FPL'S, AND THE AMDSB.              */ 05733000
*          /*                                                        */ 05734000
*          /**********************************************************/ 05735000
*                                                                  1385 05736000
*          UCSAVFVT = UCFVTPTR + TFVTLEN;                          1385 05737000
*                                                                  1385 05738000
         AL    @04,UCFVTPTR                                        1385 05739000
         ST    @04,UCSAVFVT                                        1385 05740000
*          CALL MVDAPROC(TFVTLEN,UCFVTPTR,UCSAVFVT);               1386 05741000
*                                                                  1386 05742000
         LA    @04,TFVTLEN                                         1386 05743000
         ST    @04,@AL00001                                        1386 05744000
         LA    @04,UCFVTPTR                                        1386 05745000
         ST    @04,@AL00001+4                                      1386 05746000
         LA    @04,UCSAVFVT                                        1386 05747000
         ST    @04,@AL00001+8                                      1386 05748000
         LA    @01,@AL00001                                        1386 05749000
         BAL   @14,MVDAPROC                                        1386 05750000
*          /**********************************************************/ 05751000
*          /*                                                        */ 05752000
*          /*  CALL CTLGPROC TO ACTUALLY INVOKE VSAM CATALOG         */ 05753000
*          /*  MANAGEMENT TO DO THE DEFINE OF THE USERCATALOG        */ 05754000
*          /*  SET IMPF2NER TO BE ON TO INDICATE THAT THE PRINTING   */ 05755000
*          /*  ERROR MESSAGES IS TO BE SUPPRESSED.                   */ 05756000
*          /*                                                        */ 05757000
*          /**********************************************************/ 05758000
*                                                                  1387 05759000
*          IMPF2NER = ON;                                          1387 05760000
         OI    IMPF2NER,B'00001000'                                1387 05761000
*          CALL CTLGPROC(UCPTRCPL);                                1388 05762000
         LA    @04,UCPTRCPL                                        1388 05763000
         ST    @04,@AL00001                                        1388 05764000
         LA    @01,@AL00001                                        1388 05765000
         BAL   @14,CTLGPROC                                        1388 05766000
*          RESPECIFY RTNREG RSTD;                                  1389 05767000
*          TESTRC = RTNREG;                                        1390 05768000
         STH   RTNREG,TESTRC                                       1390 05769000
*          RESPECIFY RTNREG UNRSTD;                                1391 05770000
*                                                                  1391 05771000
*          /**********************************************************/ 05772000
*          /*                                                        */ 05773000
*          /*  RESET IMPF2NER TO BE OFF TO INDICATE THAT ERROR       */ 05774000
*          /*  MESSAGES ARE TO BE PRINTED.                           */ 05775000
*          /*                                                        */ 05776000
*          /**********************************************************/ 05777000
*                                                                  1392 05778000
*          IMPF2NER = OFF;                                         1392 05779000
*                                                                  1392 05780000
         NI    IMPF2NER,B'11110111'                                1392 05781000
*          /**********************************************************/ 05782000
*          /*                                                        */ 05783000
*          /*  A NON-ZERO RETURN CODE INDICATES THAT CATALOG WAS NOT */ 05784000
*          /*  ABLE TO DEFINE THE USER CATALOG POINTER.              */ 05785000
*          /*                                                        */ 05786000
*          /**********************************************************/ 05787000
*                                                                  1393 05788000
*          IF TESTRC ^= 0                                          1393 05789000
*            THEN                                                  1393 05790000
*                                                                  1393 05791000
         LH    @04,TESTRC                                          1393 05792000
         LTR   @04,@04                                             1393 05793000
         BZ    @RF01393                                            1393 05794000
*              /******************************************************/ 05795000
*              /*                                                    */ 05796000
*              /*  TEST FOR A VSAM CATALOG RETURN CODE OF 8.  THIS   */ 05797000
*              /*  INDICATES THAT THERE IS A DUPLICATE NAME IN THE   */ 05798000
*              /*  IN THE CATALOG.                                   */ 05799000
*              /*                                                    */ 05800000
*              /******************************************************/ 05801000
*                                                                  1394 05802000
*              IF CATLGRC ^= DUPNAME                               1394 05803000
*                THEN                                              1394 05804000
         CLC   CATLGRC(2),@CH00039                                 1394 05805000
         BE    @RF01394                                            1394 05806000
*                  DO;                                             1395 05807000
*                  DARGSMOD = IMPMSG;                              1396 05808000
         L     @04,DDSTRU                                          1396 05809000
         MVC   DARGSMOD(3,@04),@CC00945                            1396 05810000
*                  DARGSENT = MPRAFAIL;                            1397 05811000
         MVI   DARGSENT(@04),X'15'                                 1397 05812000
*                  DARGILP = LENGTH(FENTNAME);                     1398 05813000
         MVC   DARGILP(2,@04),@CH00605                             1398 05814000
*                  DARGDBP = UCFVTPTR -> CTGFVENT;                 1399 05815000
*                                                                  1399 05816000
         L     @01,UCFVTPTR                                        1399 05817000
         L     @15,CTGFVENT(,@01)                                  1399 05818000
         ST    @15,DARGDBP(,@04)                                   1399 05819000
*                  CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);           1400 05820000
         L     @04,@PC00001                                        1400 05821000
         ST    @04,@AL00001                                        1400 05822000
         LA    @15,@CF00119                                        1400 05823000
         ST    @15,@AL00001+4                                      1400 05824000
         LA    @15,DDSTRU                                          1400 05825000
         ST    @15,@AL00001+8                                      1400 05826000
         MVI   @AL00001+8,X'80'                                    1400 05827000
         L     @15,GDTPRT(,@04)                                    1400 05828000
         LA    @01,@AL00001                                        1400 05829000
         BALR  @14,@15                                             1400 05830000
*                  DARGLIST = ''B;                                 1401 05831000
         L     @04,DDSTRU                                          1401 05832000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1401 05833000
*                  DARGSMOD = IMPMSG;                              1402 05834000
*                                                                  1402 05835000
         MVC   DARGSMOD(3,@04),@CC00945                            1402 05836000
*                  RETURN CODE(LASTCC08);                          1403 05837000
         LA    @15,8                                               1403 05838000
         L     @14,@SA00006                                        1403 05839000
         LM    @00,@12,@SA00006+8                                  1403 05840000
         BR    @14                                                 1403 05841000
*                  END;                                            1404 05842000
*                ELSE                                              1405 05843000
*DUPUC:            DO;                                             1405 05844000
@RF01394 DS    0H                                                  1405 05845000
DUPUC    DS    0H                                                  1406 05846000
*                  OLDERID2 = NEWERID2;                            1406 05847000
         L     @04,@PC00001                                        1406 05848000
         L     @04,GDTTR2(,@04)                                    1406 05849000
         MVC   @TS00001(95),NEWERID2(@04)                          1406 05850000
         MVC   OLDERID2(95,@04),@TS00001                           1406 05851000
*                  NEWID2 = 'RMDU';                                1407 05852000
*                                                                  1407 05853000
         MVC   NEWID2(4,@04),@CC01419                              1407 05854000
*                  /**************************************************/ 05855000
*                  /*                                                */ 05856000
*                  /*  AN ENTRY FOR THE OBJECT TO BE DEFINED ALREADY */ 05857000
*                  /*  EXISTS IN THE CATALOG.  CALL CPLPROC TO BUILD */ 05858000
*                  /*  A CPL FOR THE DELETE FUNCTION.                */ 05859000
*                  /*                                                */ 05860000
*                  /**************************************************/ 05861000
*                                                                  1408 05862000
*                  CALL CPLPROC('D',DCPLPTR,CTGFVENT,NULLPARM,CPSWD);   05863000
*                                                                  1408 05864000
         LA    @04,@CC00751                                        1408 05865000
         ST    @04,@AL00001                                        1408 05866000
         LA    @04,DCPLPTR                                         1408 05867000
         ST    @04,@AL00001+4                                      1408 05868000
         L     @04,CTGFVPTR                                        1408 05869000
         LA    @04,CTGFVENT(,@04)                                  1408 05870000
         ST    @04,@AL00001+8                                      1408 05871000
         LA    @04,NULLPARM                                        1408 05872000
         ST    @04,@AL00001+12                                     1408 05873000
         LA    @04,CPSWD                                           1408 05874000
         ST    @04,@AL00001+16                                     1408 05875000
         LA    @01,@AL00001                                        1408 05876000
         BAL   @14,CPLPROC                                         1408 05877000
*                  /**************************************************/ 05878000
*                  /*                                                */ 05879000
*                  /*  TEST THE RETURN CODE FROM CPLPROC.  IF THE CPL*/ 05880000
*                  /*  WAS NOT BUILT RETURN TO THE CALLING PROCESSOR.*/ 05881000
*                  /*                                                */ 05882000
*                  /**************************************************/ 05883000
*                                                                  1409 05884000
*                  RESPECIFY RTNREG RSTD;                          1409 05885000
*                  TESTRC = RTNREG;                                1410 05886000
         STH   RTNREG,TESTRC                                       1410 05887000
*                  RESPECIFY RTNREG UNRSTD;                        1411 05888000
*                  IF TESTRC ^= 0                                  1412 05889000
*                    THEN                                          1412 05890000
         LH    @04,TESTRC                                          1412 05891000
         LTR   @04,@04                                             1412 05892000
         BZ    @RF01412                                            1412 05893000
*                      RETURN CODE(LASTCC12);                      1413 05894000
*                                                                  1413 05895000
         LA    @15,12                                              1413 05896000
         L     @14,@SA00006                                        1413 05897000
         LM    @00,@12,@SA00006+8                                  1413 05898000
         BR    @14                                                 1413 05899000
*                  /**************************************************/ 05900000
*                  /*                                                */ 05901000
*                  /*  SET THE CTGTYPE FIELD OF THE CPL.             */ 05902000
*                  /*                                                */ 05903000
*                  /**************************************************/ 05904000
*                                                                  1414 05905000
*                  DCPLPTR -> CTGTYPE = UCPTRCPL -> CTGTYPE;       1414 05906000
*                                                                  1414 05907000
@RF01412 L     @04,DCPLPTR                                         1414 05908000
         L     @01,UCPTRCPL                                        1414 05909000
         MVC   CTGTYPE(1,@04),CTGTYPE(@01)                         1414 05910000
*                  /**************************************************/ 05911000
*                  /*                                                */ 05912000
*                  /*  SET CTGDISC TO ON TO INDICATE THAT THE        */ 05913000
*                  /*  USER CATALOG IS TO BE DISCONNECTED.           */ 05914000
*                  /*                                                */ 05915000
*                  /**************************************************/ 05916000
*                                                                  1415 05917000
*                  DCPLPTR -> CTGDISC = ON;                        1415 05918000
*                                                                  1415 05919000
         OI    CTGDISC(@04),B'00001000'                            1415 05920000
*                  /**************************************************/ 05921000
*                  /*                                                */ 05922000
*                  /*  CALL DELTPROC TO DELETE THE USERCATALOG       */ 05923000
*                  /*  POINTER AND ITS ALIASES.                      */ 05924000
*                  /*                                                */ 05925000
*                  /**************************************************/ 05926000
*                                                                  1416 05927000
*                  CALL DELTPROC(DCPLPTR);                         1416 05928000
*                                                                  1416 05929000
         LA    @04,DCPLPTR                                         1416 05930000
         ST    @04,@AL00001                                        1416 05931000
         LA    @01,@AL00001                                        1416 05932000
         BAL   @14,DELTPROC                                        1416 05933000
*                  /**************************************************/ 05934000
*                  /*                                                */ 05935000
*                  /*  TEST THE RETURN CODE FROM DELTPROC.  IF IT IS */ 05936000
*                  /*  NON-ZERO, RETURN TO THE CALLING PROCESSOR WITH*/ 05937000
*                  /*  AN ERROR INDICATION.  OTHERWISE, RESET THE    */ 05938000
*                  /*  VALUE OF DEFSTID TO NORMSTAT TO INDICATE THAT */ 05939000
*                  /*  THE ERROR INCURRED ON THE FIRST CMS DEFINE    */ 05940000
*                  /*  HAS BEEN CLEARED.                             */ 05941000
*                  /*                                                */ 05942000
*                  /**************************************************/ 05943000
*                                                                  1417 05944000
*                  RESPECIFY RTNREG RSTD;                          1417 05945000
*                  TESTRC = RTNREG;                                1418 05946000
         STH   RTNREG,TESTRC                                       1418 05947000
*                  RESPECIFY RTNREG UNRSTD;                        1419 05948000
*                  IF TESTRC ^= 0                                  1420 05949000
*                    THEN                                          1420 05950000
         LH    @04,TESTRC                                          1420 05951000
         LTR   @04,@04                                             1420 05952000
         BZ    @RF01420                                            1420 05953000
*                      DO;                                         1421 05954000
*                      DARGSMOD = IMPMSG;                          1422 05955000
         L     @04,DDSTRU                                          1422 05956000
         MVC   DARGSMOD(3,@04),@CC00945                            1422 05957000
*                      DARGSENT = MPRAFAIL;                        1423 05958000
         MVI   DARGSENT(@04),X'15'                                 1423 05959000
*                      DARGILP = LENGTH(FENTNAME);                 1424 05960000
         MVC   DARGILP(2,@04),@CH00605                             1424 05961000
*                      DARGDBP = UCFVTPTR -> CTGFVENT;             1425 05962000
*                                                                  1425 05963000
         L     @01,UCFVTPTR                                        1425 05964000
         L     @15,CTGFVENT(,@01)                                  1425 05965000
         ST    @15,DARGDBP(,@04)                                   1425 05966000
*                      CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       1426 05967000
         L     @04,@PC00001                                        1426 05968000
         ST    @04,@AL00001                                        1426 05969000
         LA    @15,@CF00119                                        1426 05970000
         ST    @15,@AL00001+4                                      1426 05971000
         LA    @15,DDSTRU                                          1426 05972000
         ST    @15,@AL00001+8                                      1426 05973000
         MVI   @AL00001+8,X'80'                                    1426 05974000
         L     @15,GDTPRT(,@04)                                    1426 05975000
         LA    @01,@AL00001                                        1426 05976000
         BALR  @14,@15                                             1426 05977000
*                      DARGLIST = ''B;                             1427 05978000
         L     @04,DDSTRU                                          1427 05979000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1427 05980000
*                      DARGSMOD = IMPMSG;                          1428 05981000
*                                                                  1428 05982000
         MVC   DARGSMOD(3,@04),@CC00945                            1428 05983000
*                      RETURN CODE(LASTCC08);                      1429 05984000
         LA    @15,8                                               1429 05985000
         L     @14,@SA00006                                        1429 05986000
         LM    @00,@12,@SA00006+8                                  1429 05987000
         BR    @14                                                 1429 05988000
*                      END;                                        1430 05989000
*                                                                  1430 05990000
*                  DEFSTID = NORMSTAT;                             1431 05991000
*                                                                  1431 05992000
@RF01420 MVI   DEFSTID,X'00'                                       1431 05993000
*                  /**************************************************/ 05994000
*                  /*                                                */ 05995000
*                  /*  PRINT A MESSAGE FOR THE USER INDICATING THAT  */ 05996000
*                  /*  A USER CATALOG HAS BEEN DISCONNECTED.         */ 05997000
*                  /*                                                */ 05998000
*                  /**************************************************/ 05999000
*                                                                  1432 06000000
*                  DARGSMOD = IMPMSG;                              1432 06001000
         L     @04,DDSTRU                                          1432 06002000
         MVC   DARGSMOD(3,@04),@CC00945                            1432 06003000
*                  DARGSENT = CATDISC;                             1433 06004000
         MVI   DARGSENT(@04),X'16'                                 1433 06005000
*                  DARGILP = LENGTH(FENTNAME);                     1434 06006000
         MVC   DARGILP(2,@04),@CH00605                             1434 06007000
*                  DARGDBP = UCFVTPTR -> CTGFVENT;                 1435 06008000
*                                                                  1435 06009000
         L     @01,UCFVTPTR                                        1435 06010000
         L     @15,CTGFVENT(,@01)                                  1435 06011000
         ST    @15,DARGDBP(,@04)                                   1435 06012000
*                  CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);           1436 06013000
*                                                                  1436 06014000
         L     @04,@PC00001                                        1436 06015000
         ST    @04,@AL00001                                        1436 06016000
         LA    @15,@CF00119                                        1436 06017000
         ST    @15,@AL00001+4                                      1436 06018000
         LA    @15,DDSTRU                                          1436 06019000
         ST    @15,@AL00001+8                                      1436 06020000
         MVI   @AL00001+8,X'80'                                    1436 06021000
         L     @15,GDTPRT(,@04)                                    1436 06022000
         LA    @01,@AL00001                                        1436 06023000
         BALR  @14,@15                                             1436 06024000
*                  DARGLIST = ''B;                                 1437 06025000
*                                                                  1437 06026000
         L     @04,DDSTRU                                          1437 06027000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1437 06028000
*                  /**************************************************/ 06029000
*                  /*                                                */ 06030000
*                  /*  RESTORE THE CATALOG PARAMETER LISTS TO THEIR  */ 06031000
*                  /*  STATE PRIOR TO THE FIRST CMS DEFINE OPERATION.*/ 06032000
*                  /*                                                */ 06033000
*                  /**************************************************/ 06034000
*                                                                  1438 06035000
*                  UCPTRCPL->FIELDR(1:LENGTH(CTGPL)+16) = SAVCPL;  1438 06036000
         L     @04,UCPTRCPL                                        1438 06037000
         MVC   FIELDR(44,@04),SAVCPL                               1438 06038000
*                  CALL MVDAPROC(TFVTLEN,UCSAVFVT,UCFVTPTR);       1439 06039000
*                                                                  1439 06040000
         LA    @04,TFVTLEN                                         1439 06041000
         ST    @04,@AL00001                                        1439 06042000
         LA    @04,UCSAVFVT                                        1439 06043000
         ST    @04,@AL00001+4                                      1439 06044000
         LA    @04,UCFVTPTR                                        1439 06045000
         ST    @04,@AL00001+8                                      1439 06046000
         LA    @01,@AL00001                                        1439 06047000
         BAL   @14,MVDAPROC                                        1439 06048000
*                  /**************************************************/ 06049000
*                  /*                                                */ 06050000
*                  /*  RESTORE THE VOLUME LIST.                      */ 06051000
*                  /*                                                */ 06052000
*                  /**************************************************/ 06053000
*                                                                  1440 06054000
*                  DO J =1 TO (FLISTLN/LENGTH(FVOLSERL));          1440 06055000
         LA    @04,1                                               1440 06056000
         B     @DE01440                                            1440 06057000
@DL01440 DS    0H                                                  1441 06058000
*                    FVOLRTN(J) = 0;                               1441 06059000
         LR    @15,@04                                             1441 06060000
         SLA   @15,3                                               1441 06061000
         L     @01,CTGFVPTR                                        1441 06062000
         L     @01,CTGFVVLT(,@01)                                  1441 06063000
         ALR   @01,@15                                             1441 06064000
         AL    @01,@CF01786                                        1441 06065000
         SLR   @00,@00                                             1441 06066000
         STCM  @00,3,FVOLRTN-2(@01)                                1441 06067000
*                  END;                                            1442 06068000
*                                                                  1442 06069000
         AL    @04,@CF00221                                        1442 06070000
@DE01440 ST    @04,J                                               1442 06071000
         L     @01,CTGFVPTR                                        1442 06072000
         L     @01,CTGFVVLT(,@01)                                  1442 06073000
         LH    @00,FLISTLN(,@01)                                   1442 06074000
         SRDA  @00,32                                              1442 06075000
         D     @00,@CF00039                                        1442 06076000
         CR    @04,@01                                             1442 06077000
         BNH   @DL01440                                            1442 06078000
*                  /**************************************************/ 06079000
*                  /*                                                */ 06080000
*                  /*  POINT TO THE CPL, AND CALL CTLGPROC TO INVOKE */ 06081000
*                  /*  CATALOG MANAGEMENT.                           */ 06082000
*                  /*                                                */ 06083000
*                  /**************************************************/ 06084000
*                                                                  1443 06085000
*                  CALL CTLGPROC(UCPTRCPL);                        1443 06086000
*                                                                  1443 06087000
         LA    @04,UCPTRCPL                                        1443 06088000
         ST    @04,@AL00001                                        1443 06089000
         LA    @01,@AL00001                                        1443 06090000
         BAL   @14,CTLGPROC                                        1443 06091000
*                  /**************************************************/ 06092000
*                  /*                                                */ 06093000
*                  /*  TEST THE RETURN CODE FROM CTLGPROC.  IF IT IS */ 06094000
*                  /*  NON-ZERO, THE SECOND ATTEMPT TO DEFINE THE    */ 06095000
*                  /*  OBJECT HAS ALSO FAILED.  RETURN TO THE CALLING*/ 06096000
*                  /*  PROCESSOR WITH AN ERROR INDICATION.           */ 06097000
*                  /*                                                */ 06098000
*                  /**************************************************/ 06099000
*                                                                  1444 06100000
*                  RESPECIFY RTNREG RSTD;                          1444 06101000
*                  TESTRC = RTNREG;                                1445 06102000
         STH   RTNREG,TESTRC                                       1445 06103000
*                  RESPECIFY RTNREG UNRSTD;                        1446 06104000
*                  IF TESTRC ^= 0                                  1447 06105000
*                    THEN                                          1447 06106000
         LH    @04,TESTRC                                          1447 06107000
         LTR   @04,@04                                             1447 06108000
         BZ    @RF01447                                            1447 06109000
*                      DO;                                         1448 06110000
*                      DARGSMOD = IMPMSG;                          1449 06111000
         L     @04,DDSTRU                                          1449 06112000
         MVC   DARGSMOD(3,@04),@CC00945                            1449 06113000
*                      DARGSENT = MPRAFAIL;                        1450 06114000
         MVI   DARGSENT(@04),X'15'                                 1450 06115000
*                      DARGILP = LENGTH(FENTNAME);                 1451 06116000
         MVC   DARGILP(2,@04),@CH00605                             1451 06117000
*                      DARGDBP = UCFVTPTR -> CTGFVENT;             1452 06118000
*                                                                  1452 06119000
         L     @01,UCFVTPTR                                        1452 06120000
         L     @15,CTGFVENT(,@01)                                  1452 06121000
         ST    @15,DARGDBP(,@04)                                   1452 06122000
*                      CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       1453 06123000
         L     @04,@PC00001                                        1453 06124000
         ST    @04,@AL00001                                        1453 06125000
         LA    @15,@CF00119                                        1453 06126000
         ST    @15,@AL00001+4                                      1453 06127000
         LA    @15,DDSTRU                                          1453 06128000
         ST    @15,@AL00001+8                                      1453 06129000
         MVI   @AL00001+8,X'80'                                    1453 06130000
         L     @15,GDTPRT(,@04)                                    1453 06131000
         LA    @01,@AL00001                                        1453 06132000
         BALR  @14,@15                                             1453 06133000
*                      DARGLIST = ''B;                             1454 06134000
         L     @04,DDSTRU                                          1454 06135000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1454 06136000
*                      DARGSMOD = IMPMSG;                          1455 06137000
*                                                                  1455 06138000
         MVC   DARGSMOD(3,@04),@CC00945                            1455 06139000
*                      RETURN CODE(LASTCC08);                      1456 06140000
         LA    @15,8                                               1456 06141000
         L     @14,@SA00006                                        1456 06142000
         LM    @00,@12,@SA00006+8                                  1456 06143000
         BR    @14                                                 1456 06144000
*                      END;                                        1457 06145000
*                                                                  1457 06146000
*                  END DUPUC;                                      1458 06147000
*                                                                  1458 06148000
@RF01447 DS    0H                                                  1459 06149000
*        /************************************************************/ 06150000
*        /*                                                          */ 06151000
*        /*  SAVE THE NAME OF THE OBJECT JUST DEFINED FOR USE        */ 06152000
*        /*  IN DEFINING ALIASES.                                    */ 06153000
*        /*                                                          */ 06154000
*        /************************************************************/ 06155000
*                                                                  1459 06156000
*        SAVRELNM = UCFVTPTR->CTGFVENT->FENTNAME;                  1459 06157000
*                                                                  1459 06158000
@RF01393 L     @04,UCFVTPTR                                        1459 06159000
         L     @04,CTGFVENT(,@04)                                  1459 06160000
         MVC   SAVRELNM(44),FENTNAME(@04)                          1459 06161000
*        /************************************************************/ 06162000
*        /*                                                          */ 06163000
*        /*  PRINT A MESSAGE TO INDICATE WHAT HAS BEEN IMPORTED      */ 06164000
*        /*  SUCCESSFULLY.                                           */ 06165000
*        /*                                                          */ 06166000
*        /************************************************************/ 06167000
*                                                                  1460 06168000
*        DARGSMOD = IMPMSG;                                        1460 06169000
         L     @15,DDSTRU                                          1460 06170000
         MVC   DARGSMOD(3,@15),@CC00945                            1460 06171000
*        DARGSENT = MPRASUCC;                                      1461 06172000
         MVI   DARGSENT(@15),X'1A'                                 1461 06173000
*        DARGILP = LENGTH(FENTNAME);                               1462 06174000
         MVC   DARGILP(2,@15),@CH00605                             1462 06175000
*        DARGDBP = UCFVTPTR -> CTGFVENT;                           1463 06176000
         ST    @04,DARGDBP(,@15)                                   1463 06177000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                     1464 06178000
         L     @04,@PC00001                                        1464 06179000
         ST    @04,@AL00001                                        1464 06180000
         LA    @15,@CF00119                                        1464 06181000
         ST    @15,@AL00001+4                                      1464 06182000
         LA    @15,DDSTRU                                          1464 06183000
         ST    @15,@AL00001+8                                      1464 06184000
         MVI   @AL00001+8,X'80'                                    1464 06185000
         L     @15,GDTPRT(,@04)                                    1464 06186000
         LA    @01,@AL00001                                        1464 06187000
         BALR  @14,@15                                             1464 06188000
*        DARGLIST = ''B;                                           1465 06189000
         L     @04,DDSTRU                                          1465 06190000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1465 06191000
*        DARGSMOD = IMPMSG;                                        1466 06192000
*                                                                  1466 06193000
         MVC   DARGSMOD(3,@04),@CC00945                            1466 06194000
*        /************************************************************/ 06195000
*        /*                                                          */ 06196000
*        /*  FREE UP THE CORE GOTTEN FOR THE DATA RECORD BUFFER      */ 06197000
*        /*                                                          */ 06198000
*        /************************************************************/ 06199000
*                                                                  1467 06200000
*        CALL IDCSAFS0(GDTTBL,UCWORKAR);                           1467 06201000
*                                                                  1467 06202000
         L     @04,@PC00001                                        1467 06203000
         ST    @04,@AL00001                                        1467 06204000
         LA    @15,UCWORKAR                                        1467 06205000
         ST    @15,@AL00001+4                                      1467 06206000
         L     @15,GDTFSP(,@04)                                    1467 06207000
         LA    @01,@AL00001                                        1467 06208000
         BALR  @14,@15                                             1467 06209000
*        RESPECIFY RTNREG RSTD;                                    1468 06210000
*        TESTRC = RTNREG;                                          1469 06211000
         STH   RTNREG,TESTRC                                       1469 06212000
*        RESPECIFY RTNREG UNRSTD;                                  1470 06213000
*        IF TESTRC ^= 0                                            1471 06214000
*          THEN                                                    1471 06215000
         LH    @04,TESTRC                                          1471 06216000
         LTR   @04,@04                                             1471 06217000
         BZ    @RF01471                                            1471 06218000
*            RETURN CODE(LASTCC12);                                1472 06219000
*                                                                  1472 06220000
         LA    @15,12                                              1472 06221000
         L     @14,@SA00006                                        1472 06222000
         LM    @00,@12,@SA00006+8                                  1472 06223000
         BR    @14                                                 1472 06224000
*        /************************************************************/ 06225000
*        /*                                                          */ 06226000
*        /*  FREE UP THE CORE GOTTEN FOR THE FVT AND FPL'S FOR       */ 06227000
*        /*  THE USER CATALOG CONNECT.                               */ 06228000
*        /*                                                          */ 06229000
*        /************************************************************/ 06230000
*                                                                  1473 06231000
*        CALL IDCSAFS0(GDTTBL,UCFVTPTR);                           1473 06232000
*                                                                  1473 06233000
@RF01471 L     @04,@PC00001                                        1473 06234000
         ST    @04,@AL00001                                        1473 06235000
         LA    @15,UCFVTPTR                                        1473 06236000
         ST    @15,@AL00001+4                                      1473 06237000
         L     @15,GDTFSP(,@04)                                    1473 06238000
         LA    @01,@AL00001                                        1473 06239000
         BALR  @14,@15                                             1473 06240000
*        RESPECIFY RTNREG RSTD;                                    1474 06241000
*        TESTRC = RTNREG;                                          1475 06242000
         STH   RTNREG,TESTRC                                       1475 06243000
*        RESPECIFY RTNREG UNRSTD;                                  1476 06244000
*        IF TESTRC ^= 0                                            1477 06245000
*          THEN                                                    1477 06246000
         LH    @04,TESTRC                                          1477 06247000
         LTR   @04,@04                                             1477 06248000
         BZ    @RF01477                                            1477 06249000
*            RETURN CODE(LASTCC12);                                1478 06250000
*                                                                  1478 06251000
         LA    @15,12                                              1478 06252000
         L     @14,@SA00006                                        1478 06253000
         LM    @00,@12,@SA00006+8                                  1478 06254000
         BR    @14                                                 1478 06255000
*        /************************************************************/ 06256000
*        /*                                                          */ 06257000
*        /*  FREE UP THE CORE GOTTEN FOR THE CPL USED TO DEFINE      */ 06258000
*        /*  THE OBJECT.                                             */ 06259000
*        /*                                                          */ 06260000
*        /************************************************************/ 06261000
*                                                                  1479 06262000
*        CALL IDCSAFS0(GDTTBL,UCPTRCPL);                           1479 06263000
*                                                                  1479 06264000
@RF01477 L     @04,@PC00001                                        1479 06265000
         ST    @04,@AL00001                                        1479 06266000
         LA    @15,UCPTRCPL                                        1479 06267000
         ST    @15,@AL00001+4                                      1479 06268000
         L     @15,GDTFSP(,@04)                                    1479 06269000
         LA    @01,@AL00001                                        1479 06270000
         BALR  @14,@15                                             1479 06271000
*        RESPECIFY RTNREG RSTD;                                    1480 06272000
*        TESTRC = RTNREG;                                          1481 06273000
         STH   RTNREG,TESTRC                                       1481 06274000
*        RESPECIFY RTNREG UNRSTD;                                  1482 06275000
*        IF TESTRC ^= 0                                            1483 06276000
*          THEN                                                    1483 06277000
         LH    @04,TESTRC                                          1483 06278000
         LTR   @04,@04                                             1483 06279000
         BZ    @RF01483                                            1483 06280000
*            RETURN CODE(LASTCC12);                                1484 06281000
         LA    @15,12                                              1484 06282000
         L     @14,@SA00006                                        1484 06283000
         LM    @00,@12,@SA00006+8                                  1484 06284000
         BR    @14                                                 1484 06285000
*          /**********************************************************/ 06286000
*          /*                                                        */ 06287000
*          /*  THE ALIASES OF THE USERCATALOG POINTER THAT WERE PUT  */ 06288000
*          /*  ON THE PORTABLE DATA SET BY EXPORTRA MUST NOW BE      */ 06289000
*          /*  DEFINED IN THE CATALOG (IN VS2) OR HANDLED AS         */ 06290000
*          /*  AS UNDEFINABLE (IN DOS OR VS1).  TO DO THIS, WE LOOP  */ 06291000
*          /*  UNTIL A SOFTWARE END OF FILE IS FOUND, DEFINING       */ 06292000
*          /*  ALIASES OR PRINTING ERROR MESSAGES.                   */ 06293000
*          /*                                                        */ 06294000
*          /**********************************************************/ 06295000
*                                                                  1485 06296000
*          /**********************************************************/ 06297000
*          /*                                                        */ 06298000
*          /*  SET GETEOF TO OFF TO INDICATE THAT THE END OF FILE    */ 06299000
*          /*  HAS NOT BEEN FOUND.                                   */ 06300000
*          /*                                                        */ 06301000
*          /**********************************************************/ 06302000
*                                                                  1485 06303000
*          GETEOF = OFF;                                           1485 06304000
*                                                                  1485 06305000
@RF01483 NI    GETEOF,B'01111111'                                  1485 06306000
*          /**********************************************************/ 06307000
*          /*                                                        */ 06308000
*          /*  LOOP UNTIL AN END OF FILE IS FOUND,                   */ 06309000
*          /*  CALLING ALISPROC.                                     */ 06310000
*          /*                                                        */ 06311000
*          /**********************************************************/ 06312000
*                                                                  1486 06313000
*          DO WHILE GETEOF = OFF;                                  1486 06314000
*                                                                  1486 06315000
         B     @DE01486                                            1486 06316000
@DL01486 DS    0H                                                  1487 06317000
*            CALL ALISPROC(ADDR(SAVRELNM));                        1487 06318000
         LA    @04,SAVRELNM                                        1487 06319000
         ST    @04,@AFTEMPS+4                                      1487 06320000
         LA    @04,@AFTEMPS+4                                      1487 06321000
         ST    @04,@AL00001                                        1487 06322000
         LA    @01,@AL00001                                        1487 06323000
         BAL   @14,ALISPROC                                        1487 06324000
*            RESPECIFY RTNREG RSTD;                                1488 06325000
*            TESTRC = RTNREG;                                      1489 06326000
         STH   RTNREG,TESTRC                                       1489 06327000
*            RESPECIFY RTNREG UNRSTD;                              1490 06328000
*                                                                  1490 06329000
*            /****************************************************/     06330000
*            /*                                                  */     06331000
*            /*  IF THE RETURN CODE INDICATES A SEVERE ERROR     */     06332000
*            /*  PASS THAT BACK TO THE CALLING PROCESSOR.        */     06333000
*            /*  OTHERWISE, CONTINUE WITH A VALUE OF 8 IN SETRC. */     06334000
*            /*                                                  */     06335000
*            /****************************************************/     06336000
*                                                                  1491 06337000
*            IF TESTRC = LASTCC12                                  1491 06338000
*              THEN                                                1491 06339000
         LH    @04,TESTRC                                          1491 06340000
         LA    @15,12                                              1491 06341000
         CR    @04,@15                                             1491 06342000
         BNE   @RF01491                                            1491 06343000
*                RETURN CODE(LASTCC12);                            1492 06344000
         L     @14,@SA00006                                        1492 06345000
         LM    @00,@12,@SA00006+8                                  1492 06346000
         BR    @14                                                 1492 06347000
*              ELSE                                                1493 06348000
*                IF TESTRC ^= 0                                    1493 06349000
*                  THEN                                            1493 06350000
@RF01491 LH    @04,TESTRC                                          1493 06351000
         LTR   @04,@04                                             1493 06352000
         BZ    @RF01493                                            1493 06353000
*                    SETRC = LASTCC08;                             1494 06354000
         MVC   SETRC(2),@CH00039                                   1494 06355000
*          END;                                                    1495 06356000
*                                                                  1495 06357000
@RF01493 DS    0H                                                  1495 06358000
@DE01486 TM    GETEOF,B'10000000'                                  1495 06359000
         BZ    @DL01486                                            1495 06360000
*        /************************************************************/ 06361000
*        /*                                                          */ 06362000
*        /*  RETURN TO THE CALLING PROCESSOR WITH SUCCESS INDICATED  */ 06363000
*        /*                                                          */ 06364000
*        /************************************************************/ 06365000
*                                                                  1496 06366000
*        RETURN CODE(0);                                           1496 06367000
*                                                                  1496 06368000
*                                                                  1496 06369000
         SLR   @15,@15                                             1496 06370000
         L     @14,@SA00006                                        1496 06371000
         LM    @00,@12,@SA00006+8                                  1496 06372000
         BR    @14                                                 1496 06373000
*END UCATPROC;                                                     1497 06374000
*          /**********************************************************/ 06375000
*          /*                                                        */ 06376000
*          /*  PROCEDURE NAME - NVSMPROC                             */ 06377000
*          /*                                                        */ 06378000
*          /*  FUNCTION - READ CATALOG AND DATA RECORDS FROM THE     */ 06379000
*          /*  PORTABILITY VOLUME, AND PERFORM A DEFINE OF           */ 06380000
*          /*  OF A NONVSAM ENTRY AND ITS ASSOCIATED ALIASES         */ 06381000
*          /*                                                        */ 06382000
*          /*  INPUT - FUNCTION DEFINITION TABLE                     */ 06383000
*          /*                                                        */ 06384000
*          /*  OUTPUT - A RECREATED NONVSAM ENTRY AND ITS            */ 06385000
*          /*  ALIASES                                               */ 06386000
*          /*                                                        */ 06387000
*          /**********************************************************/ 06388000
*                                                                  1498 06389000
*NVSMPROC: PROCEDURE;                                              1498 06390000
*                                                                  1498 06391000
NVSMPROC STM   @14,@12,@SA00007                                    1498 06392000
*          OLDERID2 = NEWERID2;                                    1499 06393000
         L     @04,@PC00001                                        1499 06394000
         L     @04,GDTTR2(,@04)                                    1499 06395000
         MVC   @TS00001(95),NEWERID2(@04)                          1499 06396000
         MVC   OLDERID2(95,@04),@TS00001                           1499 06397000
*          NEWID2 = 'RMNV';                                        1500 06398000
*                                                                  1500 06399000
         MVC   NEWID2(4,@04),@CC01424                              1500 06400000
*          /**********************************************************/ 06401000
*          /*                                                        */ 06402000
*          /*  SET THE ADDRESS OF THE CONTROL RECORD BUFFER WHICH    */ 06403000
*          /*  WILL CONTAIN THE DICTIONARY FOR THE CATALOG RECORD    */ 06404000
*          /*                                                        */ 06405000
*          /**********************************************************/ 06406000
*                                                                  1501 06407000
*          CONRCPTR = ADDR(CONRCARE);                              1501 06408000
*                                                                  1501 06409000
         LA    @04,CONRCARE                                        1501 06410000
         ST    @04,CONRCPTR                                        1501 06411000
*          /**********************************************************/ 06412000
*          /*                                                        */ 06413000
*          /*  ZERO OUT THE AREA THAT HOLDS THE CONTROL RECORDS      */ 06414000
*          /*  BEGIN BY INITIALIZING THE VALUES OF ZSIZE, ZPTR,      */ 06415000
*          /*  AND ZCNTRL.                                           */ 06416000
*          /*                                                        */ 06417000
*          /**********************************************************/ 06418000
*                                                                  1502 06419000
*          ZSIZE = LENGTH(CONRCARE);                               1502 06420000
         MVC   ZSIZE(2),@CH00920                                   1502 06421000
*          ZPTR = CONRCPTR;                                        1503 06422000
         ST    @04,ZPTR                                            1503 06423000
*          ZCNTRL = ON;                                            1504 06424000
*                                                                  1504 06425000
         OI    ZCNTRL,B'10000000'                                  1504 06426000
*          /*********************************************************** 06427000
*          /*                                                         * 06428000
*          /*  LOOP CLEARING THE  AREA THAT IS TO HOLD THE CONTROL    * 06429000
*          /*  RECORD.                                                * 06430000
*          /*                                                         * 06431000
*          /*********************************************************** 06432000
*                                                                  1505 06433000
*          DO WHILE (ZCNTRL = ON);                                 1505 06434000
         B     @DE01505                                            1505 06435000
@DL01505 DS    0H                                                  1506 06436000
*            IF ZSIZE > 256                                        1506 06437000
*              THEN                                                1506 06438000
         LH    @04,ZSIZE                                           1506 06439000
         LA    @15,256                                             1506 06440000
         CR    @04,@15                                             1506 06441000
         BNH   @RF01506                                            1506 06442000
*                DO;                                               1507 06443000
*                ZAREA(1:256) = ZER(1:256);                        1508 06444000
         L     @14,ZPTR                                            1508 06445000
         MVC   ZAREA(256,@14),ZER                                  1508 06446000
*                ZSIZE = ZSIZE - 256;                              1509 06447000
         SLR   @04,@15                                             1509 06448000
         STH   @04,ZSIZE                                           1509 06449000
*                ZPTR = ZPTR + 256;                                1510 06450000
         ALR   @14,@15                                             1510 06451000
         ST    @14,ZPTR                                            1510 06452000
*                END;                                              1511 06453000
*              ELSE                                                1512 06454000
*                DO;                                               1512 06455000
         B     @RC01506                                            1512 06456000
@RF01506 DS    0H                                                  1513 06457000
*                ZAREA (1:ZSIZE) = ZER(1:ZSIZE);                   1513 06458000
         L     @04,ZPTR                                            1513 06459000
         LH    @15,ZSIZE                                           1513 06460000
         BCTR  @15,0                                               1513 06461000
         EX    @15,@SM01777                                        1513 06462000
*                ZCNTRL = OFF;                                     1514 06463000
         NI    ZCNTRL,B'01111111'                                  1514 06464000
*                END;                                              1515 06465000
*          END;                                                    1516 06466000
*                                                                  1516 06467000
@RC01506 DS    0H                                                  1516 06468000
@DE01505 TM    ZCNTRL,B'10000000'                                  1516 06469000
         BO    @DL01505                                            1516 06470000
*          /**********************************************************/ 06471000
*          /*                                                        */ 06472000
*          /*  CONSTRUCT THE CPL TO BE USED FOR THE DEFINE FUNCTION  */ 06473000
*          /*  IF THE CONSTRUCTION FAILS, RETURN TO THE CALLING      */ 06474000
*          /*  PROCESSOR WITH AN ERROR INDICATOR.                    */ 06475000
*          /*                                                        */ 06476000
*          /*                                                        */ 06477000
*          /**********************************************************/ 06478000
*                                                                  1517 06479000
*          CALL CPLPROC('F',NVPTRCPL,NULLPARM,NULLPARM,NULLPARM);  1517 06480000
*                                                                  1517 06481000
         MVC   @AL00001(20),@AL01517                               1517 06482000
         LA    @04,NVPTRCPL                                        1517 06483000
         ST    @04,@AL00001+4                                      1517 06484000
         LA    @01,@AL00001                                        1517 06485000
         BAL   @14,CPLPROC                                         1517 06486000
*          RESPECIFY RTNREG RSTD;                                  1518 06487000
*          TESTRC = RTNREG;                                        1519 06488000
         STH   RTNREG,TESTRC                                       1519 06489000
*          RESPECIFY RTNREG UNRSTD;                                1520 06490000
*          IF TESTRC ^= 0                                          1521 06491000
*            THEN                                                  1521 06492000
         LH    @04,TESTRC                                          1521 06493000
         LTR   @04,@04                                             1521 06494000
         BZ    @RF01521                                            1521 06495000
*              RETURN CODE(LASTCC12);                              1522 06496000
*                                                                  1522 06497000
         LA    @15,12                                              1522 06498000
         L     @14,@SA00007                                        1522 06499000
         LM    @00,@12,@SA00007+8                                  1522 06500000
         BR    @14                                                 1522 06501000
*          /**********************************************************/ 06502000
*          /*                                                        */ 06503000
*          /*  SET CTGPLPTR TO BE NVPTRCPL, SO THAT IT POINTS TO THE */ 06504000
*          /*  CPL BUILT FOR THE NONVSAM.                            */ 06505000
*          /*                                                        */ 06506000
*          /**********************************************************/ 06507000
*                                                                  1523 06508000
*          CTGPLPTR = NVPTRCPL;                                    1523 06509000
*                                                                  1523 06510000
@RF01521 L     @04,NVPTRCPL                                        1523 06511000
         ST    @04,CTGPLPTR                                        1523 06512000
*          /**********************************************************/ 06513000
*          /*                                                        */ 06514000
*          /*  TEST TO DETERMINE IF A CONTROL RECORD IS TO BE READ.  */ 06515000
*          /*                                                        */ 06516000
*          /**********************************************************/ 06517000
*                                                                  1524 06518000
*          IF NVSMRDSW = OFF                                       1524 06519000
*            THEN                                                  1524 06520000
         TM    NVSMRDSW,B'10000000'                                1524 06521000
         BNZ   @RF01524                                            1524 06522000
*CONTREAD:     DO;                                                 1525 06523000
*                                                                  1525 06524000
CONTREAD DS    0H                                                  1526 06525000
*              /******************************************************/ 06526000
*              /*                                                    */ 06527000
*              /*  GET THE CONTROL RECORD FROM THE PORTABLE          */ 06528000
*              /*  DATA SET.                                         */ 06529000
*              /*                                                    */ 06530000
*              /******************************************************/ 06531000
*                                                                  1526 06532000
*              CALL IDCIOGT0(GDTTBL,PINIOCS);                      1526 06533000
*                                                                  1526 06534000
         L     @04,@PC00001                                        1526 06535000
         ST    @04,@AL00001                                        1526 06536000
         LA    @15,PINIOCS                                         1526 06537000
         ST    @15,@AL00001+4                                      1526 06538000
         MVI   @AL00001+4,X'80'                                    1526 06539000
         L     @15,GDTGET(,@04)                                    1526 06540000
         LA    @01,@AL00001                                        1526 06541000
         BALR  @14,@15                                             1526 06542000
*              RESPECIFY RTNREG RSTD;                              1527 06543000
*              TESTRC = RTNREG;                                    1528 06544000
         STH   RTNREG,TESTRC                                       1528 06545000
*              RESPECIFY RTNREG UNRSTD;                            1529 06546000
*                                                                  1529 06547000
*              /******************************************************/ 06548000
*              /*                                                    */ 06549000
*              /*  TEST FOR A RETURN CODE THAT INDICATES THAT WE     */ 06550000
*              /*  HAVE FOUND AN END OF FILE.  IF UGET GIVES US THIS */ 06551000
*              /*  RETURN CODE, RETURN TO THE CALLING PROCESSOR WITH */ 06552000
*              /*  SUCCESS INDICATED.  IF ANY OTHER NONZERO CODE IS  */ 06553000
*              /*  RETURNED, RETURN TO THE CALLER WITH A SEVERE ERROR*/ 06554000
*              /*  INDICATED.                                        */ 06555000
*              /*                                                    */ 06556000
*              /******************************************************/ 06557000
*                                                                  1530 06558000
*              IF TESTRC = 16                                      1530 06559000
*                THEN                                              1530 06560000
         LH    @04,TESTRC                                          1530 06561000
         C     @04,@CF00483                                        1530 06562000
         BNE   @RF01530                                            1530 06563000
*                  DO;                                             1531 06564000
*                                                                  1531 06565000
*                  /**************************************************/ 06566000
*                  /*                                                */ 06567000
*                  /*  SET GETEOF TO ON TO INDICATE TO THE CALLER    */ 06568000
*                  /*  THAT AN END OF FILE HAS BEEN FOUND.           */ 06569000
*                  /*                                                */ 06570000
*                  /**************************************************/ 06571000
*                                                                  1532 06572000
*                  GETEOF = ON;                                    1532 06573000
         OI    GETEOF,B'10000000'                                  1532 06574000
*                  RETURN CODE(0);                                 1533 06575000
         SLR   @15,@15                                             1533 06576000
         L     @14,@SA00007                                        1533 06577000
         LM    @00,@12,@SA00007+8                                  1533 06578000
         BR    @14                                                 1533 06579000
*                  END;                                            1534 06580000
*                ELSE                                              1535 06581000
*                  IF TESTRC ^= 0                                  1535 06582000
*                    THEN                                          1535 06583000
@RF01530 LH    @04,TESTRC                                          1535 06584000
         LTR   @04,@04                                             1535 06585000
         BZ    @RF01535                                            1535 06586000
*                      RETURN CODE(LASTCC12);                      1536 06587000
         LA    @15,12                                              1536 06588000
         L     @14,@SA00007                                        1536 06589000
         LM    @00,@12,@SA00007+8                                  1536 06590000
         BR    @14                                                 1536 06591000
*              END CONTREAD;                                       1537 06592000
*                                                                  1537 06593000
@RF01535 DS    0H                                                  1538 06594000
*          /**********************************************************/ 06595000
*          /*                                                        */ 06596000
*          /*  RESET NVSMRDSW TO BE OFF.                             */ 06597000
*          /*                                                        */ 06598000
*          /**********************************************************/ 06599000
*                                                                  1538 06600000
*          NVSMRDSW = OFF;                                         1538 06601000
*                                                                  1538 06602000
@RF01524 NI    NVSMRDSW,B'01111111'                                1538 06603000
*          /**********************************************************/ 06604000
*          /*                                                        */ 06605000
*          /*  MOVE THE CONTROL RECORD FROM THE I/O BUFFER INTO      */ 06606000
*          /*  THE AREA OF STORAGE THAT IS MAPPED BY THE CONTROL     */ 06607000
*          /*  RECORD OVERLAY.                                       */ 06608000
*          /*                                                        */ 06609000
*          /**********************************************************/ 06610000
*                                                                  1539 06611000
*          TFVTLEN = IOCDAD -> HEADLN;                             1539 06612000
         L     @04,IOCSPTR                                         1539 06613000
         L     @01,IOCDAD(,@04)                                    1539 06614000
         LH    @15,HEADLN(,@01)                                    1539 06615000
         STH   @15,TFVTLEN                                         1539 06616000
*          CALL MVDAPROC(TFVTLEN,IOCDAD,CONRCPTR);                 1540 06617000
*                                                                  1540 06618000
         LA    @15,TFVTLEN                                         1540 06619000
         ST    @15,@AL00001                                        1540 06620000
         ST    @04,@AL00001+4                                      1540 06621000
         LA    @04,CONRCPTR                                        1540 06622000
         ST    @04,@AL00001+8                                      1540 06623000
         LA    @01,@AL00001                                        1540 06624000
         BAL   @14,MVDAPROC                                        1540 06625000
*          /**********************************************************/ 06626000
*          /*                                                        */ 06627000
*          /*  TEST TO DETERMINE THAT WE GOT A CATALOG CONTROL RECORD*/ 06628000
*          /*  IF WE DID NOT, THEN RETURN TO THE CALLING PROCESSOOR  */ 06629000
*          /*  FOR THE PORTABLE DATA SET IS IN ERROR.                */ 06630000
*          /*                                                        */ 06631000
*          /**********************************************************/ 06632000
*                                                                  1541 06633000
*          IF HEADFLG1 ^= HDFL1CAT | HEADFLG2 ^= HDFL2NVS          1541 06634000
*            THEN                                                  1541 06635000
         L     @04,CONRCPTR                                        1541 06636000
         CLI   HEADFLG1(@04),X'FF'                                 1541 06637000
         BNE   @RT01541                                            1541 06638000
         CLI   HEADFLG2(@04),C'A'                                  1541 06639000
         BE    @RF01541                                            1541 06640000
@RT01541 DS    0H                                                  1542 06641000
*              DO;                                                 1542 06642000
*              DEFSTID = PORTERR;                                  1543 06643000
         MVI   DEFSTID,X'01'                                       1543 06644000
*              RETURN CODE(LASTCC12);                              1544 06645000
         LA    @15,12                                              1544 06646000
         L     @14,@SA00007                                        1544 06647000
         LM    @00,@12,@SA00007+8                                  1544 06648000
         BR    @14                                                 1544 06649000
*              END;                                                1545 06650000
*                                                                  1545 06651000
*          /**********************************************************/ 06652000
*          /*                                                        */ 06653000
*          /*  THE PORTABLE DATA SET IS ALL RIGHT SO FAR.  COMPUTE   */ 06654000
*          /*  THE AMOUNT OF SPACE NEEDED TO HOLD THE DATA RECORD    */ 06655000
*          /*  ASSOCIATED WITH THE PRESENT CONTROL RECORD.           */ 06656000
*          /*                                                        */ 06657000
*          /**********************************************************/ 06658000
*                                                                  1546 06659000
*          TOTLEN = ASSRECLN;                                      1546 06660000
*                                                                  1546 06661000
@RF01541 L     @04,CONRCPTR                                        1546 06662000
         LH    @04,ASSRECLN(,@04)                                  1546 06663000
         ST    @04,TOTLEN                                          1546 06664000
*          /**********************************************************/ 06665000
*          /*                                                        */ 06666000
*          /*  ISSUE A UGPOOL TO GET THE BUFFER FOR THE DATA RECORD. */ 06667000
*          /*  SHOULD THIS FAIL RETURN TO THE CALLING PROCESSOR WITH */ 06668000
*          /*  AN ERROR INDICATION.                                  */ 06669000
*          /*                                                        */ 06670000
*          /**********************************************************/ 06671000
*                                                                  1547 06672000
*          CALL IDCSAGP0(GDTTBL,TOTLEN,NVWORKAR,GPID,SETZERO);     1547 06673000
         L     @04,@PC00001                                        1547 06674000
         ST    @04,@AL00001                                        1547 06675000
         LA    @15,TOTLEN                                          1547 06676000
         ST    @15,@AL00001+4                                      1547 06677000
         LA    @15,NVWORKAR                                        1547 06678000
         ST    @15,@AL00001+8                                      1547 06679000
         LA    @15,GPID                                            1547 06680000
         ST    @15,@AL00001+12                                     1547 06681000
         LA    @15,SETZERO                                         1547 06682000
         ST    @15,@AL00001+16                                     1547 06683000
         MVI   @AL00001+16,X'80'                                   1547 06684000
         L     @15,GDTGPL(,@04)                                    1547 06685000
         LA    @01,@AL00001                                        1547 06686000
         BALR  @14,@15                                             1547 06687000
*          RESPECIFY RTNREG RSTD;                                  1548 06688000
*          TESTRC = RTNREG;                                        1549 06689000
         STH   RTNREG,TESTRC                                       1549 06690000
*          RESPECIFY RTNREG UNRSTD;                                1550 06691000
*          IF TESTRC ^= 0                                          1551 06692000
*            THEN                                                  1551 06693000
         LH    @04,TESTRC                                          1551 06694000
         LTR   @04,@04                                             1551 06695000
         BZ    @RF01551                                            1551 06696000
*              DO;                                                 1552 06697000
*              DEFSTID = NOSTORAG;                                 1553 06698000
         MVI   DEFSTID,X'04'                                       1553 06699000
*              DARGSMOD = UNIVMSG;                                 1554 06700000
         L     @04,DDSTRU                                          1554 06701000
         MVC   DARGSMOD(3,@04),@CC00981                            1554 06702000
*              RETURN CODE(LASTCC12);                              1555 06703000
         LA    @15,12                                              1555 06704000
         L     @14,@SA00007                                        1555 06705000
         LM    @00,@12,@SA00007+8                                  1555 06706000
         BR    @14                                                 1555 06707000
*              END;                                                1556 06708000
*                                                                  1556 06709000
*          /**********************************************************/ 06710000
*          /*                                                        */ 06711000
*          /*  GET THE DATA RECORD, USING GETPROC TO ASSEMBLE IT     */ 06712000
*          /*  IN THE BUFFER.                                        */ 06713000
*          /*                                                        */ 06714000
*          /**********************************************************/ 06715000
*                                                                  1557 06716000
*          CALL GETPROC(NVWORKAR,ASSRECLN);                        1557 06717000
@RF01551 LA    @04,NVWORKAR                                        1557 06718000
         ST    @04,@AL00001                                        1557 06719000
         L     @04,CONRCPTR                                        1557 06720000
         LA    @04,ASSRECLN(,@04)                                  1557 06721000
         ST    @04,@AL00001+4                                      1557 06722000
         LA    @01,@AL00001                                        1557 06723000
         BAL   @14,GETPROC                                         1557 06724000
*          RESPECIFY RTNREG RSTD;                                  1558 06725000
*          TESTRC = RTNREG;                                        1559 06726000
         STH   RTNREG,TESTRC                                       1559 06727000
*          RESPECIFY RTNREG UNRSTD;                                1560 06728000
*          IF TESTRC ^= 0                                          1561 06729000
*            THEN                                                  1561 06730000
         LH    @04,TESTRC                                          1561 06731000
         LTR   @04,@04                                             1561 06732000
         BZ    @RF01561                                            1561 06733000
*              RETURN CODE(LASTCC12);                              1562 06734000
*                                                                  1562 06735000
         LA    @15,12                                              1562 06736000
         L     @14,@SA00007                                        1562 06737000
         LM    @00,@12,@SA00007+8                                  1562 06738000
         BR    @14                                                 1562 06739000
*          DICTPTR = ADDR(VARDATA);                                1563 06740000
*                                                                  1563 06741000
@RF01561 L     @04,CONRCPTR                                        1563 06742000
         LA    @04,VARDATA(,@04)                                   1563 06743000
         ST    @04,DICTPTR                                         1563 06744000
*          /**********************************************************/ 06745000
*          /*                                                        */ 06746000
*          /*  CALL NFVTPROC TO BUILD THE FVT TO BE USED TO DEFINE   */ 06747000
*          /*  THE NONVSAM ENTRY.                                    */ 06748000
*          /*                                                        */ 06749000
*          /**********************************************************/ 06750000
*                                                                  1564 06751000
*          CALL NFVTPROC(DICTPTR,NVWORKAR,NVFVTPTR,NULLPARM);      1564 06752000
*                                                                  1564 06753000
         LA    @04,DICTPTR                                         1564 06754000
         ST    @04,@AL00001                                        1564 06755000
         LA    @04,NVWORKAR                                        1564 06756000
         ST    @04,@AL00001+4                                      1564 06757000
         LA    @04,NVFVTPTR                                        1564 06758000
         ST    @04,@AL00001+8                                      1564 06759000
         LA    @04,NULLPARM                                        1564 06760000
         ST    @04,@AL00001+12                                     1564 06761000
         LA    @01,@AL00001                                        1564 06762000
         BAL   @14,NFVTPROC                                        1564 06763000
*          /**********************************************************/ 06764000
*          /*                                                        */ 06765000
*          /*  TEST THE RETURN, AND RETURN TO THE CALLING            */ 06766000
*          /*  PROCESSOR IF AN ERROR IS INDICATED.                   */ 06767000
*          /*                                                        */ 06768000
*          /**********************************************************/ 06769000
*                                                                  1565 06770000
*          RESPECIFY RTNREG RSTD;                                  1565 06771000
*          TESTRC = RTNREG;                                        1566 06772000
         STH   RTNREG,TESTRC                                       1566 06773000
*          RESPECIFY RTNREG UNRSTD;                                1567 06774000
*          IF TESTRC ^= 0                                          1568 06775000
*            THEN                                                  1568 06776000
         LH    @04,TESTRC                                          1568 06777000
         LTR   @04,@04                                             1568 06778000
         BZ    @RF01568                                            1568 06779000
*              RETURN CODE(LASTCC12);                              1569 06780000
*                                                                  1569 06781000
         LA    @15,12                                              1569 06782000
         L     @14,@SA00007                                        1569 06783000
         LM    @00,@12,@SA00007+8                                  1569 06784000
         BR    @14                                                 1569 06785000
*          CTGFVT = NVFVTPTR;                                      1570 06786000
*                                                                  1570 06787000
@RF01568 L     @04,NVFVTPTR                                        1570 06788000
         L     @01,CTGPLPTR                                        1570 06789000
         ST    @04,CTGFVT(,@01)                                    1570 06790000
*          /**********************************************************/ 06791000
*          /*                                                        */ 06792000
*          /*  LOOK FOR DEVICETYPE AND VOLUMES INFORMATION FROM      */ 06793000
*          /*  THE OBJECTS PARAMETER.  SCAN THE OBJECTS LIST LOOKING */ 06794000
*          /*  FOR A MATCH.  WHEN FOUND,  CALL FOR THE APPROPRIATE   */ 06795000
*          /*  PROCESSING.                                           */ 06796000
*          /*                                                        */ 06797000
*          /**********************************************************/ 06798000
*                                                                  1571 06799000
*          IF ADDR(OBJTS) ^= NULLPTR                               1571 06800000
*            THEN                                                  1571 06801000
         L     @04,@PC00001+4                                      1571 06802000
         L     @04,FDTPTR+8(,@04)                                  1571 06803000
         LTR   @04,@04                                             1571 06804000
         BZ    @RF01571                                            1571 06805000
*NVOBNTLP:     DO IX = 1 TO OBJTSCNT;                              1572 06806000
*                                                                  1572 06807000
NVOBNTLP LA    @04,1                                               1572 06808000
         B     @DE01572                                            1572 06809000
@DL01572 DS    0H                                                  1573 06810000
*              /******************************************************/ 06811000
*              /*                                                    */ 06812000
*              /*  TEST FOR A MATCH BETWEEN OBJECT NAME, AND THE NAME*/ 06813000
*              /*  OF THE OBJECT BEING DEFINED.                      */ 06814000
*              /*                                                    */ 06815000
*              /******************************************************/ 06816000
*                                                                  1573 06817000
*                IF OBJNMPTR(IX)->OBJNMVAL(1:44) = FENTNAME(1:44)  1573 06818000
*                  THEN                                            1573 06819000
         SLA   @04,2                                               1573 06820000
         L     @15,@PC00001+4                                      1573 06821000
         L     @01,FDTPTR+12(,@15)                                 1573 06822000
         AL    @01,@CF01779                                        1573 06823000
         L     @04,OBJNMPTR(@04,@01)                               1573 06824000
         L     @01,CTGFVPTR                                        1573 06825000
         L     @01,CTGFVENT(,@01)                                  1573 06826000
         CLC   OBJNMVAL(44,@04),FENTNAME(@01)                      1573 06827000
         BNE   @RF01573                                            1573 06828000
*NVOBJMAT:           DO;                                           1574 06829000
NVOBJMAT DS    0H                                                  1575 06830000
*                    IMPF2OBJ = ON;                                1575 06831000
*                                                                  1575 06832000
         OI    IMPF2OBJ,B'00100000'                                1575 06833000
*                    /************************************************/ 06834000
*                    /*                                              */ 06835000
*                    /*  TEST FOR A VOLUMES LIST SPECIFICATION       */ 06836000
*                    /*                                              */ 06837000
*                    /************************************************/ 06838000
*                                                                  1576 06839000
*                    IF LISTVPTR(IX) ^= NULLPTR |                  1576 06840000
*                       DEVTPTR(IX) ^= NULLPTR                     1576 06841000
*                      THEN                                        1576 06842000
         SLR   @04,@04                                             1576 06843000
         L     @15,IX                                              1576 06844000
         SLA   @15,2                                               1576 06845000
         L     @14,@PC00001+4                                      1576 06846000
         L     @01,FDTPTR+24(,@14)                                 1576 06847000
         AL    @01,@CF01779                                        1576 06848000
         C     @04,LISTVPTR(@15,@01)                               1576 06849000
         BNE   @RT01576                                            1576 06850000
         L     @01,FDTPTR+32(,@14)                                 1576 06851000
         AL    @01,@CF01779                                        1576 06852000
         C     @04,DEVTPTR(@15,@01)                                1576 06853000
         BE    @RF01576                                            1576 06854000
@RT01576 DS    0H                                                  1577 06855000
*                        DO;                                       1577 06856000
*                                                                  1577 06857000
*                        /********************************************/ 06858000
*                        /*                                          */ 06859000
*                        /*  CALL LVLRPROC TO CONSTRUCT THE VOLUME   */ 06860000
*                        /*  SERIAL LIST.                            */ 06861000
*                        /*                                          */ 06862000
*                        /********************************************/ 06863000
*                                                                  1578 06864000
*                        CALL LVLRPROC(IX,NULLPARM,NULLPARM,NVFVTPTR,   06865000
*                           CTGTALIN);                             1578 06866000
*                                                                  1578 06867000
         MVC   @AL00001+4(16),@AL01578                             1578 06868000
         LA    @04,IX                                              1578 06869000
         ST    @04,@AL00001                                        1578 06870000
         LA    @04,NVFVTPTR                                        1578 06871000
         ST    @04,@AL00001+12                                     1578 06872000
         LA    @01,@AL00001                                        1578 06873000
         BAL   @14,LVLRPROC                                        1578 06874000
*                        RESPECIFY RTNREG RSTD;                    1579 06875000
*                        TESTRC = RTNREG;                          1580 06876000
         STH   RTNREG,TESTRC                                       1580 06877000
*                        RESPECIFY RTNREG UNRSTD;                  1581 06878000
*                        IF TESTRC ^= 0                            1582 06879000
*                          THEN                                    1582 06880000
         LH    @04,TESTRC                                          1582 06881000
         LTR   @04,@04                                             1582 06882000
         BZ    @RF01582                                            1582 06883000
*                            RETURN CODE(LASTCC12);                1583 06884000
         LA    @15,12                                              1583 06885000
         L     @14,@SA00007                                        1583 06886000
         LM    @00,@12,@SA00007+8                                  1583 06887000
         BR    @14                                                 1583 06888000
*                        END;                                      1584 06889000
*                                                                  1584 06890000
@RF01582 DS    0H                                                  1585 06891000
*                    END NVOBJMAT;                                 1585 06892000
@RF01576 DS    0H                                                  1586 06893000
*          END NVOBNTLP;                                           1586 06894000
*                                                                  1586 06895000
@RF01573 LA    @04,1                                               1586 06896000
         AL    @04,IX                                              1586 06897000
@DE01572 ST    @04,IX                                              1586 06898000
         L     @15,@PC00001+4                                      1586 06899000
         LA    @15,FDTPTR+8(,@15)                                  1586 06900000
         C     @04,OBJTSCNT(,@15)                                  1586 06901000
         BNH   @DL01572                                            1586 06902000
*          /**********************************************************/ 06903000
*          /*                                                        */ 06904000
*          /*  SAVE THE CPL, FVT, AND THE FPL'S PRIOR TO INVOKING    */ 06905000
*          /*  CATALOG MANAGEMENT.  IF THE NONVSAM  OBJECT IS A      */ 06906000
*          /*  DUPLICATE, IT IS DELETED, AND REDEFINED INTO THE      */ 06907000
*          /*  CATALOG.                                              */ 06908000
*          /*                                                        */ 06909000
*          /**********************************************************/ 06910000
*                                                                  1587 06911000
*          TFVTLEN = LENGTH(CTGFV) + (LENGTH(CTGFL)+8)*NVNUMFLD +  1587 06912000
*             LENGTH(IDAAMDSB);                                    1587 06913000
@RF01571 LA    @04,380                                             1587 06914000
         STH   @04,TFVTLEN                                         1587 06915000
*          SAVCPL = NVPTRCPL -> FIELDR(1:LENGTH(CTGPL)+16);        1588 06916000
*                                                                  1588 06917000
         L     @01,NVPTRCPL                                        1588 06918000
         MVC   SAVCPL(44),FIELDR(@01)                              1588 06919000
*          /**********************************************************/ 06920000
*          /*                                                        */ 06921000
*          /*  POINT TO THE SAVE AREA FOR THE FVT, WHICH FOLLOWS     */ 06922000
*          /*  THE AREA FOR THE FVT ITSELF.  THIS LOCATION IN CORE   */ 06923000
*          /*  HOLDS THE FVT, THE FPL'S, AND THE AMDSB.              */ 06924000
*          /*                                                        */ 06925000
*          /**********************************************************/ 06926000
*                                                                  1589 06927000
*          NVSAVFVT = NVFVTPTR + TFVTLEN;                          1589 06928000
*                                                                  1589 06929000
         AL    @04,NVFVTPTR                                        1589 06930000
         ST    @04,NVSAVFVT                                        1589 06931000
*          CALL MVDAPROC(TFVTLEN,NVFVTPTR,NVSAVFVT);               1590 06932000
*                                                                  1590 06933000
         LA    @04,TFVTLEN                                         1590 06934000
         ST    @04,@AL00001                                        1590 06935000
         LA    @04,NVFVTPTR                                        1590 06936000
         ST    @04,@AL00001+4                                      1590 06937000
         LA    @04,NVSAVFVT                                        1590 06938000
         ST    @04,@AL00001+8                                      1590 06939000
         LA    @01,@AL00001                                        1590 06940000
         BAL   @14,MVDAPROC                                        1590 06941000
*          /**********************************************************/ 06942000
*          /*                                                        */ 06943000
*          /*  CALL CTLGPROC TO ACTUALLY INVOKE VSAM CATALOG         */ 06944000
*          /*  MANAGEMENT TO DO THE DEFINE OF THE NONVSAM            */ 06945000
*          /*  SET IMPF2NER TO BE ON TO INDICATE THAT THE PRINTING   */ 06946000
*          /*  OF ERROR MESSAGES IS TO BE SUPPRESSED.                */ 06947000
*          /*                                                        */ 06948000
*          /**********************************************************/ 06949000
*                                                                  1591 06950000
*          IMPF2NER = ON;                                          1591 06951000
         OI    IMPF2NER,B'00001000'                                1591 06952000
*          CALL CTLGPROC(NVPTRCPL);                                1592 06953000
         LA    @04,NVPTRCPL                                        1592 06954000
         ST    @04,@AL00001                                        1592 06955000
         LA    @01,@AL00001                                        1592 06956000
         BAL   @14,CTLGPROC                                        1592 06957000
*          RESPECIFY RTNREG RSTD;                                  1593 06958000
*          TESTRC = RTNREG;                                        1594 06959000
         STH   RTNREG,TESTRC                                       1594 06960000
*          RESPECIFY RTNREG UNRSTD;                                1595 06961000
*                                                                  1595 06962000
*          /**********************************************************/ 06963000
*          /*                                                        */ 06964000
*          /*  RESET IMPF2NER TO BE OFF TO INDICATE THAT ERROR       */ 06965000
*          /*  MESSAGES ARE TO BE PRINTED.                           */ 06966000
*          /*                                                        */ 06967000
*          /**********************************************************/ 06968000
*                                                                  1596 06969000
*          IMPF2NER = OFF;                                         1596 06970000
*                                                                  1596 06971000
         NI    IMPF2NER,B'11110111'                                1596 06972000
*          /**********************************************************/ 06973000
*          /*                                                        */ 06974000
*          /*  A NON-ZERO RETURN CODE INDICATES THAT CATALOG WAS NOT */ 06975000
*          /*  ABLE TO DEFINE THE USER CATALOG POINTER.              */ 06976000
*          /*                                                        */ 06977000
*          /**********************************************************/ 06978000
*                                                                  1597 06979000
*          IF TESTRC ^= 0                                          1597 06980000
*            THEN                                                  1597 06981000
*                                                                  1597 06982000
         LH    @04,TESTRC                                          1597 06983000
         LTR   @04,@04                                             1597 06984000
         BZ    @RF01597                                            1597 06985000
*              /******************************************************/ 06986000
*              /*                                                    */ 06987000
*              /*  TEST FOR A VSAM CATALOG RETURN CODE OF 8.  THIS   */ 06988000
*              /*  INDICATES THAT THERE IS A DUPLICATE NAME IN THE   */ 06989000
*              /*  IN THE CATALOG.                                   */ 06990000
*              /*                                                    */ 06991000
*              /******************************************************/ 06992000
*                                                                  1598 06993000
*              IF CATLGRC ^= DUPNAME                               1598 06994000
*                THEN                                              1598 06995000
         CLC   CATLGRC(2),@CH00039                                 1598 06996000
         BE    @RF01598                                            1598 06997000
*                  DO;                                             1599 06998000
*                  DARGSMOD = IMPMSG;                              1600 06999000
         L     @04,DDSTRU                                          1600 07000000
         MVC   DARGSMOD(3,@04),@CC00945                            1600 07001000
*                  DARGSENT = MPRAFAIL;                            1601 07002000
         MVI   DARGSENT(@04),X'15'                                 1601 07003000
*                  DARGILP = LENGTH(FENTNAME);                     1602 07004000
         MVC   DARGILP(2,@04),@CH00605                             1602 07005000
*                  DARGDBP = NVFVTPTR -> CTGFVENT;                 1603 07006000
*                                                                  1603 07007000
         L     @01,NVFVTPTR                                        1603 07008000
         L     @15,CTGFVENT(,@01)                                  1603 07009000
         ST    @15,DARGDBP(,@04)                                   1603 07010000
*                  CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);           1604 07011000
         L     @04,@PC00001                                        1604 07012000
         ST    @04,@AL00001                                        1604 07013000
         LA    @15,@CF00119                                        1604 07014000
         ST    @15,@AL00001+4                                      1604 07015000
         LA    @15,DDSTRU                                          1604 07016000
         ST    @15,@AL00001+8                                      1604 07017000
         MVI   @AL00001+8,X'80'                                    1604 07018000
         L     @15,GDTPRT(,@04)                                    1604 07019000
         LA    @01,@AL00001                                        1604 07020000
         BALR  @14,@15                                             1604 07021000
*                  DARGLIST = ''B;                                 1605 07022000
         L     @04,DDSTRU                                          1605 07023000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1605 07024000
*                  DARGSMOD = IMPMSG;                              1606 07025000
*                                                                  1606 07026000
         MVC   DARGSMOD(3,@04),@CC00945                            1606 07027000
*                  RETURN CODE(LASTCC08);                          1607 07028000
         LA    @15,8                                               1607 07029000
         L     @14,@SA00007                                        1607 07030000
         LM    @00,@12,@SA00007+8                                  1607 07031000
         BR    @14                                                 1607 07032000
*                  END;                                            1608 07033000
*                ELSE                                              1609 07034000
*DUPNV:            DO;                                             1609 07035000
@RF01598 DS    0H                                                  1609 07036000
DUPNV    DS    0H                                                  1610 07037000
*                  OLDERID2 = NEWERID2;                            1610 07038000
         L     @04,@PC00001                                        1610 07039000
         L     @04,GDTTR2(,@04)                                    1610 07040000
         MVC   @TS00001(95),NEWERID2(@04)                          1610 07041000
         MVC   OLDERID2(95,@04),@TS00001                           1610 07042000
*                  NEWID2 = 'RMDN';                                1611 07043000
*                                                                  1611 07044000
         MVC   NEWID2(4,@04),@CC01433                              1611 07045000
*                  /**************************************************/ 07046000
*                  /*                                                */ 07047000
*                  /*  AN ENTRY FOR THE OBJECT TO BE DEFINED ALREADY */ 07048000
*                  /*  EXISTS IN THE CATALOG.  CALL CPLPROC TO BUILD */ 07049000
*                  /*  A CPL FOR THE DELETE FUNCTION.                */ 07050000
*                  /*                                                */ 07051000
*                  /**************************************************/ 07052000
*                                                                  1612 07053000
*                  CALL CPLPROC('D',DCPLPTR,CTGFVENT,NULLPARM,CPSWD);   07054000
*                                                                  1612 07055000
         LA    @04,@CC00751                                        1612 07056000
         ST    @04,@AL00001                                        1612 07057000
         LA    @04,DCPLPTR                                         1612 07058000
         ST    @04,@AL00001+4                                      1612 07059000
         L     @04,CTGFVPTR                                        1612 07060000
         LA    @04,CTGFVENT(,@04)                                  1612 07061000
         ST    @04,@AL00001+8                                      1612 07062000
         LA    @04,NULLPARM                                        1612 07063000
         ST    @04,@AL00001+12                                     1612 07064000
         LA    @04,CPSWD                                           1612 07065000
         ST    @04,@AL00001+16                                     1612 07066000
         LA    @01,@AL00001                                        1612 07067000
         BAL   @14,CPLPROC                                         1612 07068000
*                  /**************************************************/ 07069000
*                  /*                                                */ 07070000
*                  /*  TEST THE RETURN CODE FROM CPLPROC.  IF THE CPL*/ 07071000
*                  /*  WAS NOT BUILT RETURN TO THE CALLING PROCESSOR.*/ 07072000
*                  /*                                                */ 07073000
*                  /**************************************************/ 07074000
*                                                                  1613 07075000
*                  RESPECIFY RTNREG RSTD;                          1613 07076000
*                  TESTRC = RTNREG;                                1614 07077000
         STH   RTNREG,TESTRC                                       1614 07078000
*                  RESPECIFY RTNREG UNRSTD;                        1615 07079000
*                  IF TESTRC ^= 0                                  1616 07080000
*                    THEN                                          1616 07081000
         LH    @04,TESTRC                                          1616 07082000
         LTR   @04,@04                                             1616 07083000
         BZ    @RF01616                                            1616 07084000
*                      RETURN CODE(LASTCC12);                      1617 07085000
*                                                                  1617 07086000
         LA    @15,12                                              1617 07087000
         L     @14,@SA00007                                        1617 07088000
         LM    @00,@12,@SA00007+8                                  1617 07089000
         BR    @14                                                 1617 07090000
*                  /**************************************************/ 07091000
*                  /*                                                */ 07092000
*                  /*  SET THE CTGTYPE FIELD OF THE CPL.             */ 07093000
*                  /*                                                */ 07094000
*                  /**************************************************/ 07095000
*                                                                  1618 07096000
*                  DCPLPTR -> CTGTYPE = CTGFVTYP;                  1618 07097000
*                                                                  1618 07098000
@RF01616 L     @04,DCPLPTR                                         1618 07099000
         L     @01,CTGFVPTR                                        1618 07100000
         MVC   CTGTYPE(1,@04),CTGFVTYP(@01)                        1618 07101000
*                  /**************************************************/ 07102000
*                  /*                                                */ 07103000
*                  /*  CALL DELTPROC TO DELETE THE NONVSAM           */ 07104000
*                  /*  POINTER AND ITS ALIASES.                      */ 07105000
*                  /*                                                */ 07106000
*                  /**************************************************/ 07107000
*                                                                  1619 07108000
*                  CALL DELTPROC(DCPLPTR);                         1619 07109000
*                                                                  1619 07110000
         LA    @04,DCPLPTR                                         1619 07111000
         ST    @04,@AL00001                                        1619 07112000
         LA    @01,@AL00001                                        1619 07113000
         BAL   @14,DELTPROC                                        1619 07114000
*                  /**************************************************/ 07115000
*                  /*                                                */ 07116000
*                  /*  TEST THE RETURN CODE FROM DELTPROC.  IF IT IS */ 07117000
*                  /*  NON-ZERO, RETURN TO THE CALLING PROCESSOR WITH*/ 07118000
*                  /*  AN ERROR INDICATION.  OTHERWISE, RESET THE    */ 07119000
*                  /*  VALUE OF DEFSTID TO NORMSTAT TO INDICATE THAT */ 07120000
*                  /*  THE ERROR INCURRED ON THE FIRST CMS DEFINE    */ 07121000
*                  /*  HAS BEEN CLEARED.                             */ 07122000
*                  /*                                                */ 07123000
*                  /**************************************************/ 07124000
*                                                                  1620 07125000
*                  RESPECIFY RTNREG RSTD;                          1620 07126000
*                  TESTRC = RTNREG;                                1621 07127000
         STH   RTNREG,TESTRC                                       1621 07128000
*                  RESPECIFY RTNREG UNRSTD;                        1622 07129000
*                  IF TESTRC ^= 0                                  1623 07130000
*                    THEN                                          1623 07131000
         LH    @04,TESTRC                                          1623 07132000
         LTR   @04,@04                                             1623 07133000
         BZ    @RF01623                                            1623 07134000
*                      DO;                                         1624 07135000
*                      DARGSMOD = IMPMSG;                          1625 07136000
         L     @04,DDSTRU                                          1625 07137000
         MVC   DARGSMOD(3,@04),@CC00945                            1625 07138000
*                      DARGSENT = MPRAFAIL;                        1626 07139000
         MVI   DARGSENT(@04),X'15'                                 1626 07140000
*                      DARGILP = LENGTH(FENTNAME);                 1627 07141000
         MVC   DARGILP(2,@04),@CH00605                             1627 07142000
*                      DARGDBP = NVFVTPTR -> CTGFVENT;             1628 07143000
*                                                                  1628 07144000
         L     @01,NVFVTPTR                                        1628 07145000
         L     @15,CTGFVENT(,@01)                                  1628 07146000
         ST    @15,DARGDBP(,@04)                                   1628 07147000
*                      CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       1629 07148000
         L     @04,@PC00001                                        1629 07149000
         ST    @04,@AL00001                                        1629 07150000
         LA    @15,@CF00119                                        1629 07151000
         ST    @15,@AL00001+4                                      1629 07152000
         LA    @15,DDSTRU                                          1629 07153000
         ST    @15,@AL00001+8                                      1629 07154000
         MVI   @AL00001+8,X'80'                                    1629 07155000
         L     @15,GDTPRT(,@04)                                    1629 07156000
         LA    @01,@AL00001                                        1629 07157000
         BALR  @14,@15                                             1629 07158000
*                      DARGLIST = ''B;                             1630 07159000
         L     @04,DDSTRU                                          1630 07160000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1630 07161000
*                      DARGSMOD = IMPMSG;                          1631 07162000
*                                                                  1631 07163000
         MVC   DARGSMOD(3,@04),@CC00945                            1631 07164000
*                      RETURN CODE(LASTCC08);                      1632 07165000
         LA    @15,8                                               1632 07166000
         L     @14,@SA00007                                        1632 07167000
         LM    @00,@12,@SA00007+8                                  1632 07168000
         BR    @14                                                 1632 07169000
*                      END;                                        1633 07170000
*                                                                  1633 07171000
*                  DEFSTID = NORMSTAT;                             1634 07172000
*                                                                  1634 07173000
@RF01623 MVI   DEFSTID,X'00'                                       1634 07174000
*                  /**************************************************/ 07175000
*                  /*                                                */ 07176000
*                  /*  RESTORE THE CATALOG PARAMETER LISTS TO THEIR  */ 07177000
*                  /*  STATE PRIOR TO THE FIRST CMS DEFINE OPERATION.*/ 07178000
*                  /*                                                */ 07179000
*                  /**************************************************/ 07180000
*                                                                  1635 07181000
*                  NVPTRCPL->FIELDR(1:LENGTH(CTGPL)+16) = SAVCPL;  1635 07182000
         L     @04,NVPTRCPL                                        1635 07183000
         MVC   FIELDR(44,@04),SAVCPL                               1635 07184000
*                  CALL MVDAPROC(TFVTLEN,NVSAVFVT,NVFVTPTR);       1636 07185000
*                                                                  1636 07186000
         LA    @04,TFVTLEN                                         1636 07187000
         ST    @04,@AL00001                                        1636 07188000
         LA    @04,NVSAVFVT                                        1636 07189000
         ST    @04,@AL00001+4                                      1636 07190000
         LA    @04,NVFVTPTR                                        1636 07191000
         ST    @04,@AL00001+8                                      1636 07192000
         LA    @01,@AL00001                                        1636 07193000
         BAL   @14,MVDAPROC                                        1636 07194000
*                  /**************************************************/ 07195000
*                  /*                                                */ 07196000
*                  /*  RESTORE THE VOLUME LIST.                      */ 07197000
*                  /*                                                */ 07198000
*                  /**************************************************/ 07199000
*                                                                  1637 07200000
*                  DO J =1 TO (FLISTLN/LENGTH(FVOLSERL));          1637 07201000
         LA    @04,1                                               1637 07202000
         B     @DE01637                                            1637 07203000
@DL01637 DS    0H                                                  1638 07204000
*                    FVOLRTN(J) = 0;                               1638 07205000
         LR    @15,@04                                             1638 07206000
         SLA   @15,3                                               1638 07207000
         L     @01,CTGFVPTR                                        1638 07208000
         L     @01,CTGFVVLT(,@01)                                  1638 07209000
         ALR   @01,@15                                             1638 07210000
         AL    @01,@CF01786                                        1638 07211000
         SLR   @00,@00                                             1638 07212000
         STCM  @00,3,FVOLRTN-2(@01)                                1638 07213000
*                  END;                                            1639 07214000
*                                                                  1639 07215000
         AL    @04,@CF00221                                        1639 07216000
@DE01637 ST    @04,J                                               1639 07217000
         L     @01,CTGFVPTR                                        1639 07218000
         L     @01,CTGFVVLT(,@01)                                  1639 07219000
         LH    @00,FLISTLN(,@01)                                   1639 07220000
         SRDA  @00,32                                              1639 07221000
         D     @00,@CF00039                                        1639 07222000
         CR    @04,@01                                             1639 07223000
         BNH   @DL01637                                            1639 07224000
*                  /**************************************************/ 07225000
*                  /*                                                */ 07226000
*                  /*  POINT TO THE CPL, AND CALL CTLGPROC TO INVOKE */ 07227000
*                  /*  CATALOG MANAGEMENT.                           */ 07228000
*                  /*                                                */ 07229000
*                  /**************************************************/ 07230000
*                                                                  1640 07231000
*                  CALL CTLGPROC(NVPTRCPL);                        1640 07232000
*                                                                  1640 07233000
         LA    @04,NVPTRCPL                                        1640 07234000
         ST    @04,@AL00001                                        1640 07235000
         LA    @01,@AL00001                                        1640 07236000
         BAL   @14,CTLGPROC                                        1640 07237000
*                  /**************************************************/ 07238000
*                  /*                                                */ 07239000
*                  /*  TEST THE RETURN CODE FROM CTLGPROC.  IF IT IS */ 07240000
*                  /*  NON-ZERO, THE SECOND ATTEMPT TO DEFINE THE    */ 07241000
*                  /*  OBJECT HAS ALSO FAILED.  RETURN TO THE CALLING*/ 07242000
*                  /*  PROCESSOR WITH AN ERROR INDICATION.           */ 07243000
*                  /*                                                */ 07244000
*                  /**************************************************/ 07245000
*                                                                  1641 07246000
*                  RESPECIFY RTNREG RSTD;                          1641 07247000
*                  TESTRC = RTNREG;                                1642 07248000
         STH   RTNREG,TESTRC                                       1642 07249000
*                  RESPECIFY RTNREG UNRSTD;                        1643 07250000
*                  IF TESTRC ^= 0                                  1644 07251000
*                    THEN                                          1644 07252000
         LH    @04,TESTRC                                          1644 07253000
         LTR   @04,@04                                             1644 07254000
         BZ    @RF01644                                            1644 07255000
*                      DO;                                         1645 07256000
*                      DARGSMOD = IMPMSG;                          1646 07257000
         L     @04,DDSTRU                                          1646 07258000
         MVC   DARGSMOD(3,@04),@CC00945                            1646 07259000
*                      DARGSENT = MPRAFAIL;                        1647 07260000
         MVI   DARGSENT(@04),X'15'                                 1647 07261000
*                      DARGILP = LENGTH(FENTNAME);                 1648 07262000
         MVC   DARGILP(2,@04),@CH00605                             1648 07263000
*                      DARGDBP = NVFVTPTR -> CTGFVENT;             1649 07264000
*                                                                  1649 07265000
         L     @01,NVFVTPTR                                        1649 07266000
         L     @15,CTGFVENT(,@01)                                  1649 07267000
         ST    @15,DARGDBP(,@04)                                   1649 07268000
*                      CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       1650 07269000
         L     @04,@PC00001                                        1650 07270000
         ST    @04,@AL00001                                        1650 07271000
         LA    @15,@CF00119                                        1650 07272000
         ST    @15,@AL00001+4                                      1650 07273000
         LA    @15,DDSTRU                                          1650 07274000
         ST    @15,@AL00001+8                                      1650 07275000
         MVI   @AL00001+8,X'80'                                    1650 07276000
         L     @15,GDTPRT(,@04)                                    1650 07277000
         LA    @01,@AL00001                                        1650 07278000
         BALR  @14,@15                                             1650 07279000
*                      DARGLIST = ''B;                             1651 07280000
         L     @04,DDSTRU                                          1651 07281000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1651 07282000
*                      DARGSMOD = IMPMSG;                          1652 07283000
*                                                                  1652 07284000
         MVC   DARGSMOD(3,@04),@CC00945                            1652 07285000
*                      RETURN CODE(LASTCC08);                      1653 07286000
         LA    @15,8                                               1653 07287000
         L     @14,@SA00007                                        1653 07288000
         LM    @00,@12,@SA00007+8                                  1653 07289000
         BR    @14                                                 1653 07290000
*                      END;                                        1654 07291000
*                                                                  1654 07292000
*                  /**************************************************/ 07293000
*                  /*                                                */ 07294000
*                  /*  RESET THE VALUE OF DEFSTID TO BE NORMSTAT     */ 07295000
*                  /*  TO INDICATE THAT THE ORIGINAL CATALOG DEFINE  */ 07296000
*                  /*  ERROR HAS BEEN CLEARED.                       */ 07297000
*                  /*                                                */ 07298000
*                  /**************************************************/ 07299000
*                                                                  1655 07300000
*                  DEFSTID = NORMSTAT;                             1655 07301000
*                                                                  1655 07302000
@RF01644 MVI   DEFSTID,X'00'                                       1655 07303000
*                  END DUPNV;                                      1656 07304000
*                                                                  1656 07305000
*        /************************************************************/ 07306000
*        /*                                                          */ 07307000
*        /*  SAVE THE NAME OF THE OBJECT JUST DEFINED FOR USE        */ 07308000
*        /*  IN DEFINING ALIASES.                                    */ 07309000
*        /*                                                          */ 07310000
*        /************************************************************/ 07311000
*                                                                  1657 07312000
*        SAVRELNM = NVFVTPTR->CTGFVENT->FENTNAME;                  1657 07313000
*                                                                  1657 07314000
@RF01597 L     @04,NVFVTPTR                                        1657 07315000
         L     @04,CTGFVENT(,@04)                                  1657 07316000
         MVC   SAVRELNM(44),FENTNAME(@04)                          1657 07317000
*        /************************************************************/ 07318000
*        /*                                                          */ 07319000
*        /*  PRINT A MESSAGE TO INDICATE WHAT HAS BEEN IMPORTED      */ 07320000
*        /*  SUCCESSFULLY.                                           */ 07321000
*        /*                                                          */ 07322000
*        /************************************************************/ 07323000
*                                                                  1658 07324000
*        DARGSMOD = IMPMSG;                                        1658 07325000
         L     @15,DDSTRU                                          1658 07326000
         MVC   DARGSMOD(3,@15),@CC00945                            1658 07327000
*        DARGSENT = MPRASUCC;                                      1659 07328000
         MVI   DARGSENT(@15),X'1A'                                 1659 07329000
*        DARGILP = LENGTH(FENTNAME);                               1660 07330000
         MVC   DARGILP(2,@15),@CH00605                             1660 07331000
*        DARGDBP = NVFVTPTR -> CTGFVENT;                           1661 07332000
         ST    @04,DARGDBP(,@15)                                   1661 07333000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                     1662 07334000
         L     @04,@PC00001                                        1662 07335000
         ST    @04,@AL00001                                        1662 07336000
         LA    @15,@CF00119                                        1662 07337000
         ST    @15,@AL00001+4                                      1662 07338000
         LA    @15,DDSTRU                                          1662 07339000
         ST    @15,@AL00001+8                                      1662 07340000
         MVI   @AL00001+8,X'80'                                    1662 07341000
         L     @15,GDTPRT(,@04)                                    1662 07342000
         LA    @01,@AL00001                                        1662 07343000
         BALR  @14,@15                                             1662 07344000
*        DARGLIST = ''B;                                           1663 07345000
         L     @04,DDSTRU                                          1663 07346000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1663 07347000
*        DARGSMOD = IMPMSG;                                        1664 07348000
*                                                                  1664 07349000
         MVC   DARGSMOD(3,@04),@CC00945                            1664 07350000
*        /************************************************************/ 07351000
*        /*                                                          */ 07352000
*        /*  FREE UP THE CORE GOTTEN FOR THE FVT AND FPL'S FOR THE   */ 07353000
*        /*  DEFINE OF THE NONVSAM.                                  */ 07354000
*        /*                                                          */ 07355000
*        /************************************************************/ 07356000
*                                                                  1665 07357000
*        CALL IDCSAFS0(GDTTBL,NVFVTPTR);                           1665 07358000
*                                                                  1665 07359000
         L     @04,@PC00001                                        1665 07360000
         ST    @04,@AL00001                                        1665 07361000
         LA    @15,NVFVTPTR                                        1665 07362000
         ST    @15,@AL00001+4                                      1665 07363000
         L     @15,GDTFSP(,@04)                                    1665 07364000
         LA    @01,@AL00001                                        1665 07365000
         BALR  @14,@15                                             1665 07366000
*        /************************************************************/ 07367000
*        /*                                                          */ 07368000
*        /*  FREE UP THE CORE GOTTEN FOR THE DATA RECORD BUFFER      */ 07369000
*        /*                                                          */ 07370000
*        /************************************************************/ 07371000
*                                                                  1666 07372000
*        CALL IDCSAFS0(GDTTBL,NVWORKAR);                           1666 07373000
*                                                                  1666 07374000
         L     @04,@PC00001                                        1666 07375000
         ST    @04,@AL00001                                        1666 07376000
         LA    @15,NVWORKAR                                        1666 07377000
         ST    @15,@AL00001+4                                      1666 07378000
         L     @15,GDTFSP(,@04)                                    1666 07379000
         LA    @01,@AL00001                                        1666 07380000
         BALR  @14,@15                                             1666 07381000
*        /************************************************************/ 07382000
*        /*                                                          */ 07383000
*        /*  ISSUE A UFSPACE TO FREE UP THE CPL USED TO DEFINE       */ 07384000
*        /*  THE NONVSAM OBJECT.                                     */ 07385000
*        /*                                                          */ 07386000
*        /************************************************************/ 07387000
*                                                                  1667 07388000
*        CALL IDCSAFS0(GDTTBL,NVPTRCPL);                           1667 07389000
         L     @04,@PC00001                                        1667 07390000
         ST    @04,@AL00001                                        1667 07391000
         LA    @15,NVPTRCPL                                        1667 07392000
         ST    @15,@AL00001+4                                      1667 07393000
         L     @15,GDTFSP(,@04)                                    1667 07394000
         LA    @01,@AL00001                                        1667 07395000
         BALR  @14,@15                                             1667 07396000
*          /**********************************************************/ 07397000
*          /*                                                        */ 07398000
*          /*  THE ALIASES OF THE NONVSAM OBJECT THAT WERE PUT       */ 07399000
*          /*  ON THE PORTABLE DATA SET BY EXPORTRA MUST NOW BE      */ 07400000
*          /*  DEFINED IN THE CATALOG (IN VS2) OR HANDLED AS         */ 07401000
*          /*  AS UNDEFINABLE (IN DOS OR VS1).  TO DO THIS, WE LOOP  */ 07402000
*          /*  UNTIL A SOFTWARE END OF FILE IS FOUND, DEFINING       */ 07403000
*          /*  ALIASES OR PRINTING ERROR MESSAGES.                   */ 07404000
*          /*                                                        */ 07405000
*          /**********************************************************/ 07406000
*                                                                  1668 07407000
*          /**********************************************************/ 07408000
*          /*                                                        */ 07409000
*          /*  SET GETEOF TO OFF TO INDICATE THAT THE END OF FILE    */ 07410000
*          /*  HAS NOT BEEN FOUND.                                   */ 07411000
*          /*                                                        */ 07412000
*          /**********************************************************/ 07413000
*                                                                  1668 07414000
*          GETEOF = OFF;                                           1668 07415000
*                                                                  1668 07416000
         NI    GETEOF,B'01111111'                                  1668 07417000
*          /**********************************************************/ 07418000
*          /*                                                        */ 07419000
*          /*  LOOP UNTIL AN END OF FILE OR A TRAILING NONVSAM IS    */ 07420000
*          /*  FOUND, CALLING ALISPROC.                              */ 07421000
*          /*                                                        */ 07422000
*          /**********************************************************/ 07423000
*                                                                  1669 07424000
*          DO WHILE (GETEOF = OFF) & (NVSMRDSW = OFF);             1669 07425000
*                                                                  1669 07426000
         B     @DE01669                                            1669 07427000
@DL01669 DS    0H                                                  1670 07428000
*            CALL ALISPROC(ADDR(SAVRELNM));                        1670 07429000
         LA    @04,SAVRELNM                                        1670 07430000
         ST    @04,@AFTEMPS+8                                      1670 07431000
         LA    @04,@AFTEMPS+8                                      1670 07432000
         ST    @04,@AL00001                                        1670 07433000
         LA    @01,@AL00001                                        1670 07434000
         BAL   @14,ALISPROC                                        1670 07435000
*            RESPECIFY RTNREG RSTD;                                1671 07436000
*            TESTRC = RTNREG;                                      1672 07437000
         STH   RTNREG,TESTRC                                       1672 07438000
*            RESPECIFY RTNREG UNRSTD;                              1673 07439000
*                                                                  1673 07440000
*            /****************************************************/     07441000
*            /*                                                  */     07442000
*            /*  IF THE RETURN CODE INDICATES A SEVERE ERROR     */     07443000
*            /*  PASS THAT BACK TO THE CALLING PROCESSOR.        */     07444000
*            /*  OTHERWISE, CONTINUE WITH A VALUE OF 8 IN SETRC. */     07445000
*            /*                                                  */     07446000
*            /****************************************************/     07447000
*                                                                  1674 07448000
*            IF TESTRC = LASTCC12                                  1674 07449000
*              THEN                                                1674 07450000
         LH    @04,TESTRC                                          1674 07451000
         LA    @15,12                                              1674 07452000
         CR    @04,@15                                             1674 07453000
         BNE   @RF01674                                            1674 07454000
*                RETURN CODE(LASTCC12);                            1675 07455000
         L     @14,@SA00007                                        1675 07456000
         LM    @00,@12,@SA00007+8                                  1675 07457000
         BR    @14                                                 1675 07458000
*              ELSE                                                1676 07459000
*                IF TESTRC ^= 0                                    1676 07460000
*                  THEN                                            1676 07461000
@RF01674 LH    @04,TESTRC                                          1676 07462000
         LTR   @04,@04                                             1676 07463000
         BZ    @RF01676                                            1676 07464000
*                    SETRC = MAX(SETRC,LASTCC08);                  1677 07465000
         LH    @04,SETRC                                           1677 07466000
         LA    @15,8                                               1677 07467000
         CR    @04,@15                                             1677 07468000
         BNL   *+6                                                      07469000
         LR    @04,@15                                             1677 07470000
         STH   @04,SETRC                                           1677 07471000
*          END;                                                    1678 07472000
*                                                                  1678 07473000
@RF01676 DS    0H                                                  1678 07474000
@DE01669 TM    GETEOF,B'10000000'                                  1678 07475000
         BNZ   @DC01669                                            1678 07476000
         TM    NVSMRDSW,B'10000000'                                1678 07477000
         BZ    @DL01669                                            1678 07478000
@DC01669 DS    0H                                                  1679 07479000
*        /***********************************************************/  07480000
*        /*                                                          */ 07481000
*        /*  RETURN TO THE CALLING PROCESSOR WITH SUCCESS INDICATED  */ 07482000
*        /*                                                          */ 07483000
*        /************************************************************/ 07484000
*                                                                  1679 07485000
*        RETURN CODE(0);                                           1679 07486000
*                                                                  1679 07487000
         SLR   @15,@15                                             1679 07488000
         L     @14,@SA00007                                        1679 07489000
         LM    @00,@12,@SA00007+8                                  1679 07490000
         BR    @14                                                 1679 07491000
*END NVSMPROC;                                                     1680 07492000
*        /************************************************************/ 07493000
*        /*                                                          */ 07494000
*        /*  PROCEDURE NAME - ALISPROC                               */ 07495000
*        /*                                                          */ 07496000
*        /*  FUNCTION - READ A DATA RECORD FROM THE PORTABLE DATA    */ 07497000
*        /*  SET.  IN VS2 ALISPROC BUILDS CATALOG PARAMETER LISTS    */ 07498000
*        /*  AND DEFINES AN ALIAS FOR A RELATED OBJECT IN THE        */ 07499000
*        /*  CATALOG.  IN VS1 AND DOS, ALISPROC CHECKS TO BE SURE    */ 07500000
*        /*  THAT THE RECORDS READ IN ARE OF THE PROPER TYPE AND     */ 07501000
*        /*  THAT THE PORTABLE DATA SET IS NOT IN ERROR.             */ 07502000
*        /*                                                          */ 07503000
*        /*  INPUT - FUNCTION DEFINITION TABLE AND THE CATALOG       */ 07504000
*        /*  CONTROL RECORD.                                         */ 07505000
*        /*                                                          */ 07506000
*        /*  OUTPUT - IN VS2, A RECREATED ALIAS ENTRY IN THE         */ 07507000
*        /*  CATALOG.  IN VS1 AND DOS, APPROPRIATE MESSAGES.         */ 07508000
*        /*                                                          */ 07509000
*        /************************************************************/ 07510000
*                                                                  1681 07511000
*ALISPROC: PROCEDURE(ALNAMEPT);                                    1681 07512000
*                                                                  1681 07513000
ALISPROC STM   @14,@12,@SA00008                                    1681 07514000
         MVC   @PC00008(4),0(@01)                                  1681 07515000
*        /************************************************************/ 07516000
*        /*                                                          */ 07517000
*        /*  ARGUEMENTS OF INVOCATION                                */ 07518000
*        /*                                                          */ 07519000
*        /************************************************************/ 07520000
*                                                                  1682 07521000
*        DCL ALNAMEPT PTR(31);         /*POINTER TO THE RELATED NAME */ 07522000
*                                                                  1682 07523000
*        OLDERID2 = NEWERID2;                                      1683 07524000
         L     @04,@PC00001                                        1683 07525000
         L     @04,GDTTR2(,@04)                                    1683 07526000
         MVC   @TS00001(95),NEWERID2(@04)                          1683 07527000
         MVC   OLDERID2(95,@04),@TS00001                           1683 07528000
*        NEWID2 = 'RMAL';                                          1684 07529000
*                                                                  1684 07530000
         MVC   NEWID2(4,@04),@CC01439                              1684 07531000
*        /************************************************************/ 07532000
*        /*                                                          */ 07533000
*        /*  SET THE CONTROL RECORD POINTER TO THE ADDRESS OF THE    */ 07534000
*        /*  BUFFER INTO WHICH THE CONTROL RECORD IS TO BE READ.     */ 07535000
*        /*                                                          */ 07536000
*        /************************************************************/ 07537000
*                                                                  1685 07538000
*        CONRCPTR = ADDR(CONRCARE);                                1685 07539000
*                                                                  1685 07540000
         LA    @04,CONRCARE                                        1685 07541000
         ST    @04,CONRCPTR                                        1685 07542000
*        /************************************************************/ 07543000
*        /*                                                          */ 07544000
*        /*  ZERO OUT THE AREA THAT HOLDS THE CONTROL RECORDS.       */ 07545000
*        /*  BEGIN BY INITIALIZING THE VALUES OF ZSIZE, ZPTR,        */ 07546000
*        /*  AND ZCNTRL.                                             */ 07547000
*        /*                                                          */ 07548000
*        /************************************************************/ 07549000
*                                                                  1686 07550000
*        ZSIZE = LENGTH(CONRCARE);                                 1686 07551000
         MVC   ZSIZE(2),@CH00920                                   1686 07552000
*        ZPTR = CONRCPTR;                                          1687 07553000
         ST    @04,ZPTR                                            1687 07554000
*        ZCNTRL = ON;                                              1688 07555000
*                                                                  1688 07556000
         OI    ZCNTRL,B'10000000'                                  1688 07557000
*        /************************************************************/ 07558000
*        /*                                                          */ 07559000
*        /*  LOOP CLEARING THE AREA THAT IS TO HOLD THE CONTROL      */ 07560000
*        /*  RECORD.                                                 */ 07561000
*        /*                                                          */ 07562000
*        /************************************************************/ 07563000
*                                                                  1689 07564000
*        DO WHILE (ZCNTRL = ON);                                   1689 07565000
         B     @DE01689                                            1689 07566000
@DL01689 DS    0H                                                  1690 07567000
*          IF ZSIZE > 256                                          1690 07568000
*            THEN                                                  1690 07569000
         LH    @04,ZSIZE                                           1690 07570000
         LA    @15,256                                             1690 07571000
         CR    @04,@15                                             1690 07572000
         BNH   @RF01690                                            1690 07573000
*              DO;                                                 1691 07574000
*              ZAREA(1:256) = ZER(1:256);                          1692 07575000
         L     @14,ZPTR                                            1692 07576000
         MVC   ZAREA(256,@14),ZER                                  1692 07577000
*              ZSIZE = ZSIZE - 256;                                1693 07578000
         SLR   @04,@15                                             1693 07579000
         STH   @04,ZSIZE                                           1693 07580000
*              ZPTR = ZPTR + 256;                                  1694 07581000
         ALR   @14,@15                                             1694 07582000
         ST    @14,ZPTR                                            1694 07583000
*              END;                                                1695 07584000
*            ELSE                                                  1696 07585000
*              DO;                                                 1696 07586000
         B     @RC01690                                            1696 07587000
@RF01690 DS    0H                                                  1697 07588000
*              ZAREA(1:ZSIZE) = ZER(1:ZSIZE);                      1697 07589000
         L     @04,ZPTR                                            1697 07590000
         LH    @15,ZSIZE                                           1697 07591000
         BCTR  @15,0                                               1697 07592000
         EX    @15,@SM01777                                        1697 07593000
*              ZCNTRL = OFF;                                       1698 07594000
         NI    ZCNTRL,B'01111111'                                  1698 07595000
*              END;                                                1699 07596000
*        END;                                                      1700 07597000
*                                                                  1700 07598000
@RC01690 DS    0H                                                  1700 07599000
@DE01689 TM    ZCNTRL,B'10000000'                                  1700 07600000
         BO    @DL01689                                            1700 07601000
*        /************************************************************/ 07602000
*        /*                                                          */ 07603000
*        /*  PUT THE CONTROL RECORD IN THE BUFFER                    */ 07604000
*        /*                                                          */ 07605000
*        /************************************************************/ 07606000
*                                                                  1701 07607000
*        CALL IDCIOGT0(GDTTBL,PINIOCS);                            1701 07608000
         L     @04,@PC00001                                        1701 07609000
         ST    @04,@AL00001                                        1701 07610000
         LA    @15,PINIOCS                                         1701 07611000
         ST    @15,@AL00001+4                                      1701 07612000
         MVI   @AL00001+4,X'80'                                    1701 07613000
         L     @15,GDTGET(,@04)                                    1701 07614000
         LA    @01,@AL00001                                        1701 07615000
         BALR  @14,@15                                             1701 07616000
*        RESPECIFY RTNREG RSTD;                                    1702 07617000
*        TESTRC = RTNREG;                                          1703 07618000
         STH   RTNREG,TESTRC                                       1703 07619000
*        RESPECIFY RTNREG UNRSTD;                                  1704 07620000
*                                                                  1704 07621000
*        /************************************************************/ 07622000
*        /*                                                          */ 07623000
*        /*  TEST FOR A RETURN CODE INDICATING THAT WE HAVE FOUND    */ 07624000
*        /*  AN END OF FILE.  IF UGET GIVES US THIS RETURN CODE,     */ 07625000
*        /*  RETURN TO THE CALLING PROCESSOR WITH SUCCESS INDICATED. */ 07626000
*        /*  IF ANY OTHER NONZERO RETURN CODE IS RETURNED, RETURN    */ 07627000
*        /*  TO THE CALLER WITH A SEVERE ERROR INDICATED.            */ 07628000
*        /*                                                          */ 07629000
*        /************************************************************/ 07630000
*                                                                  1705 07631000
*        IF TESTRC = 16                                            1705 07632000
*          THEN                                                    1705 07633000
         LH    @04,TESTRC                                          1705 07634000
         C     @04,@CF00483                                        1705 07635000
         BNE   @RF01705                                            1705 07636000
*            DO;                                                   1706 07637000
*                                                                  1706 07638000
*            /********************************************************/ 07639000
*            /*                                                      */ 07640000
*            /*  SET GETEOF TO ON TO INDICATE TO THE CALLER THAT     */ 07641000
*            /*  AN END OF FILE HAS BEEN FOUND.                      */ 07642000
*            /*                                                      */ 07643000
*            /********************************************************/ 07644000
*                                                                  1707 07645000
*            GETEOF = ON;                                          1707 07646000
         OI    GETEOF,B'10000000'                                  1707 07647000
*            RETURN CODE(0);                                       1708 07648000
         SLR   @15,@15                                             1708 07649000
         L     @14,@SA00008                                        1708 07650000
         LM    @00,@12,@SA00008+8                                  1708 07651000
         BR    @14                                                 1708 07652000
*            END;                                                  1709 07653000
*          ELSE                                                    1710 07654000
*            IF TESTRC ^= 0                                        1710 07655000
*              THEN                                                1710 07656000
@RF01705 LH    @04,TESTRC                                          1710 07657000
         LTR   @04,@04                                             1710 07658000
         BZ    @RF01710                                            1710 07659000
*                RETURN CODE(LASTCC12);                            1711 07660000
*                                                                  1711 07661000
         LA    @15,12                                              1711 07662000
         L     @14,@SA00008                                        1711 07663000
         LM    @00,@12,@SA00008+8                                  1711 07664000
         BR    @14                                                 1711 07665000
*        TFVTLEN = IOCDAD -> HEADLN;                               1712 07666000
@RF01710 L     @04,IOCSPTR                                         1712 07667000
         L     @01,IOCDAD(,@04)                                    1712 07668000
         LH    @15,HEADLN(,@01)                                    1712 07669000
         STH   @15,TFVTLEN                                         1712 07670000
*        CALL MVDAPROC(TFVTLEN,IOCDAD,CONRCPTR);                   1713 07671000
*                                                                  1713 07672000
         LA    @15,TFVTLEN                                         1713 07673000
         ST    @15,@AL00001                                        1713 07674000
         ST    @04,@AL00001+4                                      1713 07675000
         LA    @04,CONRCPTR                                        1713 07676000
         ST    @04,@AL00001+8                                      1713 07677000
         LA    @01,@AL00001                                        1713 07678000
         BAL   @14,MVDAPROC                                        1713 07679000
*        /************************************************************/ 07680000
*        /*                                                          */ 07681000
*        /*  TEST TO DETERMINE THAT WE HAVE GOTTEN A CATALOG CONTROL */ 07682000
*        /*  RECORD.  IF NOT, THE PORTABLE DATA                      */ 07683000
*        /*  SET IS IN ERROR, AND THE IMPORTRA COMMAND MUST BE       */ 07684000
*        /*  TERMINATED.                                             */ 07685000
*        /*                                                          */ 07686000
*        /************************************************************/ 07687000
*                                                                  1714 07688000
*        IF (HEADFLG1 ^= HDFL1CAT)                                 1714 07689000
*          THEN                                                    1714 07690000
         L     @04,CONRCPTR                                        1714 07691000
         CLI   HEADFLG1(@04),X'FF'                                 1714 07692000
         BE    @RF01714                                            1714 07693000
*            DO;                                                   1715 07694000
*            DEFSTID = PORTERR;                                    1716 07695000
         MVI   DEFSTID,X'01'                                       1716 07696000
*            RETURN CODE(LASTCC12);                                1717 07697000
         LA    @15,12                                              1717 07698000
         L     @14,@SA00008                                        1717 07699000
         LM    @00,@12,@SA00008+8                                  1717 07700000
         BR    @14                                                 1717 07701000
*            END;                                                  1718 07702000
*                                                                  1718 07703000
*        /************************************************************/ 07704000
*        /*                                                          */ 07705000
*        /*  TEST TO DETERMINE IF THE CONTROL RECORD IS FOR          */ 07706000
*        /*  A NONVSAM DATA SET.  IF SO, RETURN TO THE CALLER        */ 07707000
*        /*  AFTER SETTING A SWITCH TO INDICATE THAT NVSMPROC        */ 07708000
*        /*  IS NOT TO READ A CONTROL RECORD THE NEXT TIME THAT      */ 07709000
*        /*  IT IS CALLED.                                           */ 07710000
*        /*                                                          */ 07711000
*        /************************************************************/ 07712000
*                                                                  1719 07713000
*        IF HEADFLG2 = HDFL2NVS                                    1719 07714000
*          THEN                                                    1719 07715000
@RF01714 L     @04,CONRCPTR                                        1719 07716000
         CLI   HEADFLG2(@04),C'A'                                  1719 07717000
         BNE   @RF01719                                            1719 07718000
*            DO;                                                   1720 07719000
*            NVSMRDSW = ON;                                        1721 07720000
         OI    NVSMRDSW,B'10000000'                                1721 07721000
*            RETURN CODE(0);                                       1722 07722000
         SLR   @15,@15                                             1722 07723000
         L     @14,@SA00008                                        1722 07724000
         LM    @00,@12,@SA00008+8                                  1722 07725000
         BR    @14                                                 1722 07726000
*            END;                                                  1723 07727000
*                                                                  1723 07728000
*        /************************************************************/ 07729000
*        /*                                                          */ 07730000
*        /*  THE RECORD THAT WAS GOTTEN WAS A CATALOG CONTROL RECORD */ 07731000
*        /*  FOR AN ALIAS ENTRY.  COMPUTE THE AMOUNT OF SPACE NEEDED */ 07732000
*        /*  FOR THE CATALOG DATA RECORD ASSOCIATED WITH THE         */ 07733000
*        /*  PRESENT CONTROL RECORD.  THEN GET ENOUGH CORE TO HOLD   */ 07734000
*        /*  THE RECORD.                                             */ 07735000
*        /*                                                          */ 07736000
*        /************************************************************/ 07737000
*                                                                  1724 07738000
*        TOTLEN = ASSRECLN;                                        1724 07739000
@RF01719 L     @04,CONRCPTR                                        1724 07740000
         LH    @04,ASSRECLN(,@04)                                  1724 07741000
         ST    @04,TOTLEN                                          1724 07742000
*        CALL IDCSAGP0(GDTTBL,TOTLEN,ALWORKAR,GPID,SETZERO);       1725 07743000
*                                                                  1725 07744000
         L     @04,@PC00001                                        1725 07745000
         ST    @04,@AL00001                                        1725 07746000
         LA    @15,TOTLEN                                          1725 07747000
         ST    @15,@AL00001+4                                      1725 07748000
         LA    @15,ALWORKAR                                        1725 07749000
         ST    @15,@AL00001+8                                      1725 07750000
         LA    @15,GPID                                            1725 07751000
         ST    @15,@AL00001+12                                     1725 07752000
         LA    @15,SETZERO                                         1725 07753000
         ST    @15,@AL00001+16                                     1725 07754000
         MVI   @AL00001+16,X'80'                                   1725 07755000
         L     @15,GDTGPL(,@04)                                    1725 07756000
         LA    @01,@AL00001                                        1725 07757000
         BALR  @14,@15                                             1725 07758000
*        /************************************************************/ 07759000
*        /*                                                          */ 07760000
*        /*  TEST THE RETURN CODE FROM UGPOOL.  IF IT IS NONZREO     */ 07761000
*        /*  NO STORAGE IS LEFT, AND THE COMMAND IS TERMINATED.      */ 07762000
*        /*                                                          */ 07763000
*        /************************************************************/ 07764000
*                                                                  1726 07765000
*        RESPECIFY RTNREG RSTD;                                    1726 07766000
*        TESTRC = RTNREG;                                          1727 07767000
         STH   RTNREG,TESTRC                                       1727 07768000
*        RESPECIFY RTNREG UNRSTD;                                  1728 07769000
*        IF TESTRC ^= 0                                            1729 07770000
*          THEN                                                    1729 07771000
         LH    @04,TESTRC                                          1729 07772000
         LTR   @04,@04                                             1729 07773000
         BZ    @RF01729                                            1729 07774000
*            DO;                                                   1730 07775000
*            DEFSTID = NOSTORAG;                                   1731 07776000
         MVI   DEFSTID,X'04'                                       1731 07777000
*            DARGSMOD = UNIVMSG;                                   1732 07778000
         L     @04,DDSTRU                                          1732 07779000
         MVC   DARGSMOD(3,@04),@CC00981                            1732 07780000
*            RETURN CODE(LASTCC12);                                1733 07781000
         LA    @15,12                                              1733 07782000
         L     @14,@SA00008                                        1733 07783000
         LM    @00,@12,@SA00008+8                                  1733 07784000
         BR    @14                                                 1733 07785000
*            END;                                                  1734 07786000
*                                                                  1734 07787000
*        /************************************************************/ 07788000
*        /*                                                          */ 07789000
*        /*  GET THE DATA RECORD USING GETPROC TO ASSEMBLE IT IN     */ 07790000
*        /*  THE BUFFER.  TEST THE RETURN CODE FROM                  */ 07791000
*        /*  GETPROC.  IF IT IS NONZERO, WE HAVE AN I/O ERROR.       */ 07792000
*        /*  RETURN TO THE CALLING PROCESSOR.                        */ 07793000
*        /*                                                          */ 07794000
*        /************************************************************/ 07795000
*                                                                  1735 07796000
*        CALL GETPROC(ALWORKAR,ASSRECLN);                          1735 07797000
@RF01729 LA    @04,ALWORKAR                                        1735 07798000
         ST    @04,@AL00001                                        1735 07799000
         L     @04,CONRCPTR                                        1735 07800000
         LA    @04,ASSRECLN(,@04)                                  1735 07801000
         ST    @04,@AL00001+4                                      1735 07802000
         LA    @01,@AL00001                                        1735 07803000
         BAL   @14,GETPROC                                         1735 07804000
*        RESPECIFY RTNREG RSTD;                                    1736 07805000
*        TESTRC = RTNREG;                                          1737 07806000
         STH   RTNREG,TESTRC                                       1737 07807000
*        RESPECIFY RTNREG UNRSTD;                                  1738 07808000
*        IF TESTRC ^= 0                                            1739 07809000
*          THEN                                                    1739 07810000
         LH    @04,TESTRC                                          1739 07811000
         LTR   @04,@04                                             1739 07812000
         BZ    @RF01739                                            1739 07813000
*            RETURN CODE(LASTCC12);                                1740 07814000
*                                                                  1740 07815000
         LA    @15,12                                              1740 07816000
         L     @14,@SA00008                                        1740 07817000
         LM    @00,@12,@SA00008+8                                  1740 07818000
         BR    @14                                                 1740 07819000
*        DICTPTR = ADDR(VARDATA);                                  1741 07820000
*                                                                  1741 07821000
@RF01739 L     @04,CONRCPTR                                        1741 07822000
         LA    @04,VARDATA(,@04)                                   1741 07823000
         ST    @04,DICTPTR                                         1741 07824000
*        /************************************************************/ 07825000
*        /*                                                          */ 07826000
*        /*  CONSTRUCT THE CPL TO BE USED FOR THE DEFINE FUNCTION.   */ 07827000
*        /*  IF THE CONSTRUCTION FAILS, RETURN TO THE CALLING        */ 07828000
*        /*  PROCESSOR WITH AN ERROR INDICATED.                      */ 07829000
*        /*                                                          */ 07830000
*        /************************************************************/ 07831000
*                                                                  1742 07832000
*        CALL CPLPROC('F',ALPTRCPL,NULLPARM,NULLPARM,NULLPARM);    1742 07833000
*                                                                  1742 07834000
         MVC   @AL00001(20),@AL01742                               1742 07835000
         LA    @04,ALPTRCPL                                        1742 07836000
         ST    @04,@AL00001+4                                      1742 07837000
         LA    @01,@AL00001                                        1742 07838000
         BAL   @14,CPLPROC                                         1742 07839000
*        RESPECIFY RTNREG RSTD;                                    1743 07840000
*        TESTRC = RTNREG;                                          1744 07841000
         STH   RTNREG,TESTRC                                       1744 07842000
*        RESPECIFY RTNREG UNRSTD;                                  1745 07843000
*        IF TESTRC ^= 0                                            1746 07844000
*          THEN                                                    1746 07845000
         LH    @04,TESTRC                                          1746 07846000
         LTR   @04,@04                                             1746 07847000
         BZ    @RF01746                                            1746 07848000
*            RETURN CODE(LASTCC12);                                1747 07849000
*                                                                  1747 07850000
         LA    @15,12                                              1747 07851000
         L     @14,@SA00008                                        1747 07852000
         LM    @00,@12,@SA00008+8                                  1747 07853000
         BR    @14                                                 1747 07854000
*        /************************************************************/ 07855000
*        /*                                                          */ 07856000
*        /*  SET CTGPLPTR TO BE ALPTRCPL, SO THAT IT POINTS TO THE   */ 07857000
*        /*  CPL BUILT FOR THE ALIAS.                                */ 07858000
*        /*                                                          */ 07859000
*        /************************************************************/ 07860000
*                                                                  1748 07861000
*        CTGPLPTR = ALPTRCPL;                                      1748 07862000
*                                                                  1748 07863000
@RF01746 L     @04,ALPTRCPL                                        1748 07864000
         ST    @04,CTGPLPTR                                        1748 07865000
*        /************************************************************/ 07866000
*        /*                                                          */ 07867000
*        /*  CALL NFVTPROC TO BUILD THE FVT TO BE USED TO DEFINE     */ 07868000
*        /*  THE ALIAS ENTRY.                                        */ 07869000
*        /*                                                          */ 07870000
*        /************************************************************/ 07871000
*                                                                  1749 07872000
*        CALL NFVTPROC(DICTPTR,ALWORKAR,ALFVTPTR,ALNAMEPT);        1749 07873000
*                                                                  1749 07874000
         LA    @04,DICTPTR                                         1749 07875000
         ST    @04,@AL00001                                        1749 07876000
         LA    @04,ALWORKAR                                        1749 07877000
         ST    @04,@AL00001+4                                      1749 07878000
         LA    @04,ALFVTPTR                                        1749 07879000
         ST    @04,@AL00001+8                                      1749 07880000
         L     @04,@PC00008                                        1749 07881000
         ST    @04,@AL00001+12                                     1749 07882000
         LA    @01,@AL00001                                        1749 07883000
         BAL   @14,NFVTPROC                                        1749 07884000
*        /************************************************************/ 07885000
*        /*                                                          */ 07886000
*        /*  TEST THE RETURN CODE, AND RETURN TO THE CALLING         */ 07887000
*        /*  PROCESSOR IF AN ERROR IS INDICATED.                     */ 07888000
*        /*                                                          */ 07889000
*        /************************************************************/ 07890000
*                                                                  1750 07891000
*        RESPECIFY RTNREG RSTD;                                    1750 07892000
*        TESTRC = RTNREG;                                          1751 07893000
         STH   RTNREG,TESTRC                                       1751 07894000
*        RESPECIFY RTNREG UNRSTD;                                  1752 07895000
*        IF TESTRC ^= 0                                            1753 07896000
*          THEN                                                    1753 07897000
         LH    @04,TESTRC                                          1753 07898000
         LTR   @04,@04                                             1753 07899000
         BZ    @RF01753                                            1753 07900000
*            RETURN CODE(LASTCC12);                                1754 07901000
*                                                                  1754 07902000
         LA    @15,12                                              1754 07903000
         L     @14,@SA00008                                        1754 07904000
         LM    @00,@12,@SA00008+8                                  1754 07905000
         BR    @14                                                 1754 07906000
*        CTGFVT = ALFVTPTR;                                        1755 07907000
*                                                                  1755 07908000
@RF01753 L     @04,ALFVTPTR                                        1755 07909000
         L     @01,CTGPLPTR                                        1755 07910000
         ST    @04,CTGFVT(,@01)                                    1755 07911000
*        /************************************************************/ 07912000
*        /*                                                          */ 07913000
*        /*  NO SCAN OF THE OBJECTS LIST IS NECESSARY FOR NONE       */ 07914000
*        /*  OF THE OBJECTS SUBPARAMETERS APPLY TO ALIASES.          */ 07915000
*        /*                                                          */ 07916000
*        /************************************************************/ 07917000
*                                                                  1756 07918000
*        /************************************************************/ 07919000
*        /*                                                          */ 07920000
*        /*  CALL CTLGPROC TO ACTUALLY INVOKE VSAM CATALOG           */ 07921000
*        /*  MANAGEMENT TO DO THE DEFINE OF THE ALIAS.               */ 07922000
*        /*                                                          */ 07923000
*        /************************************************************/ 07924000
*                                                                  1756 07925000
*        CALL CTLGPROC(ALPTRCPL);                                  1756 07926000
         LA    @04,ALPTRCPL                                        1756 07927000
         ST    @04,@AL00001                                        1756 07928000
         LA    @01,@AL00001                                        1756 07929000
         BAL   @14,CTLGPROC                                        1756 07930000
*        RESPECIFY RTNREG RSTD;                                    1757 07931000
*        TESTRC = RTNREG;                                          1758 07932000
         STH   RTNREG,TESTRC                                       1758 07933000
*        RESPECIFY RTNREG UNRSTD;                                  1759 07934000
*                                                                  1759 07935000
*        /************************************************************/ 07936000
*        /*                                                          */ 07937000
*        /*  A NON-ZERO RETURN CODE INDICATES THAT CATALOG WAS NOT   */ 07938000
*        /*  ABLE TO DEFINE THE ALIAS.                               */ 07939000
*        /*                                                          */ 07940000
*        /************************************************************/ 07941000
*                                                                  1760 07942000
*        IF TESTRC ^= 0                                            1760 07943000
*          THEN                                                    1760 07944000
         LH    @04,TESTRC                                          1760 07945000
         LTR   @04,@04                                             1760 07946000
         BZ    @RF01760                                            1760 07947000
*            DO;                                                   1761 07948000
*                                                                  1761 07949000
*            /********************************************************/ 07950000
*            /*                                                      */ 07951000
*            /*  NO DUPLICATE NAME ENTRIES SHOULD BE IN THE          */ 07952000
*            /*  THE CATALOG FOR THE DELETE OPERATIONS FOR THE       */ 07953000
*            /*  RELATED OBJECT SHOULD HAVE GOTTEN RID OF ALL OF     */ 07954000
*            /*  THEM.                                               */ 07955000
*            /*                                                      */ 07956000
*            /********************************************************/ 07957000
*                                                                  1762 07958000
*            DARGSENT = MPRAFAIL;                                  1762 07959000
         L     @04,DDSTRU                                          1762 07960000
         MVI   DARGSENT(@04),X'15'                                 1762 07961000
*            DARGSMOD = IMPMSG;                                    1763 07962000
         MVC   DARGSMOD(3,@04),@CC00945                            1763 07963000
*            DARGILP = LENGTH(FENTNAME);                           1764 07964000
         MVC   DARGILP(2,@04),@CH00605                             1764 07965000
*            DARGDBP = ALFVTPTR -> CTGFVENT;                       1765 07966000
         L     @01,ALFVTPTR                                        1765 07967000
         L     @15,CTGFVENT(,@01)                                  1765 07968000
         ST    @15,DARGDBP(,@04)                                   1765 07969000
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                 1766 07970000
         L     @04,@PC00001                                        1766 07971000
         ST    @04,@AL00001                                        1766 07972000
         LA    @15,@CF00119                                        1766 07973000
         ST    @15,@AL00001+4                                      1766 07974000
         LA    @15,DDSTRU                                          1766 07975000
         ST    @15,@AL00001+8                                      1766 07976000
         MVI   @AL00001+8,X'80'                                    1766 07977000
         L     @15,GDTPRT(,@04)                                    1766 07978000
         LA    @01,@AL00001                                        1766 07979000
         BALR  @14,@15                                             1766 07980000
*            DARGLIST = ''B;                                       1767 07981000
         L     @04,DDSTRU                                          1767 07982000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1767 07983000
*            DARGSMOD = IMPMSG;                                    1768 07984000
         MVC   DARGSMOD(3,@04),@CC00945                            1768 07985000
*            SETRC = MAX(SETRC,LASTCC08);                          1769 07986000
         LH    @04,SETRC                                           1769 07987000
         LA    @15,8                                               1769 07988000
         CR    @04,@15                                             1769 07989000
         BNL   *+6                                                      07990000
         LR    @04,@15                                             1769 07991000
         STH   @04,SETRC                                           1769 07992000
*            END;                                                  1770 07993000
*                                                                  1770 07994000
*        /************************************************************/ 07995000
*        /*                                                          */ 07996000
*        /*  FREE THE CORE GOTTEN FOR THIS PROCEDURE.                */ 07997000
*        /*                                                          */ 07998000
*        /************************************************************/ 07999000
*                                                                  1771 08000000
*        CALL IDCSAFS0(GDTTBL,ALFVTPTR);                           1771 08001000
@RF01760 L     @04,@PC00001                                        1771 08002000
         ST    @04,@AL00001                                        1771 08003000
         LA    @15,ALFVTPTR                                        1771 08004000
         ST    @15,@AL00001+4                                      1771 08005000
         L     @15,GDTFSP(,@04)                                    1771 08006000
         LA    @01,@AL00001                                        1771 08007000
         BALR  @14,@15                                             1771 08008000
*        CALL IDCSAFS0(GDTTBL,ALWORKAR);                           1772 08009000
         L     @04,@PC00001                                        1772 08010000
         ST    @04,@AL00001                                        1772 08011000
         LA    @15,ALWORKAR                                        1772 08012000
         ST    @15,@AL00001+4                                      1772 08013000
         L     @15,GDTFSP(,@04)                                    1772 08014000
         LA    @01,@AL00001                                        1772 08015000
         BALR  @14,@15                                             1772 08016000
*        CALL IDCSAFS0(GDTTBL,ALPTRCPL);                           1773 08017000
*                                                                  1773 08018000
         L     @04,@PC00001                                        1773 08019000
         ST    @04,@AL00001                                        1773 08020000
         LA    @15,ALPTRCPL                                        1773 08021000
         ST    @15,@AL00001+4                                      1773 08022000
         L     @15,GDTFSP(,@04)                                    1773 08023000
         LA    @01,@AL00001                                        1773 08024000
         BALR  @14,@15                                             1773 08025000
*        /************************************************************/ 08026000
*        /*                                                          */ 08027000
*        /*  RETURN TO THE CALLER WITH SUCCESS INDICATED.            */ 08028000
*        /*                                                          */ 08029000
*        /************************************************************/ 08030000
*                                                                  1774 08031000
*        RETURN CODE(0);                                           1774 08032000
*                                                                  1774 08033000
         SLR   @15,@15                                             1774 08034000
         L     @14,@SA00008                                        1774 08035000
         LM    @00,@12,@SA00008+8                                  1774 08036000
         BR    @14                                                 1774 08037000
*END ALISPROC;                                                     1775 08038000
*        /************************************************************/ 08039000
*        /*                                                          */ 08040000
*        /*  PROCEDURE NAME - NFVTPROC                               */ 08041000
*        /*                                                          */ 08042000
*        /*  FUNCTION - CONSTRUCT FVT AND FPL'S FROM INFORMATION     */ 08043000
*        /*  IN THE DICTIONARY PASSED AS AN ARGUMENT TO THIS         */ 08044000
*        /*  PROCEDURE.  FPL'S POINT TO THE CATALOG FIELD INFORMA-   */ 08045000
*        /*  TION WITHIN THE WORKAREA.  NFVTPROC IS USED ONLY FOR    */ 08046000
*        /*  NON-VSAMS, GDG BASES, ALIASES, AND USER CATALOG         */ 08047000
*        /*  POINTERS.  FVTPROC IS USED TO PERFORM THIS FUNCTION     */ 08048000
*        /*  FOR CLUSTERS, AIX'S, AND PATHS.                         */ 08049000
*        /*                                                          */ 08050000
*        /*  INPUT -                                                 */ 08051000
*        /*  .NFDICT - POINTER TO THE DICTIONARY WHICH REFERENCES    */ 08052000
*        /*            CATALOG FIELD INFORMATION WITH WORK AREA      */ 08053000
*        /*  .NFWKA  - WORKAREA CONTAINING THE CATALOG FIELD         */ 08054000
*        /*            INFORMATION                                   */ 08055000
*        /*  .NFVTPTR- RETURN CELL FOR AN FVT POINTER                */ 08056000
*        /*  .NFRELATE - POINTER TO THE RELATED NAME.  THIS IS USED  */ 08057000
*        /*              ONLY FOR ALIASES                            */ 08058000
*        /*                                                          */ 08059000
*        /*  OUTPUT - POINTER TO THE FVT CONSTRUCTED.  THIS FVT WILL */ 08060000
*        /*  REFERENCE ALL FPL'S CONSTRUCTED BY THIS PROCEDURE       */ 08061000
*        /*  IF ANY.                                                 */ 08062000
*        /*                                                          */ 08063000
*        /************************************************************/ 08064000
*                                                                  1776 08065000
*NFVTPROC: PROCEDURE(NFDICT,NFWKA,NFPTRFVT,NFRELATE);              1776 08066000
*                                                                  1776 08067000
NFVTPROC STM   @14,@12,@SA00009                                    1776 08068000
         MVC   @PC00009(16),0(@01)                                 1776 08069000
*        /************************************************************/ 08070000
*        /*                                                          */ 08071000
*        /*  ARGUEMENTS OF INVOCATION                                */ 08072000
*        /*                                                          */ 08073000
*        /************************************************************/ 08074000
*                                                                  1777 08075000
*        DCL NFDICT    PTR(31);                                    1777 08076000
*        DCL NFWKA     PTR(31);                                    1778 08077000
*        DCL NFPTRFVT  PTR(31);                                    1779 08078000
*        DCL NFRELATE  PTR(31);                                    1780 08079000
*                                                                  1780 08080000
*        /************************************************************/ 08081000
*        /*                                                          */ 08082000
*        /*  LOCAL DECLARATIONS                                      */ 08083000
*        /*                                                          */ 08084000
*        /************************************************************/ 08085000
*                                                                  1781 08086000
*        DCL NFPLADDR PTR(31);         /*POINTER TO THE FPL          */ 08087000
*        DCL NFPLNUM  FIXED(15) CONSTANT(8);                       1782 08088000
*                                      /*NUMBER OF FPL'S CONSTRUCTED */ 08089000
*                                      /*BY THIS PROCEDURE           */ 08090000
*        DCL NFIELDPT PTR(31);         /*POINTER TO A FIELD LIST     */ 08091000
*        OLDERID2 = NEWERID2;                                      1784 08092000
         L     @04,@PC00001                                        1784 08093000
         L     @15,GDTTR2(,@04)                                    1784 08094000
         MVC   @TS00001(95),NEWERID2(@15)                          1784 08095000
         MVC   OLDERID2(95,@15),@TS00001                           1784 08096000
*        NEWID2 = 'RMNF';                                          1785 08097000
*                                                                  1785 08098000
         MVC   NEWID2(4,@15),@CC01454                              1785 08099000
*        /************************************************************/ 08100000
*        /*                                                          */ 08101000
*        /*  GET CORE FOR THE FVT AND THE TOTAL NUMBER OF FPL'S      */ 08102000
*        /*  THAT CAN BE CONSTRUCTED BY THIS PROCEDURE               */ 08103000
*        /*                                                          */ 08104000
*        /************************************************************/ 08105000
*                                                                  1786 08106000
*        RESPECIFY CTGFV BASED(NFPTRFVT);                          1786 08107000
*        TOTLEN = 2*(LENGTH(CTGFV) + (LENGTH(CTGFL) + 8) * NFPLNUM + LE 08108000
*GTH(IDAAMDSB));                                                   1787 08109000
*                                                                  1787 08110000
         MVC   TOTLEN(4),@CF01753                                  1787 08111000
*        CALL IDCSAGP0(GDTTBL,TOTLEN,NFPTRFVT,GPID,SETZERO);       1788 08112000
*                                                                  1788 08113000
         ST    @04,@AL00001                                        1788 08114000
         LA    @15,TOTLEN                                          1788 08115000
         ST    @15,@AL00001+4                                      1788 08116000
         L     @15,@PC00009+8                                      1788 08117000
         ST    @15,@AL00001+8                                      1788 08118000
         LA    @15,GPID                                            1788 08119000
         ST    @15,@AL00001+12                                     1788 08120000
         LA    @15,SETZERO                                         1788 08121000
         ST    @15,@AL00001+16                                     1788 08122000
         MVI   @AL00001+16,X'80'                                   1788 08123000
         L     @15,GDTGPL(,@04)                                    1788 08124000
         LA    @01,@AL00001                                        1788 08125000
         BALR  @14,@15                                             1788 08126000
*        RESPECIFY RTNREG RSTD;                                    1789 08127000
*        TESTRC = RTNREG;                                          1790 08128000
         STH   RTNREG,TESTRC                                       1790 08129000
*        RESPECIFY RTNREG UNRSTD;                                  1791 08130000
*        IF TESTRC ^= 0                                            1792 08131000
*          THEN                                                    1792 08132000
*                                                                  1792 08133000
         LH    @04,TESTRC                                          1792 08134000
         LTR   @04,@04                                             1792 08135000
         BZ    @RF01792                                            1792 08136000
*            /********************************************************/ 08137000
*            /*                                                      */ 08138000
*            /*  IF CORE IS NOT OBTAINED SUCCESSFULLY, RETURN TO     */ 08139000
*            /*  THE CALLING PROCESSOR WITH FAILURE INDICATED.       */ 08140000
*            /*                                                      */ 08141000
*            /********************************************************/ 08142000
*                                                                  1793 08143000
*            DO;                                                   1793 08144000
*            DEFSTID = NOSTORAG;                                   1794 08145000
         MVI   DEFSTID,X'04'                                       1794 08146000
*            RETURN CODE(LASTCC12);                                1795 08147000
         LA    @15,12                                              1795 08148000
         L     @14,@SA00009                                        1795 08149000
         LM    @00,@12,@SA00009+8                                  1795 08150000
         BR    @14                                                 1795 08151000
*            END;                                                  1796 08152000
*                                                                  1796 08153000
*        /************************************************************/ 08154000
*        /*                                                          */ 08155000
*        /*  POINT TO THE DICTIONARY INFORMATION, AND SET THE        */ 08156000
*        /*  POINTER TO THE LOCATION IN CORE WHERE THE FIRST FPL IS  */ 08157000
*        /*  TO BE BUILT.                                            */ 08158000
*        /*                                                          */ 08159000
*        /************************************************************/ 08160000
*                                                                  1797 08161000
*        DICTPTR = NFDICT;                                         1797 08162000
@RF01792 L     @04,@PC00009                                        1797 08163000
         L     @04,NFDICT(,@04)                                    1797 08164000
         ST    @04,DICTPTR                                         1797 08165000
*        NFPLADDR = NFPTRFVT + LENGTH(CTGFV);                      1798 08166000
*                                                                  1798 08167000
         L     @15,@PC00009+8                                      1798 08168000
         L     @15,NFPTRFVT(,@15)                                  1798 08169000
         LA    @14,92                                              1798 08170000
         ALR   @14,@15                                             1798 08171000
         ST    @14,NFPLADDR                                        1798 08172000
*        /************************************************************/ 08173000
*        /*                                                          */ 08174000
*        /*  SET TYPE FIELD IN THE FVT FROM CATALOG FIELD INFORMATION*/ 08175000
*        /*                                                          */ 08176000
*        /************************************************************/ 08177000
*                                                                  1799 08178000
*        NFIELDPT = DICTDL(LENTYPE) + NFWKA;                       1799 08179000
         L     @14,@PC00009+4                                      1799 08180000
         L     @14,NFWKA(,@14)                                     1799 08181000
         L     @03,DICTDL(,@04)                                    1799 08182000
         ALR   @03,@14                                             1799 08183000
         ST    @03,NFIELDPT                                        1799 08184000
*        CTGFVTYP = NFIELDPT -> FENTYPE;                           1800 08185000
*                                                                  1800 08186000
         MVC   CTGFVTYP(1,@15),FENTYPE(@03)                        1800 08187000
*        /************************************************************/ 08188000
*        /*                                                          */ 08189000
*        /*  SET ENTNAME FIELD POINTER IN THE FVT                    */ 08190000
*        /*                                                          */ 08191000
*        /************************************************************/ 08192000
*                                                                  1801 08193000
*        IF DICTLN(LENTNAME) ^= NULLPTR                            1801 08194000
*          THEN                                                    1801 08195000
         L     @03,DICTLN+8(,@04)                                  1801 08196000
         LTR   @03,@03                                             1801 08197000
         BZ    @RF01801                                            1801 08198000
*            CTGFVENT = DICTDL(LENTNAME) + NFWKA;                  1802 08199000
*                                                                  1802 08200000
         AL    @14,DICTDL+8(,@04)                                  1802 08201000
         ST    @14,CTGFVENT(,@15)                                  1802 08202000
*        /************************************************************/ 08203000
*        /*                                                          */ 08204000
*        /*  SET THE VALUE OF THE OUTPUT DD NAME IN THE CTGFVIND     */ 08205000
*        /*  FIELD.                                                  */ 08206000
*        /*                                                          */ 08207000
*        /************************************************************/ 08208000
*                                                                  1803 08209000
*        IF ADDR(OUTDD) ^= NULLPTR                                 1803 08210000
*          THEN                                                    1803 08211000
@RF01801 L     @04,@PC00001+4                                      1803 08212000
         L     @04,FDTPTR+4(,@04)                                  1803 08213000
         LTR   @04,@04                                             1803 08214000
         BZ    @RF01803                                            1803 08215000
*            CTGFVIND = ADDR(OUTDDVAL);                            1804 08216000
*                                                                  1804 08217000
         L     @15,@PC00009+8                                      1804 08218000
         L     @01,NFPTRFVT(,@15)                                  1804 08219000
         LA    @04,OUTDDVAL(,@04)                                  1804 08220000
         ST    @04,CTGFVIND(,@01)                                  1804 08221000
*        /************************************************************/ 08222000
*        /*                                                          */ 08223000
*        /*  INVOKE LVLRPROC TO BUILD A VOLUME SERIAL LIST,          */ 08224000
*        /*  A DEVICETYPES LIST, AND FOR NON-VSAM OBJECTS,           */ 08225000
*        /*  A LIST OF FILESEQUENCE NUMBERS.                         */ 08226000
*        /*                                                          */ 08227000
*        /************************************************************/ 08228000
*                                                                  1805 08229000
*        IF (CTGFVTYP ^= CTGTGBS) & (CTGFVTYP ^= CTGTANM)          1805 08230000
*          THEN                                                    1805 08231000
@RF01803 L     @04,@PC00009+8                                      1805 08232000
         L     @15,NFPTRFVT(,@04)                                  1805 08233000
         CLI   CTGFVTYP(@15),C'B'                                  1805 08234000
         BE    @RF01805                                            1805 08235000
         CLI   CTGFVTYP(@15),C'X'                                  1805 08236000
         BE    @RF01805                                            1805 08237000
*            DO;                                                   1806 08238000
*            CALL LVLRPROC(NULLPARM,NFDICT,NFWKA,NFPTRFVT,CTGFVTYP);    08239000
*                                                                  1807 08240000
         LA    @14,NULLPARM                                        1807 08241000
         ST    @14,@AL00001                                        1807 08242000
         L     @14,@PC00009                                        1807 08243000
         ST    @14,@AL00001+4                                      1807 08244000
         L     @14,@PC00009+4                                      1807 08245000
         ST    @14,@AL00001+8                                      1807 08246000
         ST    @04,@AL00001+12                                     1807 08247000
         ST    @15,@AL00001+16                                     1807 08248000
         LA    @01,@AL00001                                        1807 08249000
         BAL   @14,LVLRPROC                                        1807 08250000
*            RESPECIFY RTNREG RSTD;                                1808 08251000
*            TESTRC = RTNREG;                                      1809 08252000
         STH   RTNREG,TESTRC                                       1809 08253000
*            RESPECIFY RTNREG UNRSTD;                              1810 08254000
*            IF TESTRC ^= 0                                        1811 08255000
*              THEN                                                1811 08256000
         LH    @04,TESTRC                                          1811 08257000
         LTR   @04,@04                                             1811 08258000
         BZ    @RF01811                                            1811 08259000
*                RETURN CODE(LASTCC12);                            1812 08260000
         LA    @15,12                                              1812 08261000
         L     @14,@SA00009                                        1812 08262000
         LM    @00,@12,@SA00009+8                                  1812 08263000
         BR    @14                                                 1812 08264000
*            END;                                                  1813 08265000
*                                                                  1813 08266000
@RF01811 DS    0H                                                  1814 08267000
*        /************************************************************/ 08268000
*        /*                                                          */ 08269000
*        /*  TEST TO DETERMINE IF WE ARE CONSTRUCTING AN FVT FOR     */ 08270000
*        /*  THE DEFINITION OF A GDG BASE OBJECT.                    */ 08271000
*        /*                                                          */ 08272000
*        /************************************************************/ 08273000
*                                                                  1814 08274000
*        IF CTGFVTYP = CTGTGBS                                     1814 08275000
*          THEN                                                    1814 08276000
@RF01805 L     @04,@PC00009+8                                      1814 08277000
         L     @04,NFPTRFVT(,@04)                                  1814 08278000
         CLI   CTGFVTYP(@04),C'B'                                  1814 08279000
         BNE   @RF01814                                            1814 08280000
*            DO;                                                   1815 08281000
*                                                                  1815 08282000
*            /********************************************************/ 08283000
*            /*                                                      */ 08284000
*            /*  CTGFVLMT POINTS DIRECTLY TO ONE BYTE OF GDG LIMIT   */ 08285000
*            /*  INFORMATION.                                        */ 08286000
*            /*                                                      */ 08287000
*            /********************************************************/ 08288000
*                                                                  1816 08289000
*            CTGFVLMT = DICTDL(LGDGLIM) + NFWKA;                   1816 08290000
*                                                                  1816 08291000
         L     @15,DICTPTR                                         1816 08292000
         L     @14,@PC00009+4                                      1816 08293000
         L     @14,NFWKA(,@14)                                     1816 08294000
         L     @03,DICTDL+16(,@15)                                 1816 08295000
         ALR   @03,@14                                             1816 08296000
         ST    @03,CTGFVLMT(,@04)                                  1816 08297000
*            /********************************************************/ 08298000
*            /*                                                      */ 08299000
*            /*  CTGFVGAT POINTS DIRECTLY TO ONE BYTE OF GDG         */ 08300000
*            /*  ATTRIBUTE INFORMATION.                              */ 08301000
*            /*                                                      */ 08302000
*            /********************************************************/ 08303000
*                                                                  1817 08304000
*            CTGFVGAT = DICTDL(LGDGATTR) + NFWKA;                  1817 08305000
*                                                                  1817 08306000
         AL    @14,DICTDL+24(,@15)                                 1817 08307000
         ST    @14,CTGFVGAT(,@04)                                  1817 08308000
*            END;                                                  1818 08309000
*                                                                  1818 08310000
*        /************************************************************/ 08311000
*        /*                                                          */ 08312000
*        /*  TEST TO DETERMINE IF THE OBJECT TO BE DEFINED IS        */ 08313000
*        /*  AN ALIAS.                                               */ 08314000
*        /*                                                          */ 08315000
*        /************************************************************/ 08316000
*                                                                  1819 08317000
*        IF CTGFVTYP = CTGTANM                                     1819 08318000
*          THEN                                                    1819 08319000
*                                                                  1819 08320000
@RF01814 L     @04,@PC00009+8                                      1819 08321000
         L     @04,NFPTRFVT(,@04)                                  1819 08322000
         CLI   CTGFVTYP(@04),C'X'                                  1819 08323000
         BNE   @RF01819                                            1819 08324000
*            /********************************************************/ 08325000
*            /*                                                      */ 08326000
*            /*  SET THE RELATED NAME IN THE CTGFVNAM FIELD FOR THE  */ 08327000
*            /*  ALIAS ENTRY.                                        */ 08328000
*            /*                                                      */ 08329000
*            /********************************************************/ 08330000
*                                                                  1820 08331000
*            CTGFVNAM = NFRELATE;                                  1820 08332000
*                                                                  1820 08333000
         L     @15,@PC00009+12                                     1820 08334000
         L     @15,NFRELATE(,@15)                                  1820 08335000
         ST    @15,CTGFVNAM(,@04)                                  1820 08336000
*        /************************************************************/ 08337000
*        /*                                                          */ 08338000
*        /*  IF THE OBJECT IS A NONVSAM, THEN BUILD FPLS FOR OWNER   */ 08339000
*        /*  ID, DATA SET CREATION DATE, AND DATA SET EXPIRATION     */ 08340000
*        /*  DATE.                                                   */ 08341000
*        /*                                                          */ 08342000
*        /************************************************************/ 08343000
*                                                                  1821 08344000
*        IF CTGFVTYP = CTGTALIN                                    1821 08345000
*          THEN                                                    1821 08346000
@RF01819 L     @04,@PC00009+8                                      1821 08347000
         L     @04,NFPTRFVT(,@04)                                  1821 08348000
         CLI   CTGFVTYP(@04),C'A'                                  1821 08349000
         BNE   @RF01821                                            1821 08350000
*            DO;                                                   1822 08351000
*                                                                  1822 08352000
*            /********************************************************/ 08353000
*            /*                                                      */ 08354000
*            /*  BUILD AN FPL FOR OWNER ID                           */ 08355000
*            /*                                                      */ 08356000
*            /********************************************************/ 08357000
*                                                                  1823 08358000
*            CALL BFPLPROC(ADDR(NVFLIST),LOWNERID,NFPLADDR,NFDICT, 1823 08359000
*               NFWKA,CTGFVOWN);                                   1823 08360000
*                                                                  1823 08361000
         LA    @15,NVFLIST                                         1823 08362000
         ST    @15,@AFTEMPS+12                                     1823 08363000
         LA    @15,@AFTEMPS+12                                     1823 08364000
         ST    @15,@AL00001                                        1823 08365000
         LA    @15,@CH00041                                        1823 08366000
         ST    @15,@AL00001+4                                      1823 08367000
         LA    @15,NFPLADDR                                        1823 08368000
         ST    @15,@AL00001+8                                      1823 08369000
         L     @15,@PC00009                                        1823 08370000
         ST    @15,@AL00001+12                                     1823 08371000
         L     @15,@PC00009+4                                      1823 08372000
         ST    @15,@AL00001+16                                     1823 08373000
         LA    @04,CTGFVOWN(,@04)                                  1823 08374000
         ST    @04,@AL00001+20                                     1823 08375000
         LA    @01,@AL00001                                        1823 08376000
         BAL   @14,BFPLPROC                                        1823 08377000
*            /********************************************************/ 08378000
*            /*                                                      */ 08379000
*            /*  BUILD AN FPL FOR DATA SET CREATION DATE             */ 08380000
*            /*                                                      */ 08381000
*            /********************************************************/ 08382000
*                                                                  1824 08383000
*            CALL BFPLPROC(ADDR(NVFLIST),LDSETCRD,NFPLADDR,NFDICT, 1824 08384000
*               NFWKA,CTGFVCRE);                                   1824 08385000
*                                                                  1824 08386000
         LA    @04,NVFLIST                                         1824 08387000
         ST    @04,@AFTEMPS+12                                     1824 08388000
         LA    @04,@AFTEMPS+12                                     1824 08389000
         ST    @04,@AL00001                                        1824 08390000
         LA    @04,@CH00040                                        1824 08391000
         ST    @04,@AL00001+4                                      1824 08392000
         LA    @04,NFPLADDR                                        1824 08393000
         ST    @04,@AL00001+8                                      1824 08394000
         L     @04,@PC00009                                        1824 08395000
         ST    @04,@AL00001+12                                     1824 08396000
         L     @04,@PC00009+4                                      1824 08397000
         ST    @04,@AL00001+16                                     1824 08398000
         L     @04,@PC00009+8                                      1824 08399000
         L     @04,NFPTRFVT(,@04)                                  1824 08400000
         LA    @04,CTGFVCRE(,@04)                                  1824 08401000
         ST    @04,@AL00001+20                                     1824 08402000
         LA    @01,@AL00001                                        1824 08403000
         BAL   @14,BFPLPROC                                        1824 08404000
*            /********************************************************/ 08405000
*            /*                                                      */ 08406000
*            /*  BUILD AN FPL FOR DATA SET EXPIRATION DATE           */ 08407000
*            /*                                                      */ 08408000
*            /********************************************************/ 08409000
*                                                                  1825 08410000
*            CALL BFPLPROC(ADDR(NVFLIST),LDSETEXD,NFPLADDR,NFDICT, 1825 08411000
*               NFWKA,CTGFVEXP);                                   1825 08412000
*                                                                  1825 08413000
         LA    @04,NVFLIST                                         1825 08414000
         ST    @04,@AFTEMPS+12                                     1825 08415000
         LA    @04,@AFTEMPS+12                                     1825 08416000
         ST    @04,@AL00001                                        1825 08417000
         LA    @04,@CH00039                                        1825 08418000
         ST    @04,@AL00001+4                                      1825 08419000
         LA    @04,NFPLADDR                                        1825 08420000
         ST    @04,@AL00001+8                                      1825 08421000
         L     @04,@PC00009                                        1825 08422000
         ST    @04,@AL00001+12                                     1825 08423000
         L     @04,@PC00009+4                                      1825 08424000
         ST    @04,@AL00001+16                                     1825 08425000
         L     @04,@PC00009+8                                      1825 08426000
         L     @04,NFPTRFVT(,@04)                                  1825 08427000
         LA    @04,CTGFVEXP(,@04)                                  1825 08428000
         ST    @04,@AL00001+20                                     1825 08429000
         LA    @01,@AL00001                                        1825 08430000
         BAL   @14,BFPLPROC                                        1825 08431000
*            END;                                                  1826 08432000
*                                                                  1826 08433000
*        /************************************************************/ 08434000
*        /*                                                          */ 08435000
*        /*  IF THE OBJECT IS A GDG BASE, THEN BUILD FPLS FOR OWNER  */ 08436000
*        /*  ID, DATA SET CREATION DATE, AND DATA SET EXPIRATION     */ 08437000
*        /*  DATE.                                                   */ 08438000
*        /*                                                          */ 08439000
*        /************************************************************/ 08440000
*                                                                  1827 08441000
*        IF CTGFVTYP = CTGTGBS                                     1827 08442000
*          THEN                                                    1827 08443000
@RF01821 L     @04,@PC00009+8                                      1827 08444000
         L     @04,NFPTRFVT(,@04)                                  1827 08445000
         CLI   CTGFVTYP(@04),C'B'                                  1827 08446000
         BNE   @RF01827                                            1827 08447000
*            DO;                                                   1828 08448000
*                                                                  1828 08449000
*            /********************************************************/ 08450000
*            /*                                                      */ 08451000
*            /*  BUILD AN FPL FOR OWNER ID                           */ 08452000
*            /*                                                      */ 08453000
*            /********************************************************/ 08454000
*                                                                  1829 08455000
*            CALL BFPLPROC(ADDR(GDFLIST),LGDOWN,NFPLADDR,NFDICT,   1829 08456000
*               NFWKA,CTGFVOWN);                                   1829 08457000
*                                                                  1829 08458000
         LA    @15,GDFLIST                                         1829 08459000
         ST    @15,@AFTEMPS+12                                     1829 08460000
         LA    @15,@AFTEMPS+12                                     1829 08461000
         ST    @15,@AL00001                                        1829 08462000
         LA    @15,@CH00288                                        1829 08463000
         ST    @15,@AL00001+4                                      1829 08464000
         LA    @15,NFPLADDR                                        1829 08465000
         ST    @15,@AL00001+8                                      1829 08466000
         L     @15,@PC00009                                        1829 08467000
         ST    @15,@AL00001+12                                     1829 08468000
         L     @15,@PC00009+4                                      1829 08469000
         ST    @15,@AL00001+16                                     1829 08470000
         LA    @04,CTGFVOWN(,@04)                                  1829 08471000
         ST    @04,@AL00001+20                                     1829 08472000
         LA    @01,@AL00001                                        1829 08473000
         BAL   @14,BFPLPROC                                        1829 08474000
*            /********************************************************/ 08475000
*            /*                                                      */ 08476000
*            /*  BUILD AN FPL FOR DATA SET CREATION DATE             */ 08477000
*            /*                                                      */ 08478000
*            /********************************************************/ 08479000
*                                                                  1830 08480000
*            CALL BFPLPROC(ADDR(GDFLIST),LGDDSCRD,NFPLADDR,NFDICT, 1830 08481000
*               NFWKA,CTGFVCRE);                                   1830 08482000
*                                                                  1830 08483000
         LA    @04,GDFLIST                                         1830 08484000
         ST    @04,@AFTEMPS+12                                     1830 08485000
         LA    @04,@AFTEMPS+12                                     1830 08486000
         ST    @04,@AL00001                                        1830 08487000
         LA    @04,@CH00041                                        1830 08488000
         ST    @04,@AL00001+4                                      1830 08489000
         LA    @04,NFPLADDR                                        1830 08490000
         ST    @04,@AL00001+8                                      1830 08491000
         L     @04,@PC00009                                        1830 08492000
         ST    @04,@AL00001+12                                     1830 08493000
         L     @04,@PC00009+4                                      1830 08494000
         ST    @04,@AL00001+16                                     1830 08495000
         L     @04,@PC00009+8                                      1830 08496000
         L     @04,NFPTRFVT(,@04)                                  1830 08497000
         LA    @04,CTGFVCRE(,@04)                                  1830 08498000
         ST    @04,@AL00001+20                                     1830 08499000
         LA    @01,@AL00001                                        1830 08500000
         BAL   @14,BFPLPROC                                        1830 08501000
*            /********************************************************/ 08502000
*            /*                                                      */ 08503000
*            /*  BUILD AN FPL FOR DATA SET EXPIRATION DATE           */ 08504000
*            /*                                                      */ 08505000
*            /********************************************************/ 08506000
*                                                                  1831 08507000
*            CALL BFPLPROC(ADDR(GDFLIST),LGDDSEXD,NFPLADDR,NFDICT, 1831 08508000
*               NFWKA,CTGFVEXP);                                   1831 08509000
*                                                                  1831 08510000
         LA    @04,GDFLIST                                         1831 08511000
         ST    @04,@AFTEMPS+12                                     1831 08512000
         LA    @04,@AFTEMPS+12                                     1831 08513000
         ST    @04,@AL00001                                        1831 08514000
         LA    @04,@CH00040                                        1831 08515000
         ST    @04,@AL00001+4                                      1831 08516000
         LA    @04,NFPLADDR                                        1831 08517000
         ST    @04,@AL00001+8                                      1831 08518000
         L     @04,@PC00009                                        1831 08519000
         ST    @04,@AL00001+12                                     1831 08520000
         L     @04,@PC00009+4                                      1831 08521000
         ST    @04,@AL00001+16                                     1831 08522000
         L     @04,@PC00009+8                                      1831 08523000
         L     @04,NFPTRFVT(,@04)                                  1831 08524000
         LA    @04,CTGFVEXP(,@04)                                  1831 08525000
         ST    @04,@AL00001+20                                     1831 08526000
         LA    @01,@AL00001                                        1831 08527000
         BAL   @14,BFPLPROC                                        1831 08528000
*            END;                                                  1832 08529000
*                                                                  1832 08530000
*        /************************************************************/ 08531000
*        /*                                                          */ 08532000
*        /*  RETURN TO THE CALLER WITH SUCCESS INDICATED.            */ 08533000
*        /*                                                          */ 08534000
*        /************************************************************/ 08535000
*                                                                  1833 08536000
*        RETURN CODE(0);                                           1833 08537000
*                                                                  1833 08538000
@RF01827 SLR   @15,@15                                             1833 08539000
         L     @14,@SA00009                                        1833 08540000
         LM    @00,@12,@SA00009+8                                  1833 08541000
         BR    @14                                                 1833 08542000
*        RESPECIFY CTGFV BASED(CTGFVPTR);                          1834 08543000
*                                                                  1834 08544000
*END NFVTPROC;                                                     1835 08545000
*        /************************************************************/ 08546000
*        /*                                                          */ 08547000
*        /*  PROCEDURE NAME - GDGPROC                                */ 08548000
*        /*                                                          */ 08549000
*        /*  FUNCTION - READ CATALOG AND DATA RECORDS FROM THE       */ 08550000
*        /*  PORTABLE DATA SET, AND PERFORM A DEFINE OF A GDG BASE   */ 08551000
*        /*  AND ITS ASSOCIATIONS IN A VS2 VSAM CATALOG OR PRINT     */ 08552000
*        /*  AN ERROR MESSAGE FOR A DOS OR A VS1 CATALOG.            */ 08553000
*        /*                                                          */ 08554000
*        /*  INPUT - FUNCTION DEFINITION TABLE                       */ 08555000
*        /*                                                          */ 08556000
*        /*  OUTPUT - A RECREATED GDG BASE AND ITS ASSOCIATIONS OR   */ 08557000
*        /*  APPROPRIATE ERROR MESSAGES.                             */ 08558000
*        /*                                                          */ 08559000
*        /************************************************************/ 08560000
*                                                                  1836 08561000
*GDGPROC: PROCEDURE;                                               1836 08562000
*                                                                  1836 08563000
GDGPROC  STM   @14,@12,@SA00010                                    1836 08564000
*        OLDERID2 = NEWERID2;                                      1837 08565000
         L     @04,@PC00001                                        1837 08566000
         L     @04,GDTTR2(,@04)                                    1837 08567000
         MVC   @TS00001(95),NEWERID2(@04)                          1837 08568000
         MVC   OLDERID2(95,@04),@TS00001                           1837 08569000
*        NEWID2 = 'RMGD';                                          1838 08570000
*                                                                  1838 08571000
         MVC   NEWID2(4,@04),@CC01461                              1838 08572000
*        /************************************************************/ 08573000
*        /*                                                          */ 08574000
*        /*  SET THE ADDRESS OF THE CONTROL RECORD BUFFER WHICH      */ 08575000
*        /*  WILL CONTAIN THE DICTIONARY FOR THE CATALOG RECORD.     */ 08576000
*        /*                                                          */ 08577000
*        /************************************************************/ 08578000
*                                                                  1839 08579000
*        CONRCPTR = ADDR(CONRCARE);                                1839 08580000
*                                                                  1839 08581000
         LA    @04,CONRCARE                                        1839 08582000
         ST    @04,CONRCPTR                                        1839 08583000
*        /************************************************************/ 08584000
*        /*                                                          */ 08585000
*        /*  ZERO OUT THE AREA THAT HOLDS THE CONTROL RECORDS.       */ 08586000
*        /*  BEGIN BY INITIALIZING THE VALUES OF ZSIZE, ZPTR,        */ 08587000
*        /*  AND ZCNTRL.                                             */ 08588000
*        /*                                                          */ 08589000
*        /************************************************************/ 08590000
*                                                                  1840 08591000
*        ZSIZE = LENGTH(CONRCARE);                                 1840 08592000
         MVC   ZSIZE(2),@CH00920                                   1840 08593000
*        ZPTR = CONRCPTR;                                          1841 08594000
         ST    @04,ZPTR                                            1841 08595000
*        ZCNTRL = ON;                                              1842 08596000
*                                                                  1842 08597000
         OI    ZCNTRL,B'10000000'                                  1842 08598000
*        /************************************************************/ 08599000
*        /*                                                          */ 08600000
*        /*  LOOP CLEARING THE AREA THAT IS TO HOLD THE CONTROL      */ 08601000
*        /*  RECORD.                                                 */ 08602000
*        /*                                                          */ 08603000
*        /************************************************************/ 08604000
*                                                                  1843 08605000
*        DO WHILE (ZCNTRL = ON);                                   1843 08606000
         B     @DE01843                                            1843 08607000
@DL01843 DS    0H                                                  1844 08608000
*          IF ZSIZE > 256                                          1844 08609000
*            THEN                                                  1844 08610000
         LH    @04,ZSIZE                                           1844 08611000
         LA    @15,256                                             1844 08612000
         CR    @04,@15                                             1844 08613000
         BNH   @RF01844                                            1844 08614000
*              DO;                                                 1845 08615000
*              ZAREA(1:256) = ZER(1:256);                          1846 08616000
         L     @14,ZPTR                                            1846 08617000
         MVC   ZAREA(256,@14),ZER                                  1846 08618000
*              ZSIZE = ZSIZE - 256;                                1847 08619000
         SLR   @04,@15                                             1847 08620000
         STH   @04,ZSIZE                                           1847 08621000
*              ZPTR = ZPTR + 256;                                  1848 08622000
         ALR   @14,@15                                             1848 08623000
         ST    @14,ZPTR                                            1848 08624000
*              END;                                                1849 08625000
*            ELSE                                                  1850 08626000
*              DO;                                                 1850 08627000
         B     @RC01844                                            1850 08628000
@RF01844 DS    0H                                                  1851 08629000
*              ZAREA(1:ZSIZE) = ZER(1:ZSIZE);                      1851 08630000
         L     @04,ZPTR                                            1851 08631000
         LH    @15,ZSIZE                                           1851 08632000
         BCTR  @15,0                                               1851 08633000
         EX    @15,@SM01777                                        1851 08634000
*              ZCNTRL = OFF;                                       1852 08635000
         NI    ZCNTRL,B'01111111'                                  1852 08636000
*              END;                                                1853 08637000
*        END;                                                      1854 08638000
*                                                                  1854 08639000
@RC01844 DS    0H                                                  1854 08640000
@DE01843 TM    ZCNTRL,B'10000000'                                  1854 08641000
         BO    @DL01843                                            1854 08642000
*        /************************************************************/ 08643000
*        /*                                                          */ 08644000
*        /*  CONSTRUCT THE CPL TO BE USED FOR THE DEFINE FUNCTION.   */ 08645000
*        /*  IF THE CONSTRUCTION FAILS, RETURN TO THE CALLING        */ 08646000
*        /*  PROCESSOR WITH AN ERROR INDICATOR.                      */ 08647000
*        /*                                                          */ 08648000
*        /************************************************************/ 08649000
*                                                                  1855 08650000
*        CALL CPLPROC('F',GDPTRCPL,NULLPARM,NULLPARM,NULLPARM);    1855 08651000
*                                                                  1855 08652000
         MVC   @AL00001(20),@AL01855                               1855 08653000
         LA    @04,GDPTRCPL                                        1855 08654000
         ST    @04,@AL00001+4                                      1855 08655000
         LA    @01,@AL00001                                        1855 08656000
         BAL   @14,CPLPROC                                         1855 08657000
*        RESPECIFY RTNREG RSTD;                                    1856 08658000
*        TESTRC = RTNREG;                                          1857 08659000
         STH   RTNREG,TESTRC                                       1857 08660000
*        RESPECIFY RTNREG UNRSTD;                                  1858 08661000
*        IF TESTRC ^= 0                                            1859 08662000
*          THEN                                                    1859 08663000
         LH    @04,TESTRC                                          1859 08664000
         LTR   @04,@04                                             1859 08665000
         BZ    @RF01859                                            1859 08666000
*            RETURN CODE(LASTCC12);                                1860 08667000
*                                                                  1860 08668000
         LA    @15,12                                              1860 08669000
         L     @14,@SA00010                                        1860 08670000
         LM    @00,@12,@SA00010+8                                  1860 08671000
         BR    @14                                                 1860 08672000
*        /************************************************************/ 08673000
*        /*                                                          */ 08674000
*        /*  SET CTGPLPTR TO BE GDPTRCPL, SO THAT IT POINTS TO THE   */ 08675000
*        /*  CPL BUILT FOR THE GDG BASE.                             */ 08676000
*        /*                                                          */ 08677000
*        /************************************************************/ 08678000
*                                                                  1861 08679000
*        CTGPLPTR = GDPTRCPL;                                      1861 08680000
*                                                                  1861 08681000
@RF01859 L     @04,GDPTRCPL                                        1861 08682000
         ST    @04,CTGPLPTR                                        1861 08683000
*        /************************************************************/ 08684000
*        /*                                                          */ 08685000
*        /*  NOW GET THE CONTROL RECORD AND PUT IT INTO THE BUFFER.  */ 08686000
*        /*                                                          */ 08687000
*        /************************************************************/ 08688000
*                                                                  1862 08689000
*        CALL IDCIOGT0(GDTTBL,PINIOCS);                            1862 08690000
*                                                                  1862 08691000
         L     @04,@PC00001                                        1862 08692000
         ST    @04,@AL00001                                        1862 08693000
         LA    @15,PINIOCS                                         1862 08694000
         ST    @15,@AL00001+4                                      1862 08695000
         MVI   @AL00001+4,X'80'                                    1862 08696000
         L     @15,GDTGET(,@04)                                    1862 08697000
         LA    @01,@AL00001                                        1862 08698000
         BALR  @14,@15                                             1862 08699000
*        RESPECIFY RTNREG RSTD;                                    1863 08700000
*        TESTRC = RTNREG;                                          1864 08701000
         STH   RTNREG,TESTRC                                       1864 08702000
*        RESPECIFY RTNREG UNRSTD;                                  1865 08703000
*        IF TESTRC ^= 0                                            1866 08704000
*          THEN                                                    1866 08705000
         LH    @04,TESTRC                                          1866 08706000
         LTR   @04,@04                                             1866 08707000
         BZ    @RF01866                                            1866 08708000
*            RETURN CODE(LASTCC12);                                1867 08709000
*                                                                  1867 08710000
         LA    @15,12                                              1867 08711000
         L     @14,@SA00010                                        1867 08712000
         LM    @00,@12,@SA00010+8                                  1867 08713000
         BR    @14                                                 1867 08714000
*        TFVTLEN = IOCDAD -> HEADLN;                               1868 08715000
@RF01866 L     @04,IOCSPTR                                         1868 08716000
         L     @01,IOCDAD(,@04)                                    1868 08717000
         LH    @15,HEADLN(,@01)                                    1868 08718000
         STH   @15,TFVTLEN                                         1868 08719000
*        CALL MVDAPROC(TFVTLEN,IOCDAD,CONRCPTR);                   1869 08720000
*                                                                  1869 08721000
         LA    @15,TFVTLEN                                         1869 08722000
         ST    @15,@AL00001                                        1869 08723000
         ST    @04,@AL00001+4                                      1869 08724000
         LA    @04,CONRCPTR                                        1869 08725000
         ST    @04,@AL00001+8                                      1869 08726000
         LA    @01,@AL00001                                        1869 08727000
         BAL   @14,MVDAPROC                                        1869 08728000
*        /************************************************************/ 08729000
*        /*                                                          */ 08730000
*        /*  TEST TO MAKE SURE THAT WE GOT A CATALOG CONTROL         */ 08731000
*        /*  RECORD.                                                 */ 08732000
*        /*                                                          */ 08733000
*        /************************************************************/ 08734000
*                                                                  1870 08735000
*        IF HEADFLG1 ^= HDFL1CAT | HEADFLG2 ^= HDFL2GDG            1870 08736000
*          THEN                                                    1870 08737000
         L     @04,CONRCPTR                                        1870 08738000
         CLI   HEADFLG1(@04),X'FF'                                 1870 08739000
         BNE   @RT01870                                            1870 08740000
         CLI   HEADFLG2(@04),C'B'                                  1870 08741000
         BE    @RF01870                                            1870 08742000
@RT01870 DS    0H                                                  1871 08743000
*            DO;                                                   1871 08744000
*                                                                  1871 08745000
*            /********************************************************/ 08746000
*            /*                                                      */ 08747000
*            /*  WE DID NOT GET A CATALOG CONTROL RECORD.  THE       */ 08748000
*            /*  PORTABLE DATA SET IS IN ERROR.  RETURN TO THE       */ 08749000
*            /*  CALLER WITH AN ERROR INDICATION.                    */ 08750000
*            /*                                                      */ 08751000
*            /********************************************************/ 08752000
*                                                                  1872 08753000
*            DEFSTID = PORTERR;                                    1872 08754000
         MVI   DEFSTID,X'01'                                       1872 08755000
*            RETURN CODE(LASTCC12);                                1873 08756000
         LA    @15,12                                              1873 08757000
         L     @14,@SA00010                                        1873 08758000
         LM    @00,@12,@SA00010+8                                  1873 08759000
         BR    @14                                                 1873 08760000
*            END;                                                  1874 08761000
*                                                                  1874 08762000
*        /************************************************************/ 08763000
*        /*                                                          */ 08764000
*        /*  SET THE VALUE OF THE AMOUNT OF SPACE REQUIRED FOR       */ 08765000
*        /*  THE CATALOG DATA RECORD.                                */ 08766000
*        /*                                                          */ 08767000
*        /************************************************************/ 08768000
*                                                                  1875 08769000
*        TOTLEN = ASSRECLN;                                        1875 08770000
*                                                                  1875 08771000
@RF01870 L     @04,CONRCPTR                                        1875 08772000
         LH    @04,ASSRECLN(,@04)                                  1875 08773000
         ST    @04,TOTLEN                                          1875 08774000
*        /************************************************************/ 08775000
*        /*                                                          */ 08776000
*        /*  ISSUE A UGPOOL TO GET THE BUFFER FOR THE DATA RECORD.   */ 08777000
*        /*  SHOULD THIS FAIL, RETURN TO THE CALLING PROCESSOR WITH  */ 08778000
*        /*  AN ERROR INDICATION.                                    */ 08779000
*        /*                                                          */ 08780000
*        /************************************************************/ 08781000
*                                                                  1876 08782000
*        CALL IDCSAGP0(GDTTBL,TOTLEN,GDWORKAR,GPID,SETZERO);       1876 08783000
*                                                                  1876 08784000
         L     @04,@PC00001                                        1876 08785000
         ST    @04,@AL00001                                        1876 08786000
         LA    @15,TOTLEN                                          1876 08787000
         ST    @15,@AL00001+4                                      1876 08788000
         LA    @15,GDWORKAR                                        1876 08789000
         ST    @15,@AL00001+8                                      1876 08790000
         LA    @15,GPID                                            1876 08791000
         ST    @15,@AL00001+12                                     1876 08792000
         LA    @15,SETZERO                                         1876 08793000
         ST    @15,@AL00001+16                                     1876 08794000
         MVI   @AL00001+16,X'80'                                   1876 08795000
         L     @15,GDTGPL(,@04)                                    1876 08796000
         LA    @01,@AL00001                                        1876 08797000
         BALR  @14,@15                                             1876 08798000
*        RESPECIFY RTNREG RSTD;                                    1877 08799000
*        TESTRC = RTNREG;                                          1878 08800000
         STH   RTNREG,TESTRC                                       1878 08801000
*        RESPECIFY RTNREG UNRSTD;                                  1879 08802000
*        IF TESTRC ^= 0                                            1880 08803000
*          THEN                                                    1880 08804000
         LH    @04,TESTRC                                          1880 08805000
         LTR   @04,@04                                             1880 08806000
         BZ    @RF01880                                            1880 08807000
*            DO;                                                   1881 08808000
*            DEFSTID = NOSTORAG;                                   1882 08809000
         MVI   DEFSTID,X'04'                                       1882 08810000
*            DARGSMOD = UNIVMSG;                                   1883 08811000
         L     @04,DDSTRU                                          1883 08812000
         MVC   DARGSMOD(3,@04),@CC00981                            1883 08813000
*            END;                                                  1884 08814000
*                                                                  1884 08815000
*        /************************************************************/ 08816000
*        /*                                                          */ 08817000
*        /*  GET THE DATA RECORD USING GETPROC TO ASSEMBLE IT IN     */ 08818000
*        /*  THE BUFFER.                                             */ 08819000
*        /*                                                          */ 08820000
*        /************************************************************/ 08821000
*                                                                  1885 08822000
*        CALL GETPROC(GDWORKAR,ASSRECLN);                          1885 08823000
@RF01880 LA    @04,GDWORKAR                                        1885 08824000
         ST    @04,@AL00001                                        1885 08825000
         L     @04,CONRCPTR                                        1885 08826000
         LA    @04,ASSRECLN(,@04)                                  1885 08827000
         ST    @04,@AL00001+4                                      1885 08828000
         LA    @01,@AL00001                                        1885 08829000
         BAL   @14,GETPROC                                         1885 08830000
*        RESPECIFY RTNREG RSTD;                                    1886 08831000
*        TESTRC = RTNREG;                                          1887 08832000
         STH   RTNREG,TESTRC                                       1887 08833000
*        RESPECIFY RTNREG UNRSTD;                                  1888 08834000
*        IF TESTRC ^= 0                                            1889 08835000
*          THEN                                                    1889 08836000
         LH    @04,TESTRC                                          1889 08837000
         LTR   @04,@04                                             1889 08838000
         BZ    @RF01889                                            1889 08839000
*            RETURN CODE(LASTCC12);                                1890 08840000
*                                                                  1890 08841000
         LA    @15,12                                              1890 08842000
         L     @14,@SA00010                                        1890 08843000
         LM    @00,@12,@SA00010+8                                  1890 08844000
         BR    @14                                                 1890 08845000
*        DICTPTR = ADDR(VARDATA);                                  1891 08846000
@RF01889 L     @04,CONRCPTR                                        1891 08847000
         LA    @04,VARDATA(,@04)                                   1891 08848000
         ST    @04,DICTPTR                                         1891 08849000
*        /************************************************************/ 08850000
*        /*                                                          */ 08851000
*        /*  CALL NFVTPROC TO BUILD THE FVT TO BE USED TO DEFINE     */ 08852000
*        /*  THE GDG BASE ENTRY.                                     */ 08853000
*        /*                                                          */ 08854000
*        /************************************************************/ 08855000
*                                                                  1892 08856000
*        CALL NFVTPROC(DICTPTR,GDWORKAR,GDFVTPTR,NULLPARM);        1892 08857000
*                                                                  1892 08858000
         LA    @04,DICTPTR                                         1892 08859000
         ST    @04,@AL00001                                        1892 08860000
         LA    @04,GDWORKAR                                        1892 08861000
         ST    @04,@AL00001+4                                      1892 08862000
         LA    @04,GDFVTPTR                                        1892 08863000
         ST    @04,@AL00001+8                                      1892 08864000
         LA    @04,NULLPARM                                        1892 08865000
         ST    @04,@AL00001+12                                     1892 08866000
         LA    @01,@AL00001                                        1892 08867000
         BAL   @14,NFVTPROC                                        1892 08868000
*        /************************************************************/ 08869000
*        /*                                                          */ 08870000
*        /*  TEST THE RETURN CODE AND RETURN TO THE CALLING          */ 08871000
*        /*  PROCESSOR IF AN ERROR IS INDICATED.                     */ 08872000
*        /*                                                          */ 08873000
*        /************************************************************/ 08874000
*                                                                  1893 08875000
*        RESPECIFY RTNREG RSTD;                                    1893 08876000
*        TESTRC = RTNREG;                                          1894 08877000
         STH   RTNREG,TESTRC                                       1894 08878000
*        RESPECIFY RTNREG UNRSTD;                                  1895 08879000
*        IF TESTRC ^= 0                                            1896 08880000
*          THEN                                                    1896 08881000
         LH    @04,TESTRC                                          1896 08882000
         LTR   @04,@04                                             1896 08883000
         BZ    @RF01896                                            1896 08884000
*            RETURN CODE(LASTCC12);                                1897 08885000
*                                                                  1897 08886000
         LA    @15,12                                              1897 08887000
         L     @14,@SA00010                                        1897 08888000
         LM    @00,@12,@SA00010+8                                  1897 08889000
         BR    @14                                                 1897 08890000
*        CTGFVT = GDFVTPTR;                                        1898 08891000
*                                                                  1898 08892000
@RF01896 L     @04,GDFVTPTR                                        1898 08893000
         L     @01,CTGPLPTR                                        1898 08894000
         ST    @04,CTGFVT(,@01)                                    1898 08895000
*        /************************************************************/ 08896000
*        /*                                                          */ 08897000
*        /*  WE OMIT SCANNING THE OBJECTS LIST FOR THERE ARE NO      */ 08898000
*        /*  OBJECTS SUBPARAMETERS THAT APPLY TO GDG BASES.          */ 08899000
*        /*                                                          */ 08900000
*        /************************************************************/ 08901000
*                                                                  1899 08902000
*        /************************************************************/ 08903000
*        /*                                                          */ 08904000
*        /*  SAVE THE CPL, THE FVT, AND THE FPL'S PRIOR TO INVOKING  */ 08905000
*        /*  CATALOG MANAGEMENT.  IF THE GDG OBJECT IS A             */ 08906000
*        /*  DUPLICATE, IT IS DELETED, AND REDEFINED INTO THE        */ 08907000
*        /*  CATALOG.                                                */ 08908000
*        /*                                                          */ 08909000
*        /************************************************************/ 08910000
*                                                                  1899 08911000
*        TFVTLEN = LENGTH(CTGFV) + (LENGTH(CTGFL)+8)*NVNUMFLD +    1899 08912000
*           LENGTH(IDAAMDSB);                               /*OZ09380*/ 08913000
         LA    @15,380                                             1899 08914000
         STH   @15,TFVTLEN                                         1899 08915000
*        SAVCPL = GDPTRCPL -> FIELDR(1:LENGTH(CTGPL)+16);          1900 08916000
*                                                                  1900 08917000
         L     @01,GDPTRCPL                                        1900 08918000
         MVC   SAVCPL(44),FIELDR(@01)                              1900 08919000
*        /************************************************************/ 08920000
*        /*                                                          */ 08921000
*        /*  POINT TO THE SAVE AREA FOR THE FVT, WHICH FOLLOWS       */ 08922000
*        /*  THE AREA FOR THE FVT ITSELF.  THIS LOCATION IN CORE     */ 08923000
*        /*  HODLS THE FVT, THE FPL'S, AND THE AMDSB.                */ 08924000
*        /*                                                          */ 08925000
*        /************************************************************/ 08926000
*                                                                  1901 08927000
*        GDSAVFVT = GDFVTPTR + TFVTLEN;                            1901 08928000
*                                                                  1901 08929000
         ALR   @04,@15                                             1901 08930000
         ST    @04,GDSAVFVT                                        1901 08931000
*        CALL MVDAPROC(TFVTLEN,GDFVTPTR,GDSAVFVT);                 1902 08932000
*                                                                  1902 08933000
         LA    @04,TFVTLEN                                         1902 08934000
         ST    @04,@AL00001                                        1902 08935000
         LA    @04,GDFVTPTR                                        1902 08936000
         ST    @04,@AL00001+4                                      1902 08937000
         LA    @04,GDSAVFVT                                        1902 08938000
         ST    @04,@AL00001+8                                      1902 08939000
         LA    @01,@AL00001                                        1902 08940000
         BAL   @14,MVDAPROC                                        1902 08941000
*        /************************************************************/ 08942000
*        /*                                                          */ 08943000
*        /*  CALL CTLGPROC TO ACTUALLY INVOKE VSAM CATALOG           */ 08944000
*        /*  MANAGEMENT TO DO THE DEFINE OF THE GDG BASE.            */ 08945000
*        /*  SET IMPF2NER TO BE ON TO INDICATE THAT ERROR            */ 08946000
*        /*  MESSAGES ARE TO BE SUPPRESSED.                          */ 08947000
*        /*                                                          */ 08948000
*        /************************************************************/ 08949000
*                                                                  1903 08950000
*        IMPF2NER = ON;                                            1903 08951000
         OI    IMPF2NER,B'00001000'                                1903 08952000
*        CALL CTLGPROC(GDPTRCPL);                                  1904 08953000
         LA    @04,GDPTRCPL                                        1904 08954000
         ST    @04,@AL00001                                        1904 08955000
         LA    @01,@AL00001                                        1904 08956000
         BAL   @14,CTLGPROC                                        1904 08957000
*        RESPECIFY RTNREG RSTD;                                    1905 08958000
*        TESTRC = RTNREG;                                          1906 08959000
         STH   RTNREG,TESTRC                                       1906 08960000
*        RESPECIFY RTNREG UNRSTD;                                  1907 08961000
*                                                                  1907 08962000
*        /************************************************************/ 08963000
*        /*                                                          */ 08964000
*        /*  RESET IMPF2NER TO BE OFF TO INDICATE THAT ERROR         */ 08965000
*        /*  MESSAGES ARE TO BE PRINTED.                             */ 08966000
*        /*                                                          */ 08967000
*        /************************************************************/ 08968000
*                                                                  1908 08969000
*        IMPF2NER = OFF;                                           1908 08970000
*                                                                  1908 08971000
         NI    IMPF2NER,B'11110111'                                1908 08972000
*        /************************************************************/ 08973000
*        /*                                                          */ 08974000
*        /*  A NONZERO RETURN CODE INDICATES THAT CATALOG WAS NOT    */ 08975000
*        /*  ABLE TO DEFINE THE USER CATALOG POINTER.                */ 08976000
*        /*                                                          */ 08977000
*        /************************************************************/ 08978000
*                                                                  1909 08979000
*        IF TESTRC ^= 0                                            1909 08980000
*          THEN                                                    1909 08981000
*                                                                  1909 08982000
         LH    @04,TESTRC                                          1909 08983000
         LTR   @04,@04                                             1909 08984000
         BZ    @RF01909                                            1909 08985000
*            /********************************************************/ 08986000
*            /*                                                      */ 08987000
*            /*  TEST FOR A VSAM CATALOG RETURN CODE OF 8.  THIS     */ 08988000
*            /*  INDICATES THAT THERE IS A DUPLICATE NAME IN THE     */ 08989000
*            /*  IN THE CATALOG.                                     */ 08990000
*            /*                                                      */ 08991000
*            /********************************************************/ 08992000
*                                                                  1910 08993000
*            IF CATLGRC ^= DUPNAME                                 1910 08994000
*              THEN                                                1910 08995000
         CLC   CATLGRC(2),@CH00039                                 1910 08996000
         BE    @RF01910                                            1910 08997000
*                DO;                                               1911 08998000
*                DARGSMOD = IMPMSG;                                1912 08999000
         L     @04,DDSTRU                                          1912 09000000
         MVC   DARGSMOD(3,@04),@CC00945                            1912 09001000
*                DARGSENT = MPRAFAIL;                              1913 09002000
         MVI   DARGSENT(@04),X'15'                                 1913 09003000
*                DARGILP = LENGTH(FENTNAME);                       1914 09004000
         MVC   DARGILP(2,@04),@CH00605                             1914 09005000
*                DARGDBP = GDFVTPTR -> CTGFVENT;                   1915 09006000
*                                                                  1915 09007000
         L     @01,GDFVTPTR                                        1915 09008000
         L     @15,CTGFVENT(,@01)                                  1915 09009000
         ST    @15,DARGDBP(,@04)                                   1915 09010000
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             1916 09011000
         L     @04,@PC00001                                        1916 09012000
         ST    @04,@AL00001                                        1916 09013000
         LA    @15,@CF00119                                        1916 09014000
         ST    @15,@AL00001+4                                      1916 09015000
         LA    @15,DDSTRU                                          1916 09016000
         ST    @15,@AL00001+8                                      1916 09017000
         MVI   @AL00001+8,X'80'                                    1916 09018000
         L     @15,GDTPRT(,@04)                                    1916 09019000
         LA    @01,@AL00001                                        1916 09020000
         BALR  @14,@15                                             1916 09021000
*                DARGLIST = ''B;                                   1917 09022000
         L     @04,DDSTRU                                          1917 09023000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1917 09024000
*                DARGSMOD = IMPMSG;                                1918 09025000
*                                                                  1918 09026000
         MVC   DARGSMOD(3,@04),@CC00945                            1918 09027000
*                RETURN CODE(LASTCC08);                            1919 09028000
         LA    @15,8                                               1919 09029000
         L     @14,@SA00010                                        1919 09030000
         LM    @00,@12,@SA00010+8                                  1919 09031000
         BR    @14                                                 1919 09032000
*                END;                                              1920 09033000
*              ELSE                                                1921 09034000
*DUPGDG:         DO;                                               1921 09035000
@RF01910 DS    0H                                                  1921 09036000
DUPGDG   DS    0H                                                  1922 09037000
*                OLDERID2 = NEWERID2;                              1922 09038000
         L     @04,@PC00001                                        1922 09039000
         L     @04,GDTTR2(,@04)                                    1922 09040000
         MVC   @TS00001(95),NEWERID2(@04)                          1922 09041000
         MVC   OLDERID2(95,@04),@TS00001                           1922 09042000
*                NEWID2 = 'RMDG';                                  1923 09043000
*                                                                  1923 09044000
         MVC   NEWID2(4,@04),@CC01464                              1923 09045000
*                /****************************************************/ 09046000
*                /*                                                  */ 09047000
*                /*  AN ENTRY FOR THE OBJECT TO BE DEFINED ALREADY   */ 09048000
*                /*  EXISTS IN THE CATALOG.  CALL CPLPROC TO BUILD   */ 09049000
*                /*  A CPL FOR THE DELETE FUNCTION.                  */ 09050000
*                /*                                                  */ 09051000
*                /****************************************************/ 09052000
*                                                                  1924 09053000
*                CALL CPLPROC('D',DCPLPTR,CTGFVENT,NULLPARM,CPSWD);     09054000
*                                                                  1924 09055000
         LA    @04,@CC00751                                        1924 09056000
         ST    @04,@AL00001                                        1924 09057000
         LA    @04,DCPLPTR                                         1924 09058000
         ST    @04,@AL00001+4                                      1924 09059000
         L     @04,CTGFVPTR                                        1924 09060000
         LA    @04,CTGFVENT(,@04)                                  1924 09061000
         ST    @04,@AL00001+8                                      1924 09062000
         LA    @04,NULLPARM                                        1924 09063000
         ST    @04,@AL00001+12                                     1924 09064000
         LA    @04,CPSWD                                           1924 09065000
         ST    @04,@AL00001+16                                     1924 09066000
         LA    @01,@AL00001                                        1924 09067000
         BAL   @14,CPLPROC                                         1924 09068000
*                /****************************************************/ 09069000
*                /*                                                  */ 09070000
*                /*  TEST THE RETURN CODE FROM CPLPROC.  IF THE CPL  */ 09071000
*                /*  WAS NOT BUILT RETURN TO THE CALLING PROCESSOR.  */ 09072000
*                /*                                                  */ 09073000
*                /****************************************************/ 09074000
*                                                                  1925 09075000
*                RESPECIFY RTNREG RSTD;                            1925 09076000
*                TESTRC = RTNREG;                                  1926 09077000
         STH   RTNREG,TESTRC                                       1926 09078000
*                RESPECIFY RTNREG UNRSTD;                          1927 09079000
*                IF TESTRC ^= 0                                    1928 09080000
*                  THEN                                            1928 09081000
         LH    @04,TESTRC                                          1928 09082000
         LTR   @04,@04                                             1928 09083000
         BZ    @RF01928                                            1928 09084000
*                    RETURN CODE(LASTCC12);                        1929 09085000
*                                                                  1929 09086000
         LA    @15,12                                              1929 09087000
         L     @14,@SA00010                                        1929 09088000
         LM    @00,@12,@SA00010+8                                  1929 09089000
         BR    @14                                                 1929 09090000
*                /****************************************************/ 09091000
*                /*                                                  */ 09092000
*                /*  IN ORDER TO FORCE DELETE A NONEMPTY GDG BASE,   */ 09093000
*                /*  SET CTGSCR TO ON.                               */ 09094000
*                /*                                                  */ 09095000
*                /****************************************************/ 09096000
*                                                                  1930 09097000
*                CTGSCR = ON;                                      1930 09098000
*                                                                  1930 09099000
@RF01928 L     @04,CTGPLPTR                                        1930 09100000
         OI    CTGSCR(@04),B'00000010'                             1930 09101000
*                /****************************************************/ 09102000
*                /*                                                  */ 09103000
*                /*  CALL DELTPROC TO DELETE THE GDG BASE AND ITS    */ 09104000
*                /*  ASSOCIATIONS.                                   */ 09105000
*                /*                                                  */ 09106000
*                /****************************************************/ 09107000
*                                                                  1931 09108000
*                CALL DELTPROC(DCPLPTR);                           1931 09109000
*                                                                  1931 09110000
         LA    @04,DCPLPTR                                         1931 09111000
         ST    @04,@AL00001                                        1931 09112000
         LA    @01,@AL00001                                        1931 09113000
         BAL   @14,DELTPROC                                        1931 09114000
*                /****************************************************/ 09115000
*                /*                                                  */ 09116000
*                /*  TEST THE RETURN CODE FROM DELTPROC.  IF IT IS   */ 09117000
*                /*  NON-ZERO, RETURN TO THE CALLING PROCESSOR WITH  */ 09118000
*                /*  AN ERROR INDICATION.  OTHERWISE, RESET THE      */ 09119000
*                /*  VALUE OF DEFSTID TO NORMSTAT TO INDICATE THAT   */ 09120000
*                /*  THE ERROR INCURRED ON THE FIRST CMS DEFINE      */ 09121000
*                /*  HAS BEEN CLEARED.                               */ 09122000
*                /*                                                  */ 09123000
*                /****************************************************/ 09124000
*                                                                  1932 09125000
*                RESPECIFY RTNREG RSTD;                            1932 09126000
*                TESTRC = RTNREG;                                  1933 09127000
         STH   RTNREG,TESTRC                                       1933 09128000
*                RESPECIFY RTNREG UNRSTD;                          1934 09129000
*                IF TESTRC ^= 0                                    1935 09130000
*                  THEN                                            1935 09131000
         LH    @04,TESTRC                                          1935 09132000
         LTR   @04,@04                                             1935 09133000
         BZ    @RF01935                                            1935 09134000
*                    DO;                                           1936 09135000
*                    DARGSENT = MPRAFAIL;                          1937 09136000
         L     @04,DDSTRU                                          1937 09137000
         MVI   DARGSENT(@04),X'15'                                 1937 09138000
*                    DARGSMOD = IMPMSG;                            1938 09139000
         MVC   DARGSMOD(3,@04),@CC00945                            1938 09140000
*                    DARGILP = LENGTH(FENTNAME);                   1939 09141000
         MVC   DARGILP(2,@04),@CH00605                             1939 09142000
*                    DARGDBP = GDFVTPTR -> CTGFVENT;               1940 09143000
         L     @01,GDFVTPTR                                        1940 09144000
         L     @15,CTGFVENT(,@01)                                  1940 09145000
         ST    @15,DARGDBP(,@04)                                   1940 09146000
*                    CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         1941 09147000
         L     @04,@PC00001                                        1941 09148000
         ST    @04,@AL00001                                        1941 09149000
         LA    @15,@CF00119                                        1941 09150000
         ST    @15,@AL00001+4                                      1941 09151000
         LA    @15,DDSTRU                                          1941 09152000
         ST    @15,@AL00001+8                                      1941 09153000
         MVI   @AL00001+8,X'80'                                    1941 09154000
         L     @15,GDTPRT(,@04)                                    1941 09155000
         LA    @01,@AL00001                                        1941 09156000
         BALR  @14,@15                                             1941 09157000
*                    DARGLIST = ''B;                               1942 09158000
         L     @04,DDSTRU                                          1942 09159000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1942 09160000
*                    DARGSMOD = IMPMSG;                            1943 09161000
         MVC   DARGSMOD(3,@04),@CC00945                            1943 09162000
*                    END;                                          1944 09163000
*                                                                  1944 09164000
*                /****************************************************/ 09165000
*                /*                                                  */ 09166000
*                /*  RESTORE THE CATALOG PARAMETER LISTS TO THEIR    */ 09167000
*                /*  STATE PRIOR TO THE FIRST CMS DEFINE OPERATION.  */ 09168000
*                /*                                                  */ 09169000
*                /****************************************************/ 09170000
*                                                                  1945 09171000
*                GDPTRCPL -> FIELDR(1:LENGTH(CTGPL)+16) = SAVCPL;  1945 09172000
@RF01935 L     @04,GDPTRCPL                                        1945 09173000
         MVC   FIELDR(44,@04),SAVCPL                               1945 09174000
*                CALL MVDAPROC(TFVTLEN,GDSAVFVT,GDFVTPTR);         1946 09175000
*                                                                  1946 09176000
         LA    @04,TFVTLEN                                         1946 09177000
         ST    @04,@AL00001                                        1946 09178000
         LA    @04,GDSAVFVT                                        1946 09179000
         ST    @04,@AL00001+4                                      1946 09180000
         LA    @04,GDFVTPTR                                        1946 09181000
         ST    @04,@AL00001+8                                      1946 09182000
         LA    @01,@AL00001                                        1946 09183000
         BAL   @14,MVDAPROC                                        1946 09184000
*                /****************************************************/ 09185000
*                /*                                                  */ 09186000
*                /*  CALL CTLGPROC TO INVOKE CATALOG MANAGEMENT.     */ 09187000
*                /*                                                  */ 09188000
*                /****************************************************/ 09189000
*                                                                  1947 09190000
*                CALL CTLGPROC(GDPTRCPL);                          1947 09191000
*                                                                  1947 09192000
         LA    @04,GDPTRCPL                                        1947 09193000
         ST    @04,@AL00001                                        1947 09194000
         LA    @01,@AL00001                                        1947 09195000
         BAL   @14,CTLGPROC                                        1947 09196000
*                /****************************************************/ 09197000
*                /*                                                  */ 09198000
*                /*  TEST THE RETURN CODE FROM CTLGPROC.  IF IT IS   */ 09199000
*                /*  NON-ZERO, THE SECOND ATTEMPT TO DEFINE THE      */ 09200000
*                /*  OBJECT HAS ALSO FAILED.  RETURN TO THE CALLING  */ 09201000
*                /*  PROCESSOR WITH AN ERROR INDICATED.              */ 09202000
*                /*                                                  */ 09203000
*                /****************************************************/ 09204000
*                                                                  1948 09205000
*                RESPECIFY RTNREG RSTD;                            1948 09206000
*                TESTRC = RTNREG;                                  1949 09207000
         STH   RTNREG,TESTRC                                       1949 09208000
*                RESPECIFY RTNREG UNRSTD;                          1950 09209000
*                IF TESTRC ^= 0                                    1951 09210000
*                  THEN                                            1951 09211000
         LH    @04,TESTRC                                          1951 09212000
         LTR   @04,@04                                             1951 09213000
         BZ    @RF01951                                            1951 09214000
*                    DO;                                           1952 09215000
*                    DARGSENT = MPRAFAIL;                          1953 09216000
         L     @04,DDSTRU                                          1953 09217000
         MVI   DARGSENT(@04),X'15'                                 1953 09218000
*                    DARGSMOD = IMPMSG;                            1954 09219000
         MVC   DARGSMOD(3,@04),@CC00945                            1954 09220000
*                    DARGILP = LENGTH(FENTNAME);                   1955 09221000
         MVC   DARGILP(2,@04),@CH00605                             1955 09222000
*                    DARGDBP = GDFVTPTR -> CTGFVENT;               1956 09223000
         L     @01,GDFVTPTR                                        1956 09224000
         L     @15,CTGFVENT(,@01)                                  1956 09225000
         ST    @15,DARGDBP(,@04)                                   1956 09226000
*                    CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);         1957 09227000
         L     @04,@PC00001                                        1957 09228000
         ST    @04,@AL00001                                        1957 09229000
         LA    @15,@CF00119                                        1957 09230000
         ST    @15,@AL00001+4                                      1957 09231000
         LA    @15,DDSTRU                                          1957 09232000
         ST    @15,@AL00001+8                                      1957 09233000
         MVI   @AL00001+8,X'80'                                    1957 09234000
         L     @15,GDTPRT(,@04)                                    1957 09235000
         LA    @01,@AL00001                                        1957 09236000
         BALR  @14,@15                                             1957 09237000
*                    DARGLIST = ''B;                               1958 09238000
         L     @04,DDSTRU                                          1958 09239000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1958 09240000
*                    DARGSMOD = IMPMSG;                            1959 09241000
         MVC   DARGSMOD(3,@04),@CC00945                            1959 09242000
*                    END;                                          1960 09243000
*                                                                  1960 09244000
*                END DUPGDG;                                       1961 09245000
*                                                                  1961 09246000
@RF01951 DS    0H                                                  1962 09247000
*        /************************************************************/ 09248000
*        /*                                                          */ 09249000
*        /*  PRINT A MESSAGE TO INDICATE WHAT HAS BEEN IMPORTED      */ 09250000
*        /*  SUCCESSFULLY.                                           */ 09251000
*        /*                                                          */ 09252000
*        /************************************************************/ 09253000
*                                                                  1962 09254000
*        DARGSMOD = IMPMSG;                                        1962 09255000
@RF01909 L     @04,DDSTRU                                          1962 09256000
         MVC   DARGSMOD(3,@04),@CC00945                            1962 09257000
*        DARGSENT = MPRASUCC;                                      1963 09258000
         MVI   DARGSENT(@04),X'1A'                                 1963 09259000
*        DARGILP = LENGTH(FENTNAME);                               1964 09260000
         MVC   DARGILP(2,@04),@CH00605                             1964 09261000
*        DARGDBP = GDFVTPTR -> CTGFVENT;                           1965 09262000
         L     @01,GDFVTPTR                                        1965 09263000
         L     @15,CTGFVENT(,@01)                                  1965 09264000
         ST    @15,DARGDBP(,@04)                                   1965 09265000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                     1966 09266000
         L     @04,@PC00001                                        1966 09267000
         ST    @04,@AL00001                                        1966 09268000
         LA    @15,@CF00119                                        1966 09269000
         ST    @15,@AL00001+4                                      1966 09270000
         LA    @15,DDSTRU                                          1966 09271000
         ST    @15,@AL00001+8                                      1966 09272000
         MVI   @AL00001+8,X'80'                                    1966 09273000
         L     @15,GDTPRT(,@04)                                    1966 09274000
         LA    @01,@AL00001                                        1966 09275000
         BALR  @14,@15                                             1966 09276000
*        DARGLIST = ''B;                                           1967 09277000
         L     @04,DDSTRU                                          1967 09278000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      1967 09279000
*        DARGSMOD = IMPMSG;                                        1968 09280000
*                                                                  1968 09281000
         MVC   DARGSMOD(3,@04),@CC00945                            1968 09282000
*        /************************************************************/ 09283000
*        /*                                                          */ 09284000
*        /*  FREE UP THE CORE GOTTEN FOR THE DATA RECORD BUFFER.     */ 09285000
*        /*                                                          */ 09286000
*        /************************************************************/ 09287000
*                                                                  1969 09288000
*        CALL IDCSAFS0(GDTTBL,GDWORKAR);                           1969 09289000
*                                                                  1969 09290000
         L     @04,@PC00001                                        1969 09291000
         ST    @04,@AL00001                                        1969 09292000
         LA    @15,GDWORKAR                                        1969 09293000
         ST    @15,@AL00001+4                                      1969 09294000
         L     @15,GDTFSP(,@04)                                    1969 09295000
         LA    @01,@AL00001                                        1969 09296000
         BALR  @14,@15                                             1969 09297000
*        RESPECIFY RTNREG RSTD;                                    1970 09298000
*        TESTRC = RTNREG;                                          1971 09299000
         STH   RTNREG,TESTRC                                       1971 09300000
*        RESPECIFY RTNREG UNRSTD;                                  1972 09301000
*        IF TESTRC ^= 0                                            1973 09302000
*          THEN                                                    1973 09303000
         LH    @04,TESTRC                                          1973 09304000
         LTR   @04,@04                                             1973 09305000
         BZ    @RF01973                                            1973 09306000
*            RETURN CODE(LASTCC12);                                1974 09307000
*                                                                  1974 09308000
         LA    @15,12                                              1974 09309000
         L     @14,@SA00010                                        1974 09310000
         LM    @00,@12,@SA00010+8                                  1974 09311000
         BR    @14                                                 1974 09312000
*        /************************************************************/ 09313000
*        /*                                                          */ 09314000
*        /*  FREE UP THE CORE GOTTEN FOR THE FVT AND FPL'S           */ 09315000
*        /*  CONSTRUCTED FOR THE DEFINE OF THE GDG BASE.             */ 09316000
*        /*                                                          */ 09317000
*        /************************************************************/ 09318000
*                                                                  1975 09319000
*        CALL IDCSAFS0(GDTTBL,GDFVTPTR);                           1975 09320000
*                                                                  1975 09321000
@RF01973 L     @04,@PC00001                                        1975 09322000
         ST    @04,@AL00001                                        1975 09323000
         LA    @15,GDFVTPTR                                        1975 09324000
         ST    @15,@AL00001+4                                      1975 09325000
         L     @15,GDTFSP(,@04)                                    1975 09326000
         LA    @01,@AL00001                                        1975 09327000
         BALR  @14,@15                                             1975 09328000
*        RESPECIFY RTNREG RSTD;                                    1976 09329000
*        TESTRC = RTNREG;                                          1977 09330000
         STH   RTNREG,TESTRC                                       1977 09331000
*        RESPECIFY RTNREG UNRSTD;                                  1978 09332000
*        IF TESTRC ^= 0                                            1979 09333000
*          THEN                                                    1979 09334000
         LH    @04,TESTRC                                          1979 09335000
         LTR   @04,@04                                             1979 09336000
         BZ    @RF01979                                            1979 09337000
*            RETURN CODE(LASTCC12);                                1980 09338000
*                                                                  1980 09339000
         LA    @15,12                                              1980 09340000
         L     @14,@SA00010                                        1980 09341000
         LM    @00,@12,@SA00010+8                                  1980 09342000
         BR    @14                                                 1980 09343000
*        /************************************************************/ 09344000
*        /*                                                          */ 09345000
*        /*  THE NONVSAMS ASSOCIATED WITH THE GDG BASE OBJECT WERE   */ 09346000
*        /*  PUT ON THE PORTABLE DATA SET BY EXPORTRA AS ASSOCIATED  */ 09347000
*        /*  OBJECTS.  WE LOOP UNTIL A SOFTWARE EOF IS FOUND,        */ 09348000
*        /*  DEFINING NONVSAMS AND THEIR ALIASES.                    */ 09349000
*        /*                                                          */ 09350000
*        /************************************************************/ 09351000
*                                                                  1981 09352000
*        /************************************************************/ 09353000
*        /*                                                          */ 09354000
*        /*  SET GETEOF TO OFF TO INDICATE THAT THE END OF FILE      */ 09355000
*        /*  HAS NOT BEEN FOUND.                                     */ 09356000
*        /*                                                          */ 09357000
*        /************************************************************/ 09358000
*                                                                  1981 09359000
*        GETEOF = OFF;                                             1981 09360000
*                                                                  1981 09361000
@RF01979 NI    GETEOF,B'01111111'                                  1981 09362000
*        /************************************************************/ 09363000
*        /*                                                          */ 09364000
*        /*  INITIALIZE NVSMRDSW TO BE OFF.                          */ 09365000
*        /*                                                          */ 09366000
*        /************************************************************/ 09367000
*                                                                  1982 09368000
*        NVSMRDSW = OFF;                                           1982 09369000
*                                                                  1982 09370000
         NI    NVSMRDSW,B'01111111'                                1982 09371000
*        /************************************************************/ 09372000
*        /*                                                          */ 09373000
*        /*  WHILE THE END OF FILE HAS NOT BEEN FOUND, LOOP CALLING  */ 09374000
*        /*  NVSMPROC TO DEFINE THE NONVSAM OBJECTS AND THEIR        */ 09375000
*        /*  ALIASES.                                                */ 09376000
*        /*                                                          */ 09377000
*        /************************************************************/ 09378000
*                                                                  1983 09379000
*        DO WHILE GETEOF = OFF;                                    1983 09380000
*                                                                  1983 09381000
         B     @DE01983                                            1983 09382000
@DL01983 DS    0H                                                  1984 09383000
*          /**********************************************************/ 09384000
*          /*                                                        */ 09385000
*          /*  ISSUE THE CALL TO NVSMPROC, AND TEST THE RETURN       */ 09386000
*          /*  CODE.                                                 */ 09387000
*          /*                                                        */ 09388000
*          /**********************************************************/ 09389000
*                                                                  1984 09390000
*          CALL NVSMPROC;                                          1984 09391000
         BAL   @14,NVSMPROC                                        1984 09392000
*          RESPECIFY RTNREG RSTD;                                  1985 09393000
*          TESTRC = RTNREG;                                        1986 09394000
         STH   RTNREG,TESTRC                                       1986 09395000
*          RESPECIFY RTNREG UNRSTD;                                1987 09396000
*          IF TESTRC ^= 0                                          1988 09397000
*            THEN                                                  1988 09398000
*                                                                  1988 09399000
         LH    @04,TESTRC                                          1988 09400000
         LTR   @04,@04                                             1988 09401000
         BZ    @RF01988                                            1988 09402000
*              /******************************************************/ 09403000
*              /*                                                    */ 09404000
*              /*  IF THE RETURN CODE FROM NVSMPROC INDICATES THAT   */ 09405000
*              /*  A SEVERE ERROR HAS OCCURRED, RETURN TO THE        */ 09406000
*              /*  CALLING PROCESSOR INDICATING THAT FACT.           */ 09407000
*              /*                                                    */ 09408000
*              /******************************************************/ 09409000
*                                                                  1989 09410000
*              IF TESTRC = LASTCC12                                1989 09411000
*                THEN                                              1989 09412000
         LA    @15,12                                              1989 09413000
         CR    @04,@15                                             1989 09414000
         BNE   @RF01989                                            1989 09415000
*                  RETURN CODE(LASTCC12);                          1990 09416000
         L     @14,@SA00010                                        1990 09417000
         LM    @00,@12,@SA00010+8                                  1990 09418000
         BR    @14                                                 1990 09419000
*        END;                                                      1991 09420000
*                                                                  1991 09421000
@RF01989 DS    0H                                                  1991 09422000
@RF01988 DS    0H                                                  1991 09423000
@DE01983 TM    GETEOF,B'10000000'                                  1991 09424000
         BZ    @DL01983                                            1991 09425000
*        /************************************************************/ 09426000
*        /*                                                          */ 09427000
*        /*  RETURN TO THE CALLER                                    */ 09428000
*        /*                                                          */ 09429000
*        /************************************************************/ 09430000
*                                                                  1992 09431000
*        RETURN CODE(0);                                           1992 09432000
*                                                                  1992 09433000
         SLR   @15,@15                                             1992 09434000
         L     @14,@SA00010                                        1992 09435000
         LM    @00,@12,@SA00010+8                                  1992 09436000
         BR    @14                                                 1992 09437000
*END GDGPROC;                                                      1993 09438000
*        /************************************************************/ 09439000
*        /*                                                          */ 09440000
*        /*  PROCEDURE NAME - RANGPROC                               */ 09441000
*        /*                                                          */ 09442000
*        /*  FUNCTION - RANGPROC WILL PROCESS ALL INFORMATIION       */ 09443000
*        /*  DEALING WITH KEYRANGES.  IT WILL BUILD THE RANGES LIST  */ 09444000
*        /*  THE HIKEYV AND LOKEYV CATALOG INFORMATION FROM  VOLUME  */ 09445000
*        /*  OF PORTABILITY.                                         */ 09446000
*        /*                                                          */ 09447000
*        /*  INPUT -                                                 */ 09448000
*        /*    RX - INDEX TO OBJECT PARAMETER OR ZERO                */ 09449000
*        /*    RDICT - DICTIONARY POINTER                            */ 09450000
*        /*    RWKA - WORK AREA POINTER (CONTAINS CATALOG FIELD INFO)*/ 09451000
*        /*    RRANGPTR - PTR TO FIELD IN WHICH TO PLACE LISTRNGS    */ 09452000
*        /*    POINTER                                               */ 09453000
*        /*                                                          */ 09454000
*        /*  OUTPUT - A LISTRNGS LIST OF KEY RANGES WILL HAVE BEEN   */ 09455000
*        /*  CONSTRUCTED                                             */ 09456000
*        /*                                                          */ 09457000
*        /************************************************************/ 09458000
*                                                                  1994 09459000
*RANGPROC: PROCEDURE(RX,               /*INDEX TO OBJECTS PARAMETER  */ 09460000
*                   RDICT,             /*DICTIONARY POINTER          */ 09461000
*                   RWKA,              /*WORK AREA POINTER           */ 09462000
*                   RRANGPTR);         /*RETURN CELL FOR LISTRNGS    */ 09463000
RANGPROC STM   @14,@12,@SA00011                                    1994 09464000
         MVC   @PC00011(16),0(@01)                                 1994 09465000
*                                      /*LIST                        */ 09466000
*                                                                  1995 09467000
*        /************************************************************/ 09468000
*        /*                                                          */ 09469000
*        /*  ARGUMENTS OF INVOCATION                                 */ 09470000
*        /*                                                          */ 09471000
*        /************************************************************/ 09472000
*                                                                  1995 09473000
*        DCL RX        FIXED(31),                                  1995 09474000
*            RDICT     PTR(31),                                    1995 09475000
*            RWKA      PTR(31),                                    1995 09476000
*            RRANGPTR  PTR(31);                                    1995 09477000
*                                                                  1995 09478000
*        /************************************************************/ 09479000
*        /*                                                          */ 09480000
*        /*  LOCAL DECLARES                                          */ 09481000
*        /*                                                          */ 09482000
*        /************************************************************/ 09483000
*        DCL KEYLENGH FIXED(31);                                   1996 09484000
*        DCL 1 FRANGLST BASED(RRANGPTR),                           1997 09485000
*              2 FRANGLN   FIXED(15);  /*LENGTH OF LIST EXCLUDING    */ 09486000
*                                      /*THIS 2-BYTE FIELD           */ 09487000
*        DCL 1 FRANGES BASED(FRANPTR1),/*DESCRIPTION OF EACH HIGH    */ 09488000
*                                      /*KEY-LOW KEY PAIR            */ 09489000
*                2 FKEYLN FIXED(15),   /*LENGTH OF LOW KEY           */ 09490000
*                2 FKEY   CHAR(*);    /*VARIABLE LENGTH KEY          */ 09491000
*        DCL FRANPTR1 PTR(31);         /*POINTER TO EACH MEMBER OF   */ 09492000
*                                      /*LOW KEY-HIGH KEY PAIR       */ 09493000
*                                                                  2000 09494000
*        DCL RPTR1  PTR(31);           /*POINTER TO KEY VALUE        */ 09495000
*        DCL RPTR2  PTR(31);           /*POINTER TO KEY VALUE        */ 09496000
*        DCL LENG   FIXED(15);         /*USED TO CONSTRUCT LISTRNGS  */ 09497000
*                                      /*FROM HIKEYV-LOKEYV FIELDS   */ 09498000
*        DCL RDOCNTRL BIT(1);          /*LOOP CONTROL                */ 09499000
*        DCL LKEY  CHAR(64);                                       2004 09500000
*        DCL HKEY  CHAR(64);           /*HIGH KEY FOR RANGE VALIDITY */ 09501000
*                                      /*CHECK                       */ 09502000
*        DCL   1 FFS    CHAR(64) STATIC LOCAL,                     2006 09503000
*              2 *(64)  CHAR(1)  INIT((64)'FF'X);                  2006 09504000
*                                      /*MAXIMUM KEY VALUE           */ 09505000
*        DCL KERROR BIT(1);            /*SET WHEN KEYRANGES INVALID  */ 09506000
*        DCL HILN  FIXED(31);          /*LENGTH OF HIGH KEY          */ 09507000
*        DCL LOWLN FIXED(31);          /*LENGTH OF LOW KEY           */ 09508000
*                                                                  2009 09509000
*        OLDERID2 = NEWERID2;                                      2010 09510000
         L     @04,@PC00001                                        2010 09511000
         L     @15,GDTTR2(,@04)                                    2010 09512000
         MVC   @TS00001(95),NEWERID2(@15)                          2010 09513000
         MVC   OLDERID2(95,@15),@TS00001                           2010 09514000
*        NEWID2 = 'RMRG';                                          2011 09515000
*                                                                  2011 09516000
         MVC   NEWID2(4,@15),@CC01496                              2011 09517000
*        /************************************************************/ 09518000
*        /*                                                          */ 09519000
*        /*  THE RANGE LIST IS TO BE CONSTRUCTED FROM CATALOG        */ 09520000
*        /*  INFORMATION READ IN FROM THE PORTABILITY VOLUME.        */ 09521000
*        /*  THE HIKEYV AND LOKEYV CATALOG FIELDS CONTAIN THE        */ 09522000
*        /*  INFORMATION                                             */ 09523000
*        /*                                                          */ 09524000
*        /************************************************************/ 09525000
*                                                                  2012 09526000
*        DICTPTR = RDICT;                                          2012 09527000
         L     @15,@PC00011+4                                      2012 09528000
         L     @15,RDICT(,@15)                                     2012 09529000
         ST    @15,DICTPTR                                         2012 09530000
*        IF DICTLN(IHIKEYV) ^= 0 &                                 2013 09531000
*          DICTLN(ILOKEYV) ^= 0                                    2013 09532000
*          THEN                                                    2013 09533000
         SLR   @14,@14                                             2013 09534000
         L     @03,DICTLN+120(,@15)                                2013 09535000
         CR    @03,@14                                             2013 09536000
         BE    @RF02013                                            2013 09537000
         L     @15,DICTLN+112(,@15)                                2013 09538000
         CR    @15,@14                                             2013 09539000
         BE    @RF02013                                            2013 09540000
*            DO;                                                   2014 09541000
*                                                                  2014 09542000
*            /********************************************************/ 09543000
*            /*                                                      */ 09544000
*            /*  COMPUTE SIZE OF RANGES LIST  AND OBTAIN CORE        */ 09545000
*            /*  IF CORE IS NOT OBTAINED, RETURN TO CALLING          */ 09546000
*            /*  PROCESSOR                                           */ 09547000
*            /*                                                      */ 09548000
*            /********************************************************/ 09549000
*                                                                  2015 09550000
*            TOTLEN = DICTLN(IHIKEYV) + DICTLN(ILOKEYV) + 2;       2015 09551000
*                                                                  2015 09552000
         ALR   @03,@15                                             2015 09553000
         AL    @03,@CF00157                                        2015 09554000
         ST    @03,TOTLEN                                          2015 09555000
*            CALL IDCSAGP0 (GDTTBL,TOTLEN,RRANGPTR,GPID,SETZERO);  2016 09556000
*                                                                  2016 09557000
         ST    @04,@AL00001                                        2016 09558000
         LA    @15,TOTLEN                                          2016 09559000
         ST    @15,@AL00001+4                                      2016 09560000
         L     @15,@PC00011+12                                     2016 09561000
         ST    @15,@AL00001+8                                      2016 09562000
         LA    @15,GPID                                            2016 09563000
         ST    @15,@AL00001+12                                     2016 09564000
         LA    @15,SETZERO                                         2016 09565000
         ST    @15,@AL00001+16                                     2016 09566000
         MVI   @AL00001+16,X'80'                                   2016 09567000
         L     @15,GDTGPL(,@04)                                    2016 09568000
         LA    @01,@AL00001                                        2016 09569000
         BALR  @14,@15                                             2016 09570000
*            RESPECIFY RTNREG RSTD;                                2017 09571000
*            TESTRC = RTNREG;                                      2018 09572000
         STH   RTNREG,TESTRC                                       2018 09573000
*            RESPECIFY RTNREG UNRSTD;                              2019 09574000
*            IF TESTRC ^= 0                                        2020 09575000
*              THEN                                                2020 09576000
         LH    @04,TESTRC                                          2020 09577000
         LTR   @04,@04                                             2020 09578000
         BZ    @RF02020                                            2020 09579000
*                DO;                                               2021 09580000
*                DEFSTID = NOSTORAG;                               2022 09581000
         MVI   DEFSTID,X'04'                                       2022 09582000
*                DARGSMOD = UNIVMSG;                               2023 09583000
         L     @04,DDSTRU                                          2023 09584000
         MVC   DARGSMOD(3,@04),@CC00981                            2023 09585000
*                RETURN CODE(LASTCC12);                            2024 09586000
         LA    @15,12                                              2024 09587000
         L     @14,@SA00011                                        2024 09588000
         LM    @00,@12,@SA00011+8                                  2024 09589000
         BR    @14                                                 2024 09590000
*                END;                                              2025 09591000
*                                                                  2025 09592000
*            /********************************************************/ 09593000
*            /*                                                      */ 09594000
*            /*  SET POINTERS TO START OF HIGH KEY AND LOW KEY       */ 09595000
*            /*  VALUES.  INITIALIZE LOOP CONTROL.                   */ 09596000
*            /*                                                      */ 09597000
*            /********************************************************/ 09598000
*                                                                  2026 09599000
*            FRANPTR1 = RRANGPTR + 2;                              2026 09600000
@RF02020 LA    @04,2                                               2026 09601000
         L     @15,@PC00011+12                                     2026 09602000
         L     @15,RRANGPTR(,@15)                                  2026 09603000
         ALR   @15,@04                                             2026 09604000
         ST    @15,FRANPTR1                                        2026 09605000
*            LENG = TOTLEN - 2;                                    2027 09606000
         LCR   @04,@04                                             2027 09607000
         AL    @04,TOTLEN                                          2027 09608000
         STH   @04,LENG                                            2027 09609000
*            RPTR1 = DICTDL(ILOKEYV) + RWKA;                       2028 09610000
         L     @04,DICTPTR                                         2028 09611000
         L     @15,@PC00011+8                                      2028 09612000
         L     @15,RWKA(,@15)                                      2028 09613000
         L     @14,DICTDL+112(,@04)                                2028 09614000
         ALR   @14,@15                                             2028 09615000
         ST    @14,RPTR1                                           2028 09616000
*            RPTR2 = DICTDL(IHIKEYV) + RWKA;                       2029 09617000
*                                                                  2029 09618000
         AL    @15,DICTDL+120(,@04)                                2029 09619000
         ST    @15,RPTR2                                           2029 09620000
*            DO WHILE LENG > 0;                                    2030 09621000
*                                                                  2030 09622000
         B     @DE02030                                            2030 09623000
@DL02030 DS    0H                                                  2031 09624000
*              /******************************************************/ 09625000
*              /*                                                    */ 09626000
*              /*  MOVE LOW KEY & LENGTH INTO RANGE LIST. UPDATE     */ 09627000
*              /*  POINTERS AND LOOP CONTROL.                        */ 09628000
*              /*                                                    */ 09629000
*              /******************************************************/ 09630000
*                                                                  2031 09631000
*              FKEYLN = RPTR1 -> FIELDR(1:2);                      2031 09632000
         L     @04,FRANPTR1                                        2031 09633000
         L     @15,RPTR1                                           2031 09634000
         SLR   @14,@14                                             2031 09635000
         ICM   @14,3,FIELDR(@15)                                   2031 09636000
         STH   @14,FKEYLN(,@04)                                    2031 09637000
*              FKEY(1:FKEYLN) = (RPTR1 + 2) -> FIELDR(1:FKEYLN);   2032 09638000
         LR    @03,@14                                             2032 09639000
         BCTR  @03,0                                               2032 09640000
         LA    @02,2                                               2032 09641000
         LR    @01,@15                                             2032 09642000
         ALR   @01,@02                                             2032 09643000
         EX    @03,@SM01799                                        2032 09644000
*              RPTR1 = RPTR1 + FKEYLN + 2;                         2033 09645000
         ALR   @15,@14                                             2033 09646000
         ALR   @15,@02                                             2033 09647000
         ST    @15,RPTR1                                           2033 09648000
*              LENG = LENG - FKEYLN - 2;                           2034 09649000
         LH    @15,LENG                                            2034 09650000
         SLR   @15,@14                                             2034 09651000
         SLR   @15,@02                                             2034 09652000
         STH   @15,LENG                                            2034 09653000
*              FRANPTR1 = FRANPTR1 + FKEYLN + 2;                   2035 09654000
*                                                                  2035 09655000
         ALR   @04,@14                                             2035 09656000
         ALR   @04,@02                                             2035 09657000
         ST    @04,FRANPTR1                                        2035 09658000
*              /******************************************************/ 09659000
*              /*                                                    */ 09660000
*              /*  MOVE HIGH KEY & LENGTH INTO RANGE LIST. UPDATE    */ 09661000
*              /*  POINTERS AND LOOP CONTROL                         */ 09662000
*              /*                                                    */ 09663000
*              /******************************************************/ 09664000
*                                                                  2036 09665000
*              FKEYLN = RPTR2 -> FIELDR(1:2);                      2036 09666000
         L     @14,RPTR2                                           2036 09667000
         SLR   @03,@03                                             2036 09668000
         ICM   @03,3,FIELDR(@14)                                   2036 09669000
         STH   @03,FKEYLN(,@04)                                    2036 09670000
*              FKEY(1:FKEYLN) = (RPTR2+2) -> FIELDR(1:FKEYLN);     2037 09671000
         LR    @01,@03                                             2037 09672000
         BCTR  @01,0                                               2037 09673000
         LR    @00,@14                                             2037 09674000
         ALR   @00,@02                                             2037 09675000
         LR    @15,@00                                             2037 09676000
         EX    @01,@SM01801                                        2037 09677000
*              RPTR2 = RPTR2 + FKEYLN + 2;                         2038 09678000
         ALR   @14,@03                                             2038 09679000
         ALR   @14,@02                                             2038 09680000
         ST    @14,RPTR2                                           2038 09681000
*              LENG = LENG - FKEYLN - 2;                           2039 09682000
         LH    @15,LENG                                            2039 09683000
         SLR   @15,@03                                             2039 09684000
         SLR   @15,@02                                             2039 09685000
         STH   @15,LENG                                            2039 09686000
*              FRANPTR1 = FRANPTR1 + FKEYLN + 2;                   2040 09687000
         ALR   @04,@03                                             2040 09688000
         ALR   @04,@02                                             2040 09689000
         ST    @04,FRANPTR1                                        2040 09690000
*            END;                                                  2041 09691000
*                                                                  2041 09692000
@DE02030 LH    @04,LENG                                            2041 09693000
         LTR   @04,@04                                             2041 09694000
         BP    @DL02030                                            2041 09695000
*            /********************************************************/ 09696000
*            /*                                                      */ 09697000
*            /*  SET LENGTH OF ENTIRE LIST AND RETURN                */ 09698000
*            /*  WITH SUCCESS INDICATED                              */ 09699000
*            /*                                                      */ 09700000
*            /********************************************************/ 09701000
*                                                                  2042 09702000
*            FRANGLN = TOTLEN;                                     2042 09703000
         L     @04,@PC00011+12                                     2042 09704000
         L     @04,RRANGPTR(,@04)                                  2042 09705000
         L     @15,TOTLEN                                          2042 09706000
         STH   @15,FRANGLN(,@04)                                   2042 09707000
*            END;                                                  2043 09708000
*                                                                  2043 09709000
*        /************************************************************/ 09710000
*        /*                                                          */ 09711000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 09712000
*        /*                                                          */ 09713000
*        /************************************************************/ 09714000
*                                                                  2044 09715000
*        RETURN CODE(0);                                           2044 09716000
@RF02013 SLR   @15,@15                                             2044 09717000
         L     @14,@SA00011                                        2044 09718000
         LM    @00,@12,@SA00011+8                                  2044 09719000
         BR    @14                                                 2044 09720000
*END RANGPROC;                                                     2045 09721000
*        /************************************************************/ 09722000
*        /*                                                          */ 09723000
*        /*  PROCEDURE NAME - LVLRPROC                               */ 09724000
*        /*                                                          */ 09725000
*        /*  FUNCTION - CONSTRUCT FIELD PARAMETER LISTS (FPL'S)      */ 09726000
*        /*  FOR DEVTYPE (FROM DEVICETYPES PARAMETER IN AMS COMMAND  */ 09727000
*        /*  OR LISTS FOR LISTVOLS OR LISTRNGS FROM THE LIST         */ 09728000
*        /*  PARAMETER IN THE AMS COMMAND OR THE RANGES PARAMETER    */ 09729000
*        /*                                                          */ 09730000
*        /*  INPUT -                                                 */ 09731000
*        /*    .LX - INDEX TO CORRECT OBJECT PARAMETER IN FDTTBL     */ 09732000
*        /*    .LISTDICT - POINTER THE DICTIONARY BEING USED         */ 09733000
*        /*    .LISTWKA  - POINTER TO THE WORK AREA CONTAINING       */ 09734000
*        /*     THE CATALOG INFORMATION INDEXED BY THE DICTIONARY    */ 09735000
*        /*    .LFVTPTR - POINTER TO FVT WHERE FPL OR LIST POINTERS  */ 09736000
*        /*     ARE TO BE INSERTED                                   */ 09737000
*        /*    .LTYPE - THE TYPE OF THE OBJECT FOR WHICH THE VOLUME  */ 09738000
*        /*     LIST IS BEING BUILT                                  */ 09739000
*        /*                                                          */ 09740000
*        /*  OUTPUT - FPL AND LISTS WILL BE CONSTRUCTED              */ 09741000
*        /*                                                          */ 09742000
*        /************************************************************/ 09743000
*                                                                  2046 09744000
*LVLRPROC: PROCEDURE (LX,              /*INDEX TO OBJECT PARAMETER   */ 09745000
*                    LISTDICT,         /*POINTER TO DICTIONARY FROM  */ 09746000
*                    LISTWKA,          /*FVT POINTER                 */ 09747000
*                    LFVTPTR,          /*WORK AREA CONTAINED CATALOG */ 09748000
*                                      /*FIELD INFORMATION           */ 09749000
*                    LTYPE);           /*THE TYPE OF THE OBJECT FOR  */ 09750000
LVLRPROC STM   @14,@12,@SA00012                                    2046 09751000
         MVC   @PC00012(20),0(@01)                                 2046 09752000
*                                      /*WHICH THE VOLUME LIST IS    */ 09753000
*                                      /*BEING BUILT                 */ 09754000
*                                                                  2047 09755000
*        /************************************************************/ 09756000
*        /*                                                          */ 09757000
*        /*  ARGUMENTS OF INVOCATION                                 */ 09758000
*        /*                                                          */ 09759000
*        /************************************************************/ 09760000
*                                                                  2047 09761000
*        DCL LX       FIXED(31),                                   2047 09762000
*            LISTDICT PTR(31),                                     2047 09763000
*            LISTWKA  PTR(31),                                     2047 09764000
*            LFVTPTR  PTR(31),                                     2047 09765000
*            LTYPE    CHAR(1);                                     2047 09766000
*                                                                  2047 09767000
*        /************************************************************/ 09768000
*        /*                                                          */ 09769000
*        /*  LOCAL DECLARES                                          */ 09770000
*        /*                                                          */ 09771000
*        /************************************************************/ 09772000
*                                                                  2048 09773000
*        DCL INXVOLSR FIXED(31);       /*INDEX FOR RELATIVE          */ 09774000
*                                      /*POSITION IN VOLUME SERIAL   */ 09775000
*                                      /*SERIAL LIST                 */ 09776000
*        DCL FLISTPTR PTR(31);         /*POINTER TO VOL SER LIST     */ 09777000
*                                                                  2049 09778000
*        DCL FDEVTPTR PTR(31);         /*POINTER TO DEVICETYPE FPL   */ 09779000
*        DCL 1 FDEV BASED(FDEVTPTR) BDY(HWORD),                    2051 09780000
*              2 FDEVTYP (*),                                      2051 09781000
*                3 FDEVT CHAR(8),      /*DEVICE TYPE                 */ 09782000
*                3 FDCODE CHAR(4);     /*RESERVED                    */ 09783000
*        DCL NUMVOL FIXED(15);         /*NUMBER OF VOLUMES           */ 09784000
*                                                                  2052 09785000
*        DCL NUMDTYP FIXED(15);        /*NUMBER OF DEVICETYPES       */ 09786000
*        DCL FLDEVTYP CHAR(4) BASED;   /*MAPPING OF THE DEVICETYPE   */ 09787000
*                                      /*INFORMATION AS PRESENTED BY */ 09788000
*                                      /*EXPORTRA                    */ 09789000
*                                                                  2055 09790000
*        /************************************************************/ 09791000
*        /*                                                          */ 09792000
*        /*  DECLARATIONS FOR FILE SEQUENCE NUMBERS                  */ 09793000
*       /*                                                           */ 09794000
*       /*************************************************************/ 09795000
*                                                                  2055 09796000
*        DCL FSEQPTR PTR(31);          /*POINTER TO FILE SEQUENCE    */ 09797000
*                                      /*NUMBER OVERLAY              */ 09798000
*                                                                  2056 09799000
*        DCL 1 FSEQARRY BASED(FSEQPTR) BDY(HWORD),                 2056 09800000
*          2 FFSEQNUM(255) FIXED(15);                              2056 09801000
*                                                                  2056 09802000
*        DCL FSEQNUM FIXED(15) BASED;  /*MAPPING OF AN INDIVIDUAL    */ 09803000
*                                      /*FILE SEQUENCE NUMBER        */ 09804000
*                                                                  2058 09805000
*        DCL NUMFSEQ FIXED(15);        /*NUMBER OF FILE SEQUENCE     */ 09806000
*                                      /*NUMBERS PASSED BY EXPORTRA  */ 09807000
*        /************************************************************/ 09808000
*        /*                                                          */ 09809000
*        /*  CHECK TO BE SURE THE VOLUME PARAMETER WAS SPECIFIED     */ 09810000
*        /*  IN THE AMS COMMAND                                      */ 09811000
*        /*                                                          */ 09812000
*        /************************************************************/ 09813000
*                                                                  2059 09814000
*        OLDERID2 = NEWERID2;                                      2059 09815000
         L     @04,@PC00001                                        2059 09816000
         L     @04,GDTTR2(,@04)                                    2059 09817000
         MVC   @TS00001(95),NEWERID2(@04)                          2059 09818000
         MVC   OLDERID2(95,@04),@TS00001                           2059 09819000
*        NEWID2 = 'RMLV';                                          2060 09820000
*                                                                  2060 09821000
         MVC   NEWID2(4,@04),@CC01525                              2060 09822000
*        RESPECIFY CTGFV BASED(CTGFVPTR);                          2061 09823000
*                                                                  2061 09824000
*        CTGFVPTR = LFVTPTR;                                       2062 09825000
*                                                                  2062 09826000
         L     @04,@PC00012+12                                     2062 09827000
         L     @04,LFVTPTR(,@04)                                   2062 09828000
         ST    @04,CTGFVPTR                                        2062 09829000
*        /************************************************************/ 09830000
*        /*                                                          */ 09831000
*        /*  CONSTRUCT LIST OF VOLUME SERIALS IF BEING CALLED        */ 09832000
*        /*  BY FVTPROC OR BY NFVTPROC.                              */ 09833000
*        /*                                                          */ 09834000
*        /************************************************************/ 09835000
*                                                                  2063 09836000
*        IF LISTDICT ^= NULLPTR                                    2063 09837000
*          THEN                                                    2063 09838000
         L     @04,@PC00012+4                                      2063 09839000
         L     @04,LISTDICT(,@04)                                  2063 09840000
         LTR   @04,@04                                             2063 09841000
         BZ    @RF02063                                            2063 09842000
*NOBJECTS:   DO;                                                   2064 09843000
*                                                                  2064 09844000
NOBJECTS DS    0H                                                  2065 09845000
*            /********************************************************/ 09846000
*            /*                                                      */ 09847000
*            /*  SET THE VALUE OF THE VOLUME SERIAL INDEX ON THE     */ 09848000
*            /*  BASIS OF LTYPE.  THIS IS NECESSARY SINCE THE        */ 09849000
*            /*  THE VOLUME SERIAL DISPLACEMENTS ARE DIFFERENT FOR   */ 09850000
*            /*  VSAM CLUSTERS (AND AIX'S) AND NONVSAMS (AND         */ 09851000
*            /*  USERCATALOGS).                                      */ 09852000
*            /*                                                      */ 09853000
*            /********************************************************/ 09854000
*                                                                  2065 09855000
*            IF (LTYPE = CTGTALIN) | (LTYPE = CTGTUCAT)            2065 09856000
*              THEN                                                2065 09857000
         L     @04,@PC00012+16                                     2065 09858000
         CLI   LTYPE(@04),C'A'                                     2065 09859000
         BE    @RT02065                                            2065 09860000
         CLI   LTYPE(@04),C'U'                                     2065 09861000
         BNE   @RF02065                                            2065 09862000
@RT02065 DS    0H                                                  2066 09863000
*                INXVOLSR = LVOLSER;                               2066 09864000
         MVC   INXVOLSR(4),@CF00165                                2066 09865000
*              ELSE                                                2067 09866000
*                INXVOLSR = IVOLSER;                               2067 09867000
*                                                                  2067 09868000
         B     @RC02065                                            2067 09869000
@RF02065 MVC   INXVOLSR(4),@CF00964                                2067 09870000
*            /********************************************************/ 09871000
*            /*                                                      */ 09872000
*            /*  PICK UP POINTER TO DICTIONARY ENTRY AND SEE IF A    */ 09873000
*            /*  VOLUME SERIAL LIST WAS PASSED FOR THIS COMPONENT    */ 09874000
*            /*                                                      */ 09875000
*            /********************************************************/ 09876000
*                                                                  2068 09877000
*            DICTPTR = LISTDICT;                                   2068 09878000
@RC02065 L     @04,@PC00012+4                                      2068 09879000
         L     @04,LISTDICT(,@04)                                  2068 09880000
         ST    @04,DICTPTR                                         2068 09881000
*            IF DICTLN(INXVOLSR) ^= 0                              2069 09882000
*              THEN                                                2069 09883000
         L     @15,INXVOLSR                                        2069 09884000
         SLA   @15,3                                               2069 09885000
         AL    @04,@CF01779                                        2069 09886000
         L     @04,DICTLN-4(@15,@04)                               2069 09887000
         LTR   @04,@04                                             2069 09888000
         BZ    @RF02069                                            2069 09889000
*VOL1:           DO;                                               2070 09890000
*                                                                  2070 09891000
VOL1     DS    0H                                                  2071 09892000
*                /****************************************************/ 09893000
*                /*                                                  */ 09894000
*                /*  A VOLUME SERIAL LIST WAS PASSED. COMPUTE LENGTH */ 09895000
*                /*  OF LIST TO BE CONSTRUCTED FOR DEFINE            */ 09896000
*                /*                                                  */ 09897000
*                /****************************************************/ 09898000
*                                                                  2071 09899000
*                NUMVOL = DICTLN(INXVOLSR) / LENGTH(FVOLSER);      2071 09900000
         L     @04,INXVOLSR                                        2071 09901000
         SLA   @04,3                                               2071 09902000
         L     @01,DICTPTR                                         2071 09903000
         AL    @01,@CF01779                                        2071 09904000
         L     @00,DICTLN-4(@04,@01)                               2071 09905000
         SRDA  @00,32                                              2071 09906000
         D     @00,@CF00041                                        2071 09907000
         STH   @01,NUMVOL                                          2071 09908000
*                TOTLEN = LENGTH(FVOLSERL) * NUMVOL + LENGTH(FLISTLN);  09909000
*                                                                  2072 09910000
         SLA   @01,3                                               2072 09911000
         AL    @01,@CF00157                                        2072 09912000
         ST    @01,TOTLEN                                          2072 09913000
*                CALL IDCSAGP0 (GDTTBL,TOTLEN,CTGFVVLT,GPID,SETZERO);   09914000
*                                                                  2073 09915000
         L     @04,@PC00001                                        2073 09916000
         ST    @04,@AL00001                                        2073 09917000
         LA    @15,TOTLEN                                          2073 09918000
         ST    @15,@AL00001+4                                      2073 09919000
         L     @01,CTGFVPTR                                        2073 09920000
         LA    @15,CTGFVVLT(,@01)                                  2073 09921000
         ST    @15,@AL00001+8                                      2073 09922000
         LA    @15,GPID                                            2073 09923000
         ST    @15,@AL00001+12                                     2073 09924000
         LA    @15,SETZERO                                         2073 09925000
         ST    @15,@AL00001+16                                     2073 09926000
         MVI   @AL00001+16,X'80'                                   2073 09927000
         L     @15,GDTGPL(,@04)                                    2073 09928000
         LA    @01,@AL00001                                        2073 09929000
         BALR  @14,@15                                             2073 09930000
*                RESPECIFY RTNREG RSTD;                            2074 09931000
*                TESTRC = RTNREG;                                  2075 09932000
         STH   RTNREG,TESTRC                                       2075 09933000
*                RESPECIFY RTNREG UNRSTD;                          2076 09934000
*                                                                  2076 09935000
*                /****************************************************/ 09936000
*                /*                                                  */ 09937000
*                /*  IF CORE IS NOT OBTAINED SUCCESSFULLY FOR THE    */ 09938000
*                /*  RETURN TO CALLER WITH AN ERROR INDICATED        */ 09939000
*                /*                                                  */ 09940000
*                /****************************************************/ 09941000
*                                                                  2077 09942000
*                IF TESTRC ^= 0                                    2077 09943000
*                  THEN                                            2077 09944000
         LH    @04,TESTRC                                          2077 09945000
         LTR   @04,@04                                             2077 09946000
         BZ    @RF02077                                            2077 09947000
*                    DO;                                           2078 09948000
*                    DEFSTID = NOSTORAG;                           2079 09949000
         MVI   DEFSTID,X'04'                                       2079 09950000
*                    DARGSMOD = UNIVMSG;                           2080 09951000
         L     @04,DDSTRU                                          2080 09952000
         MVC   DARGSMOD(3,@04),@CC00981                            2080 09953000
*                    RETURN CODE(LASTCC12);                        2081 09954000
         LA    @15,12                                              2081 09955000
         L     @14,@SA00012                                        2081 09956000
         LM    @00,@12,@SA00012+8                                  2081 09957000
         BR    @14                                                 2081 09958000
*                    END;                                          2082 09959000
*                                                                  2082 09960000
*                /****************************************************/ 09961000
*                /*                                                  */ 09962000
*                /*  CONSTRUCT LISTVOLS VOLUME SERIAL LIST           */ 09963000
*                /*                                                  */ 09964000
*                /****************************************************/ 09965000
*                                                                  2083 09966000
*                DO N = 1 TO NUMVOL;                               2083 09967000
@RF02077 LA    @04,1                                               2083 09968000
         B     @DE02083                                            2083 09969000
@DL02083 DS    0H                                                  2084 09970000
*                  FVOLSER(N) = (DICTDL(INXVOLSR) +LISTWKA + (N-1) 2084 09971000
*                    * LENGTH(FVOLSER)) -> FLVOLSER;               2084 09972000
         LR    @15,@04                                             2084 09973000
         SLA   @15,3                                               2084 09974000
         L     @01,CTGFVPTR                                        2084 09975000
         L     @01,CTGFVVLT(,@01)                                  2084 09976000
         ALR   @01,@15                                             2084 09977000
         AL    @01,@CF01779                                        2084 09978000
         L     @15,INXVOLSR                                        2084 09979000
         SLA   @15,3                                               2084 09980000
         L     @14,@PC00012+8                                      2084 09981000
         L     @03,DICTPTR                                         2084 09982000
         L     @15,DICTDL-8(@15,@03)                               2084 09983000
         AL    @15,LISTWKA(,@14)                                   2084 09984000
         LR    @14,@04                                             2084 09985000
         BCTR  @14,0                                               2084 09986000
         MH    @14,@CH00041                                        2084 09987000
         ALR   @15,@14                                             2084 09988000
         MVC   FVOLSER-4(6,@01),FLVOLSER(@15)                      2084 09989000
*                END;                                              2085 09990000
         AL    @04,@CF00221                                        2085 09991000
@DE02083 ST    @04,N                                               2085 09992000
         CH    @04,NUMVOL                                          2085 09993000
         BNH   @DL02083                                            2085 09994000
*                FLISTLN = TOTLEN - LENGTH(FLISTLN);               2086 09995000
         L     @04,CTGFVPTR                                        2086 09996000
         L     @04,CTGFVVLT(,@04)                                  2086 09997000
         L     @15,TOTLEN                                          2086 09998000
         BCTR  @15,0                                               2086 09999000
         BCTR  @15,0                                               2086 10000000
         STH   @15,FLISTLN(,@04)                                   2086 10001000
*                IMPF2VOL= ON;                                     2087 10002000
         OI    IMPF2VOL,B'10000000'                                2087 10003000
*                END VOL1;                                         2088 10004000
*                                                                  2088 10005000
*            /********************************************************/ 10006000
*            /*                                                      */ 10007000
*            /*  FOR NON-VSAMS AND USERCATALOGS CONSTRUCT THE        */ 10008000
*            /*  DEVICETYPES LIST.                                   */ 10009000
*            /*                                                      */ 10010000
*            /********************************************************/ 10011000
*                                                                  2089 10012000
*            IF (LTYPE = CTGTUCAT | LTYPE = CTGTALIN) &            2089 10013000
*               (DICTLN(LDEVTYP) ^= 0)                             2089 10014000
*              THEN                                                2089 10015000
@RF02069 L     @04,@PC00012+16                                     2089 10016000
         CLI   LTYPE(@04),C'U'                                     2089 10017000
         BE    @GL00022                                            2089 10018000
         CLI   LTYPE(@04),C'A'                                     2089 10019000
         BNE   @RF02089                                            2089 10020000
@GL00022 L     @04,DICTPTR                                         2089 10021000
         L     @04,DICTLN+24(,@04)                                 2089 10022000
         LTR   @04,@04                                             2089 10023000
         BZ    @RF02089                                            2089 10024000
*DEVTYP1:        DO;                                               2090 10025000
*                                                                  2090 10026000
DEVTYP1  DS    0H                                                  2091 10027000
*                /****************************************************/ 10028000
*                /*                                                  */ 10029000
*                /*  COMPUTE THE AMOUNT OF CORE REQUIRED FOR THE     */ 10030000
*                /*  DEVTYP FPL AND ITS ASSOCIATED DEVICE TYPES      */ 10031000
*                /*  LIST.  ISSUE A UGPOOL FOR THAT AMOUNT OF        */ 10032000
*                /*  STORAGE.                                        */ 10033000
*                /*                                                  */ 10034000
*                /****************************************************/ 10035000
*                                                                  2091 10036000
*                TOTLEN = (LENGTH(CTGFL) + 8) +                    2091 10037000
*                   (DICTLN(LDEVTYP)/LENGTH(FLDEVTYP))*LENGTH(FDEVTYP); 10038000
         L     @04,DICTPTR                                         2091 10039000
         L     @00,DICTLN+24(,@04)                                 2091 10040000
         SRDA  @00,32                                              2091 10041000
         D     @00,@CF00046                                        2091 10042000
         MH    @01,@CH00035                                        2091 10043000
         AL    @01,@CF00312                                        2091 10044000
         ST    @01,TOTLEN                                          2091 10045000
*                CALL IDCSAGP0(GDTTBL,TOTLEN,CTGFVDVT,GPID,SETZERO);    10046000
*                                                                  2092 10047000
         L     @04,@PC00001                                        2092 10048000
         ST    @04,@AL00001                                        2092 10049000
         LA    @15,TOTLEN                                          2092 10050000
         ST    @15,@AL00001+4                                      2092 10051000
         L     @01,CTGFVPTR                                        2092 10052000
         LA    @15,CTGFVDVT(,@01)                                  2092 10053000
         ST    @15,@AL00001+8                                      2092 10054000
         LA    @15,GPID                                            2092 10055000
         ST    @15,@AL00001+12                                     2092 10056000
         LA    @15,SETZERO                                         2092 10057000
         ST    @15,@AL00001+16                                     2092 10058000
         MVI   @AL00001+16,X'80'                                   2092 10059000
         L     @15,GDTGPL(,@04)                                    2092 10060000
         LA    @01,@AL00001                                        2092 10061000
         BALR  @14,@15                                             2092 10062000
*                /****************************************************/ 10063000
*                /*                                                  */ 10064000
*                /*  TEST THE RETURN CODE FROM UGPOOL.  IF IT IS     */ 10065000
*                /*  NONZERO, THEN RETURN TO THE CALLING PROCESSOR   */ 10066000
*                /*  WITH A TERMINAL ERROR INDICATED.                */ 10067000
*                /*                                                  */ 10068000
*                /****************************************************/ 10069000
*                                                                  2093 10070000
*                RESPECIFY RTNREG RSTD;                            2093 10071000
*                TESTRC = RTNREG;                                  2094 10072000
         STH   RTNREG,TESTRC                                       2094 10073000
*                RESPECIFY RTNREG UNRSTD;                          2095 10074000
*                IF TESTRC ^= 0                                    2096 10075000
*                  THEN                                            2096 10076000
         LH    @04,TESTRC                                          2096 10077000
         LTR   @04,@04                                             2096 10078000
         BZ    @RF02096                                            2096 10079000
*                    DO;                                           2097 10080000
*                    DARGSMOD = UNIVMSG;                           2098 10081000
         L     @04,DDSTRU                                          2098 10082000
         MVC   DARGSMOD(3,@04),@CC00981                            2098 10083000
*                    DEFSTID = NOSTORAG;                           2099 10084000
         MVI   DEFSTID,X'04'                                       2099 10085000
*                    RETURN CODE(LASTCC12);                        2100 10086000
         LA    @15,12                                              2100 10087000
         L     @14,@SA00012                                        2100 10088000
         LM    @00,@12,@SA00012+8                                  2100 10089000
         BR    @14                                                 2100 10090000
*                    END;                                          2101 10091000
*                                                                  2101 10092000
*                /****************************************************/ 10093000
*                /*                                                  */ 10094000
*                /*  SET THE CTGFLPTR TO POINT TO THE START OF THE   */ 10095000
*                /*  AREA GOTTEN BY UGPOOL.                          */ 10096000
*                /*  ALSO SET THE POINTER USED TO BASE THE DEVICE    */ 10097000
*                /*  TYPES LIST MAPPING TO THE START OF DEVICE TYPES */ 10098000
*                /*  LIST.                                           */ 10099000
*                /*                                                  */ 10100000
*                /****************************************************/ 10101000
*                                                                  2102 10102000
*                CTGFLPTR = CTGFVDVT;                              2102 10103000
@RF02096 L     @04,CTGFVPTR                                        2102 10104000
         L     @15,CTGFVDVT(,@04)                                  2102 10105000
         ST    @15,CTGFLPTR                                        2102 10106000
*                FDEVTPTR = CTGFVDVT + LENGTH(CTGFL) + 8;          2103 10107000
*                                                                  2103 10108000
         AL    @15,@CF00312                                        2103 10109000
         ST    @15,FDEVTPTR                                        2103 10110000
*                /****************************************************/ 10111000
*                /*                                                  */ 10112000
*                /*  INDICATE THAT THE DEVICE TYPE INFORMATION IS IN */ 10113000
*                /*  CODED FORM AS EXTRACTED FROM THE CATALOG BY     */ 10114000
*                /*  EXPORTRA.                                       */ 10115000
*                /*                                                  */ 10116000
*                /****************************************************/ 10117000
*                                                                  2104 10118000
*                CTGFVNDC = ON;                                    2104 10119000
*                                                                  2104 10120000
         OI    CTGFVNDC(@04),B'00100000'                           2104 10121000
*                /****************************************************/ 10122000
*                /*                                                  */ 10123000
*                /*  LOOP PLACING DEVICE TYPE INFORMATION IN THE     */ 10124000
*                /*  DEVICE TYPES LIST.                              */ 10125000
*                /*                                                  */ 10126000
*                /****************************************************/ 10127000
*                                                                  2105 10128000
*                DO N = 1 TO DICTLN(LDEVTYP) / LENGTH(FLDEVTYP);   2105 10129000
         LA    @04,1                                               2105 10130000
         B     @DE02105                                            2105 10131000
@DL02105 DS    0H                                                  2106 10132000
*                  FDCODE(N) = (DICTDL(LDEVTYP) + LISTWKA +        2106 10133000
*                     (N - 1) * LENGTH(FLDEVTYP)) -> FLDEVTYP;     2106 10134000
         LR    @15,@04                                             2106 10135000
         MH    @15,@CH00035                                        2106 10136000
         L     @01,FDEVTPTR                                        2106 10137000
         ALR   @01,@15                                             2106 10138000
         AL    @01,@CF01779                                        2106 10139000
         L     @15,@PC00012+8                                      2106 10140000
         L     @14,DICTPTR                                         2106 10141000
         L     @14,DICTDL+24(,@14)                                 2106 10142000
         AL    @14,LISTWKA(,@15)                                   2106 10143000
         LR    @15,@04                                             2106 10144000
         BCTR  @15,0                                               2106 10145000
         SLA   @15,2                                               2106 10146000
         ALR   @14,@15                                             2106 10147000
         MVC   FDCODE-8(4,@01),FLDEVTYP(@14)                       2106 10148000
*                END;                                              2107 10149000
*                                                                  2107 10150000
         AL    @04,@CF00221                                        2107 10151000
@DE02105 ST    @04,N                                               2107 10152000
         L     @01,DICTPTR                                         2107 10153000
         L     @00,DICTLN+24(,@01)                                 2107 10154000
         SRDA  @00,32                                              2107 10155000
         D     @00,@CF00046                                        2107 10156000
         CR    @04,@01                                             2107 10157000
         BNH   @DL02105                                            2107 10158000
*                /****************************************************/ 10159000
*                /*                                                  */ 10160000
*                /*  SET THE FIELDS OF THE FPL.                      */ 10161000
*                /*                                                  */ 10162000
*                /****************************************************/ 10163000
*                                                                  2108 10164000
*                CTGFLDNO = '00000001'B;                           2108 10165000
         L     @04,CTGFLPTR                                        2108 10166000
         MVI   CTGFLDNO(@04),X'01'                                 2108 10167000
*                CTGFLDNM = ADDR(NVFLIST(LDEVTYP));                2109 10168000
         LA    @15,NVFLIST+24                                      2109 10169000
         ST    @15,CTGFLDNM(,@04)                                  2109 10170000
*                CTGFLNG(1) = (DICTLN(LDEVTYP)/LENGTH(FLDEVTYP))   2110 10171000
*                     * LENGTH(FDEVTYP);                           2110 10172000
         L     @01,DICTPTR                                         2110 10173000
         L     @00,DICTLN+24(,@01)                                 2110 10174000
         SRDA  @00,32                                              2110 10175000
         D     @00,@CF00046                                        2110 10176000
         MH    @01,@CH00035                                        2110 10177000
         ST    @01,CTGFLNG(,@04)                                   2110 10178000
*                CTGFLPT(1) = FDEVTPTR;                            2111 10179000
*                                                                  2111 10180000
         L     @15,FDEVTPTR                                        2111 10181000
         ST    @15,CTGFLPT(,@04)                                   2111 10182000
*                END DEVTYP1;                                      2112 10183000
*                                                                  2112 10184000
*            /********************************************************/ 10185000
*            /*                                                      */ 10186000
*            /*  IF THE TYPE OF THE OBJECT BEING DEFINED IS NONVSAM  */ 10187000
*            /*  THEN BUILD AN FPL FOR FILESEQUENCE NUMBERS.         */ 10188000
*            /*                                                      */ 10189000
*            /********************************************************/ 10190000
*                                                                  2113 10191000
*            IF (LTYPE = CTGTALIN) & (DICTLN(LFSEQNUM) ^= 0)       2113 10192000
*              THEN                                                2113 10193000
@RF02089 L     @04,@PC00012+16                                     2113 10194000
         CLI   LTYPE(@04),C'A'                                     2113 10195000
         BNE   @RF02113                                            2113 10196000
         L     @04,DICTPTR                                         2113 10197000
         L     @04,DICTLN+32(,@04)                                 2113 10198000
         LTR   @04,@04                                             2113 10199000
         BZ    @RF02113                                            2113 10200000
*FILESN:         DO;                                               2114 10201000
*                                                                  2114 10202000
FILESN   DS    0H                                                  2115 10203000
*                /****************************************************/ 10204000
*                /*                                                  */ 10205000
*                /*  COMPUTE THE NUMBER OF FILE SEQUENCE NUMBERS,    */ 10206000
*                /*  ALSO THE AMOUNT OF CORE REQUIRED FOR THE        */ 10207000
*                /*  LIST OF FILESEQUENCE NUMBERS AND ITS ASSOCIATED */ 10208000
*                /*  FPL.  ISSUE A REQUEST FOR THE NEEDED STORAGE.   */ 10209000
*                /*                                                  */ 10210000
*                /****************************************************/ 10211000
*                                                                  2115 10212000
*                NUMFSEQ = DICTLN(LFSEQNUM) / LENGTH(FFSEQNUM);    2115 10213000
         L     @04,DICTPTR                                         2115 10214000
         L     @04,DICTLN+32(,@04)                                 2115 10215000
         LR    @00,@04                                             2115 10216000
         SRDA  @00,32                                              2115 10217000
         D     @00,@CF00157                                        2115 10218000
         STH   @01,NUMFSEQ                                         2115 10219000
*                TOTLEN = DICTLN(LFSEQNUM) + LENGTH(CTGFL) + 8;    2116 10220000
         AL    @04,@CF00312                                        2116 10221000
         ST    @04,TOTLEN                                          2116 10222000
*                CALL IDCSAGP0(GDTTBL,TOTLEN,CTGFVFSN,GPID,SETZERO);    10223000
*                                                                  2117 10224000
         L     @04,@PC00001                                        2117 10225000
         ST    @04,@AL00001                                        2117 10226000
         LA    @15,TOTLEN                                          2117 10227000
         ST    @15,@AL00001+4                                      2117 10228000
         L     @01,CTGFVPTR                                        2117 10229000
         LA    @15,CTGFVFSN(,@01)                                  2117 10230000
         ST    @15,@AL00001+8                                      2117 10231000
         LA    @15,GPID                                            2117 10232000
         ST    @15,@AL00001+12                                     2117 10233000
         LA    @15,SETZERO                                         2117 10234000
         ST    @15,@AL00001+16                                     2117 10235000
         MVI   @AL00001+16,X'80'                                   2117 10236000
         L     @15,GDTGPL(,@04)                                    2117 10237000
         LA    @01,@AL00001                                        2117 10238000
         BALR  @14,@15                                             2117 10239000
*                /****************************************************/ 10240000
*                /*                                                  */ 10241000
*                /*  TEST THE RETURN CODE FROM THE UGPOOL.  IF IT IS */ 10242000
*                /*  NONZERO, RETURN TO THE CALLER WITH A TERMINAL   */ 10243000
*                /*  ERROR INDICATED.                                */ 10244000
*                /*                                                  */ 10245000
*                /****************************************************/ 10246000
*                                                                  2118 10247000
*                RESPECIFY RTNREG RSTD;                            2118 10248000
*                TESTRC = RTNREG;                                  2119 10249000
         STH   RTNREG,TESTRC                                       2119 10250000
*                RESPECIFY RTNREG UNRSTD;                          2120 10251000
*                IF TESTRC ^= 0                                    2121 10252000
*                  THEN                                            2121 10253000
         LH    @04,TESTRC                                          2121 10254000
         LTR   @04,@04                                             2121 10255000
         BZ    @RF02121                                            2121 10256000
*                    DO;                                           2122 10257000
*                    DEFSTID = NOSTORAG;                           2123 10258000
         MVI   DEFSTID,X'04'                                       2123 10259000
*                    DARGSMOD = UNIVMSG;                           2124 10260000
         L     @04,DDSTRU                                          2124 10261000
         MVC   DARGSMOD(3,@04),@CC00981                            2124 10262000
*                    RETURN CODE(LASTCC12);                        2125 10263000
         LA    @15,12                                              2125 10264000
         L     @14,@SA00012                                        2125 10265000
         LM    @00,@12,@SA00012+8                                  2125 10266000
         BR    @14                                                 2125 10267000
*                    END;                                          2126 10268000
*                                                                  2126 10269000
*                /****************************************************/ 10270000
*                /*                                                  */ 10271000
*                /*  BUILD THE FILE SEQUENCE NUMBER FPL.             */ 10272000
*                /*                                                  */ 10273000
*                /****************************************************/ 10274000
*                                                                  2127 10275000
*                CTGFLPTR = CTGFVFSN;                              2127 10276000
@RF02121 L     @04,CTGFVPTR                                        2127 10277000
         L     @04,CTGFVFSN(,@04)                                  2127 10278000
         ST    @04,CTGFLPTR                                        2127 10279000
*                CTGFLDNO = '00000001'B;                           2128 10280000
         MVI   CTGFLDNO(@04),X'01'                                 2128 10281000
*                CTGFLDNM = ADDR(NVFLIST(LFSEQNUM));               2129 10282000
         LA    @15,NVFLIST+32                                      2129 10283000
         ST    @15,CTGFLDNM(,@04)                                  2129 10284000
*                CTGFLPT(1) = CTGFVFSN + (LENGTH(CTGFL) + 8);      2130 10285000
         LA    @15,24                                              2130 10286000
         ALR   @15,@04                                             2130 10287000
         ST    @15,CTGFLPT(,@04)                                   2130 10288000
*                CTGFLNG(1) = DICTLN(LFSEQNUM);                    2131 10289000
         L     @01,DICTPTR                                         2131 10290000
         L     @15,DICTLN+32(,@01)                                 2131 10291000
         ST    @15,CTGFLNG(,@04)                                   2131 10292000
*                FSEQPTR = CTGFLPT(1);                             2132 10293000
*                                                                  2132 10294000
         L     @04,CTGFLPT(,@04)                                   2132 10295000
         ST    @04,FSEQPTR                                         2132 10296000
*                /****************************************************/ 10297000
*                /*                                                  */ 10298000
*                /*  LOOP, PLACING THE FILE SEQUENCE NUMBERS INTO    */ 10299000
*                /*  THE LIST.                                       */ 10300000
*                /*                                                  */ 10301000
*                /****************************************************/ 10302000
*                                                                  2133 10303000
*                DO N = 1 TO NUMFSEQ;                              2133 10304000
         LA    @04,1                                               2133 10305000
         B     @DE02133                                            2133 10306000
@DL02133 DS    0H                                                  2134 10307000
*                  FFSEQNUM (N) = (DICTDL(LFSEQNUM)+LISTWKA+       2134 10308000
*                     (N-1)*LENGTH(FFSEQNUM))->FSEQNUM;            2134 10309000
         LR    @15,@04                                             2134 10310000
         ALR   @15,@15                                             2134 10311000
         L     @14,@PC00012+8                                      2134 10312000
         L     @01,DICTPTR                                         2134 10313000
         L     @03,DICTDL+32(,@01)                                 2134 10314000
         AL    @03,LISTWKA(,@14)                                   2134 10315000
         LR    @14,@04                                             2134 10316000
         BCTR  @14,0                                               2134 10317000
         ALR   @14,@14                                             2134 10318000
         ALR   @03,@14                                             2134 10319000
         LH    @14,FSEQNUM(,@03)                                   2134 10320000
         L     @01,FSEQPTR                                         2134 10321000
         BCTR  @01,0                                               2134 10322000
         BCTR  @01,0                                               2134 10323000
         STH   @14,FFSEQNUM(@15,@01)                               2134 10324000
*                END;                                              2135 10325000
         AL    @04,@CF00221                                        2135 10326000
@DE02133 ST    @04,N                                               2135 10327000
         CH    @04,NUMFSEQ                                         2135 10328000
         BNH   @DL02133                                            2135 10329000
*                END FILESN;                                       2136 10330000
*                                                                  2136 10331000
*            /********************************************************/ 10332000
*            /*                                                      */ 10333000
*            /*  RETURN TO CALLER WITH A GOOD RETURN CODE            */ 10334000
*            /*                                                      */ 10335000
*            /********************************************************/ 10336000
*                                                                  2137 10337000
*            RETURN CODE(0);                                       2137 10338000
@RF02113 SLR   @15,@15                                             2137 10339000
         L     @14,@SA00012                                        2137 10340000
         LM    @00,@12,@SA00012+8                                  2137 10341000
         BR    @14                                                 2137 10342000
*            END NOBJECTS;                                         2138 10343000
*        /************************************************************/ 10344000
*        /*                                                          */ 10345000
*        /*  CONSTRUCT LIST OF VOLUME SERIALS IF LIST PARAMETER      */ 10346000
*        /*  WAS SPECIFIED IN THE AMS COMMAND                        */ 10347000
*        /*                                                          */ 10348000
*        /************************************************************/ 10349000
*                                                                  2139 10350000
*        IF LISTVPTR(LX) ^= NULLPTR                                2139 10351000
*          THEN                                                    2139 10352000
@RF02063 L     @04,@PC00012                                        2139 10353000
         L     @04,LX(,@04)                                        2139 10354000
         SLA   @04,2                                               2139 10355000
         L     @15,@PC00001+4                                      2139 10356000
         L     @01,FDTPTR+24(,@15)                                 2139 10357000
         AL    @01,@CF01779                                        2139 10358000
         L     @04,LISTVPTR(@04,@01)                               2139 10359000
         LTR   @04,@04                                             2139 10360000
         BZ    @RF02139                                            2139 10361000
*VOL2:       DO;                                                   2140 10362000
*                                                                  2140 10363000
VOL2     DS    0H                                                  2141 10364000
*            /********************************************************/ 10365000
*            /*                                                      */ 10366000
*            /*  IF CTGFVVLT IS NOT EQUAL TO NULLPTR, THEN A         */ 10367000
*            /*  VOLUME SERIAL LIST HAS BEEN CONSTRUCTED PREVIOUSLY. */ 10368000
*            /*  FREE UP THE CORE THAT IT OCCUPIES, AND RESET        */ 10369000
*            /*  CTGFVVLT TO NULLPTR.  THE OLD VOLUME SERIAL LIST,   */ 10370000
*            /*  CONSTRUCTED FROM THE PORTABLE DATA SET IS TO BE     */ 10371000
*            /*  OVERRIDDEN WITH INFORMATION FROM THE OBJECTS        */ 10372000
*            /*  PARAMETER.                                          */ 10373000
*            /*                                                      */ 10374000
*            /********************************************************/ 10375000
*                                                                  2141 10376000
*            IF CTGFVVLT ^= NULLPTR                                2141 10377000
*              THEN                                                2141 10378000
         L     @04,CTGFVPTR                                        2141 10379000
         L     @15,CTGFVVLT(,@04)                                  2141 10380000
         LTR   @15,@15                                             2141 10381000
         BZ    @RF02141                                            2141 10382000
*                DO;                                               2142 10383000
*                CALL IDCSAFS0(GDTTBL,CTGFVVLT);                   2143 10384000
         L     @15,@PC00001                                        2143 10385000
         ST    @15,@AL00001                                        2143 10386000
         LA    @04,CTGFVVLT(,@04)                                  2143 10387000
         ST    @04,@AL00001+4                                      2143 10388000
         L     @15,GDTFSP(,@15)                                    2143 10389000
         LA    @01,@AL00001                                        2143 10390000
         BALR  @14,@15                                             2143 10391000
*                RESPECIFY RTNREG RSTD;                            2144 10392000
*                TESTRC = RTNREG;                                  2145 10393000
         STH   RTNREG,TESTRC                                       2145 10394000
*                RESPECIFY RTNREG UNRSTD;                          2146 10395000
*                IF TESTRC ^= 0                                    2147 10396000
*                  THEN                                            2147 10397000
         LH    @04,TESTRC                                          2147 10398000
         LTR   @04,@04                                             2147 10399000
         BZ    @RF02147                                            2147 10400000
*                    RETURN CODE(LASTCC12);                        2148 10401000
         LA    @15,12                                              2148 10402000
         L     @14,@SA00012                                        2148 10403000
         LM    @00,@12,@SA00012+8                                  2148 10404000
         BR    @14                                                 2148 10405000
*                CTGFVVLT = NULLPTR;                               2149 10406000
@RF02147 L     @04,CTGFVPTR                                        2149 10407000
         SLR   @15,@15                                             2149 10408000
         ST    @15,CTGFVVLT(,@04)                                  2149 10409000
*                END;                                              2150 10410000
*                                                                  2150 10411000
*            TOTLEN = LENGTH(FVOLSERL) * (LISTVPTR(LX)->LISTVCNT) +2;   10412000
*                                                                  2151 10413000
@RF02141 L     @04,@PC00012                                        2151 10414000
         L     @04,LX(,@04)                                        2151 10415000
         SLA   @04,2                                               2151 10416000
         L     @15,@PC00001+4                                      2151 10417000
         L     @01,FDTPTR+24(,@15)                                 2151 10418000
         AL    @01,@CF01779                                        2151 10419000
         L     @04,LISTVPTR(@04,@01)                               2151 10420000
         LH    @04,LISTVCNT(,@04)                                  2151 10421000
         SLA   @04,3                                               2151 10422000
         AL    @04,@CF00157                                        2151 10423000
         ST    @04,TOTLEN                                          2151 10424000
*            /*******************************************************/  10425000
*            /*                                                      */ 10426000
*            /*  GET CORE FOR THE VOLUME SERIAL LIST. IF CORE IS     */ 10427000
*            /*  NOT OBTAINED SUCCESSFULLY, RETURN TO THE CALLING    */ 10428000
*            /*  PROCESSOR                                           */ 10429000
*            /*                                                      */ 10430000
*            /********************************************************/ 10431000
*                                                                  2152 10432000
*            CALL IDCSAGP0 (GDTTBL,TOTLEN,CTGFVVLT,GPID,SETZERO);  2152 10433000
*                                                                  2152 10434000
         L     @04,@PC00001                                        2152 10435000
         ST    @04,@AL00001                                        2152 10436000
         LA    @15,TOTLEN                                          2152 10437000
         ST    @15,@AL00001+4                                      2152 10438000
         L     @01,CTGFVPTR                                        2152 10439000
         LA    @15,CTGFVVLT(,@01)                                  2152 10440000
         ST    @15,@AL00001+8                                      2152 10441000
         LA    @15,GPID                                            2152 10442000
         ST    @15,@AL00001+12                                     2152 10443000
         LA    @15,SETZERO                                         2152 10444000
         ST    @15,@AL00001+16                                     2152 10445000
         MVI   @AL00001+16,X'80'                                   2152 10446000
         L     @15,GDTGPL(,@04)                                    2152 10447000
         LA    @01,@AL00001                                        2152 10448000
         BALR  @14,@15                                             2152 10449000
*            RESPECIFY RTNREG RSTD;                                2153 10450000
*            TESTRC = RTNREG;                                      2154 10451000
         STH   RTNREG,TESTRC                                       2154 10452000
*            RESPECIFY RTNREG UNRSTD;                              2155 10453000
*            IF TESTRC ^= 0                                        2156 10454000
*              THEN                                                2156 10455000
         LH    @04,TESTRC                                          2156 10456000
         LTR   @04,@04                                             2156 10457000
         BZ    @RF02156                                            2156 10458000
*                DO;                                               2157 10459000
*                DARGSMOD = UNIVMSG;                               2158 10460000
         L     @04,DDSTRU                                          2158 10461000
         MVC   DARGSMOD(3,@04),@CC00981                            2158 10462000
*                DEFSTID = NOSTORAG;                               2159 10463000
         MVI   DEFSTID,X'04'                                       2159 10464000
*                RETURN CODE(LASTCC12);                            2160 10465000
         LA    @15,12                                              2160 10466000
         L     @14,@SA00012                                        2160 10467000
         LM    @00,@12,@SA00012+8                                  2160 10468000
         BR    @14                                                 2160 10469000
*                END;                                              2161 10470000
*                                                                  2161 10471000
*            /********************************************************/ 10472000
*            /*                                                      */ 10473000
*            /*  CONSTRUCT LIST OF VOLUME SERIAL NUMBERS             */ 10474000
*            /*                                                      */ 10475000
*            /********************************************************/ 10476000
*                                                                  2162 10477000
*            DO N = 1 TO (LISTVPTR(LX)->LISTVCNT);                 2162 10478000
@RF02156 LA    @04,1                                               2162 10479000
         B     @DE02162                                            2162 10480000
@DL02162 DS    0H                                                  2163 10481000
*              FVOLSER(N) = LISTVPTR(LX) -> LISTVVAL(N);           2163 10482000
         LR    @15,@04                                             2163 10483000
         SLA   @15,3                                               2163 10484000
         L     @01,CTGFVPTR                                        2163 10485000
         L     @01,CTGFVVLT(,@01)                                  2163 10486000
         ALR   @01,@15                                             2163 10487000
         AL    @01,@CF01779                                        2163 10488000
         L     @14,@PC00012                                        2163 10489000
         L     @14,LX(,@14)                                        2163 10490000
         SLA   @14,2                                               2163 10491000
         L     @03,@PC00001+4                                      2163 10492000
         L     @03,FDTPTR+24(,@03)                                 2163 10493000
         AL    @03,@CF01779                                        2163 10494000
         L     @14,LISTVPTR(@14,@03)                               2163 10495000
         ALR   @14,@15                                             2163 10496000
         AL    @14,@CF01803                                        2163 10497000
         MVC   FVOLSER-4(6,@01),LISTVVAL-3(@14)                    2163 10498000
*            END;                                                  2164 10499000
         AL    @04,@CF00221                                        2164 10500000
@DE02162 ST    @04,N                                               2164 10501000
         L     @15,@PC00012                                        2164 10502000
         L     @15,LX(,@15)                                        2164 10503000
         SLA   @15,2                                               2164 10504000
         L     @14,@PC00001+4                                      2164 10505000
         L     @01,FDTPTR+24(,@14)                                 2164 10506000
         AL    @01,@CF01779                                        2164 10507000
         L     @01,LISTVPTR(@15,@01)                               2164 10508000
         CH    @04,LISTVCNT(,@01)                                  2164 10509000
         BNH   @DL02162                                            2164 10510000
*            FLISTLN = TOTLEN -2;                                  2165 10511000
         L     @04,CTGFVPTR                                        2165 10512000
         L     @04,CTGFVVLT(,@04)                                  2165 10513000
         L     @15,TOTLEN                                          2165 10514000
         BCTR  @15,0                                               2165 10515000
         BCTR  @15,0                                               2165 10516000
         STH   @15,FLISTLN(,@04)                                   2165 10517000
*            IMPF2VOL = ON;                                        2166 10518000
         OI    IMPF2VOL,B'10000000'                                2166 10519000
*            END VOL2;                                             2167 10520000
*                                                                  2167 10521000
*        /************************************************************/ 10522000
*        /*                                                          */ 10523000
*        /*  IF DEVICETYPES WAS SPECIFIED IN THE AMS COMMAND, SET    */ 10524000
*        /*  UP THE DEVTYP FPL AND FIELD INFORMATION.  THIS          */ 10525000
*        /*  PARAMETER MAY ONLY BE SPECIFIED FOR  A USER CATALOG     */ 10526000
*        /*  OR A NONVSAM OBJECT.                                    */ 10527000
*        /*                                                          */ 10528000
*        /************************************************************/ 10529000
*                                                                  2168 10530000
*        IF DEVTPTR(LX) ^= NULLPTR                                 2168 10531000
*          THEN                                                    2168 10532000
@RF02139 L     @04,@PC00012                                        2168 10533000
         L     @04,LX(,@04)                                        2168 10534000
         SLA   @04,2                                               2168 10535000
         L     @15,@PC00001+4                                      2168 10536000
         L     @01,FDTPTR+32(,@15)                                 2168 10537000
         AL    @01,@CF01779                                        2168 10538000
         L     @04,DEVTPTR(@04,@01)                                2168 10539000
         LTR   @04,@04                                             2168 10540000
         BZ    @RF02168                                            2168 10541000
*DEVTYP2:    DO;                                                   2169 10542000
*                                                                  2169 10543000
DEVTYP2  DS    0H                                                  2170 10544000
*            /********************************************************/ 10545000
*            /*                                                      */ 10546000
*            /*  IF CTGFVDVT IS NOT EQUAL TO NULLPTR, THEN A         */ 10547000
*            /*  DEVICETYPES LIST WAS CONSTRUCTED FROM INFORMATION   */ 10548000
*            /*  ON THE PORTABLE DATA SET.  THIS INFORMATION IS TO   */ 10549000
*            /*  BE OVERRIDDEN WITH THAT FROM THE OBJECTS PARAMETER. */ 10550000
*            /*  FREE UP THE CORE OCCUPIED BY THE DEVICETYPES FPL    */ 10551000
*            /*  AND BY THE DEVICETYPES LIST.  RESET CTGFVDVT TO     */ 10552000
*            /*  NULLPTR.                                            */ 10553000
*            /*                                                      */ 10554000
*            /********************************************************/ 10555000
*                                                                  2170 10556000
*            IF CTGFVDVT ^= NULLPTR                                2170 10557000
*              THEN                                                2170 10558000
         L     @04,CTGFVPTR                                        2170 10559000
         L     @15,CTGFVDVT(,@04)                                  2170 10560000
         LTR   @15,@15                                             2170 10561000
         BZ    @RF02170                                            2170 10562000
*                DO;                                               2171 10563000
*                CALL IDCSAFS0(GDTTBL,CTGFVDVT);                   2172 10564000
         L     @15,@PC00001                                        2172 10565000
         ST    @15,@AL00001                                        2172 10566000
         LA    @04,CTGFVDVT(,@04)                                  2172 10567000
         ST    @04,@AL00001+4                                      2172 10568000
         L     @15,GDTFSP(,@15)                                    2172 10569000
         LA    @01,@AL00001                                        2172 10570000
         BALR  @14,@15                                             2172 10571000
*                RESPECIFY RTNREG RSTD;                            2173 10572000
*                TESTRC = RTNREG;                                  2174 10573000
         STH   RTNREG,TESTRC                                       2174 10574000
*                RESPECIFY RTNREG UNRSTD;                          2175 10575000
*                IF TESTRC ^= 0                                    2176 10576000
*                  THEN                                            2176 10577000
         LH    @04,TESTRC                                          2176 10578000
         LTR   @04,@04                                             2176 10579000
         BZ    @RF02176                                            2176 10580000
*                    RETURN CODE(LASTCC12);                        2177 10581000
         LA    @15,12                                              2177 10582000
         L     @14,@SA00012                                        2177 10583000
         LM    @00,@12,@SA00012+8                                  2177 10584000
         BR    @14                                                 2177 10585000
*                CTGFVDVT = NULLPTR;                               2178 10586000
@RF02176 L     @04,CTGFVPTR                                        2178 10587000
         SLR   @15,@15                                             2178 10588000
         ST    @15,CTGFVDVT(,@04)                                  2178 10589000
*                END;                                              2179 10590000
*                                                                  2179 10591000
*            /********************************************************/ 10592000
*            /*                                                      */ 10593000
*            /*  GET CORE FOR THE FPL PLUS THE FIELD INFORMATION     */ 10594000
*            /*  IF CORE IS NOT OBTAINED, RETURN TO CALLING PROCESSOR*/ 10595000
*            /*                                                      */ 10596000
*            /********************************************************/ 10597000
*                                                                  2180 10598000
*            TOTLEN = (LENGTH(CTGFL) + 8) + DEVTPTR(LX)->DEVTCNT * 2180 10599000
*               LENGTH(FDEVTYP);                                   2180 10600000
*                                                                  2180 10601000
@RF02170 L     @04,@PC00012                                        2180 10602000
         L     @04,LX(,@04)                                        2180 10603000
         SLA   @04,2                                               2180 10604000
         L     @15,@PC00001+4                                      2180 10605000
         L     @01,FDTPTR+32(,@15)                                 2180 10606000
         AL    @01,@CF01779                                        2180 10607000
         L     @04,DEVTPTR(@04,@01)                                2180 10608000
         LH    @04,DEVTCNT(,@04)                                   2180 10609000
         MH    @04,@CH00035                                        2180 10610000
         AL    @04,@CF00312                                        2180 10611000
         ST    @04,TOTLEN                                          2180 10612000
*            CALL IDCSAGP0 (GDTTBL,TOTLEN,CTGFVDVT,GPID,SETZERO);  2181 10613000
*                                                                  2181 10614000
         L     @04,@PC00001                                        2181 10615000
         ST    @04,@AL00001                                        2181 10616000
         LA    @15,TOTLEN                                          2181 10617000
         ST    @15,@AL00001+4                                      2181 10618000
         L     @01,CTGFVPTR                                        2181 10619000
         LA    @15,CTGFVDVT(,@01)                                  2181 10620000
         ST    @15,@AL00001+8                                      2181 10621000
         LA    @15,GPID                                            2181 10622000
         ST    @15,@AL00001+12                                     2181 10623000
         LA    @15,SETZERO                                         2181 10624000
         ST    @15,@AL00001+16                                     2181 10625000
         MVI   @AL00001+16,X'80'                                   2181 10626000
         L     @15,GDTGPL(,@04)                                    2181 10627000
         LA    @01,@AL00001                                        2181 10628000
         BALR  @14,@15                                             2181 10629000
*            RESPECIFY RTNREG RSTD;                                2182 10630000
*            TESTRC = RTNREG;                                      2183 10631000
         STH   RTNREG,TESTRC                                       2183 10632000
*            RESPECIFY RTNREG UNRSTD;                              2184 10633000
*            IF TESTRC ^= 0                                        2185 10634000
*              THEN                                                2185 10635000
         LH    @04,TESTRC                                          2185 10636000
         LTR   @04,@04                                             2185 10637000
         BZ    @RF02185                                            2185 10638000
*                DO;                                               2186 10639000
*                DARGSMOD = UNIVMSG;                               2187 10640000
         L     @04,DDSTRU                                          2187 10641000
         MVC   DARGSMOD(3,@04),@CC00981                            2187 10642000
*                DEFSTID = NOSTORAG;                               2188 10643000
         MVI   DEFSTID,X'04'                                       2188 10644000
*                RETURN CODE(LASTCC12);                            2189 10645000
         LA    @15,12                                              2189 10646000
         L     @14,@SA00012                                        2189 10647000
         LM    @00,@12,@SA00012+8                                  2189 10648000
         BR    @14                                                 2189 10649000
*                END;                                              2190 10650000
*                                                                  2190 10651000
*            /********************************************************/ 10652000
*            /*                                                      */ 10653000
*            /*  CONSTRUCT DEVICETYPES LIST                          */ 10654000
*            /*                                                      */ 10655000
*            /********************************************************/ 10656000
*                                                                  2191 10657000
*            CTGFLPTR = CTGFVDVT;                                  2191 10658000
@RF02185 L     @04,CTGFVPTR                                        2191 10659000
         L     @04,CTGFVDVT(,@04)                                  2191 10660000
         ST    @04,CTGFLPTR                                        2191 10661000
*            FDEVTPTR = CTGFVDVT + LENGTH(CTGFL) +8;               2192 10662000
         AL    @04,@CF00312                                        2192 10663000
         ST    @04,FDEVTPTR                                        2192 10664000
*            DO N = 1 TO  DEVTPTR(LX)->DEVTCNT;                    2193 10665000
         LA    @04,1                                               2193 10666000
         B     @DE02193                                            2193 10667000
@DL02193 DS    0H                                                  2194 10668000
*              FDEVT(N) = DEVTPTR(LX) -> DEVTVAL(N,1:8);           2194 10669000
         LR    @15,@04                                             2194 10670000
         MH    @15,@CH00035                                        2194 10671000
         L     @01,FDEVTPTR                                        2194 10672000
         ALR   @01,@15                                             2194 10673000
         AL    @01,@CF01804                                        2194 10674000
         LR    @15,@04                                             2194 10675000
         MH    @15,@CH00037                                        2194 10676000
         L     @14,@PC00012                                        2194 10677000
         L     @14,LX(,@14)                                        2194 10678000
         SLA   @14,2                                               2194 10679000
         L     @03,@PC00001+4                                      2194 10680000
         L     @03,FDTPTR+32(,@03)                                 2194 10681000
         AL    @03,@CF01779                                        2194 10682000
         L     @14,DEVTPTR(@14,@03)                                2194 10683000
         ALR   @14,@15                                             2194 10684000
         AL    @14,@CF01805                                        2194 10685000
         MVC   FDEVT(8,@01),DEVTVAL-3(@14)                         2194 10686000
*            END;                                                  2195 10687000
*                                                                  2195 10688000
         AL    @04,@CF00221                                        2195 10689000
@DE02193 ST    @04,N                                               2195 10690000
         L     @15,@PC00012                                        2195 10691000
         L     @15,LX(,@15)                                        2195 10692000
         SLA   @15,2                                               2195 10693000
         L     @14,@PC00001+4                                      2195 10694000
         L     @01,FDTPTR+32(,@14)                                 2195 10695000
         AL    @01,@CF01779                                        2195 10696000
         L     @01,DEVTPTR(@15,@01)                                2195 10697000
         CH    @04,DEVTCNT(,@01)                                   2195 10698000
         BNH   @DL02193                                            2195 10699000
*            /********************************************************/ 10700000
*            /*                                                      */ 10701000
*            /*  SET FIELDS IN DEVTYP FPL                            */ 10702000
*            /*                                                      */ 10703000
*            /********************************************************/ 10704000
*                                                                  2196 10705000
*            CTGFLDNO = '00000001'B;                               2196 10706000
         L     @04,CTGFLPTR                                        2196 10707000
         MVI   CTGFLDNO(@04),X'01'                                 2196 10708000
*            CTGFLDNM = ADDR(FNDEVTYP);                            2197 10709000
         LA    @15,FNDEVTYP                                        2197 10710000
         ST    @15,CTGFLDNM(,@04)                                  2197 10711000
*            CTGFLNG(1) = DEVTPTR(LX)->DEVTCNT * LENGTH(FDEVTYP);  2198 10712000
         L     @15,@PC00012                                        2198 10713000
         L     @15,LX(,@15)                                        2198 10714000
         SLA   @15,2                                               2198 10715000
         L     @14,@PC00001+4                                      2198 10716000
         L     @01,FDTPTR+32(,@14)                                 2198 10717000
         AL    @01,@CF01779                                        2198 10718000
         L     @01,DEVTPTR(@15,@01)                                2198 10719000
         LH    @15,DEVTCNT(,@01)                                   2198 10720000
         MH    @15,@CH00035                                        2198 10721000
         ST    @15,CTGFLNG(,@04)                                   2198 10722000
*            CTGFLPT(1) = FDEVTPTR;                                2199 10723000
         L     @15,FDEVTPTR                                        2199 10724000
         ST    @15,CTGFLPT(,@04)                                   2199 10725000
*            END DEVTYP2;                                          2200 10726000
*                                                                  2200 10727000
*        /************************************************************/ 10728000
*        /*                                                          */ 10729000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 10730000
*        /*                                                          */ 10731000
*        /************************************************************/ 10732000
*                                                                  2201 10733000
*        RETURN CODE(0);                                           2201 10734000
*                                                                  2201 10735000
@RF02168 SLR   @15,@15                                             2201 10736000
         L     @14,@SA00012                                        2201 10737000
         LM    @00,@12,@SA00012+8                                  2201 10738000
         BR    @14                                                 2201 10739000
*END LVLRPROC;                                                     2202 10740000
*        /************************************************************/ 10741000
*        /*                                                          */ 10742000
*        /* PROCEDURE NAME - CTLGPROC                                */ 10743000
*        /*                                                          */ 10744000
*        /*  FUNCTION - INVOKE THE VSAM CATALOG MANAGEMENT TO PERFORM*/ 10745000
*        /*  THE OPERATION INDICATED IN THE CPL (ALTER OR DEFINE)    */ 10746000
*        /*  EXAMINE THE RETURN CODE FROM CATALOG MANAGEMENT,GET MORE*/ 10747000
*        /*  CATALOG WORK AREA IF REQUIRED, SET UP APPROPRIATE ERROR */ 10748000
*        /*  INDICATORS                                              */ 10749000
*        /*                                                          */ 10750000
*        /*  INPUT - CATALOG PARAMETER LIST(CPL)                     */ 10751000
*        /*                                                          */ 10752000
*        /*  OUTPUT - RETURN CODE IS SET TO INDICATE SUCCESS OR      */ 10753000
*        /*  FAILURE.  DEFSTID IS SET TO INDICATE MESSAGE ID IF      */ 10754000
*        /*  AN ERROR MESSAGE IS TO BE LISTED.                       */ 10755000
*        /*                                                          */ 10756000
*        /************************************************************/ 10757000
*                                                                  2203 10758000
*CTLGPROC: PROCEDURE(SCPLPTR);         /*CPL POINTER                 */ 10759000
*                                                                  2203 10760000
CTLGPROC STM   @14,@12,@SA00013                                    2203 10761000
         MVC   @PC00013(4),0(@01)                                  2203 10762000
*        /************************************************************/ 10763000
*        /*                                                          */ 10764000
*        /*  ARGUMENTS OF INVOCATION                                 */ 10765000
*        /*                                                          */ 10766000
*        /************************************************************/ 10767000
*                                                                  2204 10768000
*        DCL SCPLPTR PTR(31);                                      2204 10769000
*                                                                  2204 10770000
*        /************************************************************/ 10771000
*        /*                                                          */ 10772000
*        /* LOCAL DECLARATIONS                                       */ 10773000
*        /*                                                          */ 10774000
*        /************************************************************/ 10775000
*                                                                  2205 10776000
*        DCL WSIZE   FIXED(31);        /*SIZE OF WORK AREA NEEDED BY */ 10777000
*                                      /*VSAM CATALOG MANAGEMENT     */ 10778000
*        DCL VOLLSTOR CHAR(10) BDY(WORD);                          2206 10779000
*                                      /*STORAGE FOR THE             */ 10780000
*                                      /*FAKE VOLUMES LIST           */ 10781000
*                                      /*TO BE PASSED TO             */ 10782000
*                                      /*DALCPROC WHEN CMS           */ 10783000
*                                      /*PLACES THE VOLSER           */ 10784000
*                                      /*TO BE ALLOCATED IN          */ 10785000
*                                      /*THE WORKAREA.               */ 10786000
*        DCL VOLLSTPT PTR(31);         /*POINTER TO VOLLSTOR         */ 10787000
*        DCL JX       FIXED(31);       /*INDEX USED IN               */ 10788000
*                                      /*VOLUME LIST                 */ 10789000
*                                      /*RESTORE                     */ 10790000
*        DCL JX1      FIXED(31);       /*INDEX USED IN               */ 10791000
*                                      /*VOLUME LIST                 */ 10792000
*                                      /*RESTORE                     */ 10793000
*                                                                  2210 10794000
*                                                                  2210 10795000
*        /************************************************************/ 10796000
*        /*                                                          */ 10797000
*        /*  INVOKE  CATALOG MANAGEMENT                              */ 10798000
*        /*                                                          */ 10799000
*        /************************************************************/ 10800000
*                                                                  2210 10801000
*        OLDERID2 = NEWERID2;                                      2210 10802000
         L     @04,@PC00001                                        2210 10803000
         L     @15,GDTTR2(,@04)                                    2210 10804000
         MVC   @TS00001(95),NEWERID2(@15)                          2210 10805000
         MVC   OLDERID2(95,@15),@TS00001                           2210 10806000
*        NEWID2 = 'RMSP';                                          2211 10807000
*                                                                  2211 10808000
         MVC   NEWID2(4,@15),@CC01550                              2211 10809000
*        IF GDTDBG = NULLPTR                                       2212 10810000
*          THEN;                                                   2212 10811000
         L     @04,GDTDBG(,@04)                                    2212 10812000
         LTR   @04,@04                                             2212 10813000
         BZ    @RT02212                                            2212 10814000
*          ELSE                                                    2214 10815000
*            CALL IDCDB010 (GDTTBL,'RMZZ');                        2214 10816000
*                                                                  2214 10817000
         L     @04,@PC00001                                        2214 10818000
         ST    @04,@AL00001                                        2214 10819000
         LA    @15,@CC01551                                        2214 10820000
         ST    @15,@AL00001+4                                      2214 10821000
         MVI   @AL00001+4,X'80'                                    2214 10822000
         L     @15,GDTDBG(,@04)                                    2214 10823000
         LA    @01,@AL00001                                        2214 10824000
         BALR  @14,@15                                             2214 10825000
*        CATRTNID = 'CATLGRTN';                                    2215 10826000
*                                                                  2215 10827000
@RT02212 MVC   CATRTNID(8),@CC01552                                2215 10828000
*        CALL IDCSACA0 (GDTTBL,SCPLPTR);                           2216 10829000
*                                                                  2216 10830000
         L     @04,@PC00001                                        2216 10831000
         ST    @04,@AL00001                                        2216 10832000
         L     @15,@PC00013                                        2216 10833000
         ST    @15,@AL00001+4                                      2216 10834000
         L     @15,GDTCAT(,@04)                                    2216 10835000
         LA    @01,@AL00001                                        2216 10836000
         BALR  @14,@15                                             2216 10837000
*        RESPECIFY REG15 RSTD;                                     2217 10838000
*        CATLGRC = REG15;                                          2218 10839000
         STH   REG15,CATLGRC                                       2218 10840000
*        RESPECIFY REG15 UNRSTD;                                   2219 10841000
*                                                                  2219 10842000
*        IF GDTDBG = NULLPTR                                       2220 10843000
*          THEN;                                                   2220 10844000
         L     @04,@PC00001                                        2220 10845000
         L     @04,GDTDBG(,@04)                                    2220 10846000
         LTR   @04,@04                                             2220 10847000
         BZ    @RT02220                                            2220 10848000
*          ELSE                                                    2222 10849000
*            CALL IDCDB010 (GDTTBL,'RMZZ');                        2222 10850000
         L     @04,@PC00001                                        2222 10851000
         ST    @04,@AL00001                                        2222 10852000
         LA    @15,@CC01551                                        2222 10853000
         ST    @15,@AL00001+4                                      2222 10854000
         MVI   @AL00001+4,X'80'                                    2222 10855000
         L     @15,GDTDBG(,@04)                                    2222 10856000
         LA    @01,@AL00001                                        2222 10857000
         BALR  @14,@15                                             2222 10858000
*        CTGPLPTR = SCPLPTR;                                       2223 10859000
*                                                                  2223 10860000
@RT02220 L     @04,@PC00013                                        2223 10861000
         L     @04,SCPLPTR(,@04)                                   2223 10862000
         ST    @04,CTGPLPTR                                        2223 10863000
*        /************************************************************/ 10864000
*        /*                                                          */ 10865000
*        /*  IF THE RETURN CODE INDICATES AN ERROR, TEST FOR WORK    */ 10866000
*        /*  AREA TOO SMALL.  IF IT IS, GET A NEW WORK AREA AFTER    */ 10867000
*        /*  FREEING THE OLD ONE.  RE-INVOKE CATALOG MANAGEMENT      */ 10868000
*        /*                                                          */ 10869000
*        /************************************************************/ 10870000
*                                                                  2224 10871000
*        IF CATLGRC ^= 0                                           2224 10872000
*          THEN                                                    2224 10873000
         LH    @15,CATLGRC                                         2224 10874000
         SLR   @14,@14                                             2224 10875000
         CR    @15,@14                                             2224 10876000
         BE    @RF02224                                            2224 10877000
*            IF CATLGRC = RCWORKSM                                 2225 10878000
*              THEN                                                2225 10879000
         C     @15,@CF01127                                        2225 10880000
         BNE   @RF02225                                            2225 10881000
*                DO;                                               2226 10882000
*                                                                  2226 10883000
*                /****************************************************/ 10884000
*                /*                                                  */ 10885000
*                /*  GET NEEDED SIZE FROM CATALOG WORKAREA           */ 10886000
*                /*                                                  */ 10887000
*                /****************************************************/ 10888000
*                                                                  2227 10889000
*                WSIZE = RETURNLN;                                 2227 10890000
*                                                                  2227 10891000
         L     @01,CTGWKA(,@04)                                    2227 10892000
         LH    @15,RETURNLN(,@01)                                  2227 10893000
         ST    @15,WSIZE                                           2227 10894000
*                /****************************************************/ 10895000
*                /*                                                  */ 10896000
*                /*  RESET CTGWKA TO NULLPTR.  THE AREA OCCUPIED     */ 10897000
*                /*  BY THE CATALOG WORK AREA WAS GOTTEN AS A        */ 10898000
*                /*  PART OF THE SPACE FOR THE CATALOG PARAMETER     */ 10899000
*                /*  LIST, AND SO CANNOT BE FREED UP SEPARATELY.     */ 10900000
*                /*                                                  */ 10901000
*                /****************************************************/ 10902000
*                                                                  2228 10903000
*                CTGWKA = NULLPTR;                                 2228 10904000
*                                                                  2228 10905000
         ST    @14,CTGWKA(,@04)                                    2228 10906000
*                /****************************************************/ 10907000
*                /*                                                  */ 10908000
*                /*  GET CORE FOR THE LARGER WORK AREA.  IF CORE IS  */ 10909000
*                /*  NOT GOTTEN SUCCESSFULLY, RETURN TO THE CALLING  */ 10910000
*                /*  PROCESSOR.                                      */ 10911000
*                /*                                                  */ 10912000
*                /****************************************************/ 10913000
*                                                                  2229 10914000
*                CALL IDCSAGP0 (GDTTBL,WSIZE,CTGWKA,GPID,SETZERO); 2229 10915000
*                                                                  2229 10916000
         L     @15,@PC00001                                        2229 10917000
         ST    @15,@AL00001                                        2229 10918000
         LA    @14,WSIZE                                           2229 10919000
         ST    @14,@AL00001+4                                      2229 10920000
         LA    @04,CTGWKA(,@04)                                    2229 10921000
         ST    @04,@AL00001+8                                      2229 10922000
         LA    @04,GPID                                            2229 10923000
         ST    @04,@AL00001+12                                     2229 10924000
         LA    @04,SETZERO                                         2229 10925000
         ST    @04,@AL00001+16                                     2229 10926000
         MVI   @AL00001+16,X'80'                                   2229 10927000
         L     @15,GDTGPL(,@15)                                    2229 10928000
         LA    @01,@AL00001                                        2229 10929000
         BALR  @14,@15                                             2229 10930000
*                RESPECIFY RTNREG RSTD;                            2230 10931000
*                TESTRC = RTNREG;                                  2231 10932000
         STH   RTNREG,TESTRC                                       2231 10933000
*                RESPECIFY RTNREG UNRSTD;                          2232 10934000
*                IF TESTRC ^= 0                                    2233 10935000
*                  THEN                                            2233 10936000
         LH    @04,TESTRC                                          2233 10937000
         LTR   @04,@04                                             2233 10938000
         BZ    @RF02233                                            2233 10939000
*                    DO;                                           2234 10940000
*                    DEFSTID = NOSTORAG;                           2235 10941000
         MVI   DEFSTID,X'04'                                       2235 10942000
*                    DARGSMOD = UNIVMSG;                           2236 10943000
         L     @04,DDSTRU                                          2236 10944000
         MVC   DARGSMOD(3,@04),@CC00981                            2236 10945000
*                    RETURN CODE(LASTCC12);                        2237 10946000
         LA    @15,12                                              2237 10947000
         L     @14,@SA00013                                        2237 10948000
         LM    @00,@12,@SA00013+8                                  2237 10949000
         BR    @14                                                 2237 10950000
*                    END;                                          2238 10951000
*                                                                  2238 10952000
*                AREALN = WSIZE;                                   2239 10953000
*                                                                  2239 10954000
@RF02233 L     @04,CTGPLPTR                                        2239 10955000
         L     @04,CTGWKA(,@04)                                    2239 10956000
         L     @15,WSIZE                                           2239 10957000
         STH   @15,AREALN(,@04)                                    2239 10958000
*                /****************************************************/ 10959000
*                /*                                                  */ 10960000
*                /*  RE- INVOKE CATALOG MANAGEMENT                   */ 10961000
*                /*                                                  */ 10962000
*                /****************************************************/ 10963000
*                                                                  2240 10964000
*                CALL IDCSACA0 (GDTTBL,SCPLPTR);                   2240 10965000
*                                                                  2240 10966000
         L     @04,@PC00001                                        2240 10967000
         ST    @04,@AL00001                                        2240 10968000
         L     @15,@PC00013                                        2240 10969000
         ST    @15,@AL00001+4                                      2240 10970000
         L     @15,GDTCAT(,@04)                                    2240 10971000
         LA    @01,@AL00001                                        2240 10972000
         BALR  @14,@15                                             2240 10973000
*                RESPECIFY REG15 RSTD;                             2241 10974000
*                CATLGRC = REG15;                                  2242 10975000
         STH   REG15,CATLGRC                                       2242 10976000
*                RESPECIFY REG15 UNRSTD;                           2243 10977000
*                END;                                              2244 10978000
*                                                                  2244 10979000
*              ELSE                                                2245 10980000
*                                                                  2245 10981000
*                /****************************************************/ 10982000
*                /*                                                  */ 10983000
*                /*  TEST FOR A VSAM CATALOG RETURN CODE OF          */ 10984000
*                /*  140 WITH A REASON CODE OF 40.  THIS             */ 10985000
*                /*  INDICATES THAT A VOLUME MUST BE                 */ 10986000
*                /*  DYNAMICALLY ALLOCATED SO THAT ITS CRA           */ 10987000
*                /*  CAN BE UPDATED.                                 */ 10988000
*                /*                                                  */ 10989000
*                /****************************************************/ 10990000
*                                                                  2245 10991000
*                IF (CATLGRC = DEFALLRC) & (CTGFBFLG =             2245 10992000
*                   DEFALLFG)                                      2245 10993000
*                  THEN                                            2245 10994000
         B     @RC02225                                            2245 10995000
@RF02225 CLC   CATLGRC(2),@CH01139                                 2245 10996000
         BNE   @RF02245                                            2245 10997000
         L     @04,CTGPLPTR                                        2245 10998000
         CLC   CTGFBFLG(2,@04),@CH01127                            2245 10999000
         BNE   @RF02245                                            2245 11000000
*DEFALLC:            DO;                                           2246 11001000
*                                                                  2246 11002000
DEFALLC  DS    0H                                                  2247 11003000
*                    /************************************************/ 11004000
*                    /*                                              */ 11005000
*                    /*  VSAM CATALOG MANAGEMENT IS TO BE            */ 11006000
*                    /*  INVOKED AGAIN.  RESTORE THE CATALOG         */ 11007000
*                    /*  PARAMETER LISTS TO BE PASSED TO             */ 11008000
*                    /*  VSAM.                                       */ 11009000
*                    /*                                              */ 11010000
*                    /************************************************/ 11011000
*                                                                  2247 11012000
*                    IF (CTGFVT->CTGFVTYP = CTGTCL) |              2247 11013000
*                         (CTGFVT->CTGFVTYP = CTGTAIX)             2247 11014000
*                      THEN                                        2247 11015000
         L     @04,CTGPLPTR                                        2247 11016000
         L     @04,CTGFVT(,@04)                                    2247 11017000
         CLI   CTGFVTYP(@04),C'C'                                  2247 11018000
         BE    @RT02247                                            2247 11019000
         CLI   CTGFVTYP(@04),C'G'                                  2247 11020000
         BNE   @RF02247                                            2247 11021000
@RT02247 DS    0H                                                  2248 11022000
*DEFCALLC:               DO;                                       2248 11023000
DEFCALLC DS    0H                                                  2249 11024000
*                        CTGPL = SAVCPL;                           2249 11025000
         L     @04,CTGPLPTR                                        2249 11026000
         MVC   CTGPL(28,@04),SAVCPL                                2249 11027000
*                        DO JX = 1 TO NUMCOMP;                     2250 11028000
         LA    @04,1                                               2250 11029000
         B     @DE02250                                            2250 11030000
@DL02250 DS    0H                                                  2251 11031000
*                          CALL MVDAPROC(TFVTLEN,SAVFVT(JX),       2251 11032000
*                             FVTPTR(JX));                         2251 11033000
         LA    @15,TFVTLEN                                         2251 11034000
         ST    @15,@AL00001                                        2251 11035000
         SLA   @04,2                                               2251 11036000
         LA    @15,SAVFVT-4(@04)                                   2251 11037000
         ST    @15,@AL00001+4                                      2251 11038000
         LA    @04,FVTPTR-4(@04)                                   2251 11039000
         ST    @04,@AL00001+8                                      2251 11040000
         LA    @01,@AL00001                                        2251 11041000
         BAL   @14,MVDAPROC                                        2251 11042000
*                          IF CTGFVVLT ^= NULLPTR                  2252 11043000
*                            THEN                                  2252 11044000
         L     @04,CTGFVPTR                                        2252 11045000
         L     @04,CTGFVVLT(,@04)                                  2252 11046000
         LTR   @04,@04                                             2252 11047000
         BZ    @RF02252                                            2252 11048000
*                              DO JX1 = 1 TO (FLISTLN/             2253 11049000
*                                 LENGTH(FVOLSERL));               2253 11050000
         LA    @04,1                                               2253 11051000
         B     @DE02253                                            2253 11052000
@DL02253 DS    0H                                                  2254 11053000
*                                FVOLRTN(JX1) = 0;                 2254 11054000
         LR    @15,@04                                             2254 11055000
         SLA   @15,3                                               2254 11056000
         L     @01,CTGFVPTR                                        2254 11057000
         L     @01,CTGFVVLT(,@01)                                  2254 11058000
         ALR   @01,@15                                             2254 11059000
         AL    @01,@CF01786                                        2254 11060000
         SLR   @00,@00                                             2254 11061000
         STCM  @00,3,FVOLRTN-2(@01)                                2254 11062000
*                              END;                                2255 11063000
         AL    @04,@CF00221                                        2255 11064000
@DE02253 ST    @04,JX1                                             2255 11065000
         L     @01,CTGFVPTR                                        2255 11066000
         L     @01,CTGFVVLT(,@01)                                  2255 11067000
         LH    @00,FLISTLN(,@01)                                   2255 11068000
         SRDA  @00,32                                              2255 11069000
         D     @00,@CF00039                                        2255 11070000
         CR    @04,@01                                             2255 11071000
         BNH   @DL02253                                            2255 11072000
*                        END;                                      2256 11073000
*                                                                  2256 11074000
@RF02252 LA    @04,1                                               2256 11075000
         AL    @04,JX                                              2256 11076000
@DE02250 ST    @04,JX                                              2256 11077000
         CH    @04,NUMCOMP                                         2256 11078000
         BNH   @DL02250                                            2256 11079000
*                        /********************************************/ 11080000
*                        /*                                          */ 11081000
*                        /*  IF THERE IS A NULL VOLUME               */ 11082000
*                        /*  FVT, RESTORE THAT.                      */ 11083000
*                        /*                                          */ 11084000
*                        /********************************************/ 11085000
*                                                                  2257 11086000
*                        IF FVTPTR(1) -> CTGFVVCH ^= NULLPTR       2257 11087000
*                          THEN                                    2257 11088000
         L     @04,FVTPTR                                          2257 11089000
         L     @04,CTGFVVCH(,@04)                                  2257 11090000
         LTR   @04,@04                                             2257 11091000
         BZ    @RF02257                                            2257 11092000
*                            DO;                                   2258 11093000
*                            IUNIQFVT = ''B;                       2259 11094000
         XC    IUNIQFVT(92),IUNIQFVT                               2259 11095000
*                            FVTPTR(1) -> CTGFVVCH -> CTGFVTYP     2260 11096000
*                               = CTGFVVOL;                        2260 11097000
         MVI   CTGFVTYP(@04),C'V'                                  2260 11098000
*                            END;                                  2261 11099000
*                                                                  2261 11100000
*                        /********************************************/ 11101000
*                        /*                                          */ 11102000
*                        /*  IF THE OBJECT BEING DEFINED IS          */ 11103000
*                        /*  AN ALTERNATE INDEX, THEN                */ 11104000
*                        /*  THEN CMS HAS PLACED THE VOLUME          */ 11105000
*                        /*  SERIAL OF THE VOLUME TO BE              */ 11106000
*                        /*  ALLOCATED IN THE WORK AREA.             */ 11107000
*                        /*                                          */ 11108000
*                        /********************************************/ 11109000
*                                                                  2262 11110000
*                        IF (FVTPTR(1) -> CTGFVTYP = CTGTAIX)      2262 11111000
*                          THEN                                    2262 11112000
@RF02257 L     @04,FVTPTR                                          2262 11113000
         CLI   CTGFVTYP(@04),C'G'                                  2262 11114000
         BNE   @RF02262                                            2262 11115000
*                            DO;                                   2263 11116000
*                                                                  2263 11117000
*                            /****************************************/ 11118000
*                            /*                                      */ 11119000
*                            /*  BUILD A FAKE VOLUMES LIST TO BE     */ 11120000
*                            /*  PASSED TO DALCPROC.                 */ 11121000
*                            /*  RESPECIFY THE VOLUME LIST           */ 11122000
*                            /*  OVERLAY TO BE BASED ON VOLLSTPT     */ 11123000
*                            /*  AND ESTABLISH ADDRESSABILITY TO     */ 11124000
*                            /*  THE STORAGE FOR THE VOLUME LIST.    */ 11125000
*                            /*                                      */ 11126000
*                            /****************************************/ 11127000
*                                                                  2264 11128000
*                            RESPECIFY FLISTVOL BASED(VOLLSTPT);   2264 11129000
*                            VOLLSTPT = ADDR(VOLLSTOR);            2265 11130000
*                                                                  2265 11131000
         LA    @15,VOLLSTOR                                        2265 11132000
         ST    @15,VOLLSTPT                                        2265 11133000
*                            /****************************************/ 11134000
*                            /*                                      */ 11135000
*                            /*  BUILD THE FAKE VOLUMES LIST AND     */ 11136000
*                            /*  CALL DALCPROC.                      */ 11137000
*                            /*                                      */ 11138000
*                            /****************************************/ 11139000
*                                                                  2266 11140000
*                            FLISTLN = LENGTH(FVOLSERL(1));        2266 11141000
         MVC   FLISTLN(2,@15),@CH00039                             2266 11142000
*                            FVOLSER(1) = CATRCWKA;                2267 11143000
*                                                                  2267 11144000
         MVC   FVOLSER(6,@15),CATRCWKA                             2267 11145000
*                            CALL DALCPROC('A',VOLLSTPT,           2268 11146000
*                               FVTPTR(1) -> CTGFVIND,DALCINDX);   2268 11147000
*                                                                  2268 11148000
         LA    @15,@CC00755                                        2268 11149000
         ST    @15,@AL00001                                        2268 11150000
         LA    @15,VOLLSTPT                                        2268 11151000
         ST    @15,@AL00001+4                                      2268 11152000
         LA    @04,CTGFVIND(,@04)                                  2268 11153000
         ST    @04,@AL00001+8                                      2268 11154000
         LA    @04,DALCINDX                                        2268 11155000
         ST    @04,@AL00001+12                                     2268 11156000
         LA    @01,@AL00001                                        2268 11157000
         BAL   @14,DALCPROC                                        2268 11158000
*                            /****************************************/ 11159000
*                            /*                                      */ 11160000
*                            /*  TEST THE RETURN CODE FROM           */ 11161000
*                            /*  DALCPROC.  IF IT IS NON-ZERO,       */ 11162000
*                            /*  INDICATE A FAILURE, AND RETURN      */ 11163000
*                            /*  TO THE CALLING PROCESSOR.           */ 11164000
*                            /*                                      */ 11165000
*                            /****************************************/ 11166000
*                                                                  2269 11167000
*                            RESPECIFY RTNREG RSTD;                2269 11168000
*                            TESTRC = RTNREG;                      2270 11169000
         STH   RTNREG,TESTRC                                       2270 11170000
*                            RESPECIFY RTNREG UNRSTD;              2271 11171000
*                            IF TESTRC ^= 0                        2272 11172000
*                              THEN                                2272 11173000
         LH    @04,TESTRC                                          2272 11174000
         LTR   @04,@04                                             2272 11175000
         BZ    @RF02272                                            2272 11176000
*                                RETURN CODE(LASTCC12);            2273 11177000
         LA    @15,12                                              2273 11178000
         L     @14,@SA00013                                        2273 11179000
         LM    @00,@12,@SA00013+8                                  2273 11180000
         BR    @14                                                 2273 11181000
*                            RESPECIFY FLISTVOL                    2274 11182000
*                               BASED(CTGFVVLT);                   2274 11183000
@RF02272 DS    0H                                                  2275 11184000
*                            END;                                  2275 11185000
*                                                                  2275 11186000
*                    /************************************************/ 11187000
*                    /*                                              */ 11188000
*                    /*  IF THERE IS A DATA COMPONENT PRESENT,       */ 11189000
*                    /*  DYNAMICALLY ALLOCATE THE VOLUMES FROM       */ 11190000
*                    /*  THE VOLUMES LIST AT THE DATA LEVEL.         */ 11191000
*                    /*                                              */ 11192000
*                    /************************************************/ 11193000
*                                                                  2276 11194000
*                    IF FVTPTR(2) ^= NULLPTR                       2276 11195000
*                      THEN                                        2276 11196000
@RF02262 SLR   @04,@04                                             2276 11197000
         L     @15,FVTPTR+4                                        2276 11198000
         CR    @15,@04                                             2276 11199000
         BE    @RF02276                                            2276 11200000
*                        IF (FVTPTR(2) -> CTGFVIND = NULLPTR)      2277 11201000
*                           & (FVTPTR(2) -> CTGFVVLT ^=            2277 11202000
*                           NULLPTR)                               2277 11203000
*                          THEN                                    2277 11204000
         C     @04,CTGFVIND(,@15)                                  2277 11205000
         BNE   @RF02277                                            2277 11206000
         C     @04,CTGFVVLT(,@15)                                  2277 11207000
         BE    @RF02277                                            2277 11208000
*                            DO;                                   2278 11209000
*                            CALL DALCPROC('A',                    2279 11210000
*                               FVTPTR(2) -> CTGFVVLT,             2279 11211000
*                               FVTPTR(2) -> CTGFVIND,             2279 11212000
*                               DALCINDX);                         2279 11213000
         LA    @04,@CC00755                                        2279 11214000
         ST    @04,@AL00001                                        2279 11215000
         LA    @04,CTGFVVLT(,@15)                                  2279 11216000
         ST    @04,@AL00001+4                                      2279 11217000
         LA    @04,CTGFVIND(,@15)                                  2279 11218000
         ST    @04,@AL00001+8                                      2279 11219000
         LA    @04,DALCINDX                                        2279 11220000
         ST    @04,@AL00001+12                                     2279 11221000
         LA    @01,@AL00001                                        2279 11222000
         BAL   @14,DALCPROC                                        2279 11223000
*                            RESPECIFY RTNREG RSTD;                2280 11224000
*                            TESTRC = RTNREG;                      2281 11225000
         STH   RTNREG,TESTRC                                       2281 11226000
*                            RESPECIFY RTNREG UNRSTD;              2282 11227000
*                            IF TESTRC ^= 0                        2283 11228000
*                              THEN                                2283 11229000
         LH    @04,TESTRC                                          2283 11230000
         LTR   @04,@04                                             2283 11231000
         BZ    @RF02283                                            2283 11232000
*                                RETURN CODE(LASTCC12);            2284 11233000
         LA    @15,12                                              2284 11234000
         L     @14,@SA00013                                        2284 11235000
         LM    @00,@12,@SA00013+8                                  2284 11236000
         BR    @14                                                 2284 11237000
*                            END;                                  2285 11238000
*                                                                  2285 11239000
@RF02283 DS    0H                                                  2286 11240000
*                    /************************************************/ 11241000
*                    /*                                              */ 11242000
*                    /*  IF THERE IS AN INDEX COMPONENT PRESENT,     */ 11243000
*                    /*  DYNAMICALLY ALLOCATE THE VOLUMES FROM       */ 11244000
*                    /*  THE VOLUMES LIST AT THE INDEX LEVEL.        */ 11245000
*                    /*                                              */ 11246000
*                    /************************************************/ 11247000
*                                                                  2286 11248000
*                    IF FVTPTR(3) ^= NULLPTR                       2286 11249000
*                      THEN                                        2286 11250000
@RF02277 DS    0H                                                  2286 11251000
@RF02276 SLR   @04,@04                                             2286 11252000
         L     @15,FVTPTR+8                                        2286 11253000
         CR    @15,@04                                             2286 11254000
         BE    @RF02286                                            2286 11255000
*                        IF (FVTPTR(3) -> CTGFVIND = NULLPTR)      2287 11256000
*                           & (FVTPTR(3) -> CTGFVVLT ^=            2287 11257000
*                           NULLPTR)                               2287 11258000
*                          THEN                                    2287 11259000
         C     @04,CTGFVIND(,@15)                                  2287 11260000
         BNE   @RF02287                                            2287 11261000
         C     @04,CTGFVVLT(,@15)                                  2287 11262000
         BE    @RF02287                                            2287 11263000
*                            DO;                                   2288 11264000
*                            CALL DALCPROC('A',                    2289 11265000
*                               FVTPTR(3) -> CTGFVVLT,             2289 11266000
*                               FVTPTR(3) -> CTGFVIND,             2289 11267000
*                               DALCINDX);                         2289 11268000
         LA    @04,@CC00755                                        2289 11269000
         ST    @04,@AL00001                                        2289 11270000
         LA    @04,CTGFVVLT(,@15)                                  2289 11271000
         ST    @04,@AL00001+4                                      2289 11272000
         LA    @04,CTGFVIND(,@15)                                  2289 11273000
         ST    @04,@AL00001+8                                      2289 11274000
         LA    @04,DALCINDX                                        2289 11275000
         ST    @04,@AL00001+12                                     2289 11276000
         LA    @01,@AL00001                                        2289 11277000
         BAL   @14,DALCPROC                                        2289 11278000
*                            RESPECIFY RTNREG RSTD;                2290 11279000
*                            TESTRC = RTNREG;                      2291 11280000
         STH   RTNREG,TESTRC                                       2291 11281000
*                            RESPECIFY RTNREG UNRSTD;              2292 11282000
*                            IF TESTRC ^= 0                        2293 11283000
*                              THEN                                2293 11284000
         LH    @04,TESTRC                                          2293 11285000
         LTR   @04,@04                                             2293 11286000
         BZ    @RF02293                                            2293 11287000
*                                RETURN CODE(LASTCC12);            2294 11288000
         LA    @15,12                                              2294 11289000
         L     @14,@SA00013                                        2294 11290000
         LM    @00,@12,@SA00013+8                                  2294 11291000
         BR    @14                                                 2294 11292000
*                            END;                                  2295 11293000
*                        END DEFCALLC;                             2296 11294000
*                      ELSE                                        2297 11295000
*DEFPALLC:               DO;                                       2297 11296000
*                                                                  2297 11297000
         B     @RC02247                                            2297 11298000
@RF02247 DS    0H                                                  2297 11299000
DEFPALLC DS    0H                                                  2298 11300000
*                        /********************************************/ 11301000
*                        /*                                          */ 11302000
*                        /*  HANDLE 140-40 FOR PATHS.                */ 11303000
*                        /*                                          */ 11304000
*                        /********************************************/ 11305000
*                                                                  2298 11306000
*                        CTGPL = PSAVCPL;                          2298 11307000
*                                                                  2298 11308000
         L     @04,CTGPLPTR                                        2298 11309000
         MVC   CTGPL(28,@04),PSAVCPL                               2298 11310000
*                        /********************************************/ 11311000
*                        /*                                          */ 11312000
*                        /*  SET CTGFVT TO POINT TO THE FVT          */ 11313000
*                        /*  FOR THE PATH DEFINE OPERATION.          */ 11314000
*                        /*                                          */ 11315000
*                        /********************************************/ 11316000
*                                                                  2299 11317000
*                        CTGFVT = PFVTPTR;                         2299 11318000
*                                                                  2299 11319000
         L     @15,PFVTPTR                                         2299 11320000
         ST    @15,CTGFVT(,@04)                                    2299 11321000
*                        /********************************************/ 11322000
*                        /*                                          */ 11323000
*                        /*  IF THE OBJECT BEING DEFINED IS          */ 11324000
*                        /*  A PATH, THEN                            */ 11325000
*                        /*  THEN CMS HAS PLACED THE VOLUME          */ 11326000
*                        /*  SERIAL OF THE VOLUME TO BE              */ 11327000
*                        /*  ALLOCATED IN THE WORK AREA.             */ 11328000
*                        /*                                          */ 11329000
*                        /********************************************/ 11330000
*                                                                  2300 11331000
*                        IF (PFVTPTR -> CTGFVTYP = CTGTPTH)        2300 11332000
*                          THEN                                    2300 11333000
         CLI   CTGFVTYP(@15),C'R'                                  2300 11334000
         BNE   @RF02300                                            2300 11335000
*                            DO;                                   2301 11336000
*                                                                  2301 11337000
*                            /****************************************/ 11338000
*                            /*                                      */ 11339000
*                            /*  BUILD A FAKE VOLUMES LIST TO BE     */ 11340000
*                            /*  PASSED TO DALCPROC.                 */ 11341000
*                            /*  RESPECIFY THE VOLUME LIST           */ 11342000
*                            /*  OVERLAY TO BE BASED ON VOLLSTPT     */ 11343000
*                            /*  AND ESTABLISH ADDRESSABILITY TO     */ 11344000
*                            /*  THE STORAGE FOR THE VOLUME LIST.    */ 11345000
*                            /*                                      */ 11346000
*                            /****************************************/ 11347000
*                                                                  2302 11348000
*                            RESPECIFY FLISTVOL BASED(VOLLSTPT);   2302 11349000
*                            VOLLSTPT = ADDR(VOLLSTOR);            2303 11350000
*                                                                  2303 11351000
         LA    @04,VOLLSTOR                                        2303 11352000
         ST    @04,VOLLSTPT                                        2303 11353000
*                            /****************************************/ 11354000
*                            /*                                      */ 11355000
*                            /*  BUILD THE FAKE VOLUMES LIST AND     */ 11356000
*                            /*  CALL DALCPROC.                      */ 11357000
*                            /*                                      */ 11358000
*                            /****************************************/ 11359000
*                                                                  2304 11360000
*                            FLISTLN = LENGTH(FVOLSERL(1));        2304 11361000
         MVC   FLISTLN(2,@04),@CH00039                             2304 11362000
*                            FVOLSER(1) = CATRCWKA;                2305 11363000
*                                                                  2305 11364000
         MVC   FVOLSER(6,@04),CATRCWKA                             2305 11365000
*                            CALL DALCPROC('A',VOLLSTPT,           2306 11366000
*                               PFVTPTR -> CTGFVIND,DALCINDX);     2306 11367000
*                                                                  2306 11368000
         LA    @04,@CC00755                                        2306 11369000
         ST    @04,@AL00001                                        2306 11370000
         LA    @04,VOLLSTPT                                        2306 11371000
         ST    @04,@AL00001+4                                      2306 11372000
         LA    @04,CTGFVIND(,@15)                                  2306 11373000
         ST    @04,@AL00001+8                                      2306 11374000
         LA    @04,DALCINDX                                        2306 11375000
         ST    @04,@AL00001+12                                     2306 11376000
         LA    @01,@AL00001                                        2306 11377000
         BAL   @14,DALCPROC                                        2306 11378000
*                            /****************************************/ 11379000
*                            /*                                      */ 11380000
*                            /*  TEST THE RETURN CODE FROM           */ 11381000
*                            /*  DALCPROC.  IF IT IS NON-ZERO,       */ 11382000
*                            /*  INDICATE A FAILURE, AND RETURN      */ 11383000
*                            /*  TO THE CALLING PROCESSOR.           */ 11384000
*                            /*                                      */ 11385000
*                            /****************************************/ 11386000
*                                                                  2307 11387000
*                            RESPECIFY RTNREG RSTD;                2307 11388000
*                            TESTRC = RTNREG;                      2308 11389000
         STH   RTNREG,TESTRC                                       2308 11390000
*                            RESPECIFY RTNREG UNRSTD;              2309 11391000
*                            IF TESTRC ^= 0                        2310 11392000
*                              THEN                                2310 11393000
         LH    @04,TESTRC                                          2310 11394000
         LTR   @04,@04                                             2310 11395000
         BZ    @RF02310                                            2310 11396000
*                                RETURN CODE(LASTCC12);            2311 11397000
         LA    @15,12                                              2311 11398000
         L     @14,@SA00013                                        2311 11399000
         LM    @00,@12,@SA00013+8                                  2311 11400000
         BR    @14                                                 2311 11401000
*                            RESPECIFY FLISTVOL                    2312 11402000
*                               BASED(CTGFVVLT);                   2312 11403000
@RF02310 DS    0H                                                  2313 11404000
*                            END;                                  2313 11405000
*                        END DEFPALLC;                             2314 11406000
*                                                                  2314 11407000
@RF02300 DS    0H                                                  2315 11408000
*                /****************************************************/ 11409000
*                /*                                                  */ 11410000
*                /*  NOW CALL VSAM CATALOG MANAGEMENT AGAIN.         */ 11411000
*                /*                                                  */ 11412000
*                /****************************************************/ 11413000
*                                                                  2315 11414000
*                CALL IDCSACA0(GDTTBL,SCPLPTR);                    2315 11415000
*                                                                  2315 11416000
@RC02247 L     @04,@PC00001                                        2315 11417000
         ST    @04,@AL00001                                        2315 11418000
         L     @15,@PC00013                                        2315 11419000
         ST    @15,@AL00001+4                                      2315 11420000
         L     @15,GDTCAT(,@04)                                    2315 11421000
         LA    @01,@AL00001                                        2315 11422000
         BALR  @14,@15                                             2315 11423000
*                RESPECIFY REG15 RSTD;                             2316 11424000
*                CATLGRC = REG15;                                  2317 11425000
         STH   REG15,CATLGRC                                       2317 11426000
*                RESPECIFY REG15 UNRSTD;                           2318 11427000
*                                                                  2318 11428000
*                /****************************************************/ 11429000
*                /*                                                  */ 11430000
*                /*  CALL DALCPROC TO DYNAMICALLY UNALLOCATE         */ 11431000
*                /*  THE VOLUMES ALLOCATED.                          */ 11432000
*                /*                                                  */ 11433000
*                /****************************************************/ 11434000
*                                                                  2319 11435000
*                CALL DALCPROC('D',NULLPARM,NULLPARM,              2319 11436000
*                   DALCINDX);                                     2319 11437000
         MVC   @AL00001(12),@AL02319                               2319 11438000
         LA    @04,DALCINDX                                        2319 11439000
         ST    @04,@AL00001+12                                     2319 11440000
         LA    @01,@AL00001                                        2319 11441000
         BAL   @14,DALCPROC                                        2319 11442000
*                RESPECIFY RTNREG RSTD;                            2320 11443000
*                TESTRC = RTNREG;                                  2321 11444000
         STH   RTNREG,TESTRC                                       2321 11445000
*                RESPECIFY RTNREG UNRSTD;                          2322 11446000
*                IF TESTRC ^= 0                                    2323 11447000
*                  THEN                                            2323 11448000
         LH    @04,TESTRC                                          2323 11449000
         LTR   @04,@04                                             2323 11450000
         BZ    @RF02323                                            2323 11451000
*                    RETURN CODE(LASTCC12);                        2324 11452000
         LA    @15,12                                              2324 11453000
         L     @14,@SA00013                                        2324 11454000
         LM    @00,@12,@SA00013+8                                  2324 11455000
         BR    @14                                                 2324 11456000
*                END DEFALLC;                                      2325 11457000
*                                                                  2325 11458000
@RF02323 DS    0H                                                  2326 11459000
*        IF CATLGRC ^= 0 &                                         2326 11460000
*           (IMPF2NER = OFF | CATLGRC ^= DUPNAME)                  2326 11461000
*          THEN                                                    2326 11462000
@RF02245 DS    0H                                                  2326 11463000
@RC02225 DS    0H                                                  2326 11464000
@RF02224 LH    @04,CATLGRC                                         2326 11465000
         LTR   @04,@04                                             2326 11466000
         BZ    @RF02326                                            2326 11467000
         TM    IMPF2NER,B'00001000'                                2326 11468000
         BZ    @RT02326                                            2326 11469000
         C     @04,@CF00039                                        2326 11470000
         BE    @RF02326                                            2326 11471000
@RT02326 DS    0H                                                  2327 11472000
*ERCALL1:    DO;                                                   2327 11473000
*                                                                  2327 11474000
ERCALL1  DS    0H                                                  2328 11475000
*            /********************************************************/ 11476000
*            /*                                                      */ 11477000
*            /*  CLEAR THE STOARGE TO BE OCCUPIED BY THE             */ 11478000
*            /*  ERROR CONVERSION TABLE.                             */ 11479000
*            /*                                                      */ 11480000
*            /********************************************************/ 11481000
*                                                                  2328 11482000
*            ERRORTAB = ''B;                                       2328 11483000
*                                                                  2328 11484000
         XC    ERRORTAB(32),ERRORTAB                               2328 11485000
*            /********************************************************/ 11486000
*            /*                                                      */ 11487000
*            /*  SET ERCNVADR TO POINT TO THE STORAGE FOR THE        */ 11488000
*            /*  ERROR CONVERSION TABLE.                             */ 11489000
*            /*                                                      */ 11490000
*            /********************************************************/ 11491000
*                                                                  2329 11492000
*            ERCNVADR = ADDR(ERRORTAB);                            2329 11493000
*                                                                  2329 11494000
         LA    @04,ERRORTAB                                        2329 11495000
         ST    @04,ERCNVADR                                        2329 11496000
*            /********************************************************/ 11497000
*            /*                                                      */ 11498000
*            /*  SET ERCATLG TO BE ON TO INDICATE THAT THIS IS       */ 11499000
*            /*  A CATALOG ERROR.  DETERMINE THE CMS FUNCTION BEING  */ 11500000
*            /*  PERFORMED, AND SET THE APPROPRIATE EROPER BIT.      */ 11501000
*            /*                                                      */ 11502000
*            /********************************************************/ 11503000
*                                                                  2330 11504000
*            ERCATLG = ON;                                         2330 11505000
         OI    ERCATLG(@04),B'10000000'                            2330 11506000
*            IF CTGOPTNS = CTGALTER                                2331 11507000
*              THEN                                                2331 11508000
*                                                                  2331 11509000
         L     @01,CTGPLPTR                                        2331 11510000
         TM    CTGOPTNS(@01),B'00010000'                           2331 11511000
         BNO   @RF02331                                            2331 11512000
         TM    CTGOPTNS(@01),B'11101000'                           2331 11513000
         BNZ   @RF02331                                            2331 11514000
*                /****************************************************/ 11515000
*                /*                                                  */ 11516000
*                /*  THE CATALOG OPERATION IS AN ALTER.  SET         */ 11517000
*                /*  ERCATAL TO BE ON.                               */ 11518000
*                /*                                                  */ 11519000
*                /****************************************************/ 11520000
*                                                                  2332 11521000
*                ERCATAL = ON;                                     2332 11522000
         OI    ERCATAL(@04),B'00010000'                            2332 11523000
*              ELSE                                                2333 11524000
*                IF CTGOPTNS = CTGDEFIN                            2333 11525000
*                  THEN                                            2333 11526000
*                                                                  2333 11527000
         B     @RC02331                                            2333 11528000
@RF02331 L     @04,CTGPLPTR                                        2333 11529000
         TM    CTGOPTNS(@04),B'00001000'                           2333 11530000
         BNO   @RF02333                                            2333 11531000
         TM    CTGOPTNS(@04),B'11110000'                           2333 11532000
         BNZ   @RF02333                                            2333 11533000
*                    /************************************************/ 11534000
*                    /*                                              */ 11535000
*                    /*  THE CATALOG OPERATION IS A DEFINE.  SET     */ 11536000
*                    /*  ERCATDE TO BE ON.                           */ 11537000
*                    /*                                              */ 11538000
*                    /************************************************/ 11539000
*                                                                  2334 11540000
*                    ERCATDE = ON;                                 2334 11541000
*                                                                  2334 11542000
         L     @04,ERCNVADR                                        2334 11543000
         OI    ERCATDE(@04),B'01000000'                            2334 11544000
*            /********************************************************/ 11545000
*            /*                                                      */ 11546000
*            /*  SET ERCATRC TO CATLGRC, AND SET ERCPLPT TO POINT    */ 11547000
*            /*  TO THE CPL FOR THE CATALOG OPERATION.               */ 11548000
*            /*                                                      */ 11549000
*            /********************************************************/ 11550000
*                                                                  2335 11551000
*            ERCATRC = CATLGRC;                                    2335 11552000
@RF02333 DS    0H                                                  2335 11553000
@RC02331 L     @04,ERCNVADR                                        2335 11554000
         LH    @15,CATLGRC                                         2335 11555000
         ST    @15,ERCATRC(,@04)                                   2335 11556000
*            ERCPLPT = CTGPLPTR;                                   2336 11557000
*                                                                  2336 11558000
         L     @15,CTGPLPTR                                        2336 11559000
         ST    @15,ERCPLPT(,@04)                                   2336 11560000
*            /********************************************************/ 11561000
*            /*                                                      */ 11562000
*            /*  SET A POINTER IN THE ERROR CONVERSION               */ 11563000
*            /*  TABLE TO THE ENTRY NAME.                            */ 11564000
*            /*                                                      */ 11565000
*            /********************************************************/ 11566000
*                                                                  2337 11567000
*            ERDSNM = CTGFVT -> CTGFVENT;                          2337 11568000
*                                                                  2337 11569000
         L     @01,CTGFVT(,@15)                                    2337 11570000
         L     @15,CTGFVENT(,@01)                                  2337 11571000
         ST    @15,ERDSNM(,@04)                                    2337 11572000
*            /********************************************************/ 11573000
*            /*                                                      */ 11574000
*            /*  INVOKE THE UERROR ROUTINE BY ISSUING THE UERROR     */ 11575000
*            /*  MACRO OF THE AMS TEXT PROCESSOR.                    */ 11576000
*            /*                                                      */ 11577000
*            /********************************************************/ 11578000
*                                                                  2338 11579000
*            CALL IDCTPER0(GDTTBL,ERCNVADR);                       2338 11580000
         L     @04,@PC00001                                        2338 11581000
         ST    @04,@AL00001                                        2338 11582000
         LA    @15,ERCNVADR                                        2338 11583000
         ST    @15,@AL00001+4                                      2338 11584000
         MVI   @AL00001+4,X'80'                                    2338 11585000
         L     @15,GDTERR(,@04)                                    2338 11586000
         LA    @01,@AL00001                                        2338 11587000
         BALR  @14,@15                                             2338 11588000
*            RETURN CODE(LASTCC12);                                2339 11589000
         LA    @15,12                                              2339 11590000
         L     @14,@SA00013                                        2339 11591000
         LM    @00,@12,@SA00013+8                                  2339 11592000
         BR    @14                                                 2339 11593000
*            END ERCALL1;                                          2340 11594000
*                                                                  2340 11595000
*        /************************************************************/ 11596000
*        /*                                                          */ 11597000
*        /*  RETURN TO THE CALLER, INDICATING THE RESULT.            */ 11598000
*        /*                                                          */ 11599000
*        /************************************************************/ 11600000
*                                                                  2341 11601000
*        IF CATLGRC ^= 0                                           2341 11602000
*          THEN                                                    2341 11603000
@RF02326 LH    @04,CATLGRC                                         2341 11604000
         LTR   @04,@04                                             2341 11605000
         BZ    @RF02341                                            2341 11606000
*            RETURN CODE(LASTCC12);                                2342 11607000
         LA    @15,12                                              2342 11608000
         L     @14,@SA00013                                        2342 11609000
         LM    @00,@12,@SA00013+8                                  2342 11610000
         BR    @14                                                 2342 11611000
*          ELSE                                                    2343 11612000
*            RETURN CODE(0);                                       2343 11613000
*                                                                  2343 11614000
@RF02341 SLR   @15,@15                                             2343 11615000
         L     @14,@SA00013                                        2343 11616000
         LM    @00,@12,@SA00013+8                                  2343 11617000
         BR    @14                                                 2343 11618000
*END CTLGPROC;                                                     2344 11619000
*        /************************************************************/ 11620000
*        /*                                                          */ 11621000
*        /*  PROCEDURE NAME - DELTPROC                               */ 11622000
*        /*                                                          */ 11623000
*        /*  FUNCTION - PERFORMS ALL CALLS TO CATALOG                */ 11624000
*        /*  DELETE.  WILL ITERATIVELY CALL CATALOG                  */ 11625000
*        /*  DELETE IF NECESSARY TO DELETE ALL OF THE                */ 11626000
*        /*  OBJECT.                                                 */ 11627000
*        /*                                                          */ 11628000
*        /*  INPUT - A POINTER TO A CPL                              */ 11629000
*        /*                                                          */ 11630000
*        /*  OUTPUT - A PRINTED LIST OF ITEMS DELETED AND            */ 11631000
*        /*  ANY APPROPRIATE ERROR MESSAGES.                         */ 11632000
*        /*                                                          */ 11633000
*        /************************************************************/ 11634000
*                                                                  2345 11635000
*DELTPROC: PROCEDURE(DLCPLPTR);                                    2345 11636000
*                                                                  2345 11637000
DELTPROC STM   @14,@12,@SA00014                                    2345 11638000
         MVC   @PC00014(4),0(@01)                                  2345 11639000
*        /************************************************************/ 11640000
*        /*                                                          */ 11641000
*        /*  ARGUMENTS OF INVOCATION                                 */ 11642000
*        /*                                                          */ 11643000
*        /************************************************************/ 11644000
*                                                                  2346 11645000
*        DCL DLCPLPTR PTR(31);         /*POINTER TO THE CPL          */ 11646000
*                                                                  2346 11647000
*        /************************************************************/ 11648000
*        /*                                                          */ 11649000
*        /*  LOCAL DECLARATIONS                                      */ 11650000
*        /*                                                          */ 11651000
*        /************************************************************/ 11652000
*                                                                  2347 11653000
*        DCL DSAVCPL CHAR(LENGTH(CTGPL));                          2347 11654000
*                                      /*SAVE AREA FOR               */ 11655000
*                                      /*DELETE CPL                  */ 11656000
*        DCL IX1 FIXED(31);            /*IX1 AND K ARE               */ 11657000
*                                      /*USED FOR LOOP               */ 11658000
*        DCL K FIXED(31);              /*CONTROL                     */ 11659000
*        DCL LIMIT FIXED(15);          /*MAXIMUM NUMBER OF           */ 11660000
*                                      /*CATALOG ENTRIES             */ 11661000
*                                      /*THAT WILL FIT INTO          */ 11662000
*                                      /*THE CURRENT WORK            */ 11663000
*                                      /*AREA                        */ 11664000
*        DCL COREFLAG BIT(1);          /*FLAG INDICATING             */ 11665000
*                                      /*WHETHER CORE HAS            */ 11666000
*                                      /*BEEN GOTTEN                 */ 11667000
*        DCL SIZENEED FIXED(31);       /*SIZE OF WORK AREA           */ 11668000
*                                      /*NEEDED                      */ 11669000
*        DCL CURSIZE  FIXED(15);       /*CURRENT SIZE OF THE         */ 11670000
*                                      /*WORK AREA                   */ 11671000
*        DCL PLIMIT   FIXED(15);       /*NUMBER OF ENTRIES           */ 11672000
*                                      /*TO BE PRINTED FROM          */ 11673000
*                                      /*THE CMS WORKAREA            */ 11674000
*                                                                  2355 11675000
*        OLDERID2 = NEWERID2;                                      2355 11676000
         L     @04,@PC00001                                        2355 11677000
         L     @15,GDTTR2(,@04)                                    2355 11678000
         MVC   @TS00001(95),NEWERID2(@15)                          2355 11679000
         MVC   OLDERID2(95,@15),@TS00001                           2355 11680000
*        NEWID2 = 'RMDL';                                          2356 11681000
*                                                                  2356 11682000
         MVC   NEWID2(4,@15),@CC01578                              2356 11683000
*        /************************************************************/ 11684000
*        /*                                                          */ 11685000
*        /*  INITIALIZE AND CALL CATALOG                             */ 11686000
*        /*                                                          */ 11687000
*        /************************************************************/ 11688000
*                                                                  2357 11689000
*        CTGPLPTR = DLCPLPTR;                                      2357 11690000
         L     @15,@PC00014                                        2357 11691000
         L     @14,DLCPLPTR(,@15)                                  2357 11692000
         ST    @14,CTGPLPTR                                        2357 11693000
*        DSAVCPL = CTGPL;                                          2358 11694000
         MVC   DSAVCPL(28),CTGPL(@14)                              2358 11695000
*        LIMIT = (AREALN - 4) / LENGTH(ENTITEM);                   2359 11696000
         L     @01,CTGWKA(,@14)                                    2359 11697000
         LH    @14,AREALN(,@01)                                    2359 11698000
         LR    @00,@14                                             2359 11699000
         SL    @00,@CF00046                                        2359 11700000
         SRDA  @00,32                                              2359 11701000
         D     @00,@CF01390                                        2359 11702000
         STH   @01,LIMIT                                           2359 11703000
*        CURSIZE = AREALN;                                         2360 11704000
         STH   @14,CURSIZE                                         2360 11705000
*        COREFLAG = OFF;                                           2361 11706000
         NI    COREFLAG,B'01111111'                                2361 11707000
*        DARGSMOD = DELMSG;                                        2362 11708000
         L     @14,DDSTRU                                          2362 11709000
         MVC   DARGSMOD(3,@14),@CC00989                            2362 11710000
*        DARGSENT = ENTRYMSG;                                      2363 11711000
         MVI   DARGSENT(@14),X'01'                                 2363 11712000
*        CATRTNID = 'CATLGRTN';                                    2364 11713000
*                                                                  2364 11714000
         MVC   CATRTNID(8),@CC01552                                2364 11715000
*        CALL IDCSACA0(GDTTBL,DLCPLPTR);                           2365 11716000
*                                                                  2365 11717000
         ST    @04,@AL00001                                        2365 11718000
         ST    @15,@AL00001+4                                      2365 11719000
         L     @15,GDTCAT(,@04)                                    2365 11720000
         LA    @01,@AL00001                                        2365 11721000
         BALR  @14,@15                                             2365 11722000
*        RESPECIFY REG15 RSTD;                                     2366 11723000
*        CATLGRC = REG15;                                          2367 11724000
         STH   REG15,CATLGRC                                       2367 11725000
*        RESPECIFY REG15 UNRSTD;                                   2368 11726000
*                                                                  2368 11727000
*        IF GDTDBG = NULLPTR                                       2369 11728000
*          THEN;                                                   2369 11729000
         L     @04,@PC00001                                        2369 11730000
         L     @04,GDTDBG(,@04)                                    2369 11731000
         LTR   @04,@04                                             2369 11732000
         BZ    @RT02369                                            2369 11733000
*          ELSE                                                    2371 11734000
*            CALL IDCDB010(GDTTBL,'RMDC');                         2371 11735000
*                                                                  2371 11736000
         L     @04,@PC00001                                        2371 11737000
         ST    @04,@AL00001                                        2371 11738000
         LA    @15,@CC01579                                        2371 11739000
         ST    @15,@AL00001+4                                      2371 11740000
         MVI   @AL00001+4,X'80'                                    2371 11741000
         L     @15,GDTDBG(,@04)                                    2371 11742000
         LA    @01,@AL00001                                        2371 11743000
         BALR  @14,@15                                             2371 11744000
*        /************************************************************/ 11745000
*        /*                                                          */ 11746000
*        /*  RESTORE THE CPL.  TO PREVENT CATALOG FROM               */ 11747000
*        /*  RE-ERASING THE OBJECT ON SUBSEQUENT CALLS,              */ 11748000
*        /*  SET CTGOVRID TO ON AND CTGERASE TO OFF. THEN            */ 11749000
*        /*  SAVE THE CPL AGAIN.                                     */ 11750000
*        /*                                                          */ 11751000
*        /************************************************************/ 11752000
*                                                                  2372 11753000
*        IF (CATLGRC = RCWORKSM) | (CATLGRC = ALLORC1)             2372 11754000
*           | (CATLGRC = ALLORC2) | (CATLGRC = ALLORC3)            2372 11755000
*          THEN                                                    2372 11756000
@RT02369 LH    @04,CATLGRC                                         2372 11757000
         C     @04,@CF01127                                        2372 11758000
         BE    @RT02372                                            2372 11759000
         C     @04,@CF01129                                        2372 11760000
         BE    @RT02372                                            2372 11761000
         C     @04,@CF01137                                        2372 11762000
         BE    @RT02372                                            2372 11763000
         C     @04,@CF01131                                        2372 11764000
         BNE   @RF02372                                            2372 11765000
@RT02372 DS    0H                                                  2373 11766000
*            DO;                                                   2373 11767000
*            CTGPL = DSAVCPL;                                      2374 11768000
         L     @04,CTGPLPTR                                        2374 11769000
         MVC   CTGPL(28,@04),DSAVCPL                               2374 11770000
*            CTGERASE = OFF;                                       2375 11771000
*            CTGOVRID = ON;                                        2376 11772000
         OI    CTGOVRID(@04),B'00000100'                           2376 11773000
         NI    CTGERASE(@04),B'10111111'                           2376 11774000
*            DSAVCPL = CTGPL;                                      2377 11775000
         MVC   DSAVCPL(28),CTGPL(@04)                              2377 11776000
*            END;                                                  2378 11777000
*                                                                  2378 11778000
*        /************************************************************/ 11779000
*        /*                                                          */ 11780000
*        /*  IF VSAM CATALOG RETURNS A CODE OF 40, LOOP              */ 11781000
*        /*  DELETING OBJECTS AND PRINTING THEM.  GET A              */ 11782000
*        /*  LARGER WORK AREA AS NEEDED.                             */ 11783000
*        /*  IF VSAM CATALOG RETURNS A CODE OF 72 OR ONE OF 76 OR ONE*/ 11784000
*        /*  OF 240, SOMETHING MUST BE DYNAMICALLY                   */ 11785000
*        /*  ALLOCATED.  LOOP PRINTING NAMES FROM THE                */ 11786000
*        /*  WORKAREA, AND CALLING CATALOG, ALLOCATING               */ 11787000
*        /*  OBJECTS NEEDED.                                         */ 11788000
*        /*                                                          */ 11789000
*        /************************************************************/ 11790000
*                                                                  2379 11791000
*DELLP:  DO WHILE (CATLGRC = RCWORKSM) | (CATLGRC = ALLORC1) |     2379 11792000
*             (CATLGRC = ALLORC2) | (CATLGRC = ALLORC3);           2379 11793000
*                                                                  2379 11794000
@RF02372 DS    0H                                                  2379 11795000
DELLP    B     @DE02379                                            2379 11796000
@DL02379 DS    0H                                                  2380 11797000
*          IX1 = 1;                                                2380 11798000
*                                                                  2380 11799000
         MVC   IX1(4),@CF00221                                     2380 11800000
*          /**********************************************************/ 11801000
*          /*                                                        */ 11802000
*          /*  IF THE VSAM CATALOG RETURN CODE WAS 72 OR 76,         */ 11803000
*          /*  ADJUST THE VALUE OF PLIMIT,  THE NUMBER OF            */ 11804000
*          /*  ENTRIES TO BE PRINTED FROM THE CMS WORKAREA           */ 11805000
*          /*  SO THAT THE OBJECT TO BE ALLOCATED AND ITS            */ 11806000
*          /*  ASSOCIATIONS DO NOT GET PRINTED.                      */ 11807000
*          /*  IN ALL OTHER CASES, THE VALUE OF PLIMIT IS            */ 11808000
*          /*  THE SIZE OF THE WORK AREA.                            */ 11809000
*          /*                                                        */ 11810000
*          /**********************************************************/ 11811000
*                                                                  2381 11812000
*          IF (CATLGRC = ALLORC1) | (CATLGRC = ALLORC3)            2381 11813000
*            THEN                                                  2381 11814000
         LH    @04,CATLGRC                                         2381 11815000
         C     @04,@CF01129                                        2381 11816000
         BE    @RT02381                                            2381 11817000
         C     @04,@CF01131                                        2381 11818000
         BNE   @RF02381                                            2381 11819000
@RT02381 DS    0H                                                  2382 11820000
*              PLIMIT = (RETURNLN - 4) / LENGTH(ENTITEM) - 1;      2382 11821000
         L     @04,CTGPLPTR                                        2382 11822000
         L     @04,CTGWKA(,@04)                                    2382 11823000
         LH    @00,RETURNLN(,@04)                                  2382 11824000
         SL    @00,@CF00046                                        2382 11825000
         SRDA  @00,32                                              2382 11826000
         D     @00,@CF01390                                        2382 11827000
         BCTR  @01,0                                               2382 11828000
         STH   @01,PLIMIT                                          2382 11829000
*            ELSE                                                  2383 11830000
*              PLIMIT = LIMIT;                                     2383 11831000
*                                                                  2383 11832000
         B     @RC02381                                            2383 11833000
@RF02381 LH    @04,LIMIT                                           2383 11834000
         STH   @04,PLIMIT                                          2383 11835000
*          /**********************************************************/ 11836000
*          /*                                                        */ 11837000
*          /*  LOOP THROUGH THE CATALOG WORK AREA, PRINTING          */ 11838000
*          /*  THE NAMES OF THE OBJECTS DELETED.                     */ 11839000
*          /*                                                        */ 11840000
*          /**********************************************************/ 11841000
*                                                                  2384 11842000
*          DO WHILE IX1 <= PLIMIT & ENTRYTYP(IX1) ^= 0;            2384 11843000
@RC02381 B     @DE02384                                            2384 11844000
@DL02384 DS    0H                                                  2385 11845000
*            DARGDBP = ADDR(ENTLIST(IX1));                         2385 11846000
         L     @04,DDSTRU                                          2385 11847000
         LA    @15,45                                              2385 11848000
         L     @01,IX1                                             2385 11849000
         MR    @00,@15                                             2385 11850000
         L     @14,CTGPLPTR                                        2385 11851000
         L     @14,CTGWKA(,@14)                                    2385 11852000
         AL    @14,@CF01798                                        2385 11853000
         LA    @14,ENTLIST-4(@01,@14)                              2385 11854000
         ST    @14,DARGDBP(,@04)                                   2385 11855000
*            DARGILP = LENGTH(ENTLIST(1));                         2386 11856000
         STH   @15,DARGILP(,@04)                                   2386 11857000
*            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);                 2387 11858000
         L     @04,@PC00001                                        2387 11859000
         ST    @04,@AL00001                                        2387 11860000
         LA    @15,@CF00119                                        2387 11861000
         ST    @15,@AL00001+4                                      2387 11862000
         LA    @15,DDSTRU                                          2387 11863000
         ST    @15,@AL00001+8                                      2387 11864000
         MVI   @AL00001+8,X'80'                                    2387 11865000
         L     @15,GDTPRT(,@04)                                    2387 11866000
         LA    @01,@AL00001                                        2387 11867000
         BALR  @14,@15                                             2387 11868000
*            IX1 = IX1 + 1;                                        2388 11869000
         LA    @04,1                                               2388 11870000
         AL    @04,IX1                                             2388 11871000
         ST    @04,IX1                                             2388 11872000
*          END;                                                    2389 11873000
*                                                                  2389 11874000
@DE02384 L     @04,IX1                                             2389 11875000
         CH    @04,PLIMIT                                          2389 11876000
         BH    @DC02384                                            2389 11877000
         MH    @04,@CH01390                                        2389 11878000
         L     @01,CTGPLPTR                                        2389 11879000
         L     @01,CTGWKA(,@01)                                    2389 11880000
         AL    @01,@CF01798                                        2389 11881000
         SLR   @00,@00                                             2389 11882000
         IC    @00,ENTRYTYP-4(@04,@01)                             2389 11883000
         C     @00,@CF00119                                        2389 11884000
         BNE   @DL02384                                            2389 11885000
@DC02384 DS    0H                                                  2390 11886000
*          /**********************************************************/ 11887000
*          /*                                                        */ 11888000
*          /*  RESTORE THE CPL FOR THE NEXT CALL TO CATALOG.         */ 11889000
*          /*                                                        */ 11890000
*          /**********************************************************/ 11891000
*                                                                  2390 11892000
*          CTGPL = DSAVCPL;                                        2390 11893000
*                                                                  2390 11894000
         L     @04,CTGPLPTR                                        2390 11895000
         MVC   CTGPL(28,@04),DSAVCPL                               2390 11896000
*          /**********************************************************/ 11897000
*          /*                                                        */ 11898000
*          /*  TEST FOR A VSAM CATALOG RETURN CODE OF 40.            */ 11899000
*          /*                                                        */ 11900000
*          /**********************************************************/ 11901000
*                                                                  2391 11902000
*          IF CATLGRC = RCWORKSM                                   2391 11903000
*            THEN                                                  2391 11904000
         CLC   CATLGRC(2),@CH01127                                 2391 11905000
         BNE   @RF02391                                            2391 11906000
*MORESP:       DO;                                                 2392 11907000
*                                                                  2392 11908000
*                                                                  2392 11909000
MORESP   DS    0H                                                  2393 11910000
*              /******************************************************/ 11911000
*              /*                                                    */ 11912000
*              /*  COMPUTE THE AMOUNT OF SPACE NEEDED BY CMS         */ 11913000
*              /*  TO CONTINUE WITH THE DELETE                       */ 11914000
*              /*                                                    */ 11915000
*              /******************************************************/ 11916000
*                                                                  2393 11917000
*              SIZENEED = RETURNLN - (LENGTH(ENTITEM) *            2393 11918000
*                (IX1 - 1));                                       2393 11919000
*                                                                  2393 11920000
         L     @04,CTGPLPTR                                        2393 11921000
         L     @01,CTGWKA(,@04)                                    2393 11922000
         L     @00,IX1                                             2393 11923000
         BCTR  @00,0                                               2393 11924000
         MH    @00,@CH01390                                        2393 11925000
         LCR   @00,@00                                             2393 11926000
         AH    @00,RETURNLN(,@01)                                  2393 11927000
         ST    @00,SIZENEED                                        2393 11928000
*              /******************************************************/ 11929000
*              /*                                                    */ 11930000
*              /*  COMPARE THE AMOUNT OF CORE NEEDED WITH            */ 11931000
*              /*  THAT AVAILABLE, AND GET A LARGER WORK             */ 11932000
*              /*  AREA IF NEEDED.                                   */ 11933000
*              /*                                                    */ 11934000
*              /******************************************************/ 11935000
*                                                                  2394 11936000
*              IF SIZENEED > CURSIZE                               2394 11937000
*                THEN                                              2394 11938000
         CH    @00,CURSIZE                                         2394 11939000
         BNH   @RF02394                                            2394 11940000
*                  DO;                                             2395 11941000
*                                                                  2395 11942000
*                  /**************************************************/ 11943000
*                  /*                                                */ 11944000
*                  /*  IF WE HAVE GOTTEN CORE PREVIOUSLY,            */ 11945000
*                  /*  FREE IT PRIOR TO GETTING ANOTHER              */ 11946000
*                  /*  WORK AREA.                                    */ 11947000
*                  /*                                                */ 11948000
*                  /**************************************************/ 11949000
*                                                                  2396 11950000
*                  IF COREFLAG = ON                                2396 11951000
*                    THEN                                          2396 11952000
         TM    COREFLAG,B'10000000'                                2396 11953000
         BNO   @RF02396                                            2396 11954000
*                      CALL IDCSAFS0(GDTTBL,CTGWKA);               2397 11955000
         L     @15,@PC00001                                        2397 11956000
         ST    @15,@AL00001                                        2397 11957000
         LA    @04,CTGWKA(,@04)                                    2397 11958000
         ST    @04,@AL00001+4                                      2397 11959000
         L     @15,GDTFSP(,@15)                                    2397 11960000
         LA    @01,@AL00001                                        2397 11961000
         BALR  @14,@15                                             2397 11962000
*                    ELSE ;                                        2398 11963000
*                                                                  2398 11964000
@RF02396 DS    0H                                                  2399 11965000
*                  /**************************************************/ 11966000
*                  /*                                                */ 11967000
*                  /*  TURN THE COREFLAG ON AND ISSUE A              */ 11968000
*                  /*  UGPOOL TO OBTAIN CORE.                        */ 11969000
*                  /*                                                */ 11970000
*                  /*************************************************/  11971000
*                                                                  2399 11972000
*                  COREFLAG = ON;                                  2399 11973000
*                                                                  2399 11974000
         OI    COREFLAG,B'10000000'                                2399 11975000
*                  CALL IDCSAGP0(GDTTBL,SIZENEED,                  2400 11976000
*                    CTGWKA,GPID,SETZERO);                         2400 11977000
*                                                                  2400 11978000
         L     @04,@PC00001                                        2400 11979000
         ST    @04,@AL00001                                        2400 11980000
         LA    @15,SIZENEED                                        2400 11981000
         ST    @15,@AL00001+4                                      2400 11982000
         L     @01,CTGPLPTR                                        2400 11983000
         LA    @15,CTGWKA(,@01)                                    2400 11984000
         ST    @15,@AL00001+8                                      2400 11985000
         LA    @15,GPID                                            2400 11986000
         ST    @15,@AL00001+12                                     2400 11987000
         LA    @15,SETZERO                                         2400 11988000
         ST    @15,@AL00001+16                                     2400 11989000
         MVI   @AL00001+16,X'80'                                   2400 11990000
         L     @15,GDTGPL(,@04)                                    2400 11991000
         LA    @01,@AL00001                                        2400 11992000
         BALR  @14,@15                                             2400 11993000
*                  RESPECIFY RTNREG RSTD;                          2401 11994000
*                  TESTRC = RTNREG;                                2402 11995000
         STH   RTNREG,TESTRC                                       2402 11996000
*                  RESPECIFY RTNREG UNRSTD;                        2403 11997000
*                  IF TESTRC ^= 0                                  2404 11998000
*                    THEN                                          2404 11999000
         LH    @04,TESTRC                                          2404 12000000
         LTR   @04,@04                                             2404 12001000
         BZ    @RF02404                                            2404 12002000
*                      DO;                                         2405 12003000
*                      DARGSMOD = UNIVMSG;                         2406 12004000
         L     @04,DDSTRU                                          2406 12005000
         MVC   DARGSMOD(3,@04),@CC00981                            2406 12006000
*                      DEFSTID = NOSTORAG;                         2407 12007000
         MVI   DEFSTID,X'04'                                       2407 12008000
*                      RETURN CODE(LASTCC12);                      2408 12009000
         LA    @15,12                                              2408 12010000
         L     @14,@SA00014                                        2408 12011000
         LM    @00,@12,@SA00014+8                                  2408 12012000
         BR    @14                                                 2408 12013000
*                      END;                                        2409 12014000
*                                                                  2409 12015000
*                  /**************************************************/ 12016000
*                  /*                                                */ 12017000
*                  /*  COMPUTE A NEW VALUE FOR LIMIT, AND            */ 12018000
*                  /*  SET CURSIZE AND AREALN TO THE                 */ 12019000
*                  /*  PROPER VALUES.                                */ 12020000
*                  /*                                                */ 12021000
*                  /**************************************************/ 12022000
*                                                                  2410 12023000
*                  LIMIT = (SIZENEED - 4) /                        2410 12024000
*                     LENGTH(ENTITEM);                             2410 12025000
@RF02404 L     @04,SIZENEED                                        2410 12026000
         LR    @00,@04                                             2410 12027000
         SL    @00,@CF00046                                        2410 12028000
         SRDA  @00,32                                              2410 12029000
         D     @00,@CF01390                                        2410 12030000
         STH   @01,LIMIT                                           2410 12031000
*                  CURSIZE = SIZENEED;                             2411 12032000
         STH   @04,CURSIZE                                         2411 12033000
*                  AREALN = SIZENEED;                              2412 12034000
         L     @01,CTGPLPTR                                        2412 12035000
         L     @01,CTGWKA(,@01)                                    2412 12036000
         STH   @04,AREALN(,@01)                                    2412 12037000
*                  END;                                            2413 12038000
*                                                                  2413 12039000
*                ELSE                                              2414 12040000
*                                                                  2414 12041000
*                  /**************************************************/ 12042000
*                  /*                                                */ 12043000
*                  /*  ZERO AND REUSE THE PRESENT CATALOG            */ 12044000
*                  /*  WORK AREA.  IT IS ALREADY LARGE               */ 12045000
*                  /*  ENOUGH.                                       */ 12046000
*                  /*                                                */ 12047000
*                  /**************************************************/ 12048000
*                                                                  2414 12049000
*                  DO;                                             2414 12050000
         B     @RC02394                                            2414 12051000
@RF02394 DS    0H                                                  2415 12052000
*                  RETURNLN = 0;                                   2415 12053000
         L     @04,CTGPLPTR                                        2415 12054000
         L     @04,CTGWKA(,@04)                                    2415 12055000
         SLR   @15,@15                                             2415 12056000
         STH   @15,RETURNLN(,@04)                                  2415 12057000
*                  DO J = 1 TO LIMIT;                              2416 12058000
         LA    @04,1                                               2416 12059000
         B     @DE02416                                            2416 12060000
@DL02416 DS    0H                                                  2417 12061000
*                    ENTLIST(J) = ''B;                             2417 12062000
         LR    @15,@04                                             2417 12063000
         MH    @15,@CH01390                                        2417 12064000
         L     @01,CTGPLPTR                                        2417 12065000
         L     @01,CTGWKA(,@01)                                    2417 12066000
         ALR   @01,@15                                             2417 12067000
         AL    @01,@CF01798                                        2417 12068000
         XC    ENTLIST-4(45,@01),ENTLIST-4(@01)                    2417 12069000
*                  END;                                            2418 12070000
         AL    @04,@CF00221                                        2418 12071000
@DE02416 ST    @04,J                                               2418 12072000
         CH    @04,LIMIT                                           2418 12073000
         BNH   @DL02416                                            2418 12074000
*                  END;                                            2419 12075000
*                                                                  2419 12076000
*              END MORESP;                                         2420 12077000
*                                                                  2420 12078000
*            ELSE                                                  2421 12079000
*                                                                  2421 12080000
*              /******************************************************/ 12081000
*              /*                                                    */ 12082000
*              /*  TEST FOR VSAM CATALOG RETURN CODES OF 72          */ 12083000
*              /*  AND 240.  THESE INDICATE THAT SOMETHING           */ 12084000
*              /*  MUST BE DYNAMICALLY ALLOCATED.                    */ 12085000
*              /*                                                    */ 12086000
*              /******************************************************/ 12087000
*                                                                  2421 12088000
*              IF (CATLGRC = ALLORC1) | (CATLGRC = ALLORC2)        2421 12089000
*                 | (CATLGRC = ALLORC3)                            2421 12090000
*                THEN                                              2421 12091000
*                                                                  2421 12092000
         B     @RC02391                                            2421 12093000
@RF02391 LH    @04,CATLGRC                                         2421 12094000
         C     @04,@CF01129                                        2421 12095000
         BE    @RT02421                                            2421 12096000
         C     @04,@CF01137                                        2421 12097000
         BE    @RT02421                                            2421 12098000
         C     @04,@CF01131                                        2421 12099000
         BNE   @RF02421                                            2421 12100000
@RT02421 DS    0H                                                  2422 12101000
*ALLOCRC:          DO;                                             2422 12102000
*                                                                  2422 12103000
ALLOCRC  DS    0H                                                  2423 12104000
*                  /**************************************************/ 12105000
*                  /*                                                */ 12106000
*                  /*  IF DEALLOC IS ON, SOMETHING HAS BEEN          */ 12107000
*                  /*  DYNAMICALLY ALLOCATED.  DYNAMICALLY           */ 12108000
*                  /*  UNALLOCATE THE OBJECT SO THAT THE             */ 12109000
*                  /*  SAME STORAGE CAN BE USED FOR THE              */ 12110000
*                  /*  ALLAGL OF THE NEXT THING TO BE                */ 12111000
*                  /*  ALLOCATED.                                    */ 12112000
*                  /*                                                */ 12113000
*                  /**************************************************/ 12114000
*                                                                  2423 12115000
*                  IF DEALLOC = ON                                 2423 12116000
*                    THEN                                          2423 12117000
*                                                                  2423 12118000
         TM    DEALLOC,B'10000000'                                 2423 12119000
         BNO   @RF02423                                            2423 12120000
*                      DO;                                         2424 12121000
*                      DEALLOC = OFF;                              2425 12122000
*                                                                  2425 12123000
         NI    DEALLOC,B'01111111'                                 2425 12124000
*                      CALL IDCSADL0(GDTTBL,ALLAGL);               2426 12125000
         L     @04,@PC00001                                        2426 12126000
         ST    @04,@AL00001                                        2426 12127000
         L     @01,ALLPTR                                          2426 12128000
         ST    @01,@AL00001+4                                      2426 12129000
         MVI   @AL00001+4,X'80'                                    2426 12130000
         L     @15,GDTDLC(,@04)                                    2426 12131000
         LA    @01,@AL00001                                        2426 12132000
         BALR  @14,@15                                             2426 12133000
*                      RESPECIFY RTNREG RSTD;                      2427 12134000
*                      TESTRC = RTNREG;                            2428 12135000
         STH   RTNREG,TESTRC                                       2428 12136000
*                      RESPECIFY RTNREG UNRSTD;                    2429 12137000
*                      IF TESTRC ^= 0                              2430 12138000
*                        THEN                                      2430 12139000
         LH    @04,TESTRC                                          2430 12140000
         LTR   @04,@04                                             2430 12141000
         BZ    @RF02430                                            2430 12142000
*                          SETRC = LASTCC08;                       2431 12143000
         MVC   SETRC(2),@CH00039                                   2431 12144000
*                      END;                                        2432 12145000
*                                                                  2432 12146000
@RF02430 DS    0H                                                  2433 12147000
*                  /**************************************************/ 12148000
*                  /*                                                */ 12149000
*                  /*  SET DEALLOC TO INDICATE THAT AN               */ 12150000
*                  /*  ATTEMPT HAS BEEN MADE TO DYNAMICALLY          */ 12151000
*                  /*  ALLOCATE SOMETHING.                           */ 12152000
*                  /*                                                */ 12153000
*                  /**************************************************/ 12154000
*                                                                  2433 12155000
*                  DEALLOC = ON;                                   2433 12156000
*                                                                  2433 12157000
@RF02423 OI    DEALLOC,B'10000000'                                 2433 12158000
*                  /**************************************************/ 12159000
*                  /*                                                */ 12160000
*                  /*  POINT TO THE STORAGE FOR THE ALLAGL,          */ 12161000
*                  /*  AND CLEAR IT TO ZEROS.                        */ 12162000
*                  /*                                                */ 12163000
*                  /**************************************************/ 12164000
*                                                                  2434 12165000
*                  ALLPTR = ADDR(ALLLIST);                         2434 12166000
         LA    @04,ALLLIST                                         2434 12167000
         ST    @04,ALLPTR                                          2434 12168000
*                  ALLAGL = ''B;                                   2435 12169000
*                                                                  2435 12170000
         XC    ALLAGL(31,@04),ALLAGL(@04)                          2435 12171000
*                  /**************************************************/ 12172000
*                  /*                                                */ 12173000
*                  /*  IF THE VSAM CATALOG RETURN CODE IS 72 OR 76,  */ 12174000
*                  /*  THEN THE THING TO BE DYNAMICALLY              */ 12175000
*                  /*  ALLOCATED IS THE LAST ITEM IN THE             */ 12176000
*                  /*  CMS WORK AREA.  IF IT IS 240, THEN            */ 12177000
*                  /*  THE ADDRESS OF THE THING TO ALLOCATE          */ 12178000
*                  /*  IS IN CTGENT.                                 */ 12179000
*                  /*                                                */ 12180000
*                  /**************************************************/ 12181000
*                                                                  2436 12182000
*                  IF (CATLGRC = ALLORC1) | (CATLGRC = ALLORC3)    2436 12183000
*                    THEN                                          2436 12184000
         LH    @04,CATLGRC                                         2436 12185000
         C     @04,@CF01129                                        2436 12186000
         BE    @RT02436                                            2436 12187000
         C     @04,@CF01131                                        2436 12188000
         BNE   @RF02436                                            2436 12189000
@RT02436 DS    0H                                                  2437 12190000
*                      ALLDSN = ADDR(ENTRYNM(PLIMIT + 1));         2437 12191000
         LH    @04,PLIMIT                                          2437 12192000
         MH    @04,@CH01390                                        2437 12193000
         L     @01,CTGPLPTR                                        2437 12194000
         L     @01,CTGWKA(,@01)                                    2437 12195000
         LA    @04,ENTRYNM(@04,@01)                                2437 12196000
         L     @01,ALLPTR                                          2437 12197000
         ST    @04,ALLDSN(,@01)                                    2437 12198000
*                    ELSE                                          2438 12199000
*                      ALLDSN = CTGENT;                            2438 12200000
*                                                                  2438 12201000
         B     @RC02436                                            2438 12202000
@RF02436 L     @04,CTGPLPTR                                        2438 12203000
         L     @04,CTGENT(,@04)                                    2438 12204000
         L     @01,ALLPTR                                          2438 12205000
         ST    @04,ALLDSN(,@01)                                    2438 12206000
*                  /**************************************************/ 12207000
*                  /*                                                */ 12208000
*                  /*  SELECT DYNAMIC ALLOCATION OPTIONS             */ 12209000
*                  /*  (1) DYNAMIC ALLOCATION BY DATA SET            */ 12210000
*                  /*      NAME                                      */ 12211000
*                  /*  (2) STATUS = OLD                              */ 12212000
*                  /*  (3) DISP = KEEP                               */ 12213000
*                  /*                                                */ 12214000
*                  /**************************************************/ 12215000
*                                                                  2439 12216000
*                  ALLOPTVL = OFF;                                 2439 12217000
@RC02436 DS    0H                                                  2440 12218000
*                  ALLOPTDS = ON;                                  2440 12219000
         L     @04,ALLPTR                                          2440 12220000
         OI    ALLOPTDS(@04),B'01000000'                           2440 12221000
         NI    ALLOPTVL(@04),B'01111111'                           2440 12222000
*                  ALLSTSOD = ON;                                  2441 12223000
         OI    ALLSTSOD(@04),B'00000001'                           2441 12224000
*                  ALLDSPKP = ON;                                  2442 12225000
*                                                                  2442 12226000
         OI    ALLDSPKP(@04),B'00001000'                           2442 12227000
*                  /**************************************************/ 12228000
*                  /*                                                */ 12229000
*                  /*  ISSUE THE UALLOC MACRO OF THE SYSTEM          */ 12230000
*                  /*  ADAPTER, AND TEST THE RETURN CODE.            */ 12231000
*                  /*                                                */ 12232000
*                  /**************************************************/ 12233000
*                                                                  2443 12234000
*                  CALL IDCSAAL0(GDTTBL,ALLAGL);                   2443 12235000
         L     @15,@PC00001                                        2443 12236000
         ST    @15,@AL00001                                        2443 12237000
         ST    @04,@AL00001+4                                      2443 12238000
         MVI   @AL00001+4,X'80'                                    2443 12239000
         L     @15,GDTALC(,@15)                                    2443 12240000
         LA    @01,@AL00001                                        2443 12241000
         BALR  @14,@15                                             2443 12242000
*                  RESPECIFY RTNREG RSTD;                          2444 12243000
*                  TESTRC = RTNREG;                                2445 12244000
         STH   RTNREG,TESTRC                                       2445 12245000
*                  RESPECIFY RTNREG UNRSTD;                        2446 12246000
*                                                                  2446 12247000
*                  IF TESTRC = 0                                   2447 12248000
*                    THEN                                          2447 12249000
*                                                                  2447 12250000
         LH    @04,TESTRC                                          2447 12251000
         LTR   @04,@04                                             2447 12252000
         BNZ   @RF02447                                            2447 12253000
*                      /**********************************************/ 12254000
*                      /*                                            */ 12255000
*                      /*  THE OBJECT HAS BEEN ALLOCATED             */ 12256000
*                      /*  SUCCESSFULLY.  RESTORE THE CPL,           */ 12257000
*                      /*  AND PLACE A POINTER TO THE                */ 12258000
*                      /*  DDNAME RETURNED BY ALLOCATION IN          */ 12259000
*                      /*  THE CPL.                                  */ 12260000
*                      /*                                            */ 12261000
*                      /**********************************************/ 12262000
*                                                                  2448 12263000
*                      DO;                                         2448 12264000
*                      CTGPL = DSAVCPL;                            2449 12265000
         L     @04,CTGPLPTR                                        2449 12266000
         MVC   CTGPL(28,@04),DSAVCPL                               2449 12267000
*                      CTGDDNM = ADDR(ALLDDN);                     2450 12268000
*                                                                  2450 12269000
         L     @01,ALLPTR                                          2450 12270000
         LA    @15,ALLDDN(,@01)                                    2450 12271000
         ST    @15,CTGDDNM(,@04)                                   2450 12272000
*                      /**********************************************/ 12273000
*                      /*                                            */ 12274000
*                      /*  CLEAR THE CMS WORKAREA.                   */ 12275000
*                      /*                                            */ 12276000
*                      /**********************************************/ 12277000
*                                                                  2451 12278000
*                      DO J = 1 TO LIMIT;                          2451 12279000
         LA    @04,1                                               2451 12280000
         B     @DE02451                                            2451 12281000
@DL02451 DS    0H                                                  2452 12282000
*                        ENTITEM(J) = ''B;                         2452 12283000
         LR    @15,@04                                             2452 12284000
         MH    @15,@CH01390                                        2452 12285000
         L     @01,CTGPLPTR                                        2452 12286000
         L     @01,CTGWKA(,@01)                                    2452 12287000
         ALR   @01,@15                                             2452 12288000
         AL    @01,@CF01798                                        2452 12289000
         XC    ENTITEM-4(45,@01),ENTITEM-4(@01)                    2452 12290000
*                      END;                                        2453 12291000
         AL    @04,@CF00221                                        2453 12292000
@DE02451 ST    @04,J                                               2453 12293000
         CH    @04,LIMIT                                           2453 12294000
         BNH   @DL02451                                            2453 12295000
*                      RETURNLN = 0;                               2454 12296000
         L     @04,CTGPLPTR                                        2454 12297000
         L     @04,CTGWKA(,@04)                                    2454 12298000
         SLR   @15,@15                                             2454 12299000
         STH   @15,RETURNLN(,@04)                                  2454 12300000
*                      END;                                        2455 12301000
*                                                                  2455 12302000
*                    ELSE                                          2456 12303000
*                                                                  2456 12304000
*                      /**********************************************/ 12305000
*                      /*                                            */ 12306000
*                      /*  DYNAMIC ALLOCATION HAS FAILED.            */ 12307000
*                      /*  PRINT AN ERROR MESSAGE, AND               */ 12308000
*                      /*  RETURN TO THE CALLING PROCESSOR.          */ 12309000
*                      /*                                            */ 12310000
*                      /**********************************************/ 12311000
*                                                                  2456 12312000
*                      DO;                                         2456 12313000
         B     @RC02447                                            2456 12314000
@RF02447 DS    0H                                                  2457 12315000
*                      DEFSTID = 0;                                2457 12316000
         MVI   DEFSTID,X'00'                                       2457 12317000
*                      DARGSMOD = DELMSG;                          2458 12318000
         L     @04,DDSTRU                                          2458 12319000
         MVC   DARGSMOD(3,@04),@CC00989                            2458 12320000
*                      DARGILP = LENGTH(FENTNAME);                 2459 12321000
         MVC   DARGILP(2,@04),@CH00605                             2459 12322000
*                      DARGSENT = NODELMSG;                        2460 12323000
         MVI   DARGSENT(@04),X'08'                                 2460 12324000
*                      DARGDBP = CTGENT;                           2461 12325000
*                                                                  2461 12326000
         L     @01,CTGPLPTR                                        2461 12327000
         L     @15,CTGENT(,@01)                                    2461 12328000
         ST    @15,DARGDBP(,@04)                                   2461 12329000
*                      CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       2462 12330000
*                                                                  2462 12331000
         L     @04,@PC00001                                        2462 12332000
         ST    @04,@AL00001                                        2462 12333000
         LA    @15,@CF00119                                        2462 12334000
         ST    @15,@AL00001+4                                      2462 12335000
         LA    @15,DDSTRU                                          2462 12336000
         ST    @15,@AL00001+8                                      2462 12337000
         MVI   @AL00001+8,X'80'                                    2462 12338000
         L     @15,GDTPRT(,@04)                                    2462 12339000
         LA    @01,@AL00001                                        2462 12340000
         BALR  @14,@15                                             2462 12341000
*                      DARGSMOD = UNIVMSG;                         2463 12342000
         L     @04,DDSTRU                                          2463 12343000
         MVC   DARGSMOD(3,@04),@CC00981                            2463 12344000
*                      RETURN CODE(LASTCC12);                      2464 12345000
         LA    @15,12                                              2464 12346000
         L     @14,@SA00014                                        2464 12347000
         LM    @00,@12,@SA00014+8                                  2464 12348000
         BR    @14                                                 2464 12349000
*                      END;                                        2465 12350000
*                                                                  2465 12351000
*                  END ALLOCRC;                                    2466 12352000
*                                                                  2466 12353000
@RC02447 DS    0H                                                  2467 12354000
*            /********************************************************/ 12355000
*            /*                                                      */ 12356000
*            /*  CALL CATALOG AND SAVE THE RETURN CODE.              */ 12357000
*            /*                                                      */ 12358000
*            /********************************************************/ 12359000
*                                                                  2467 12360000
*            CALL IDCSACA0(GDTTBL,DLCPLPTR);                       2467 12361000
*                                                                  2467 12362000
@RF02421 DS    0H                                                  2467 12363000
@RC02391 L     @04,@PC00001                                        2467 12364000
         ST    @04,@AL00001                                        2467 12365000
         L     @15,@PC00014                                        2467 12366000
         ST    @15,@AL00001+4                                      2467 12367000
         L     @15,GDTCAT(,@04)                                    2467 12368000
         LA    @01,@AL00001                                        2467 12369000
         BALR  @14,@15                                             2467 12370000
*            RESPECIFY REG15 RSTD;                                 2468 12371000
*            CATLGRC = REG15;                                      2469 12372000
         STH   REG15,CATLGRC                                       2469 12373000
*            RESPECIFY REG15 UNRSTD;                               2470 12374000
*                                                                  2470 12375000
*            IF GDTDBG = NULLPTR                                   2471 12376000
*              THEN;                                               2471 12377000
         L     @04,@PC00001                                        2471 12378000
         L     @04,GDTDBG(,@04)                                    2471 12379000
         LTR   @04,@04                                             2471 12380000
         BZ    @RT02471                                            2471 12381000
*              ELSE                                                2473 12382000
*                CALL IDCDB010(GDTTBL,'RMDD');                     2473 12383000
*                                                                  2473 12384000
         L     @04,@PC00001                                        2473 12385000
         ST    @04,@AL00001                                        2473 12386000
         LA    @15,@CC01586                                        2473 12387000
         ST    @15,@AL00001+4                                      2473 12388000
         MVI   @AL00001+4,X'80'                                    2473 12389000
         L     @15,GDTDBG(,@04)                                    2473 12390000
         LA    @01,@AL00001                                        2473 12391000
         BALR  @14,@15                                             2473 12392000
*        END DELLP;                                                2474 12393000
*                                                                  2474 12394000
@RT02471 DS    0H                                                  2474 12395000
@DE02379 LH    @04,CATLGRC                                         2474 12396000
         C     @04,@CF01127                                        2474 12397000
         BE    @DL02379                                            2474 12398000
         C     @04,@CF01129                                        2474 12399000
         BE    @DL02379                                            2474 12400000
         C     @04,@CF01137                                        2474 12401000
         BE    @DL02379                                            2474 12402000
         C     @04,@CF01131                                        2474 12403000
         BE    @DL02379                                            2474 12404000
*        /************************************************************/ 12405000
*        /*                                                          */ 12406000
*        /*  IF VSAM CATALOG MANAGEMENT HAS PLACED ANYTHING          */ 12407000
*        /*  IN THE WORKAREA PASSED TO IT FOR THE CATALOG            */ 12408000
*        /*  DELETE, PRINT IT OUT.                                   */ 12409000
*        /*                                                          */ 12410000
*        /************************************************************/ 12411000
*                                                                  2475 12412000
*        IF RETURNLN > 4                                           2475 12413000
*          THEN                                                    2475 12414000
         LA    @04,4                                               2475 12415000
         L     @01,CTGPLPTR                                        2475 12416000
         L     @01,CTGWKA(,@01)                                    2475 12417000
         LH    @15,RETURNLN(,@01)                                  2475 12418000
         CR    @15,@04                                             2475 12419000
         BNH   @RF02475                                            2475 12420000
*            DO;                                                   2476 12421000
*            ENTRYNO = (RETURNLN - 4) / LENGTH(ENTITEM);           2477 12422000
         LR    @00,@15                                             2477 12423000
         SLR   @00,@04                                             2477 12424000
         SRDA  @00,32                                              2477 12425000
         D     @00,@CF01390                                        2477 12426000
         ST    @01,ENTRYNO                                         2477 12427000
*            DO K = 1 TO ENTRYNO;                                  2478 12428000
         LA    @04,1                                               2478 12429000
         B     @DE02478                                            2478 12430000
@DL02478 DS    0H                                                  2479 12431000
*              DARGDBP = ADDR(ENTLIST(K));                         2479 12432000
         L     @15,DDSTRU                                          2479 12433000
         LA    @14,45                                              2479 12434000
         LR    @01,@04                                             2479 12435000
         MR    @00,@14                                             2479 12436000
         L     @04,CTGPLPTR                                        2479 12437000
         L     @04,CTGWKA(,@04)                                    2479 12438000
         AL    @04,@CF01798                                        2479 12439000
         LA    @04,ENTLIST-4(@01,@04)                              2479 12440000
         ST    @04,DARGDBP(,@15)                                   2479 12441000
*              DARGILP = LENGTH(ENTLIST(1));                       2480 12442000
*                                                                  2480 12443000
         STH   @14,DARGILP(,@15)                                   2480 12444000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);               2481 12445000
         L     @04,@PC00001                                        2481 12446000
         ST    @04,@AL00001                                        2481 12447000
         LA    @15,@CF00119                                        2481 12448000
         ST    @15,@AL00001+4                                      2481 12449000
         LA    @15,DDSTRU                                          2481 12450000
         ST    @15,@AL00001+8                                      2481 12451000
         MVI   @AL00001+8,X'80'                                    2481 12452000
         L     @15,GDTPRT(,@04)                                    2481 12453000
         LA    @01,@AL00001                                        2481 12454000
         BALR  @14,@15                                             2481 12455000
*            END;                                                  2482 12456000
*                                                                  2482 12457000
         LA    @04,1                                               2482 12458000
         AL    @04,K                                               2482 12459000
@DE02478 ST    @04,K                                               2482 12460000
         C     @04,ENTRYNO                                         2482 12461000
         BNH   @DL02478                                            2482 12462000
*            END;                                                  2483 12463000
*          ELSE ;                                                  2484 12464000
*                                                                  2484 12465000
@RF02475 DS    0H                                                  2485 12466000
*        /************************************************************/ 12467000
*        /*                                                  @Z40RSSA*/ 12468000
*        /*  IF THE VSAM CATALOG RETURN CODE IS 110          @Z40RSSA*/ 12469000
*        /*  PRINT THE REASON THE PROFILE COULD NOT BE       @Z40RSSA*/ 12470000
*        /*  DELETED.                                        @Z40RSSA*/ 12471000
*        /*         REASON CODE 4 - NO PROFILE               @Z40RSSA*/ 12472000
*        /*         REASON CODE 8 - NOT ELIGIBLE             @Z40RSSA*/ 12473000
*        /*                                                  @Z40RSSA*/ 12474000
*        /*  IF NOT 110, SIMPLY PRINT THE VSAM RETURN CODE   @Z40RSSA*/ 12475000
*        /*                                                  @Z40RSSA*/ 12476000
*        /************************************************************/ 12477000
*               IF CATLGRC = PRNTDEL & (CTGFBFLG = NFRET |         2485 12478000
*                CTGFBFLG = NDRET) THEN                            2485 12479000
         CLC   CATLGRC(2),@CH01133                                 2485 12480000
         BNE   @RF02485                                            2485 12481000
         L     @04,CTGPLPTR                                        2485 12482000
         CLC   CTGFBFLG(2,@04),@CH00046                            2485 12483000
         BE    @RT02485                                            2485 12484000
         CLC   CTGFBFLG(2,@04),@CH00039                            2485 12485000
         BNE   @RF02485                                            2485 12486000
@RT02485 DS    0H                                                  2486 12487000
*                 DO;                                      /*@Z40RSSA*/ 12488000
*                   DARGLIST = ''B;                        /*@Z40RSSA*/ 12489000
         L     @04,DDSTRU                                          2487 12490000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      2487 12491000
*                   DARGSMOD = DELMSG;                     /*@Z40RSSA*/ 12492000
         MVC   DARGSMOD(3,@04),@CC00989                            2488 12493000
*                   IF CTGFBFLG = 4 THEN                   /*@Z40RSSA*/ 12494000
         L     @01,CTGPLPTR                                        2489 12495000
         CLC   CTGFBFLG(2,@01),@CH00046                            2489 12496000
         BNE   @RF02489                                            2489 12497000
*                     DARGSENT = PFNTFND;                  /*@Z40RSSA*/ 12498000
         MVI   DARGSENT(@04),X'0D'                                 2490 12499000
*                   ELSE                                   /*@Z40RSSA*/ 12500000
*                     DARGSENT = PFINUSE;                  /*@Z40RSSA*/ 12501000
         B     @RC02489                                            2491 12502000
@RF02489 L     @04,DDSTRU                                          2491 12503000
         MVI   DARGSENT(@04),X'0C'                                 2491 12504000
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);  /*@Z40RSSA*/ 12505000
@RC02489 L     @04,@PC00001                                        2492 12506000
         ST    @04,@AL00001                                        2492 12507000
         LA    @15,@CF00119                                        2492 12508000
         ST    @15,@AL00001+4                                      2492 12509000
         LA    @15,DDSTRU                                          2492 12510000
         ST    @15,@AL00001+8                                      2492 12511000
         MVI   @AL00001+8,X'80'                                    2492 12512000
         L     @15,GDTPRT(,@04)                                    2492 12513000
         LA    @01,@AL00001                                        2492 12514000
         BALR  @14,@15                                             2492 12515000
*                   SETRC = LASTCC04;                      /*@Z40RSSA*/ 12516000
         MVC   SETRC(2),@CH00046                                   2493 12517000
*                 END;                                     /*@Z40RSSA*/ 12518000
*               ELSE                                       /*@Z40RSSA*/ 12519000
*        /************************************************************/ 12520000
*        /*                                                  @Z40RSSA*/ 12521000
*        /*  TEST FOR A VSAM CATALOG RETURN CODE OTHER THAN          */ 12522000
*        /*  ZERO.  IF CATALOG MANAGEMENT HAS SET A NON-ZERO         */ 12523000
*        /*  RETURN CODE, PRINT AN APPROPRIATE MESSAGE.              */ 12524000
*        /*                                                          */ 12525000
*        /************************************************************/ 12526000
*                                                                  2495 12527000
*        IF CATLGRC ^= 0                                           2495 12528000
*          THEN                                                    2495 12529000
         B     @RC02485                                            2495 12530000
@RF02485 LH    @04,CATLGRC                                         2495 12531000
         LTR   @04,@04                                             2495 12532000
         BZ    @RF02495                                            2495 12533000
*ERCALL2:    DO;                                                   2496 12534000
*                                                                  2496 12535000
ERCALL2  DS    0H                                                  2497 12536000
*            /********************************************************/ 12537000
*            /*                                                      */ 12538000
*            /*  CLEAR THE STORAGE TO BE OCCUPIED BY THE ERROR       */ 12539000
*            /*  CONVERSION TABLE.                                   */ 12540000
*            /*                                                      */ 12541000
*            /********************************************************/ 12542000
*                                                                  2497 12543000
*            ERRORTAB = ''B;                                       2497 12544000
*                                                                  2497 12545000
         XC    ERRORTAB(32),ERRORTAB                               2497 12546000
*            /********************************************************/ 12547000
*            /*                                                      */ 12548000
*            /*  SET ERCNVADR TO POINT TO THE STORAGE FOR THE ERROR  */ 12549000
*            /*  CONVERSION TABLE.                                   */ 12550000
*            /*                                                      */ 12551000
*            /********************************************************/ 12552000
*                                                                  2498 12553000
*            ERCNVADR = ADDR(ERRORTAB);                            2498 12554000
*                                                                  2498 12555000
         LA    @04,ERRORTAB                                        2498 12556000
         ST    @04,ERCNVADR                                        2498 12557000
*            /********************************************************/ 12558000
*            /*                                                      */ 12559000
*            /*  SET ERCATLG TO BE ON TO INDICATE THAT THIS IS A     */ 12560000
*            /*  CATALOG ERROR.  THE CMS FUNCTION BEING PERFORMED    */ 12561000
*            /*  IS A DELETE.  SET THE ERCATDL BIT TO ON.            */ 12562000
*            /*                                                      */ 12563000
*            /********************************************************/ 12564000
*                                                                  2499 12565000
*            ERCATLG = ON;                                         2499 12566000
         OI    ERCATLG(@04),B'10000000'                            2499 12567000
*            ERCATDL = ON;                                         2500 12568000
*                                                                  2500 12569000
         OI    ERCATDL(@04),B'00100000'                            2500 12570000
*            /********************************************************/ 12571000
*            /*                                                      */ 12572000
*            /*  SET ERCATRC TO CATLGRC, AND SET ERPLPT TO POINT TO  */ 12573000
*            /*  THE CPL FOR THE CATALOG OPERATION.                  */ 12574000
*            /*                                                      */ 12575000
*            /********************************************************/ 12576000
*                                                                  2501 12577000
*            ERCATRC = CATLGRC;                                    2501 12578000
         LH    @15,CATLGRC                                         2501 12579000
         ST    @15,ERCATRC(,@04)                                   2501 12580000
*            ERCPLPT = CTGPLPTR;                                   2502 12581000
*                                                                  2502 12582000
         L     @15,CTGPLPTR                                        2502 12583000
         ST    @15,ERCPLPT(,@04)                                   2502 12584000
*            /********************************************************/ 12585000
*            /*                                                      */ 12586000
*            /*  SET A POINTER IN THE ERROR CONVERSION TABLE         */ 12587000
*            /*  TO THE ENTRY NAME.                                  */ 12588000
*            /*                                                      */ 12589000
*            /********************************************************/ 12590000
*                                                                  2503 12591000
*            ERDSNM = CTGENT;                                      2503 12592000
*                                                                  2503 12593000
         L     @15,CTGENT(,@15)                                    2503 12594000
         ST    @15,ERDSNM(,@04)                                    2503 12595000
*            /********************************************************/ 12596000
*            /*                                                      */ 12597000
*            /*  INVOKE THE UERROR ROUTINE BY ISSUING THE UERROR     */ 12598000
*            /*  MACRO OF THE TEXT PROCESSOR.                        */ 12599000
*            /*                                                      */ 12600000
*            /********************************************************/ 12601000
*                                                                  2504 12602000
*            CALL IDCTPER0(GDTTBL,ERCNVADR);                       2504 12603000
         L     @04,@PC00001                                        2504 12604000
         ST    @04,@AL00001                                        2504 12605000
         LA    @15,ERCNVADR                                        2504 12606000
         ST    @15,@AL00001+4                                      2504 12607000
         MVI   @AL00001+4,X'80'                                    2504 12608000
         L     @15,GDTERR(,@04)                                    2504 12609000
         LA    @01,@AL00001                                        2504 12610000
         BALR  @14,@15                                             2504 12611000
*            RETURN CODE(LASTCC12);                                2505 12612000
         LA    @15,12                                              2505 12613000
         L     @14,@SA00014                                        2505 12614000
         LM    @00,@12,@SA00014+8                                  2505 12615000
         BR    @14                                                 2505 12616000
*            END ERCALL2;                                          2506 12617000
*                                                                  2506 12618000
*        /************************************************************/ 12619000
*        /*                                                          */ 12620000
*        /*  IF CORE WAS OBTAINED BY THIS PROCEDURE, FREE            */ 12621000
*        /*  IT.                                                     */ 12622000
*        /*                                                          */ 12623000
*        /************************************************************/ 12624000
*                                                                  2507 12625000
*        IF COREFLAG = ON                                          2507 12626000
*          THEN                                                    2507 12627000
*                                                                  2507 12628000
@RF02495 DS    0H                                                  2507 12629000
@RC02485 TM    COREFLAG,B'10000000'                                2507 12630000
         BNO   @RF02507                                            2507 12631000
*            DO;                                                   2508 12632000
*            COREFLAG = OFF;                                       2509 12633000
         NI    COREFLAG,B'01111111'                                2509 12634000
*            CALL IDCSAFS0(GDTTBL,CTGWKA);                         2510 12635000
         L     @04,@PC00001                                        2510 12636000
         ST    @04,@AL00001                                        2510 12637000
         L     @01,CTGPLPTR                                        2510 12638000
         LA    @15,CTGWKA(,@01)                                    2510 12639000
         ST    @15,@AL00001+4                                      2510 12640000
         L     @15,GDTFSP(,@04)                                    2510 12641000
         LA    @01,@AL00001                                        2510 12642000
         BALR  @14,@15                                             2510 12643000
*            END;                                                  2511 12644000
*                                                                  2511 12645000
*        /************************************************************/ 12646000
*        /*                                                          */ 12647000
*        /*  IF DYNAMIC ALLOCATION HAS BEEN PERFORMED BY             */ 12648000
*        /*  THIS PROCEDURE, DYNAMICALLY UNALLOCATE.                 */ 12649000
*        /*                                                          */ 12650000
*        /************************************************************/ 12651000
*                                                                  2512 12652000
*        IF DEALLOC = ON                                           2512 12653000
*          THEN                                                    2512 12654000
@RF02507 TM    DEALLOC,B'10000000'                                 2512 12655000
         BNO   @RF02512                                            2512 12656000
*            DO;                                                   2513 12657000
*            DEALLOC = OFF;                                        2514 12658000
         NI    DEALLOC,B'01111111'                                 2514 12659000
*            CALL IDCSADL0(GDTTBL,ALLAGL);                         2515 12660000
         L     @04,@PC00001                                        2515 12661000
         ST    @04,@AL00001                                        2515 12662000
         L     @01,ALLPTR                                          2515 12663000
         ST    @01,@AL00001+4                                      2515 12664000
         MVI   @AL00001+4,X'80'                                    2515 12665000
         L     @15,GDTDLC(,@04)                                    2515 12666000
         LA    @01,@AL00001                                        2515 12667000
         BALR  @14,@15                                             2515 12668000
*            RESPECIFY RTNREG RSTD;                                2516 12669000
*            TESTRC = RTNREG;                                      2517 12670000
         STH   RTNREG,TESTRC                                       2517 12671000
*            RESPECIFY RTNREG UNRSTD;                              2518 12672000
*            IF TESTRC ^= 0                                        2519 12673000
*              THEN                                                2519 12674000
         LH    @04,TESTRC                                          2519 12675000
         LTR   @04,@04                                             2519 12676000
         BZ    @RF02519                                            2519 12677000
*                SETRC = LASTCC08;                                 2520 12678000
         MVC   SETRC(2),@CH00039                                   2520 12679000
*            END;                                                  2521 12680000
*                                                                  2521 12681000
@RF02519 DS    0H                                                  2522 12682000
*        /************************************************************/ 12683000
*        /*                                                          */ 12684000
*        /*  RETURN TO THE CALLER WITH SUCCESS INDICATED.            */ 12685000
*        /*                                                          */ 12686000
*        /************************************************************/ 12687000
*                                                                  2522 12688000
*        RETURN CODE(0);                                           2522 12689000
*                                                                  2522 12690000
@RF02512 SLR   @15,@15                                             2522 12691000
         L     @14,@SA00014                                        2522 12692000
         LM    @00,@12,@SA00014+8                                  2522 12693000
         BR    @14                                                 2522 12694000
*END DELTPROC;                                                     2523 12695000
*/********************************************************************/ 12696000
*/*                                                                  */ 12697000
*/* PROCEDURE NAME - DALCPROC (SERVICE ROUTINE)                      */ 12698000
*/*                                                                  */ 12699000
*/* FUNCTION - DALCPROC PERFORMS THE NECESSARY PROCESSING TO         */ 12700000
*/*            INVOKE THE AMS UALLOC ROUTINE WHICH PERFORMS          */ 12701000
*/*            DYNAMIC ALLOCATION.                                   */ 12702000
*/********************************************************************/ 12703000
*                                                                  2524 12704000
*DALCPROC:                                                         2524 12705000
*        PROCEDURE (REQTYPE,DALVLPTR,DALDNMPT,DALINDEX);           2524 12706000
*                                                                  2524 12707000
DALCPROC STM   @14,@12,@SA00015                                    2524 12708000
         MVC   @PC00015(16),0(@01)                                 2524 12709000
*        /************************************************************/ 12710000
*        /*                                                          */ 12711000
*        /* ARGUMENTS OF INVOCATION                                  */ 12712000
*        /*                                                          */ 12713000
*        /************************************************************/ 12714000
*        DCL                                                       2525 12715000
*          REQTYPE CHAR(1),            /* TYPE OF REQUEST            */ 12716000
*          DALVLPTR,                   /* ADDR OF VOLUMES LIST       */ 12717000
*          DALDNMPT,                   /* ADDR OF DNAME              */ 12718000
*          DALINDEX;                   /* INDEX OF ALLAGLS           */ 12719000
*                                                                  2525 12720000
*        /************************************************************/ 12721000
*        /*                                                          */ 12722000
*        /* UNIT DESCRIPTOR LIST REFERENCED BY ALLAGL                */ 12723000
*        /*                                                          */ 12724000
*        /************************************************************/ 12725000
*        DCL                                                       2526 12726000
*          1 DALCUNIT STATIC LOCAL,                                2526 12727000
*            2 DL#UNIT   FIXED(15) INIT(1),                        2526 12728000
*            2 DLUNITLN  FIXED(15) INIT(8),                        2526 12729000
*            2 DLUNIT    CHAR(8)   INIT('SYSALLDA');               2526 12730000
*                                                                  2526 12731000
*        /************************************************************/ 12732000
*        /*                                                          */ 12733000
*        /* SAVE AREAS FOR POINTERS TO ALLAGLS                       */ 12734000
*        /*                                                          */ 12735000
*        /************************************************************/ 12736000
*        DCL                                                       2527 12737000
*          1 ALGLSAVE  CHAR(20) BDY(WORD),                         2527 12738000
*            2 ALSAVPTR(*) PTR(31);                                2527 12739000
*                                                                  2527 12740000
*        /************************************************************/ 12741000
*        /*                                                          */ 12742000
*        /* MAPPING STRUCTURE FOR VOLUME LIST TO BE DYNAMICALLY      */ 12743000
*        /* ALLOCATED, THIS LIST IS RECONSTRUCTED IN A FORM          */ 12744000
*        /* COMPATIBLE TO DYNAMIC ALLOCATION IN A NEW AREA           */ 12745000
*        /*                                                          */ 12746000
*        /************************************************************/ 12747000
*                                                                  2528 12748000
*        DCL                                                       2528 12749000
*          1 FVTVLIST BASED(DALVLPTR),                             2528 12750000
*            2 FVTVLEN FIXED(15),                                  2528 12751000
*            2 * (*),                                              2528 12752000
*              3 *       FIXED(15),                                2528 12753000
*              3 FVTVSER CHAR(6);                                  2528 12754000
*                                                                  2528 12755000
*        /************************************************************/ 12756000
*        /*                                                          */ 12757000
*        /* MAPPING STRUCTURE FOR VOLUME LIST CONSTRUCTED IN DALCPROC*/ 12758000
*        /* AND PASSED TO DYNAMIC ALLOCATION VIA THE ALLAGL PARAMETER*/ 12759000
*        /* LIST                                                     */ 12760000
*        /*                                                          */ 12761000
*        /************************************************************/ 12762000
*                                                                  2529 12763000
*        DCL                                                       2529 12764000
*          1 ALCVLIST BASED(ALLVLP),                               2529 12765000
*            2 ALC#ENT FIXED(15),                                  2529 12766000
*            2 * (*),                                              2529 12767000
*              3 ALCVLEN FIXED(15),                                2529 12768000
*              3 ALCVSER CHAR(6);                                  2529 12769000
*                                                                  2529 12770000
*        /************************************************************/ 12771000
*        /*                                                          */ 12772000
*        /* POINTER TO ALLAGL PARAMETERLIST                          */ 12773000
*        /*                                                          */ 12774000
*        /************************************************************/ 12775000
*        DCL                                                       2530 12776000
*          DALGLPTR  PTR(31);                                      2530 12777000
*                                                                  2530 12778000
*        /************************************************************/ 12779000
*        /*                                                          */ 12780000
*        /* ENTRY POINT TO DALCPROC                                  */ 12781000
*        /*                                                          */ 12782000
*        /************************************************************/ 12783000
*                                                                  2531 12784000
*        OLDERID2 = NEWERID2;                                      2531 12785000
         L     @04,@PC00001                                        2531 12786000
         L     @04,GDTTR2(,@04)                                    2531 12787000
         MVC   @TS00001(95),NEWERID2(@04)                          2531 12788000
         MVC   OLDERID2(95,@04),@TS00001                           2531 12789000
*        NEWID2 = 'RMDA';                                          2532 12790000
*                                                                  2532 12791000
         MVC   NEWID2(4,@04),@CC01618                              2532 12792000
*        /************************************************************/ 12793000
*        /*                                                          */ 12794000
*        /* CHECK REQUEST TYPE FOR ALLOCATION OR DEALLOCATION        */ 12795000
*        /*                                                          */ 12796000
*        /************************************************************/ 12797000
*                                                                  2533 12798000
*        IF REQTYPE = 'A'                                          2533 12799000
*          THEN                                                    2533 12800000
         L     @04,@PC00015                                        2533 12801000
         CLI   REQTYPE(@04),C'A'                                   2533 12802000
         BNE   @RF02533                                            2533 12803000
*DALOOP0:    DO;                                                   2534 12804000
*                                                                  2534 12805000
DALOOP0  DS    0H                                                  2535 12806000
*            /********************************************************/ 12807000
*            /*                                                      */ 12808000
*            /* THIS IS AN ALLOCATION REQUEST - GET SPACE FOR THE    */ 12809000
*            /* VOLUME LIST TO BE BUILT AND PASSED TO THE AMS        */ 12810000
*            /* SYSTEM ADAPTER VIA THE ALLAGL PARAMETERLIST          */ 12811000
*            /*                                                      */ 12812000
*            /********************************************************/ 12813000
*                                                                  2535 12814000
*            CALL IDCSAGP0 (GDTTBL,                                2535 12815000
*              ((FVTVLEN + 8) + (LENGTH(ALLAGL) +4 )),             2535 12816000
*              DALGLPTR,                                           2535 12817000
*              GPID,                                               2535 12818000
*              SETZERO);                                           2535 12819000
*                                                                  2535 12820000
         L     @04,@PC00001                                        2535 12821000
         ST    @04,@AL00001                                        2535 12822000
         L     @15,@PC00015+4                                      2535 12823000
         L     @01,DALVLPTR(,@15)                                  2535 12824000
         LA    @00,43                                              2535 12825000
         AH    @00,FVTVLEN(,@01)                                   2535 12826000
         ST    @00,@AFTEMPS+16                                     2535 12827000
         LA    @15,@AFTEMPS+16                                     2535 12828000
         ST    @15,@AL00001+4                                      2535 12829000
         LA    @15,DALGLPTR                                        2535 12830000
         ST    @15,@AL00001+8                                      2535 12831000
         LA    @15,GPID                                            2535 12832000
         ST    @15,@AL00001+12                                     2535 12833000
         LA    @15,SETZERO                                         2535 12834000
         ST    @15,@AL00001+16                                     2535 12835000
         MVI   @AL00001+16,X'80'                                   2535 12836000
         L     @15,GDTGPL(,@04)                                    2535 12837000
         LA    @01,@AL00001                                        2535 12838000
         BALR  @14,@15                                             2535 12839000
*            RESPECIFY RTNREG RSTD;                                2536 12840000
*            TESTRC = RTNREG;                                      2537 12841000
         STH   RTNREG,TESTRC                                       2537 12842000
*            RESPECIFY RTNREG UNRSTD;                              2538 12843000
*            IF TESTRC ^= 0                                        2539 12844000
*              THEN                                                2539 12845000
         LH    @04,TESTRC                                          2539 12846000
         LTR   @04,@04                                             2539 12847000
         BZ    @RF02539                                            2539 12848000
*                DO;                                               2540 12849000
*                                                                  2540 12850000
*                DEFSTID = NOSTORAG;                               2541 12851000
         MVI   DEFSTID,X'04'                                       2541 12852000
*                RETURN;                                           2542 12853000
*                                                                  2542 12854000
@EL00015 DS    0H                                                  2542 12855000
@EF00015 DS    0H                                                  2542 12856000
@ER00015 LM    @14,@12,@SA00015                                    2542 12857000
         BR    @14                                                 2542 12858000
*                END;                                              2543 12859000
*                                                                  2543 12860000
*            /********************************************************/ 12861000
*            /*                                                      */ 12862000
*            /* SET ADDRESSABILITY TO ALLAGL AND INITIALIZE ALLVLP   */ 12863000
*            /*                                                      */ 12864000
*            /********************************************************/ 12865000
*                                                                  2544 12866000
*            RFY ALLAGL BASED(DALGLPTR);                           2544 12867000
@RF02539 DS    0H                                                  2545 12868000
*            ALLVLP = DALGLPTR + (LENGTH(ALLAGL) +4);              2545 12869000
*                                                                  2545 12870000
         L     @04,DALGLPTR                                        2545 12871000
         LA    @15,35                                              2545 12872000
         ALR   @15,@04                                             2545 12873000
         ST    @15,ALLVLP(,@04)                                    2545 12874000
*            /********************************************************/ 12875000
*            /*                                                      */ 12876000
*            /* COMPUTE THE NUMBER OF ENTRIES IN THE UALLOC VOLUME   */ 12877000
*            /* LIST                                                 */ 12878000
*            /********************************************************/ 12879000
*                                                                  2546 12880000
*            ALC#ENT = FVTVLEN / 8;                                2546 12881000
*                                                                  2546 12882000
         L     @04,@PC00015+4                                      2546 12883000
         L     @04,DALVLPTR(,@04)                                  2546 12884000
         LH    @00,FVTVLEN(,@04)                                   2546 12885000
         SRDA  @00,32                                              2546 12886000
         D     @00,@CF00039                                        2546 12887000
         STH   @01,ALC#ENT(,@15)                                   2546 12888000
*            /********************************************************/ 12889000
*            /*                                                      */ 12890000
*            /* CHECK FOR UNREASONABLE VALUE IN ALC#ENT TO PREVENT   */ 12891000
*            /* ALLOPING PROBLEM IN DALOOP1                          */ 12892000
*            /*                                                      */ 12893000
*            /********************************************************/ 12894000
*            IF ALC#ENT  < 1  |                                    2547 12895000
*               ALC#ENT  > 255                                     2547 12896000
*              THEN                                                2547 12897000
         LTR   @01,@01                                             2547 12898000
         BNP   @RT02547                                            2547 12899000
         C     @01,@CF00615                                        2547 12900000
         BNH   @RF02547                                            2547 12901000
@RT02547 DS    0H                                                  2548 12902000
*                DO;                                               2548 12903000
*                                                                  2548 12904000
*                DEFSTID = UALLCERR;                               2549 12905000
         MVI   DEFSTID,X'10'                                       2549 12906000
*                RETURN;                                           2550 12907000
*                                                                  2550 12908000
         B     @EL00015                                            2550 12909000
*                END;                                              2551 12910000
*                                                                  2551 12911000
*            /********************************************************/ 12912000
*            /*                                                      */ 12913000
*            /* LOOP THRU THE LIST OF VOLUMES REFERENCED BY DALVLPTR */ 12914000
*            /* MOVING EACH VOLSER INTO THE LIST PASSED VIA THE      */ 12915000
*            /* ALLAGL AND COMPUTE THE LENGTH OF THE NON-BLANK       */ 12916000
*            /* PORTION OF THE VOLSER, THIS LENGTH PRECEEDES EACH    */ 12917000
*            /* VOLSER IN THE ALLAGL VOLUME LIST                     */ 12918000
*            /*                                                      */ 12919000
*            /********************************************************/ 12920000
*                                                                  2552 12921000
*DALOOP1:    DO N = 1 TO ALC#ENT;                                  2552 12922000
*                                                                  2552 12923000
@RF02547 DS    0H                                                  2552 12924000
DALOOP1  LA    @04,1                                               2552 12925000
         B     @DE02552                                            2552 12926000
@DL02552 DS    0H                                                  2553 12927000
*              DO J = 1 TO 6                                       2553 12928000
*                WHILE FVTVSER (N,J) ^= ' ';                       2553 12929000
         LA    @04,1                                               2553 12930000
         ST    @04,J                                               2553 12931000
@DL02553 L     @15,N                                               2553 12932000
         SLA   @15,3                                               2553 12933000
         ALR   @15,@04                                             2553 12934000
         L     @14,@PC00015+4                                      2553 12935000
         L     @01,DALVLPTR(,@14)                                  2553 12936000
         ALR   @01,@15                                             2553 12937000
         AL    @01,@CF01803                                        2553 12938000
         CLI   FVTVSER-4(@01),C' '                                 2553 12939000
         BE    @DC02553                                            2553 12940000
*              END;                                                2554 12941000
*                                                                  2554 12942000
         AL    @04,@CF00221                                        2554 12943000
         ST    @04,J                                               2554 12944000
         C     @04,@CF00041                                        2554 12945000
         BNH   @DL02553                                            2554 12946000
@DC02553 DS    0H                                                  2555 12947000
*              /******************************************************/ 12948000
*              /*                                                    */ 12949000
*              /* ON EXIT FROM ABOVE LOOP J HAS THE LENGTH OF THE    */ 12950000
*              /* NONBLANK PORTION OF THE VOLSER + 1                 */ 12951000
*              /*                                                    */ 12952000
*              /******************************************************/ 12953000
*                                                                  2555 12954000
*              ALCVLEN(N) = (J - 1);                               2555 12955000
         L     @04,N                                               2555 12956000
         LR    @15,@04                                             2555 12957000
         SLA   @15,3                                               2555 12958000
         L     @01,DALGLPTR                                        2555 12959000
         L     @14,ALLVLP(,@01)                                    2555 12960000
         L     @03,J                                               2555 12961000
         BCTR  @03,0                                               2555 12962000
         LA    @02,0(@15,@14)                                      2555 12963000
         AL    @02,@CF01786                                        2555 12964000
         STH   @03,ALCVLEN-2(,@02)                                 2555 12965000
*              ALCVSER(N) = FVTVSER(N);                            2556 12966000
*                                                                  2556 12967000
         ALR   @14,@15                                             2556 12968000
         AL    @14,@CF01779                                        2556 12969000
         L     @03,@PC00015+4                                      2556 12970000
         L     @01,DALVLPTR(,@03)                                  2556 12971000
         ALR   @01,@15                                             2556 12972000
         AL    @01,@CF01779                                        2556 12973000
         MVC   ALCVSER-4(6,@14),FVTVSER-4(@01)                     2556 12974000
*            END DALOOP1;                                          2557 12975000
*                                                                  2557 12976000
         AL    @04,@CF00221                                        2557 12977000
@DE02552 ST    @04,N                                               2557 12978000
         L     @01,DALGLPTR                                        2557 12979000
         L     @01,ALLVLP(,@01)                                    2557 12980000
         CH    @04,ALC#ENT(,@01)                                   2557 12981000
         BNH   @DL02552                                            2557 12982000
*            /********************************************************/ 12983000
*            /*                                                      */ 12984000
*            /* INITIALIZE REMAINING ALLAGL FIELDS                   */ 12985000
*            /*                                                      */ 12986000
*            /********************************************************/ 12987000
*                                                                  2558 12988000
*            ALLULP = ADDR(DALCUNIT);                              2558 12989000
         L     @04,DALGLPTR                                        2558 12990000
         LA    @15,DALCUNIT                                        2558 12991000
         ST    @15,ALLULP(,@04)                                    2558 12992000
*            ALLOPTVL = ON;                                        2559 12993000
*                                                                  2559 12994000
         OI    ALLOPTVL(@04),B'10000000'                           2559 12995000
*            /********************************************************/ 12996000
*            /*                                                      */ 12997000
*            /*  INVOKE DYNAMIC ALLOCATION VIA AMS UALLOC MACRO      */ 12998000
*            /*                                                      */ 12999000
*            /********************************************************/ 13000000
*                                                                  2560 13001000
*            CALL IDCSAAL0 (GDTTBL,ALLAGL);                        2560 13002000
*                                                                  2560 13003000
         L     @15,@PC00001                                        2560 13004000
         ST    @15,@AL00001                                        2560 13005000
         ST    @04,@AL00001+4                                      2560 13006000
         MVI   @AL00001+4,X'80'                                    2560 13007000
         L     @15,GDTALC(,@15)                                    2560 13008000
         LA    @01,@AL00001                                        2560 13009000
         BALR  @14,@15                                             2560 13010000
*            RESPECIFY RTNREG RSTD;                                2561 13011000
*            TESTRC = RTNREG;                                      2562 13012000
         STH   RTNREG,TESTRC                                       2562 13013000
*            RESPECIFY RTNREG UNRSTD;                              2563 13014000
*            IF TESTRC = 4                                         2564 13015000
*              THEN                                                2564 13016000
         LH    @04,TESTRC                                          2564 13017000
         C     @04,@CF00046                                        2564 13018000
         BNE   @RF02564                                            2564 13019000
*                DO;                                               2565 13020000
*                                                                  2565 13021000
*                DEFSTID = UALLCERR;                               2566 13022000
         MVI   DEFSTID,X'10'                                       2566 13023000
*                RETURN CODE(LASTCC12);                            2567 13024000
*                                                                  2567 13025000
         LA    @15,12                                              2567 13026000
         L     @14,@SA00015                                        2567 13027000
         LM    @00,@12,@SA00015+8                                  2567 13028000
         BR    @14                                                 2567 13029000
*                END;                                              2568 13030000
*            /********************************************************/ 13031000
*            /*                                                      */ 13032000
*            /* MAINTAIN A LIST OF POINTERS TO ALLAGLS - THERE IS A  */ 13033000
*            /* POSSIBILITY OF TWO ALLAGLS                           */ 13034000
*            /*                                                      */ 13035000
*            /********************************************************/ 13036000
*                                                                  2569 13037000
*            DALINDEX = DALINDEX + 1;                              2569 13038000
@RF02564 L     @04,@PC00015+12                                     2569 13039000
         LA    @15,1                                               2569 13040000
         AL    @15,DALINDEX(,@04)                                  2569 13041000
         ST    @15,DALINDEX(,@04)                                  2569 13042000
*            ALSAVPTR(DALINDEX) = DALGLPTR;                        2570 13043000
*                                                                  2570 13044000
         L     @04,DALGLPTR                                        2570 13045000
         SLA   @15,2                                               2570 13046000
         ST    @04,ALSAVPTR-4(@15)                                 2570 13047000
*            /********************************************************/ 13048000
*            /*                                                      */ 13049000
*            /* SET POINTER TO DDNAME BUILT BY UALLOC                */ 13050000
*            /*                                                      */ 13051000
*            /********************************************************/ 13052000
*                                                                  2571 13053000
*            DALDNMPT = ADDR(ALLDDN);                              2571 13054000
*                                                                  2571 13055000
         L     @15,@PC00015+8                                      2571 13056000
         LA    @04,ALLDDN(,@04)                                    2571 13057000
         ST    @04,DALDNMPT(,@15)                                  2571 13058000
*            END DALOOP0;                                          2572 13059000
*                                                                  2572 13060000
*          /**********************************************************/ 13061000
*          /* THIS IS A DEALLOCATE REQUEST                           */ 13062000
*          /**********************************************************/ 13063000
*          ELSE                                                    2573 13064000
*            DO;                                                   2573 13065000
         B     @RC02533                                            2573 13066000
@RF02533 DS    0H                                                  2574 13067000
*            DO N = 1 TO DALINDEX;                                 2574 13068000
*                                                                  2574 13069000
         LA    @04,1                                               2574 13070000
         B     @DE02574                                            2574 13071000
@DL02574 DS    0H                                                  2575 13072000
*              RFY ALLAGL BASED(ALSAVPTR(N));                      2575 13073000
*                                                                  2575 13074000
*              CALL IDCSADL0 (GDTTBL,ALLAGL);                      2576 13075000
*                                                                  2576 13076000
         L     @15,@PC00001                                        2576 13077000
         ST    @15,@AL00001                                        2576 13078000
         SLA   @04,2                                               2576 13079000
         L     @04,ALSAVPTR-4(@04)                                 2576 13080000
         ST    @04,@AL00001+4                                      2576 13081000
         MVI   @AL00001+4,X'80'                                    2576 13082000
         L     @15,GDTDLC(,@15)                                    2576 13083000
         LA    @01,@AL00001                                        2576 13084000
         BALR  @14,@15                                             2576 13085000
*            END;                                                  2577 13086000
*                                                                  2577 13087000
         LA    @04,1                                               2577 13088000
         AL    @04,N                                               2577 13089000
@DE02574 ST    @04,N                                               2577 13090000
         L     @15,@PC00015+12                                     2577 13091000
         C     @04,DALINDEX(,@15)                                  2577 13092000
         BNH   @DL02574                                            2577 13093000
*            /********************************************************/ 13094000
*            /*                                                      */ 13095000
*            /*  RESET THE VALUE OF DALINDEX TO ZERO.                */ 13096000
*            /*                                                      */ 13097000
*            /********************************************************/ 13098000
*                                                                  2578 13099000
*            DALINDEX = 0;                                         2578 13100000
         L     @04,@PC00015+12                                     2578 13101000
         SLR   @15,@15                                             2578 13102000
         ST    @15,DALINDEX(,@04)                                  2578 13103000
*            END;                                                  2579 13104000
*                                                                  2579 13105000
*        RETURN CODE(0);                                           2580 13106000
@RC02533 SLR   @15,@15                                             2580 13107000
         L     @14,@SA00015                                        2580 13108000
         LM    @00,@12,@SA00015+8                                  2580 13109000
         BR    @14                                                 2580 13110000
*        RFY ALLAGL BASED(ALLPTR);                                 2581 13111000
*END DALCPROC;                                                     2582 13112000
*        /************************************************************/ 13113000
*        /*                                                          */ 13114000
*        /*  PROCEDURE NAME - OPENPROC                               */ 13115000
*        /*                                                          */ 13116000
*        /*  FUNCTION - PERFORMS ALL OPENS REQUIRED FOR OPENING A    */ 13117000
*        /*  VSAM OBJECT FOR OUTPUT, OR OPENING THE PORTABILITY      */ 13118000
*        /*  VOLUME FOR INPUT.                                       */ 13119000
*        /*  WHEN OPENING A VSAM OBJECT FOR INPUT OPENPROC           */ 13120000
*        /*  SETS THE EXPORT/IMPORT FLAG IN THE OPNAGL.              */ 13121000
*        /*                                                          */ 13122000
*        /*  INPUT -                                                 */ 13123000
*        /*    .OTYPE - I INDICATES INPUT, O INDICATES OUTPUT        */ 13124000
*        /*    .ODD - 8-BYTE JCL STATEMENT NAME FOR DATA SET TO BE   */ 13125000
*        /*           OPENED                                         */ 13126000
*        /*    .ODSN - NAME OF VSAM CLUSTER COMPONENT                */ 13127000
*        /*    .OREC - LRECL SIZE FOR DATA SET                       */ 13128000
*        /*    .OBLK - BLKSIZE FOR DATA SET                          */ 13129000
*        /*                                                          */ 13130000
*        /*  OUTPUT - POINTER TO IOCS FOR OPEN DATA SET              */ 13131000
*        /*                                                          */ 13132000
*        /************************************************************/ 13133000
*                                                                  2583 13134000
*OPENPROC:  PROCEDURE(OTYPE,           /*OPEN FOR INPUT OR OUTPUT    */ 13135000
*                     ODD,             /*8-BYTE JCL STATEMENT NAME   */ 13136000
*                     ODSN,            /*ENTRYNAME OF OBJECT RELATED */ 13137000
*                                      /*TO CLUSTER                  */ 13138000
*                     OREC,            /*LRECL FOR OUTPUT DATA SET   */ 13139000
*                     OBLK,            /*BLKSIZE FOR OUTPUT DATA SET */ 13140000
*                     OIOCS);          /*RETURN CELL FOR IOCS        */ 13141000
*                                                                  2583 13142000
OPENPROC STM   @14,@12,@SA00016                                    2583 13143000
         MVC   @PC00016(24),0(@01)                                 2583 13144000
*        /************************************************************/ 13145000
*        /*                                                          */ 13146000
*        /*  ARGUMENTS OF INVOCATION                                 */ 13147000
*        /*                                                          */ 13148000
*        /************************************************************/ 13149000
*                                                                  2584 13150000
*        DCL                                                       2584 13151000
*          OTYPE CHAR(1),                                          2584 13152000
*          ODD   PTR(31),                                          2584 13153000
*          ODSN  PTR(31),                                          2584 13154000
*          OREC,                                                   2584 13155000
*          OBLK,                                                   2584 13156000
*          OIOCS PTR(31);                                          2584 13157000
*                                                                  2584 13158000
*        /************************************************************/ 13159000
*        /*                                                          */ 13160000
*        /*  LOCAL DECLARATIONS                                      */ 13161000
*        /*                                                          */ 13162000
*        /************************************************************/ 13163000
*                                                                  2585 13164000
*        DCL OPENLIST BIT(LENGTH(OPNAGL)) BDY(WORD);               2585 13165000
*                                      /* STORAGE FOR OPEN ARGUMENT  */ 13166000
*                                      /* LIST                       */ 13167000
*        DCL OPENSAVE BIT(LENGTH(OPNAGL)) BDY(WORD);               2586 13168000
*                                      /*SAVE AREA FOR THE OPNAGL    */ 13169000
*        DCL RECSZ    FIXED(31);       /*RECORD SIZE OF PORTABLE DATA*/ 13170000
*                                      /*SET                         */ 13171000
*        DCL OIOCSPTR PTR(31) BASED(OIOCS);                        2588 13172000
*                                                                  2588 13173000
*        /************************************************************/ 13174000
*        /*                                                          */ 13175000
*        /*  CONSTRUCT OPNAGL SETTING DIFFERENT OPTIONS FOR INPUT    */ 13176000
*        /*  VERSUS AN OUTPUT DATA SET                               */ 13177000
*        /*  BEGIN BY POINTING TO THE STORAGE FOR THE OPNAGL, AND    */ 13178000
*        /*  BY CLEARING THAT STORAGE AS WELL AS THE STORAGE FOR THE */ 13179000
*        /*  OPNAGL SAVE AREA.                                       */ 13180000
*        /*                                                          */ 13181000
*        /************************************************************/ 13182000
*                                                                  2589 13183000
*        OLDERID2 = NEWERID2;                                      2589 13184000
         L     @04,@PC00001                                        2589 13185000
         L     @04,GDTTR2(,@04)                                    2589 13186000
         MVC   @TS00001(95),NEWERID2(@04)                          2589 13187000
         MVC   OLDERID2(95,@04),@TS00001                           2589 13188000
*        NEWID2 = 'RMOP';                                          2590 13189000
         MVC   NEWID2(4,@04),@CC01647                              2590 13190000
*        OPENLIST = ''B;                                           2591 13191000
         XC    OPENLIST(48),OPENLIST                               2591 13192000
*        OPENSAVE = ''B;                                           2592 13193000
         XC    OPENSAVE(48),OPENSAVE                               2592 13194000
*        OPNPTR = ADDR(OPENLIST);                                  2593 13195000
         LA    @04,OPENLIST                                        2593 13196000
         ST    @04,OPNPTR                                          2593 13197000
*        IF OTYPE = 'I'                                            2594 13198000
*          THEN                                                    2594 13199000
*                                                                  2594 13200000
         L     @15,@PC00016                                        2594 13201000
         CLI   OTYPE(@15),C'I'                                     2594 13202000
         BNE   @RF02594                                            2594 13203000
*            /********************************************************/ 13204000
*            /*                                                      */ 13205000
*            /*  OPEN FOR  INPUT SPECIFIED - SET VBS FORMAT          */ 13206000
*            /*                                                      */ 13207000
*            /********************************************************/ 13208000
*                                                                  2595 13209000
*            DO;                                                   2595 13210000
*            OPNOPTIN = ON;                                        2596 13211000
         OI    OPNOPTIN(@04),B'10000000'                           2596 13212000
*            OPNRFMSF = ON;                                        2597 13213000
*            OPNRFMBK = ON;                                        2598 13214000
         OI    OPNRFMSF(@04),B'00011000'                           2598 13215000
*            OPNBLK = OBLK;                                        2599 13216000
*                                                                  2599 13217000
         L     @15,@PC00016+16                                     2599 13218000
         L     @15,OBLK(,@15)                                      2599 13219000
         ST    @15,OPNBLK(,@04)                                    2599 13220000
*            /********************************************************/ 13221000
*            /*                                                      */ 13222000
*            /*  SET THE RECOVERY BIT TO ON TO INDICATE THAT THIS    */ 13223000
*            /*  PORTABLE DATA SET IS SUPPOSED TO HAVE THE SPECIAL   */ 13224000
*            /*  RECOVERY HEADERS PREPENDED TO ITS RECORDS.          */ 13225000
*            /*                                                      */ 13226000
*            /********************************************************/ 13227000
*                                                                  2600 13228000
*            OPNTYPRV = ON;                                        2600 13229000
*                                                                  2600 13230000
         OI    OPNTYPRV(@04),B'00000010'                           2600 13231000
*            /********************************************************/ 13232000
*            /*                                                      */ 13233000
*            /*  PROCESS ENVIRONMENT PARAMETER FOR DOS               */ 13234000
*            /*  SET DEVICE TYPE ADDRESS                             */ 13235000
*            /*                                                      */ 13236000
*            /********************************************************/ 13237000
*                                                                  2601 13238000
*            IF ADDR(ENV) ^= NULLPTR                               2601 13239000
*              THEN                                                2601 13240000
         L     @04,@PC00001+4                                      2601 13241000
         L     @04,FDTPTR+60(,@04)                                 2601 13242000
         LTR   @04,@04                                             2601 13243000
         BZ    @RF02601                                            2601 13244000
*ENVPARM:        DO;                                               2602 13245000
ENVPARM  DS    0H                                                  2603 13246000
*                IF ADDR(PDEV) ^= NULLPTR                          2603 13247000
*                  THEN                                            2603 13248000
         L     @04,@PC00001+4                                      2603 13249000
         L     @04,FDTPTR+84(,@04)                                 2603 13250000
         LTR   @04,@04                                             2603 13251000
         BZ    @RF02603                                            2603 13252000
*                    OPNDEVDT = ADDR(PDEVVAL);                     2604 13253000
*                                                                  2604 13254000
         LA    @04,PDEVVAL(,@04)                                   2604 13255000
         L     @01,OPNPTR                                          2604 13256000
         ST    @04,OPNDEVDT(,@01)                                  2604 13257000
*                /****************************************************/ 13258000
*                /*                                                  */ 13259000
*                /*  IF THE USER SPECIFIED THE BLOCKSIZE             */ 13260000
*                /*  SUBPARAMETER, OVERRIDE THE VALUE OF             */ 13261000
*                /*  OPNBLK WITH THE VALUE SPECIFIED BY THE          */ 13262000
*                /*  USER.                                           */ 13263000
*                /*                                                  */ 13264000
*                /****************************************************/ 13265000
*                                                                  2605 13266000
*                IF ADDR(BLKSZ) ^= NULLPTR                         2605 13267000
*                  THEN                                            2605 13268000
@RF02603 L     @04,@PC00001+4                                      2605 13269000
         L     @04,FDTPTR+80(,@04)                                 2605 13270000
         LTR   @04,@04                                             2605 13271000
         BZ    @RF02605                                            2605 13272000
*                    OPNBLK = BLKSZVAL;                            2606 13273000
         L     @04,BLKSZVAL(,@04)                                  2606 13274000
         L     @01,OPNPTR                                          2606 13275000
         ST    @04,OPNBLK(,@01)                                    2606 13276000
*                END ENVPARM;                                      2607 13277000
*                                                                  2607 13278000
@RF02605 DS    0H                                                  2608 13279000
*            /********************************************************/ 13280000
*            /*                                                      */ 13281000
*            /*  SET AN INITIAL VALUE FOR THE RECORD SIZE            */ 13282000
*            /*  OF THE PORTABLE DATA SET.  THE VALUE THAT IS        */ 13283000
*            /*  ACTUALLY USED IS OBTAINED BY READING THE            */ 13284000
*            /*  FIRST RECORD OF THE DATA SET.                       */ 13285000
*            /*                                                      */ 13286000
*            /********************************************************/ 13287000
*                                                                  2608 13288000
*            OPNREC = RECSIZ;                                      2608 13289000
*                                                                  2608 13290000
@RF02601 L     @04,OPNPTR                                          2608 13291000
         MVC   OPNREC(4,@04),@CF00917                              2608 13292000
*            /********************************************************/ 13293000
*            /*                                                      */ 13294000
*            /*  IF THE THE INPUT DD VALUE WAS NOT GIVEN, SET        */ 13295000
*            /*  THE DATA SET NAME IN THE OPNAGL.  THIS CAN OCCUR    */ 13296000
*            /*  ONLY IN VS2.                                        */ 13297000
*            /*                                                      */ 13298000
*            /********************************************************/ 13299000
*                                                                  2609 13300000
*            IF ADDR(INDD) = NULLPTR                               2609 13301000
*              THEN                                                2609 13302000
         L     @15,@PC00001+4                                      2609 13303000
         L     @15,FDTPTR+56(,@15)                                 2609 13304000
         LTR   @15,@15                                             2609 13305000
         BNZ   @RF02609                                            2609 13306000
*                OPNDSN = ODSN;                                    2610 13307000
         L     @15,@PC00016+8                                      2610 13308000
         L     @15,ODSN(,@15)                                      2610 13309000
         ST    @15,OPNDSN(,@04)                                    2610 13310000
*              ELSE                                                2611 13311000
*                OPNDDN = ODD;                                     2611 13312000
         B     @RC02609                                            2611 13313000
@RF02609 L     @04,@PC00016+4                                      2611 13314000
         L     @04,ODD(,@04)                                       2611 13315000
         L     @01,OPNPTR                                          2611 13316000
         ST    @04,OPNDDN(,@01)                                    2611 13317000
*            END;                                                  2612 13318000
*                                                                  2612 13319000
@RC02609 DS    0H                                                  2613 13320000
*        IF OTYPE = 'O'                                            2613 13321000
*          THEN                                                    2613 13322000
*                                                                  2613 13323000
@RF02594 L     @04,@PC00016                                        2613 13324000
         CLI   OTYPE(@04),C'O'                                     2613 13325000
         BNE   @RF02613                                            2613 13326000
*            /********************************************************/ 13327000
*            /*                                                      */ 13328000
*            /*  OPEN FOR OUTPUT FOR VSAM DATA SET.  SET OPEN FOR    */ 13329000
*            /*  OUTPUT.                                             */ 13330000
*            /*                                                      */ 13331000
*            /********************************************************/ 13332000
*                                                                  2614 13333000
*            DO;                                                   2614 13334000
*            OPNOPTOT = ON;                                        2615 13335000
         L     @04,OPNPTR                                          2615 13336000
         OI    OPNOPTOT(@04),B'01000000'                           2615 13337000
*            OPNTYPXM = ON;                                        2616 13338000
*            /*                                              @Z40RSSA*/ 13339000
*            /*  SET OPNTYPSY SO OPEN WILL BYPASS SECURITY   @Z40RSSA*/ 13340000
*            /*  CHECKING                                    @Z40RSSA*/ 13341000
*            /*                                              @Z40RSSA*/ 13342000
*                                                                  2617 13343000
*            OPNTYPSY = ON;                                /*@Z40RSSA*/ 13344000
*                                                                  2617 13345000
         OI    OPNTYPXM(@04),B'00010001'                           2617 13346000
*            /********************************************************/ 13347000
*            /*                                                      */ 13348000
*            /*  IF IMPORTING AN AIX, SET THE OPNMODAX BIT,          */ 13349000
*            /*  SO THAT WHEN OPENING BY PATH NAME, THE AIX          */ 13350000
*            /*  IS OPENED RATHER THAN THE BASE CLUSTER.             */ 13351000
*            /*                                                      */ 13352000
*            /********************************************************/ 13353000
*                                                                  2618 13354000
*            IF FVTPTR(1) -> CTGFVTYP = CTGTAIX                    2618 13355000
*              THEN                                                2618 13356000
         L     @01,FVTPTR                                          2618 13357000
         CLI   CTGFVTYP(@01),C'G'                                  2618 13358000
         BNE   @RF02618                                            2618 13359000
*                OPNMODAX = ON;                                    2619 13360000
*                                                                  2619 13361000
         OI    OPNMODAX(@04),B'00001000'                           2619 13362000
*            /********************************************************/ 13363000
*            /*                                                      */ 13364000
*            /*  GET OBJECT PASSWORD, WHICH WILL BE OVERRIDEN        */ 13365000
*            /*  IF A PASSWORD WAS SPECIFIED VIA OUTFILE.            */ 13366000
*            /*                                                      */ 13367000
*            /********************************************************/ 13368000
*                                                                  2620 13369000
*            IF ADDR(OUTDD) ^= NULLPTR                             2620 13370000
*              THEN                                                2620 13371000
@RF02618 L     @04,@PC00001+4                                      2620 13372000
         L     @04,FDTPTR+4(,@04)                                  2620 13373000
         LTR   @04,@04                                             2620 13374000
         BZ    @RF02620                                            2620 13375000
*OFPWA:          DO;                                               2621 13376000
OFPWA    DS    0H                                                  2622 13377000
*                IF OUTDDPLN ^= 0                                  2622 13378000
*                  THEN                                            2622 13379000
         L     @04,@PC00001+4                                      2622 13380000
         L     @04,FDTPTR+4(,@04)                                  2622 13381000
         CLI   OUTDDPLN(@04),0                                     2622 13382000
         BE    @RF02622                                            2622 13383000
*                    OPNPWA = ADDR(OUTDDPAS);                      2623 13384000
         LA    @04,OUTDDPAS(,@04)                                  2623 13385000
         L     @01,OPNPTR                                          2623 13386000
         ST    @04,OPNPWA(,@01)                                    2623 13387000
*                END OFPWA;                                        2624 13388000
@RF02622 DS    0H                                                  2625 13389000
*            IF OPNPWA = NULLPTR                                   2625 13390000
*              THEN                                                2625 13391000
@RF02620 L     @04,OPNPTR                                          2625 13392000
         L     @04,OPNPWA(,@04)                                    2625 13393000
         LTR   @04,@04                                             2625 13394000
         BNZ   @RF02625                                            2625 13395000
*PORTPWA:        DO;                                               2626 13396000
PORTPWA  DS    0H                                                  2627 13397000
*                CTGFVPTR = FVTPTR(1);                             2627 13398000
         L     @04,FVTPTR                                          2627 13399000
         ST    @04,CTGFVPTR                                        2627 13400000
*                IF CTGFVSTY ^= NULLPTR                            2628 13401000
*                  THEN                                            2628 13402000
         L     @04,CTGFVSTY(,@04)                                  2628 13403000
         LTR   @04,@04                                             2628 13404000
         BZ    @RF02628                                            2628 13405000
*                    DO;                                           2629 13406000
*                    CTGFLPTR = CTGFVSTY;                          2630 13407000
         ST    @04,CTGFLPTR                                        2630 13408000
*                    OPNPWA = CTGFLPT(1);                          2631 13409000
         L     @04,CTGFLPT(,@04)                                   2631 13410000
         L     @01,OPNPTR                                          2631 13411000
         ST    @04,OPNPWA(,@01)                                    2631 13412000
*                    END;                                          2632 13413000
*                END PORTPWA;                                      2633 13414000
@RF02628 DS    0H                                                  2634 13415000
*            END;                                                  2634 13416000
*                                                                  2634 13417000
@RF02625 DS    0H                                                  2635 13418000
*        /************************************************************/ 13419000
*        /*                                                          */ 13420000
*        /*  SET FIELDS IN OPNAGL THAT ARE COMMON FOR OUTPUT AND     */ 13421000
*        /*  INPUT                                                   */ 13422000
*        /*                                                          */ 13423000
*        /************************************************************/ 13424000
*                                                                  2635 13425000
*        OPNIOC = OIOCS;                                           2635 13426000
@RF02613 L     @04,OPNPTR                                          2635 13427000
         L     @15,@PC00016+20                                     2635 13428000
         L     @15,OIOCS(,@15)                                     2635 13429000
         ST    @15,OPNIOC(,@04)                                    2635 13430000
*        OPNDDN = ODD;                                             2636 13431000
         L     @15,@PC00016+4                                      2636 13432000
         L     @15,ODD(,@15)                                       2636 13433000
         ST    @15,OPNDDN(,@04)                                    2636 13434000
*        IF ODSN ^= NULLPTR                                        2637 13435000
*          THEN                                                    2637 13436000
         L     @15,@PC00016+8                                      2637 13437000
         L     @15,ODSN(,@15)                                      2637 13438000
         LTR   @15,@15                                             2637 13439000
         BZ    @RF02637                                            2637 13440000
*            OPNDSN = ODSN;                                        2638 13441000
*                                                                  2638 13442000
*                                                                  2638 13443000
         ST    @15,OPNDSN(,@04)                                    2638 13444000
*        /************************************************************/ 13445000
*        /*                                                          */ 13446000
*        /*  SAVE THE OPNAGL INCASE A SECOND OPEN OF THE DATA SET    */ 13447000
*        /*  IS REQUIRED (AS MAY BE THE CASE IN DOS).                */ 13448000
*        /*  ISSUE THE UOPEN MACRO TO OPEN INPUT OR OUTPUT DATA SET  */ 13449000
*        /*                                                          */ 13450000
*        /************************************************************/ 13451000
*                                                                  2639 13452000
*        OPENSAVE = OPNAGL;                                        2639 13453000
*                                                                  2639 13454000
@RF02637 L     @04,OPNPTR                                          2639 13455000
         MVC   OPENSAVE(48),OPNAGL(@04)                            2639 13456000
*        CALL IDCIOOP0 (GDTTBL,OPNAGL);                            2640 13457000
*                                                                  2640 13458000
         L     @15,@PC00001                                        2640 13459000
         ST    @15,@AL00001                                        2640 13460000
         ST    @04,@AL00001+4                                      2640 13461000
         MVI   @AL00001+4,X'80'                                    2640 13462000
         L     @15,GDTOPN(,@15)                                    2640 13463000
         LA    @01,@AL00001                                        2640 13464000
         BALR  @14,@15                                             2640 13465000
*        RESPECIFY RTNREG RSTD;                                    2641 13466000
*        TESTRC = RTNREG;                                          2642 13467000
         STH   RTNREG,TESTRC                                       2642 13468000
*        RESPECIFY RTNREG UNRSTD;                                  2643 13469000
*        /************************************************************/ 13470000
*        /*                                                          */ 13471000
*        /*  TEST RETURN CODE FROM OPEN.  IF NOT SUCCESSFUL, CLOSE   */ 13472000
*        /*  DATA SET TO FREE CORE, AND SET RETURN CODE TO FAILURE   */ 13473000
*        /*                                                          */ 13474000
*        /************************************************************/ 13475000
*                                                                  2644 13476000
*        IF TESTRC ^= 0                                            2644 13477000
*          THEN                                                    2644 13478000
         LH    @04,TESTRC                                          2644 13479000
         LTR   @04,@04                                             2644 13480000
         BZ    @RF02644                                            2644 13481000
*            DO;                                                   2645 13482000
*                                                                  2645 13483000
*            CALL IDCIOCL0 (GDTTBL,OIOCSPTR);                      2646 13484000
*                                                                  2646 13485000
         L     @04,@PC00001                                        2646 13486000
         ST    @04,@AL00001                                        2646 13487000
         L     @15,@PC00016+20                                     2646 13488000
         L     @01,OIOCS(,@15)                                     2646 13489000
         ST    @01,@AL00001+4                                      2646 13490000
         MVI   @AL00001+4,X'80'                                    2646 13491000
         L     @15,GDTCLS(,@04)                                    2646 13492000
         LA    @01,@AL00001                                        2646 13493000
         BALR  @14,@15                                             2646 13494000
*            OIOCSPTR = NULLPTR;                                   2647 13495000
         L     @04,@PC00016+20                                     2647 13496000
         L     @04,OIOCS(,@04)                                     2647 13497000
         SLR   @15,@15                                             2647 13498000
         ST    @15,OIOCSPTR(,@04)                                  2647 13499000
*            RETURN CODE(LASTCC12);                                2648 13500000
         LA    @15,12                                              2648 13501000
         L     @14,@SA00016                                        2648 13502000
         LM    @00,@12,@SA00016+8                                  2648 13503000
         BR    @14                                                 2648 13504000
*            END;                                                  2649 13505000
*          ELSE                                                    2650 13506000
*GOODOPEN:   DO;                                                   2650 13507000
*                                                                  2650 13508000
@RF02644 DS    0H                                                  2650 13509000
GOODOPEN DS    0H                                                  2651 13510000
*            /********************************************************/ 13511000
*            /*                                                      */ 13512000
*            /*  IF THE OPEN WAS FOR INPUT, GET THE SPECIAL FIRST    */ 13513000
*            /*  RECORD OF THE PORTABLE DATA SET.  THIS CONTAINS     */ 13514000
*            /*  THE RECORDSIZE OF THE PORTABLE DATA SET FOR USE     */ 13515000
*            /*  IN DOS.                                             */ 13516000
*            /*                                                      */ 13517000
*            /********************************************************/ 13518000
*                                                                  2651 13519000
*            IF OTYPE ='I'                                         2651 13520000
*              THEN                                                2651 13521000
*                                                                  2651 13522000
         L     @04,@PC00016                                        2651 13523000
         CLI   OTYPE(@04),C'I'                                     2651 13524000
         BNE   @RF02651                                            2651 13525000
*                /****************************************************/ 13526000
*                /*                                                  */ 13527000
*                /*  ISSUE A UGET TO GET THE RECORD, AND TEST FOR    */ 13528000
*                /*  A NONZERO RETURN CODE.  IF SUCH A RETURN CODE   */ 13529000
*                /*  IS DETECTED, RETURN TO THE CALLER WITH A        */ 13530000
*                /*  TERMINAL ERROR INDICATED.                       */ 13531000
*                /*                                                  */ 13532000
*                /****************************************************/ 13533000
*                                                                  2652 13534000
*OPENIN:         DO;                                               2652 13535000
OPENIN   DS    0H                                                  2653 13536000
*                CALL IDCIOGT0(GDTTBL,OIOCSPTR);                   2653 13537000
         L     @04,@PC00001                                        2653 13538000
         ST    @04,@AL00001                                        2653 13539000
         L     @15,@PC00016+20                                     2653 13540000
         L     @01,OIOCS(,@15)                                     2653 13541000
         ST    @01,@AL00001+4                                      2653 13542000
         MVI   @AL00001+4,X'80'                                    2653 13543000
         L     @15,GDTGET(,@04)                                    2653 13544000
         LA    @01,@AL00001                                        2653 13545000
         BALR  @14,@15                                             2653 13546000
*                RESPECIFY RTNREG RSTD;                            2654 13547000
*                TESTRC = RTNREG;                                  2655 13548000
         STH   RTNREG,TESTRC                                       2655 13549000
*                RESPECIFY RTNREG UNRSTD;                          2656 13550000
*                IF TESTRC ^= 0                                    2657 13551000
*                  THEN                                            2657 13552000
         LH    @04,TESTRC                                          2657 13553000
         LTR   @04,@04                                             2657 13554000
         BZ    @RF02657                                            2657 13555000
*                    DO;                                           2658 13556000
*                    CALL IDCIOCL0(GDTTBL,OIOCSPTR);               2659 13557000
         L     @04,@PC00001                                        2659 13558000
         ST    @04,@AL00001                                        2659 13559000
         L     @15,@PC00016+20                                     2659 13560000
         L     @01,OIOCS(,@15)                                     2659 13561000
         ST    @01,@AL00001+4                                      2659 13562000
         MVI   @AL00001+4,X'80'                                    2659 13563000
         L     @15,GDTCLS(,@04)                                    2659 13564000
         LA    @01,@AL00001                                        2659 13565000
         BALR  @14,@15                                             2659 13566000
*                    OIOCSPTR = NULLPTR;                           2660 13567000
         L     @04,@PC00016+20                                     2660 13568000
         L     @04,OIOCS(,@04)                                     2660 13569000
         SLR   @15,@15                                             2660 13570000
         ST    @15,OIOCSPTR(,@04)                                  2660 13571000
*                    RETURN CODE(LASTCC12);                        2661 13572000
         LA    @15,12                                              2661 13573000
         L     @14,@SA00016                                        2661 13574000
         LM    @00,@12,@SA00016+8                                  2661 13575000
         BR    @14                                                 2661 13576000
*                    END;                                          2662 13577000
*                                                                  2662 13578000
*                /****************************************************/ 13579000
*                /*                                                  */ 13580000
*                /*  POINT TO THE RECORD IN THE INPUT BUFFER.        */ 13581000
*                /*                                                  */ 13582000
*                /****************************************************/ 13583000
*                                                                  2663 13584000
*                IOCSPTR = OIOCSPTR;                               2663 13585000
@RF02657 L     @04,@PC00016+20                                     2663 13586000
         L     @04,OIOCS(,@04)                                     2663 13587000
         L     @04,OIOCSPTR(,@04)                                  2663 13588000
         ST    @04,IOCSPTR                                         2663 13589000
*                CONRCPTR = IOCDAD;                                2664 13590000
*                                                                  2664 13591000
         L     @04,IOCDAD(,@04)                                    2664 13592000
         ST    @04,CONRCPTR                                        2664 13593000
*                /****************************************************/ 13594000
*                /*                                                  */ 13595000
*                /*  RESTORE THE OPNAGL FROM OPENSAVE, AND COMPARE   */ 13596000
*                /*  THE RECORDSIZE OF THE DATA SET AS FOUND ON      */ 13597000
*                /*  THE FIRST RECORD TO THAT WITH WHICH IT WAS      */ 13598000
*                /*  ORIGINALLY OPENED.                              */ 13599000
*                /*                                                  */ 13600000
*                /****************************************************/ 13601000
*                                                                  2665 13602000
*                OPNAGL = OPENSAVE;                                2665 13603000
         L     @15,OPNPTR                                          2665 13604000
         MVC   OPNAGL(48,@15),OPENSAVE                             2665 13605000
*                IF RECORDSZ > OPNREC                              2666 13606000
*                  THEN                                            2666 13607000
         L     @04,RECORDSZ(,@04)                                  2666 13608000
         C     @04,OPNREC(,@15)                                    2666 13609000
         BNH   @RF02666                                            2666 13610000
*REOPEN:             DO;                                           2667 13611000
*                                                                  2667 13612000
REOPEN   DS    0H                                                  2668 13613000
*                    /************************************************/ 13614000
*                    /*                                              */ 13615000
*                    /*  SET THE VALUE OF OPNREC USING THE           */ 13616000
*                    /*  RECORDSIZE FOUND ON THE FIRST RECORD        */ 13617000
*                    /*  OF THE DATA SET.                            */ 13618000
*                    /*                                              */ 13619000
*                    /************************************************/ 13620000
*                                                                  2668 13621000
*                    OPNREC = RECORDSZ;                            2668 13622000
*                                                                  2668 13623000
         L     @04,CONRCPTR                                        2668 13624000
         L     @04,RECORDSZ(,@04)                                  2668 13625000
         L     @01,OPNPTR                                          2668 13626000
         ST    @04,OPNREC(,@01)                                    2668 13627000
*                    /************************************************/ 13628000
*                    /*                                              */ 13629000
*                    /*  ISSUE A CLOSE AGAINST THE PORTABLE DATA     */ 13630000
*                    /*  SET AND ZERO OUT THE IOCS POINTER FOR THAT  */ 13631000
*                    /*  DATA SET.  THEN TEST THE RETURN CODE TO     */ 13632000
*                    /*  INSURE THAT THE CLOSE WAS SUCCESSFUL.       */ 13633000
*                    /*                                              */ 13634000
*                    /************************************************/ 13635000
*                                                                  2669 13636000
*                    CALL IDCIOCL0(GDTTBL,OIOCSPTR);               2669 13637000
         L     @04,@PC00001                                        2669 13638000
         ST    @04,@AL00001                                        2669 13639000
         L     @15,@PC00016+20                                     2669 13640000
         L     @01,OIOCS(,@15)                                     2669 13641000
         ST    @01,@AL00001+4                                      2669 13642000
         MVI   @AL00001+4,X'80'                                    2669 13643000
         L     @15,GDTCLS(,@04)                                    2669 13644000
         LA    @01,@AL00001                                        2669 13645000
         BALR  @14,@15                                             2669 13646000
*                    RESPECIFY RTNREG RSTD;                        2670 13647000
*                    TESTRC = RTNREG;                              2671 13648000
         STH   RTNREG,TESTRC                                       2671 13649000
*                    RESPECIFY RTNREG UNRSTD;              /*@OZ06132*/ 13650000
*                    OIOCSPTR = NULLPTR;                           2673 13651000
*                                                                  2673 13652000
         SLR   @04,@04                                             2673 13653000
         L     @15,@PC00016+20                                     2673 13654000
         L     @01,OIOCS(,@15)                                     2673 13655000
         ST    @04,OIOCSPTR(,@01)                                  2673 13656000
*                    IF TESTRC ^= 0                                2674 13657000
*                      THEN                                        2674 13658000
         LH    @15,TESTRC                                          2674 13659000
         CR    @15,@04                                             2674 13660000
         BE    @RF02674                                            2674 13661000
*                        RETURN CODE(LASTCC12);                    2675 13662000
*                                                                  2675 13663000
         LA    @15,12                                              2675 13664000
         L     @14,@SA00016                                        2675 13665000
         LM    @00,@12,@SA00016+8                                  2675 13666000
         BR    @14                                                 2675 13667000
*                    /************************************************/ 13668000
*                    /*                                              */ 13669000
*                    /*  REOPEN THE PORTABLE DATA SET WITH THE       */ 13670000
*                    /*  RIGHT RECORD SIZE.                          */ 13671000
*                    /*                                              */ 13672000
*                    /************************************************/ 13673000
*                                                                  2676 13674000
*                    CALL IDCIOOP0(GDTTBL,OPNAGL);                 2676 13675000
*                                                                  2676 13676000
@RF02674 L     @04,@PC00001                                        2676 13677000
         ST    @04,@AL00001                                        2676 13678000
         L     @01,OPNPTR                                          2676 13679000
         ST    @01,@AL00001+4                                      2676 13680000
         MVI   @AL00001+4,X'80'                                    2676 13681000
         L     @15,GDTOPN(,@04)                                    2676 13682000
         LA    @01,@AL00001                                        2676 13683000
         BALR  @14,@15                                             2676 13684000
*                    /************************************************/ 13685000
*                    /*                                              */ 13686000
*                    /*  TEST THE RETURN CODE FROM OPEN.  IF THE     */ 13687000
*                    /*  SECOND OPEN FAILS, ATTEMPT TO CLOSE THE     */ 13688000
*                    /*  PORTABLE DATA SET AND ZERO OUT THE          */ 13689000
*                    /*  IOCS POINTER.                               */ 13690000
*                    /*                                              */ 13691000
*                    /************************************************/ 13692000
*                                                                  2677 13693000
*                    RESPECIFY RTNREG RSTD;                        2677 13694000
*                    TESTRC = RTNREG;                              2678 13695000
         STH   RTNREG,TESTRC                                       2678 13696000
*                    RESPECIFY RTNREG UNRSTD;                      2679 13697000
*                    IF TESTRC ^= 0                                2680 13698000
*                      THEN                                        2680 13699000
         LH    @04,TESTRC                                          2680 13700000
         LTR   @04,@04                                             2680 13701000
         BZ    @RF02680                                            2680 13702000
*                        DO;                                       2681 13703000
*                        CALL IDCIOCL0(GDTTBL,OIOCSPTR);           2682 13704000
         L     @04,@PC00001                                        2682 13705000
         ST    @04,@AL00001                                        2682 13706000
         L     @15,@PC00016+20                                     2682 13707000
         L     @01,OIOCS(,@15)                                     2682 13708000
         ST    @01,@AL00001+4                                      2682 13709000
         MVI   @AL00001+4,X'80'                                    2682 13710000
         L     @15,GDTCLS(,@04)                                    2682 13711000
         LA    @01,@AL00001                                        2682 13712000
         BALR  @14,@15                                             2682 13713000
*                        OIOCSPTR = NULLPTR;                       2683 13714000
         L     @04,@PC00016+20                                     2683 13715000
         L     @04,OIOCS(,@04)                                     2683 13716000
         SLR   @15,@15                                             2683 13717000
         ST    @15,OIOCSPTR(,@04)                                  2683 13718000
*                        RETURN CODE(LASTCC12);                    2684 13719000
         LA    @15,12                                              2684 13720000
         L     @14,@SA00016                                        2684 13721000
         LM    @00,@12,@SA00016+8                                  2684 13722000
         BR    @14                                                 2684 13723000
*                        END;                                      2685 13724000
*                                                                  2685 13725000
*                    /************************************************/ 13726000
*                    /*                                              */ 13727000
*                    /*  THE SECOND OPEN WAS SUCCESSFUL.  READ THE   */ 13728000
*                    /*  FIRST RECORD AGAIN.                         */ 13729000
*                    /*                                              */ 13730000
*                    /************************************************/ 13731000
*                                                                  2686 13732000
*                    CALL IDCIOGT0(GDTTBL,OIOCSPTR);               2686 13733000
@RF02680 L     @04,@PC00001                                        2686 13734000
         ST    @04,@AL00001                                        2686 13735000
         L     @15,@PC00016+20                                     2686 13736000
         L     @01,OIOCS(,@15)                                     2686 13737000
         ST    @01,@AL00001+4                                      2686 13738000
         MVI   @AL00001+4,X'80'                                    2686 13739000
         L     @15,GDTGET(,@04)                                    2686 13740000
         LA    @01,@AL00001                                        2686 13741000
         BALR  @14,@15                                             2686 13742000
*                    RESPECIFY RTNREG RSTD;                        2687 13743000
*                    TESTRC = RTNREG;                              2688 13744000
         STH   RTNREG,TESTRC                                       2688 13745000
*                    RESPECIFY RTNREG UNRSTD;                      2689 13746000
*                    IF TESTRC ^= 0                                2690 13747000
*                      THEN                                        2690 13748000
         LH    @04,TESTRC                                          2690 13749000
         LTR   @04,@04                                             2690 13750000
         BZ    @RF02690                                            2690 13751000
*                        DO;                                       2691 13752000
*                                                                  2691 13753000
*                        /********************************************/ 13754000
*                        /*                                          */ 13755000
*                        /*  THE GET FAILED.  CLOSE THE PORTABLE     */ 13756000
*                        /*  DATA SET, AND ZERO OUT THE IOCS POINTER.*/ 13757000
*                        /*                                          */ 13758000
*                        /********************************************/ 13759000
*                                                                  2692 13760000
*                        CALL IDCIOCL0(GDTTBL,OIOCSPTR);           2692 13761000
         L     @04,@PC00001                                        2692 13762000
         ST    @04,@AL00001                                        2692 13763000
         L     @15,@PC00016+20                                     2692 13764000
         L     @01,OIOCS(,@15)                                     2692 13765000
         ST    @01,@AL00001+4                                      2692 13766000
         MVI   @AL00001+4,X'80'                                    2692 13767000
         L     @15,GDTCLS(,@04)                                    2692 13768000
         LA    @01,@AL00001                                        2692 13769000
         BALR  @14,@15                                             2692 13770000
*                        OIOCSPTR = NULLPTR;                       2693 13771000
         L     @04,@PC00016+20                                     2693 13772000
         L     @04,OIOCS(,@04)                                     2693 13773000
         SLR   @15,@15                                             2693 13774000
         ST    @15,OIOCSPTR(,@04)                                  2693 13775000
*                        RETURN CODE(LASTCC12);                    2694 13776000
         LA    @15,12                                              2694 13777000
         L     @14,@SA00016                                        2694 13778000
         LM    @00,@12,@SA00016+8                                  2694 13779000
         BR    @14                                                 2694 13780000
*                        END;                                      2695 13781000
*                    END REOPEN;                                   2696 13782000
@RF02690 DS    0H                                                  2697 13783000
*                END OPENIN;                                       2697 13784000
@RF02666 DS    0H                                                  2698 13785000
*            END GOODOPEN;                                         2698 13786000
*                                                                  2698 13787000
@RF02651 DS    0H                                                  2699 13788000
*        /************************************************************/ 13789000
*        /*                                                          */ 13790000
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */ 13791000
*        /*                                                          */ 13792000
*        /************************************************************/ 13793000
*                                                                  2699 13794000
*        RETURN CODE(0);                                           2699 13795000
*                                                                  2699 13796000
         SLR   @15,@15                                             2699 13797000
         L     @14,@SA00016                                        2699 13798000
         LM    @00,@12,@SA00016+8                                  2699 13799000
         BR    @14                                                 2699 13800000
*END OPENPROC;                                                     2700 13801000
*        /************************************************************/ 13802000
*        /*                                                          */ 13803000
*        /*  PROCEDURE NAME- BFPLPROC                                */ 13804000
*        /*                                                          */ 13805000
*        /*  FUNCTION - CONSTRUCT A FIELD PARAMETER LIST FROM        */ 13806000
*        /*  DICTIONARY AND WORK AREA INFORMATION PASSED BY EXPORT   */ 13807000
*        /*  ON PORTABILITY VOLUME OR CONSTRUCT A SKELETON FPL       */ 13808000
*        /*  CONTAINING NO FIELD INFORMATION                         */ 13809000
*        /*                                                          */ 13810000
*        /*  INPUT -                                                 */ 13811000
*        /*    .BFLISTPT - POINTER TO THE FIELD LIST USED            */ 13812000
*        /*      TO PROVIDE CATALOG FIELD NAMES                      */ 13813000
*        /*    .BINDX - INDEX OF FIELDNAME INTO FIELDLST             */ 13814000
*        /*    .BFPLADDR - RETURN CELL FOR FPL ADDRESS               */ 13815000
*        /*    .BDICTPTR - POINTER TO DICTIONARY WHICH REFERENCES    */ 13816000
*        /*     CATALOG FIELD INFORMATION IN THE WORK AREA           */ 13817000
*        /*    .BWKAPTR - WORK AREA REFERENCED BY DICTIONARY         */ 13818000
*        /*                                                          */ 13819000
*        /*  OUTPUT - A FPL IS CONSTRUCTED                           */ 13820000
*        /*                                                          */ 13821000
*        /************************************************************/ 13822000
*                                                                  2701 13823000
*BFPLPROC: PROCEDURE(BFLISTPT,         /*ADDRESS OF FIELD            */ 13824000
*                                      /*NAMES LIST                  */ 13825000
*                    BINDX,            /*INDEX OF FIELDNAME          */ 13826000
*                    BFPLADDR,         /*RETURN CELL FOR FPL POINTER */ 13827000
*                    BDICTPTR,         /*POINTER TO DICTIONARY       */ 13828000
*                    BWKAPTR,          /*POINTER TO WORK AREA        */ 13829000
*                                      /*REFERENCED BY DICTIONARY    */ 13830000
*                    BFPLRTN);         /*ADDR IN WHICH TO STORE FPL  */ 13831000
BFPLPROC STM   @14,@12,@SA00017                                    2701 13832000
         MVC   @PC00017(24),0(@01)                                 2701 13833000
*                                      /*POINTER(WITHIN A FVT)       */ 13834000
*                                                                  2702 13835000
*        /************************************************************/ 13836000
*        /*                                                          */ 13837000
*        /*  ARGUMENTS OF INVOCATION                                 */ 13838000
*        /*                                                          */ 13839000
*        /************************************************************/ 13840000
*                                                                  2702 13841000
*        DCL BFLISTPT PTR(31),                                     2702 13842000
*            BINDX    FIXED(15),                                   2702 13843000
*            BFPLADDR PTR(31),                                     2702 13844000
*            BDICTPTR PTR(31),                                     2702 13845000
*            BWKAPTR  PTR(31),                                     2702 13846000
*            BFPLRTN  PTR(31);                                     2702 13847000
*                                                                  2702 13848000
*        /************************************************************/ 13849000
*        /*                                                          */ 13850000
*        /*  LOCAL DECLARATIONS FOR BFPLPROC                         */ 13851000
*        /*                                                          */ 13852000
*        /************************************************************/ 13853000
*                                                                  2703 13854000
*        DCL BFLIST(*) CHAR(8) BASED(BFLISTPT);                    2703 13855000
*                                      /*TEMPLATE FOR FIELD          */ 13856000
*                                      /*NAME LIST                   */ 13857000
*                                                                  2704 13858000
*        /************************************************************/ 13859000
*        /*                                                          */ 13860000
*        /*  IF THE DICTIONARY POINTER IS ZERO, THEN A SKELETON      */ 13861000
*        /*  FIELD PARAMETER LIST(FPL) IS CONSTRUCTED                */ 13862000
*        /*                                                          */ 13863000
*        /************************************************************/ 13864000
*                                                                  2704 13865000
*        OLDERID2 = NEWERID2;                                      2704 13866000
         L     @04,@PC00001                                        2704 13867000
         L     @15,GDTTR2(,@04)                                    2704 13868000
         MVC   @TS00001(95),NEWERID2(@15)                          2704 13869000
         MVC   OLDERID2(95,@15),@TS00001                           2704 13870000
*        NEWID2 = 'RMBF';                                          2705 13871000
*                                                                  2705 13872000
         MVC   NEWID2(4,@15),@CC01677                              2705 13873000
*        IF BDICTPTR = NULLPTR                                     2706 13874000
*          THEN                                                    2706 13875000
*                                                                  2706 13876000
         L     @15,@PC00017+12                                     2706 13877000
         L     @15,BDICTPTR(,@15)                                  2706 13878000
         LTR   @15,@15                                             2706 13879000
         BNZ   @RF02706                                            2706 13880000
*            /********************************************************/ 13881000
*            /*                                                      */ 13882000
*            /*  TEST TO DETERMINE IF WE ARE BUILDING AN FPL         */ 13883000
*            /*  FOR THE NAMEDS FIELD.                               */ 13884000
*            /*                                                      */ 13885000
*            /********************************************************/ 13886000
*                                                                  2707 13887000
*            IF BINDX = INAMEDS                                    2707 13888000
*              THEN                                                2707 13889000
*                                                                  2707 13890000
         L     @15,@PC00017+4                                      2707 13891000
         CLC   BINDX(2,@15),@CH01063                               2707 13892000
         BNE   @RF02707                                            2707 13893000
*                /****************************************************/ 13894000
*                /*                                                  */ 13895000
*                /*  BUILD AN FPL FOR NAMEDS AND ALSO A TEST         */ 13896000
*                /*  FPL SO THAT CATALOG MANAGEMENT WILL             */ 13897000
*                /*  RETURN AT MOST THE FIRST TWO ASSOCIA-           */ 13898000
*                /*  TIONS FOUND IN THE CATALOG.                     */ 13899000
*                /*                                                  */ 13900000
*                /****************************************************/ 13901000
*                                                                  2708 13902000
*                DO;                                               2708 13903000
*                                                                  2708 13904000
*                /****************************************************/ 13905000
*                /*                                                  */ 13906000
*                /*  GET CORE FOR TWO FPL'S.                         */ 13907000
*                /*                                                  */ 13908000
*                /****************************************************/ 13909000
*                                                                  2709 13910000
*                CALL IDCSAGP0(GDTTBL,(2*(LENGTH(CTGFL)+8)),       2709 13911000
*                  BFPLADDR,GPID,SETZERO);                         2709 13912000
*                                                                  2709 13913000
         ST    @04,@AL00001                                        2709 13914000
         LA    @15,48                                              2709 13915000
         ST    @15,@AFTEMPS+20                                     2709 13916000
         LA    @15,@AFTEMPS+20                                     2709 13917000
         ST    @15,@AL00001+4                                      2709 13918000
         L     @15,@PC00017+8                                      2709 13919000
         ST    @15,@AL00001+8                                      2709 13920000
         LA    @15,GPID                                            2709 13921000
         ST    @15,@AL00001+12                                     2709 13922000
         LA    @15,SETZERO                                         2709 13923000
         ST    @15,@AL00001+16                                     2709 13924000
         MVI   @AL00001+16,X'80'                                   2709 13925000
         L     @15,GDTGPL(,@04)                                    2709 13926000
         LA    @01,@AL00001                                        2709 13927000
         BALR  @14,@15                                             2709 13928000
*                RESPECIFY RTNREG RSTD;                            2710 13929000
*                TESTRC = RTNREG;                                  2711 13930000
         STH   RTNREG,TESTRC                                       2711 13931000
*                RESPECIFY RTNREG UNRSTD;                          2712 13932000
*                                                                  2712 13933000
*                IF TESTRC ^= 0                                    2713 13934000
*                  THEN                                            2713 13935000
         LH    @04,TESTRC                                          2713 13936000
         LTR   @04,@04                                             2713 13937000
         BZ    @RF02713                                            2713 13938000
*                    DO;                                           2714 13939000
*                    DARGSMOD = UNIVMSG;                           2715 13940000
         L     @04,DDSTRU                                          2715 13941000
         MVC   DARGSMOD(3,@04),@CC00981                            2715 13942000
*                    DEFSTID = NOSTORAG;                           2716 13943000
         MVI   DEFSTID,X'04'                                       2716 13944000
*                    RETURN CODE(LASTCC12);                        2717 13945000
         LA    @15,12                                              2717 13946000
         L     @14,@SA00017                                        2717 13947000
         LM    @00,@12,@SA00017+8                                  2717 13948000
         BR    @14                                                 2717 13949000
*                    END;                                          2718 13950000
*                                                                  2718 13951000
*                /****************************************************/ 13952000
*                /*                                                  */ 13953000
*                /*  CONSTRUCT THE FPL FOR THE NAMEDS FIELD          */ 13954000
*                /*  ITSELF.                                         */ 13955000
*                /*                                                  */ 13956000
*                /****************************************************/ 13957000
*                                                                  2719 13958000
*                CTGFLPTR = BFPLADDR;                              2719 13959000
@RF02713 L     @04,@PC00017+8                                      2719 13960000
         L     @04,BFPLADDR(,@04)                                  2719 13961000
         ST    @04,CTGFLPTR                                        2719 13962000
*                CTGFLDNO = '00000001'B;                           2720 13963000
         MVI   CTGFLDNO(@04),X'01'                                 2720 13964000
*                CTGFLDNM = ADDR(BFLIST(BINDX));                   2721 13965000
*                                                                  2721 13966000
         L     @15,@PC00017+4                                      2721 13967000
         LH    @15,BINDX(,@15)                                     2721 13968000
         SLA   @15,3                                               2721 13969000
         L     @14,@PC00017                                        2721 13970000
         L     @01,BFLISTPT(,@14)                                  2721 13971000
         AL    @01,@CF01806                                        2721 13972000
         LA    @15,BFLIST(@15,@01)                                 2721 13973000
         ST    @15,CTGFLDNM(,@04)                                  2721 13974000
*                /****************************************************/ 13975000
*                /*                                                  */ 13976000
*                /*  SET THE CHAIN FIELD FROM THE NAMEDS             */ 13977000
*                /*  FPL.                                            */ 13978000
*                /*                                                  */ 13979000
*                /****************************************************/ 13980000
*                                                                  2722 13981000
*                CTGFLCHN = BFPLADDR + LENGTH(CTGFL) + 8;          2722 13982000
*                                                                  2722 13983000
         LA    @15,24                                              2722 13984000
         ALR   @15,@04                                             2722 13985000
         ST    @15,CTGFLCHN(,@04)                                  2722 13986000
*                /****************************************************/ 13987000
*                /*                                                  */ 13988000
*                /*  SET THE CTGFLPTR TO POINT TO THE TEST           */ 13989000
*                /*  FPL.                                            */ 13990000
*                /*                                                  */ 13991000
*                /****************************************************/ 13992000
*                                                                  2723 13993000
*                CTGFLPTR = CTGFLCHN;                              2723 13994000
*                                                                  2723 13995000
         ST    @15,CTGFLPTR                                        2723 13996000
*                /****************************************************/ 13997000
*                /*                                                  */ 13998000
*                /*  CONSTRUCT THE TEST FPL ITSELF.                  */ 13999000
*                /*                                                  */ 14000000
*                /****************************************************/ 14001000
*                                                                  2724 14002000
*                CTGFLDNO = '00000001'B;                           2724 14003000
         MVI   CTGFLDNO(@15),X'01'                                 2724 14004000
*                CTGFLDNM = ADDR(CNTREPNO);                        2725 14005000
         LA    @04,CNTREPNO                                        2725 14006000
         ST    @04,CTGFLDNM(,@15)                                  2725 14007000
*                CTGFLDCD = CTGFLDLE;                              2726 14008000
         MVI   CTGFLDCD(@15),X'C0'                                 2726 14009000
*                CTGFLNG(1) = LENGTH(NUMASSOB);                    2727 14010000
         MVC   CTGFLNG(4,@15),@CF00157                             2727 14011000
*                CTGFLPT(1) = ADDR(NUMASSOB);                      2728 14012000
*                                                                  2728 14013000
         LA    @04,@CH00157                                        2728 14014000
         ST    @04,CTGFLPT(,@15)                                   2728 14015000
*                RETURN CODE(0);                                   2729 14016000
*                                                                  2729 14017000
         SLR   @15,@15                                             2729 14018000
         L     @14,@SA00017                                        2729 14019000
         LM    @00,@12,@SA00017+8                                  2729 14020000
         BR    @14                                                 2729 14021000
*                END;                                              2730 14022000
*                                                                  2730 14023000
*              ELSE                                                2731 14024000
*                                                                  2731 14025000
*                DO;                                               2731 14026000
*                                                                  2731 14027000
@RF02707 DS    0H                                                  2732 14028000
*                /****************************************************/ 14029000
*                /*                                                  */ 14030000
*                /*  GET CORE FOR A FPL                              */ 14031000
*                /*  IF CORE IS NOT OBTAINED SUCCESSFULLY, RETURN TO */ 14032000
*                /*  CALLING PROCESSOR.                              */ 14033000
*                /*                                                  */ 14034000
*                /****************************************************/ 14035000
*                                                                  2732 14036000
*                CALL IDCSAGP0 (GDTTBL,(LENGTH(CTGFL)+8),BFPLADDR,GPID, 14037000
*ETZERO);                                                          2732 14038000
         L     @04,@PC00001                                        2732 14039000
         ST    @04,@AL00001                                        2732 14040000
         LA    @15,24                                              2732 14041000
         ST    @15,@AFTEMPS+20                                     2732 14042000
         LA    @15,@AFTEMPS+20                                     2732 14043000
         ST    @15,@AL00001+4                                      2732 14044000
         L     @15,@PC00017+8                                      2732 14045000
         ST    @15,@AL00001+8                                      2732 14046000
         LA    @15,GPID                                            2732 14047000
         ST    @15,@AL00001+12                                     2732 14048000
         LA    @15,SETZERO                                         2732 14049000
         ST    @15,@AL00001+16                                     2732 14050000
         MVI   @AL00001+16,X'80'                                   2732 14051000
         L     @15,GDTGPL(,@04)                                    2732 14052000
         LA    @01,@AL00001                                        2732 14053000
         BALR  @14,@15                                             2732 14054000
*                RESPECIFY RTNREG RSTD;                            2733 14055000
*                TESTRC = RTNREG;                                  2734 14056000
         STH   RTNREG,TESTRC                                       2734 14057000
*                RESPECIFY RTNREG UNRSTD;                          2735 14058000
*                IF TESTRC ^= 0                                    2736 14059000
*                  THEN                                            2736 14060000
         LH    @04,TESTRC                                          2736 14061000
         LTR   @04,@04                                             2736 14062000
         BZ    @RF02736                                            2736 14063000
*                    DO;                                           2737 14064000
*                    DARGSMOD = UNIVMSG;                           2738 14065000
         L     @04,DDSTRU                                          2738 14066000
         MVC   DARGSMOD(3,@04),@CC00981                            2738 14067000
*                    DEFSTID = NOSTORAG;                           2739 14068000
         MVI   DEFSTID,X'04'                                       2739 14069000
*                    RETURN CODE(LASTCC12);                        2740 14070000
         LA    @15,12                                              2740 14071000
         L     @14,@SA00017                                        2740 14072000
         LM    @00,@12,@SA00017+8                                  2740 14073000
         BR    @14                                                 2740 14074000
*                    END;                                          2741 14075000
*                                                                  2741 14076000
*                /****************************************************/ 14077000
*                /*                                                  */ 14078000
*                /*  SET FIELDS IN SKELETON FPL .  RETURN TO CALLING */ 14079000
*                /*  PROCESSOR INDICATING SUCCESS.                   */ 14080000
*                /*                                                  */ 14081000
*                /****************************************************/ 14082000
*                                                                  2742 14083000
*                CTGFLPTR = BFPLADDR;  /*SET FPL BASE                */ 14084000
@RF02736 L     @04,@PC00017+8                                      2742 14085000
         L     @04,BFPLADDR(,@04)                                  2742 14086000
         ST    @04,CTGFLPTR                                        2742 14087000
*                CTGFLDNO = '00000001'B;                           2743 14088000
         MVI   CTGFLDNO(@04),X'01'                                 2743 14089000
*                                      /*NUMBER OF LNG/ADDR PAIRS    */ 14090000
*                CTGFLDNM = ADDR(BFLIST(BINDX));                   2744 14091000
         L     @15,@PC00017+4                                      2744 14092000
         LH    @15,BINDX(,@15)                                     2744 14093000
         SLA   @15,3                                               2744 14094000
         L     @14,@PC00017                                        2744 14095000
         L     @01,BFLISTPT(,@14)                                  2744 14096000
         AL    @01,@CF01806                                        2744 14097000
         LA    @15,BFLIST(@15,@01)                                 2744 14098000
         ST    @15,CTGFLDNM(,@04)                                  2744 14099000
*                                      /*CATALOG FIELD NAME          */ 14100000
*                RETURN CODE(0);                                   2745 14101000
         SLR   @15,@15                                             2745 14102000
         L     @14,@SA00017                                        2745 14103000
         LM    @00,@12,@SA00017+8                                  2745 14104000
         BR    @14                                                 2745 14105000
*                END;                                              2746 14106000
*                                                                  2746 14107000
*        /************************************************************/ 14108000
*        /*                                                          */ 14109000
*        /*  CONSTRUCT A FIELD PARAMETER LIST POINTING TO FIELD      */ 14110000
*        /*  INFORMATION WITHIN THE WORK AREA REFERENCED BY THE      */ 14111000
*        /*  DICTIONARY                                              */ 14112000
*        /*                                                          */ 14113000
*        /************************************************************/ 14114000
*                                                                  2747 14115000
*          ELSE                                                    2747 14116000
*            DO;                                                   2747 14117000
@RF02706 DS    0H                                                  2748 14118000
*            DICTPTR = BDICTPTR;                                   2748 14119000
         L     @04,@PC00017+12                                     2748 14120000
         L     @04,BDICTPTR(,@04)                                  2748 14121000
         ST    @04,DICTPTR                                         2748 14122000
*            IF DICTLN(BINDX) = 0                                  2749 14123000
*              THEN                                                2749 14124000
         SLR   @15,@15                                             2749 14125000
         L     @14,@PC00017+4                                      2749 14126000
         LH    @14,BINDX(,@14)                                     2749 14127000
         SLA   @14,3                                               2749 14128000
         AL    @04,@CF01779                                        2749 14129000
         C     @15,DICTLN-4(@14,@04)                               2749 14130000
         BNE   @RF02749                                            2749 14131000
*                DO;                                               2750 14132000
*                                                                  2750 14133000
*                /****************************************************/ 14134000
*                /*                                                  */ 14135000
*                /*  IF THE DICTIONARY ENTRY INDICATES NOT CATALOG   */ 14136000
*                /*  INFORMATION FOR THIS FIELD, SET FVT POINTER     */ 14137000
*                /*  TO FIELD TO ZERO AND RETURN INDICATING          */ 14138000
*                /*  SUCCESSFUL COMPLETION.                          */ 14139000
*                /*                                                  */ 14140000
*                /****************************************************/ 14141000
*                                                                  2751 14142000
*                BFPLRTN = NULLPTR;                                2751 14143000
         L     @04,@PC00017+20                                     2751 14144000
         ST    @15,BFPLRTN(,@04)                                   2751 14145000
*                RETURN CODE(0);                                   2752 14146000
         L     @14,@SA00017                                        2752 14147000
         LM    @00,@12,@SA00017+8                                  2752 14148000
         BR    @14                                                 2752 14149000
*                END;                                              2753 14150000
*                                                                  2753 14151000
*            /********************************************************/ 14152000
*            /*                                                      */ 14153000
*            /*  CORE FOR FPL HAS ALREADY BEEN OBTAINED.  FILL IN    */ 14154000
*            /*  CATALOG FIELD INFORMATION FROM WORK AREA            */ 14155000
*            /*                                                      */ 14156000
*            /********************************************************/ 14157000
*                                                                  2754 14158000
*            CTGFLPTR = BFPLADDR;      /*SET FPL BASE                */ 14159000
@RF02749 L     @04,@PC00017+8                                      2754 14160000
         L     @15,BFPLADDR(,@04)                                  2754 14161000
         ST    @15,CTGFLPTR                                        2754 14162000
*            BFPLRTN = BFPLADDR;                                   2755 14163000
         L     @14,@PC00017+20                                     2755 14164000
         ST    @15,BFPLRTN(,@14)                                   2755 14165000
*            CTGFLDNO = '00000001'B;   /*SET NUMBER LNG/ADDR PAIRS   */ 14166000
         MVI   CTGFLDNO(@15),X'01'                                 2756 14167000
*            CTGFLDNM = ADDR(BFLIST(BINDX));                       2757 14168000
         L     @14,@PC00017+4                                      2757 14169000
         LH    @14,BINDX(,@14)                                     2757 14170000
         LR    @03,@14                                             2757 14171000
         SLA   @03,3                                               2757 14172000
         L     @02,@PC00017                                        2757 14173000
         L     @01,BFLISTPT(,@02)                                  2757 14174000
         AL    @01,@CF01806                                        2757 14175000
         LA    @03,BFLIST(@03,@01)                                 2757 14176000
         ST    @03,CTGFLDNM(,@15)                                  2757 14177000
*                                      /*SET CATALOG FIELD NAME      */ 14178000
*                                                                  2758 14179000
*            /********************************************************/ 14180000
*            /*                                                      */ 14181000
*            /*  IF CONSTRUCTING AMDSBCAT FPL, THE CATALOG FIELD     */ 14182000
*            /*  INFORMATION AREA IS JUST BEYOND THE FPL AREA.       */ 14183000
*            /*                                                      */ 14184000
*            /********************************************************/ 14185000
*                                                                  2758 14186000
*            IF BINDX = IAMDSB                                     2758 14187000
*              THEN                                                2758 14188000
         C     @14,@CF00966                                        2758 14189000
         BNE   @RF02758                                            2758 14190000
*                DO;                                               2759 14191000
*                CTGFLNG(1) = LENGTH(IDAAMDSB);                    2760 14192000
         LA    @14,96                                              2760 14193000
         ST    @14,CTGFLNG(,@15)                                   2760 14194000
*                                      /*CATALOG DATA LENGTH         */ 14195000
*                BFPLADDR = BFPLADDR + LENGTH(CTGFL) + 8;          2761 14196000
         LA    @03,24                                              2761 14197000
         ALR   @03,@15                                             2761 14198000
         ST    @03,BFPLADDR(,@04)                                  2761 14199000
*                CTGFLPT(1) = BFPLADDR;/*CATALOG DATA ADDRESS        */ 14200000
         ST    @03,CTGFLPT(,@15)                                   2762 14201000
*                BFPLADDR = BFPLADDR + LENGTH(IDAAMDSB);           2763 14202000
         ALR   @03,@14                                             2763 14203000
         ST    @03,BFPLADDR(,@04)                                  2763 14204000
*                END;                                              2764 14205000
*              ELSE                                                2765 14206000
*                /****************************************************/ 14207000
*                /*                                                  */ 14208000
*                /*  FOR A FPL OTHER THAN AMDSBCAT, THE CATALOG FIELD*/ 14209000
*                /*  INFORMATION IS IN THE WORK AREA READ IN FROM THE*/ 14210000
*                /*  PORTABLE DATA SET.                              */ 14211000
*                /*                                                  */ 14212000
*                /****************************************************/ 14213000
*                                                                  2765 14214000
*                DO;                                               2765 14215000
         B     @RC02758                                            2765 14216000
@RF02758 DS    0H                                                  2766 14217000
*                CTGFLNG(1) = DICTLN(BINDX);                       2766 14218000
         L     @04,CTGFLPTR                                        2766 14219000
         L     @15,DICTPTR                                         2766 14220000
         L     @14,@PC00017+4                                      2766 14221000
         LH    @14,BINDX(,@14)                                     2766 14222000
         SLA   @14,3                                               2766 14223000
         LA    @01,0(@14,@15)                                      2766 14224000
         AL    @01,@CF01779                                        2766 14225000
         L     @03,DICTLN-4(,@01)                                  2766 14226000
         ST    @03,CTGFLNG(,@04)                                   2766 14227000
*                                      /*CATALOG DATA LENGTH         */ 14228000
*                CTGFLPT(1) = BWKAPTR + DICTDL(BINDX);             2767 14229000
         L     @03,@PC00017+16                                     2767 14230000
         L     @03,BWKAPTR(,@03)                                   2767 14231000
         AL    @03,DICTDL-8(@14,@15)                               2767 14232000
         ST    @03,CTGFLPT(,@04)                                   2767 14233000
*                                      /*CATALOG DATA ADDRESS        */ 14234000
*                                                                  2768 14235000
*                /****************************************************/ 14236000
*                /*                                                  */ 14237000
*                /*  INCREMENT FPL ADDRESS TO NEXT FPL POSITION      */ 14238000
*                /*                                                  */ 14239000
*                /****************************************************/ 14240000
*                                                                  2768 14241000
*                BFPLADDR = BFPLADDR + LENGTH(CTGFL) +8;           2768 14242000
         L     @04,@PC00017+8                                      2768 14243000
         LA    @15,24                                              2768 14244000
         AL    @15,BFPLADDR(,@04)                                  2768 14245000
         ST    @15,BFPLADDR(,@04)                                  2768 14246000
*                END;                                              2769 14247000
*            END;                                                  2770 14248000
*                                                                  2770 14249000
@RC02758 DS    0H                                                  2771 14250000
*        /************************************************************/ 14251000
*        /*                                                          */ 14252000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 14253000
*        /*                                                          */ 14254000
*        /************************************************************/ 14255000
*                                                                  2771 14256000
*        RETURN CODE(0);                                           2771 14257000
*                                                                  2771 14258000
         SLR   @15,@15                                             2771 14259000
         L     @14,@SA00017                                        2771 14260000
         LM    @00,@12,@SA00017+8                                  2771 14261000
         BR    @14                                                 2771 14262000
*END BFPLPROC;                                                     2772 14263000
*        /************************************************************/ 14264000
*        /*                                                          */ 14265000
*        /*  PROCEDURE NAME - RECPROC                                */ 14266000
*        /*                                                          */ 14267000
*        /*  FUNCTION - COPY THE DATA FROM THE PORTABILITY DATA SET  */ 14268000
*        /*  TO THE VSAM CLUSTER BEING IMPORTED.                     */ 14269000
*        /*  THE VSAM CLUSTER IS OPENED BY OPENPROC,                 */ 14270000
*        /*  THE UCOPY MACRO IS EMPLOYED TO PERFORM THE COPY, THEN   */ 14271000
*        /*  THE CLUSTER DATA SET IS CLOSED THROUGH ISSUANCE OF THE  */ 14272000
*        /*  UCLOSE MACRO.                                           */ 14273000
*        /*                                                          */ 14274000
*        /*  INPUT - NONE                                            */ 14275000
*        /*                                                          */ 14276000
*        /*  OUTPUT - THE VSAM CLUSTER WILL CONTAIN ALL DATA THAT IT */ 14277000
*        /*  CONTAINED PRIOR TO EXPORT.                              */ 14278000
*        /*                                                          */ 14279000
*        /************************************************************/ 14280000
*                                                                  2773 14281000
*RECPROC:  PROCEDURE;                                              2773 14282000
*                                                                  2773 14283000
*                                                                  2773 14284000
RECPROC  STM   @14,@12,@SA00018                                    2773 14285000
*        /************************************************************/ 14286000
*        /*                                                          */ 14287000
*        /*  CALL ALTRPROC TO ALTER THE NAME OF THE DATA SET TO BE   */ 14288000
*        /*  LOADED BY RECPROC TO THE NAME RETURNED BY UIOINFO AS    */ 14289000
*        /*  BEING THE DATA SET NAME GIVEN ON THE DD CARD.           */ 14290000
*        /*                                                          */ 14291000
*        /************************************************************/ 14292000
*                                                                  2774 14293000
*        IF ADDR(OUTDD) ^= NULLPTR                                 2774 14294000
*          THEN                                                    2774 14295000
         L     @04,@PC00001+4                                      2774 14296000
         L     @04,FDTPTR+4(,@04)                                  2774 14297000
         LTR   @04,@04                                             2774 14298000
         BZ    @RF02774                                            2774 14299000
*            DO;                                           /*@OZ17068*/ 14300000
*            CALL ALTRPROC('F');                                   2776 14301000
*                                                                  2776 14302000
         LA    @01,@AL02776                                        2776 14303000
         BAL   @14,ALTRPROC                                        2776 14304000
*        /************************************************************/ 14305000
*        /*                                                          */ 14306000
*        /*  TEST THE RETURN CODE FROM ALTRPROC.  IF IT IS NONZERO,  */ 14307000
*        /*  INDICATE A TERMINAL ERROR, AND RETURN TO THE CALLER.    */ 14308000
*        /*  SET IMPORTRA FAILED MESSAGE FLAG.               @OZ17068*/ 14309000
*        /*                                                          */ 14310000
*        /************************************************************/ 14311000
*                                                                  2777 14312000
*            RESPECIFY RTNREG RSTD;                                2777 14313000
*            TESTRC = RTNREG;                                      2778 14314000
         STH   RTNREG,TESTRC                                       2778 14315000
*            RESPECIFY RTNREG UNRSTD;                      /*@OZ17068*/ 14316000
*            IF TESTRC ^= 0                                /*@OZ17068*/ 14317000
*              THEN                                        /*@OZ17068*/ 14318000
         LH    @04,TESTRC                                          2780 14319000
         LTR   @04,@04                                             2780 14320000
         BZ    @RF02780                                            2780 14321000
*                DO;                                       /*@OZ17068*/ 14322000
*                IMPMFIMF = ON;                            /*@OZ17068*/ 14323000
         OI    IMPMFIMF,B'10000000'                                2782 14324000
*                RETURN CODE(LASTCC12);                    /*@OZ17068*/ 14325000
         LA    @15,12                                              2783 14326000
         L     @14,@SA00018                                        2783 14327000
         LM    @00,@12,@SA00018+8                                  2783 14328000
         BR    @14                                                 2783 14329000
*                END;                                      /*@OZ17068*/ 14330000
*                                                          /*@OZ17068*/ 14331000
*            END;                                          /*@OZ17068*/ 14332000
*                                                                  2785 14333000
@RF02780 DS    0H                                                  2786 14334000
*        /************************************************************/ 14335000
*        /*                                                          */ 14336000
*        /*  CALL OPENPROC TO OPEN THE VSAM CLUSTER FOR INPUT.       */ 14337000
*        /*  IF THE OPEN FAILS, SET THE IMPORTRA FAILED      @OZ17068*/ 14338000
*        /*  MESSAGE FLAG AND TRY TO RENAME THE OBJECT BACK  @OZ17068*/ 14339000
*        /*  TO THE REAL NAME BEFORE RETURNING TO THE CALLER.@OZ17068*/ 14340000
*        /*  IF THE RENAME FAILS THE REMAINING OBJECTS THAT  @OZ17068*/ 14341000
*        /*  REQUIRE THE DUMMY NAME WILL ALSO FAIL. SET THE  @OZ17068*/ 14342000
*        /*  DUMMY NAME MESSAGE FLAG AND RETURN TO CALLER    @OZ17068*/ 14343000
*        /*  WITH TERMINATE RETURN CODE. SET RETURN CODE TO  @OZ17068*/ 14344000
*        /*  CONTINUE TO NEXT OBJECT IF RENAME SUCCESSFUL.   @OZ17068*/ 14345000
*        /*                                                          */ 14346000
*        /************************************************************/ 14347000
*                                                                  2786 14348000
*        IF ADDR(OUTDD) ^= NULLPTR                                 2786 14349000
*          THEN                                                    2786 14350000
@RF02774 L     @04,@PC00001+4                                      2786 14351000
         L     @04,FDTPTR+4(,@04)                                  2786 14352000
         LTR   @04,@04                                             2786 14353000
         BZ    @RF02786                                            2786 14354000
*            CALL OPENPROC('O',ADDR(OUTDDVAL),NULLPARM,0,0,        2787 14355000
*              ADDR(POUTIOCS));                                    2787 14356000
         MVC   @AL00001(20),@AL02787                               2787 14357000
         LA    @04,OUTDDVAL(,@04)                                  2787 14358000
         ST    @04,@AFTEMPS+24                                     2787 14359000
         LA    @04,@AFTEMPS+24                                     2787 14360000
         ST    @04,@AL00001+4                                      2787 14361000
         LA    @04,POUTIOCS                                        2787 14362000
         ST    @04,@AFTEMPS+28                                     2787 14363000
         LA    @04,@AFTEMPS+28                                     2787 14364000
         ST    @04,@AL00001+20                                     2787 14365000
         LA    @01,@AL00001                                        2787 14366000
         BAL   @14,OPENPROC                                        2787 14367000
*          ELSE                                                    2788 14368000
*            CALL OPENPROC('O',ADDR(ALLDDN),NULLPARM,0,0,          2788 14369000
*               ADDR(POUTIOCS));                                   2788 14370000
         B     @RC02786                                            2788 14371000
@RF02786 MVC   @AL00001(20),@AL02788                               2788 14372000
         L     @04,ALLPTR                                          2788 14373000
         LA    @04,ALLDDN(,@04)                                    2788 14374000
         ST    @04,@AFTEMPS+24                                     2788 14375000
         LA    @04,@AFTEMPS+24                                     2788 14376000
         ST    @04,@AL00001+4                                      2788 14377000
         LA    @04,POUTIOCS                                        2788 14378000
         ST    @04,@AFTEMPS+28                                     2788 14379000
         LA    @04,@AFTEMPS+28                                     2788 14380000
         ST    @04,@AL00001+20                                     2788 14381000
         LA    @01,@AL00001                                        2788 14382000
         BAL   @14,OPENPROC                                        2788 14383000
*        RESPECIFY RTNREG RSTD;                                    2789 14384000
@RC02786 DS    0H                                                  2790 14385000
*        TESTRC = RTNREG;                                          2790 14386000
         STH   RTNREG,TESTRC                                       2790 14387000
*        RESPECIFY RTNREG UNRSTD;                                  2791 14388000
*        IF TESTRC ^= 0                                            2792 14389000
*          THEN                                                    2792 14390000
         LH    @04,TESTRC                                          2792 14391000
         SLR   @15,@15                                             2792 14392000
         CR    @04,@15                                             2792 14393000
         BE    @RF02792                                            2792 14394000
*            DO;                                                   2793 14395000
*            IMPMFIMF = ON;                                /*@OZ17068*/ 14396000
         OI    IMPMFIMF,B'10000000'                                2794 14397000
*                                                          /*@OZ17068*/ 14398000
*            IF ADDR(OUTDD) ^= NULLPTR                     /*@OZ17068*/ 14399000
*              THEN                                        /*@OZ17068*/ 14400000
         L     @04,@PC00001+4                                      2795 14401000
         C     @15,FDTPTR+4(,@04)                                  2795 14402000
         BE    @RF02795                                            2795 14403000
*                DO;                                       /*@OZ17068*/ 14404000
*                                                          /*@OZ17068*/ 14405000
*                CALL ALTRPROC('S');                       /*@OZ17068*/ 14406000
         LA    @01,@AL02797                                        2797 14407000
         BAL   @14,ALTRPROC                                        2797 14408000
*                                                          /*@OZ17068*/ 14409000
*                RESPECIFY RTNREG RSTD;                            2798 14410000
*                TESTRC = RTNREG;                                  2799 14411000
         STH   RTNREG,TESTRC                                       2799 14412000
*                RESPECIFY RTNREG UNRSTD;                  /*@OZ17068*/ 14413000
*                IF TESTRC ^= 0                            /*@OZ17068*/ 14414000
*                  THEN                                    /*@OZ17068*/ 14415000
         LH    @04,TESTRC                                          2801 14416000
         LTR   @04,@04                                             2801 14417000
         BZ    @RF02801                                            2801 14418000
*                    DO;                                   /*@OZ17068*/ 14419000
*                    IMPMFDNM = ON;                        /*@OZ17068*/ 14420000
         OI    IMPMFDNM,B'01000000'                                2803 14421000
*                                                          /*@OZ17068*/ 14422000
*                    RETURN CODE(LASTCC12);                /*@OZ17068*/ 14423000
         LA    @15,12                                              2804 14424000
         L     @14,@SA00018                                        2804 14425000
         LM    @00,@12,@SA00018+8                                  2804 14426000
         BR    @14                                                 2804 14427000
*                    END;                                  /*@OZ17068*/ 14428000
*                END;                                      /*@OZ17068*/ 14429000
@RF02801 DS    0H                                                  2807 14430000
*            RETURN CODE(LASTCC08);                        /*@OZ17068*/ 14431000
@RF02795 LA    @15,8                                               2807 14432000
         L     @14,@SA00018                                        2807 14433000
         LM    @00,@12,@SA00018+8                                  2807 14434000
         BR    @14                                                 2807 14435000
*            END;                                                  2808 14436000
*                                                                  2808 14437000
*        /************************************************************/ 14438000
*        /*                                                          */ 14439000
*        /*  COPY DATA BY RECORD FROM THE PORTABILITY DATA SET TO    */ 14440000
*        /*  THE CLUSTER. IF ANY ERRORS ARE ENCOUNTERED,     @OZ17068*/ 14441000
*        /*  SET THE IMPORTRA FAILED MESSAGE FLAG, CLOSE     @OZ17068*/ 14442000
*        /*  THE CLUSTER AND TRY TO RENAME THE CLUSTER BACK  @OZ17068*/ 14443000
*        /*  TO THE REAL NAME. IF THE RENAME FAILS SET THE   @OZ17068*/ 14444000
*        /*  DUMMY NAME MESSAGE FLAG AND RETURN WITH A       @OZ17068*/ 14445000
*        /*  TERMINATE RETURN CODE. IF THE RENAME IS SUCCESS-@OZ17068*/ 14446000
*        /*  FUL SET THE DELETE FLAG AND DETERMINE IF THE    @OZ17068*/ 14447000
*        /*  UCOPY ERROR WAS AN ERROR ON THE PORTABILITY DATA@OZ17068*/ 14448000
*        /*  SET. IF IT WAS, RETURN TO THE CALLER WITH A     @OZ17068*/ 14449000
*        /*  TERMINATE RETURN CODE. IF NOT,RETURN WITH A     @OZ17068*/ 14450000
*        /*  RETURN CODE TO CONTINUE TO THE NEXT OBJECT.     @OZ17068*/ 14451000
*        /*                                                          */ 14452000
*        /************************************************************/ 14453000
*                                                                  2809 14454000
*        CALL IDCIOCO0 (GDTTBL,PINIOCS,POUTIOCS);                  2809 14455000
*                                                                  2809 14456000
@RF02792 L     @04,@PC00001                                        2809 14457000
         ST    @04,@AL00001                                        2809 14458000
         LA    @15,PINIOCS                                         2809 14459000
         ST    @15,@AL00001+4                                      2809 14460000
         LA    @15,POUTIOCS                                        2809 14461000
         ST    @15,@AL00001+8                                      2809 14462000
         MVI   @AL00001+8,X'80'                                    2809 14463000
         L     @15,GDTCPY(,@04)                                    2809 14464000
         LA    @01,@AL00001                                        2809 14465000
         BALR  @14,@15                                             2809 14466000
*        RESPECIFY RTNREG RSTD;                                    2810 14467000
*        TESTRC = RTNREG;                                          2811 14468000
         STH   RTNREG,TESTRC                                       2811 14469000
*        RESPECIFY RTNREG UNRSTD;                                  2812 14470000
*        IF TESTRC ^= 0                                            2813 14471000
*          THEN                                                    2813 14472000
         LH    @04,TESTRC                                          2813 14473000
         LTR   @04,@04                                             2813 14474000
         BZ    @RF02813                                            2813 14475000
*            DO;                                                   2814 14476000
*            IMPMFIMF = ON;                                /*@OZ17068*/ 14477000
         OI    IMPMFIMF,B'10000000'                                2815 14478000
*            CALL IDCIOCL0(GDTTBL,POUTIOCS);                       2816 14479000
         L     @04,@PC00001                                        2816 14480000
         ST    @04,@AL00001                                        2816 14481000
         LA    @15,POUTIOCS                                        2816 14482000
         ST    @15,@AL00001+4                                      2816 14483000
         MVI   @AL00001+4,X'80'                                    2816 14484000
         L     @15,GDTCLS(,@04)                                    2816 14485000
         LA    @01,@AL00001                                        2816 14486000
         BALR  @14,@15                                             2816 14487000
*            POUTIOCS = NULLPTR;                                   2817 14488000
         SLR   @04,@04                                             2817 14489000
         ST    @04,POUTIOCS                                        2817 14490000
*                                                          /*@OZ17068*/ 14491000
*            IF ADDR(OUTDD) ^= NULLPTR                     /*@OZ17068*/ 14492000
*              THEN                                        /*@OZ17068*/ 14493000
         L     @15,@PC00001+4                                      2818 14494000
         C     @04,FDTPTR+4(,@15)                                  2818 14495000
         BE    @RF02818                                            2818 14496000
*                DO;                                       /*@OZ17068*/ 14497000
*                CALL ALTRPROC('S');                       /*@OZ17068*/ 14498000
         LA    @01,@AL02820                                        2820 14499000
         BAL   @14,ALTRPROC                                        2820 14500000
*                RESPECIFY RTNREG RSTD;                            2821 14501000
*                TESTRC = RTNREG;                                  2822 14502000
         STH   RTNREG,TESTRC                                       2822 14503000
*                RESPECIFY RTNREG UNRSTD;                  /*@OZ17068*/ 14504000
*                IF TESTRC ^= 0                            /*@OZ17068*/ 14505000
*                  THEN                                    /*@OZ17068*/ 14506000
         LH    @04,TESTRC                                          2824 14507000
         LTR   @04,@04                                             2824 14508000
         BZ    @RF02824                                            2824 14509000
*                    DO;                                   /*@OZ17068*/ 14510000
*                    IMPMFDNM = ON;                        /*@OZ17068*/ 14511000
         OI    IMPMFDNM,B'01000000'                                2826 14512000
*                    RETURN CODE(LASTCC12);                /*@OZ17068*/ 14513000
         LA    @15,12                                              2827 14514000
         L     @14,@SA00018                                        2827 14515000
         LM    @00,@12,@SA00018+8                                  2827 14516000
         BR    @14                                                 2827 14517000
*                    END;                                  /*@OZ17068*/ 14518000
*                END;                                      /*@OZ17068*/ 14519000
@RF02824 DS    0H                                                  2830 14520000
*              IMPF2DEL = ON;                              /*@OZ17068*/ 14521000
@RF02818 OI    IMPF2DEL,B'01000000'                                2830 14522000
*              IF PINIOCS -> IOCMSGOP = OFF                /*@OZ17068*/ 14523000
*                THEN                                      /*@OZ17068*/ 14524000
         L     @04,PINIOCS                                         2831 14525000
         TM    IOCMSGOP(@04),B'00100000'                           2831 14526000
         BNZ   @RF02831                                            2831 14527000
*                  RETURN CODE(LASTCC12);                  /*@OZ17068*/ 14528000
         LA    @15,12                                              2832 14529000
         L     @14,@SA00018                                        2832 14530000
         LM    @00,@12,@SA00018+8                                  2832 14531000
         BR    @14                                                 2832 14532000
*                ELSE                                      /*@OZ17068*/ 14533000
*                  RETURN CODE(LASTCC08);                  /*@OZ17068*/ 14534000
@RF02831 LA    @15,8                                               2833 14535000
         L     @14,@SA00018                                        2833 14536000
         LM    @00,@12,@SA00018+8                                  2833 14537000
         BR    @14                                                 2833 14538000
*            END;                                                  2834 14539000
*                                                                  2834 14540000
*        /************************************************************/ 14541000
*        /*                                                          */ 14542000
*        /*  CLOSE THE OUTPUT DATA SET (THE VSAM CLUSTER).  IF THE   */ 14543000
*        /*  CLOSE FAILS, SET THE IMPORTRA FAILED MESSAGE    @OZ17068*/ 14544000
*        /*  FLAG AND TRY TO RENAME THE CLUSTER BACK TO THE  @OZ17068*/ 14545000
*        /*  REAL NAME. IF THE RENAME FAILS, SET THE DUMMY   @OZ17068*/ 14546000
*        /*  NAME MESSAGE FLAG AND RETURN TO THE CALLER WITH @OZ17068*/ 14547000
*        /*  A TERMINATE RETURN CODE. IF SUCCESSFUL, SET THE @OZ17068*/ 14548000
*        /*  DELETE FLAG, THE GETEOF BIT AND RETURN TO THE   @OZ17068*/ 14549000
*        /*  CALLER WITH A CONTINUE RETURN CODE.             @OZ17068*/ 14550000
*        /*                                                          */ 14551000
*        /************************************************************/ 14552000
*                                                                  2835 14553000
*        CALL IDCIOCL0 (GDTTBL,POUTIOCS);                          2835 14554000
*                                                                  2835 14555000
@RF02813 L     @04,@PC00001                                        2835 14556000
         ST    @04,@AL00001                                        2835 14557000
         LA    @15,POUTIOCS                                        2835 14558000
         ST    @15,@AL00001+4                                      2835 14559000
         MVI   @AL00001+4,X'80'                                    2835 14560000
         L     @15,GDTCLS(,@04)                                    2835 14561000
         LA    @01,@AL00001                                        2835 14562000
         BALR  @14,@15                                             2835 14563000
*        RESPECIFY RTNREG RSTD;                                    2836 14564000
*        TESTRC = RTNREG;                                          2837 14565000
         STH   RTNREG,TESTRC                                       2837 14566000
*        RESPECIFY RTNREG UNRSTD;                                  2838 14567000
*        POUTIOCS = NULLPTR;                                       2839 14568000
         SLR   @04,@04                                             2839 14569000
         ST    @04,POUTIOCS                                        2839 14570000
*        IF TESTRC ^= 0                                            2840 14571000
*          THEN                                                    2840 14572000
         LH    @15,TESTRC                                          2840 14573000
         CR    @15,@04                                             2840 14574000
         BE    @RF02840                                            2840 14575000
*            DO;                                                   2841 14576000
*            IMPMFIMF = ON;                                /*@OZ17068*/ 14577000
         OI    IMPMFIMF,B'10000000'                                2842 14578000
*            IF ADDR(OUTDD) ^= NULLPTR                     /*@OZ17068*/ 14579000
*              THEN                                        /*@OZ17068*/ 14580000
         L     @15,@PC00001+4                                      2843 14581000
         C     @04,FDTPTR+4(,@15)                                  2843 14582000
         BE    @RF02843                                            2843 14583000
*                DO;                                       /*@OZ17068*/ 14584000
*                CALL ALTRPROC('S');                       /*@OZ17068*/ 14585000
         LA    @01,@AL02845                                        2845 14586000
         BAL   @14,ALTRPROC                                        2845 14587000
*                RESPECIFY RTNREG RSTD;                            2846 14588000
*                TESTRC = RTNREG;                                  2847 14589000
         STH   RTNREG,TESTRC                                       2847 14590000
*                RESPECIFY RTNREG UNRSTD;                  /*@OZ17068*/ 14591000
*                IF TESTRC ^= 0                            /*@OZ17068*/ 14592000
*                  THEN                                    /*@OZ17068*/ 14593000
         LH    @04,TESTRC                                          2849 14594000
         LTR   @04,@04                                             2849 14595000
         BZ    @RF02849                                            2849 14596000
*                    DO;                                   /*@OZ17068*/ 14597000
*                    IMPMFDNM = ON;                        /*@OZ17068*/ 14598000
         OI    IMPMFDNM,B'01000000'                                2851 14599000
*                    RETURN CODE(LASTCC12);                /*@OZ17068*/ 14600000
         LA    @15,12                                              2852 14601000
         L     @14,@SA00018                                        2852 14602000
         LM    @00,@12,@SA00018+8                                  2852 14603000
         BR    @14                                                 2852 14604000
*                    END;                                  /*@OZ17068*/ 14605000
*                END;                                      /*@OZ17068*/ 14606000
@RF02849 DS    0H                                                  2855 14607000
*            IMPF2DEL = ON;                                /*@OZ17068*/ 14608000
@RF02843 OI    IMPF2DEL,B'01000000'                                2855 14609000
*            GETEOF = ON;                                  /*@OZ17068*/ 14610000
         OI    GETEOF,B'10000000'                                  2856 14611000
*            RETURN CODE(LASTCC08);                        /*@OZ17068*/ 14612000
         LA    @15,8                                               2857 14613000
         L     @14,@SA00018                                        2857 14614000
         LM    @00,@12,@SA00018+8                                  2857 14615000
         BR    @14                                                 2857 14616000
*            END;                                                  2858 14617000
*                                                                  2858 14618000
*        /************************************************************/ 14619000
*        /*                                                          */ 14620000
*        /*  CALL ALTRPROC TO ALTER THE NAME OF THE DATA SET JUST    */ 14621000
*        /*  CLOSED BACK TO THE NAME UNDER WHICH IT WAS ORIGINALLY   */ 14622000
*        /*  DEFINED. IF THE ALTER FAILS SET THE IMPORTRA    @OZ17068*/ 14623000
*        /*  FAILED AND DUMMY NAME MESSAGE FLAGS AND RETURN  @OZ17068*/ 14624000
*        /*  TO THE CALLER WITH A TERMINATE RETURN CODE.     @OZ17068*/ 14625000
*        /*                                                          */ 14626000
*        /************************************************************/ 14627000
*                                                                  2859 14628000
*        IF ADDR(OUTDD) ^= NULLPTR                                 2859 14629000
*          THEN                                                    2859 14630000
@RF02840 L     @04,@PC00001+4                                      2859 14631000
         L     @04,FDTPTR+4(,@04)                                  2859 14632000
         LTR   @04,@04                                             2859 14633000
         BZ    @RF02859                                            2859 14634000
*            DO;                                           /*@OZ17068*/ 14635000
*            CALL ALTRPROC('S');                                   2861 14636000
*                                                                  2861 14637000
         LA    @01,@AL02861                                        2861 14638000
         BAL   @14,ALTRPROC                                        2861 14639000
*        /************************************************************/ 14640000
*        /*                                                          */ 14641000
*        /*  TEST THE RETURN CODE FROM ALTRPROC.  IF IT IS NONZERO,  */ 14642000
*        /*  RETURN TO THE CALLING PROCESSOR WITH A TERMINAL ERROR   */ 14643000
*        /*  INDICATED.                                              */ 14644000
*        /*                                                          */ 14645000
*        /************************************************************/ 14646000
*                                                                  2862 14647000
*            RESPECIFY RTNREG RSTD;                                2862 14648000
*            TESTRC = RTNREG;                                      2863 14649000
         STH   RTNREG,TESTRC                                       2863 14650000
*            RESPECIFY RTNREG UNRSTD;                      /*@OZ17068*/ 14651000
*            IF TESTRC ^= 0                                /*@OZ17068*/ 14652000
*              THEN                                        /*@OZ17068*/ 14653000
         LH    @04,TESTRC                                          2865 14654000
         LTR   @04,@04                                             2865 14655000
         BZ    @RF02865                                            2865 14656000
*                DO;                                       /*@OZ17068*/ 14657000
*                IMPMFIMF = ON;                            /*@OZ17068*/ 14658000
*                IMPMFDNM = ON;                            /*@OZ17068*/ 14659000
         OI    IMPMFIMF,B'11000000'                                2868 14660000
*                RETURN CODE(LASTCC12);                    /*@OZ17068*/ 14661000
         LA    @15,12                                              2869 14662000
         L     @14,@SA00018                                        2869 14663000
         LM    @00,@12,@SA00018+8                                  2869 14664000
         BR    @14                                                 2869 14665000
*                END;                                      /*@OZ17068*/ 14666000
*            END;                                          /*@OZ17068*/ 14667000
*                                                                  2871 14668000
@RF02865 DS    0H                                                  2872 14669000
*        /************************************************************/ 14670000
*        /*                                                          */ 14671000
*        /*  RETURN TO THE CALLING PROCESSOR WITH SUCCESSFUL         */ 14672000
*        /*  COMPLETION INDICATED                                    */ 14673000
*        /*                                                          */ 14674000
*        /************************************************************/ 14675000
*                                                                  2872 14676000
*        RETURN CODE(LASTCC00);                                    2872 14677000
@RF02859 SLR   @15,@15                                             2872 14678000
         L     @14,@SA00018                                        2872 14679000
         LM    @00,@12,@SA00018+8                                  2872 14680000
         BR    @14                                                 2872 14681000
*END RECPROC;                                                      2873 14682000
*        /************************************************************/ 14683000
*        /*                                                          */ 14684000
*        /*  PROCEDURE NAME - MVDAPROC                               */ 14685000
*        /*                                                          */ 14686000
*        /*  FUNCTION - MOVES DATA FROM ONE LOCATION IN CORE TO      */ 14687000
*        /*  ANOTHER AS SPECIFIED BY INPUT ARGUMENTS.                */ 14688000
*        /*                                                          */ 14689000
*        /*  INPUT -                                                 */ 14690000
*        /*    .MSIZE - LENGTH OF DATA TO BE MOVED                   */ 14691000
*        /*    .MF1PTR- FROM LOCATION                                */ 14692000
*        /*    .MT1PTR- TO LOCATION                                  */ 14693000
*        /*                                                          */ 14694000
*        /*  OUTPUT - DATA WILL BE MOVED TO LOCATION INDICATED BY    */ 14695000
*        /*  THE "TO" AGRUMENT (MPTR).                               */ 14696000
*        /*                                                          */ 14697000
*        /************************************************************/ 14698000
*                                                                  2874 14699000
*MVDAPROC: PROCEDURE(MSIZE,                                        2874 14700000
*                    MF1PTR,           /*LOCATION TO MOVE FROM       */ 14701000
*                    MT1PTR);          /*LOCATION TO MOVE DATA INTO  */ 14702000
*                                                                  2874 14703000
MVDAPROC STM   @14,@12,12(@13)                                     2874 14704000
         MVC   @PC00019(12),0(@01)                                 2874 14705000
*        /************************************************************/ 14706000
*        /*                                                          */ 14707000
*        /*  ARGUMENTS OF INVOCATION                                 */ 14708000
*        /*                                                          */ 14709000
*        /************************************************************/ 14710000
*                                                                  2875 14711000
*        DCL MSIZE    FIXED(15),                                   2875 14712000
*            MF1PTR   PTR(31),                                     2875 14713000
*            MT1PTR   PTR(31);                                     2875 14714000
*                                                                  2875 14715000
*        /************************************************************/ 14716000
*        /*                                                          */ 14717000
*        /*  LOCAL DECLARATIONS                                      */ 14718000
*        /*                                                          */ 14719000
*        /************************************************************/ 14720000
*                                                                  2876 14721000
*        DCL MFPTR PTR(31);            /*WORKING SOURCE PTR          */ 14722000
*        DCL MTPTR PTR(31);            /*WORKING TARGET PTR          */ 14723000
*        DCL FROMAREA CHAR(*) BASED(MFPTR);                        2878 14724000
*        DCL TOAREA   CHAR(*) BASED(MTPTR);                        2879 14725000
*        DCL M1SIZE FIXED(15);                                     2880 14726000
*        DCL DOCNTRL  BIT(1);                                      2881 14727000
*                                                                  2881 14728000
*        /************************************************************/ 14729000
*        /*                                                          */ 14730000
*        /*  LOOP MOVING 256 BYTES AT A TIME                         */ 14731000
*        /*                                                          */ 14732000
*        /************************************************************/ 14733000
*                                                                  2882 14734000
*        MFPTR = MF1PTR;                                           2882 14735000
         L     @04,@PC00019+4                                      2882 14736000
         L     @04,MF1PTR(,@04)                                    2882 14737000
         ST    @04,MFPTR                                           2882 14738000
*        MTPTR = MT1PTR;                                           2883 14739000
         L     @04,@PC00019+8                                      2883 14740000
         L     @04,MT1PTR(,@04)                                    2883 14741000
         ST    @04,MTPTR                                           2883 14742000
*        M1SIZE = MSIZE;                                           2884 14743000
         L     @04,@PC00019                                        2884 14744000
         LH    @04,MSIZE(,@04)                                     2884 14745000
         STH   @04,M1SIZE                                          2884 14746000
*        DOCNTRL = ON;                                             2885 14747000
         OI    DOCNTRL,B'10000000'                                 2885 14748000
*        DO WHILE (DOCNTRL = ON);                                  2886 14749000
*                                                                  2886 14750000
         B     @DE02886                                            2886 14751000
@DL02886 DS    0H                                                  2887 14752000
*          /**********************************************************/ 14753000
*          /*                                                        */ 14754000
*          /*  CHECK FOR MORE THAN 256 BYTES TO MOVE                 */ 14755000
*          /*                                                        */ 14756000
*          /**********************************************************/ 14757000
*                                                                  2887 14758000
*          IF M1SIZE > 256                                         2887 14759000
*            THEN                                                  2887 14760000
         LH    @04,M1SIZE                                          2887 14761000
         LA    @15,256                                             2887 14762000
         CR    @04,@15                                             2887 14763000
         BNH   @RF02887                                            2887 14764000
*              DO;                                                 2888 14765000
*              /******************************************************/ 14766000
*              /*                                                    */ 14767000
*              /*  MOVE 256 BYTES AT A TIME AND UPDATE SIZE AND      */ 14768000
*              /*  POINTER VARIABLES FOR NEXT ITERATION              */ 14769000
*              /*                                                    */ 14770000
*              /******************************************************/ 14771000
*                                                                  2889 14772000
*              TOAREA(1:256) = FROMAREA(1:256);                    2889 14773000
         L     @14,MTPTR                                           2889 14774000
         L     @03,MFPTR                                           2889 14775000
         MVC   TOAREA(256,@14),FROMAREA(@03)                       2889 14776000
*              M1SIZE = M1SIZE - 256;                              2890 14777000
         SLR   @04,@15                                             2890 14778000
         STH   @04,M1SIZE                                          2890 14779000
*              MTPTR = MTPTR +256;                                 2891 14780000
         ALR   @14,@15                                             2891 14781000
         ST    @14,MTPTR                                           2891 14782000
*              MFPTR = MFPTR + 256;                                2892 14783000
         ALR   @03,@15                                             2892 14784000
         ST    @03,MFPTR                                           2892 14785000
*              END;                                                2893 14786000
*                                                                  2893 14787000
*            ELSE                                                  2894 14788000
*              DO;                                                 2894 14789000
         B     @RC02887                                            2894 14790000
@RF02887 DS    0H                                                  2895 14791000
*              /******************************************************/ 14792000
*              /*                                                    */ 14793000
*              /*  MOVE NUMBER OF BYTES INDICATED BY MSIZE AND RETURN*/ 14794000
*              /*                                                    */ 14795000
*              /******************************************************/ 14796000
*                                                                  2895 14797000
*              TOAREA(1:M1SIZE) = FROMAREA(1:M1SIZE);              2895 14798000
         L     @04,MTPTR                                           2895 14799000
         LH    @15,M1SIZE                                          2895 14800000
         BCTR  @15,0                                               2895 14801000
         L     @01,MFPTR                                           2895 14802000
         EX    @15,@SM01807                                        2895 14803000
*              DOCNTRL = OFF;                                      2896 14804000
         NI    DOCNTRL,B'01111111'                                 2896 14805000
*              END;                                                2897 14806000
*          END;                                                    2898 14807000
*                                                                  2898 14808000
@RC02887 DS    0H                                                  2898 14809000
@DE02886 TM    DOCNTRL,B'10000000'                                 2898 14810000
         BO    @DL02886                                            2898 14811000
*        /************************************************************/ 14812000
*        /*                                                          */ 14813000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 14814000
*        /*                                                          */ 14815000
*        /************************************************************/ 14816000
*                                                                  2899 14817000
*        RETURN CODE(0);                                           2899 14818000
         SLR   @15,@15                                             2899 14819000
         L     @14,12(,@13)                                        2899 14820000
         LM    @00,@12,20(@13)                                     2899 14821000
         BR    @14                                                 2899 14822000
*END MVDAPROC;                                                     2900 14823000
*        /************************************************************/ 14824000
*        /*                                                          */ 14825000
*        /*  PROCEDURE NAME - FVTPROC                                */ 14826000
*        /*                                                          */ 14827000
*        /*  FUNCTION - CONSTRUCT FVT AND FPL'S FROM INFORMATION     */ 14828000
*        /*  IN THE DICTIONARY PASSED AS AN ARGUMENT TO THIS         */ 14829000
*        /*  PROCEDURE.  FPL'S WILL POINT TO THE CATALOG FIELD       */ 14830000
*        /*  INFORMATION WITHIN THE WORK AREA.                       */ 14831000
*        /*                                                          */ 14832000
*        /*  INPUT -                                                 */ 14833000
*        /*    .FDICT - POINTER TO DICTIONARY WHICH REFERENCES       */ 14834000
*        /*      CATALOG FIELD INFORMATION WITH WORK AREA            */ 14835000
*        /*    .FWKA - WORK AREA CONTAINING CATALOG FIELD INFORMATION*/ 14836000
*        /*    .FPTRFVT - RETURN CELL FOR FVT POINTER                */ 14837000
*        /*                                                          */ 14838000
*        /*  OUTPUT - POINTER TO FVT CONSTRUCTED.  THIS FVT WILL     */ 14839000
*        /*  REFERENCE ALL FPL'S CONSTRUCTED BY THIS PROCEDURE       */ 14840000
*        /*                                                          */ 14841000
*        /************************************************************/ 14842000
*                                                                  2901 14843000
*FVTPROC: PROCEDURE(FDICT,             /*DICTIONARY POINTER          */ 14844000
*                  FWKA,     /*WORK AREA POINTER                     */ 14845000
*                  FPTRFVT); /*RETURN CELL FOR FVT POINTER           */ 14846000
*                                                                  2901 14847000
FVTPROC  STM   @14,@12,@SA00020                                    2901 14848000
         MVC   @PC00020(12),0(@01)                                 2901 14849000
*        /************************************************************/ 14850000
*        /*                                                          */ 14851000
*        /*  ARGUMENTS OF INVOCATION                                 */ 14852000
*        /*                                                          */ 14853000
*        /************************************************************/ 14854000
*                                                                  2902 14855000
*        DCL FDICT    PTR(31),                                     2902 14856000
*            FWKA     PTR(31),                                     2902 14857000
*            FPTRFVT  PTR(31);                                     2902 14858000
*                                                                  2902 14859000
*        /************************************************************/ 14860000
*        /*                                                          */ 14861000
*        /*  LOCAL DECLARATIONS                                      */ 14862000
*        /*                                                          */ 14863000
*        /************************************************************/ 14864000
*                                                                  2903 14865000
*        DCL FPLADDR  PTR(31);                                     2903 14866000
*        DCL FPLNUM  FIXED(15) CONSTANT(12); /*NUMBER OF FPL'S BUILT */ 14867000
*                                       /*BY THIS PROCEDURE          */ 14868000
*        /* FIELDPTR USED TO POINT TO ENTRY TYPE OR SECFLAGS @Z40RSSA*/ 14869000
*        /* IN THE DICTIONARY WORK AREA                      @Z40RSSA*/ 14870000
*        DCL   FIELDPTR PTR(31);                                   2905 14871000
*        /************************************************************/ 14872000
*        /*                                                          */ 14873000
*        /*  GET CORE FOR THE FVT AND THE TOTAL NUMBER OF FPL'S      */ 14874000
*        /*  THAT CAN BE CONSTRUCTED BY THIS PROCEDURE               */ 14875000
*        /*                                                          */ 14876000
*        /************************************************************/ 14877000
*                                                                  2906 14878000
*        OLDERID2 = NEWERID2;                                      2906 14879000
         L     @04,@PC00001                                        2906 14880000
         L     @15,GDTTR2(,@04)                                    2906 14881000
         MVC   @TS00001(95),NEWERID2(@15)                          2906 14882000
         MVC   OLDERID2(95,@15),@TS00001                           2906 14883000
*        NEWID2 = 'RMFV';                                          2907 14884000
         MVC   NEWID2(4,@15),@CC01709                              2907 14885000
*        RESPECIFY CTGFV BASED(FPTRFVT);                           2908 14886000
*        TOTLEN =2*(LENGTH(CTGFV) + (LENGTH(CTGFL)+8) * FPLNUM     2909 14887000
*          + LENGTH(IDAAMDSB));                                    2909 14888000
*                                                                  2909 14889000
         MVC   TOTLEN(4),@CF01762                                  2909 14890000
*        CALL IDCSAGP0 (GDTTBL,TOTLEN,FPTRFVT,GPID,SETZERO);       2910 14891000
*                                                                  2910 14892000
         ST    @04,@AL00001                                        2910 14893000
         LA    @15,TOTLEN                                          2910 14894000
         ST    @15,@AL00001+4                                      2910 14895000
         L     @15,@PC00020+8                                      2910 14896000
         ST    @15,@AL00001+8                                      2910 14897000
         LA    @15,GPID                                            2910 14898000
         ST    @15,@AL00001+12                                     2910 14899000
         LA    @15,SETZERO                                         2910 14900000
         ST    @15,@AL00001+16                                     2910 14901000
         MVI   @AL00001+16,X'80'                                   2910 14902000
         L     @15,GDTGPL(,@04)                                    2910 14903000
         LA    @01,@AL00001                                        2910 14904000
         BALR  @14,@15                                             2910 14905000
*        RESPECIFY RTNREG RSTD;                                    2911 14906000
*        TESTRC = RTNREG;                                          2912 14907000
         STH   RTNREG,TESTRC                                       2912 14908000
*        RESPECIFY RTNREG UNRSTD;                                  2913 14909000
*        IF TESTRC ^= 0                                            2914 14910000
*          THEN                                                    2914 14911000
*                                                                  2914 14912000
         LH    @04,TESTRC                                          2914 14913000
         LTR   @04,@04                                             2914 14914000
         BZ    @RF02914                                            2914 14915000
*            /********************************************************/ 14916000
*            /*                                                      */ 14917000
*            /*  IF CORE IS NOT OBTAINED SUCCESSFULLY, RETURN TO     */ 14918000
*            /*  CALLING PROCESSOR WITH FAILURE INDICATED            */ 14919000
*            /*                                                      */ 14920000
*            /********************************************************/ 14921000
*                                                                  2915 14922000
*            DO;                                                   2915 14923000
*            DEFSTID = NOSTORAG;                                   2916 14924000
         MVI   DEFSTID,X'04'                                       2916 14925000
*            RETURN CODE(LASTCC12);                                2917 14926000
         LA    @15,12                                              2917 14927000
         L     @14,@SA00020                                        2917 14928000
         LM    @00,@12,@SA00020+8                                  2917 14929000
         BR    @14                                                 2917 14930000
*            END;                                                  2918 14931000
*                                                                  2918 14932000
*        DICTPTR = FDICT;                                          2919 14933000
@RF02914 L     @04,@PC00020                                        2919 14934000
         L     @04,FDICT(,@04)                                     2919 14935000
         ST    @04,DICTPTR                                         2919 14936000
*        FPLADDR = FPTRFVT + LENGTH(CTGFV);                        2920 14937000
*                                                                  2920 14938000
         L     @15,@PC00020+8                                      2920 14939000
         L     @15,FPTRFVT(,@15)                                   2920 14940000
         LA    @14,92                                              2920 14941000
         ALR   @14,@15                                             2920 14942000
         ST    @14,FPLADDR                                         2920 14943000
*        /************************************************************/ 14944000
*        /*                                                          */ 14945000
*        /*  SET TYPE FIELD IN FVT FROM CATALOG FIELD INFORMATION    */ 14946000
*        /*                                                          */ 14947000
*        /************************************************************/ 14948000
*                                                                  2921 14949000
*        FIELDPTR = DICTDL(IENTYPE) + FWKA;                        2921 14950000
         L     @14,@PC00020+4                                      2921 14951000
         L     @14,FWKA(,@14)                                      2921 14952000
         L     @03,DICTDL(,@04)                                    2921 14953000
         ALR   @03,@14                                             2921 14954000
         ST    @03,FIELDPTR                                        2921 14955000
*        CTGFVTYP = FIELDPTR -> FENTYPE;                           2922 14956000
         MVC   CTGFVTYP(1,@15),FENTYPE(@03)                        2922 14957000
*        /*                                                  @Z40RSSA*/ 14958000
*        /* SET CTGFVRON TO VALUE OF IMPORTED RAC INDICATOR  @Z40RSSA*/ 14959000
*        /*                                                  @Z40RSSA*/ 14960000
*                                                                  2923 14961000
*        IF DICTLN(ISECFLG) ^= NULLPTR THEN                        2923 14962000
         L     @03,DICTLN+248(,@04)                                2923 14963000
         LTR   @03,@03                                             2923 14964000
         BZ    @RF02923                                            2923 14965000
*          DO;                                             /*@Z40RSSA*/ 14966000
*            FIELDPTR = DICTDL(ISECFLG) + FWKA;            /*@Z40RSSA*/ 14967000
         AL    @14,DICTDL+248(,@04)                                2925 14968000
         ST    @14,FIELDPTR                                        2925 14969000
*            IF FIELDPTR -> RCDEXSEC = ON THEN                     2926 14970000
         TM    RCDEXSEC(@14),B'10000000'                           2926 14971000
         BNO   @RF02926                                            2926 14972000
*              CTGFVRON = ON;                              /*@Z40RSSA*/ 14973000
         OI    CTGFVRON(@15),B'00001000'                           2927 14974000
*          END;                                            /*@Z40RSSA*/ 14975000
*                                                                  2928 14976000
@RF02926 DS    0H                                                  2929 14977000
*        /************************************************************/ 14978000
*        /*                                                          */ 14979000
*        /*  SET ENTNAME FIELD POINTER IN FPL                        */ 14980000
*        /*                                                          */ 14981000
*        /************************************************************/ 14982000
*                                                                  2929 14983000
*        IF DICTLN(IENTNAME) ^= NULLPTR                            2929 14984000
*          THEN                                                    2929 14985000
@RF02923 L     @04,DICTPTR                                         2929 14986000
         L     @15,DICTLN+8(,@04)                                  2929 14987000
         LTR   @15,@15                                             2929 14988000
         BZ    @RF02929                                            2929 14989000
*            CTGFVENT = DICTDL(IENTNAME) + FWKA;                   2930 14990000
*                                                                  2930 14991000
         L     @15,@PC00020+8                                      2930 14992000
         L     @01,FPTRFVT(,@15)                                   2930 14993000
         L     @15,@PC00020+4                                      2930 14994000
         L     @04,DICTDL+8(,@04)                                  2930 14995000
         AL    @04,FWKA(,@15)                                      2930 14996000
         ST    @04,CTGFVENT(,@01)                                  2930 14997000
*        /************************************************************/ 14998000
*        /*                                                          */ 14999000
*        /*  TEST TO DETERMINE IF WE ARE BUILDING AN FVT             */ 15000000
*        /*  FOR AN AIX OR A PATH                                    */ 15001000
*        /*                                                          */ 15002000
*        /************************************************************/ 15003000
*                                                                  2931 15004000
*        IF CTGFVTYP = CTGTAIX | CTGFVTYP = CTGTPTH                2931 15005000
*          THEN                                                    2931 15006000
*                                                                  2931 15007000
@RF02929 L     @04,@PC00020+8                                      2931 15008000
         L     @04,FPTRFVT(,@04)                                   2931 15009000
         CLI   CTGFVTYP(@04),C'G'                                  2931 15010000
         BE    @RT02931                                            2931 15011000
         CLI   CTGFVTYP(@04),C'R'                                  2931 15012000
         BNE   @RF02931                                            2931 15013000
@RT02931 DS    0H                                                  2932 15014000
*            /********************************************************/ 15015000
*            /*                                                      */ 15016000
*            /*  BUILD AN FPL FOR RGATTR                             */ 15017000
*            /*                                                      */ 15018000
*            /********************************************************/ 15019000
*                                                                  2932 15020000
*            DO;                                                   2932 15021000
*            CALL BFPLPROC(ADDR(FIELDLST),IRGATTR,FPLADDR,         2933 15022000
*               FDICT,FWKA,CTGFVUPG);                              2933 15023000
*                                                                  2933 15024000
         LA    @04,FIELDLST                                        2933 15025000
         ST    @04,@AFTEMPS+32                                     2933 15026000
         LA    @04,@AFTEMPS+32                                     2933 15027000
         ST    @04,@AL00001                                        2933 15028000
         LA    @04,@CH01060                                        2933 15029000
         ST    @04,@AL00001+4                                      2933 15030000
         LA    @04,FPLADDR                                         2933 15031000
         ST    @04,@AL00001+8                                      2933 15032000
         L     @04,@PC00020                                        2933 15033000
         ST    @04,@AL00001+12                                     2933 15034000
         L     @04,@PC00020+4                                      2933 15035000
         ST    @04,@AL00001+16                                     2933 15036000
         L     @04,@PC00020+8                                      2933 15037000
         L     @04,FPTRFVT(,@04)                                   2933 15038000
         LA    @04,CTGFVUPG(,@04)                                  2933 15039000
         ST    @04,@AL00001+20                                     2933 15040000
         LA    @01,@AL00001                                        2933 15041000
         BAL   @14,BFPLPROC                                        2933 15042000
*            /********************************************************/ 15043000
*            /*                                                      */ 15044000
*            /*  DETERMINE IF AN FVT FOR AN AIX IS BEING             */ 15045000
*            /*  BUILT.  IF SO, SET RELATED NAME VALUE.              */ 15046000
*            /*                                                      */ 15047000
*            /********************************************************/ 15048000
*                                                                  2934 15049000
*            IF CTGFVTYP = CTGTAIX                                 2934 15050000
*              THEN                                                2934 15051000
         L     @04,@PC00020+8                                      2934 15052000
         L     @04,FPTRFVT(,@04)                                   2934 15053000
         CLI   CTGFVTYP(@04),C'G'                                  2934 15054000
         BNE   @RF02934                                            2934 15055000
*                CTGFVNAM = DICTDL(IRELNAM) + FWKA;                2935 15056000
         L     @15,@PC00020+4                                      2935 15057000
         L     @01,DICTPTR                                         2935 15058000
         L     @14,DICTDL+232(,@01)                                2935 15059000
         AL    @14,FWKA(,@15)                                      2935 15060000
         ST    @14,CTGFVNAM(,@04)                                  2935 15061000
*              ELSE                                                2936 15062000
*                                                                  2936 15063000
*                /****************************************************/ 15064000
*                /*                                                  */ 15065000
*                /*  OTHERWISE WE ARE CONSTRUCTING A PATH            */ 15066000
*                /*  FVT.  PLACE THE APPROPRIATE PATHENTRY           */ 15067000
*                /*  NAME AND PASSWORD IN THE FVT.                   */ 15068000
*                /*                                                  */ 15069000
*                /****************************************************/ 15070000
*                                                                  2936 15071000
*                DO;                                               2936 15072000
         B     @RC02934                                            2936 15073000
@RF02934 DS    0H                                                  2937 15074000
*                CTGFVNAM = FVTPTR(1) -> CTGFVENT;                 2937 15075000
         L     @04,@PC00020+8                                      2937 15076000
         L     @04,FPTRFVT(,@04)                                   2937 15077000
         L     @01,FVTPTR                                          2937 15078000
         L     @15,CTGFVENT(,@01)                                  2937 15079000
         ST    @15,CTGFVNAM(,@04)                                  2937 15080000
*                IF DICTDL(IPTHPASS) ^= 0                          2938 15081000
*                  THEN                                            2938 15082000
         L     @01,DICTPTR                                         2938 15083000
         L     @15,DICTDL+240(,@01)                                2938 15084000
         LTR   @15,@15                                             2938 15085000
         BZ    @RF02938                                            2938 15086000
*                    CTGFVPWD = DICTDL(IPTHPASS) + FWKA;           2939 15087000
         L     @14,@PC00020+4                                      2939 15088000
         AL    @15,FWKA(,@14)                                      2939 15089000
         ST    @15,CTGFVPWD(,@04)                                  2939 15090000
*                END;                                              2940 15091000
*                                                                  2940 15092000
@RF02938 DS    0H                                                  2941 15093000
*            END;                                                  2941 15094000
*                                                                  2941 15095000
@RC02934 DS    0H                                                  2942 15096000
*        /************************************************************/ 15097000
*        /*                                                          */ 15098000
*        /*  CONSTRUCT PASSWALL FPL WHICH REFERENCES THE PASSWORD    */ 15099000
*        /*  CATALOG FIELD, PLACE POINTER TO FPL IN FVT              */ 15100000
*        /*  IF THE PASSWALL FIELD IS NOT CONSTRUCTED                */ 15101000
*        /*  SUCCESSFULLY, RETURN TO THE CALLING                     */ 15102000
*        /*  PROCESSOR WITH FAILURE INDICATED.                       */ 15103000
*        /*                                                          */ 15104000
*        /************************************************************/ 15105000
*                                                                  2942 15106000
*        CTGFVSTY = FPLADDR;                                       2942 15107000
@RF02931 L     @04,@PC00020+8                                      2942 15108000
         L     @04,FPTRFVT(,@04)                                   2942 15109000
         L     @15,FPLADDR                                         2942 15110000
         ST    @15,CTGFVSTY(,@04)                                  2942 15111000
*        CALL BPASPROC(FPLADDR,FDICT,FWKA);                        2943 15112000
         LA    @04,FPLADDR                                         2943 15113000
         ST    @04,@AL00001                                        2943 15114000
         L     @04,@PC00020                                        2943 15115000
         ST    @04,@AL00001+4                                      2943 15116000
         L     @04,@PC00020+4                                      2943 15117000
         ST    @04,@AL00001+8                                      2943 15118000
         LA    @01,@AL00001                                        2943 15119000
         BAL   @14,BPASPROC                                        2943 15120000
*        RESPECIFY RTNREG RSTD;                                    2944 15121000
*        TESTRC = RTNREG;                                          2945 15122000
         STH   RTNREG,TESTRC                                       2945 15123000
*        RESPECIFY RTNREG UNRSTD;                                  2946 15124000
*        IF TESTRC ^= 0                                            2947 15125000
*          THEN                                                    2947 15126000
         LH    @04,TESTRC                                          2947 15127000
         SLR   @15,@15                                             2947 15128000
         CR    @04,@15                                             2947 15129000
         BE    @RF02947                                            2947 15130000
*            DO;                                                   2948 15131000
*            IF TESTRC = 4                                         2949 15132000
*              THEN                                                2949 15133000
         C     @04,@CF00046                                        2949 15134000
         BNE   @RF02949                                            2949 15135000
*                CTGFVSTY = NULLPTR;                               2950 15136000
         L     @04,@PC00020+8                                      2950 15137000
         L     @04,FPTRFVT(,@04)                                   2950 15138000
         ST    @15,CTGFVSTY(,@04)                                  2950 15139000
*              ELSE                                                2951 15140000
*                RETURN CODE(LASTCC12);                            2951 15141000
         B     @RC02949                                            2951 15142000
@RF02949 LA    @15,12                                              2951 15143000
         L     @14,@SA00020                                        2951 15144000
         LM    @00,@12,@SA00020+8                                  2951 15145000
         BR    @14                                                 2951 15146000
*            END;                                                  2952 15147000
*                                                                  2952 15148000
@RC02949 DS    0H                                                  2953 15149000
*        /************************************************************/ 15150000
*        /*                                                          */ 15151000
*        /*  CONSTRUCT OWNERID FPL WHICH REFERENCES THE OWNER OF     */ 15152000
*        /*  DATA SET CATALOG FIELD, PLACE POINTER TO FPL IN FVT     */ 15153000
*        /*                                                          */ 15154000
*        /************************************************************/ 15155000
*                                                                  2953 15156000
*        CALL BFPLPROC(ADDR(FIELDLST),IOWNERID,                    2953 15157000
*            FPLADDR,FDICT,FWKA,CTGFVOWN);                         2953 15158000
*                                                                  2953 15159000
@RF02947 LA    @04,FIELDLST                                        2953 15160000
         ST    @04,@AFTEMPS+32                                     2953 15161000
         LA    @04,@AFTEMPS+32                                     2953 15162000
         ST    @04,@AL00001                                        2953 15163000
         LA    @04,@CH00046                                        2953 15164000
         ST    @04,@AL00001+4                                      2953 15165000
         LA    @04,FPLADDR                                         2953 15166000
         ST    @04,@AL00001+8                                      2953 15167000
         L     @04,@PC00020                                        2953 15168000
         ST    @04,@AL00001+12                                     2953 15169000
         L     @04,@PC00020+4                                      2953 15170000
         ST    @04,@AL00001+16                                     2953 15171000
         L     @04,@PC00020+8                                      2953 15172000
         L     @04,FPTRFVT(,@04)                                   2953 15173000
         LA    @04,CTGFVOWN(,@04)                                  2953 15174000
         ST    @04,@AL00001+20                                     2953 15175000
         LA    @01,@AL00001                                        2953 15176000
         BAL   @14,BFPLPROC                                        2953 15177000
*        /************************************************************/ 15178000
*        /*                                                          */ 15179000
*        /*  CONSTRUCT DSETEXDT FPL WHICH REFERENCES                 */ 15180000
*        /*  THE EXPIRATION DATE CATALOG FIELD, PLACE                */ 15181000
*        /*  POINTER IN FVT                                          */ 15182000
*        /*                                                          */ 15183000
*        /************************************************************/ 15184000
*                                                                  2954 15185000
*        CALL BFPLPROC(ADDR(FIELDLST),IDSETEXD,                    2954 15186000
*           FPLADDR,FDICT,FWKA,CTGFVEXP);                          2954 15187000
*                                                                  2954 15188000
         LA    @04,FIELDLST                                        2954 15189000
         ST    @04,@AFTEMPS+32                                     2954 15190000
         LA    @04,@AFTEMPS+32                                     2954 15191000
         ST    @04,@AL00001                                        2954 15192000
         LA    @04,@CH00041                                        2954 15193000
         ST    @04,@AL00001+4                                      2954 15194000
         LA    @04,FPLADDR                                         2954 15195000
         ST    @04,@AL00001+8                                      2954 15196000
         L     @04,@PC00020                                        2954 15197000
         ST    @04,@AL00001+12                                     2954 15198000
         L     @04,@PC00020+4                                      2954 15199000
         ST    @04,@AL00001+16                                     2954 15200000
         L     @04,@PC00020+8                                      2954 15201000
         L     @04,FPTRFVT(,@04)                                   2954 15202000
         LA    @04,CTGFVEXP(,@04)                                  2954 15203000
         ST    @04,@AL00001+20                                     2954 15204000
         LA    @01,@AL00001                                        2954 15205000
         BAL   @14,BFPLPROC                                        2954 15206000
*        /************************************************************/ 15207000
*        /*                                                          */ 15208000
*        /*  CONSTRUCT DSETCRDT FPL WHICH REFERENCES THE             */ 15209000
*        /*  CREATION DATE CATALOG FIELD, PLACE                      */ 15210000
*        /*                                                          */ 15211000
*        /************************************************************/ 15212000
*                                                                  2955 15213000
*        CALL BFPLPROC(ADDR(FIELDLST),IDSETCRD,                    2955 15214000
*           FPLADDR,FDICT,FWKA,CTGFVCRE);                          2955 15215000
*                                                                  2955 15216000
         LA    @04,FIELDLST                                        2955 15217000
         ST    @04,@AFTEMPS+32                                     2955 15218000
         LA    @04,@AFTEMPS+32                                     2955 15219000
         ST    @04,@AL00001                                        2955 15220000
         LA    @04,@CH00288                                        2955 15221000
         ST    @04,@AL00001+4                                      2955 15222000
         LA    @04,FPLADDR                                         2955 15223000
         ST    @04,@AL00001+8                                      2955 15224000
         L     @04,@PC00020                                        2955 15225000
         ST    @04,@AL00001+12                                     2955 15226000
         L     @04,@PC00020+4                                      2955 15227000
         ST    @04,@AL00001+16                                     2955 15228000
         L     @04,@PC00020+8                                      2955 15229000
         L     @04,FPTRFVT(,@04)                                   2955 15230000
         LA    @04,CTGFVCRE(,@04)                                  2955 15231000
         ST    @04,@AL00001+20                                     2955 15232000
         LA    @01,@AL00001                                        2955 15233000
         BAL   @14,BFPLPROC                                        2955 15234000
*        /************************************************************/ 15235000
*        /*                                                          */ 15236000
*        /*  IF THE TYPE IS PATH, OMIT BUILDING THE REST OF          */ 15237000
*        /*  THE FPL'S.                                              */ 15238000
*        /*                                                          */ 15239000
*        /************************************************************/ 15240000
*                                                                  2956 15241000
*        IF CTGFVTYP ^= CTGTPTH                                    2956 15242000
*          THEN                                                    2956 15243000
         L     @04,@PC00020+8                                      2956 15244000
         L     @04,FPTRFVT(,@04)                                   2956 15245000
         CLI   CTGFVTYP(@04),C'R'                                  2956 15246000
         BE    @RF02956                                            2956 15247000
*NOPTH:      DO;                                                   2957 15248000
*                                                                  2957 15249000
NOPTH    DS    0H                                                  2958 15250000
*        /************************************************************/ 15251000
*        /*                                                          */ 15252000
*        /*  CONSTRUCT SPACPARM FPL WHICH REFERENCES THE SPACE       */ 15253000
*        /*  ALLOCATION CATALOG FIELD, PLACE FVT POINTER IN FPL      */ 15254000
*        /*                                                          */ 15255000
*        /************************************************************/ 15256000
*                                                                  2958 15257000
*            CALL BFPLPROC(ADDR(FIELDLST),ISPACPAR,                2958 15258000
*                FPLADDR,FDICT,FWKA,CTGFVSPC);                     2958 15259000
*                                                                  2958 15260000
         LA    @04,FIELDLST                                        2958 15261000
         ST    @04,@AFTEMPS+32                                     2958 15262000
         LA    @04,@AFTEMPS+32                                     2958 15263000
         ST    @04,@AL00001                                        2958 15264000
         LA    @04,@CH00038                                        2958 15265000
         ST    @04,@AL00001+4                                      2958 15266000
         LA    @04,FPLADDR                                         2958 15267000
         ST    @04,@AL00001+8                                      2958 15268000
         L     @04,@PC00020                                        2958 15269000
         ST    @04,@AL00001+12                                     2958 15270000
         L     @04,@PC00020+4                                      2958 15271000
         ST    @04,@AL00001+16                                     2958 15272000
         L     @04,@PC00020+8                                      2958 15273000
         L     @04,FPTRFVT(,@04)                                   2958 15274000
         LA    @04,CTGFVSPC(,@04)                                  2958 15275000
         ST    @04,@AL00001+20                                     2958 15276000
         LA    @01,@AL00001                                        2958 15277000
         BAL   @14,BFPLPROC                                        2958 15278000
*            /********************************************************/ 15279000
*            /*                                                      */ 15280000
*            /*  CONSTRUCT AMDSB FPL, PLACE POINTER IN FVT           */ 15281000
*            /*                                                      */ 15282000
*            /********************************************************/ 15283000
*                                                                  2959 15284000
*            CALL BFPLPROC(ADDR(FIELDLST),IAMDSB,                  2959 15285000
*                FPLADDR,FDICT,FWKA,CTGFVAMD);                     2959 15286000
         LA    @04,FIELDLST                                        2959 15287000
         ST    @04,@AFTEMPS+32                                     2959 15288000
         LA    @04,@AFTEMPS+32                                     2959 15289000
         ST    @04,@AL00001                                        2959 15290000
         LA    @04,@CH00966                                        2959 15291000
         ST    @04,@AL00001+4                                      2959 15292000
         LA    @04,FPLADDR                                         2959 15293000
         ST    @04,@AL00001+8                                      2959 15294000
         L     @04,@PC00020                                        2959 15295000
         ST    @04,@AL00001+12                                     2959 15296000
         L     @04,@PC00020+4                                      2959 15297000
         ST    @04,@AL00001+16                                     2959 15298000
         L     @04,@PC00020+8                                      2959 15299000
         L     @04,FPTRFVT(,@04)                                   2959 15300000
         LA    @04,CTGFVAMD(,@04)                                  2959 15301000
         ST    @04,@AL00001+20                                     2959 15302000
         LA    @01,@AL00001                                        2959 15303000
         BAL   @14,BFPLPROC                                        2959 15304000
*            RESPECIFY IDAAMDSB BASED(DSCCATPT);                   2960 15305000
*            IF CTGFVAMD ^= NULLPTR                                2961 15306000
*              THEN                                                2961 15307000
*                                                                  2961 15308000
         L     @04,@PC00020+8                                      2961 15309000
         L     @04,FPTRFVT(,@04)                                   2961 15310000
         L     @15,CTGFVAMD(,@04)                                  2961 15311000
         LTR   @15,@15                                             2961 15312000
         BZ    @RF02961                                            2961 15313000
*                /****************************************************/ 15314000
*                /*                                                  */ 15315000
*                /*  IF AMDSBCAT INFORMATION EXISTS FOR THIS         */ 15316000
*                /*  COMPONENT INITIALIZE THE AMDSBCAT               */ 15317000
*                /*  INFORMATION FROM INFORMATION                    */ 15318000
*                /*  IN THE DICTIONARY AND WORK AREA.                */ 15319000
*                /*                                                  */ 15320000
*                /****************************************************/ 15321000
*                                                                  2962 15322000
*                DO;                                               2962 15323000
*                DSCCATPT = CTGFVAMD -> CTGFLPT(1);                2963 15324000
         L     @15,CTGFLPT(,@15)                                   2963 15325000
         ST    @15,DSCCATPT                                        2963 15326000
*                AMDLEN = LENGTH(IDAAMDSB);                        2964 15327000
         MVC   AMDLEN(2,@15),@CH01744                              2964 15328000
*                AMDATTR = (FWKA + DICTDL(IAMDSB)) -> AMDATTR;     2965 15329000
         L     @14,@PC00020+4                                      2965 15330000
         L     @14,FWKA(,@14)                                      2965 15331000
         L     @01,DICTPTR                                         2965 15332000
         AL    @14,DICTDL+136(,@01)                                2965 15333000
         MVC   AMDATTR(1,@15),AMDATTR(@14)                         2965 15334000
*                AMDRKP = (FWKA + DICTDL(IAMDSB)) -> AMDRKP;       2966 15335000
         LH    @03,AMDRKP(,@14)                                    2966 15336000
         STH   @03,AMDRKP(,@15)                                    2966 15337000
*                AMDKEYLN = (FWKA + DICTDL(IAMDSB)) -> AMDKEYLN;   2967 15338000
         LH    @03,AMDKEYLN(,@14)                                  2967 15339000
         STH   @03,AMDKEYLN(,@15)                                  2967 15340000
*                AMDCINV = (FWKA + DICTDL(IAMDSB))-> AMDCINV;      2968 15341000
         L     @03,AMDCINV(,@14)                                   2968 15342000
         ST    @03,AMDCINV(,@15)                                   2968 15343000
*                AMDLRECL = (FWKA + DICTDL(IAMDSB)) -> AMDLRECL;   2969 15344000
         L     @03,AMDLRECL(,@14)                                  2969 15345000
         ST    @03,AMDLRECL(,@15)                                  2969 15346000
*                AMDPCTCA = (FWKA + DICTDL(IAMDSB)) -> AMDPCTCA;   2970 15347000
         IC    @03,AMDPCTCA(,@14)                                  2970 15348000
         STC   @03,AMDPCTCA(,@15)                                  2970 15349000
*                AMDPCTCI = (FWKA + DICTDL(IAMDSB)) -> AMDPCTCI;   2971 15350000
         IC    @03,AMDPCTCI(,@14)                                  2971 15351000
         STC   @03,AMDPCTCI(,@15)                                  2971 15352000
*                AMDATTR3 = (FWKA + DICTDL(IAMDSB))->              2972 15353000
*                   AMDATTR3;                                      2972 15354000
*                                                                  2972 15355000
         MVC   AMDATTR3(1,@15),AMDATTR3(@14)                       2972 15356000
*                IF CTGFVTYP = CTGTDATA                            2973 15357000
*                  THEN                                            2973 15358000
         CLI   CTGFVTYP(@04),C'D'                                  2973 15359000
         BNE   @RF02973                                            2973 15360000
*                    AMDAXRKP = (FWKA + DICTDL(IAMDSB))->          2974 15361000
*                       AMDAXRKP;                                  2974 15362000
         LH    @04,AMDAXRKP(,@14)                                  2974 15363000
         STH   @04,AMDAXRKP(,@15)                                  2974 15364000
*                END;                                              2975 15365000
*                                                                  2975 15366000
@RF02973 DS    0H                                                  2976 15367000
*            /********************************************************/ 15368000
*            /*                                                      */ 15369000
*            /*  CONSTRUCT DSATTR FPL WHICH REFERENCES DATA          */ 15370000
*            /*  SET ATTRIBUTES CATALOG FIELD, PLACE POINTER         */ 15371000
*            /*  IN FVT                                              */ 15372000
*            /*                                                      */ 15373000
*            /********************************************************/ 15374000
*                                                                  2976 15375000
*            IF CTGFVTYP = CTGTINDX | CTGFVTYP = CTGTDATA          2976 15376000
*              THEN                                                2976 15377000
@RF02961 L     @04,@PC00020+8                                      2976 15378000
         L     @04,FPTRFVT(,@04)                                   2976 15379000
         CLI   CTGFVTYP(@04),C'I'                                  2976 15380000
         BE    @RT02976                                            2976 15381000
         CLI   CTGFVTYP(@04),C'D'                                  2976 15382000
         BNE   @RF02976                                            2976 15383000
@RT02976 DS    0H                                                  2977 15384000
*                CALL BFPLPROC(ADDR(FIELDLST),IDSATTR,             2977 15385000
*                   FPLADDR,FDICT,FWKA,CTGFVATR);                  2977 15386000
*                                                                  2977 15387000
         LA    @04,FIELDLST                                        2977 15388000
         ST    @04,@AFTEMPS+32                                     2977 15389000
         LA    @04,@AFTEMPS+32                                     2977 15390000
         ST    @04,@AL00001                                        2977 15391000
         LA    @04,@CH00165                                        2977 15392000
         ST    @04,@AL00001+4                                      2977 15393000
         LA    @04,FPLADDR                                         2977 15394000
         ST    @04,@AL00001+8                                      2977 15395000
         L     @04,@PC00020                                        2977 15396000
         ST    @04,@AL00001+12                                     2977 15397000
         L     @04,@PC00020+4                                      2977 15398000
         ST    @04,@AL00001+16                                     2977 15399000
         L     @04,@PC00020+8                                      2977 15400000
         L     @04,FPTRFVT(,@04)                                   2977 15401000
         LA    @04,CTGFVATR(,@04)                                  2977 15402000
         ST    @04,@AL00001+20                                     2977 15403000
         LA    @01,@AL00001                                        2977 15404000
         BAL   @14,BFPLPROC                                        2977 15405000
*            /********************************************************/ 15406000
*            /*                                                      */ 15407000
*            /*  CONSTRUCT EXCEPTION EXIT FPL, PLACE POINTER         */ 15408000
*            /*  IN THE FVT.                                         */ 15409000
*            /*                                                      */ 15410000
*            /********************************************************/ 15411000
*                                                                  2978 15412000
*            CALL BFPLPROC(ADDR(FIELDLST),IEXCPXIT,                2978 15413000
*               FPLADDR,FDICT,FWKA,CTGFVEXT);                      2978 15414000
*                                                                  2978 15415000
@RF02976 LA    @04,FIELDLST                                        2978 15416000
         ST    @04,@AFTEMPS+32                                     2978 15417000
         LA    @04,@AFTEMPS+32                                     2978 15418000
         ST    @04,@AL00001                                        2978 15419000
         LA    @04,@CH00977                                        2978 15420000
         ST    @04,@AL00001+4                                      2978 15421000
         LA    @04,FPLADDR                                         2978 15422000
         ST    @04,@AL00001+8                                      2978 15423000
         L     @04,@PC00020                                        2978 15424000
         ST    @04,@AL00001+12                                     2978 15425000
         L     @04,@PC00020+4                                      2978 15426000
         ST    @04,@AL00001+16                                     2978 15427000
         L     @04,@PC00020+8                                      2978 15428000
         L     @04,FPTRFVT(,@04)                                   2978 15429000
         LA    @04,CTGFVEXT(,@04)                                  2978 15430000
         ST    @04,@AL00001+20                                     2978 15431000
         LA    @01,@AL00001                                        2978 15432000
         BAL   @14,BFPLPROC                                        2978 15433000
*            /********************************************************/ 15434000
*            /*                                                      */ 15435000
*            /*  CONSTRUCT BUFSIZE FPL, PLACE POINTER IN FVT         */ 15436000
*            /*                                                      */ 15437000
*            /********************************************************/ 15438000
*                                                                  2979 15439000
*            IF CTGFVTYP ^= CTGFVIDX                               2979 15440000
*              THEN                                                2979 15441000
         L     @04,@PC00020+8                                      2979 15442000
         L     @04,FPTRFVT(,@04)                                   2979 15443000
         CLI   CTGFVTYP(@04),C'I'                                  2979 15444000
         BE    @RF02979                                            2979 15445000
*                CALL BFPLPROC(ADDR(FIELDLST),IBUFSIZE,            2980 15446000
*                   FPLADDR,FDICT,FWKA,CTGFVBUF);                  2980 15447000
*                                                                  2980 15448000
         LA    @15,FIELDLST                                        2980 15449000
         ST    @15,@AFTEMPS+32                                     2980 15450000
         LA    @15,@AFTEMPS+32                                     2980 15451000
         ST    @15,@AL00001                                        2980 15452000
         LA    @15,@CH00040                                        2980 15453000
         ST    @15,@AL00001+4                                      2980 15454000
         LA    @15,FPLADDR                                         2980 15455000
         ST    @15,@AL00001+8                                      2980 15456000
         L     @15,@PC00020                                        2980 15457000
         ST    @15,@AL00001+12                                     2980 15458000
         L     @15,@PC00020+4                                      2980 15459000
         ST    @15,@AL00001+16                                     2980 15460000
         LA    @04,CTGFVBUF(,@04)                                  2980 15461000
         ST    @04,@AL00001+20                                     2980 15462000
         LA    @01,@AL00001                                        2980 15463000
         BAL   @14,BFPLPROC                                        2980 15464000
*            /********************************************************/ 15465000
*            /*                                                      */ 15466000
*            /*  CONSTRUCT LRECL FPL AND PLACE POINTER IN FVT        */ 15467000
*            /*                                                      */ 15468000
*            /********************************************************/ 15469000
*                                                                  2981 15470000
*            IF CTGFVTYP ^= CTGFVIDX                               2981 15471000
*              THEN                                                2981 15472000
@RF02979 L     @04,@PC00020+8                                      2981 15473000
         L     @04,FPTRFVT(,@04)                                   2981 15474000
         CLI   CTGFVTYP(@04),C'I'                                  2981 15475000
         BE    @RF02981                                            2981 15476000
*                CALL BFPLPROC(ADDR(FIELDLST),ILRECL,              2982 15477000
*                   FPLADDR,FDICT,FWKA,CTGFVLRS);                  2982 15478000
*                                                                  2982 15479000
         LA    @15,FIELDLST                                        2982 15480000
         ST    @15,@AFTEMPS+32                                     2982 15481000
         LA    @15,@AFTEMPS+32                                     2982 15482000
         ST    @15,@AL00001                                        2982 15483000
         LA    @15,@CH00039                                        2982 15484000
         ST    @15,@AL00001+4                                      2982 15485000
         LA    @15,FPLADDR                                         2982 15486000
         ST    @15,@AL00001+8                                      2982 15487000
         L     @15,@PC00020                                        2982 15488000
         ST    @15,@AL00001+12                                     2982 15489000
         L     @15,@PC00020+4                                      2982 15490000
         ST    @15,@AL00001+16                                     2982 15491000
         LA    @04,CTGFVLRS(,@04)                                  2982 15492000
         ST    @04,@AL00001+20                                     2982 15493000
         LA    @01,@AL00001                                        2982 15494000
         BAL   @14,BFPLPROC                                        2982 15495000
*            /********************************************************/ 15496000
*            /*                                                      */ 15497000
*            /*  CONSTRUCT KEY RANGES LIST IF HIKEYV, LOKEYV         */ 15498000
*            /*  FIELDS WERE LOCATED AT EXPORT TIME                  */ 15499000
*            /*  IF RANGPROC DOES NOT CONSTRUCT THE LIST             */ 15500000
*            /*  SUCCESSFULLY, INDICATE AN ERROR AND RETURN          */ 15501000
*            /*  TO CALLING PROCESSOR.                               */ 15502000
*            /*                                                      */ 15503000
*            /********************************************************/ 15504000
*                                                                  2983 15505000
*            CALL RANGPROC(0,FDICT,FWKA,CTGFVRNG);                 2983 15506000
@RF02981 LA    @04,@CF00119                                        2983 15507000
         ST    @04,@AL00001                                        2983 15508000
         L     @04,@PC00020                                        2983 15509000
         ST    @04,@AL00001+4                                      2983 15510000
         L     @04,@PC00020+4                                      2983 15511000
         ST    @04,@AL00001+8                                      2983 15512000
         L     @04,@PC00020+8                                      2983 15513000
         L     @04,FPTRFVT(,@04)                                   2983 15514000
         LA    @04,CTGFVRNG(,@04)                                  2983 15515000
         ST    @04,@AL00001+12                                     2983 15516000
         LA    @01,@AL00001                                        2983 15517000
         BAL   @14,RANGPROC                                        2983 15518000
*            RESPECIFY RTNREG RSTD;                                2984 15519000
*            TESTRC = RTNREG;                                      2985 15520000
         STH   RTNREG,TESTRC                                       2985 15521000
*            RESPECIFY RTNREG UNRSTD;                              2986 15522000
*            IF TESTRC ^= 0                                        2987 15523000
*              THEN                                                2987 15524000
         LH    @04,TESTRC                                          2987 15525000
         LTR   @04,@04                                             2987 15526000
         BZ    @RF02987                                            2987 15527000
*                RETURN CODE(LASTCC12);                            2988 15528000
*                                                                  2988 15529000
         LA    @15,12                                              2988 15530000
         L     @14,@SA00020                                        2988 15531000
         LM    @00,@12,@SA00020+8                                  2988 15532000
         BR    @14                                                 2988 15533000
*        /************************************************************/ 15534000
*        /*                                                          */ 15535000
*        /*  CONSTRUCT LIST OF VOLUME SERIALS IF THE VOLUME SERIAL   */ 15536000
*        /*  NUMBER WERE EXPORTED (ON A TEMPORARY EXPORT) AND IF     */ 15537000
*        /*  THE VOLUMES PARAMETER WAS NOT SPECIFIED ON THE IMPORT   */ 15538000
*        /*  COMMAND. LVLRPROC WILL CHECK TO SEE IF THE VOLUMES LIST */ 15539000
*        /*  WAS PASSED ON THE PORTABLE DATA SET.  IF SO, THE VOLUME */ 15540000
*        /*  SERIAL LIST WILL BE CONSTRUCTED FOR DEFINE.             */ 15541000
*        /*                                                          */ 15542000
*        /************************************************************/ 15543000
*                                                                  2989 15544000
*            CALL LVLRPROC(0,FDICT,FWKA,FPTRFVT,CTGFVTYP);         2989 15545000
*                                                                  2989 15546000
@RF02987 LA    @04,@CF00119                                        2989 15547000
         ST    @04,@AL00001                                        2989 15548000
         L     @04,@PC00020                                        2989 15549000
         ST    @04,@AL00001+4                                      2989 15550000
         L     @04,@PC00020+4                                      2989 15551000
         ST    @04,@AL00001+8                                      2989 15552000
         L     @04,@PC00020+8                                      2989 15553000
         ST    @04,@AL00001+12                                     2989 15554000
         L     @04,FPTRFVT(,@04)                                   2989 15555000
         ST    @04,@AL00001+16                                     2989 15556000
         LA    @01,@AL00001                                        2989 15557000
         BAL   @14,LVLRPROC                                        2989 15558000
*            RESPECIFY RTNREG RSTD;                                2990 15559000
*            TESTRC = RTNREG;                                      2991 15560000
         STH   RTNREG,TESTRC                                       2991 15561000
*            RESPECIFY RTNREG UNRSTD;                              2992 15562000
*                                                                  2992 15563000
*            /********************************************************/ 15564000
*            /*                                                      */ 15565000
*            /*  IF UNSUCCESSFUL, RETURN TO CALLER                   */ 15566000
*            /*                                                      */ 15567000
*            /********************************************************/ 15568000
*                                                                  2993 15569000
*            IF TESTRC ^= 0                                        2993 15570000
*              THEN                                                2993 15571000
         LH    @04,TESTRC                                          2993 15572000
         LTR   @04,@04                                             2993 15573000
         BZ    @RF02993                                            2993 15574000
*                RETURN CODE(LASTCC12);                            2994 15575000
*                                                                  2994 15576000
         LA    @15,12                                              2994 15577000
         L     @14,@SA00020                                        2994 15578000
         LM    @00,@12,@SA00020+8                                  2994 15579000
         BR    @14                                                 2994 15580000
*            END NOPTH;                                            2995 15581000
*                                                                  2995 15582000
@RF02993 DS    0H                                                  2996 15583000
*        /************************************************************/ 15584000
*        /*                                                          */ 15585000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 15586000
*        /*                                                          */ 15587000
*        /************************************************************/ 15588000
*                                                                  2996 15589000
*        RETURN CODE(0);                                           2996 15590000
@RF02956 SLR   @15,@15                                             2996 15591000
         L     @14,@SA00020                                        2996 15592000
         LM    @00,@12,@SA00020+8                                  2996 15593000
         BR    @14                                                 2996 15594000
*END FVTPROC;                                                      2997 15595000
*        /************************************************************/ 15596000
*        /*                                                          */ 15597000
*        /*  PROCEDURE NAME - BPASPROC                               */ 15598000
*        /*                                                          */ 15599000
*        /*  FUNCTION - CONSTRUCT PASSWALL FPL, MOVE FIELD           */ 15600000
*        /*  INFORMATION FROM PASSWORD, PASSPRMT, PASSATM, USERAREA  */ 15601000
*        /*  AND USVRMDUL FIELDS INTO PASSWALL COMBINATION FIELD     */ 15602000
*        /*                                                          */ 15603000
*        /*  INPUT -                                                 */ 15604000
*        /*    .BFPL - FPL POINTER                                   */ 15605000
*        /*    .BDICT - POINTER TO DICTIONARY REFERENCING CATALOG    */ 15606000
*        /*      FIELD INFORMATION WITHIN THE WORK AREA              */ 15607000
*        /*    .BWKA - WORK AREA CONTAINING CATALOG FIELD INFORMATION*/ 15608000
*        /*                                                          */ 15609000
*        /*  OUTPUT - PASSWALL FPL, AND PASSWALL COMBINATION FIELD   */ 15610000
*        /*                                                          */ 15611000
*        /************************************************************/ 15612000
*                                                                  2998 15613000
*BPASPROC: PROCEDURE(BFPL,             /*POINTER TO FPL              */ 15614000
*                    BDICT,            /*DICTIONARY POINTER          */ 15615000
*                    BWKA);            /*WORK AREA POINTER           */ 15616000
*                                                                  2998 15617000
BPASPROC STM   @14,@12,@SA00021                                    2998 15618000
         MVC   @PC00021(12),0(@01)                                 2998 15619000
*        /************************************************************/ 15620000
*        /*                                                          */ 15621000
*        /*  ARGUMENTS OF INVOCATION                                 */ 15622000
*        /*                                                          */ 15623000
*        /************************************************************/ 15624000
*                                                                  2999 15625000
*        DCL BFPL   PTR(31),                                       2999 15626000
*            BDICT  PTR(31),                                       2999 15627000
*            BWKA   PTR(31);                                       2999 15628000
*                                                                  2999 15629000
*        /************************************************************/ 15630000
*        /*                                                          */ 15631000
*        /*  LOCAL DECLARATIONS                                      */ 15632000
*        /*                                                          */ 15633000
*        /************************************************************/ 15634000
*                                                                  3000 15635000
*        DCL DICENPTR PTR(31);                                     3000 15636000
*        DCL FIELDPS  CHAR(*) BASED(DICENPTR);                     3001 15637000
*        DCL NOFIND   CONSTANT(4);                                 3002 15638000
*                                                                  3002 15639000
*        /************************************************************/ 15640000
*        /*                                                          */ 15641000
*        /*  CHECK TO BE SURE PASSWORD INFORMATION WAS SPECIFIED.    */ 15642000
*        /*  IF IT WAS FILL IN FPL FIELDS FOR PASSSWALL FIELD        */ 15643000
*        /*                                                          */ 15644000
*        /************************************************************/ 15645000
*                                                                  3003 15646000
*        OLDERID2 = NEWERID2;                                      3003 15647000
         L     @04,@PC00001                                        3003 15648000
         L     @15,GDTTR2(,@04)                                    3003 15649000
         MVC   @TS00001(95),NEWERID2(@15)                          3003 15650000
         MVC   OLDERID2(95,@15),@TS00001                           3003 15651000
*        NEWID2 = 'RMPS';                                          3004 15652000
         MVC   NEWID2(4,@15),@CC01727                              3004 15653000
*        DICTPTR = BDICT;                                          3005 15654000
         L     @15,@PC00021+4                                      3005 15655000
         L     @15,BDICT(,@15)                                     3005 15656000
         ST    @15,DICTPTR                                         3005 15657000
*        IF DICTLN(IPASSWOR) ^= 0                                  3006 15658000
*          THEN                                                    3006 15659000
         L     @14,DICTLN+72(,@15)                                 3006 15660000
         LTR   @14,@14                                             3006 15661000
         BZ    @RF03006                                            3006 15662000
*            DO;                                                   3007 15663000
*            CTGFLPTR = BFPL;                                      3008 15664000
         L     @14,@PC00021                                        3008 15665000
         L     @14,BFPL(,@14)                                      3008 15666000
         ST    @14,CTGFLPTR                                        3008 15667000
*            CTGFLDNO = '00000001'B;                               3009 15668000
         MVI   CTGFLDNO(@14),X'01'                                 3009 15669000
*            CTGFLDNM = ADDR(FPASNAME);                            3010 15670000
         LA    @03,FPASNAME                                        3010 15671000
         ST    @03,CTGFLDNM(,@14)                                  3010 15672000
*            CTGFLNG(1) = LENGTH(FPASSWAL) + DICTLN(IUSRAREC);     3011 15673000
*                                                                  3011 15674000
         LA    @03,52                                              3011 15675000
         AL    @03,DICTLN+104(,@15)                                3011 15676000
         ST    @03,CTGFLNG(,@14)                                   3011 15677000
*            /********************************************************/ 15678000
*            /*                                                      */ 15679000
*            /*  GET CORE TO CONTAIN FIELD INFORMATION               */ 15680000
*            /*  IF CORE IS NOT OBTAINED, RETURN TO CALLING PROCESSOR*/ 15681000
*            /*                                                      */ 15682000
*            /********************************************************/ 15683000
*                                                                  3012 15684000
*            CALL IDCSAGP0(GDTTBL,CTGFLNG(1),CTGFLPT(1),GPID,SETZERO);  15685000
*                                                                  3012 15686000
         ST    @04,@AL00001                                        3012 15687000
         LA    @15,CTGFLNG(,@14)                                   3012 15688000
         ST    @15,@AL00001+4                                      3012 15689000
         LA    @15,CTGFLPT(,@14)                                   3012 15690000
         ST    @15,@AL00001+8                                      3012 15691000
         LA    @15,GPID                                            3012 15692000
         ST    @15,@AL00001+12                                     3012 15693000
         LA    @15,SETZERO                                         3012 15694000
         ST    @15,@AL00001+16                                     3012 15695000
         MVI   @AL00001+16,X'80'                                   3012 15696000
         L     @15,GDTGPL(,@04)                                    3012 15697000
         LA    @01,@AL00001                                        3012 15698000
         BALR  @14,@15                                             3012 15699000
*            RESPECIFY RTNREG RSTD;                                3013 15700000
*            TESTRC = RTNREG;                                      3014 15701000
         STH   RTNREG,TESTRC                                       3014 15702000
*            RESPECIFY RTNREG UNRSTD;                              3015 15703000
*            IF TESTRC ^= 0                                        3016 15704000
*              THEN                                                3016 15705000
         LH    @04,TESTRC                                          3016 15706000
         LTR   @04,@04                                             3016 15707000
         BZ    @RF03016                                            3016 15708000
*                DO;                                               3017 15709000
*                DEFSTID = NOSTORAG;                               3018 15710000
         MVI   DEFSTID,X'04'                                       3018 15711000
*                DARGSMOD = UNIVMSG;                               3019 15712000
         L     @04,DDSTRU                                          3019 15713000
         MVC   DARGSMOD(3,@04),@CC00981                            3019 15714000
*                RETURN CODE(LASTCC12);                            3020 15715000
         LA    @15,12                                              3020 15716000
         L     @14,@SA00021                                        3020 15717000
         LM    @00,@12,@SA00021+8                                  3020 15718000
         BR    @14                                                 3020 15719000
*                END;                                              3021 15720000
*                                                                  3021 15721000
*            /********************************************************/ 15722000
*            /*                                                      */ 15723000
*            /*  INITIALIZE PASSWORD PORTION OF PASSWALL COMBINATION */ 15724000
*            /*  FIELD TO FF'S                                       */ 15725000
*            /*                                                      */ 15726000
*            /********************************************************/ 15727000
*                                                                  3022 15728000
*            DO J = 1 TO LENGTH(FPASSWAL);                         3022 15729000
@RF03016 LA    @04,1                                               3022 15730000
         ST    @04,J                                               3022 15731000
@DL03022 DS    0H                                                  3023 15732000
*              FPASSWAL(J) = 'FF'X;                                3023 15733000
         L     @01,CTGFLPTR                                        3023 15734000
         L     @01,CTGFLPT(,@01)                                   3023 15735000
         ALR   @01,@04                                             3023 15736000
         BCTR  @01,0                                               3023 15737000
         MVI   FPASSWAL(@01),X'FF'                                 3023 15738000
*            END;                                                  3024 15739000
*                                                                  3024 15740000
         AL    @04,@CF00221                                        3024 15741000
         ST    @04,J                                               3024 15742000
         C     @04,@CF01741                                        3024 15743000
         BNH   @DL03022                                            3024 15744000
*            FUSERLN = 0;                                          3025 15745000
*                                                                  3025 15746000
         SLR   @04,@04                                             3025 15747000
         L     @01,CTGFLPTR                                        3025 15748000
         L     @15,CTGFLPT(,@01)                                   3025 15749000
         STH   @04,FUSERLN(,@15)                                   3025 15750000
*            DICENPTR = DICTDL(IPASSWOR) + BWKA;                   3026 15751000
*                                                                  3026 15752000
         L     @14,DICTPTR                                         3026 15753000
         L     @03,@PC00021+8                                      3026 15754000
         L     @02,DICTDL+72(,@14)                                 3026 15755000
         AL    @02,BWKA(,@03)                                      3026 15756000
         ST    @02,DICENPTR                                        3026 15757000
*            /********************************************************/ 15758000
*            /*                                                      */ 15759000
*            /*  CONSTRUCT PASSWALL COMBINATION CATALOG FIELD FROM   */ 15760000
*            /*  ALL SUPPLIED INFORMATION IN WORK AREA.  FIELDS WILL */ 15761000
*            /*  BE LEFT ZERO WHEN NO INFORMATION HAS BEEN SUPPLIED  */ 15762000
*            /*  FOR THAT ENTRY                                      */ 15763000
*            /*                                                      */ 15764000
*            /********************************************************/ 15765000
*                                                                  3027 15766000
*            IF DICTLN(IPASSWOR) ^= 0                              3027 15767000
*              THEN                                                3027 15768000
         L     @14,DICTLN+72(,@14)                                 3027 15769000
         CR    @14,@04                                             3027 15770000
         BE    @RF03027                                            3027 15771000
*                FPASWD(1:DICTLN(IPASSWOR)) =                      3028 15772000
*                  FIELDPS(1:DICTLN(IPASSWOR));                    3028 15773000
*                                                                  3028 15774000
         BCTR  @14,0                                               3028 15775000
         EX    @14,@SM01809                                        3028 15776000
*            DICENPTR = DICTDL(IPASSPRM) + BWKA;                   3029 15777000
@RF03027 L     @04,DICTPTR                                         3029 15778000
         L     @15,@PC00021+8                                      3029 15779000
         L     @14,DICTDL+80(,@04)                                 3029 15780000
         AL    @14,BWKA(,@15)                                      3029 15781000
         ST    @14,DICENPTR                                        3029 15782000
*            IF DICTLN(IPASSPRM) ^= 0                              3030 15783000
*              THEN                                                3030 15784000
         L     @04,DICTLN+80(,@04)                                 3030 15785000
         LTR   @04,@04                                             3030 15786000
         BZ    @RF03030                                            3030 15787000
*                FPASSPRM(1:DICTLN(IPASSPRM)) =                    3031 15788000
*                  FIELDPS(1:DICTLN(IPASSPRM));                    3031 15789000
*                                                                  3031 15790000
         L     @01,CTGFLPTR                                        3031 15791000
         L     @01,CTGFLPT(,@01)                                   3031 15792000
         BCTR  @04,0                                               3031 15793000
         EX    @04,@SM01811                                        3031 15794000
*            DICENPTR = DICTDL(IPASSATM) + BWKA;                   3032 15795000
@RF03030 L     @04,DICTPTR                                         3032 15796000
         L     @15,DICTDL+88(,@04)                                 3032 15797000
         L     @14,@PC00021+8                                      3032 15798000
         LR    @03,@15                                             3032 15799000
         AL    @03,BWKA(,@14)                                      3032 15800000
         ST    @03,DICENPTR                                        3032 15801000
*            IF DICTDL(IPASSATM) ^= 0                              3033 15802000
*              THEN                                                3033 15803000
         LTR   @15,@15                                             3033 15804000
         BZ    @RF03033                                            3033 15805000
*                FPASSATM(1:DICTLN(IPASSATM)) =                    3034 15806000
*                  FIELDPS(1:DICTLN(IPASSATM));                    3034 15807000
*                                                                  3034 15808000
         L     @01,CTGFLPTR                                        3034 15809000
         L     @01,CTGFLPT(,@01)                                   3034 15810000
         L     @04,DICTLN+88(,@04)                                 3034 15811000
         BCTR  @04,0                                               3034 15812000
         EX    @04,@SM01813                                        3034 15813000
*            DICENPTR = DICTDL(IUSVRMDU) + BWKA;                   3035 15814000
@RF03033 L     @04,DICTPTR                                         3035 15815000
         L     @15,@PC00021+8                                      3035 15816000
         L     @14,DICTDL+96(,@04)                                 3035 15817000
         AL    @14,BWKA(,@15)                                      3035 15818000
         ST    @14,DICENPTR                                        3035 15819000
*            IF DICTLN(IUSVRMDU) ^= 0                              3036 15820000
*              THEN                                                3036 15821000
         L     @04,DICTLN+96(,@04)                                 3036 15822000
         LTR   @04,@04                                             3036 15823000
         BZ    @RF03036                                            3036 15824000
*                FUSVRMDU(1:DICTLN(IUSVRMDU)) =                    3037 15825000
*                  FIELDPS(1:DICTDL(IUSVRMDU));                    3037 15826000
*                                                                  3037 15827000
         L     @01,CTGFLPTR                                        3037 15828000
         L     @01,CTGFLPT(,@01)                                   3037 15829000
         BCTR  @04,0                                               3037 15830000
         EX    @04,@SM01815                                        3037 15831000
*            DICENPTR = DICTDL(IUSRAREC) + BWKA;                   3038 15832000
@RF03036 L     @04,DICTPTR                                         3038 15833000
         L     @15,@PC00021+8                                      3038 15834000
         L     @14,DICTDL+104(,@04)                                3038 15835000
         AL    @14,BWKA(,@15)                                      3038 15836000
         ST    @14,DICENPTR                                        3038 15837000
*            IF DICTLN(IUSRAREC) ^= 0                              3039 15838000
*              THEN                                                3039 15839000
         L     @04,DICTLN+104(,@04)                                3039 15840000
         LTR   @04,@04                                             3039 15841000
         BZ    @RF03039                                            3039 15842000
*                FUSERARE(1:DICTLN(IUSRAREC)) =                    3040 15843000
*                  FIELDPS(1:DICTLN(IUSRAREC));                    3040 15844000
         L     @01,CTGFLPTR                                        3040 15845000
         L     @01,CTGFLPT(,@01)                                   3040 15846000
         BCTR  @04,0                                               3040 15847000
         EX    @04,@SM01817                                        3040 15848000
*            END;                                                  3041 15849000
*                                                                  3041 15850000
*          /**********************************************************/ 15851000
*          /*                                                        */ 15852000
*          /*  PASSWORD FIELD IS ZERO, THEREFORE DON'T BUILD FPL     */ 15853000
*          /*  OR FIELD                                              */ 15854000
*          /*                                                        */ 15855000
*          /**********************************************************/ 15856000
*                                                                  3042 15857000
*          ELSE                                                    3042 15858000
*            RETURN CODE(NOFIND);                                  3042 15859000
*                                                                  3042 15860000
*                                                                  3042 15861000
         B     @RC03006                                            3042 15862000
@RF03006 LA    @15,4                                               3042 15863000
         L     @14,@SA00021                                        3042 15864000
         LM    @00,@12,@SA00021+8                                  3042 15865000
         BR    @14                                                 3042 15866000
*        /************************************************************/ 15867000
*        /*                                                          */ 15868000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 15869000
*        /*                                                          */ 15870000
*        /************************************************************/ 15871000
*                                                                  3043 15872000
*        BFPL = BFPL + LENGTH(CTGFL) + 8;                          3043 15873000
*                                                                  3043 15874000
@RC03006 L     @04,@PC00021                                        3043 15875000
         LA    @15,24                                              3043 15876000
         AL    @15,BFPL(,@04)                                      3043 15877000
         ST    @15,BFPL(,@04)                                      3043 15878000
*        RETURN CODE(0);                                           3044 15879000
         SLR   @15,@15                                             3044 15880000
         L     @14,@SA00021                                        3044 15881000
         LM    @00,@12,@SA00021+8                                  3044 15882000
         BR    @14                                                 3044 15883000
*END BPASPROC;                                                     3045 15884000
*        /************************************************************/ 15885000
*        /*                                                          */ 15886000
*        /*  PROCEDURE NAME - GETPROC                                */ 15887000
*        /*                                                          */ 15888000
*        /*  FUNCTION - GET A DATA RECORD AND PLACE IT INTO A        */ 15889000
*        /*  SUPPLIED BUFFER, RECONSTRUCTING THE ORIGINAL RECORD     */ 15890000
*        /*  IF IT HAS BEEN SEGMENTED INTO SEVERAL RECORDS           */ 15891000
*        /*                                                          */ 15892000
*        /*  INPUT -                                                 */ 15893000
*        /*    .GINVBUF - ADDR OF SUPPLIED BUFFER TO CONTAIN RECORD  */ 15894000
*        /*    .GLENGTH - LENGTH OF ENTIRE RECORD                    */ 15895000
*        /*                                                          */ 15896000
*        /*  OUTPUT - A BUFFER CONTAINING THE ENTIRE RECORD          */ 15897000
*        /*                                                          */ 15898000
*        /************************************************************/ 15899000
*                                                                  3046 15900000
*GETPROC: PROCEDURE (GINVBUF,          /*BUFFER TO CONTAIN RECORD    */ 15901000
*                    GLENGTH);         /*LENGTH OF RECORD            */ 15902000
*                                                                  3046 15903000
GETPROC  STM   @14,@12,@SA00022                                    3046 15904000
         MVC   @PC00022(8),0(@01)                                  3046 15905000
*        /************************************************************/ 15906000
*        /*                                                          */ 15907000
*        /*  ARGUMENTS OF INVOCATION                                 */ 15908000
*        /*                                                          */ 15909000
*        /************************************************************/ 15910000
*                                                                  3047 15911000
*        DCL GINVBUF  PTR(31),                                     3047 15912000
*            GLENGTH  FIXED(15);                                   3047 15913000
*                                                                  3047 15914000
*        /************************************************************/ 15915000
*        /*                                                          */ 15916000
*        /*  LOCAL DECLARATIONS                                      */ 15917000
*        /*                                                          */ 15918000
*        /************************************************************/ 15919000
*                                                                  3048 15920000
*        DCL GDOCNTRL BIT(1);                                      3048 15921000
*        DCL GMLEN  FIXED(15);                                     3049 15922000
*        DCL RDBUF PTR(31);            /*POINTER TO BUFFER POSITION  */ 15923000
*                                      /*INTO WHICH DATA TO BE MOVED */ 15924000
*        DCL RDLEN FIXED(15);          /*LENGTH OF DATA YET TO BE    */ 15925000
*                                      /*READ                        */ 15926000
*                                                                  3052 15927000
*        /************************************************************/ 15928000
*        /*                                                          */ 15929000
*        /*  ISSUE UGETS UNTIL ENTIRE RECORD HAS BEEN READ INTO CORE */ 15930000
*        /*                                                          */ 15931000
*        /************************************************************/ 15932000
*                                                                  3052 15933000
*        RDBUF = GINVBUF;                                          3052 15934000
         L     @04,@PC00022                                        3052 15935000
         L     @04,GINVBUF(,@04)                                   3052 15936000
         ST    @04,RDBUF                                           3052 15937000
*        RDLEN= GLENGTH;                                           3053 15938000
         L     @04,@PC00022+4                                      3053 15939000
         LH    @04,GLENGTH(,@04)                                   3053 15940000
         STH   @04,RDLEN                                           3053 15941000
*        GDOCNTRL = ON;                                            3054 15942000
*                                                                  3054 15943000
         OI    GDOCNTRL,B'10000000'                                3054 15944000
*READLOOP: DO WHILE (GDOCNTRL = ON);                               3055 15945000
READLOOP B     @DE03055                                            3055 15946000
@DL03055 DS    0H                                                  3056 15947000
*            IOCSPTR = PINIOCS;                                    3056 15948000
*                                                                  3056 15949000
         L     @04,PINIOCS                                         3056 15950000
         ST    @04,IOCSPTR                                         3056 15951000
*            CALL IDCIOGT0(GDTTBL,PINIOCS);                        3057 15952000
*                                                                  3057 15953000
         L     @04,@PC00001                                        3057 15954000
         ST    @04,@AL00001                                        3057 15955000
         LA    @15,PINIOCS                                         3057 15956000
         ST    @15,@AL00001+4                                      3057 15957000
         MVI   @AL00001+4,X'80'                                    3057 15958000
         L     @15,GDTGET(,@04)                                    3057 15959000
         LA    @01,@AL00001                                        3057 15960000
         BALR  @14,@15                                             3057 15961000
*            RESPECIFY RTNREG RSTD;                                3058 15962000
*            TESTRC = RTNREG;                                      3059 15963000
         STH   RTNREG,TESTRC                                       3059 15964000
*            RESPECIFY RTNREG UNRSTD;                              3060 15965000
*            IF TESTRC ^= 0                                        3061 15966000
*              THEN                                                3061 15967000
*                                                                  3061 15968000
         LH    @04,TESTRC                                          3061 15969000
         LTR   @04,@04                                             3061 15970000
         BZ    @RF03061                                            3061 15971000
*              /******************************************************/ 15972000
*              /*                                                    */ 15973000
*              /*  IF AN ERROR OR END OF DATA CONDITION IS           */ 15974000
*              /*  RETURN TO THE CALLING PROCESSOR                   */ 15975000
*              /*                                                    */ 15976000
*              /******************************************************/ 15977000
*                                                                  3062 15978000
*                IF TESTRC = 16                                    3062 15979000
*                  THEN                                            3062 15980000
         LA    @15,16                                              3062 15981000
         CR    @04,@15                                             3062 15982000
         BNE   @RF03062                                            3062 15983000
*                    RETURN CODE(16);                              3063 15984000
         L     @14,@SA00022                                        3063 15985000
         LM    @00,@12,@SA00022+8                                  3063 15986000
         BR    @14                                                 3063 15987000
*                  ELSE                                            3064 15988000
*                    RETURN CODE(LASTCC12);                        3064 15989000
@RF03062 LA    @15,12                                              3064 15990000
         L     @14,@SA00022                                        3064 15991000
         LM    @00,@12,@SA00022+8                                  3064 15992000
         BR    @14                                                 3064 15993000
*              ELSE;                                               3065 15994000
*                                                                  3065 15995000
@RF03061 DS    0H                                                  3066 15996000
*          /**********************************************************/ 15997000
*          /*                                                        */ 15998000
*          /*  MOVE DATA JUST READ IN INTO BUFFER                    */ 15999000
*          /*                                                        */ 16000000
*          /**********************************************************/ 16001000
*                                                                  3066 16002000
*          GMLEN = IOCDLN;                                         3066 16003000
*                                                                  3066 16004000
         L     @04,IOCSPTR                                         3066 16005000
         L     @15,IOCDLN(,@04)                                    3066 16006000
         STH   @15,GMLEN                                           3066 16007000
*          CALL MVDAPROC(GMLEN,IOCDAD,RDBUF);                      3067 16008000
*                                                                  3067 16009000
         LA    @15,GMLEN                                           3067 16010000
         ST    @15,@AL00001                                        3067 16011000
         ST    @04,@AL00001+4                                      3067 16012000
         LA    @04,RDBUF                                           3067 16013000
         ST    @04,@AL00001+8                                      3067 16014000
         LA    @01,@AL00001                                        3067 16015000
         BAL   @14,MVDAPROC                                        3067 16016000
*        /************************************************************/ 16017000
*        /*                                                          */ 16018000
*        /*  DETERMINE IF ALL RECORD SEGMENTS HAVE BEEN READ IN.     */ 16019000
*        /*  IF SO, EXIT FROM LOOP.  IF NOT ADJUST LENGTH AND        */ 16020000
*        /*  AND CONTINUE GETTING RECORDS.                           */ 16021000
*        /*                                                          */ 16022000
*        /************************************************************/ 16023000
*                                                                  3068 16024000
*          IF IOCDLN < RDLEN                                       3068 16025000
*            THEN                                                  3068 16026000
         LH    @04,RDLEN                                           3068 16027000
         L     @01,IOCSPTR                                         3068 16028000
         L     @15,IOCDLN(,@01)                                    3068 16029000
         CR    @15,@04                                             3068 16030000
         BNL   @RF03068                                            3068 16031000
*              DO;                                                 3069 16032000
*              RDLEN = RDLEN - IOCDLN;                             3070 16033000
         SLR   @04,@15                                             3070 16034000
         STH   @04,RDLEN                                           3070 16035000
*              RDBUF = RDBUF + IOCDLN;                             3071 16036000
         AL    @15,RDBUF                                           3071 16037000
         ST    @15,RDBUF                                           3071 16038000
*              END;                                                3072 16039000
*            ELSE                                                  3073 16040000
*              GDOCNTRL = OFF;                                     3073 16041000
         B     @RC03068                                            3073 16042000
@RF03068 NI    GDOCNTRL,B'01111111'                                3073 16043000
*        END READLOOP;                                             3074 16044000
*                                                                  3074 16045000
@RC03068 DS    0H                                                  3074 16046000
@DE03055 TM    GDOCNTRL,B'10000000'                                3074 16047000
         BO    @DL03055                                            3074 16048000
*        /************************************************************/ 16049000
*        /*                                                          */ 16050000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 16051000
*        /*                                                          */ 16052000
*        /************************************************************/ 16053000
*                                                                  3075 16054000
*        RETURN CODE(0);                                           3075 16055000
         SLR   @15,@15                                             3075 16056000
         L     @14,@SA00022                                        3075 16057000
         LM    @00,@12,@SA00022+8                                  3075 16058000
         BR    @14                                                 3075 16059000
*END GETPROC;                                                      3076 16060000
*END IDCRM01                                                       3077 16061000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 16062000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 16063000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 16064000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 16065000
*/*%INCLUDE SYSLIB  (IDCCSRM )                                        * 16066000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        * 16067000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        * 16068000
*/*%INCLUDE SYSLIB  (IEZCTGFV)                                        * 16069000
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        * 16070000
*;                                                                 3077 16071000
@DATA    DS    0H                                                       16072000
@CH00288 DC    H'5'                                                     16073000
@CH00040 DC    H'7'                                                     16074000
@CH00038 DC    H'9'                                                     16075000
@CH00037 DC    H'10'                                                    16076000
@CH01063 DC    H'23'                                                    16077000
@CH00977 DC    H'28'                                                    16078000
@CH01060 DC    H'29'                                                    16079000
@CH00605 DC    H'44'                                                    16080000
@CH01385 DC    H'49'                                                    16081000
@CH01744 DC    H'96'                                                    16082000
@CH01133 DC    H'110'                                                   16083000
@CH01139 DC    H'140'                                                   16084000
@CH00920 DC    H'268'                                                   16085000
@CH01749 DC    H'544'                                                   16086000
@SM01777 MVC   ZAREA(0,@04),ZER                                         16087000
@SM01780 MVC   FLISTVOL(0,@01),FLISTVOL(@14)                            16088000
@SM01784 MVC   FIELDR(0,@01),SAVCPL                                     16089000
@SM01799 MVC   FKEY(0,@04),FIELDR(@01)                                  16090000
@SM01801 MVC   FKEY(0,@04),FIELDR(@15)                                  16091000
@SM01807 MVC   TOAREA(0,@04),FROMAREA(@01)                              16092000
@SM01809 MVC   FPASWD(0,@15),FIELDPS(@02)                               16093000
@SM01811 MVC   FPASSPRM(0,@01),FIELDPS(@14)                             16094000
@SM01813 MVC   FPASSATM(0,@01),FIELDPS(@03)                             16095000
@SM01815 MVC   FUSVRMDU(0,@01),FIELDPS(@14)                             16096000
@SM01817 MVC   FUSERARE(0,@01),FIELDPS(@14)                             16097000
         DS    0F                                                       16098000
@AL00691 EQU   *                       LIST WITH   5 ARGUMENT(S)        16099000
@AL01006 EQU   *                       LIST WITH   5 ARGUMENT(S)        16100000
@AL01319 EQU   *                       LIST WITH   5 ARGUMENT(S)        16101000
@AL01517 EQU   *                       LIST WITH   5 ARGUMENT(S)        16102000
@AL01742 EQU   *                       LIST WITH   5 ARGUMENT(S)        16103000
@AL01855 EQU   *                       LIST WITH   5 ARGUMENT(S)        16104000
@AL02776 DC    A(@CC00767)             LIST WITH   1 ARGUMENT(S)        16105000
@AL00986 EQU   *                       LIST WITH   3 ARGUMENT(S)        16106000
@AL02319 DC    A(@CC00751)             LIST WITH   3 ARGUMENT(S)        16107000
@AL01578 DC    A(NULLPARM)             LIST WITH   4 ARGUMENT(S)        16108000
@AL01374 DC    A(NULLPARM)             LIST WITH   4 ARGUMENT(S)        16109000
         DC    A(NULLPARM)                                              16110000
@AL01269 DC    A(@CC00755)             LIST WITH   5 ARGUMENT(S)        16111000
         DC    A(@CC00757)                                              16112000
         DC    A(NULLPARM)                                              16113000
         DC    A(NULLPARM)                                              16114000
         DC    A(NULLPARM)                                              16115000
@AL02787 EQU   *                       LIST WITH   5 ARGUMENT(S)        16116000
@AL02788 DC    A(@CC01650)             LIST WITH   5 ARGUMENT(S)        16117000
@AL02797 EQU   *                       LIST WITH   1 ARGUMENT(S)        16118000
@AL02820 EQU   *                       LIST WITH   1 ARGUMENT(S)        16119000
@AL02845 EQU   *                       LIST WITH   1 ARGUMENT(S)        16120000
@AL02861 DC    A(@CC01681)             LIST WITH   1 ARGUMENT(S)        16121000
         DC    A(NULLPARM)                                              16122000
         DC    A(@CF00119)                                              16123000
         DC    A(@CF00119)                                              16124000
@DATD    DSECT                                                          16125000
         DS    0F                                                       16126000
@SA00001 DS    18F                                                      16127000
@PC00001 DS    3F                                                       16128000
@SA00016 DS    15F                                                      16129000
@PC00016 DS    6F                                                       16130000
@SA00007 DS    15F                                                      16131000
@SA00010 DS    15F                                                      16132000
@SA00006 DS    15F                                                      16133000
@SA00002 DS    15F                                                      16134000
@SA00003 DS    15F                                                      16135000
@PC00003 DS    5F                                                       16136000
@SA00014 DS    15F                                                      16137000
@PC00014 DS    1F                                                       16138000
@PC00019 DS    3F                                                       16139000
@SA00022 DS    15F                                                      16140000
@PC00022 DS    2F                                                       16141000
@SA00020 DS    15F                                                      16142000
@PC00020 DS    3F                                                       16143000
@SA00012 DS    15F                                                      16144000
@PC00012 DS    5F                                                       16145000
@SA00015 DS    15F                                                      16146000
@PC00015 DS    4F                                                       16147000
@SA00013 DS    15F                                                      16148000
@PC00013 DS    1F                                                       16149000
@SA00018 DS    15F                                                      16150000
@SA00005 DS    15F                                                      16151000
@PC00005 DS    1F                                                       16152000
@SA00009 DS    15F                                                      16153000
@PC00009 DS    4F                                                       16154000
@SA00008 DS    15F                                                      16155000
@PC00008 DS    1F                                                       16156000
@SA00017 DS    15F                                                      16157000
@PC00017 DS    6F                                                       16158000
@SA00011 DS    15F                                                      16159000
@PC00011 DS    4F                                                       16160000
@SA00021 DS    15F                                                      16161000
@PC00021 DS    3F                                                       16162000
@AL00001 DS    6A                                                       16163000
@AFTEMPS DS    11F                                                      16164000
IDCRM01  CSECT                                                          16165000
         DS    0F                                                       16166000
@CF00119 DC    F'0'                                                     16167000
@CF00221 DC    F'1'                                                     16168000
@CH00221 EQU   @CF00221+2                                               16169000
@CF00157 DC    F'2'                                                     16170000
@CH00157 EQU   @CF00157+2                                               16171000
@CF00165 DC    F'3'                                                     16172000
@CH00165 EQU   @CF00165+2                                               16173000
@CF00046 DC    F'4'                                                     16174000
@CH00046 EQU   @CF00046+2                                               16175000
@CF00041 DC    F'6'                                                     16176000
@CH00041 EQU   @CF00041+2                                               16177000
@CF00039 DC    F'8'                                                     16178000
@CH00039 EQU   @CF00039+2                                               16179000
@CF00035 DC    F'12'                                                    16180000
@CH00035 EQU   @CF00035+2                                               16181000
@CF00483 DC    F'16'                                                    16182000
@CF00964 DC    F'17'                                                    16183000
@CF00966 DC    F'18'                                                    16184000
@CH00966 EQU   @CF00966+2                                               16185000
@CF00312 DC    F'24'                                                    16186000
@CH00312 EQU   @CF00312+2                                               16187000
@CF01127 DC    F'40'                                                    16188000
@CH01127 EQU   @CF01127+2                                               16189000
@CF01390 DC    F'45'                                                    16190000
@CH01390 EQU   @CF01390+2                                               16191000
@CF01741 DC    F'52'                                                    16192000
@CH01741 EQU   @CF01741+2                                               16193000
@CF01129 DC    F'72'                                                    16194000
@CF01131 DC    F'76'                                                    16195000
@CF01137 DC    F'240'                                                   16196000
@CF00615 DC    F'255'                                                   16197000
@CF01753 DC    F'760'                                                   16198000
@CF01762 DC    F'952'                                                   16199000
@CF00917 DC    F'2044'                                                  16200000
@CF01302 DC    F'2048'                                                  16201000
@CF01798 DC    F'-41'                                                   16202000
@CF01804 DC    F'-12'                                                   16203000
@CF01806 DC    F'-8'                                                    16204000
@CF01805 DC    F'-7'                                                    16205000
@CF01786 DC    F'-6'                                                    16206000
@CF01803 DC    F'-5'                                                    16207000
@CF01779 DC    F'-4'                                                    16208000
@DATD    DSECT                                                          16209000
         DS    0D                                                       16210000
LISTSCAN DS    A                                                        16211000
IOCSPTR  DS    A                                                        16212000
OPNPTR   DS    A                                                        16213000
DDSTRU   DS    A                                                        16214000
FSADDR   DS    A                                                        16215000
ERCNVADR DS    A                                                        16216000
DMPINDEX DS    A                                                        16217000
CTGPLPTR DS    A                                                        16218000
CTGFLPTR DS    A                                                        16219000
CTGFVPTR DS    A                                                        16220000
DSCCATPT DS    A                                                        16221000
BLKSIZ   DS    F                                                        16222000
TOTLEN   DS    F                                                        16223000
FNMPTR   DS    A                                                        16224000
PWORKAR  DS    A                                                        16225000
UCWORKAR DS    A                                                        16226000
NVWORKAR DS    A                                                        16227000
GDWORKAR DS    A                                                        16228000
ALWORKAR DS    A                                                        16229000
PFVTPTR  DS    A                                                        16230000
UCFVTPTR DS    A                                                        16231000
NVFVTPTR DS    A                                                        16232000
GDFVTPTR DS    A                                                        16233000
ALFVTPTR DS    A                                                        16234000
PTRCPL   DS    A                                                        16235000
PPTRCPL  DS    A                                                        16236000
UCPTRCPL DS    A                                                        16237000
NVPTRCPL DS    A                                                        16238000
ALPTRCPL DS    A                                                        16239000
GDPTRCPL DS    A                                                        16240000
DCPLPTR  DS    A                                                        16241000
CPSWD    DS    A                                                        16242000
SAVCPLLN DS    F                                                        16243000
NVSAVFVT DS    A                                                        16244000
UCSAVFVT DS    A                                                        16245000
GDSAVFVT DS    A                                                        16246000
PINIOCS  DS    A                                                        16247000
POUTIOCS DS    A                                                        16248000
PTRCTACB DS    A                                                        16249000
CONRCPTR DS    A                                                        16250000
DICTPTR  DS    A                                                        16251000
ALLPTR   DS    A                                                        16252000
DALCINDX DS    F                                                        16253000
ENTRYNO  DS    F                                                        16254000
FX       DS    F                                                        16255000
I        DS    F                                                        16256000
IX       DS    F                                                        16257000
N        DS    F                                                        16258000
J        DS    F                                                        16259000
ACPLPTR  DS    A                                                        16260000
AFVTPTR  DS    A                                                        16261000
ZPTR     DS    A                                                        16262000
IOINFPTR DS    A                                                        16263000
DSNRETPT DS    A                                                        16264000
CPLPROCI DS    F                                                        16265000
APSWD    DS    A                                                        16266000
NFPLADDR DS    A                                                        16267000
NFIELDPT DS    A                                                        16268000
FRANPTR1 DS    A                                                        16269000
RPTR1    DS    A                                                        16270000
RPTR2    DS    A                                                        16271000
INXVOLSR DS    F                                                        16272000
FDEVTPTR DS    A                                                        16273000
FSEQPTR  DS    A                                                        16274000
WSIZE    DS    F                                                        16275000
VOLLSTPT DS    A                                                        16276000
JX       DS    F                                                        16277000
JX1      DS    F                                                        16278000
IX1      DS    F                                                        16279000
K        DS    F                                                        16280000
SIZENEED DS    F                                                        16281000
DALGLPTR DS    A                                                        16282000
MFPTR    DS    A                                                        16283000
MTPTR    DS    A                                                        16284000
FPLADDR  DS    A                                                        16285000
FIELDPTR DS    A                                                        16286000
DICENPTR DS    A                                                        16287000
RDBUF    DS    A                                                        16288000
ALSAVFVT DS    A                                                        16289000
FLISTPTR DS    A                                                        16290000
HILN     DS    F                                                        16291000
INDX     DS    F                                                        16292000
KEYLENGH DS    F                                                        16293000
LISTPTR  DS    A                                                        16294000
LOWLN    DS    F                                                        16295000
RECSZ    DS    F                                                        16296000
SAVFVTV  DS    A                                                        16297000
SETRC    DS    H                                                        16298000
TESTRC   DS    H                                                        16299000
QUALLEN  DS    H                                                        16300000
TFVTLEN  DS    H                                                        16301000
NUMCOMP  DS    H                                                        16302000
NUMOBJ   DS    H                                                        16303000
ZSIZE    DS    H                                                        16304000
LENG     DS    H                                                        16305000
NUMVOL   DS    H                                                        16306000
NUMFSEQ  DS    H                                                        16307000
LIMIT    DS    H                                                        16308000
CURSIZE  DS    H                                                        16309000
PLIMIT   DS    H                                                        16310000
M1SIZE   DS    H                                                        16311000
GMLEN    DS    H                                                        16312000
RDLEN    DS    H                                                        16313000
NUMDTYP  DS    H                                                        16314000
TOTLENH  DS    H                                                        16315000
DEFSTID  DS    FL1                                                      16316000
LISTLN   DS    FL1                                                      16317000
@TS00001 DS    CL95                                                     16318000
ERRORTAB DS    CL32                                                     16319000
         DS    CL3                                                      16320000
@NM00052 DS    CL10                                                     16321000
         ORG   @NM00052                                                 16322000
CATRTNID DS    CL8                                                      16323000
CATLGRC  DS    FL2                                                      16324000
         ORG   @NM00052+10                                              16325000
         DS    CL2                                                      16326000
CATRCVWK DS    CL10                                                     16327000
         ORG   CATRCVWK                                                 16328000
RCVLN    DS    FL2                                                      16329000
RCVRLN   DS    FL2                                                      16330000
CATRCWKA DS    CL6                                                      16331000
         ORG   CATRCVWK+10                                              16332000
PCOREFLG DS    BL1                                                      16333000
SAVCPL   DS    CL44                                                     16334000
PSAVCPL  DS    CL28                                                     16335000
IMPFLG   DS    BL1                                                      16336000
         ORG   IMPFLG                                                   16337000
IMPUNIQ  DS    BL1                                                      16338000
IMPINHTG EQU   IMPFLG+0                                                 16339000
IMPASSOC EQU   IMPFLG+0                                                 16340000
IMPBASE  EQU   IMPFLG+0                                                 16341000
IMPNTUSD EQU   IMPFLG+0                                                 16342000
         ORG   IMPFLG+1                                                 16343000
KSDSFLAG DS    BL1                                                      16344000
IMPFLG2  DS    BL1                                                      16345000
         ORG   IMPFLG2                                                  16346000
IMPF2VOL DS    BL1                                                      16347000
IMPF2DEL EQU   IMPFLG2+0                                                16348000
IMPF2OBJ EQU   IMPFLG2+0                                                16349000
IMPF2NOD EQU   IMPFLG2+0                                                16350000
IMPF2NER EQU   IMPFLG2+0                                                16351000
IMPF2RES EQU   IMPFLG2+0                                                16352000
         ORG   IMPFLG2+1                                                16353000
IMPMFLAG DS    BL1                                                      16354000
         ORG   IMPMFLAG                                                 16355000
IMPMFIMF DS    BL1                                                      16356000
IMPMFDNM EQU   IMPMFLAG+0                                               16357000
IMPMFRES EQU   IMPMFLAG+0                                               16358000
         ORG   IMPMFLAG+1                                               16359000
         DS    CL1                                                      16360000
CONRCARE DS    CL268                                                    16361000
ALLLIST  DS    CL31                                                     16362000
         DS    CL1                                                      16363000
QUALLIST DS    CL12                                                     16364000
         ORG   QUALLIST                                                 16365000
QUALADDR DS    AL4                                                      16366000
QUALCAT  DS    AL4                                                      16367000
QUALPAS  DS    AL4                                                      16368000
         ORG   QUALLIST+12                                              16369000
DEALLOC  DS    BL1                                                      16370000
UNIQD    DS    BL1                                                      16371000
UNIQI    DS    BL1                                                      16372000
IUNIQFVT DS    CL92                                                     16373000
ZCNTRL   DS    BL1                                                      16374000
IOINFBYT DS    CL1                                                      16375000
         DS    CL3                                                      16376000
DSNRET   DS    CL52                                                     16377000
         ORG   DSNRET                                                   16378000
DSNRETAL DS    FL2                                                      16379000
DSNRETFL DS    FL2                                                      16380000
DSNRETIN DS    CL48                                                     16381000
         ORG   DSNRETIN                                                 16382000
DSNRETTP DS    CL2                                                      16383000
DSNRETLN DS    FL2                                                      16384000
DSNRETNM DS    CL44                                                     16385000
         ORG   DSNRET+52                                                16386000
ENDFLAG  DS    BL1                                                      16387000
GETEOF   DS    BL1                                                      16388000
GETREO   DS    BL1                                                      16389000
SAVRELNM DS    CL44                                                     16390000
NVSMRDSW DS    BL1                                                      16391000
DELTWKA  DS    CL544                                                    16392000
         ORG   DELTWKA                                                  16393000
@NM00053 DS    FL2                                                      16394000
@NM00054 DS    FL2                                                      16395000
@NM00055 DS    12CL45                                                   16396000
         ORG   DELTWKA+544                                              16397000
AFVT     DS    CL92                                                     16398000
VOLLSTOR DS    CL10                                                     16399000
DSAVCPL  DS    CL28                                                     16400000
COREFLAG DS    BL1                                                      16401000
         DS    CL1                                                      16402000
ALGLSAVE DS    CL20                                                     16403000
         ORG   ALGLSAVE                                                 16404000
ALSAVPTR DS    0A                                                       16405000
         ORG   ALGLSAVE+20                                              16406000
OPENLIST DS    BL48                                                     16407000
OPENSAVE DS    BL48                                                     16408000
DOCNTRL  DS    BL1                                                      16409000
GDOCNTRL DS    BL1                                                      16410000
ALISFIR  DS    BL1                                                      16411000
DEFSTMOD DS    CL3                                                      16412000
HKEY     DS    CL64                                                     16413000
KERROR   DS    BL1                                                      16414000
LKEY     DS    CL64                                                     16415000
RDOCNTRL DS    BL1                                                      16416000
RENEWCPL DS    CL28                                                     16417000
PRINTTAB DS    9F                                                       16418000
WORKAR   DS    3A                                                       16419000
FVTPTR   DS    3A                                                       16420000
SAVFVT   DS    3A                                                       16421000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                16422000
@ENDDATD EQU   *                                                        16423000
IDCRM01  CSECT                                                          16424000
         DS    0F                                                       16425000
@SIZDATD DC    AL1(0)                                                   16426000
         DC    AL3(@ENDDATD-@DATD)                                      16427000
         DS    0D                                                       16428000
NULLPARM DC    A(0)                                                     16429000
CFPLNUM  DC    H'12'                                                    16430000
LNAMEDS  DC    H'4'                                                     16431000
@CC01552 DC    C'CATLGRTN'                                              16432000
@CC01300 DC    C'RMBG'                                                  16433000
@CC01330 DC    C'RMEL'                                                  16434000
@CC01331 DC    C'RMFN'                                                  16435000
@CC01335 DC    C'RMCP'                                                  16436000
@CC01336 DC    C'RMCT'                                                  16437000
@CC01359 DC    C'RMDV'                                                  16438000
@CC01362 DC    C'RMPT'                                                  16439000
@CC01370 DC    C'RMCE'                                                  16440000
@CC01392 DC    C'RMPL'                                                  16441000
@CC01394 DC    C'RMCL'                                                  16442000
@CC01398 DC    C'RMUQ'                                                  16443000
@CC01405 DC    C'RMAT'                                                  16444000
@CC01411 DC    C'RMUC'                                                  16445000
@CC01419 DC    C'RMDU'                                                  16446000
@CC01424 DC    C'RMNV'                                                  16447000
@CC01433 DC    C'RMDN'                                                  16448000
@CC01439 DC    C'RMAL'                                                  16449000
@CC01454 DC    C'RMNF'                                                  16450000
@CC01461 DC    C'RMGD'                                                  16451000
@CC01464 DC    C'RMDG'                                                  16452000
@CC01496 DC    C'RMRG'                                                  16453000
@CC01525 DC    C'RMLV'                                                  16454000
@CC01550 DC    C'RMSP'                                                  16455000
@CC01551 DC    C'RMZZ'                                                  16456000
@CC01578 DC    C'RMDL'                                                  16457000
@CC01579 DC    C'RMDC'                                                  16458000
@CC01586 DC    C'RMDD'                                                  16459000
@CC01618 DC    C'RMDA'                                                  16460000
@CC01647 DC    C'RMOP'                                                  16461000
@CC01677 DC    C'RMBF'                                                  16462000
@CC01709 DC    C'RMFV'                                                  16463000
@CC01727 DC    C'RMPS'                                                  16464000
@CC00945 DC    C'MP0'                                                   16465000
@CC00981 DC    C'UV0'                                                   16466000
@CC00989 DC    C'DL0'                                                   16467000
@CC00996 DC    C'DE0'                                                   16468000
@CC00751 EQU   @CC00989                                                 16469000
@CC00753 DC    C'I'                                                     16470000
@CC00755 DC    C'A'                                                     16471000
@CC00757 EQU   @CC00981                                                 16472000
@CC00767 DC    C'F'                                                     16473000
@CC01650 DC    C'O'                                                     16474000
@CC01681 DC    C'S'                                                     16475000
ALL      DC    CL3'ALL'                                                 16476000
FORMAT   DC    CL4'FORM'                                                16477000
HSECOND  DC    CL4'HSEC'                                                16478000
CLOCK    DC    CL4'KLOK'                                                16479000
SETZERO  DC    CL4'ZERO'                                                16480000
SETBLANK DC    CL4'BLNK'                                                16481000
NOSET    DC    CL4'NSET'                                                16482000
OVERRIDE DC    CL4'OVRD'                                                16483000
ACQUIRE  DC    CL8'ACQUIRE '                                            16484000
RELINQ   DC    CL8'RELINQ  '                                            16485000
MOUNT    DC    CL8'MOUNT   '                                            16486000
DEMOUNT  DC    CL8'DEMOUNT '                                            16487000
DEFINE   DC    CL8'DEFINE  '                                            16488000
MOVE     DC    CL8'MOVE    '                                            16489000
TRACEQ   DC    CL8'TRACEQ  '                                            16490000
COPYTABL DC    CL8'COPYTABL'                                            16491000
COPYCRTG DC    CL8'COPYCRTG'                                            16492000
COPYVOL  DC    CL8'COPYVOL '                                            16493000
VVIC     DC    CL8'VVIC    '                                            16494000
TUNE     DC    CL8'TUNE    '                                            16495000
NAMES    DC    CL4'NAME'                                                16496000
UNIT     DC    CL4'UNIT'                                                16497000
SHR      DC    CL4'SHR '                                                16498000
EXCL     DC    CL4'EXCL'                                                16499000
NOWAIT   DC    CL4'NWAI'                                                16500000
WAIT     DC    CL4'WAIT'                                                16501000
MODID    DC    CL4'RM01'                                                16502000
GPID     DC    CL4'RM01'                                                16503000
FIXAREA  DS    CL768                                                    16504000
         ORG   FIXAREA                                                  16505000
@NM00044 DS    CL256                                                    16506000
         ORG   @NM00044                                                 16507000
@NM00045 DC    256X'00'                                                 16508000
         ORG   FIXAREA+256                                              16509000
@NM00046 DS    CL256                                                    16510000
         ORG   @NM00046                                                 16511000
@NM00047 DC    256X'00'                                                 16512000
         ORG   FIXAREA+512                                              16513000
@NM00048 DS    CL256                                                    16514000
         ORG   @NM00048                                                 16515000
@NM00049 DC    256X'00'                                                 16516000
         ORG   FIXAREA+768                                              16517000
FPASNAME DC    CL8'PASSWALL'                                            16518000
FNDEVTYP DC    CL8'DEVTYP  '                                            16519000
CNTREPNO DC    CL8'CNTREPNO'                                            16520000
ZEROS    DC    X'00'                                                    16521000
         DC    XL5'0'                                                   16522000
ZER      DC    X'00'                                                    16523000
         DC    XL255'0'                                                 16524000
FFS      DS    CL64                                                     16525000
         ORG   FFS                                                      16526000
@NM00056 DC    64X'FF'                                                  16527000
         ORG   FFS+64                                                   16528000
DALCUNIT DS    CL12                                                     16529000
         ORG   DALCUNIT                                                 16530000
DL#UNIT  DC    H'1'                                                     16531000
DLUNITLN DC    H'8'                                                     16532000
DLUNIT   DC    CL8'SYSALLDA'                                            16533000
         ORG   DALCUNIT+12                                              16534000
FIELDLST DC    CL8'ENTYPE  '                                            16535000
         DC    CL8'ENTNAME '                                            16536000
         DC    CL8'DSATTR  '                                            16537000
         DC    CL8'OWNERID '                                            16538000
         DC    CL8'DSETCRDT'                                            16539000
         DC    CL8'DSETEXDT'                                            16540000
         DC    CL8'BUFSIZE '                                            16541000
         DC    CL8'LRECL   '                                            16542000
         DC    CL8'SPACPARM'                                            16543000
         DC    CL8'PASSWORD'                                            16544000
         DC    CL8'PASSPRMT'                                            16545000
         DC    CL8'PASSATMP'                                            16546000
         DC    CL8'USVRMDUL'                                            16547000
         DC    CL8'USERAREC'                                            16548000
         DC    CL8'LOKEYV  '                                            16549000
         DC    CL8'HIKEYV  '                                            16550000
         DC    CL8'VOLSER  '                                            16551000
         DC    CL8'AMDSBCAT'                                            16552000
         DC    CL8'EXCPEXIT'                                            16553000
         DC    CL8'RGATTR  '                                            16554000
         DC    CL8'SECFLAGS'                                            16555000
         DC    CL8'CATACB  '                                            16556000
         DC    CL8'NAMEDS  '                                            16557000
         DC    CL8'HURBADS '                                            16558000
NVFLIST  DC    CL8'ENTYPE  '                                            16559000
         DC    CL8'ENTNAME '                                            16560000
         DC    CL8'VOLSER  '                                            16561000
         DC    CL8'DEVTYP  '                                            16562000
         DC    CL8'FILESEQ '                                            16563000
         DC    CL8'OWNERID '                                            16564000
         DC    CL8'DSETCRDT'                                            16565000
         DC    CL8'DSETEXDT'                                            16566000
GDFLIST  DC    CL8'ENTYPE  '                                            16567000
         DC    CL8'ENTNAME '                                            16568000
         DC    CL8'GDGLIMIT'                                            16569000
         DC    CL8'GDGATTR '                                            16570000
         DC    CL8'OWNERID '                                            16571000
         DC    CL8'DSETCRDT'                                            16572000
         DC    CL8'DSETEXDT'                                            16573000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       16574000
@01      EQU   01                                                       16575000
@02      EQU   02                                                       16576000
@03      EQU   03                                                       16577000
@04      EQU   04                                                       16578000
@05      EQU   05                                                       16579000
@06      EQU   06                                                       16580000
@07      EQU   07                                                       16581000
@08      EQU   08                                                       16582000
@09      EQU   09                                                       16583000
@10      EQU   10                                                       16584000
@11      EQU   11                                                       16585000
@12      EQU   12                                                       16586000
@13      EQU   13                                                       16587000
@14      EQU   14                                                       16588000
@15      EQU   15                                                       16589000
RTNREG   EQU   @15                                                      16590000
REG15    EQU   @15                                                      16591000
REG0     EQU   @00                                                      16592000
REG1     EQU   @01                                                      16593000
REG10    EQU   @10                                                      16594000
REG11    EQU   @11                                                      16595000
REG12    EQU   @12                                                      16596000
REG13    EQU   @13                                                      16597000
REG14    EQU   @14                                                      16598000
REG2     EQU   @02                                                      16599000
REG3     EQU   @03                                                      16600000
REG4     EQU   @04                                                      16601000
REG5     EQU   @05                                                      16602000
REG6     EQU   @06                                                      16603000
REG7     EQU   @07                                                      16604000
REG8     EQU   @08                                                      16605000
REG9     EQU   @09                                                      16606000
IDCSAEP0 EQU   0                                                        16607000
IDCSAFS0 EQU   0                                                        16608000
IDCSAGP0 EQU   0                                                        16609000
IDCSAFP0 EQU   0                                                        16610000
IDCSACA0 EQU   0                                                        16611000
IDCSAAL0 EQU   0                                                        16612000
IDCSADL0 EQU   0                                                        16613000
IDCSAQL0 EQU   0                                                        16614000
TRACE1   EQU   0                                                        16615000
OLDERID1 EQU   TRACE1                                                   16616000
TRACE2   EQU   0                                                        16617000
OLDERID2 EQU   TRACE2                                                   16618000
NEWID2   EQU   TRACE2+95                                                16619000
NEWERID2 EQU   5                                                        16620000
CIRAGL   EQU   0                                                        16621000
CIRTYPE  EQU   CIRAGL                                                   16622000
ALLAGL   EQU   0                                                        16623000
ALLDSN   EQU   ALLAGL                                                   16624000
ALLDDN   EQU   ALLAGL+4                                                 16625000
ALLULP   EQU   ALLAGL+12                                                16626000
ALLVLP   EQU   ALLAGL+16                                                16627000
ALLSTS   EQU   ALLAGL+24                                                16628000
ALLSTSOD EQU   ALLSTS                                                   16629000
ALLDSP   EQU   ALLAGL+25                                                16630000
ALLDSPKP EQU   ALLDSP                                                   16631000
ALLORG   EQU   ALLAGL+26                                                16632000
ALLOPT   EQU   ALLAGL+28                                                16633000
ALLOPTVL EQU   ALLOPT                                                   16634000
ALLOPTDS EQU   ALLOPT                                                   16635000
UNITABL  EQU   0                                                        16636000
UNITADR  EQU   UNITABL+4                                                16637000
@NM00010 EQU   UNITADR                                                  16638000
UNITSTAT EQU   UNITABL+6                                                16639000
IDCIOOP0 EQU   0                                                        16640000
IDCIOCL0 EQU   0                                                        16641000
IDCIOGT0 EQU   0                                                        16642000
IDCIOCO0 EQU   0                                                        16643000
IDCIOSI0 EQU   0                                                        16644000
IOCSTR   EQU   0                                                        16645000
IOCDAD   EQU   IOCSTR                                                   16646000
IOCDLN   EQU   IOCSTR+4                                                 16647000
IOCDSO   EQU   IOCSTR+16                                                16648000
IOCRFM   EQU   IOCSTR+17                                                16649000
IOCMAC   EQU   IOCSTR+18                                                16650000
IOCMAC2  EQU   IOCSTR+19                                                16651000
IOCCHP   EQU   IOCSTR+20                                                16652000
IOCMSG   EQU   IOCSTR+21                                                16653000
IOCMSGOP EQU   IOCMSG                                                   16654000
IOCRBA   EQU   IOCSTR+40                                                16655000
IOCTTR   EQU   IOCRBA                                                   16656000
IOCMEM   EQU   IOCSTR+44                                                16657000
IOCNWM   EQU   IOCSTR+48                                                16658000
IOCREL   EQU   IOCSTR+60                                                16659000
OPNAGL   EQU   0                                                        16660000
OPNOPT   EQU   OPNAGL                                                   16661000
OPNOPTIN EQU   OPNOPT                                                   16662000
OPNOPTOT EQU   OPNOPT                                                   16663000
OPNRFM   EQU   OPNAGL+1                                                 16664000
OPNRFMSF EQU   OPNRFM                                                   16665000
OPNRFMBK EQU   OPNRFM                                                   16666000
OPNTYP   EQU   OPNAGL+2                                                 16667000
OPNTYPXM EQU   OPNTYP                                                   16668000
OPNTYPRV EQU   OPNTYP                                                   16669000
OPNTYPSY EQU   OPNTYP                                                   16670000
OPNMOD   EQU   OPNAGL+3                                                 16671000
OPNMODAX EQU   OPNMOD                                                   16672000
OPNIOC   EQU   OPNAGL+4                                                 16673000
OPNDDN   EQU   OPNAGL+8                                                 16674000
OPNPWA   EQU   OPNAGL+12                                                16675000
OPNDSN   EQU   OPNAGL+16                                                16676000
OPNDEV   EQU   OPNAGL+24                                                16677000
OPNDEVDT EQU   OPNDEV                                                   16678000
OPNREC   EQU   OPNAGL+32                                                16679000
OPNBLK   EQU   OPNAGL+36                                                16680000
OPNDSO   EQU   OPNAGL+41                                                16681000
OPNOPT2  EQU   OPNAGL+42                                                16682000
IOINFOPT EQU   0                                                        16683000
IOINFDSN EQU   IOINFOPT                                                 16684000
UVOLLIST EQU   0                                                        16685000
UVOLENT  EQU   UVOLLIST+2                                               16686000
AMSTP011 EQU   0                                                        16687000
IDCTPER0 EQU   0                                                        16688000
DARGLIST EQU   0                                                        16689000
DARGDBP  EQU   DARGLIST                                                 16690000
DARGSTID EQU   DARGLIST+8                                               16691000
DARGSMOD EQU   DARGSTID                                                 16692000
DARGSENT EQU   DARGSTID+3                                               16693000
DARGILP  EQU   DARGLIST+12                                              16694000
DARGCNT  EQU   DARGLIST+14                                              16695000
DARGFLGS EQU   DARGLIST+19                                              16696000
DARGARY  EQU   DARGLIST+20                                              16697000
DARGINS  EQU   DARGARY                                                  16698000
DARGINL  EQU   DARGARY+2                                                16699000
DARGPCT  EQU   DARGINL                                                  16700000
DARGDTM  EQU   DARGARY+4                                                16701000
FMTLIST  EQU   0                                                        16702000
FMTFLGS  EQU   FMTLIST                                                  16703000
FMTSPF   EQU   FMTLIST+2                                                16704000
FMTRFNO  EQU   FMTSPF                                                   16705000
FMTILEN  EQU   FMTRFNO                                                  16706000
FMTIOFF  EQU   FMTLIST+4                                                16707000
FMTTRBC  EQU   FMTIOFF                                                  16708000
FMTSTO   EQU   FMTTRBC                                                  16709000
FMTOCOL  EQU   FMTLIST+6                                                16710000
FMTCNVF  EQU   FMTLIST+10                                               16711000
ERCNVTAB EQU   0                                                        16712000
ERTYPE   EQU   ERCNVTAB                                                 16713000
ERCATLG  EQU   ERTYPE                                                   16714000
EROPER   EQU   ERCNVTAB+1                                               16715000
ERCATDE  EQU   EROPER                                                   16716000
ERCATDL  EQU   EROPER                                                   16717000
ERCATAL  EQU   EROPER                                                   16718000
EROSOPER EQU   ERCNVTAB+2                                               16719000
ERDSNM   EQU   ERCNVTAB+12                                              16720000
ERCATRC  EQU   ERCNVTAB+16                                              16721000
ERCPLPT  EQU   ERCNVTAB+20                                              16722000
IDCDB010 EQU   0                                                        16723000
DMPITM   EQU   0                                                        16724000
DMPARY   EQU   0                                                        16725000
IN       EQU   0                                                        16726000
INDS     EQU   0                                                        16727000
INDSPLN  EQU   INDS                                                     16728000
INDSPAS  EQU   INDS+1                                                   16729000
INDSFLG  EQU   INDS+10                                                  16730000
INDSFUQ  EQU   INDSFLG                                                  16731000
INDSLEN  EQU   INDS+20                                                  16732000
INDSVAL  EQU   INDS+21                                                  16733000
OUTDD    EQU   0                                                        16734000
OUTDDPLN EQU   OUTDD                                                    16735000
OUTDDPAS EQU   OUTDD+1                                                  16736000
OUTDDVAL EQU   OUTDD+10                                                 16737000
OBJTS    EQU   0                                                        16738000
OBJTSCNT EQU   0                                                        16739000
OBJNMPTR EQU   0                                                        16740000
OBJNM    EQU   0                                                        16741000
OBJNMFLG EQU   OBJNM+10                                                 16742000
OBJNMVAL EQU   OBJNM+21                                                 16743000
OBJFLPTR EQU   0                                                        16744000
OBJFL    EQU   0                                                        16745000
OBJFLVAL EQU   OBJFL+1                                                  16746000
LISTVPTR EQU   0                                                        16747000
LISTV    EQU   0                                                        16748000
LISTVCNT EQU   LISTV                                                    16749000
@NM00032 EQU   LISTV+2                                                  16750000
LISTVVAL EQU   @NM00032+1                                               16751000
DEVTPTR  EQU   0                                                        16752000
DEVT     EQU   0                                                        16753000
DEVTCNT  EQU   DEVT                                                     16754000
@NM00033 EQU   DEVT+2                                                   16755000
DEVTVAL  EQU   @NM00033+1                                               16756000
INDD     EQU   0                                                        16757000
INDDVAL  EQU   INDD+1                                                   16758000
ENV      EQU   0                                                        16759000
BLKSZ    EQU   0                                                        16760000
BLKSZVAL EQU   BLKSZ                                                    16761000
PDEV     EQU   0                                                        16762000
PDEVVAL  EQU   PDEV+1                                                   16763000
CAT      EQU   0                                                        16764000
CATPLN   EQU   CAT                                                      16765000
CATPAS   EQU   CAT+1                                                    16766000
CATFLG   EQU   CAT+10                                                   16767000
CATVAL   EQU   CAT+21                                                   16768000
SRAC     EQU   0                                                        16769000
CTGPL    EQU   0                                                        16770000
CTGOPTN1 EQU   CTGPL                                                    16771000
CTGMAST  EQU   CTGOPTN1                                                 16772000
CTGNAME  EQU   CTGOPTN1                                                 16773000
CTGCNAME EQU   CTGOPTN1                                                 16774000
CTGOPTN2 EQU   CTGPL+1                                                  16775000
CTGEXT   EQU   CTGOPTN2                                                 16776000
CTGERASE EQU   CTGOPTN2                                                 16777000
CTGSMF   EQU   CTGERASE                                                 16778000
CTGREL   EQU   CTGSMF                                                   16779000
CTGPURG  EQU   CTGOPTN2                                                 16780000
CTGVMNT  EQU   CTGPURG                                                  16781000
CTGRCATN EQU   CTGVMNT                                                  16782000
CTGDISC  EQU   CTGOPTN2                                                 16783000
CTGOVRID EQU   CTGOPTN2                                                 16784000
CTGSCR   EQU   CTGOPTN2                                                 16785000
CTGOPTN3 EQU   CTGPL+2                                                  16786000
CTGFUNC  EQU   CTGOPTN3                                                 16787000
CTGNUM   EQU   CTGOPTN3                                                 16788000
CTGAM0   EQU   CTGOPTN3                                                 16789000
CTGOPTN4 EQU   CTGPL+3                                                  16790000
CTGNPROF EQU   CTGOPTN4                                                 16791000
CTGENT   EQU   CTGPL+4                                                  16792000
CTGFVT   EQU   CTGENT                                                   16793000
CTGCAT   EQU   CTGPL+8                                                  16794000
CTGWKA   EQU   CTGPL+12                                                 16795000
CTGDSORG EQU   CTGPL+16                                                 16796000
CTGOPTNS EQU   CTGDSORG                                                 16797000
CTGTYPE  EQU   CTGPL+18                                                 16798000
CTGDDNM  EQU   CTGPL+20                                                 16799000
CTGNEWNM EQU   CTGDDNM                                                  16800000
CTGFBFLG EQU   CTGNEWNM+2                                               16801000
CTGJSCB  EQU   CTGPL+24                                                 16802000
CTGPSWD  EQU   CTGJSCB                                                  16803000
CTGFL    EQU   0                                                        16804000
CTGFLDNO EQU   CTGFL                                                    16805000
CTGFLDCD EQU   CTGFL+1                                                  16806000
CTGFLDRE EQU   CTGFL+3                                                  16807000
CTGFLDNM EQU   CTGFL+8                                                  16808000
CTGFLCHN EQU   CTGFL+12                                                 16809000
CTGFLDAT EQU   CTGFL+16                                                 16810000
CTGFLNG  EQU   CTGFLDAT                                                 16811000
CTGFLPT  EQU   CTGFLDAT+4                                               16812000
CTGFV    EQU   0                                                        16813000
CTGFVTYP EQU   CTGFV                                                    16814000
CTGFVPRO EQU   CTGFV+1                                                  16815000
CTGFVNDC EQU   CTGFVPRO                                                 16816000
CTGFVRON EQU   CTGFVPRO                                                 16817000
CTGFVDCH EQU   CTGFV+4                                                  16818000
CTGFVICH EQU   CTGFV+8                                                  16819000
CTGFVVCH EQU   CTGFV+12                                                 16820000
CTGFVIND EQU   CTGFV+16                                                 16821000
CTGFVENT EQU   CTGFV+20                                                 16822000
CTGFVSTY EQU   CTGFV+24                                                 16823000
CTGFVOWN EQU   CTGFV+28                                                 16824000
CTGFVEXP EQU   CTGFV+32                                                 16825000
CTGFVCRE EQU   CTGFV+36                                                 16826000
CTGFVVLT EQU   CTGFV+40                                                 16827000
CTGFVRNG EQU   CTGFV+44                                                 16828000
CTGFVDVT EQU   CTGFV+48                                                 16829000
CTGFVSPC EQU   CTGFV+52                                                 16830000
CTGFVAMD EQU   CTGFV+56                                                 16831000
CTGFVFSN EQU   CTGFVAMD                                                 16832000
CTGFVATR EQU   CTGFV+60                                                 16833000
CTGFVBUF EQU   CTGFV+64                                                 16834000
CTGFVLRS EQU   CTGFV+68                                                 16835000
CTGFVLMT EQU   CTGFV+72                                                 16836000
CTGFVEXT EQU   CTGFVLMT                                                 16837000
CTGFVGAT EQU   CTGFV+76                                                 16838000
CTGFVUPG EQU   CTGFVGAT                                                 16839000
CTGFVNAM EQU   CTGFV+80                                                 16840000
CTGFVPWD EQU   CTGFV+84                                                 16841000
CTGFVWKA EQU   CTGFV+88                                                 16842000
IDAAMDSB EQU   0                                                        16843000
AMDATTR  EQU   IDAAMDSB+1                                               16844000
AMDLEN   EQU   IDAAMDSB+2                                               16845000
AMDNEST  EQU   IDAAMDSB+4                                               16846000
AMDAXRKP EQU   AMDNEST                                                  16847000
AMDRKP   EQU   IDAAMDSB+6                                               16848000
AMDKEYLN EQU   IDAAMDSB+8                                               16849000
AMDPCTCA EQU   IDAAMDSB+10                                              16850000
AMDPCTCI EQU   IDAAMDSB+11                                              16851000
AMDCINV  EQU   IDAAMDSB+20                                              16852000
AMDLRECL EQU   IDAAMDSB+24                                              16853000
AMDHLRBA EQU   IDAAMDSB+28                                              16854000
AMDSSRBA EQU   IDAAMDSB+32                                              16855000
AMDATTR3 EQU   IDAAMDSB+40                                              16856000
AMDSTAT  EQU   IDAAMDSB+48                                              16857000
FIELDR   EQU   0                                                        16858000
FENTYPE  EQU   0                                                        16859000
FENTNAME EQU   0                                                        16860000
FDSATTR  EQU   0                                                        16861000
FDSUNIQ  EQU   FDSATTR                                                  16862000
FLVOLSER EQU   0                                                        16863000
FIELDVR  EQU   0                                                        16864000
FPASSWAL EQU   0                                                        16865000
FPASWD   EQU   FPASSWAL                                                 16866000
FPASSPRM EQU   FPASSWAL+32                                              16867000
FPASSATM EQU   FPASSWAL+40                                              16868000
FUSVRMDU EQU   FPASSWAL+42                                              16869000
FUSERARE EQU   FPASSWAL+50                                              16870000
FUSERLN  EQU   FUSERARE                                                 16871000
FLISTVOL EQU   0                                                        16872000
FLISTLN  EQU   FLISTVOL                                                 16873000
FVOLSERL EQU   FLISTVOL+2                                               16874000
FVOLRTN  EQU   FVOLSERL                                                 16875000
FVOLSER  EQU   FVOLSERL+2                                               16876000
FNAMEDS  EQU   0                                                        16877000
RCDSECF  EQU   0                                                        16878000
RCDEXSEC EQU   RCDSECF                                                  16879000
WORKAREA EQU   0                                                        16880000
AREALN   EQU   WORKAREA                                                 16881000
RETURNLN EQU   WORKAREA+2                                               16882000
ENTLIST  EQU   WORKAREA+4                                               16883000
ENTITEM  EQU   ENTLIST                                                  16884000
ENTRYTYP EQU   ENTITEM                                                  16885000
ENTRYNM  EQU   ENTITEM+1                                                16886000
CONREC   EQU   0                                                        16887000
HEADER   EQU   CONREC                                                   16888000
HEADLN   EQU   HEADER                                                   16889000
HEADFLG1 EQU   HEADER+2                                                 16890000
HEADFLG2 EQU   HEADER+3                                                 16891000
RECORDSZ EQU   HEADER+4                                                 16892000
ASSRECLN EQU   RECORDSZ                                                 16893000
VARDATA  EQU   CONREC+8                                                 16894000
DICT     EQU   0                                                        16895000
DICTEN   EQU   DICT+4                                                   16896000
DICTLN   EQU   DICTEN                                                   16897000
DICTDL   EQU   DICTEN+4                                                 16898000
TIMESTMP EQU   0                                                        16899000
TEXOJCT  EQU   TIMESTMP                                                 16900000
TEXFLG   EQU   TIMESTMP+1                                               16901000
TEXNVS   EQU   TEXFLG                                                   16902000
TEXGDG   EQU   TEXFLG                                                   16903000
TEXUCT   EQU   TEXFLG                                                   16904000
TIMEODAY EQU   TIMESTMP+4                                               16905000
TIMEDATE EQU   TIMESTMP+12                                              16906000
ZAREA    EQU   0                                                        16907000
FRANGLST EQU   0                                                        16908000
FRANGLN  EQU   FRANGLST                                                 16909000
FRANGES  EQU   0                                                        16910000
FKEYLN   EQU   FRANGES                                                  16911000
FKEY     EQU   FRANGES+2                                                16912000
FDEV     EQU   0                                                        16913000
FDEVTYP  EQU   FDEV                                                     16914000
FDEVT    EQU   FDEVTYP                                                  16915000
FDCODE   EQU   FDEVTYP+8                                                16916000
FLDEVTYP EQU   0                                                        16917000
FSEQARRY EQU   0                                                        16918000
FFSEQNUM EQU   FSEQARRY                                                 16919000
FSEQNUM  EQU   0                                                        16920000
FVTVLIST EQU   0                                                        16921000
FVTVLEN  EQU   FVTVLIST                                                 16922000
@NM00057 EQU   FVTVLIST+2                                               16923000
FVTVSER  EQU   @NM00057+2                                               16924000
ALCVLIST EQU   0                                                        16925000
ALC#ENT  EQU   ALCVLIST                                                 16926000
@NM00059 EQU   ALCVLIST+2                                               16927000
ALCVLEN  EQU   @NM00059                                                 16928000
ALCVSER  EQU   @NM00059+2                                               16929000
OIOCSPTR EQU   0                                                        16930000
BFLIST   EQU   0                                                        16931000
FROMAREA EQU   0                                                        16932000
TOAREA   EQU   0                                                        16933000
FIELDPS  EQU   0                                                        16934000
AMSTP041 EQU   0                                                        16935000
AMSTP042 EQU   0                                                        16936000
AMSTP043 EQU   0                                                        16937000
AMSTP044 EQU   0                                                        16938000
DMPTRM   EQU   0                                                        16939000
FCATACB  EQU   0                                                        16940000
IDCIOIT0 EQU   0                                                        16941000
IDCIOPO0 EQU   0                                                        16942000
IDCIOPT0 EQU   0                                                        16943000
IDCIOST0 EQU   0                                                        16944000
IDCIOTM0 EQU   0                                                        16945000
IDCIOVY0 EQU   0                                                        16946000
IDCIO050 EQU   0                                                        16947000
IDCSACL0 EQU   0                                                        16948000
IDCSACR0 EQU   0                                                        16949000
IDCSADE0 EQU   0                                                        16950000
IDCSADQ0 EQU   0                                                        16951000
IDCSAGS0 EQU   0                                                        16952000
IDCSAID0 EQU   0                                                        16953000
IDCSALC0 EQU   0                                                        16954000
IDCSALD0 EQU   0                                                        16955000
IDCSALK0 EQU   0                                                        16956000
IDCSANQ0 EQU   0                                                        16957000
IDCSAPR0 EQU   0                                                        16958000
IDCSAPT0 EQU   0                                                        16959000
IDCSARC0 EQU   0                                                        16960000
IDCSARV0 EQU   0                                                        16961000
IDCSASC0 EQU   0                                                        16962000
IDCSASI0 EQU   0                                                        16963000
IDCSASN0 EQU   0                                                        16964000
IDCSASS0 EQU   0                                                        16965000
IDCSAST0 EQU   0                                                        16966000
IDCSATI0 EQU   0                                                        16967000
IDCSAUC0 EQU   0                                                        16968000
IDCSAWO0 EQU   0                                                        16969000
IDCSA060 EQU   0                                                        16970000
IDCST010 EQU   0                                                        16971000
LISTTEST EQU   0                                                        16972000
NEWERID1 EQU   5                                                        16973000
NSRAC    EQU   0                                                        16974000
GDTTBL   EQU   0                                                        16975000
GDTTR1   EQU   GDTTBL+8                                                 16976000
GDTTR2   EQU   GDTTBL+12                                                16977000
GDTDBG   EQU   GDTTBL+40                                                16978000
GDTSTC   EQU   GDTTBL+44                                                16979000
GDTPRT   EQU   GDTTBL+48                                                16980000
GDTESS   EQU   GDTTBL+52                                                16981000
GDTESA   EQU   GDTTBL+56                                                16982000
GDTRST   EQU   GDTTBL+60                                                16983000
GDTRES   EQU   GDTTBL+64                                                16984000
GDTCAL   EQU   GDTTBL+68                                                16985000
GDTGSP   EQU   GDTTBL+72                                                16986000
GDTFSP   EQU   GDTTBL+76                                                16987000
GDTGPL   EQU   GDTTBL+80                                                16988000
GDTFPL   EQU   GDTTBL+84                                                16989000
GDTLOD   EQU   GDTTBL+88                                                16990000
GDTDEL   EQU   GDTTBL+92                                                16991000
GDTPRL   EQU   GDTTBL+96                                                16992000
GDTEPL   EQU   GDTTBL+100                                               16993000
GDTTIM   EQU   GDTTBL+104                                               16994000
GDTIIO   EQU   GDTTBL+108                                               16995000
GDTTIO   EQU   GDTTBL+112                                               16996000
GDTOPN   EQU   GDTTBL+124                                               16997000
GDTCLS   EQU   GDTTBL+128                                               16998000
GDTGET   EQU   GDTTBL+132                                               16999000
GDTPUT   EQU   GDTTBL+136                                               17000000
GDTPOS   EQU   GDTTBL+140                                               17001000
GDTCPY   EQU   GDTTBL+144                                               17002000
GDTCAT   EQU   GDTTBL+148                                               17003000
GDTSNP   EQU   GDTTBL+164                                               17004000
GDTVFY   EQU   GDTTBL+172                                               17005000
GDTECT   EQU   GDTTBL+188                                               17006000
GDTUID   EQU   GDTTBL+192                                               17007000
GDTPMT   EQU   GDTTBL+196                                               17008000
GDTCIR   EQU   GDTTBL+200                                               17009000
GDTLNK   EQU   GDTTBL+204                                               17010000
GDTALC   EQU   GDTTBL+208                                               17011000
GDTDLC   EQU   GDTTBL+212                                               17012000
GDTQAL   EQU   GDTTBL+216                                               17013000
GDTSTW   EQU   GDTTBL+220                                               17014000
GDTSSC   EQU   GDTTBL+224                                               17015000
GDTENQ   EQU   GDTTBL+228                                               17016000
GDTRSV   EQU   GDTTBL+232                                               17017000
GDTDEQ   EQU   GDTTBL+236                                               17018000
GDTSFO   EQU   GDTTBL+240                                               17019000
GDTWTO   EQU   GDTTBL+244                                               17020000
GDTSCR   EQU   GDTTBL+248                                               17021000
GDTUNT   EQU   GDTTBL+252                                               17022000
GDTRCT   EQU   GDTTBL+256                                               17023000
GDTIFO   EQU   GDTTBL+260                                               17024000
GDTEXP   EQU   GDTTBL+264                                               17025000
GDTSTA   EQU   GDTTBL+268                                               17026000
GDTERR   EQU   GDTTBL+272                                               17027000
GDTUNC   EQU   GDTTBL+276                                               17028000
GDTLOC   EQU   GDTTBL+280                                               17029000
FDTTBL   EQU   0                                                        17030000
FDTPTR   EQU   FDTTBL+8                                                 17031000
LASTCC   EQU   0                                                        17032000
CTYPE    EQU   0                                                        17033000
CPTRCPL  EQU   0                                                        17034000
CNAME    EQU   0                                                        17035000
CINUM    EQU   0                                                        17036000
CCPSWD   EQU   0                                                        17037000
ALTERTYP EQU   0                                                        17038000
ALNAMEPT EQU   0                                                        17039000
NFDICT   EQU   0                                                        17040000
NFWKA    EQU   0                                                        17041000
NFPTRFVT EQU   0                                                        17042000
NFRELATE EQU   0                                                        17043000
RX       EQU   0                                                        17044000
RDICT    EQU   0                                                        17045000
RWKA     EQU   0                                                        17046000
RRANGPTR EQU   0                                                        17047000
LX       EQU   0                                                        17048000
LISTDICT EQU   0                                                        17049000
LISTWKA  EQU   0                                                        17050000
LFVTPTR  EQU   0                                                        17051000
LTYPE    EQU   0                                                        17052000
SCPLPTR  EQU   0                                                        17053000
DLCPLPTR EQU   0                                                        17054000
REQTYPE  EQU   0                                                        17055000
DALVLPTR EQU   0                                                        17056000
DALDNMPT EQU   0                                                        17057000
DALINDEX EQU   0                                                        17058000
OTYPE    EQU   0                                                        17059000
ODD      EQU   0                                                        17060000
ODSN     EQU   0                                                        17061000
OREC     EQU   0                                                        17062000
OBLK     EQU   0                                                        17063000
OIOCS    EQU   0                                                        17064000
BFLISTPT EQU   0                                                        17065000
BINDX    EQU   0                                                        17066000
BFPLADDR EQU   0                                                        17067000
BDICTPTR EQU   0                                                        17068000
BWKAPTR  EQU   0                                                        17069000
BFPLRTN  EQU   0                                                        17070000
MSIZE    EQU   0                                                        17071000
MF1PTR   EQU   0                                                        17072000
MT1PTR   EQU   0                                                        17073000
FDICT    EQU   0                                                        17074000
FWKA     EQU   0                                                        17075000
FPTRFVT  EQU   0                                                        17076000
BFPL     EQU   0                                                        17077000
BDICT    EQU   0                                                        17078000
BWKA     EQU   0                                                        17079000
GINVBUF  EQU   0                                                        17080000
GLENGTH  EQU   0                                                        17081000
@NM00038 EQU   CTGDDNM                                                  17082000
CTGPROB  EQU   @NM00038                                                 17083000
CTGREASN EQU   CTGPROB+2                                                17084000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    17085000
CTGREAS2 EQU   CTGREASN+1                                               17086000
CTGREAS1 EQU   CTGREASN                                                 17087000
CTGMODID EQU   CTGPROB                                                  17088000
FDTVERB  EQU   FDTTBL                                                   17089000
GDTPSB   EQU   GDTTBL+184                                               17090000
GDTUPT   EQU   GDTTBL+180                                               17091000
GDTCMB   EQU   GDTTBL+176                                               17092000
GDTSPR   EQU   GDTTBL+168                                               17093000
@NM00001 EQU   GDTTBL+160                                               17094000
GDTABH   EQU   GDTTBL+156                                               17095000
GDTABT   EQU   GDTTBL+152                                               17096000
GDTTOH   EQU   GDTTBL+120                                               17097000
GDTRIP   EQU   GDTTBL+116                                               17098000
GDTIOH   EQU   GDTTBL+36                                                17099000
GDTSAH   EQU   GDTTBL+32                                                17100000
GDTTPH   EQU   GDTTBL+28                                                17101000
GDTRIH   EQU   GDTTBL+24                                                17102000
GDTSTH   EQU   GDTTBL+20                                                17103000
GDTDBH   EQU   GDTTBL+16                                                17104000
GDTPRM   EQU   GDTTBL+4                                                 17105000
GDTHDR   EQU   GDTTBL                                                   17106000
@NM00058 EQU   @NM00057                                                 17107000
TEXRESV  EQU   TIMESTMP+2                                               17108000
TEXRCVY  EQU   TEXFLG                                                   17109000
TEXBASE  EQU   TEXFLG                                                   17110000
TEXASSOC EQU   TEXFLG                                                   17111000
TEXINHTG EQU   TEXFLG                                                   17112000
TEXUNIQ  EQU   TEXFLG                                                   17113000
DICTNM   EQU   DICT                                                     17114000
ASSRECNM EQU   RECORDSZ+2                                               17115000
@NM00051 EQU   RCDSECF                                                  17116000
FNAME    EQU   FNAMEDS+1                                                17117000
FTYPE    EQU   FNAMEDS                                                  17118000
FUSERVAL EQU   FUSERARE+2                                               17119000
FIELDCT  EQU   FIELDVR+2                                                17120000
FIELDLN  EQU   FIELDVR                                                  17121000
FDSNTUSE EQU   FDSATTR+1                                                17122000
@NM00050 EQU   FDSATTR+1                                                17123000
FDSTROVF EQU   FDSATTR                                                  17124000
FDSTMPEX EQU   FDSATTR                                                  17125000
FDSINHUP EQU   FDSATTR                                                  17126000
FDSSHARE EQU   FDSATTR                                                  17127000
FDSERASE EQU   FDSATTR                                                  17128000
FDSRELSE EQU   FDSATTR                                                  17129000
FDSSPEED EQU   FDSATTR                                                  17130000
AMDEXCP  EQU   AMDSTAT+44                                               17131000
AMDNCAS  EQU   AMDSTAT+40                                               17132000
AMDNCIS  EQU   AMDSTAT+36                                               17133000
AMDASPA  EQU   AMDSTAT+32                                               17134000
AMDRETR  EQU   AMDSTAT+28                                               17135000
AMDUPR   EQU   AMDSTAT+24                                               17136000
AMDIREC  EQU   AMDSTAT+20                                               17137000
AMDDELR  EQU   AMDSTAT+16                                               17138000
AMDNLR   EQU   AMDSTAT+12                                               17139000
AMDNEXT  EQU   AMDSTAT+10                                               17140000
AMDNIL   EQU   AMDSTAT+8                                                17141000
AMDSTSP  EQU   AMDSTAT                                                  17142000
@NM00043 EQU   IDAAMDSB+41                                              17143000
@NM00042 EQU   AMDATTR3                                                 17144000
AMDLM    EQU   AMDATTR3                                                 17145000
AMDWAIT  EQU   AMDATTR3                                                 17146000
AMDBIND  EQU   AMDATTR3                                                 17147000
AMDFAULT EQU   AMDATTR3                                                 17148000
AMDUNQ   EQU   AMDATTR3                                                 17149000
AMDPARDB EQU   IDAAMDSB+36                                              17150000
AMDMAXRR EQU   AMDSSRBA                                                 17151000
AMDNSLOT EQU   AMDHLRBA                                                 17152000
AMDFSCI  EQU   IDAAMDSB+16                                              17153000
AMDFSCA  EQU   IDAAMDSB+14                                              17154000
AMDCIPCA EQU   IDAAMDSB+12                                              17155000
AMDSPAN  EQU   AMDATTR                                                  17156000
AMDRRDS  EQU   AMDATTR                                                  17157000
AMDRANGE EQU   AMDATTR                                                  17158000
AMDORDER EQU   AMDATTR                                                  17159000
AMDREPL  EQU   AMDATTR                                                  17160000
AMDSDT   EQU   AMDATTR                                                  17161000
AMDWCK   EQU   AMDATTR                                                  17162000
AMDDST   EQU   AMDATTR                                                  17163000
AMDSBID  EQU   IDAAMDSB                                                 17164000
CTGFVCPP EQU   CTGFVPWD                                                 17165000
CTGFVTTR EQU   CTGFVSPC                                                 17166000
@NM00041 EQU   CTGFV+3                                                  17167000
CTGFVELM EQU   CTGFV+2                                                  17168000
@NM00040 EQU   CTGFVPRO                                                 17169000
CTGFVROF EQU   CTGFVPRO                                                 17170000
CTGFVDRC EQU   CTGFVPRO                                                 17171000
CTGFVRVL EQU   CTGFVPRO                                                 17172000
CTGFVAVL EQU   CTGFVPRO                                                 17173000
CTGFLDWA EQU   CTGFL+4                                                  17174000
CTGFLDTS EQU   CTGFLDRE                                                 17175000
@NM00039 EQU   CTGFLDRE                                                 17176000
CTGFLDGC EQU   CTGFL+2                                                  17177000
CTGFIELD EQU   CTGPL+28                                                 17178000
@NM00037 EQU   CTGFBFLG                                                 17179000
CTGNGDSN EQU   CTGFBFLG                                                 17180000
CTGGDGB  EQU   CTGFBFLG                                                 17181000
CTGKEEP  EQU   CTGFBFLG                                                 17182000
CTGPAR   EQU   CTGFBFLG                                                 17183000
CTGFDBK  EQU   CTGNEWNM                                                 17184000
CTGNOFLD EQU   CTGPL+19                                                 17185000
@NM00036 EQU   CTGDSORG                                                 17186000
CTGCVOL  EQU   CTGCAT                                                   17187000
@NM00035 EQU   CTGOPTN4                                                 17188000
CTGTIOT  EQU   CTGOPTN4                                                 17189000
CTGBYPMT EQU   CTGOPTN4                                                 17190000
CTGCOIN  EQU   CTGOPTN4                                                 17191000
CTGDOCAT EQU   CTGOPTN4                                                 17192000
CTGLBASE EQU   CTGOPTN4                                                 17193000
CTGSRH   EQU   CTGOPTN3                                                 17194000
CTGGDGL  EQU   CTGOPTN3                                                 17195000
CTGSUPLT EQU   CTGOPTN3                                                 17196000
@NM00034 EQU   CTGOPTN2                                                 17197000
CTGGTNXT EQU   CTGOPTN2                                                 17198000
CTGSWAP  EQU   CTGRCATN                                                 17199000
CTGGTALL EQU   CTGREL                                                   17200000
CTGNSVS  EQU   CTGEXT                                                   17201000
CTGGENLD EQU   CTGOPTN1                                                 17202000
CTGREAD  EQU   CTGOPTN1                                                 17203000
CTGUPD   EQU   CTGOPTN1                                                 17204000
CTGCI    EQU   CTGOPTN1                                                 17205000
CTGBYPSS EQU   CTGOPTN1                                                 17206000
CATLEN   EQU   CAT+20                                                   17207000
CATMEM   EQU   CAT+12                                                   17208000
CATMLN   EQU   CAT+11                                                   17209000
CATFUQ   EQU   CATFLG                                                   17210000
CATPOS   EQU   CAT+9                                                    17211000
PDEVLEN  EQU   PDEV                                                     17212000
INDDLEN  EQU   INDD                                                     17213000
DEVTLEN  EQU   @NM00033                                                 17214000
LISTVLEN EQU   @NM00032                                                 17215000
OBJFLLEN EQU   OBJFL                                                    17216000
OBJNMLEN EQU   OBJNM+20                                                 17217000
OBJNMMEM EQU   OBJNM+12                                                 17218000
OBJNMMLN EQU   OBJNM+11                                                 17219000
OBJNMFUQ EQU   OBJNMFLG                                                 17220000
OBJNMPOS EQU   OBJNM+9                                                  17221000
OBJNMPAS EQU   OBJNM+1                                                  17222000
OBJNMPLN EQU   OBJNM                                                    17223000
OUTDDLEN EQU   OUTDD+9                                                  17224000
INDSMEM  EQU   INDS+12                                                  17225000
INDSMLN  EQU   INDS+11                                                  17226000
INDSPOS  EQU   INDS+9                                                   17227000
@NM00031 EQU   DMPARY+15                                                17228000
DMPARYTP EQU   DMPARY+14                                                17229000
DMPARYEX EQU   DMPARY+12                                                17230000
DMPARYIC EQU   DMPARY+10                                                17231000
DMPARYSZ EQU   DMPARY+8                                                 17232000
DMPARYNM EQU   DMPARY                                                   17233000
@NM00030 EQU   DMPITM+15                                                17234000
DMPITMTP EQU   DMPITM+14                                                17235000
DMPITMLN EQU   DMPITM+12                                                17236000
DMPITMPT EQU   DMPITM+8                                                 17237000
DMPITMNM EQU   DMPITM                                                   17238000
@NM00029 EQU   ERCNVTAB+24                                              17239000
ERDARBPT EQU   ERCPLPT                                                  17240000
ERDYNRC  EQU   ERCATRC                                                  17241000
@NM00028 EQU   ERCNVTAB+4                                               17242000
@NM00027 EQU   ERCNVTAB+3                                               17243000
@NM00026 EQU   EROSOPER                                                 17244000
EROSUCDX EQU   EROSOPER                                                 17245000
EROSCATL EQU   EROSOPER                                                 17246000
@NM00025 EQU   EROPER                                                   17247000
ERCATLC  EQU   EROPER                                                   17248000
@NM00024 EQU   ERTYPE                                                   17249000
ERDYNAL  EQU   ERTYPE                                                   17250000
EROSCAT  EQU   ERTYPE                                                   17251000
@NM00023 EQU   FMTCNVF+1                                                17252000
FMTAR    EQU   FMTCNVF+1                                                17253000
FMTBS    EQU   FMTCNVF+1                                                17254000
FMTSS    EQU   FMTCNVF+1                                                17255000
FMTAL    EQU   FMTCNVF+1                                                17256000
FMTZS    EQU   FMTCNVF+1                                                17257000
@NM00022 EQU   FMTCNVF                                                  17258000
FMTPU    EQU   FMTCNVF                                                  17259000
FMTBD    EQU   FMTCNVF                                                  17260000
FMTBHD   EQU   FMTCNVF                                                  17261000
FMTBHA   EQU   FMTCNVF                                                  17262000
FMTBH    EQU   FMTCNVF                                                  17263000
FMTOLEN  EQU   FMTLIST+8                                                17264000
FMTRIO   EQU   FMTOCOL                                                  17265000
FMTSPT   EQU   FMTSTO                                                   17266000
FMTSTL   EQU   FMTILEN                                                  17267000
@NM00021 EQU   FMTFLGS+1                                                17268000
FMTSMSG  EQU   FMTFLGS+1                                                17269000
FMTHDF   EQU   FMTFLGS                                                  17270000
FMTDFF   EQU   FMTFLGS                                                  17271000
FMTSTF   EQU   FMTFLGS                                                  17272000
FMTREPF  EQU   FMTFLGS                                                  17273000
FMTBDF   EQU   FMTFLGS                                                  17274000
FMTIDF   EQU   FMTFLGS                                                  17275000
FMTSCF   EQU   FMTFLGS                                                  17276000
FMTEOLF  EQU   FMTFLGS                                                  17277000
DARGREP  EQU   DARGINS                                                  17278000
@NM00020 EQU   DARGFLGS                                                 17279000
DARGFULL EQU   DARGFLGS                                                 17280000
DARGIND  EQU   DARGLIST+18                                              17281000
DARGRETL EQU   DARGLIST+16                                              17282000
DARGRETP EQU   DARGLIST+4                                               17283000
UVOLVOL  EQU   UVOLENT+4                                                17284000
UVOLDEV  EQU   UVOLENT                                                  17285000
UVOLCNT  EQU   UVOLLIST                                                 17286000
@NM00019 EQU   IOINFOPT                                                 17287000
IOINFLUB EQU   IOINFOPT                                                 17288000
IOINFTMS EQU   IOINFOPT                                                 17289000
IOINFSUP EQU   IOINFOPT                                                 17290000
IOINFVOL EQU   IOINFOPT                                                 17291000
IOINFDVT EQU   IOINFOPT                                                 17292000
OPNVOL   EQU   OPNAGL+44                                                17293000
OPNSTRNO EQU   OPNAGL+43                                                17294000
@NM00018 EQU   OPNOPT2                                                  17295000
OPNOPTJM EQU   OPNOPT2                                                  17296000
OPNOPTNM EQU   OPNOPT2                                                  17297000
OPNOPTAS EQU   OPNOPT2                                                  17298000
@NM00017 EQU   OPNDSO                                                   17299000
OPNDSOPO EQU   OPNDSO                                                   17300000
OPNDSOIS EQU   OPNDSO                                                   17301000
OPNDSOPS EQU   OPNDSO                                                   17302000
OPNDSOAM EQU   OPNDSO                                                   17303000
OPNKYL   EQU   OPNAGL+40                                                17304000
OPNDEVIX EQU   OPNDEV+4                                                 17305000
OPNCBP   EQU   OPNAGL+20                                                17306000
OPNMODRP EQU   OPNMOD                                                   17307000
OPNMODUB EQU   OPNMOD                                                   17308000
OPNMODRS EQU   OPNMOD                                                   17309000
OPNMODRR EQU   OPNMOD                                                   17310000
OPNMODRC EQU   OPNMOD                                                   17311000
OPNMODAC EQU   OPNMOD                                                   17312000
OPNMODPD EQU   OPNMOD                                                   17313000
OPNTYPEX EQU   OPNTYP                                                   17314000
OPNTYPRA EQU   OPNTYP                                                   17315000
OPNTYPCI EQU   OPNTYP                                                   17316000
OPNTYPSO EQU   OPNTYP                                                   17317000
OPNTYPSI EQU   OPNTYP                                                   17318000
@NM00016 EQU   OPNRFM                                                   17319000
OPNRFMUN EQU   OPNRFM                                                   17320000
OPNRFMVR EQU   OPNRFM                                                   17321000
OPNRFMFX EQU   OPNRFM                                                   17322000
OPNOPTSK EQU   OPNOPT                                                   17323000
OPNOPTDR EQU   OPNOPT                                                   17324000
OPNOPTCR EQU   OPNOPT                                                   17325000
OPNOPTKS EQU   OPNOPT                                                   17326000
OPNOPTBK EQU   OPNOPT                                                   17327000
OPNOPTUP EQU   OPNOPT                                                   17328000
IOCEXT   EQU   IOCSTR+64                                                17329000
IOCTSML  EQU   IOCREL+2                                                 17330000
IOCTPML  EQU   IOCREL                                                   17331000
IOCWORK  EQU   IOCSTR+56                                                17332000
IOCRRN   EQU   IOCSTR+52                                                17333000
IOCPNM   EQU   IOCNWM+2                                                 17334000
IOCPTL   EQU   IOCNWM                                                   17335000
IOCKYA   EQU   IOCMEM                                                   17336000
IOCVRC   EQU   IOCTTR                                                   17337000
IOCCBP   EQU   IOCSTR+36                                                17338000
IOCDSN   EQU   IOCSTR+32                                                17339000
IOCHURBA EQU   IOCSTR+28                                                17340000
IOCVOLSR EQU   IOCSTR+22                                                17341000
@NM00015 EQU   IOCMSG                                                   17342000
IOCMSGSM EQU   IOCMSG                                                   17343000
IOCMSGAE EQU   IOCMSG                                                   17344000
IOCMSGCE EQU   IOCMSG                                                   17345000
IOCMSGOE EQU   IOCMSG                                                   17346000
IOCCHPKG EQU   IOCMSG                                                   17347000
IOCCHPKE EQU   IOCMSG                                                   17348000
IOCCHPNU EQU   IOCCHP                                                   17349000
IOCCHPUP EQU   IOCCHP                                                   17350000
IOCCHPBK EQU   IOCCHP                                                   17351000
IOCCHPCR EQU   IOCCHP                                                   17352000
IOCCHPKS EQU   IOCCHP                                                   17353000
IOCCHPSK EQU   IOCCHP                                                   17354000
IOCCHPDR EQU   IOCCHP                                                   17355000
IOCCHPSQ EQU   IOCCHP                                                   17356000
IOCMACNT EQU   IOCMAC2                                                  17357000
IOCMACER EQU   IOCMAC2                                                  17358000
IOCMACPA EQU   IOCMAC2                                                  17359000
IOCMACEN EQU   IOCMAC2                                                  17360000
IOCMACCP EQU   IOCMAC2                                                  17361000
IOCMACRR EQU   IOCMAC2                                                  17362000
IOCMACAS EQU   IOCMAC2                                                  17363000
IOCMACSK EQU   IOCMAC2                                                  17364000
@NM00014 EQU   IOCMAC                                                   17365000
IOCMACCC EQU   IOCMAC                                                   17366000
IOCMACDR EQU   IOCMAC                                                   17367000
IOCMACBK EQU   IOCMAC                                                   17368000
IOCMACCR EQU   IOCMAC                                                   17369000
IOCMACUP EQU   IOCMAC                                                   17370000
IOCMACOT EQU   IOCMAC                                                   17371000
IOCMACIN EQU   IOCMAC                                                   17372000
@NM00013 EQU   IOCRFM                                                   17373000
IOCRFMBK EQU   IOCRFM                                                   17374000
IOCRFMSF EQU   IOCRFM                                                   17375000
IOCRFMUN EQU   IOCRFM                                                   17376000
IOCRFMVR EQU   IOCRFM                                                   17377000
IOCRFMFX EQU   IOCRFM                                                   17378000
@NM00012 EQU   IOCDSO                                                   17379000
IOCDSOPO EQU   IOCDSO                                                   17380000
IOCDSOIS EQU   IOCDSO                                                   17381000
IOCDSOPS EQU   IOCDSO                                                   17382000
IOCDSOAM EQU   IOCDSO                                                   17383000
IOCRKP   EQU   IOCSTR+13                                                17384000
IOCKYL   EQU   IOCSTR+12                                                17385000
IOCTRN   EQU   IOCSTR+8                                                 17386000
UNITVTOC EQU   UNITABL+7                                                17387000
@NM00011 EQU   UNITSTAT                                                 17388000
UNITUSHR EQU   UNITSTAT                                                 17389000
UNITXSHR EQU   UNITSTAT                                                 17390000
UNITISHR EQU   UNITSTAT                                                 17391000
UNITUA   EQU   @NM00010+1                                               17392000
UNITCHA  EQU   @NM00010                                                 17393000
UNITUCB  EQU   UNITABL                                                  17394000
ALLUNCNT EQU   ALLAGL+30                                                17395000
ALLVLCNT EQU   ALLAGL+29                                                17396000
@NM00009 EQU   ALLOPT                                                   17397000
ALLOPTUN EQU   ALLOPT                                                   17398000
ALLOPTPV EQU   ALLOPT                                                   17399000
@NM00008 EQU   ALLORG+1                                                 17400000
ALLORGVS EQU   ALLORG+1                                                 17401000
@NM00007 EQU   ALLORG+1                                                 17402000
ALLORGGS EQU   ALLORG+1                                                 17403000
ALLORGUN EQU   ALLORG                                                   17404000
ALLORGPO EQU   ALLORG                                                   17405000
ALLORGMQ EQU   ALLORG                                                   17406000
ALLORGCQ EQU   ALLORG                                                   17407000
ALLORGCX EQU   ALLORG                                                   17408000
ALLORGDA EQU   ALLORG                                                   17409000
ALLORGPS EQU   ALLORG                                                   17410000
ALLORGIS EQU   ALLORG                                                   17411000
ALLDSPUN EQU   ALLDSP                                                   17412000
ALLDSPCG EQU   ALLDSP                                                   17413000
ALLDSPDE EQU   ALLDSP                                                   17414000
@NM00006 EQU   ALLDSP                                                   17415000
ALLSTSMD EQU   ALLSTS                                                   17416000
ALLSTSNW EQU   ALLSTS                                                   17417000
ALLSTSSR EQU   ALLSTS                                                   17418000
@NM00005 EQU   ALLSTS                                                   17419000
ALLPWD   EQU   ALLAGL+20                                                17420000
CIRPID   EQU   CIRAGL+28                                                17421000
CIRPWD   EQU   CIRAGL+24                                                17422000
CIRCAT   EQU   CIRAGL+20                                                17423000
CIRWKP   EQU   CIRAGL+16                                                17424000
CIRTLR   EQU   CIRAGL+12                                                17425000
CIRHDR   EQU   CIRAGL+8                                                 17426000
CIRTLN   EQU   CIRAGL+6                                                 17427000
CIRHLN   EQU   CIRAGL+4                                                 17428000
@NM00004 EQU   CIRAGL+1                                                 17429000
@NM00003 EQU   CIRTYPE                                                  17430000
CIRTYPAQ EQU   CIRTYPE                                                  17431000
CIRTYP1Q EQU   CIRTYPE                                                  17432000
NEWID1   EQU   TRACE1+95                                                17433000
CALLID   EQU   OLDERID1+90                                              17434000
@NM00002 EQU   OLDERID1                                                 17435000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      17436000
@RC00490 EQU   @RC00482                                                 17437000
@RF00489 EQU   @RC00482                                                 17438000
@RC00517 EQU   @RC00507                                                 17439000
@RF00516 EQU   @RC00507                                                 17440000
@RC00541 EQU   @RC00534                                                 17441000
@RF00540 EQU   @RC00534                                                 17442000
@RF00738 EQU   @RC00735                                                 17443000
@RF00818 EQU   @RC00803                                                 17444000
@RF00821 EQU   @RC00803                                                 17445000
@RF00855 EQU   @RC00840                                                 17446000
@RF00858 EQU   @RC00840                                                 17447000
@RF02287 EQU   @RC02247                                                 17448000
@RF02286 EQU   @RC02247                                                 17449000
@RF02293 EQU   @RC02247                                                 17450000
@RC02394 EQU   @RC02391                                                 17451000
@RF03039 EQU   @RC03006                                                 17452000
@PB00022 EQU   @EL00001                                                 17453000
@PB00021 EQU   @PB00022                                                 17454000
@PB00020 EQU   @PB00021                                                 17455000
@PB00019 EQU   @PB00020                                                 17456000
@PB00018 EQU   @PB00019                                                 17457000
@PB00017 EQU   @PB00018                                                 17458000
@PB00016 EQU   @PB00017                                                 17459000
@PB00015 EQU   @PB00016                                                 17460000
@PB00014 EQU   @PB00015                                                 17461000
@PB00013 EQU   @PB00014                                                 17462000
@PB00012 EQU   @PB00013                                                 17463000
@PB00011 EQU   @PB00012                                                 17464000
@PB00010 EQU   @PB00011                                                 17465000
@PB00009 EQU   @PB00010                                                 17466000
@PB00008 EQU   @PB00009                                                 17467000
@PB00007 EQU   @PB00008                                                 17468000
@PB00006 EQU   @PB00007                                                 17469000
@PB00005 EQU   @PB00006                                                 17470000
@PB00004 EQU   @PB00005                                                 17471000
@PB00003 EQU   @PB00004                                                 17472000
@PB00002 EQU   @PB00003                                                 17473000
@ENDDATA EQU   *                                                        17474000
         END   IDCRM01,(C'PLS1604',0701,78177)                          17475000
