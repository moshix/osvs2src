         TITLE '*************** IDCRP01: IDCAMS REPRO ROUTINE **********00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCRP01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCRP01   77.258'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @10,0                                               0002 00021000
@PSTART  LA    @11,4095(,@10)                                      0002 00022000
         LA    @09,4095(,@11)                                      0002 00023000
         USING @PSTART,@10                                         0002 00024000
         USING @PSTART+4095,@11                                    0002 00025000
         USING @PSTART+8190,@09                                    0002 00026000
         L     @00,@SIZDATD                                        0002 00027000
         GETMAIN  R,LV=(0)                                              00028000
         LR    @12,@01                                             0002 00029000
         USING @DATD,@12                                           0002 00030000
         ST    @13,@SA00001+4                                      0002 00031000
         LM    @00,@01,20(@13)                                     0002 00032000
         ST    @12,8(,@13)                                         0002 00033000
         LR    @13,@12                                             0002 00034000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00035000
         MVC   @PC00001(12),0(@01)                                 0002 00036000
*                                                                  0257 00037000
*                                                                  0258 00038000
*        /************************************************************/ 00039000
*        /*                                                          */ 00040000
*        /*ENTRY POINT TO IDCRP01- THIS IS THE ONLY ENTRY POINT      */ 00041000
*        /*                                                          */ 00042000
*        /************************************************************/ 00043000
*                                                                  0258 00044000
*        CPRECID = '00'X;                                          0258 00045000
*                                                                  0258 00046000
         MVI   CPRECID,X'00'                                       0258 00047000
*        /************************************************************/ 00048000
*        /*                                                          */ 00049000
*        /*INITIALIZE CONTROL FLAG VALUES                            */ 00050000
*        /*                                                          */ 00051000
*        /************************************************************/ 00052000
*                                                                  0259 00053000
*        STATFLG = NORMAL;                                         0259 00054000
         MVC   STATFLG(5),@CB00816                                 0259 00055000
*        FAILIOER = 0;                                             0260 00056000
         SLR   @08,@08                                             0260 00057000
         STH   @08,FAILIOER                                        0260 00058000
*        CATRELSW = '0'B;                                  /*@OZ00751*/ 00059000
         NI    CATRELSW,B'01111111'                                0261 00060000
*        CATCOPSW = '0'B;                                  /*@OZ00751*/ 00061000
         NI    CATCOPSW,B'01111111'                                0262 00062000
*        IOPOSSW = 'U';                                    /*@OZ00751*/ 00063000
         MVI   IOPOSSW,C'U'                                        0263 00064000
*        EOFSW = 0;                                        /*@OZ00751*/ 00065000
         STH   @08,EOFSW                                           0264 00066000
*        READSW = '0'B;                                    /*@OZ00751*/ 00067000
         MVI   READSW,B'00000000'                                  0265 00068000
*        EMPTYSW = '0'B;                                   /*@OZ00751*/ 00069000
         NI    EMPTYSW,B'01111111'                                 0266 00070000
*        FREENUM = 0;                                      /*@OZ00751*/ 00071000
         ST    @08,FREENUM                                         0267 00072000
*        OPNWRN = '0'B;                                    /*@OZ20461*/ 00073000
*                                                                  0268 00074000
         NI    OPNWRN,B'01111111'                                  0268 00075000
*        DDSTRU=ADDR(DARGL);           /* SET POINTER TO DARGLIST    */ 00076000
*                                                                  0269 00077000
*                                                                  0269 00078000
         LA    @03,DARGL                                           0269 00079000
         ST    @03,DDSTRU                                          0269 00080000
*        /************************************************************/ 00081000
*        /*                                                          */ 00082000
*        /* INITIALIZE THE OPEN ARGUMENT LIST FOR THE INPUT & OUTPUT */ 00083000
*        /* DATA SETS. THE OPENAGL COMMUNICATES INFORMATION ABOUT    */ 00084000
*        /* THE DATA SET TO THE AMS I/O ADAPTER. THE PTR TO THE IOCS */ 00085000
*        /* FOR EACH DATA SET IS RETURNED VIA THE RESPECTIVE OPNAGL  */ 00086000
*        /* INITIALIZE IOCS POINTERS TO ZERO                   YM6244*/ 00087000
*        /* A THIRD OPEN ARGUMENT LIST IS CLEARED FOR USE    @OZ00751*/ 00088000
*        /* IF THE TARGET IS FOUND TO BE A CATALOG.          @OZ00751*/ 00089000
*        /*                                                          */ 00090000
*        /************************************************************/ 00091000
*                                                                  0270 00092000
*        OPAGLST1 = ''B;                                           0270 00093000
         XC    OPAGLST1(48),OPAGLST1                               0270 00094000
*        OPAGLST2 = ''B;                                           0271 00095000
         XC    OPAGLST2(48),OPAGLST2                               0271 00096000
*        OPAGLST3 = ''B;                                   /*@OZ00751*/ 00097000
*                                                                  0272 00098000
*                                                                  0272 00099000
         XC    OPAGLST3(48),OPAGLST3                               0272 00100000
*        IOCSINP = NULLPTR;                                  /*YM6244*/ 00101000
         ST    @08,IOCSINP                                         0273 00102000
*        IOCSOUT = NULLPTR;                                  /*YM6244*/ 00103000
*                                                                  0274 00104000
         ST    @08,IOCSOUT                                         0274 00105000
*        /************************************************************/ 00106000
*        /*                                                          */ 00107000
*        /*INITIALIZE THE OPNAGL FOR THE INPUT DATA SET              */ 00108000
*        /*                                                          */ 00109000
*        /************************************************************/ 00110000
*                                                                  0275 00111000
*        OPNPTR=ADDR(OPAGLST1);        /* REFERENCE INPUT OPNAGL     */ 00112000
         LA    OPNPTR,OPAGLST1                                     0275 00113000
*        OPNOPTIN= ON;                 /* OPEN FOR INPUT             */ 00114000
         OI    OPNOPTIN(OPNPTR),B'10000000'                        0276 00115000
*        OPNIOC=ADDR(IOCSINP);         /* ADDR OF INPUT IOCS POINTER */ 00116000
         LA    @03,IOCSINP                                         0277 00117000
         ST    @03,OPNIOC(,OPNPTR)                                 0277 00118000
*        /************************************************************/ 00119000
*        /*                                                          */ 00120000
*        /* THE INPUT DATA SET CAN BE DESCRIBED VIA A JCL STATMENT   */ 00121000
*        /* OR, IN A SYSTEM WITH DYNAMIC ALLOCATION, ITS DATA SET    */ 00122000
*        /* NAME. WHEN DESCRIBED BY ITS DATA SET NAME THE I/O ADAPTER*/ 00123000
*        /* PERFORMS DYNAMIC ALLOCATION AS A PART OF THE UOPEN       */ 00124000
*        /* PROCESS. THE I/O ADAPTER IS SENSITIVE TO THE MEANS OF    */ 00125000
*        /* DESCRIPTION BY THE SETTING OF OPNDDN OR OPNDSN           */ 00126000
*        /*                                                          */ 00127000
*        /************************************************************/ 00128000
*        IF (ADDR(INDN)) ^= NULLPTR                                0278 00129000
*          THEN                                                    0278 00130000
         L     @03,@PC00001+4                                      0278 00131000
         C     @08,FDTPTR(,@03)                                    0278 00132000
         BE    @RF00278                                            0278 00133000
*            DO;                                                   0279 00134000
*                                                                  0279 00135000
*            OPNDDN = ADDR(INPDDVAL);                              0280 00136000
*                                                                  0280 00137000
         L     @08,FDTPTR+32(,@03)                                 0280 00138000
         LA    @03,INPDDVAL(,@08)                                  0280 00139000
         ST    @03,OPNDDN(,OPNPTR)                                 0280 00140000
*            /********************************************************/ 00141000
*            /*                                                      */ 00142000
*            /* REFERENCE THE PASSWORD FROM THE OPNAGL               */ 00143000
*            /*                                                      */ 00144000
*            /********************************************************/ 00145000
*                                                                  0281 00146000
*            IF INPDDPLN ^= 0                                      0281 00147000
*              THEN                                                0281 00148000
         CLI   INPDDPLN(@08),0                                     0281 00149000
         BE    @RF00281                                            0281 00150000
*                OPNPWA = ADDR(INPDDPAS);                          0282 00151000
*                                                                  0282 00152000
         LA    @08,INPDDPAS(,@08)                                  0282 00153000
         ST    @08,OPNPWA(,OPNPTR)                                 0282 00154000
*            END;                                                  0283 00155000
*          ELSE                                                    0284 00156000
*            IF (ADDR(INDS)) ^= NULLPTR                            0284 00157000
*              THEN                                                0284 00158000
         B     @RC00278                                            0284 00159000
@RF00278 L     @08,@PC00001+4                                      0284 00160000
         L     @08,FDTPTR+280(,@08)                                0284 00161000
         LTR   @08,@08                                             0284 00162000
         BZ    @RF00284                                            0284 00163000
*                DO;                                               0285 00164000
*                                                                  0285 00165000
*                /****************************************************/ 00166000
*                /*                                          @YL026UG*/ 00167000
*                /* IN TSO ENVIRONMENT THE DATA SET NAME MAY @YL026UG*/ 00168000
*                /* BE UNQUALIFIED, ISSUE THE AMS UQUAL MACRO        */ 00169000
*                /* IF INDSFUQ IS TURNED ON.                 @YL026UG*/ 00170000
*                /*                                          @YL026UG*/ 00171000
*                /****************************************************/ 00172000
*                IF INDSFUQ = ON                                   0286 00173000
*                  THEN                                            0286 00174000
         TM    INDSFUQ(@08),B'10000000'                            0286 00175000
         BNO   @RF00286                                            0286 00176000
*QQUAL01:            DO;                                   /*@YL026UG*/ 00177000
*                                                                  0287 00178000
QQUAL01  DS    0H                                                  0288 00179000
*                    QDSNPTR = ADDR(INDSVAL);              /*@YL026UG*/ 00180000
         L     @08,@PC00001+4                                      0288 00181000
         L     @08,FDTPTR+280(,@08)                                0288 00182000
         LA    @03,INDSVAL(,@08)                                   0288 00183000
         ST    @03,QDSNPTR                                         0288 00184000
*                    QDSNLEN = INDSLEN;                    /*@YL026UG*/ 00185000
         SLR   @03,@03                                             0289 00186000
         IC    @03,INDSLEN(,@08)                                   0289 00187000
         STH   @03,QDSNLEN                                         0289 00188000
*                    QCATPTR = NULLPTR;                    /*@YL026UG*/ 00189000
*                                                                  0290 00190000
         SLR   @03,@03                                             0290 00191000
         ST    @03,QCATPTR                                         0290 00192000
*                    IF INDSPLN ^= NULLPTR                         0291 00193000
*                      THEN                                        0291 00194000
         CLI   INDSPLN(@08),0                                      0291 00195000
         BE    @RF00291                                            0291 00196000
*                        QCATPSWD = ADDR(INDSPAS);         /*@YL026UG*/ 00197000
*                                                                  0292 00198000
         LA    @08,INDSPAS(,@08)                                   0292 00199000
         ST    @08,QCATPSWD                                        0292 00200000
*                      ELSE                                        0293 00201000
*                        QCATPSWD = NULLPTR;               /*@YL026UG*/ 00202000
*                                                                  0293 00203000
         B     @RC00291                                            0293 00204000
@RF00291 SLR   @08,@08                                             0293 00205000
         ST    @08,QCATPSWD                                        0293 00206000
*                    CALL IDCSAQL0 (GDTTBL,                        0294 00207000
*                      QDSNPTR,        /* PTR TO DSNAME      @YL026UG*/ 00208000
*                      QDSNLEN,        /* LENGTH OF DSNAME   @YL026UG*/ 00209000
*                      QCATPTR,        /* PTR TO CATNAME     @YL026UG*/ 00210000
*                      QCATPSWD);      /* PTR TO CAT PSWD    @YL026UG*/ 00211000
*                                                                  0294 00212000
@RC00291 L     @08,@PC00001                                        0294 00213000
         ST    @08,@AL00001                                        0294 00214000
         LA    @03,QDSNPTR                                         0294 00215000
         ST    @03,@AL00001+4                                      0294 00216000
         LA    @03,QDSNLEN                                         0294 00217000
         ST    @03,@AL00001+8                                      0294 00218000
         LA    @03,QCATPTR                                         0294 00219000
         ST    @03,@AL00001+12                                     0294 00220000
         LA    @03,QCATPSWD                                        0294 00221000
         ST    @03,@AL00001+16                                     0294 00222000
         MVI   @AL00001+16,X'80'                                   0294 00223000
         L     @15,GDTQAL(,@08)                                    0294 00224000
         LA    @01,@AL00001                                        0294 00225000
         BALR  @14,@15                                             0294 00226000
*                    RESPECIFY RTNREG RSTD;                        0295 00227000
*                    TESTRC = RTNREG;                              0296 00228000
         STH   RTNREG,TESTRC                                       0296 00229000
*                    RESPECIFY RTNREG UNRSTD;              /*@YL026UG*/ 00230000
*                                                                  0297 00231000
*                    IF TESTRC ^= 0                                0298 00232000
*                      THEN                                        0298 00233000
         LH    @08,TESTRC                                          0298 00234000
         LTR   @08,@08                                             0298 00235000
         BZ    @RF00298                                            0298 00236000
*                        STATFLG = TERMERR;                /*@YL026UG*/ 00237000
*                                                                  0299 00238000
         MVC   STATFLG(5),@CB00819                                 0299 00239000
*                    END QQUAL01;                          /*@YL026UG*/ 00240000
*                                                                  0300 00241000
@RF00298 DS    0H                                                  0301 00242000
*                OPNDSN = ADDR(INDSVAL);                           0301 00243000
*                                                                  0301 00244000
@RF00286 L     @08,@PC00001+4                                      0301 00245000
         L     @08,FDTPTR+280(,@08)                                0301 00246000
         LA    @03,INDSVAL(,@08)                                   0301 00247000
         ST    @03,OPNDSN(,OPNPTR)                                 0301 00248000
*                /****************************************************/ 00249000
*                /*                                                  */ 00250000
*                /* REFERENCE THE PASSWORD FROM THE OPNAGL   @YL026UG*/ 00251000
*                /*                                                  */ 00252000
*                /****************************************************/ 00253000
*                                                                  0302 00254000
*                IF INDSPLN ^= 0                                   0302 00255000
*                  THEN                                            0302 00256000
         CLI   INDSPLN(@08),0                                      0302 00257000
         BE    @RF00302                                            0302 00258000
*                    OPNPWA = ADDR(INDSPAS);                       0303 00259000
*                                                                  0303 00260000
         LA    @08,INDSPAS(,@08)                                   0303 00261000
         ST    @08,OPNPWA(,OPNPTR)                                 0303 00262000
*                END;                                              0304 00263000
@RF00302 DS    0H                                                  0305 00264000
*                                                                  0305 00265000
*        /************************************************************/ 00266000
*        /*                                                          */ 00267000
*        /* WHEN RECORD NUMBERS OR KEY DELIMITERS ARE SPECIFIED,     */ 00268000
*        /* INDICATE KEYED PROCESSING IN OPNAGL - THIS ALLOWS THE    */ 00269000
*        /* I/O ADAPTER TO VERIFY THE DATA SET IS CONSISTENT WITH    */ 00270000
*        /* KEYED PROCESSING AT OPEN TIME.                           */ 00271000
*        /*                                                          */ 00272000
*        /************************************************************/ 00273000
*                                                                  0305 00274000
*        IF (ADDR(FMKYC) ^= NULLPTR |                      /*@Y30SSJH*/ 00275000
*            ADDR(TOKYC) ^= NULLPTR |                      /*@Y30SSJH*/ 00276000
*            ADDR(FMNUM) ^= NULLPTR |                      /*@Y30SSJH*/ 00277000
*            ADDR(TONUM) ^= NULLPTR )                      /*@Y30SSJH*/ 00278000
*          THEN                                                    0305 00279000
@RF00284 DS    0H                                                  0305 00280000
@RC00278 SLR   @08,@08                                             0305 00281000
         L     @03,@PC00001+4                                      0305 00282000
         C     @08,FDTPTR+8(,@03)                                  0305 00283000
         BNE   @RT00305                                            0305 00284000
         C     @08,FDTPTR+20(,@03)                                 0305 00285000
         BNE   @RT00305                                            0305 00286000
         C     @08,FDTPTR+48(,@03)                                 0305 00287000
         BNE   @RT00305                                            0305 00288000
         C     @08,FDTPTR+52(,@03)                                 0305 00289000
         BE    @RF00305                                            0305 00290000
@RT00305 DS    0H                                                  0306 00291000
*            OPNOPTKS = ON;                                        0306 00292000
*                                                                  0306 00293000
         OI    OPNOPTKS(OPNPTR),B'00001000'                        0306 00294000
*          /**********************************************************/ 00295000
*          /*                                                        */ 00296000
*          /* WHEN BEGINNING OR ENDING RBA DELIMITERS ARE SPECIFIED, */ 00297000
*          /* INDICATE CHRONOLOGIC PROCESSING IN OPNAGL - THIS ALLOWS*/ 00298000
*          /* THE I/0 ADAPTER TO VERIFY THE DATA SET IS CONSISTENT   */ 00299000
*          /* WITH RBA PROCESSING AT OPEN TIME.                      */ 00300000
*          /*                                                        */ 00301000
*          /**********************************************************/ 00302000
*                                                                  0307 00303000
*          ELSE                                                    0307 00304000
*            IF (ADDR(FMRBA)  ^= NULLPTR  |                /*@Y30SSLO*/ 00305000
*                ADDR(TORBA)  ^= NULLPTR  )                /*@Y30SSLO*/ 00306000
*              THEN                                                0307 00307000
         B     @RC00305                                            0307 00308000
@RF00305 SLR   @08,@08                                             0307 00309000
         L     @03,@PC00001+4                                      0307 00310000
         C     @08,FDTPTR+12(,@03)                                 0307 00311000
         BNE   @RT00307                                            0307 00312000
         C     @08,FDTPTR+24(,@03)                                 0307 00313000
         BE    @RF00307                                            0307 00314000
@RT00307 DS    0H                                                  0308 00315000
*                OPNOPTCR = ON;                                    0308 00316000
*                                                                  0308 00317000
         OI    OPNOPTCR(OPNPTR),B'00000100'                        0308 00318000
*        /************************************************************/ 00319000
*        /*                                                          */ 00320000
*        /* SPECIFY THE ENVIRONMENT ATTRIBUTES FOR INPUT DATA SET    */ 00321000
*        /*                                                          */ 00322000
*        /************************************************************/ 00323000
*                                                                  0309 00324000
*        IF (ADDR(IENV)) ^= NULLPTR |                      /*@OZ05582*/ 00325000
*            ADDR(IDENV) ^= NULLPTR                                0309 00326000
*          THEN                                                    0309 00327000
*                                                                  0309 00328000
@RF00307 DS    0H                                                  0309 00329000
@RC00305 SLR   @08,@08                                             0309 00330000
         L     @03,@PC00001+4                                      0309 00331000
         C     @08,FDTPTR+60(,@03)                                 0309 00332000
         BNE   @RT00309                                            0309 00333000
         C     @08,FDTPTR+284(,@03)                                0309 00334000
         BE    @RF00309                                            0309 00335000
@RT00309 DS    0H                                                  0310 00336000
*            /********************************************************/ 00337000
*            /*                                                      */ 00338000
*            /* SPECIFY THAT DUMMY ISAM RECORDS ARE TO BE  COPIED    */ 00339000
*            /*                                                      */ 00340000
*            /********************************************************/ 00341000
*                                                                  0310 00342000
*            IF (ADDR(IDUMY)) ^= NULLPTR |                         0310 00343000
*               ADDR(IDUM) ^= NULLPTR                      /*@OZ05582*/ 00344000
*              THEN                                                0310 00345000
         SLR   @08,@08                                             0310 00346000
         L     @03,@PC00001+4                                      0310 00347000
         C     @08,FDTPTR+188(,@03)                                0310 00348000
         BNE   @RT00310                                            0310 00349000
         C     @08,FDTPTR+288(,@03)                                0310 00350000
         BE    @RF00310                                            0310 00351000
@RT00310 DS    0H                                                  0311 00352000
*                OPNMODPD = ON;                                    0311 00353000
*                                                                  0311 00354000
         OI    OPNMODPD(OPNPTR),B'10000000'                        0311 00355000
*                                                                  0312 00356000
*        /************************************************************/ 00357000
*        /*                                                          */ 00358000
*        /*INITIALIZE THE OPEN ARGLIST FOR THE OUTPUT DATA SET       */ 00359000
*        /*                                                          */ 00360000
*        /************************************************************/ 00361000
*                                                                  0312 00362000
*        OPNPTR=ADDR(OPAGLST2);        /* REFERENCE OUTPUT OPNAGL    */ 00363000
@RF00310 DS    0H                                                  0312 00364000
@RF00309 LA    OPNPTR,OPAGLST2                                     0312 00365000
*        OPNOPTOT=ON;                  /* OPEN FOR OUTPUT            */ 00366000
         OI    OPNOPTOT(OPNPTR),B'01000000'                        0313 00367000
*        OPNIOC=ADDR(IOCSOUT);         /* ADDR OF OUTPUT IOCS POINTER*/ 00368000
*                                                                  0314 00369000
         LA    @08,IOCSOUT                                         0314 00370000
         ST    @08,OPNIOC(,OPNPTR)                                 0314 00371000
*        /************************************************************/ 00372000
*        /*                                                          */ 00373000
*        /* THE OUTPUT DATA SET CAN BE DESCRIBED VIA A JCL STATEMENT */ 00374000
*        /* OR, IN A SYSTEM WITH DYNAMIC ALLOCATION, ITS DATA SET    */ 00375000
*        /* NAME.  WHEN DESCRIBED BY ITS DATA SET NAME THE I/O       */ 00376000
*        /* ADAPTER PERFORMS DYNAMIC ALLOCATION AS A PART OF THE     */ 00377000
*        /* UOPEN PROCESS. THE I/O ADAPTER IS SENSITIVE TO THE MEANS */ 00378000
*        /* OF DESCRIPTION BY THE SETTING OF OPNDDN OR OPNDSN.       */ 00379000
*        /*                                                          */ 00380000
*        /************************************************************/ 00381000
*        IF (ADDR(OUTDN)) ^= NULLPTR                               0315 00382000
*          THEN                                                    0315 00383000
         L     @08,@PC00001+4                                      0315 00384000
         L     @03,FDTPTR+4(,@08)                                  0315 00385000
         LTR   @03,@03                                             0315 00386000
         BZ    @RF00315                                            0315 00387000
*            DO;                                                   0316 00388000
*                                                                  0316 00389000
*            OPNDDN = ADDR(OUTDDVAL);                              0317 00390000
*                                                                  0317 00391000
         L     @08,FDTPTR+36(,@08)                                 0317 00392000
         LA    @03,OUTDDVAL(,@08)                                  0317 00393000
         ST    @03,OPNDDN(,OPNPTR)                                 0317 00394000
*            /********************************************************/ 00395000
*            /*                                                      */ 00396000
*            /* REFERENCE THE PASSWORD FROM THE OPNAGL               */ 00397000
*            /*                                                      */ 00398000
*            /********************************************************/ 00399000
*                                                                  0318 00400000
*            IF OUTDDPLN ^= 0                                      0318 00401000
*              THEN                                                0318 00402000
         CLI   OUTDDPLN(@08),0                                     0318 00403000
         BE    @RF00318                                            0318 00404000
*                OPNPWA = ADDR(OUTDDPAS);                          0319 00405000
*                                                                  0319 00406000
         LA    @08,OUTDDPAS(,@08)                                  0319 00407000
         ST    @08,OPNPWA(,OPNPTR)                                 0319 00408000
*            END;                                                  0320 00409000
*                                                                  0320 00410000
*          ELSE                                                    0321 00411000
*            IF (ADDR(OUTDS)) ^= NULLPTR                           0321 00412000
*              THEN                                                0321 00413000
         B     @RC00315                                            0321 00414000
@RF00315 L     @08,@PC00001+4                                      0321 00415000
         L     @08,FDTPTR+44(,@08)                                 0321 00416000
         LTR   @08,@08                                             0321 00417000
         BZ    @RF00321                                            0321 00418000
*                DO;                                               0322 00419000
*                                                                  0322 00420000
*                /****************************************************/ 00421000
*                /*                                          @YL026UG*/ 00422000
*                /* IN TSO ENVIRONMENT THE DATA SET NAME MAY @YL026UG*/ 00423000
*                /* BE UNQUALIFIED, ISSUE THE AMS UQUAL MACRO        */ 00424000
*                /* IF OUTDSFUQ IS TURNED ON.                @YL026UG*/ 00425000
*                /*                                          @YL026UG*/ 00426000
*                /****************************************************/ 00427000
*                IF OUTDSFUQ = ON                                  0323 00428000
*                  THEN                                            0323 00429000
         TM    OUTDSFUQ(@08),B'10000000'                           0323 00430000
         BNO   @RF00323                                            0323 00431000
*QQUAL02:            DO;                                   /*@YL026UG*/ 00432000
*                                                                  0324 00433000
QQUAL02  DS    0H                                                  0325 00434000
*                    QDSNPTR = ADDR(OUTDSVAL);             /*@YL026UG*/ 00435000
         L     @08,@PC00001+4                                      0325 00436000
         L     @08,FDTPTR+44(,@08)                                 0325 00437000
         LA    @03,OUTDSVAL(,@08)                                  0325 00438000
         ST    @03,QDSNPTR                                         0325 00439000
*                    QDSNLEN = OUTDSLEN;                   /*@YL026UG*/ 00440000
         SLR   @03,@03                                             0326 00441000
         IC    @03,OUTDSLEN(,@08)                                  0326 00442000
         STH   @03,QDSNLEN                                         0326 00443000
*                    QCATPTR = NULLPTR;                    /*@YL026UG*/ 00444000
*                                                                  0327 00445000
         SLR   @03,@03                                             0327 00446000
         ST    @03,QCATPTR                                         0327 00447000
*                    IF OUTDSPLN ^= 0                              0328 00448000
*                      THEN                                        0328 00449000
         CLI   OUTDSPLN(@08),0                                     0328 00450000
         BE    @RF00328                                            0328 00451000
*                        QCATPSWD = ADDR(OUTDSPAS);        /*@YL026UG*/ 00452000
*                                                                  0329 00453000
         LA    @08,OUTDSPAS(,@08)                                  0329 00454000
         ST    @08,QCATPSWD                                        0329 00455000
*                      ELSE                                        0330 00456000
*                        QCATPSWD = NULLPTR;               /*@YL026UG*/ 00457000
*                                                                  0330 00458000
         B     @RC00328                                            0330 00459000
@RF00328 SLR   @08,@08                                             0330 00460000
         ST    @08,QCATPSWD                                        0330 00461000
*                    CALL IDCSAQL0(GDTTBL,                         0331 00462000
*                      QDSNPTR,        /* PTR TO DSNAME      @YL026UG*/ 00463000
*                      QDSNLEN,        /* LEN OF DSNAME      @YL026UG*/ 00464000
*                      QCATPTR,        /* PTR TO CATNAME     @YL026UG*/ 00465000
*                      QCATPSWD);      /* PTR TO CAT PSWD    @YL026UG*/ 00466000
*                                                                  0331 00467000
@RC00328 L     @08,@PC00001                                        0331 00468000
         ST    @08,@AL00001                                        0331 00469000
         LA    @03,QDSNPTR                                         0331 00470000
         ST    @03,@AL00001+4                                      0331 00471000
         LA    @03,QDSNLEN                                         0331 00472000
         ST    @03,@AL00001+8                                      0331 00473000
         LA    @03,QCATPTR                                         0331 00474000
         ST    @03,@AL00001+12                                     0331 00475000
         LA    @03,QCATPSWD                                        0331 00476000
         ST    @03,@AL00001+16                                     0331 00477000
         MVI   @AL00001+16,X'80'                                   0331 00478000
         L     @15,GDTQAL(,@08)                                    0331 00479000
         LA    @01,@AL00001                                        0331 00480000
         BALR  @14,@15                                             0331 00481000
*                    RESPECIFY RTNREG RSTD;                        0332 00482000
*                    TESTRC = RTNREG;                              0333 00483000
         STH   RTNREG,TESTRC                                       0333 00484000
*                    RESPECIFY RTNREG UNRSTD;              /*@YL026UG*/ 00485000
*                                                                  0334 00486000
*                    IF TESTRC ^= 0                                0335 00487000
*                      THEN                                        0335 00488000
         LH    @08,TESTRC                                          0335 00489000
         LTR   @08,@08                                             0335 00490000
         BZ    @RF00335                                            0335 00491000
*                        STATFLG = TERMERR;                /*@YL026UG*/ 00492000
*                                                                  0336 00493000
         MVC   STATFLG(5),@CB00819                                 0336 00494000
*                    END QQUAL02;                          /*@YL026UG*/ 00495000
*                                                                  0337 00496000
*                                                                  0337 00497000
@RF00335 DS    0H                                                  0338 00498000
*                /****************************************************/ 00499000
*                /*                                                  */ 00500000
*                /* REFERENCE THE PASSWORD FROM THE OPNAGL           */ 00501000
*                /*                                                  */ 00502000
*                /****************************************************/ 00503000
*                IF OUTDSPLN ^= 0                                  0338 00504000
*                  THEN                                            0338 00505000
@RF00323 L     @08,@PC00001+4                                      0338 00506000
         L     @08,FDTPTR+44(,@08)                                 0338 00507000
         CLI   OUTDSPLN(@08),0                                     0338 00508000
         BE    @RF00338                                            0338 00509000
*                    OPNPWA = ADDR(OUTDSPAS);              /*@Y30SSEC*/ 00510000
*                                                                  0339 00511000
         LA    @08,OUTDSPAS(,@08)                                  0339 00512000
         ST    @08,OPNPWA(,OPNPTR)                                 0339 00513000
*                /****************************************************/ 00514000
*                /* CONSTRUCT AN ALLOCATE AGL AND CALL ROUTINE TO    */ 00515000
*                /* INVOKE DYNAMIC ALLOCATION TO GET A DDNAME TO     */ 00516000
*                /* PLACE IN THE OPEN ARGUMENT LIST          @Y30SSSB*/ 00517000
*                /****************************************************/ 00518000
*                RFY ALLAGL BASED(ALLAGLPT);               /*@Y30SSSB*/ 00519000
@RF00338 DS    0H                                                  0341 00520000
*                ALLAGLPT=ADDR(ALLAGLWK);                  /*@Y30SSSB*/ 00521000
         LA    @08,ALLAGLWK                                        0341 00522000
         ST    @08,ALLAGLPT                                        0341 00523000
*                ALLAGL=''B;                               /*@Y30SSSB*/ 00524000
         XC    ALLAGL(31,@08),ALLAGL(@08)                          0342 00525000
*                ALLDSN=ADDR(OUTDSVAL);                    /*@Y30SSSB*/ 00526000
         L     @03,@PC00001+4                                      0343 00527000
         L     @03,FDTPTR+44(,@03)                                 0343 00528000
         LA    @03,OUTDSVAL(,@03)                                  0343 00529000
         ST    @03,ALLDSN(,@08)                                    0343 00530000
*                ALLPWD=OPNPWA;                            /*@Y30SSSB*/ 00531000
         MVC   ALLPWD(4,@08),OPNPWA(OPNPTR)                        0344 00532000
*                ALLOPTDS=ON;                              /*@Y30SSSB*/ 00533000
         OI    ALLOPTDS(@08),B'01000000'                           0345 00534000
*                ALLSTSOD=ON;                              /*@Y30SSSB*/ 00535000
         OI    ALLSTSOD(@08),B'00000001'                           0346 00536000
*                ALLDSPKP=ON;                              /*@Y30SSSB*/ 00537000
*                                                                  0347 00538000
         OI    ALLDSPKP(@08),B'00001000'                           0347 00539000
*                CALL IDCSAAL0 (GDTTBL,ALLAGL);            /*@Y30SSSB*/ 00540000
*                                                                  0348 00541000
         L     @03,@PC00001                                        0348 00542000
         ST    @03,@AL00001                                        0348 00543000
         ST    @08,@AL00001+4                                      0348 00544000
         MVI   @AL00001+4,X'80'                                    0348 00545000
         L     @15,GDTALC(,@03)                                    0348 00546000
         LA    @01,@AL00001                                        0348 00547000
         BALR  @14,@15                                             0348 00548000
*                RESPECIFY RTNREG RSTD;                            0349 00549000
*                TESTRC = RTNREG;                                  0350 00550000
         STH   RTNREG,TESTRC                                       0350 00551000
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSSB*/ 00552000
*                IF TESTRC ^= 0                            /*@OZ05922*/ 00553000
*                  THEN                                    /*@OZ05922*/ 00554000
         LH    @08,TESTRC                                          0352 00555000
         LTR   @08,@08                                             0352 00556000
         BZ    @RF00352                                            0352 00557000
*                    STATFLG = TERMERR;                    /*@OZ05922*/ 00558000
         MVC   STATFLG(5),@CB00819                                 0353 00559000
*                  ELSE                                    /*@OZ05922*/ 00560000
*                    OPNDDN=ADDR(ALLDDN);                  /*@Y30SSSB*/ 00561000
*                                                                  0354 00562000
         B     @RC00352                                            0354 00563000
@RF00352 L     @08,ALLAGLPT                                        0354 00564000
         LA    @08,ALLDDN(,@08)                                    0354 00565000
         ST    @08,OPNDDN(,OPNPTR)                                 0354 00566000
*                END;                                              0355 00567000
@RC00352 DS    0H                                                  0356 00568000
*        /************************************************************/ 00569000
*        /*                                                  @Y30SSJH*/ 00570000
*        /*  THE REUSABLE ATTRIBUTE IS NOTED IN THE OPNAGL   @Y30SSJH*/ 00571000
*        /*                                                  @Y30SSJH*/ 00572000
*        /************************************************************/ 00573000
*                                                                  0356 00574000
*        IF (ADDR(RUS)) ^= NULLPTR                                 0356 00575000
*          THEN                                                    0356 00576000
@RF00321 DS    0H                                                  0356 00577000
@RC00315 L     @08,@PC00001+4                                      0356 00578000
         L     @08,FDTPTR+200(,@08)                                0356 00579000
         LTR   @08,@08                                             0356 00580000
         BZ    @RF00356                                            0356 00581000
*            OPNMODRS = ON;                                /*@Y30SSJH*/ 00582000
         OI    OPNMODRS(OPNPTR),B'00000100'                        0357 00583000
*          ELSE;                                           /*@Y30SSJH*/ 00584000
*                                                                  0358 00585000
@RF00356 DS    0H                                                  0359 00586000
*        /************************************************************/ 00587000
*        /*                                                  @Y30SSJH*/ 00588000
*        /*  REPLACE PROCESSING IS NOTED IN THE OPNAGL       @Y30SSJH*/ 00589000
*        /*                                                  @Y30SSJH*/ 00590000
*        /************************************************************/ 00591000
*                                                                  0359 00592000
*        IF (ADDR(REP)) ^= NULLPTR                                 0359 00593000
*          THEN                                                    0359 00594000
         L     @08,@PC00001+4                                      0359 00595000
         L     @08,FDTPTR+192(,@08)                                0359 00596000
         LTR   @08,@08                                             0359 00597000
         BZ    @RF00359                                            0359 00598000
*            DO;                                           /*@Y30SSJH*/ 00599000
*                                                                  0360 00600000
*              OPNMODRP = ON;                              /*@Y30SSJH*/ 00601000
*                                                                  0361 00602000
         OI    OPNMODRP(OPNPTR),B'00000001'                        0361 00603000
*            END;                                          /*@Y30SSJH*/ 00604000
*          ELSE;                                           /*@Y30SSJH*/ 00605000
*                                                                  0363 00606000
@RF00359 DS    0H                                                  0364 00607000
*        /************************************************************/ 00608000
*        /*                                                          */ 00609000
*        /* OPEN THE INPUT AND OUTPUT DATA SETS                      */ 00610000
*        /*                                                          */ 00611000
*        /************************************************************/ 00612000
*                                                                  0364 00613000
*        IF STATFLG = NORMAL                                       0364 00614000
*          THEN                                                    0364 00615000
         CLC   STATFLG(5),@CB00816                                 0364 00616000
         BNE   @RF00364                                            0364 00617000
*            DO;                                           /*@YL026UG*/ 00618000
*                                                                  0365 00619000
*            CALL IDCIOOP0 (GDTTBL,OPAGLST1,OPAGLST2);     /*@YL026UG*/ 00620000
         L     @08,@PC00001                                        0366 00621000
         ST    @08,@AL00001                                        0366 00622000
         LA    @15,OPAGLST1                                        0366 00623000
         ST    @15,@AL00001+4                                      0366 00624000
         LA    @15,OPAGLST2                                        0366 00625000
         ST    @15,@AL00001+8                                      0366 00626000
         MVI   @AL00001+8,X'80'                                    0366 00627000
         L     @15,GDTOPN(,@08)                                    0366 00628000
         LA    @01,@AL00001                                        0366 00629000
         BALR  @14,@15                                             0366 00630000
*            RESPECIFY RTNREG RSTD;                                0367 00631000
*            TESTRC = RTNREG;                                      0368 00632000
         STH   RTNREG,TESTRC                                       0368 00633000
*            RESPECIFY RTNREG UNRSTD;                      /*@YL026UG*/ 00634000
*                                                                  0369 00635000
*        /************************************************************/ 00636000
*        /*                                                  @OZ20461*/ 00637000
*        /* IF THE INPUT DATA SET WAS OPENED WITH A          @OZ20461*/ 00638000
*        /* WARNING ERROR, PROCESSING WILL CONTINUE. ANY     @OZ20461*/ 00639000
*        /* OTHER OPEN ERROR WILL CAUSE PROCESSING TO BE     @OZ20461*/ 00640000
*        /* TERMINATED.                                      @OZ20461*/ 00641000
*        /*                                                  @OZ20461*/ 00642000
*        /************************************************************/ 00643000
*                                                                  0370 00644000
*            IOCSPTR = IOCSINP;                            /*@OZ11053*/ 00645000
*                                                                  0370 00646000
         L     @08,IOCSINP                                         0370 00647000
         ST    @08,IOCSPTR                                         0370 00648000
*            IF TESTRC ^= 0                                /*@OZ20461*/ 00649000
*              THEN                                                0371 00650000
         LH    @15,TESTRC                                          0371 00651000
         SLR   @14,@14                                             0371 00652000
         CR    @15,@14                                             0371 00653000
         BE    @RF00371                                            0371 00654000
*                DO;                                       /*@YL026UG*/ 00655000
*                                                                  0372 00656000
*                OLDERID2 = NEWERID2;                              0373 00657000
         L     @15,@PC00001                                        0373 00658000
         L     @15,GDTTR2(,@15)                                    0373 00659000
         MVC   @TS00001(95),NEWERID2(@15)                          0373 00660000
         MVC   OLDERID2(95,@15),@TS00001                           0373 00661000
*                NEWID2 = 'RP12';                          /*@YL026LO*/ 00662000
         MVC   NEWID2(4,@15),@CC01127                              0374 00663000
*                IF IOCSINP = NULLPTR THEN                         0375 00664000
         CR    @08,@14                                             0375 00665000
         BNE   @RF00375                                            0375 00666000
*                    STATFLG = TERMERR;                    /*@OZ20461*/ 00667000
         MVC   STATFLG(5),@CB00819                                 0376 00668000
*                ELSE                                      /*@OZ20461*/ 00669000
*                  IF IOCMSGOP = OFF | IOCVRC > 116 THEN   /*@OZ20461*/ 00670000
         B     @RC00375                                            0377 00671000
@RF00375 L     @08,IOCSPTR                                         0377 00672000
         TM    IOCMSGOP(@08),B'00100000'                           0377 00673000
         BZ    @RT00377                                            0377 00674000
         CLC   IOCVRC(4,@08),@CF01128                              0377 00675000
         BNH   @RF00377                                            0377 00676000
@RT00377 DS    0H                                                  0378 00677000
*                    STATFLG = TERMERR;                    /*@OZ20461*/ 00678000
         MVC   STATFLG(5),@CB00819                                 0378 00679000
*                  ELSE                                    /*@OZ20461*/ 00680000
*                    IF IOCVRC ^= 0 THEN                   /*@OZ20461*/ 00681000
         B     @RC00377                                            0379 00682000
@RF00377 L     @08,IOCSPTR                                         0379 00683000
         L     @08,IOCVRC(,@08)                                    0379 00684000
         LTR   @08,@08                                             0379 00685000
         BZ    @RF00379                                            0379 00686000
*                      OPNWRN = ON;                        /*@OZ20461*/ 00687000
         OI    OPNWRN,B'10000000'                                  0380 00688000
*                                                          /*@OZ20461*/ 00689000
*                IOCSPTR = IOCSOUT;                        /*@OZ20461*/ 00690000
@RF00379 DS    0H                                                  0381 00691000
@RC00377 DS    0H                                                  0381 00692000
@RC00375 L     @08,IOCSOUT                                         0381 00693000
         ST    @08,IOCSPTR                                         0381 00694000
*                IF STATFLG = NORMAL THEN                  /*@OZ20461*/ 00695000
         CLC   STATFLG(5),@CB00816                                 0382 00696000
         BNE   @RF00382                                            0382 00697000
*                  IF IOCSOUT = NULLPTR THEN               /*@OZ20461*/ 00698000
         LTR   @08,@08                                             0383 00699000
         BNZ   @RF00383                                            0383 00700000
*                    STATFLG = TERMERR;                    /*@OZ20461*/ 00701000
         MVC   STATFLG(5),@CB00819                                 0384 00702000
*                  ELSE                                    /*@OZ20461*/ 00703000
*                    IF IOCMSGOP = OFF | IOCVRC ^= 0 THEN  /*@OZ20461*/ 00704000
         B     @RC00383                                            0385 00705000
@RF00383 L     @08,IOCSPTR                                         0385 00706000
         TM    IOCMSGOP(@08),B'00100000'                           0385 00707000
         BZ    @RT00385                                            0385 00708000
         L     @08,IOCVRC(,@08)                                    0385 00709000
         LTR   @08,@08                                             0385 00710000
         BZ    @RF00385                                            0385 00711000
@RT00385 DS    0H                                                  0386 00712000
*                      STATFLG = TERMERR;                  /*@OZ20461*/ 00713000
         MVC   STATFLG(5),@CB00819                                 0386 00714000
*                                                          /*@OZ20461*/ 00715000
*                END;                                      /*@YL026UG*/ 00716000
*                                                                  0387 00717000
@RF00385 DS    0H                                                  0387 00718000
@RC00383 DS    0H                                                  0387 00719000
@RF00382 DS    0H                                                  0388 00720000
*            END;                                          /*@YL026UG*/ 00721000
@RF00371 DS    0H                                                  0389 00722000
*                                                                  0389 00723000
*        /************************************************************/ 00724000
*        /*                                                  @Y30SSJH*/ 00725000
*        /* VALIDITY TEST -                                  @Y30SSJH*/ 00726000
*        /*   CHECK FOR NON-RELATIVE RECORD INPUT DATA SET   @Y30SSJH*/ 00727000
*        /*   TOGETHER WITH NON-EMPTY RELATIVE RECORD OUTPUT @Y30SSJH*/ 00728000
*        /*   DATA SET.                                      @Y30SSJH*/ 00729000
*        /*                                                  @Y30SSJH*/ 00730000
*        /************************************************************/ 00731000
*                                                                  0389 00732000
*        IF (IOCSOUT -> IOCHURBA ^= 0 &                            0389 00733000
*            IOCSOUT -> IOCMACRR = ON ) &                          0389 00734000
*            IOCSINP -> IOCMACRR = OFF &                           0389 00735000
*            STATFLG = NORMAL                                      0389 00736000
*          THEN                                                    0389 00737000
@RF00364 L     @08,IOCSOUT                                         0389 00738000
         L     @15,IOCHURBA(,@08)                                  0389 00739000
         LTR   @15,@15                                             0389 00740000
         BZ    @RF00389                                            0389 00741000
         TM    IOCMACRR(@08),B'00100000'                           0389 00742000
         BNO   @RF00389                                            0389 00743000
         L     @08,IOCSINP                                         0389 00744000
         TM    IOCMACRR(@08),B'00100000'                           0389 00745000
         BNZ   @RF00389                                            0389 00746000
         CLC   STATFLG(5),@CB00816                                 0389 00747000
         BNE   @RF00389                                            0389 00748000
*            DO;                                           /*@Y30SSJH*/ 00749000
*                                                                  0390 00750000
*            STATFLG = TERMERR;                            /*@Y30SSJH*/ 00751000
         MVC   STATFLG(5),@CB00819                                 0391 00752000
*            DARGL = ''B;                                  /*@Y30SSLO*/ 00753000
         XC    DARGL(28),DARGL                                     0392 00754000
*            DARGSENT = 14;                                /*@Y30SSEC*/ 00755000
         L     @08,DDSTRU                                          0393 00756000
         MVI   DARGSENT(@08),X'0E'                                 0393 00757000
*            DARGSMOD = 'PR0';                             /*@Y30SSJH*/ 00758000
*                                                                  0394 00759000
         MVC   DARGSMOD(3,@08),@CC01129                            0394 00760000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30SSJH*/ 00761000
*                                                                  0395 00762000
         L     @08,@PC00001                                        0395 00763000
         ST    @08,@AL00001                                        0395 00764000
         LA    @15,@CF00115                                        0395 00765000
         ST    @15,@AL00001+4                                      0395 00766000
         LA    @15,DDSTRU                                          0395 00767000
         ST    @15,@AL00001+8                                      0395 00768000
         MVI   @AL00001+8,X'80'                                    0395 00769000
         L     @15,GDTPRT(,@08)                                    0395 00770000
         LA    @01,@AL00001                                        0395 00771000
         BALR  @14,@15                                             0395 00772000
*            END;                                          /*@Y30SSJH*/ 00773000
*                                                                  0396 00774000
*        /************************************************************/ 00775000
*        /*                                                  @OZ00751*/ 00776000
*        /* EACH DATA SET MUST BE INTERROGATED IN TURN TO SEE@OZ00751*/ 00777000
*        /* IF IT IS A CATALOG. THIS IS DONE BY LOCATING THE @OZ00751*/ 00778000
*        /* CATALOG ENTRY. DETERMINATION THAT THE OBJECT IS  @OZ00751*/ 00779000
*        /* A CATALOG IS VIA THE TYPE AND/OR CONTROL INTERVAL@OZ00751*/ 00780000
*        /* #. IF THE TARGET IS FOUND TO BE A CATALOG THEN   @OZ00751*/ 00781000
*        /* CATRELSW IS TURNED ON                            @OZ00751*/ 00782000
*        /* IF BOTH SOURCE AND TARGET ARE CATALOGS, THEN     @Y30SSEC*/ 00783000
*        /* THE CATRELSW IS TURNED OFF AND CATCOPSW IS       @Y30SSEC*/ 00784000
*        /* TURNED ON TO COPY CATALOGS. IF COPY CATALOG IS   @Y30SSEC*/ 00785000
*        /* REQUIRED, THEN A CHECK IS MADE TO VERIFY THAT    @Y30SSEC*/ 00786000
*        /* BOTH SOURCE AND TARGET ARE NOT RECOVERABLE.      @Y30SSEC*/ 00787000
*        /*                                                  @OZ00751*/ 00788000
*        /************************************************************/ 00789000
*                                                                  0397 00790000
*        IF STATFLG=NORMAL                                         0397 00791000
*          THEN                                                    0397 00792000
*                                                                  0397 00793000
@RF00389 CLC   STATFLG(5),@CB00816                                 0397 00794000
         BNE   @RF00397                                            0397 00795000
*CATCPYCK:   DO;                                           /*@OZ00751*/ 00796000
*                                                                  0398 00797000
CATCPYCK DS    0H                                                  0399 00798000
*            IOCSPTR = IOCSOUT;         /* PROCESS OUTPUT    @OZ00751*/ 00799000
         MVC   IOCSPTR(4),IOCSOUT                                  0399 00800000
*            OPNPTR  = ADDR(OPAGLST2);                     /*@OZ00751*/ 00801000
*                                                                  0400 00802000
         LA    OPNPTR,OPAGLST2                                     0400 00803000
*CATLGCHK:     DO J =1 TO 2;                               /*@OZ00751*/ 00804000
*                                                                  0401 00805000
CATLGCHK LA    J,1                                                 0401 00806000
@DL00401 DS    0H                                                  0402 00807000
*                /****************************************************/ 00808000
*                /*                                        /*@OZ00751*/ 00809000
*                /* IF IOCS FLAG INDICATES THIS IS A VSAM    @OZ00751*/ 00810000
*                /* DATA SET ORGANIZATION, CHECK TO SEE      @OZ00751*/ 00811000
*                /* IF IT IS A CATALOG.                      @OZ00751*/ 00812000
*                /*                                          @OZ00751*/ 00813000
*                /****************************************************/ 00814000
*                                                                  0402 00815000
*                IF IOCDSOAM = ON                                  0402 00816000
*                  THEN                                            0402 00817000
         L     @08,IOCSPTR                                         0402 00818000
         TM    IOCDSOAM(@08),B'10000000'                           0402 00819000
         BNO   @RF00402                                            0402 00820000
*VSAMCHK:            DO;                                   /*@OZ00751*/ 00821000
*                                                                  0403 00822000
VSAMCHK  DS    0H                                                  0404 00823000
*                    LOCATWKA = ''B;     /* ZERO LOCATE STRUC@OZ00751*/ 00824000
         XC    LOCATWKA(180),LOCATWKA                              0404 00825000
*                    LOCCPLID = 'LOCATCPL';/* DUMP ID FOR CPL@OZ00751*/ 00826000
         MVC   LOCCPLID(8),@CC01136                                0405 00827000
*                    CTGPLPTR = ADDR(LOCATCPL);/* SET CPL PTR@OZ00751*/ 00828000
         LA    @08,LOCATCPL                                        0406 00829000
         ST    @08,CTGPLPTR                                        0406 00830000
*                    CTGFUNC  = CTGLOC;  /* SET LOCATE FLAG  @OZ00751*/ 00831000
         NI    CTGFUNC(@08),B'00111111'                            0407 00832000
         OI    CTGFUNC(@08),B'00100000'                            0407 00833000
*                    CTGAM0   = ON;      /* SET VSAM FUNCTION@OZ00751*/ 00834000
*                    CTGSRH   = OFF;     /* SEARCH VSAM CATLG@OZ00751*/ 00835000
*                    CTGNUM   = ON;      /* ONLY VSAM CATLG  @OZ00751*/ 00836000
         OI    CTGAM0(@08),B'00000011'                             0410 00837000
         NI    CTGSRH(@08),B'11111011'                             0410 00838000
*                    CTGNAME  = ON;      /* LOCATE BY NAME   @OZ00751*/ 00839000
         OI    CTGNAME(@08),B'00000100'                            0411 00840000
*                    CTGNOFLD =  3;      /* NUMBER OF FPLS   @Y30SSEC*/ 00841000
         MVI   CTGNOFLD(@08),X'03'                                 0412 00842000
*                    CTGWKA   = ADDR(LOCWKA); /* ADDR OF WKA @OZ00751*/ 00843000
         LA    @07,LOCWKA                                          0413 00844000
         ST    @07,CTGWKA(,@08)                                    0413 00845000
*                    LOCWKALN = 40;      /* WKA LENGTH       @OZ00751*/ 00846000
         MVC   LOCWKALN(2),@CH00812                                0414 00847000
*                    CTGENT   = IOCDSN;  /* ADDR OF NAME     @OZ00751*/ 00848000
         L     @07,IOCSPTR                                         0415 00849000
         MVC   CTGENT(4,@08),IOCDSN(@07)                           0415 00850000
*                    IF J = 1                              /*@Y30SSEC*/ 00851000
*                      THEN   /*  SET PASWORDS               @Y30SSEC*/ 00852000
         CH    J,@CH00219                                          0416 00853000
         BNE   @RF00416                                            0416 00854000
*                        DO;                               /*@Y30SSEC*/ 00855000
*                          IF ADDR(OUTDD) ^= 0 & OUTDDPLN ^= 0     0418 00856000
*                             THEN                         /*@Y30SSEC*/ 00857000
         L     @07,@PC00001+4                                      0418 00858000
         L     @07,FDTPTR+36(,@07)                                 0418 00859000
         LTR   @07,@07                                             0418 00860000
         BZ    @RF00418                                            0418 00861000
         CLI   OUTDDPLN(@07),0                                     0418 00862000
         BE    @RF00418                                            0418 00863000
*                               CTGPSWD = ADDR(OUTDDPAS);  /*@Y30SSEC*/ 00864000
         LA    @07,OUTDDPAS(,@07)                                  0419 00865000
         ST    @07,CTGPSWD(,@08)                                   0419 00866000
*                             ELSE                         /*@Y30SSEC*/ 00867000
*                               IF ADDR(OUTDS) ^= 0 & OUTDSPLN ^= 0     00868000
*                                  THEN CTGPSWD = ADDR(OUTDSPAS);  0420 00869000
         B     @RC00418                                            0420 00870000
@RF00418 L     @08,@PC00001+4                                      0420 00871000
         L     @08,FDTPTR+44(,@08)                                 0420 00872000
         LTR   @08,@08                                             0420 00873000
         BZ    @RF00420                                            0420 00874000
         CLI   OUTDSPLN(@08),0                                     0420 00875000
         BE    @RF00420                                            0420 00876000
         LA    @08,OUTDSPAS(,@08)                                  0421 00877000
         L     @07,CTGPLPTR                                        0421 00878000
         ST    @08,CTGPSWD(,@07)                                   0421 00879000
*                                  ELSE;                   /*@Y30SSEC*/ 00880000
@RF00420 DS    0H                                                  0423 00881000
*                          IF ADDR(INPDD) ^= 0 & INPDDPLN ^= 0     0423 00882000
*                             THEN                         /*@Y30SSEC*/ 00883000
@RC00418 L     @08,@PC00001+4                                      0423 00884000
         L     @08,FDTPTR+32(,@08)                                 0423 00885000
         LTR   @08,@08                                             0423 00886000
         BZ    @RF00423                                            0423 00887000
         CLI   INPDDPLN(@08),0                                     0423 00888000
         BE    @RF00423                                            0423 00889000
*                               CTGPSWD = ADDR(INPDDPAS);  /*@Y30SSEC*/ 00890000
         LA    @08,INPDDPAS(,@08)                                  0424 00891000
         L     @07,CTGPLPTR                                        0424 00892000
         ST    @08,CTGPSWD(,@07)                                   0424 00893000
*                             ELSE                         /*@Y30SSEC*/ 00894000
*                               IF ADDR(INDS) ^= 0 & INDSPLN ^= 0  0425 00895000
*                                  THEN CTGPSWD = ADDR(INDSPAS);   0425 00896000
         B     @RC00423                                            0425 00897000
@RF00423 L     @08,@PC00001+4                                      0425 00898000
         L     @08,FDTPTR+280(,@08)                                0425 00899000
         LTR   @08,@08                                             0425 00900000
         BZ    @RF00425                                            0425 00901000
         CLI   INDSPLN(@08),0                                      0425 00902000
         BE    @RF00425                                            0425 00903000
         LA    @08,INDSPAS(,@08)                                   0426 00904000
         L     @07,CTGPLPTR                                        0426 00905000
         ST    @08,CTGPSWD(,@07)                                   0426 00906000
*                                  ELSE;                   /*@Y30SSEC*/ 00907000
@RF00425 DS    0H                                                  0428 00908000
*                        END;                              /*@Y30SSEC*/ 00909000
@RC00423 DS    0H                                                  0429 00910000
*                    /************************************************/ 00911000
*                    /*                                      @OZ00751*/ 00912000
*                    /* INITIALIZE ENTYPE AND ENTIDNO        @OZ00751*/ 00913000
*                    /*        AND ACB FPLS                  @Y30SSEC*/ 00914000
*                    /*                                      @OZ00751*/ 00915000
*                    /************************************************/ 00916000
*                                                                  0429 00917000
*                    CTGFLPTR = ADDR(ENTYPFPL);            /*@OZ00751*/ 00918000
*                                                                  0429 00919000
@RF00416 LA    CTGFLPTR,ENTYPFPL                                   0429 00920000
*                      DO N = 1 TO 3;                      /*@Y30SSEC*/ 00921000
*                                                                  0430 00922000
         LA    N,1                                                 0430 00923000
@DL00430 DS    0H                                                  0431 00924000
*                        CTGFLDNO = 1;                     /*@OZ00751*/ 00925000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0431 00926000
*                        CTGFLDNM = ADDR(TYPFIELD(N));     /*@OZ00751*/ 00927000
         LR    @08,N                                               0432 00928000
         SLA   @08,3                                               0432 00929000
         LA    @08,TYPFIELD-8(@08)                                 0432 00930000
         ST    @08,CTGFLDNM(,CTGFLPTR)                             0432 00931000
*                        CTGFIELD(N) = CTGFLPTR;           /*@OZ00751*/ 00932000
         LR    @08,N                                               0433 00933000
         SLA   @08,2                                               0433 00934000
         L     @04,CTGPLPTR                                        0433 00935000
         ST    CTGFLPTR,CTGFIELD-4(@08,@04)                        0433 00936000
*                        CTGFLPTR =                                0434 00937000
*                           CTGFLPTR + (LENGTH(CTGFL)+12); /*@OZ00751*/ 00938000
         AH    CTGFLPTR,@CH01283                                   0434 00939000
*                      END;                                /*@OZ00751*/ 00940000
*                                                                  0435 00941000
         AH    N,@CH00219                                          0435 00942000
         CH    N,@CH00162                                          0435 00943000
         BNH   @DL00430                                            0435 00944000
*                    /************************************************/ 00945000
*                    /*                                      @OZ00751*/ 00946000
*                    /* INVOKE VSAM CATALOG FOR LOCATE REQ   @OZ00751*/ 00947000
*                    /*                                      @OZ00751*/ 00948000
*                    /************************************************/ 00949000
*                                                                  0436 00950000
*                    CALL IDCSACA0 (GDTTBL,CTGPLPTR);      /*@OZ00751*/ 00951000
*                                                                  0436 00952000
         L     @08,@PC00001                                        0436 00953000
         ST    @08,@AL00001                                        0436 00954000
         LA    @07,CTGPLPTR                                        0436 00955000
         ST    @07,@AL00001+4                                      0436 00956000
         L     @15,GDTCAT(,@08)                                    0436 00957000
         LA    @01,@AL00001                                        0436 00958000
         BALR  @14,@15                                             0436 00959000
*                    CTGRTNCC = RTNREG;                    /*@OZ00751*/ 00960000
*                                                                  0437 00961000
         LR    CTGRTNCC,RTNREG                                     0437 00962000
*                    /************************************************/ 00963000
*                    /*                                      @OZ00751*/ 00964000
*                    /* IF THE ENTRY IS LOCATED, CHECK TO    @OZ00751*/ 00965000
*                    /* SEE IF THE ENTRY IS A CATALOG. IF    @OZ00751*/ 00966000
*                    /* THE RTN CODE IS NON ZERO THERE IS    @OZ00751*/ 00967000
*                    /* NO MESSAGE PRINTED                   @OZ00751*/ 00968000
*                    /*                                      @OZ00751*/ 00969000
*                    /************************************************/ 00970000
*                                                                  0438 00971000
*                    IF CTGRTNCC = 0                               0438 00972000
*                      THEN                                        0438 00973000
         LTR   CTGRTNCC,CTGRTNCC                                   0438 00974000
         BNZ   @RF00438                                            0438 00975000
*                        DO;                               /*@OZ00751*/ 00976000
*                                                                  0439 00977000
*                        /********************************************/ 00978000
*                        /*                                  @OZ00751*/ 00979000
*                        /* ONE OF TWO CONDITIONS INDICATE   @OZ00751*/ 00980000
*                        /* THAT THIS ENTRY IS A CATALOG:    @OZ00751*/ 00981000
*                        /*   : THE ENTRY TYPE IS 'U'        @OZ00751*/ 00982000
*                        /*   : THE CI # IS 2                @Y30SSEC*/ 00983000
*                        /* THE ENTIDNO AND ENTYPE FPLS      @OZ00751*/ 00984000
*                        /* REFERENCE THE OBJECTS            @OZ00751*/ 00985000
*                        /* CHARACTERISTICS                  @OZ00751*/ 00986000
*                        /*                                  @OZ00751*/ 00987000
*                        /********************************************/ 00988000
*                                                                  0440 00989000
*                        CTGFLPTR = CTGFIELD(1);           /*@OZ00751*/ 00990000
*                                                                  0440 00991000
         L     @08,CTGPLPTR                                        0440 00992000
         L     @03,CTGFIELD(,@08)                                  0440 00993000
         LR    CTGFLPTR,@03                                        0440 00994000
*                        IF CTGFLPT(1) -> ENTRYTYP = 'U' |         0441 00995000
*                            (CTGFIELD(1)->CTGFLPT(1)->ENTRYTYP='C' &   00996000
*                             CTGFIELD(2) -> CTGFLPT(1)-> ENTRYCI# = 2) 00997000
*                          THEN                                    0441 00998000
         L     @01,CTGFLPT(,CTGFLPTR)                              0441 00999000
         CLI   ENTRYTYP(@01),C'U'                                  0441 01000000
         BE    @RT00441                                            0441 01001000
         L     @03,CTGFLPT(,@03)                                   0441 01002000
         CLI   ENTRYTYP(@03),C'C'                                  0441 01003000
         BNE   @RF00441                                            0441 01004000
         L     @08,CTGFIELD+4(,@08)                                0441 01005000
         L     @08,CTGFLPT(,@08)                                   0441 01006000
         CLC   ENTRYCI#(3,@08),@CF00153+1                          0441 01007000
         BNE   @RF00441                                            0441 01008000
@RT00441 DS    0H                                                  0442 01009000
*                            DO;                           /*@OZ00751*/ 01010000
*                                                                  0442 01011000
*                            IF J=1                                0443 01012000
*                              THEN                                0443 01013000
         CH    J,@CH00219                                          0443 01014000
         BNE   @RF00443                                            0443 01015000
*                                CATRELSW = ON;            /*@OZ00751*/ 01016000
*                                                                  0444 01017000
         OI    CATRELSW,B'10000000'                                0444 01018000
*                            IF J = 2   & CATRELSW = ON            0445 01019000
*                              THEN                                0445 01020000
@RF00443 CH    J,@CH00153                                          0445 01021000
         BNE   @RF00445                                            0445 01022000
         TM    CATRELSW,B'10000000'                                0445 01023000
         BNO   @RF00445                                            0445 01024000
*                                DO;                       /*@OZ00751*/ 01025000
*                                                                  0446 01026000
*                                CATCOPSW = ON;            /*@OZ00751*/ 01027000
         OI    CATCOPSW,B'10000000'                                0447 01028000
*                                CATRELSW = OFF;           /*@OZ00751*/ 01029000
*                                                                  0448 01030000
         NI    CATRELSW,B'01111111'                                0448 01031000
*                                END;                      /*@OZ00751*/ 01032000
*                                                                  0449 01033000
*                            CALL VERIFYC;                 /*@OZ00751*/ 01034000
*                                                                  0450 01035000
@RF00445 BAL   @14,VERIFYC                                         0450 01036000
*                              /* SAVE ACB ADDR OF CATALOGS  @Y30SSEC*/ 01037000
*                            HOLDACB(J) = CTGFIELD(3) -> CTGFLPT(1)     01038000
*                                         -> ACBADDR;      /*@Y30SSEC*/ 01039000
         LR    @08,J                                               0451 01040000
         SLA   @08,2                                               0451 01041000
         L     @07,CTGPLPTR                                        0451 01042000
         L     @07,CTGFIELD+8(,@07)                                0451 01043000
         L     @07,CTGFLPT(,@07)                                   0451 01044000
         L     @07,ACBADDR(,@07)                                   0451 01045000
         ST    @07,HOLDACB-4(@08)                                  0451 01046000
*                            END;                          /*@OZ00751*/ 01047000
*                                                                  0452 01048000
*                        END;                              /*@OZ00751*/ 01049000
*                                                                  0453 01050000
@RF00441 DS    0H                                                  0454 01051000
*                    END VSAMCHK;                          /*@OZ00751*/ 01052000
*                                                                  0454 01053000
*                                                                  0454 01054000
@RF00438 DS    0H                                                  0455 01055000
*                OPNPTR  = ADDR(OPAGLST1);                 /*@OZ00751*/ 01056000
*                                                                  0455 01057000
@RF00402 LA    OPNPTR,OPAGLST1                                     0455 01058000
*                IOCSPTR = IOCSINP;                        /*@OZ00751*/ 01059000
*                                                                  0456 01060000
         MVC   IOCSPTR(4),IOCSINP                                  0456 01061000
*              END CATLGCHK;                               /*@OZ00751*/ 01062000
*                                                                  0457 01063000
         AH    J,@CH00219                                          0457 01064000
         CH    J,@CH00153                                          0457 01065000
         BNH   @DL00401                                            0457 01066000
*            /********************************************************/ 01067000
*            /*                                              @OZ00751*/ 01068000
*            /* IF TARGET WAS A CATALOG VERIFY THAT NO       @OZ00751*/ 01069000
*            /* BEGINNING OR ENDING DELIMITERS WERE SPECIFIED@OZ00751*/ 01070000
*            /* FOR THE REQUEST                              @OZ00751*/ 01071000
*            /*                                              @OZ00751*/ 01072000
*            /********************************************************/ 01073000
*                                                                  0458 01074000
*            IF CATRELSW = ON  &                                   0458 01075000
*                 ( (ADDR(FMKYC)) ^= NULLPTR  |                    0458 01076000
*                   (ADDR(FMRBA)) ^= NULLPTR  |                    0458 01077000
*                   (ADDR(SKIP))  ^= NULLPTR  |                    0458 01078000
*                   (ADDR(TOKYC)) ^= NULLPTR  |                    0458 01079000
*                   (ADDR(TORBA)) ^= NULLPTR  |                    0458 01080000
*                   (ADDR(COUNT)) ^= NULLPTR  )                    0458 01081000
*              THEN                                                0458 01082000
         TM    CATRELSW,B'10000000'                                0458 01083000
         BNO   @RF00458                                            0458 01084000
         SLR   @08,@08                                             0458 01085000
         L     @15,@PC00001+4                                      0458 01086000
         C     @08,FDTPTR+8(,@15)                                  0458 01087000
         BNE   @RT00458                                            0458 01088000
         C     @08,FDTPTR+12(,@15)                                 0458 01089000
         BNE   @RT00458                                            0458 01090000
         C     @08,FDTPTR+16(,@15)                                 0458 01091000
         BNE   @RT00458                                            0458 01092000
         C     @08,FDTPTR+20(,@15)                                 0458 01093000
         BNE   @RT00458                                            0458 01094000
         C     @08,FDTPTR+24(,@15)                                 0458 01095000
         BNE   @RT00458                                            0458 01096000
         C     @08,FDTPTR+28(,@15)                                 0458 01097000
         BE    @RF00458                                            0458 01098000
@RT00458 DS    0H                                                  0459 01099000
*                DO;                                       /*@OZ00751*/ 01100000
*                                                                  0459 01101000
*                STATFLG = TERMERR;                        /*@OZ00751*/ 01102000
*                                                                  0460 01103000
         MVC   STATFLG(5),@CB00819                                 0460 01104000
*                /****************************************************/ 01105000
*                /*                                          @OZ00751*/ 01106000
*                /* PUT OUT NO DELIMITERS ALLOWED WHEN TRYING@OZ00751*/ 01107000
*                /* TO RELOAD A CATALOG MESSAGE              @OZ00751*/ 01108000
*                /*                                          @OZ00751*/ 01109000
*                /****************************************************/ 01110000
*                                                                  0461 01111000
*                DARGLIST = ''B;                           /*@OZ00751*/ 01112000
         L     @08,DDSTRU                                          0461 01113000
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0461 01114000
*                DARGSMOD = 'PR0';                         /*@OZ00751*/ 01115000
         MVC   DARGSMOD(3,@08),@CC01129                            0462 01116000
*                DARGSENT = 18;                            /*@OZ00751*/ 01117000
         MVI   DARGSENT(@08),X'12'                                 0463 01118000
*                CALL AMSTP011  (GDTTBL,PRTFILE,DDSTRU);   /*@OZ00751*/ 01119000
*                                                                  0464 01120000
         L     @08,@PC00001                                        0464 01121000
         ST    @08,@AL00001                                        0464 01122000
         LA    @15,@CF00115                                        0464 01123000
         ST    @15,@AL00001+4                                      0464 01124000
         LA    @15,DDSTRU                                          0464 01125000
         ST    @15,@AL00001+8                                      0464 01126000
         MVI   @AL00001+8,X'80'                                    0464 01127000
         L     @15,GDTPRT(,@08)                                    0464 01128000
         LA    @01,@AL00001                                        0464 01129000
         BALR  @14,@15                                             0464 01130000
*                END;                                      /*@OZ00751*/ 01131000
*                                                                  0465 01132000
*            IF CATRELSW = ON & STATFLG = NORMAL                   0466 01133000
*              THEN                                        /*@OZ00751*/ 01134000
@RF00458 TM    CATRELSW,B'10000000'                                0466 01135000
         BNO   @RF00466                                            0466 01136000
         CLC   STATFLG(5),@CB00816                                 0466 01137000
         BNE   @RF00466                                            0466 01138000
*                DO;                                       /*@OZ00751*/ 01139000
*                                                                  0467 01140000
*                /****************************************************/ 01141000
*                /*                                          @OZ00751*/ 01142000
*                /* CALL THE CATALOG RELOAD ROUTINE AFTER    @OZ00751*/ 01143000
*                /* PUTTING OUT A MESSAGE INFORMING THE USER @OZ00751*/ 01144000
*                /* THAT HE IS ABOUT TO RELOAD A CATALOG     @OZ00751*/ 01145000
*                /* AND OPENING TARGET FOR UPDATE            @OZ00751*/ 01146000
*                /*                                          @OZ00751*/ 01147000
*                /****************************************************/ 01148000
*                                                                  0468 01149000
*                DARGLIST = ''B;                           /*@OZ00751*/ 01150000
         L     @08,DDSTRU                                          0468 01151000
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0468 01152000
*                DARGSMOD = 'PR0';                         /*@OZ00751*/ 01153000
         MVC   DARGSMOD(3,@08),@CC01129                            0469 01154000
*                DARGSENT = 19;                            /*@OZ00751*/ 01155000
         MVI   DARGSENT(@08),X'13'                                 0470 01156000
*                CALL AMSTP011  (GDTTBL,PRTFILE,DDSTRU);   /*@OZ00751*/ 01157000
*                                                                  0471 01158000
         L     @08,@PC00001                                        0471 01159000
         ST    @08,@AL00001                                        0471 01160000
         LA    @03,@CF00115                                        0471 01161000
         ST    @03,@AL00001+4                                      0471 01162000
         LA    @03,DDSTRU                                          0471 01163000
         ST    @03,@AL00001+8                                      0471 01164000
         MVI   @AL00001+8,X'80'                                    0471 01165000
         L     @15,GDTPRT(,@08)                                    0471 01166000
         LA    @01,@AL00001                                        0471 01167000
         BALR  @14,@15                                             0471 01168000
*                OPAGLST3 = OPAGLST2;                      /*@OZ00751*/ 01169000
         MVC   OPAGLST3(48),OPAGLST2                               0472 01170000
*                OPNPTR = ADDR(OPAGLST3);                  /*@OZ00751*/ 01171000
         LA    OPNPTR,OPAGLST3                                     0473 01172000
*                OPNOPTOT = OFF;                           /*@OZ00751*/ 01173000
*                OPNOPTUP = ON;                            /*@OZ00751*/ 01174000
         OI    OPNOPTUP(OPNPTR),B'00100000'                        0475 01175000
         NI    OPNOPTOT(OPNPTR),B'10111111'                        0475 01176000
*                OPNIOC = ADDR(IOCSOUP);                   /*@OZ00751*/ 01177000
*                                                                  0476 01178000
         LA    @08,IOCSOUP                                         0476 01179000
         ST    @08,OPNIOC(,OPNPTR)                                 0476 01180000
*                CALL IDCIOOP0 (GDTTBL,OPAGLST3);          /*@OZ00751*/ 01181000
*                                                                  0477 01182000
         L     @08,@PC00001                                        0477 01183000
         ST    @08,@AL00001                                        0477 01184000
         LA    @15,OPAGLST3                                        0477 01185000
         ST    @15,@AL00001+4                                      0477 01186000
         MVI   @AL00001+4,X'80'                                    0477 01187000
         L     @15,GDTOPN(,@08)                                    0477 01188000
         LA    @01,@AL00001                                        0477 01189000
         BALR  @14,@15                                             0477 01190000
*                RESPECIFY RTNREG RSTD;                            0478 01191000
*                TESTRC = RTNREG;                                  0479 01192000
         STH   RTNREG,TESTRC                                       0479 01193000
*                RESPECIFY RTNREG UNRSTD;                  /*@OZ00751*/ 01194000
*                                                                  0480 01195000
*                IF TESTRC ^= 0                                    0481 01196000
*                  THEN                                            0481 01197000
         LH    @08,TESTRC                                          0481 01198000
         LTR   @08,@08                                             0481 01199000
         BZ    @RF00481                                            0481 01200000
*                    STATFLG = TERMERR;                    /*@OZ00751*/ 01201000
*                                                                  0482 01202000
         MVC   STATFLG(5),@CB00819                                 0482 01203000
*                  ELSE                                            0483 01204000
*                    CALL CATRELOD;                        /*@OZ00751*/ 01205000
*                                                                  0483 01206000
         B     @RC00481                                            0483 01207000
@RF00481 BAL   @14,CATRELOD                                        0483 01208000
*                END;                                      /*@OZ00751*/ 01209000
*                                                                  0484 01210000
@RC00481 DS    0H                                                  0485 01211000
*            /********************************************************/ 01212000
*            /*                                                      */ 01213000
*            /*IF BOTH OBJECTS ARE CATALOGS AND NO DELIMETERS@OZ00751*/ 01214000
*            /*HAVE BEEN SPECIFIED THEN SET THE APPROPRIATE  @OZ00751*/ 01215000
*            /* IOCS FLAGS                                   @OZ00751*/ 01216000
*            /*                                                      */ 01217000
*            /********************************************************/ 01218000
*                                                                  0485 01219000
*            IF CATCOPSW = ON  &                                   0485 01220000
*                 ( (ADDR(FMKYC)) ^= NULLPTR  |                    0485 01221000
*                   (ADDR(FMRBA)) ^= NULLPTR  |                    0485 01222000
*                   (ADDR(SKIP))  ^= NULLPTR  |                    0485 01223000
*                   (ADDR(TOKYC)) ^= NULLPTR  |                    0485 01224000
*                   (ADDR(TORBA)) ^= NULLPTR  |                    0485 01225000
*                   (ADDR(COUNT)) ^= NULLPTR  )                    0485 01226000
*              THEN                                                0485 01227000
@RF00466 TM    CATCOPSW,B'10000000'                                0485 01228000
         BNO   @RF00485                                            0485 01229000
         SLR   @08,@08                                             0485 01230000
         L     @15,@PC00001+4                                      0485 01231000
         C     @08,FDTPTR+8(,@15)                                  0485 01232000
         BNE   @RT00485                                            0485 01233000
         C     @08,FDTPTR+12(,@15)                                 0485 01234000
         BNE   @RT00485                                            0485 01235000
         C     @08,FDTPTR+16(,@15)                                 0485 01236000
         BNE   @RT00485                                            0485 01237000
         C     @08,FDTPTR+20(,@15)                                 0485 01238000
         BNE   @RT00485                                            0485 01239000
         C     @08,FDTPTR+24(,@15)                                 0485 01240000
         BNE   @RT00485                                            0485 01241000
         C     @08,FDTPTR+28(,@15)                                 0485 01242000
         BE    @RF00485                                            0485 01243000
@RT00485 DS    0H                                                  0486 01244000
*                STATFLG = CATDLMER;                       /*@OZ00751*/ 01245000
         MVC   STATFLG(5),@CB00828                                 0486 01246000
*              ELSE                                                0487 01247000
*                IF CATCOPSW = ON                                  0487 01248000
*                  THEN                                            0487 01249000
         B     @RC00485                                            0487 01250000
@RF00485 TM    CATCOPSW,B'10000000'                                0487 01251000
         BNO   @RF00487                                            0487 01252000
*                    DO;                                   /*@OZ00751*/ 01253000
*                                                                  0488 01254000
*                    CALL RECOVCAT; /* GO CHECK FOR RECOVERABLE ATTR */ 01255000
         BAL   @14,RECOVCAT                                        0489 01256000
*                                                          /*@Y30SSEC*/ 01257000
*                    IF STATFLG = NORMAL THEN                      0490 01258000
         CLC   STATFLG(5),@CB00816                                 0490 01259000
         BNE   @RF00490                                            0490 01260000
*                      DO;                                 /*@Y30SSEC*/ 01261000
*                        IOCSINP -> IOCMACCC = ON;         /*@Y30SSEC*/ 01262000
         L     @08,IOCSINP                                         0492 01263000
         OI    IOCMACCC(@08),B'00000010'                           0492 01264000
*                        IOCSOUT -> IOCMACCC = ON;         /*@Y30SSEC*/ 01265000
         L     @08,IOCSOUT                                         0493 01266000
         OI    IOCMACCC(@08),B'00000010'                           0493 01267000
*                      END;                                /*@Y30SSEC*/ 01268000
*                                                                  0494 01269000
*                    END;                                  /*@OZ00751*/ 01270000
*                                                                  0495 01271000
@RF00490 DS    0H                                                  0496 01272000
*            END CATCPYCK;                                 /*@OZ00751*/ 01273000
*                                                                  0496 01274000
@RF00487 DS    0H                                                  0496 01275000
@RC00485 DS    0H                                                  0497 01276000
*        /************************************************************/ 01277000
*        /*                                                          */ 01278000
*        /* INVOKE THE DATA SET DELIMITER(DELIMSET) -                */ 01279000
*        /* POSITIONS TO THE BEGINNING OF INPUT DATA SET SUBSET      */ 01280000
*        /* AND/OR REFERENCES THE ENDING DELIMITERS:                 */ 01281000
*        /* . DELIMFLG - SET BY DELIMSET IF AN ENDING KEY OR RBA     */ 01282000
*        /*   DELIMITER EXISTS.                                      */ 01283000
*        /* . LOOPCNT  - SET BY DELIMSET IF A COUNT OF RECORDS IS TO */ 01284000
*        /*   BE PROCESSED.                                          */ 01285000
*        /* . LOOPINCR - WHEN COUNT PROCESSING EXISTS, DELIMSET SETS */ 01286000
*        /*   THIS VALUE TO 1, OTHERWISE IT IS ALWAYS 0.             */ 01287000
*        /*                                                          */ 01288000
*        /************************************************************/ 01289000
*                                                                  0497 01290000
*        IF STATFLG = NORMAL & CATRELSW ^= ON              /*@OZ00751*/ 01291000
*          THEN                                                    0497 01292000
@RF00397 CLC   STATFLG(5),@CB00816                                 0497 01293000
         BNE   @RF00497                                            0497 01294000
         TM    CATRELSW,B'10000000'                                0497 01295000
         BO    @RF00497                                            0497 01296000
*            DO;                                                   0498 01297000
*                                                                  0498 01298000
*            IOCSPTR = IOCSINP;                                    0499 01299000
         MVC   IOCSPTR(4),IOCSINP                                  0499 01300000
*            CALL DELIMSET (DELIMFLG,LOOPCNT,LOOPINCR);            0500 01301000
*                                                                  0500 01302000
         LA    @08,DELIMFLG                                        0500 01303000
         ST    @08,@AL00001                                        0500 01304000
         LA    @08,LOOPCNT                                         0500 01305000
         ST    @08,@AL00001+4                                      0500 01306000
         LA    @08,LOOPINCR                                        0500 01307000
         ST    @08,@AL00001+8                                      0500 01308000
         LA    @01,@AL00001                                        0500 01309000
         BAL   @14,DELIMSET                                        0500 01310000
*            END;                                                  0501 01311000
*                                                                  0501 01312000
*                                                                  0501 01313000
*        /************************************************************/ 01314000
*        /*                                                          */ 01315000
*        /* COPY PROCESSING IS BY A UGET/UPUT LOOP WHEN AN ENDING    */ 01316000
*        /* SUBSET DELIMITER IS SPECIFIED -                          */ 01317000
*        /*  DELIMFLG OR LOOPINCR INDICATE THE EXISTANCE OF AN ENDING*/ 01318000
*        /*  DELIMITER, THESE VALUES ARE SET BY 'DELIMSET'.          */ 01319000
*        /* WHEN THERE IS NO ENDING DELIMITER THE UCOPY MACRO IS     */ 01320000
*        /* INVOKED ONCE TO PERFORM THE ENTIRE COPY OPERATION        */ 01321000
*        /*                                                          */ 01322000
*        /************************************************************/ 01323000
*                                                                  0502 01324000
*        IF STATFLG = NORMAL & CATRELSW ^= ON              /*@OZ00751*/ 01325000
*          THEN                                                    0502 01326000
@RF00497 CLC   STATFLG(5),@CB00816                                 0502 01327000
         BNE   @RF00502                                            0502 01328000
         TM    CATRELSW,B'10000000'                                0502 01329000
         BO    @RF00502                                            0502 01330000
* CPYLOOPA:  DO;                                                   0503 01331000
*                                                                  0503 01332000
CPYLOOPA DS    0H                                                  0504 01333000
*            OLDERID2 = NEWERID2;                                  0504 01334000
         L     @08,@PC00001                                        0504 01335000
         L     @08,GDTTR2(,@08)                                    0504 01336000
         MVC   @TS00001(95),NEWERID2(@08)                          0504 01337000
         MVC   OLDERID2(95,@08),@TS00001                           0504 01338000
*            NEWID2 = 'RP13';                              /*@Y30SSLO*/ 01339000
         MVC   NEWID2(4,@08),@CC01144                              0505 01340000
*            CYCLEFLG = GO;                                        0506 01341000
*                                                                  0506 01342000
         MVI   CYCLEFLG,X'00'                                      0506 01343000
*            /********************************************************/ 01344000
*            /*                                                      */ 01345000
*            /* INITIALIZE KEY LENGTH USED IN DETERMINING ENDING SUB-*/ 01346000
*            /* SET BOUNDARY. THE LENGTH MUST BE THE MINIMUM OF THE  */ 01347000
*            /* VALUES SPECIFIED BY THE USER VERSUS THAT SPECIFIED   */ 01348000
*            /* IN THE IOCS                                          */ 01349000
*            /*                                                      */ 01350000
*            /********************************************************/ 01351000
*                                                                  0507 01352000
*            IF DELIMFLG = TOKYPOST                                0507 01353000
*              THEN                                                0507 01354000
         CLI   DELIMFLG,X'02'                                      0507 01355000
         BNE   @RF00507                                            0507 01356000
*                DO;                                               0508 01357000
*                                                                  0508 01358000
*                IOCSPTR = IOCSINP;                                0509 01359000
         L     @08,IOCSINP                                         0509 01360000
         ST    @08,IOCSPTR                                         0509 01361000
*                ENDKYLN = MIN(TOKYCLEN,IOCKYL);                   0510 01362000
*                                                                  0510 01363000
         L     @15,@PC00001+4                                      0510 01364000
         L     @01,FDTPTR+20(,@15)                                 0510 01365000
         SLR   @00,@00                                             0510 01366000
         IC    @00,TOKYCLEN(,@01)                                  0510 01367000
         SLR   @01,@01                                             0510 01368000
         IC    @01,IOCKYL(,@08)                                    0510 01369000
         CR    @00,@01                                             0510 01370000
         BNH   *+6                                                      01371000
         LR    @00,@01                                             0510 01372000
         ST    @00,ENDKYLN                                         0510 01373000
*                END;                                              0511 01374000
*                                                                  0511 01375000
*            /********************************************************/ 01376000
*            /*                                              @Y30SSJH*/ 01377000
*            /* IF THE DATA SET IS RELATIVE RECORD ,INITIALIZE       */ 01378000
*            /* OLDREL TO POINT TO THE SLOT PRIOR TO WHERE   @Y30SSJH*/ 01379000
*            /* COPYING IS TO START.                         @Y30SSJH*/ 01380000
*            /*                                              @Y30SSJH*/ 01381000
*            /********************************************************/ 01382000
*                                                                  0512 01383000
*            IF ( IOCSINP -> IOCMACRR = ON &                       0512 01384000
*                 ADDR(COUNT) ^= NULLPTR )                         0512 01385000
*              THEN                                                0512 01386000
@RF00507 L     @08,IOCSINP                                         0512 01387000
         TM    IOCMACRR(@08),B'00100000'                           0512 01388000
         BNO   @RF00512                                            0512 01389000
         SLR   @08,@08                                             0512 01390000
         L     @15,@PC00001+4                                      0512 01391000
         C     @08,FDTPTR+28(,@15)                                 0512 01392000
         BE    @RF00512                                            0512 01393000
*                DO;                                       /*@Y30SSJH*/ 01394000
*                                                                  0513 01395000
*                IF ADDR(SKIP) ^= NULLPTR                          0514 01396000
*                  THEN                                            0514 01397000
         L     @15,FDTPTR+16(,@15)                                 0514 01398000
         CR    @15,@08                                             0514 01399000
         BE    @RF00514                                            0514 01400000
*                    OLDREL = SKIPVAL;                     /*@Y30SSJH*/ 01401000
         MVC   OLDREL(4),SKIPVAL(@15)                              0515 01402000
*                  ELSE                                            0516 01403000
*                    IF ADDR(FMNUM) ^= NULLPTR                     0516 01404000
*                      THEN                                        0516 01405000
         B     @RC00514                                            0516 01406000
@RF00514 L     @08,@PC00001+4                                      0516 01407000
         L     @08,FDTPTR+48(,@08)                                 0516 01408000
         LTR   @08,@08                                             0516 01409000
         BZ    @RF00516                                            0516 01410000
*                        OLDREL = FMNUMVAL - 1;            /*@Y30SSJH*/ 01411000
         L     @08,FMNUMVAL(,@08)                                  0517 01412000
         BCTR  @08,0                                               0517 01413000
         ST    @08,OLDREL                                          0517 01414000
*                      ELSE                                        0518 01415000
*                        OLDREL = 0;                       /*@Y30SSJH*/ 01416000
*                                                                  0518 01417000
         B     @RC00516                                            0518 01418000
@RF00516 SLR   @08,@08                                             0518 01419000
         ST    @08,OLDREL                                          0518 01420000
*                END;                                      /*@Y30SSJH*/ 01421000
*                                                                  0519 01422000
@RC00516 DS    0H                                                  0519 01423000
@RC00514 DS    0H                                                  0520 01424000
*            /********************************************************/ 01425000
*            /*                                                      */ 01426000
*            /* WHEN ENDING DELIMITERS ARE SPECIFIED AS INDICATED BY */ 01427000
*            /* DELIMFLG OR LOOPINCR, CPYLOOPB IS USED TO GET AND    */ 01428000
*            /* PUT RECORDS INDIVIDUALLY.                            */ 01429000
*            /*                                                      */ 01430000
*            /********************************************************/ 01431000
*                                                                  0520 01432000
*            IF DELIMFLG ^= STOP  |                                0520 01433000
*               LOOPINCR ^= 0                                      0520 01434000
*              THEN                                                0520 01435000
*                                                                  0520 01436000
@RF00512 CLI   DELIMFLG,X'0F'                                      0520 01437000
         BNE   @RT00520                                            0520 01438000
         LH    @08,LOOPINCR                                        0520 01439000
         LTR   @08,@08                                             0520 01440000
         BZ    @RF00520                                            0520 01441000
@RT00520 DS    0H                                                  0521 01442000
*                /****************************************************/ 01443000
*                /*                                                  */ 01444000
*                /* UGET/UPUT LOOP IF ENDING DELIMITER HAS BEEN      */ 01445000
*                /* SPECIFIED                                        */ 01446000
*                /*                                                  */ 01447000
*                /****************************************************/ 01448000
*                                                                  0521 01449000
*CPYLOOPB:       DO N = 1 TO LOOPCNT BY LOOPINCR                   0521 01450000
*                  WHILE CYCLEFLG = GO;                            0521 01451000
*                                                                  0521 01452000
CPYLOOPB LA    N,1                                                 0521 01453000
         B     @DE00521                                            0521 01454000
@DL00521 CLI   CYCLEFLG,X'00'                                      0521 01455000
         BNE   @DC00521                                            0521 01456000
*                /****************************************************/ 01457000
*                /*                                                  */ 01458000
*                /* RETRIEVE THE INPUT RECORD                        */ 01459000
*                /*                                                  */ 01460000
*                /****************************************************/ 01461000
*                                                                  0522 01462000
*                IOCSPTR = IOCSINP;                                0522 01463000
         MVC   IOCSPTR(4),IOCSINP                                  0522 01464000
*                CALL IDCIOGT0 (GDTTBL,IOCSPTR);                   0523 01465000
         L     @08,@PC00001                                        0523 01466000
         ST    @08,@AL00001                                        0523 01467000
         LA    @04,IOCSPTR                                         0523 01468000
         ST    @04,@AL00001+4                                      0523 01469000
         MVI   @AL00001+4,X'80'                                    0523 01470000
         L     @15,GDTGET(,@08)                                    0523 01471000
         LA    @01,@AL00001                                        0523 01472000
         BALR  @14,@15                                             0523 01473000
*                RESPECIFY RTNREG RSTD;                            0524 01474000
*                TESTRC = RTNREG;                                  0525 01475000
         STH   RTNREG,TESTRC                                       0525 01476000
*                RESPECIFY RTNREG UNRSTD;                          0526 01477000
*                CPRECID = '01'X;                                  0527 01478000
*                                                                  0527 01479000
         MVI   CPRECID,X'01'                                       0527 01480000
*                IF TESTRC = 0                                     0528 01481000
*                  THEN                                            0528 01482000
         LH    @08,TESTRC                                          0528 01483000
         LTR   @08,@08                                             0528 01484000
         BNZ   @RF00528                                            0528 01485000
* CPYLOOPC:          DO;                                           0529 01486000
*                                                                  0529 01487000
*                                                                  0529 01488000
CPYLOOPC DS    0H                                                  0530 01489000
*                    /************************************************/ 01490000
*                    /*                                              */ 01491000
*                    /* HAVE WE EXCEEDED THE RBA DELIMITER           */ 01492000
*                    /*                                              */ 01493000
*                    /************************************************/ 01494000
*                                                                  0530 01495000
*                    IF DELIMFLG = TORBAPOS                        0530 01496000
*                      THEN                                        0530 01497000
         CLI   DELIMFLG,X'03'                                      0530 01498000
         BNE   @RF00530                                            0530 01499000
*                        IF IOCRBA > TORBAVAL                      0531 01500000
*                          THEN                                    0531 01501000
         L     @08,@PC00001+4                                      0531 01502000
         L     @08,FDTPTR+24(,@08)                                 0531 01503000
         L     @04,IOCSPTR                                         0531 01504000
         L     @04,IOCRBA(,@04)                                    0531 01505000
         C     @04,TORBAVAL(,@08)                                  0531 01506000
         BNH   @RF00531                                            0531 01507000
*                            CYCLEFLG = STOP;                      0532 01508000
*                                                                  0532 01509000
         MVI   CYCLEFLG,X'0F'                                      0532 01510000
*                          ELSE;                                   0533 01511000
*                                                                  0533 01512000
*                                                                  0533 01513000
@RF00531 DS    0H                                                  0534 01514000
*                      ELSE                                        0534 01515000
*                  /**************************************************/ 01516000
*                  /*                                                */ 01517000
*                  /* HAVE WE EXCEEDED THE KEY DELIMITER             */ 01518000
*                  /*                                                */ 01519000
*                  /**************************************************/ 01520000
*                                                                  0534 01521000
*                  IF DELIMFLG = TOKYPOST                          0534 01522000
*                    THEN                                          0534 01523000
         B     @RC00530                                            0534 01524000
@RF00530 CLI   DELIMFLG,X'02'                                      0534 01525000
         BNE   @RF00534                                            0534 01526000
*                      DO;                                         0535 01527000
*                                                                  0535 01528000
*                      IF TOKYCVAL < RECDKEY(1:ENDKYLN)            0536 01529000
*                        THEN                                      0536 01530000
         L     @08,@PC00001+4                                      0536 01531000
         L     @08,FDTPTR+20(,@08)                                 0536 01532000
         L     @04,IOCSPTR                                         0536 01533000
         L     @04,IOCKYA(,@04)                                    0536 01534000
         L     @15,ENDKYLN                                         0536 01535000
         BCTR  @15,0                                               0536 01536000
         EX    @15,@SC01302                                        0536 01537000
         BNL   @RF00536                                            0536 01538000
*                          CYCLEFLG = STOP;                        0537 01539000
*                                                                  0537 01540000
         MVI   CYCLEFLG,X'0F'                                      0537 01541000
*                      END;                                        0538 01542000
*                                                                  0538 01543000
*                          /******************************************/ 01544000
*                          /*                                @Y30SSJH*/ 01545000
*                          /* HAVE WE EXCEEDED THE RECORD    @Y30SSJH*/ 01546000
*                          /* NUMBER DELIMITER               @Y30SSJH*/ 01547000
*                          /*                                @Y30SSJH*/ 01548000
*                          /******************************************/ 01549000
*                                                                  0539 01550000
*                          ELSE                                    0539 01551000
*                            IF DELIMFLG = TORRNPOS                0539 01552000
*                              THEN                                0539 01553000
         B     @RC00534                                            0539 01554000
@RF00534 CLI   DELIMFLG,X'04'                                      0539 01555000
         BNE   @RF00539                                            0539 01556000
*                                DO;                       /*@Y30SSJH*/ 01557000
*                                                                  0540 01558000
*                                IF IOCREL > TONUMVAL              0541 01559000
*                                  THEN                            0541 01560000
         L     @08,@PC00001+4                                      0541 01561000
         L     @08,FDTPTR+52(,@08)                                 0541 01562000
         L     @04,IOCSPTR                                         0541 01563000
         L     @04,IOCREL(,@04)                                    0541 01564000
         C     @04,TONUMVAL(,@08)                                  0541 01565000
         BNH   @RF00541                                            0541 01566000
*                                    CYCLEFLG = STOP;      /*@Y30SSJH*/ 01567000
*                                                                  0542 01568000
         MVI   CYCLEFLG,X'0F'                                      0542 01569000
*                                END;                      /*@Y30SSJH*/ 01570000
*                                                                  0543 01571000
*                              /**************************************/ 01572000
*                              /*                            @Y30SSJH*/ 01573000
*                              /* IF COUNT SPECIFIED WITH RELA-      */ 01574000
*                              /* TIVE RECORD DATA SET, COPYING      */ 01575000
*                              /* STOPS WHEN THE NUMBER OF   @Y30SSJH*/ 01576000
*                              /* VALID RECORD SLOTS COPIED  @Y30SSJH*/ 01577000
*                              /* PLUS THE NUMBER OF INVALID @Y30SSJH*/ 01578000
*                              /* SLOTS BYPASSED EXCEEDS COUNTVAL.   */ 01579000
*                              /*                            @Y30SSJH*/ 01580000
*                              /**************************************/ 01581000
*                                                                  0544 01582000
*                              ELSE                        /*@Y30SSJH*/ 01583000
*                                IF IOCMACRR = ON   &              0544 01584000
*                                   ADDR(COUNT) ^= NULLPTR         0544 01585000
*                                  THEN                            0544 01586000
         B     @RC00539                                            0544 01587000
@RF00539 L     @08,IOCSPTR                                         0544 01588000
         TM    IOCMACRR(@08),B'00100000'                           0544 01589000
         BNO   @RF00544                                            0544 01590000
         L     @04,@PC00001+4                                      0544 01591000
         L     @04,FDTPTR+28(,@04)                                 0544 01592000
         LTR   @04,@04                                             0544 01593000
         BZ    @RF00544                                            0544 01594000
*                                    DO;                   /*@Y30SSJH*/ 01595000
*                                                                  0545 01596000
*                                    N = N + IOCREL - OLDREL - 1;  0546 01597000
         L     @08,IOCREL(,@08)                                    0546 01598000
         LR    @04,N                                               0546 01599000
         ALR   @04,@08                                             0546 01600000
         SL    @04,OLDREL                                          0546 01601000
         BCTR  @04,0                                               0546 01602000
         LR    N,@04                                               0546 01603000
*                                    OLDREL = IOCREL;      /*@Y30SSJH*/ 01604000
         ST    @08,OLDREL                                          0547 01605000
*                                    IF N > LOOPCNT                0548 01606000
*                                      THEN                        0548 01607000
         C     N,LOOPCNT                                           0548 01608000
         BNH   @RF00548                                            0548 01609000
*                                        CYCLEFLG = STOP;  /*@Y30SSJH*/ 01610000
*                                                                  0549 01611000
         MVI   CYCLEFLG,X'0F'                                      0549 01612000
*                                    END;                  /*@Y30SSJH*/ 01613000
*                                                                  0550 01614000
@RF00548 DS    0H                                                  0551 01615000
*                    /************************************************/ 01616000
*                    /*                                              */ 01617000
*                    /* ENDING DELIMITERS HAVE NOT BEEN EXCEEDED -   */ 01618000
*                    /* WRITE RECORD TO OUTPUT DATA SET              */ 01619000
*                    /*                                              */ 01620000
*                    /************************************************/ 01621000
*                                                                  0551 01622000
*                    IF CYCLEFLG = GO                              0551 01623000
*                      THEN                                        0551 01624000
@RF00544 DS    0H                                                  0551 01625000
@RC00539 DS    0H                                                  0551 01626000
@RC00534 DS    0H                                                  0551 01627000
@RC00530 CLI   CYCLEFLG,X'00'                                      0551 01628000
         BNE   @RF00551                                            0551 01629000
*                        DO;                                       0552 01630000
*                                                                  0552 01631000
*                        /********************************************/ 01632000
*                        /*                                  @Y30SSJH*/ 01633000
*                        /* WHEN COPYING FROM ONE RELATIVE   @Y30SSJH*/ 01634000
*                        /* RECORD DATA SET TO A ANOTHER     @Y30SSJH*/ 01635000
*                        /* RECORD NUMBERS ARE CONSTANT.     @Y30SSJH*/ 01636000
*                        /*                                  @Y30SSJH*/ 01637000
*                        /********************************************/ 01638000
*                                                                  0553 01639000
*                        IF IOCMACRR = ON  &                       0553 01640000
*                           IOCSOUT -> IOCMACRR = ON               0553 01641000
*                          THEN                                    0553 01642000
         L     @08,IOCSPTR                                         0553 01643000
         TM    IOCMACRR(@08),B'00100000'                           0553 01644000
         BNO   @RF00553                                            0553 01645000
         L     @04,IOCSOUT                                         0553 01646000
         TM    IOCMACRR(@04),B'00100000'                           0553 01647000
         BNO   @RF00553                                            0553 01648000
*                            IOCSOUT -> IOCREL = IOCREL;   /*@Y30SSJH*/ 01649000
         MVC   IOCREL(4,@04),IOCREL(@08)                           0554 01650000
*                          ELSE                            /*@Y30SSEC*/ 01651000
*                          /*********************************@Y30SSEC*/ 01652000
*                          /*                                        */ 01653000
*                          /* IF ONLY THE OUTPUT IS RRDS,            */ 01654000
*                          /* RECORD NUMBERS ARE 1,2,...., ETC.      */ 01655000
*                          /*                                        */ 01656000
*                          /*********************************@Y30SSEC*/ 01657000
*                          IF IOCSOUT -> IOCMACRR = ON     /*@Y30SSEC*/ 01658000
*                            THEN                                  0555 01659000
         B     @RC00553                                            0555 01660000
@RF00553 L     @08,IOCSOUT                                         0555 01661000
         TM    IOCMACRR(@08),B'00100000'                           0555 01662000
         BNO   @RF00555                                            0555 01663000
*                              IOCSOUT -> IOCREL = IOCSOUT -> IOCREL+1; 01664000
         LA    @04,1                                               0556 01665000
         AL    @04,IOCREL(,@08)                                    0556 01666000
         ST    @04,IOCREL(,@08)                                    0556 01667000
*                                                          /*@Y30SSEC*/ 01668000
*                                                                  0557 01669000
*                        IOCSOUT -> IOCDAD = IOCDAD;               0557 01670000
@RF00555 DS    0H                                                  0557 01671000
@RC00553 L     @08,IOCSOUT                                         0557 01672000
         L     @04,IOCSPTR                                         0557 01673000
         MVC   IOCDAD(4,@08),IOCDAD(@04)                           0557 01674000
*                        IOCSOUT -> IOCDLN = IOCDLN;               0558 01675000
         MVC   IOCDLN(4,@08),IOCDLN(@04)                           0558 01676000
*                        IOCSPTR = IOCSOUT;                        0559 01677000
*                                                                  0559 01678000
         ST    @08,IOCSPTR                                         0559 01679000
*                        CALL IDCIOPT0 (GDTTBL,IOCSPTR,CPRECID);   0560 01680000
         L     @08,@PC00001                                        0560 01681000
         ST    @08,@AL00001                                        0560 01682000
         LA    @04,IOCSPTR                                         0560 01683000
         ST    @04,@AL00001+4                                      0560 01684000
         LA    @04,CPRECID                                         0560 01685000
         ST    @04,@AL00001+8                                      0560 01686000
         MVI   @AL00001+8,X'80'                                    0560 01687000
         L     @15,GDTPUT(,@08)                                    0560 01688000
         LA    @01,@AL00001                                        0560 01689000
         BALR  @14,@15                                             0560 01690000
*                        RESPECIFY RTNREG RSTD;                    0561 01691000
*                        TESTRC = RTNREG;                          0562 01692000
         STH   RTNREG,TESTRC                                       0562 01693000
*                        RESPECIFY RTNREG UNRSTD;                  0563 01694000
*                        CPRECID = '02'X;                          0564 01695000
*                                                                  0564 01696000
         MVI   CPRECID,X'02'                                       0564 01697000
*                        END;                                      0565 01698000
*                                                                  0565 01699000
*                    END CPYLOOPC;                                 0566 01700000
*                                                                  0566 01701000
@RF00551 DS    0H                                                  0567 01702000
*                  /**************************************************/ 01703000
*                  /*                                                */ 01704000
*                  /* CHECK FOR NON-RCOK RETURN CODES FROM UGET/UPUT */ 01705000
*                  /* RCEODAD AND RCFAIL ARE THE TWO POSSIBLE CODES  */ 01706000
*                  /*                                                */ 01707000
*                  /**************************************************/ 01708000
*                                                                  0567 01709000
*                  IF TESTRC ^= 0                                  0567 01710000
*                    THEN                                          0567 01711000
@RF00528 LH    @08,TESTRC                                          0567 01712000
         LTR   @08,@08                                             0567 01713000
         BZ    @RF00567                                            0567 01714000
*CHCKLOOP:             DO;                                         0568 01715000
*                                                                  0568 01716000
CHCKLOOP DS    0H                                                  0569 01717000
*                      /**********************************************/ 01718000
*                      /*                                            */ 01719000
*                      /* NORMAL END OF DATA ON RECORD RETRIEVAL     */ 01720000
*                      /*                                            */ 01721000
*                      /**********************************************/ 01722000
*                      IF TESTRC = 16  &                           0569 01723000
*                         CPRECID = '01'X                          0569 01724000
*                        THEN                                      0569 01725000
         CLC   TESTRC(2),@CH00476                                  0569 01726000
         BNE   @RF00569                                            0569 01727000
         CLI   CPRECID,X'01'                                       0569 01728000
         BNE   @RF00569                                            0569 01729000
*                          DO;                                     0570 01730000
*                                                                  0570 01731000
*                          CYCLEFLG = STOP;                        0571 01732000
*                                                                  0571 01733000
         MVI   CYCLEFLG,X'0F'                                      0571 01734000
*                        /********************************************/ 01735000
*                        /*                                          */ 01736000
*                        /* VERIFY THAT ENDING DELIMITER WAS NOT     */ 01737000
*                        /* BEYOND END OF FILE - IF IT WAS SET       */ 01738000
*                        /* LASTCC = 4                               */ 01739000
*                        /*                                          */ 01740000
*                        /********************************************/ 01741000
*                        IF DELIMFLG = TOKYPOST  &                 0572 01742000
*                           TOKYCVAL > RECDKEY(1:ENDKYLN)          0572 01743000
*                          THEN                                    0572 01744000
         CLI   DELIMFLG,X'02'                                      0572 01745000
         BNE   @RF00572                                            0572 01746000
         L     @08,@PC00001+4                                      0572 01747000
         L     @08,FDTPTR+20(,@08)                                 0572 01748000
         L     @04,IOCSPTR                                         0572 01749000
         L     @04,IOCKYA(,@04)                                    0572 01750000
         L     @15,ENDKYLN                                         0572 01751000
         BCTR  @15,0                                               0572 01752000
         EX    @15,@SC01302                                        0572 01753000
         BNH   @RF00572                                            0572 01754000
*                            STATFLG = ABNCONDT;                   0573 01755000
*                                                                  0573 01756000
         MVC   STATFLG(5),@CB00813                                 0573 01757000
*                        IF DELIMFLG = TORBAPOS  &                 0574 01758000
*                           TORBAVAL > IOCRBA                      0574 01759000
*                          THEN                                    0574 01760000
@RF00572 CLI   DELIMFLG,X'03'                                      0574 01761000
         BNE   @RF00574                                            0574 01762000
         L     @08,@PC00001+4                                      0574 01763000
         L     @08,FDTPTR+24(,@08)                                 0574 01764000
         L     @08,TORBAVAL(,@08)                                  0574 01765000
         L     @04,IOCSPTR                                         0574 01766000
         C     @08,IOCRBA(,@04)                                    0574 01767000
         BNH   @RF00574                                            0574 01768000
*                            STATFLG = ABNCONDT;                   0575 01769000
*                                                                  0575 01770000
         MVC   STATFLG(5),@CB00813                                 0575 01771000
*                        IF DELIMFLG = TORRNPOS  &                 0576 01772000
*                           TONUMVAL > IOCREL                      0576 01773000
*                          THEN                                    0576 01774000
@RF00574 CLI   DELIMFLG,X'04'                                      0576 01775000
         BNE   @RF00576                                            0576 01776000
         L     @08,@PC00001+4                                      0576 01777000
         L     @08,FDTPTR+52(,@08)                                 0576 01778000
         L     @08,TONUMVAL(,@08)                                  0576 01779000
         L     @04,IOCSPTR                                         0576 01780000
         C     @08,IOCREL(,@04)                                    0576 01781000
         BNH   @RF00576                                            0576 01782000
*                            STATFLG = ABNCONDT;           /*@Y30SSJH*/ 01783000
*                                                                  0577 01784000
         MVC   STATFLG(5),@CB00813                                 0577 01785000
*                        IF LOOPINCR ^= 0                          0578 01786000
*                          THEN                                    0578 01787000
@RF00576 LH    @08,LOOPINCR                                        0578 01788000
         LTR   @08,@08                                             0578 01789000
         BZ    @RF00578                                            0578 01790000
*                            STATFLG = ABNCONDT;                   0579 01791000
*                                                                  0579 01792000
         MVC   STATFLG(5),@CB00813                                 0579 01793000
*                        END;                                      0580 01794000
*                                                                  0581 01795000
*                        /********************************************/ 01796000
*                        /*                                          */ 01797000
*                        /* TESTRC = RCFAIL, IF BOTH DATA SETS ARE   */ 01798000
*                        /* STILL OPEN FOR PROCESSING AND WE HAVE NOT*/ 01799000
*                        /* ALREADY ENCOUNTERED 3 I/O ERRORS OF THIS */ 01800000
*                        /* TYPE - PROCESSING CAN CONTINUE           */ 01801000
*                        /*                                          */ 01802000
*                        /********************************************/ 01803000
*                        ELSE                                      0581 01804000
*                          IF (TESTRC  = 4  &                      0581 01805000
*                              IOCSINP -> IOCMSGOP = ON &          0581 01806000
*                              IOCSOUT -> IOCMSGOP = ON &          0581 01807000
*                              FAILIOER  < 3    )                  0581 01808000
*                                                                  0581 01809000
*                          THEN                                    0581 01810000
         B     @RC00569                                            0581 01811000
@RF00569 CLC   TESTRC(2),@CH00042                                  0581 01812000
         BNE   @RF00581                                            0581 01813000
         L     @08,IOCSINP                                         0581 01814000
         TM    IOCMSGOP(@08),B'00100000'                           0581 01815000
         BNO   @RF00581                                            0581 01816000
         L     @08,IOCSOUT                                         0581 01817000
         TM    IOCMSGOP(@08),B'00100000'                           0581 01818000
         BNO   @RF00581                                            0581 01819000
         LH    @08,FAILIOER                                        0581 01820000
         CH    @08,@CH00162                                        0581 01821000
         BNL   @RF00581                                            0581 01822000
*                            DO;                                   0582 01823000
*                                                                  0582 01824000
*                            FAILIOER = FAILIOER + 1;              0583 01825000
         LA    @08,1(,@08)                                         0583 01826000
         STH   @08,FAILIOER                                        0583 01827000
*                            STATFLG = ABNEVENT;                   0584 01828000
*                                                                  0584 01829000
         MVC   STATFLG(5),@CB00825                                 0584 01830000
*                            END;                                  0585 01831000
*                                                                  0585 01832000
*                          ELSE                                    0586 01833000
*                            DO;                                   0586 01834000
*                                                                  0586 01835000
         B     @RC00581                                            0586 01836000
@RF00581 DS    0H                                                  0587 01837000
*                            CYCLEFLG = STOP;                      0587 01838000
         MVI   CYCLEFLG,X'0F'                                      0587 01839000
*                            STATFLG = TERMERR;                    0588 01840000
*                                                                  0588 01841000
         MVC   STATFLG(5),@CB00819                                 0588 01842000
*                            END;                                  0589 01843000
*                      END CHCKLOOP;                               0590 01844000
*                                                                  0590 01845000
@RC00581 DS    0H                                                  0590 01846000
@RC00569 DS    0H                                                  0591 01847000
*                END CPYLOOPB;                                     0591 01848000
@RF00567 AH    N,LOOPINCR                                          0591 01849000
@DE00521 C     N,LOOPCNT                                           0591 01850000
         BNH   @DL00521                                            0591 01851000
@DC00521 DS    0H                                                  0592 01852000
*              /******************************************************/ 01853000
*              /*                                                    */ 01854000
*              /* THERE IS NO ENDING DELIMITER - INVOKE UCOPY TO     */ 01855000
*              /* COPY ALL RECORDS FROM PRESENT POSITION TO END OF   */ 01856000
*              /* THE INPUT DATA SET                                 */ 01857000
*              /*                                                    */ 01858000
*              /******************************************************/ 01859000
*                                                                  0592 01860000
*              ELSE                                                0592 01861000
* CPYLOOPD:      DO;                                               0592 01862000
*                                                                  0592 01863000
         B     @RC00520                                            0592 01864000
@RF00520 DS    0H                                                  0592 01865000
CPYLOOPD DS    0H                                                  0593 01866000
*                CALL IDCIOCO0 (GDTTBL,IOCSINP,IOCSOUT);           0593 01867000
         L     @08,@PC00001                                        0593 01868000
         ST    @08,@AL00001                                        0593 01869000
         LA    @15,IOCSINP                                         0593 01870000
         ST    @15,@AL00001+4                                      0593 01871000
         LA    @15,IOCSOUT                                         0593 01872000
         ST    @15,@AL00001+8                                      0593 01873000
         MVI   @AL00001+8,X'80'                                    0593 01874000
         L     @15,GDTCPY(,@08)                                    0593 01875000
         LA    @01,@AL00001                                        0593 01876000
         BALR  @14,@15                                             0593 01877000
*                RESPECIFY RTNREG RSTD;                            0594 01878000
*                TESTRC = RTNREG;                                  0595 01879000
         STH   RTNREG,TESTRC                                       0595 01880000
*                RESPECIFY RTNREG UNRSTD;                          0596 01881000
*                                                                  0596 01882000
*                IOCSPTR = IOCSINP;                                0597 01883000
*                                                                  0597 01884000
         L     @08,IOCSINP                                         0597 01885000
         ST    @08,IOCSPTR                                         0597 01886000
*                IF TESTRC = 4                                     0598 01887000
*                  THEN                                            0598 01888000
*                                                                  0598 01889000
         LH    @15,TESTRC                                          0598 01890000
         CH    @15,@CH00042                                        0598 01891000
         BNE   @RF00598                                            0598 01892000
*                    /************************************************/ 01893000
*                    /*                                              */ 01894000
*                    /* COPY COMPLETED BUT WITH NON-TERMINAL ERRORS  */ 01895000
*                    /*                                              */ 01896000
*                    /************************************************/ 01897000
*                                                                  0599 01898000
*                    IF ( IOCSINP -> IOCMSGOP = ON  &              0599 01899000
*                         IOCSOUT -> IOCMSGOP = ON  )              0599 01900000
*                      THEN                                        0599 01901000
         TM    IOCMSGOP(@08),B'00100000'                           0599 01902000
         BNO   @RF00599                                            0599 01903000
         L     @08,IOCSOUT                                         0599 01904000
         TM    IOCMSGOP(@08),B'00100000'                           0599 01905000
         BNO   @RF00599                                            0599 01906000
*                        STATFLG = ABNEVENT;                       0600 01907000
*                                                                  0600 01908000
         MVC   STATFLG(5),@CB00825                                 0600 01909000
*                      /**********************************************/ 01910000
*                      /*                                            */ 01911000
*                      /* UCOPY TERMINATED DUE TO ERROR              */ 01912000
*                      /*                                            */ 01913000
*                      /**********************************************/ 01914000
*                                                                  0601 01915000
*                      ELSE                                        0601 01916000
*                        STATFLG = TERMERR;                        0601 01917000
*                                                                  0601 01918000
         B     @RC00599                                            0601 01919000
@RF00599 MVC   STATFLG(5),@CB00819                                 0601 01920000
*                END CPYLOOPD;                                     0602 01921000
*                                                                  0602 01922000
*                                                                  0602 01923000
@RC00599 DS    0H                                                  0602 01924000
@RF00598 DS    0H                                                  0603 01925000
*            END CPYLOOPA;                                         0603 01926000
*                                                                  0603 01927000
@RC00520 DS    0H                                                  0604 01928000
*        /************************************************************/ 01929000
*        /*                                                  @OZ20461*/ 01930000
*        /* IF INPUT DATA SET WAS OPENED WITH WARNING,       @OZ20461*/ 01931000
*        /* SET LASTCC TO 4                                  @OZ20461*/ 01932000
*        /*                                                  @OZ20461*/ 01933000
*        /************************************************************/ 01934000
*                                                                  0604 01935000
*        IF STATFLG = NORMAL & OPNWRN = ON THEN                    0604 01936000
@RF00502 CLC   STATFLG(5),@CB00816                                 0604 01937000
         BNE   @RF00604                                            0604 01938000
         TM    OPNWRN,B'10000000'                                  0604 01939000
         BNO   @RF00604                                            0604 01940000
*          STATFLG = ABNCONDT;                             /*@OZ20461*/ 01941000
         MVC   STATFLG(5),@CB00813                                 0605 01942000
*        /************************************************************/ 01943000
*        /*                                                          */ 01944000
*        /* TERMINATION PROCESSING - STATFLG GIVES COMPLETION STATUS */ 01945000
*        /*  . WRITE MESSAGE INDICATING THE NUMBER OF RECORDS COPIED */ 01946000
*        /*  . WRITE FUNCTION TERMINATION MESSAGE                    */ 01947000
*        /*  . SET TERMINATION CONDITION IN LASTCC AND RETURN        */ 01948000
*        /*  . CLOSE DATA SETS                               @Y30SSJH*/ 01949000
*        /*                                                          */ 01950000
*        /************************************************************/ 01951000
*                                                                  0606 01952000
*        OLDERID2 = NEWERID2;                                      0606 01953000
@RF00604 L     @08,@PC00001                                        0606 01954000
         L     @15,GDTTR2(,@08)                                    0606 01955000
         MVC   @TS00001(95),NEWERID2(@15)                          0606 01956000
         MVC   OLDERID2(95,@15),@TS00001                           0606 01957000
*        NEWID2 = 'RP18';                                  /*@Y30SSLO*/ 01958000
         MVC   NEWID2(4,@15),@CC01154                              0607 01959000
*        IF GDTDBG = NULLPTR                                       0608 01960000
*          THEN;                                                   0608 01961000
         L     @08,GDTDBG(,@08)                                    0608 01962000
         LTR   @08,@08                                             0608 01963000
         BZ    @RT00608                                            0608 01964000
*          ELSE                                                    0610 01965000
*            CALL IDCDB010 (GDTTBL,'RP01');                        0610 01966000
         L     @08,@PC00001                                        0610 01967000
         ST    @08,@AL00001                                        0610 01968000
         LA    @15,@CC00831                                        0610 01969000
         ST    @15,@AL00001+4                                      0610 01970000
         MVI   @AL00001+4,X'80'                                    0610 01971000
         L     @15,GDTDBG(,@08)                                    0610 01972000
         LA    @01,@AL00001                                        0610 01973000
         BALR  @14,@15                                             0610 01974000
*                                                          /*@Y30SSLO*/ 01975000
*                                                                  0611 01976000
*        /************************************************************/ 01977000
*        /*                                                          */ 01978000
*        /* ISSUE MESSAGE INDICATING NUMBER OF RECORDS COPIED        */ 01979000
*        /* . THE I/O ADAPTER MAINTAINS A COUNT OF RECORDS SUCCESS-  */ 01980000
*        /*   FULLY COPIED IN IOCRRN (SEE IOCS STRUCTURE),           */ 01981000
*        /* FOR A CATALOG RELOAD THE INPUT ONLY CONTAINS     @OZ00751*/ 01982000
*        /* THE VALID COUNT INFORMATION.                     @OZ00751*/ 01983000
*        /*  MESSAGE IS NOT PRINTED WHEN COPYING CATALOGS.   @VS05903*/ 01984000
*        /*                                                          */ 01985000
*        /************************************************************/ 01986000
*                                                                  0611 01987000
*        IF CATRELSW = ON                                          0611 01988000
*          THEN                                                    0611 01989000
@RT00608 TM    CATRELSW,B'10000000'                                0611 01990000
         BNO   @RF00611                                            0611 01991000
*            IOCSPTR = IOCSINP;                            /*@OZ00751*/ 01992000
         MVC   IOCSPTR(4),IOCSINP                                  0612 01993000
*          ELSE                                                    0613 01994000
*            IOCSPTR = IOCSOUT;                            /*@OZ00751*/ 01995000
*                                                                  0613 01996000
         B     @RC00611                                            0613 01997000
@RF00611 MVC   IOCSPTR(4),IOCSOUT                                  0613 01998000
*        IF CATCOPSW = OFF                                         0614 01999000
*          THEN                                                    0614 02000000
@RC00611 TM    CATCOPSW,B'10000000'                                0614 02001000
         BNZ   @RF00614                                            0614 02002000
*            DO;                                           /*@VS05903*/ 02003000
*                                                                  0615 02004000
*            DARGL = ''B;                                  /*@Y30SSLO*/ 02005000
         XC    DARGL(28),DARGL                                     0616 02006000
*            DARGSMOD = 'UV0';                                     0617 02007000
         L     @08,DDSTRU                                          0617 02008000
         MVC   DARGSMOD(3,@08),@CC01155                            0617 02009000
*            DARGSENT = 5;                                         0618 02010000
*                                                                  0618 02011000
         MVI   DARGSENT(@08),X'05'                                 0618 02012000
*            IF IOCSOUT ^= NULLPTR                           /*YM6244*/ 02013000
*              THEN                                          /*YM6244*/ 02014000
         L     @15,IOCSOUT                                         0619 02015000
         LTR   @15,@15                                             0619 02016000
         BZ    @RF00619                                            0619 02017000
*                DO;                                         /*YM6244*/ 02018000
*                  DARGDBP  = ADDR(IOCRRN);                  /*YM6244*/ 02019000
         L     @01,IOCSPTR                                         0621 02020000
         LA    @15,IOCRRN(,@01)                                    0621 02021000
         ST    @15,DARGDBP(,@08)                                   0621 02022000
*                  DARGILP  = LENGTH(IOCRRN);                /*YM6244*/ 02023000
         MVC   DARGILP(2,@08),@CH00042                             0622 02024000
*                END;                                        /*YM6244*/ 02025000
*              ELSE                                          /*YM6244*/ 02026000
*                DO;                                         /*YM6244*/ 02027000
         B     @RC00619                                            0624 02028000
@RF00619 DS    0H                                                  0625 02029000
*                  DARGDBP = ADDR(NULLPTR);                  /*YM6244*/ 02030000
         L     @08,DDSTRU                                          0625 02031000
         LA    @15,@CF00115                                        0625 02032000
         ST    @15,DARGDBP(,@08)                                   0625 02033000
*                  DARGILP = LENGTH(NULLPTR);                /*YM6244*/ 02034000
         MVC   DARGILP(2,@08),@CH00042                             0626 02035000
*                END;                                        /*YM6244*/ 02036000
*                                                                  0627 02037000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0628 02038000
*                                                                  0628 02039000
@RC00619 L     @08,@PC00001                                        0628 02040000
         ST    @08,@AL00001                                        0628 02041000
         LA    @15,@CF00115                                        0628 02042000
         ST    @15,@AL00001+4                                      0628 02043000
         LA    @15,DDSTRU                                          0628 02044000
         ST    @15,@AL00001+8                                      0628 02045000
         MVI   @AL00001+8,X'80'                                    0628 02046000
         L     @15,GDTPRT(,@08)                                    0628 02047000
         LA    @01,@AL00001                                        0628 02048000
         BALR  @14,@15                                             0628 02049000
*            END;                                          /*@VS05903*/ 02050000
*                                                                  0629 02051000
*        /************************************************************/ 02052000
*        /*                                                          */ 02053000
*        /* CLOSE THE TARGET AND SOURCE DATA SETS                    */ 02054000
*        /*                                                          */ 02055000
*        /************************************************************/ 02056000
*                                                                  0630 02057000
*        CALL IDCIOCL0 (GDTTBL,IOCSINP,IOCSOUT);                   0630 02058000
*                                                                  0630 02059000
@RF00614 L     @08,@PC00001                                        0630 02060000
         ST    @08,@AL00001                                        0630 02061000
         LA    @15,IOCSINP                                         0630 02062000
         ST    @15,@AL00001+4                                      0630 02063000
         LA    @15,IOCSOUT                                         0630 02064000
         ST    @15,@AL00001+8                                      0630 02065000
         MVI   @AL00001+8,X'80'                                    0630 02066000
         L     @15,GDTCLS(,@08)                                    0630 02067000
         LA    @01,@AL00001                                        0630 02068000
         BALR  @14,@15                                             0630 02069000
*        RESPECIFY RTNREG RSTD;                                    0631 02070000
*        TESTRC = RTNREG;                                          0632 02071000
         STH   RTNREG,TESTRC                                       0632 02072000
*        RESPECIFY RTNREG UNRSTD;                                  0633 02073000
*                                                                  0633 02074000
*        /************************************************************/ 02075000
*        /*                                                          */ 02076000
*        /* A CLOSE ERROR OCCURRED. THE I/O ADAPTER PRINTS MESSAGES  */ 02077000
*        /* INDICATING THIS CONDITION. THIS IS A NON-TERMINAL CONDIT-*/ 02078000
*        /* ION, INDICATE CONDITION IN STATFLAG IF A MORE SERIOUS    */ 02079000
*        /* CONDITION HAS NOT ALREADY OCCURRED.                      */ 02080000
*        /*                                                          */ 02081000
*        /************************************************************/ 02082000
*                                                                  0634 02083000
*        IF TESTRC ^= 0                                            0634 02084000
*          THEN                                                    0634 02085000
         LH    @08,TESTRC                                          0634 02086000
         LTR   @08,@08                                             0634 02087000
         BZ    @RF00634                                            0634 02088000
*            IF STATFLG ^= TERMERR  &                      /*@YA04557*/ 02089000
*               STATFLG ^= POSITERR                                0635 02090000
*              THEN                                                0635 02091000
*                                                                  0635 02092000
         CLC   STATFLG(5),@CB00819                                 0635 02093000
         BE    @RF00635                                            0635 02094000
         CLC   STATFLG(5),@CB00822                                 0635 02095000
         BE    @RF00635                                            0635 02096000
*                /****************************************************/ 02097000
*                /*                                                  */ 02098000
*                /* SET STATFLG IF A PREVIOUS TERMINAL ERROR HAS NOT */ 02099000
*                /* OCCURRED                                         */ 02100000
*                /*                                                  */ 02101000
*                /****************************************************/ 02102000
*                STATFLG = ABNEVENT;                               0636 02103000
         MVC   STATFLG(5),@CB00825                                 0636 02104000
*        /************************************************************/ 02105000
*        /*                                                          */ 02106000
*        /* ISSUE UDEALLOC TO RELEASE THE DYNAMICALLY        @Y30SSEC*/ 02107000
*        /* ALLOCATED OUTPUT DATA SET.                       @Y30SSEC*/ 02108000
*        /*                                                  @Y30SSEC*/ 02109000
*        /************************************************************/ 02110000
*                                                                  0637 02111000
*        IF (ADDR(OUTDS)) ^= NULLPTR                               0637 02112000
*           THEN                                                   0637 02113000
@RF00635 DS    0H                                                  0637 02114000
@RF00634 L     @08,@PC00001+4                                      0637 02115000
         L     @08,FDTPTR+44(,@08)                                 0637 02116000
         LTR   @08,@08                                             0637 02117000
         BZ    @RF00637                                            0637 02118000
*             CALL IDCSADL0 (GDTTBL,ALLAGL);               /*@Y30SSEC*/ 02119000
*                                                                  0638 02120000
         L     @08,@PC00001                                        0638 02121000
         ST    @08,@AL00001                                        0638 02122000
         L     @01,ALLAGLPT                                        0638 02123000
         ST    @01,@AL00001+4                                      0638 02124000
         MVI   @AL00001+4,X'80'                                    0638 02125000
         L     @15,GDTDLC(,@08)                                    0638 02126000
         LA    @01,@AL00001                                        0638 02127000
         BALR  @14,@15                                             0638 02128000
*        RESPECIFY RTNREG RSTD;                                    0639 02129000
@RF00637 DS    0H                                                  0640 02130000
*        TESTRC = RTNREG;                                          0640 02131000
         STH   RTNREG,TESTRC                                       0640 02132000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30SSEC*/ 02133000
*                                                                  0641 02134000
*        IF TESTRC ^= 0                                            0642 02135000
*          THEN                                                    0642 02136000
         LH    @08,TESTRC                                          0642 02137000
         LTR   @08,@08                                             0642 02138000
         BZ    @RF00642                                            0642 02139000
*            STATFLG = TERMERR;/* UDEALLOC ISSUES ERR MSG    @Y30SSEC*/ 02140000
         MVC   STATFLG(5),@CB00819                                 0643 02141000
*                                                                  0644 02142000
*        /************************************************************/ 02143000
*        /*                                                          */ 02144000
*        /* ISSUE TERMINATION MESSAGE                                */ 02145000
*        /*                                                          */ 02146000
*        /************************************************************/ 02147000
*                                                                  0644 02148000
*        DARGL = ''B;                                      /*@Y30SSLO*/ 02149000
@RF00642 XC    DARGL(28),DARGL                                     0644 02150000
*        DARGSENT = STATFLG2;                                      0645 02151000
         L     @08,DDSTRU                                          0645 02152000
         MVC   DARGSENT(1,@08),STATFLG2                            0645 02153000
*        DARGSMOD = STMODID;                                       0646 02154000
         MVC   DARGSMOD(3,@08),STMODID                             0646 02155000
*        LASTCC   = STATFLG1;                                      0647 02156000
         L     @15,@PC00001+8                                      0647 02157000
         SLR   @14,@14                                             0647 02158000
         IC    @14,STATFLG1                                        0647 02159000
         STH   @14,LASTCC(,@15)                                    0647 02160000
*        DARGDBP  = ADDR(LASTCC);                                  0648 02161000
         ST    @15,DARGDBP(,@08)                                   0648 02162000
*        DARGILP  = LENGTH(LASTCC);                                0649 02163000
         MVC   DARGILP(2,@08),@CH00153                             0649 02164000
*        IF GDTECT ^= 0 & LASTCC > 0                               0650 02165000
*          THEN                                                    0650 02166000
         SLR   @15,@15                                             0650 02167000
         L     @07,@PC00001                                        0650 02168000
         C     @15,GDTECT(,@07)                                    0650 02169000
         BE    @RF00650                                            0650 02170000
         CR    @14,@15                                             0650 02171000
         BNH   @RF00650                                            0650 02172000
*            DARGSENT = 15; /*ISSUE BRIEF MSG FOR TSO USER   @Y30SSEC*/ 02173000
*                                                                  0651 02174000
         MVI   DARGSENT(@08),X'0F'                                 0651 02175000
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0652 02176000
*                                                                  0652 02177000
@RF00650 L     @08,@PC00001                                        0652 02178000
         ST    @08,@AL00001                                        0652 02179000
         LA    @15,@CF00115                                        0652 02180000
         ST    @15,@AL00001+4                                      0652 02181000
         LA    @15,DDSTRU                                          0652 02182000
         ST    @15,@AL00001+8                                      0652 02183000
         MVI   @AL00001+8,X'80'                                    0652 02184000
         L     @15,GDTPRT(,@08)                                    0652 02185000
         LA    @01,@AL00001                                        0652 02186000
         BALR  @14,@15                                             0652 02187000
*        /************************************************************/ 02188000
*        /*                                                          */ 02189000
*        /*     RETURN TO INVOKER OF IDCRP01                         */ 02190000
*        /*                                                          */ 02191000
*        /************************************************************/ 02192000
*                                                                  0653 02193000
*        CALL IDCSAEP0(GDTTBL,MODID);                              0653 02194000
         L     @08,@PC00001                                        0653 02195000
         ST    @08,@AL00001                                        0653 02196000
         LA    @15,MODID                                           0653 02197000
         ST    @15,@AL00001+4                                      0653 02198000
         MVI   @AL00001+4,X'80'                                    0653 02199000
         L     @15,GDTEPL(,@08)                                    0653 02200000
         LA    @01,@AL00001                                        0653 02201000
         BALR  @14,@15                                             0653 02202000
*/********************************************************************/ 02203000
*/*                                                                  */ 02204000
*/* PROCEDURE NAME - DELIMSET                                        */ 02205000
*/*                                                                  */ 02206000
*/* FUNCTION - DELIMSET ESTABLISHES THE BOUNDARIES FOR  COPYING A    */ 02207000
*/*            SUBSET OF THE INPUT DATASET.                          */ 02208000
*/*            BEGINNING AND/OR ENDING DELIMITERS SERVE TO SUBSET    */ 02209000
*/*            THE DATA SET.  THESE DELIMITERS MAY BE IN THE FORM    */ 02210000
*/*            OF KEYS, RBA'S, RECORD NUMBERS OR A RECORD COUNT      */ 02211000
*/*                                                                  */ 02212000
*/*            BEGINNING DELIMITERS:                                 */ 02213000
*/*              FROMKEY - ISAM OR VSAM KEY AT WHICH COPYING BEGINS  */ 02214000
*/*                POSITIONING IS VIA THE IDCAMS UPOSIT MACRO.       */ 02215000
*/*              FROMADDRESS - RBA AT WHICH  COPYING IS TO BEGIN.    */ 02216000
*/*                POSITIONING IS VIA THE IDCAMS UPOSIT MACRO.       */ 02217000
*/*              FROMNUMBER - RELATIVE RECORD NUMBER AT      @Y30SSJH*/ 02218000
*/*                WHICH COPYING IS TO BEGIN.                @Y30SSJH*/ 02219000
*/*                POSITIONING VIA THE IDCAMS UPOSIT MACRO.  @Y30SSJH*/ 02220000
*/*              SKIP - NUMBER OF LOGICAL RECORDS TO BE SKIPPED      */ 02221000
*/*                BEFORE  COPYING IS BEGUN. DELIMSET EXECUTES A     */ 02222000
*/*                LOOP OF UGET REQUESTS TO EFFECT POSITIONING       */ 02223000
*/*                OR ISSUES A UPOSIT IF THE DATA SET IS     @Y30SSJH*/ 02224000
*/*                RELATIVE RECORD                           @Y30SSJH*/ 02225000
*/*                                                                  */ 02226000
*/*            ENDING DELIMITERS:                                    */ 02227000
*/*              TOKEY - KEY OF THE LAST RECORD TO BE  COPIED.       */ 02228000
*/*                POSKYVAL IS SET TO THE VALUE OF THE KEY. IDCRP01  */ 02229000
*/*                USES THIS VALUE TO CONTROL THE UGET/UPRINT LOOP.  */ 02230000
*/*              TOADDRESS - THE RBA OF THE LAST VSAM RECORD TO BE   */ 02231000
*/*                COPIED . POSRBADD IS SET TO THE THE VALUE OF THE  */ 02232000
*/*                RBA. IDCRP01 USES THIS VALUE TO CONTROL THE       */ 02233000
*/*                UGET/UPUT LOOP.                                   */ 02234000
*/*              TONUMBER - RELATIVE RECORD NUMBER OF THE    @Y30SSJH*/ 02235000
*/*                RECORD TO BE COPIED.                      @Y30SSJH*/ 02236000
*/*              COUNT - NUMBER OF LOGICAL RECORDS TO BE  COPIED.    */ 02237000
*/*                LOOPCNT IS SET TO CONTROL THE UGET/UPUT   LOOP IN */ 02238000
*/*                IDCRP01.                                          */ 02239000
*/*                                                                  */ 02240000
*/* INPUT -                                                          */ 02241000
*/*      DELIMSET REFERENCES THE FDTTBL AND USES THE IOCS TO EFFECT  */ 02242000
*/*      'UPOSIT' POSITIONING.                                       */ 02243000
*/*                                                                  */ 02244000
*/* OUTPUT -                                                         */ 02245000
*/*      DELMFLG - INDICATES KEY, RELATIVE RECORD NUMBER   /*@Y30SSJH*/ 02246000
*/*      OR RBA DELIMITER                                  /*@Y30SSJH*/ 02247000
*/*      DELMCNT - INDICATES NUMBER OF RECORDS TO BE PROCESSED       */ 02248000
*/*      DELMINCR - UGET/UPUT  LOOP INCREMENT WHEN AN EXPLICIT       */ 02249000
*/*                 NUMBER OF RECORDS ARE TO BE  COPIED              */ 02250000
*/*      STATFLG - INDICATES THE TERMINATION CONDITION OF DELIMSET   */ 02251000
*/*                                                                  */ 02252000
*/********************************************************************/ 02253000
*DELIMSET:                                                         0654 02254000
*        PROCEDURE (DELMFLG,DELMCNT,DELMINCR);                     0654 02255000
@EL00001 L     @13,4(,@13)                                         0654 02256000
@EF00001 L     @00,@SIZDATD                                        0654 02257000
         LR    @01,@12                                             0654 02258000
         FREEMAIN R,LV=(0),A=(1)                                        02259000
@ER00001 LM    @14,@12,12(@13)                                     0654 02260000
         BR    @14                                                 0654 02261000
DELIMSET STM   @14,@12,@SA00002                                    0654 02262000
         MVC   @PC00002(12),0(@01)                                 0654 02263000
*        /************************************************************/ 02264000
*        /*                                                          */ 02265000
*        /* ARGUMENTS OF INVOCATION (DEFINITIONS IN PROLOGUE)        */ 02266000
*        /*                                                          */ 02267000
*        /************************************************************/ 02268000
*                                                                  0655 02269000
*        DCL                                                       0655 02270000
*          DELMFLG   CHAR(1),                                      0655 02271000
*          DELMCNT   FIXED(31),                                    0655 02272000
*          DELMINCR  FIXED(15);                                    0655 02273000
*                                                                  0655 02274000
*        /************************************************************/ 02275000
*        /*                                                          */ 02276000
*        /* LOOP CONTROL VARIABLES TO SKIP TO BEGINNING OF SUBSET    */ 02277000
*        /*                                                          */ 02278000
*        /************************************************************/ 02279000
*                                                                  0656 02280000
*        DCL                                                       0656 02281000
*          SKIPFLAG  CHAR(1),          /* BEGINNING POSITION FLAG    */ 02282000
*          SKIPLOOP  FIXED(31);        /* # OF RECORDS TO BE SKIPPED */ 02283000
*                                                                  0656 02284000
*        /************************************************************/ 02285000
*        /*                                                  @Y30SSJH*/ 02286000
*        /* VARIABLES FOR VALIDITY ERROR MESSAGE             @Y30SSJH*/ 02287000
*        /*                                                  @Y30SSJH*/ 02288000
*        /************************************************************/ 02289000
*                                                                  0657 02290000
*        DCL                                                       0657 02291000
*          MSGARY(6)  CHAR(11)                                     0657 02292000
*            INIT('FROMKEY' , 'TOKEY' , 'FROMADDRESS' ,            0657 02293000
*                 'TOADDRESS' , 'FROMNUMBER' , 'TONUMBER' ),       0657 02294000
*          MSGINDX    FIXED(31) ,                                  0657 02295000
*          MSGENTRY   PTR(8)      INIT(17);                /*@Y30SSLO*/ 02296000
*                                                                  0657 02297000
*        /************************************************************/ 02298000
*        /*                                                          */ 02299000
*        /* ENTRY POINT TO DELIMSET- INTERNAL PROCEDURE              */ 02300000
*        /*                                                          */ 02301000
*        /************************************************************/ 02302000
*                                                                  0658 02303000
*        OLDERID2 = NEWERID2;                                      0658 02304000
         L     @08,@PC00001                                        0658 02305000
         L     @08,GDTTR2(,@08)                                    0658 02306000
         MVC   @TS00001(95),NEWERID2(@08)                          0658 02307000
         MVC   OLDERID2(95,@08),@TS00001                           0658 02308000
*        NEWID2 = 'RP21';                                  /*@Y30SSLO*/ 02309000
         MVC   NEWID2(4,@08),@CC01180                              0659 02310000
*        DELMFLG = STOP;                                           0660 02311000
         L     @08,@PC00002                                        0660 02312000
         MVI   DELMFLG(@08),X'0F'                                  0660 02313000
*        SKIPFLAG = GO;                                            0661 02314000
         MVI   SKIPFLAG,X'00'                                      0661 02315000
*        TESTRC = 0;                                               0662 02316000
         SLR   @08,@08                                             0662 02317000
         STH   @08,TESTRC                                          0662 02318000
*        DELMINCR = 0;                                             0663 02319000
         L     @03,@PC00002+8                                      0663 02320000
         STH   @08,DELMINCR(,@03)                                  0663 02321000
*        DELMCNT = 2;                                              0664 02322000
         L     @03,@PC00002+4                                      0664 02323000
         MVC   DELMCNT(4,@03),@CF00153                             0664 02324000
*        MSGINDX = 0;                                      /*@Y30SSJH*/ 02325000
*                                                                  0665 02326000
         SLR   MSGINDX,MSGINDX                                     0665 02327000
*        /************************************************************/ 02328000
*        /*                                                  @Y30SSJH*/ 02329000
*        /* DATA TYPE VALIDITY CHECKING:                     @Y30SSJH*/ 02330000
*        /*   FMKEY/TOKEY INVALID WITH RRDS,                 @Y30SSJH*/ 02331000
*        /*   FMRBA/TORBA INVALID WITH RRDS,                 @Y30SSJH*/ 02332000
*        /*   FMNUM VALID ONLY WITH RRDS,                    @Y30SSJH*/ 02333000
*        /*   TONUM VALID ONLY WITH RRDS.                    @Y30SSJH*/ 02334000
*        /*                                                  @Y30SSJH*/ 02335000
*        /************************************************************/ 02336000
*                                                                  0666 02337000
*        IF (ADDR(FMKYC) ^= NULLPTR  &                             0666 02338000
*            IOCMACRR = ON )                                       0666 02339000
*          THEN                                                    0666 02340000
         L     @03,@PC00001+4                                      0666 02341000
         C     @08,FDTPTR+8(,@03)                                  0666 02342000
         BE    @RF00666                                            0666 02343000
         L     @08,IOCSPTR                                         0666 02344000
         TM    IOCMACRR(@08),B'00100000'                           0666 02345000
         BNO   @RF00666                                            0666 02346000
*            MSGINDX = 1;                                  /*@Y30SSJH*/ 02347000
         LA    MSGINDX,1                                           0667 02348000
*          ELSE                                                    0668 02349000
*            IF (ADDR(TOKYC) ^= NULLPTR  &                         0668 02350000
*                IOCMACRR = ON)                                    0668 02351000
*              THEN                                                0668 02352000
         B     @RC00666                                            0668 02353000
@RF00666 L     @08,@PC00001+4                                      0668 02354000
         L     @08,FDTPTR+20(,@08)                                 0668 02355000
         LTR   @08,@08                                             0668 02356000
         BZ    @RF00668                                            0668 02357000
         L     @08,IOCSPTR                                         0668 02358000
         TM    IOCMACRR(@08),B'00100000'                           0668 02359000
         BNO   @RF00668                                            0668 02360000
*                MSGINDX = 2;                              /*@Y30SSJH*/ 02361000
         LA    MSGINDX,2                                           0669 02362000
*              ELSE                                                0670 02363000
*                IF (ADDR(FMRBA) ^= NULLPTR  &                     0670 02364000
*                  IOCMACRR = ON)                                  0670 02365000
*                  THEN                                            0670 02366000
         B     @RC00668                                            0670 02367000
@RF00668 L     @08,@PC00001+4                                      0670 02368000
         L     @08,FDTPTR+12(,@08)                                 0670 02369000
         LTR   @08,@08                                             0670 02370000
         BZ    @RF00670                                            0670 02371000
         L     @08,IOCSPTR                                         0670 02372000
         TM    IOCMACRR(@08),B'00100000'                           0670 02373000
         BNO   @RF00670                                            0670 02374000
*                    MSGINDX = 3;                          /*@Y30SSJH*/ 02375000
         LA    MSGINDX,3                                           0671 02376000
*                  ELSE                                            0672 02377000
*                    IF (ADDR(TORBA) ^= NULLPTR  &                 0672 02378000
*                        IOCMACRR= ON)                             0672 02379000
*                      THEN                                        0672 02380000
         B     @RC00670                                            0672 02381000
@RF00670 L     @08,@PC00001+4                                      0672 02382000
         L     @08,FDTPTR+24(,@08)                                 0672 02383000
         LTR   @08,@08                                             0672 02384000
         BZ    @RF00672                                            0672 02385000
         L     @08,IOCSPTR                                         0672 02386000
         TM    IOCMACRR(@08),B'00100000'                           0672 02387000
         BNO   @RF00672                                            0672 02388000
*                        MSGINDX = 4;                      /*@Y30SSJH*/ 02389000
         LA    MSGINDX,4                                           0673 02390000
*                      ELSE                                        0674 02391000
*                        IF (ADDR(FMNUM) ^= NULLPTR  &             0674 02392000
*                            IOCMACRR = OFF)                       0674 02393000
*                          THEN                                    0674 02394000
         B     @RC00672                                            0674 02395000
@RF00672 L     @08,@PC00001+4                                      0674 02396000
         L     @08,FDTPTR+48(,@08)                                 0674 02397000
         LTR   @08,@08                                             0674 02398000
         BZ    @RF00674                                            0674 02399000
         L     @08,IOCSPTR                                         0674 02400000
         TM    IOCMACRR(@08),B'00100000'                           0674 02401000
         BNZ   @RF00674                                            0674 02402000
*                            MSGINDX = 5;                  /*@Y30SSJH*/ 02403000
         LA    MSGINDX,5                                           0675 02404000
*                          ELSE                                    0676 02405000
*                            IF (ADDR(TONUM) ^= NULLPTR  &         0676 02406000
*                                IOCMACRR = OFF)                   0676 02407000
*                              THEN                                0676 02408000
         B     @RC00674                                            0676 02409000
@RF00674 L     @08,@PC00001+4                                      0676 02410000
         L     @08,FDTPTR+52(,@08)                                 0676 02411000
         LTR   @08,@08                                             0676 02412000
         BZ    @RF00676                                            0676 02413000
         L     @08,IOCSPTR                                         0676 02414000
         TM    IOCMACRR(@08),B'00100000'                           0676 02415000
         BNZ   @RF00676                                            0676 02416000
*                                MSGINDX = 6;              /*@Y30SSJH*/ 02417000
         LA    MSGINDX,6                                           0677 02418000
*                              ELSE;                       /*@Y30SSJH*/ 02419000
*                                                                  0678 02420000
@RF00676 DS    0H                                                  0679 02421000
*                                                                  0679 02422000
*        /************************************************************/ 02423000
*        /*                                                  @Y30SSJH*/ 02424000
*        /* WRITE MESSAGE INDICATING INVALID USE OF          @Y30SSJH*/ 02425000
*        /* DELIMITERS                                       @Y30SSJH*/ 02426000
*        /*                                                  @Y30SSJH*/ 02427000
*        /************************************************************/ 02428000
*                                                                  0679 02429000
*        IF MSGINDX ^= 0                                           0679 02430000
*          THEN                                                    0679 02431000
@RC00674 DS    0H                                                  0679 02432000
@RC00672 DS    0H                                                  0679 02433000
@RC00670 DS    0H                                                  0679 02434000
@RC00668 DS    0H                                                  0679 02435000
@RC00666 LTR   MSGINDX,MSGINDX                                     0679 02436000
         BZ    @RF00679                                            0679 02437000
*            DO;                                           /*@Y30SSJH*/ 02438000
*                                                                  0680 02439000
*            STATFLG = TERMERR;                            /*@Y30SSJH*/ 02440000
         MVC   STATFLG(5),@CB00819                                 0681 02441000
*            DARGL = ''B;                                  /*@Y30SSLO*/ 02442000
         XC    DARGL(28),DARGL                                     0682 02443000
*            DARGSENT = MSGENTRY;                          /*@Y30SSJH*/ 02444000
         L     @08,DDSTRU                                          0683 02445000
         MVC   DARGSENT(1,@08),MSGENTRY                            0683 02446000
*            DARGSMOD = 'PR0';                             /*@Y30SSJH*/ 02447000
         MVC   DARGSMOD(3,@08),@CC01129                            0684 02448000
*            DARGCNT = 1;                                  /*@Y30SSJH*/ 02449000
         LA    @03,1                                               0685 02450000
         STH   @03,DARGCNT(,@08)                                   0685 02451000
*            DARGINS(1) = 1;                               /*@Y30SSLO*/ 02452000
         STH   @03,DARGINS(,@08)                                   0686 02453000
*            DARGINL(1) = LENGTH(MSGARY(1));               /*@Y30SSLO*/ 02454000
         LA    @03,11                                              0687 02455000
         STH   @03,DARGINL(,@08)                                   0687 02456000
*            DARGDTM(1) = ADDR(MSGARY(MSGINDX));           /*@Y30SSLO*/ 02457000
*                                                                  0688 02458000
         LR    @01,@03                                             0688 02459000
         MR    @00,MSGINDX                                         0688 02460000
         LA    @03,MSGARY-11(@01)                                  0688 02461000
         ST    @03,DARGDTM(,@08)                                   0688 02462000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30SSJH*/ 02463000
*                                                                  0689 02464000
         L     @08,@PC00001                                        0689 02465000
         ST    @08,@AL00001                                        0689 02466000
         LA    @03,@CF00115                                        0689 02467000
         ST    @03,@AL00001+4                                      0689 02468000
         LA    @03,DDSTRU                                          0689 02469000
         ST    @03,@AL00001+8                                      0689 02470000
         MVI   @AL00001+8,X'80'                                    0689 02471000
         L     @15,GDTPRT(,@08)                                    0689 02472000
         LA    @01,@AL00001                                        0689 02473000
         BALR  @14,@15                                             0689 02474000
*            END;                                          /*@Y30SSJH*/ 02475000
*                                                                  0690 02476000
*        /************************************************************/ 02477000
*        /*                                                          */ 02478000
*        /* POSITION TO THE BEGINNING OF THE SUBSET OF THE DATASET   */ 02479000
*        /*                                                          */ 02480000
*        /************************************************************/ 02481000
*                                                                  0691 02482000
*        IF ((ADDR(FMKYC)) ^= NULLPTR  |                   /*@Y30SSJH*/ 02483000
*            (ADDR(FMRBA)) ^= NULLPTR |                    /*@Y30SSJH*/ 02484000
*            (ADDR(FMNUM)) ^= NULLPTR )  &                 /*@Y30SSJH*/ 02485000
*           MSGINDX = 0                                            0691 02486000
*                                                                  0691 02487000
*          /**********************************************************/ 02488000
*          /*                                                        */ 02489000
*          /* POSITION BY KEY, RBA OR RECORD NUMBER        /*@Y30SSJH*/ 02490000
*          /*                                                        */ 02491000
*          /**********************************************************/ 02492000
*          THEN                                                    0691 02493000
@RF00679 SLR   @08,@08                                             0691 02494000
         L     @03,@PC00001+4                                      0691 02495000
         C     @08,FDTPTR+8(,@03)                                  0691 02496000
         BNE   @GL00055                                            0691 02497000
         C     @08,FDTPTR+12(,@03)                                 0691 02498000
         BNE   @GL00055                                            0691 02499000
         C     @08,FDTPTR+48(,@03)                                 0691 02500000
         BE    @RF00691                                            0691 02501000
@GL00055 SLR   @08,@08                                             0691 02502000
         CR    MSGINDX,@08                                         0691 02503000
         BNE   @RF00691                                            0691 02504000
*            DO;                                                   0692 02505000
*                                                                  0692 02506000
*            /********************************************************/ 02507000
*            /*                                                      */ 02508000
*            /* SET UP FOR KEY POSITIONING                           */ 02509000
*            /*                                                      */ 02510000
*            /********************************************************/ 02511000
*                                                                  0693 02512000
*            IF (ADDR(FMKYC)) ^= NULLPTR                   /*@Y30SSJH*/ 02513000
*              THEN                                                0693 02514000
         L     @03,@PC00001+4                                      0693 02515000
         L     @03,FDTPTR+8(,@03)                                  0693 02516000
         CR    @03,@08                                             0693 02517000
         BE    @RF00693                                            0693 02518000
*                DO;                                               0694 02519000
*                                                                  0694 02520000
*                IOCKYA = ADDR(FMKYCVAL);                          0695 02521000
         L     @08,IOCSPTR                                         0695 02522000
         LA    @15,FMKYCVAL(,@03)                                  0695 02523000
         ST    @15,IOCKYA(,@08)                                    0695 02524000
*                IOCPTL = FMKYCLEN;                                0696 02525000
*                                                                  0696 02526000
         SLR   @15,@15                                             0696 02527000
         IC    @15,FMKYCLEN(,@03)                                  0696 02528000
         STH   @15,IOCPTL(,@08)                                    0696 02529000
*                END;                                              0697 02530000
*                                                                  0697 02531000
*              /******************************************************/ 02532000
*              /*                                                    */ 02533000
*              /* SET UP FOR RBA POSITIONING                         */ 02534000
*              /*                                                    */ 02535000
*              /******************************************************/ 02536000
*                                                                  0698 02537000
*              ELSE                                                0698 02538000
*                IF (ADDR(FMNUM)) ^= NULLPTR               /*@Y30SSJH*/ 02539000
*                  THEN                                            0698 02540000
         B     @RC00693                                            0698 02541000
@RF00693 L     @08,@PC00001+4                                      0698 02542000
         L     @08,FDTPTR+48(,@08)                                 0698 02543000
         LTR   @08,@08                                             0698 02544000
         BZ    @RF00698                                            0698 02545000
*                    IOCREL = FMNUMVAL;                    /*@Y30SSJH*/ 02546000
         L     @03,IOCSPTR                                         0699 02547000
         MVC   IOCREL(4,@03),FMNUMVAL(@08)                         0699 02548000
*                  ELSE                                            0700 02549000
*                IOCRBA = FMRBAVAL;                                0700 02550000
*                                                                  0700 02551000
         B     @RC00698                                            0700 02552000
@RF00698 L     @08,@PC00001+4                                      0700 02553000
         L     @08,FDTPTR+12(,@08)                                 0700 02554000
         L     @03,IOCSPTR                                         0700 02555000
         MVC   IOCRBA(4,@03),FMRBAVAL(@08)                         0700 02556000
*            CALL IDCIOPO0(GDTTBL,IOCSPTR);                        0701 02557000
*                                                                  0701 02558000
@RC00698 DS    0H                                                  0701 02559000
@RC00693 L     @08,@PC00001                                        0701 02560000
         ST    @08,@AL00001                                        0701 02561000
         LA    @03,IOCSPTR                                         0701 02562000
         ST    @03,@AL00001+4                                      0701 02563000
         MVI   @AL00001+4,X'80'                                    0701 02564000
         L     @15,GDTPOS(,@08)                                    0701 02565000
         LA    @01,@AL00001                                        0701 02566000
         BALR  @14,@15                                             0701 02567000
*            RESPECIFY RTNREG RSTD;                                0702 02568000
*            TESTRC = RTNREG;                                      0703 02569000
         STH   RTNREG,TESTRC                                       0703 02570000
*            RESPECIFY RTNREG UNRSTD;                              0704 02571000
*                                                                  0704 02572000
*            END;                                                  0705 02573000
*                                                                  0706 02574000
*          /**********************************************************/ 02575000
*          /*                                                        */ 02576000
*          /* POSITION BY SKIPPING TO BEGINING OF SUBSET, VIA A      */ 02577000
*          /* REPETITION OF UGET REQUESTS EQUAL TO THE NUMBER OF     */ 02578000
*          /* RECORDS TO BE SKIPPED.                                 */ 02579000
*          /*                                                        */ 02580000
*          /**********************************************************/ 02581000
*          ELSE                                                    0706 02582000
*            IF MSGINDX = 0                                        0706 02583000
*              THEN                                                0706 02584000
         B     @RC00691                                            0706 02585000
@RF00691 SLR   @08,@08                                             0706 02586000
         CR    MSGINDX,@08                                         0706 02587000
         BNE   @RF00706                                            0706 02588000
*                DO;                                       /*@Y30SSJH*/ 02589000
*                IF (ADDR(SKIP)) ^= NULLPTR                /*@Y30SSJH*/ 02590000
*                  THEN                                            0708 02591000
         L     @03,@PC00001+4                                      0708 02592000
         L     @03,FDTPTR+16(,@03)                                 0708 02593000
         CR    @03,@08                                             0708 02594000
         BE    @RF00708                                            0708 02595000
*                    IF IOCMACRR = ON                              0709 02596000
*                      THEN                                        0709 02597000
         L     @08,IOCSPTR                                         0709 02598000
         TM    IOCMACRR(@08),B'00100000'                           0709 02599000
         BNO   @RF00709                                            0709 02600000
*                        DO;                               /*@Y30SSJH*/ 02601000
*                                                                  0710 02602000
*                        IOCREL = SKIPVAL + 1;             /*@Y30SSJH*/ 02603000
*                                                                  0711 02604000
         LA    @15,1                                               0711 02605000
         AL    @15,SKIPVAL(,@03)                                   0711 02606000
         ST    @15,IOCREL(,@08)                                    0711 02607000
*                        CALL IDCIOPO0(GDTTBL,IOCSPTR);    /*@Y30SSJH*/ 02608000
         L     @08,@PC00001                                        0712 02609000
         ST    @08,@AL00001                                        0712 02610000
         LA    @03,IOCSPTR                                         0712 02611000
         ST    @03,@AL00001+4                                      0712 02612000
         MVI   @AL00001+4,X'80'                                    0712 02613000
         L     @15,GDTPOS(,@08)                                    0712 02614000
         LA    @01,@AL00001                                        0712 02615000
         BALR  @14,@15                                             0712 02616000
*                        RESPECIFY RTNREG RSTD;                    0713 02617000
*                        TESTRC = RTNREG;                          0714 02618000
         STH   RTNREG,TESTRC                                       0714 02619000
*                        RESPECIFY RTNREG UNRSTD;          /*@Y30SSJH*/ 02620000
*                                                                  0715 02621000
*                        END;                              /*@Y30SSJH*/ 02622000
*                      ELSE                                        0717 02623000
*                        DO SKIPLOOP= 1 TO SKIPVAL                 0717 02624000
*                          WHILE SKIPFLAG = GO;            /*@Y30SSJH*/ 02625000
*                                                                  0717 02626000
         B     @RC00709                                            0717 02627000
@RF00709 LA    SKIPLOOP,1                                          0717 02628000
         B     @DE00717                                            0717 02629000
@DL00717 CLI   SKIPFLAG,X'00'                                      0717 02630000
         BNE   @DC00717                                            0717 02631000
*                          CALL IDCIOGT0(GDTTBL,IOCSPTR);  /*@Y30SSJH*/ 02632000
         L     @08,@PC00001                                        0718 02633000
         ST    @08,@AL00001                                        0718 02634000
         LA    @04,IOCSPTR                                         0718 02635000
         ST    @04,@AL00001+4                                      0718 02636000
         MVI   @AL00001+4,X'80'                                    0718 02637000
         L     @15,GDTGET(,@08)                                    0718 02638000
         LA    @01,@AL00001                                        0718 02639000
         BALR  @14,@15                                             0718 02640000
*                          RESPECIFY RTNREG RSTD;                  0719 02641000
*                          TESTRC = RTNREG;                        0720 02642000
         STH   RTNREG,TESTRC                                       0720 02643000
*                          RESPECIFY RTNREG UNRSTD;        /*@Y30SSJH*/ 02644000
*                                                                  0721 02645000
*                          /******************************************/ 02646000
*                          /*                                @Y30SSJH*/ 02647000
*                          /* FAILURE IN SKIPPING WILL CAUSE A       */ 02648000
*                          /* TERMINAL ERROR                 @Y30SSJH*/ 02649000
*                          /*                                @Y30SSJH*/ 02650000
*                          /******************************************/ 02651000
*                                                                  0722 02652000
*                          IF TESTRC ^= 0                          0722 02653000
*                            THEN                                  0722 02654000
         LH    @08,TESTRC                                          0722 02655000
         LTR   @08,@08                                             0722 02656000
         BZ    @RF00722                                            0722 02657000
*                              SKIPFLAG = STOP;            /*@Y30SSJH*/ 02658000
*                                                                  0723 02659000
         MVI   SKIPFLAG,X'0F'                                      0723 02660000
*                        END;                              /*@Y30SSJH*/ 02661000
@RF00722 AH    SKIPLOOP,@CH00219                                   0724 02662000
@DE00717 L     @08,@PC00001+4                                      0724 02663000
         L     @08,FDTPTR+16(,@08)                                 0724 02664000
         C     SKIPLOOP,SKIPVAL(,@08)                              0724 02665000
         BNH   @DL00717                                            0724 02666000
@DC00717 DS    0H                                                  0725 02667000
*                END;                                      /*@Y30SSJH*/ 02668000
@RC00709 DS    0H                                                  0725 02669000
@RF00708 DS    0H                                                  0726 02670000
*        /************************************************************/ 02671000
*        /*                                                          */ 02672000
*        /* INSURE BEGINNING DELIMITER HAS BEEN SUCCESSFULLY SET     */ 02673000
*        /* BEFORE SETTING THE ENDING DELIMITER                      */ 02674000
*        /*                                                          */ 02675000
*        /************************************************************/ 02676000
*        IF TESTRC = 0  & MSGINDX = 0                              0726 02677000
*          THEN                                                    0726 02678000
@RF00706 DS    0H                                                  0726 02679000
@RC00691 SLR   @08,@08                                             0726 02680000
         CH    @08,TESTRC                                          0726 02681000
         BNE   @RF00726                                            0726 02682000
         CR    MSGINDX,@08                                         0726 02683000
         BNE   @RF00726                                            0726 02684000
*            DO;                                                   0727 02685000
*                                                                  0727 02686000
*                                                                  0727 02687000
*            /********************************************************/ 02688000
*            /*                                                      */ 02689000
*            /* SET ENDING KEY DELIMITER FLAG                        */ 02690000
*            /*                                                      */ 02691000
*            /********************************************************/ 02692000
*                                                                  0728 02693000
*            IF (ADDR(TOKYC)) ^= NULLPTR                   /*@Y30SSJH*/ 02694000
*              THEN                                                0728 02695000
         L     @15,@PC00001+4                                      0728 02696000
         C     @08,FDTPTR+20(,@15)                                 0728 02697000
         BE    @RF00728                                            0728 02698000
*                DELIMFLG = TOKYPOST;                              0729 02699000
*                                                                  0729 02700000
         MVI   DELIMFLG,X'02'                                      0729 02701000
*              ELSE                                                0730 02702000
*                /****************************************************/ 02703000
*                /*                                                  */ 02704000
*                /* SET ENDING RBA DELIMITER FLAG                    */ 02705000
*                /*                                                  */ 02706000
*                /****************************************************/ 02707000
*                                                                  0730 02708000
*                IF (ADDR(TORBA)) ^= NULLPTR               /*@Y30SSJH*/ 02709000
*                  THEN                                            0730 02710000
         B     @RC00728                                            0730 02711000
@RF00728 L     @08,@PC00001+4                                      0730 02712000
         L     @08,FDTPTR+24(,@08)                                 0730 02713000
         LTR   @08,@08                                             0730 02714000
         BZ    @RF00730                                            0730 02715000
*                    DELIMFLG = TORBAPOS;                          0731 02716000
*                                                                  0731 02717000
         MVI   DELIMFLG,X'03'                                      0731 02718000
*                  /**************************************************/ 02719000
*                  /*                                        @Y30SSJH*/ 02720000
*                  /* SET ENDING RECORD NUMBER  FLAG         @Y30SSJH*/ 02721000
*                  /*                                        @Y30SSJH*/ 02722000
*                  /**************************************************/ 02723000
*                                                                  0732 02724000
*                  ELSE                                            0732 02725000
*                    IF (ADDR(TONUM)) ^= NULLPTR           /*@Y30SSJH*/ 02726000
*                      THEN                                        0732 02727000
         B     @RC00730                                            0732 02728000
@RF00730 L     @08,@PC00001+4                                      0732 02729000
         L     @08,FDTPTR+52(,@08)                                 0732 02730000
         LTR   @08,@08                                             0732 02731000
         BZ    @RF00732                                            0732 02732000
*                        DELIMFLG = TORRNPOS;              /*@Y30SSJH*/ 02733000
         MVI   DELIMFLG,X'04'                                      0733 02734000
*                    /************************************************/ 02735000
*                    /*                                              */ 02736000
*                    /* SET LOOP CONTROL FOR COPYING AN EXPLICIT     */ 02737000
*                    /* NUMBER OR RECORDS                            */ 02738000
*                    /* . DELMCNT - # OF RECORDS TO BE COPIED        */ 02739000
*                    /* . DELMINCR - LOOP CONTROL INCREMENT, THIS    */ 02740000
*                    /*   VALUE ENABLES LOOP CONTROL OF THE COUNT    */ 02741000
*                    /*   PROCESSING IN CPYLOOPB.                    */ 02742000
*                    /*                                              */ 02743000
*                    /************************************************/ 02744000
*                                                                  0734 02745000
*                    IF (ADDR(COUNT)) ^= NULLPTR           /*@Y30SSJH*/ 02746000
*                      THEN                                        0734 02747000
@RF00732 DS    0H                                                  0734 02748000
@RC00730 DS    0H                                                  0734 02749000
@RC00728 L     @08,@PC00001+4                                      0734 02750000
         L     @08,FDTPTR+28(,@08)                                 0734 02751000
         LTR   @08,@08                                             0734 02752000
         BZ    @RF00734                                            0734 02753000
*                        DO;                                       0735 02754000
*                                                                  0735 02755000
*                        DELMCNT = COUNTVAL;                       0736 02756000
         L     @15,@PC00002+4                                      0736 02757000
         MVC   DELMCNT(4,@15),COUNTVAL(@08)                        0736 02758000
*                        DELMINCR = 1;                             0737 02759000
*                                                                  0737 02760000
         L     @08,@PC00002+8                                      0737 02761000
         MVC   DELMINCR(2,@08),@CH00219                            0737 02762000
*                        END;                                      0738 02763000
*                                                                  0738 02764000
*            END;                                                  0739 02765000
*          /**********************************************************/ 02766000
*          /*                                                        */ 02767000
*          /* BEGINNING POSITIONING FAILED                           */ 02768000
*          /*                                                        */ 02769000
*          /**********************************************************/ 02770000
*          ELSE                                                    0740 02771000
*            IF MSGINDX = 0                                        0740 02772000
*              THEN                                                0740 02773000
         B     @RC00726                                            0740 02774000
@RF00726 LTR   MSGINDX,MSGINDX                                     0740 02775000
         BNZ   @RF00740                                            0740 02776000
*                DO;                                       /*@Y30SSJH*/ 02777000
*                                                                  0741 02778000
*                STATFLG = POSITERR;                       /*@Y30SSJH*/ 02779000
*                                                                  0742 02780000
         MVC   STATFLG(5),@CB00822                                 0742 02781000
*                END;                                      /*@Y30SSJH*/ 02782000
*                                                                  0743 02783000
*        /************************************************************/ 02784000
*        /*                                                          */ 02785000
*        /* RETURN TO INVOKER OF DELIMSET                            */ 02786000
*        /*                                                          */ 02787000
*        /************************************************************/ 02788000
*                                                                  0744 02789000
*        RETURN ;                                                  0744 02790000
@EL00002 DS    0H                                                  0744 02791000
@EF00002 DS    0H                                                  0744 02792000
@ER00002 LM    @14,@12,@SA00002                                    0744 02793000
         BR    @14                                                 0744 02794000
*END DELIMSET;                                                     0745 02795000
*                                                                  0745 02796000
         B     @EL00002                                            0745 02797000
*/********************************************************************/ 02798000
*/*                                                          @OZ00751*/ 02799000
*/* PROCEDURE NAME - CATRELOD                                @OZ00751*/ 02800000
*/*                                                          @OZ00751*/ 02801000
*/* FUNCTION - CATRELOD RECEIVES CONTROL FROM IDCRP01;THE    @OZ00751*/ 02802000
*/*            FUNCTIONS PERFORMED ARE:                      @OZ00751*/ 02803000
*/*              1 - VERIFY THAT BACKUP AND TARGET MATCH     @OZ00751*/ 02804000
*/*                  WITH RESPECT TO NAME,VOLSER AND DEVICE  @OZ00751*/ 02805000
*/*                  TYPE                                    @OZ00751*/ 02806000
*/*              2   VERIFY THAT THERE IS ENOUGH SPACE TO    @OZ00751*/ 02807000
*/*                  COPY THE CATALOG.                       @OZ00751*/ 02808000
*/*              3 - BUILD CI TRANSLATE TABLE FROM BACKUP    @OZ00751*/ 02809000
*/*                  AND TARGET HEADERS                      @OZ00751*/ 02810000
*/*                                                                  */ 02811000
*/*              4 - COPY THE BACKUP TO THE TARGET CATALOG   @OZ00751*/ 02812000
*/*                  AND TRANSLATE THE INTERNAL CI# POINTERS.@OZ00751*/ 02813000
*/*              5   AT END OF FILE AN UPDATED CATALOG       @OZ00751*/ 02814000
*/*                  CONTROL RECORD IS WRITTEN.              @OZ00751*/ 02815000
*/*                                                                  */ 02816000
*/*  INPUT - THE OUTPUT DATA SET IS OPENED FOR OUTPUT AND    @OZ00751*/ 02817000
*/*          UPDATE AND IS POSITIONED AT THE FIRST RECORD    @OZ00751*/ 02818000
*/*          THE INPUT DATA SET IS OPEN AND SIMILARLY        @OZ00751*/ 02819000
*/*          POSITIONED.                                     @OZ00751*/ 02820000
*/*                                                                  */ 02821000
*/* OUTPUT - THE INPUT DATA SET (THE BACKUP CATALOG) HAS     @OZ00751*/ 02822000
*/*          BEEN COPIED (RELOADED) TO THE OUTPUT (THE TARGET@OZ00751*/ 02823000
*/*          CATALOG) DATA SET.                              @OZ00751*/ 02824000
*/*                                                                  */ 02825000
*/********************************************************************/ 02826000
*                                                                  0746 02827000
*CATRELOD:                                                         0746 02828000
*        PROCEDURE;                                        /*@OZ00751*/ 02829000
*                                                                  0746 02830000
CATRELOD STM   @14,@12,@SA00003                                    0746 02831000
*        OLDERID2 = NEWERID2;                                      0747 02832000
         L     @08,@PC00001                                        0747 02833000
         L     @08,GDTTR2(,@08)                                    0747 02834000
         MVC   @TS00001(95),NEWERID2(@08)                          0747 02835000
         MVC   OLDERID2(95,@08),@TS00001                           0747 02836000
*        NEWID2='RPT1';                                    /*@OZ00751*/ 02837000
*                                                                  0748 02838000
         MVC   NEWID2(4,@08),@CC01184                              0748 02839000
*        K = NULL;                       /*ZERO MSG COUNTER  @OZ00751*/ 02840000
         SLR   K,K                                                 0749 02841000
*        CFROLD = NULL;                 /*ZERO OLD CI STORE  @OZ00751*/ 02842000
*                                                                  0750 02843000
*                                                                  0750 02844000
         SLR   @08,@08                                             0750 02845000
         ST    @08,@TF00001                                        0750 02846000
         MVC   CFROLD(3),@TF00001+1                                0750 02847000
*        /************************************************************/ 02848000
*        /*                                                  @OZ00751*/ 02849000
*        /*BEFORE STARTING UPDATTING OF THE TARGET THERE ARE @OZ00751*/ 02850000
*        /* SEVERAL CHECKS TO BE MADE AND INFORMATION TO BE  @OZ00751*/ 02851000
*        /* OBTAINED.                                        @OZ00751*/ 02852000
*        /* 1 CHECK THAT TARGET HAS ENOUGH SPACE ALLOCATED.  @OZ00751*/ 02853000
*        /* 2 CHECK THAT TARGET AND BACKUP NAMES AGREE.      @OZ00751*/ 02854000
*        /* 3 MAP THE TRUENAME EXTENTS OF BACKUP AND TARGET. @OZ00751*/ 02855000
*        /* 4 CHECK THAT THE VOLSER AND DEVTYPES AGREE.      @OZ00751*/ 02856000
*        /*                                                  @OZ00751*/ 02857000
*        /************************************************************/ 02858000
*                                                                  0751 02859000
*        /************************************************************/ 02860000
*        /*                                                  @OZ00751*/ 02861000
*        /*POSITION TO THE THIRD RECORD ON BACKUP AND TARGET @OZ00751*/ 02862000
*        /*                                                  @OZ00751*/ 02863000
*        /************************************************************/ 02864000
*                                                                  0751 02865000
*        DO I = 1 TO 3 WHILE TESTRC = 0;                   /*@OZ00751*/ 02866000
*                                                                  0751 02867000
         LA    I,1                                                 0751 02868000
@DL00751 LH    @08,TESTRC                                          0751 02869000
         LTR   @08,@08                                             0751 02870000
         BNZ   @DC00751                                            0751 02871000
*          CALL GETPAIR;                                   /*@OZ00751*/ 02872000
*                                                                  0752 02873000
         BAL   @14,GETPAIR                                         0752 02874000
*        END;                                              /*@OZ00751*/ 02875000
*                                                                  0753 02876000
         AH    I,@CH00219                                          0753 02877000
         CH    I,@CH00162                                          0753 02878000
         BNH   @DL00751                                            0753 02879000
@DC00751 DS    0H                                                  0754 02880000
*        /************************************************************/ 02881000
*        /*                                                  @OZ00751*/ 02882000
*        /* THESE NEXT RECORDS ARE THE CLUSTER RECORD FOR    @OZ00751*/ 02883000
*        /* THE CATALOG. THE NAMES ARE COMPARED AND IF THEY  @OZ00751*/ 02884000
*        /* DO NOT MATCH THEN A MESSAGE IS PRINTED AND       @OZ00751*/ 02885000
*        /* TERMINAL ERROR IS SET                            @OZ00751*/ 02886000
*        /* IF THE INPUT IS NOT POSITIONED AT THE THIRD      @OZ00751*/ 02887000
*        /* RECORD THEN THE RETURN CODE IS SET NON ZERO.     @OZ00751*/ 02888000
*        /*                                                  @OZ00751*/ 02889000
*        /************************************************************/ 02890000
*                                                                  0754 02891000
*        IF TESTRC = 0                                             0754 02892000
*          THEN                                                    0754 02893000
         LH    @08,TESTRC                                          0754 02894000
         LTR   @08,@08                                             0754 02895000
         BNZ   @RF00754                                            0754 02896000
*            DO;                                           /*@OZ00751*/ 02897000
*                                                                  0755 02898000
*            IF IOCSINP -> IOCDAD -> RCDCINO ^= 2                  0756 02899000
*              THEN                                                0756 02900000
         L     @08,IOCSINP                                         0756 02901000
         L     @08,IOCDAD(,@08)                                    0756 02902000
         CLC   RCDCINO(3,@08),@CF00153+1                           0756 02903000
         BE    @RF00756                                            0756 02904000
*                TESTRC = 4;                               /*@OZ00751*/ 02905000
*                                                                  0757 02906000
         MVC   TESTRC(2),@CH00042                                  0757 02907000
*            IF IOCSINP -> IOCDAD -> ENTNAME ^=                    0758 02908000
*               IOCSOUP -> IOCDAD -> ENTNAME                       0758 02909000
*              THEN                                                0758 02910000
@RF00756 L     @08,IOCSINP                                         0758 02911000
         L     @08,IOCDAD(,@08)                                    0758 02912000
         L     @04,IOCSOUP                                         0758 02913000
         L     @04,IOCDAD(,@04)                                    0758 02914000
         CLC   ENTNAME(44,@08),ENTNAME(@04)                        0758 02915000
         BE    @RF00758                                            0758 02916000
*                DO;                                       /*@OZ00751*/ 02917000
*                                                                  0759 02918000
*                STATFLG = TERMERR;                        /*@OZ00751*/ 02919000
         MVC   STATFLG(5),@CB00819                                 0760 02920000
*                DARGLIST = ''B;                           /*@OZ00751*/ 02921000
         L     @08,DDSTRU                                          0761 02922000
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0761 02923000
*                DARGSMOD = 'PR0';                         /*@OZ00751*/ 02924000
         MVC   DARGSMOD(3,@08),@CC01129                            0762 02925000
*                DARGSENT = 21;                            /*@OZ00751*/ 02926000
         MVI   DARGSENT(@08),X'15'                                 0763 02927000
*                DARGDBP = ADDR(CNAME);                    /*@Y30SSEC*/ 02928000
         LA    @04,CNAME                                           0764 02929000
         ST    @04,DARGDBP(,@08)                                   0764 02930000
*                DARGILP = LENGTH(CNAME);                  /*@Y30SSEC*/ 02931000
*                                                                  0765 02932000
         MVC   DARGILP(2,@08),@CH00156                             0765 02933000
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@OZ00751*/ 02934000
*                                                                  0766 02935000
         L     @08,@PC00001                                        0766 02936000
         ST    @08,@AL00001                                        0766 02937000
         LA    @04,@CF00115                                        0766 02938000
         ST    @04,@AL00001+4                                      0766 02939000
         LA    @04,DDSTRU                                          0766 02940000
         ST    @04,@AL00001+8                                      0766 02941000
         MVI   @AL00001+8,X'80'                                    0766 02942000
         L     @15,GDTPRT(,@08)                                    0766 02943000
         LA    @01,@AL00001                                        0766 02944000
         BALR  @14,@15                                             0766 02945000
*                END;                                      /*@OZ00751*/ 02946000
*                                                                  0767 02947000
*            END;                                          /*@OZ00751*/ 02948000
*                                                                  0768 02949000
@RF00758 DS    0H                                                  0769 02950000
*        /************************************************************/ 02951000
*        /*                                                  @OZ00751*/ 02952000
*        /* STORE CATALOG CONTROL RECORD FOR LATER USE       @OZ00751*/ 02953000
*        /*                                                  @OZ00751*/ 02954000
*        /***********************************************************/  02955000
*                                                                  0769 02956000
*        IF TESTRC = 0                                             0769 02957000
*          THEN                                                    0769 02958000
@RF00754 LH    @08,TESTRC                                          0769 02959000
         LTR   @08,@08                                             0769 02960000
         BNZ   @RF00769                                            0769 02961000
*            DO;                                           /*@OZ00751*/ 02962000
*                                                                  0770 02963000
*            CALL GETPAIR;                                 /*@OZ00751*/ 02964000
         BAL   @14,GETPAIR                                         0771 02965000
*            CCRECSTR = IOCSINP -> IOCDAD -> CATLREC(1:51);/*@OZ00751*/ 02966000
*                                                                  0772 02967000
         L     @08,IOCSINP                                         0772 02968000
         L     @08,IOCDAD(,@08)                                    0772 02969000
         MVC   CCRECSTR(51),CATLREC(@08)                           0772 02970000
*        /************************************************************/ 02971000
*        /*                                                  @OZ20462*/ 02972000
*        /* SAVE NEXT AVAILABLE CI IN OUTPUT CATALG          @OZ20462*/ 02973000
*        /*                                                  @OZ20462*/ 02974000
*        /***********************************************************/  02975000
*                                                                  0773 02976000
*            OCCRNFCI = IOCSOUP -> IOCDAD -> CCRNFCI;      /*@OZ20462*/ 02977000
*                                                                  0773 02978000
         L     @08,IOCSOUP                                         0773 02979000
         L     @08,IOCDAD(,@08)                                    0773 02980000
         MVC   OCCRNFCI(1),CCRNFCI+2(@08)                          0773 02981000
*            END;                                          /*@OZ00751*/ 02982000
*                                                                  0774 02983000
*        /************************************************************/ 02984000
*        /*                                                  @OZ00751*/ 02985000
*        /*READ TO RECORD 5 ON BACKUP AND TARGET             @OZ00751*/ 02986000
*        /*                                                  @OZ00751*/ 02987000
*        /************************************************************/ 02988000
*                                                                  0775 02989000
*        DO I = 1 TO 2;                                    /*@OZ00751*/ 02990000
*                                                                  0775 02991000
@RF00769 LA    I,1                                                 0775 02992000
@DL00775 DS    0H                                                  0776 02993000
*          CALL GETPAIR;                                   /*@OZ00751*/ 02994000
*                                                                  0776 02995000
         BAL   @14,GETPAIR                                         0776 02996000
*        END;                                              /*@OZ00751*/ 02997000
*                                                                  0777 02998000
         AH    I,@CH00219                                          0777 02999000
         CH    I,@CH00153                                          0777 03000000
         BNH   @DL00775                                            0777 03001000
*        /************************************************************/ 03002000
*        /*                                                  @OZ00751*/ 03003000
*        /* STORE FROM RECORD 5 THE HIGH USED AND HIGH       @OZ00751*/ 03004000
*        /* ALLOCATED RBA'S OF THE BACKUP AND TARGET         @OZ00751*/ 03005000
*        /* RESPECTIVELY.                                    @OZ00751*/ 03006000
*        /*                                                  @OZ00751*/ 03007000
*        /************************************************************/ 03008000
*                                                                  0778 03009000
*        IF TESTRC = 0                                             0778 03010000
*          THEN                                                    0778 03011000
         LH    @08,TESTRC                                          0778 03012000
         LTR   @08,@08                                             0778 03013000
         BNZ   @RF00778                                            0778 03014000
*            DO;                                           /*@OZ00751*/ 03015000
*                                                                  0779 03016000
*            HURBASAV = IOCSINP -> IOCDAD -> VOLHURBA;     /*@OZ00751*/ 03017000
         L     @08,IOCSINP                                         0780 03018000
         L     @08,IOCDAD(,@08)                                    0780 03019000
         MVC   HURBASAV(4),VOLHURBA(@08)                           0780 03020000
*            HARBASAV = IOCSOUP -> IOCDAD -> VOLHARBA;     /*@OZ00751*/ 03021000
*                                                                  0781 03022000
         L     @08,IOCSOUP                                         0781 03023000
         L     @08,IOCDAD(,@08)                                    0781 03024000
         MVC   HARBASAV(4),VOLHARBA(@08)                           0781 03025000
*            END;                                          /*@OZ00751*/ 03026000
*                                                                  0782 03027000
*        /************************************************************/ 03028000
*        /*                                                  @OZ00751*/ 03029000
*        /* READ TO RECORD 7 ON BACKUP-AND TARGET            @OZ00751*/ 03030000
*        /*                                                  @OZ00751*/ 03031000
*        /************************************************************/ 03032000
*                                                                  0783 03033000
*        DO I=1 TO 2;                                      /*@OZ00751*/ 03034000
@RF00778 LA    I,1                                                 0783 03035000
@DL00783 DS    0H                                                  0784 03036000
*          CALL GETPAIR;                                   /*@OZ00751*/ 03037000
         BAL   @14,GETPAIR                                         0784 03038000
*        END;                                              /*@OZ00751*/ 03039000
*                                                                  0785 03040000
         AH    I,@CH00219                                          0785 03041000
         CH    I,@CH00153                                          0785 03042000
         BNH   @DL00783                                            0785 03043000
*        /************************************************************/ 03044000
*        /*                                                  @OZ00751*/ 03045000
*        /* RECORD 7 CONTAINS A DESCRIPTION OF THE HIGH KEY  @OZ00751*/ 03046000
*        /* RANGE (TRUENAME) OF THE CATALOG. ANALYSIS OF     @OZ00751*/ 03047000
*        /* THESE RECORDS DETERMINE THE TRANSLATION OF CI #S @OZ00751*/ 03048000
*        /*                                                  @OZ00751*/ 03049000
*        /************************************************************/ 03050000
*                                                                  0786 03051000
*        IF TESTRC = 0                                             0786 03052000
*          THEN                                                    0786 03053000
         LH    @08,TESTRC                                          0786 03054000
         LTR   @08,@08                                             0786 03055000
         BNZ   @RF00786                                            0786 03056000
*            CALL TRUENAME;                                /*@OZ00751*/ 03057000
*                                                                  0787 03058000
         BAL   @14,TRUENAME                                        0787 03059000
*        /************************************************************/ 03060000
*        /*                                                  @OZ00751*/ 03061000
*        /*COMPARISON OF THE HIGH USED RBA FOR THE LOW KEY   @OZ00751*/ 03062000
*        /*RANGE OF THE BACKUP WITH THE HIGH ALLOCATED RBA   @OZ00751*/ 03063000
*        /*OF THE LOW KEY RANGE OF THE TARGET WILL TELL      @OZ00751*/ 03064000
*        /*IF THERE IS ENOUGH SPACE TO RELOAD THE CATALOG.   @OZ00751*/ 03065000
*        /* THE HIGH USED VALUE IS FIRST TRANSLATED.         @OZ00751*/ 03066000
*        /*                                                  @OZ00751*/ 03067000
*        /************************************************************/ 03068000
*                                                                  0788 03069000
*        IF TESTRC = 0                                             0788 03070000
*          THEN                                                    0788 03071000
@RF00786 LH    @08,TESTRC                                          0788 03072000
         LTR   @08,@08                                             0788 03073000
         BNZ   @RF00788                                            0788 03074000
*            DO;                                           /*@OZ00751*/ 03075000
*                                                                  0789 03076000
*            RFY RCIADDR RSTD;                             /*@OZ00751*/ 03077000
*            HURBASAV = (HURBASAV/CILEN) - 1;              /*@OZ00751*/ 03078000
         L     @00,HURBASAV                                        0791 03079000
         SRDA  @00,32                                              0791 03080000
         D     @00,@CF01050                                        0791 03081000
         BCTR  @01,0                                               0791 03082000
         ST    @01,HURBASAV                                        0791 03083000
*            RCIADDR = ADDR(HURBASAV) +1;                  /*@OZ00751*/ 03084000
         LA    RCIADDR,HURBASAV                                    0792 03085000
         AH    RCIADDR,@CH00219                                    0792 03086000
*            CALL CNVRTCI;                                 /*@OZ00751*/ 03087000
         BAL   @14,CNVRTCI                                         0793 03088000
*            RFY RCIADDR UNRSTD;                           /*@OZ00751*/ 03089000
*                                                                  0794 03090000
*            HURBASAV = HURBASAV* CILEN;                   /*@OZ00751*/ 03091000
         L     @08,HURBASAV                                        0795 03092000
         SLA   @08,9                                               0795 03093000
         ST    @08,HURBASAV                                        0795 03094000
*            IF HURBASAV > HARBASAV                                0796 03095000
*              THEN                                                0796 03096000
         C     @08,HARBASAV                                        0796 03097000
         BNH   @RF00796                                            0796 03098000
*                DO;                                       /*@OZ00751*/ 03099000
*                                                                  0797 03100000
*                /****************************************************/ 03101000
*                /*                                                  */ 03102000
*                /* SIGNAL TERMINAL ERROR AND PRINT NO SPACE @OZ00751*/ 03103000
*                /* MESSAGE                                  @OZ00751*/ 03104000
*                /*                                                  */ 03105000
*                /****************************************************/ 03106000
*                                                                  0798 03107000
*                STATFLG = TERMERR;                        /*@OZ00751*/ 03108000
         MVC   STATFLG(5),@CB00819                                 0798 03109000
*                DARGLIST = ''B;                           /*@OZ00751*/ 03110000
         L     @08,DDSTRU                                          0799 03111000
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0799 03112000
*                DARGSMOD = 'PR0';                         /*@OZ00751*/ 03113000
         MVC   DARGSMOD(3,@08),@CC01129                            0800 03114000
*                DARGSENT = '14'X;                         /*@OZ00751*/ 03115000
*                                                                  0801 03116000
         MVI   DARGSENT(@08),X'14'                                 0801 03117000
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@OZ00751*/ 03118000
*                                                                  0802 03119000
         L     @08,@PC00001                                        0802 03120000
         ST    @08,@AL00001                                        0802 03121000
         LA    @04,@CF00115                                        0802 03122000
         ST    @04,@AL00001+4                                      0802 03123000
         LA    @04,DDSTRU                                          0802 03124000
         ST    @04,@AL00001+8                                      0802 03125000
         MVI   @AL00001+8,X'80'                                    0802 03126000
         L     @15,GDTPRT(,@08)                                    0802 03127000
         LA    @01,@AL00001                                        0802 03128000
         BALR  @14,@15                                             0802 03129000
*                END;                                              0803 03130000
*                                                                  0803 03131000
*            END;                                          /*@OZ00751*/ 03132000
@RF00796 DS    0H                                                  0805 03133000
*        /************************************************************/ 03134000
*        /*                                                  @OZ00751*/ 03135000
*        /* READ FORWARD TO RECORD 9                         @OZ00751*/ 03136000
*        /*                                                  @OZ00751*/ 03137000
*        /************************************************************/ 03138000
*                                                                  0805 03139000
*        DO I=1 TO 2;                                      /*@OZ00751*/ 03140000
*                                                                  0805 03141000
@RF00788 LA    I,1                                                 0805 03142000
@DL00805 DS    0H                                                  0806 03143000
*          CALL GETPAIR;                                   /*@OZ00751*/ 03144000
*                                                                  0806 03145000
         BAL   @14,GETPAIR                                         0806 03146000
*        END;                                              /*@OZ00751*/ 03147000
*                                                                  0807 03148000
         AH    I,@CH00219                                          0807 03149000
         CH    I,@CH00153                                          0807 03150000
         BNH   @DL00805                                            0807 03151000
*        /************************************************************/ 03152000
*        /*                                                  @OZ00751*/ 03153000
*        /* RECORD 9 CONTAINS  THE VOLUME SERIAL NUMBER AND  @OZ00751*/ 03154000
*        /* THE DEVICE TYPE OF THE CATALOG. THE TWO RECORD   @OZ00751*/ 03155000
*        /* NINES ARE COMPARED AND IF THE VOLUME SERIAL      @OZ00751*/ 03156000
*        /* NUMBER OR DEVICE TYPES DO NOT AGREE THEN TERMINAL@OZ00751*/ 03157000
*        /* ERROR IS SET AND A MESSAGE PRINTED.              @OZ00751*/ 03158000
*        /*                                                  @OZ00751*/ 03159000
*        /************************************************************/ 03160000
*                                                                  0808 03161000
*        IF TESTRC = 0 &                                           0808 03162000
*           ((IOCSINP -> IOCDAD -> ENTNAME ^=                      0808 03163000
*           IOCSOUP -> IOCDAD -> ENTNAME) |                        0808 03164000
*           (IOCSINP -> IOCDAD -> DEVCLASS ^=              /*@OZ17527*/ 03165000
*           IOCSOUP -> IOCDAD -> DEVCLASS))                /*@OZ17527*/ 03166000
*          THEN                                                    0808 03167000
         LH    @08,TESTRC                                          0808 03168000
         LTR   @08,@08                                             0808 03169000
         BNZ   @RF00808                                            0808 03170000
         L     @08,IOCSINP                                         0808 03171000
         L     @08,IOCDAD(,@08)                                    0808 03172000
         L     @04,IOCSOUP                                         0808 03173000
         L     @04,IOCDAD(,@04)                                    0808 03174000
         CLC   ENTNAME(44,@08),ENTNAME(@04)                        0808 03175000
         BNE   @RT00808                                            0808 03176000
         CLC   DEVCLASS(2,@08),DEVCLASS(@04)                       0808 03177000
         BE    @RF00808                                            0808 03178000
@RT00808 DS    0H                                                  0809 03179000
*            DO;                                           /*@OZ00751*/ 03180000
*                                                                  0809 03181000
*            STATFLG = TERMERR;                            /*@OZ00751*/ 03182000
         MVC   STATFLG(5),@CB00819                                 0810 03183000
*            DARGLIST = ''B;                               /*@OZ00751*/ 03184000
         L     @08,DDSTRU                                          0811 03185000
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0811 03186000
*            DARGSMOD = 'PR0';                             /*@OZ00751*/ 03187000
         MVC   DARGSMOD(3,@08),@CC01129                            0812 03188000
*            DARGSENT = 21;                                /*@Y30SSEC*/ 03189000
         MVI   DARGSENT(@08),X'15'                                 0813 03190000
*            IF IOCSINP -> IOCDAD -> ENTNAME ^=                    0814 03191000
*               IOCSOUP -> IOCDAD -> ENTNAME                       0814 03192000
*              THEN                                                0814 03193000
         L     @04,IOCSINP                                         0814 03194000
         L     @04,IOCDAD(,@04)                                    0814 03195000
         L     @01,IOCSOUP                                         0814 03196000
         L     @01,IOCDAD(,@01)                                    0814 03197000
         CLC   ENTNAME(44,@04),ENTNAME(@01)                        0814 03198000
         BE    @RF00814                                            0814 03199000
*               DO;                                        /*@Y30SSEC*/ 03200000
*                 DARGDBP = ADDR(CVOLSER);                 /*@Y30SSEC*/ 03201000
         LA    @04,CVOLSER                                         0816 03202000
         ST    @04,DARGDBP(,@08)                                   0816 03203000
*                 DARGILP = LENGTH(CVOLSER);               /*@Y30SSEC*/ 03204000
*                                                                  0817 03205000
         MVC   DARGILP(2,@08),@CH00156                             0817 03206000
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);    /*@Y30SSEC*/ 03207000
*                                                                  0818 03208000
         L     @08,@PC00001                                        0818 03209000
         ST    @08,@AL00001                                        0818 03210000
         LA    @04,@CF00115                                        0818 03211000
         ST    @04,@AL00001+4                                      0818 03212000
         LA    @04,DDSTRU                                          0818 03213000
         ST    @04,@AL00001+8                                      0818 03214000
         MVI   @AL00001+8,X'80'                                    0818 03215000
         L     @15,GDTPRT(,@08)                                    0818 03216000
         LA    @01,@AL00001                                        0818 03217000
         BALR  @14,@15                                             0818 03218000
*                 END;                                     /*@Y30SSEC*/ 03219000
*            IF IOCSINP -> IOCDAD -> DEVCLASS ^=           /*@OZ17527*/ 03220000
*               IOCSOUP -> IOCDAD -> DEVCLASS              /*@OZ17527*/ 03221000
*              THEN                                                0820 03222000
@RF00814 L     @08,IOCSINP                                         0820 03223000
         L     @08,IOCDAD(,@08)                                    0820 03224000
         L     @04,IOCSOUP                                         0820 03225000
         L     @04,IOCDAD(,@04)                                    0820 03226000
         CLC   DEVCLASS(2,@08),DEVCLASS(@04)                       0820 03227000
         BE    @RF00820                                            0820 03228000
*               DO;                                        /*@Y30SSEC*/ 03229000
*                 DARGDBP = ADDR(CDEVTYP);                 /*@Y30SSEC*/ 03230000
         L     @08,DDSTRU                                          0822 03231000
         LA    @04,CDEVTYP                                         0822 03232000
         ST    @04,DARGDBP(,@08)                                   0822 03233000
*                 DARGILP = LENGTH(CDEVTYP);               /*@Y30SSEC*/ 03234000
*                                                                  0823 03235000
         MVC   DARGILP(2,@08),@CH00156                             0823 03236000
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);    /*@Y30SSEC*/ 03237000
*                                                                  0824 03238000
         L     @08,@PC00001                                        0824 03239000
         ST    @08,@AL00001                                        0824 03240000
         LA    @04,@CF00115                                        0824 03241000
         ST    @04,@AL00001+4                                      0824 03242000
         LA    @04,DDSTRU                                          0824 03243000
         ST    @04,@AL00001+8                                      0824 03244000
         MVI   @AL00001+8,X'80'                                    0824 03245000
         L     @15,GDTPRT(,@08)                                    0824 03246000
         LA    @01,@AL00001                                        0824 03247000
         BALR  @14,@15                                             0824 03248000
*                 END;                                     /*@Y30SSEC*/ 03249000
*                                                                  0825 03250000
*            END;                                          /*@OZ00751*/ 03251000
*                                                                  0826 03252000
*          ELSE                                                    0827 03253000
*            IF TESTRC = 0                                         0827 03254000
*              THEN DO;                                    /*@OZ20462*/ 03255000
         B     @RC00808                                            0827 03256000
@RF00808 LH    @08,TESTRC                                          0827 03257000
         LTR   @08,@08                                             0827 03258000
         BNZ   @RF00827                                            0827 03259000
*                CALL CATRANS;                             /*@OZ00751*/ 03260000
*                                                                  0829 03261000
         BAL   @14,CATRANS                                         0829 03262000
*        /************************************************************/ 03263000
*        /*                                                  @OZ20462*/ 03264000
*        /* DETERMINE THE NEXT AVAILABLE CI IN AN EMPTY      @OZ20462*/ 03265000
*        /* CATALOG FOR THE OUTPUT DEVICE AS FOLLOWS:        @OZ20462*/ 03266000
*        /*  CI OF V RECORD (9) + 1 + NUMBER OF BIT MAP      @OZ20462*/ 03267000
*        /*  GROUP CODES (GC5) IN V RECORD                   @OZ20462*/ 03268000
*        /*                                                  @OZ20462*/ 03269000
*        /************************************************************/ 03270000
*                                                                  0830 03271000
*                EMPTYCI = 10;                             /*@OZ20462*/ 03272000
         MVI   EMPTYCI,X'0A'                                       0830 03273000
*                IOCSPTR = IOCSOUP;                        /*@OZ20462*/ 03274000
         L     @08,IOCSOUP                                         0831 03275000
         ST    @08,IOCSPTR                                         0831 03276000
*                RFY RREC RSTD;                            /*@OZ20462*/ 03277000
*                                                                  0832 03278000
*        /************************************************************/ 03279000
*        /*                                                  @OZ20462*/ 03280000
*        /* ESTABLISH THE NUMBER OF BIT MAP CIS BY           @OZ20462*/ 03281000
*        /* COUNTING THE GROUP CODE 5'S IN THE OUTPUT        @OZ20462*/ 03282000
*        /* CATALOG VOLUME RECORD                            @OZ20462*/ 03283000
*        /*                                                  @OZ20462*/ 03284000
*        /************************************************************/ 03285000
*                                                                  0833 03286000
*                RREC = IOCDAD + NREPLF; /*PT PAST FIXED FLDS@OZ20462*/ 03287000
         L     @08,IOCDAD(,@08)                                    0833 03288000
         SLR   RREC,RREC                                           0833 03289000
         IC    RREC,NREPLF(,@08)                                   0833 03290000
         ALR   RREC,@08                                            0833 03291000
*                RFY VARFIELD BASED(RREC);                 /*@OZ20462*/ 03292000
*                DO I = 1 TO NREPCV;     /*PT PAST VAR FLDS  @OZ20462*/ 03293000
         LA    I,1                                                 0835 03294000
         B     @DE00835                                            0835 03295000
@DL00835 DS    0H                                                  0836 03296000
*                  RREC = RREC + VARLEN + LENGTH(VARLEN);  /*@OZ20462*/ 03297000
         LR    @08,RREC                                            0836 03298000
         AH    @08,VARLEN(,RREC)                                   0836 03299000
         AL    @08,@CF00153                                        0836 03300000
         LR    RREC,@08                                            0836 03301000
*                END;                                      /*@OZ20462*/ 03302000
         AH    I,@CH00219                                          0837 03303000
@DE00835 L     @08,IOCSPTR                                         0837 03304000
         L     @08,IOCDAD(,@08)                                    0837 03305000
         MVC   @ZT00003+3(1),NREPCV(@08)                           0837 03306000
         C     I,@ZT00003                                          0837 03307000
         BNH   @DL00835                                            0837 03308000
*                RFY REPCNTRL BASED(RREC);                 /*@OZ20462*/ 03309000
*                GOPLEN = LENGTH(CATGOPT) -                /*@OZ20462*/ 03310000
*                  LENGTH(CATGOSEQ) + LENGTH(CATSN);       /*@OZ20462*/ 03311000
         LA    GOPLEN,6                                            0839 03312000
*                                        /*SET VOL GOP LEN   @OZ20462*/ 03313000
*                GOSTART = GOPLEN*REPCNT +                 /*@OZ20462*/ 03314000
*                  ADDR(REPGOPT(1));                       /*@OZ20462*/ 03315000
         SLR   @01,@01                                             0840 03316000
         IC    @01,REPCNT(,RREC)                                   0840 03317000
         MR    @00,GOPLEN                                          0840 03318000
         LA    GOSTART,REPGOPT(,RREC)                              0840 03319000
         ALR   @01,GOSTART                                         0840 03320000
         LR    GOSTART,@01                                         0840 03321000
*                L = GOSTART - GOPLEN;   /*SCAN GOPS FOR     @OZ20462*/ 03322000
         LR    L,GOSTART                                           0841 03323000
         SLR   L,GOPLEN                                            0841 03324000
*                                        /*GC5'S             @OZ20462*/ 03325000
*                DO RREC = ADDR(REPGOPT) TO L BY GOPLEN;   /*@OZ20462*/ 03326000
         LA    @08,REPGOPT(,RREC)                                  0842 03327000
         LR    RREC,@08                                            0842 03328000
         B     @DE00842                                            0842 03329000
@DL00842 DS    0H                                                  0843 03330000
*                  RFY CATGOPT BASED(RREC);                /*@OZ20462*/ 03331000
*                  IF CATGOGC = '0101'B THEN               /*@OZ20462*/ 03332000
         TM    CATGOGC(RREC),B'00000101'                           0844 03333000
         BNO   @RF00844                                            0844 03334000
         TM    CATGOGC(RREC),B'00001010'                           0844 03335000
         BNZ   @RF00844                                            0844 03336000
*                    EMPTYCI = EMPTYCI + 1;                /*@OZ20462*/ 03337000
         IC    @08,EMPTYCI                                         0845 03338000
         LA    @08,1(,@08)                                         0845 03339000
         STC   @08,EMPTYCI                                         0845 03340000
*                END;                                      /*@OZ20462*/ 03341000
*                                                                  0846 03342000
@RF00844 ALR   RREC,GOPLEN                                         0846 03343000
@DE00842 CR    RREC,L                                              0846 03344000
         BNH   @DL00842                                            0846 03345000
*        /************************************************************/ 03346000
*        /*                                                  @OZ20462*/ 03347000
*        /* IF THE NEXT AVAILABLE CI JUST DETERMINED         @OZ20462*/ 03348000
*        /* MATCHES THE ACTUAL OUTPUT CATALOG NEXT           @OZ20462*/ 03349000
*        /* AVAILABLE CI, THEN THE CATALOG IS EMPTY          @OZ20462*/ 03350000
*        /*                                                  @OZ20462*/ 03351000
*        /************************************************************/ 03352000
*                                                                  0847 03353000
*                IF OCCRNFCI = EMPTYCI THEN                /*@OZ20462*/ 03354000
         CLC   OCCRNFCI(1),EMPTYCI                                 0847 03355000
         BNE   @RF00847                                            0847 03356000
*                  EMPTYSW = ON;                           /*@OZ20462*/ 03357000
         OI    EMPTYSW,B'10000000'                                 0848 03358000
*                IOCSPTR = IOCSINP;                        /*@OZ20462*/ 03359000
@RF00847 MVC   IOCSPTR(4),IOCSINP                                  0849 03360000
*                RFY RREC UNRSTD;                          /*@OZ20462*/ 03361000
*            END;                                          /*@OZ20462*/ 03362000
*                                                                  0851 03363000
*        /************************************************************/ 03364000
*        /*                                                  @OZ00751*/ 03365000
*        /* IF THE RETURN CODE FROM ANY READ WAS NONE ZERO   @OZ00751*/ 03366000
*        /* THEN TERMINAL ERROR SHOULD BE SIGNALLED          @OZ00751*/ 03367000
*        /*                                                          */ 03368000
*        /************************************************************/ 03369000
*                                                                  0852 03370000
*        IF GDTDBG = NULLPTR                                       0852 03371000
*          THEN;                                                   0852 03372000
@RF00827 DS    0H                                                  0852 03373000
@RC00808 L     @08,@PC00001                                        0852 03374000
         L     @08,GDTDBG(,@08)                                    0852 03375000
         LTR   @08,@08                                             0852 03376000
         BZ    @RT00852                                            0852 03377000
*          ELSE                                                    0854 03378000
*            CALL IDCDB010 (GDTTBL,'RPD1');                        0854 03379000
         L     @08,@PC00001                                        0854 03380000
         ST    @08,@AL00001                                        0854 03381000
         LA    @04,@CC01195                                        0854 03382000
         ST    @04,@AL00001+4                                      0854 03383000
         MVI   @AL00001+4,X'80'                                    0854 03384000
         L     @15,GDTDBG(,@08)                                    0854 03385000
         LA    @01,@AL00001                                        0854 03386000
         BALR  @14,@15                                             0854 03387000
*                                                          /*@OZ00751*/ 03388000
*                                                                  0855 03389000
*        IF TESTRC ^= 0                                            0855 03390000
*          THEN                                                    0855 03391000
@RT00852 LH    @08,TESTRC                                          0855 03392000
         LTR   @08,@08                                             0855 03393000
         BZ    @RF00855                                            0855 03394000
*            STATFLG = TERMERR;                            /*@OZ00751*/ 03395000
*                                                                  0856 03396000
         MVC   STATFLG(5),@CB00819                                 0856 03397000
*                                                                  0857 03398000
*/********************************************************************/ 03399000
*/*                                                          @OZ00751*/ 03400000
*/* THIS NEXT SECTION OF THE PROGRAM IS THE MAIN PROCESSING  @OZ00751*/ 03401000
*/* LOOP AND IS LEFT ONLY WHEN ALL RECORDS HAVE BEEN READ.   @OZ00751*/ 03402000
*/* A COPY OF THE BACKUP CATALOG IS MADE. I. E.              @OZ00751*/ 03403000
*/*   RECORDS ARE DELETED,ADDED OR UPDATED AS NECESSARY.     @OZ00751*/ 03404000
*/*                                                          @OZ00751*/ 03405000
*/********************************************************************/ 03406000
*                                                                  0857 03407000
*                                                                  0857 03408000
*      /**************************************************************/ 03409000
*      /*                                                    @OZ00751*/ 03410000
*      /* THE SOURCE AND/OR TARGET IS READ DEPENDING ON THE  @OZ00751*/ 03411000
*      /* VALUE OF READSW-- READS,READT AND READB MEAN       @OZ00751*/ 03412000
*      /* READ A BACKUP RECORD ONLY,READ A TARGET RECORD     @OZ00751*/ 03413000
*      /* ONLY,READ A BACKUP AND TARGET RECORD RESPECTIVELY. @OZ00751*/ 03414000
*      /*                                                    @OZ00751*/ 03415000
*      /**************************************************************/ 03416000
*                                                                  0857 03417000
*MAIN: DO WHILE STATFLG ^= TERMERR &                               0857 03418000
*                   EOFSW ^= EOF;                          /*@OZ00751*/ 03419000
*                                                                  0857 03420000
@RF00855 DS    0H                                                  0857 03421000
MAIN     B     @DE00857                                            0857 03422000
@DL00857 DS    0H                                                  0858 03423000
*        IF READSW = READS |                                       0858 03424000
*            READSW = READB                                        0858 03425000
*                                                                  0858 03426000
*          THEN                                                    0858 03427000
         CLI   READSW,X'01'                                        0858 03428000
         BE    @RT00858                                            0858 03429000
         CLI   READSW,X'03'                                        0858 03430000
         BNE   @RF00858                                            0858 03431000
@RT00858 DS    0H                                                  0859 03432000
*            DO;                                           /*@OZ00751*/ 03433000
*                                                                  0859 03434000
*            CALL SORSREAD;                                /*@OZ00751*/ 03435000
*                                                                  0860 03436000
         BAL   @14,SORSREAD                                        0860 03437000
*            IF TESTRC = 0                                         0861 03438000
*              THEN                                                0861 03439000
         LH    @08,TESTRC                                          0861 03440000
         LTR   @08,@08                                             0861 03441000
         BNZ   @RF00861                                            0861 03442000
*                CALL CATRANS;                             /*@OZ00751*/ 03443000
*                                                                  0862 03444000
*                                                                  0862 03445000
         BAL   @14,CATRANS                                         0862 03446000
*            END;                                          /*@OZ00751*/ 03447000
*                                                                  0863 03448000
@RF00861 DS    0H                                                  0864 03449000
*        IF READSW = READT |                                       0864 03450000
*            READSW = READB                                        0864 03451000
*          THEN                                                    0864 03452000
@RF00858 CLI   READSW,X'02'                                        0864 03453000
         BE    @RT00864                                            0864 03454000
         CLI   READSW,X'03'                                        0864 03455000
         BNE   @RF00864                                            0864 03456000
@RT00864 DS    0H                                                  0865 03457000
*            DO;                                           /*@OZ00751*/ 03458000
*                                                                  0865 03459000
*            CALL TARGREAD;                                /*@OZ00751*/ 03460000
*                                                                  0866 03461000
*                                                                  0866 03462000
         BAL   @14,TARGREAD                                        0866 03463000
*           END;                                           /*@OZ00751*/ 03464000
*                                                                  0867 03465000
*        /************************************************************/ 03466000
*        /*                                                          */ 03467000
*        /* IF A RECORD EXISTED ON THE TARGET CATALOG BUT    @OZ00751*/ 03468000
*        /* NOT ON THE SOURCE THEN IT SHOULD BE :            @OZ00751*/ 03469000
*        /* DELETED IF IT IS A TRUENAME RECORD OR---         @OZ00751*/ 03470000
*        /*MADE INTO A CATALOG FREE RECORD IF IT IS IN THE   @OZ00751*/ 03471000
*        /* LOW KEY RANGE.                                   @OZ00751*/ 03472000
*        /* A NEW TARGET RECORD IS READ AND THE COMPARE      @OZ00751*/ 03473000
*        /*  PROCEDURE IS CALLED.                            @OZ00751*/ 03474000
*        /*                                                  @OZ00751*/ 03475000
*        /************************************************************/ 03476000
*                                                                  0868 03477000
*        IF IOCSINP->IOCDAD->RCDKEYTY^=NULL &              /*@Y30SSSB*/ 03478000
*           IOCSINP -> IOCDAD -> RECKEY  >                         0868 03479000
*           IOCSOUP -> IOCDAD -> RECKEY                            0868 03480000
*                                                                  0868 03481000
*          THEN                                                    0868 03482000
@RF00864 L     @08,IOCSINP                                         0868 03483000
         L     @08,IOCDAD(,@08)                                    0868 03484000
         CLI   RCDKEYTY(@08),0                                     0868 03485000
         BE    @RF00868                                            0868 03486000
         L     @04,IOCSOUP                                         0868 03487000
         L     @04,IOCDAD(,@04)                                    0868 03488000
         CLC   RECKEY(44,@08),RECKEY(@04)                          0868 03489000
         BNH   @RF00868                                            0868 03490000
*            IF IOCSOUP -> IOCDAD -> RCDKEYTY ^= NULL              0869 03491000
*              THEN                                                0869 03492000
         CLI   RCDKEYTY(@04),0                                     0869 03493000
         BE    @RF00869                                            0869 03494000
*                DO;                                       /*@OZ00751*/ 03495000
*                /****************************************************/ 03496000
*                /*                                          @OZ00751*/ 03497000
*                /*  CALL THE COMPARE PROCEDURE .            @OZ00751*/ 03498000
*                /*                                          @OZ00751*/ 03499000
*                /****************************************************/ 03500000
*                                                                  0871 03501000
*                READSW = READT;                           /*@OZ00751*/ 03502000
         MVI   READSW,X'02'                                        0871 03503000
*                CALL CATCOMP;                             /*@OZ00751*/ 03504000
*                                                                  0872 03505000
         BAL   @14,CATCOMP                                         0872 03506000
*                IF IOPOSSW = 'I'                                  0873 03507000
*                  THEN                                            0873 03508000
         CLI   IOPOSSW,C'I'                                        0873 03509000
         BNE   @RF00873                                            0873 03510000
*                    DO;                                           0874 03511000
*                                                                  0874 03512000
*                    /************************************************/ 03513000
*                    /*                                      @OZ00751*/ 03514000
*                    /* IF THE LAST REQUEST WAS FOR AN INSERT@OZ00751*/ 03515000
*                    /* THEN THE INSERT RPL HAS TO BE        @OZ00751*/ 03516000
*                    /* QUIESCED AND THE UPDATE RPL          @OZ00751*/ 03517000
*                    /* REPOSITIONED.                        @OZ00751*/ 03518000
*                    /*                                      @OZ00751*/ 03519000
*                    /************************************************/ 03520000
*                                                                  0875 03521000
*                    REG1 = IOCSOUT -> IOCEXT -> IOCRPL;   /*@OZ00751*/ 03522000
         L     @08,IOCSOUT                                         0875 03523000
         L     @08,IOCEXT(,@08)                                    0875 03524000
         L     REG1,IOCRPL(,@08)                                   0875 03525000
*                    GEN(ENDREQ RPL=(1) );                 /*@OZ00751*/ 03526000
*                                                                  0876 03527000
         ENDREQ RPL=(1)                                                 03528000
*                    IOCSOUP -> IOCKYA = ADDR(CURRKEYT);   /*@OZ00751*/ 03529000
         LA    @08,CURRKEYT                                        0877 03530000
         L     @04,IOCSOUP                                         0877 03531000
         ST    @08,IOCKYA(,@04)                                    0877 03532000
*                    CALL IDCIOPO0 (GDTTBL,IOCSOUP);       /*@OZ00751*/ 03533000
         L     @08,@PC00001                                        0878 03534000
         ST    @08,@AL00001                                        0878 03535000
         LA    @04,IOCSOUP                                         0878 03536000
         ST    @04,@AL00001+4                                      0878 03537000
         MVI   @AL00001+4,X'80'                                    0878 03538000
         L     @15,GDTPOS(,@08)                                    0878 03539000
         LA    @01,@AL00001                                        0878 03540000
         BALR  @14,@15                                             0878 03541000
*                    RESPECIFY RTNREG RSTD;                        0879 03542000
*                    TESTRC = RTNREG;                              0880 03543000
         STH   RTNREG,TESTRC                                       0880 03544000
*                    RESPECIFY RTNREG UNRSTD;              /*@OZ00751*/ 03545000
*                                                                  0881 03546000
*                    IF TESTRC = 0                                 0882 03547000
*                      THEN;                               /*@OZ00751*/ 03548000
         LH    @08,TESTRC                                          0882 03549000
         LTR   @08,@08                                             0882 03550000
         BZ    @RT00882                                            0882 03551000
*                      ELSE                                        0884 03552000
*                        STATFLG = TERMERR;                /*@OZ00751*/ 03553000
*                                                                  0884 03554000
         MVC   STATFLG(5),@CB00819                                 0884 03555000
*                    CALL IDCIOGT0   (GDTTBL,IOCSOUP);     /*@OZ00751*/ 03556000
@RT00882 L     @08,@PC00001                                        0885 03557000
         ST    @08,@AL00001                                        0885 03558000
         LA    @04,IOCSOUP                                         0885 03559000
         ST    @04,@AL00001+4                                      0885 03560000
         MVI   @AL00001+4,X'80'                                    0885 03561000
         L     @15,GDTGET(,@08)                                    0885 03562000
         LA    @01,@AL00001                                        0885 03563000
         BALR  @14,@15                                             0885 03564000
*                    RESPECIFY RTNREG RSTD;                        0886 03565000
*                    TESTRC = RTNREG;                              0887 03566000
         STH   RTNREG,TESTRC                                       0887 03567000
*                    RESPECIFY RTNREG UNRSTD;              /*@OZ00751*/ 03568000
*                                                                  0888 03569000
*                    IF TESTRC = 0                                 0889 03570000
*                      THEN;                               /*@OZ00751*/ 03571000
         LH    @08,TESTRC                                          0889 03572000
         LTR   @08,@08                                             0889 03573000
         BZ    @RT00889                                            0889 03574000
*                      ELSE                                        0891 03575000
*                        STATFLG = TERMERR;                /*@OZ00751*/ 03576000
*                                                                  0891 03577000
         MVC   STATFLG(5),@CB00819                                 0891 03578000
*                    END;                                  /*@OZ00751*/ 03579000
*                                                                  0892 03580000
@RT00889 DS    0H                                                  0893 03581000
*                /****************************************************/ 03582000
*                /*                                          @OZ00751*/ 03583000
*                /* DELETE THE TRUENAME AND SET THE LAST     @OZ00751*/ 03584000
*                /* OPERATION WAS UPDATE.                    @OZ00751*/ 03585000
*                /*                                          @OZ00751*/ 03586000
*                /****************************************************/ 03587000
*                                                                  0893 03588000
*                DMNAME1 = 'DLOUTREC';                     /*@OZ00751*/ 03589000
@RF00873 MVC   DMNAME1(8),@CC01201                                 0893 03590000
*                DMADDR1 = IOCSOUP -> IOCDAD;              /*@OZ00751*/ 03591000
*                                                                  0894 03592000
         L     @08,IOCSOUP                                         0894 03593000
         MVC   DMADDR1(4),IOCDAD(@08)                              0894 03594000
*                REG1 = IOCSOUP -> IOCEXT -> IOCRPL;       /*@OZ00751*/ 03595000
         L     @08,IOCEXT(,@08)                                    0895 03596000
         L     REG1,IOCRPL(,@08)                                   0895 03597000
*                GEN(ERASE RPL=(1) );                      /*@OZ00751*/ 03598000
         ERASE RPL=(1)                                                  03599000
*                RESPECIFY RTNREG RSTD;                            0897 03600000
*                TESTRC = RTNREG;                                  0898 03601000
         STH   RTNREG,TESTRC                                       0898 03602000
*                RESPECIFY RTNREG UNRSTD;                  /*@OZ00751*/ 03603000
*                                                                  0899 03604000
*                IF TESTRC = 0                                     0900 03605000
*                  THEN;                                   /*@OZ00751*/ 03606000
         LH    @08,TESTRC                                          0900 03607000
         LTR   @08,@08                                             0900 03608000
         BZ    @RT00900                                            0900 03609000
*                  ELSE                                            0902 03610000
*                    STATFLG = TERMERR;                    /*@OZ00751*/ 03611000
*                                                                  0902 03612000
         MVC   STATFLG(5),@CB00819                                 0902 03613000
*                IOPOSSW = 'U';                            /*@OZ00751*/ 03614000
*                                                                  0903 03615000
@RT00900 MVI   IOPOSSW,C'U'                                        0903 03616000
*                IOCSOUP -> IOCDAD = DMADDR1;              /*@OZ00751*/ 03617000
*                                                                  0904 03618000
         L     @08,IOCSOUP                                         0904 03619000
         MVC   IOCDAD(4,@08),DMADDR1                               0904 03620000
*                IF GDTDBG = NULLPTR                               0905 03621000
*                  THEN;                                   /*@OZ00751*/ 03622000
         L     @08,@PC00001                                        0905 03623000
         L     @08,GDTDBG(,@08)                                    0905 03624000
         LTR   @08,@08                                             0905 03625000
         BZ    @RT00905                                            0905 03626000
*                  ELSE                                            0907 03627000
*                    CALL DUMPIT;                          /*@OZ00751*/ 03628000
*                                                                  0907 03629000
         BAL   @14,DUMPIT                                          0907 03630000
*                IF TESTRC ^= 0                                    0908 03631000
*                  THEN                                            0908 03632000
@RT00905 LH    @08,TESTRC                                          0908 03633000
         LTR   @08,@08                                             0908 03634000
         BZ    @RF00908                                            0908 03635000
*                    STATFLG = TERMERR;                    /*@OZ00751*/ 03636000
*                                                                  0909 03637000
         MVC   STATFLG(5),@CB00819                                 0909 03638000
*                END;                                      /*@OZ00751*/ 03639000
*                                                                  0910 03640000
*              ELSE                                                0911 03641000
*                DO;                                       /*@OZ00751*/ 03642000
*                                                                  0911 03643000
         B     @RC00869                                            0911 03644000
@RF00869 DS    0H                                                  0912 03645000
*                /****************************************************/ 03646000
*                /*                                          @OZ00751*/ 03647000
*                /* MAKE A FREE RECORD OF THE TARGET RECORD  @OZ00751*/ 03648000
*                /*                                          @OZ00751*/ 03649000
*                /****************************************************/ 03650000
*                                                                  0912 03651000
*                IOCSPTR=IOCSOUP;                          /*@OZ00751*/ 03652000
*                                                                  0912 03653000
         L     @08,IOCSOUP                                         0912 03654000
         ST    @08,IOCSPTR                                         0912 03655000
*                CLEARA = ''B; /* CLEAR 1ST PART OF FREE REC @Y30SSEC*/ 03656000
         L     @04,IOCDAD(,@08)                                    0913 03657000
         XC    CLEARA(216,@04),CLEARA(@04)                         0913 03658000
*                CLEARB = ''B; /* CLEAR 2ND PART             @Y30SSEC*/ 03659000
*                                                                  0914 03660000
         XC    CLEARB(245,@04),CLEARB(@04)                         0914 03661000
*                RCDID= 'F';                               /*@OZ00751*/ 03662000
         MVI   RCDID(@04),C'F'                                     0915 03663000
*                CFRNEXT= CFROLD;                          /*@OZ00751*/ 03664000
         MVC   CFRNEXT+45(3,@04),CFROLD                            0916 03665000
*                CFROLD= RCDCINO;                          /*@OZ00751*/ 03666000
         MVC   CFROLD(3),RCDCINO(@04)                              0917 03667000
*                FREENUM= FREENUM + 1;                     /*@OZ00751*/ 03668000
*                                                                  0918 03669000
         LA    @04,1                                               0918 03670000
         AL    @04,FREENUM                                         0918 03671000
         ST    @04,FREENUM                                         0918 03672000
*                IOCSPTR = IOCSINP;                        /*@OZ00751*/ 03673000
*                                                                  0919 03674000
         MVC   IOCSPTR(4),IOCSINP                                  0919 03675000
*                READSW = READT;                           /*@OZ00751*/ 03676000
*                                                                  0920 03677000
         MVI   READSW,X'02'                                        0920 03678000
*                DMNAME1 = 'FUPOTREC';                     /*@OZ00751*/ 03679000
         MVC   DMNAME1(8),@CC01203                                 0921 03680000
*                DMADDR1 = IOCSOUP -> IOCDAD;              /*@OZ00751*/ 03681000
*                                                                  0922 03682000
         MVC   DMADDR1(4),IOCDAD(@08)                              0922 03683000
*                CALL IDCIOPT0 (GDTTBL,IOCSOUP);           /*@OZ00751*/ 03684000
         L     @08,@PC00001                                        0923 03685000
         ST    @08,@AL00001                                        0923 03686000
         LA    @04,IOCSOUP                                         0923 03687000
         ST    @04,@AL00001+4                                      0923 03688000
         MVI   @AL00001+4,X'80'                                    0923 03689000
         L     @15,GDTPUT(,@08)                                    0923 03690000
         LA    @01,@AL00001                                        0923 03691000
         BALR  @14,@15                                             0923 03692000
*                RESPECIFY RTNREG RSTD;                            0924 03693000
*                TESTRC = RTNREG;                                  0925 03694000
         STH   RTNREG,TESTRC                                       0925 03695000
*                RESPECIFY RTNREG UNRSTD;                  /*@OZ00751*/ 03696000
*                                                                  0926 03697000
*                IOCSOUP -> IOCDAD = DMADDR1;              /*@OZ00751*/ 03698000
*                                                                  0927 03699000
         L     @08,IOCSOUP                                         0927 03700000
         MVC   IOCDAD(4,@08),DMADDR1                               0927 03701000
*                IOPOSSW = 'U';                            /*@OZ00751*/ 03702000
*                                                                  0928 03703000
         MVI   IOPOSSW,C'U'                                        0928 03704000
*                IF GDTDBG = NULLPTR                               0929 03705000
*                  THEN;                                   /*@OZ00751*/ 03706000
         L     @08,@PC00001                                        0929 03707000
         L     @08,GDTDBG(,@08)                                    0929 03708000
         LTR   @08,@08                                             0929 03709000
         BZ    @RT00929                                            0929 03710000
*                  ELSE                                            0931 03711000
*                    CALL DUMPIT;                          /*@OZ00751*/ 03712000
*                                                                  0931 03713000
         BAL   @14,DUMPIT                                          0931 03714000
*                IF TESTRC ^= 0                                    0932 03715000
*                  THEN                                            0932 03716000
@RT00929 LH    @08,TESTRC                                          0932 03717000
         LTR   @08,@08                                             0932 03718000
         BZ    @RF00932                                            0932 03719000
*                    STATFLG = TERMERR;                    /*@OZ00751*/ 03720000
*                                                                  0933 03721000
         MVC   STATFLG(5),@CB00819                                 0933 03722000
*                END;                                      /*@OZ00751*/ 03723000
*                                                                  0934 03724000
@RF00932 DS    0H                                                  0935 03725000
*        /************************************************************/ 03726000
*        /*                                                  @OZ00751*/ 03727000
*        /* IF A RECORD EXISTS ON THE BACKUP CATALOG BUT NOT @OZ00751*/ 03728000
*        /* ON THE TARGET THEN IT SHOULD BE INSERTED INTO    @OZ00751*/ 03729000
*        /* THE TARGET,TRANSLATING THE CI #S IF NECESSARY.   @OZ00751*/ 03730000
*        /* A CATALOG COMPARE SHOULD BE DONE IF DESIRED AND  @OZ00751*/ 03731000
*        /* A NEW SOURE RECORD READ IS INDICATED.            @OZ00751*/ 03732000
*        /*                                                  @OZ00751*/ 03733000
*        /************************************************************/ 03734000
*                                                                  0935 03735000
*        IF IOCSOUP->IOCDAD->RCDKEYTY^=NULL &              /*@Y30SSSB*/ 03736000
*           IOCSINP -> IOCDAD -> RECKEY <                          0935 03737000
*           IOCSOUP -> IOCDAD -> RECKEY                            0935 03738000
*          THEN                                                    0935 03739000
@RC00869 DS    0H                                                  0935 03740000
@RF00868 L     @08,IOCSOUP                                         0935 03741000
         L     @08,IOCDAD(,@08)                                    0935 03742000
         CLI   RCDKEYTY(@08),0                                     0935 03743000
         BE    @RF00935                                            0935 03744000
         L     @04,IOCSINP                                         0935 03745000
         L     @04,IOCDAD(,@04)                                    0935 03746000
         CLC   RECKEY(44,@04),RECKEY(@08)                          0935 03747000
         BNL   @RF00935                                            0935 03748000
*            DO;                                           /*@OZ00751*/ 03749000
*                                                                  0936 03750000
*            READSW = READS;                               /*@OZ00751*/ 03751000
*                                                                  0937 03752000
         MVI   READSW,X'01'                                        0937 03753000
*            CALL CATCOMP;                                 /*@OZ00751*/ 03754000
*                                                                  0938 03755000
         BAL   @14,CATCOMP                                         0938 03756000
*            IF IOPOSSW = 'U'                                      0939 03757000
*              THEN                                                0939 03758000
         CLI   IOPOSSW,C'U'                                        0939 03759000
         BNE   @RF00939                                            0939 03760000
*                DO;                                       /*@OZ00751*/ 03761000
*                                                                  0940 03762000
*                /****************************************************/ 03763000
*                /*                                          @OZ00751*/ 03764000
*                /* IF THE LAST REQUEST WAS FOR AN UPDATE    @OZ00751*/ 03765000
*                /* THEN QUIESCE THE UPDATE RPL.             @OZ00751*/ 03766000
*                /*                                          @OZ00751*/ 03767000
*                /****************************************************/ 03768000
*                                                                  0941 03769000
*                REG1 = IOCSOUP -> IOCEXT -> IOCRPL;       /*@OZ00751*/ 03770000
         L     @08,IOCSOUP                                         0941 03771000
         L     @08,IOCEXT(,@08)                                    0941 03772000
         L     REG1,IOCRPL(,@08)                                   0941 03773000
*                GEN(ENDREQ RPL=(1) );                     /*@OZ00751*/ 03774000
*                                                                  0942 03775000
         ENDREQ RPL=(1)                                                 03776000
*                END;                                      /*@OZ00751*/ 03777000
*                                                                  0943 03778000
*            /********************************************************/ 03779000
*            /*                                              @OZ00751*/ 03780000
*            /* PERFORM THE INSERT AND SET THE LAST I/O      @OZ00751*/ 03781000
*            /* AS AN INSERT.                                @OZ00751*/ 03782000
*            /*                                              @OZ00751*/ 03783000
*            /********************************************************/ 03784000
*                                                                  0944 03785000
*            IOCSOUT -> IOCDAD = IOCDAD;                   /*@OZ00751*/ 03786000
@RF00939 L     @08,IOCSOUT                                         0944 03787000
         L     @04,IOCSPTR                                         0944 03788000
         L     @15,IOCDAD(,@04)                                    0944 03789000
         ST    @15,IOCDAD(,@08)                                    0944 03790000
*            IOCSOUT -> IOCDLN = IOCDLN;                   /*@OZ00751*/ 03791000
*                                                                  0945 03792000
         MVC   IOCDLN(4,@08),IOCDLN(@04)                           0945 03793000
*            DMNAME1 = 'INSOTREC';                         /*@OZ00751*/ 03794000
         MVC   DMNAME1(8),@CC01204                                 0946 03795000
*            DMADDR1 = IOCSOUT -> IOCDAD;                  /*@OZ00751*/ 03796000
*                                                                  0947 03797000
         ST    @15,@TF00001                                        0947 03798000
         MVC   DMADDR1(4),@TF00001                                 0947 03799000
*            CALL IDCIOPT0 (GDTTBL,IOCSOUT);               /*@OZ00751*/ 03800000
         L     @08,@PC00001                                        0948 03801000
         ST    @08,@AL00001                                        0948 03802000
         LA    @04,IOCSOUT                                         0948 03803000
         ST    @04,@AL00001+4                                      0948 03804000
         MVI   @AL00001+4,X'80'                                    0948 03805000
         L     @15,GDTPUT(,@08)                                    0948 03806000
         LA    @01,@AL00001                                        0948 03807000
         BALR  @14,@15                                             0948 03808000
*            RESPECIFY RTNREG RSTD;                                0949 03809000
*            TESTRC = RTNREG;                                      0950 03810000
         STH   RTNREG,TESTRC                                       0950 03811000
*            RESPECIFY RTNREG UNRSTD;                      /*@OZ00751*/ 03812000
*                                                                  0951 03813000
*            IOPOSSW = 'I';                                /*@OZ00751*/ 03814000
*                                                                  0952 03815000
         MVI   IOPOSSW,C'I'                                        0952 03816000
*            IF GDTDBG = NULLPTR                                   0953 03817000
*              THEN;                                       /*@OZ00751*/ 03818000
         L     @08,@PC00001                                        0953 03819000
         L     @08,GDTDBG(,@08)                                    0953 03820000
         LTR   @08,@08                                             0953 03821000
         BZ    @RT00953                                            0953 03822000
*              ELSE                                                0955 03823000
*                CALL DUMPIT;                              /*@OZ00751*/ 03824000
*                                                                  0955 03825000
         BAL   @14,DUMPIT                                          0955 03826000
*            IF TESTRC ^= 0                                        0956 03827000
*              THEN                                                0956 03828000
@RT00953 LH    @08,TESTRC                                          0956 03829000
         LTR   @08,@08                                             0956 03830000
         BZ    @RF00956                                            0956 03831000
*                STATFLG = TERMERR;                        /*@OZ00751*/ 03832000
*                                                                  0957 03833000
         MVC   STATFLG(5),@CB00819                                 0957 03834000
*            END;                                          /*@OZ00751*/ 03835000
*                                                                  0958 03836000
@RF00956 DS    0H                                                  0959 03837000
*        /************************************************************/ 03838000
*        /* IF A RECORD EXISTS ON BOTH BACKUP AND TARGET     @OZ00751*/ 03839000
*        /* THEN THE TARGET HAS TO BE UPDATED.               @OZ00751*/ 03840000
*        /*  A NEW BACKUP AND TARGET RECORD WILL             @OZ00751*/ 03841000
*        /* BE READ NEXT                                     @OZ00751*/ 03842000
*        /************************************************************/ 03843000
*                                                                  0959 03844000
*        IF ((IOCSINP->IOCDAD->RCDKEYTY=NULL &             /*@Y30SSSB*/ 03845000
*             IOCSOUP->IOCDAD->RCDKEYTY=NULL) |            /*@Y30SSSB*/ 03846000
*            IOCSINP -> IOCDAD -> RECKEY =                 /*@Y30SSSB*/ 03847000
*            IOCSOUP -> IOCDAD -> RECKEY) &                /*@Y30SSSB*/ 03848000
*           EOFSW  ^= EOF                                          0959 03849000
*          THEN                                                    0959 03850000
@RF00935 L     @08,IOCSINP                                         0959 03851000
         L     @08,IOCDAD(,@08)                                    0959 03852000
         CLI   RCDKEYTY(@08),0                                     0959 03853000
         BNE   @GL00066                                            0959 03854000
         L     @08,IOCSOUP                                         0959 03855000
         L     @08,IOCDAD(,@08)                                    0959 03856000
         CLI   RCDKEYTY(@08),0                                     0959 03857000
         BE    @GL00065                                            0959 03858000
@GL00066 L     @08,IOCSINP                                         0959 03859000
         L     @08,IOCDAD(,@08)                                    0959 03860000
         L     @04,IOCSOUP                                         0959 03861000
         L     @04,IOCDAD(,@04)                                    0959 03862000
         CLC   RECKEY(44,@08),RECKEY(@04)                          0959 03863000
         BNE   @RF00959                                            0959 03864000
@GL00065 CLC   EOFSW(2),@CH00162                                   0959 03865000
         BE    @RF00959                                            0959 03866000
*            DO;                                           /*@OZ00751*/ 03867000
*                                                                  0960 03868000
*            READSW = READB;                               /*@OZ00751*/ 03869000
*                                                                  0961 03870000
         MVI   READSW,X'03'                                        0961 03871000
*            IF IOPOSSW = 'I'                                      0962 03872000
*              THEN                                                0962 03873000
         CLI   IOPOSSW,C'I'                                        0962 03874000
         BNE   @RF00962                                            0962 03875000
*                DO;                                       /*@OZ00751*/ 03876000
*                                                                  0963 03877000
*                /****************************************************/ 03878000
*                /*                                          @OZ00751*/ 03879000
*                /* IF THE LAST REQUEST WAS FOR AN INSERT    @OZ00751*/ 03880000
*                /* THEN THE INSERT RPL HAS TO BE            @OZ00751*/ 03881000
*                /* QUIESCED AND THE UPDATE RPL              @OZ00751*/ 03882000
*                /* REPOSITIONED.                            @OZ00751*/ 03883000
*                /*                                          @OZ00751*/ 03884000
*                /****************************************************/ 03885000
*                                                                  0964 03886000
*                REG1 = IOCSOUT -> IOCEXT -> IOCRPL;       /*@OZ00751*/ 03887000
         L     @08,IOCSOUT                                         0964 03888000
         L     @08,IOCEXT(,@08)                                    0964 03889000
         L     REG1,IOCRPL(,@08)                                   0964 03890000
*                GEN(ENDREQ RPL=(1) );                     /*@OZ00751*/ 03891000
*                                                                  0965 03892000
         ENDREQ RPL=(1)                                                 03893000
*                IOCSOUP -> IOCKYA = ADDR(CURRKEYT);       /*@OZ00751*/ 03894000
         LA    @08,CURRKEYT                                        0966 03895000
         L     @04,IOCSOUP                                         0966 03896000
         ST    @08,IOCKYA(,@04)                                    0966 03897000
*                CALL IDCIOPO0 (GDTTBL,IOCSOUP);           /*@OZ00751*/ 03898000
         L     @08,@PC00001                                        0967 03899000
         ST    @08,@AL00001                                        0967 03900000
         LA    @04,IOCSOUP                                         0967 03901000
         ST    @04,@AL00001+4                                      0967 03902000
         MVI   @AL00001+4,X'80'                                    0967 03903000
         L     @15,GDTPOS(,@08)                                    0967 03904000
         LA    @01,@AL00001                                        0967 03905000
         BALR  @14,@15                                             0967 03906000
*                RESPECIFY RTNREG RSTD;                            0968 03907000
*                TESTRC = RTNREG;                                  0969 03908000
         STH   RTNREG,TESTRC                                       0969 03909000
*                RESPECIFY RTNREG UNRSTD;                  /*@OZ00751*/ 03910000
*                                                                  0970 03911000
*                IF TESTRC = 0                                     0971 03912000
*                  THEN;                                   /*@OZ00751*/ 03913000
         LH    @08,TESTRC                                          0971 03914000
         LTR   @08,@08                                             0971 03915000
         BZ    @RT00971                                            0971 03916000
*                  ELSE                                            0973 03917000
*                    STATFLG = TERMERR;                    /*@OZ00751*/ 03918000
*                                                                  0973 03919000
         MVC   STATFLG(5),@CB00819                                 0973 03920000
*                CALL IDCIOGT0   (GDTTBL,IOCSOUP);         /*@OZ00751*/ 03921000
@RT00971 L     @08,@PC00001                                        0974 03922000
         ST    @08,@AL00001                                        0974 03923000
         LA    @04,IOCSOUP                                         0974 03924000
         ST    @04,@AL00001+4                                      0974 03925000
         MVI   @AL00001+4,X'80'                                    0974 03926000
         L     @15,GDTGET(,@08)                                    0974 03927000
         LA    @01,@AL00001                                        0974 03928000
         BALR  @14,@15                                             0974 03929000
*                RESPECIFY RTNREG RSTD;                            0975 03930000
*                TESTRC = RTNREG;                                  0976 03931000
         STH   RTNREG,TESTRC                                       0976 03932000
*                RESPECIFY RTNREG UNRSTD;                  /*@OZ00751*/ 03933000
*                                                                  0977 03934000
*                IF TESTRC = 0                                     0978 03935000
*                  THEN;                                   /*@OZ00751*/ 03936000
         LH    @08,TESTRC                                          0978 03937000
         LTR   @08,@08                                             0978 03938000
         BZ    @RT00978                                            0978 03939000
*                  ELSE                                            0980 03940000
*                    STATFLG = TERMERR;                    /*@OZ00751*/ 03941000
*                                                                  0980 03942000
         MVC   STATFLG(5),@CB00819                                 0980 03943000
*                END;                                      /*@OZ00751*/ 03944000
*                                                                  0981 03945000
@RT00978 DS    0H                                                  0982 03946000
*            IF  IOCSINP -> IOCDLN = 47                            0982 03947000
*              THEN                                                0982 03948000
@RF00962 L     @08,IOCSINP                                         0982 03949000
         CLC   IOCDLN(4,@08),@CF01205                              0982 03950000
         BNE   @RF00982                                            0982 03951000
*                IOCSOUP -> IOCDAD -> CATLREC(1:47) =              0983 03952000
*                IOCSINP -> IOCDAD -> CATLREC(1:47);       /*@OZ00751*/ 03953000
         L     @04,IOCSOUP                                         0983 03954000
         L     @04,IOCDAD(,@04)                                    0983 03955000
         L     @08,IOCDAD(,@08)                                    0983 03956000
         MVC   CATLREC(47,@04),CATLREC(@08)                        0983 03957000
*              ELSE                                                0984 03958000
*                IF EMPTYSW = ON & IOCSOUP -> IOCDAD ->            0984 03959000
*                    RCDCINO < EMPTYCI                     /*@OZ20462*/ 03960000
*                    & (IOCSOUP -> IOCDAD -> RCDID = 'V'           0984 03961000
*                    | IOCSOUP -> IOCDAD -> RCDID = 'W' )  /*@OZ17949*/ 03962000
*                  THEN;                                   /*@OZ00751*/ 03963000
         B     @RC00982                                            0984 03964000
@RF00982 TM    EMPTYSW,B'10000000'                                 0984 03965000
         BNO   @RF00984                                            0984 03966000
         L     @08,IOCSOUP                                         0984 03967000
         L     @08,IOCDAD(,@08)                                    0984 03968000
         MVC   @ZT00001+1(3),RCDCINO(@08)                          0984 03969000
         L     @04,@ZT00001                                        0984 03970000
         MVC   @ZT00003+3(1),EMPTYCI                               0984 03971000
         C     @04,@ZT00003                                        0984 03972000
         BNL   @RF00984                                            0984 03973000
         CLI   RCDID(@08),C'V'                                     0984 03974000
         BE    @RT00984                                            0984 03975000
         CLI   RCDID(@08),C'W'                                     0984 03976000
         BE    @RT00984                                            0984 03977000
*                  ELSE                                    /*@OZ17081*/ 03978000
*                    IF IOCSINP->IOCDAD->RECKEY=                   0986 03979000
*                       IOCSOUP->IOCDAD->RECKEY THEN               0986 03980000
@RF00984 L     @08,IOCSINP                                         0986 03981000
         L     @08,IOCDAD(,@08)                                    0986 03982000
         L     @04,IOCSOUP                                         0986 03983000
         L     @04,IOCDAD(,@04)                                    0986 03984000
         CLC   RECKEY(44,@08),RECKEY(@04)                          0986 03985000
         BNE   @RF00986                                            0986 03986000
*                                       /*DO FULL KEYS MATCH @Y30SSSB*/ 03987000
*                      DO;              /*YES                @Y30SSSB*/ 03988000
*                                                                  0987 03989000
*                        IOCSOUP -> IOCDAD -> CATLREC(1:255) =     0988 03990000
*                        IOCSINP->IOCDAD -> CATLREC(1:255);/*@Y30SSSB*/ 03991000
         MVC   CATLREC(255,@04),CATLREC(@08)                       0988 03992000
*                        IOCSOUP -> IOCDAD -> CATLREC(256:505) =   0989 03993000
*                        IOCSINP->IOCDAD->CATLREC(256:505);/*@Y30SSSB*/ 03994000
*                                                                  0989 03995000
         MVC   CATLREC+255(250,@04),CATLREC+255(@08)               0989 03996000
*                      END;                                /*@Y30SSSB*/ 03997000
*                                                                  0990 03998000
*           IF IOCSINP -> IOCDLN ^= 47 & EMPTYSW = ON &            0991 03999000
*              IOCSOUP -> IOCDAD -> RCDCINO < EMPTYCI      /*@OZ20462*/ 04000000
*              & (IOCSOUP -> IOCDAD -> RCDID = 'V'                 0991 04001000
*                   | IOCSOUP -> IOCDAD -> RCDID = 'W' )           0991 04002000
*              THEN;                                       /*@OZ17081*/ 04003000
@RF00986 DS    0H                                                  0991 04004000
@RT00984 DS    0H                                                  0991 04005000
@RC00982 L     @08,IOCSINP                                         0991 04006000
         CLC   IOCDLN(4,@08),@CF01205                              0991 04007000
         BE    @RF00991                                            0991 04008000
         TM    EMPTYSW,B'10000000'                                 0991 04009000
         BNO   @RF00991                                            0991 04010000
         L     @08,IOCSOUP                                         0991 04011000
         L     @08,IOCDAD(,@08)                                    0991 04012000
         MVC   @ZT00001+1(3),RCDCINO(@08)                          0991 04013000
         L     @04,@ZT00001                                        0991 04014000
         MVC   @ZT00003+3(1),EMPTYCI                               0991 04015000
         C     @04,@ZT00003                                        0991 04016000
         BNL   @RF00991                                            0991 04017000
         CLI   RCDID(@08),C'V'                                     0991 04018000
         BE    @RT00991                                            0991 04019000
         CLI   RCDID(@08),C'W'                                     0991 04020000
         BE    @RT00991                                            0991 04021000
*           ELSE                                                   0993 04022000
*             DO;                                          /*@OZ17081*/ 04023000
@RF00991 DS    0H                                                  0994 04024000
*            IF IOCSINP->IOCDAD->RECKEY^=                          0994 04025000
*               IOCSOUP->IOCDAD->RECKEY THEN /*DO FULL KEYS MATCH  0994 04026000
*                                                            @Y30SSSB*/ 04027000
         L     @08,IOCSINP                                         0994 04028000
         L     @08,IOCDAD(,@08)                                    0994 04029000
         L     @04,IOCSOUP                                         0994 04030000
         L     @15,IOCDAD(,@04)                                    0994 04031000
         CLC   RECKEY(44,@08),RECKEY(@15)                          0994 04032000
         BE    @RF00994                                            0994 04033000
*              DO;                           /*NO            @Y30SSSB*/ 04034000
*                /* DELETE THE RECORD FROM THE TARGET & THEN @Y30SSSB*/ 04035000
*                /* INSERT THE RECORD FROM THE SOURCE.       @Y30SSSB*/ 04036000
*                /* SET LAST OPERATION TO INSERT.            @Y30SSSB*/ 04037000
*                DMNAME1 = 'DLOUTREC';                     /*@Y30SSSB*/ 04038000
         MVC   DMNAME1(8),@CC01201                                 0996 04039000
*                DMADDR1 = IOCSOUP -> IOCDAD;              /*@Y30SSSB*/ 04040000
*                                                                  0997 04041000
         ST    @15,@TF00001                                        0997 04042000
         MVC   DMADDR1(4),@TF00001                                 0997 04043000
*                REG1 = IOCSOUP -> IOCEXT -> IOCRPL;       /*@Y30SSSB*/ 04044000
         L     @08,IOCEXT(,@04)                                    0998 04045000
         L     REG1,IOCRPL(,@08)                                   0998 04046000
*                GEN(ERASE RPL=(1) );                      /*@Y30SSSB*/ 04047000
         ERASE RPL=(1)                                                  04048000
*                RESPECIFY RTNREG RSTD;                            1000 04049000
*                TESTRC = RTNREG;                                  1001 04050000
         STH   RTNREG,TESTRC                                       1001 04051000
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSSB*/ 04052000
*                                                                  1002 04053000
*                IF TESTRC = 0                                     1003 04054000
*                  THEN;                                   /*@Y30SSSB*/ 04055000
         LH    @08,TESTRC                                          1003 04056000
         LTR   @08,@08                                             1003 04057000
         BZ    @RT01003                                            1003 04058000
*                  ELSE                                            1005 04059000
*                    STATFLG = TERMERR;                    /*@Y30SSSB*/ 04060000
*                                                                  1005 04061000
         MVC   STATFLG(5),@CB00819                                 1005 04062000
*                IOPOSSW = 'U';                            /*@Y30SSSB*/ 04063000
*                                                                  1006 04064000
@RT01003 MVI   IOPOSSW,C'U'                                        1006 04065000
*                IOCSOUP -> IOCDAD = DMADDR1;              /*@Y30SSSB*/ 04066000
*                                                                  1007 04067000
         L     @08,IOCSOUP                                         1007 04068000
         MVC   IOCDAD(4,@08),DMADDR1                               1007 04069000
*                IF TESTRC=0 THEN            /*I/O ERROR     @Y30SSSB*/ 04070000
         LH    @04,TESTRC                                          1008 04071000
         LTR   @04,@04                                             1008 04072000
         BNZ   @RF01008                                            1008 04073000
*                  DO;                       /* NO           @Y30SSSB*/ 04074000
*                                                                  1009 04075000
*                    /* QUIESCE THE UPDATE RPL               @Y30SSSB*/ 04076000
*                                                                  1010 04077000
*                    REG1 = IOCSOUP -> IOCEXT -> IOCRPL;   /*@Y30SSSB*/ 04078000
         L     @08,IOCEXT(,@08)                                    1010 04079000
         L     REG1,IOCRPL(,@08)                                   1010 04080000
*                    GEN(ENDREQ RPL=(1) );                 /*@Y30SSSB*/ 04081000
*                                                                  1011 04082000
         ENDREQ RPL=(1)                                                 04083000
*                    /* PERFORM THE INSERT AND SET LAST I/O  @Y30SSSB*/ 04084000
*                    /* AS AN INSERT.                        @Y30SSSB*/ 04085000
*                                                                  1012 04086000
*                    IOCSOUT -> IOCDAD = IOCDAD;           /*@Y30SSSB*/ 04087000
         L     @08,IOCSOUT                                         1012 04088000
         L     @04,IOCSPTR                                         1012 04089000
         L     @15,IOCDAD(,@04)                                    1012 04090000
         ST    @15,IOCDAD(,@08)                                    1012 04091000
*                    IOCSOUT -> IOCDLN = IOCDLN;           /*@Y30SSSB*/ 04092000
*                                                                  1013 04093000
         MVC   IOCDLN(4,@08),IOCDLN(@04)                           1013 04094000
*                    DMNAME1 = 'INSOTREC';                 /*@Y30SSSB*/ 04095000
         MVC   DMNAME1(8),@CC01204                                 1014 04096000
*                    DMADDR1 = IOCSOUT -> IOCDAD;          /*@Y30SSSB*/ 04097000
*                                                                  1015 04098000
         ST    @15,@TF00001                                        1015 04099000
         MVC   DMADDR1(4),@TF00001                                 1015 04100000
*                    CALL IDCIOPT0 (GDTTBL,IOCSOUT);       /*@Y30SSSB*/ 04101000
         L     @08,@PC00001                                        1016 04102000
         ST    @08,@AL00001                                        1016 04103000
         LA    @04,IOCSOUT                                         1016 04104000
         ST    @04,@AL00001+4                                      1016 04105000
         MVI   @AL00001+4,X'80'                                    1016 04106000
         L     @15,GDTPUT(,@08)                                    1016 04107000
         LA    @01,@AL00001                                        1016 04108000
         BALR  @14,@15                                             1016 04109000
*                    RESPECIFY RTNREG RSTD;                        1017 04110000
*                    TESTRC = RTNREG;                              1018 04111000
         STH   RTNREG,TESTRC                                       1018 04112000
*                    RESPECIFY RTNREG UNRSTD;              /*@Y30SSSB*/ 04113000
*                                                                  1019 04114000
*                    IOPOSSW = 'I';                        /*@Y30SSSB*/ 04115000
         MVI   IOPOSSW,C'I'                                        1020 04116000
*                    IF TESTRC=0 THEN        /*I/O ERROR     @Y30SSSB*/ 04117000
         LH    @08,TESTRC                                          1021 04118000
         LTR   @08,@08                                             1021 04119000
         BNZ   @RF01021                                            1021 04120000
*                      DO;                   /* NO           @Y30SSSB*/ 04121000
*                                                                  1022 04122000
*                        /* QUIESCE THE INSERT RPL AND       @Y30SSSB*/ 04123000
*                        /* REPOSITION THE UPDATE RPL        @Y30SSSB*/ 04124000
*                                                                  1023 04125000
*                        REG1=IOCSOUT->IOCEXT->IOCRPL;     /*@Y30SSSB*/ 04126000
         L     @08,IOCSOUT                                         1023 04127000
         L     @08,IOCEXT(,@08)                                    1023 04128000
         L     REG1,IOCRPL(,@08)                                   1023 04129000
*                        GEN(ENDREQ RPL=(1) );             /*@Y30SSSB*/ 04130000
*                                                                  1024 04131000
         ENDREQ RPL=(1)                                                 04132000
*                        CURRKEYT=IOCSINP->IOCDAD->                1025 04133000
*                         CATLREC(1:44);                   /*@Y30SSSB*/ 04134000
*                                                                  1025 04135000
         L     @08,IOCSINP                                         1025 04136000
         L     @08,IOCDAD(,@08)                                    1025 04137000
         MVC   CURRKEYT(44),CATLREC(@08)                           1025 04138000
*                        IOCSOUP->IOCKYA=ADDR(CURRKEYT);   /*@Y30SSSB*/ 04139000
         LA    @08,CURRKEYT                                        1026 04140000
         L     @04,IOCSOUP                                         1026 04141000
         ST    @08,IOCKYA(,@04)                                    1026 04142000
*                        CALL IDCIOPO0 (GDTTBL,IOCSOUP);   /*@Y30SSSB*/ 04143000
         L     @08,@PC00001                                        1027 04144000
         ST    @08,@AL00001                                        1027 04145000
         LA    @04,IOCSOUP                                         1027 04146000
         ST    @04,@AL00001+4                                      1027 04147000
         MVI   @AL00001+4,X'80'                                    1027 04148000
         L     @15,GDTPOS(,@08)                                    1027 04149000
         LA    @01,@AL00001                                        1027 04150000
         BALR  @14,@15                                             1027 04151000
*                        RESPECIFY RTNREG RSTD;                    1028 04152000
*                        TESTRC = RTNREG;                          1029 04153000
         STH   RTNREG,TESTRC                                       1029 04154000
*                        RESPECIFY RTNREG UNRSTD;          /*@Y30SSSB*/ 04155000
*                                                                  1030 04156000
*                        IF TESTRC=0 THEN    /*I/O ERROR     @Y30SSSB*/ 04157000
         LH    @08,TESTRC                                          1031 04158000
         LTR   @08,@08                                             1031 04159000
         BNZ   @RF01031                                            1031 04160000
*                          DO;               /* NO           @Y30SSSB*/ 04161000
*                                                                  1032 04162000
*                            CALL IDCIOGT0   (GDTTBL,IOCSOUP);/*   1033 04163000
*                                                            @Y30SSSB*/ 04164000
         L     @08,@PC00001                                        1033 04165000
         ST    @08,@AL00001                                        1033 04166000
         LA    @04,IOCSOUP                                         1033 04167000
         ST    @04,@AL00001+4                                      1033 04168000
         MVI   @AL00001+4,X'80'                                    1033 04169000
         L     @15,GDTGET(,@08)                                    1033 04170000
         LA    @01,@AL00001                                        1033 04171000
         BALR  @14,@15                                             1033 04172000
*                            RESPECIFY RTNREG RSTD;                1034 04173000
*                            TESTRC = RTNREG;                      1035 04174000
         STH   RTNREG,TESTRC                                       1035 04175000
*                            RESPECIFY RTNREG UNRSTD;      /*@Y30SSSB*/ 04176000
*                                                                  1036 04177000
*                          END;                            /*@Y30SSSB*/ 04178000
*                        IOPOSSW='U';                      /*@Y30SSSB*/ 04179000
@RF01031 MVI   IOPOSSW,C'U'                                        1038 04180000
*                      END;                                /*@Y30SSSB*/ 04181000
*                  END;                                    /*@Y30SSSB*/ 04182000
*              END;                                        /*@Y30SSSB*/ 04183000
*            ELSE                       /*FULL KEYS DO MATCH @Y30SSSB*/ 04184000
*              DO;                                         /*@Y30SSSB*/ 04185000
*                                                                  1042 04186000
         B     @RC00994                                            1042 04187000
@RF00994 DS    0H                                                  1043 04188000
*                /* UPDATE THE TRUENAME AND SET THE LAST     @Y30SSSB*/ 04189000
*                /* OPERATION WAS UPDATE.                    @Y30SSSB*/ 04190000
*                                                                  1043 04191000
*                DMNAME1 = 'UPOUTREC';                     /*@Y30SSSB*/ 04192000
         MVC   DMNAME1(8),@CC01207                                 1043 04193000
*                DMADDR1 = IOCSOUP -> IOCDAD;              /*@Y30SSSB*/ 04194000
*                                                                  1044 04195000
         L     @08,IOCSOUP                                         1044 04196000
         MVC   DMADDR1(4),IOCDAD(@08)                              1044 04197000
*                CALL IDCIOPT0 (GDTTBL,IOCSOUP);           /*@Y30SSSB*/ 04198000
         L     @08,@PC00001                                        1045 04199000
         ST    @08,@AL00001                                        1045 04200000
         LA    @04,IOCSOUP                                         1045 04201000
         ST    @04,@AL00001+4                                      1045 04202000
         MVI   @AL00001+4,X'80'                                    1045 04203000
         L     @15,GDTPUT(,@08)                                    1045 04204000
         LA    @01,@AL00001                                        1045 04205000
         BALR  @14,@15                                             1045 04206000
*                RESPECIFY RTNREG RSTD;                            1046 04207000
*                TESTRC = RTNREG;                                  1047 04208000
         STH   RTNREG,TESTRC                                       1047 04209000
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30SSSB*/ 04210000
*                                                                  1048 04211000
*                IOCSOUP -> IOCDAD = DMADDR1;              /*@Y30SSSB*/ 04212000
*                                                                  1049 04213000
         L     @08,IOCSOUP                                         1049 04214000
         MVC   IOCDAD(4,@08),DMADDR1                               1049 04215000
*                IOPOSSW = 'U';                            /*@Y30SSSB*/ 04216000
         MVI   IOPOSSW,C'U'                                        1050 04217000
*              END;                                        /*@Y30SSSB*/ 04218000
*            END;                                          /*@OZ17081*/ 04219000
@RC00994 DS    0H                                                  1053 04220000
*            IF GDTDBG = NULLPTR                                   1053 04221000
*              THEN;                                       /*@OZ00751*/ 04222000
@RT00991 L     @08,@PC00001                                        1053 04223000
         L     @08,GDTDBG(,@08)                                    1053 04224000
         LTR   @08,@08                                             1053 04225000
         BZ    @RT01053                                            1053 04226000
*              ELSE                                                1055 04227000
*                CALL DUMPIT;                              /*@OZ00751*/ 04228000
*                                                                  1055 04229000
         BAL   @14,DUMPIT                                          1055 04230000
*            IF TESTRC ^= 0                                        1056 04231000
*              THEN                                                1056 04232000
@RT01053 LH    @08,TESTRC                                          1056 04233000
         LTR   @08,@08                                             1056 04234000
         BZ    @RF01056                                            1056 04235000
*                STATFLG = TERMERR;                        /*@OZ00751*/ 04236000
*                                                                  1057 04237000
         MVC   STATFLG(5),@CB00819                                 1057 04238000
*            END;                                          /*@OZ00751*/ 04239000
*                                                                  1058 04240000
@RF01056 DS    0H                                                  1059 04241000
*      END MAIN;                                           /*@OZ00751*/ 04242000
*                                                                  1059 04243000
@RF00959 DS    0H                                                  1059 04244000
@DE00857 CLC   STATFLG(5),@CB00819                                 1059 04245000
         BE    @DC00857                                            1059 04246000
         CLC   EOFSW(2),@CH00162                                   1059 04247000
         BNE   @DL00857                                            1059 04248000
@DC00857 DS    0H                                                  1060 04249000
*/********************************************************************/ 04250000
*/*                                                                  */ 04251000
*/* THE MAIN JOB LEFT TO BE DONE AFTER ALL BACKUP RECORDS    @OZ00751*/ 04252000
*/* HAVE BEEN WRITTEN TO THE TARGET IS TO UPDATE THE CATALOG @OZ00751*/ 04253000
*/* CONTROL RECORD. THE CATALOG FREE RECORD POINTERS AND     @OZ00751*/ 04254000
*/* COUNTERS HAVE TO BE UPDATED, ALSO THE RBA FIELDS SHOULD  @OZ00751*/ 04255000
*/* BE CLEARED. CATALOG MANAGEMENT WILL SET UP THE NEW RBA   @OZ00751*/ 04256000
*/* POINTERS NEXT TIME THE CATALOG IS OPENED.                @OZ00751*/ 04257000
*/* ANOTHER TASK TO BE DONE IS TO PUT OUT A MESSAGE          @OZ00751*/ 04258000
*/* INDICATING THAT THE CATALOGS MATCHED OK IF CATALOG       @OZ00751*/ 04259000
*/* COMPARISON WAS POSSIBLE                                  @OZ00751*/ 04260000
*/*                                                          @OZ00751*/ 04261000
*/********************************************************************/ 04262000
*                                                                  1060 04263000
*    IF STATFLG ^= TERMERR                                         1060 04264000
*      THEN                                                        1060 04265000
         CLC   STATFLG(5),@CB00819                                 1060 04266000
         BE    @RF01060                                            1060 04267000
*EOJ:    DO;                                               /*@OZ00751*/ 04268000
*                                                                  1061 04269000
EOJ      DS    0H                                                  1062 04270000
*        IF IOPOSSW = 'I'                                          1062 04271000
*          THEN                                                    1062 04272000
         CLI   IOPOSSW,C'I'                                        1062 04273000
         BNE   @RF01062                                            1062 04274000
*            DO;                                           /*@OZ00751*/ 04275000
*                                                                  1063 04276000
*            /********************************************************/ 04277000
*            /*                                              @OZ00751*/ 04278000
*            /* IF THE LAST REQUEST WAS FOR AN INSERT        @OZ00751*/ 04279000
*            /* THEN THE INSERT RPL HAS TO BE                @OZ00751*/ 04280000
*            /* QUIESCED AND THE UPDATE RPL                  @OZ00751*/ 04281000
*            /* REPOSITIONED.                                @OZ00751*/ 04282000
*            /*                                              @OZ00751*/ 04283000
*            /********************************************************/ 04284000
*                                                                  1064 04285000
*            REG1 = IOCSOUT -> IOCEXT -> IOCRPL;           /*@OZ00751*/ 04286000
         L     @08,IOCSOUT                                         1064 04287000
         L     @08,IOCEXT(,@08)                                    1064 04288000
         L     REG1,IOCRPL(,@08)                                   1064 04289000
*            GEN(ENDREQ RPL=(1) );                         /*@OZ00751*/ 04290000
*                                                                  1065 04291000
         ENDREQ RPL=(1)                                                 04292000
*            END;                                                  1066 04293000
*                                                                  1066 04294000
*        /************************************************************/ 04295000
*        /*                                                  @OZ00751*/ 04296000
*        /* THE FIRST THING TO DO IS TO POSITION AT THE      @OZ00751*/ 04297000
*        /* CATALOG CONTROL RECORD OF THE TARGET             @OZ00751*/ 04298000
*        /*                                                  @OZ00751*/ 04299000
*        /************************************************************/ 04300000
*                                                                  1067 04301000
*        IOCSOUP -> IOCEXT -> IOCFLGEF = OFF;              /*@Y30SSEC*/ 04302000
*                                                                  1067 04303000
*                                                                  1067 04304000
@RF01062 L     @08,IOCSOUP                                         1067 04305000
         L     @01,IOCEXT(,@08)                                    1067 04306000
         NI    IOCFLGEF(@01),B'11011111'                           1067 04307000
*        IOCSOUP -> IOCKYA = ADDR(CCRECSTR);               /*@OZ00751*/ 04308000
         LA    @15,CCRECSTR                                        1068 04309000
         ST    @15,IOCKYA(,@08)                                    1068 04310000
*        CALL IDCIOPO0 (GDTTBL,IOCSOUP);                   /*@OZ00751*/ 04311000
         L     @08,@PC00001                                        1069 04312000
         ST    @08,@AL00001                                        1069 04313000
         LA    @15,IOCSOUP                                         1069 04314000
         ST    @15,@AL00001+4                                      1069 04315000
         MVI   @AL00001+4,X'80'                                    1069 04316000
         L     @15,GDTPOS(,@08)                                    1069 04317000
         LA    @01,@AL00001                                        1069 04318000
         BALR  @14,@15                                             1069 04319000
*        RESPECIFY RTNREG RSTD;                                    1070 04320000
*        TESTRC = RTNREG;                                          1071 04321000
         STH   RTNREG,TESTRC                                       1071 04322000
*        RESPECIFY RTNREG UNRSTD;                          /*@OZ00751*/ 04323000
*                                                                  1072 04324000
*        IF TESTRC = 0                                             1073 04325000
*          THEN                                                    1073 04326000
         LH    @08,TESTRC                                          1073 04327000
         LTR   @08,@08                                             1073 04328000
         BNZ   @RF01073                                            1073 04329000
*            CALL IDCIOGT0 (GDTTBL,IOCSOUP);               /*@OZ00751*/ 04330000
         L     @08,@PC00001                                        1074 04331000
         ST    @08,@AL00001                                        1074 04332000
         LA    @15,IOCSOUP                                         1074 04333000
         ST    @15,@AL00001+4                                      1074 04334000
         MVI   @AL00001+4,X'80'                                    1074 04335000
         L     @15,GDTGET(,@08)                                    1074 04336000
         LA    @01,@AL00001                                        1074 04337000
         BALR  @14,@15                                             1074 04338000
*        RESPECIFY RTNREG RSTD;                                    1075 04339000
@RF01073 DS    0H                                                  1076 04340000
*        TESTRC = RTNREG;                                          1076 04341000
         STH   RTNREG,TESTRC                                       1076 04342000
*        RESPECIFY RTNREG UNRSTD;                          /*@OZ00751*/ 04343000
*                                                                  1077 04344000
*        IF GDTDBG = NULLPTR                                       1078 04345000
*          THEN;                                           /*@OZ00751*/ 04346000
         L     @08,@PC00001                                        1078 04347000
         L     @08,GDTDBG(,@08)                                    1078 04348000
         LTR   @08,@08                                             1078 04349000
         BZ    @RT01078                                            1078 04350000
*          ELSE                                                    1080 04351000
*            DO;                                           /*@OZ00751*/ 04352000
*                                                                  1080 04353000
*            DMNAME1 = 'RDCCREC';                          /*@OZ00751*/ 04354000
         MVI   DMNAME1+7,C' '                                      1081 04355000
         MVC   DMNAME1(7),@CC01210                                 1081 04356000
*            DMADDR1 = IOCSOUP -> IOCDAD;                  /*@OZ00751*/ 04357000
         L     @08,IOCSOUP                                         1082 04358000
         MVC   DMADDR1(4),IOCDAD(@08)                              1082 04359000
*            CALL DUMPIT;                                  /*@OZ00751*/ 04360000
*                                                                  1083 04361000
         BAL   @14,DUMPIT                                          1083 04362000
*            END;                                          /*@OZ00751*/ 04363000
*                                                                  1084 04364000
*        /************************************************************/ 04365000
*        /*                                                  @OZ00751*/ 04366000
*        /* THE CATALOG CONTROL RECORD CI #S SHOULD BE       @OZ00751*/ 04367000
*        /* UPDATED AND THEN WRITTEN OUT                     @OZ00751*/ 04368000
*        /*                                                  @OZ00751*/ 04369000
*        /************************************************************/ 04370000
*                                                                  1085 04371000
*        IF TESTRC = 0                                             1085 04372000
*          THEN                                                    1085 04373000
@RT01078 LH    @08,TESTRC                                          1085 04374000
         LTR   @08,@08                                             1085 04375000
         BNZ   @RF01085                                            1085 04376000
*            DO;                                           /*@OZ00751*/ 04377000
*                                                                  1086 04378000
*            IOCSPTR = IOCSOUP;                            /*@OZ00751*/ 04379000
*                                                                  1087 04380000
         MVC   IOCSPTR(4),IOCSOUP                                  1087 04381000
*            RFY RCIADDR RSTD;                             /*@OZ00751*/ 04382000
*            RCIADDR = ADDR(NFCISTOR);                     /*@OZ00751*/ 04383000
         LA    RCIADDR,NFCISTOR                                    1089 04384000
*            CALL CNVRTCI;                                 /*@OZ00751*/ 04385000
         BAL   @14,CNVRTCI                                         1090 04386000
*            RFY RCIADDR UNRSTD;                           /*@OZ00751*/ 04387000
*                                                                  1091 04388000
*            IF CCRNFCI < NFCISTOR                                 1092 04389000
*              THEN                                                1092 04390000
         L     @08,IOCSPTR                                         1092 04391000
         L     @08,IOCDAD(,@08)                                    1092 04392000
         CLC   CCRNFCI(3,@08),NFCISTOR                             1092 04393000
         BNL   @RF01092                                            1092 04394000
*                CCRNFCI = NFCISTOR;                       /*@OZ00751*/ 04395000
*                                                                  1093 04396000
         MVC   CCRNFCI(3,@08),NFCISTOR                             1093 04397000
*            CCRNUM = FREENUM;                             /*@OZ00751*/ 04398000
@RF01092 L     @08,IOCSPTR                                         1094 04399000
         L     @08,IOCDAD(,@08)                                    1094 04400000
         MVC   CCRNUM(3,@08),FREENUM+1                             1094 04401000
*            CCRFDCI = CFROLD;                             /*@OZ00751*/ 04402000
*                                                                  1095 04403000
         MVC   CCRFDCI(3,@08),CFROLD                               1095 04404000
*            IOCSPTR = IOCSINP;                            /*@OZ00751*/ 04405000
*                                                                  1096 04406000
         MVC   IOCSPTR(4),IOCSINP                                  1096 04407000
*            IOCSOUP -> IOCDAD -> RBAFIELD = ''B;          /*@OZ00751*/ 04408000
*                                                                  1097 04409000
         L     @08,IOCSOUP                                         1097 04410000
         L     @08,IOCDAD(,@08)                                    1097 04411000
         XC    RBAFIELD(48,@08),RBAFIELD(@08)                      1097 04412000
*            DMNAME1 = 'UPCCREC';                          /*@OZ00751*/ 04413000
         MVI   DMNAME1+7,C' '                                      1098 04414000
         MVC   DMNAME1(7),@CC01211                                 1098 04415000
*            DMADDR1 = IOCSOUP -> IOCDAD;                  /*@OZ00751*/ 04416000
*                                                                  1099 04417000
         ST    @08,@TF00001                                        1099 04418000
         MVC   DMADDR1(4),@TF00001                                 1099 04419000
*            CALL IDCIOPT0      (GDTTBL,IOCSOUP);          /*@OZ00751*/ 04420000
         L     @08,@PC00001                                        1100 04421000
         ST    @08,@AL00001                                        1100 04422000
         LA    @15,IOCSOUP                                         1100 04423000
         ST    @15,@AL00001+4                                      1100 04424000
         MVI   @AL00001+4,X'80'                                    1100 04425000
         L     @15,GDTPUT(,@08)                                    1100 04426000
         LA    @01,@AL00001                                        1100 04427000
         BALR  @14,@15                                             1100 04428000
*            RESPECIFY RTNREG RSTD;                                1101 04429000
*            TESTRC = RTNREG;                                      1102 04430000
         STH   RTNREG,TESTRC                                       1102 04431000
*            RESPECIFY RTNREG UNRSTD;                      /*@OZ00751*/ 04432000
*                                                                  1103 04433000
*            IF GDTDBG = NULLPTR                                   1104 04434000
*              THEN;                                       /*@OZ00751*/ 04435000
         L     @08,@PC00001                                        1104 04436000
         L     @08,GDTDBG(,@08)                                    1104 04437000
         LTR   @08,@08                                             1104 04438000
         BZ    @RT01104                                            1104 04439000
*              ELSE                                                1106 04440000
*                CALL DUMPIT;                              /*@OZ00751*/ 04441000
*                                                                  1106 04442000
         BAL   @14,DUMPIT                                          1106 04443000
*            END;                                          /*@OZ00751*/ 04444000
@RT01104 DS    0H                                                  1108 04445000
*        IF TESTRC ^= 0                                            1108 04446000
*          THEN                                                    1108 04447000
@RF01085 LH    @08,TESTRC                                          1108 04448000
         LTR   @08,@08                                             1108 04449000
         BZ    @RF01108                                            1108 04450000
*            STATFLG = TERMERR;                            /*@OZ00751*/ 04451000
*                                                                  1109 04452000
         MVC   STATFLG(5),@CB00819                                 1109 04453000
*        END EOJ;                                          /*@OZ00751*/ 04454000
*                                                                  1110 04455000
@RF01108 DS    0H                                                  1111 04456000
*        CALL IDCIOCL0 (GDTTBL,IOCSOUP);/*                         1111 04457000
*                                     CLOSE UPDATE FILE      @OZ00751*/ 04458000
*                                                                  1111 04459000
*                                                                  1111 04460000
@RF01060 L     @08,@PC00001                                        1111 04461000
         ST    @08,@AL00001                                        1111 04462000
         LA    @15,IOCSOUP                                         1111 04463000
         ST    @15,@AL00001+4                                      1111 04464000
         MVI   @AL00001+4,X'80'                                    1111 04465000
         L     @15,GDTCLS(,@08)                                    1111 04466000
         LA    @01,@AL00001                                        1111 04467000
         BALR  @14,@15                                             1111 04468000
*        RETURN;                                           /*@OZ00751*/ 04469000
*                                                                  1112 04470000
*                                                                  1112 04471000
@EL00003 DS    0H                                                  1112 04472000
@EF00003 DS    0H                                                  1112 04473000
@ER00003 LM    @14,@12,@SA00003                                    1112 04474000
         BR    @14                                                 1112 04475000
*/********************************************************************/ 04476000
*/*                                                          @OZ00751*/ 04477000
*/* PROCEDURE NAME - SORSREAD                                @OZ00751*/ 04478000
*/*                                                          @OZ00751*/ 04479000
*/* THIS IS A CATALOG RELOAD PROCEDURE TO READ A RECORD FROM @OZ00751*/ 04480000
*/* THE BACKUP CATALOG AND TAKE ACTION IF THE RETURN CODE IS @OZ00751*/ 04481000
*/* NON ZERO.                                                @OZ00751*/ 04482000
*/*                                                          @OZ00751*/ 04483000
*/********************************************************************/ 04484000
*                                                                  1113 04485000
*SORSREAD:                                                         1113 04486000
*        PROC;                                             /*@OZ00751*/ 04487000
*                                                                  1113 04488000
SORSREAD STM   @14,@12,@SA00004                                    1113 04489000
*        CALL IDCIOGT0 (GDTTBL,IOCSINP);                   /*@OZ00751*/ 04490000
         L     @08,@PC00001                                        1114 04491000
         ST    @08,@AL00001                                        1114 04492000
         LA    @15,IOCSINP                                         1114 04493000
         ST    @15,@AL00001+4                                      1114 04494000
         MVI   @AL00001+4,X'80'                                    1114 04495000
         L     @15,GDTGET(,@08)                                    1114 04496000
         LA    @01,@AL00001                                        1114 04497000
         BALR  @14,@15                                             1114 04498000
*        RESPECIFY RTNREG RSTD;                                    1115 04499000
*        TESTRC = RTNREG;                                          1116 04500000
         STH   RTNREG,TESTRC                                       1116 04501000
*        RESPECIFY RTNREG UNRSTD;                          /*@OZ00751*/ 04502000
*                                                                  1117 04503000
*        IF GDTDBG = NULLPTR                                       1118 04504000
*          THEN;                                           /*@OZ00751*/ 04505000
         L     @08,@PC00001                                        1118 04506000
         L     @08,GDTDBG(,@08)                                    1118 04507000
         LTR   @08,@08                                             1118 04508000
         BZ    @RT01118                                            1118 04509000
*          ELSE                                                    1120 04510000
*            DO;                                           /*@OZ00751*/ 04511000
*                                                                  1120 04512000
*            DMNAME1 = 'RDINPREC';                         /*@OZ00751*/ 04513000
         MVC   DMNAME1(8),@CC01215                                 1121 04514000
*            DMADDR1 = IOCSINP -> IOCDAD;                  /*@OZ00751*/ 04515000
         L     @08,IOCSINP                                         1122 04516000
         MVC   DMADDR1(4),IOCDAD(@08)                              1122 04517000
*            CALL DUMPIT;                                  /*@OZ00751*/ 04518000
*                                                                  1123 04519000
         BAL   @14,DUMPIT                                          1123 04520000
*            END;                                          /*@OZ00751*/ 04521000
*                                                                  1124 04522000
*        IF TESTRC = 4                                             1125 04523000
*          THEN                                                    1125 04524000
@RT01118 CLC   TESTRC(2),@CH00042                                  1125 04525000
         BNE   @RF01125                                            1125 04526000
*          STATFLG = TERMERR;                              /*@OZ00751*/ 04527000
*                                                                  1126 04528000
         MVC   STATFLG(5),@CB00819                                 1126 04529000
*      IF TESTRC = 16                                              1127 04530000
*        THEN                                                      1127 04531000
@RF01125 CLC   TESTRC(2),@CH00476                                  1127 04532000
         BNE   @RF01127                                            1127 04533000
*          DO;                                             /*@OZ00751*/ 04534000
*                                                                  1128 04535000
*          IOCSINP -> IOCDAD -> RECKEY = 'FE'X;            /*@OZ00751*/ 04536000
         L     @08,IOCSINP                                         1129 04537000
         L     @08,IOCDAD(,@08)                                    1129 04538000
         XC    RECKEY+1(43,@08),RECKEY+1(@08)                      1129 04539000
         MVI   RECKEY(@08),X'FE'                                   1129 04540000
*          EOFSW = EOFSW + SORSEOF;                        /*@OZ00751*/ 04541000
*                                                                  1130 04542000
         LH    @08,EOFSW                                           1130 04543000
         LA    @08,1(,@08)                                         1130 04544000
         STH   @08,EOFSW                                           1130 04545000
*          END;                                            /*@OZ00751*/ 04546000
*                                                                  1131 04547000
*        END SORSREAD;                                             1132 04548000
*                                                                  1132 04549000
@EL00004 DS    0H                                                  1132 04550000
@EF00004 DS    0H                                                  1132 04551000
@ER00004 LM    @14,@12,@SA00004                                    1132 04552000
         BR    @14                                                 1132 04553000
*/********************************************************************/ 04554000
*/*                                                          @OZ00751*/ 04555000
*/* PROCEDURE NAME - TARGREAD                                @OZ00751*/ 04556000
*/*                                                          @OZ00751*/ 04557000
*/* THIS IS A CATALOG RELOAD PROCEEDURE TO READ A RECORD FROM@OZ00751*/ 04558000
*/* THE TARGET CATALOG AND TAKE ACTION IF THE RETURN CODE IS @OZ00751*/ 04559000
*/* NON ZERO                                                 @OZ00751*/ 04560000
*/*                                                          @OZ00751*/ 04561000
*/********************************************************************/ 04562000
*                                                                  1133 04563000
*TARGREAD:                                                         1133 04564000
*        PROC;                                             /*@OZ00751*/ 04565000
*                                                                  1133 04566000
TARGREAD STM   @14,@12,@SA00005                                    1133 04567000
*        CALL IDCIOGT0  (GDTTBL,IOCSOUP);                  /*@OZ00751*/ 04568000
         L     @08,@PC00001                                        1134 04569000
         ST    @08,@AL00001                                        1134 04570000
         LA    @15,IOCSOUP                                         1134 04571000
         ST    @15,@AL00001+4                                      1134 04572000
         MVI   @AL00001+4,X'80'                                    1134 04573000
         L     @15,GDTGET(,@08)                                    1134 04574000
         LA    @01,@AL00001                                        1134 04575000
         BALR  @14,@15                                             1134 04576000
*        RESPECIFY RTNREG RSTD;                                    1135 04577000
*        TESTRC = RTNREG;                                          1136 04578000
         STH   RTNREG,TESTRC                                       1136 04579000
*        RESPECIFY RTNREG UNRSTD;                          /*@OZ00751*/ 04580000
*                                                                  1137 04581000
*        CURRKEYT =IOCSOUP -> IOCDAD -> CATLREC(1:44);     /*@OZ00751*/ 04582000
*                                                                  1138 04583000
         L     @08,IOCSOUP                                         1138 04584000
         L     @08,IOCDAD(,@08)                                    1138 04585000
         MVC   CURRKEYT(44),CATLREC(@08)                           1138 04586000
*        IF GDTDBG = NULLPTR                                       1139 04587000
*          THEN;                                           /*@OZ00751*/ 04588000
         L     @08,@PC00001                                        1139 04589000
         L     @08,GDTDBG(,@08)                                    1139 04590000
         LTR   @08,@08                                             1139 04591000
         BZ    @RT01139                                            1139 04592000
*          ELSE                                                    1141 04593000
*            DO;                                           /*@OZ00751*/ 04594000
*                                                                  1141 04595000
*            DMNAME1 = 'RDOUTREC';                         /*@OZ00751*/ 04596000
         MVC   DMNAME1(8),@CC01220                                 1142 04597000
*            DMADDR1 = IOCSOUP -> IOCDAD;                  /*@OZ00751*/ 04598000
         L     @08,IOCSOUP                                         1143 04599000
         MVC   DMADDR1(4),IOCDAD(@08)                              1143 04600000
*            CALL DUMPIT;                                  /*@OZ00751*/ 04601000
*                                                                  1144 04602000
         BAL   @14,DUMPIT                                          1144 04603000
*            END;                                          /*@OZ00751*/ 04604000
*                                                                  1145 04605000
*        IF TESTRC = 4                                             1146 04606000
*          THEN                                                    1146 04607000
@RT01139 CLC   TESTRC(2),@CH00042                                  1146 04608000
         BNE   @RF01146                                            1146 04609000
*            STATFLG = TERMERR;                            /*@OZ00751*/ 04610000
*                                                                  1147 04611000
         MVC   STATFLG(5),@CB00819                                 1147 04612000
*        IF TESTRC = 16                                            1148 04613000
*          THEN                                                    1148 04614000
@RF01146 CLC   TESTRC(2),@CH00476                                  1148 04615000
         BNE   @RF01148                                            1148 04616000
*            DO;                                           /*@OZ00751*/ 04617000
*                                                                  1149 04618000
*            IOCSOUP -> IOCDAD -> RECKEY = 'FE'X;          /*@OZ00751*/ 04619000
         L     @08,IOCSOUP                                         1150 04620000
         L     @08,IOCDAD(,@08)                                    1150 04621000
         XC    RECKEY+1(43,@08),RECKEY+1(@08)                      1150 04622000
         MVI   RECKEY(@08),X'FE'                                   1150 04623000
*            EOFSW = EOFSW + TARGEOF;                      /*@OZ00751*/ 04624000
*                                                                  1151 04625000
         LH    @08,EOFSW                                           1151 04626000
         LA    @08,2(,@08)                                         1151 04627000
         STH   @08,EOFSW                                           1151 04628000
*            END;                                          /*@OZ00751*/ 04629000
*                                                                  1152 04630000
*        END TARGREAD;                                     /*@OZ00751*/ 04631000
*                                                                  1153 04632000
@EL00005 DS    0H                                                  1153 04633000
@EF00005 DS    0H                                                  1153 04634000
@ER00005 LM    @14,@12,@SA00005                                    1153 04635000
         BR    @14                                                 1153 04636000
*/********************************************************************/ 04637000
*/*                                                          @OZ00751*/ 04638000
*/* PROCEDURE NAME - GETPAIR                                 @OZ00751*/ 04639000
*/*                                                          @OZ00751*/ 04640000
*/* A SIMPLE PROCEEDURE TO READ A BACKUP AND TARGET RECORD   @OZ00751*/ 04641000
*/* PROVIDED THE RETURN CODE IS ZERO                         @OZ00751*/ 04642000
*/*                                                          @OZ00751*/ 04643000
*/********************************************************************/ 04644000
*                                                                  1154 04645000
* GETPAIR:                                                         1154 04646000
*        PROC;                                             /*@OZ00751*/ 04647000
*                                                                  1154 04648000
GETPAIR  STM   @14,@12,@SA00006                                    1154 04649000
*        IF TESTRC = 0                                     /*@OZ00751*/ 04650000
*          THEN                                                    1155 04651000
         LH    @08,TESTRC                                          1155 04652000
         LTR   @08,@08                                             1155 04653000
         BNZ   @RF01155                                            1155 04654000
*            DO;                                           /*@OZ00751*/ 04655000
*                                                                  1156 04656000
*            CALL IDCIOGT0 (GDTTBL,IOCSINP);               /*@OZ00751*/ 04657000
         L     @08,@PC00001                                        1157 04658000
         ST    @08,@AL00001                                        1157 04659000
         LA    @15,IOCSINP                                         1157 04660000
         ST    @15,@AL00001+4                                      1157 04661000
         MVI   @AL00001+4,X'80'                                    1157 04662000
         L     @15,GDTGET(,@08)                                    1157 04663000
         LA    @01,@AL00001                                        1157 04664000
         BALR  @14,@15                                             1157 04665000
*            RESPECIFY RTNREG RSTD;                                1158 04666000
*            TESTRC = RTNREG;                                      1159 04667000
         STH   RTNREG,TESTRC                                       1159 04668000
*            RESPECIFY RTNREG UNRSTD;                      /*@OZ00751*/ 04669000
*                                                                  1160 04670000
*            IF GDTDBG = NULLPTR                                   1161 04671000
*              THEN;                                       /*@OZ00751*/ 04672000
         L     @08,@PC00001                                        1161 04673000
         L     @08,GDTDBG(,@08)                                    1161 04674000
         LTR   @08,@08                                             1161 04675000
         BZ    @RT01161                                            1161 04676000
*              ELSE                                                1163 04677000
*                DO;                                       /*@OZ00751*/ 04678000
*                                                                  1163 04679000
*                DMNAME1 = 'RDINPREC';                     /*@OZ00751*/ 04680000
         MVC   DMNAME1(8),@CC01215                                 1164 04681000
*                DMADDR1= IOCSINP ->  IOCDAD;              /*@OZ00751*/ 04682000
         L     @08,IOCSINP                                         1165 04683000
         MVC   DMADDR1(4),IOCDAD(@08)                              1165 04684000
*                CALL DUMPIT;                              /*@OZ00751*/ 04685000
*                                                                  1166 04686000
         BAL   @14,DUMPIT                                          1166 04687000
*                END;                                      /*@OZ00751*/ 04688000
*                                                                  1167 04689000
*            END;                                          /*@OZ00751*/ 04690000
*                                                                  1168 04691000
@RT01161 DS    0H                                                  1169 04692000
*        IF TESTRC = 0                                             1169 04693000
*          THEN                                                    1169 04694000
@RF01155 LH    @08,TESTRC                                          1169 04695000
         LTR   @08,@08                                             1169 04696000
         BNZ   @RF01169                                            1169 04697000
*            DO;                                           /*@OZ00751*/ 04698000
*                                                                  1170 04699000
*            CALL IDCIOGT0 (GDTTBL,IOCSOUP);               /*@OZ00751*/ 04700000
         L     @08,@PC00001                                        1171 04701000
         ST    @08,@AL00001                                        1171 04702000
         LA    @15,IOCSOUP                                         1171 04703000
         ST    @15,@AL00001+4                                      1171 04704000
         MVI   @AL00001+4,X'80'                                    1171 04705000
         L     @15,GDTGET(,@08)                                    1171 04706000
         LA    @01,@AL00001                                        1171 04707000
         BALR  @14,@15                                             1171 04708000
*            RESPECIFY RTNREG RSTD;                                1172 04709000
*            TESTRC = RTNREG;                                      1173 04710000
         STH   RTNREG,TESTRC                                       1173 04711000
*            RESPECIFY RTNREG UNRSTD;                      /*@OZ00751*/ 04712000
*                                                                  1174 04713000
*            IF GDTDBG = NULLPTR                                   1175 04714000
*              THEN;                                       /*@OZ00751*/ 04715000
         L     @08,@PC00001                                        1175 04716000
         L     @08,GDTDBG(,@08)                                    1175 04717000
         LTR   @08,@08                                             1175 04718000
         BZ    @RT01175                                            1175 04719000
*              ELSE                                                1177 04720000
*                DO;                                       /*@OZ00751*/ 04721000
*                                                                  1177 04722000
*                DMNAME1 = 'RDOUTREC';                     /*@OZ00751*/ 04723000
         MVC   DMNAME1(8),@CC01220                                 1178 04724000
*                DMADDR1 = IOCSOUP -> IOCDAD;              /*@OZ00751*/ 04725000
         L     @08,IOCSOUP                                         1179 04726000
         MVC   DMADDR1(4),IOCDAD(@08)                              1179 04727000
*                CALL DUMPIT;                              /*@OZ00751*/ 04728000
*                                                                  1180 04729000
         BAL   @14,DUMPIT                                          1180 04730000
*                END;                                      /*@OZ00751*/ 04731000
*                                                                  1181 04732000
*            END;                                                  1182 04733000
*                                                                  1182 04734000
*        END GETPAIR;                                      /*@OZ00751*/ 04735000
*                                                                  1183 04736000
@EL00006 DS    0H                                                  1183 04737000
@EF00006 DS    0H                                                  1183 04738000
@ER00006 LM    @14,@12,@SA00006                                    1183 04739000
         BR    @14                                                 1183 04740000
*/********************************************************************/ 04741000
*/*                                                          @OZ00751*/ 04742000
*/* PROCEDURE NAME - DUMPIT                                  @OZ00751*/ 04743000
*/*                                                          @OZ00751*/ 04744000
*/* FUNCTION - THIS ROUTINE IS ACTIVATED BY THE AMS PARM     @OZ00751*/ 04745000
*/*            TEST FUNCTION. IT WILL TRACE ALL I/O FOR      @OZ00751*/ 04746000
*/*            CATALOG RELOAD IF THE AREAS(RP) SUB PARAMETER @OZ00751*/ 04747000
*/*            IS USED.                                      @OZ00751*/ 04748000
*/*                                                          @OZ00751*/ 04749000
*/********************************************************************/ 04750000
*                                                                  1184 04751000
*DUMPIT:                                                           1184 04752000
*        PROC;                                             /*@OZ00751*/ 04753000
DUMPIT   STM   @14,@12,@SA00007                                    1184 04754000
*        DMPINDEX = ADDR(DUMPAREA);                        /*@OZ00751*/ 04755000
         LA    @08,DUMPAREA                                        1185 04756000
         ST    @08,DMPINDEX                                        1185 04757000
*        IF DMADDR1 -> RCDKEYTY ^= NULL                            1186 04758000
*          THEN                                                    1186 04759000
         MVC   @TF00001(4),DMADDR1                                 1186 04760000
         L     @01,@TF00001                                        1186 04761000
         CLI   RCDKEYTY(@01),0                                     1186 04762000
         BE    @RF01186                                            1186 04763000
*            DO;                                           /*@OZ00751*/ 04764000
*                                                                  1187 04765000
*            DMPITMLN = 47;                                /*@OZ00751*/ 04766000
         MVC   DMPITMLN(2,@08),@CH01205                            1188 04767000
*            DMPITMTP = 'C';                               /*@OZ00751*/ 04768000
*                                                                  1189 04769000
         MVI   DMPITMTP(@08),C'C'                                  1189 04770000
*            END;                                                  1190 04771000
*          ELSE                                                    1191 04772000
*            DO;                                           /*@OZ00751*/ 04773000
*                                                                  1191 04774000
         B     @RC01186                                            1191 04775000
@RF01186 DS    0H                                                  1192 04776000
*            DMPITMLN = 255;                               /*@OZ00751*/ 04777000
         LA    @08,255                                             1192 04778000
         L     @15,DMPINDEX                                        1192 04779000
         STH   @08,DMPITMLN(,@15)                                  1192 04780000
*            DMPITMTP = 'H';                               /*@OZ00751*/ 04781000
         MVI   DMPITMTP(@15),C'H'                                  1193 04782000
*            DMPINDEX = DMPINDEX + DMPELEMT;               /*@OZ00751*/ 04783000
         AH    @15,@CH00476                                        1194 04784000
         ST    @15,DMPINDEX                                        1194 04785000
*            DMPITMNM = '2ND-HALF';                        /*@OZ00751*/ 04786000
         MVC   DMPITMNM(8,@15),@CC01228                            1195 04787000
*            DMPITMPT = DMADDR1 + 255;                     /*@OZ00751*/ 04788000
         MVC   @TF00001(4),DMADDR1                                 1196 04789000
         AL    @08,@TF00001                                        1196 04790000
         ST    @08,DMPITMPT(,@15)                                  1196 04791000
*            DMPITMLN = 250;                               /*@OZ00751*/ 04792000
         MVC   DMPITMLN(2,@15),@CH01229                            1197 04793000
*            DMPITMTP = 'H';                               /*@OZ00751*/ 04794000
*                                                                  1198 04795000
         MVI   DMPITMTP(@15),C'H'                                  1198 04796000
*            END;                                          /*@OZ00751*/ 04797000
*                                                                  1199 04798000
*        DMPINDEX = DMPINDEX + DMPELEMT;                   /*@OZ00751*/ 04799000
@RC01186 LA    @08,16                                              1200 04800000
         L     @15,DMPINDEX                                        1200 04801000
         ALR   @15,@08                                             1200 04802000
         ST    @15,DMPINDEX                                        1200 04803000
*        DMPITMNM = 'RET-CODE';                            /*@OZ00751*/ 04804000
         MVC   DMPITMNM(8,@15),@CC01230                            1201 04805000
*        DMPITMPT = ADDR(TESTRC);                          /*@OZ00751*/ 04806000
         LA    @14,TESTRC                                          1202 04807000
         ST    @14,DMPITMPT(,@15)                                  1202 04808000
*        DMPITMLN = 2;                                     /*@OZ00751*/ 04809000
         MVC   DMPITMLN(2,@15),@CH00153                            1203 04810000
*        DMPITMTP = 'F';                                   /*@OZ00751*/ 04811000
         MVI   DMPITMTP(@15),C'F'                                  1204 04812000
*        DMPINDEX = DMPINDEX + DMPELEMT;                   /*@OZ00751*/ 04813000
         ALR   @15,@08                                             1205 04814000
         ST    @15,DMPINDEX                                        1205 04815000
*        DMPTRM = DMPTRMVL;                                /*@OZ00751*/ 04816000
*                                                                  1206 04817000
         MVI   DMPTRM(@15),X'FF'                                   1206 04818000
*        IF GDTDBG = NULLPTR                                       1207 04819000
*          THEN;                                                   1207 04820000
         L     @08,@PC00001                                        1207 04821000
         L     @08,GDTDBG(,@08)                                    1207 04822000
         LTR   @08,@08                                             1207 04823000
         BZ    @RT01207                                            1207 04824000
*          ELSE                                                    1209 04825000
*            CALL IDCDB010 (GDTTBL,'RPIO',ADDR(DUMPAREA));         1209 04826000
         L     @08,@PC00001                                        1209 04827000
         ST    @08,@AL00001                                        1209 04828000
         LA    @15,@CC01231                                        1209 04829000
         ST    @15,@AL00001+4                                      1209 04830000
         LA    @15,DUMPAREA                                        1209 04831000
         ST    @15,@AFTEMPS                                        1209 04832000
         LA    @15,@AFTEMPS                                        1209 04833000
         ST    @15,@AL00001+8                                      1209 04834000
         MVI   @AL00001+8,X'80'                                    1209 04835000
         L     @15,GDTDBG(,@08)                                    1209 04836000
         LA    @01,@AL00001                                        1209 04837000
         BALR  @14,@15                                             1209 04838000
*                                                          /*@OZ00751*/ 04839000
*                                                                  1210 04840000
*        END DUMPIT;                                       /*@OZ00751*/ 04841000
*                                                                  1210 04842000
@EL00007 DS    0H                                                  1210 04843000
@EF00007 DS    0H                                                  1210 04844000
@ER00007 LM    @14,@12,@SA00007                                    1210 04845000
         BR    @14                                                 1210 04846000
*TRUENAME:                                                         1211 04847000
*        PROC;                                             /*@OZ00751*/ 04848000
*                                                                  1211 04849000
TRUENAME STM   @14,@12,@SA00008                                    1211 04850000
*/********************************************************************/ 04851000
*/*                                                          @OZ00751*/ 04852000
*/* PROCEDURE NAME - TRUENAME                                @OZ00751*/ 04853000
*/*                                                          @OZ00751*/ 04854000
*/* FUNCTION - TRUENAME MAPS THE RBA BOUNDARIES OF THE       @OZ00751*/ 04855000
*/*            BACKUP AND TARGET CATALOG TRUENAME RANGES.    @OZ00751*/ 04856000
*/*            THIS IS NECESSARY SINCE A VSAM CATALOG        @OZ00751*/ 04857000
*/*            (RATHER LIKE THE OS SVCLIB) CONTAINS INTERNAL @OZ00751*/ 04858000
*/*            POINTERS AND IF THE CATALOG IS MOVED THEN     @OZ00751*/ 04859000
*/*            THE INTERNAL POINTERS MUST BE ADJUSTED        @OZ00751*/ 04860000
*/*            CORRECTLY.                                    @OZ00751*/ 04861000
*/*              WHEN A CATALOG IS DEFINED THEN THE SPACE    @OZ00751*/ 04862000
*/*            GIVEN IS SPLIT INTO A LOW KEY RANGE AND A HIGH@OZ00751*/ 04863000
*/*            KEY RANGE (ALSO CALLED THE TRUENAME RANGE). A @OZ00751*/ 04864000
*/*            CATALOG WOULD LOOK LIKE THIS WHEN FIRST       @OZ00751*/ 04865000
*/*            DEFINED.                                      @OZ00751*/ 04866000
*/*                          -------------                   @OZ00751*/ 04867000
*/*                      *   |  LOW-KEY  |  FIRST DATA       @OZ00751*/ 04868000
*/*                 DATA *   |  RANGE    |  EXTENT           @OZ00751*/ 04869000
*/*                      *   |           |                   @OZ00751*/ 04870000
*/*                          -------------                   @OZ00751*/ 04871000
*/*                INDEX *   | INDEX     |  FIRST INDX EXTENT@OZ00751*/ 04872000
*/*                          -------------                   @OZ00751*/ 04873000
*/*                      *   | TRUENAME  |  SECOND DATA      @OZ00751*/ 04874000
*/*                 DATA *   | RANGE     |                   @OZ00751*/ 04875000
*/*                          -------------                   @OZ00751*/ 04876000
*/*            TO TAKE A COMPLICATED EXAMPLE:                @OZ00751*/ 04877000
*/*            AFTER A PERIOD OF USE THE BACKUP CATALOG      @OZ00751*/ 04878000
*/*            AND A NEWLY DEFINED TARGET ON THE SAME        @OZ00751*/ 04879000
*/*            VOLUME WITH THE SAME NAME MIGHT HAVE A        @OZ00751*/ 04880000
*/*            STRUCTURE LIKE.                               @OZ00751*/ 04881000
*/*   BACKUP                            TARGET               @OZ00751*/ 04882000
*/*   DATA STRUCTURE                    DATA STRUCTURE       @OZ00751*/ 04883000
*/*                                                          @OZ00751*/ 04884000
*/*-----------                       -----------             @OZ00751*/ 04885000
*/*| 1ST LKR |                       |         |             @OZ00751*/ 04886000
*/*|---------| *                     |         |             @OZ00751*/ 04887000
*/*| 1ST HKR | *LET X= RBA RANGE     |         |             @OZ00751*/ 04888000
*/*|---------| *                     | 1ST LKR |             @OZ00751*/ 04889000
*/*| 2ND LKR |                       |         |             @OZ00751*/ 04890000
*/*|---------|                       |         |             @OZ00751*/ 04891000
*/*| 3RD LKR |                       |---------|*            @OZ00751*/ 04892000
*/*|---------| *                     | 1ST HKR |*LET Z= RBA  @OZ00751*/ 04893000
*/*| 2ND HKR | *LET Y= RBA RANGE     |         |* RANGE      @OZ00751*/ 04894000
*/*|---------| *                     |---------|*            @OZ00751*/ 04895000
*/*| 4TH LKR |                                               @OZ00751*/ 04896000
*/*|---------|                                               @OZ00751*/ 04897000
*/*            IT CAN BE SEEN,FOR EXAMPLE,THAT A POINTER     @OZ00751*/ 04898000
*/*            TO A RECORD IN THE 4TH LOW KEY RANGE ON THE   @OZ00751*/ 04899000
*/*            BACKUP WOULD HAVE TO BE ADJUSTED WHEN THE     @OZ00751*/ 04900000
*/*            DATA SET IS COPIED,SINCE IT IS COPIED IN      @OZ00751*/ 04901000
*/*            KEY SEQUENCE.                                 @OZ00751*/ 04902000
*/*              IF THE NEW RECORD POSITION IS BELOW THE     @OZ00751*/ 04903000
*/*            TRUENAME RANGE OF THE TARGET THEN THE         @OZ00751*/ 04904000
*/*            ADJUSTMENT WOULD BE                           @OZ00751*/ 04905000
*/*                                                          @OZ00751*/ 04906000
*/*              NEW RBA  = OLD RBA -X -Y                    @OZ00751*/ 04907000
*/*              IF THE RECORD WILL NOT FIT THEN A NEW DATA  @OZ00751*/ 04908000
*/*            EXTENT IS OBTAINED FOR THE LOW KEY RANGE AND  @OZ00751*/ 04909000
*/*            THE ADJUSTMENT WOULD BE                       @OZ00751*/ 04910000
*/*                                                          @OZ00751*/ 04911000
*/*              NEW RBA  = OLD RBA -X -Y +Z                 @OZ00751*/ 04912000
*/*******                                                    *********/ 04913000
*/* INPUT -    CATALOG CI # 7  RECORDS SERVE AS THE          @OZ00751*/ 04914000
*/*            INFORMATION TO BUILD THE TRUENAME             @OZ00751*/ 04915000
*/*            EXTENTS                                       @OZ00751*/ 04916000
*/*                                                          @OZ00751*/ 04917000
*/* OUTPUT-    STBL WHICH IS A SOURCE TABLE AND STBLDIM      @OZ00751*/ 04918000
*/*            WHICH IS THE NUMBER OF ENTRIES IN THE TABLE   @OZ00751*/ 04919000
*/*            ARE INITIALISED. SIMILARLY FOR THE TAGET TABLE@OZ00751*/ 04920000
*/*                                                          @OZ00751*/ 04921000
*/********************************************************************/ 04922000
*        /************************************************************/ 04923000
*         /*                                                 @OZ00751*/ 04924000
*        /* POINT TO THE INPUT RECORD7 AND THENCE TO         @OZ00751*/ 04925000
*        /* THE FIRST EXTENT FIELD. SET NUMBER OF ENTRIES    @OZ00751*/ 04926000
*        /*                                                  @OZ00751*/ 04927000
*        /************************************************************/ 04928000
*                                                                  1212 04929000
*        RFY RREC RSTD;                                    /*@OZ00751*/ 04930000
*                                                                  1212 04931000
*        OLDERID2 = NEWERID2;                                      1213 04932000
         L     @08,@PC00001                                        1213 04933000
         L     @08,GDTTR2(,@08)                                    1213 04934000
         MVC   @TS00001(95),NEWERID2(@08)                          1213 04935000
         MVC   OLDERID2(95,@08),@TS00001                           1213 04936000
*        NEWID2='RPT2';                                    /*@OZ00751*/ 04937000
*                                                                  1214 04938000
         MVC   NEWID2(4,@08),@CC01235                              1214 04939000
*        RREC = IOCSINP -> IOCDAD;                         /*@OZ00751*/ 04940000
         L     @08,IOCSINP                                         1215 04941000
         L     RREC,IOCDAD(,@08)                                   1215 04942000
*        RREC = ADDR(REC7INDX) + REC7OFFS + 6;             /*@OZ00751*/ 04943000
         LA    @08,REC7INDX(,RREC)                                 1216 04944000
         MVC   @ZT00003+3(1),REC7OFFS(RREC)                        1216 04945000
         AL    @08,@ZT00003                                        1216 04946000
         AH    @08,@CH00156                                        1216 04947000
         LR    RREC,@08                                            1216 04948000
*        STBLDIM = REC7LNEX/LENGTH(REC7XTNT);              /*@OZ00751*/ 04949000
*                                                                  1217 04950000
         MVC   @TF00001(2),REC7LNEX(RREC)                          1217 04951000
         LH    @00,@TF00001                                        1217 04952000
         SRDA  @00,32                                              1217 04953000
         D     @00,@CF01276                                        1217 04954000
         ST    @01,STBLDIM                                         1217 04955000
*        /************************************************************/ 04956000
*        /*                                                  @OZ00751*/ 04957000
*        /* LOOP UP THE EXTENT ENTRIES CALCULATING AND       @OZ00751*/ 04958000
*        /* STORING THE HIGH CI #S. AND THE ASSOCIATED       @OZ00751*/ 04959000
*        /* GAP MEASURED IN CI 3S                            @OZ00751*/ 04960000
*        /*                                                  @OZ00751*/ 04961000
*        /************************************************************/ 04962000
*                                                                  1218 04963000
*        DO I = 1 TO STBLDIM;                              /*@OZ00751*/ 04964000
*                                                                  1218 04965000
         LA    I,1                                                 1218 04966000
         B     @DE01218                                            1218 04967000
@DL01218 DS    0H                                                  1219 04968000
*          STBLHI(I) = REC7HRBA(I)/CILEN;                  /*@OZ00751*/ 04969000
         LR    @08,I                                               1219 04970000
         SLA   @08,3                                               1219 04971000
         LA    @15,512                                             1219 04972000
         LR    @14,I                                               1219 04973000
         MH    @14,@CH01276                                        1219 04974000
         ST    @14,@TF00001                                        1219 04975000
         ALR   @14,RREC                                            1219 04976000
         BCTR  @14,0                                               1219 04977000
         BCTR  @14,0                                               1219 04978000
         MVC   @TF00002(4),REC7HRBA-18(@14)                        1219 04979000
         L     @14,@TF00002                                        1219 04980000
         LR    @00,@14                                             1219 04981000
         SRDA  @00,32                                              1219 04982000
         DR    @00,@15                                             1219 04983000
         ST    @01,STBLHI-8(@08)                                   1219 04984000
*          STBLGAP(I) = (REC7HRBA(I) - REC7LRBA(I))/CILEN          1220 04985000
*                      +1 ;                                /*@OZ00751*/ 04986000
*                                                                  1220 04987000
         LR    @01,RREC                                            1220 04988000
         AL    @01,@TF00001                                        1220 04989000
         AL    @01,@CF01305                                        1220 04990000
         MVC   @TF00001(4),REC7LRBA-14(@01)                        1220 04991000
         SL    @14,@TF00001                                        1220 04992000
         ST    @15,@TF00001                                        1220 04993000
         SRDA  @14,32                                              1220 04994000
         D     @14,@TF00001                                        1220 04995000
         AH    @15,@CH00219                                        1220 04996000
         ST    @15,STBLGAP-8(@08)                                  1220 04997000
*        END;                                              /*@OZ00751*/ 04998000
*                                                                  1221 04999000
         AH    I,@CH00219                                          1221 05000000
@DE01218 C     I,STBLDIM                                           1221 05001000
         BNH   @DL01218                                            1221 05002000
*        /************************************************************/ 05003000
*        /*                                                  @OZ00751*/ 05004000
*        /* THE ABOVE SOURCE TABLE INITIALISING IS           @OZ00751*/ 05005000
*        /* REPEATED IN A SIMILAR MANNER FOR THE             @OZ00751*/ 05006000
*        /* TARGET                                           @OZ00751*/ 05007000
*        /*                                                  @OZ00751*/ 05008000
*        /************************************************************/ 05009000
*                                                                  1222 05010000
*        RREC = IOCSOUP -> IOCDAD;                         /*@OZ00751*/ 05011000
         L     @08,IOCSOUP                                         1222 05012000
         L     RREC,IOCDAD(,@08)                                   1222 05013000
*        RREC = ADDR(REC7INDX) + REC7OFFS + 6;             /*@OZ00751*/ 05014000
         LA    @08,REC7INDX(,RREC)                                 1223 05015000
         MVC   @ZT00003+3(1),REC7OFFS(RREC)                        1223 05016000
         AL    @08,@ZT00003                                        1223 05017000
         AH    @08,@CH00156                                        1223 05018000
         LR    RREC,@08                                            1223 05019000
*        TTBLDIM = REC7LNEX/LENGTH(REC7XTNT);              /*@OZ00751*/ 05020000
*                                                                  1224 05021000
         MVC   @TF00001(2),REC7LNEX(RREC)                          1224 05022000
         LH    @00,@TF00001                                        1224 05023000
         SRDA  @00,32                                              1224 05024000
         D     @00,@CF01276                                        1224 05025000
         ST    @01,TTBLDIM                                         1224 05026000
*        DO I = 1 TO TTBLDIM;                              /*@OZ00751*/ 05027000
*                                                                  1225 05028000
         LA    I,1                                                 1225 05029000
         B     @DE01225                                            1225 05030000
@DL01225 DS    0H                                                  1226 05031000
*          TTBLHI(I) = REC7HRBA(I)/CILEN;                  /*@OZ00751*/ 05032000
         LR    @08,I                                               1226 05033000
         SLA   @08,3                                               1226 05034000
         LA    @15,512                                             1226 05035000
         LR    @14,I                                               1226 05036000
         MH    @14,@CH01276                                        1226 05037000
         ST    @14,@TF00001                                        1226 05038000
         ALR   @14,RREC                                            1226 05039000
         BCTR  @14,0                                               1226 05040000
         BCTR  @14,0                                               1226 05041000
         MVC   @TF00002(4),REC7HRBA-18(@14)                        1226 05042000
         L     @14,@TF00002                                        1226 05043000
         LR    @00,@14                                             1226 05044000
         SRDA  @00,32                                              1226 05045000
         DR    @00,@15                                             1226 05046000
         ST    @01,TTBLHI-8(@08)                                   1226 05047000
*          TTBLGAP(I) = (REC7HRBA(I) - REC7LRBA(I))/CILEN          1227 05048000
*                      +1;                                 /*@OZ00751*/ 05049000
*                                                                  1227 05050000
         LR    @01,RREC                                            1227 05051000
         AL    @01,@TF00001                                        1227 05052000
         AL    @01,@CF01305                                        1227 05053000
         MVC   @TF00001(4),REC7LRBA-14(@01)                        1227 05054000
         SL    @14,@TF00001                                        1227 05055000
         ST    @15,@TF00001                                        1227 05056000
         SRDA  @14,32                                              1227 05057000
         D     @14,@TF00001                                        1227 05058000
         AH    @15,@CH00219                                        1227 05059000
         ST    @15,TTBLGAP-8(@08)                                  1227 05060000
*        END;                                              /*@OZ00751*/ 05061000
*                                                                  1228 05062000
         AH    I,@CH00219                                          1228 05063000
@DE01225 C     I,TTBLDIM                                           1228 05064000
         BNH   @DL01225                                            1228 05065000
*        IF GDTDBG = NULLPTR                               /*@OZ00751*/ 05066000
*          THEN;                                           /*@OZ00751*/ 05067000
         L     @08,@PC00001                                        1229 05068000
         L     @08,GDTDBG(,@08)                                    1229 05069000
         LTR   @08,@08                                             1229 05070000
         BZ    @RT01229                                            1229 05071000
*          ELSE                                                    1231 05072000
*            DO;                                           /*@OZ00751*/ 05073000
*                                                                  1231 05074000
*            DMPINDEX = ADDR(DUMPAREA);                    /*@OZ00751*/ 05075000
         LA    @08,DUMPAREA                                        1232 05076000
         ST    @08,DMPINDEX                                        1232 05077000
*            DMPITMNM = 'SORSTABL';                        /*@OZ00751*/ 05078000
         MVC   DMPITMNM(8,@08),@CC01236                            1233 05079000
*            DMPITMPT = ADDR(STBL);                        /*@OZ00751*/ 05080000
         LA    @02,STBL                                            1234 05081000
         ST    @02,DMPITMPT(,@08)                                  1234 05082000
*            DMPITMLN = STBLDIM * 8;                       /*@OZ00751*/ 05083000
         L     @02,STBLDIM                                         1235 05084000
         SLA   @02,3                                               1235 05085000
         STH   @02,DMPITMLN(,@08)                                  1235 05086000
*            DMPITMTP = 'H';                               /*@OZ00751*/ 05087000
         MVI   DMPITMTP(@08),C'H'                                  1236 05088000
*            DMPINDEX = DMPINDEX + DMPELEMT;               /*@OZ00751*/ 05089000
         LA    @02,16                                              1237 05090000
         ALR   @08,@02                                             1237 05091000
         ST    @08,DMPINDEX                                        1237 05092000
*            DMPITMNM = 'TARGTABL';                        /*@OZ00751*/ 05093000
         MVC   DMPITMNM(8,@08),@CC01237                            1238 05094000
*            DMPITMPT = ADDR(TTBL);                        /*@OZ00751*/ 05095000
         LA    @15,TTBL                                            1239 05096000
         ST    @15,DMPITMPT(,@08)                                  1239 05097000
*            DMPITMLN = TTBLDIM * 8;                       /*@OZ00751*/ 05098000
         L     @15,TTBLDIM                                         1240 05099000
         SLA   @15,3                                               1240 05100000
         STH   @15,DMPITMLN(,@08)                                  1240 05101000
*            DMPITMTP = 'H';                               /*@OZ00751*/ 05102000
         MVI   DMPITMTP(@08),C'H'                                  1241 05103000
*            DMPINDEX = DMPINDEX + DMPELEMT;               /*@OZ00751*/ 05104000
         ALR   @08,@02                                             1242 05105000
         ST    @08,DMPINDEX                                        1242 05106000
*            DMPTRM =  DMPTRMVL;                           /*@OZ00751*/ 05107000
         MVI   DMPTRM(@08),X'FF'                                   1243 05108000
*            IF GDTDBG = NULLPTR                                   1244 05109000
*              THEN;                                               1244 05110000
         L     @08,@PC00001                                        1244 05111000
         L     @08,GDTDBG(,@08)                                    1244 05112000
         LTR   @08,@08                                             1244 05113000
         BZ    @RT01244                                            1244 05114000
*              ELSE                                                1246 05115000
*                CALL IDCDB010 (GDTTBL,'RPTU',ADDR(DUMPAREA));     1246 05116000
         L     @08,@PC00001                                        1246 05117000
         ST    @08,@AL00001                                        1246 05118000
         LA    @02,@CC01238                                        1246 05119000
         ST    @02,@AL00001+4                                      1246 05120000
         LA    @02,DUMPAREA                                        1246 05121000
         ST    @02,@AFTEMPS+4                                      1246 05122000
         LA    @02,@AFTEMPS+4                                      1246 05123000
         ST    @02,@AL00001+8                                      1246 05124000
         MVI   @AL00001+8,X'80'                                    1246 05125000
         L     @15,GDTDBG(,@08)                                    1246 05126000
         LA    @01,@AL00001                                        1246 05127000
         BALR  @14,@15                                             1246 05128000
*                                                          /*@OZ00751*/ 05129000
*                                                                  1247 05130000
*            END;                                          /*@OZ00751*/ 05131000
*                                                                  1247 05132000
*        END TRUENAME;                                             1248 05133000
@EL00008 DS    0H                                                  1248 05134000
@EF00008 DS    0H                                                  1248 05135000
@ER00008 LM    @14,@12,@SA00008                                    1248 05136000
         BR    @14                                                 1248 05137000
*                                                                  1249 05138000
*CATRANS:                                                          1249 05139000
*        PROC;                                             /*@OZ00751*/ 05140000
*                                                                  1249 05141000
CATRANS  STM   @14,@12,@SA00009                                    1249 05142000
*        OLDERID2 = NEWERID2;                                      1250 05143000
         L     @08,@PC00001                                        1250 05144000
         L     @08,GDTTR2(,@08)                                    1250 05145000
         MVC   @TS00001(95),NEWERID2(@08)                          1250 05146000
         MVC   OLDERID2(95,@08),@TS00001                           1250 05147000
*        NEWID2='RPT3';                                    /*@OZ00751*/ 05148000
*                                                                  1251 05149000
         MVC   NEWID2(4,@08),@CC01242                              1251 05150000
*/********************************************************************/ 05151000
*/*                                                          @OZ00751*/ 05152000
*/* PROCEDURE NAME - CATRANS                                 @OZ00751*/ 05153000
*/* FUNCTION -                                               @OZ00751*/ 05154000
*/*                                                          @OZ00751*/ 05155000
*/* THE BASIC JOB OF THE CATRANS PROCEEDURE IS TO FIND       @OZ00751*/ 05156000
*/* EACH CI NUMBER IN A CATALOG RECORD AND CONVERT THE       @OZ00751*/ 05157000
*/* NUMBER FROM ITS SOURCE CATALOG VALUE TO THE APPROPRIATE  @OZ00751*/ 05158000
*/* VALUE FOR THE TARGET CATALOG.                            @OZ00751*/ 05159000
*/*                                                          @OZ00751*/ 05160000
*/* INPUT - THE BACKUP CATALOG RECORD.                       @OZ00751*/ 05161000
*/* OUTPUT - THE CONVERTED BACKUP RECORD                     @OZ00751*/ 05162000
*/*                                                          @OZ00751*/ 05163000
*/********************************************************************/ 05164000
*                                                                  1252 05165000
*                                                                  1252 05166000
*        /************************************************************/ 05167000
*        /*                                                  @OZ00751*/ 05168000
*        /* IF THE RECORD IS IN THE HIGH KEY RANGE TRANSLATE @OZ00751*/ 05169000
*        /* IT.                                              @OZ00751*/ 05170000
*        /*                                                  @OZ00751*/ 05171000
*        /************************************************************/ 05172000
*                                                                  1252 05173000
*        IF RCDKEYTY ^= NULL                                       1252 05174000
*          THEN                                                    1252 05175000
         L     @08,IOCSPTR                                         1252 05176000
         L     @08,IOCDAD(,@08)                                    1252 05177000
         CLI   RCDKEYTY(@08),0                                     1252 05178000
         BE    @RF01252                                            1252 05179000
*            DO;                                           /*@OZ00751*/ 05180000
*                                                                  1253 05181000
*            RCIADDR = ADDR(HKCINO);                       /*@OZ00751*/ 05182000
         LA    RCIADDR,HKCINO(,@08)                                1254 05183000
*            CALL CNVRTCI;                                 /*@OZ00751*/ 05184000
         BAL   @14,CNVRTCI                                         1255 05185000
*            END;                                          /*@OZ00751*/ 05186000
*                                                                  1256 05187000
*          ELSE                                                    1257 05188000
*            DO;                                           /*@OZ00751*/ 05189000
*                                                                  1257 05190000
         B     @RC01252                                            1257 05191000
@RF01252 DS    0H                                                  1258 05192000
*            /********************************************************/ 05193000
*            /*                                              @OZ00751*/ 05194000
*            /* IF RECORD IS IN THE LOW KEY RANGE TRANSLATE  @OZ00751*/ 05195000
*            /* THE ENTRY ID.                                @OZ00751*/ 05196000
*            /*                                              @OZ00751*/ 05197000
*            /********************************************************/ 05198000
*                                                                  1258 05199000
*            RCIADDR = ADDR(RCDCINO);                      /*@OZ00751*/ 05200000
         L     @08,IOCSPTR                                         1258 05201000
         L     RCIADDR,IOCDAD(,@08)                                1258 05202000
         LA    RCIADDR,RCDCINO(,RCIADDR)                           1258 05203000
*            CALL CNVRTCI;                                 /*@OZ00751*/ 05204000
*                                                                  1259 05205000
*                                                                  1259 05206000
         BAL   @14,CNVRTCI                                         1259 05207000
*            /********************************************************/ 05208000
*            /*                                                      */ 05209000
*            /* IF  THE RECORD IS A CATALOG FREE RECORD THEN         */ 05210000
*            /* THE POINTER TO THE NEXT CI NUMBER IN THE             */ 05211000
*            /* DELETE CHAIN HAS TO BE CONVERTED.                    */ 05212000
*            /*                                                      */ 05213000
*            /********************************************************/ 05214000
*                                                                  1260 05215000
*            IF RCDID = 'F'                                        1260 05216000
*              THEN                                                1260 05217000
         L     @08,IOCSPTR                                         1260 05218000
         L     @08,IOCDAD(,@08)                                    1260 05219000
         CLI   RCDID(@08),C'F'                                     1260 05220000
         BNE   @RF01260                                            1260 05221000
*                DO;                                       /*@OZ00751*/ 05222000
*                                                                  1261 05223000
*                CFRNEXT = CFROLD;                         /*@OZ00751*/ 05224000
         MVC   CFRNEXT+45(3,@08),CFROLD                            1262 05225000
*                CFROLD  = RCDCINO;                        /*@OZ00751*/ 05226000
         MVC   CFROLD(3),RCDCINO(@08)                              1263 05227000
*                FREENUM = FREENUM + 1;                    /*@OZ00751*/ 05228000
*                                                                  1264 05229000
         LA    @08,1                                               1264 05230000
         AL    @08,FREENUM                                         1264 05231000
         ST    @08,FREENUM                                         1264 05232000
*                END;                                      /*@OZ00751*/ 05233000
*                                                                  1265 05234000
*              ELSE                                                1266 05235000
*                DO;                                       /*@OZ00751*/ 05236000
*                                                                  1266 05237000
         B     @RC01260                                            1266 05238000
@RF01260 DS    0H                                                  1267 05239000
*                /****************************************************/ 05240000
*                /*                                          @OZ00751*/ 05241000
*                /* CHECK FOR VALID RECORD TYPE USING RCIADDR@OZ00751*/ 05242000
*                /* AS THE INDICATION TO LEAVE THE LOOP.     @OZ00751*/ 05243000
*                /*                                          @OZ00751*/ 05244000
*                /****************************************************/ 05245000
*                                                                  1267 05246000
*                RFY RCIADDR RSTD;                         /*@OZ00751*/ 05247000
*                RCIADDR = NULL;                           /*@OZ00751*/ 05248000
*                                                                  1268 05249000
         SLR   RCIADDR,RCIADDR                                     1268 05250000
*                  DO COMFTBLX = 1 TO 13                   /*@Y30SSEC*/ 05251000
*                    WHILE RCIADDR = NULL;                 /*@OZ00751*/ 05252000
*                                                                  1269 05253000
         LA    COMFTBLX,1                                          1269 05254000
@DL01269 LTR   RCIADDR,RCIADDR                                     1269 05255000
         BNZ   @DC01269                                            1269 05256000
*                    IF RCDID = COMFTBL(COMFTBLX)                  1270 05257000
*                      THEN                                        1270 05258000
         L     @08,IOCSPTR                                         1270 05259000
         L     @08,IOCDAD(,@08)                                    1270 05260000
         LA    @02,COMFTBL-1(COMFTBLX)                             1270 05261000
         CLC   RCDID(1,@08),0(@02)                                 1270 05262000
         BNE   @RF01270                                            1270 05263000
*                        DO;                               /*@OZ00751*/ 05264000
*                                                                  1271 05265000
*                        /********************************************/ 05266000
*                        /*                                  @OZ00751*/ 05267000
*                        /* FIND THE EXTENSION RECORD POINTER@OZ00751*/ 05268000
*                        /* AND THEN CONVERT IT. TO FIND THE @OZ00751*/ 05269000
*                        /* POINTER, POINT PAST THE FIXED    @OZ00751*/ 05270000
*                        /* FIELDS AND BUMP PAST EACH        @OZ00751*/ 05271000
*                        /* VARIABLE FIELD TO THE REPEATING  @OZ00751*/ 05272000
*                        /* CONTROL INFO FIELDS.             @OZ00751*/ 05273000
*                        /*                                  @OZ00751*/ 05274000
*                        /********************************************/ 05275000
*                                                                  1272 05276000
*                        RFY RREC RSTD;                    /*@OZ00751*/ 05277000
*                                                                  1272 05278000
*                        RREC = IOCDAD + NREPLF;           /*@OZ00751*/ 05279000
*                                                                  1273 05280000
         SLR   RREC,RREC                                           1273 05281000
         IC    RREC,NREPLF(,@08)                                   1273 05282000
         ALR   RREC,@08                                            1273 05283000
*                        RFY VARFIELD BASED(RREC);         /*@OZ00751*/ 05284000
*                                                                  1274 05285000
*                          DO I   = 1 TO NREPCV;           /*@OZ00751*/ 05286000
         LA    I,1                                                 1275 05287000
         B     @DE01275                                            1275 05288000
@DL01275 DS    0H                                                  1276 05289000
*                            RREC = RREC + VARLEN                  1276 05290000
*                            + LENGTH(VARLEN);             /*@OZ00751*/ 05291000
         LR    @08,RREC                                            1276 05292000
         AH    @08,VARLEN(,RREC)                                   1276 05293000
         AL    @08,@CF00153                                        1276 05294000
         LR    RREC,@08                                            1276 05295000
*                          END;                            /*@OZ00751*/ 05296000
*                                                                  1277 05297000
*                                                                  1277 05298000
         AH    I,@CH00219                                          1277 05299000
@DE01275 L     @08,IOCSPTR                                         1277 05300000
         L     @08,IOCDAD(,@08)                                    1277 05301000
         MVC   @ZT00003+3(1),NREPCV(@08)                           1277 05302000
         C     I,@ZT00003                                          1277 05303000
         BNH   @DL01275                                            1277 05304000
*                        RFY REPCNTRL BASED(RREC);         /*@OZ00751*/ 05305000
*                                                                  1278 05306000
*                        RCIADDR = ADDR(EXTGOCI);          /*@OZ00751*/ 05307000
         LR    RCIADDR,RREC                                        1279 05308000
*                        CALL CNVRTCI;                     /*@OZ00751*/ 05309000
*                                                                  1280 05310000
         BAL   @14,CNVRTCI                                         1280 05311000
*                        /********************************************/ 05312000
*                        /*                                  @OZ00751*/ 05313000
*                        /* THE NEXT THING TO BE PROCESSED IS@OZ00751*/ 05314000
*                        /* THE GROUP OCCURRENCE POINTERS.   @OZ00751*/ 05315000
*                        /* THE FIRST STEP IS CALCULATE THE  @OZ00751*/ 05316000
*                        /* G.O.P. LENGTH SINCE THE VOLUME   @OZ00751*/ 05317000
*                        /* G.O.P. LENGTH IS DIFFERENT       @OZ00751*/ 05318000
*                        /*                                  @OZ00751*/ 05319000
*                        /********************************************/ 05320000
*                                                                  1281 05321000
*                        IF RCDID = 'V'  |                         1281 05322000
*                           RCDID = 'W'                            1281 05323000
*                          THEN                                    1281 05324000
         L     @08,IOCSPTR                                         1281 05325000
         L     @08,IOCDAD(,@08)                                    1281 05326000
         CLI   RCDID(@08),C'V'                                     1281 05327000
         BE    @RT01281                                            1281 05328000
         CLI   RCDID(@08),C'W'                                     1281 05329000
         BNE   @RF01281                                            1281 05330000
@RT01281 DS    0H                                                  1282 05331000
*                            GOPLEN = LENGTH(CATGOPT)              1282 05332000
*                                   - LENGTH(CATGOSEQ)             1282 05333000
*                                   + LENGTH(CATSN);       /*@OZ00751*/ 05334000
*                                                                  1282 05335000
         LA    GOPLEN,6                                            1282 05336000
*                          ELSE                                    1283 05337000
*                            GOPLEN = LENGTH(CATGOPT);     /*@OZ00751*/ 05338000
*                                                                  1283 05339000
         B     @RC01281                                            1283 05340000
@RF01281 LA    GOPLEN,5                                            1283 05341000
*                        /********************************************/ 05342000
*                        /*                                  @OZ00751*/ 05343000
*                        /* THE NEXT STEP IS TO SET THE START@OZ00751*/ 05344000
*                        /* OF THE GROUP OCCURRENCES. SINCE  @OZ00751*/ 05345000
*                        /* THIS IS ALSO THE END OF THE GOPS @OZ00751*/ 05346000
*                        /* THIS GIVES US THE TOTAL LENGTH   @OZ00751*/ 05347000
*                        /* OF GOPS.                         @OZ00751*/ 05348000
*                        /*                                  @OZ00751*/ 05349000
*                        /********************************************/ 05350000
*                                                                  1284 05351000
*                        GOSTART = GOPLEN * REPCNT                 1284 05352000
*                                 + ADDR(REPGOPT(1));      /*@OZ00751*/ 05353000
@RC01281 SLR   @01,@01                                             1284 05354000
         IC    @01,REPCNT(,RREC)                                   1284 05355000
         MR    @00,GOPLEN                                          1284 05356000
         LA    GOSTART,REPGOPT(,RREC)                              1284 05357000
         ALR   @01,GOSTART                                         1284 05358000
         LR    GOSTART,@01                                         1284 05359000
*                        L = GOSTART - GOPLEN;             /*@OZ00751*/ 05360000
*                                                                  1285 05361000
         LR    L,GOSTART                                           1285 05362000
         SLR   L,GOPLEN                                            1285 05363000
*                          DO RREC = ADDR(REPGOPT) TO L            1286 05364000
*                                           BY GOPLEN;     /*@OZ00751*/ 05365000
         LA    @08,REPGOPT(,RREC)                                  1286 05366000
         LR    RREC,@08                                            1286 05367000
         B     @DE01286                                            1286 05368000
@DL01286 DS    0H                                                  1287 05369000
*                            RFY CATGOPT BASED(RREC);      /*@OZ00751*/ 05370000
*                                                                  1287 05371000
*                            /****************************************/ 05372000
*                            /*                              @OZ00751*/ 05373000
*                            /* IF THE GOP HAS ITS GO ON     @OZ00751*/ 05374000
*                            /* ANOTHER RECORD THEN THE      @OZ00751*/ 05375000
*                            /* EXTENSION POINTER IN THE     @OZ00751*/ 05376000
*                            /* GOP HAS TO BE TRANSLATED.    @OZ00751*/ 05377000
*                            /*                              @OZ00751*/ 05378000
*                            /****************************************/ 05379000
*                                                                  1288 05380000
*                            IF CATGOEXT = ON                      1288 05381000
*                              THEN                                1288 05382000
         TM    CATGOEXT(RREC),B'10000000'                          1288 05383000
         BNO   @RF01288                                            1288 05384000
*                                DO;                       /*@OZ00751*/ 05385000
*                                                                  1289 05386000
*                                RCIADDR = ADDR(CATGOCI);  /*@OZ00751*/ 05387000
         LR    RCIADDR,RREC                                        1290 05388000
*                                CALL CNVRTCI;             /*@OZ00751*/ 05389000
         BAL   @14,CNVRTCI                                         1291 05390000
*                                END;                      /*@OZ00751*/ 05391000
*                                                                  1292 05392000
*                              ELSE                                1293 05393000
*                                                                  1293 05394000
*                                /************************************/ 05395000
*                                /*                          @OZ00751*/ 05396000
*                                /* IF THE G.O. IS ON THIS   @OZ00751*/ 05397000
*                                /* SAME RECORD AND IF IT IS @OZ00751*/ 05398000
*                                /* A DATA SET DIRECTORY OR  @OZ00751*/ 05399000
*                                /* ASSOCIATION G.O. THEN THE@OZ00751*/ 05400000
*                                /* G.O.HAS A POINTER TO     @OZ00751*/ 05401000
*                                /* CONVERT                  @OZ00751*/ 05402000
*                                /*                          @OZ00751*/ 05403000
*                                /************************************/ 05404000
*                                                                  1293 05405000
*                                IF CATGOGC1 = DSDGC               1293 05406000
*                                  THEN                            1293 05407000
         B     @RC01288                                            1293 05408000
@RF01288 CLI   CATGOGC1(RREC),8                                    1293 05409000
         BNE   @RF01293                                            1293 05410000
*                                    DO;                   /*@OZ00751*/ 05411000
*                                                                  1294 05412000
*                                    RCIADDR = GOSTART             1295 05413000
*                                       + CATGODSP;        /*@OZ00751*/ 05414000
         LR    RCIADDR,GOSTART                                     1295 05415000
         MVC   @TF00001(2),CATGODSP(RREC)                          1295 05416000
         AH    RCIADDR,@TF00001                                    1295 05417000
*                                    RFY CNTRLINF                  1296 05418000
*                                       BASED(RCIADDR);    /*@OZ00751*/ 05419000
*                                    RCIADDR = ADDR(DSDCI);/*@OZ00751*/ 05420000
         LA    @08,DSDCI+1(,RCIADDR)                               1297 05421000
         LR    RCIADDR,@08                                         1297 05422000
*                                    CALL CNVRTCI;         /*@OZ00751*/ 05423000
*                                                                  1298 05424000
         BAL   @14,CNVRTCI                                         1298 05425000
*                                    END;                  /*@OZ00751*/ 05426000
*                                                                  1299 05427000
*                                IF CATGOGC1 = ASGC                1300 05428000
*                                  THEN                            1300 05429000
@RF01293 DS    0H                                                  1300 05430000
@RC01288 CLI   CATGOGC1(RREC),2                                    1300 05431000
         BNE   @RF01300                                            1300 05432000
*                                    DO;                   /*@OZ00751*/ 05433000
*                                                                  1301 05434000
*                                    RCIADDR = GOSTART             1302 05435000
*                                       + CATGODSP;        /*@OZ00751*/ 05436000
         LR    RCIADDR,GOSTART                                     1302 05437000
         MVC   @TF00001(2),CATGODSP(RREC)                          1302 05438000
         AH    RCIADDR,@TF00001                                    1302 05439000
*                                    RFY CNTRLINF                  1303 05440000
*                                       BASED(RCIADDR);    /*@OZ00751*/ 05441000
*                                    RCIADDR = ADDR(ASCI); /*@OZ00751*/ 05442000
         LA    @08,ASCI+1(,RCIADDR)                                1304 05443000
         LR    RCIADDR,@08                                         1304 05444000
*                                    CALL CNVRTCI;         /*@OZ00751*/ 05445000
*                                                                  1305 05446000
         BAL   @14,CNVRTCI                                         1305 05447000
*                                /************************************/ 05448000
*                                /*                          @Y30SSEC*/ 05449000
*                                /* CHECK FOR REL 2 GROUP CODE LEN.  */ 05450000
*                                /* IF SO, PROCESS SECOND CI ENTRY.  */ 05451000
*                                /*                          @Y30SSEC*/ 05452000
*                                /************************************/ 05453000
*                                    RCIADDR = RCIADDR             1306 05454000
*                                              - LENGTH(CNTRLINF)  1306 05455000
*                                              - LENGTH(ASTYPE);   1306 05456000
         SH    RCIADDR,@CH00162                                    1306 05457000
*                                    IF (LENFIX = REL2UPGP) &      1307 05458000
*                                       (ASTYPE = CTGTDATA)/*@OZ09375*/ 05459000
*                                     THEN DO;             /*@Y30SSEC*/ 05460000
         CLI   LENFIX(RCIADDR),10                                  1307 05461000
         BNE   @RF01307                                            1307 05462000
         CLI   ASTYPE+1(RCIADDR),196                               1307 05463000
         BNE   @RF01307                                            1307 05464000
*                                      RCIADDR = RCIADDR           1309 05465000
*                                               + LENGTH(CNTRLINF) 1309 05466000
*                                               + LENGTH(ASGO)     1309 05467000
*                                               + LENGTH(ASTYPE);  1309 05468000
         AH    RCIADDR,@CH00466                                    1309 05469000
*                                      CALL CNVRTCI;       /*@Y30SSEC*/ 05470000
         BAL   @14,CNVRTCI                                         1310 05471000
*                                      END;                /*@Y30SSEC*/ 05472000
*                                     ELSE;                /*@Y30SSEC*/ 05473000
@RF01307 DS    0H                                                  1313 05474000
*                                    END;                  /*@OZ00751*/ 05475000
*                          END;                            /*@OZ00751*/ 05476000
@RF01300 ALR   RREC,GOPLEN                                         1314 05477000
@DE01286 CR    RREC,L                                              1314 05478000
         BNH   @DL01286                                            1314 05479000
*                        END;                              /*@OZ00751*/ 05480000
*                                                                  1315 05481000
*                      RFY RREC UNRSTD;                    /*@OZ00751*/ 05482000
*                                                                  1316 05483000
@RF01270 DS    0H                                                  1317 05484000
*                  END;                                    /*@OZ00751*/ 05485000
         AH    COMFTBLX,@CH00219                                   1317 05486000
         CH    COMFTBLX,@CH00624                                   1317 05487000
         BNH   @DL01269                                            1317 05488000
@DC01269 DS    0H                                                  1318 05489000
*                END;                                      /*@OZ00751*/ 05490000
*                                                                  1318 05491000
*            RFY RCIADDR UNRSTD;                           /*@OZ00751*/ 05492000
*                                                                  1319 05493000
@RC01260 DS    0H                                                  1320 05494000
*            END;                                          /*@OZ00751*/ 05495000
*                                                                  1320 05496000
*        RETURN;                                           /*@OZ00751*/ 05497000
@EL00009 DS    0H                                                  1321 05498000
@EF00009 DS    0H                                                  1321 05499000
@ER00009 LM    @14,@12,@SA00009                                    1321 05500000
         BR    @14                                                 1321 05501000
*CNVRTCI:                                                          1322 05502000
*        PROC;                                                     1322 05503000
*                                                                  1322 05504000
CNVRTCI  STM   @14,@12,@SA00010                                    1322 05505000
*        RFY RCIADDR RSTD;                                         1323 05506000
*                                                                  1323 05507000
*        OLDERID2 = NEWERID2;                                      1324 05508000
         L     @08,@PC00001                                        1324 05509000
         L     @08,GDTTR2(,@08)                                    1324 05510000
         MVC   @TS00001(95),NEWERID2(@08)                          1324 05511000
         MVC   OLDERID2(95,@08),@TS00001                           1324 05512000
*        NEWID2='RPT4';                                    /*@OZ00751*/ 05513000
*                                                                  1325 05514000
         MVC   NEWID2(4,@08),@CC01251                              1325 05515000
*/********************************************************************/ 05516000
*/*                                                          @OZ00751*/ 05517000
*/* PROCEDURE NAME - CONVRTCI                                @OZ00751*/ 05518000
*/*                                                          @OZ00751*/ 05519000
*/* FUNCTION -                                               @OZ00751*/ 05520000
*/* THIS ROUTINE CONVERTS A CONTROL INTERVAL NUMBER          @OZ00751*/ 05521000
*/* CONTAINED IN THE BACKUP CATALOG RECORD TO THE            @OZ00751*/ 05522000
*/* APPROPRIATE VALUE FOR THE TARGET CATALOG. THE            @OZ00751*/ 05523000
*/* ADDRESS OF THE CI # TO BE CONVERTED SHOULD BE            @OZ00751*/ 05524000
*/* PASSED IN 'RCIADDR'. ZERO CI # WILL NOT BE               @OZ00751*/ 05525000
*/* CONVERTED. TERMINAL ERROR WILL BE SET IF                 @OZ00751*/ 05526000
*/* CONVERSION IS NOT POSSIBLE.                              @OZ00751*/ 05527000
*/* INPUT - RCIADDR CONTAINS THE ADDRESS OF THE CI # TO BE   @OZ00751*/ 05528000
*/*         CONVERTED.                                       @OZ00751*/ 05529000
*/* OUTPUT - THE CI # IS CONVERTED                           @OZ00751*/ 05530000
*/*                                                          @OZ00751*/ 05531000
*/********************************************************************/ 05532000
*                                                                  1326 05533000
*        /************************************************************/ 05534000
*        /*                                                  @OZ00751*/ 05535000
*        /* BYPASS ANY FURTHER PROCESSING FOR A ZERO CI #.   @OZ00751*/ 05536000
*        /*                                                  @OZ00751*/ 05537000
*        /************************************************************/ 05538000
*                                                                  1326 05539000
*        NEWCINUM = NULL;                                  /*@OZ00751*/ 05540000
*                                                                  1326 05541000
         SLR   @08,@08                                             1326 05542000
         ST    @08,NEWCINUM                                        1326 05543000
*        IF CINUM ^= NULL                                          1327 05544000
*          THEN                                                    1327 05545000
         LR    @08,RCIADDR                                         1327 05546000
         BCTR  @08,0                                               1327 05547000
         L     @08,CINUM(,@08)                                     1327 05548000
         LA    @08,0(,@08)                                         1327 05549000
         LTR   @08,@08                                             1327 05550000
         BZ    @RF01327                                            1327 05551000
*            DO;                                           /*@OZ00751*/ 05552000
*                                                                  1328 05553000
*            /********************************************************/ 05554000
*            /*                                              @OZ00751*/ 05555000
*            /* SET J WITH A VALUE MINUS ONE TO ACT AS A LOOP@OZ00751*/ 05556000
*            /* EXIT SWITCH. SCAN THE SOURCE TABLE CI #  TO  @OZ00751*/ 05557000
*            /* THE END  OR A LOW COMPARISON IS OBTAINED.    @OZ00751*/ 05558000
*            /*                                              @OZ00751*/ 05559000
*            /********************************************************/ 05560000
*                                                                  1329 05561000
*            WRKCINUM = CINUM;                             /*@OZ00751*/ 05562000
         LR    WRKCINUM,@08                                        1329 05563000
*            J = MINUS1;                                   /*@OZ00751*/ 05564000
*                                                                  1330 05565000
         SLR   J,J                                                 1330 05566000
         BCTR  J,0                                                 1330 05567000
*              DO  I = 1 TO STBLDIM                                1331 05568000
*                WHILE J  < NULL;                          /*@OZ00751*/ 05569000
*                                                                  1331 05570000
         LA    I,1                                                 1331 05571000
         B     @DE01331                                            1331 05572000
@DL01331 LTR   J,J                                                 1331 05573000
         BNM   @DC01331                                            1331 05574000
*                IF CINUM > STBLHI(I)                              1332 05575000
*                  THEN                                            1332 05576000
         LR    @08,I                                               1332 05577000
         SLA   @08,3                                               1332 05578000
         LR    @07,RCIADDR                                         1332 05579000
         BCTR  @07,0                                               1332 05580000
         L     @07,CINUM(,@07)                                     1332 05581000
         LA    @07,0(,@07)                                         1332 05582000
         C     @07,STBLHI-8(@08)                                   1332 05583000
         BNH   @RF01332                                            1332 05584000
*                    WRKCINUM = WRKCINUM - STBLGAP(I);     /*@OZ00751*/ 05585000
         SL    WRKCINUM,STBLGAP-8(@08)                             1333 05586000
*                  ELSE                                            1334 05587000
*                    J = 1;                                /*@OZ00751*/ 05588000
*                                                                  1334 05589000
         B     @RC01332                                            1334 05590000
@RF01332 LA    J,1                                                 1334 05591000
*              END;                                        /*@OZ00751*/ 05592000
*                                                                  1335 05593000
@RC01332 AH    I,@CH00219                                          1335 05594000
@DE01331 C     I,STBLDIM                                           1335 05595000
         BNH   @DL01331                                            1335 05596000
@DC01331 DS    0H                                                  1336 05597000
*            NEWCINUM = WRKCINUM;                          /*@OZ00751*/ 05598000
*                                                                  1336 05599000
         ST    WRKCINUM,NEWCINUM                                   1336 05600000
*            /********************************************************/ 05601000
*            /*                                              @OZ00751*/ 05602000
*            /* SET J  WITH A VALUE MINUS ONE IN ORDER TO ACT@OZ00751*/ 05603000
*            /* AS A LOOP EXIT SWITCH. SCAN THE TARGET TABLE @OZ00751*/ 05604000
*            /* CI #S TILL EITHER A LOW COMPARISON OR THE    @OZ00751*/ 05605000
*            /* END OF THE TABLE IS REACHED.                 @OZ00751*/ 05606000
*            /*                                              @OZ00751*/ 05607000
*            /********************************************************/ 05608000
*                                                                  1337 05609000
*            J = MINUS1;                                   /*@OZ00751*/ 05610000
*                                                                  1337 05611000
         SLR   J,J                                                 1337 05612000
         BCTR  J,0                                                 1337 05613000
*              DO  I = 1 TO TTBLDIM                                1338 05614000
*                WHILE J < NULL;                           /*@OZ00751*/ 05615000
*                                                                  1338 05616000
         LA    I,1                                                 1338 05617000
         B     @DE01338                                            1338 05618000
@DL01338 LTR   J,J                                                 1338 05619000
         BNM   @DC01338                                            1338 05620000
*                IF NEWCINUM > TTBLHI(I) - TTBLGAP(I)              1339 05621000
*                  THEN                                            1339 05622000
         LR    @08,I                                               1339 05623000
         SLA   @08,3                                               1339 05624000
         L     @07,TTBLGAP-8(@08)                                  1339 05625000
         L     @08,TTBLHI-8(@08)                                   1339 05626000
         SLR   @08,@07                                             1339 05627000
         C     @08,NEWCINUM                                        1339 05628000
         BNL   @RF01339                                            1339 05629000
*                    WRKCINUM = WRKCINUM + TTBLGAP(I);     /*@OZ00751*/ 05630000
*                                                                  1340 05631000
         ALR   WRKCINUM,@07                                        1340 05632000
*                  ELSE                                            1341 05633000
*                    J = 1;                                /*@OZ00751*/ 05634000
*                                                                  1341 05635000
         B     @RC01339                                            1341 05636000
@RF01339 LA    J,1                                                 1341 05637000
*              END;                                        /*@OZ00751*/ 05638000
*                                                                  1342 05639000
@RC01339 AH    I,@CH00219                                          1342 05640000
@DE01338 C     I,TTBLDIM                                           1342 05641000
         BNH   @DL01338                                            1342 05642000
@DC01338 DS    0H                                                  1343 05643000
*            NEWCINUM = WRKCINUM;                          /*@OZ00751*/ 05644000
*                                                                  1343 05645000
         ST    WRKCINUM,NEWCINUM                                   1343 05646000
*            END;                                          /*@OZ00751*/ 05647000
*                                                                  1344 05648000
*        IF GDTDBG = NULLPTR                                       1345 05649000
*          THEN;                                           /*@OZ00751*/ 05650000
@RF01327 L     @08,@PC00001                                        1345 05651000
         L     @08,GDTDBG(,@08)                                    1345 05652000
         LTR   @08,@08                                             1345 05653000
         BZ    @RT01345                                            1345 05654000
*          ELSE                                                    1347 05655000
*            DO;                                           /*@OZ00751*/ 05656000
*                                                                  1347 05657000
*            DMPINDEX = ADDR(DUMPAREA);                    /*@OZ00751*/ 05658000
         LA    @08,DUMPAREA                                        1348 05659000
         ST    @08,DMPINDEX                                        1348 05660000
*            DMPITMNM = 'OLDCI#';                          /*@OZ00751*/ 05661000
         MVI   DMPITMNM+6(@08),C' '                                1349 05662000
         MVI   DMPITMNM+7(@08),C' '                                1349 05663000
         MVC   DMPITMNM(6,@08),@CC01252                            1349 05664000
*            DMPITMPT = RCIADDR;                           /*@OZ00751*/ 05665000
         ST    RCIADDR,DMPITMPT(,@08)                              1350 05666000
*            DMPITMLN = 3;                                 /*@OZ00751*/ 05667000
         MVC   DMPITMLN(2,@08),@CH00162                            1351 05668000
*            DMPITMTP = 'F';                               /*@OZ00751*/ 05669000
         MVI   DMPITMTP(@08),C'F'                                  1352 05670000
*            DMPINDEX = DMPINDEX + DMPELEMT;               /*@OZ00751*/ 05671000
         LA    @05,16                                              1353 05672000
         ALR   @08,@05                                             1353 05673000
         ST    @08,DMPINDEX                                        1353 05674000
*            DMPITMNM = 'NEWCI#';                          /*@OZ00751*/ 05675000
         MVI   DMPITMNM+6(@08),C' '                                1354 05676000
         MVI   DMPITMNM+7(@08),C' '                                1354 05677000
         MVC   DMPITMNM(6,@08),@CC01253                            1354 05678000
*            DMPITMPT = ADDR(NEWCINUM);                    /*@OZ00751*/ 05679000
         LA    @15,NEWCINUM                                        1355 05680000
         ST    @15,DMPITMPT(,@08)                                  1355 05681000
*            DMPITMLN = 4;                                 /*@OZ00751*/ 05682000
         MVC   DMPITMLN(2,@08),@CH00042                            1356 05683000
*            DMPITMTP = 'F';                               /*@OZ00751*/ 05684000
         MVI   DMPITMTP(@08),C'F'                                  1357 05685000
*            DMPINDEX = DMPINDEX + DMPELEMT;               /*@OZ00751*/ 05686000
         ALR   @08,@05                                             1358 05687000
         ST    @08,DMPINDEX                                        1358 05688000
*            DMPTRM = DMPTRMVL;                            /*@OZ00751*/ 05689000
         MVI   DMPTRM(@08),X'FF'                                   1359 05690000
*            IF GDTDBG = NULLPTR                                   1360 05691000
*              THEN;                                               1360 05692000
         L     @08,@PC00001                                        1360 05693000
         L     @08,GDTDBG(,@08)                                    1360 05694000
         LTR   @08,@08                                             1360 05695000
         BZ    @RT01360                                            1360 05696000
*              ELSE                                                1362 05697000
*                CALL IDCDB010 (GDTTBL,'RPCI',ADDR(DUMPAREA));     1362 05698000
         L     @08,@PC00001                                        1362 05699000
         ST    @08,@AL00001                                        1362 05700000
         LA    @05,@CC01254                                        1362 05701000
         ST    @05,@AL00001+4                                      1362 05702000
         LA    @05,DUMPAREA                                        1362 05703000
         ST    @05,@AFTEMPS+8                                      1362 05704000
         LA    @05,@AFTEMPS+8                                      1362 05705000
         ST    @05,@AL00001+8                                      1362 05706000
         MVI   @AL00001+8,X'80'                                    1362 05707000
         L     @15,GDTDBG(,@08)                                    1362 05708000
         LA    @01,@AL00001                                        1362 05709000
         BALR  @14,@15                                             1362 05710000
*                                                          /*@OZ00751*/ 05711000
*                                                                  1363 05712000
*            END;                                          /*@OZ00751*/ 05713000
*                                                                  1363 05714000
@RT01360 DS    0H                                                  1364 05715000
*        IF CINUM ^= NULL                                          1364 05716000
*          THEN                                                    1364 05717000
@RT01345 LR    @08,RCIADDR                                         1364 05718000
         BCTR  @08,0                                               1364 05719000
         L     @08,CINUM(,@08)                                     1364 05720000
         LA    @08,0(,@08)                                         1364 05721000
         LTR   @08,@08                                             1364 05722000
         BZ    @RF01364                                            1364 05723000
*            CINUM = NEWCINUM;                             /*@OZ00751*/ 05724000
*                                                                  1365 05725000
         MVC   CINUM(3,RCIADDR),NEWCINUM+1                         1365 05726000
*        END CNVRTCI;                                      /*@OZ00751*/ 05727000
*                                                                  1366 05728000
@EL00010 DS    0H                                                  1366 05729000
@EF00010 DS    0H                                                  1366 05730000
@ER00010 LM    @14,@12,@SA00010                                    1366 05731000
         BR    @14                                                 1366 05732000
*        END CATRANS;                                      /*@OZ00751*/ 05733000
         B     @EL00009                                            1367 05734000
*CATCOMP: PROC;                                                    1368 05735000
*                                                                  1368 05736000
CATCOMP  STM   @14,@04,@SA00011                                    1368 05737000
         STM   @06,@12,@SA00011+28                                 1368 05738000
*        OLDERID2 = NEWERID2;                                      1369 05739000
         L     @08,@PC00001                                        1369 05740000
         L     @08,GDTTR2(,@08)                                    1369 05741000
         MVC   @TS00001(95),NEWERID2(@08)                          1369 05742000
         MVC   OLDERID2(95,@08),@TS00001                           1369 05743000
*        NEWID2='RPT5';                                    /*@OZ00751*/ 05744000
*                                                                  1370 05745000
         MVC   NEWID2(4,@08),@CC01258                              1370 05746000
*/********************************************************************/ 05747000
*/*                                                          @OZ00751*/ 05748000
*/* PROCEDURE NAME - CATCOMP                                 @OZ00751*/ 05749000
*/*                                                          @OZ00751*/ 05750000
*/* FUNCTION.                                                @OZ00751*/ 05751000
*/*                                                          @OZ00751*/ 05752000
*/*      CATCOMP IS INVOKED WHEN THE CATALOG TRUENAME        @OZ00751*/ 05753000
*/*      RECORDS ARE TO BE COMPARED                          @OZ00751*/ 05754000
*/*                                                          @OZ00751*/ 05755000
*/*      1. TO INDICATE DIFFERENCES IN TRUENAME ENTRIES      @OZ00751*/ 05756000
*/*         BETWEEN THE BACKUP AND THE TARGET CATALOG.       @OZ00751*/ 05757000
*/*                                                          @OZ00751*/ 05758000
*/* INPUT - THE BACKUP AND TARGET RECORDS HAVE BEEN READ     @OZ00751*/ 05759000
*/*OUTRUT - A MESSAGE INDICATING THE DIFFERENCE              @OZ00751*/ 05760000
*/*                                                          @OZ00751*/ 05761000
*/********************************************************************/ 05762000
*                                                                  1371 05763000
*        /************************************************************/ 05764000
*        /*                                                          */ 05765000
*        /* IF EITHER IS A TRUENAME RECORD THEN DO TRUENAME          */ 05766000
*        /* PROCESSING.                                              */ 05767000
*        /*                                                          */ 05768000
*        /************************************************************/ 05769000
*                                                                  1371 05770000
*        IF                                                        1371 05771000
*           IOCSOUP -> IOCDAD -> RCDKEYTY ^= NULL &                1371 05772000
*           READSW = READT &                                       1371 05773000
*           ( K < LIMIT | IOCSOUP -> IOCDAD -> RECKEY(9) = '00'X)  1371 05774000
*                                                                  1371 05775000
*        /************************************************************/ 05776000
*        /*                                                  @OZ00751*/ 05777000
*        /* IF LESS THAN 100 COMPARE MSGS AND  THERE EXISTS  @OZ00751*/ 05778000
*        /* A TARGET TRUENAME RECORD WITHOUT A CORRESPONDING @OZ00751*/ 05779000
*        /* BACKUP A COMPARE MESSAGE IS PRINTED AND          @OZ00751*/ 05780000
*        /* THE STATUS FLAG IS SET TO WARNING                @OZ00751*/ 05781000
*        /*                                                  @OZ00751*/ 05782000
*        /************************************************************/ 05783000
*                                                                  1371 05784000
*          THEN                                                    1371 05785000
         L     @08,IOCSOUP                                         1371 05786000
         L     @08,IOCDAD(,@08)                                    1371 05787000
         CLI   RCDKEYTY(@08),0                                     1371 05788000
         BE    @RF01371                                            1371 05789000
         CLI   READSW,X'02'                                        1371 05790000
         BNE   @RF01371                                            1371 05791000
         CH    K,@CH00147                                          1371 05792000
         BL    @RT01371                                            1371 05793000
         CLI   RECKEY+8(@08),X'00'                                 1371 05794000
         BNE   @RF01371                                            1371 05795000
@RT01371 DS    0H                                                  1372 05796000
*            DO;                                           /*@OZ00751*/ 05797000
*                                                                  1372 05798000
*            /* VOL ENTRY IN A TRUENAME RECORD HAS 6 CHAR NAME       */ 05799000
*            IF IOCSOUP -> IOCDAD -> RECKEY(7) = NULL       /*Y30SSEC*/ 05800000
*              THEN                                         /*Y30SSEC*/ 05801000
         L     @08,IOCSOUP                                         1373 05802000
         L     @08,IOCDAD(,@08)                                    1373 05803000
         CLI   RECKEY+6(@08),0                                     1373 05804000
         BNE   @RF01373                                            1373 05805000
*                DARGINL(1) = 6;  /* VOL ENTRY LENGTH        @Y30SSEC*/ 05806000
         L     @08,DDSTRU                                          1374 05807000
         MVC   DARGINL(2,@08),@CH00156                             1374 05808000
*              ELSE                                         /*Y30SSEC*/ 05809000
*                DARGINL(1) = 44; /* TRUE NAME LENGTH        @Y30SSEC*/ 05810000
         B     @RC01373                                            1375 05811000
@RF01373 L     @08,DDSTRU                                          1375 05812000
         MVC   DARGINL(2,@08),@CH00622                             1375 05813000
*            DARGLIST = ''B;                               /*@OZ00751*/ 05814000
@RC01373 L     @08,DDSTRU                                          1376 05815000
         XC    DARGLIST(20,@08),DARGLIST(@08)                      1376 05816000
*            DARGSMOD = 'PR0';                             /*@OZ00751*/ 05817000
         MVC   DARGSMOD(3,@08),@CC01129                            1377 05818000
*            DARGSENT = '17'X;                             /*@OZ00751*/ 05819000
         MVI   DARGSENT(@08),X'17'                                 1378 05820000
*            DARGCNT  = 2;                                 /*@OZ00751*/ 05821000
         LA    @15,2                                               1379 05822000
         STH   @15,DARGCNT(,@08)                                   1379 05823000
*            DARGINS(1) = 1;                               /*@OZ00751*/ 05824000
         MVC   DARGINS(2,@08),@CH00219                             1380 05825000
*            DARGDTM(1) =                   /*ADDRESS OF     @OZ00751*/ 05826000
*            ADDR (IOCSOUP -> IOCDAD -> RECKEY ); /*TRUENAME @OZ00751*/ 05827000
         L     @01,IOCSOUP                                         1381 05828000
         MVC   DARGDTM(4,@08),IOCDAD(@01)                          1381 05829000
*            DARGINS(2) = 2;                               /*@OZ00751*/ 05830000
         STH   @15,DARGINS+8(,@08)                                 1382 05831000
*            DARGINL(2) = 6;                               /*@OZ00751*/ 05832000
         MVC   DARGINL+8(2,@08),@CH00156                           1383 05833000
*            DARGDTM(2) = ADDR(CTARGET);    /*CONSTANT TARGET@OZ00751*/ 05834000
*                                                                  1384 05835000
         LA    @15,CTARGET                                         1384 05836000
         ST    @15,DARGDTM+8(,@08)                                 1384 05837000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@OZ00751*/ 05838000
*                                                                  1385 05839000
         L     @08,@PC00001                                        1385 05840000
         ST    @08,@AL00001                                        1385 05841000
         LA    @15,@CF00115                                        1385 05842000
         ST    @15,@AL00001+4                                      1385 05843000
         LA    @15,DDSTRU                                          1385 05844000
         ST    @15,@AL00001+8                                      1385 05845000
         MVI   @AL00001+8,X'80'                                    1385 05846000
         L     @15,GDTPRT(,@08)                                    1385 05847000
         LA    @01,@AL00001                                        1385 05848000
         BALR  @14,@15                                             1385 05849000
*            STATFLG = ABNCONDT;                           /*@OZ00751*/ 05850000
*                                                                  1386 05851000
         MVC   STATFLG(5),@CB00813                                 1386 05852000
*            K = K + 1;                                    /*@OZ00751*/ 05853000
*                                                                  1387 05854000
         AH    K,@CH00219                                          1387 05855000
*            END;                                          /*@OZ00751*/ 05856000
*                                                                  1388 05857000
*        /************************************************************/ 05858000
*        /*                                                  @OZ00751*/ 05859000
*        /* IF THERE ARE LESS THAN 100 COMPARE MESSAGES AND  @OZ00751*/ 05860000
*        /* THERE IS A BACKUP TRUENAME RECORD WITHOUT A      @OZ00751*/ 05861000
*        /* CORRESPONDING TARGET. A MESSAGE IS PRINTED AND   @OZ00751*/ 05862000
*        /* THE STATUS SET AS BEFORE                         @OZ00751*/ 05863000
*        /*                                                          */ 05864000
*        /************************************************************/ 05865000
*                                                                  1389 05866000
*        IF READSW = READS & (K < LIMIT |                          1389 05867000
*            IOCSINP -> IOCDAD -> RECKEY(9) = '00'X ) &            1389 05868000
*            IOCSINP -> IOCDAD -> RCDKEYTY ^= NULL                 1389 05869000
*                                                                  1389 05870000
*          THEN                                                    1389 05871000
@RF01371 CLI   READSW,X'01'                                        1389 05872000
         BNE   @RF01389                                            1389 05873000
         CH    K,@CH00147                                          1389 05874000
         BL    @GL00081                                            1389 05875000
         L     @08,IOCSINP                                         1389 05876000
         L     @08,IOCDAD(,@08)                                    1389 05877000
         CLI   RECKEY+8(@08),X'00'                                 1389 05878000
         BNE   @RF01389                                            1389 05879000
@GL00081 L     @08,IOCSINP                                         1389 05880000
         L     @08,IOCDAD(,@08)                                    1389 05881000
         CLI   RCDKEYTY(@08),0                                     1389 05882000
         BE    @RF01389                                            1389 05883000
*            DO;                                           /*@OZ00751*/ 05884000
*                                                                  1390 05885000
*            /* VOL ENTRY IN A TRUENAME RECORD HAS 6 CHAR NAME       */ 05886000
*            IF IOCSINP -> IOCDAD -> RECKEY(7) = NULL      /*@Y30SSEC*/ 05887000
*              THEN                                        /*@Y30SSEC*/ 05888000
         CLI   RECKEY+6(@08),0                                     1391 05889000
         BNE   @RF01391                                            1391 05890000
*                DARGINL(1) = 6;  /* VOL ENTRY LENGTH        @Y30SSEC*/ 05891000
         L     @08,DDSTRU                                          1392 05892000
         MVC   DARGINL(2,@08),@CH00156                             1392 05893000
*              ELSE                                        /*@Y30SSEC*/ 05894000
*                DARGINL(1) = 44; /* TRUE NAME LENGTH        @Y30SSEC*/ 05895000
         B     @RC01391                                            1393 05896000
@RF01391 L     @08,DDSTRU                                          1393 05897000
         MVC   DARGINL(2,@08),@CH00622                             1393 05898000
*            DARGLIST = ''B;                               /*@OZ00751*/ 05899000
@RC01391 L     @08,DDSTRU                                          1394 05900000
         XC    DARGLIST(20,@08),DARGLIST(@08)                      1394 05901000
*            DARGSMOD = 'PR0';                             /*@OZ00751*/ 05902000
         MVC   DARGSMOD(3,@08),@CC01129                            1395 05903000
*            DARGSENT = '17'X;                             /*@OZ00751*/ 05904000
         MVI   DARGSENT(@08),X'17'                                 1396 05905000
*            DARGCNT  = 2;                                 /*@OZ00751*/ 05906000
         LA    @15,2                                               1397 05907000
         STH   @15,DARGCNT(,@08)                                   1397 05908000
*            DARGINS(1) = 1;                               /*@OZ00751*/ 05909000
         MVC   DARGINS(2,@08),@CH00219                             1398 05910000
*            DARGDTM(1) =              /*ADDRESS OF TRUENAME @OZ00751*/ 05911000
*            ADDR(IOCSINP -> IOCDAD -> RECKEY );           /*@OZ00751*/ 05912000
         L     @01,IOCSINP                                         1399 05913000
         MVC   DARGDTM(4,@08),IOCDAD(@01)                          1399 05914000
*            DARGINS(2) = 2;                               /*@OZ00751*/ 05915000
         STH   @15,DARGINS+8(,@08)                                 1400 05916000
*            DARGINL(2) = 6;                               /*@OZ00751*/ 05917000
         MVC   DARGINL+8(2,@08),@CH00156                           1401 05918000
*            DARGDTM(2) = ADDR(CBACKUP);                   /*@OZ00751*/ 05919000
*                                                                  1402 05920000
         LA    @15,CBACKUP                                         1402 05921000
         ST    @15,DARGDTM+8(,@08)                                 1402 05922000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@OZ00751*/ 05923000
*                                                                  1403 05924000
         L     @08,@PC00001                                        1403 05925000
         ST    @08,@AL00001                                        1403 05926000
         LA    @15,@CF00115                                        1403 05927000
         ST    @15,@AL00001+4                                      1403 05928000
         LA    @15,DDSTRU                                          1403 05929000
         ST    @15,@AL00001+8                                      1403 05930000
         MVI   @AL00001+8,X'80'                                    1403 05931000
         L     @15,GDTPRT(,@08)                                    1403 05932000
         LA    @01,@AL00001                                        1403 05933000
         BALR  @14,@15                                             1403 05934000
*            STATFLG = ABNCONDT;                           /*@OZ00751*/ 05935000
*                                                                  1404 05936000
         MVC   STATFLG(5),@CB00813                                 1404 05937000
*            K = K + 1;                                    /*@OZ00751*/ 05938000
*                                                                  1405 05939000
         AH    K,@CH00219                                          1405 05940000
*            END;                                          /*@OZ00751*/ 05941000
*                                                                  1406 05942000
*        /***********************************************************/  05943000
*        /*                                                  @OZ00751*/ 05944000
*        /* IF THE NUMBER OF COMPARE MESSAGES IS MORE THAN   @OZ00751*/ 05945000
*        /* 100  THEN PRINT A MESSAGE INDICATING THE         @OZ00751*/ 05946000
*        /* COMPARE FUNCTION IS NO LONGER OPERATING.         @OZ00751*/ 05947000
*        /*                                                  @OZ00751*/ 05948000
*        /************************************************************/ 05949000
*                                                                  1407 05950000
*        IF K = LIMIT                                              1407 05951000
*          THEN                                                    1407 05952000
@RF01389 CH    K,@CH00147                                          1407 05953000
         BNE   @RF01407                                            1407 05954000
*            DO;                                           /*@OZ00751*/ 05955000
*                                                                  1408 05956000
*            DARGLIST = ''B;                               /*@OZ00751*/ 05957000
         L     @08,DDSTRU                                          1409 05958000
         XC    DARGLIST(20,@08),DARGLIST(@08)                      1409 05959000
*            DARGSMOD = 'PR0';                             /*@OZ00751*/ 05960000
         MVC   DARGSMOD(3,@08),@CC01129                            1410 05961000
*            DARGSENT = '16'X;                             /*@OZ00751*/ 05962000
*                                                                  1411 05963000
         MVI   DARGSENT(@08),X'16'                                 1411 05964000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@OZ00751*/ 05965000
*                                                                  1412 05966000
         L     @08,@PC00001                                        1412 05967000
         ST    @08,@AL00001                                        1412 05968000
         LA    @15,@CF00115                                        1412 05969000
         ST    @15,@AL00001+4                                      1412 05970000
         LA    @15,DDSTRU                                          1412 05971000
         ST    @15,@AL00001+8                                      1412 05972000
         MVI   @AL00001+8,X'80'                                    1412 05973000
         L     @15,GDTPRT(,@08)                                    1412 05974000
         LA    @01,@AL00001                                        1412 05975000
         BALR  @14,@15                                             1412 05976000
*            K = K + 1;                                    /*@OZ00751*/ 05977000
*                                                                  1413 05978000
         AH    K,@CH00219                                          1413 05979000
*            STATFLG=ABNCONDT;                             /*@OZ00751*/ 05980000
*                                                                  1414 05981000
         MVC   STATFLG(5),@CB00813                                 1414 05982000
*            END;                                          /*@OZ00751*/ 05983000
*                                                                  1415 05984000
*        END CATCOMP;                                      /*@OZ00751*/ 05985000
*                                                                  1416 05986000
@EL00011 DS    0H                                                  1416 05987000
@EF00011 DS    0H                                                  1416 05988000
@ER00011 LM    @14,@04,@SA00011                                    1416 05989000
         LM    @06,@12,@SA00011+28                                 1416 05990000
         BR    @14                                                 1416 05991000
*VERIFYC:                                                          1417 05992000
*        PROC;                                             /*@OZ00751*/ 05993000
*                                                                  1417 05994000
VERIFYC  STM   @14,@12,@SA00012                                    1417 05995000
*        OLDERID2 = NEWERID2;                                      1418 05996000
         L     @08,@PC00001                                        1418 05997000
         L     @07,GDTTR2(,@08)                                    1418 05998000
         MVC   @TS00001(95),NEWERID2(@07)                          1418 05999000
         MVC   OLDERID2(95,@07),@TS00001                           1418 06000000
*        NEWID2='RPT6';                                    /*@OZ00751*/ 06001000
*                                                                  1419 06002000
         MVC   NEWID2(4,@07),@CC01264                              1419 06003000
*/********************************************************************/ 06004000
*/*                                                          @OZ00751*/ 06005000
*/* PROCEDURE NAME - VERIFYC                                 @OZ00751*/ 06006000
*/*                                                          @OZ00751*/ 06007000
*/* FUNCTION- THE OBJECT CATALOG MUST BE VERIFIED BEFORE     @OZ00751*/ 06008000
*/*            PROCESSING. THE SEQUENCE OF EVENTS IS:        @OZ00751*/ 06009000
*/*         .  CLOSE THE OBJECT(IGNORE ANY CLOSE ERRORS)     @OZ00751*/ 06010000
*/*         .  REOPEN FOR CI PROCESSING                      @OZ00751*/ 06011000
*/*         .  CALL VERIFY FOR THE OBJECT                    @OZ00751*/ 06012000
*/*         .  CLOSE THE OBJECT                              @OZ00751*/ 06013000
*/*         .  REOPEN AS BEFORE                              @OZ00751*/ 06014000
*/*                                                          @OZ00751*/ 06015000
*/* INPUT - POINTER TO A CATALOG OPENED ALREADY AS A VSAM    @OZ00751*/ 06016000
*/*         DATA SET.                                        @OZ00751*/ 06017000
*/*       - THE LOOP COUNTER J WILL HAVE VALUE 1 IF THE      @OZ00751*/ 06018000
*/*         OUTPUT IS BEING VERIFIED AND VALUE 2 IF INPUT    @OZ00751*/ 06019000
*/* OUTPUT - THE CATALOG HAS BEEN VERIFIED.                  @OZ00751*/ 06020000
*/*                                                          @OZ00751*/ 06021000
*/********************************************************************/ 06022000
*                                                                  1420 06023000
*        /************************************************************/ 06024000
*        /*                                                  @OZ00751*/ 06025000
*        /* CLOSE THE OBJECT CATALOG                         @OZ00751*/ 06026000
*        /*                                                  @OZ00751*/ 06027000
*        /************************************************************/ 06028000
*                                                                  1420 06029000
*        CALL IDCIOCL0 (GDTTBL,IOCSPTR);                   /*@OZ00751*/ 06030000
*                                                                  1420 06031000
         ST    @08,@AL00001                                        1420 06032000
         LA    @07,IOCSPTR                                         1420 06033000
         ST    @07,@AL00001+4                                      1420 06034000
         MVI   @AL00001+4,X'80'                                    1420 06035000
         L     @15,GDTCLS(,@08)                                    1420 06036000
         LA    @01,@AL00001                                        1420 06037000
         BALR  @14,@15                                             1420 06038000
*        /************************************************************/ 06039000
*        /*                                                  @OZ00751*/ 06040000
*        /* RESET THE OPNAGL SO THAT THE CATALOG WILL BE     @OZ00751*/ 06041000
*        /* OPENED FOR CI PROCESSING.                        @OZ00751*/ 06042000
*        /*                                                  @OZ00751*/ 06043000
*        /************************************************************/ 06044000
*                                                                  1421 06045000
*        OPNOPTIN = OFF;                                   /*@OZ00751*/ 06046000
*        OPNOPTOT = ON;                                    /*@OZ00751*/ 06047000
*        OPNOPTBK = ON;                                    /*@OZ00751*/ 06048000
*        OPNOPTCR = ON;                                    /*@OZ00751*/ 06049000
*                                                                  1424 06050000
         OI    OPNOPTOT(OPNPTR),B'01010100'                        1424 06051000
         NI    OPNOPTIN(OPNPTR),B'01111111'                        1424 06052000
*        /************************************************************/ 06053000
*        /*                                                  @OZ00751*/ 06054000
*        /* OPEN FOR CI PROCESSING                           @OZ00751*/ 06055000
*        /*                                                  @OZ00751*/ 06056000
*        /************************************************************/ 06057000
*                                                                  1425 06058000
*        CALL IDCIOOP0 (GDTTBL,OPAGLST);                   /*@OZ00751*/ 06059000
         L     @08,@PC00001                                        1425 06060000
         ST    @08,@AL00001                                        1425 06061000
         ST    OPNPTR,@AL00001+4                                   1425 06062000
         MVI   @AL00001+4,X'80'                                    1425 06063000
         L     @15,GDTOPN(,@08)                                    1425 06064000
         LA    @01,@AL00001                                        1425 06065000
         BALR  @14,@15                                             1425 06066000
*        RESPECIFY RTNREG RSTD;                                    1426 06067000
*        TESTRC = RTNREG;                                          1427 06068000
         STH   RTNREG,TESTRC                                       1427 06069000
*        RESPECIFY RTNREG UNRSTD;                          /*@OZ00751*/ 06070000
*                                                                  1428 06071000
*        IF TESTRC ^= 0                                            1429 06072000
*          THEN                                                    1429 06073000
         LH    @08,TESTRC                                          1429 06074000
         LTR   @08,@08                                             1429 06075000
         BZ    @RF01429                                            1429 06076000
*            DO;                                           /*@OZ00751*/ 06077000
*                                                                  1430 06078000
*            OLDERID2 = NEWERID2;                          /*@OZ00751*/ 06079000
         L     @08,@PC00001                                        1431 06080000
         L     @08,GDTTR2(,@08)                                    1431 06081000
         MVC   @TS00001(95),NEWERID2(@08)                          1431 06082000
         MVC   OLDERID2(95,@08),@TS00001                           1431 06083000
*            NEWID2 = 'CP14';                              /*@OZ00751*/ 06084000
         MVC   NEWID2(4,@08),@CC01265                              1432 06085000
*            STATFLG = TERMERR;                            /*@OZ00751*/ 06086000
         MVC   STATFLG(5),@CB00819                                 1433 06087000
*            RETURN;                                       /*@OZ00751*/ 06088000
*                                                                  1434 06089000
@EL00012 DS    0H                                                  1434 06090000
@EF00012 DS    0H                                                  1434 06091000
@ER00012 LM    @14,@12,@SA00012                                    1434 06092000
         BR    @14                                                 1434 06093000
*            END;                                          /*@OZ00751*/ 06094000
*                                                                  1435 06095000
*        /************************************************************/ 06096000
*        /*                                                  @OZ00751*/ 06097000
*        /* VERIFY THE OBJECT CATALOG                        @OZ00751*/ 06098000
*        /*                                                  @OZ00751*/ 06099000
*        /************************************************************/ 06100000
*                                                                  1436 06101000
*       IF J = 2                                                   1436 06102000
*          THEN                                                    1436 06103000
@RF01429 CH    J,@CH00153                                          1436 06104000
         BNE   @RF01436                                            1436 06105000
*            IOCSPTR = IOCSINP;                            /*@OZ00751*/ 06106000
         MVC   IOCSPTR(4),IOCSINP                                  1437 06107000
*          ELSE                                                    1438 06108000
*            IOCSPTR = IOCSOUT;                            /*@OZ00751*/ 06109000
*                                                                  1438 06110000
         B     @RC01436                                            1438 06111000
@RF01436 MVC   IOCSPTR(4),IOCSOUT                                  1438 06112000
*        IF STATFLG = NORMAL                                       1439 06113000
*          THEN                                                    1439 06114000
@RC01436 CLC   STATFLG(5),@CB00816                                 1439 06115000
         BNE   @RF01439                                            1439 06116000
*            DO;                                           /*@OZ00751*/ 06117000
*                                                                  1440 06118000
*            CALL IDCIOVY0 (GDTTBL,IOCSPTR);               /*@OZ00751*/ 06119000
         L     @08,@PC00001                                        1441 06120000
         ST    @08,@AL00001                                        1441 06121000
         LA    @07,IOCSPTR                                         1441 06122000
         ST    @07,@AL00001+4                                      1441 06123000
         MVI   @AL00001+4,X'80'                                    1441 06124000
         L     @15,GDTVFY(,@08)                                    1441 06125000
         LA    @01,@AL00001                                        1441 06126000
         BALR  @14,@15                                             1441 06127000
*            RESPECIFY RTNREG RSTD;                                1442 06128000
*            TESTRC = RTNREG;                                      1443 06129000
         STH   RTNREG,TESTRC                                       1443 06130000
*            RESPECIFY RTNREG UNRSTD;                      /*@OZ00751*/ 06131000
*                                                                  1444 06132000
*            IF TESTRC ^= 0                                        1445 06133000
*              THEN                                                1445 06134000
*                                                                  1445 06135000
         LH    @08,TESTRC                                          1445 06136000
         LTR   @08,@08                                             1445 06137000
         BZ    @RF01445                                            1445 06138000
*                STATFLG = TERMERR;                        /*@OZ00751*/ 06139000
         MVC   STATFLG(5),@CB00819                                 1446 06140000
*            END;                                          /*@OZ00751*/ 06141000
*                                                                  1447 06142000
@RF01445 DS    0H                                                  1448 06143000
*        /************************************************************/ 06144000
*        /*                                                  @OZ00751*/ 06145000
*        /* CLOSE AND RESET THE OPEN OPTIONS                 @OZ00751*/ 06146000
*        /*                                                  @OZ00751*/ 06147000
*        /************************************************************/ 06148000
*                                                                  1448 06149000
*        CALL IDCIOCL0 (GDTTBL,IOCSPTR);                   /*@OZ00751*/ 06150000
*                                                                  1448 06151000
@RF01439 L     @08,@PC00001                                        1448 06152000
         ST    @08,@AL00001                                        1448 06153000
         LA    @07,IOCSPTR                                         1448 06154000
         ST    @07,@AL00001+4                                      1448 06155000
         MVI   @AL00001+4,X'80'                                    1448 06156000
         L     @15,GDTCLS(,@08)                                    1448 06157000
         LA    @01,@AL00001                                        1448 06158000
         BALR  @14,@15                                             1448 06159000
*        IF J = 2                                                  1449 06160000
*          THEN                                                    1449 06161000
         CH    J,@CH00153                                          1449 06162000
         BNE   @RF01449                                            1449 06163000
*            DO;                                           /*@OZ00751*/ 06164000
*            OPNOPTIN = ON;                                /*@OZ00751*/ 06165000
*            OPNOPTOT = OFF;                               /*@OZ00751*/ 06166000
         OI    OPNOPTIN(OPNPTR),B'10000000'                        1452 06167000
         NI    OPNOPTOT(OPNPTR),B'10111111'                        1452 06168000
*            END;                                                  1453 06169000
*                                                                  1453 06170000
*        OPNOPTBK = OFF;                                   /*@OZ00751*/ 06171000
@RF01449 DS    0H                                                  1455 06172000
*        OPNOPTCR = OFF;                                   /*@OZ00751*/ 06173000
*        OPNOPTKS = ON;                                    /*@OZ00751*/ 06174000
*                                                                  1456 06175000
         OI    OPNOPTKS(OPNPTR),B'00001000'                        1456 06176000
         NI    OPNOPTBK(OPNPTR),B'11101011'                        1456 06177000
*        /************************************************************/ 06178000
*        /*                                                  @OZ00751*/ 06179000
*        /* REOPEN FOR NORMAL KEYED PROCESSING.              @OZ00751*/ 06180000
*        /*                                                  @OZ00751*/ 06181000
*        /************************************************************/ 06182000
*                                                                  1457 06183000
*        IF STATFLG = NORMAL                                       1457 06184000
*          THEN                                                    1457 06185000
         CLC   STATFLG(5),@CB00816                                 1457 06186000
         BNE   @RF01457                                            1457 06187000
*            DO;                                           /*@OZ00751*/ 06188000
*            CALL IDCIOOP0 (GDTTBL,OPAGLST);               /*@OZ00751*/ 06189000
         L     @08,@PC00001                                        1459 06190000
         ST    @08,@AL00001                                        1459 06191000
         ST    OPNPTR,@AL00001+4                                   1459 06192000
         MVI   @AL00001+4,X'80'                                    1459 06193000
         L     @15,GDTOPN(,@08)                                    1459 06194000
         LA    @01,@AL00001                                        1459 06195000
         BALR  @14,@15                                             1459 06196000
*            RESPECIFY RTNREG RSTD;                                1460 06197000
*            TESTRC = RTNREG;                                      1461 06198000
         STH   RTNREG,TESTRC                                       1461 06199000
*            RESPECIFY RTNREG UNRSTD;                              1462 06200000
*                                                                  1462 06201000
*            IF TESTRC ^= 0                                        1463 06202000
*              THEN                                                1463 06203000
         LH    @08,TESTRC                                          1463 06204000
         LTR   @08,@08                                             1463 06205000
         BZ    @RF01463                                            1463 06206000
*                DO;                                       /*@OZ00751*/ 06207000
*                                                                  1464 06208000
*                OLDERID2 = NEWERID2;                      /*@OZ00751*/ 06209000
         L     @08,@PC00001                                        1465 06210000
         L     @08,GDTTR2(,@08)                                    1465 06211000
         MVC   @TS00001(95),NEWERID2(@08)                          1465 06212000
         MVC   OLDERID2(95,@08),@TS00001                           1465 06213000
*                NEWID2   = 'CP14';                        /*@OZ00751*/ 06214000
         MVC   NEWID2(4,@08),@CC01265                              1466 06215000
*                STATFLG  = TERMERR;                       /*@OZ00751*/ 06216000
         MVC   STATFLG(5),@CB00819                                 1467 06217000
*                END;                                      /*@OZ00751*/ 06218000
*            END;                                          /*@OZ00751*/ 06219000
*                                                                  1469 06220000
*        END VERIFYC;                                      /*@OZ00751*/ 06221000
*                                                                  1470 06222000
         B     @EL00012                                            1470 06223000
*        END CATRELOD;                                     /*@OZ00751*/ 06224000
*                                                                  1471 06225000
*/*******************************************************************/  06226000
*/*                                                          @Y30SSEC*/ 06227000
*/*PROCEDURE NAME - RECOVCAT                                 @Y30SSEC*/ 06228000
*/*                                                          @Y30SSEC*/ 06229000
*/* FUNCTION - RECOVCAT RECEIVES CONTROL FROM IDCRP01 WHEN A @Y30SSEC*/ 06230000
*/* CATALOG COPY OPERATION IS TO TAKE PLACE. BOTH CATALOGS   @Y30SSEC*/ 06231000
*/* ARE CHECKED FOR THE RECOVERABLE ATTRIBUTE VIA A LOCATE   @Y30SSEC*/ 06232000
*/* OF THE DATA COMPONENT ENTRY FOR EACH CATALOG.            @Y30SSEC*/ 06233000
*/*                                                          @Y30SSEC*/ 06234000
*/* INPUT - ASSUMES THAT BOTH CATALOGS ARE OPEN AND THE ACB  @Y30SSEC*/ 06235000
*/*         ADDRESS IS AVAILABLE IN HOLDACB(J). ALSO, THAT   @Y30SSEC*/ 06236000
*/*         THE DATA COMPONET CI NUMBER REMAINS = 0.         @Y30SSEC*/ 06237000
*/* OUTPUT - IF EITHER  OF THE CATALOGS ARE                  @Y30SSEC*/ 06238000
*/*          RECOVERABLE AN ERROR MESSAGE IS ISSUED.         @Y30SSEC*/ 06239000
*/*                                                          @Y30SSEC*/ 06240000
*/********************************************************************/ 06241000
*RECOVCAT:                                                         1472 06242000
*        PROCEDURE ;                                       /*@Y30SSEC*/ 06243000
RECOVCAT STM   @14,@12,@SA00013                                    1472 06244000
*        /************************************************** @Y30SSEC*/ 06245000
*        /*                                                  @Y30SSEC*/ 06246000
*        /* SET UP CTGPL AND CTGFPL TO GET DATA COMPONENT    @Y30SSEC*/ 06247000
*        /* OF CATALOG ENTRIES TO BE COPIED.                 @Y30SSEC*/ 06248000
*        /*                                                  @Y30SSEC*/ 06249000
*        /************************************************** @Y30SSEC*/ 06250000
*        IF STATFLG = NORMAL                                       1473 06251000
*          THEN                                                    1473 06252000
         CLC   STATFLG(5),@CB00816                                 1473 06253000
         BNE   @RF01473                                            1473 06254000
*ATTRLOOP:   DO J = 1 TO 2 WHILE STATFLG ^= TERMERR;       /*@Y30SSEC*/ 06255000
*                                                                  1474 06256000
ATTRLOOP LA    J,1                                                 1474 06257000
@DL01474 CLC   STATFLG(5),@CB00819                                 1474 06258000
         BE    @DC01474                                            1474 06259000
*            LOCATWKA = ''B;  /* ZERO LOCATE WORK AREA       @Y30SSEC*/ 06260000
         XC    LOCATWKA(180),LOCATWKA                              1475 06261000
*            LOCCPLID = 'LOCATTR1';  /* DUMP ID              @Y30SSEC*/ 06262000
         MVC   LOCCPLID(8),@CC01271                                1476 06263000
*            CTGPLPTR = ADDR(LOCATCPL);  /* SET CPL PTR      @Y30SSEC*/ 06264000
         LA    @08,LOCATCPL                                        1477 06265000
         ST    @08,CTGPLPTR                                        1477 06266000
*            CTGFUNC = '001'B;  /* SET LOCATE FLAG           @Y30SSEC*/ 06267000
         NI    CTGFUNC(@08),B'00111111'                            1478 06268000
         OI    CTGFUNC(@08),B'00100000'                            1478 06269000
*            CTGAM0 = ON; /* SET VSAM FUNC                   @Y30SSEC*/ 06270000
*            CTGSRH = OFF; /* SEARCH VSAM CATLG              @Y30SSEC*/ 06271000
*            CTGNUM = ON;  /* ONLY VSAM CATLG                @Y30SSEC*/ 06272000
         OI    CTGAM0(@08),B'00000011'                             1481 06273000
         NI    CTGSRH(@08),B'11111011'                             1481 06274000
*            CTGCNAME = OFF;  /* LOCATE BY ACB               @Y30SSEC*/ 06275000
         NI    CTGCNAME(@08),B'11111101'                           1482 06276000
*            CTGCAT = ADDR(HOLDACB(J));  /* POINT TO CAT ACB @Y30SSEC*/ 06277000
         LR    @07,J                                               1483 06278000
         SLA   @07,2                                               1483 06279000
         LA    @07,HOLDACB-4(@07)                                  1483 06280000
         ST    @07,CTGCAT(,@08)                                    1483 06281000
*            CTGNAME = OFF;  /* LOCATE BY CI NUMBER          @Y30SSEC*/ 06282000
         NI    CTGNAME(@08),B'11111011'                            1484 06283000
*            CTGENT = ADDR(DATACI#); /* DATA COMP CI NUMBER  @Y30SSEC*/ 06284000
         LA    @07,DATACI#                                         1485 06285000
         ST    @07,CTGENT(,@08)                                    1485 06286000
*            CTGNOFLD = 1;  /* NUMBER OF FPLS                @Y30SSEC*/ 06287000
         MVI   CTGNOFLD(@08),X'01'                                 1486 06288000
*            CTGWKA = ADDR(LOCWKA);  /* ADDR OF WORK AREA    @Y30SSEC*/ 06289000
         LA    @07,LOCWKA                                          1487 06290000
         ST    @07,CTGWKA(,@08)                                    1487 06291000
*            LOCWKALN = LENGTH(LOCWKA); /* SET LENGTH        @Y30SSEC*/ 06292000
*                                                                  1488 06293000
         MVC   LOCWKALN(2),@CH00631                                1488 06294000
*            /*********************************************  @Y30SSEC*/ 06295000
*            /*                                              @Y30SSEC*/ 06296000
*            /* SET UP PASSWORD FIELDS                       @Y30SSEC*/ 06297000
*            /*                                              @Y30SSEC*/ 06298000
*            /*********************************************  @Y30SSEC*/ 06299000
*                    IF J = 1                              /*@Y30SSEC*/ 06300000
*                      THEN   /*  SET PASWORDS               @Y30SSEC*/ 06301000
         CH    J,@CH00219                                          1489 06302000
         BNE   @RF01489                                            1489 06303000
*                        DO;                               /*@Y30SSEC*/ 06304000
*                          IF ADDR(OUTDD) ^= 0 & OUTDDPLN ^= 0     1491 06305000
*                             THEN                         /*@Y30SSEC*/ 06306000
         L     @07,@PC00001+4                                      1491 06307000
         L     @07,FDTPTR+36(,@07)                                 1491 06308000
         LTR   @07,@07                                             1491 06309000
         BZ    @RF01491                                            1491 06310000
         CLI   OUTDDPLN(@07),0                                     1491 06311000
         BE    @RF01491                                            1491 06312000
*                               CTGPSWD = ADDR(OUTDDPAS);  /*@Y30SSEC*/ 06313000
         LA    @07,OUTDDPAS(,@07)                                  1492 06314000
         ST    @07,CTGPSWD(,@08)                                   1492 06315000
*                             ELSE                         /*@Y30SSEC*/ 06316000
*                               IF ADDR(OUTDS) ^= 0 & OUTDSPLN ^= 0     06317000
*                                  THEN CTGPSWD = ADDR(OUTDSPAS);  1493 06318000
         B     @RC01491                                            1493 06319000
@RF01491 L     @08,@PC00001+4                                      1493 06320000
         L     @08,FDTPTR+44(,@08)                                 1493 06321000
         LTR   @08,@08                                             1493 06322000
         BZ    @RF01493                                            1493 06323000
         CLI   OUTDSPLN(@08),0                                     1493 06324000
         BE    @RF01493                                            1493 06325000
         LA    @08,OUTDSPAS(,@08)                                  1494 06326000
         L     @07,CTGPLPTR                                        1494 06327000
         ST    @08,CTGPSWD(,@07)                                   1494 06328000
*                                  ELSE;                   /*@Y30SSEC*/ 06329000
@RF01493 DS    0H                                                  1496 06330000
*                          IF ADDR(INPDD) ^= 0 & INPDDPLN ^= 0     1496 06331000
*                             THEN                         /*@Y30SSEC*/ 06332000
@RC01491 L     @08,@PC00001+4                                      1496 06333000
         L     @08,FDTPTR+32(,@08)                                 1496 06334000
         LTR   @08,@08                                             1496 06335000
         BZ    @RF01496                                            1496 06336000
         CLI   INPDDPLN(@08),0                                     1496 06337000
         BE    @RF01496                                            1496 06338000
*                               CTGPSWD = ADDR(INPDDPAS);  /*@Y30SSEC*/ 06339000
         LA    @08,INPDDPAS(,@08)                                  1497 06340000
         L     @07,CTGPLPTR                                        1497 06341000
         ST    @08,CTGPSWD(,@07)                                   1497 06342000
*                             ELSE                         /*@Y30SSEC*/ 06343000
*                               IF ADDR(INDS) ^= 0 & INDSPLN ^= 0  1498 06344000
*                                  THEN CTGPSWD = ADDR(INDSPAS);   1498 06345000
         B     @RC01496                                            1498 06346000
@RF01496 L     @08,@PC00001+4                                      1498 06347000
         L     @08,FDTPTR+280(,@08)                                1498 06348000
         LTR   @08,@08                                             1498 06349000
         BZ    @RF01498                                            1498 06350000
         CLI   INDSPLN(@08),0                                      1498 06351000
         BE    @RF01498                                            1498 06352000
         LA    @08,INDSPAS(,@08)                                   1499 06353000
         L     @07,CTGPLPTR                                        1499 06354000
         ST    @08,CTGPSWD(,@07)                                   1499 06355000
*                                  ELSE;                   /*@Y30SSEC*/ 06356000
@RF01498 DS    0H                                                  1501 06357000
*                        END;                              /*@Y30SSEC*/ 06358000
*                                                                  1501 06359000
@RC01496 DS    0H                                                  1502 06360000
*            /*********************************************  @Y30SSEC*/ 06361000
*            /*                                              @Y30SSEC*/ 06362000
*            /* INITIALIZE FPL                               @Y30SSEC*/ 06363000
*            /*                                              @Y30SSEC*/ 06364000
*            /*********************************************  @Y30SSEC*/ 06365000
*            DSATRFPL = ''B;  /* ZERO OUT FPL                @Y30SSEC*/ 06366000
@RF01489 XC    DSATRFPL(28),DSATRFPL                               1502 06367000
*            CTGFLPTR = ADDR(DSATRFPL);  /* SET CTG PTR      @Y30SSEC*/ 06368000
         LA    CTGFLPTR,DSATRFPL                                   1503 06369000
*            CTGFLDNM = ADDR(DSATRNAM); /* POINT TO FPL NAME @Y30SSEC*/ 06370000
         LA    @08,DSATRNAM                                        1504 06371000
         ST    @08,CTGFLDNM(,CTGFLPTR)                             1504 06372000
*            CTGFIELD(1) = CTGFLPTR;  /* POINT TO FPL        @Y30SSEC*/ 06373000
         L     @08,CTGPLPTR                                        1505 06374000
         ST    CTGFLPTR,CTGFIELD(,@08)                             1505 06375000
*            /*********************************************  @Y30SSEC*/ 06376000
*            /*                                              @Y30SSEC*/ 06377000
*            /* SET UP DUMP PARMS FOR CTGPL AND CTGFPL AREAS @Y30SSEC*/ 06378000
*            /*                                              @Y30SSEC*/ 06379000
*            /*********************************************  @Y30SSEC*/ 06380000
*            IF GDTDBG = NULLPTR                                   1506 06381000
*               THEN;                                      /*@Y30SSEC*/ 06382000
         L     @08,@PC00001                                        1506 06383000
         L     @08,GDTDBG(,@08)                                    1506 06384000
         LTR   @08,@08                                             1506 06385000
         BZ    @RT01506                                            1506 06386000
*               ELSE                                               1508 06387000
*                 DO;                                      /*@Y30SSEC*/ 06388000
*                 DMPINDEX = ADDR(DMPLST1); /* POINT TO DUMP LIST    */ 06389000
         LA    @08,DMPLST1                                         1509 06390000
         ST    @08,DMPINDEX                                        1509 06391000
*                 DMPITMNM = 'DSATRCPL';  /* NAME FIRST DUMP @Y30SSEC*/ 06392000
         MVC   DMPITMNM(8,@08),@CC01272                            1510 06393000
*                 DMPITMPT = CTGPLPTR; /* POINT TO AREA      @Y30SSEC*/ 06394000
         MVC   DMPITMPT(4,@08),CTGPLPTR                            1511 06395000
*                 DMPITMLN = LENGTH(CTGPL) + 4;            /*@Y30SSEC*/ 06396000
         MVC   DMPITMLN(2,@08),@CH00221                            1512 06397000
*                 DMPITMTP = 'H';  /* SET TYPE OF DUMP       @Y30SSEC*/ 06398000
         MVI   DMPITMTP(@08),C'H'                                  1513 06399000
*                 DMPINDEX = DMPINDEX + DMPELEMT; /* NEXT LIST ENTRY */ 06400000
         LA    @05,16                                              1514 06401000
         LR    @15,@08                                             1514 06402000
         ALR   @15,@05                                             1514 06403000
         ST    @15,DMPINDEX                                        1514 06404000
*                 DMPITMNM = 'DSATRFPL';  /* NAME 2DN ENTRY  @Y30SSEC*/ 06405000
         MVC   DMPITMNM(8,@15),@CC01273                            1515 06406000
*                 DMPITMPT = CTGFLPTR;  /* POINT TO AREA     @Y30SSEC*/ 06407000
         ST    CTGFLPTR,DMPITMPT(,@15)                             1516 06408000
*                 DMPITMLN = LENGTH(CTGFL) + 8;/* SET LENGTH @Y30SSEC*/ 06409000
         MVC   DMPITMLN(2,@15),@CH00310                            1517 06410000
*                 DMPITMTP = 'H';  /* SET TYPE OF DUMP       @Y30SSEC*/ 06411000
         MVI   DMPITMTP(@15),C'H'                                  1518 06412000
*                 DMPINDEX = DMPINDEX + DMPELEMT; /* NEXT LIST ENTRY */ 06413000
         ALR   @15,@05                                             1519 06414000
         ST    @15,DMPINDEX                                        1519 06415000
*                 DMPTRM = DMPTRMVL;  /* SET END OF LIST CODE */   1520 06416000
         MVI   DMPTRM(@15),X'FF'                                   1520 06417000
*                 DMPINDEX = ADDR(DMPLST1); /* POINT TO DUMP LIST    */ 06418000
         ST    @08,DMPINDEX                                        1521 06419000
*                 IF GDTDBG = NULLPTR                              1522 06420000
*                   THEN;                                          1522 06421000
         L     @08,@PC00001                                        1522 06422000
         L     @08,GDTDBG(,@08)                                    1522 06423000
         LTR   @08,@08                                             1522 06424000
         BZ    @RT01522                                            1522 06425000
*                   ELSE                                           1524 06426000
*                     CALL IDCDB010 (GDTTBL,'RPRV',DMPINDEX);      1524 06427000
         L     @08,@PC00001                                        1524 06428000
         ST    @08,@AL00001                                        1524 06429000
         LA    @05,@CC01274                                        1524 06430000
         ST    @05,@AL00001+4                                      1524 06431000
         LA    @05,DMPINDEX                                        1524 06432000
         ST    @05,@AL00001+8                                      1524 06433000
         MVI   @AL00001+8,X'80'                                    1524 06434000
         L     @15,GDTDBG(,@08)                                    1524 06435000
         LA    @01,@AL00001                                        1524 06436000
         BALR  @14,@15                                             1524 06437000
*                                                          /*@Y30SSEC*/ 06438000
*                 END;                                     /*@Y30SSEC*/ 06439000
@RT01522 DS    0H                                                  1526 06440000
*            /*********************************************  @Y30SSEC*/ 06441000
*            /*                                              @Y30SSEC*/ 06442000
*            /* INVOKE CATALOG MGT TO LOCATE CAT DATA COMP   @Y30SSEC*/ 06443000
*            /*                                              @Y30SSEC*/ 06444000
*            /*********************************************  @Y30SSEC*/ 06445000
*            CALL IDCSACA0 (GDTTBL,CTGPLPTR);              /*@Y30SSEC*/ 06446000
@RT01506 L     @08,@PC00001                                        1526 06447000
         ST    @08,@AL00001                                        1526 06448000
         LA    @15,CTGPLPTR                                        1526 06449000
         ST    @15,@AL00001+4                                      1526 06450000
         L     @15,GDTCAT(,@08)                                    1526 06451000
         LA    @01,@AL00001                                        1526 06452000
         BALR  @14,@15                                             1526 06453000
*            CTGRTNCC = RTNREG; /* SAVE RETURN CODE          @Y30SSEC*/ 06454000
         LR    CTGRTNCC,RTNREG                                     1527 06455000
*            /*********************************************  @Y30SSEC*/ 06456000
*            /*                                              @Y30SSEC*/ 06457000
*            /* IF THE CATALOG ENTRY IS LOCATED CHECK TO SEE @Y30SSEC*/ 06458000
*            /* IF IT HAS THE RECOVERABLE ATTRIBUTE.         @Y30SSEC*/ 06459000
*            /* IF IT IS RECOVERABLE PRINT AN ERROR MESSAGE. @Y30SSEC*/ 06460000
*            /* OTHERWISE CONTINUE WITH NORMAL PROCESSING.   @Y30SSEC*/ 06461000
*            /*                                              @Y30SSEC*/ 06462000
*            /*********************************************  @Y30SSEC*/ 06463000
*            IF CTGRTNCC = 0                                       1528 06464000
*              THEN                                                1528 06465000
         LTR   CTGRTNCC,CTGRTNCC                                   1528 06466000
         BNZ   @RF01528                                            1528 06467000
*                DO;                                       /*@Y30SSEC*/ 06468000
*                IF CTGFLPT(1) -> RECOVHIT = ON                    1530 06469000
*                  THEN                                            1530 06470000
         L     @08,CTGFLPT(,CTGFLPTR)                              1530 06471000
         TM    RECOVHIT(@08),B'00001000'                           1530 06472000
         BNO   @RF01530                                            1530 06473000
*                    DO;                                   /*@Y30SSEC*/ 06474000
*                    STATFLG = TERMERR;                    /*@Y30SSEC*/ 06475000
         MVC   STATFLG(5),@CB00819                                 1532 06476000
*                    DARGLIST = ''B; /* CLEAR PARM AREA      @Y30SSEC*/ 06477000
         L     @08,DDSTRU                                          1533 06478000
         XC    DARGLIST(20,@08),DARGLIST(@08)                      1533 06479000
*                    DARGSMOD = 'PR0';  /* STATIC TEXT MOD   @Y30SSEC*/ 06480000
         MVC   DARGSMOD(3,@08),@CC01129                            1534 06481000
*                    DARGSENT = 24;  /* STATIC TEXT ENTRY    @Y30SSEC*/ 06482000
         MVI   DARGSENT(@08),X'18'                                 1535 06483000
*                    CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);/*@Y30SSEC*/ 06484000
         L     @08,@PC00001                                        1536 06485000
         ST    @08,@AL00001                                        1536 06486000
         LA    @07,@CF00115                                        1536 06487000
         ST    @07,@AL00001+4                                      1536 06488000
         LA    @07,DDSTRU                                          1536 06489000
         ST    @07,@AL00001+8                                      1536 06490000
         MVI   @AL00001+8,X'80'                                    1536 06491000
         L     @15,GDTPRT(,@08)                                    1536 06492000
         LA    @01,@AL00001                                        1536 06493000
         BALR  @14,@15                                             1536 06494000
*                    END;                                  /*@Y30SSEC*/ 06495000
*                  ELSE;                                   /*@Y30SSEC*/ 06496000
@RF01530 DS    0H                                                  1539 06497000
*                END;                                      /*@Y30SSEC*/ 06498000
*                ELSE                                      /*@Y30SSEC*/ 06499000
*                  STATFLG = TERMERR;                      /*@Y30SSEC*/ 06500000
         B     @RC01528                                            1540 06501000
@RF01528 MVC   STATFLG(5),@CB00819                                 1540 06502000
*            END ATTRLOOP;                                 /*@Y30SSEC*/ 06503000
@RC01528 AH    J,@CH00219                                          1541 06504000
         CH    J,@CH00153                                          1541 06505000
         BNH   @DL01474                                            1541 06506000
@DC01474 DS    0H                                                  1542 06507000
*        END RECOVCAT;                                     /*@Y30SSEC*/ 06508000
@EL00013 DS    0H                                                  1542 06509000
@EF00013 DS    0H                                                  1542 06510000
@ER00013 LM    @14,@12,@SA00013                                    1542 06511000
         BR    @14                                                 1542 06512000
*        END IDCRP01                                       /*@OZ00751*/ 06513000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 06514000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 06515000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 06516000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 06517000
*/*%INCLUDE SYSLIB  (IDCCSRP )                                        * 06518000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        * 06519000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        * 06520000
*/*%INCLUDE SYSLIB  (AMSDF05 )                                        * 06521000
*;                                                                 1543 06522000
@DATA    DS    0H                                                       06523000
@CH00219 DC    H'1'                                                     06524000
@CH00162 DC    H'3'                                                     06525000
@CH00042 DC    H'4'                                                     06526000
@CH00156 DC    H'6'                                                     06527000
@CH00466 DC    H'7'                                                     06528000
@CH00624 DC    H'13'                                                    06529000
@CH00476 DC    H'16'                                                    06530000
@CH00310 DC    H'24'                                                    06531000
@CH01283 DC    H'28'                                                    06532000
@CH00221 DC    H'32'                                                    06533000
@CH00812 DC    H'40'                                                    06534000
@CH00622 DC    H'44'                                                    06535000
@CH00631 DC    H'48'                                                    06536000
@CH00147 DC    H'100'                                                   06537000
@CH01229 DC    H'250'                                                   06538000
@SC01302 CLC   TOKYCVAL(0,@08),RECDKEY(@04)                             06539000
@DATD    DSECT                                                          06540000
         DS    0F                                                       06541000
@SA00001 DS    18F                                                      06542000
@PC00001 DS    3F                                                       06543000
@SA00012 DS    15F                                                      06544000
@SA00003 DS    15F                                                      06545000
@SA00013 DS    15F                                                      06546000
@SA00002 DS    15F                                                      06547000
@PC00002 DS    3F                                                       06548000
@SA00006 DS    15F                                                      06549000
@SA00008 DS    15F                                                      06550000
@SA00010 DS    15F                                                      06551000
@SA00009 DS    15F                                                      06552000
@SA00004 DS    15F                                                      06553000
@SA00005 DS    15F                                                      06554000
@SA00011 DS    14F                                                      06555000
@SA00007 DS    15F                                                      06556000
@AL00001 DS    5A                                                       06557000
@TF00001 DS    F                                                        06558000
@TF00002 DS    F                                                        06559000
@AFTEMPS DS    3F                                                       06560000
@ZTEMPS  DS    0F                                                       06561000
@ZT00001 DC    F'0'                                                     06562000
@ZT00003 DC    F'0'                                                     06563000
@ZTEMPND EQU   *                                                        06564000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         06565000
IDCRP01  CSECT                                                          06566000
         DS    0F                                                       06567000
@CF00115 DC    F'0'                                                     06568000
@CF00153 DC    F'2'                                                     06569000
@CH00153 EQU   @CF00153+2                                               06570000
@CF01276 DC    F'20'                                                    06571000
@CH01276 EQU   @CF01276+2                                               06572000
@CF01205 DC    F'47'                                                    06573000
@CH01205 EQU   @CF01205+2                                               06574000
@CF01128 DC    F'116'                                                   06575000
@CF01050 DC    F'512'                                                   06576000
@CF01305 DC    F'-6'                                                    06577000
@DATD    DSECT                                                          06578000
         DS    0D                                                       06579000
LISTSCAN DS    A                                                        06580000
IOCSPTR  DS    A                                                        06581000
DDSTRU   DS    A                                                        06582000
FSADDR   DS    A                                                        06583000
ERCNVADR DS    A                                                        06584000
DMPINDEX DS    A                                                        06585000
CTGPLPTR DS    A                                                        06586000
IOCSINP  DS    A                                                        06587000
IOCSOUT  DS    A                                                        06588000
IOCSOUP  DS    A                                                        06589000
LOOPCNT  DS    F                                                        06590000
OLDREL   DS    F                                                        06591000
ENDKYLN  DS    F                                                        06592000
STBLDIM  DS    F                                                        06593000
TTBLDIM  DS    F                                                        06594000
QCATPSWD DS    A                                                        06595000
QCATPTR  DS    A                                                        06596000
QDSNPTR  DS    A                                                        06597000
HURBASAV DS    F                                                        06598000
HARBASAV DS    F                                                        06599000
NEWCINUM DS    F                                                        06600000
FREENUM  DS    F                                                        06601000
ALLAGLPT DS    A                                                        06602000
LISTPTR  DS    A                                                        06603000
TESTRC   DS    H                                                        06604000
LOOPINCR DS    H                                                        06605000
FAILIOER DS    H                                                        06606000
EOFSW    DS    H                                                        06607000
QDSNLEN  DS    H                                                        06608000
SETRC    DS    H                                                        06609000
CFROLD   DS    AL3                                                      06610000
EMPTYCI  DS    FL1                                                      06611000
OCCRNFCI DS    FL1                                                      06612000
LISTLN   DS    FL1                                                      06613000
@TS00001 DS    CL95                                                     06614000
         DS    CL3                                                      06615000
OPNARGS  DS    CL144                                                    06616000
         ORG   OPNARGS                                                  06617000
OPAGLST1 DS    BL48                                                     06618000
OPAGLST2 DS    BL48                                                     06619000
OPAGLST3 DS    BL48                                                     06620000
         ORG   OPNARGS+144                                              06621000
DARGL    DS    CL28                                                     06622000
CPRECID  DS    CL1                                                      06623000
DELIMFLG DS    CL1                                                      06624000
CYCLEFLG DS    CL1                                                      06625000
         DS    CL1                                                      06626000
STATFLG  DS    CL5                                                      06627000
         ORG   STATFLG                                                  06628000
STMODID  DS    CL3                                                      06629000
STATFLG1 DS    AL1                                                      06630000
STATFLG2 DS    AL1                                                      06631000
         ORG   STATFLG+5                                                06632000
         DS    CL3                                                      06633000
LOCATWKA DS    CL180                                                    06634000
         ORG   LOCATWKA                                                 06635000
LOCCPLID DS    CL8                                                      06636000
LOCATCPL DS    CL28                                                     06637000
@NM00046 DS    CL12                                                     06638000
ENTYPFPL DS    CL16                                                     06639000
@NM00047 DS    CL12                                                     06640000
ENTIDFPL DS    CL16                                                     06641000
@NM00048 DS    CL12                                                     06642000
ACBFPL   DS    CL16                                                     06643000
@NM00049 DS    CL12                                                     06644000
LOCWKA   DS    CL48                                                     06645000
         ORG   LOCWKA                                                   06646000
LOCWKALN DS    FL2                                                      06647000
         ORG   LOCATWKA+180                                             06648000
DSATRFPL DS    CL28                                                     06649000
DMPLST1  DS    CL36                                                     06650000
CATRELSW DS    BL1                                                      06651000
CATCOPSW DS    BL1                                                      06652000
OPNWRN   DS    BL1                                                      06653000
IOPOSSW  DS    CL1                                                      06654000
READSW   DS    BL1                                                      06655000
CCRECSTR DS    CL51                                                     06656000
         ORG   CCRECSTR                                                 06657000
@NM00063 DS    CL48                                                     06658000
NFCISTOR DS    AL3                                                      06659000
         ORG   CCRECSTR+51                                              06660000
CURRKEYT DS    CL44                                                     06661000
EMPTYSW  DS    BL1                                                      06662000
DUMPAREA DS    CL49                                                     06663000
         ORG   DUMPAREA                                                 06664000
DMNAME1  DS    CL8                                                      06665000
DMADDR1  DS    AL4                                                      06666000
DMLEN1   DS    FL2                                                      06667000
DMTYP2   DS    CL1                                                      06668000
         ORG   DUMPAREA+49                                              06669000
ALLAGLWK DS    CL31                                                     06670000
SKIPFLAG DS    CL1                                                      06671000
         DS    CL2                                                      06672000
HOLDACB  DS    2A                                                       06673000
STBL     DS    CL8                                                      06674000
         ORG   STBL+0                                                   06675000
STBLHI   DS    FL4                                                      06676000
STBLGAP  DS    FL4                                                      06677000
         ORG   STBL+128                                                 06678000
TTBL     DS    CL8                                                      06679000
         ORG   TTBL+0                                                   06680000
TTBLHI   DS    FL4                                                      06681000
TTBLGAP  DS    FL4                                                      06682000
         ORG   TTBL+128                                                 06683000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                06684000
@ENDDATD EQU   *                                                        06685000
IDCRP01  CSECT                                                          06686000
         DS    0F                                                       06687000
@SIZDATD DC    AL1(0)                                                   06688000
         DC    AL3(@ENDDATD-@DATD)                                      06689000
         DS    0D                                                       06690000
DATACI#  DC    A(0)                                                     06691000
MSGENTRY DC    AL1(17)                                                  06692000
@CC01136 DC    C'LOCATCPL'                                              06693000
@CC01201 DC    C'DLOUTREC'                                              06694000
@CC01203 DC    C'FUPOTREC'                                              06695000
@CC01204 DC    C'INSOTREC'                                              06696000
@CC01207 DC    C'UPOUTREC'                                              06697000
@CC01215 DC    C'RDINPREC'                                              06698000
@CC01220 DC    C'RDOUTREC'                                              06699000
@CC01228 DC    C'2ND-HALF'                                              06700000
@CC01230 DC    C'RET-CODE'                                              06701000
@CC01236 DC    C'SORSTABL'                                              06702000
@CC01237 DC    C'TARGTABL'                                              06703000
@CC01271 DC    C'LOCATTR1'                                              06704000
@CC01272 DC    C'DSATRCPL'                                              06705000
@CC01273 DC    C'DSATRFPL'                                              06706000
@CC01210 DC    C'RDCCREC'                                               06707000
@CC01211 DC    C'UPCCREC'                                               06708000
@CC01252 DC    C'OLDCI#'                                                06709000
@CC01253 DC    C'NEWCI#'                                                06710000
@CC00831 DC    C'RP01'                                                  06711000
@CC01127 DC    C'RP12'                                                  06712000
@CC01144 DC    C'RP13'                                                  06713000
@CC01154 DC    C'RP18'                                                  06714000
@CC01180 DC    C'RP21'                                                  06715000
@CC01184 DC    C'RPT1'                                                  06716000
@CC01195 DC    C'RPD1'                                                  06717000
@CC01231 DC    C'RPIO'                                                  06718000
@CC01235 DC    C'RPT2'                                                  06719000
@CC01238 DC    C'RPTU'                                                  06720000
@CC01242 DC    C'RPT3'                                                  06721000
@CC01251 DC    C'RPT4'                                                  06722000
@CC01254 DC    C'RPCI'                                                  06723000
@CC01258 DC    C'RPT5'                                                  06724000
@CC01264 DC    C'RPT6'                                                  06725000
@CC01265 DC    C'CP14'                                                  06726000
@CC01274 DC    C'RPRV'                                                  06727000
@CC01129 DC    C'PR0'                                                   06728000
@CC01155 DC    C'UV0'                                                   06729000
@CB00813 DC    X'E4E5F00409'                                            06730000
@CB00816 DC    X'E4E5F00001'                                            06731000
@CB00819 DC    X'E4E5F00C03'                                            06732000
@CB00822 DC    X'E4E5F00C06'                                            06733000
@CB00825 DC    X'E4E5F00809'                                            06734000
@CB00828 DC    X'D7D9F00C10'                                            06735000
ALL      DC    CL3'ALL'                                                 06736000
FORMAT   DC    CL4'FORM'                                                06737000
HSECOND  DC    CL4'HSEC'                                                06738000
CLOCK    DC    CL4'KLOK'                                                06739000
SETZERO  DC    CL4'ZERO'                                                06740000
SETBLANK DC    CL4'BLNK'                                                06741000
NOSET    DC    CL4'NSET'                                                06742000
OVERRIDE DC    CL4'OVRD'                                                06743000
ACQUIRE  DC    CL8'ACQUIRE '                                            06744000
RELINQ   DC    CL8'RELINQ  '                                            06745000
MOUNT    DC    CL8'MOUNT   '                                            06746000
DEMOUNT  DC    CL8'DEMOUNT '                                            06747000
DEFINE   DC    CL8'DEFINE  '                                            06748000
MOVE     DC    CL8'MOVE    '                                            06749000
TRACEQ   DC    CL8'TRACEQ  '                                            06750000
COPYTABL DC    CL8'COPYTABL'                                            06751000
COPYCRTG DC    CL8'COPYCRTG'                                            06752000
COPYVOL  DC    CL8'COPYVOL '                                            06753000
VVIC     DC    CL8'VVIC    '                                            06754000
TUNE     DC    CL8'TUNE    '                                            06755000
NAMES    DC    CL4'NAME'                                                06756000
UNIT     DC    CL4'UNIT'                                                06757000
SHR      DC    CL4'SHR '                                                06758000
EXCL     DC    CL4'EXCL'                                                06759000
NOWAIT   DC    CL4'NWAI'                                                06760000
WAIT     DC    CL4'WAIT'                                                06761000
MODID    DC    CL4'RP01'                                                06762000
FIXAREA  DS    CL256                                                    06763000
         ORG   FIXAREA                                                  06764000
@NM00044 DS    CL256                                                    06765000
         ORG   @NM00044                                                 06766000
@NM00045 DC    256X'00'                                                 06767000
         ORG   FIXAREA+256                                              06768000
DSATRNAM DC    CL8'DSATTR'                                              06769000
CTARGET  DC    CL7'TARGET'                                              06770000
CBACKUP  DC    CL7'BACKUP'                                              06771000
CDEVTYP  DC    CL6'DEVTYP'                                              06772000
CNAME    DC    CL6'NAME  '                                              06773000
CVOLSER  DC    CL6'VOLSER'                                              06774000
TYPFIELD DC    CL8'ENTYPE'                                              06775000
         DC    CL8'ENTIDNO'                                             06776000
         DC    CL8'CATACB'                                              06777000
COMFTBL  DC    CL1'A'                                                   06778000
         DC    CL1'D'                                                   06779000
         DC    CL1'I'                                                   06780000
         DC    CL1'C'                                                   06781000
         DC    CL1'U'                                                   06782000
         DC    CL1'B'                                                   06783000
         DC    CL1'X'                                                   06784000
         DC    CL1'E'                                                   06785000
         DC    CL1'V'                                                   06786000
         DC    CL1'W'                                                   06787000
         DC    CL1'G'                                                   06788000
         DC    CL1'R'                                                   06789000
         DC    CL1'Y'                                                   06790000
MSGARY   DC    CL11'FROMKEY'                                            06791000
         DC    CL11'TOKEY'                                              06792000
         DC    CL11'FROMADDRESS'                                        06793000
         DC    CL11'TOADDRESS'                                          06794000
         DC    CL11'FROMNUMBER'                                         06795000
         DC    CL11'TONUMBER'                                           06796000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       06797000
@01      EQU   01                                                       06798000
@02      EQU   02                                                       06799000
@03      EQU   03                                                       06800000
@04      EQU   04                                                       06801000
@05      EQU   05                                                       06802000
@06      EQU   06                                                       06803000
@07      EQU   07                                                       06804000
@08      EQU   08                                                       06805000
@09      EQU   09                                                       06806000
@10      EQU   10                                                       06807000
@11      EQU   11                                                       06808000
@12      EQU   12                                                       06809000
@13      EQU   13                                                       06810000
@14      EQU   14                                                       06811000
@15      EQU   15                                                       06812000
MSGINDX  EQU   @02                                                      06813000
SKIPLOOP EQU   @05                                                      06814000
COMFTBLX EQU   @05                                                      06815000
WRKCINUM EQU   @05                                                      06816000
GOSTART  EQU   @07                                                      06817000
GOPLEN   EQU   @02                                                      06818000
CTGRTNCC EQU   @05                                                      06819000
K        EQU   @05                                                      06820000
L        EQU   @06                                                      06821000
J        EQU   @06                                                      06822000
I        EQU   @02                                                      06823000
N        EQU   @05                                                      06824000
CTGFLPTR EQU   @07                                                      06825000
OPNPTR   EQU   @02                                                      06826000
RTNREG   EQU   @15                                                      06827000
REG1     EQU   @01                                                      06828000
RREC     EQU   @03                                                      06829000
RCIADDR  EQU   @04                                                      06830000
REG0     EQU   @00                                                      06831000
REG10    EQU   @10                                                      06832000
REG11    EQU   @11                                                      06833000
REG12    EQU   @12                                                      06834000
REG13    EQU   @13                                                      06835000
REG14    EQU   @14                                                      06836000
REG15    EQU   @15                                                      06837000
REG2     EQU   @02                                                      06838000
REG3     EQU   @03                                                      06839000
REG4     EQU   @04                                                      06840000
REG5     EQU   @05                                                      06841000
REG6     EQU   @06                                                      06842000
REG7     EQU   @07                                                      06843000
REG8     EQU   @08                                                      06844000
REG9     EQU   @09                                                      06845000
IDCSAEP0 EQU   0                                                        06846000
IDCSACA0 EQU   0                                                        06847000
IDCSAAL0 EQU   0                                                        06848000
IDCSADL0 EQU   0                                                        06849000
IDCSAQL0 EQU   0                                                        06850000
TRACE1   EQU   0                                                        06851000
OLDERID1 EQU   TRACE1                                                   06852000
TRACE2   EQU   0                                                        06853000
OLDERID2 EQU   TRACE2                                                   06854000
NEWID2   EQU   TRACE2+95                                                06855000
NEWERID2 EQU   5                                                        06856000
CIRAGL   EQU   0                                                        06857000
CIRTYPE  EQU   CIRAGL                                                   06858000
ALLAGL   EQU   0                                                        06859000
ALLDSN   EQU   ALLAGL                                                   06860000
ALLDDN   EQU   ALLAGL+4                                                 06861000
ALLPWD   EQU   ALLAGL+20                                                06862000
ALLSTS   EQU   ALLAGL+24                                                06863000
ALLSTSOD EQU   ALLSTS                                                   06864000
ALLDSP   EQU   ALLAGL+25                                                06865000
ALLDSPKP EQU   ALLDSP                                                   06866000
ALLORG   EQU   ALLAGL+26                                                06867000
ALLOPT   EQU   ALLAGL+28                                                06868000
ALLOPTDS EQU   ALLOPT                                                   06869000
UNITABL  EQU   0                                                        06870000
UNITADR  EQU   UNITABL+4                                                06871000
@NM00010 EQU   UNITADR                                                  06872000
UNITSTAT EQU   UNITABL+6                                                06873000
IDCIOOP0 EQU   0                                                        06874000
IDCIOCL0 EQU   0                                                        06875000
IDCIOPO0 EQU   0                                                        06876000
IDCIOGT0 EQU   0                                                        06877000
IDCIOPT0 EQU   0                                                        06878000
IDCIOCO0 EQU   0                                                        06879000
IDCIOVY0 EQU   0                                                        06880000
IOCSTR   EQU   0                                                        06881000
IOCDAD   EQU   IOCSTR                                                   06882000
IOCDLN   EQU   IOCSTR+4                                                 06883000
IOCKYL   EQU   IOCSTR+12                                                06884000
IOCDSO   EQU   IOCSTR+16                                                06885000
IOCDSOAM EQU   IOCDSO                                                   06886000
IOCRFM   EQU   IOCSTR+17                                                06887000
IOCMAC   EQU   IOCSTR+18                                                06888000
IOCMACCC EQU   IOCMAC                                                   06889000
IOCMAC2  EQU   IOCSTR+19                                                06890000
IOCMACRR EQU   IOCMAC2                                                  06891000
IOCCHP   EQU   IOCSTR+20                                                06892000
IOCMSG   EQU   IOCSTR+21                                                06893000
IOCMSGOP EQU   IOCMSG                                                   06894000
IOCHURBA EQU   IOCSTR+28                                                06895000
IOCDSN   EQU   IOCSTR+32                                                06896000
IOCRBA   EQU   IOCSTR+40                                                06897000
IOCTTR   EQU   IOCRBA                                                   06898000
IOCVRC   EQU   IOCTTR                                                   06899000
IOCMEM   EQU   IOCSTR+44                                                06900000
IOCKYA   EQU   IOCMEM                                                   06901000
IOCNWM   EQU   IOCSTR+48                                                06902000
IOCPTL   EQU   IOCNWM                                                   06903000
IOCRRN   EQU   IOCSTR+52                                                06904000
IOCREL   EQU   IOCSTR+60                                                06905000
IOCEXT   EQU   IOCSTR+64                                                06906000
OPNAGL   EQU   0                                                        06907000
OPNOPT   EQU   OPNAGL                                                   06908000
OPNOPTIN EQU   OPNOPT                                                   06909000
OPNOPTOT EQU   OPNOPT                                                   06910000
OPNOPTUP EQU   OPNOPT                                                   06911000
OPNOPTBK EQU   OPNOPT                                                   06912000
OPNOPTKS EQU   OPNOPT                                                   06913000
OPNOPTCR EQU   OPNOPT                                                   06914000
OPNRFM   EQU   OPNAGL+1                                                 06915000
OPNTYP   EQU   OPNAGL+2                                                 06916000
OPNMOD   EQU   OPNAGL+3                                                 06917000
OPNMODPD EQU   OPNMOD                                                   06918000
OPNMODRS EQU   OPNMOD                                                   06919000
OPNMODRP EQU   OPNMOD                                                   06920000
OPNIOC   EQU   OPNAGL+4                                                 06921000
OPNDDN   EQU   OPNAGL+8                                                 06922000
OPNPWA   EQU   OPNAGL+12                                                06923000
OPNDSN   EQU   OPNAGL+16                                                06924000
OPNDEV   EQU   OPNAGL+24                                                06925000
OPNDSO   EQU   OPNAGL+41                                                06926000
OPNOPT2  EQU   OPNAGL+42                                                06927000
IOINFOPT EQU   0                                                        06928000
UVOLLIST EQU   0                                                        06929000
UVOLENT  EQU   UVOLLIST+2                                               06930000
AMSTP011 EQU   0                                                        06931000
DARGLIST EQU   0                                                        06932000
DARGDBP  EQU   DARGLIST                                                 06933000
DARGSTID EQU   DARGLIST+8                                               06934000
DARGSMOD EQU   DARGSTID                                                 06935000
DARGSENT EQU   DARGSTID+3                                               06936000
DARGILP  EQU   DARGLIST+12                                              06937000
DARGCNT  EQU   DARGLIST+14                                              06938000
DARGFLGS EQU   DARGLIST+19                                              06939000
DARGARY  EQU   DARGLIST+20                                              06940000
DARGINS  EQU   DARGARY                                                  06941000
DARGINL  EQU   DARGARY+2                                                06942000
DARGDTM  EQU   DARGARY+4                                                06943000
FMTLIST  EQU   0                                                        06944000
FMTFLGS  EQU   FMTLIST                                                  06945000
FMTSPF   EQU   FMTLIST+2                                                06946000
FMTRFNO  EQU   FMTSPF                                                   06947000
FMTILEN  EQU   FMTRFNO                                                  06948000
FMTIOFF  EQU   FMTLIST+4                                                06949000
FMTTRBC  EQU   FMTIOFF                                                  06950000
FMTSTO   EQU   FMTTRBC                                                  06951000
FMTOCOL  EQU   FMTLIST+6                                                06952000
FMTCNVF  EQU   FMTLIST+10                                               06953000
ERCNVTAB EQU   0                                                        06954000
ERTYPE   EQU   ERCNVTAB                                                 06955000
EROPER   EQU   ERCNVTAB+1                                               06956000
EROSOPER EQU   ERCNVTAB+2                                               06957000
IDCDB010 EQU   0                                                        06958000
DMPITM   EQU   0                                                        06959000
DMPITMNM EQU   DMPITM                                                   06960000
DMPITMPT EQU   DMPITM+8                                                 06961000
DMPITMLN EQU   DMPITM+12                                                06962000
DMPITMTP EQU   DMPITM+14                                                06963000
DMPARY   EQU   0                                                        06964000
DMPTRM   EQU   0                                                        06965000
INDN     EQU   0                                                        06966000
OUTDN    EQU   0                                                        06967000
FMKYC    EQU   0                                                        06968000
FMKYCLEN EQU   FMKYC                                                    06969000
FMKYCVAL EQU   FMKYC+1                                                  06970000
FMRBA    EQU   0                                                        06971000
FMRBAVAL EQU   FMRBA                                                    06972000
SKIP     EQU   0                                                        06973000
SKIPVAL  EQU   SKIP                                                     06974000
TOKYC    EQU   0                                                        06975000
TOKYCLEN EQU   TOKYC                                                    06976000
TOKYCVAL EQU   TOKYC+1                                                  06977000
TORBA    EQU   0                                                        06978000
TORBAVAL EQU   TORBA                                                    06979000
COUNT    EQU   0                                                        06980000
COUNTVAL EQU   COUNT                                                    06981000
INPDD    EQU   0                                                        06982000
INPDDPLN EQU   INPDD                                                    06983000
INPDDPAS EQU   INPDD+1                                                  06984000
INPDDVAL EQU   INPDD+10                                                 06985000
OUTDD    EQU   0                                                        06986000
OUTDDPLN EQU   OUTDD                                                    06987000
OUTDDPAS EQU   OUTDD+1                                                  06988000
OUTDDVAL EQU   OUTDD+10                                                 06989000
OUTDS    EQU   0                                                        06990000
OUTDSPLN EQU   OUTDS                                                    06991000
OUTDSPAS EQU   OUTDS+1                                                  06992000
OUTDSFLG EQU   OUTDS+10                                                 06993000
OUTDSFUQ EQU   OUTDSFLG                                                 06994000
OUTDSLEN EQU   OUTDS+20                                                 06995000
OUTDSVAL EQU   OUTDS+21                                                 06996000
FMNUM    EQU   0                                                        06997000
FMNUMVAL EQU   FMNUM                                                    06998000
TONUM    EQU   0                                                        06999000
TONUMVAL EQU   TONUM                                                    07000000
IENV     EQU   0                                                        07001000
IDUMY    EQU   0                                                        07002000
REP      EQU   0                                                        07003000
RUS      EQU   0                                                        07004000
INDS     EQU   0                                                        07005000
INDSPLN  EQU   INDS                                                     07006000
INDSPAS  EQU   INDS+1                                                   07007000
INDSFLG  EQU   INDS+10                                                  07008000
INDSFUQ  EQU   INDSFLG                                                  07009000
INDSLEN  EQU   INDS+20                                                  07010000
INDSVAL  EQU   INDS+21                                                  07011000
IDENV    EQU   0                                                        07012000
IDUM     EQU   0                                                        07013000
CTGPL    EQU   0                                                        07014000
CTGOPTN1 EQU   CTGPL                                                    07015000
CTGNAME  EQU   CTGOPTN1                                                 07016000
CTGCNAME EQU   CTGOPTN1                                                 07017000
CTGOPTN2 EQU   CTGPL+1                                                  07018000
CTGEXT   EQU   CTGOPTN2                                                 07019000
CTGERASE EQU   CTGOPTN2                                                 07020000
CTGSMF   EQU   CTGERASE                                                 07021000
CTGREL   EQU   CTGSMF                                                   07022000
CTGPURG  EQU   CTGOPTN2                                                 07023000
CTGVMNT  EQU   CTGPURG                                                  07024000
CTGOPTN3 EQU   CTGPL+2                                                  07025000
CTGFUNC  EQU   CTGOPTN3                                                 07026000
CTGSRH   EQU   CTGOPTN3                                                 07027000
CTGNUM   EQU   CTGOPTN3                                                 07028000
CTGAM0   EQU   CTGOPTN3                                                 07029000
CTGOPTN4 EQU   CTGPL+3                                                  07030000
CTGENT   EQU   CTGPL+4                                                  07031000
CTGCAT   EQU   CTGPL+8                                                  07032000
CTGWKA   EQU   CTGPL+12                                                 07033000
CTGDSORG EQU   CTGPL+16                                                 07034000
CTGNOFLD EQU   CTGPL+19                                                 07035000
CTGDDNM  EQU   CTGPL+20                                                 07036000
CTGNEWNM EQU   CTGDDNM                                                  07037000
CTGFBFLG EQU   CTGNEWNM+2                                               07038000
CTGJSCB  EQU   CTGPL+24                                                 07039000
CTGPSWD  EQU   CTGJSCB                                                  07040000
CTGFIELD EQU   CTGPL+28                                                 07041000
CTGFL    EQU   0                                                        07042000
CTGFLDNO EQU   CTGFL                                                    07043000
CTGFLDRE EQU   CTGFL+3                                                  07044000
CTGFLDNM EQU   CTGFL+8                                                  07045000
CTGFLDAT EQU   CTGFL+16                                                 07046000
CTGFLPT  EQU   CTGFLDAT+4                                               07047000
OPAGLST  EQU   0                                                        07048000
RECDKEY  EQU   0                                                        07049000
ACBADDR  EQU   0                                                        07050000
DATRMASK EQU   0                                                        07051000
@NM00050 EQU   DATRMASK                                                 07052000
RECOVHIT EQU   @NM00050                                                 07053000
ENTRYTYP EQU   0                                                        07054000
ENTRYCI# EQU   0                                                        07055000
IODATA   EQU   0                                                        07056000
IODSID   EQU   IODATA+16                                                07057000
IOCSEX   EQU   0                                                        07058000
IOCRPL   EQU   IOCSEX+4                                                 07059000
IOCXAD   EQU   IOCSEX+16                                                07060000
IOCXPM   EQU   IOCSEX+20                                                07061000
IOCFLG   EQU   IOCSEX+32                                                07062000
IOCFLGEF EQU   IOCFLG                                                   07063000
IOCDEV   EQU   IOCSEX+33                                                07064000
IOCINF   EQU   IOCSEX+34                                                07065000
IOCMOD   EQU   IOCSEX+35                                                07066000
IOCDLM   EQU   IOCSEX+36                                                07067000
IOCRCV   EQU   IOCSEX+44                                                07068000
CCREC    EQU   0                                                        07069000
CCRCI    EQU   CCREC                                                    07070000
CCRHACI  EQU   CCRCI+45                                                 07071000
CCRNFCI  EQU   CCRCI+48                                                 07072000
CCRNUM   EQU   CCRCI+51                                                 07073000
CCRFDCI  EQU   CCRCI+54                                                 07074000
RBAFIELD EQU   CCREC+57                                                 07075000
CATLREC  EQU   0                                                        07076000
RECKEY   EQU   CATLREC                                                  07077000
RCDKEYTY EQU   RECKEY                                                   07078000
RCDCINO  EQU   RECKEY+1                                                 07079000
RCDID    EQU   CATLREC+44                                               07080000
NREPCV   EQU   CATLREC+47                                               07081000
NREPLF   EQU   CATLREC+48                                               07082000
ENTNAME  EQU   CATLREC+49                                               07083000
VOLDVCHR EQU   CATLREC+101                                              07084000
DEVCLASS EQU   VOLDVCHR+2                                               07085000
FREEREC  EQU   0                                                        07086000
CLEARA   EQU   FREEREC+44                                               07087000
CLEARB   EQU   FREEREC+260                                              07088000
REC7     EQU   0                                                        07089000
REC7INDX EQU   REC7+60                                                  07090000
REC7OFFS EQU   REC7+61                                                  07091000
VOLHURBA EQU   REC7+80                                                  07092000
VOLHARBA EQU   REC7+84                                                  07093000
REC7STRT EQU   0                                                        07094000
REC7LNEX EQU   REC7STRT                                                 07095000
REC7XTNT EQU   REC7STRT+2                                               07096000
REC7LRBA EQU   REC7XTNT+12                                              07097000
REC7HRBA EQU   REC7XTNT+16                                              07098000
CINUM    EQU   0                                                        07099000
HKRR     EQU   0                                                        07100000
HKCINO   EQU   HKRR+44                                                  07101000
CFR      EQU   0                                                        07102000
CFRNEXT  EQU   CFR                                                      07103000
ASGO     EQU   1                                                        07104000
ASTYPE   EQU   ASGO                                                     07105000
ASCI     EQU   ASGO+1                                                   07106000
DSDGO    EQU   1                                                        07107000
DSDCI    EQU   DSDGO                                                    07108000
CATGOPT  EQU   0                                                        07109000
CATGOCI  EQU   CATGOPT                                                  07110000
CATGODSP EQU   CATGOCI+1                                                07111000
CATGOGC1 EQU   CATGOPT+3                                                07112000
CATGOEXT EQU   CATGOGC1                                                 07113000
CATGOGC  EQU   CATGOGC1                                                 07114000
CATGOSEQ EQU   CATGOPT+4                                                07115000
CATSN    EQU   0                                                        07116000
REPCNTRL EQU   0                                                        07117000
@NM00072 EQU   REPCNTRL                                                 07118000
EXTGOCI  EQU   @NM00072                                                 07119000
REPCNT   EQU   REPCNTRL+5                                               07120000
REPGOPT  EQU   REPCNTRL+6                                               07121000
VARFIELD EQU   0                                                        07122000
VARLEN   EQU   VARFIELD                                                 07123000
CNTRLINF EQU   0                                                        07124000
LENFIX   EQU   CNTRLINF+1                                               07125000
AMSTP041 EQU   0                                                        07126000
AMSTP042 EQU   0                                                        07127000
AMSTP043 EQU   0                                                        07128000
AMSTP044 EQU   0                                                        07129000
IDCIOIT0 EQU   0                                                        07130000
IDCIOSI0 EQU   0                                                        07131000
IDCIOST0 EQU   0                                                        07132000
IDCIOTM0 EQU   0                                                        07133000
IDCIO050 EQU   0                                                        07134000
IDCSACL0 EQU   0                                                        07135000
IDCSACR0 EQU   0                                                        07136000
IDCSADE0 EQU   0                                                        07137000
IDCSADQ0 EQU   0                                                        07138000
IDCSAFP0 EQU   0                                                        07139000
IDCSAFS0 EQU   0                                                        07140000
IDCSAGP0 EQU   0                                                        07141000
IDCSAGS0 EQU   0                                                        07142000
IDCSAID0 EQU   0                                                        07143000
IDCSALC0 EQU   0                                                        07144000
IDCSALD0 EQU   0                                                        07145000
IDCSALK0 EQU   0                                                        07146000
IDCSANQ0 EQU   0                                                        07147000
IDCSAPR0 EQU   0                                                        07148000
IDCSAPT0 EQU   0                                                        07149000
IDCSARC0 EQU   0                                                        07150000
IDCSARV0 EQU   0                                                        07151000
IDCSASC0 EQU   0                                                        07152000
IDCSASI0 EQU   0                                                        07153000
IDCSASN0 EQU   0                                                        07154000
IDCSASS0 EQU   0                                                        07155000
IDCSAST0 EQU   0                                                        07156000
IDCSATI0 EQU   0                                                        07157000
IDCSAUC0 EQU   0                                                        07158000
IDCSAWO0 EQU   0                                                        07159000
IDCSA060 EQU   0                                                        07160000
IDCST010 EQU   0                                                        07161000
IDCTPER0 EQU   0                                                        07162000
IDS      EQU   0                                                        07163000
LISTTEST EQU   0                                                        07164000
NEWERID1 EQU   5                                                        07165000
NREP     EQU   0                                                        07166000
NRUS     EQU   0                                                        07167000
GDTTBL   EQU   0                                                        07168000
GDTTR1   EQU   GDTTBL+8                                                 07169000
GDTTR2   EQU   GDTTBL+12                                                07170000
GDTIOH   EQU   GDTTBL+36                                                07171000
GDTDBG   EQU   GDTTBL+40                                                07172000
GDTSTC   EQU   GDTTBL+44                                                07173000
GDTPRT   EQU   GDTTBL+48                                                07174000
GDTESS   EQU   GDTTBL+52                                                07175000
GDTESA   EQU   GDTTBL+56                                                07176000
GDTRST   EQU   GDTTBL+60                                                07177000
GDTRES   EQU   GDTTBL+64                                                07178000
GDTCAL   EQU   GDTTBL+68                                                07179000
GDTGSP   EQU   GDTTBL+72                                                07180000
GDTFSP   EQU   GDTTBL+76                                                07181000
GDTGPL   EQU   GDTTBL+80                                                07182000
GDTFPL   EQU   GDTTBL+84                                                07183000
GDTLOD   EQU   GDTTBL+88                                                07184000
GDTDEL   EQU   GDTTBL+92                                                07185000
GDTPRL   EQU   GDTTBL+96                                                07186000
GDTEPL   EQU   GDTTBL+100                                               07187000
GDTTIM   EQU   GDTTBL+104                                               07188000
GDTIIO   EQU   GDTTBL+108                                               07189000
GDTTIO   EQU   GDTTBL+112                                               07190000
GDTOPN   EQU   GDTTBL+124                                               07191000
GDTCLS   EQU   GDTTBL+128                                               07192000
GDTGET   EQU   GDTTBL+132                                               07193000
GDTPUT   EQU   GDTTBL+136                                               07194000
GDTPOS   EQU   GDTTBL+140                                               07195000
GDTCPY   EQU   GDTTBL+144                                               07196000
GDTCAT   EQU   GDTTBL+148                                               07197000
GDTSNP   EQU   GDTTBL+164                                               07198000
GDTVFY   EQU   GDTTBL+172                                               07199000
GDTECT   EQU   GDTTBL+188                                               07200000
GDTUID   EQU   GDTTBL+192                                               07201000
GDTPMT   EQU   GDTTBL+196                                               07202000
GDTCIR   EQU   GDTTBL+200                                               07203000
GDTLNK   EQU   GDTTBL+204                                               07204000
GDTALC   EQU   GDTTBL+208                                               07205000
GDTDLC   EQU   GDTTBL+212                                               07206000
GDTQAL   EQU   GDTTBL+216                                               07207000
GDTSTW   EQU   GDTTBL+220                                               07208000
GDTSSC   EQU   GDTTBL+224                                               07209000
GDTENQ   EQU   GDTTBL+228                                               07210000
GDTRSV   EQU   GDTTBL+232                                               07211000
GDTDEQ   EQU   GDTTBL+236                                               07212000
GDTSFO   EQU   GDTTBL+240                                               07213000
GDTWTO   EQU   GDTTBL+244                                               07214000
GDTSCR   EQU   GDTTBL+248                                               07215000
GDTUNT   EQU   GDTTBL+252                                               07216000
GDTRCT   EQU   GDTTBL+256                                               07217000
GDTIFO   EQU   GDTTBL+260                                               07218000
GDTEXP   EQU   GDTTBL+264                                               07219000
GDTSTA   EQU   GDTTBL+268                                               07220000
GDTERR   EQU   GDTTBL+272                                               07221000
GDTUNC   EQU   GDTTBL+276                                               07222000
GDTLOC   EQU   GDTTBL+280                                               07223000
FDTTBL   EQU   0                                                        07224000
FDTPTR   EQU   FDTTBL+8                                                 07225000
LASTCC   EQU   0                                                        07226000
DELMFLG  EQU   0                                                        07227000
DELMCNT  EQU   0                                                        07228000
DELMINCR EQU   0                                                        07229000
@NM00042 EQU   CTGDDNM                                                  07230000
CTGPROB  EQU   @NM00042                                                 07231000
CTGREASN EQU   CTGPROB+2                                                07232000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    07233000
CTGREAS2 EQU   CTGREASN+1                                               07234000
CTGREAS1 EQU   CTGREASN                                                 07235000
CTGMODID EQU   CTGPROB                                                  07236000
FDTVERB  EQU   FDTTBL                                                   07237000
GDTPSB   EQU   GDTTBL+184                                               07238000
GDTUPT   EQU   GDTTBL+180                                               07239000
GDTCMB   EQU   GDTTBL+176                                               07240000
GDTSPR   EQU   GDTTBL+168                                               07241000
@NM00001 EQU   GDTTBL+160                                               07242000
GDTABH   EQU   GDTTBL+156                                               07243000
GDTABT   EQU   GDTTBL+152                                               07244000
GDTTOH   EQU   GDTTBL+120                                               07245000
GDTRIP   EQU   GDTTBL+116                                               07246000
GDTSAH   EQU   GDTTBL+32                                                07247000
GDTTPH   EQU   GDTTBL+28                                                07248000
GDTRIH   EQU   GDTTBL+24                                                07249000
GDTSTH   EQU   GDTTBL+20                                                07250000
GDTDBH   EQU   GDTTBL+16                                                07251000
GDTPRM   EQU   GDTTBL+4                                                 07252000
GDTHDR   EQU   GDTTBL                                                   07253000
@NM00073 EQU   CNTRLINF                                                 07254000
@NM00071 EQU   CATGOGC1                                                 07255000
@NM00070 EQU   CATGOCI                                                  07256000
HKNAME   EQU   HKRR                                                     07257000
@NM00069 EQU   REC7XTNT                                                 07258000
@NM00068 EQU   REC7+62                                                  07259000
@NM00067 EQU   REC7                                                     07260000
@NM00066 EQU   FREEREC+505                                              07261000
@NM00065 EQU   FREEREC                                                  07262000
DEVFLAGS EQU   VOLDVCHR                                                 07263000
X        EQU   CATLREC+93                                               07264000
@NM00064 EQU   CATLREC+45                                               07265000
@NM00062 EQU   CCRCI                                                    07266000
@NM00061 EQU   IOCRCV                                                   07267000
IOCRCVRA EQU   IOCRCV                                                   07268000
IOCRCVXM EQU   IOCRCV                                                   07269000
IOCVLN   EQU   IOCSEX+42                                                07270000
IOCDNM   EQU   IOCSEX+40                                                07271000
IOCDDN   EQU   IOCDLM                                                   07272000
IOCMODEX EQU   IOCMOD                                                   07273000
IOCMODRP EQU   IOCMOD                                                   07274000
IOCMODXM EQU   IOCMOD                                                   07275000
IOCMODUB EQU   IOCMOD                                                   07276000
IOCMODRG EQU   IOCMOD                                                   07277000
IOCMODDY EQU   IOCMOD                                                   07278000
IOCMODRR EQU   IOCMOD                                                   07279000
IOCMODPD EQU   IOCMOD                                                   07280000
IOCINFR1 EQU   IOCINF                                                   07281000
IOCINFCT EQU   IOCINF                                                   07282000
IOCINFDO EQU   IOCINF                                                   07283000
IOCINFAC EQU   IOCINF                                                   07284000
IOCINFQX EQU   IOCINF                                                   07285000
IOCINFND EQU   IOCINF                                                   07286000
IOCINFAE EQU   IOCINF                                                   07287000
IOCINFPT EQU   IOCINF                                                   07288000
@NM00060 EQU   IOCDEV                                                   07289000
IOCDEVUR EQU   IOCDEV                                                   07290000
IOCDEVMT EQU   IOCDEV                                                   07291000
IOCDEVDA EQU   IOCDEV                                                   07292000
@NM00059 EQU   IOCFLG                                                   07293000
IOCFLGSP EQU   IOCFLG                                                   07294000
IOCFLGOE EQU   IOCFLG                                                   07295000
IOCFLGOP EQU   IOCFLG                                                   07296000
IOCFLGIO EQU   IOCFLG                                                   07297000
IOCFLGDF EQU   IOCFLG                                                   07298000
IOCFLGEX EQU   IOCFLG                                                   07299000
IOCSID   EQU   IOCSEX+28                                                07300000
IOCNIO   EQU   IOCSEX+24                                                07301000
@NM00058 EQU   IOCXPM+2                                                 07302000
IOCEXL   EQU   IOCXPM                                                   07303000
IOCEXA   EQU   IOCXAD                                                   07304000
IOCWKA   EQU   IOCSEX+12                                                07305000
IOCLRP   EQU   IOCSEX+10                                                07306000
IOCCBL   EQU   IOCSEX+8                                                 07307000
IOCDEC   EQU   IOCRPL                                                   07308000
IOCCBA   EQU   IOCSEX                                                   07309000
@NM00057 EQU   IODATA+64                                                07310000
IODAEI   EQU   IODATA+60                                                07311000
@NM00056 EQU   IODATA+56                                                07312000
IODIOX   EQU   IODATA+52                                                07313000
IODOCS   EQU   IODATA+48                                                07314000
IODICS   EQU   IODATA+44                                                07315000
IODOSO   EQU   IODATA+40                                                07316000
IODOSS   EQU   IODATA+36                                                07317000
IODEOD   EQU   IODATA+32                                                07318000
@NM00055 EQU   IODATA+30                                                07319000
@NM00054 EQU   IODATA+28                                                07320000
IODOEV   EQU   IODATA+24                                                07321000
IODIEV   EQU   IODATA+20                                                07322000
IODINC   EQU   IODSID+2                                                 07323000
IODMID   EQU   IODSID                                                   07324000
IODXTN   EQU   IODATA+12                                                07325000
IODADD   EQU   IODATA+8                                                 07326000
IODMSG   EQU   IODATA+4                                                 07327000
IODIOC   EQU   IODATA                                                   07328000
@NM00053 EQU   DATRMASK+1                                               07329000
@NM00052 EQU   @NM00050                                                 07330000
@NM00051 EQU   @NM00050                                                 07331000
CTGFLNG  EQU   CTGFLDAT                                                 07332000
CTGFLCHN EQU   CTGFL+12                                                 07333000
CTGFLDWA EQU   CTGFL+4                                                  07334000
CTGFLDTS EQU   CTGFLDRE                                                 07335000
@NM00043 EQU   CTGFLDRE                                                 07336000
CTGFLDGC EQU   CTGFL+2                                                  07337000
CTGFLDCD EQU   CTGFL+1                                                  07338000
@NM00041 EQU   CTGFBFLG                                                 07339000
CTGNGDSN EQU   CTGFBFLG                                                 07340000
CTGGDGB  EQU   CTGFBFLG                                                 07341000
CTGKEEP  EQU   CTGFBFLG                                                 07342000
CTGPAR   EQU   CTGFBFLG                                                 07343000
CTGFDBK  EQU   CTGNEWNM                                                 07344000
CTGTYPE  EQU   CTGPL+18                                                 07345000
@NM00040 EQU   CTGDSORG                                                 07346000
CTGOPTNS EQU   CTGDSORG                                                 07347000
CTGCVOL  EQU   CTGCAT                                                   07348000
CTGFVT   EQU   CTGENT                                                   07349000
@NM00039 EQU   CTGOPTN4                                                 07350000
CTGTIOT  EQU   CTGOPTN4                                                 07351000
CTGBYPMT EQU   CTGOPTN4                                                 07352000
CTGCOIN  EQU   CTGOPTN4                                                 07353000
@NM00038 EQU   CTGOPTN4                                                 07354000
CTGDOCAT EQU   CTGOPTN4                                                 07355000
CTGLBASE EQU   CTGOPTN4                                                 07356000
CTGGDGL  EQU   CTGOPTN3                                                 07357000
CTGSUPLT EQU   CTGOPTN3                                                 07358000
@NM00037 EQU   CTGOPTN2                                                 07359000
CTGSCR   EQU   CTGOPTN2                                                 07360000
CTGOVRID EQU   CTGOPTN2                                                 07361000
CTGDISC  EQU   CTGOPTN2                                                 07362000
CTGGTNXT EQU   CTGOPTN2                                                 07363000
CTGRCATN EQU   CTGVMNT                                                  07364000
CTGGTALL EQU   CTGREL                                                   07365000
CTGNSVS  EQU   CTGEXT                                                   07366000
CTGGENLD EQU   CTGOPTN1                                                 07367000
CTGREAD  EQU   CTGOPTN1                                                 07368000
CTGUPD   EQU   CTGOPTN1                                                 07369000
CTGCI    EQU   CTGOPTN1                                                 07370000
CTGMAST  EQU   CTGOPTN1                                                 07371000
CTGBYPSS EQU   CTGOPTN1                                                 07372000
INDSMEM  EQU   INDS+12                                                  07373000
INDSMLN  EQU   INDS+11                                                  07374000
INDSPOS  EQU   INDS+9                                                   07375000
OUTDSMEM EQU   OUTDS+12                                                 07376000
OUTDSMLN EQU   OUTDS+11                                                 07377000
OUTDSPOS EQU   OUTDS+9                                                  07378000
OUTDDLEN EQU   OUTDD+9                                                  07379000
INPDDLEN EQU   INPDD+9                                                  07380000
@NM00036 EQU   DMPARY+15                                                07381000
DMPARYTP EQU   DMPARY+14                                                07382000
DMPARYEX EQU   DMPARY+12                                                07383000
DMPARYIC EQU   DMPARY+10                                                07384000
DMPARYSZ EQU   DMPARY+8                                                 07385000
DMPARYNM EQU   DMPARY                                                   07386000
@NM00035 EQU   DMPITM+15                                                07387000
@NM00034 EQU   ERCNVTAB+24                                              07388000
ERCPLPT  EQU   ERCNVTAB+20                                              07389000
ERCATRC  EQU   ERCNVTAB+16                                              07390000
ERDSNM   EQU   ERCNVTAB+12                                              07391000
@NM00033 EQU   ERCNVTAB+4                                               07392000
@NM00032 EQU   ERCNVTAB+3                                               07393000
@NM00031 EQU   EROSOPER                                                 07394000
EROSUCDX EQU   EROSOPER                                                 07395000
EROSCATL EQU   EROSOPER                                                 07396000
@NM00030 EQU   EROPER                                                   07397000
ERCATAL  EQU   EROPER                                                   07398000
ERCATDL  EQU   EROPER                                                   07399000
ERCATDE  EQU   EROPER                                                   07400000
ERCATLC  EQU   EROPER                                                   07401000
@NM00029 EQU   ERTYPE                                                   07402000
EROSCAT  EQU   ERTYPE                                                   07403000
ERCATLG  EQU   ERTYPE                                                   07404000
@NM00028 EQU   FMTCNVF+1                                                07405000
FMTAR    EQU   FMTCNVF+1                                                07406000
FMTBS    EQU   FMTCNVF+1                                                07407000
FMTSS    EQU   FMTCNVF+1                                                07408000
FMTAL    EQU   FMTCNVF+1                                                07409000
FMTZS    EQU   FMTCNVF+1                                                07410000
@NM00027 EQU   FMTCNVF                                                  07411000
FMTPU    EQU   FMTCNVF                                                  07412000
FMTBD    EQU   FMTCNVF                                                  07413000
FMTBHD   EQU   FMTCNVF                                                  07414000
FMTBHA   EQU   FMTCNVF                                                  07415000
FMTBH    EQU   FMTCNVF                                                  07416000
FMTOLEN  EQU   FMTLIST+8                                                07417000
FMTRIO   EQU   FMTOCOL                                                  07418000
FMTSPT   EQU   FMTSTO                                                   07419000
FMTSTL   EQU   FMTILEN                                                  07420000
@NM00026 EQU   FMTFLGS+1                                                07421000
FMTHDF   EQU   FMTFLGS                                                  07422000
FMTDFF   EQU   FMTFLGS                                                  07423000
FMTSTF   EQU   FMTFLGS                                                  07424000
FMTREPF  EQU   FMTFLGS                                                  07425000
FMTBDF   EQU   FMTFLGS                                                  07426000
FMTIDF   EQU   FMTFLGS                                                  07427000
FMTSCF   EQU   FMTFLGS                                                  07428000
FMTEOLF  EQU   FMTFLGS                                                  07429000
DARGPCT  EQU   DARGINL                                                  07430000
DARGREP  EQU   DARGINS                                                  07431000
@NM00025 EQU   DARGFLGS                                                 07432000
DARGFULL EQU   DARGFLGS                                                 07433000
DARGIND  EQU   DARGLIST+18                                              07434000
DARGRETL EQU   DARGLIST+16                                              07435000
DARGRETP EQU   DARGLIST+4                                               07436000
UVOLVOL  EQU   UVOLENT+4                                                07437000
UVOLDEV  EQU   UVOLENT                                                  07438000
UVOLCNT  EQU   UVOLLIST                                                 07439000
@NM00024 EQU   IOINFOPT                                                 07440000
IOINFTMS EQU   IOINFOPT                                                 07441000
IOINFSUP EQU   IOINFOPT                                                 07442000
IOINFDSN EQU   IOINFOPT                                                 07443000
IOINFVOL EQU   IOINFOPT                                                 07444000
IOINFDVT EQU   IOINFOPT                                                 07445000
OPNVOL   EQU   OPNAGL+44                                                07446000
@NM00023 EQU   OPNAGL+43                                                07447000
@NM00022 EQU   OPNOPT2                                                  07448000
OPNOPTJM EQU   OPNOPT2                                                  07449000
OPNOPTNM EQU   OPNOPT2                                                  07450000
OPNOPTAS EQU   OPNOPT2                                                  07451000
@NM00021 EQU   OPNDSO                                                   07452000
OPNDSOPO EQU   OPNDSO                                                   07453000
OPNDSOIS EQU   OPNDSO                                                   07454000
OPNDSOPS EQU   OPNDSO                                                   07455000
OPNDSOAM EQU   OPNDSO                                                   07456000
OPNKYL   EQU   OPNAGL+40                                                07457000
OPNBLK   EQU   OPNAGL+36                                                07458000
OPNREC   EQU   OPNAGL+32                                                07459000
OPNDEVIX EQU   OPNDEV+4                                                 07460000
OPNDEVDT EQU   OPNDEV                                                   07461000
OPNCBP   EQU   OPNAGL+20                                                07462000
OPNMODUB EQU   OPNMOD                                                   07463000
OPNMODAX EQU   OPNMOD                                                   07464000
OPNMODRR EQU   OPNMOD                                                   07465000
OPNMODRC EQU   OPNMOD                                                   07466000
OPNMODAC EQU   OPNMOD                                                   07467000
@NM00020 EQU   OPNTYP                                                   07468000
OPNTYPRV EQU   OPNTYP                                                   07469000
OPNTYPEX EQU   OPNTYP                                                   07470000
OPNTYPRA EQU   OPNTYP                                                   07471000
OPNTYPXM EQU   OPNTYP                                                   07472000
OPNTYPCI EQU   OPNTYP                                                   07473000
OPNTYPSO EQU   OPNTYP                                                   07474000
OPNTYPSI EQU   OPNTYP                                                   07475000
@NM00019 EQU   OPNRFM                                                   07476000
OPNRFMBK EQU   OPNRFM                                                   07477000
OPNRFMSF EQU   OPNRFM                                                   07478000
OPNRFMUN EQU   OPNRFM                                                   07479000
OPNRFMVR EQU   OPNRFM                                                   07480000
OPNRFMFX EQU   OPNRFM                                                   07481000
OPNOPTSK EQU   OPNOPT                                                   07482000
OPNOPTDR EQU   OPNOPT                                                   07483000
IOCWORK  EQU   IOCSTR+56                                                07484000
IOCPNM   EQU   IOCNWM+2                                                 07485000
IOCCBP   EQU   IOCSTR+36                                                07486000
IOCVOLSR EQU   IOCSTR+22                                                07487000
@NM00018 EQU   IOCMSG                                                   07488000
IOCMSGAE EQU   IOCMSG                                                   07489000
IOCMSGCE EQU   IOCMSG                                                   07490000
IOCMSGOE EQU   IOCMSG                                                   07491000
@NM00017 EQU   IOCMSG                                                   07492000
IOCCHPSY EQU   IOCCHP                                                   07493000
IOCCHPAS EQU   IOCCHP                                                   07494000
IOCCHPBK EQU   IOCCHP                                                   07495000
IOCCHPCR EQU   IOCCHP                                                   07496000
IOCCHPKS EQU   IOCCHP                                                   07497000
IOCCHPSK EQU   IOCCHP                                                   07498000
IOCCHPDR EQU   IOCCHP                                                   07499000
IOCCHPSQ EQU   IOCCHP                                                   07500000
@NM00016 EQU   IOCMAC2                                                  07501000
IOCMACPA EQU   IOCMAC2                                                  07502000
@NM00015 EQU   IOCMAC2                                                  07503000
IOCMACCP EQU   IOCMAC2                                                  07504000
IOCMACAS EQU   IOCMAC2                                                  07505000
IOCMACSK EQU   IOCMAC2                                                  07506000
@NM00014 EQU   IOCMAC                                                   07507000
IOCMACDR EQU   IOCMAC                                                   07508000
IOCMACBK EQU   IOCMAC                                                   07509000
IOCMACCR EQU   IOCMAC                                                   07510000
IOCMACUP EQU   IOCMAC                                                   07511000
IOCMACOT EQU   IOCMAC                                                   07512000
IOCMACIN EQU   IOCMAC                                                   07513000
@NM00013 EQU   IOCRFM                                                   07514000
IOCRFMBK EQU   IOCRFM                                                   07515000
IOCRFMSF EQU   IOCRFM                                                   07516000
IOCRFMUN EQU   IOCRFM                                                   07517000
IOCRFMVR EQU   IOCRFM                                                   07518000
IOCRFMFX EQU   IOCRFM                                                   07519000
@NM00012 EQU   IOCDSO                                                   07520000
IOCDSOPO EQU   IOCDSO                                                   07521000
IOCDSOIS EQU   IOCDSO                                                   07522000
IOCDSOPS EQU   IOCDSO                                                   07523000
IOCRKP   EQU   IOCSTR+13                                                07524000
IOCTRN   EQU   IOCSTR+8                                                 07525000
UNITVTOC EQU   UNITABL+7                                                07526000
@NM00011 EQU   UNITSTAT                                                 07527000
UNITUSHR EQU   UNITSTAT                                                 07528000
UNITXSHR EQU   UNITSTAT                                                 07529000
UNITISHR EQU   UNITSTAT                                                 07530000
UNITUA   EQU   @NM00010+1                                               07531000
UNITCHA  EQU   @NM00010                                                 07532000
UNITUCB  EQU   UNITABL                                                  07533000
ALLUNCNT EQU   ALLAGL+30                                                07534000
ALLVLCNT EQU   ALLAGL+29                                                07535000
@NM00009 EQU   ALLOPT                                                   07536000
ALLOPTUN EQU   ALLOPT                                                   07537000
ALLOPTPV EQU   ALLOPT                                                   07538000
ALLOPTVL EQU   ALLOPT                                                   07539000
@NM00008 EQU   ALLORG+1                                                 07540000
ALLORGVS EQU   ALLORG+1                                                 07541000
@NM00007 EQU   ALLORG+1                                                 07542000
ALLORGGS EQU   ALLORG+1                                                 07543000
ALLORGUN EQU   ALLORG                                                   07544000
ALLORGPO EQU   ALLORG                                                   07545000
ALLORGMQ EQU   ALLORG                                                   07546000
ALLORGCQ EQU   ALLORG                                                   07547000
ALLORGCX EQU   ALLORG                                                   07548000
ALLORGDA EQU   ALLORG                                                   07549000
ALLORGPS EQU   ALLORG                                                   07550000
ALLORGIS EQU   ALLORG                                                   07551000
ALLDSPUN EQU   ALLDSP                                                   07552000
ALLDSPCG EQU   ALLDSP                                                   07553000
ALLDSPDE EQU   ALLDSP                                                   07554000
@NM00006 EQU   ALLDSP                                                   07555000
ALLSTSMD EQU   ALLSTS                                                   07556000
ALLSTSNW EQU   ALLSTS                                                   07557000
ALLSTSSR EQU   ALLSTS                                                   07558000
@NM00005 EQU   ALLSTS                                                   07559000
ALLVLP   EQU   ALLAGL+16                                                07560000
ALLULP   EQU   ALLAGL+12                                                07561000
CIRPID   EQU   CIRAGL+28                                                07562000
CIRPWD   EQU   CIRAGL+24                                                07563000
CIRCAT   EQU   CIRAGL+20                                                07564000
CIRWKP   EQU   CIRAGL+16                                                07565000
CIRTLR   EQU   CIRAGL+12                                                07566000
CIRHDR   EQU   CIRAGL+8                                                 07567000
CIRTLN   EQU   CIRAGL+6                                                 07568000
CIRHLN   EQU   CIRAGL+4                                                 07569000
@NM00004 EQU   CIRAGL+1                                                 07570000
@NM00003 EQU   CIRTYPE                                                  07571000
CIRTYPAQ EQU   CIRTYPE                                                  07572000
CIRTYP1Q EQU   CIRTYPE                                                  07573000
NEWID1   EQU   TRACE1+95                                                07574000
CALLID   EQU   OLDERID1+90                                              07575000
@NM00002 EQU   OLDERID1                                                 07576000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      07577000
@RF00281 EQU   @RC00278                                                 07578000
@RF00318 EQU   @RC00315                                                 07579000
@RF00536 EQU   @RC00534                                                 07580000
@RF00541 EQU   @RC00539                                                 07581000
@RF00578 EQU   @RC00569                                                 07582000
@RF00740 EQU   @EL00002                                                 07583000
@RC00726 EQU   @EL00002                                                 07584000
@RF00820 EQU   @RC00808                                                 07585000
@RF00908 EQU   @RC00869                                                 07586000
@RF01008 EQU   @RC00994                                                 07587000
@RF01021 EQU   @RC00994                                                 07588000
@RF01127 EQU   @EL00004                                                 07589000
@RF01148 EQU   @EL00005                                                 07590000
@RF01169 EQU   @EL00006                                                 07591000
@RT01175 EQU   @EL00006                                                 07592000
@RT01207 EQU   @EL00007                                                 07593000
@RT01229 EQU   @EL00008                                                 07594000
@RT01244 EQU   @EL00008                                                 07595000
@RC01252 EQU   @EL00009                                                 07596000
@RF01364 EQU   @EL00010                                                 07597000
@RF01407 EQU   @EL00011                                                 07598000
@RF01457 EQU   @EL00012                                                 07599000
@RF01463 EQU   @EL00012                                                 07600000
@RF01473 EQU   @EL00013                                                 07601000
@PB00013 EQU   @EL00001                                                 07602000
@RF00734 EQU   @RC00726                                                 07603000
@PB00003 EQU   @PB00013                                                 07604000
@PB00002 EQU   @PB00003                                                 07605000
@ENDDATA EQU   *                                                        07606000
         END   IDCRP01,(C'PLS2233',0701,77258)                          07607000
