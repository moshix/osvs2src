         TITLE '********** IDCRR01: REMOVEVR FUNCTION SUPPORT ROUTINE **00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCRR01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCRR01   75.225'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @10,4095(,@12)                                      0002 00022000
         USING @PSTART,@12                                         0002 00023000
         USING @PSTART+4095,@10                                    0002 00024000
         L     @00,@SIZDATD                                        0002 00025000
         GETMAIN  R,LV=(0)                                              00026000
         LR    @11,@01                                             0002 00027000
         USING @DATD,@11                                           0002 00028000
         ST    @13,@SA00001+4                                      0002 00029000
         LM    @00,@01,20(@13)                                     0002 00030000
         ST    @11,8(,@13)                                         0002 00031000
         LR    @13,@11                                             0002 00032000
         MVC   @PC00001(12),0(@01)                                 0002 00033000
*                                                                  0229 00034000
*   /*****************************************************************/ 00035000
*   /*                                                               */ 00036000
*   /* THIS IS THE MAIN CONTROL ROUTING SECTION OF REMOVEVR. @Y30LB11*/ 00037000
*   /* MESSAGES ISSUED IN THIS ROUTINE ARE IDC0001I, AND     @Y30LB11*/ 00038000
*   /* IDC3003I. THE EXIT POINT FROM THE REMOVEVR FSR IS     @Y30LB11*/ 00039000
*   /* CONTAINED IN THIS PROCEDURE.                          @Y30LB11*/ 00040000
*   /*                                                               */ 00041000
*   /*****************************************************************/ 00042000
*                                                                  0229 00043000
*                                                                  0229 00044000
*   /*****************************************************************/ 00045000
*   /*                                                               */ 00046000
*   /* TRACE AT ENTRY TO REMOVEVR                            @Y30LB11*/ 00047000
*   /*                                                               */ 00048000
*   /*****************************************************************/ 00049000
*                                                                  0229 00050000
*   OLDERID2=NEWERID2;                                             0229 00051000
         L     @05,@PC00001                                        0229 00052000
         L     @15,GDTTR2(,@05)                                    0229 00053000
         MVC   @TS00001(95),NEWERID2(@15)                          0229 00054000
         MVC   OLDERID2(95,@15),@TS00001                           0229 00055000
*   NEWID2='RRRM';                  /* TRACE MACRO           @Y30LB11*/ 00056000
*                                                                  0230 00057000
         MVC   NEWID2(4,@15),@CC01145                              0230 00058000
*   /*****************************************************************/ 00059000
*   /*                                                               */ 00060000
*   /* FULL REGION DUMP BEFORE PROCESSING REMOVE VOLUME RECORD       */ 00061000
*   /* REQUEST.                                              @Y30LB11*/ 00062000
*   /*                                                               */ 00063000
*   /*****************************************************************/ 00064000
*                                                                  0231 00065000
*   IF GDTDBG=NULLPTR THEN                                         0231 00066000
         L     @05,GDTDBG(,@05)                                    0231 00067000
         LTR   @05,@05                                             0231 00068000
         BZ    @RT00231                                            0231 00069000
*     ;                                                            0232 00070000
*   ELSE                                                           0233 00071000
*     CALL IDCDB010(GDTTBL,'RRRR'); /* DUMP MACRO            @Y30LB11*/ 00072000
*                                                                  0233 00073000
         L     @05,@PC00001                                        0233 00074000
         ST    @05,@AL00001                                        0233 00075000
         LA    @15,@CC01146                                        0233 00076000
         ST    @15,@AL00001+4                                      0233 00077000
         MVI   @AL00001+4,X'80'                                    0233 00078000
         L     @15,GDTDBG(,@05)                                    0233 00079000
         LA    @01,@AL00001                                        0233 00080000
         BALR  @14,@15                                             0233 00081000
*   /*****************************************************************/ 00082000
*   /*                                                               */ 00083000
*   /* SET ADDRESSABILITY TO DATA AREAS USED IN MODULE       @Y30LB11*/ 00084000
*   /*                                                               */ 00085000
*   /*****************************************************************/ 00086000
*                                                                  0234 00087000
*   BASEVPTR=ADDR(BASEAREA);        /*                       @Y30LB11*/ 00088000
@RT00231 LA    BASEVPTR,BASEAREA                                   0234 00089000
*   COPYVPTR=ADDR(COPYAREA);        /*                       @Y30LB11*/ 00090000
         LA    COPYVPTR,COPYAREA                                   0235 00091000
*   DEFLPTR=ADDR(DEFAREA);          /*                       @Y30LB11*/ 00092000
         LA    @07,DEFAREA                                         0236 00093000
         ST    @07,DEFLPTR                                         0236 00094000
*   DDSTRU=ADDR(DARGAREA);          /*                       @Y30LB11*/ 00095000
         LA    @15,DARGAREA                                        0237 00096000
         ST    @15,DDSTRU                                          0237 00097000
*   RVRPTR=ADDR(RVRAREA);           /*                       @Y30LB11*/ 00098000
         LA    @15,RVRAREA                                         0238 00099000
         ST    @15,RVRPTR                                          0238 00100000
*   RVVIPTR=ADDR(RVVIAREA);         /*                       @Y30LB11*/ 00101000
*                                                                  0239 00102000
         LA    @14,RVVIAREA                                        0239 00103000
         ST    @14,RVVIPTR                                         0239 00104000
*   /*****************************************************************/ 00105000
*   /*                                                               */ 00106000
*   /* INITIALIZE DATA AREAS TO ZERO                         @Y30LB11*/ 00107000
*   /*                                                               */ 00108000
*   /*****************************************************************/ 00109000
*                                                                  0240 00110000
*   BASEV=''B;                      /*                       @Y30LB11*/ 00111000
         XC    BASEV(224,BASEVPTR),BASEV(BASEVPTR)                 0240 00112000
*   COPYV=''B;                      /*                       @Y30LB11*/ 00113000
         XC    COPYV(164,COPYVPTR),COPYV(COPYVPTR)                 0241 00114000
*   DEFLIST=''B;                    /*                       @Y30LB11*/ 00115000
         XC    DEFLIST(132,@07),DEFLIST(@07)                       0242 00116000
*   RVR=''B;                        /*                       @Y30LB11*/ 00117000
         XC    RVR(24,@15),RVR(@15)                                0243 00118000
*   RVVI=''B;                       /*                       @Y30LB11*/ 00119000
         XC    RVVI(68,@14),RVVI(@14)                              0244 00120000
*   RMVDFLG=OFF;                    /*                       @Y30LB11*/ 00121000
         NI    RMVDFLG,B'01111111'                                 0245 00122000
*   WARNFLG=OFF;                    /*                       @Y30LB11*/ 00123000
*                                                                  0246 00124000
         NI    WARNFLG,B'01111111'                                 0246 00125000
*   /*****************************************************************/ 00126000
*   /*                                                               */ 00127000
*   /* INITIALIZE DEFLIST, RVVI AND RVR PARAMETER LISTS      @Y30LB11*/ 00128000
*   /*                                                               */ 00129000
*   /*****************************************************************/ 00130000
*                                                                  0247 00131000
*   DEFVRNTR=ON;                    /*                       @Y30LB11*/ 00132000
         OI    DEFVRNTR(@07),B'00000100'                           0247 00133000
*   DEFVOLD=VOLVAL;                 /*                       @Y30LB11*/ 00134000
         L     @09,@PC00001+4                                      0248 00135000
         L     @08,FDTPTR(,@09)                                    0248 00136000
         MVC   DEFVOLD(6,@07),VOLVAL(@08)                          0248 00137000
*   DEFVNVOL=VOLVAL;                /*                       @Y30LB11*/ 00138000
         MVC   DEFVNVOL(6,@07),VOLVAL(@08)                         0249 00139000
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB11*/ 00140000
         LH    @07,RVVLEN                                          0250 00141000
         ST    @07,RVVLNGTH(,@14)                                  0250 00142000
*   RVVCODE=RVVOP;                  /*                       @Y30LB11*/ 00143000
         MVI   RVVCODE(@14),X'87'                                  0251 00144000
*   RVVOLUME=VOLVAL;                /*                       @Y30LB11*/ 00145000
         MVC   RVVOLUME(6,@14),VOLVAL(@08)                         0252 00146000
*   RVVSVOL=ON;                     /*                       @Y30LB11*/ 00147000
         OI    RVVSVOL(@14),B'00000001'                            0253 00148000
*   RVRLNGTH=RVRLEN;                /*                       @Y30LB11*/ 00149000
         LH    @07,RVRLEN                                          0254 00150000
         ST    @07,RVRLNGTH(,@15)                                  0254 00151000
*   RVRCODE=RVROP;                  /*                       @Y30LB11*/ 00152000
         XC    RVRCODE+1(3,@15),RVRCODE+1(@15)                     0255 00153000
         MVI   RVRCODE(@15),X'81'                                  0255 00154000
*   RVRVOLID=VOLVAL;                /*                       @Y30LB11*/ 00155000
         MVC   RVRVOLID(6,@15),VOLVAL(@08)                         0256 00156000
*                                                                  0257 00157000
*   /*****************************************************************/ 00158000
*   /*                                                               */ 00159000
*   /* IF COPYDATE WAS SPECIFIED THEN CALL COPYPROC TO SCRATCH THE   */ 00160000
*   /* SPECIFIED COPY RECORD.                                @Y30LB11*/ 00161000
*   /*                                                               */ 00162000
*   /*****************************************************************/ 00163000
*                                                                  0257 00164000
*   IF ADDR(CDATE)^=NULLPTR THEN    /*                       @Y30LB11*/ 00165000
         L     @07,FDTPTR+8(,@09)                                  0257 00166000
         LTR   @07,@07                                             0257 00167000
         BZ    @RF00257                                            0257 00168000
*     DO;                           /*                       @Y30LB11*/ 00169000
*       CALL COPYPROC;              /*                       @Y30LB11*/ 00170000
         BAL   @14,COPYPROC                                        0259 00171000
*       RESPECIFY                                                  0260 00172000
*         RTNREG RSTD;                                             0260 00173000
*       TESTRC=RTNREG;                                             0261 00174000
         LR    TESTRC,RTNREG                                       0261 00175000
*       RESPECIFY                                                  0262 00176000
*         RTNREG UNRSTD;            /*                       @Y30LB11*/ 00177000
*                                                                  0262 00178000
*       /*************************************************************/ 00179000
*       /*                                                           */ 00180000
*       /* IF COPYPROC WAS UNSUCCESSFUL, THEN SET RETURN CODE TO     */ 00181000
*       /* INDICATE FAILURE.                                 @Y30LB11*/ 00182000
*       /*                                                           */ 00183000
*       /*************************************************************/ 00184000
*                                                                  0263 00185000
*       IF TESTRC=4 THEN            /*                       @Y30LB11*/ 00186000
         LA    @05,4                                               0263 00187000
         CR    TESTRC,@05                                          0263 00188000
         BNE   @RF00263                                            0263 00189000
*         SETRC=4;                  /*                       @Y30LB11*/ 00190000
         LR    SETRC,@05                                           0264 00191000
*     END;                          /*                       @Y30LB11*/ 00192000
*                                                                  0265 00193000
*   /*****************************************************************/ 00194000
*   /*                                                               */ 00195000
*   /* IF COPYDATE WAS NOT SPECIFIED, REMOVE THE BASE VOLUME RECORD. */ 00196000
*   /*                                                       @Y30LB11*/ 00197000
*   /*                                                               */ 00198000
*   /*****************************************************************/ 00199000
*                                                                  0266 00200000
*   ELSE                            /*                       @Y30LB11*/ 00201000
*     DO;                           /*                       @Y30LB11*/ 00202000
*                                                                  0266 00203000
         B     @RC00257                                            0266 00204000
@RF00257 DS    0H                                                  0267 00205000
*       /*************************************************************/ 00206000
*       /*                                                           */ 00207000
*       /* CALL BASEALL TO REMOVE ALL THE COPY RECORDS AND/OR THE    */ 00208000
*       /* BASE RECORD.                                      @Y30LB11*/ 00209000
*       /*                                                           */ 00210000
*       /*************************************************************/ 00211000
*                                                                  0267 00212000
*       CALL BASEALL;               /*                       @Y30LB11*/ 00213000
         BAL   @14,BASEALL                                         0267 00214000
*       RESPECIFY                                                  0268 00215000
*         RTNREG RSTD;                                             0268 00216000
*       TESTRC=RTNREG;                                             0269 00217000
         LR    TESTRC,RTNREG                                       0269 00218000
*       RESPECIFY                                                  0270 00219000
*         RTNREG UNRSTD;            /*                       @Y30LB11*/ 00220000
*                                                                  0270 00221000
*       /*************************************************************/ 00222000
*       /*                                                           */ 00223000
*       /* IF BASEALL WAS UNSUCCESSFUL, THEN SET RETURN CODE @Y30LB11*/ 00224000
*       /* TO INDICATE FAILURE.                              @Y30LB11*/ 00225000
*       /*                                                           */ 00226000
*       /*************************************************************/ 00227000
*                                                                  0271 00228000
*       IF TESTRC=4 THEN            /*                       @Y30LB11*/ 00229000
         LA    @05,4                                               0271 00230000
         CR    TESTRC,@05                                          0271 00231000
         BNE   @RF00271                                            0271 00232000
*         SETRC=4;                  /*                       @Y30LB11*/ 00233000
         LR    SETRC,@05                                           0272 00234000
*     END;                          /*                       @Y30LB11*/ 00235000
@RF00271 DS    0H                                                  0274 00236000
*                                                                  0274 00237000
*   /*****************************************************************/ 00238000
*   /*                                                               */ 00239000
*   /* IF A WARNING ERROR OCCURRED, THE FINAL CONDITION CODE IS SET  */ 00240000
*   /* TO 4. THEN IF A SEVERE ERROR OCCURRED, THE FINAL CONDITION    */ 00241000
*   /* CODE IS SET TO 8 IF AT LEAST 1 RECORD WAS REMOVED, OTHERWISE  */ 00242000
*   /* IT IS SET TO 12.                                      @Y30LB11*/ 00243000
*   /*                                                               */ 00244000
*   /*****************************************************************/ 00245000
*                                                                  0274 00246000
*   IF WARNFLG=ON THEN                                             0274 00247000
@RC00257 TM    WARNFLG,B'10000000'                                 0274 00248000
         BNO   @RF00274                                            0274 00249000
*     LASTCOND=LASTCC04;            /*                       @Y30LB11*/ 00250000
         L     @05,@PC00001+8                                      0275 00251000
         MVC   LASTCOND(2,@05),@CH00041                            0275 00252000
*   IF SETRC=4 THEN                 /*                       @Y30LB11*/ 00253000
@RF00274 C     SETRC,@CF00041                                      0276 00254000
         BNE   @RF00276                                            0276 00255000
*     IF RMVDFLG=ON THEN            /*                       @Y30LB11*/ 00256000
         TM    RMVDFLG,B'10000000'                                 0277 00257000
         BNO   @RF00277                                            0277 00258000
*       LASTCOND=LASTCC08;          /*                       @Y30LB11*/ 00259000
         L     @15,@PC00001+8                                      0278 00260000
         MVC   LASTCOND(2,@15),@CH00173                            0278 00261000
*     ELSE                          /*                       @Y30LB11*/ 00262000
*       LASTCOND=LASTCC12;          /*                       @Y30LB11*/ 00263000
*                                                                  0279 00264000
         B     @RC00277                                            0279 00265000
@RF00277 L     @15,@PC00001+8                                      0279 00266000
         MVC   LASTCOND(2,@15),@CH00035                            0279 00267000
*   /*****************************************************************/ 00268000
*   /*                                                               */ 00269000
*   /* ISSUE THE FINAL COMPLETION MESSAGE                    @Y30LB11*/ 00270000
*   /*                                                               */ 00271000
*   /*****************************************************************/ 00272000
*                                                                  0280 00273000
*   DARGAREA=''B;                   /*                       @Y30LB11*/ 00274000
@RC00277 DS    0H                                                  0280 00275000
@RF00276 XC    DARGAREA(36),DARGAREA                               0280 00276000
*   DARGSMOD=UNIVMSG;               /*                       @Y30LB11*/ 00277000
         L     @15,DDSTRU                                          0281 00278000
         MVC   DARGSMOD(3,@15),@CC01139                            0281 00279000
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB11*/ 00280000
         L     @14,@PC00001+8                                      0282 00281000
         ST    @14,DARGDBP(,@15)                                   0282 00282000
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB11*/ 00283000
*                                                                  0283 00284000
         MVC   DARGILP(2,@15),@CH00147                             0283 00285000
*   /*****************************************************************/ 00286000
*   /*                                                               */ 00287000
*   /* IF THE FINAL RETURN CODE IS 12 THEN THE MESSAGE: FUNCTION     */ 00288000
*   /* TERMINATED, CONDITION CODE IS (NN), IS WRITTEN.       @Y30LB11*/ 00289000
*   /*                                                               */ 00290000
*   /*****************************************************************/ 00291000
*                                                                  0284 00292000
*   IF LASTCOND=LASTCC12 THEN       /*                       @Y30LB11*/ 00293000
         CLC   LASTCOND(2,@14),@CH00035                            0284 00294000
         BNE   @RF00284                                            0284 00295000
*     DARGSENT=MSG3003I;            /*                       @Y30LB11*/ 00296000
*                                                                  0285 00297000
         MVI   DARGSENT(@15),X'03'                                 0285 00298000
*   /*****************************************************************/ 00299000
*   /*                                                               */ 00300000
*   /* OTHERWISE, THE MESSAGE: FUNCTION COMPLETED, HIGHEST CONDITION */ 00301000
*   /* CODE WAS (NN), IS WRITTEN.                            @Y30LB11*/ 00302000
*   /*                                                               */ 00303000
*   /*****************************************************************/ 00304000
*                                                                  0286 00305000
*   ELSE                            /*                       @Y30LB11*/ 00306000
*     DARGSENT=MSG0001I;            /*                       @Y30LB11*/ 00307000
         B     @RC00284                                            0286 00308000
@RF00284 L     @01,DDSTRU                                          0286 00309000
         MVI   DARGSENT(@01),X'01'                                 0286 00310000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB11*/ 00311000
@RC00284 L     @15,@PC00001                                        0287 00312000
         ST    @15,@AL00001                                        0287 00313000
         LA    @14,@CF00111                                        0287 00314000
         ST    @14,@AL00001+4                                      0287 00315000
         LA    @14,DDSTRU                                          0287 00316000
         ST    @14,@AL00001+8                                      0287 00317000
         MVI   @AL00001+8,X'80'                                    0287 00318000
         L     @15,GDTPRT(,@15)                                    0287 00319000
         LA    @01,@AL00001                                        0287 00320000
         BALR  @14,@15                                             0287 00321000
*                                                                  0288 00322000
*   /*****************************************************************/ 00323000
*   /*                                                               */ 00324000
*   /* FULL REGION DUMP BEFORE EXITING REMOVEVR              @Y30LB11*/ 00325000
*   /*                                                               */ 00326000
*   /*****************************************************************/ 00327000
*                                                                  0288 00328000
*   IF GDTDBG=NULLPTR THEN                                         0288 00329000
         L     @15,@PC00001                                        0288 00330000
         L     @15,GDTDBG(,@15)                                    0288 00331000
         LTR   @15,@15                                             0288 00332000
         BZ    @RT00288                                            0288 00333000
*     ;                                                            0289 00334000
*   ELSE                                                           0290 00335000
*     CALL IDCDB010(GDTTBL,'RRRC'); /*                       @Y30LB11*/ 00336000
*                                                                  0290 00337000
         L     @15,@PC00001                                        0290 00338000
         ST    @15,@AL00001                                        0290 00339000
         LA    @14,@CC01151                                        0290 00340000
         ST    @14,@AL00001+4                                      0290 00341000
         MVI   @AL00001+4,X'80'                                    0290 00342000
         L     @15,GDTDBG(,@15)                                    0290 00343000
         LA    @01,@AL00001                                        0290 00344000
         BALR  @14,@15                                             0290 00345000
*   /*****************************************************************/ 00346000
*   /*                                                               */ 00347000
*   /* RETURN TO AMS EXECUTIVE                               @Y30LB11*/ 00348000
*   /*                                                               */ 00349000
*   /*****************************************************************/ 00350000
*                                                                  0291 00351000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0291 00352000
*                                                                  0291 00353000
@RT00288 L     @15,@PC00001                                        0291 00354000
         ST    @15,@AL00001                                        0291 00355000
         LA    @14,MODID                                           0291 00356000
         ST    @14,@AL00001+4                                      0291 00357000
         L     @14,@PC00001+8                                      0291 00358000
         ST    @14,@AL00001+8                                      0291 00359000
         MVI   @AL00001+8,X'80'                                    0291 00360000
         L     @15,GDTEPL(,@15)                                    0291 00361000
         LA    @01,@AL00001                                        0291 00362000
         BALR  @14,@15                                             0291 00363000
*   /*****************************************************************/ 00364000
*   /*                                                               */ 00365000
*   /*                                                       @Y30LB11*/ 00366000
*   /*                                                               */ 00367000
*   /*****************************************************************/ 00368000
*                                                                  0292 00369000
*                                                                  0292 00370000
*/********************************************************************/ 00371000
*/*                                                          @Y30LB11*/ 00372000
*/* PROCEDURE NAME - ALLPROC                                 @Y30LB11*/ 00373000
*/*                                                          @Y30LB11*/ 00374000
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO REMOVE     @Y30LB11*/ 00375000
*/*            ALL COPIES OF THE VOLUME RECORD.  ONE OF THE  @Y30LB11*/ 00376000
*/*            FOLLOWING MESSAGES IS ISSUED:                 @Y30LB11*/ 00377000
*/*                                                          @Y30LB11*/ 00378000
*/*            IDC0760I RECORD FOR COPY YYDDD REMOVED.       @Y30LB11*/ 00379000
*/*                                                          @Y30LB11*/ 00380000
*/*            IDC3761I ** RECORD FOR COPY YYDDD NOT REMOVED @Y30LB11*/ 00381000
*/*                                                          @Y30LB11*/ 00382000
*/*            IDC2078I ** COPY RECORD FOR VOL (VOLSER)      @Y30LB11*/ 00383000
*/*            CANNOT BE RETRIEVED.                          @Y30LB11*/ 00384000
*/*                                                          @Y30LB11*/ 00385000
*/* INPUT - THE RVVI MAPPING MACRO IS PARTIALLY INITIALIZED  @Y30LB11*/ 00386000
*/*         AND USED AS INPUT TO READ THE COPYV RECORDS  TO  @Y30LB11*/ 00387000
*/*         BE SCRATCHED. THE DEFLIST AND RVR MAPPING MACROS @Y30LB11*/ 00388000
*/*         ARE PARTIALLY INITIALIZED FOR CALLING THE        @Y30LB11*/ 00389000
*/*         REMOVRCD ROUTINE.                                @Y30LB11*/ 00390000
*/*                                                          @Y30LB11*/ 00391000
*/* OUTPUT - RETURN CODE IS RETURNED IN REGISTER 15.         @Y30LB11*/ 00392000
*/*          RMVDFLG IS SET ON IF REMOVRCD IS SUCCESSFUL.    @Y30LB11*/ 00393000
*/*                                                          @Y30LB11*/ 00394000
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/ 00395000
*/*                                                          @Y30LB11*/ 00396000
*/*          4 - ONE OR MORE RECORDS COULD NOT BE REMOVED    @Y30LB11*/ 00397000
*/*                                                          @Y30LB11*/ 00398000
*/********************************************************************/ 00399000
*                                                                  0292 00400000
*ALLPROC:                           /*                       @Y30LB11*/ 00401000
*   PROC;                           /*                       @Y30LB11*/ 00402000
@EL00001 L     @13,4(,@13)                                         0292 00403000
@EF00001 L     @00,@SIZDATD                                        0292 00404000
         LR    @01,@11                                             0292 00405000
         FREEMAIN R,LV=(0),A=(1)                                        00406000
@ER00001 LM    @14,@12,12(@13)                                     0292 00407000
         BR    @14                                                 0292 00408000
ALLPROC  STM   @14,@12,@SA00002                                    0292 00409000
*   DCL                                                            0293 00410000
*     ALLCOND FIXED(15);            /* ALLCOND RETURN CODE   @Y30LB11*/ 00411000
*                                                                  0294 00412000
*   /*****************************************************************/ 00413000
*   /*                                                               */ 00414000
*   /* TRACE AT ENTRY TO ALLPROC PROCEDURE                   @Y30LB11*/ 00415000
*   /*                                                               */ 00416000
*   /*****************************************************************/ 00417000
*                                                                  0294 00418000
*   OLDERID2=NEWERID2;                                             0294 00419000
         L     @15,@PC00001                                        0294 00420000
         L     @14,GDTTR2(,@15)                                    0294 00421000
         MVC   @TS00001(95),NEWERID2(@14)                          0294 00422000
         MVC   OLDERID2(95,@14),@TS00001                           0294 00423000
*   NEWID2='RRAP';                  /*                       @Y30LB11*/ 00424000
*                                                                  0295 00425000
         MVC   NEWID2(4,@14),@CC01157                              0295 00426000
*   /*****************************************************************/ 00427000
*   /*                                                               */ 00428000
*   /* ALLPROC RETURN CODE IS INITIALIZED TO ZERO.           @Y30LB11*/ 00429000
*   /*                                                               */ 00430000
*   /*****************************************************************/ 00431000
*                                                                  0296 00432000
*   ALLCOND=0;                      /*                       @Y30LB11*/ 00433000
*                                                                  0296 00434000
         SLR   @14,@14                                             0296 00435000
         LR    ALLCOND,@14                                         0296 00436000
*   /*****************************************************************/ 00437000
*   /*                                                               */ 00438000
*   /* REASONCD IS ZEROED PRIOR TO ISSUING THE FIRST READ MACRO.     */ 00439000
*   /*                                                               */ 00440000
*   /*****************************************************************/ 00441000
*                                                                  0297 00442000
*   REASONCD=0;                     /*                       @Y30LB11*/ 00443000
*                                                                  0297 00444000
         ST    @14,REASONCD                                        0297 00445000
*   /*****************************************************************/ 00446000
*   /*                                                               */ 00447000
*   /* INITIALIZE RVVI VARIABLES FOR READING ALL COPIES      @Y30LB11*/ 00448000
*   /*                                                               */ 00449000
*   /*****************************************************************/ 00450000
*                                                                  0298 00451000
*   RVVRDR=OFF;                     /*                       @Y30LB11*/ 00452000
         L     @09,RVVIPTR                                         0298 00453000
         NI    RVVRDR(@09),B'01111111'                             0298 00454000
*   RVVBVRCD=OFF;                   /*                       @Y30LB11*/ 00455000
         NI    RVVBVRCD(@09),B'01111111'                           0299 00456000
*   RVVCPYID=0;                     /*                       @Y30LB11*/ 00457000
         MVI   RVVCPYID(@09),X'00'                                 0300 00458000
*   RVVSCPY=ON;                     /*                       @Y30LB11*/ 00459000
         OI    RVVSCPY(@09),B'00000100'                            0301 00460000
*   RVVRDNR=ON;                     /*                       @Y30LB11*/ 00461000
         OI    RVVRDNR(@09),B'01000000'                            0302 00462000
*   RVVCPYRC=ON;                    /*                       @Y30LB11*/ 00463000
         OI    RVVCPYRC(@09),B'00100000'                           0303 00464000
*   RVVBUFLN=LENGTH(COPYAREA);      /*                       @Y30LB11*/ 00465000
         MVC   RVVBUFLN(2,@09),@CH01211                            0304 00466000
*   RVVRTBUF=COPYVPTR;              /*                       @Y30LB11*/ 00467000
*                                                                  0305 00468000
         ST    COPYVPTR,RVVRTBUF(,@09)                             0305 00469000
*   /*****************************************************************/ 00470000
*   /*                                                               */ 00471000
*   /* DUMP OF INITIALIZED PARM LIST FOR MSVC READ MACRO     @Y30LB11*/ 00472000
*   /*                                                               */ 00473000
*   /*****************************************************************/ 00474000
*                                                                  0306 00475000
*   IF GDTDBG=NULLPTR THEN                                         0306 00476000
         C     @14,GDTDBG(,@15)                                    0306 00477000
         BE    @RT00306                                            0306 00478000
*     ;                                                            0307 00479000
*   ELSE                                                           0308 00480000
*     DO;                                                          0308 00481000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB11*/ 00482000
         LA    DMPINDEX,DUMPAREA                                   0309 00483000
*       DMPITMNM='RVVI';                                           0310 00484000
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0310 00485000
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0310 00486000
         MVC   DMPITMNM(4,DMPINDEX),@CC01158                       0310 00487000
*       DMPITMPT=ADDR(RVVI);                                       0311 00488000
         L     @03,RVVIPTR                                         0311 00489000
         ST    @03,DMPITMPT(,DMPINDEX)                             0311 00490000
*       DMPITMLN=LENGTH(RVVI);                                     0312 00491000
         MVC   DMPITMLN(2,DMPINDEX),@CH01212                       0312 00492000
*       DMPITMTP='H';                                              0313 00493000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0313 00494000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0314 00495000
*                                                                  0314 00496000
         AL    DMPINDEX,@CF00464                                   0314 00497000
*       /*************************************************************/ 00498000
*       /*                                                           */ 00499000
*       /*                                                   @Y30LB11*/ 00500000
*       /*                                                           */ 00501000
*       /*************************************************************/ 00502000
*                                                                  0315 00503000
*       DMPTRM=DMPTRMVL;                                           0315 00504000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0315 00505000
*     END;                          /*                       @Y30LB11*/ 00506000
*   IF GDTDBG=NULLPTR THEN                                         0317 00507000
@RT00306 L     @15,@PC00001                                        0317 00508000
         L     @15,GDTDBG(,@15)                                    0317 00509000
         LTR   @15,@15                                             0317 00510000
         BZ    @RT00317                                            0317 00511000
*     ;                                                            0318 00512000
*   ELSE                                                           0319 00513000
*     CALL IDCDB010(GDTTBL,'RRRA',ADDR(DUMPAREA));/*         @Y30LB11*/ 00514000
         L     @15,@PC00001                                        0319 00515000
         ST    @15,@AL00001                                        0319 00516000
         LA    @14,@CC01160                                        0319 00517000
         ST    @14,@AL00001+4                                      0319 00518000
         LA    @14,DUMPAREA                                        0319 00519000
         ST    @14,@AFTEMPS                                        0319 00520000
         LA    @14,@AFTEMPS                                        0319 00521000
         ST    @14,@AL00001+8                                      0319 00522000
         MVI   @AL00001+8,X'80'                                    0319 00523000
         L     @15,GDTDBG(,@15)                                    0319 00524000
         LA    @01,@AL00001                                        0319 00525000
         BALR  @14,@15                                             0319 00526000
*                                                                  0320 00527000
*   /*****************************************************************/ 00528000
*   /*                                                               */ 00529000
*   /* THIS CODE IS EXECUTED REPEATEDLY UNTIL EITHER THE RETURN CODE */ 00530000
*   /* IS SET TO 4 OR UNTIL END OF FILE IS REACHED.          @Y30LB11*/ 00531000
*   /*                                                               */ 00532000
*   /*****************************************************************/ 00533000
*                                                                  0320 00534000
*   DO WHILE ALLCOND^=4&REASONCD^=EOFILE;/*                  @Y30LB11*/ 00535000
*                                                                  0320 00536000
@RT00317 B     @DE00320                                            0320 00537000
@DL00320 DS    0H                                                  0321 00538000
*     /***************************************************************/ 00539000
*     /*                                                             */ 00540000
*     /* ISSUE THE USSC MACRO TO READ THE NEXT COPY RECORD.  @Y30LB11*/ 00541000
*     /*                                                             */ 00542000
*     /***************************************************************/ 00543000
*                                                                  0321 00544000
*     CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*         @Y30LB11*/ 00545000
         L     @02,@PC00001                                        0321 00546000
         ST    @02,@AL00001                                        0321 00547000
         LA    @15,VVIC                                            0321 00548000
         ST    @15,@AL00001+4                                      0321 00549000
         LA    @15,RVVIPTR                                         0321 00550000
         ST    @15,@AL00001+8                                      0321 00551000
         LA    @15,REASONCD                                        0321 00552000
         ST    @15,@AL00001+12                                     0321 00553000
         MVI   @AL00001+12,X'80'                                   0321 00554000
         L     @15,GDTSSC(,@02)                                    0321 00555000
         LA    @01,@AL00001                                        0321 00556000
         BALR  @14,@15                                             0321 00557000
*     RESPECIFY                                                    0322 00558000
*       RTNREG RSTD;                                               0322 00559000
*     TESTRC=RTNREG;                                               0323 00560000
         LR    TESTRC,RTNREG                                       0323 00561000
*     RESPECIFY                                                    0324 00562000
*       RTNREG UNRSTD;              /*                       @Y30LB11*/ 00563000
*                                                                  0324 00564000
*     /***************************************************************/ 00565000
*     /*                                                             */ 00566000
*     /* IF THE COPY RECORD WAS READ SUCCESSFULLY, THE REMOVRCD      */ 00567000
*     /* PROCEDURE IS CALLED TO REMOVE THE COPY RECORD.      @Y30LB11*/ 00568000
*     /*                                                             */ 00569000
*     /***************************************************************/ 00570000
*                                                                  0325 00571000
*     IF TESTRC=0 THEN              /*                       @Y30LB11*/ 00572000
         LTR   TESTRC,TESTRC                                       0325 00573000
         BNZ   @RF00325                                            0325 00574000
*       DO;                         /*                       @Y30LB11*/ 00575000
*                                                                  0326 00576000
*         /***********************************************************/ 00577000
*         /*                                                         */ 00578000
*         /* THE DEFLIST AND RVR PARAMETER LIST ARE INITIALIZED      */ 00579000
*         /* BEFORE CALLING REMOVRCD.                        @Y30LB11*/ 00580000
*         /*                                                         */ 00581000
*         /***********************************************************/ 00582000
*                                                                  0327 00583000
*         DEFVCSN1=COPCSN1;         /*                       @Y30LB11*/ 00584000
         L     @01,DEFLPTR                                         0327 00585000
         MVC   DEFVCSN1(12,@01),COPCSN1(COPYVPTR)                  0327 00586000
*         RVRCOPYV=ON;              /*                       @Y30LB11*/ 00587000
         L     @15,RVRPTR                                          0328 00588000
         OI    RVRCOPYV(@15),B'01000000'                           0328 00589000
*         RVRCPYID=COPNO;           /*                       @Y30LB11*/ 00590000
         MVC   RVRCPYID(1,@15),COPNO(COPYVPTR)                     0329 00591000
*         CALL REMOVRCD;            /*                       @Y30LB11*/ 00592000
         BAL   @14,REMOVRCD                                        0330 00593000
*         RESPECIFY                                                0331 00594000
*           RTNREG RSTD;                                           0331 00595000
*         TESTRC=RTNREG;                                           0332 00596000
         LR    TESTRC,RTNREG                                       0332 00597000
*         RESPECIFY                                                0333 00598000
*           RTNREG UNRSTD;          /*                       @Y30LB11*/ 00599000
*                                                                  0333 00600000
*         /***********************************************************/ 00601000
*         /*                                                         */ 00602000
*         /* IF THE REMOVRCD PROC EXECUTED SUCCESSFULLY THE RMVDFLG  */ 00603000
*         /* IS SET ON INDICATING THAT AT LEAST ONE COPY RECORD WAS  */ 00604000
*         /* REMOVED.                                        @Y30LB11*/ 00605000
*         /*                                                         */ 00606000
*         /***********************************************************/ 00607000
*                                                                  0334 00608000
*         IF TESTRC=0 THEN          /*                       @Y30LB11*/ 00609000
         LTR   TESTRC,TESTRC                                       0334 00610000
         BNZ   @RF00334                                            0334 00611000
*           DO;                     /*                       @Y30LB11*/ 00612000
*             RMVDFLG=ON;           /*                       @Y30LB11*/ 00613000
*                                                                  0336 00614000
         OI    RMVDFLG,B'10000000'                                 0336 00615000
*             /*******************************************************/ 00616000
*             /*                                                     */ 00617000
*             /* SINCE REMOVRCD WAS SUCCESSFUL, THE MESSAGE: **      */ 00618000
*             /* RECORD FOR COPY YYYDDD REMOVED, IS WRITTEN. @Y30LB11*/ 00619000
*             /*                                                     */ 00620000
*             /*******************************************************/ 00621000
*                                                                  0337 00622000
*             DARGAREA=''B;         /*                       @Y30LB11*/ 00623000
         XC    DARGAREA(36),DARGAREA                               0337 00624000
*             DARGSMOD=REMOVRMG;    /*                       @Y30LB11*/ 00625000
         L     @15,DDSTRU                                          0338 00626000
         MVC   DARGSMOD(3,@15),@CC01134                            0338 00627000
*             DARGSENT=MSG0760I;    /*                       @Y30LB11*/ 00628000
         MVI   DARGSENT(@15),X'01'                                 0339 00629000
*             DARGDBP=ADDR(COPDATE);/*                       @Y30LB11*/ 00630000
         LA    @14,COPDATE(,COPYVPTR)                              0340 00631000
         ST    @14,DARGDBP(,@15)                                   0340 00632000
*             DARGILP=LENGTH(COPDATE);/*                     @Y30LB11*/ 00633000
         MVC   DARGILP(2,@15),@CH00041                             0341 00634000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB11*/ 00635000
         L     @15,@PC00001                                        0342 00636000
         ST    @15,@AL00001                                        0342 00637000
         LA    @14,@CF00111                                        0342 00638000
         ST    @14,@AL00001+4                                      0342 00639000
         LA    @14,DDSTRU                                          0342 00640000
         ST    @14,@AL00001+8                                      0342 00641000
         MVI   @AL00001+8,X'80'                                    0342 00642000
         L     @15,GDTPRT(,@15)                                    0342 00643000
         LA    @01,@AL00001                                        0342 00644000
         BALR  @14,@15                                             0342 00645000
*           END;                    /*                       @Y30LB11*/ 00646000
*                                                                  0343 00647000
*         /***********************************************************/ 00648000
*         /*                                                         */ 00649000
*         /* IF THE REMOVE FAILED, THE CONDITION CODE IS SET TO 8 TO */ 00650000
*         /* INDICATE THAT THE REST OF THE COPIES CAN STILL BE       */ 00651000
*         /* SCRATCHED. OTHERWISE, STORAGE IS NOT AVAILABLE TO ISSUE */ 00652000
*         /* FURTHER MSC MACROS, SO SET THE CONDITION CODE TO 4 TO   */ 00653000
*         /* TERMINATE THE LOOP OF SCRATCHING COPIES.        @Y30LB11*/ 00654000
*         /*                                                         */ 00655000
*         /***********************************************************/ 00656000
*                                                                  0344 00657000
*         ELSE                      /*                       @Y30LB11*/ 00658000
*           DO;                     /*                       @Y30LB11*/ 00659000
         B     @RC00334                                            0344 00660000
@RF00334 DS    0H                                                  0345 00661000
*             IF TESTRC=4 THEN      /*                       @Y30LB11*/ 00662000
         C     TESTRC,@CF00041                                     0345 00663000
         BNE   @RF00345                                            0345 00664000
*               ALLCOND=8;          /*                       @Y30LB11*/ 00665000
         LA    ALLCOND,8                                           0346 00666000
*             ELSE                  /*                       @Y30LB11*/ 00667000
*               ALLCOND=4;          /*                       @Y30LB11*/ 00668000
*                                                                  0347 00669000
         B     @RC00345                                            0347 00670000
@RF00345 LA    ALLCOND,4                                           0347 00671000
*             /*******************************************************/ 00672000
*             /*                                                     */ 00673000
*             /* SINCE REMOVRCD WAS UNSUCCESSFUL, THE MESSAGE: **    */ 00674000
*             /* RECORD FOR COPY YYYDDD NOT REMOVED, IS WRITTEN.     */ 00675000
*             /*                                             @Y30LB11*/ 00676000
*             /*                                                     */ 00677000
*             /*******************************************************/ 00678000
*                                                                  0348 00679000
*             DARGAREA=''B;         /*                       @Y30LB11*/ 00680000
@RC00345 XC    DARGAREA(36),DARGAREA                               0348 00681000
*             DARGSMOD=REMOVRMG;    /*                       @Y30LB11*/ 00682000
         L     @15,DDSTRU                                          0349 00683000
         MVC   DARGSMOD(3,@15),@CC01134                            0349 00684000
*             DARGSENT=MSG3761I;    /*                       @Y30LB11*/ 00685000
         MVI   DARGSENT(@15),X'02'                                 0350 00686000
*             DARGDBP=ADDR(COPDATE);/*                       @Y30LB11*/ 00687000
         LA    @14,COPDATE(,COPYVPTR)                              0351 00688000
         ST    @14,DARGDBP(,@15)                                   0351 00689000
*             DARGILP=LENGTH(COPDATE);/*                     @Y30LB11*/ 00690000
         MVC   DARGILP(2,@15),@CH00041                             0352 00691000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB11*/ 00692000
         L     @15,@PC00001                                        0353 00693000
         ST    @15,@AL00001                                        0353 00694000
         LA    @14,@CF00111                                        0353 00695000
         ST    @14,@AL00001+4                                      0353 00696000
         LA    @14,DDSTRU                                          0353 00697000
         ST    @14,@AL00001+8                                      0353 00698000
         MVI   @AL00001+8,X'80'                                    0353 00699000
         L     @15,GDTPRT(,@15)                                    0353 00700000
         LA    @01,@AL00001                                        0353 00701000
         BALR  @14,@15                                             0353 00702000
*           END;                    /*                       @Y30LB11*/ 00703000
*                                                                  0354 00704000
*         /***********************************************************/ 00705000
*         /*                                                         */ 00706000
*         /* THE NEXT COPY ID IS SET FOR THE NEXT READ MACRO @Y30LB11*/ 00707000
*         /* EXECUTION.                                      @Y30LB11*/ 00708000
*         /*                                                         */ 00709000
*         /***********************************************************/ 00710000
*                                                                  0355 00711000
*         RVVCPYID=COPNO;           /*                       @Y30LB11*/ 00712000
@RC00334 L     @01,RVVIPTR                                         0355 00713000
         MVC   RVVCPYID(1,@01),COPNO(COPYVPTR)                     0355 00714000
*       END;                        /*                       @Y30LB11*/ 00715000
*                                                                  0356 00716000
*     /***************************************************************/ 00717000
*     /*                                                             */ 00718000
*     /* IF THE COPY RECORD WAS NOT READ, TEST FOR THE END OF FILE.  */ 00719000
*     /* IF END OF FILE IS NOT REACHED, THE SSCMSG PROCEDURE IS      */ 00720000
*     /* CALLED TO ISSUE AN ERROR MSG CORRESPONDING TO THE REASON    */ 00721000
*     /* CODE. THEN THE MESSAGE: ** COPY RECORD FOR VOLUME (VOLSER)  */ 00722000
*     /* CANNOT BE RETRIEVED, IS WRITTEN.                    @Y30LB11*/ 00723000
*     /*                                                             */ 00724000
*     /***************************************************************/ 00725000
*                                                                  0357 00726000
*     ELSE                          /*                       @Y30LB11*/ 00727000
*       IF REASONCD^=EOFILE THEN    /*                       @Y30LB11*/ 00728000
         B     @RC00325                                            0357 00729000
@RF00325 CLC   REASONCD(4),@CF01115                                0357 00730000
         BE    @RF00357                                            0357 00731000
*         DO;                       /*                       @Y30LB11*/ 00732000
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB11*/ 00733000
         LA    @04,REASONCD                                        0359 00734000
         ST    @04,@AL00001                                        0359 00735000
         LA    @01,@AL00001                                        0359 00736000
         BAL   @14,SSCMSG                                          0359 00737000
*           DARGAREA=''B;           /*                       @Y30LB11*/ 00738000
         XC    DARGAREA(36),DARGAREA                               0360 00739000
*           DARGSMOD=COMMSG;        /*                       @Y30LB11*/ 00740000
         L     @15,DDSTRU                                          0361 00741000
         MVC   DARGSMOD(3,@15),@CC01113                            0361 00742000
*           DARGSENT=MSG2078I;      /*                       @Y30LB11*/ 00743000
         MVI   DARGSENT(@15),X'1C'                                 0362 00744000
*           DARGDBP=ADDR(VOLVAL);   /*                       @Y30LB11*/ 00745000
         L     @14,@PC00001+4                                      0363 00746000
         L     @01,FDTPTR(,@14)                                    0363 00747000
         LA    @14,VOLVAL(,@01)                                    0363 00748000
         ST    @14,DARGDBP(,@15)                                   0363 00749000
*           DARGILP=LENGTH(VOLVAL); /*                       @Y30LB11*/ 00750000
         MVC   DARGILP(2,@15),@CH00150                             0364 00751000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB11*/ 00752000
*                                                                  0365 00753000
         L     @15,@PC00001                                        0365 00754000
         ST    @15,@AL00001                                        0365 00755000
         LA    @14,@CF00111                                        0365 00756000
         ST    @14,@AL00001+4                                      0365 00757000
         LA    @14,DDSTRU                                          0365 00758000
         ST    @14,@AL00001+8                                      0365 00759000
         MVI   @AL00001+8,X'80'                                    0365 00760000
         L     @15,GDTPRT(,@15)                                    0365 00761000
         LA    @01,@AL00001                                        0365 00762000
         BALR  @14,@15                                             0365 00763000
*           /*********************************************************/ 00764000
*           /*                                                       */ 00765000
*           /* SET THE CONDITION CODE TO RCFAIL TO TERMINATE THE LOOP*/ 00766000
*           /* OF SCRATCHING COPIES.                         @Y30LB11*/ 00767000
*           /*                                                       */ 00768000
*           /*********************************************************/ 00769000
*                                                                  0366 00770000
*           ALLCOND=4;              /*                       @Y30LB11*/ 00771000
         LA    ALLCOND,4                                           0366 00772000
*         END;                      /*                       @Y30LB11*/ 00773000
*   END;                            /*                       @Y30LB11*/ 00774000
@RF00357 DS    0H                                                  0368 00775000
@RC00325 DS    0H                                                  0368 00776000
@DE00320 C     ALLCOND,@CF00041                                    0368 00777000
         BE    @DC00320                                            0368 00778000
         CLC   REASONCD(4),@CF01115                                0368 00779000
         BNE   @DL00320                                            0368 00780000
@DC00320 DS    0H                                                  0369 00781000
*                                                                  0369 00782000
*   /*****************************************************************/ 00783000
*   /*                                                               */ 00784000
*   /* FINALLY, IF THE RETURN CODE IS NOT 0 THEN THE FINAL RETURN    */ 00785000
*   /* CODE IS SET TO 4.                                     @Y30LB11*/ 00786000
*   /*                                                               */ 00787000
*   /*****************************************************************/ 00788000
*                                                                  0369 00789000
*   IF ALLCOND^=0 THEN              /*                       @Y30LB11*/ 00790000
         LTR   ALLCOND,ALLCOND                                     0369 00791000
         BZ    @RF00369                                            0369 00792000
*     ALLCOND=4;                    /*                       @Y30LB11*/ 00793000
*                                                                  0370 00794000
         LA    ALLCOND,4                                           0370 00795000
*   /*****************************************************************/ 00796000
*   /*                                                               */ 00797000
*   /* RETURN IS MADE TO BASEALL.                            @Y30LB11*/ 00798000
*   /*                                                               */ 00799000
*   /*****************************************************************/ 00800000
*                                                                  0371 00801000
*   RETURN CODE(ALLCOND);           /*                       @Y30LB11*/ 00802000
@RF00369 LR    @15,ALLCOND                                         0371 00803000
         L     @14,@SA00002                                        0371 00804000
         LM    @00,@12,@SA00002+8                                  0371 00805000
         BR    @14                                                 0371 00806000
*   END ALLPROC;                    /*                       @Y30LB11*/ 00807000
*                                                                  0373 00808000
*/********************************************************************/ 00809000
*/*                                                          @Y30LB11*/ 00810000
*/* PROCEDURE NAME - BASEALL                                 @Y30LB11*/ 00811000
*/*                                                          @Y30LB11*/ 00812000
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO PROCESS    @Y30LB11*/ 00813000
*/*            FUNCTIONS REQUIRED TO SATISFY REQUEST FOR     @Y30LB11*/ 00814000
*/*            REMOVAL OF ALL RECORDS OR BASE RECORD.  THE   @Y30LB11*/ 00815000
*/*            FOLLOWING MESSAGES CAN BE ISSUED:             @Y30LB11*/ 00816000
*/*                                                          @Y30LB11*/ 00817000
*/*            IDC3080I ** RECORD FOR VOL (VOLSER) CANNOT    @Y30LB11*/ 00818000
*/*            BE RETRIEVED FROM INVENTORY.                  @Y30LB11*/ 00819000
*/*                                                          @Y30LB11*/ 00820000
*/*            IDC2765I RECORD FOR VOLUME (VOLSER) NOT       @Y30LB11*/ 00821000
*/*            REMOVED.  RECORD FOR COPY EXISTS.             @Y30LB11*/ 00822000
*/*                                                          @Y30LB11*/ 00823000
*/* INPUT - THE RVVI MAPPING MACRO IS PARTIALLY INITIALIZED  @Y30LB11*/ 00824000
*/*         AND USED AS INPUT TO READ THE BASEV AND/OR COPYV @Y30LB11*/ 00825000
*/*         RECORDS TO BE SCRATCHED.                         @Y30LB11*/ 00826000
*/*                                                          @Y30LB11*/ 00827000
*/* OUTPUT - RETURN CODE IS RETURNED IN REGISTER 15.         @Y30LB11*/ 00828000
*/*                                                          @Y30LB11*/ 00829000
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/ 00830000
*/*                                                          @Y30LB11*/ 00831000
*/*          4 - BASEALL WAS UNSUCCESSFUL: BASE RECORD COULD @Y30LB11*/ 00832000
*/*              NOT BE READ, OR COPY OR BASE RECORD WAS NOT @Y30LB11*/ 00833000
*/*              REMOVED.                                    @Y30LB11*/ 00834000
*/*                                                          @Y30LB11*/ 00835000
*/********************************************************************/ 00836000
*                                                                  0373 00837000
*BASEALL:                           /*                       @Y30LB11*/ 00838000
*   PROC;                           /*                       @Y30LB11*/ 00839000
BASEALL  STM   @14,@12,@SA00003                                    0373 00840000
*   DCL                                                            0374 00841000
*     BASECOND FIXED(15);           /* BASEALL RETURN CODE   @Y30LB11*/ 00842000
*                                                                  0375 00843000
*   /*****************************************************************/ 00844000
*   /*                                                               */ 00845000
*   /* TRACE AT ENTRY TO BASEALL PROCEDURE                   @Y30LB11*/ 00846000
*   /*                                                               */ 00847000
*   /*****************************************************************/ 00848000
*                                                                  0375 00849000
*   OLDERID2=NEWERID2;                                             0375 00850000
         L     @07,@PC00001                                        0375 00851000
         L     @15,GDTTR2(,@07)                                    0375 00852000
         MVC   @TS00001(95),NEWERID2(@15)                          0375 00853000
         MVC   OLDERID2(95,@15),@TS00001                           0375 00854000
*   NEWID2='RRBA';                  /*                       @Y30LB11*/ 00855000
*                                                                  0376 00856000
         MVC   NEWID2(4,@15),@CC01167                              0376 00857000
*   /*****************************************************************/ 00858000
*   /*                                                               */ 00859000
*   /* BASEALL RETURN CODE IS INITIALIZED TO ZERO.           @Y30LB11*/ 00860000
*   /*                                                               */ 00861000
*   /*****************************************************************/ 00862000
*                                                                  0377 00863000
*   BASECOND=0;                     /*                       @Y30LB11*/ 00864000
*                                                                  0377 00865000
         SLR   @15,@15                                             0377 00866000
         LR    BASECOND,@15                                        0377 00867000
*   /*****************************************************************/ 00868000
*   /*                                                               */ 00869000
*   /* INITIALIZE RVVI VARIABLES FOR READING THE BASE RECORD @Y30LB11*/ 00870000
*   /*                                                               */ 00871000
*   /*****************************************************************/ 00872000
*                                                                  0378 00873000
*   RVVRDR=ON;                      /*                       @Y30LB11*/ 00874000
         L     @14,RVVIPTR                                         0378 00875000
         OI    RVVRDR(@14),B'10000000'                             0378 00876000
*   RVVBVRCD=ON;                    /*                       @Y30LB11*/ 00877000
         OI    RVVBVRCD(@14),B'10000000'                           0379 00878000
*   RVVRTBUF=BASEVPTR;              /*                       @Y30LB11*/ 00879000
         ST    BASEVPTR,RVVRTBUF(,@14)                             0380 00880000
*   RVVBUFLN=LENGTH(BASEV);         /*                       @Y30LB11*/ 00881000
*                                                                  0381 00882000
         MVC   RVVBUFLN(2,@14),@CH01213                            0381 00883000
*   /*****************************************************************/ 00884000
*   /*                                                               */ 00885000
*   /* DUMP OF INITIALIZED PARM LIST FOR MSVC READ MACRO     @Y30LB11*/ 00886000
*   /*                                                               */ 00887000
*   /*****************************************************************/ 00888000
*                                                                  0382 00889000
*   IF GDTDBG=NULLPTR THEN                                         0382 00890000
         C     @15,GDTDBG(,@07)                                    0382 00891000
         BE    @RT00382                                            0382 00892000
*     ;                                                            0383 00893000
*   ELSE                                                           0384 00894000
*     DO;                                                          0384 00895000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB11*/ 00896000
         LA    DMPINDEX,DUMPAREA                                   0385 00897000
*       DMPITMNM='RVVI';                                           0386 00898000
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0386 00899000
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0386 00900000
         MVC   DMPITMNM(4,DMPINDEX),@CC01158                       0386 00901000
*       DMPITMPT=ADDR(RVVI);                                       0387 00902000
         L     @07,RVVIPTR                                         0387 00903000
         ST    @07,DMPITMPT(,DMPINDEX)                             0387 00904000
*       DMPITMLN=LENGTH(RVVI);                                     0388 00905000
         MVC   DMPITMLN(2,DMPINDEX),@CH01212                       0388 00906000
*       DMPITMTP='H';                                              0389 00907000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0389 00908000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0390 00909000
*                                                                  0390 00910000
         AL    DMPINDEX,@CF00464                                   0390 00911000
*       /*************************************************************/ 00912000
*       /*                                                           */ 00913000
*       /*                                                   @Y30LB11*/ 00914000
*       /*                                                           */ 00915000
*       /*************************************************************/ 00916000
*                                                                  0391 00917000
*       DMPTRM=DMPTRMVL;                                           0391 00918000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0391 00919000
*     END;                          /*                       @Y30LB11*/ 00920000
*   IF GDTDBG=NULLPTR THEN                                         0393 00921000
@RT00382 L     @07,@PC00001                                        0393 00922000
         L     @07,GDTDBG(,@07)                                    0393 00923000
         LTR   @07,@07                                             0393 00924000
         BZ    @RT00393                                            0393 00925000
*     ;                                                            0394 00926000
*   ELSE                                                           0395 00927000
*     CALL IDCDB010(GDTTBL,'RRRB',ADDR(DUMPAREA));/*         @Y30LB11*/ 00928000
*                                                                  0395 00929000
         L     @07,@PC00001                                        0395 00930000
         ST    @07,@AL00001                                        0395 00931000
         LA    @15,@CC01168                                        0395 00932000
         ST    @15,@AL00001+4                                      0395 00933000
         LA    @15,DUMPAREA                                        0395 00934000
         ST    @15,@AFTEMPS+4                                      0395 00935000
         LA    @15,@AFTEMPS+4                                      0395 00936000
         ST    @15,@AL00001+8                                      0395 00937000
         MVI   @AL00001+8,X'80'                                    0395 00938000
         L     @15,GDTDBG(,@07)                                    0395 00939000
         LA    @01,@AL00001                                        0395 00940000
         BALR  @14,@15                                             0395 00941000
*   /*****************************************************************/ 00942000
*   /*                                                               */ 00943000
*   /* ISSUE THE USSC MACRO TO READ THE BASE VOLUME RECORD.  @Y30LB11*/ 00944000
*   /*                                                               */ 00945000
*   /*****************************************************************/ 00946000
*                                                                  0396 00947000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*           @Y30LB11*/ 00948000
@RT00393 L     @07,@PC00001                                        0396 00949000
         ST    @07,@AL00001                                        0396 00950000
         LA    @02,VVIC                                            0396 00951000
         ST    @02,@AL00001+4                                      0396 00952000
         LA    @02,RVVIPTR                                         0396 00953000
         ST    @02,@AL00001+8                                      0396 00954000
         LA    @02,REASONCD                                        0396 00955000
         ST    @02,@AL00001+12                                     0396 00956000
         MVI   @AL00001+12,X'80'                                   0396 00957000
         L     @15,GDTSSC(,@07)                                    0396 00958000
         LA    @01,@AL00001                                        0396 00959000
         BALR  @14,@15                                             0396 00960000
*   RESPECIFY                                                      0397 00961000
*     RTNREG RSTD;                                                 0397 00962000
*   TESTRC=RTNREG;                                                 0398 00963000
         LR    TESTRC,RTNREG                                       0398 00964000
*   RESPECIFY                                                      0399 00965000
*     RTNREG UNRSTD;                /*                       @Y30LB11*/ 00966000
*                                                                  0399 00967000
*   /*****************************************************************/ 00968000
*   /*                                                               */ 00969000
*   /* IF THE BASE RECORD WAS READ SUCCESSFULLY, THE 'ALL' PARAMETER */ 00970000
*   /* IS CHECKED TO DETERMINE WHETHER THE ALLPROC ROUTINE SHOULD BE */ 00971000
*   /* CALLED TO REMOVE ALL COPY RECORDS BEFORE REMOVING THE BASE    */ 00972000
*   /* VOLUME RECORD.                                        @Y30LB11*/ 00973000
*   /*                                                               */ 00974000
*   /*****************************************************************/ 00975000
*                                                                  0400 00976000
*   IF TESTRC=0 THEN                /*                       @Y30LB11*/ 00977000
         SLR   @07,@07                                             0400 00978000
         CR    TESTRC,@07                                          0400 00979000
         BNE   @RF00400                                            0400 00980000
*     DO;                           /*                       @Y30LB11*/ 00981000
*       IF ADDR(ALLC)^=NULLPTR THEN /*                       @Y30LB11*/ 00982000
         L     @02,@PC00001+4                                      0402 00983000
         C     @07,FDTPTR+4(,@02)                                  0402 00984000
         BE    @RF00402                                            0402 00985000
*         DO;                       /*                       @Y30LB11*/ 00986000
*           CALL ALLPROC;           /*                       @Y30LB11*/ 00987000
         BAL   @14,ALLPROC                                         0404 00988000
*           RESPECIFY                                              0405 00989000
*             RTNREG RSTD;                                         0405 00990000
*           TESTRC=RTNREG;                                         0406 00991000
         LR    TESTRC,RTNREG                                       0406 00992000
*           RESPECIFY                                              0407 00993000
*             RTNREG UNRSTD;        /*                       @Y30LB11*/ 00994000
*         END;                      /*                       @Y30LB11*/ 00995000
*                                                                  0408 00996000
*       /*************************************************************/ 00997000
*       /*                                                           */ 00998000
*       /* IF ALLPROC WAS SUCCESSFUL OR NOT CALLED, INVOKE BASEPROC  */ 00999000
*       /* TO REMOVE THE BASE RECORD.                        @Y30LB11*/ 01000000
*       /*                                                           */ 01001000
*       /*************************************************************/ 01002000
*                                                                  0409 01003000
*       IF TESTRC=0 THEN            /*                       @Y30LB11*/ 01004000
@RF00402 LTR   TESTRC,TESTRC                                       0409 01005000
         BNZ   @RF00409                                            0409 01006000
*         DO;                       /*                       @Y30LB11*/ 01007000
*           CALL BASEPROC;          /*                       @Y30LB11*/ 01008000
         BAL   @14,BASEPROC                                        0411 01009000
*           RESPECIFY                                              0412 01010000
*             RTNREG RSTD;                                         0412 01011000
*           TESTRC=RTNREG;                                         0413 01012000
         LR    TESTRC,RTNREG                                       0413 01013000
*           RESPECIFY                                              0414 01014000
*             RTNREG UNRSTD;        /*                       @Y30LB11*/ 01015000
*                                                                  0414 01016000
*           /*********************************************************/ 01017000
*           /*                                                       */ 01018000
*           /* IF BASEPROC WAS UNSUCCESSFUL, THE RETURN CODE IS SET  */ 01019000
*           /* TO 4.                                         @Y30LB11*/ 01020000
*           /*                                                       */ 01021000
*           /*********************************************************/ 01022000
*                                                                  0415 01023000
*           IF TESTRC=4 THEN        /*                       @Y30LB11*/ 01024000
         LA    @05,4                                               0415 01025000
         CR    TESTRC,@05                                          0415 01026000
         BNE   @RF00415                                            0415 01027000
*             BASECOND=4;           /*                       @Y30LB11*/ 01028000
         LR    BASECOND,@05                                        0416 01029000
*         END;                      /*                       @Y30LB11*/ 01030000
*                                                                  0417 01031000
*       /*************************************************************/ 01032000
*       /*                                                           */ 01033000
*       /* IF ALLPROC WAS UNSUCCESSFUL, THE RETURN CODE IS SET TO 4  */ 01034000
*       /* AND THE MESSAGE: RECORD FOR VOLUME (VOLSER) NOT REMOVED.  */ 01035000
*       /* RECORD FOR COPY EXISTS, IS WRITTEN                @Y30LB11*/ 01036000
*       /*                                                           */ 01037000
*       /*************************************************************/ 01038000
*                                                                  0418 01039000
*       ELSE                        /*                       @Y30LB11*/ 01040000
*         DO;                       /*                       @Y30LB11*/ 01041000
         B     @RC00409                                            0418 01042000
@RF00409 DS    0H                                                  0419 01043000
*           BASECOND=4;             /*                       @Y30LB11*/ 01044000
         LA    BASECOND,4                                          0419 01045000
*           DARGAREA=''B;           /*                       @Y30LB11*/ 01046000
         XC    DARGAREA(36),DARGAREA                               0420 01047000
*           DARGSMOD=REMOVRMG;      /*                       @Y30LB11*/ 01048000
         L     @05,DDSTRU                                          0421 01049000
         MVC   DARGSMOD(3,@05),@CC01134                            0421 01050000
*           DARGSENT=MSG2765I;      /*                       @Y30LB11*/ 01051000
         MVI   DARGSENT(@05),X'06'                                 0422 01052000
*           DARGDBP=ADDR(VOLVAL);   /*                       @Y30LB11*/ 01053000
         L     @15,@PC00001+4                                      0423 01054000
         L     @01,FDTPTR(,@15)                                    0423 01055000
         LA    @15,VOLVAL(,@01)                                    0423 01056000
         ST    @15,DARGDBP(,@05)                                   0423 01057000
*           DARGILP=LENGTH(VOLVAL); /*                       @Y30LB11*/ 01058000
         MVC   DARGILP(2,@05),@CH00150                             0424 01059000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB11*/ 01060000
         L     @05,@PC00001                                        0425 01061000
         ST    @05,@AL00001                                        0425 01062000
         LA    @15,@CF00111                                        0425 01063000
         ST    @15,@AL00001+4                                      0425 01064000
         LA    @15,DDSTRU                                          0425 01065000
         ST    @15,@AL00001+8                                      0425 01066000
         MVI   @AL00001+8,X'80'                                    0425 01067000
         L     @15,GDTPRT(,@05)                                    0425 01068000
         LA    @01,@AL00001                                        0425 01069000
         BALR  @14,@15                                             0425 01070000
*         END;                      /*                       @Y30LB11*/ 01071000
*     END;                          /*                       @Y30LB11*/ 01072000
*                                                                  0427 01073000
*   /*****************************************************************/ 01074000
*   /*                                                               */ 01075000
*   /* IF THE MSVC READ WAS UNSUCCESSFUL, THE RETURN CODE IS SET TO  */ 01076000
*   /* 4, AND THE MESSAGE: ** RECORD FOR VOL (VOLSER) CANNOT BE      */ 01077000
*   /* RETRIEVED FROM INVENTORY, IS WRITTEN.                 @Y30LB11*/ 01078000
*   /*                                                               */ 01079000
*   /*****************************************************************/ 01080000
*                                                                  0428 01081000
*   ELSE                            /*                       @Y30LB11*/ 01082000
*     DO;                           /*                       @Y30LB11*/ 01083000
         B     @RC00400                                            0428 01084000
@RF00400 DS    0H                                                  0429 01085000
*       BASECOND=4;                 /*                       @Y30LB11*/ 01086000
*                                                                  0429 01087000
         LA    BASECOND,4                                          0429 01088000
*       /*************************************************************/ 01089000
*       /*                                                           */ 01090000
*       /* FIRST, SSCMSG IS CALLED TO PRINT A MESSAGE CORRESPONDING  */ 01091000
*       /* TO THE REASON CODE.                               @Y30LB11*/ 01092000
*       /*                                                           */ 01093000
*       /*************************************************************/ 01094000
*                                                                  0430 01095000
*       CALL SSCMSG(REASONCD);      /*                       @Y30LB11*/ 01096000
         LA    @05,REASONCD                                        0430 01097000
         ST    @05,@AL00001                                        0430 01098000
         LA    @01,@AL00001                                        0430 01099000
         BAL   @14,SSCMSG                                          0430 01100000
*       DARGAREA=''B;               /*                       @Y30LB11*/ 01101000
         XC    DARGAREA(36),DARGAREA                               0431 01102000
*       DARGSMOD=COMMSG;            /*                       @Y30LB11*/ 01103000
         L     @05,DDSTRU                                          0432 01104000
         MVC   DARGSMOD(3,@05),@CC01113                            0432 01105000
*       DARGSENT=MSG3080I;          /*                       @Y30LB11*/ 01106000
         MVI   DARGSENT(@05),X'1A'                                 0433 01107000
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB11*/ 01108000
         L     @15,@PC00001+4                                      0434 01109000
         L     @01,FDTPTR(,@15)                                    0434 01110000
         LA    @15,VOLVAL(,@01)                                    0434 01111000
         ST    @15,DARGDBP(,@05)                                   0434 01112000
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB11*/ 01113000
         MVC   DARGILP(2,@05),@CH00150                             0435 01114000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB11*/ 01115000
         L     @05,@PC00001                                        0436 01116000
         ST    @05,@AL00001                                        0436 01117000
         LA    @15,@CF00111                                        0436 01118000
         ST    @15,@AL00001+4                                      0436 01119000
         LA    @15,DDSTRU                                          0436 01120000
         ST    @15,@AL00001+8                                      0436 01121000
         MVI   @AL00001+8,X'80'                                    0436 01122000
         L     @15,GDTPRT(,@05)                                    0436 01123000
         LA    @01,@AL00001                                        0436 01124000
         BALR  @14,@15                                             0436 01125000
*     END;                          /*                       @Y30LB11*/ 01126000
*                                                                  0437 01127000
*   /*****************************************************************/ 01128000
*   /*                                                               */ 01129000
*   /* RETURN IS MADE TO IDCRR01.                            @Y30LB11*/ 01130000
*   /*                                                               */ 01131000
*   /*****************************************************************/ 01132000
*                                                                  0438 01133000
*   RETURN CODE(BASECOND);          /*                       @Y30LB11*/ 01134000
@RC00400 LR    @15,BASECOND                                        0438 01135000
         L     @14,@SA00003                                        0438 01136000
         LM    @00,@12,@SA00003+8                                  0438 01137000
         BR    @14                                                 0438 01138000
*   END BASEALL;                    /*                       @Y30LB11*/ 01139000
*                                                                  0440 01140000
*/********************************************************************/ 01141000
*/*                                                          @Y30LB11*/ 01142000
*/* PROCEDURE NAME - BASEPROC                                @Y30LB11*/ 01143000
*/*                                                          @Y30LB11*/ 01144000
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO REMOVE     @Y30LB11*/ 01145000
*/*            THE BASE VOLUME RECORD FROM THE INVENTORY.    @Y30LB11*/ 01146000
*/*            ONE OF THE FOLLOWING MESSAGES IS ISSUED:      @Y30LB11*/ 01147000
*/*                                                          @Y30LB11*/ 01148000
*/*            IDC3762I ** RECORD FOR VOL (VOLSER) NOT       @Y30LB11*/ 01149000
*/*            REMOVED.                                      @Y30LB11*/ 01150000
*/*                                                          @Y30LB11*/ 01151000
*/*            IDC0763I RECORD FOR VOLUME (VOLSER) REMOVED.  @Y30LB11*/ 01152000
*/*                                                          @Y30LB11*/ 01153000
*/* INPUT - THE BASE VOLUME RECORD MUST HAVE BEEN READ       @Y30LB11*/ 01154000
*/*         BEFORE BASEPROC IS CALLED.  THE DEFLIST IS       @Y30LB11*/ 01155000
*/*         PARTIALLY INITIALIZED.                           @Y30LB11*/ 01156000
*/*                                                          @Y30LB11*/ 01157000
*/* OUTPUT - RETURN CODE IS RETURNED IN REGISTER 15.         @Y30LB11*/ 01158000
*/*                                                          @Y30LB11*/ 01159000
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/ 01160000
*/*                                                          @Y30LB11*/ 01161000
*/*          4 - FUNCTION WAS UNSUCCESSFUL: VOLUME STILL IN  @Y30LB11*/ 01162000
*/*              MSF OR MSC FAILURE OCCURRED.                @Y30LB11*/ 01163000
*/*                                                          @Y30LB11*/ 01164000
*/********************************************************************/ 01165000
*                                                                  0440 01166000
*BASEPROC:                          /*                       @Y30LB11*/ 01167000
*   PROC;                           /*                       @Y30LB11*/ 01168000
BASEPROC STM   @14,@12,@SA00004                                    0440 01169000
*   DCL                                                            0441 01170000
*     BPROCOND FIXED(15);           /* BASEPROC RETURN CODE  @Y30LB11*/ 01171000
*                                                                  0442 01172000
*   /*****************************************************************/ 01173000
*   /*                                                               */ 01174000
*   /* TRACE AT ENTRY TO BASEPROC PROCEDURE                  @Y30LB11*/ 01175000
*   /*                                                               */ 01176000
*   /*****************************************************************/ 01177000
*                                                                  0442 01178000
*   OLDERID2=NEWERID2;                                             0442 01179000
         L     @07,@PC00001                                        0442 01180000
         L     @05,GDTTR2(,@07)                                    0442 01181000
         MVC   @TS00001(95),NEWERID2(@05)                          0442 01182000
         MVC   OLDERID2(95,@05),@TS00001                           0442 01183000
*   NEWID2='RRBP';                  /*                       @Y30LB11*/ 01184000
*                                                                  0443 01185000
         MVC   NEWID2(4,@05),@CC01174                              0443 01186000
*   /*****************************************************************/ 01187000
*   /*                                                               */ 01188000
*   /* BASEPROC RETURN CODE IS INITIALIZED TO ZERO.          @Y30LB11*/ 01189000
*   /*                                                               */ 01190000
*   /*****************************************************************/ 01191000
*                                                                  0444 01192000
*   BPROCOND=0;                     /*                       @Y30LB11*/ 01193000
*                                                                  0444 01194000
         SLR   @15,@15                                             0444 01195000
         LR    BPROCOND,@15                                        0444 01196000
*   /*****************************************************************/ 01197000
*   /*                                                               */ 01198000
*   /* INITIALIZE RVR PARAMETER LIST TO REMOVE A BASE VOLUME RECORD. */ 01199000
*   /*                                                               */ 01200000
*   /*****************************************************************/ 01201000
*                                                                  0445 01202000
*   RVRCOPYV=OFF;                   /*                       @Y30LB11*/ 01203000
*   RVRBASEV=ON;                    /*                       @Y30LB11*/ 01204000
         L     @05,RVRPTR                                          0446 01205000
         OI    RVRBASEV(@05),B'10000000'                           0446 01206000
         NI    RVRCOPYV(@05),B'10111111'                           0446 01207000
*                                                                  0447 01208000
*   /*****************************************************************/ 01209000
*   /*                                                               */ 01210000
*   /* A CHECK IS MADE TO DETERMINE WHETHER THE CARTRIDGES HAVE BEEN */ 01211000
*   /* REASSIGNED TO ANOTHER VOLUME. IF THEY HAVE, THE USSC UMACRO IS*/ 01212000
*   /* ISSUED TO INVOKE THE ICBVVIC MACRO TO REMOVE THE BASE VOLUME  */ 01213000
*   /* RECORD. THE CHECK IN REMOVRCD PROCEDURE TO TEST WHETHER THE   */ 01214000
*   /* CARTRIDGES ARE IN THE MSF IS BYPASSED.                @Y30LB11*/ 01215000
*   /*                                                               */ 01216000
*   /*****************************************************************/ 01217000
*                                                                  0447 01218000
*   IF BASREASS=ON THEN             /*                       @Y30LB11*/ 01219000
         TM    BASREASS(BASEVPTR),B'00100000'                      0447 01220000
         BNO   @RF00447                                            0447 01221000
*     DO;                           /*                       @Y30LB11*/ 01222000
*                                                                  0448 01223000
*       /*************************************************************/ 01224000
*       /*                                                           */ 01225000
*       /* DUMP OF INITIALIZED PARM LIST FOR MSVC REMOVE MACRO       */ 01226000
*       /*                                                   @Y30LB11*/ 01227000
*       /*                                                           */ 01228000
*       /*************************************************************/ 01229000
*                                                                  0449 01230000
*       IF GDTDBG=NULLPTR THEN                                     0449 01231000
         C     @15,GDTDBG(,@07)                                    0449 01232000
         BE    @RT00449                                            0449 01233000
*         ;                                                        0450 01234000
*       ELSE                                                       0451 01235000
*         DO;                                                      0451 01236000
*           DMPINDEX=ADDR(DUMPAREA);/*                       @Y30LB11*/ 01237000
         LA    DMPINDEX,DUMPAREA                                   0452 01238000
*           DMPITMNM='RVVI';                                       0453 01239000
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0453 01240000
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0453 01241000
         MVC   DMPITMNM(4,DMPINDEX),@CC01158                       0453 01242000
*           DMPITMPT=ADDR(RVVI);                                   0454 01243000
         L     @05,RVVIPTR                                         0454 01244000
         ST    @05,DMPITMPT(,DMPINDEX)                             0454 01245000
*           DMPITMLN=LENGTH(RVVI);                                 0455 01246000
         MVC   DMPITMLN(2,DMPINDEX),@CH01212                       0455 01247000
*           DMPITMTP='H';                                          0456 01248000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0456 01249000
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0457 01250000
*                                                                  0457 01251000
         AL    DMPINDEX,@CF00464                                   0457 01252000
*           /*********************************************************/ 01253000
*           /*                                                       */ 01254000
*           /*                                               @Y30LB11*/ 01255000
*           /*                                                       */ 01256000
*           /*********************************************************/ 01257000
*                                                                  0458 01258000
*           DMPTRM=DMPTRMVL;                                       0458 01259000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0458 01260000
*         END;                      /*                       @Y30LB11*/ 01261000
*       IF GDTDBG=NULLPTR THEN                                     0460 01262000
@RT00449 L     @05,@PC00001                                        0460 01263000
         L     @05,GDTDBG(,@05)                                    0460 01264000
         LTR   @05,@05                                             0460 01265000
         BZ    @RT00460                                            0460 01266000
*         ;                                                        0461 01267000
*       ELSE                                                       0462 01268000
*         CALL IDCDB010(GDTTBL,'RRRV',ADDR(DUMPAREA));/*     @Y30LB11*/ 01269000
*                                                                  0462 01270000
         L     @05,@PC00001                                        0462 01271000
         ST    @05,@AL00001                                        0462 01272000
         LA    @15,@CC01175                                        0462 01273000
         ST    @15,@AL00001+4                                      0462 01274000
         LA    @15,DUMPAREA                                        0462 01275000
         ST    @15,@AFTEMPS+8                                      0462 01276000
         LA    @15,@AFTEMPS+8                                      0462 01277000
         ST    @15,@AL00001+8                                      0462 01278000
         MVI   @AL00001+8,X'80'                                    0462 01279000
         L     @15,GDTDBG(,@05)                                    0462 01280000
         LA    @01,@AL00001                                        0462 01281000
         BALR  @14,@15                                             0462 01282000
*       /*************************************************************/ 01283000
*       /*                                                           */ 01284000
*       /* THE USSC UMACRO IS EXECUTED TO REMOVE THE BASE VOLUME     */ 01285000
*       /* RECORD FROM THE INVENTORY. IF THE UMACRO WAS UNSUCCESSFUL */ 01286000
*       /* THE REASON CODE IS PASSED TO SSCMSG TO PRINT A MESSAGE    */ 01287000
*       /* CORRESPONDING TO THAT REASON CODE.                @Y30LB11*/ 01288000
*       /*                                                           */ 01289000
*       /*************************************************************/ 01290000
*                                                                  0463 01291000
*       CALL IDCSASS0(GDTTBL,VVIC,RVRPTR,REASONCD);/*        @Y30LB11*/ 01292000
@RT00460 L     @05,@PC00001                                        0463 01293000
         ST    @05,@AL00001                                        0463 01294000
         LA    @02,VVIC                                            0463 01295000
         ST    @02,@AL00001+4                                      0463 01296000
         LA    @02,RVRPTR                                          0463 01297000
         ST    @02,@AL00001+8                                      0463 01298000
         LA    @02,REASONCD                                        0463 01299000
         ST    @02,@AL00001+12                                     0463 01300000
         MVI   @AL00001+12,X'80'                                   0463 01301000
         L     @15,GDTSSC(,@05)                                    0463 01302000
         LA    @01,@AL00001                                        0463 01303000
         BALR  @14,@15                                             0463 01304000
*       RESPECIFY                                                  0464 01305000
*         RTNREG RSTD;                                             0464 01306000
*       TESTRC=RTNREG;                                             0465 01307000
         LR    TESTRC,RTNREG                                       0465 01308000
*       RESPECIFY                                                  0466 01309000
*         RTNREG UNRSTD;            /*                       @Y30LB11*/ 01310000
*                                                                  0466 01311000
*       /*************************************************************/ 01312000
*       /*                                                           */ 01313000
*       /* THE DARGLIST IS INITIALIZED FOR BASEPROC          @Y30LB11*/ 01314000
*       /*                                                           */ 01315000
*       /*************************************************************/ 01316000
*                                                                  0467 01317000
*       DARGAREA=''B;               /*                       @Y30LB11*/ 01318000
         XC    DARGAREA(36),DARGAREA                               0467 01319000
*       DARGSMOD=REMOVRMG;          /*                       @Y30LB11*/ 01320000
         L     @05,DDSTRU                                          0468 01321000
         MVC   DARGSMOD(3,@05),@CC01134                            0468 01322000
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB11*/ 01323000
         L     @02,@PC00001+4                                      0469 01324000
         L     @02,FDTPTR(,@02)                                    0469 01325000
         LA    @02,VOLVAL(,@02)                                    0469 01326000
         ST    @02,DARGDBP(,@05)                                   0469 01327000
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB11*/ 01328000
*                                                                  0470 01329000
         MVC   DARGILP(2,@05),@CH00150                             0470 01330000
*       /*************************************************************/ 01331000
*       /*                                                           */ 01332000
*       /* IF AN I/0 ERROR OCCURRED WHILE UPDATING THE INVENTORY, SET*/ 01333000
*       /* THE WARNING FLAG ON.                              @ZA00670*/ 01334000
*       /*                                                           */ 01335000
*       /*************************************************************/ 01336000
*                                                                  0471 01337000
*       IF TESTRC=12 THEN                                          0471 01338000
         C     TESTRC,@CF00035                                     0471 01339000
         BNE   @RF00471                                            0471 01340000
*         WARNFLG=ON;               /*                       @ZA00670*/ 01341000
*                                                                  0472 01342000
         OI    WARNFLG,B'10000000'                                 0472 01343000
*       /*************************************************************/ 01344000
*       /*                                                           */ 01345000
*       /* IF THE MACRO WAS EXECUTED SUCCESSFULLY, THE MESSAGE:      */ 01346000
*       /* RECORD FOR VOLUME (VOLSER) REMOVED, IS PRINTED.   @Y30LB11*/ 01347000
*       /*                                                           */ 01348000
*       /*************************************************************/ 01349000
*                                                                  0473 01350000
*       IF TESTRC=0|TESTRC=12 THEN                                 0473 01351000
@RF00471 LTR   TESTRC,TESTRC                                       0473 01352000
         BZ    @RT00473                                            0473 01353000
         C     TESTRC,@CF00035                                     0473 01354000
         BNE   @RF00473                                            0473 01355000
@RT00473 DS    0H                                                  0474 01356000
*         DARGSENT=MSG0763I;        /*                       @Y30LB11*/ 01357000
*                                                                  0474 01358000
         L     @05,DDSTRU                                          0474 01359000
         MVI   DARGSENT(@05),X'04'                                 0474 01360000
*       /*************************************************************/ 01361000
*       /*                                                           */ 01362000
*       /* IF THE MACRO WAS NOT SUCCESSFUL, SSCMSG IS CALLED TO ISSUE*/ 01363000
*       /* THE MESSAGE: ** RECORD FOR VOLUME (VOLSER) REMOVED, AND   */ 01364000
*       /* THE RETURN CODE IS SET TO 4.                      @Y30LB11*/ 01365000
*       /*                                                           */ 01366000
*       /*************************************************************/ 01367000
*                                                                  0475 01368000
*       ELSE                        /*                       @Y30LB11*/ 01369000
*         DO;                       /*                       @Y30LB11*/ 01370000
         B     @RC00473                                            0475 01371000
@RF00473 DS    0H                                                  0476 01372000
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB11*/ 01373000
         LA    @15,REASONCD                                        0476 01374000
         ST    @15,@AL00001                                        0476 01375000
         LA    @01,@AL00001                                        0476 01376000
         BAL   @14,SSCMSG                                          0476 01377000
*           DARGSENT=MSG3762I;      /*                       @Y30LB11*/ 01378000
         L     @05,DDSTRU                                          0477 01379000
         MVI   DARGSENT(@05),X'03'                                 0477 01380000
*           BPROCOND=4;             /*                       @Y30LB11*/ 01381000
         LA    BPROCOND,4                                          0478 01382000
*         END;                      /*                       @Y30LB11*/ 01383000
*     END;                          /*                       @Y30LB11*/ 01384000
*                                                                  0481 01385000
*   /*****************************************************************/ 01386000
*   /*                                                               */ 01387000
*   /* IF NO CARTRIDGES WERE REASSIGNED TO ANOTHER VOLUME, THE       */ 01388000
*   /* DEFLIST IS INITIALIZED AND A CALL TO REMOVRCD IS MADE TO CHECK*/ 01389000
*   /* THAT THE CARTRIDGES ARE NOT IN THE LIBRARY AND REMOVE A VOLUME*/ 01390000
*   /* RECORD.                                               @Y30LB11*/ 01391000
*   /*                                                               */ 01392000
*   /*****************************************************************/ 01393000
*                                                                  0481 01394000
*   ELSE                            /*                       @Y30LB11*/ 01395000
*     DO;                           /*                       @Y30LB11*/ 01396000
         B     @RC00447                                            0481 01397000
@RF00447 DS    0H                                                  0482 01398000
*       DEFVCSN1=BASCSN1;           /*                       @Y30LB11*/ 01399000
         L     @07,DEFLPTR                                         0482 01400000
         MVC   DEFVCSN1(12,@07),BASCSN1(BASEVPTR)                  0482 01401000
*       CALL REMOVRCD;              /*                       @Y30LB11*/ 01402000
         BAL   @14,REMOVRCD                                        0483 01403000
*       RESPECIFY                                                  0484 01404000
*         RTNREG RSTD;                                             0484 01405000
*       TESTRC=RTNREG;                                             0485 01406000
         LR    TESTRC,RTNREG                                       0485 01407000
*       RESPECIFY                                                  0486 01408000
*         RTNREG UNRSTD;            /*                       @Y30LB11*/ 01409000
*                                                                  0486 01410000
*       /*************************************************************/ 01411000
*       /*                                                           */ 01412000
*       /* THE DARGLIST IS INITIALIZED FOR BASEPROC          @Y30LB11*/ 01413000
*       /*                                                           */ 01414000
*       /*************************************************************/ 01415000
*                                                                  0487 01416000
*       DARGAREA=''B;               /*                       @Y30LB11*/ 01417000
         XC    DARGAREA(36),DARGAREA                               0487 01418000
*       DARGSMOD=REMOVRMG;          /*                       @Y30LB11*/ 01419000
         L     @05,DDSTRU                                          0488 01420000
         MVC   DARGSMOD(3,@05),@CC01134                            0488 01421000
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB11*/ 01422000
         L     @02,@PC00001+4                                      0489 01423000
         L     @02,FDTPTR(,@02)                                    0489 01424000
         LA    @02,VOLVAL(,@02)                                    0489 01425000
         ST    @02,DARGDBP(,@05)                                   0489 01426000
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB11*/ 01427000
*                                                                  0490 01428000
         MVC   DARGILP(2,@05),@CH00150                             0490 01429000
*       /*************************************************************/ 01430000
*       /*                                                           */ 01431000
*       /* IF REMOVRCD WAS SUCCESSFUL, THE MESSAGE: RECORD FOR VOLUME*/ 01432000
*       /* (VOLSER) REMOVED, IS PRINTED.                     @Y30LB11*/ 01433000
*       /*                                                           */ 01434000
*       /*************************************************************/ 01435000
*                                                                  0491 01436000
*       IF TESTRC=0 THEN            /*                       @Y30LB11*/ 01437000
         LTR   TESTRC,TESTRC                                       0491 01438000
         BNZ   @RF00491                                            0491 01439000
*         DARGSENT=MSG0763I;        /*                       @Y30LB11*/ 01440000
         MVI   DARGSENT(@05),X'04'                                 0492 01441000
*       ELSE                        /*                       @Y30LB11*/ 01442000
*         DO;                       /*                       @Y30LB11*/ 01443000
*                                                                  0493 01444000
         B     @RC00491                                            0493 01445000
@RF00491 DS    0H                                                  0494 01446000
*           /*********************************************************/ 01447000
*           /*                                                       */ 01448000
*           /* IF REMOVRCD FAILS, THE MESSAGE: RECORD FOR VOLUME     */ 01449000
*           /* (VOLSER) NOT REMOVED, IS WRITTEN AND THE RETURN CODE  */ 01450000
*           /* IS SET TO 4.                                  @Y30LB11*/ 01451000
*           /*                                                       */ 01452000
*           /*********************************************************/ 01453000
*                                                                  0494 01454000
*           DARGSENT=MSG3762I;      /*                       @Y30LB11*/ 01455000
         L     @05,DDSTRU                                          0494 01456000
         MVI   DARGSENT(@05),X'03'                                 0494 01457000
*           BPROCOND=4;             /*                       @Y30LB11*/ 01458000
         LA    BPROCOND,4                                          0495 01459000
*         END;                      /*                       @Y30LB11*/ 01460000
*     END;                          /*                       @Y30LB11*/ 01461000
*                                                                  0497 01462000
@RC00491 DS    0H                                                  0498 01463000
*   /*****************************************************************/ 01464000
*   /*                                                               */ 01465000
*   /* THE UPRINT UMACRO IS ISSUED TO PRINT THE QUEUED MESSAGE.      */ 01466000
*   /*                                                               */ 01467000
*   /*****************************************************************/ 01468000
*                                                                  0498 01469000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB11*/ 01470000
*                                                                  0498 01471000
@RC00447 L     @05,@PC00001                                        0498 01472000
         ST    @05,@AL00001                                        0498 01473000
         LA    @15,@CF00111                                        0498 01474000
         ST    @15,@AL00001+4                                      0498 01475000
         LA    @15,DDSTRU                                          0498 01476000
         ST    @15,@AL00001+8                                      0498 01477000
         MVI   @AL00001+8,X'80'                                    0498 01478000
         L     @15,GDTPRT(,@05)                                    0498 01479000
         LA    @01,@AL00001                                        0498 01480000
         BALR  @14,@15                                             0498 01481000
*   /*****************************************************************/ 01482000
*   /*                                                               */ 01483000
*   /* RETURN IS MADE TO BASEALL.                            @Y30LB11*/ 01484000
*   /*                                                               */ 01485000
*   /*****************************************************************/ 01486000
*                                                                  0499 01487000
*   RETURN CODE(BPROCOND);          /*                       @Y30LB11*/ 01488000
         LR    @15,BPROCOND                                        0499 01489000
         L     @14,@SA00004                                        0499 01490000
         LM    @00,@12,@SA00004+8                                  0499 01491000
         BR    @14                                                 0499 01492000
*   END BASEPROC;                   /*                       @Y30LB11*/ 01493000
*                                                                  0501 01494000
*/********************************************************************/ 01495000
*/*                                                          @Y30LB11*/ 01496000
*/* PROCEDURE NAME - COPYPROC                                @Y30LB11*/ 01497000
*/*                                                          @Y30LB11*/ 01498000
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO REMOVE     @Y30LB11*/ 01499000
*/*            A SPECIFIC COPY RECORD.  ONE OF THE FOLLOWING @Y30LB11*/ 01500000
*/*            MESSAGES IS ISSUED:                           @Y30LB11*/ 01501000
*/*                                                          @Y30LB11*/ 01502000
*/*           IDC0760I RECORD FOR COPY YYDDD REMOVED.        @Y30LB11*/ 01503000
*/*                                                          @Y30LB11*/ 01504000
*/*           IDC3761I RECORD FOR COPY YYDDD NOT REMOVED.    @Y30LB11*/ 01505000
*/*                                                          @Y30LB11*/ 01506000
*/* INPUT - THE RVVI MAPPING MACRO IS PARTIALLY INITIALIZED  @Y30LB11*/ 01507000
*/*         AND USED AS INPUT TO READ THE COPYV RECORDS TO   @Y30LB11*/ 01508000
*/*         BE SCRATCHED.                                    @Y30LB11*/ 01509000
*/*                                                          @Y30LB11*/ 01510000
*/* OUTPUT - OUTPUT CONSISTS RETURN CODE IN REGISTER 15.     @Y30LB11*/ 01511000
*/*                                                          @Y30LB11*/ 01512000
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/ 01513000
*/*                                                          @Y30LB11*/ 01514000
*/*          4 - COPYPROC WAS UNSUCCESSFUL: COPY RECORD      @Y30LB11*/ 01515000
*/*              COULD NOT BE READ, OR COPY RECORD WAS NOT   @Y30LB11*/ 01516000
*/*              REMOVED.                                    @Y30LB11*/ 01517000
*/*                                                          @Y30LB11*/ 01518000
*/********************************************************************/ 01519000
*                                                                  0501 01520000
*COPYPROC:                          /*                       @Y30LB11*/ 01521000
*   PROC;                           /*                       @Y30LB11*/ 01522000
COPYPROC STM   @14,@12,@SA00005                                    0501 01523000
*   DCL                                                            0502 01524000
*     COPYCOND FIXED(15);           /* COPYPROC RETURN CODE  @Y30LB11*/ 01525000
*                                                                  0503 01526000
*   /*****************************************************************/ 01527000
*   /*                                                               */ 01528000
*   /* TRACE AT ENTRY TO COPYPROC PROCEDURE                  @Y30LB11*/ 01529000
*   /*                                                               */ 01530000
*   /*****************************************************************/ 01531000
*                                                                  0503 01532000
*   OLDERID2=NEWERID2;                                             0503 01533000
         L     @15,@PC00001                                        0503 01534000
         L     @15,GDTTR2(,@15)                                    0503 01535000
         MVC   @TS00001(95),NEWERID2(@15)                          0503 01536000
         MVC   OLDERID2(95,@15),@TS00001                           0503 01537000
*   NEWID2='RRCP';                  /*                       @Y30LB11*/ 01538000
*                                                                  0504 01539000
         MVC   NEWID2(4,@15),@CC01180                              0504 01540000
*   /*****************************************************************/ 01541000
*   /*                                                               */ 01542000
*   /* COPYPROC RETURN CODE IS INITIALIZED TO ZERO.          @Y30LB11*/ 01543000
*   /*                                                               */ 01544000
*   /*****************************************************************/ 01545000
*                                                                  0505 01546000
*   COPYCOND=0;                     /*                       @Y30LB11*/ 01547000
*                                                                  0505 01548000
         SLR   @15,@15                                             0505 01549000
         LR    COPYCOND,@15                                        0505 01550000
*   /*****************************************************************/ 01551000
*   /*                                                               */ 01552000
*   /* INITIALIZE RVVI VARIABLES FOR READING A SPECIFIC COPY @Y30LB11*/ 01553000
*   /*                                                               */ 01554000
*   /*****************************************************************/ 01555000
*                                                                  0506 01556000
*   CVD(DATEVAL,RVVCDATE);          /*                       @Y30LB11*/ 01557000
         L     @14,@PC00001+4                                      0506 01558000
         L     @01,FDTPTR+12(,@14)                                 0506 01559000
         L     @09,DATEVAL(,@01)                                   0506 01560000
         L     @08,RVVIPTR                                         0506 01561000
         CVD   @09,@TS00001                                        0506 01562000
         MVC   RVVCDATE(4,@08),@TS00001+4                          0506 01563000
*   RVVRDR=ON;                      /*                       @Y30LB11*/ 01564000
         OI    RVVRDR(@08),B'10000000'                             0507 01565000
*   RVVCPYRC=ON;                    /*                       @Y30LB11*/ 01566000
         OI    RVVCPYRC(@08),B'00100000'                           0508 01567000
*   RVVSDTE=ON;                     /*                       @Y30LB11*/ 01568000
         OI    RVVSDTE(@08),B'00100000'                            0509 01569000
*   RVVRTBUF=COPYVPTR;              /*                       @Y30LB11*/ 01570000
         ST    COPYVPTR,RVVRTBUF(,@08)                             0510 01571000
*   RVVBUFLN=LENGTH(COPYAREA);      /*                       @Y30LB11*/ 01572000
         MVC   RVVBUFLN(2,@08),@CH01211                            0511 01573000
*   RVVSSEQ=ON;                     /*                       @Y30LB11*/ 01574000
*                                                                  0512 01575000
         OI    RVVSSEQ(@08),B'00010000'                            0512 01576000
*   /*****************************************************************/ 01577000
*   /*                                                               */ 01578000
*   /* IF A COPY NUMBER IS SPECIFIED, THE SEQUENCE NUMBER IS SET TO  */ 01579000
*   /* IT, OTHERWISE IT IS DEFAULTED TO 1.                   @Y30LB11*/ 01580000
*   /*                                                               */ 01581000
*   /*****************************************************************/ 01582000
*                                                                  0513 01583000
*   IF ADDR(SEQ)^=NULLPTR THEN      /*                       @Y30LB11*/ 01584000
         L     @14,FDTPTR+16(,@14)                                 0513 01585000
         CR    @14,@15                                             0513 01586000
         BE    @RF00513                                            0513 01587000
*     RVVRDSEQ=SEQVAL;              /*                       @Y30LB11*/ 01588000
         MVC   RVVRDSEQ(1,@08),SEQVAL+3(@14)                       0514 01589000
*   ELSE                            /*                       @Y30LB11*/ 01590000
*     RVVRDSEQ=SEQDEFLT;            /*                       @Y30LB11*/ 01591000
*                                                                  0515 01592000
         B     @RC00513                                            0515 01593000
@RF00513 L     @01,RVVIPTR                                         0515 01594000
         MVI   RVVRDSEQ(@01),X'01'                                 0515 01595000
*   /*****************************************************************/ 01596000
*   /*                                                               */ 01597000
*   /* ADDITIONALLY SET THE SEQUENCE NUMBER FOR MESSAGE IDC3081I.    */ 01598000
*   /*                                                               */ 01599000
*   /*****************************************************************/ 01600000
*                                                                  0516 01601000
*   SEQNUM=RVVRDSEQ;                /*                       @Y30LB11*/ 01602000
*                                                                  0516 01603000
@RC00513 L     @01,RVVIPTR                                         0516 01604000
         SLR   @00,@00                                             0516 01605000
         IC    @00,RVVRDSEQ(,@01)                                  0516 01606000
         ST    @00,SEQNUM                                          0516 01607000
*   /*****************************************************************/ 01608000
*   /*                                                               */ 01609000
*   /* DUMP OF INITIALIZED PARM LIST FOR MSVC READ MACRO     @Y30LB11*/ 01610000
*   /*                                                               */ 01611000
*   /*****************************************************************/ 01612000
*                                                                  0517 01613000
*   IF GDTDBG=NULLPTR THEN                                         0517 01614000
         L     @15,@PC00001                                        0517 01615000
         L     @15,GDTDBG(,@15)                                    0517 01616000
         LTR   @15,@15                                             0517 01617000
         BZ    @RT00517                                            0517 01618000
*     ;                                                            0518 01619000
*   ELSE                                                           0519 01620000
*     DO;                                                          0519 01621000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB11*/ 01622000
         LA    DMPINDEX,DUMPAREA                                   0520 01623000
*       DMPITMNM='RVVI';                                           0521 01624000
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0521 01625000
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0521 01626000
         MVC   DMPITMNM(4,DMPINDEX),@CC01158                       0521 01627000
*       DMPITMPT=ADDR(RVVI);                                       0522 01628000
         L     @03,RVVIPTR                                         0522 01629000
         ST    @03,DMPITMPT(,DMPINDEX)                             0522 01630000
*       DMPITMLN=LENGTH(RVVI);                                     0523 01631000
         MVC   DMPITMLN(2,DMPINDEX),@CH01212                       0523 01632000
*       DMPITMTP='H';                                              0524 01633000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0524 01634000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0525 01635000
*                                                                  0525 01636000
         AL    DMPINDEX,@CF00464                                   0525 01637000
*       /*************************************************************/ 01638000
*       /*                                                           */ 01639000
*       /*                                                   @Y30LB11*/ 01640000
*       /*                                                           */ 01641000
*       /*************************************************************/ 01642000
*                                                                  0526 01643000
*       DMPTRM=DMPTRMVL;                                           0526 01644000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0526 01645000
*     END;                          /*                       @Y30LB11*/ 01646000
*   IF GDTDBG=NULLPTR THEN                                         0528 01647000
@RT00517 L     @15,@PC00001                                        0528 01648000
         L     @15,GDTDBG(,@15)                                    0528 01649000
         LTR   @15,@15                                             0528 01650000
         BZ    @RT00528                                            0528 01651000
*     ;                                                            0529 01652000
*   ELSE                                                           0530 01653000
*     CALL IDCDB010(GDTTBL,'RRCR',ADDR(DUMPAREA));/*         @Y30LB11*/ 01654000
         L     @15,@PC00001                                        0530 01655000
         ST    @15,@AL00001                                        0530 01656000
         LA    @14,@CC01182                                        0530 01657000
         ST    @14,@AL00001+4                                      0530 01658000
         LA    @14,DUMPAREA                                        0530 01659000
         ST    @14,@AFTEMPS+12                                     0530 01660000
         LA    @14,@AFTEMPS+12                                     0530 01661000
         ST    @14,@AL00001+8                                      0530 01662000
         MVI   @AL00001+8,X'80'                                    0530 01663000
         L     @15,GDTDBG(,@15)                                    0530 01664000
         LA    @01,@AL00001                                        0530 01665000
         BALR  @14,@15                                             0530 01666000
*                                                                  0531 01667000
*   /*****************************************************************/ 01668000
*   /*                                                               */ 01669000
*   /* ISSUE THE USSC UMACRO TO READ THE COPY RECORD.        @Y30LB11*/ 01670000
*   /*                                                               */ 01671000
*   /*****************************************************************/ 01672000
*                                                                  0531 01673000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*           @Y30LB11*/ 01674000
@RT00528 L     @02,@PC00001                                        0531 01675000
         ST    @02,@AL00001                                        0531 01676000
         LA    @15,VVIC                                            0531 01677000
         ST    @15,@AL00001+4                                      0531 01678000
         LA    @15,RVVIPTR                                         0531 01679000
         ST    @15,@AL00001+8                                      0531 01680000
         LA    @15,REASONCD                                        0531 01681000
         ST    @15,@AL00001+12                                     0531 01682000
         MVI   @AL00001+12,X'80'                                   0531 01683000
         L     @15,GDTSSC(,@02)                                    0531 01684000
         LA    @01,@AL00001                                        0531 01685000
         BALR  @14,@15                                             0531 01686000
*   RESPECIFY                                                      0532 01687000
*     RTNREG RSTD;                                                 0532 01688000
*   TESTRC=RTNREG;                                                 0533 01689000
         LR    TESTRC,RTNREG                                       0533 01690000
*   RESPECIFY                                                      0534 01691000
*     RTNREG UNRSTD;                /*                       @Y30LB11*/ 01692000
*                                                                  0534 01693000
*   /*****************************************************************/ 01694000
*   /*                                                               */ 01695000
*   /* IF THE RECORD WAS READ SUCCESSFULLY, CALL REMOVRCD TO @Y30LB11*/ 01696000
*   /* REMOVE THE RECORD.                                    @Y30LB11*/ 01697000
*   /*                                                               */ 01698000
*   /*****************************************************************/ 01699000
*                                                                  0535 01700000
*   IF TESTRC=0 THEN                /*                       @Y30LB11*/ 01701000
         LTR   TESTRC,TESTRC                                       0535 01702000
         BNZ   @RF00535                                            0535 01703000
*     DO;                           /*                       @Y30LB11*/ 01704000
*       DEFVCSN1=COPCSN1;           /*                       @Y30LB11*/ 01705000
         L     @01,DEFLPTR                                         0537 01706000
         MVC   DEFVCSN1(12,@01),COPCSN1(COPYVPTR)                  0537 01707000
*       RVRCOPYV=ON;                /*                       @Y30LB11*/ 01708000
         L     @15,RVRPTR                                          0538 01709000
         OI    RVRCOPYV(@15),B'01000000'                           0538 01710000
*       RVRCPYID=COPNO;             /*                       @Y30LB11*/ 01711000
         MVC   RVRCPYID(1,@15),COPNO(COPYVPTR)                     0539 01712000
*       CALL REMOVRCD;              /*                       @Y30LB11*/ 01713000
         BAL   @14,REMOVRCD                                        0540 01714000
*       RESPECIFY                                                  0541 01715000
*         RTNREG RSTD;                                             0541 01716000
*       TESTRC=RTNREG;                                             0542 01717000
         LR    TESTRC,RTNREG                                       0542 01718000
*       RESPECIFY                                                  0543 01719000
*         RTNREG UNRSTD;            /*                       @Y30LB11*/ 01720000
*                                                                  0543 01721000
*       /*************************************************************/ 01722000
*       /*                                                           */ 01723000
*       /* IF REMOVRCD WAS SUCCESSFUL, THE MESSAGE: ** RECORD FOR    */ 01724000
*       /* COPY YYYDDD REMOVED, IS WRITTEN.                  @Y30LB11*/ 01725000
*       /*                                                           */ 01726000
*       /*************************************************************/ 01727000
*                                                                  0544 01728000
*       IF TESTRC=0 THEN            /*                       @Y30LB11*/ 01729000
         LTR   TESTRC,TESTRC                                       0544 01730000
         BNZ   @RF00544                                            0544 01731000
*         DO;                       /*                       @Y30LB11*/ 01732000
*           DARGAREA=''B;           /*                       @Y30LB11*/ 01733000
         XC    DARGAREA(36),DARGAREA                               0546 01734000
*           DARGSMOD=REMOVRMG;      /*                       @Y30LB11*/ 01735000
         L     @15,DDSTRU                                          0547 01736000
         MVC   DARGSMOD(3,@15),@CC01134                            0547 01737000
*           DARGSENT=MSG0760I;      /*                       @Y30LB11*/ 01738000
         MVI   DARGSENT(@15),X'01'                                 0548 01739000
*           DARGDBP=ADDR(COPDATE);  /*                       @Y30LB11*/ 01740000
         LA    @14,COPDATE(,COPYVPTR)                              0549 01741000
         ST    @14,DARGDBP(,@15)                                   0549 01742000
*           DARGILP=LENGTH(COPDATE);/*                       @Y30LB11*/ 01743000
         MVC   DARGILP(2,@15),@CH00041                             0550 01744000
*         END;                      /*                       @Y30LB11*/ 01745000
*                                                                  0551 01746000
*       /*************************************************************/ 01747000
*       /*                                                           */ 01748000
*       /* IF REMOVRCD WAS UNSUCCESSFUL, THE MESSAGE: ** RECORD FOR  */ 01749000
*       /* COPY YYYDDD NOT REMOVED, IS WRITTEN.              @Y30LB11*/ 01750000
*       /*                                                           */ 01751000
*       /*************************************************************/ 01752000
*                                                                  0552 01753000
*       ELSE                        /*                       @Y30LB11*/ 01754000
*         DO;                       /*                       @Y30LB11*/ 01755000
         B     @RC00544                                            0552 01756000
@RF00544 DS    0H                                                  0553 01757000
*           DARGAREA=''B;           /*                       @Y30LB11*/ 01758000
         XC    DARGAREA(36),DARGAREA                               0553 01759000
*           DARGSMOD=REMOVRMG;      /*                       @Y30LB11*/ 01760000
         L     @15,DDSTRU                                          0554 01761000
         MVC   DARGSMOD(3,@15),@CC01134                            0554 01762000
*           DARGSENT=MSG3761I;      /*                       @Y30LB11*/ 01763000
         MVI   DARGSENT(@15),X'02'                                 0555 01764000
*           DARGDBP=ADDR(COPDATE);  /*                       @Y30LB11*/ 01765000
         LA    @14,COPDATE(,COPYVPTR)                              0556 01766000
         ST    @14,DARGDBP(,@15)                                   0556 01767000
*           DARGILP=LENGTH(COPDATE);/*                       @Y30LB11*/ 01768000
*                                                                  0557 01769000
         LA    @05,4                                               0557 01770000
         STH   @05,DARGILP(,@15)                                   0557 01771000
*           /*********************************************************/ 01772000
*           /*                                                       */ 01773000
*           /* THE RETURN CODE IS SET TO 4.                  @Y30LB11*/ 01774000
*           /*                                                       */ 01775000
*           /*********************************************************/ 01776000
*                                                                  0558 01777000
*           COPYCOND=4;             /*                       @Y30LB11*/ 01778000
         LR    COPYCOND,@05                                        0558 01779000
*         END;                      /*                       @Y30LB11*/ 01780000
*                                                                  0559 01781000
*       /*************************************************************/ 01782000
*       /*                                                           */ 01783000
*       /* THE UPRINT UMACRO IS ISSUED TO PRINT THE MESSAGE  @Y30LB11*/ 01784000
*       /*                                                           */ 01785000
*       /*************************************************************/ 01786000
*                                                                  0560 01787000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB11*/ 01788000
@RC00544 L     @05,@PC00001                                        0560 01789000
         ST    @05,@AL00001                                        0560 01790000
         LA    @15,@CF00111                                        0560 01791000
         ST    @15,@AL00001+4                                      0560 01792000
         LA    @15,DDSTRU                                          0560 01793000
         ST    @15,@AL00001+8                                      0560 01794000
         MVI   @AL00001+8,X'80'                                    0560 01795000
         L     @15,GDTPRT(,@05)                                    0560 01796000
         LA    @01,@AL00001                                        0560 01797000
         BALR  @14,@15                                             0560 01798000
*     END;                          /*                       @Y30LB11*/ 01799000
*                                                                  0561 01800000
*   /*****************************************************************/ 01801000
*   /*                                                               */ 01802000
*   /* IF THE READ FAILED, SSCMSG IS CALLED TO PRINT A MESSAGE       */ 01803000
*   /* CORRESPONDING TO THE REASON CODE. THE MESSAGE: ** COPY NOT    */ 01804000
*   /* RETRIEVED FROM INVENTORY FOR RECORD YYDDD, NO.XXX, IS WRITTEN,*/ 01805000
*   /* AND THE RETURN CODE IS SET TO 4.                      @Y30LB11*/ 01806000
*   /*                                                               */ 01807000
*   /*****************************************************************/ 01808000
*                                                                  0562 01809000
*   ELSE                            /*                       @Y30LB11*/ 01810000
*     DO;                           /*                       @Y30LB11*/ 01811000
         B     @RC00535                                            0562 01812000
@RF00535 DS    0H                                                  0563 01813000
*       CALL SSCMSG(REASONCD);      /*                       @Y30LB11*/ 01814000
         LA    @15,REASONCD                                        0563 01815000
         ST    @15,@AL00001                                        0563 01816000
         LA    @01,@AL00001                                        0563 01817000
         BAL   @14,SSCMSG                                          0563 01818000
*       DARGAREA=''B;               /*                       @Y30LB11*/ 01819000
         XC    DARGAREA(36),DARGAREA                               0564 01820000
*       DARGSMOD=COMMSG;            /*                       @Y30LB11*/ 01821000
         L     @05,DDSTRU                                          0565 01822000
         MVC   DARGSMOD(3,@05),@CC01113                            0565 01823000
*       DARGSENT=MSG3081I;          /*                       @Y30LB11*/ 01824000
         MVI   DARGSENT(@05),X'19'                                 0566 01825000
*       DARGDBP=ADDR(RVVCDATE);     /*                       @Y30LB11*/ 01826000
         L     @01,RVVIPTR                                         0567 01827000
         LA    @15,RVVCDATE(,@01)                                  0567 01828000
         ST    @15,DARGDBP(,@05)                                   0567 01829000
*       DARGILP=LENGTH(RVVCDATE);   /*                       @Y30LB11*/ 01830000
         LA    @15,4                                               0568 01831000
         STH   @15,DARGILP(,@05)                                   0568 01832000
*       DARGCNT=1;                  /*                       @Y30LB11*/ 01833000
         LA    @14,1                                               0569 01834000
         STH   @14,DARGCNT(,@05)                                   0569 01835000
*       DARGINS(1)=SEQ#;            /*                       @Y30LB11*/ 01836000
         STH   @14,DARGINS(,@05)                                   0570 01837000
*       DARGINL(1)=LENGTH(SEQNUM);  /*                       @Y30LB11*/ 01838000
         STH   @15,DARGINL(,@05)                                   0571 01839000
*       DARGDTM(1)=ADDR(SEQNUM);    /*                       @Y30LB11*/ 01840000
         LA    @15,SEQNUM                                          0572 01841000
         ST    @15,DARGDTM(,@05)                                   0572 01842000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB11*/ 01843000
         L     @05,@PC00001                                        0573 01844000
         ST    @05,@AL00001                                        0573 01845000
         LA    @15,@CF00111                                        0573 01846000
         ST    @15,@AL00001+4                                      0573 01847000
         LA    @15,DDSTRU                                          0573 01848000
         ST    @15,@AL00001+8                                      0573 01849000
         MVI   @AL00001+8,X'80'                                    0573 01850000
         L     @15,GDTPRT(,@05)                                    0573 01851000
         LA    @01,@AL00001                                        0573 01852000
         BALR  @14,@15                                             0573 01853000
*       COPYCOND=4;                 /*                       @Y30LB11*/ 01854000
         LA    COPYCOND,4                                          0574 01855000
*     END;                          /*                       @Y30LB11*/ 01856000
*                                                                  0575 01857000
*   /*****************************************************************/ 01858000
*   /*                                                               */ 01859000
*   /* RETURN TO IDCRR01.                                    @Y30LB11*/ 01860000
*   /*                                                               */ 01861000
*   /*****************************************************************/ 01862000
*                                                                  0576 01863000
*   RETURN CODE(COPYCOND);          /*                       @Y30LB11*/ 01864000
@RC00535 LR    @15,COPYCOND                                        0576 01865000
         L     @14,@SA00005                                        0576 01866000
         LM    @00,@12,@SA00005+8                                  0576 01867000
         BR    @14                                                 0576 01868000
*   END COPYPROC;                   /*                       @Y30LB11*/ 01869000
*                                                                  0578 01870000
*/***********************************************************@Y30LB39*/ 01871000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 01872000
*/*                                                          @Y30LB39*/ 01873000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 01874000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 01875000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 01876000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 01877000
*/*                                                          @Y30LB39*/ 01878000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 01879000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 01880000
*/*   IN SSECBCD.                                            @Y30LB39*/ 01881000
*/*                                                          @Y30LB39*/ 01882000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 01883000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 01884000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 01885000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 01886000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 01887000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 01888000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 01889000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 01890000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 01891000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 01892000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 01893000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 01894000
*/*                                                          @Y30LB39*/ 01895000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 01896000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 01897000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 01898000
*/*                                                          @Y30LB39*/ 01899000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 01900000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 01901000
*/*                                                          @Y30LB39*/ 01902000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 01903000
*/*                                                          @Y30LB39*/ 01904000
*/***********************************************************@Y30LB39*/ 01905000
*                                                                  0578 01906000
*                                   /*                       @Y30LB39*/ 01907000
*SSCMSG:                                                           0578 01908000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 01909000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   01910000
*                                                            @Y30LB39*/ 01911000
SSCMSG   STM   @14,@12,@SA00006                                    0578 01912000
         MVC   @PC00006(8),0(@01)                                  0578 01913000
*                                   /*                       @Y30LB39*/ 01914000
*                                                                  0579 01915000
*   /*****************************************************************/ 01916000
*   /*                                                               */ 01917000
*   /*                                                       @Y30LB39*/ 01918000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 01919000
*   /*                                                       @Y30LB39*/ 01920000
*   /*                                                               */ 01921000
*   /*****************************************************************/ 01922000
*                                                                  0579 01923000
*                                   /*                       @Y30LB39   01924000
*                                                            @Y30LB39*/ 01925000
*                                                                  0579 01926000
*   /*****************************************************************/ 01927000
*   /*                                                               */ 01928000
*   /*                                                       @Y30LB39*/ 01929000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 01930000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 01931000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 01932000
*   /*                                                       @Y30LB39*/ 01933000
*   /*                                                               */ 01934000
*   /*****************************************************************/ 01935000
*                                                                  0579 01936000
*                                   /*                       @Y30LB39*/ 01937000
*   DCL                                                            0579 01938000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 01939000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 01940000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 01941000
*   DCL                                                            0580 01942000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   01943000
*                                                            @Y30LB39   01944000
*                                                            @Y30LB39*/ 01945000
*                                                                  0580 01946000
*   /*****************************************************************/ 01947000
*   /*                                                               */ 01948000
*   /*                                                       @Y30LB39*/ 01949000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 01950000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 01951000
*   /*                                                       @Y30LB39*/ 01952000
*   /*                                                               */ 01953000
*   /*****************************************************************/ 01954000
*                                                                  0581 01955000
*                                   /*                       @Y30LB39*/ 01956000
*   DCL                                                            0581 01957000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 01958000
*   DCL                                                            0582 01959000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   01960000
*                                                            @Y30LB39*/ 01961000
*                                                                  0582 01962000
*   /*****************************************************************/ 01963000
*   /*                                                               */ 01964000
*   /*                                                       @Y30LB39*/ 01965000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 01966000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 01967000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 01968000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 01969000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 01970000
*   /*                                                       @Y30LB39*/ 01971000
*   /*                                                               */ 01972000
*   /*****************************************************************/ 01973000
*                                                                  0583 01974000
*                                   /*                       @Y30LB39*/ 01975000
*   DECLARE                                                        0583 01976000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   01977000
*                                                            @Y30LB39*/ 01978000
*                                                                  0583 01979000
*   /*****************************************************************/ 01980000
*   /*                                                               */ 01981000
*   /*                                                       @Y30LB39*/ 01982000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 01983000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 01984000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 01985000
*   /* IDCTSCM0.                                             @Y30LB39*/ 01986000
*   /*                                                       @Y30LB39*/ 01987000
*   /*                                                               */ 01988000
*   /*****************************************************************/ 01989000
*                                                                  0584 01990000
*                                   /*                       @Y30LB39*/ 01991000
*   DECLARE                                                        0584 01992000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   01993000
*                                                            @Y30LB39*/ 01994000
*                                                                  0584 01995000
*   /*****************************************************************/ 01996000
*   /*                                                               */ 01997000
*   /*                                                       @Y30LB39*/ 01998000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 01999000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 02000000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 02001000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 02002000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 02003000
*   /*                                                       @Y30LB39*/ 02004000
*   /*                                                               */ 02005000
*   /*****************************************************************/ 02006000
*                                                                  0585 02007000
*                                   /*                       @Y30LB39*/ 02008000
*   DECLARE                                                        0585 02009000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 02010000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   02011000
*                                                            @Y30LB39*/ 02012000
*                                                                  0585 02013000
*   /*****************************************************************/ 02014000
*   /*                                                               */ 02015000
*   /*                                                       @Y30LB39*/ 02016000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 02017000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 02018000
*   /*                                                       @Y30LB39*/ 02019000
*   /*                                                               */ 02020000
*   /*****************************************************************/ 02021000
*                                                                  0586 02022000
*                                   /*                       @Y30LB39*/ 02023000
*   DECLARE                                                        0586 02024000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   02025000
*                                                            @Y30LB39*/ 02026000
*                                                                  0586 02027000
*   /*****************************************************************/ 02028000
*   /*                                                               */ 02029000
*   /*                                                       @Y30LB39*/ 02030000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 02031000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 02032000
*   /*                                                       @Y30LB39*/ 02033000
*   /*                                                               */ 02034000
*   /*****************************************************************/ 02035000
*                                                                  0587 02036000
*                                   /*                       @Y30LB39*/ 02037000
*   DECLARE                                                        0587 02038000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   02039000
*                                                            @Y30LB39*/ 02040000
*                                   /*                       @Y30LB39*/ 02041000
*                                                                  0588 02042000
*   /*****************************************************************/ 02043000
*   /*                                                               */ 02044000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 02045000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 02046000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 02047000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 02048000
*   /*                                                       @Y30LB39*/ 02049000
*   /*                                                               */ 02050000
*   /*****************************************************************/ 02051000
*                                                                  0588 02052000
*                                   /*                       @Y30LB39*/ 02053000
*   OLDERID2=NEWERID2;                                             0588 02054000
         L     @15,@PC00001                                        0588 02055000
         L     @14,GDTTR2(,@15)                                    0588 02056000
         MVC   @TS00001(95),NEWERID2(@14)                          0588 02057000
         MVC   OLDERID2(95,@14),@TS00001                           0588 02058000
*   NEWID2='SSAA';                  /*                       @Y30LB39   02059000
*                                                            @Y30LB39*/ 02060000
*                                                                  0589 02061000
         MVC   NEWID2(4,@14),@CC01203                              0589 02062000
*   /*****************************************************************/ 02063000
*   /*                                                               */ 02064000
*   /*                                                       @Y30LB39*/ 02065000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 02066000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 02067000
*   /*                                                       @Y30LB39*/ 02068000
*   /*                                                               */ 02069000
*   /*****************************************************************/ 02070000
*                                                                  0590 02071000
*                                   /*                       @Y30LB39*/ 02072000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   02073000
*                                                            @Y30LB39*/ 02074000
*                                                                  0590 02075000
         LA    @14,SSDRGLT                                         0590 02076000
         ST    @14,SSDLPTR                                         0590 02077000
*   /*****************************************************************/ 02078000
*   /*                                                               */ 02079000
*   /*                                                       @Y30LB39*/ 02080000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 02081000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 02082000
*   /*                                                       @Y30LB39*/ 02083000
*   /*                                                               */ 02084000
*   /*****************************************************************/ 02085000
*                                                                  0591 02086000
*                                   /*                       @Y30LB39*/ 02087000
*   IF SSRCODE>0 THEN                                              0591 02088000
         L     @09,@PC00006                                        0591 02089000
         L     @09,SSRCODE(,@09)                                   0591 02090000
         LTR   @09,@09                                             0591 02091000
         BNP   @RF00591                                            0591 02092000
*     DO;                           /*                       @Y30LB39   02093000
*                                                            @Y30LB39*/ 02094000
*                                                                  0592 02095000
*       /*************************************************************/ 02096000
*       /*                                                           */ 02097000
*       /*                                                   @Y30LB39*/ 02098000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 02099000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 02100000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 02101000
*       /* CODES.                                            @Y30LB39*/ 02102000
*       /*                                                   @Y30LB39*/ 02103000
*       /*                                                           */ 02104000
*       /*************************************************************/ 02105000
*                                                                  0593 02106000
*                                   /*                       @Y30LB39*/ 02107000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 02108000
         XC    SSDRGLT(20),SSDRGLT                                 0593 02109000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 02110000
         LA    @03,SSINXLST                                        0594 02111000
         ST    @03,DARGRETP(,@14)                                  0594 02112000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 02113000
         MVC   DARGSMOD(3,@14),SSMODSS0                            0595 02114000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 02115000
         MVI   DARGSENT(@14),X'01'                                 0596 02116000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   02117000
*                                                            @Y30LB39*/ 02118000
*                                                                  0597 02119000
         MVC   DARGRETL(2,@14),@CH01214                            0597 02120000
*       /*************************************************************/ 02121000
*       /*                                                           */ 02122000
*       /*                                                   @Y30LB39*/ 02123000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 02124000
*       /* ARRAY.                                            @Y30LB39*/ 02125000
*       /*                                                   @Y30LB39*/ 02126000
*       /*                                                           */ 02127000
*       /*************************************************************/ 02128000
*                                                                  0598 02129000
*                                   /*                       @Y30LB39*/ 02130000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   02131000
*                                                            @Y30LB39*/ 02132000
*                                                                  0598 02133000
         ST    @15,@AL00001                                        0598 02134000
         LA    @03,@CF00111                                        0598 02135000
         ST    @03,@AL00001+4                                      0598 02136000
         LA    @03,SSDLPTR                                         0598 02137000
         ST    @03,@AL00001+8                                      0598 02138000
         MVI   @AL00001+8,X'80'                                    0598 02139000
         L     @15,GDTPRT(,@15)                                    0598 02140000
         LA    @01,@AL00001                                        0598 02141000
         BALR  @14,@15                                             0598 02142000
*       /*************************************************************/ 02143000
*       /*                                                           */ 02144000
*       /*                                                   @Y30LB39*/ 02145000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 02146000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 02147000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 02148000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 02149000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 02150000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 02151000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 02152000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 02153000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 02154000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 02155000
*       /* REASON CODE.                                      @Y30LB39*/ 02156000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 02157000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 02158000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 02159000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 02160000
*       /*                                                   @Y30LB39*/ 02161000
*       /*                                                           */ 02162000
*       /*************************************************************/ 02163000
*                                                                  0599 02164000
*                                   /*                       @Y30LB39*/ 02165000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 02166000
         LA    ENTRYNUM,1                                          0599 02167000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   0600 02168000
@DL00600 DS    0H                                                  0601 02169000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 02170000
         AL    ENTRYNUM,@CF00213                                   0601 02171000
*       END;                        /*                       @Y30LB39   02172000
*                                                            @Y30LB39*/ 02173000
*                                                                  0602 02174000
@DE00600 L     @03,@PC00006                                        0602 02175000
         LR    @15,ENTRYNUM                                        0602 02176000
         ALR   @15,@15                                             0602 02177000
         LH    @15,SSARRAY-2(@15)                                  0602 02178000
         CH    @15,SSRHALF(,@03)                                   0602 02179000
         BE    @DC00600                                            0602 02180000
         SLR   @14,@14                                             0602 02181000
         CR    @15,@14                                             0602 02182000
         BNE   @DL00600                                            0602 02183000
@DC00600 DS    0H                                                  0603 02184000
*       /*************************************************************/ 02185000
*       /*                                                           */ 02186000
*       /*                                                   @Y30LB39*/ 02187000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 02188000
*       /*                                                   @Y30LB39*/ 02189000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 02190000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 02191000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 02192000
*       /* CODE OR                                           @Y30LB39*/ 02193000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 02194000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 02195000
*       /*                                                   @Y30LB39*/ 02196000
*       /*                                                           */ 02197000
*       /*************************************************************/ 02198000
*                                                                  0603 02199000
*                                   /*                       @Y30LB39*/ 02200000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 02201000
         XC    SSDRGLT(20),SSDRGLT                                 0603 02202000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 02203000
         L     @09,SSDLPTR                                         0604 02204000
         MVC   DARGSMOD(3,@09),SSMODSS0                            0604 02205000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 02206000
         STC   ENTRYNUM,DARGSENT(,@09)                             0605 02207000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 02208000
         CR    @15,@14                                             0606 02209000
         BNE   @RF00606                                            0606 02210000
*         DO;                       /*                       @Y30LB39*/ 02211000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 02212000
         ST    @03,DARGDBP(,@09)                                   0608 02213000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 02214000
         MVC   DARGILP(2,@09),@CH00041                             0609 02215000
*         END;                      /*                       @Y30LB39*/ 02216000
*     END;                          /*                       @Y30LB39*/ 02217000
*                                   /*                       @Y30LB39*/ 02218000
*                                                                  0612 02219000
*   /*****************************************************************/ 02220000
*   /*                                                               */ 02221000
*   /*                                                       @Y30LB39*/ 02222000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 02223000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 02224000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 02225000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 02226000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 02227000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 02228000
*   /* POST CODE.                                            @Y30LB39*/ 02229000
*   /*                                                       @Y30LB39*/ 02230000
*   /*                                                               */ 02231000
*   /*****************************************************************/ 02232000
*                                                                  0612 02233000
*                                   /*                       @Y30LB39*/ 02234000
*   ELSE                            /*                       @Y30LB39*/ 02235000
*     DO;                           /*                       @Y30LB39*/ 02236000
         B     @RC00591                                            0612 02237000
@RF00591 DS    0H                                                  0613 02238000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 02239000
         XC    SSDRGLT(20),SSDRGLT                                 0613 02240000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 02241000
         L     @15,SSDLPTR                                         0614 02242000
         MVC   DARGSMOD(3,@15),SSMODCM0                            0614 02243000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 02244000
         MVC   DARGSENT(1,@15),SSMSGNUM                            0615 02245000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 02246000
         L     @14,@PC00006+4                                      0616 02247000
         ST    @14,DARGDBP(,@15)                                   0616 02248000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 02249000
         MVC   DARGILP(2,@15),@CH00213                             0617 02250000
*     END;                          /*                       @Y30LB39   02251000
*                                                            @Y30LB39*/ 02252000
*                                                                  0618 02253000
*   /*****************************************************************/ 02254000
*   /*                                                               */ 02255000
*   /*                                                       @Y30LB39*/ 02256000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 02257000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 02258000
*   /*                                                       @Y30LB39*/ 02259000
*   /*                                                               */ 02260000
*   /*****************************************************************/ 02261000
*                                                                  0619 02262000
*                                   /*                       @Y30LB39*/ 02263000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   02264000
*                                                            @Y30LB39*/ 02265000
*                                                                  0619 02266000
@RC00591 L     @15,@PC00001                                        0619 02267000
         ST    @15,@AL00001                                        0619 02268000
         LA    @14,@CF00111                                        0619 02269000
         ST    @14,@AL00001+4                                      0619 02270000
         LA    @14,SSDLPTR                                         0619 02271000
         ST    @14,@AL00001+8                                      0619 02272000
         MVI   @AL00001+8,X'80'                                    0619 02273000
         L     @15,GDTPRT(,@15)                                    0619 02274000
         LA    @01,@AL00001                                        0619 02275000
         BALR  @14,@15                                             0619 02276000
*   /*****************************************************************/ 02277000
*   /*                                                               */ 02278000
*   /*                                                       @Y30LB39*/ 02279000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 02280000
*   /*                                                       @Y30LB39*/ 02281000
*   /*                                                               */ 02282000
*   /*****************************************************************/ 02283000
*                                                                  0620 02284000
*                                   /*                       @Y30LB39   02285000
*                                                            @Y30LB39*/ 02286000
*   RETURN CODE(0);                 /*                       @Y30LB39   02287000
*                                                            @Y30LB39*/ 02288000
         SLR   @15,@15                                             0620 02289000
         L     @14,@SA00006                                        0620 02290000
         LM    @00,@12,@SA00006+8                                  0620 02291000
         BR    @14                                                 0620 02292000
*   END SSCMSG;                     /*                       @Y30LB39*/ 02293000
*                                                                  0622 02294000
*/********************************************************************/ 02295000
*/*                                                          @Y30LB11*/ 02296000
*/* PROCEDURE NAME - REMOVRCD                                @Y30LB11*/ 02297000
*/*                                                          @Y30LB11*/ 02298000
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO CHECK      @Y30LB11*/ 02299000
*/*            IF THE CARTRIDGES ARE STILL IN THE MSF AND    @Y30LB11*/ 02300000
*/*            REMOVE THE BASE OR COPY RECORD IF THE         @Y30LB11*/ 02301000
*/*            CARTRIDGES ARE NOT IN THE MSF.  THE FOLLOWING @Y30LB11*/ 02302000
*/*            MESSAGE MAY BE ISSUED:                        @Y30LB11*/ 02303000
*/*                                                          @Y30LB11*/ 02304000
*/*           IDC2764I CARTRIDGES STILL IN MASS STORAGE      @Y30LB11*/ 02305000
*/*           FACILITY.                                      @Y30LB11*/ 02306000
*/*                                                          @Y30LB11*/ 02307000
*/* INPUT - THE DEFLIST MAPPING MACRO IS COMPLETELY          @Y30LB11*/ 02308000
*/*         INITIALIZED AND IS USED AS INPUT TO TEST WHETHER @Y30LB11*/ 02309000
*/*         THE CARTRIDGES ARE STILL IN THE MSF.  THE RVR    @Y30LB11*/ 02310000
*/*         ARGUMENT LIST IS COMPLETELY INITIALIZED AND IS   @Y30LB11*/ 02311000
*/*         USED AS INPUT TO REMOVE THE RECORD.              @Y30LB11*/ 02312000
*/*                                                          @Y30LB11*/ 02313000
*/* OUTPUT - OUTPUT CONSISTS RETURN CODE IN REGISTER 15.     @Y30LB11*/ 02314000
*/*                                                          @Y30LB11*/ 02315000
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/ 02316000
*/*                                                          @Y30LB11*/ 02317000
*/*          4 - FUNCTION WAS UNSUCCESSFUL: VOLUME STILL     @Y30LB11*/ 02318000
*/*              IN MSF, OR MSC FAILURE OCCURRED.            @Y30LB11*/ 02319000
*/*                                                          @Y30LB11*/ 02320000
*/*          8 - USSC UMACRO COULD NOT OBTAIN STORAGE FOR    @Y30LB11*/ 02321000
*/*              ECB/MESSAGE AREA.                           @Y30LB11*/ 02322000
*/********************************************************************/ 02323000
*                                                                  0622 02324000
*REMOVRCD:                          /*                       @Y30LB11*/ 02325000
*   PROC;                           /*                       @Y30LB11*/ 02326000
REMOVRCD STM   @14,@12,@SA00007                                    0622 02327000
*   DCL                                                            0623 02328000
*     RMVRCOND FIXED(15);           /* REMOVRCD RETURN CODE  @Y30LB11*/ 02329000
*                                                                  0624 02330000
*   /*****************************************************************/ 02331000
*   /*                                                               */ 02332000
*   /* TRACE AT ENTRY TO REMOVRCD PROCEDURE                  @Y30LB11*/ 02333000
*   /*                                                               */ 02334000
*   /*****************************************************************/ 02335000
*                                                                  0624 02336000
*   OLDERID2=NEWERID2;                                             0624 02337000
         L     @05,@PC00001                                        0624 02338000
         L     @15,GDTTR2(,@05)                                    0624 02339000
         MVC   @TS00001(95),NEWERID2(@15)                          0624 02340000
         MVC   OLDERID2(95,@15),@TS00001                           0624 02341000
*   NEWID2='RRDV';                  /*                       @Y30LB11*/ 02342000
*                                                                  0625 02343000
         MVC   NEWID2(4,@15),@CC01208                              0625 02344000
*   /*****************************************************************/ 02345000
*   /*                                                               */ 02346000
*   /* REMOVRCD RETURN CODE IS INITIALIZED TO ZERO.          @Y30LB11*/ 02347000
*   /*                                                               */ 02348000
*   /*****************************************************************/ 02349000
*                                                                  0626 02350000
*   RMVRCOND=0;                     /*                       @Y30LB11*/ 02351000
*                                                                  0626 02352000
         SLR   @15,@15                                             0626 02353000
         LR    RMVRCOND,@15                                        0626 02354000
*   /*****************************************************************/ 02355000
*   /*                                                               */ 02356000
*   /* DUMP OF INITIALIZED PARM LIST FOR MSVC DEFINE MACRO   @Y30LB11*/ 02357000
*   /*                                                               */ 02358000
*   /*****************************************************************/ 02359000
*                                                                  0627 02360000
*   IF GDTDBG=NULLPTR THEN                                         0627 02361000
         C     @15,GDTDBG(,@05)                                    0627 02362000
         BE    @RT00627                                            0627 02363000
*     ;                                                            0628 02364000
*   ELSE                                                           0629 02365000
*     DO;                                                          0629 02366000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB11*/ 02367000
         LA    DMPINDEX,DUMPAREA                                   0630 02368000
*       DMPITMNM='RVVI';                                           0631 02369000
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0631 02370000
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0631 02371000
         MVC   DMPITMNM(4,DMPINDEX),@CC01158                       0631 02372000
*       DMPITMPT=ADDR(RVVI);                                       0632 02373000
         L     @05,RVVIPTR                                         0632 02374000
         ST    @05,DMPITMPT(,DMPINDEX)                             0632 02375000
*       DMPITMLN=LENGTH(RVVI);                                     0633 02376000
         MVC   DMPITMLN(2,DMPINDEX),@CH01212                       0633 02377000
*       DMPITMTP='H';                                              0634 02378000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0634 02379000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0635 02380000
*                                                                  0635 02381000
         AL    DMPINDEX,@CF00464                                   0635 02382000
*       /*************************************************************/ 02383000
*       /*                                                           */ 02384000
*       /*                                                   @Y30LB11*/ 02385000
*       /*                                                           */ 02386000
*       /*************************************************************/ 02387000
*                                                                  0636 02388000
*       DMPTRM=DMPTRMVL;                                           0636 02389000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0636 02390000
*     END;                          /*                       @Y30LB11*/ 02391000
*   IF GDTDBG=NULLPTR THEN                                         0638 02392000
@RT00627 L     @05,@PC00001                                        0638 02393000
         L     @05,GDTDBG(,@05)                                    0638 02394000
         LTR   @05,@05                                             0638 02395000
         BZ    @RT00638                                            0638 02396000
*     ;                                                            0639 02397000
*   ELSE                                                           0640 02398000
*     CALL IDCDB010(GDTTBL,'RRDL',ADDR(DUMPAREA));/*         @Y30LB11*/ 02399000
         L     @05,@PC00001                                        0640 02400000
         ST    @05,@AL00001                                        0640 02401000
         LA    @15,@CC01209                                        0640 02402000
         ST    @15,@AL00001+4                                      0640 02403000
         LA    @15,DUMPAREA                                        0640 02404000
         ST    @15,@AFTEMPS+16                                     0640 02405000
         LA    @15,@AFTEMPS+16                                     0640 02406000
         ST    @15,@AL00001+8                                      0640 02407000
         MVI   @AL00001+8,X'80'                                    0640 02408000
         L     @15,GDTDBG(,@05)                                    0640 02409000
         LA    @01,@AL00001                                        0640 02410000
         BALR  @14,@15                                             0640 02411000
*                                                                  0641 02412000
*   /*****************************************************************/ 02413000
*   /*                                                               */ 02414000
*   /* ISSUE THE USSC MACRO TO INVOKE THE ICBDEFV (DEFINE) MACRO TO  */ 02415000
*   /* PERFORM A RENAME OF THE VOLUME OR COPY TO ITSELF TO TEST      */ 02416000
*   /* WHETHER THE CARTRIDGES ARE IN THE LIBRARY. THE DEFLIST WAS    */ 02417000
*   /* SETUP PRIOR TO THE CALL TO REMOVRCD.                  @Y30LB11*/ 02418000
*   /*                                                               */ 02419000
*   /*****************************************************************/ 02420000
*                                                                  0641 02421000
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFLPTR,REASONCD,ECBCODE);/* @Y30LB11*/ 02422000
@RT00638 L     @05,@PC00001                                        0641 02423000
         ST    @05,@AL00001                                        0641 02424000
         LA    @02,DEFINE                                          0641 02425000
         ST    @02,@AL00001+4                                      0641 02426000
         LA    @02,DEFLPTR                                         0641 02427000
         ST    @02,@AL00001+8                                      0641 02428000
         LA    @02,REASONCD                                        0641 02429000
         ST    @02,@AL00001+12                                     0641 02430000
         LA    @02,ECBCODE                                         0641 02431000
         ST    @02,@AL00001+16                                     0641 02432000
         MVI   @AL00001+16,X'80'                                   0641 02433000
         L     @15,GDTSSC(,@05)                                    0641 02434000
         LA    @01,@AL00001                                        0641 02435000
         BALR  @14,@15                                             0641 02436000
*   RESPECIFY                                                      0642 02437000
*     RTNREG RSTD;                                                 0642 02438000
*   TESTRC=RTNREG;                                                 0643 02439000
         LR    TESTRC,RTNREG                                       0643 02440000
*   RESPECIFY                                                      0644 02441000
*     RTNREG UNRSTD;                /*                       @Y30LB11*/ 02442000
*                                                                  0644 02443000
*   /*****************************************************************/ 02444000
*   /*                                                               */ 02445000
*   /* IF ANY CARTRIDGES WERE FOUND, THE MESSAGE: CARTRIDGES STILL IN*/ 02446000
*   /* MASS STORAGE FACILITY, IS WRITTEN, AND THE RETURN CODE IS SET */ 02447000
*   /* TO 4.                                                 @Y30LB11*/ 02448000
*   /*                                                               */ 02449000
*   /*****************************************************************/ 02450000
*                                                                  0645 02451000
*   IF TESTRC=0|(TESTRC=4&REASONCD=NOCSN1)|/*                @Y30LB11*/ 02452000
*       (TESTRC=4&REASONCD=NOCSN2) THEN/*                    @Y30LB11*/ 02453000
         LTR   TESTRC,TESTRC                                       0645 02454000
         BZ    @RT00645                                            0645 02455000
         C     TESTRC,@CF00041                                     0645 02456000
         BNE   @GL00004                                            0645 02457000
         CLC   REASONCD(4),@CF01117                                0645 02458000
         BE    @RT00645                                            0645 02459000
@GL00004 C     TESTRC,@CF00041                                     0645 02460000
         BNE   @RF00645                                            0645 02461000
         CLC   REASONCD(4),@CF01119                                0645 02462000
         BNE   @RF00645                                            0645 02463000
@RT00645 DS    0H                                                  0646 02464000
*     DO;                           /*                       @Y30LB11*/ 02465000
*       DARGAREA=''B;               /*                       @Y30LB11*/ 02466000
         XC    DARGAREA(36),DARGAREA                               0647 02467000
*       DARGSMOD=REMOVRMG;          /*                       @Y30LB11*/ 02468000
         L     @05,DDSTRU                                          0648 02469000
         MVC   DARGSMOD(3,@05),@CC01134                            0648 02470000
*       DARGSENT=MSG2764I;          /*                       @Y30LB11*/ 02471000
         MVI   DARGSENT(@05),X'05'                                 0649 02472000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB11*/ 02473000
         L     @05,@PC00001                                        0650 02474000
         ST    @05,@AL00001                                        0650 02475000
         LA    @15,@CF00111                                        0650 02476000
         ST    @15,@AL00001+4                                      0650 02477000
         LA    @15,DDSTRU                                          0650 02478000
         ST    @15,@AL00001+8                                      0650 02479000
         MVI   @AL00001+8,X'80'                                    0650 02480000
         L     @15,GDTPRT(,@05)                                    0650 02481000
         LA    @01,@AL00001                                        0650 02482000
         BALR  @14,@15                                             0650 02483000
*       RMVRCOND=4;                 /*                       @Y30LB11*/ 02484000
         LA    RMVRCOND,4                                          0651 02485000
*     END;                          /*                       @Y30LB11*/ 02486000
*                                                                  0652 02487000
*   /*****************************************************************/ 02488000
*   /*                                                               */ 02489000
*   /* IF DEFINE FAILED BECAUSE OF INSUFFICIENT STORAGE, THE         */ 02490000
*   /* CONDITION CODE IS SET TO 8.                           @Y30LB11*/ 02491000
*   /*                                                               */ 02492000
*   /*****************************************************************/ 02493000
*                                                                  0653 02494000
*   ELSE                            /*                       @Y30LB11*/ 02495000
*     DO;                           /*                       @Y30LB11*/ 02496000
         B     @RC00645                                            0653 02497000
@RF00645 DS    0H                                                  0654 02498000
*       IF TESTRC=8 THEN            /*                       @Y30LB11*/ 02499000
         LA    @05,8                                               0654 02500000
         CR    TESTRC,@05                                          0654 02501000
         BNE   @RF00654                                            0654 02502000
*         RMVRCOND=8;               /*                       @Y30LB11*/ 02503000
*                                                                  0655 02504000
         LR    RMVRCOND,@05                                        0655 02505000
*       /*************************************************************/ 02506000
*       /*                                                           */ 02507000
*       /* IF THE DEFINE FAILED BECAUSE NEITHER CSN WAS FOUND, THE   */ 02508000
*       /* USSC UMACRO IS ISSUED TO INVOKE THE ICBVVIC MACRO TO      */ 02509000
*       /* REMOVE THE RECORD.                                @Y30LB11*/ 02510000
*       /*                                                           */ 02511000
*       /*************************************************************/ 02512000
*                                                                  0656 02513000
*       ELSE                        /*                       @Y30LB11*/ 02514000
*         IF REASONCD=NOCSNS THEN   /*                       @Y30LB11*/ 02515000
         B     @RC00654                                            0656 02516000
@RF00654 CLC   REASONCD(4),@CF01121                                0656 02517000
         BNE   @RF00656                                            0656 02518000
*           DO;                     /*                       @Y30LB11*/ 02519000
*                                                                  0657 02520000
*             /*******************************************************/ 02521000
*             /*                                                     */ 02522000
*             /* DUMP OF INITIALIZED PARM LIST FOR MSVC READ MACRO   */ 02523000
*             /*                                             @Y30LB11*/ 02524000
*             /*                                                     */ 02525000
*             /*******************************************************/ 02526000
*                                                                  0658 02527000
*             IF GDTDBG=NULLPTR THEN                               0658 02528000
         L     @05,@PC00001                                        0658 02529000
         L     @05,GDTDBG(,@05)                                    0658 02530000
         LTR   @05,@05                                             0658 02531000
         BZ    @RT00658                                            0658 02532000
*               ;                                                  0659 02533000
*             ELSE                                                 0660 02534000
*               DO;                                                0660 02535000
*                 DMPINDEX=ADDR(DUMPAREA);/*                 @Y30LB11*/ 02536000
         LA    DMPINDEX,DUMPAREA                                   0661 02537000
*                 DMPITMNM='RVVI';                                 0662 02538000
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0662 02539000
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0662 02540000
         MVC   DMPITMNM(4,DMPINDEX),@CC01158                       0662 02541000
*                 DMPITMPT=ADDR(RVVI);                             0663 02542000
         L     @05,RVVIPTR                                         0663 02543000
         ST    @05,DMPITMPT(,DMPINDEX)                             0663 02544000
*                 DMPITMLN=LENGTH(RVVI);                           0664 02545000
         MVC   DMPITMLN(2,DMPINDEX),@CH01212                       0664 02546000
*                 DMPITMTP='H';                                    0665 02547000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0665 02548000
*                 DMPINDEX=DMPINDEX+DMPELEMT;                      0666 02549000
*                                                                  0666 02550000
         AL    DMPINDEX,@CF00464                                   0666 02551000
*                 /***************************************************/ 02552000
*                 /*                                                 */ 02553000
*                 /*                                         @Y30LB11*/ 02554000
*                 /*                                                 */ 02555000
*                 /***************************************************/ 02556000
*                                                                  0667 02557000
*                 DMPTRM=DMPTRMVL;                                 0667 02558000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0667 02559000
*               END;                /*                       @Y30LB11*/ 02560000
*             IF GDTDBG=NULLPTR THEN                               0669 02561000
@RT00658 L     @05,@PC00001                                        0669 02562000
         L     @05,GDTDBG(,@05)                                    0669 02563000
         LTR   @05,@05                                             0669 02564000
         BZ    @RT00669                                            0669 02565000
*               ;                                                  0670 02566000
*             ELSE                                                 0671 02567000
*               CALL IDCDB010(GDTTBL,'RRRE',ADDR(DUMPAREA));/*     0671 02568000
*                                                            @Y30LB11*/ 02569000
         L     @05,@PC00001                                        0671 02570000
         ST    @05,@AL00001                                        0671 02571000
         LA    @15,@CC01210                                        0671 02572000
         ST    @15,@AL00001+4                                      0671 02573000
         LA    @15,DUMPAREA                                        0671 02574000
         ST    @15,@AFTEMPS+16                                     0671 02575000
         LA    @15,@AFTEMPS+16                                     0671 02576000
         ST    @15,@AL00001+8                                      0671 02577000
         MVI   @AL00001+8,X'80'                                    0671 02578000
         L     @15,GDTDBG(,@05)                                    0671 02579000
         LA    @01,@AL00001                                        0671 02580000
         BALR  @14,@15                                             0671 02581000
*                                                                  0672 02582000
*             /*******************************************************/ 02583000
*             /*                                                     */ 02584000
*             /* ISSUE THE USSC UMACRO IS ISSUED TO INVOKE THE       */ 02585000
*             /* ICBVVIC MACRO TO REMOVE THE RECORD.         @Y30LB11*/ 02586000
*             /*                                                     */ 02587000
*             /*******************************************************/ 02588000
*                                                                  0672 02589000
*             CALL IDCSASS0(GDTTBL,VVIC,RVRPTR,REASONCD);/*  @Y30LB11*/ 02590000
@RT00669 L     @05,@PC00001                                        0672 02591000
         ST    @05,@AL00001                                        0672 02592000
         LA    @02,VVIC                                            0672 02593000
         ST    @02,@AL00001+4                                      0672 02594000
         LA    @02,RVRPTR                                          0672 02595000
         ST    @02,@AL00001+8                                      0672 02596000
         LA    @02,REASONCD                                        0672 02597000
         ST    @02,@AL00001+12                                     0672 02598000
         MVI   @AL00001+12,X'80'                                   0672 02599000
         L     @15,GDTSSC(,@05)                                    0672 02600000
         LA    @01,@AL00001                                        0672 02601000
         BALR  @14,@15                                             0672 02602000
*             RESPECIFY                                            0673 02603000
*               RTNREG RSTD;                                       0673 02604000
*             TESTRC=RTNREG;                                       0674 02605000
         LR    TESTRC,RTNREG                                       0674 02606000
*             RESPECIFY                                            0675 02607000
*               RTNREG UNRSTD;      /*                       @Y30LB11*/ 02608000
*                                                                  0675 02609000
*             /*******************************************************/ 02610000
*             /*                                                     */ 02611000
*             /* IF THE REMOVAL WAS UNSUCCESSFUL, SSCMSG IS INVOKED  */ 02612000
*             /* EXPLAINING THE REASON FOR THE FAILURE AND THE RETURN*/ 02613000
*             /* CODE IS SET TO 4.                           @Y30LB11*/ 02614000
*             /*                                                     */ 02615000
*             /*******************************************************/ 02616000
*                                                                  0676 02617000
*             IF TESTRC=4 THEN                                     0676 02618000
         C     TESTRC,@CF00041                                     0676 02619000
         BNE   @RF00676                                            0676 02620000
*               DO;                 /*                       @Y30LB11*/ 02621000
*                 CALL SSCMSG(REASONCD);/*                   @Y30LB11*/ 02622000
         LA    @02,REASONCD                                        0678 02623000
         ST    @02,@AL00001                                        0678 02624000
         LA    @01,@AL00001                                        0678 02625000
         BAL   @14,SSCMSG                                          0678 02626000
*                 RMVRCOND=4;       /*                       @Y30LB11*/ 02627000
         LA    RMVRCOND,4                                          0679 02628000
*               END;                /*                       @Y30LB11*/ 02629000
*                                                                  0680 02630000
*             /*******************************************************/ 02631000
*             /*                                                     */ 02632000
*             /* IF THE REMOVAL WAS SUCCESSFUL BUT THERE WAS AN I/O  */ 02633000
*             /* ERROR UPDATING A RECORD IN THE INVENTORY, SET THE   */ 02634000
*             /* WARNING FLAG ON.                            @Y30LB11*/ 02635000
*             /*                                                     */ 02636000
*             /*******************************************************/ 02637000
*                                                                  0681 02638000
*             IF TESTRC=12 THEN                                    0681 02639000
@RF00676 C     TESTRC,@CF00035                                     0681 02640000
         BNE   @RF00681                                            0681 02641000
*               WARNFLG=ON;         /*                       @Y30LB11*/ 02642000
         OI    WARNFLG,B'10000000'                                 0682 02643000
*           END;                    /*                       @Y30LB11*/ 02644000
*                                                                  0683 02645000
*       /*************************************************************/ 02646000
*       /*                                                           */ 02647000
*       /* IF DEFINE FAILED BECAUSE OF AN UNEXPECTED ERROR, SSCMSG IS*/ 02648000
*       /* INVOKED TO WRITE A MESSAGE EXPLAINING THE REASON FOR THE  */ 02649000
*       /* FAILURE AND THE RETURN CODE IS SET TO 4.          @Y30LB11*/ 02650000
*       /*                                                           */ 02651000
*       /*************************************************************/ 02652000
*                                                                  0684 02653000
*         ELSE                                                     0684 02654000
*           DO;                     /*                       @Y30LB11*/ 02655000
         B     @RC00656                                            0684 02656000
@RF00656 DS    0H                                                  0685 02657000
*             CALL SSCMSG(REASONCD);/*                       @Y30LB11*/ 02658000
         LA    @15,REASONCD                                        0685 02659000
         ST    @15,@AL00001                                        0685 02660000
         LA    @01,@AL00001                                        0685 02661000
         BAL   @14,SSCMSG                                          0685 02662000
*             RMVRCOND=4;           /*                       @Y30LB11*/ 02663000
         LA    RMVRCOND,4                                          0686 02664000
*           END;                    /*                       @Y30LB11*/ 02665000
*     END;                          /*                       @Y30LB11*/ 02666000
*                                                                  0688 02667000
@RC00656 DS    0H                                                  0688 02668000
@RC00654 DS    0H                                                  0689 02669000
*   /*****************************************************************/ 02670000
*   /*                                                               */ 02671000
*   /* RETURN TO CALLER                                      @Y30LB11*/ 02672000
*   /*                                                               */ 02673000
*   /*****************************************************************/ 02674000
*                                                                  0689 02675000
*   RETURN CODE(RMVRCOND);          /*                       @Y30LB11*/ 02676000
@RC00645 LR    @15,RMVRCOND                                        0689 02677000
         L     @14,@SA00007                                        0689 02678000
         LM    @00,@12,@SA00007+8                                  0689 02679000
         BR    @14                                                 0689 02680000
*   END REMOVRCD;                   /*                       @Y30LB11*/ 02681000
*   END IDCRR01                     /*                       @Y30LB11*/ 02682000
*                                                                  0691 02683000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02684000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 02685000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 02686000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 02687000
*/*%INCLUDE SYSLIB  (IDCCSRR )                                       */ 02688000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 02689000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 02690000
*/*%INCLUDE SYSLIB  (IEZCOPYV)                                       */ 02691000
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */ 02692000
*/*%INCLUDE SYSLIB  (IEZRVR  )                                       */ 02693000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 02694000
*                                                                  0691 02695000
*       ;                                                          0691 02696000
@DATA    DS    0H                                                       02697000
@CH00147 DC    H'2'                                                     02698000
@CH00150 DC    H'6'                                                     02699000
@CH00173 DC    H'8'                                                     02700000
@CH01212 DC    H'68'                                                    02701000
@CH01214 DC    H'120'                                                   02702000
@CH01211 DC    H'164'                                                   02703000
@CH01213 DC    H'224'                                                   02704000
@DATD    DSECT                                                          02705000
         DS    0F                                                       02706000
@SA00001 DS    18F                                                      02707000
@PC00001 DS    3F                                                       02708000
@SA00005 DS    15F                                                      02709000
@SA00003 DS    15F                                                      02710000
@SA00002 DS    15F                                                      02711000
@SA00007 DS    15F                                                      02712000
@SA00006 DS    15F                                                      02713000
@PC00006 DS    2F                                                       02714000
@SA00004 DS    15F                                                      02715000
@AL00001 DS    5A                                                       02716000
@AFTEMPS DS    5F                                                       02717000
IDCRR01  CSECT                                                          02718000
         DS    0F                                                       02719000
@CF00111 DC    F'0'                                                     02720000
@CF00213 DC    F'1'                                                     02721000
@CH00213 EQU   @CF00213+2                                               02722000
@CF00041 DC    F'4'                                                     02723000
@CH00041 EQU   @CF00041+2                                               02724000
@CF00035 DC    F'12'                                                    02725000
@CH00035 EQU   @CF00035+2                                               02726000
@CF00464 DC    F'16'                                                    02727000
@CF01115 DC    XL4'0208'                                                02728000
@CF01117 DC    XL4'26'                                                  02729000
@CF01119 DC    XL4'2A'                                                  02730000
@CF01121 DC    XL4'23'                                                  02731000
@DATD    DSECT                                                          02732000
         DS    0D                                                       02733000
LISTSCAN DS    A                                                        02734000
IOCSPTR  DS    A                                                        02735000
OPNPTR   DS    A                                                        02736000
DDSTRU   DS    A                                                        02737000
FSADDR   DS    A                                                        02738000
CCMSGPTR DS    A                                                        02739000
CMMSGPTR DS    A                                                        02740000
CTMSGPTR DS    A                                                        02741000
RVVIPTR  DS    A                                                        02742000
RVRPTR   DS    A                                                        02743000
DEFLPTR  DS    A                                                        02744000
REASONCD DS    F                                                        02745000
SEQNUM   DS    F                                                        02746000
SSDLPTR  DS    A                                                        02747000
LISTPTR  DS    A                                                        02748000
ECBCODE  DS    FL1                                                      02749000
LISTLN   DS    FL1                                                      02750000
         DS    0D                                                       02751000
@TS00001 DS    CL95                                                     02752000
BASEAREA DS    CL224                                                    02753000
COPYAREA DS    CL164                                                    02754000
DARGAREA DS    CL36                                                     02755000
DEFAREA  DS    CL132                                                    02756000
DUMPAREA DS    CL17                                                     02757000
RMVDFLG  DS    BL1                                                      02758000
RVRAREA  DS    CL24                                                     02759000
RVVIAREA DS    CL68                                                     02760000
WARNFLG  DS    BL1                                                      02761000
SSDRGLT  DS    CL20                                                     02762000
         DS    CL2                                                      02763000
SSINXLST DS    CL120                                                    02764000
         ORG   SSINXLST                                                 02765000
SSARRAY  DS    60H                                                      02766000
         ORG   SSINXLST+120                                             02767000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02768000
@ENDDATD EQU   *                                                        02769000
IDCRR01  CSECT                                                          02770000
         DS    0F                                                       02771000
@SIZDATD DC    AL1(0)                                                   02772000
         DC    AL3(@ENDDATD-@DATD)                                      02773000
         DS    0D                                                       02774000
RVVLEN   DC    AL2(68)                                                  02775000
RVRLEN   DC    AL2(24)                                                  02776000
SSMSGNUM DC    AL1(56)                                                  02777000
@CC01145 DC    C'RRRM'                                                  02778000
@CC01146 DC    C'RRRR'                                                  02779000
@CC01151 DC    C'RRRC'                                                  02780000
@CC01157 DC    C'RRAP'                                                  02781000
@CC01158 DC    C'RVVI'                                                  02782000
@CC01160 DC    C'RRRA'                                                  02783000
@CC01167 DC    C'RRBA'                                                  02784000
@CC01168 DC    C'RRRB'                                                  02785000
@CC01174 DC    C'RRBP'                                                  02786000
@CC01175 DC    C'RRRV'                                                  02787000
@CC01180 DC    C'RRCP'                                                  02788000
@CC01182 DC    C'RRCR'                                                  02789000
@CC01203 DC    C'SSAA'                                                  02790000
@CC01208 DC    C'RRDV'                                                  02791000
@CC01209 DC    C'RRDL'                                                  02792000
@CC01210 DC    C'RRRE'                                                  02793000
@CC01113 DC    C'CM0'                                                   02794000
@CC01134 DC    C'RR0'                                                   02795000
@CC01139 DC    C'UV0'                                                   02796000
ALL      DC    CL3'ALL'                                                 02797000
FORMAT   DC    CL4'FORM'                                                02798000
HSECOND  DC    CL4'HSEC'                                                02799000
CLOCK    DC    CL4'KLOK'                                                02800000
SETZERO  DC    CL4'ZERO'                                                02801000
SETBLANK DC    CL4'BLNK'                                                02802000
NOSET    DC    CL4'NSET'                                                02803000
OVERRIDE DC    CL4'OVRD'                                                02804000
ACQUIRE  DC    CL8'ACQUIRE '                                            02805000
RELINQ   DC    CL8'RELINQ  '                                            02806000
MOUNT    DC    CL8'MOUNT   '                                            02807000
DEMOUNT  DC    CL8'DEMOUNT '                                            02808000
DEFINE   DC    CL8'DEFINE  '                                            02809000
MOVE     DC    CL8'MOVE    '                                            02810000
TRACEQ   DC    CL8'TRACEQ  '                                            02811000
COPYTABL DC    CL8'COPYTABL'                                            02812000
COPYCRTG DC    CL8'COPYCRTG'                                            02813000
COPYVOL  DC    CL8'COPYVOL '                                            02814000
VVIC     DC    CL8'VVIC    '                                            02815000
TUNE     DC    CL8'TUNE    '                                            02816000
NAMES    DC    CL4'NAME'                                                02817000
UNIT     DC    CL4'UNIT'                                                02818000
SHR      DC    CL4'SHR '                                                02819000
EXCL     DC    CL4'EXCL'                                                02820000
NOWAIT   DC    CL4'NWAI'                                                02821000
WAIT     DC    CL4'WAIT'                                                02822000
SECCHECK DC    CL8'SECCHECK'                                            02823000
SCRVTOC  DC    CL8'SCRVTOC '                                            02824000
GETVTOC  DC    CL8'GETVTOC '                                            02825000
PUTVTOC  DC    CL8'PUTVTOC '                                            02826000
RECATLG  DC    CL8'RECATLG '                                            02827000
INITVOL  DC    CL8'INITVOL '                                            02828000
CHECK    DC    CL8'CHECK   '                                            02829000
POSTUCB  DC    CL8'POSTUCB '                                            02830000
GET      DC    CL8'GET     '                                            02831000
PUT      DC    CL8'PUT     '                                            02832000
CLOSE    DC    CL8'CLOSE   '                                            02833000
OPEN     DC    CL8'OPEN    '                                            02834000
PUTLABEL DC    CL8'PUTLABEL'                                            02835000
GETLABEL DC    CL8'GETLABEL'                                            02836000
CANCEL   DC    CL8'CANCEL  '                                            02837000
SET      DC    CL8'SET     '                                            02838000
SELECTX  DC    CL8'SELECTX '                                            02839000
CHANGEX  DC    CL8'CHANGEX '                                            02840000
MODID    DC    CL4'RR01'                                                02841000
FIXAREA  DS    CL250                                                    02842000
         ORG   FIXAREA                                                  02843000
@NM00085 DC    250X'00'                                                 02844000
         ORG   FIXAREA+250                                              02845000
SSMODSS0 DC    CL3'SS0'                                                 02846000
SSMODCM0 DC    CL3'CM0'                                                 02847000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02848000
@01      EQU   01                                                       02849000
@02      EQU   02                                                       02850000
@03      EQU   03                                                       02851000
@04      EQU   04                                                       02852000
@05      EQU   05                                                       02853000
@06      EQU   06                                                       02854000
@07      EQU   07                                                       02855000
@08      EQU   08                                                       02856000
@09      EQU   09                                                       02857000
@10      EQU   10                                                       02858000
@11      EQU   11                                                       02859000
@12      EQU   12                                                       02860000
@13      EQU   13                                                       02861000
@14      EQU   14                                                       02862000
@15      EQU   15                                                       02863000
RMVRCOND EQU   @04                                                      02864000
ENTRYNUM EQU   @02                                                      02865000
COPYCOND EQU   @04                                                      02866000
BPROCOND EQU   @04                                                      02867000
BASECOND EQU   @04                                                      02868000
ALLCOND  EQU   @04                                                      02869000
COPYVPTR EQU   @05                                                      02870000
BASEVPTR EQU   @06                                                      02871000
DMPINDEX EQU   @02                                                      02872000
TESTRC   EQU   @03                                                      02873000
SETRC    EQU   @04                                                      02874000
RTNREG   EQU   @15                                                      02875000
DEFVR1   EQU   @01                                                      02876000
REG0     EQU   @00                                                      02877000
REG1     EQU   @01                                                      02878000
REG10    EQU   @10                                                      02879000
REG11    EQU   @11                                                      02880000
REG12    EQU   @12                                                      02881000
REG13    EQU   @13                                                      02882000
REG14    EQU   @14                                                      02883000
REG15    EQU   @15                                                      02884000
REG2     EQU   @02                                                      02885000
REG3     EQU   @03                                                      02886000
REG4     EQU   @04                                                      02887000
REG5     EQU   @05                                                      02888000
REG6     EQU   @06                                                      02889000
REG7     EQU   @07                                                      02890000
REG8     EQU   @08                                                      02891000
REG9     EQU   @09                                                      02892000
IDCSAEP0 EQU   0                                                        02893000
IDCSASS0 EQU   0                                                        02894000
TRACE1   EQU   0                                                        02895000
OLDERID1 EQU   TRACE1                                                   02896000
TRACE2   EQU   0                                                        02897000
OLDERID2 EQU   TRACE2                                                   02898000
NEWID2   EQU   TRACE2+95                                                02899000
NEWERID2 EQU   5                                                        02900000
CIRAGL   EQU   0                                                        02901000
CIRTYPE  EQU   CIRAGL                                                   02902000
ALLAGL   EQU   0                                                        02903000
ALLSTS   EQU   ALLAGL+24                                                02904000
ALLDSP   EQU   ALLAGL+25                                                02905000
ALLORG   EQU   ALLAGL+26                                                02906000
ALLOPT   EQU   ALLAGL+28                                                02907000
UNITABL  EQU   0                                                        02908000
UNITADR  EQU   UNITABL+4                                                02909000
@NM00010 EQU   UNITADR                                                  02910000
UNITSTAT EQU   UNITABL+6                                                02911000
IOCSTR   EQU   0                                                        02912000
IOCDSO   EQU   IOCSTR+16                                                02913000
IOCRFM   EQU   IOCSTR+17                                                02914000
IOCMAC   EQU   IOCSTR+18                                                02915000
IOCMAC2  EQU   IOCSTR+19                                                02916000
IOCCHP   EQU   IOCSTR+20                                                02917000
IOCMSG   EQU   IOCSTR+21                                                02918000
IOCRBA   EQU   IOCSTR+40                                                02919000
IOCTTR   EQU   IOCRBA                                                   02920000
IOCMEM   EQU   IOCSTR+44                                                02921000
IOCNWM   EQU   IOCSTR+48                                                02922000
OPNAGL   EQU   0                                                        02923000
OPNOPT   EQU   OPNAGL                                                   02924000
OPNRFM   EQU   OPNAGL+1                                                 02925000
OPNTYP   EQU   OPNAGL+2                                                 02926000
OPNMOD   EQU   OPNAGL+3                                                 02927000
OPNDEV   EQU   OPNAGL+24                                                02928000
OPNDSO   EQU   OPNAGL+41                                                02929000
OPNOPT2  EQU   OPNAGL+42                                                02930000
IOINFOPT EQU   0                                                        02931000
UVOLLIST EQU   0                                                        02932000
UVOLENT  EQU   UVOLLIST+2                                               02933000
AMSTP011 EQU   0                                                        02934000
DARGLIST EQU   0                                                        02935000
DARGDBP  EQU   DARGLIST                                                 02936000
DARGRETP EQU   DARGLIST+4                                               02937000
DARGSTID EQU   DARGLIST+8                                               02938000
DARGSMOD EQU   DARGSTID                                                 02939000
DARGSENT EQU   DARGSTID+3                                               02940000
DARGILP  EQU   DARGLIST+12                                              02941000
DARGCNT  EQU   DARGLIST+14                                              02942000
DARGRETL EQU   DARGLIST+16                                              02943000
DARGARY  EQU   DARGLIST+20                                              02944000
DARGINS  EQU   DARGARY                                                  02945000
DARGINL  EQU   DARGARY+2                                                02946000
DARGDTM  EQU   DARGARY+4                                                02947000
FMTLIST  EQU   0                                                        02948000
FMTFLGS  EQU   FMTLIST                                                  02949000
FMTSPF   EQU   FMTLIST+2                                                02950000
FMTRFNO  EQU   FMTSPF                                                   02951000
FMTILEN  EQU   FMTRFNO                                                  02952000
FMTIOFF  EQU   FMTLIST+4                                                02953000
FMTTRBC  EQU   FMTIOFF                                                  02954000
FMTSTO   EQU   FMTTRBC                                                  02955000
FMTOCOL  EQU   FMTLIST+6                                                02956000
FMTCNVF  EQU   FMTLIST+10                                               02957000
IDCDB010 EQU   0                                                        02958000
DMPITM   EQU   0                                                        02959000
DMPITMNM EQU   DMPITM                                                   02960000
DMPITMPT EQU   DMPITM+8                                                 02961000
DMPITMLN EQU   DMPITM+12                                                02962000
DMPITMTP EQU   DMPITM+14                                                02963000
DMPARY   EQU   0                                                        02964000
DMPTRM   EQU   0                                                        02965000
VOL      EQU   0                                                        02966000
VOLVAL   EQU   VOL+1                                                    02967000
ALLC     EQU   0                                                        02968000
CDATE    EQU   0                                                        02969000
DATE     EQU   0                                                        02970000
DATEVAL  EQU   DATE                                                     02971000
SEQ      EQU   0                                                        02972000
SEQVAL   EQU   SEQ                                                      02973000
CCMSG    EQU   0                                                        02974000
CMMSG    EQU   0                                                        02975000
CMVOLFLG EQU   CMMSG+6                                                  02976000
CTMSG    EQU   0                                                        02977000
CTARRAY  EQU   CTMSG+4                                                  02978000
MDAGL    EQU   0                                                        02979000
MDFLAGS  EQU   MDAGL+30                                                 02980000
PUAGL    EQU   0                                                        02981000
CKAGL    EQU   0                                                        02982000
CKFLAGS  EQU   CKAGL+28                                                 02983000
EXCLAGL  EQU   0                                                        02984000
EXCLFLAG EQU   EXCLAGL+22                                               02985000
EXOARG   EQU   0                                                        02986000
EXOPT    EQU   EXOARG+32                                                02987000
EXFLG    EQU   EXOARG+33                                                02988000
EXGARG   EQU   0                                                        02989000
EXPARG   EQU   0                                                        02990000
EXPDATA  EQU   EXPARG+12                                                02991000
EXPDATAB EQU   0                                                        02992000
EXPARRAY EQU   EXPDATAB+4                                               02993000
VS2AGL   EQU   0                                                        02994000
VSLABOPT EQU   VS2AGL+28                                                02995000
VS2MSG   EQU   VS2AGL+35                                                02996000
VS2RESOP EQU   VS2AGL+36                                                02997000
VS1AGL   EQU   0                                                        02998000
VSSECOPT EQU   VS1AGL+68                                                02999000
VSVTOPT  EQU   VS1AGL+69                                                03000000
VSCATOPT EQU   VS1AGL+70                                                03001000
VSRETURN EQU   VS1AGL+71                                                03002000
VSMSG    EQU   VS1AGL+72                                                03003000
VSRESOPT EQU   VS1AGL+73                                                03004000
RCTAGL   EQU   0                                                        03005000
RCTOPT   EQU   RCTAGL+8                                                 03006000
STAEPARM EQU   0                                                        03007000
STARCVY  EQU   STAEPARM+52                                              03008000
STARETRY EQU   STAEPARM+53                                              03009000
VOLLABEL EQU   0                                                        03010000
SV82LIST EQU   0                                                        03011000
@NM00057 EQU   SV82LIST+4                                               03012000
SV82DCBP EQU   @NM00057                                                 03013000
@NM00058 EQU   SV82LIST+12                                              03014000
SV82WRKP EQU   @NM00058                                                 03015000
BASEV    EQU   0                                                        03016000
BASNAME  EQU   BASEV                                                    03017000
BASID    EQU   BASNAME+11                                               03018000
BASFLAGA EQU   BASEV+14                                                 03019000
BASTYPE  EQU   BASFLAGA                                                 03020000
BASREASS EQU   BASFLAGA+3                                               03021000
BASRCVYF EQU   BASEV+20                                                 03022000
BASSATIA EQU   BASRCVYF                                                 03023000
BASMISCF EQU   BASRCVYF+2                                               03024000
BASCSN1  EQU   BASEV+24                                                 03025000
BASLIB1  EQU   BASEV+36                                                 03026000
BASLID1  EQU   BASLIB1                                                  03027000
BASLIB2  EQU   BASEV+49                                                 03028000
BASLID2  EQU   BASLIB2                                                  03029000
BASKLCPY EQU   BASEV+76                                                 03030000
BASCOPID EQU   BASKLCPY+11                                              03031000
COPYV    EQU   0                                                        03032000
COPNAME  EQU   COPYV                                                    03033000
COPID    EQU   COPNAME+11                                               03034000
COPNO    EQU   COPID+1                                                  03035000
COPFLAGA EQU   COPYV+14                                                 03036000
COPTYPE  EQU   COPFLAGA                                                 03037000
COPRCVYF EQU   COPYV+20                                                 03038000
COPSATIA EQU   COPRCVYF                                                 03039000
COPMISCF EQU   COPRCVYF+2                                               03040000
COPCSN1  EQU   COPYV+24                                                 03041000
COPLIB1  EQU   COPYV+36                                                 03042000
COPLID1  EQU   COPLIB1                                                  03043000
COPLIB2  EQU   COPYV+49                                                 03044000
COPLID2  EQU   COPLIB2                                                  03045000
COPDATE  EQU   COPYV+50                                                 03046000
RVVI     EQU   0                                                        03047000
RVVLNGTH EQU   RVVI                                                     03048000
RVVOPCOD EQU   RVVI+4                                                   03049000
RVVCODE  EQU   RVVOPCOD                                                 03050000
RVVOLUME EQU   RVVI+8                                                   03051000
RVVBUFLN EQU   RVVI+30                                                  03052000
RVVRTBUF EQU   RVVI+32                                                  03053000
RVVCDATE EQU   RVVI+38                                                  03054000
RVVRDSEQ EQU   RVVI+43                                                  03055000
RVVCPYID EQU   RVVI+56                                                  03056000
RVVFLAGA EQU   RVVI+58                                                  03057000
RVVRMODE EQU   RVVFLAGA                                                 03058000
RVVRDR   EQU   RVVRMODE                                                 03059000
RVVRDNR  EQU   RVVRMODE                                                 03060000
RVVCHAIN EQU   RVVFLAGA+1                                               03061000
RVVRDRCD EQU   RVVFLAGA+2                                               03062000
RVVBVRCD EQU   RVVRDRCD                                                 03063000
RVVCPYRC EQU   RVVRDRCD                                                 03064000
RVVRTEST EQU   RVVFLAGA+3                                               03065000
RVVCPYTP EQU   RVVFLAGA+4                                               03066000
RVVSPEC  EQU   RVVFLAGA+5                                               03067000
RVVSDTE  EQU   RVVSPEC                                                  03068000
RVVSSEQ  EQU   RVVSPEC                                                  03069000
RVVSCPY  EQU   RVVSPEC                                                  03070000
RVVSVOL  EQU   RVVSPEC                                                  03071000
RVR      EQU   0                                                        03072000
RVRLNGTH EQU   RVR                                                      03073000
RVRCODE  EQU   RVR+4                                                    03074000
RVRVOLID EQU   RVR+8                                                    03075000
RVRCPYID EQU   RVR+15                                                   03076000
RVRFLAGA EQU   RVR+16                                                   03077000
RVRBASEV EQU   RVRFLAGA                                                 03078000
RVRCOPYV EQU   RVRFLAGA                                                 03079000
DEFLIST  EQU   0                                                        03080000
DEFVFLG  EQU   DEFLIST+6                                                03081000
DEFVRNTR EQU   DEFVFLG                                                  03082000
DEFVLIB  EQU   DEFLIST+7                                                03083000
DEFVOLD  EQU   DEFLIST+8                                                03084000
DEFVVFLG EQU   DEFLIST+14                                               03085000
DEFVNVOL EQU   DEFLIST+16                                               03086000
DEFVCSN1 EQU   DEFLIST+24                                               03087000
DEFVDATA EQU   DEFLIST+56                                               03088000
AMSTP041 EQU   0                                                        03089000
AMSTP042 EQU   0                                                        03090000
AMSTP043 EQU   0                                                        03091000
AMSTP044 EQU   0                                                        03092000
IDCIOCL0 EQU   0                                                        03093000
IDCIOCO0 EQU   0                                                        03094000
IDCIOGT0 EQU   0                                                        03095000
IDCIOIT0 EQU   0                                                        03096000
IDCIOOP0 EQU   0                                                        03097000
IDCIOPO0 EQU   0                                                        03098000
IDCIOPT0 EQU   0                                                        03099000
IDCIOSI0 EQU   0                                                        03100000
IDCIOST0 EQU   0                                                        03101000
IDCIOTM0 EQU   0                                                        03102000
IDCIOVY0 EQU   0                                                        03103000
IDCIO050 EQU   0                                                        03104000
IDCSAAL0 EQU   0                                                        03105000
IDCSACA0 EQU   0                                                        03106000
IDCSACL0 EQU   0                                                        03107000
IDCSACR0 EQU   0                                                        03108000
IDCSADE0 EQU   0                                                        03109000
IDCSADL0 EQU   0                                                        03110000
IDCSADQ0 EQU   0                                                        03111000
IDCSAFP0 EQU   0                                                        03112000
IDCSAFS0 EQU   0                                                        03113000
IDCSAGP0 EQU   0                                                        03114000
IDCSAGS0 EQU   0                                                        03115000
IDCSAID0 EQU   0                                                        03116000
IDCSALD0 EQU   0                                                        03117000
IDCSALK0 EQU   0                                                        03118000
IDCSANQ0 EQU   0                                                        03119000
IDCSAPR0 EQU   0                                                        03120000
IDCSAPT0 EQU   0                                                        03121000
IDCSAQL0 EQU   0                                                        03122000
IDCSARC0 EQU   0                                                        03123000
IDCSARV0 EQU   0                                                        03124000
IDCSASC0 EQU   0                                                        03125000
IDCSASI0 EQU   0                                                        03126000
IDCSASN0 EQU   0                                                        03127000
IDCSAST0 EQU   0                                                        03128000
IDCSATI0 EQU   0                                                        03129000
IDCSAWO0 EQU   0                                                        03130000
IDCSA060 EQU   0                                                        03131000
IDCST010 EQU   0                                                        03132000
LISTTEST EQU   0                                                        03133000
NEWERID1 EQU   5                                                        03134000
GDTTBL   EQU   0                                                        03135000
GDTTR1   EQU   GDTTBL+8                                                 03136000
GDTTR2   EQU   GDTTBL+12                                                03137000
GDTDBG   EQU   GDTTBL+40                                                03138000
GDTSTC   EQU   GDTTBL+44                                                03139000
GDTPRT   EQU   GDTTBL+48                                                03140000
GDTESS   EQU   GDTTBL+52                                                03141000
GDTESA   EQU   GDTTBL+56                                                03142000
GDTRST   EQU   GDTTBL+60                                                03143000
GDTRES   EQU   GDTTBL+64                                                03144000
GDTCAL   EQU   GDTTBL+68                                                03145000
GDTGSP   EQU   GDTTBL+72                                                03146000
GDTFSP   EQU   GDTTBL+76                                                03147000
GDTGPL   EQU   GDTTBL+80                                                03148000
GDTFPL   EQU   GDTTBL+84                                                03149000
GDTLOD   EQU   GDTTBL+88                                                03150000
GDTDEL   EQU   GDTTBL+92                                                03151000
GDTPRL   EQU   GDTTBL+96                                                03152000
GDTEPL   EQU   GDTTBL+100                                               03153000
GDTTIM   EQU   GDTTBL+104                                               03154000
GDTIIO   EQU   GDTTBL+108                                               03155000
GDTTIO   EQU   GDTTBL+112                                               03156000
GDTOPN   EQU   GDTTBL+124                                               03157000
GDTCLS   EQU   GDTTBL+128                                               03158000
GDTGET   EQU   GDTTBL+132                                               03159000
GDTPUT   EQU   GDTTBL+136                                               03160000
GDTPOS   EQU   GDTTBL+140                                               03161000
GDTCPY   EQU   GDTTBL+144                                               03162000
GDTCAT   EQU   GDTTBL+148                                               03163000
GDTSNP   EQU   GDTTBL+164                                               03164000
GDTVFY   EQU   GDTTBL+172                                               03165000
GDTUID   EQU   GDTTBL+192                                               03166000
GDTPMT   EQU   GDTTBL+196                                               03167000
GDTCIR   EQU   GDTTBL+200                                               03168000
GDTLNK   EQU   GDTTBL+204                                               03169000
GDTALC   EQU   GDTTBL+208                                               03170000
GDTDLC   EQU   GDTTBL+212                                               03171000
GDTQAL   EQU   GDTTBL+216                                               03172000
GDTSTW   EQU   GDTTBL+220                                               03173000
GDTSSC   EQU   GDTTBL+224                                               03174000
GDTENQ   EQU   GDTTBL+228                                               03175000
GDTRSV   EQU   GDTTBL+232                                               03176000
GDTDEQ   EQU   GDTTBL+236                                               03177000
GDTSFO   EQU   GDTTBL+240                                               03178000
GDTWTO   EQU   GDTTBL+244                                               03179000
GDTSCR   EQU   GDTTBL+248                                               03180000
GDTUNT   EQU   GDTTBL+252                                               03181000
GDTRCT   EQU   GDTTBL+256                                               03182000
GDTIFO   EQU   GDTTBL+260                                               03183000
GDTEXP   EQU   GDTTBL+264                                               03184000
GDTSTA   EQU   GDTTBL+268                                               03185000
FDTTBL   EQU   0                                                        03186000
FDTPTR   EQU   FDTTBL+8                                                 03187000
LASTCOND EQU   0                                                        03188000
SSRCODE  EQU   0                                                        03189000
SSRHALF  EQU   SSRCODE+2                                                03190000
SSECBCD  EQU   0                                                        03191000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03192000
@NM00086 EQU   SSRCODE                                                  03193000
FDTVERB  EQU   FDTTBL                                                   03194000
GDTECT   EQU   GDTTBL+188                                               03195000
GDTPSB   EQU   GDTTBL+184                                               03196000
GDTUPT   EQU   GDTTBL+180                                               03197000
GDTCMB   EQU   GDTTBL+176                                               03198000
GDTSPR   EQU   GDTTBL+168                                               03199000
@NM00001 EQU   GDTTBL+160                                               03200000
GDTABH   EQU   GDTTBL+156                                               03201000
GDTABT   EQU   GDTTBL+152                                               03202000
GDTTOH   EQU   GDTTBL+120                                               03203000
GDTRIP   EQU   GDTTBL+116                                               03204000
GDTIOH   EQU   GDTTBL+36                                                03205000
GDTSAH   EQU   GDTTBL+32                                                03206000
GDTTPH   EQU   GDTTBL+28                                                03207000
GDTRIH   EQU   GDTTBL+24                                                03208000
GDTSTH   EQU   GDTTBL+20                                                03209000
GDTDBH   EQU   GDTTBL+16                                                03210000
GDTPRM   EQU   GDTTBL+4                                                 03211000
GDTHDR   EQU   GDTTBL                                                   03212000
DEFVVEXT EQU   DEFLIST+128                                              03213000
DEFTLAB  EQU   DEFVDATA+71                                              03214000
DEFR60   EQU   DEFVDATA+43                                              03215000
DEFOWNID EQU   DEFVDATA+29                                              03216000
DEFR55   EQU   DEFVDATA+3                                               03217000
DEFACSEC EQU   DEFVDATA+2                                               03218000
DEFR50   EQU   DEFVDATA                                                 03219000
DEFVECB  EQU   DEFLIST+52                                               03220000
DEFVASID EQU   DEFLIST+50                                               03221000
@NM00084 EQU   DEFLIST+48                                               03222000
DEFVCSN2 EQU   DEFLIST+36                                               03223000
@NM00083 EQU   DEFLIST+22                                               03224000
@NM00082 EQU   DEFLIST+15                                               03225000
@NM00081 EQU   DEFVVFLG                                                 03226000
DEFVWINH EQU   DEFVVFLG                                                 03227000
DEFVBIND EQU   DEFVVFLG                                                 03228000
@NM00080 EQU   DEFVVFLG                                                 03229000
DEFVEXCL EQU   DEFVVFLG                                                 03230000
DEFVSEC  EQU   DEFVVFLG                                                 03231000
@NM00079 EQU   DEFVVFLG                                                 03232000
DEFVCECT EQU   DEFVVFLG                                                 03233000
DEFVLID  EQU   DEFVLIB                                                  03234000
@NM00078 EQU   DEFVLIB                                                  03235000
DEFVDACT EQU   DEFVFLG                                                  03236000
DEFVACT  EQU   DEFVFLG                                                  03237000
DEFVELTR EQU   DEFVFLG                                                  03238000
DEFVREP  EQU   DEFVFLG                                                  03239000
DEFVRNM  EQU   DEFVFLG                                                  03240000
DEFVELM  EQU   DEFVFLG                                                  03241000
DEFVCR   EQU   DEFVFLG                                                  03242000
@NM00077 EQU   DEFLIST+5                                                03243000
DEFVOPCD EQU   DEFLIST+4                                                03244000
DEFVLEN  EQU   DEFLIST                                                  03245000
@NM00076 EQU   RVR+20                                                   03246000
@NM00075 EQU   RVRFLAGA                                                 03247000
RVRBLNK1 EQU   RVR+14                                                   03248000
@NM00074 EQU   RVRCODE+1                                                03249000
RVROPCD  EQU   RVRCODE                                                  03250000
@NM00073 EQU   RVVI+64                                                  03251000
RVVSDUP  EQU   RVVSPEC                                                  03252000
RVVSCSN  EQU   RVVSPEC                                                  03253000
RVVSEXP  EQU   RVVSPEC                                                  03254000
RVVSGRP  EQU   RVVSPEC                                                  03255000
@NM00072 EQU   RVVCPYTP                                                 03256000
RVVLCOPY EQU   RVVCPYTP                                                 03257000
RVVOBKUP EQU   RVVCPYTP                                                 03258000
RVVLBKUP EQU   RVVCPYTP                                                 03259000
@NM00071 EQU   RVVRTEST                                                 03260000
RVVDVOL  EQU   RVVRTEST                                                 03261000
RVVACTV  EQU   RVVRTEST                                                 03262000
RVVINACT EQU   RVVRTEST                                                 03263000
RVVRSTD  EQU   RVVRTEST                                                 03264000
RVVGSVOL EQU   RVVRTEST                                                 03265000
RVVTHOLD EQU   RVVRTEST                                                 03266000
RVVEXPDT EQU   RVVRTEST                                                 03267000
@NM00070 EQU   RVVRDRCD                                                 03268000
RVVRUNKN EQU   RVVRDRCD                                                 03269000
RVVDUPRC EQU   RVVRDRCD                                                 03270000
RVVGRPRC EQU   RVVRDRCD                                                 03271000
@NM00069 EQU   RVVCHAIN                                                 03272000
RVVNGVOL EQU   RVVCHAIN                                                 03273000
RVVGPVOL EQU   RVVCHAIN                                                 03274000
@NM00068 EQU   RVVRMODE                                                 03275000
RVVRDCH  EQU   RVVRMODE                                                 03276000
RVVDUPID EQU   RVVI+57                                                  03277000
RVVRDCSN EQU   RVVI+44                                                  03278000
RVVBLNK1 EQU   RVVI+42                                                  03279000
RVVEXPIR EQU   RVVI+36                                                  03280000
@NM00067 EQU   RVVI+28                                                  03281000
RVVAREA  EQU   RVVI+24                                                  03282000
RVVARLN  EQU   RVVI+22                                                  03283000
RVVGROUP EQU   RVVI+14                                                  03284000
@NM00066 EQU   RVVOPCOD+1                                               03285000
@NM00065 EQU   COPYV+136                                                03286000
COPFREXT EQU   COPYV+132                                                03287000
COPLEXT  EQU   COPYV+130                                                03288000
COPFRESP EQU   COPYV+128                                                03289000
COPOWNER EQU   COPYV+118                                                03290000
COPDEST  EQU   COPYV+88                                                 03291000
COPDESCR EQU   COPYV+58                                                 03292000
COPDTREM EQU   COPYV+54                                                 03293000
COP2BIT2 EQU   COPLID2                                                  03294000
COP2BIT1 EQU   COPLID2                                                  03295000
COPRES5  EQU   COPLIB2                                                  03296000
COPCSN2  EQU   COPYV+37                                                 03297000
COP1BIT2 EQU   COPLID1                                                  03298000
COP1BIT1 EQU   COPLID1                                                  03299000
COPRES4  EQU   COPLIB1                                                  03300000
@NM00064 EQU   COPMISCF                                                 03301000
COPHOLD  EQU   COPMISCF                                                 03302000
COPRES3  EQU   COPSATIA                                                 03303000
COPVSMIS EQU   COPSATIA                                                 03304000
COPIVCPY EQU   COPSATIA                                                 03305000
COPIVCRE EQU   COPSATIA                                                 03306000
@NM00063 EQU   COPYV+18                                                 03307000
@NM00062 EQU   COPFLAGA+3                                               03308000
COPDLSPF EQU   COPFLAGA+3                                               03309000
COPRONLY EQU   COPFLAGA+3                                               03310000
COPDAERA EQU   COPFLAGA+2                                               03311000
COPEXCL  EQU   COPFLAGA+2                                               03312000
COPBIND  EQU   COPFLAGA+2                                               03313000
COPBKUP  EQU   COPFLAGA+2                                               03314000
COPRSTD  EQU   COPFLAGA+2                                               03315000
COPGENUS EQU   COPFLAGA+2                                               03316000
COPVSAM  EQU   COPFLAGA+2                                               03317000
COPGROUP EQU   COPFLAGA+2                                               03318000
COPRES2  EQU   COPTYPE                                                  03319000
COPCOPYV EQU   COPTYPE                                                  03320000
COPRES1  EQU   COPTYPE                                                  03321000
COPRES6  EQU   COPYV+13                                                 03322000
COPBLANK EQU   COPID                                                    03323000
COPSERNO EQU   COPNAME+5                                                03324000
COPV     EQU   COPNAME                                                  03325000
@NM00061 EQU   BASEV+188                                                03326000
BASGROUP EQU   BASEV+180                                                03327000
BASRECOV EQU   BASEV+174                                                03328000
BASDEST  EQU   BASEV+144                                                03329000
BASOWNER EQU   BASEV+134                                                03330000
BASDESCR EQU   BASEV+104                                                03331000
BASDTREM EQU   BASEV+100                                                03332000
BASEXPDT EQU   BASEV+96                                                 03333000
BASDLMTD EQU   BASEV+92                                                 03334000
BASRES6  EQU   BASEV+89                                                 03335000
BASCOPNO EQU   BASCOPID+1                                               03336000
BASCOPBK EQU   BASCOPID                                                 03337000
BASCOPSN EQU   BASKLCPY+5                                               03338000
BASCOPV  EQU   BASKLCPY                                                 03339000
BASFREXT EQU   BASEV+72                                                 03340000
BASLEXT  EQU   BASEV+70                                                 03341000
BASFRESP EQU   BASEV+68                                                 03342000
@NM00060 EQU   BASEV+65                                                 03343000
BASBKLMT EQU   BASEV+64                                                 03344000
BASNBKUP EQU   BASEV+63                                                 03345000
BASNCOPY EQU   BASEV+62                                                 03346000
BASNEXTV EQU   BASEV+56                                                 03347000
BASPREV  EQU   BASEV+50                                                 03348000
BAS2BIT2 EQU   BASLID2                                                  03349000
BAS2BIT1 EQU   BASLID2                                                  03350000
BASRES5  EQU   BASLIB2                                                  03351000
BASCSN2  EQU   BASEV+37                                                 03352000
BAS1BIT2 EQU   BASLID1                                                  03353000
BAS1BIT1 EQU   BASLID1                                                  03354000
BASRES4  EQU   BASLIB1                                                  03355000
BASRES3  EQU   BASMISCF                                                 03356000
BASHOLD  EQU   BASMISCF                                                 03357000
BASRES8  EQU   BASSATIA                                                 03358000
BASVSMIS EQU   BASSATIA                                                 03359000
BASIVCPY EQU   BASSATIA                                                 03360000
BASIVCRE EQU   BASSATIA                                                 03361000
BASCPUID EQU   BASEV+18                                                 03362000
@NM00059 EQU   BASFLAGA+3                                               03363000
BASLAST  EQU   BASFLAGA+3                                               03364000
BASFIRST EQU   BASFLAGA+3                                               03365000
BASRONLY EQU   BASFLAGA+3                                               03366000
BASDAERA EQU   BASFLAGA+3                                               03367000
BASEXCL  EQU   BASFLAGA+2                                               03368000
BASBIND  EQU   BASFLAGA+2                                               03369000
BASINAC  EQU   BASFLAGA+2                                               03370000
BASRSTD  EQU   BASFLAGA+2                                               03371000
BASGENUS EQU   BASFLAGA+2                                               03372000
BASGRPV  EQU   BASFLAGA+2                                               03373000
BASNOCPY EQU   BASFLAGA+2                                               03374000
BASDLSF  EQU   BASFLAGA+2                                               03375000
BASRES2  EQU   BASTYPE                                                  03376000
BASBASVR EQU   BASTYPE                                                  03377000
BASRES1  EQU   BASTYPE                                                  03378000
BASRES7  EQU   BASEV+13                                                 03379000
BASZERO  EQU   BASID+1                                                  03380000
BASBLANK EQU   BASID                                                    03381000
BASSERNO EQU   BASNAME+5                                                03382000
BASEVKEY EQU   BASNAME                                                  03383000
SV82DEBP EQU   SV82WRKP                                                 03384000
SV82TTRP EQU   SV82LIST+8                                               03385000
SV82VOLP EQU   SV82DCBP                                                 03386000
SV82UCBP EQU   SV82LIST+1                                               03387000
SV82CODE EQU   SV82LIST                                                 03388000
VOLRESV3 EQU   VOLLABEL+55                                              03389000
VOLOWNER EQU   VOLLABEL+45                                              03390000
VOLRESV1 EQU   VOLLABEL+20                                              03391000
VOLVTOC  EQU   VOLLABEL+15                                              03392000
VOLSECTY EQU   VOLLABEL+14                                              03393000
VOLSERNO EQU   VOLLABEL+8                                               03394000
VOLNO    EQU   VOLLABEL+7                                               03395000
VOLLABI  EQU   VOLLABEL+4                                               03396000
VOLKEY   EQU   VOLLABEL                                                 03397000
@NM00056 EQU   STARETRY                                                 03398000
STAOFF   EQU   STARETRY                                                 03399000
STAIO05  EQU   STARETRY                                                 03400000
@NM00055 EQU   STARCVY                                                  03401000
STACLEAR EQU   STARCVY                                                  03402000
STAVPOST EQU   STARCVY                                                  03403000
STAVENQ  EQU   STARCVY                                                  03404000
STAVDMNT EQU   STARCVY                                                  03405000
STAVMNT  EQU   STARCVY                                                  03406000
STATCB   EQU   STAEPARM+48                                              03407000
STARTADD EQU   STAEPARM+44                                              03408000
STAEXSAV EQU   STAEPARM+40                                              03409000
STARTSAV EQU   STAEPARM+36                                              03410000
STARTTR  EQU   STAEPARM+32                                              03411000
@NM00054 EQU   STAEPARM+30                                              03412000
STARVOL  EQU   STAEPARM+24                                              03413000
STARUCB  EQU   STAEPARM+20                                              03414000
@NM00053 EQU   STAEPARM+18                                              03415000
STAVVOL  EQU   STAEPARM+12                                              03416000
STAVUCB  EQU   STAEPARM+8                                               03417000
STAHEAD  EQU   STAEPARM                                                 03418000
RCTDSET  EQU   RCTAGL+32                                                03419000
RCTNVOL  EQU   RCTAGL+26                                                03420000
RCTOVOL  EQU   RCTAGL+20                                                03421000
RCTNDEV  EQU   RCTAGL+16                                                03422000
RCTODEV  EQU   RCTAGL+12                                                03423000
@NM00052 EQU   RCTAGL+10                                                03424000
@NM00051 EQU   RCTOPT                                                   03425000
RCTVOL   EQU   RCTOPT                                                   03426000
RCTDEV   EQU   RCTOPT                                                   03427000
RCTHEAD  EQU   RCTAGL                                                   03428000
@NM00050 EQU   VSRESOPT                                                 03429000
VSREAL   EQU   VSRESOPT                                                 03430000
VSRES    EQU   VSRESOPT                                                 03431000
@NM00049 EQU   VSMSG                                                    03432000
VSTOV    EQU   VSMSG                                                    03433000
VSFROMV  EQU   VSMSG                                                    03434000
@NM00048 EQU   VSRETURN                                                 03435000
VSUCAT   EQU   VSRETURN                                                 03436000
VSVSAM   EQU   VSRETURN                                                 03437000
@NM00047 EQU   VSCATOPT                                                 03438000
VSLIST   EQU   VSCATOPT                                                 03439000
VSSERIAL EQU   VSCATOPT                                                 03440000
VSDEVICE EQU   VSCATOPT                                                 03441000
@NM00046 EQU   VSVTOPT                                                  03442000
VSVSFLAG EQU   VSVTOPT                                                  03443000
VSALTTRK EQU   VSVTOPT                                                  03444000
VSTIME   EQU   VSVTOPT                                                  03445000
VSUCMAST EQU   VSSECOPT                                                 03446000
VSOPCAT  EQU   VSSECOPT                                                 03447000
VSUCTEST EQU   VSSECOPT                                                 03448000
VSWRITE  EQU   VSSECOPT                                                 03449000
VSREAD   EQU   VSSECOPT                                                 03450000
VSNONONV EQU   VSSECOPT                                                 03451000
VSMASTER EQU   VSSECOPT                                                 03452000
VSNOVSAM EQU   VSSECOPT                                                 03453000
VSODEVP  EQU   VS1AGL+64                                                03454000
VSOSERP  EQU   VS1AGL+60                                                03455000
VSDEVP   EQU   VS1AGL+56                                                03456000
VSSERP   EQU   VS1AGL+52                                                03457000
VSPFILEP EQU   VS1AGL+48                                                03458000
VSPSWDP  EQU   VS1AGL+44                                                03459000
VSCATDDP EQU   VS1AGL+40                                                03460000
VSACBP   EQU   VS1AGL+36                                                03461000
VSCATP   EQU   VS1AGL+32                                                03462000
VSNXTATP EQU   VS1AGL+28                                                03463000
VSNUMATP EQU   VS1AGL+24                                                03464000
VSIOP    EQU   VS1AGL+20                                                03465000
VSFILEP  EQU   VS1AGL+16                                                03466000
VSVOLP   EQU   VS1AGL+12                                                03467000
VSUCBP   EQU   VS1AGL+8                                                 03468000
VSHEAD   EQU   VS1AGL                                                   03469000
VSDDNAME EQU   VS2AGL+37                                                03470000
@NM00045 EQU   VS2RESOP                                                 03471000
VS2REAL  EQU   VS2RESOP                                                 03472000
VS2RES   EQU   VS2RESOP                                                 03473000
@NM00044 EQU   VS2MSG                                                   03474000
VS2TOV   EQU   VS2MSG                                                   03475000
VSVOLUME EQU   VS2AGL+29                                                03476000
@NM00043 EQU   VSLABOPT                                                 03477000
VSVOLSER EQU   VSLABOPT                                                 03478000
VSOWNER  EQU   VSLABOPT                                                 03479000
VSIOBKPT EQU   VS2AGL+24                                                03480000
VSVOLPTR EQU   VS2AGL+20                                                03481000
VSOWNPTR EQU   VS2AGL+16                                                03482000
VSVTOCSZ EQU   VS2AGL+12                                                03483000
VSUCBPTR EQU   VS2AGL+8                                                 03484000
VS2HEAD  EQU   VS2AGL                                                   03485000
EXPDATAL EQU   EXPARRAY+6                                               03486000
@NM00042 EQU   EXPARRAY+5                                               03487000
EXPKEYLN EQU   EXPARRAY+4                                               03488000
EXPDATAP EQU   EXPARRAY                                                 03489000
EXPRECNO EQU   EXPDATAB                                                 03490000
EXPCCHHR EQU   EXPARG+16                                                03491000
EXPCTLBK EQU   EXPARG+8                                                 03492000
EXPHEAD  EQU   EXPARG                                                   03493000
EXGDATAL EQU   EXGARG+30                                                03494000
@NM00041 EQU   EXGARG+29                                                03495000
EXGKEYLN EQU   EXGARG+28                                                03496000
EXGDATAP EQU   EXGARG+24                                                03497000
EXGRECNO EQU   EXGARG+20                                                03498000
EXGCCHH2 EQU   EXGARG+16                                                03499000
EXGCCHH1 EQU   EXGARG+12                                                03500000
EXGCTLBK EQU   EXGARG+8                                                 03501000
EXGHEAD  EQU   EXGARG                                                   03502000
@NM00040 EQU   EXFLG                                                    03503000
EXOREAD  EQU   EXFLG                                                    03504000
@NM00039 EQU   EXOPT                                                    03505000
EXONEW   EQU   EXOPT                                                    03506000
EXOPASS  EQU   EXOPT                                                    03507000
EXOLAB   EQU   EXOPT                                                    03508000
EXOTAB   EQU   EXOPT                                                    03509000
EXOCTLBK EQU   EXOARG+28                                                03510000
EXOEXT   EQU   EXOARG+24                                                03511000
EXOUCB   EQU   EXOARG+20                                                03512000
EXOVSN   EQU   EXOARG+16                                                03513000
EXODSN   EQU   EXOARG+12                                                03514000
EXODDN   EQU   EXOARG+8                                                 03515000
EXOHEAD  EQU   EXOARG                                                   03516000
@NM00038 EQU   EXCLFLAG                                                 03517000
EXCLMNT  EQU   EXCLFLAG                                                 03518000
EXCLVOL  EQU   EXCLAGL+16                                               03519000
EXCLDDP  EQU   EXCLAGL+12                                               03520000
EXCLUCBP EQU   EXCLAGL+8                                                03521000
EXCLHEAD EQU   EXCLAGL                                                  03522000
@NM00037 EQU   CKFLAGS                                                  03523000
CKRETTYP EQU   CKFLAGS                                                  03524000
CKTESTVT EQU   CKFLAGS                                                  03525000
CKLABELP EQU   CKAGL+24                                                 03526000
CKDATYPE EQU   CKAGL+20                                                 03527000
CKDDNAME EQU   CKAGL+12                                                 03528000
CKUCBPTR EQU   CKAGL+8                                                  03529000
CKHEAD   EQU   CKAGL                                                    03530000
PULABELP EQU   PUAGL+16                                                 03531000
PUTTRPTR EQU   PUAGL+12                                                 03532000
PUUCBPTR EQU   PUAGL+8                                                  03533000
PUHEAD   EQU   PUAGL                                                    03534000
@NM00036 EQU   MDFLAGS                                                  03535000
MDDEQ    EQU   MDFLAGS                                                  03536000
MDENQ    EQU   MDFLAGS                                                  03537000
MDWAIT   EQU   MDFLAGS                                                  03538000
MDPOST   EQU   MDFLAGS                                                  03539000
MDCLEAR  EQU   MDFLAGS                                                  03540000
MDNEWVOL EQU   MDFLAGS                                                  03541000
MDLABEL  EQU   MDAGL+24                                                 03542000
MDPUAGL  EQU   MDAGL+20                                                 03543000
MDDDNAME EQU   MDAGL+12                                                 03544000
MDUCBPTR EQU   MDAGL+8                                                  03545000
MDHEAD   EQU   MDAGL                                                    03546000
CTTBLRR  EQU   CTARRAY+3                                                03547000
CTTBLHH  EQU   CTARRAY+2                                                03548000
CTTBLCC  EQU   CTARRAY+1                                                03549000
CTTBLID  EQU   CTARRAY                                                  03550000
CTREALH  EQU   CTMSG+3                                                  03551000
CTREALCC EQU   CTMSG+1                                                  03552000
@NM00035 EQU   CTMSG                                                    03553000
CMCSN2   EQU   CMMSG+28                                                 03554000
CMCSN1   EQU   CMMSG+16                                                 03555000
CMNUMCRT EQU   CMMSG+15                                                 03556000
@NM00034 EQU   CMMSG+14                                                 03557000
CMNEWVOL EQU   CMMSG+8                                                  03558000
@NM00033 EQU   CMMSG+7                                                  03559000
@NM00032 EQU   CMVOLFLG                                                 03560000
CMRONLY  EQU   CMVOLFLG                                                 03561000
CMBIND   EQU   CMVOLFLG                                                 03562000
CMSCRCRT EQU   CMVOLFLG                                                 03563000
CMEXCL   EQU   CMVOLFLG                                                 03564000
CMDERAS  EQU   CMVOLFLG                                                 03565000
CMSCRVOL EQU   CMVOLFLG                                                 03566000
CMCECART EQU   CMVOLFLG                                                 03567000
CMOLDVOL EQU   CMMSG                                                    03568000
CCOLDCSN EQU   CCMSG+24                                                 03569000
CCNEWCSN EQU   CCMSG+12                                                 03570000
@NM00031 EQU   CCMSG+10                                                 03571000
CCVOL    EQU   CCMSG+4                                                  03572000
@NM00030 EQU   CCMSG+2                                                  03573000
CCEJCODE EQU   CCMSG+1                                                  03574000
CCPSTCDE EQU   CCMSG                                                    03575000
VOLLEN   EQU   VOL                                                      03576000
@NM00029 EQU   DMPARY+15                                                03577000
DMPARYTP EQU   DMPARY+14                                                03578000
DMPARYEX EQU   DMPARY+12                                                03579000
DMPARYIC EQU   DMPARY+10                                                03580000
DMPARYSZ EQU   DMPARY+8                                                 03581000
DMPARYNM EQU   DMPARY                                                   03582000
@NM00028 EQU   DMPITM+15                                                03583000
@NM00027 EQU   FMTCNVF+1                                                03584000
FMTBS    EQU   FMTCNVF+1                                                03585000
FMTSS    EQU   FMTCNVF+1                                                03586000
FMTAL    EQU   FMTCNVF+1                                                03587000
FMTZS    EQU   FMTCNVF+1                                                03588000
@NM00026 EQU   FMTCNVF                                                  03589000
FMTPU    EQU   FMTCNVF                                                  03590000
FMTBD    EQU   FMTCNVF                                                  03591000
FMTBHD   EQU   FMTCNVF                                                  03592000
FMTBHA   EQU   FMTCNVF                                                  03593000
FMTBH    EQU   FMTCNVF                                                  03594000
FMTOLEN  EQU   FMTLIST+8                                                03595000
FMTRIO   EQU   FMTOCOL                                                  03596000
FMTSPT   EQU   FMTSTO                                                   03597000
FMTSTL   EQU   FMTILEN                                                  03598000
@NM00025 EQU   FMTFLGS+1                                                03599000
FMTHDF   EQU   FMTFLGS                                                  03600000
FMTDFF   EQU   FMTFLGS                                                  03601000
FMTSTF   EQU   FMTFLGS                                                  03602000
FMTREPF  EQU   FMTFLGS                                                  03603000
FMTBDF   EQU   FMTFLGS                                                  03604000
FMTIDF   EQU   FMTFLGS                                                  03605000
FMTSCF   EQU   FMTFLGS                                                  03606000
FMTEOLF  EQU   FMTFLGS                                                  03607000
DARGPCT  EQU   DARGINL                                                  03608000
DARGREP  EQU   DARGINS                                                  03609000
@NM00024 EQU   DARGLIST+19                                              03610000
DARGIND  EQU   DARGLIST+18                                              03611000
UVOLVOL  EQU   UVOLENT+4                                                03612000
UVOLDEV  EQU   UVOLENT                                                  03613000
UVOLCNT  EQU   UVOLLIST                                                 03614000
@NM00023 EQU   IOINFOPT                                                 03615000
IOINFTMS EQU   IOINFOPT                                                 03616000
IOINFSUP EQU   IOINFOPT                                                 03617000
IOINFDSN EQU   IOINFOPT                                                 03618000
IOINFVOL EQU   IOINFOPT                                                 03619000
IOINFDVT EQU   IOINFOPT                                                 03620000
OPNVOL   EQU   OPNAGL+44                                                03621000
@NM00022 EQU   OPNAGL+43                                                03622000
@NM00021 EQU   OPNOPT2                                                  03623000
OPNOPTJM EQU   OPNOPT2                                                  03624000
OPNOPTNF EQU   OPNOPT2                                                  03625000
OPNOPTAS EQU   OPNOPT2                                                  03626000
@NM00020 EQU   OPNDSO                                                   03627000
OPNDSOPO EQU   OPNDSO                                                   03628000
OPNDSOIS EQU   OPNDSO                                                   03629000
OPNDSOPS EQU   OPNDSO                                                   03630000
OPNDSOAM EQU   OPNDSO                                                   03631000
OPNKYL   EQU   OPNAGL+40                                                03632000
OPNBLK   EQU   OPNAGL+36                                                03633000
OPNREC   EQU   OPNAGL+32                                                03634000
OPNDEVIX EQU   OPNDEV+4                                                 03635000
OPNDEVDT EQU   OPNDEV                                                   03636000
OPNCBP   EQU   OPNAGL+20                                                03637000
OPNDSN   EQU   OPNAGL+16                                                03638000
OPNPWA   EQU   OPNAGL+12                                                03639000
OPNDDN   EQU   OPNAGL+8                                                 03640000
OPNIOC   EQU   OPNAGL+4                                                 03641000
OPNMODRP EQU   OPNMOD                                                   03642000
OPNMODUB EQU   OPNMOD                                                   03643000
OPNMODRS EQU   OPNMOD                                                   03644000
OPNMODAX EQU   OPNMOD                                                   03645000
OPNMODRR EQU   OPNMOD                                                   03646000
OPNMODRC EQU   OPNMOD                                                   03647000
OPNMODAC EQU   OPNMOD                                                   03648000
OPNMODPD EQU   OPNMOD                                                   03649000
@NM00019 EQU   OPNTYP                                                   03650000
OPNTYPRV EQU   OPNTYP                                                   03651000
OPNTYPEX EQU   OPNTYP                                                   03652000
OPNTYPRA EQU   OPNTYP                                                   03653000
OPNTYPXM EQU   OPNTYP                                                   03654000
OPNTYPCI EQU   OPNTYP                                                   03655000
OPNTYPSO EQU   OPNTYP                                                   03656000
OPNTYPSI EQU   OPNTYP                                                   03657000
@NM00018 EQU   OPNRFM                                                   03658000
OPNRFMBK EQU   OPNRFM                                                   03659000
OPNRFMSF EQU   OPNRFM                                                   03660000
OPNRFMUN EQU   OPNRFM                                                   03661000
OPNRFMVR EQU   OPNRFM                                                   03662000
OPNRFMFX EQU   OPNRFM                                                   03663000
OPNOPTSK EQU   OPNOPT                                                   03664000
OPNOPTDR EQU   OPNOPT                                                   03665000
OPNOPTCR EQU   OPNOPT                                                   03666000
OPNOPTKS EQU   OPNOPT                                                   03667000
OPNOPTBK EQU   OPNOPT                                                   03668000
OPNOPTUP EQU   OPNOPT                                                   03669000
OPNOPTOT EQU   OPNOPT                                                   03670000
OPNOPTIN EQU   OPNOPT                                                   03671000
IOCEXT   EQU   IOCSTR+64                                                03672000
IOCREL   EQU   IOCSTR+60                                                03673000
IOCWORK  EQU   IOCSTR+56                                                03674000
IOCRRN   EQU   IOCSTR+52                                                03675000
IOCPNM   EQU   IOCNWM+2                                                 03676000
IOCPTL   EQU   IOCNWM                                                   03677000
IOCKYA   EQU   IOCMEM                                                   03678000
IOCVRC   EQU   IOCTTR                                                   03679000
IOCCBP   EQU   IOCSTR+36                                                03680000
IOCDSN   EQU   IOCSTR+32                                                03681000
IOCHURBA EQU   IOCSTR+28                                                03682000
IOCVOLSR EQU   IOCSTR+22                                                03683000
@NM00017 EQU   IOCMSG                                                   03684000
IOCMSGAE EQU   IOCMSG                                                   03685000
IOCMSGCE EQU   IOCMSG                                                   03686000
IOCMSGOE EQU   IOCMSG                                                   03687000
IOCMSGOP EQU   IOCMSG                                                   03688000
@NM00016 EQU   IOCMSG                                                   03689000
IOCCHPSY EQU   IOCCHP                                                   03690000
IOCCHPAS EQU   IOCCHP                                                   03691000
IOCCHPBK EQU   IOCCHP                                                   03692000
IOCCHPCR EQU   IOCCHP                                                   03693000
IOCCHPKS EQU   IOCCHP                                                   03694000
IOCCHPSK EQU   IOCCHP                                                   03695000
IOCCHPDR EQU   IOCCHP                                                   03696000
IOCCHPSQ EQU   IOCCHP                                                   03697000
@NM00015 EQU   IOCMAC2                                                  03698000
IOCMACPA EQU   IOCMAC2                                                  03699000
IOCMACNF EQU   IOCMAC2                                                  03700000
IOCMACCP EQU   IOCMAC2                                                  03701000
IOCMACRR EQU   IOCMAC2                                                  03702000
IOCMACAS EQU   IOCMAC2                                                  03703000
IOCMACSK EQU   IOCMAC2                                                  03704000
@NM00014 EQU   IOCMAC                                                   03705000
IOCMACCC EQU   IOCMAC                                                   03706000
IOCMACDR EQU   IOCMAC                                                   03707000
IOCMACBK EQU   IOCMAC                                                   03708000
IOCMACCR EQU   IOCMAC                                                   03709000
IOCMACUP EQU   IOCMAC                                                   03710000
IOCMACOT EQU   IOCMAC                                                   03711000
IOCMACIN EQU   IOCMAC                                                   03712000
@NM00013 EQU   IOCRFM                                                   03713000
IOCRFMBK EQU   IOCRFM                                                   03714000
IOCRFMSF EQU   IOCRFM                                                   03715000
IOCRFMUN EQU   IOCRFM                                                   03716000
IOCRFMVR EQU   IOCRFM                                                   03717000
IOCRFMFX EQU   IOCRFM                                                   03718000
@NM00012 EQU   IOCDSO                                                   03719000
IOCDSOPO EQU   IOCDSO                                                   03720000
IOCDSOIS EQU   IOCDSO                                                   03721000
IOCDSOPS EQU   IOCDSO                                                   03722000
IOCDSOAM EQU   IOCDSO                                                   03723000
IOCRKP   EQU   IOCSTR+13                                                03724000
IOCKYL   EQU   IOCSTR+12                                                03725000
IOCTRN   EQU   IOCSTR+8                                                 03726000
IOCDLN   EQU   IOCSTR+4                                                 03727000
IOCDAD   EQU   IOCSTR                                                   03728000
UNITVTOC EQU   UNITABL+7                                                03729000
@NM00011 EQU   UNITSTAT                                                 03730000
UNITXSHR EQU   UNITSTAT                                                 03731000
UNITISHR EQU   UNITSTAT                                                 03732000
UNITUA   EQU   @NM00010+1                                               03733000
UNITCHA  EQU   @NM00010                                                 03734000
UNITUCB  EQU   UNITABL                                                  03735000
ALLUNCNT EQU   ALLAGL+30                                                03736000
ALLVLCNT EQU   ALLAGL+29                                                03737000
@NM00009 EQU   ALLOPT                                                   03738000
ALLOPTPV EQU   ALLOPT                                                   03739000
ALLOPTDS EQU   ALLOPT                                                   03740000
ALLOPTVL EQU   ALLOPT                                                   03741000
@NM00008 EQU   ALLORG+1                                                 03742000
ALLORGVS EQU   ALLORG+1                                                 03743000
@NM00007 EQU   ALLORG+1                                                 03744000
ALLORGGS EQU   ALLORG+1                                                 03745000
ALLORGUN EQU   ALLORG                                                   03746000
ALLORGPO EQU   ALLORG                                                   03747000
ALLORGMQ EQU   ALLORG                                                   03748000
ALLORGCQ EQU   ALLORG                                                   03749000
ALLORGCX EQU   ALLORG                                                   03750000
ALLORGDA EQU   ALLORG                                                   03751000
ALLORGPS EQU   ALLORG                                                   03752000
ALLORGIS EQU   ALLORG                                                   03753000
ALLDSPUN EQU   ALLDSP                                                   03754000
ALLDSPCG EQU   ALLDSP                                                   03755000
ALLDSPDE EQU   ALLDSP                                                   03756000
ALLDSPKP EQU   ALLDSP                                                   03757000
@NM00006 EQU   ALLDSP                                                   03758000
ALLSTSOD EQU   ALLSTS                                                   03759000
ALLSTSMD EQU   ALLSTS                                                   03760000
ALLSTSNW EQU   ALLSTS                                                   03761000
ALLSTSSR EQU   ALLSTS                                                   03762000
@NM00005 EQU   ALLSTS                                                   03763000
ALLPWD   EQU   ALLAGL+20                                                03764000
ALLVLP   EQU   ALLAGL+16                                                03765000
ALLULP   EQU   ALLAGL+12                                                03766000
ALLDDN   EQU   ALLAGL+4                                                 03767000
ALLDSN   EQU   ALLAGL                                                   03768000
CIRPID   EQU   CIRAGL+28                                                03769000
CIRPWD   EQU   CIRAGL+24                                                03770000
CIRCAT   EQU   CIRAGL+20                                                03771000
CIRWKP   EQU   CIRAGL+16                                                03772000
CIRTLR   EQU   CIRAGL+12                                                03773000
CIRHDR   EQU   CIRAGL+8                                                 03774000
CIRTLN   EQU   CIRAGL+6                                                 03775000
CIRHLN   EQU   CIRAGL+4                                                 03776000
@NM00004 EQU   CIRAGL+1                                                 03777000
@NM00003 EQU   CIRTYPE                                                  03778000
CIRTYPAQ EQU   CIRTYPE                                                  03779000
CIRTYP1Q EQU   CIRTYPE                                                  03780000
NEWID1   EQU   TRACE1+95                                                03781000
CALLID   EQU   OLDERID1+90                                              03782000
@NM00002 EQU   OLDERID1                                                 03783000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03784000
@RF00263 EQU   @RC00257                                                 03785000
@RC00409 EQU   @RC00400                                                 03786000
@RC00473 EQU   @RC00447                                                 03787000
@RF00606 EQU   @RC00591                                                 03788000
@RF00681 EQU   @RC00656                                                 03789000
@PB00007 EQU   @EL00001                                                 03790000
@RF00415 EQU   @RC00409                                                 03791000
@PB00006 EQU   @PB00007                                                 03792000
@PB00005 EQU   @PB00006                                                 03793000
@PB00004 EQU   @PB00005                                                 03794000
@PB00003 EQU   @PB00004                                                 03795000
@PB00002 EQU   @PB00003                                                 03796000
@ENDDATA EQU   *                                                        03797000
         END   IDCRR01,(C'PLS1351',0603,75225)                          03798000
