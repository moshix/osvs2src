         TITLE '************** IDCRS01: IDCAMS RESETCAT ROUTINE ********00001000
               *********'                                               00002000
         MACRO                                                          00003000
         GETMAIN &R,&LV=                                                00004000
         L     REG15,0(REG1)           GDTTBL ADDRESS                   00005000
         L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS             00006000
         CNOP  2,4                     BOUNDARY ALIGNMENT               00007000
         LA    REG14,*+14              RETURN ADDRESS                   00008000
         BALR  REG1,REG15              LINKAGE TO PROL ROUTINE          00009000
         DC    A(MODID)                MODULE ID ADDRESS                00010000
         DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS   00011000
         MEND                                                           00012000
IDCRS01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCRS01   77.115'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @11,4095(,@12)                                      0002 00022000
         LA    @10,4095(,@11)                                      0002 00023000
         LA    @09,4095(,@10)                                      0002 00024000
         USING @PSTART,@12                                         0002 00025000
         USING @PSTART+4095,@11                                    0002 00026000
         USING @PSTART+8190,@10                                    0002 00027000
         USING @PSTART+12285,@09                                   0002 00028000
         L     @00,@SIZDATD                                        0002 00029000
         GETMAIN  R,LV=(0)                                              00030000
         LR    @08,@01                                             0002 00031000
         LA    @07,4095(,@08)                                      0002 00032000
         USING @DATD,@08                                           0002 00033000
         USING @DATD+4095,@07                                      0002 00034000
         ST    @13,@SA00001+4                                      0002 00035000
         LM    @00,@01,20(@13)                                     0002 00036000
         ST    @08,8(,@13)                                         0002 00037000
         LR    @13,@08                                             0002 00038000
         MVC   @PC00001(12),0(@01)                                 0002 00039000
*        REG2 = ADDR(RSLAST);          /* RSWORK START ADDR  @ZM43016*/ 00040000
         LA    REG2,RSLAST                                         0262 00041000
*        REG4 = 0;                     /* ZERO SECOND OPER   @ZM43016*/ 00042000
         SLR   REG4,REG4                                           0263 00043000
*        REG5 = 0;                     /* ZERO SECOND LENGTH @ZM43016*/ 00044000
         SLR   REG5,REG5                                           0264 00045000
*        REG3 = LENGTH(RSWORK);        /* LENGTH OF CORE     @ZM43016*/ 00046000
         LA    REG3,2160                                           0265 00047000
*        MVCL(REG2,REG4);              /* MVCL CLEAR REWORK  @ZM43016*/ 00048000
         MVCL  REG2,REG4                                           0266 00049000
*        RESPECIFY (REG2,REG3,REG4) UNRSTD; /* FREE WRK REGS @ZM43016*/ 00050000
*                                                                  0267 00051000
*        /************************************************************/ 00052000
*        /*                                                          */ 00053000
*        /* SET UP THE ADDRESSES OF THE GDT AND RSWORK               */ 00054000
*        /*                                                          */ 00055000
*        /************************************************************/ 00056000
*                                                                  0268 00057000
*        REG6 = ADDR(RSLAST);          /*ADDRESS OF RSWORK           */ 00058000
         LA    REG6,RSLAST                                         0268 00059000
*        REG5 = ADDR(GDTTBLX);         /*ADDRESS OF THE GDT          */ 00060000
*                                                                  0269 00061000
         L     REG5,@PC00001                                       0269 00062000
*        /************************************************************/ 00063000
*        /*                                                          */ 00064000
*        /* INITIALIZE RSWORK - THE PRIMARY WORK AREA FOR            */ 00065000
*        /* RESETCAT.                                                */ 00066000
*        /*                                                          */ 00067000
*        /************************************************************/ 00068000
*                                                                  0270 00069000
*        RSLASTCC = ADDR(ALASTCC);     /*ADDR OF AMS LAST CC         */ 00070000
         L     @04,@PC00001+8                                      0270 00071000
         ST    @04,RSLASTCC(,REG6)                                 0270 00072000
*        RSFDT = ADDR(FDTTBL);         /*ADDR OF THE FDT             */ 00073000
         L     @04,@PC00001+4                                      0271 00074000
         ST    @04,RSFDT(,REG6)                                    0271 00075000
*        RSGDT = REG5;                 /*ADDRESS OF THE GDT          */ 00076000
*                                                                  0272 00077000
         ST    REG5,RSGDT(,REG6)                                   0272 00078000
*        /************************************************************/ 00079000
*        /*                                                          */ 00080000
*        /*      INITIALIZE ADDRESSES OF SECONDARY STORAGE ELEMENTS  */ 00081000
*        /*      GOTTEN.                                             */ 00082000
*        /*                                                          */ 00083000
*        /************************************************************/ 00084000
*                                                                  0273 00085000
*        RSA = 'RSWA';                 /*RSWORK I.D.                 */ 00086000
         MVC   RSA(4,REG6),@CC03474                                0273 00087000
*        DDSTRU = ADDR(RS2);           /*PTR TO DARGLIST             */ 00088000
         LA    @04,RS2                                             0274 00089000
         ST    @04,DDSTRU(,REG6)                                   0274 00090000
*        ERCNVADR = ADDR(RS3);         /*ADDR OF ERCNVTAB            */ 00091000
         LA    @04,RS3                                             0275 00092000
         ST    @04,ERCNVADR(,REG6)                                 0275 00093000
*        DMPINDEX = ADDR(RS5);         /*ADDRESS OF DUMP ELEMENT     */ 00094000
*                                                                  0276 00095000
         LA    @04,RS5                                             0276 00096000
         ST    @04,DMPINDEX(,REG6)                                 0276 00097000
*        /************************************************************/ 00098000
*        /*                                                          */ 00099000
*        /* INITIALIZE FIRST REGISTER SAVE AREA                      */ 00100000
*        /*                                                          */ 00101000
*        /************************************************************/ 00102000
*                                                                  0277 00103000
*        REG13->RSREGMOD = MODID;      /*RS01 DUMMY SAVE AREA        */ 00104000
         MVC   RSREGMOD(4,REG13),MODID                             0277 00105000
*        REG13->RSREGF = ADDR(RSREGS(1)); /*FORWARD CHAIN RS01 TO US */ 00106000
         LA    @04,RSREGS                                          0278 00107000
         ST    @04,RSREGF(,REG13)                                  0278 00108000
*        ADDR(RSREGS(1))->RSREGB = REG13; /*BACK CHAIN US TO RS01    */ 00109000
         ST    REG13,RSREGB(,@04)                                  0279 00110000
*        REG13 = ADDR(RSREGS(1));      /*GET OUR REGISTER SAVE AREA  */ 00111000
*                                                                  0280 00112000
         LR    REG13,@04                                           0280 00113000
*        /************************************************************/ 00114000
*        /*                                                          */ 00115000
*        /* INITIALIZE REGISTER LINKAGE WITH OTHER MODULES.          */ 00116000
*        /* ALSO GET THE AUTOMATIC STORAGE FOR THOSE MODULES.        */ 00117000
*        /* STANDARD REGISTER IN ALL MODULES MUST BE:                */ 00118000
*        /*     REG 08 - DATA REGISTER                               */ 00119000
*        /*     REG 09 - BASE REGISTER                               */ 00120000
*        /*     REG 10 - BASE REGISTER                               */ 00121000
*        /*     REG 11 - BASE REGISTER                               */ 00122000
*        /*     REG 12 - BASE REGISTER                               */ 00123000
*        /*                                                          */ 00124000
*        /************************************************************/ 00125000
*                                                                  0281 00126000
*        REG13 = ADDR(RSREGS(1));      /*IDCRS01 REGISTER SAVE AREA  */ 00127000
*                                                                  0281 00128000
         LR    REG13,@04                                           0281 00129000
*        /************************************************************/ 00130000
*        /*                                                          */ 00131000
*        /*   ESTABLISH BASE AND DATA REGISTERS FOR EACH             */ 00132000
*        /*   MODULE. ALSO GET AUTOMATIC STORAGE FOR EACH            */ 00133000
*        /*   MODULE.                                                */ 00134000
*        /*                                                          */ 00135000
*        /************************************************************/ 00136000
*                                                                  0282 00137000
*        /************************************************************/ 00138000
*        /*                                                          */ 00139000
*        /*     REGISTERS FOR IDCRS01                                */ 00140000
*        /*                                                          */ 00141000
*        /************************************************************/ 00142000
*                                                                  0282 00143000
*        RS01RG08 = REG8;              /*SAVE AUTO DATA REG          */ 00144000
         ST    REG8,RS01RG08(,REG6)                                0282 00145000
*        GENERATE REFS(RS01RG09,REG6);                             0283 00146000
*                                                                  0283 00147000
          STM   9,12,RS01RG09(REG6) SAVE BASE REGISTERS                 00148000
*        /************************************************************/ 00149000
*        /*                                                          */ 00150000
*        /*     ESTABLISH BASE REGISTERS - GET AUTO STORAGE          */ 00151000
*        /*     THEN ESTABLISH AUTO STORAGE REGISTER                 */ 00152000
*        /*     FOR IDCRS02                                          */ 00153000
*        /*                                                          */ 00154000
*        /************************************************************/ 00155000
*                                                                  0284 00156000
*        CALL IDCRS02;                 /*EXECUTE THE PROLOGUE        */ 00157000
         L     @15,@CV03434                                        0284 00158000
         BALR  @14,@15                                             0284 00159000
*        RSUGLEN = REG15;              /*LENGTH OF AUTO STORAGE      */ 00160000
         ST    REG15,RSUGLEN(,REG6)                                0285 00161000
*        IF RSUGLEN > 0 THEN           /*GET THE AUTO STORAGE        */ 00162000
         L     @04,RSUGLEN(,REG6)                                  0286 00163000
         LTR   @04,@04                                             0286 00164000
         BNP   @RF00286                                            0286 00165000
*          DO;                                                     0287 00166000
*                                                                  0287 00167000
*            CALL IDCSAGP0(GDTTBL,RSUGLEN,RS02RG08,POOL1,SETZERO); 0288 00168000
*                                                                  0288 00169000
         ST    REG5,@AL00001                                       0288 00170000
         LA    @04,RSUGLEN(,REG6)                                  0288 00171000
         ST    @04,@AL00001+4                                      0288 00172000
         LA    @04,RS02RG08(,REG6)                                 0288 00173000
         ST    @04,@AL00001+8                                      0288 00174000
         LA    @04,@CC00900                                        0288 00175000
         ST    @04,@AL00001+12                                     0288 00176000
         LA    @04,SETZERO                                         0288 00177000
         ST    @04,@AL00001+16                                     0288 00178000
         MVI   @AL00001+16,X'80'                                   0288 00179000
         L     @15,GDTGPL(,REG5)                                   0288 00180000
         LA    @01,@AL00001                                        0288 00181000
         BALR  @14,@15                                             0288 00182000
*            RESPECIFY RTNREG RSTD;                                0289 00183000
*            TESTRC = RTNREG;                                      0290 00184000
         STH   RTNREG,TESTRC(,REG6)                                0290 00185000
*            RESPECIFY RTNREG UNRSTD;                              0291 00186000
*            IF TESTRC ^= 0 THEN       /*EXIT STORAGE UNAVAILABLE    */ 00187000
         LH    @04,TESTRC(,REG6)                                   0292 00188000
         LTR   @04,@04                                             0292 00189000
         BZ    @RF00292                                            0292 00190000
*              CALL AERROR;                                        0293 00191000
*                                                                  0293 00192000
         BAL   @14,AERROR                                          0293 00193000
*          END;                                                    0294 00194000
*                                                                  0294 00195000
@RF00292 DS    0H                                                  0295 00196000
*        /************************************************************/ 00197000
*        /*                                                          */ 00198000
*        /*     ESTABLISH BASE REGISTERS - GET AUTO STORAGE          */ 00199000
*        /*     THEN ESTABLISH AUTO STORAGE REGISTER                 */ 00200000
*        /*     FOR IDCRS03                                          */ 00201000
*        /*                                                          */ 00202000
*        /************************************************************/ 00203000
*                                                                  0295 00204000
*        CALL IDCRS03;                 /*EXECUTE THE PROLOGUE        */ 00205000
@RF00286 L     @15,@CV03435                                        0295 00206000
         BALR  @14,@15                                             0295 00207000
*        RSUGLEN = REG15;              /*LENGTH OF AUTO STORAGE      */ 00208000
         ST    REG15,RSUGLEN(,REG6)                                0296 00209000
*        IF RSUGLEN > 0 THEN           /*GET THE AUTO STORAGE        */ 00210000
         L     @04,RSUGLEN(,REG6)                                  0297 00211000
         LTR   @04,@04                                             0297 00212000
         BNP   @RF00297                                            0297 00213000
*          DO;                                                     0298 00214000
*                                                                  0298 00215000
*            CALL IDCSAGP0(GDTTBL,RSUGLEN,RS03RG08,POOL1,SETZERO); 0299 00216000
*                                                                  0299 00217000
         ST    REG5,@AL00001                                       0299 00218000
         LA    @04,RSUGLEN(,REG6)                                  0299 00219000
         ST    @04,@AL00001+4                                      0299 00220000
         LA    @04,RS03RG08(,REG6)                                 0299 00221000
         ST    @04,@AL00001+8                                      0299 00222000
         LA    @04,@CC00900                                        0299 00223000
         ST    @04,@AL00001+12                                     0299 00224000
         LA    @04,SETZERO                                         0299 00225000
         ST    @04,@AL00001+16                                     0299 00226000
         MVI   @AL00001+16,X'80'                                   0299 00227000
         L     @15,GDTGPL(,REG5)                                   0299 00228000
         LA    @01,@AL00001                                        0299 00229000
         BALR  @14,@15                                             0299 00230000
*            RESPECIFY RTNREG RSTD;                                0300 00231000
*            TESTRC = RTNREG;                                      0301 00232000
         STH   RTNREG,TESTRC(,REG6)                                0301 00233000
*            RESPECIFY RTNREG UNRSTD;                              0302 00234000
*            IF TESTRC ^= 0 THEN       /*EXIT STORAGE UNAVAILABLE    */ 00235000
         LH    @04,TESTRC(,REG6)                                   0303 00236000
         LTR   @04,@04                                             0303 00237000
         BZ    @RF00303                                            0303 00238000
*              CALL AERROR;                                        0304 00239000
*                                                                  0304 00240000
         BAL   @14,AERROR                                          0304 00241000
*          END;                                                    0305 00242000
*                                                                  0305 00243000
@RF00303 DS    0H                                                  0306 00244000
*        /************************************************************/ 00245000
*        /*                                                          */ 00246000
*        /*     ESTABLISH BASE REGISTERS - GET AUTO STORAGE          */ 00247000
*        /*     THEN ESTABLISH AUTO STORAGE REGISTER                 */ 00248000
*        /*     FOR IDCRS04                                          */ 00249000
*        /*                                                          */ 00250000
*        /************************************************************/ 00251000
*                                                                  0306 00252000
*        CALL IDCRS04;                 /*EXECUTE THE PROLOGUE        */ 00253000
@RF00297 L     @15,@CV03436                                        0306 00254000
         BALR  @14,@15                                             0306 00255000
*        RSUGLEN = REG15;              /*LENGTH OF AUTO STORAGE      */ 00256000
         ST    REG15,RSUGLEN(,REG6)                                0307 00257000
*        IF RSUGLEN > 0 THEN           /*GET THE AUTO STORAGE        */ 00258000
         L     @04,RSUGLEN(,REG6)                                  0308 00259000
         LTR   @04,@04                                             0308 00260000
         BNP   @RF00308                                            0308 00261000
*          DO;                                                     0309 00262000
*                                                                  0309 00263000
*            CALL IDCSAGP0(GDTTBL,RSUGLEN,RS04RG08,POOL1,SETZERO); 0310 00264000
*                                                                  0310 00265000
         ST    REG5,@AL00001                                       0310 00266000
         LA    @04,RSUGLEN(,REG6)                                  0310 00267000
         ST    @04,@AL00001+4                                      0310 00268000
         LA    @04,RS04RG08(,REG6)                                 0310 00269000
         ST    @04,@AL00001+8                                      0310 00270000
         LA    @04,@CC00900                                        0310 00271000
         ST    @04,@AL00001+12                                     0310 00272000
         LA    @04,SETZERO                                         0310 00273000
         ST    @04,@AL00001+16                                     0310 00274000
         MVI   @AL00001+16,X'80'                                   0310 00275000
         L     @15,GDTGPL(,REG5)                                   0310 00276000
         LA    @01,@AL00001                                        0310 00277000
         BALR  @14,@15                                             0310 00278000
*            RESPECIFY RTNREG RSTD;                                0311 00279000
*            TESTRC = RTNREG;                                      0312 00280000
         STH   RTNREG,TESTRC(,REG6)                                0312 00281000
*            RESPECIFY RTNREG UNRSTD;                              0313 00282000
*            IF TESTRC ^= 0 THEN       /*EXIT STORAGE UNAVAILABLE    */ 00283000
         LH    @04,TESTRC(,REG6)                                   0314 00284000
         LTR   @04,@04                                             0314 00285000
         BZ    @RF00314                                            0314 00286000
*              CALL AERROR;                                        0315 00287000
*                                                                  0315 00288000
         BAL   @14,AERROR                                          0315 00289000
*          END;                                                    0316 00290000
*                                                                  0316 00291000
@RF00314 DS    0H                                                  0317 00292000
*        /************************************************************/ 00293000
*        /*                                                          */ 00294000
*        /*     ESTABLISH BASE REGISTERS - GET AUTO STORAGE          */ 00295000
*        /*     THEN ESTABLISH AUTO STORAGE REGISTER                 */ 00296000
*        /*     FOR IDCRS05                                          */ 00297000
*        /*                                                          */ 00298000
*        /************************************************************/ 00299000
*                                                                  0317 00300000
*        CALL IDCRS05;                 /*EXECUTE THE PROLOGUE        */ 00301000
@RF00308 L     @15,@CV03437                                        0317 00302000
         BALR  @14,@15                                             0317 00303000
*        RSUGLEN = REG15;              /*LENGTH OF AUTO STORAGE      */ 00304000
         ST    REG15,RSUGLEN(,REG6)                                0318 00305000
*        IF RSUGLEN > 0 THEN           /*GET THE AUTO STORAGE        */ 00306000
         L     @04,RSUGLEN(,REG6)                                  0319 00307000
         LTR   @04,@04                                             0319 00308000
         BNP   @RF00319                                            0319 00309000
*          DO;                                                     0320 00310000
*                                                                  0320 00311000
*            CALL IDCSAGP0(GDTTBL,RSUGLEN,RS05RG08,POOL1,SETZERO); 0321 00312000
*                                                                  0321 00313000
         ST    REG5,@AL00001                                       0321 00314000
         LA    @04,RSUGLEN(,REG6)                                  0321 00315000
         ST    @04,@AL00001+4                                      0321 00316000
         LA    @04,RS05RG08(,REG6)                                 0321 00317000
         ST    @04,@AL00001+8                                      0321 00318000
         LA    @04,@CC00900                                        0321 00319000
         ST    @04,@AL00001+12                                     0321 00320000
         LA    @04,SETZERO                                         0321 00321000
         ST    @04,@AL00001+16                                     0321 00322000
         MVI   @AL00001+16,X'80'                                   0321 00323000
         L     @15,GDTGPL(,REG5)                                   0321 00324000
         LA    @01,@AL00001                                        0321 00325000
         BALR  @14,@15                                             0321 00326000
*            RESPECIFY RTNREG RSTD;                                0322 00327000
*            TESTRC = RTNREG;                                      0323 00328000
         STH   RTNREG,TESTRC(,REG6)                                0323 00329000
*            RESPECIFY RTNREG UNRSTD;                              0324 00330000
*            IF TESTRC ^= 0 THEN       /*EXIT STORAGE UNAVAILABLE    */ 00331000
         LH    @04,TESTRC(,REG6)                                   0325 00332000
         LTR   @04,@04                                             0325 00333000
         BZ    @RF00325                                            0325 00334000
*              CALL AERROR;                                        0326 00335000
*                                                                  0326 00336000
         BAL   @14,AERROR                                          0326 00337000
*          END;                                                    0327 00338000
*                                                                  0327 00339000
@RF00325 DS    0H                                                  0328 00340000
*        /************************************************************/ 00341000
*        /*                                                          */ 00342000
*        /*     ESTABLISH BASE REGISTERS - GET AUTO STORAGE          */ 00343000
*        /*     THEN ESTABLISH AUTO STORAGE REGISTER                 */ 00344000
*        /*     FOR IDCRS06                                          */ 00345000
*        /*                                                          */ 00346000
*        /************************************************************/ 00347000
*                                                                  0328 00348000
*        CALL IDCRS06;                 /*EXECUTE THE PROLOGUE        */ 00349000
@RF00319 L     @15,@CV03438                                        0328 00350000
         BALR  @14,@15                                             0328 00351000
*        RSUGLEN = REG15;              /*LENGTH OF AUTO STORAGE      */ 00352000
         ST    REG15,RSUGLEN(,REG6)                                0329 00353000
*        IF RSUGLEN > 0 THEN           /*GET THE AUTO STORAGE        */ 00354000
         L     @04,RSUGLEN(,REG6)                                  0330 00355000
         LTR   @04,@04                                             0330 00356000
         BNP   @RF00330                                            0330 00357000
*          DO;                                                     0331 00358000
*                                                                  0331 00359000
*            CALL IDCSAGP0(GDTTBL,RSUGLEN,RS06RG08,POOL1,SETZERO); 0332 00360000
*                                                                  0332 00361000
         ST    REG5,@AL00001                                       0332 00362000
         LA    @04,RSUGLEN(,REG6)                                  0332 00363000
         ST    @04,@AL00001+4                                      0332 00364000
         LA    @04,RS06RG08(,REG6)                                 0332 00365000
         ST    @04,@AL00001+8                                      0332 00366000
         LA    @04,@CC00900                                        0332 00367000
         ST    @04,@AL00001+12                                     0332 00368000
         LA    @04,SETZERO                                         0332 00369000
         ST    @04,@AL00001+16                                     0332 00370000
         MVI   @AL00001+16,X'80'                                   0332 00371000
         L     @15,GDTGPL(,REG5)                                   0332 00372000
         LA    @01,@AL00001                                        0332 00373000
         BALR  @14,@15                                             0332 00374000
*            RESPECIFY RTNREG RSTD;                                0333 00375000
*            TESTRC = RTNREG;                                      0334 00376000
         STH   RTNREG,TESTRC(,REG6)                                0334 00377000
*            RESPECIFY RTNREG UNRSTD;                              0335 00378000
*            IF TESTRC ^= 0 THEN       /*EXIT STORAGE UNAVAILABLE    */ 00379000
         LH    @04,TESTRC(,REG6)                                   0336 00380000
         LTR   @04,@04                                             0336 00381000
         BZ    @RF00336                                            0336 00382000
*              CALL AERROR;                                        0337 00383000
*                                                                  0337 00384000
         BAL   @14,AERROR                                          0337 00385000
*          END;                                                    0338 00386000
*                                                                  0338 00387000
@RF00336 DS    0H                                                  0339 00388000
*        /************************************************************/ 00389000
*        /*                                                          */ 00390000
*        /*     ESTABLISH BASE REGISTERS - GET AUTO STORAGE          */ 00391000
*        /*     THEN ESTABLISH AUTO STORAGE REGISTER                 */ 00392000
*        /*     FOR IDCRS07                                          */ 00393000
*        /*                                                          */ 00394000
*        /************************************************************/ 00395000
*                                                                  0339 00396000
*        CALL IDCRS07;                 /*EXECUTE THE PROLOGUE        */ 00397000
@RF00330 L     @15,@CV03439                                        0339 00398000
         BALR  @14,@15                                             0339 00399000
*        RSUGLEN = REG15;              /*LENGTH OF AUTO STORAGE      */ 00400000
         ST    REG15,RSUGLEN(,REG6)                                0340 00401000
*        IF RSUGLEN > 0 THEN           /*GET THE AUTO STORAGE        */ 00402000
         L     @04,RSUGLEN(,REG6)                                  0341 00403000
         LTR   @04,@04                                             0341 00404000
         BNP   @RF00341                                            0341 00405000
*          DO;                                                     0342 00406000
*                                                                  0342 00407000
*            CALL IDCSAGP0(GDTTBL,RSUGLEN,RS07RG08,POOL1,SETZERO); 0343 00408000
*                                                                  0343 00409000
         ST    REG5,@AL00001                                       0343 00410000
         LA    @04,RSUGLEN(,REG6)                                  0343 00411000
         ST    @04,@AL00001+4                                      0343 00412000
         LA    @04,RS07RG08(,REG6)                                 0343 00413000
         ST    @04,@AL00001+8                                      0343 00414000
         LA    @04,@CC00900                                        0343 00415000
         ST    @04,@AL00001+12                                     0343 00416000
         LA    @04,SETZERO                                         0343 00417000
         ST    @04,@AL00001+16                                     0343 00418000
         MVI   @AL00001+16,X'80'                                   0343 00419000
         L     @15,GDTGPL(,REG5)                                   0343 00420000
         LA    @01,@AL00001                                        0343 00421000
         BALR  @14,@15                                             0343 00422000
*            RESPECIFY RTNREG RSTD;                                0344 00423000
*            TESTRC = RTNREG;                                      0345 00424000
         STH   RTNREG,TESTRC(,REG6)                                0345 00425000
*            RESPECIFY RTNREG UNRSTD;                              0346 00426000
*            IF TESTRC ^= 0 THEN       /*EXIT STORAGE UNAVAILABLE    */ 00427000
         LH    @04,TESTRC(,REG6)                                   0347 00428000
         LTR   @04,@04                                             0347 00429000
         BZ    @RF00347                                            0347 00430000
*              CALL AERROR;                                        0348 00431000
*                                                                  0348 00432000
         BAL   @14,AERROR                                          0348 00433000
*          END;                                                    0349 00434000
@RF00347 DS    0H                                                  0350 00435000
*        /************************************************************/ 00436000
*        /*                                                          */ 00437000
*        /* THIS IS THE START OF THE FUNCTIONAL SEGMENT              */ 00438000
*        /* FOR RESETCAT.                                            */ 00439000
*        /*                                                          */ 00440000
*        /************************************************************/ 00441000
*RS01TOP:                                                          0350 00442000
*                                                                  0350 00443000
*        OLDERID2 = NEWERID2;                                      0350 00444000
@RF00341 DS    0H                                                  0350 00445000
RS01TOP  L     @04,GDTTR2(,REG5)                                   0350 00446000
         MVC   @TS00001(95),NEWERID2(@04)                          0350 00447000
         MVC   OLDERID2(95,@04),@TS00001                           0350 00448000
*        NEWID2 = 'RS01' ;                                         0351 00449000
*                                                                  0351 00450000
         MVC   NEWID2(4,@04),@CC00900                              0351 00451000
*         CALL INIT;                                               0352 00452000
         BAL   @14,INIT                                            0352 00453000
*                                      /*OPEN CATALOG AND WORKFILE   */ 00454000
*                                                                  0353 00455000
*        DO UNTIL RSENUFCI = ON;       /*REDO IF CAT MUST BE EXTD    */ 00456000
*                                                                  0353 00457000
@DL00353 DS    0H                                                  0354 00458000
*           CALL COPYCAT;                                          0354 00459000
         BAL   @14,COPYCAT                                         0354 00460000
*                                      /*COPY CATALOG TO WORKFILE    */ 00461000
*           CALL MERGECRA;                                         0355 00462000
         BAL   @14,MERGECRA                                        0355 00463000
*                                      /*COPY CRA(S) TO WORKFILE     */ 00464000
*           /* CALL TO MODULE IDCRS07 FOR PROCEDURE ENSURECI         */ 00465000
*           CALL ENSURECI;                                         0356 00466000
         L     @15,@CV03481                                        0356 00467000
         BALR  @14,@15                                             0356 00468000
*                                      /*ENSURE ENOUGH CIS           */ 00469000
*                                                                  0357 00470000
*        END;                                                      0357 00471000
*                                                                  0357 00472000
@DE00353 TM    RSENUFCI(REG6),B'10000000'                          0357 00473000
         BNO   @DL00353                                            0357 00474000
*         CALL REASSIGN;                                           0358 00475000
         BAL   @14,REASSIGN                                        0358 00476000
*                                      /*REASSIGN CI NUMS AS NEEDED  */ 00477000
*         /* CALL TO MODULE IDCRS02 FOR PROCEDURE ASSOC              */ 00478000
*         CALL ASSOC;                                              0359 00479000
         L     @15,@CV03483                                        0359 00480000
         BALR  @14,@15                                             0359 00481000
*                                      /*CHECK ASSOCIATION AND SPACE */ 00482000
*         CALL UPDCAT;                                             0360 00483000
         BAL   @14,UPDCAT                                          0360 00484000
*                                      /*UPDATE CATALOG              */ 00485000
*         CALL UPDCRA;                                             0361 00486000
         BAL   @14,UPDCRA                                          0361 00487000
*                                      /*UPDATE CRA(S)               */ 00488000
*         CALL WRAPUP;                                             0362 00489000
         BAL   @14,WRAPUP                                          0362 00490000
*                                      /*CLOSE CATALOG AND WORKFILE  */ 00491000
*                                                                  0363 00492000
*                                                                  0363 00493000
*                                                                  0363 00494000
*        IF GDTDBG = NULLPTR                                       0363 00495000
*          THEN;                                                   0363 00496000
         L     @04,GDTDBG(,REG5)                                   0363 00497000
         LTR   @04,@04                                             0363 00498000
         BZ    @RT00363                                            0363 00499000
*          ELSE                                                    0365 00500000
*            CALL IDCDB010 (GDTTBL,'RS00');                        0365 00501000
         ST    REG5,@AL00001                                       0365 00502000
         LA    @04,@CC03487                                        0365 00503000
         ST    @04,@AL00001+4                                      0365 00504000
         MVI   @AL00001+4,X'80'                                    0365 00505000
         L     @15,GDTDBG(,REG5)                                   0365 00506000
         LA    @01,@AL00001                                        0365 00507000
         BALR  @14,@15                                             0365 00508000
*/********************************************************************/ 00509000
*/*                                                                  */ 00510000
*/* PROCEDURE NAME - AERROR                                          */ 00511000
*/*                                                                  */ 00512000
*/* FUNCTION -                                                       */ 00513000
*/*    AERROR IS CALLED PRIOR TO LINKAGE BEING ESTABLISHED           */ 00514000
*/*    TO CKERR. AERROR WILL PRINT 'STORAGE UNAVAILABLE' AND         */ 00515000
*/*    TERMINATE.                                                    */ 00516000
*/*                                                                  */ 00517000
*/* INPUT -    NONE                                                  */ 00518000
*/*                                                                  */ 00519000
*/* OUTPUT - NONE                                                    */ 00520000
*/*                                                                  */ 00521000
*/* EXIT - TERMINATE VIA UEPIL                                       */ 00522000
*/*                                                                  */ 00523000
*/********************************************************************/ 00524000
*                                                                  0366 00525000
*      GENERATE;                                                   0366 00526000
@RT00363 DS    0H                                                  0366 00527000
         DS    0F                                                       00528000
NAME0011 DC    CL8'AERROR'                                              00529000
*AERROR: PROCEDURE                                                 0367 00530000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0367 00531000
*                                                                  0367 00532000
         B     @PB00002                                            0367 00533000
AERROR   DS    0H                                                  0368 00534000
*      GENERATE REFS(RS01RG08, REG6);                              0368 00535000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          00536000
         LR    @15,@13  OLD SAVE AREA                                   00537000
         LA    @13,72(@13)  NEW SAVE AREA                               00538000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     00539000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        00540000
         MVC   0(4,@15),NAME0011  PROCNAME TO REGSAVE                   00541000
*        /************************************************************/ 00542000
*        /*                                                          */ 00543000
*        /*  SET UP DARGLIST AND CALL UPRINT TO PRINT INSUFFICIENT   */ 00544000
*        /*   STORAGE MSG                                            */ 00545000
*        /*                                                          */ 00546000
*        /************************************************************/ 00547000
*        DARGLIST = DARGLIST && DARGLIST;                          0369 00548000
         L     @04,DDSTRU(,REG6)                                   0369 00549000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0369 00550000
*        DARGSTID = INSUFSTG;                                      0370 00551000
         MVC   DARGSTID(4,@04),@CF00734                            0370 00552000
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0371 00553000
         ST    REG5,@AL00001                                       0371 00554000
         LA    @04,@CF00119                                        0371 00555000
         ST    @04,@AL00001+4                                      0371 00556000
         LA    @04,DDSTRU(,REG6)                                   0371 00557000
         ST    @04,@AL00001+8                                      0371 00558000
         MVI   @AL00001+8,X'80'                                    0371 00559000
         L     @15,GDTPRT(,REG5)                                   0371 00560000
         LA    @01,@AL00001                                        0371 00561000
         BALR  @14,@15                                             0371 00562000
*        /************************************************************/ 00563000
*        /*                                                          */ 00564000
*        /*  HANDLE TERMINATION MESSAGE SEQUENCE. THE MESSAGE        */ 00565000
*        /*   PRINTED DIFFERS BETWEEN A BATCH ENVIROMENT AND A       */ 00566000
*        /*   TSO ENVIROMENT                                         */ 00567000
*        /*                                                          */ 00568000
*        /************************************************************/ 00569000
*        LASTCC = LASTCC12;                                        0372 00570000
         L     @04,RSLASTCC(,REG6)                                 0372 00571000
         MVC   LASTCC(2,@04),@CH00037                              0372 00572000
*        DARGLIST = DARGLIST && DARGLIST;                          0373 00573000
         L     @15,DDSTRU(,REG6)                                   0373 00574000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0373 00575000
*        DARGDBP = ADDR(LASTCC);                                   0374 00576000
         ST    @04,DARGDBP(,@15)                                   0374 00577000
*        DARGILP = LENGTH(LASTCC);                                 0375 00578000
         MVC   DARGILP(2,@15),@CH00157                             0375 00579000
*        IF GDTECT = NULLPTR           /*BATCH ENVIROMENT            */ 00580000
*          THEN                                                    0376 00581000
         L     @04,GDTECT(,REG5)                                   0376 00582000
         LTR   @04,@04                                             0376 00583000
         BNZ   @RF00376                                            0376 00584000
*            DARGSTID = ERRTRM;        /*IDC003I                     */ 00585000
         MVC   DARGSTID(4,@15),@CF00736                            0377 00586000
*          ELSE                                                    0378 00587000
*            DARGSTID = TSOERROR;      /*IDC0014I                    */ 00588000
         B     @RC00376                                            0378 00589000
@RF00376 L     @04,DDSTRU(,REG6)                                   0378 00590000
         MVC   DARGSTID(4,@04),@CF00738                            0378 00591000
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0379 00592000
@RC00376 ST    REG5,@AL00001                                       0379 00593000
         LA    @04,@CF00119                                        0379 00594000
         ST    @04,@AL00001+4                                      0379 00595000
         LA    @04,DDSTRU(,REG6)                                   0379 00596000
         ST    @04,@AL00001+8                                      0379 00597000
         MVI   @AL00001+8,X'80'                                    0379 00598000
         L     @15,GDTPRT(,REG5)                                   0379 00599000
         LA    @01,@AL00001                                        0379 00600000
         BALR  @14,@15                                             0379 00601000
*        /************************************************************/ 00602000
*        /*                                                          */ 00603000
*        /*  RETURN TO SYSTEM VIA UEPIL. REG 13 MUST POINT TO FIRST  */ 00604000
*        /*    BYTE OF DYANMIC STORAGE FOR THIS MODULE FOR UEPIL     */ 00605000
*        /*                                                          */ 00606000
*        /************************************************************/ 00607000
*        REG13 = REG8;                                             0380 00608000
         LR    REG13,REG8                                          0380 00609000
*        CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                       0381 00610000
*                                                                  0381 00611000
         ST    REG5,@AL00001                                       0381 00612000
         LA    @04,MODID                                           0381 00613000
         ST    @04,@AL00001+4                                      0381 00614000
         L     @04,RSLASTCC(,REG6)                                 0381 00615000
         ST    @04,@AL00001+8                                      0381 00616000
         MVI   @AL00001+8,X'80'                                    0381 00617000
         L     @15,GDTEPL(,REG5)                                   0381 00618000
         LA    @01,@AL00001                                        0381 00619000
         BALR  @14,@15                                             0381 00620000
* CALL EXIT;  /*TERMINATE*/                                        0382 00621000
         BAL   @14,EXIT                                            0382 00622000
* END AERROR; /*END OF PROCEDURE*/                                 0383 00623000
@EL00002 DS    0H                                                  0383 00624000
@EF00002 DS    0H                                                  0383 00625000
@ER00002 BR    @14                                                 0383 00626000
@PB00002 DS    0H                                                  0384 00627000
*/********************************************************************/ 00628000
*/*                                                                  */ 00629000
*/* PROCEDURE NAME - CATINIT                                         */ 00630000
*/*                                                                  */ 00631000
*/* FUNCTION - BUILD THE CONTROL INTERVAL (CI) TO RELATIVE RECORD    */ 00632000
*/*            NUMBER (RRN) TRANSLATION TABLE (CIXLT)                */ 00633000
*/*                                                                  */ 00634000
*/* INPUT -    NONE                                                  */ 00635000
*/*                                                                  */ 00636000
*/* OUTPUT -   FORMATS CIXLT TABLE                                   */ 00637000
*/*                                                                  */ 00638000
*/* EXIT, NORMAL - RETURN TO CALLER                                  */ 00639000
*/*                                                                  */ 00640000
*/********************************************************************/ 00641000
*      GENERATE;                                                   0384 00642000
         DS    0F                                                       00643000
NAME0014 DC    CL8'CATINIT'                                             00644000
*CATINIT: PROCEDURE                                                0385 00645000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0385 00646000
*                                                                  0385 00647000
         B     @PB00003                                            0385 00648000
CATINIT  DS    0H                                                  0386 00649000
*      GENERATE REFS(RS01RG08, REG6);                              0386 00650000
*                                                                  0386 00651000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          00652000
         LR    @15,@13  OLD SAVE AREA                                   00653000
         LA    @13,72(@13)  NEW SAVE AREA                               00654000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     00655000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        00656000
         ENTRY CATINIT  ENTRY POINT                                     00657000
         LM    @08,@12,RS01RG08(REG6)  PRIME BASE AND DATA REGS         00658000
         MVC   0(4,@15),NAME0014  PROCNAME TO REGSAVE                   00659000
*         OLDERID2 = NEWERID2;                                     0387 00660000
         L     @04,GDTTR2(,REG5)                                   0387 00661000
         MVC   @TS00001(95),NEWERID2(@04)                          0387 00662000
         MVC   OLDERID2(95,@04),@TS00001                           0387 00663000
*         NEWID2 = 'RSCI';                                         0388 00664000
*                                                                  0388 00665000
         MVC   NEWID2(4,@04),@CC03496                              0388 00666000
*         /***********************************************************/ 00667000
*         /*                                                         */ 00668000
*         /*  GET CATALOG CCR RECORD VIA RECMGMT.                    */ 00669000
*         /*                                                         */ 00670000
*         /***********************************************************/ 00671000
*                                                                  0389 00672000
*         RSGRABCU = ADDR(GRABSCA);                                0389 00673000
         L     @04,RSIOTBL(,REG6)                                  0389 00674000
         LA    @04,GRABSCA(,@04)                                   0389 00675000
         ST    @04,RSGRABCU(,REG6)                                 0389 00676000
*         GRABCURR = GRABRAB1;                                     0390 00677000
         L     @15,GRABRAB1(,@04)                                  0390 00678000
         ST    @15,GRABCURR(,@04)                                  0390 00679000
*         RABRCDA = CCRCI;                                         0391 00680000
*                                                                  0391 00681000
*                                                                  0391 00682000
         MVC   RABRCDA(4,@15),@CF00166                             0391 00683000
*         DO;                                                      0392 00684000
*           RSRTYPE = ''B;                                         0393 00685000
         MVI   RSRTYPE(REG6),X'00'                                 0393 00686000
*           RSRGET = ON;      /* GETRCD  */                        0394 00687000
         OI    RSRGET(REG6),B'10000000'                            0394 00688000
*           RSRUPD = OFF;     /* NO UPDATE  */                     0395 00689000
         NI    RSRUPD(REG6),B'11110111'                            0395 00690000
*           RSRDS = ''B;                                           0396 00691000
         NI    RSRDS(REG6),B'00011111'                             0396 00692000
*           RSRCAT = ON;      /* CATALOG  */                       0397 00693000
*           RSRDIR = ON;      /* DIRECT  */                        0398 00694000
*           RSRKEY = OFF;     /* CNV  */                           0399 00695000
*                                                                  0399 00696000
         OI    RSRCAT(REG6),B'01000100'                            0399 00697000
         NI    RSRKEY(REG6),B'11101111'                            0399 00698000
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */ 00699000
*         CALL RECMGMT;                                            0400 00700000
         L     @15,@CV03498                                        0400 00701000
         BALR  @14,@15                                             0400 00702000
*           RFY RTNREG RSTD;                                       0401 00703000
*           TESTRC = RTNREG;                                       0402 00704000
         STH   RTNREG,TESTRC(,REG6)                                0402 00705000
*           RFY RTNREG UNRSTD;                                     0403 00706000
*         END;                                                     0404 00707000
*                                                                  0404 00708000
*                                                                  0404 00709000
*         /***********************************************************/ 00710000
*         /*                                                         */ 00711000
*         /*  SAVE NEXT UNFORMATTED FREE CI IN MAIN WORKAREA         */ 00712000
*         /*                                                         */ 00713000
*         /***********************************************************/ 00714000
*                                                                  0405 00715000
*         RSCANFCI = CCRNFCI;                                      0405 00716000
*                                                                  0405 00717000
         L     @04,RSGRABCU(,REG6)                                 0405 00718000
         L     @04,GRABCURR(,@04)                                  0405 00719000
         LA    @15,8                                               0405 00720000
         ALR   @15,@04                                             0405 00721000
         SLR   @14,@14                                             0405 00722000
         ICM   @14,7,CCRNFCI(@15)                                  0405 00723000
         ST    @14,RSCANFCI(,REG6)                                 0405 00724000
*         /***********************************************************/ 00725000
*         /*                                                         */ 00726000
*         /*  SAVE HIGH ALLOCATED LOW KEY RANGE CI IN MAIN           */ 00727000
*         /*  WORKAREA                                               */ 00728000
*         /*                                                         */ 00729000
*         /***********************************************************/ 00730000
*                                                                  0406 00731000
*         RSCAHALC = CCRHACI;                                      0406 00732000
*                                                                  0406 00733000
         SLR   @14,@14                                             0406 00734000
         ICM   @14,7,CCRHACI(@15)                                  0406 00735000
         ST    @14,RSCAHALC(,REG6)                                 0406 00736000
*         /***********************************************************/ 00737000
*         /*                                                         */ 00738000
*         /*  GET CATALOG DATA RECORD VIA RECMGMT.                   */ 00739000
*         /*  COMPUTE HIGH ALLOCATED DATA CI AND SAVE IN             */ 00740000
*         /*  MAIN WORKAREA.                                         */ 00741000
*         /*                                                         */ 00742000
*         /***********************************************************/ 00743000
*                                                                  0407 00744000
*         RABRCDA = DATACI;                                        0407 00745000
*                                                                  0407 00746000
*                                                                  0407 00747000
         SLR   @15,@15                                             0407 00748000
         ST    @15,RABRCDA(,@04)                                   0407 00749000
*         DO;                                                      0408 00750000
*           RSRTYPE = ''B;                                         0409 00751000
         MVI   RSRTYPE(REG6),X'00'                                 0409 00752000
*           RSRGET = ON;      /* GETRCD  */                        0410 00753000
         OI    RSRGET(REG6),B'10000000'                            0410 00754000
*           RSRUPD = OFF;     /* NO UPDATE  */                     0411 00755000
         NI    RSRUPD(REG6),B'11110111'                            0411 00756000
*           RSRDS = ''B;                                           0412 00757000
         NI    RSRDS(REG6),B'00011111'                             0412 00758000
*           RSRCAT = ON;      /* CATALOG  */                       0413 00759000
*           RSRDIR = ON;      /* DIRECT  */                        0414 00760000
*           RSRKEY = OFF;     /* CNV  */                           0415 00761000
*                                                                  0415 00762000
         OI    RSRCAT(REG6),B'01000100'                            0415 00763000
         NI    RSRKEY(REG6),B'11101111'                            0415 00764000
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */ 00765000
*         CALL RECMGMT;                                            0416 00766000
         L     @15,@CV03498                                        0416 00767000
         BALR  @14,@15                                             0416 00768000
*           RFY RTNREG RSTD;                                       0417 00769000
*           TESTRC = RTNREG;                                       0418 00770000
         STH   RTNREG,TESTRC(,REG6)                                0418 00771000
*           RFY RTNREG UNRSTD;                                     0419 00772000
*         END;                                                     0420 00773000
*                                                                  0420 00774000
*         RSCAHACI = CHIA/CILEN;                                   0421 00775000
*                                                                  0421 00776000
         L     @04,RSGRABCU(,REG6)                                 0421 00777000
         L     @04,GRABCURR(,@04)                                  0421 00778000
         ICM   @15,15,CHIA+8(@04)                                  0421 00779000
         SRL   @15,9                                               0421 00780000
         ST    @15,RSCAHACI(,REG6)                                 0421 00781000
*         /***********************************************************/ 00782000
*         /*                                                         */ 00783000
*         /*  COMPUTE FIRST WORKFILE RRN AVAILABLE FOR ALLOCATION    */ 00784000
*         /*                                                         */ 00785000
*         /***********************************************************/ 00786000
*                                                                  0422 00787000
*         RSWFNEXT = RSCAHALC + 2;                                 0422 00788000
*                                                                  0422 00789000
         LA    @04,2                                               0422 00790000
         AL    @04,RSCAHALC(,REG6)                                 0422 00791000
         ST    @04,RSWFNEXT(,REG6)                                 0422 00792000
*         /***********************************************************/ 00793000
*         /*                                                         */ 00794000
*         /*  FREE EOV STORAGE POOL                                  */ 00795000
*         /*                                                         */ 00796000
*         /***********************************************************/ 00797000
*                                                                  0423 00798000
*         CALL IDCSAFP0 (GDTTBL,POOL2);                            0423 00799000
*                                                                  0423 00800000
         ST    REG5,@AL00001                                       0423 00801000
         LA    @04,@CC00902                                        0423 00802000
         ST    @04,@AL00001+4                                      0423 00803000
         MVI   @AL00001+4,X'80'                                    0423 00804000
         L     @15,GDTFPL(,REG5)                                   0423 00805000
         LA    @01,@AL00001                                        0423 00806000
         BALR  @14,@15                                             0423 00807000
*         /***********************************************************/ 00808000
*         /*                                                         */ 00809000
*         /*  INITIALIZE MAIN WORKAREA POINTERS,COUNTERS AND FLAGS   */ 00810000
*         /*                                                         */ 00811000
*         /***********************************************************/ 00812000
*                                                                  0424 00813000
*         RSVOLLST = 0;                                            0424 00814000
         SLR   @04,@04                                             0424 00815000
         ST    @04,RSVOLLST(,REG6)                                 0424 00816000
*         RSAVAIL  = 0;                                            0425 00817000
         ST    @04,RSAVAIL(,REG6)                                  0425 00818000
*         RSREASS  = 0;                                            0426 00819000
         ST    @04,RSREASS(,REG6)                                  0426 00820000
*         RSF1RNAM = 0;                                    /*@ZA18274*/ 00821000
         ST    @04,RSF1RNAM(,REG6)                                 0427 00822000
*         RSCHCRAN = 0;                                    /*@ZA18274*/ 00823000
         ST    @04,RSCHCRAN(,REG6)                                 0428 00824000
*         RSAVAILN = 0;                                            0429 00825000
         ST    @04,RSAVAILN(,REG6)                                 0429 00826000
*         RSREASSN = 0;                                            0430 00827000
         ST    @04,RSREASSN(,REG6)                                 0430 00828000
*         RSFLAGSI = ''B;                                          0431 00829000
*                                                                  0431 00830000
         XC    RSFLAGSI(3,REG6),RSFLAGSI(REG6)                     0431 00831000
*         /***********************************************************/ 00832000
*         /*                                                 @ZA18272*/ 00833000
*         /*  CLEAN UP WORKFILE RECMGMT CONTROL BLOCKS       @ZA18272*/ 00834000
*         /*                                                 @ZA18272*/ 00835000
*         /***********************************************************/ 00836000
*                                                                  0432 00837000
*                                                                  0432 00838000
*         DO;                                                      0432 00839000
*           RSRECREQ = ''B;                                        0433 00840000
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0433 00841000
*           RSRTERM = ON;     /* TERMRCD */                        0434 00842000
         OI    RSRTERM(REG6),B'00000010'                           0434 00843000
*           RSRWF = ON;       /* WORKFILE */                       0435 00844000
*                                                                  0435 00845000
         OI    RSRWF(REG6),B'10000000'                             0435 00846000
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */ 00847000
*         CALL RECMGMT;                                            0436 00848000
         L     @15,@CV03498                                        0436 00849000
         BALR  @14,@15                                             0436 00850000
*           RFY RTNREG RSTD;                                       0437 00851000
*           TESTRC = RTNREG;                                       0438 00852000
         STH   RTNREG,TESTRC(,REG6)                                0438 00853000
*           RFY RTNREG UNRSTD;                                     0439 00854000
*         END;                                  /*@ZA18272*/       0440 00855000
*                                                                  0440 00856000
*         /***********************************************************/ 00857000
*         /*                                                         */ 00858000
*         /*  BUILD CIXLT TABLE.                                     */ 00859000
*         /*                                                         */ 00860000
*         /***********************************************************/ 00861000
*                                                                  0441 00862000
*         RSCIDFCI = 0;                                            0441 00863000
         SLR   @04,@04                                             0441 00864000
         ST    @04,RSCIDFCI(,REG6)                                 0441 00865000
*         RSCIEXPT = ADDR(RSCIEXT);                                0442 00866000
*                                                                  0442 00867000
         LA    @04,RSCIEXT(,REG6)                                  0442 00868000
         ST    @04,RSCIEXPT(,REG6)                                 0442 00869000
*         /***********************************************************/ 00870000
*         /*                                                         */ 00871000
*         /*  GET CATALOG LKR DATA RECORD VIA RECMGMT.               */ 00872000
*         /*                                                         */ 00873000
*         /***********************************************************/ 00874000
*                                                                  0443 00875000
*         RABRCDA = LKRDATCI;                                      0443 00876000
*                                                                  0443 00877000
*                                                                  0443 00878000
         L     @04,RSGRABCU(,REG6)                                 0443 00879000
         L     @04,GRABCURR(,@04)                                  0443 00880000
         MVC   RABRCDA(4,@04),@CF00287                             0443 00881000
*         DO;                                                      0444 00882000
*           RSRTYPE = ''B;                                         0445 00883000
         MVI   RSRTYPE(REG6),X'00'                                 0445 00884000
*           RSRGET = ON;      /* GETRCD  */                        0446 00885000
         OI    RSRGET(REG6),B'10000000'                            0446 00886000
*           RSRUPD = OFF;     /* NO UPDATE  */                     0447 00887000
         NI    RSRUPD(REG6),B'11110111'                            0447 00888000
*           RSRDS = ''B;                                           0448 00889000
         NI    RSRDS(REG6),B'00011111'                             0448 00890000
*           RSRCAT = ON;      /* CATALOG  */                       0449 00891000
*           RSRDIR = ON;      /* DIRECT  */                        0450 00892000
*           RSRKEY = OFF;     /* CNV  */                           0451 00893000
*                                                                  0451 00894000
         OI    RSRCAT(REG6),B'01000100'                            0451 00895000
         NI    RSRKEY(REG6),B'11101111'                            0451 00896000
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */ 00897000
*         CALL RECMGMT;                                            0452 00898000
         L     @15,@CV03498                                        0452 00899000
         BALR  @14,@15                                             0452 00900000
*           RFY RTNREG RSTD;                                       0453 00901000
*           TESTRC = RTNREG;                                       0454 00902000
         STH   RTNREG,TESTRC(,REG6)                                0454 00903000
*           RFY RTNREG UNRSTD;                                     0455 00904000
*         END;                                                     0456 00905000
*                                                                  0456 00906000
*         /***********************************************************/ 00907000
*         /*                                                         */ 00908000
*         /*    POINT TO FIRST EXTENT DESCRIPTOR IN CATALOG          */ 00909000
*         /*    LOW KEY RANGE DATA RECORD. FIND CONTROL INFORMATION  */ 00910000
*         /*    VIA CATRCDSU.                                        */ 00911000
*         /*                                                         */ 00912000
*         /***********************************************************/ 00913000
*                                                                  0457 00914000
*         /* CALL TO MODULE IDCRS03 FOR PROCEDURE CATRCDSU           */ 00915000
*         CALL CATRCDSU;                                           0457 00916000
*                                                                  0457 00917000
         L     @15,@CV03499                                        0457 00918000
         BALR  @14,@15                                             0457 00919000
*         RSCPE6 = RSCPE3;                                         0458 00920000
*                                                                  0458 00921000
         L     @04,RSCPE3(,REG6)                                   0458 00922000
         ST    @04,RSCPE6(,REG6)                                   0458 00923000
*         /***********************************************************/ 00924000
*         /*                                                         */ 00925000
*         /*    POINT TO FIRST VARIABLE FIELD.                       */ 00926000
*         /*                                                         */ 00927000
*         /***********************************************************/ 00928000
*                                                                  0459 00929000
*         RSCPE7 = RSCPE6 + LENFIX;                                0459 00930000
*                                                                  0459 00931000
         SLR   @15,@15                                             0459 00932000
         IC    @15,LENFIX(,@04)                                    0459 00933000
         ALR   @15,@04                                             0459 00934000
         ST    @15,RSCPE7(,REG6)                                   0459 00935000
*         /***********************************************************/ 00936000
*         /*                                                         */ 00937000
*         /*    THE EXTENT DESCRIPTOR FIELD IS THE THIRD VARIABLE    */ 00938000
*         /*    FIELD. SKIP THE FIRST TWO VARIABLE FIELDS TO GET     */ 00939000
*         /*    TO IT.                                               */ 00940000
*         /*                                                         */ 00941000
*         /***********************************************************/ 00942000
*                                                                  0460 00943000
*CATILP1: DO RSIDX = 1 TO 2;                                       0460 00944000
*                                                                  0460 00945000
CATILP1  LA    @04,1                                               0460 00946000
         STH   @04,RSIDX(,REG6)                                    0460 00947000
@DL00460 DS    0H                                                  0461 00948000
*           RSCPE7 = RSCPE7 + VARLEN + LENGTH(VARLEN);             0461 00949000
*                                                                  0461 00950000
         L     @04,RSCPE7(,REG6)                                   0461 00951000
         ICM   @15,12,VARLEN(@04)                                  0461 00952000
         SRA   @15,16                                              0461 00953000
         ALR   @15,@04                                             0461 00954000
         AL    @15,@CF00157                                        0461 00955000
         ST    @15,RSCPE7(,REG6)                                   0461 00956000
*         END CATILP1;                                             0462 00957000
*                                                                  0462 00958000
         LA    @04,1                                               0462 00959000
         AH    @04,RSIDX(,REG6)                                    0462 00960000
         STH   @04,RSIDX(,REG6)                                    0462 00961000
         C     @04,@CF00157                                        0462 00962000
         BNH   @DL00460                                            0462 00963000
*         /***********************************************************/ 00964000
*         /*                                                         */ 00965000
*         /*    MOVE FIRST EXTENT TO SAVE AREA. SET NEXT CI TO 0.    */ 00966000
*         /*                                                         */ 00967000
*         /***********************************************************/ 00968000
*                                                                  0463 00969000
*         RSCIEXCU = RSCPE7 + LENGTH(VARLEN);                      0463 00970000
         LA    @04,2                                               0463 00971000
         AL    @04,RSCPE7(,REG6)                                   0463 00972000
         ST    @04,RSCIEXCU(,REG6)                                 0463 00973000
*         RSCIEXT = RSCIEXCU -> CATIEXT;                           0464 00974000
         MVC   RSCIEXT(20,REG6),CATIEXT(@04)                       0464 00975000
*         RSCINXCI = 0;                                            0465 00976000
*                                                                  0465 00977000
         SLR   @04,@04                                             0465 00978000
         ST    @04,RSCINXCI(,REG6)                                 0465 00979000
*         /***********************************************************/ 00980000
*         /*                                                         */ 00981000
*         /*  PROCESS EACH CIXLT ENTRY.                              */ 00982000
*         /*                                                         */ 00983000
*         /***********************************************************/ 00984000
*                                                                  0466 00985000
*CATILP2: DO RSIDX = 1 TO DIM(RSXCIENT);                           0466 00986000
*                                                                  0466 00987000
CATILP2  LA    @04,1                                               0466 00988000
         STH   @04,RSIDX(,REG6)                                    0466 00989000
@DL00466 DS    0H                                                  0467 00990000
*         /***********************************************************/ 00991000
*         /*                                                         */ 00992000
*         /*    CLEAR THE ENTRY.                                     */ 00993000
*         /*                                                         */ 00994000
*         /***********************************************************/ 00995000
*                                                                  0467 00996000
*           RSXCIENT(RSIDX) = ''B;                                 0467 00997000
*                                                                  0467 00998000
         LH    @04,RSIDX(,REG6)                                    0467 00999000
         SLA   @04,4                                               0467 01000000
         L     @01,RSCIXLTA(,REG6)                                 0467 01001000
         ALR   @01,@04                                             0467 01002000
         AL    @01,@CF03776                                        0467 01003000
         XC    RSXCIENT-8(16,@01),RSXCIENT-8(@01)                  0467 01004000
*         /***********************************************************/ 01005000
*         /*                                                         */ 01006000
*         /*    PROCESS ANOTHER EXTENT DESCRIPTOR.                   */ 01007000
*         /*                                                         */ 01008000
*         /***********************************************************/ 01009000
*                                                                  0468 01010000
*           IF VARLEN ^= 0                                         0468 01011000
*             THEN                                                 0468 01012000
         L     @04,RSCPE7(,REG6)                                   0468 01013000
         ICM   @15,3,VARLEN(@04)                                   0468 01014000
         BZ    @RF00468                                            0468 01015000
*CATIEX:        DO;                                                0469 01016000
*                                                                  0469 01017000
CATIEX   DS    0H                                                  0470 01018000
*         /***********************************************************/ 01019000
*         /*                                                         */ 01020000
*         /*    HIGH KEY RANGE EXTENT.                               */ 01021000
*         /*                                                         */ 01022000
*         /***********************************************************/ 01023000
*                                                                  0470 01024000
*                 RSCILCI = CATILRBA/CILEN;                        0470 01025000
         L     @04,RSCIEXPT(,REG6)                                 0470 01026000
         L     @00,CATILRBA(,@04)                                  0470 01027000
         SRDA  @00,32                                              0470 01028000
         D     @00,@CF00745                                        0470 01029000
         ST    @01,RSCILCI(,REG6)                                  0470 01030000
*                 IF RSCILCI ^= RSCINXCI                           0471 01031000
*                   THEN                                           0471 01032000
         C     @01,RSCINXCI(,REG6)                                 0471 01033000
         BE    @RF00471                                            0471 01034000
*CATIHKR:             DO;                                          0472 01035000
*                                                                  0472 01036000
CATIHKR  DS    0H                                                  0473 01037000
*         /***********************************************************/ 01038000
*         /*                                                         */ 01039000
*         /*    SET HKR FLAG, STARTING CI, COUNT OF CIS AND          */ 01040000
*         /*    TRANSLATION FACTOR OF 1 IN CIXLT ENTRY.              */ 01041000
*         /*                                                         */ 01042000
*         /***********************************************************/ 01043000
*                                                                  0473 01044000
*                       RSXCIRNG(RSIDX) = ON;                      0473 01045000
         LH    @04,RSIDX(,REG6)                                    0473 01046000
         SLA   @04,4                                               0473 01047000
         L     @15,RSCIXLTA(,REG6)                                 0473 01048000
         ST    @04,@TF00001                                        0473 01049000
         ALR   @04,@15                                             0473 01050000
         OI    RSXCIRNG-16(@04),B'10000000'                        0473 01051000
*                       RSXCIBEG(RSIDX) = RSCINXCI;                0474 01052000
         L     @04,RSCINXCI(,REG6)                                 0474 01053000
         L     @14,@TF00001                                        0474 01054000
         AL    @14,@CF03776                                        0474 01055000
         ST    @04,RSXCIBEG-8(@14,@15)                             0474 01056000
*                       RSCINXCI = RSCILCI;                        0475 01057000
         L     @14,RSCILCI(,REG6)                                  0475 01058000
         ST    @14,RSCINXCI(,REG6)                                 0475 01059000
*                       RSXCILN(RSIDX) = RSCINXCI - RSXCIBEG(RSIDX);    01060000
         SLR   @14,@04                                             0476 01061000
         L     @04,@TF00001                                        0476 01062000
         AL    @04,@CF03777                                        0476 01063000
         ST    @14,RSXCILN-12(@04,@15)                             0476 01064000
*                       RSXCIREL(RSIDX) = 1;                       0477 01065000
*                                                                  0477 01066000
         LA    @04,1                                               0477 01067000
         L     @14,@TF00001                                        0477 01068000
         ST    @04,RSXCIREL-16(@14,@15)                            0477 01069000
*                     END CATIHKR;                                 0478 01070000
*                                                                  0478 01071000
*         /***********************************************************/ 01072000
*         /*                                                         */ 01073000
*         /*    LOW KEY RANGE EXTENT.                                */ 01074000
*         /*                                                         */ 01075000
*         /***********************************************************/ 01076000
*                                                                  0479 01077000
*                   ELSE                                           0479 01078000
*CATILKR:             DO;                                          0479 01079000
*                                                                  0479 01080000
         B     @RC00471                                            0479 01081000
@RF00471 DS    0H                                                  0479 01082000
CATILKR  DS    0H                                                  0480 01083000
*         /***********************************************************/ 01084000
*         /*                                                         */ 01085000
*         /*    SET LKR FLAG, STARTING CI, COUNT OF CIS AND          */ 01086000
*         /*    TRANSLATION FACTOR OF 1 IN CIXLT ENTRY.              */ 01087000
*         /*                                                         */ 01088000
*         /***********************************************************/ 01089000
*                                                                  0480 01090000
*                       RSXCIRNG(RSIDX) = OFF;                     0480 01091000
         LH    @04,RSIDX(,REG6)                                    0480 01092000
         LR    @15,@04                                             0480 01093000
         SLA   @15,4                                               0480 01094000
         L     @14,RSCIXLTA(,REG6)                                 0480 01095000
         ST    @15,@TF00001                                        0480 01096000
         ALR   @15,@14                                             0480 01097000
         NI    RSXCIRNG-16(@15),B'01111111'                        0480 01098000
*                       RSCISVLK = RSIDX;                          0481 01099000
         STC   @04,RSCISVLK(,REG6)                                 0481 01100000
*                       RSXCIBEG(RSIDX) = RSCINXCI;                0482 01101000
         L     @04,RSCINXCI(,REG6)                                 0482 01102000
         L     @15,@TF00001                                        0482 01103000
         AL    @15,@CF03776                                        0482 01104000
         ST    @04,RSXCIBEG-8(@15,@14)                             0482 01105000
*                       RSCINXCI = CATIHRBA/CILEN + 1;             0483 01106000
         LA    @15,1                                               0483 01107000
         L     @01,RSCIEXPT(,REG6)                                 0483 01108000
         L     @00,CATIHRBA(,@01)                                  0483 01109000
         SRDA  @00,32                                              0483 01110000
         D     @00,@CF00745                                        0483 01111000
         ALR   @01,@15                                             0483 01112000
         ST    @01,RSCINXCI(,REG6)                                 0483 01113000
*                       RSXCILN(RSIDX) = RSCINXCI - RSXCIBEG(RSIDX);    01114000
         SLR   @01,@04                                             0484 01115000
         L     @04,@TF00001                                        0484 01116000
         AL    @04,@CF03777                                        0484 01117000
         ST    @01,RSXCILN-12(@04,@14)                             0484 01118000
*                       RSXCIREL(RSIDX) = 1;                       0485 01119000
*                                                                  0485 01120000
         L     @04,@TF00001                                        0485 01121000
         ST    @15,RSXCIREL-16(@04,@14)                            0485 01122000
*         /***********************************************************/ 01123000
*         /*                                                         */ 01124000
*         /*    DECREMENT VARIABLE LENGTH BY LENGTH OF THIS EXTENT.  */ 01125000
*         /*    IF THERE IS ANOTHER EXTENT, MOVE IT TO THE SAVE AREA.*/ 01126000
*         /*                                                         */ 01127000
*         /***********************************************************/ 01128000
*                                                                  0486 01129000
*                       VARLEN = VARLEN - LENGTH(CATIEXT);         0486 01130000
         L     @04,RSCPE7(,REG6)                                   0486 01131000
         LA    @15,20                                              0486 01132000
         ICM   @14,12,VARLEN(@04)                                  0486 01133000
         SRA   @14,16                                              0486 01134000
         SLR   @14,@15                                             0486 01135000
         STCM  @14,3,VARLEN(@04)                                   0486 01136000
*                       IF VARLEN ^= 0                             0487 01137000
*                         THEN                                     0487 01138000
         LTR   @14,@14                                             0487 01139000
         BZ    @RF00487                                            0487 01140000
*                           DO;                                    0488 01141000
*                             RSCIEXCU = RSCIEXCU + LENGTH(CATIEXT);    01142000
         AL    @15,RSCIEXCU(,REG6)                                 0489 01143000
         ST    @15,RSCIEXCU(,REG6)                                 0489 01144000
*                             RSCIEXT = RSCIEXCU -> CATIEXT;       0490 01145000
         MVC   RSCIEXT(20,REG6),CATIEXT(@15)                       0490 01146000
*                           END;                                   0491 01147000
*                                                                  0491 01148000
*                     END CATILKR;                                 0492 01149000
*                                                                  0492 01150000
*               END CATIEX;                                        0493 01151000
*                                                                  0493 01152000
*         /***********************************************************/ 01153000
*         /*                                                         */ 01154000
*         /*  NO MORE EXTENT DESCRIPTORS TO PROCESS.                 */ 01155000
*         /*                                                         */ 01156000
*         /***********************************************************/ 01157000
*                                                                  0494 01158000
*             ELSE                                                 0494 01159000
*CATINOEX:      DO;                                                0494 01160000
*                                                                  0494 01161000
         B     @RC00468                                            0494 01162000
@RF00468 DS    0H                                                  0494 01163000
CATINOEX DS    0H                                                  0495 01164000
*         /***********************************************************/ 01165000
*         /*                                                         */ 01166000
*         /*    PROCESS LAST HKR EXTENT.                             */ 01167000
*         /*                                                         */ 01168000
*         /***********************************************************/ 01169000
*                                                                  0495 01170000
*                 IF RSCINXCI <= RSCAHACI                          0495 01171000
*                   THEN                                           0495 01172000
         L     @04,RSCINXCI(,REG6)                                 0495 01173000
         C     @04,RSCAHACI(,REG6)                                 0495 01174000
         BH    @RF00495                                            0495 01175000
*CATILH:              DO;                                          0496 01176000
*                                                                  0496 01177000
CATILH   DS    0H                                                  0497 01178000
*         /***********************************************************/ 01179000
*         /*                                                         */ 01180000
*         /*    SET HKR FLAG, STARTING CI, COUNT OF CIS AND          */ 01181000
*         /*    TRANSLATION FACTOR OF 0 (NOT ACTIVE) IN ENTRY.       */ 01182000
*         /*                                                         */ 01183000
*         /***********************************************************/ 01184000
*                                                                  0497 01185000
*                       RSXCIRNG(RSIDX) = ON;                      0497 01186000
         LH    @04,RSIDX(,REG6)                                    0497 01187000
         LR    @15,@04                                             0497 01188000
         SLA   @15,4                                               0497 01189000
         L     @14,RSCIXLTA(,REG6)                                 0497 01190000
         ST    @15,@TF00001                                        0497 01191000
         ALR   @15,@14                                             0497 01192000
         OI    RSXCIRNG-16(@15),B'10000000'                        0497 01193000
*                       RSXCIBEG(RSIDX) = RSCINXCI;                0498 01194000
         L     @15,RSCINXCI(,REG6)                                 0498 01195000
         L     @01,@TF00001                                        0498 01196000
         AL    @01,@CF03776                                        0498 01197000
         ST    @15,RSXCIBEG-8(@01,@14)                             0498 01198000
*                       RSCINXCI = RSCAHACI + 1;                   0499 01199000
         LA    @03,1                                               0499 01200000
         L     @02,RSCAHACI(,REG6)                                 0499 01201000
         ALR   @02,@03                                             0499 01202000
         ST    @02,RSCINXCI(,REG6)                                 0499 01203000
*                       RSXCILN(RSIDX) = RSCINXCI - RSXCIBEG(RSIDX);    01204000
         SLR   @02,@15                                             0500 01205000
         L     @15,@TF00001                                        0500 01206000
         AL    @15,@CF03777                                        0500 01207000
         ST    @02,RSXCILN-12(@15,@14)                             0500 01208000
*                       RSIDX = RSIDX + 1;                         0501 01209000
         ALR   @04,@03                                             0501 01210000
         STH   @04,RSIDX(,REG6)                                    0501 01211000
*                       RSXCIENT(RSIDX) = ''B;                     0502 01212000
*                                                                  0502 01213000
         SLA   @04,4                                               0502 01214000
         ALR   @14,@04                                             0502 01215000
         AL    @14,@CF03776                                        0502 01216000
         XC    RSXCIENT-8(16,@14),RSXCIENT-8(@14)                  0502 01217000
*                     END CATILH;                                  0503 01218000
*                                                                  0503 01219000
*         /***********************************************************/ 01220000
*         /*                                                         */ 01221000
*         /*    SET UP REMAINING ENTRIES IN CIXLT TABLE.             */ 01222000
*         /*                                                         */ 01223000
*         /***********************************************************/ 01224000
*                                                                  0504 01225000
*                                                                  0504 01226000
*         /***********************************************************/ 01227000
*         /*                                                         */ 01228000
*         /*    COMPUTE DEFAULT COUNT OF CIS FOR REMAINING ENTRIES.  */ 01229000
*         /*                                                         */ 01230000
*         /***********************************************************/ 01231000
*                                                                  0504 01232000
*                 IF RSCIDFCI = 0                                  0504 01233000
*                   THEN                                           0504 01234000
@RF00495 SLR   @04,@04                                             0504 01235000
         C     @04,RSCIDFCI(,REG6)                                 0504 01236000
         BNE   @RF00504                                            0504 01237000
*                     DO;                                          0505 01238000
*                       IF RSCATSCN ^= 0 THEN /*CAT HAS SCNDY SPC    */ 01239000
         L     @15,RSCATSCN(,REG6)                                 0506 01240000
         CR    @15,@04                                             0506 01241000
         BE    @RF00506                                            0506 01242000
*                         DO;                                      0507 01243000
*                           RSCIRMEN = DIM(RSXCIENT) - MAXEXTNT;   0508 01244000
         MVC   RSCIRMEN(4,REG6),@CF03733                           0508 01245000
*                           RSCIREMC = RSCINXCI +                  0509 01246000
*                                      (MAXEXTNT + 1 - RSIDX)*RSCATSCN; 01247000
         LA    @01,17                                              0509 01248000
         SH    @01,RSIDX(,REG6)                                    0509 01249000
         MR    @00,@15                                             0509 01250000
         AL    @01,RSCINXCI(,REG6)                                 0509 01251000
         ST    @01,RSCIREMC(,REG6)                                 0509 01252000
*                         END;                                     0510 01253000
*                       ELSE           /*CAT HAS NO SECONDARY SPACE  */ 01254000
*                         DO;                                      0511 01255000
         B     @RC00506                                            0511 01256000
@RF00506 DS    0H                                                  0512 01257000
*                           RSCIRMEN = DIM(RSXCIENT) - (RSIDX - 1);     01258000
         LA    @04,1                                               0512 01259000
         SH    @04,RSIDX(,REG6)                                    0512 01260000
         AL    @04,@CF01850                                        0512 01261000
         ST    @04,RSCIRMEN(,REG6)                                 0512 01262000
*                           RSCIREMC = RSCINXCI;                   0513 01263000
         L     @04,RSCINXCI(,REG6)                                 0513 01264000
         ST    @04,RSCIREMC(,REG6)                                 0513 01265000
*                         END;                                     0514 01266000
*                       RSCIDFCI = (MAXCINO - RSCIREMC             0515 01267000
*                                  + RSCIRMEN)/RSCIRMEN;           0515 01268000
@RC00506 L     @04,MAXCINO                                         0515 01269000
         SL    @04,RSCIREMC(,REG6)                                 0515 01270000
         L     @15,RSCIRMEN(,REG6)                                 0515 01271000
         ALR   @04,@15                                             0515 01272000
         LR    @00,@04                                             0515 01273000
         SRDA  @00,32                                              0515 01274000
         DR    @00,@15                                             0515 01275000
         ST    @01,RSCIDFCI(,REG6)                                 0515 01276000
*                     END;                                         0516 01277000
*                                                                  0516 01278000
*         /***********************************************************/ 01279000
*         /*                                                         */ 01280000
*         /*    COMPUTE DEFAULT COUNT OF CIS FOR LAST ENTRY.         */ 01281000
*         /*                                                         */ 01282000
*         /***********************************************************/ 01283000
*                                                                  0517 01284000
*                 IF RSIDX = DIM(RSXCIENT)                         0517 01285000
*                   THEN                                           0517 01286000
@RF00504 CLC   RSIDX(2,REG6),@CH01850                              0517 01287000
         BNE   @RF00517                                            0517 01288000
*                     RSCIDFCI = MAXCINO + 1 - RSCINXCI;           0518 01289000
*                                                                  0518 01290000
         LA    @04,1                                               0518 01291000
         AL    @04,MAXCINO                                         0518 01292000
         SL    @04,RSCINXCI(,REG6)                                 0518 01293000
         ST    @04,RSCIDFCI(,REG6)                                 0518 01294000
*         /***********************************************************/ 01295000
*         /*                                                         */ 01296000
*         /*    SET LKR FLAG, STARTING CI, COUNT OF CIS AND          */ 01297000
*         /*    TRANSLATION FACTOR OF 0 (NOT ACTIVE) IN ENTRY.       */ 01298000
*         /*                                                         */ 01299000
*         /***********************************************************/ 01300000
*                                                                  0519 01301000
*                 RSXCIRNG(RSIDX) = OFF;                           0519 01302000
@RF00517 LH    @04,RSIDX(,REG6)                                    0519 01303000
         LR    @15,@04                                             0519 01304000
         SLA   @15,4                                               0519 01305000
         L     @14,RSCIXLTA(,REG6)                                 0519 01306000
         ST    @15,@TF00001                                        0519 01307000
         ALR   @15,@14                                             0519 01308000
         NI    RSXCIRNG-16(@15),B'01111111'                        0519 01309000
*                 RSXCIBEG(RSIDX) = RSCINXCI;                      0520 01310000
         L     @15,RSCINXCI(,REG6)                                 0520 01311000
         L     @01,@TF00001                                        0520 01312000
         AL    @01,@CF03776                                        0520 01313000
         ST    @15,RSXCIBEG-8(@01,@14)                             0520 01314000
*                 IF RSIDX =< MAXEXTNT & RSCATSCN ^= 0             0521 01315000
*                   THEN                                           0521 01316000
         C     @04,@CF00478                                        0521 01317000
         BH    @RF00521                                            0521 01318000
         L     @04,RSCATSCN(,REG6)                                 0521 01319000
         LTR   @04,@04                                             0521 01320000
         BZ    @RF00521                                            0521 01321000
*                     DO;                                          0522 01322000
*                       RSCINXCI = RSXCIBEG(RSIDX) + RSCATSCN;     0523 01323000
         ALR   @15,@04                                             0523 01324000
         ST    @15,RSCINXCI(,REG6)                                 0523 01325000
*                       RSXCILN(RSIDX) = RSCATSCN;                 0524 01326000
         L     @15,@TF00001                                        0524 01327000
         AL    @14,@CF03777                                        0524 01328000
         ST    @04,RSXCILN-12(@15,@14)                             0524 01329000
*                     END;                                         0525 01330000
*                   ELSE                                           0526 01331000
*                     DO;                                          0526 01332000
         B     @RC00521                                            0526 01333000
@RF00521 DS    0H                                                  0527 01334000
*                       RSCINXCI = RSXCIBEG(RSIDX) + RSCIDFCI;     0527 01335000
         LH    @04,RSIDX(,REG6)                                    0527 01336000
         SLA   @04,4                                               0527 01337000
         L     @15,RSCIXLTA(,REG6)                                 0527 01338000
         L     @14,RSCIDFCI(,REG6)                                 0527 01339000
         LA    @01,0(@04,@15)                                      0527 01340000
         AL    @01,@CF03776                                        0527 01341000
         L     @03,RSXCIBEG-8(,@01)                                0527 01342000
         ALR   @03,@14                                             0527 01343000
         ST    @03,RSCINXCI(,REG6)                                 0527 01344000
*                       RSXCILN(RSIDX) = RSCIDFCI;                 0528 01345000
         AL    @15,@CF03777                                        0528 01346000
         ST    @14,RSXCILN-12(@04,@15)                             0528 01347000
*                     END;                                         0529 01348000
*                                                                  0529 01349000
*               END CATINOEX;                                      0530 01350000
*                                                                  0530 01351000
@RC00521 DS    0H                                                  0531 01352000
*         END CATILP2;                                             0531 01353000
*                                                                  0531 01354000
@RC00468 LA    @04,1                                               0531 01355000
         AH    @04,RSIDX(,REG6)                                    0531 01356000
         STH   @04,RSIDX(,REG6)                                    0531 01357000
         C     @04,@CF01850                                        0531 01358000
         BNH   @DL00466                                            0531 01359000
*         /***********************************************************/ 01360000
*         /*                                                         */ 01361000
*         /*  PRESERVE UNFORMATTED FREE RECORDS FOR EOV.             */ 01362000
*         /*                                                         */ 01363000
*         /***********************************************************/ 01364000
*                                                                  0532 01365000
*         RSCAHALC = RSXCIBEG(RSCISVLK) + RSXCILN(RSCISVLK) - 1;   0532 01366000
         SLR   @04,@04                                             0532 01367000
         IC    @04,RSCISVLK(,REG6)                                 0532 01368000
         SLA   @04,4                                               0532 01369000
         L     @15,RSCIXLTA(,REG6)                                 0532 01370000
         LA    @01,0(@04,@15)                                      0532 01371000
         AL    @01,@CF03776                                        0532 01372000
         L     @14,RSXCIBEG-8(,@01)                                0532 01373000
         AL    @15,@CF03777                                        0532 01374000
         AL    @14,RSXCILN-12(@04,@15)                             0532 01375000
         BCTR  @14,0                                               0532 01376000
         ST    @14,RSCAHALC(,REG6)                                 0532 01377000
*         RSCANFCN = RSCAHALC + 1 - RSCANFCI;                      0533 01378000
*                                                                  0533 01379000
         AL    @14,@CF00219                                        0533 01380000
         SL    @14,RSCANFCI(,REG6)                                 0533 01381000
         ST    @14,RSCANFCN(,REG6)                                 0533 01382000
*         IF RSCANFCN > 4                                          0534 01383000
*           THEN                                                   0534 01384000
         LA    @04,4                                               0534 01385000
         CR    @14,@04                                             0534 01386000
         BNH   @RF00534                                            0534 01387000
*             RSCANFCN = 4;                                        0535 01388000
*                                                                  0535 01389000
         ST    @04,RSCANFCN(,REG6)                                 0535 01390000
*         IF RSCANFCN < 0                                          0536 01391000
*           THEN                                                   0536 01392000
@RF00534 SLR   @04,@04                                             0536 01393000
         C     @04,RSCANFCN(,REG6)                                 0536 01394000
         BNH   @RF00536                                            0536 01395000
*             RSCANFCN = 0;                                        0537 01396000
*                                                                  0537 01397000
         ST    @04,RSCANFCN(,REG6)                                 0537 01398000
*         RSCAFUCI = RSCAHALC + 1 - RSCANFCN;                      0538 01399000
*                                                                  0538 01400000
@RF00536 LA    @04,1                                               0538 01401000
         AL    @04,RSCAHALC(,REG6)                                 0538 01402000
         SL    @04,RSCANFCN(,REG6)                                 0538 01403000
         ST    @04,RSCAFUCI(,REG6)                                 0538 01404000
*         /***********************************************************/ 01405000
*         /*                                                         */ 01406000
*         /*  PROCESSING COMPLETED. RETURN.                          */ 01407000
*         /*                                                         */ 01408000
*         /***********************************************************/ 01409000
*                                                                  0539 01410000
*         IF GDTDBG = NULLPTR                                      0539 01411000
*           THEN;                                                  0539 01412000
         L     @04,GDTDBG(,REG5)                                   0539 01413000
         LTR   @04,@04                                             0539 01414000
         BZ    @RT00539                                            0539 01415000
*           ELSE                                                   0541 01416000
*             CALL IDCDB010 (GDTTBL,'RSC1');                       0541 01417000
*                                                                  0541 01418000
         ST    REG5,@AL00001                                       0541 01419000
         LA    @04,@CC03515                                        0541 01420000
         ST    @04,@AL00001+4                                      0541 01421000
         MVI   @AL00001+4,X'80'                                    0541 01422000
         L     @15,GDTDBG(,REG5)                                   0541 01423000
         LA    @01,@AL00001                                        0541 01424000
         BALR  @14,@15                                             0541 01425000
* CALL EXIT;  /*TERMINATE*/                                        0542 01426000
@RT00539 BAL   @14,EXIT                                            0542 01427000
* END CATINIT; /*END OF PROCEDURE*/                                0543 01428000
*                                                                  0543 01429000
@EL00003 DS    0H                                                  0543 01430000
@EF00003 DS    0H                                                  0543 01431000
@ER00003 BR    @14                                                 0543 01432000
@PB00003 DS    0H                                                  0544 01433000
*/********************************************************************/ 01434000
*/*                                                                  */ 01435000
*/* PROCEDURE NAME - COPYCAT                                         */ 01436000
*/*                                                                  */ 01437000
*/* FUNCTION - THIS SEGMENT PERFORMS THE INITIAL LOAD OF THE         */ 01438000
*/*            WORKFILE FROM THE CATALOG TO BE RESET.                */ 01439000
*/*                                                                  */ 01440000
*/* INPUT -    NONE                                                  */ 01441000
*/*                                                                  */ 01442000
*/* OUTPUT -   NONE                                                  */ 01443000
*/*                                                                  */ 01444000
*/* EXIT, NORMAL - RETURN TO CALLER                                  */ 01445000
*/* EXIT, ERROR - TO CKERR TO TERMINATE                              */ 01446000
*/*                                                                  */ 01447000
*/********************************************************************/ 01448000
*      GENERATE;                                                   0544 01449000
         DS    0F                                                       01450000
NAME0025 DC    CL8'COPYCAT'                                             01451000
*COPYCAT: PROCEDURE                                                0545 01452000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0545 01453000
*                                                                  0545 01454000
         B     @PB00004                                            0545 01455000
COPYCAT  DS    0H                                                  0546 01456000
*      GENERATE REFS(RS01RG08, REG6);                              0546 01457000
*                                                                  0546 01458000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          01459000
         LR    @15,@13  OLD SAVE AREA                                   01460000
         LA    @13,72(@13)  NEW SAVE AREA                               01461000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     01462000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        01463000
         MVC   0(4,@15),NAME0025  PROCNAME TO REGSAVE                   01464000
*         RFY RESVOL BASED(RSENTPT);                               0547 01465000
*         RFY VOLSERTB BASED(RSENTPT);                             0548 01466000
*                                                                  0548 01467000
*         OLDERID2 = NEWERID2;                                     0549 01468000
         L     @04,GDTTR2(,REG5)                                   0549 01469000
         MVC   @TS00001(95),NEWERID2(@04)                          0549 01470000
         MVC   OLDERID2(95,@04),@TS00001                           0549 01471000
*         NEWID2 = 'RSCO';                                         0550 01472000
*                                                                  0550 01473000
         MVC   NEWID2(4,@04),@CC03521                              0550 01474000
*         /***********************************************************/ 01475000
*         /*                                                         */ 01476000
*         /*  INITIALIZATION.                                        */ 01477000
*         /*                                                         */ 01478000
*         /***********************************************************/ 01479000
*                                                                  0551 01480000
*         /***********************************************************/ 01481000
*         /*                                                         */ 01482000
*         /*    SET VOLSERTB ANCHOR TO 0. SET AVAILABLE COUNT AND    */ 01483000
*         /*    AVAILABLE CHAIN ANCHOR TO 0. SET CURRENT             */ 01484000
*         /*    RELATIVE RECORD NUMBER TO 1.                         */ 01485000
*         /*                                                         */ 01486000
*         /***********************************************************/ 01487000
*                                                                  0551 01488000
*         RSVOLLST = 0;                                            0551 01489000
         SLR   @04,@04                                             0551 01490000
         ST    @04,RSVOLLST(,REG6)                                 0551 01491000
*         RSAVAIL  = 0;                                            0552 01492000
         ST    @04,RSAVAIL(,REG6)                                  0552 01493000
*         RSAVAILN = 0;                                            0553 01494000
         ST    @04,RSAVAILN(,REG6)                                 0553 01495000
*         RSCURRN  = 1;                                            0554 01496000
*                                                                  0554 01497000
         LA    @04,1                                               0554 01498000
         ST    @04,RSCURRN(,REG6)                                  0554 01499000
*         /***********************************************************/ 01500000
*         /*                                                         */ 01501000
*         /*    SET GRAB, RAB AND BUFFER POINTERS FOR WORKFILE       */ 01502000
*         /*                                                         */ 01503000
*         /***********************************************************/ 01504000
*                                                                  0555 01505000
*         RSGRABCU = ADDR(GRABSWF);                                0555 01506000
         L     @15,RSIOTBL(,REG6)                                  0555 01507000
         ST    @15,RSGRABCU(,REG6)                                 0555 01508000
*         GRABCURR = GRABRAB1;                                     0556 01509000
         L     @14,GRABRAB1(,@15)                                  0556 01510000
         ST    @14,GRABCURR(,@15)                                  0556 01511000
*         RSWFBP1 = ADDR(RABBUF);                                  0557 01512000
*                                                                  0557 01513000
         LA    @15,RABBUF(,@14)                                    0557 01514000
         ST    @15,RSWFBP1(,REG6)                                  0557 01515000
*         /***********************************************************/ 01516000
*         /*                                                         */ 01517000
*         /*    WORKFILE WAS PREVIOUSLY LOADED. MUST POSITION        */ 01518000
*         /*    TO THE END OF THE DATA SET IN CASE RECORDS MUST      */ 01519000
*         /*    BE ADDED AT THE END                                  */ 01520000
*         /*                                                         */ 01521000
*         /***********************************************************/ 01522000
*                                                                  0558 01523000
*         IF RSWFCREA = ON                                         0558 01524000
*           THEN                                                   0558 01525000
         TM    RSWFCREA(REG6),B'00100000'                          0558 01526000
         BNO   @RF00558                                            0558 01527000
*             DO;                                                  0559 01528000
*               RABRCDA = RSWFHURR + 1;                            0560 01529000
         AL    @04,RSWFHURR(,REG6)                                 0560 01530000
         ST    @04,RABRCDA(,@14)                                   0560 01531000
*               RABRRN = ON;                                       0561 01532000
*                                                                  0561 01533000
*                                                                  0561 01534000
         OI    RABRRN(@14),B'00010000'                             0561 01535000
*               DO;                                                0562 01536000
*                 RSRTYPE = ''B;                                   0563 01537000
         MVI   RSRTYPE(REG6),X'00'                                 0563 01538000
*                 RSRPOS = ON;      /* POSRCD  */                  0564 01539000
         OI    RSRPOS(REG6),B'00010000'                            0564 01540000
*                 RSRDS = ''B;                                     0565 01541000
         NI    RSRDS(REG6),B'00011111'                             0565 01542000
*                 RSRWF = ON;       /* WORKFILE  */                0566 01543000
*                 RSRDIR = OFF;     /* SEQUENTIAL  */              0567 01544000
*                 RSRKEY = ON;      /* KEY  */                     0568 01545000
*                                                                  0568 01546000
         OI    RSRWF(REG6),B'10010000'                             0568 01547000
         NI    RSRDIR(REG6),B'11111011'                            0568 01548000
*               /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT      */ 01549000
*               CALL RECMGMT;                                      0569 01550000
         L     @15,@CV03498                                        0569 01551000
         BALR  @14,@15                                             0569 01552000
*                 RFY RTNREG RSTD;                                 0570 01553000
*                 TESTRC = RTNREG;                                 0571 01554000
         STH   RTNREG,TESTRC(,REG6)                                0571 01555000
*                 RFY RTNREG UNRSTD;                               0572 01556000
*               END;                                               0573 01557000
*                                                                  0573 01558000
*               RABRRN = OFF;                                      0574 01559000
         L     @04,RSGRABCU(,REG6)                                 0574 01560000
         L     @04,GRABCURR(,@04)                                  0574 01561000
         NI    RABRRN(@04),B'11101111'                             0574 01562000
*             END;                                                 0575 01563000
*                                                                  0575 01564000
*         /***********************************************************/ 01565000
*         /*                                                         */ 01566000
*         /*    SET GRAB, RAB AND BUFFER POINTERS FOR CATALOG        */ 01567000
*         /*                                                         */ 01568000
*         /***********************************************************/ 01569000
*                                                                  0576 01570000
*         RSGRABCU = ADDR(GRABSCA);                                0576 01571000
@RF00558 L     @04,RSIOTBL(,REG6)                                  0576 01572000
         LA    @04,GRABSCA(,@04)                                   0576 01573000
         ST    @04,RSGRABCU(,REG6)                                 0576 01574000
*         GRABCURR = GRABRAB1;                                     0577 01575000
         L     @15,GRABRAB1(,@04)                                  0577 01576000
         ST    @15,GRABCURR(,@04)                                  0577 01577000
*         RSCABLP1 = ADDR(RABBUF);                                 0578 01578000
*                                                                  0578 01579000
         LA    @15,RABBUF(,@15)                                    0578 01580000
         ST    @15,RSCABLP1(,REG6)                                 0578 01581000
*         /***********************************************************/ 01582000
*         /*                                                         */ 01583000
*         /*  SET CATALOG GRABS FLAGS FOR SPECIAL I/O ERROR          */ 01584000
*         /*  HANDLING.                                              */ 01585000
*         /*                                                         */ 01586000
*         /***********************************************************/ 01587000
*                                                                  0579 01588000
*         GRABAFLS = ''B;                                          0579 01589000
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       0579 01590000
*         GRABSIOI = ON;                                           0580 01591000
*         GRABSIOF = ON;                                           0581 01592000
*                                                                  0581 01593000
         OI    GRABSIOI(@04),B'00011000'                           0581 01594000
*         /***********************************************************/ 01595000
*         /*                                                         */ 01596000
*         /*  PROCESS CURRENT CATALOG EXTENTS VIA CIXLT TABLE.       */ 01597000
*         /*                                                         */ 01598000
*         /***********************************************************/ 01599000
*                                                                  0582 01600000
*COPYLP1: DO RSIDX = 1 TO DIM(RSXCIENT)                            0582 01601000
*             WHILE (RSXCIBEG(RSIDX) <= RSCAHALC);                 0582 01602000
*                                                                  0582 01603000
COPYLP1  LA    @04,1                                               0582 01604000
         STH   @04,RSIDX(,REG6)                                    0582 01605000
@DL00582 LH    @04,RSIDX(,REG6)                                    0582 01606000
         SLA   @04,4                                               0582 01607000
         L     @15,RSCIXLTA(,REG6)                                 0582 01608000
         LA    @01,0(@04,@15)                                      0582 01609000
         AL    @01,@CF03776                                        0582 01610000
         L     @14,RSXCIBEG-8(,@01)                                0582 01611000
         C     @14,RSCAHALC(,REG6)                                 0582 01612000
         BH    @DC00582                                            0582 01613000
*         /***********************************************************/ 01614000
*         /*                                                         */ 01615000
*         /*  COMPUTE LAST CONTROL INTERVAL NUMBER (CI) IN THIS      */ 01616000
*         /*  CIXLT ENTRY.                                           */ 01617000
*         /*                                                         */ 01618000
*         /***********************************************************/ 01619000
*                                                                  0583 01620000
*           RSXCIEND = RSXCIBEG(RSIDX) + RSXCILN(RSIDX) - 1;       0583 01621000
*                                                                  0583 01622000
         LA    @01,0(@04,@15)                                      0583 01623000
         AL    @01,@CF03777                                        0583 01624000
         AL    @14,RSXCILN-12(,@01)                                0583 01625000
         BCTR  @14,0                                               0583 01626000
         ST    @14,RSXCIEND(,REG6)                                 0583 01627000
*         /***********************************************************/ 01628000
*         /*                                                         */ 01629000
*         /*  PROCESS HIGH KEY RANGE EXTENT RECORDS.                 */ 01630000
*         /*  THESE RECORDS WILL BE REPRESENTED IN THE WORKFILE      */ 01631000
*         /*  AS DUMMY INVALID RECORDS.                              */ 01632000
*         /*                                                         */ 01633000
*         /***********************************************************/ 01634000
*                                                                  0584 01635000
*           IF RSXCIRNG(RSIDX) = ON                                0584 01636000
*             THEN                                                 0584 01637000
         ALR   @15,@04                                             0584 01638000
         TM    RSXCIRNG-16(@15),B'10000000'                        0584 01639000
         BNO   @RF00584                                            0584 01640000
*COPYHKR:       DO;                                                0585 01641000
*                                                                  0585 01642000
COPYHKR  DS    0H                                                  0586 01643000
*         /***********************************************************/ 01644000
*         /*                                                         */ 01645000
*         /*    SET CURRENT GRAB POINTER FOR WORKFILE GRABS.         */ 01646000
*         /*                                                         */ 01647000
*         /***********************************************************/ 01648000
*                                                                  0586 01649000
*                 RSGRABCU = ADDR(GRABSWF);                        0586 01650000
*                                                                  0586 01651000
         L     @04,RSIOTBL(,REG6)                                  0586 01652000
         ST    @04,RSGRABCU(,REG6)                                 0586 01653000
*         /***********************************************************/ 01654000
*         /*                                                         */ 01655000
*         /*    SET INVALID FLAG IN WORKFILE PROCESSING AREA AND     */ 01656000
*         /*    CLEAR WORKFILE BUFFER.                               */ 01657000
*         /*                                                         */ 01658000
*         /***********************************************************/ 01659000
*                                                                  0587 01660000
*                 RSWFLD = ''B;                                    0587 01661000
         L     @04,GRABCURR(,@04)                                  0587 01662000
         XC    RSWFLD(10,@04),RSWFLD(@04)                          0587 01663000
*                 RSWINVCI = ON;                                   0588 01664000
         OI    RSWINVCI(@04),B'10000000'                           0588 01665000
*                 WFBUF1(1:256) = ''B;                             0589 01666000
         L     @04,RSWFBP1(,REG6)                                  0589 01667000
         XC    WFBUF1(256,@04),WFBUF1(@04)                         0589 01668000
*                 WFBUF1(257:CELEN) = ''B;                         0590 01669000
*                                                                  0590 01670000
         XC    WFBUF1+256(249,@04),WFBUF1+256(@04)                 0590 01671000
*         /***********************************************************/ 01672000
*         /*                                                         */ 01673000
*         /*    WRITE A DUMMY RECORD TO THE WORKFILE FOR EACH RECORD */ 01674000
*         /*    IN THIS EXTENT.                                      */ 01675000
*         /*                                                         */ 01676000
*         /***********************************************************/ 01677000
*                                                                  0591 01678000
*COPYLP2:         DO RSCURCI = RSXCIBEG(RSIDX) TO RSXCIEND;        0591 01679000
*                                                                  0591 01680000
COPYLP2  LH    @04,RSIDX(,REG6)                                    0591 01681000
         SLA   @04,4                                               0591 01682000
         L     @01,RSCIXLTA(,REG6)                                 0591 01683000
         AL    @01,@CF03776                                        0591 01684000
         L     @04,RSXCIBEG-8(@04,@01)                             0591 01685000
         B     @DE00591                                            0591 01686000
@DL00591 DS    0H                                                  0592 01687000
*         /***********************************************************/ 01688000
*         /*                                                         */ 01689000
*         /*    SET CONTROL INTERVAL NUMBER IN RECORD TO CURRENT CI. */ 01690000
*         /*    WRITE THE RECORD TO THE WORKFILE VIA COPYADD.        */ 01691000
*         /*                                                         */ 01692000
*         /***********************************************************/ 01693000
*                                                                  0592 01694000
*                   RCDCINO = RSCURCI;                             0592 01695000
*                                                                  0592 01696000
         L     @04,RSGRABCU(,REG6)                                 0592 01697000
         L     @04,GRABCURR(,@04)                                  0592 01698000
         MVC   RCDCINO+8(3,@04),RSCURCI+1(REG6)                    0592 01699000
*                   CALL COPYADD;                                  0593 01700000
*                                                                  0593 01701000
         BAL   @14,COPYADD                                         0593 01702000
*                 END COPYLP2;                                     0594 01703000
*                                                                  0594 01704000
         LA    @04,1                                               0594 01705000
         AL    @04,RSCURCI(,REG6)                                  0594 01706000
@DE00591 ST    @04,RSCURCI(,REG6)                                  0594 01707000
         C     @04,RSXCIEND(,REG6)                                 0594 01708000
         BNH   @DL00591                                            0594 01709000
*               END COPYHKR;                                       0595 01710000
*                                                                  0595 01711000
*         /***********************************************************/ 01712000
*         /*                                                         */ 01713000
*         /*  PROCESS LOW KEY RANGE EXTENT RECORDS.                  */ 01714000
*         /*  COPY FORMATTED RECORDS FROM CATALOG TO WORKFILE.       */ 01715000
*         /*  REPRESENT UNFORMATTED RECORDS AS DUMMY RECORDS IN      */ 01716000
*         /*  THE WORKFILE.                                          */ 01717000
*         /*                                                         */ 01718000
*         /***********************************************************/ 01719000
*                                                                  0596 01720000
*           IF RSXCIRNG(RSIDX) = OFF                               0596 01721000
*             THEN                                                 0596 01722000
@RF00584 LH    @04,RSIDX(,REG6)                                    0596 01723000
         SLA   @04,4                                               0596 01724000
         L     @01,RSCIXLTA(,REG6)                                 0596 01725000
         ALR   @01,@04                                             0596 01726000
         TM    RSXCIRNG-16(@01),B'10000000'                        0596 01727000
         BNZ   @RF00596                                            0596 01728000
*COPYLKR:       DO;                                                0597 01729000
*                                                                  0597 01730000
COPYLKR  DS    0H                                                  0598 01731000
*         /***********************************************************/ 01732000
*         /*                                                         */ 01733000
*         /*  PROCESS EACH RECORD IN THIS EXTENT.                    */ 01734000
*         /*                                                         */ 01735000
*         /***********************************************************/ 01736000
*                                                                  0598 01737000
*COPYLP3:         DO RSCURCI = RSXCIBEG(RSIDX) TO RSXCIEND;        0598 01738000
*                                                                  0598 01739000
COPYLP3  LH    @04,RSIDX(,REG6)                                    0598 01740000
         SLA   @04,4                                               0598 01741000
         L     @01,RSCIXLTA(,REG6)                                 0598 01742000
         AL    @01,@CF03776                                        0598 01743000
         L     @04,RSXCIBEG-8(@04,@01)                             0598 01744000
         B     @DE00598                                            0598 01745000
@DL00598 DS    0H                                                  0599 01746000
*         /***********************************************************/ 01747000
*         /*                                                         */ 01748000
*         /*  PROCESS FORMATTED RECORDS.                             */ 01749000
*         /*                                                         */ 01750000
*         /***********************************************************/ 01751000
*                                                                  0599 01752000
*                   IF RSCURCI < RSCANFCI                          0599 01753000
*                     THEN                                         0599 01754000
         L     @04,RSCURCI(,REG6)                                  0599 01755000
         C     @04,RSCANFCI(,REG6)                                 0599 01756000
         BNL   @RF00599                                            0599 01757000
*COPYFMT:               DO;                                        0600 01758000
*                                                                  0600 01759000
COPYFMT  DS    0H                                                  0601 01760000
*         /***********************************************************/ 01761000
*         /*                                                         */ 01762000
*         /*    SET CURRENT GRAB POINTER FOR THE CATALOG GRAB.       */ 01763000
*         /*    SET ARGUMENT TO CURRENT CI.                          */ 01764000
*         /*                                                         */ 01765000
*         /***********************************************************/ 01766000
*                                                                  0601 01767000
*                         RSGRABCU = ADDR(GRABSCA);                0601 01768000
         L     @04,RSIOTBL(,REG6)                                  0601 01769000
         LA    @04,GRABSCA(,@04)                                   0601 01770000
         ST    @04,RSGRABCU(,REG6)                                 0601 01771000
*                         RABRCDA = RSCURCI;                       0602 01772000
*                                                                  0602 01773000
         L     @04,GRABCURR(,@04)                                  0602 01774000
         L     @15,RSCURCI(,REG6)                                  0602 01775000
         ST    @15,RABRCDA(,@04)                                   0602 01776000
*         /***********************************************************/ 01777000
*         /*                                                         */ 01778000
*         /*    RETRIEVE THE CATALOG RECORD VIA RECMGMT.             */ 01779000
*         /*                                                         */ 01780000
*         /***********************************************************/ 01781000
*                                                                  0603 01782000
*                                                                  0603 01783000
*                         DO;                                      0603 01784000
*                           RSRTYPE = ''B;                         0604 01785000
         MVI   RSRTYPE(REG6),X'00'                                 0604 01786000
*                           RSRGET = ON;      /* GETRCD  */        0605 01787000
         OI    RSRGET(REG6),B'10000000'                            0605 01788000
*                           RSRUPD = OFF;     /* NO UPDATE  */     0606 01789000
         NI    RSRUPD(REG6),B'11110111'                            0606 01790000
*                           RSRDS = ''B;                           0607 01791000
         NI    RSRDS(REG6),B'00011111'                             0607 01792000
*                           RSRCAT = ON;      /* CATALOG  */       0608 01793000
*                           RSRDIR = ON;      /* DIRECT  */        0609 01794000
*                           RSRKEY = OFF;     /* CNV  */           0610 01795000
*                                                                  0610 01796000
         OI    RSRCAT(REG6),B'01000100'                            0610 01797000
         NI    RSRKEY(REG6),B'11101111'                            0610 01798000
*                         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMG 01799000
*T                                                                   */ 01800000
*                         CALL RECMGMT;                            0611 01801000
         L     @15,@CV03498                                        0611 01802000
         BALR  @14,@15                                             0611 01803000
*                           RFY RTNREG RSTD;                       0612 01804000
*                           TESTRC = RTNREG;                       0613 01805000
         STH   RTNREG,TESTRC(,REG6)                                0613 01806000
*                           RFY RTNREG UNRSTD;                     0614 01807000
*                         END;                                     0615 01808000
*                                                                  0615 01809000
*         /***********************************************************/ 01810000
*         /*                                                         */ 01811000
*         /*    MOVE THE CATALOG RECORD TO THE WORKFILE RECORD BUFFER*/ 01812000
*         /*                                                         */ 01813000
*         /***********************************************************/ 01814000
*                                                                  0616 01815000
*                         WFBUF1(1:256) = CABUFL1(1:256);          0616 01816000
         L     @04,RSWFBP1(,REG6)                                  0616 01817000
         L     @15,RSCABLP1(,REG6)                                 0616 01818000
         MVC   WFBUF1(256,@04),CABUFL1(@15)                        0616 01819000
*                         WFBUF1(257:CELEN) = CABUFL1(257:CELEN);  0617 01820000
*                                                                  0617 01821000
         MVC   WFBUF1+256(249,@04),CABUFL1+256(@15)                0617 01822000
*         /***********************************************************/ 01823000
*         /*                                                         */ 01824000
*         /*    SET CURRENT GRAB POINTER FOR WORKFILE GRABS.         */ 01825000
*         /*    CLEAR WORKFILE PROCESSING FIELD.                     */ 01826000
*         /*                                                         */ 01827000
*         /***********************************************************/ 01828000
*                                                                  0618 01829000
*                         RSGRABCU = ADDR(GRABSWF);                0618 01830000
         L     @04,RSIOTBL(,REG6)                                  0618 01831000
         ST    @04,RSGRABCU(,REG6)                                 0618 01832000
*                         RSWFLD = ''B;                            0619 01833000
*                                                                  0619 01834000
         L     @15,GRABCURR(,@04)                                  0619 01835000
         XC    RSWFLD(10,@15),RSWFLD(@15)                          0619 01836000
*         /***********************************************************/ 01837000
*         /*                                                         */ 01838000
*         /*    CATALOG RECORD NOT RETRIEVED DUE TO AN I/O ERROR     */ 01839000
*         /*    ON GET. A DUMMY RECORD HAS BEEN FORMATTED IN THE     */ 01840000
*         /*    BUFFER. INDICATE THE RECORD IS INVALID.              */ 01841000
*         /*                                                         */ 01842000
*         /***********************************************************/ 01843000
*                                                                  0620 01844000
*                         IF ADDR(GRABSCA) -> GRABCURR ->          0620 01845000
*                              RABIOIGN = ON                       0620 01846000
*                           THEN                                   0620 01847000
         L     @04,GRABCURR+40(,@04)                               0620 01848000
         TM    RABIOIGN(@04),B'00000100'                           0620 01849000
         BNO   @RF00620                                            0620 01850000
*                             DO;                                  0621 01851000
*                               ADDR(GRABSCA) -> GRABCURR ->       0622 01852000
*                                   RABIOIGN = OFF;                0622 01853000
         NI    RABIOIGN(@04),B'11111011'                           0622 01854000
*                               RSWINVCI = ON;                     0623 01855000
         OI    RSWINVCI(@15),B'10000000'                           0623 01856000
*                             END;                                 0624 01857000
*                                                                  0624 01858000
*         /***********************************************************/ 01859000
*         /*                                                         */ 01860000
*         /*    CATALOG RECORD WAS RETRIEVED SUCCESSFULLY.           */ 01861000
*         /*                                                         */ 01862000
*         /***********************************************************/ 01863000
*                                                                  0625 01864000
*                           ELSE                                   0625 01865000
*COPYGOK:                     DO;                                  0625 01866000
*                                                                  0625 01867000
         B     @RC00620                                            0625 01868000
@RF00620 DS    0H                                                  0625 01869000
COPYGOK  DS    0H                                                  0626 01870000
*         /***********************************************************/ 01871000
*         /*                                                         */ 01872000
*         /*    VOLUME RECORD. ADD AN ENTRY TO VOLSERTB              */ 01873000
*         /*    VIA BLDVLST.                                         */ 01874000
*         /*                                                         */ 01875000
*         /***********************************************************/ 01876000
*                                                                  0626 01877000
*                               IF RCDID = VOLID                   0626 01878000
*                                 THEN                             0626 01879000
         L     @04,RSGRABCU(,REG6)                                 0626 01880000
         L     @04,GRABCURR(,@04)                                  0626 01881000
         LA    @15,8                                               0626 01882000
         ALR   @15,@04                                             0626 01883000
         CLI   RCDID(@15),C'V'                                     0626 01884000
         BNE   @RF00626                                            0626 01885000
*                                   DO;                            0627 01886000
*                                     RSENTPT = ADDR(RSVUENT);     0628 01887000
         L     @01,RSIOTBL(,REG6)                                  0628 01888000
         LA    @14,RSVUENT(,@01)                                   0628 01889000
         ST    @14,RSENTPT(,REG6)                                  0628 01890000
*                                     VOLSERTB = ''B;              0629 01891000
         XC    VOLSERTB(28,@14),VOLSERTB(@14)                      0629 01892000
*                                     VOLSRSER = CNAME(1:6);       0630 01893000
         MVC   VOLSRSER(6,@14),CNAME(@15)                          0630 01894000
*                                     VOLSRCI = RCDCINO;           0631 01895000
         L     @15,RCDCINO-1(,@15)                                 0631 01896000
         LA    @15,0(,@15)                                         0631 01897000
         ST    @15,VOLSRCI(,@14)                                   0631 01898000
*                                     VOLSRNTK = RTNOTRKS;         0632 01899000
*                                                                  0632 01900000
         MVC   VOLSRNTK(2,@14),RTNOTRKS(@04)                       0632 01901000
*                                     /* CALL TO MODULE IDCRS05 FOR PRO 01902000
*EDURE BLDVLST                                                       */ 01903000
*                                     CALL IDCRS5BV(RSENTPT);      0633 01904000
*                                                                  0633 01905000
         LA    @04,RSENTPT(,REG6)                                  0633 01906000
         ST    @04,@AL00001                                        0633 01907000
         L     @15,@CV03538                                        0633 01908000
         LA    @01,@AL00001                                        0633 01909000
         BALR  @14,@15                                             0633 01910000
*                                   END;                           0634 01911000
*                                                                  0634 01912000
*         /***********************************************************/ 01913000
*         /*                                                         */ 01914000
*         /*    FREE RECORD. PLACE IT ON THE AVAILABLE CHAIN.        */ 01915000
*         /*                                                         */ 01916000
*         /***********************************************************/ 01917000
*                                                                  0635 01918000
*                               IF RCDID = FREEID                  0635 01919000
*                                 THEN                             0635 01920000
@RF00626 L     @04,RSGRABCU(,REG6)                                 0635 01921000
         L     @04,GRABCURR(,@04)                                  0635 01922000
         LA    @15,8                                               0635 01923000
         ALR   @15,@04                                             0635 01924000
         CLI   RCDID(@15),C'F'                                     0635 01925000
         BNE   @RF00635                                            0635 01926000
*                                   DO;                            0636 01927000
*                                     RSAVAILN = RSAVAILN + 1;     0637 01928000
         LA    @14,1                                               0637 01929000
         AL    @14,RSAVAILN(,REG6)                                 0637 01930000
         ST    @14,RSAVAILN(,REG6)                                 0637 01931000
*                                     RSWCHPTR = RSAVAIL;          0638 01932000
         L     @14,RSAVAIL(,REG6)                                  0638 01933000
         ST    @14,RSWCHPTR(,@04)                                  0638 01934000
*                                     RSAVAIL = RCDCINO;           0639 01935000
         L     @04,RCDCINO-1(,@15)                                 0639 01936000
         LA    @04,0(,@04)                                         0639 01937000
         ST    @04,RSAVAIL(,REG6)                                  0639 01938000
*                                   END;                           0640 01939000
*                                                                  0640 01940000
*         /***********************************************************/ 01941000
*         /*                                                         */ 01942000
*         /*    RECORD IS NOT FREE.                                  */ 01943000
*         /*    CALL SCNRLST TO SCAN THE ALL PORTION OF RESVOL FOR   */ 01944000
*         /*    IT'S CRA VOLSER TO DETERMINE IF THIS RECORD          */ 01945000
*         /*    BELONGS TO A CRA SPECIFIED FOR RESET.                */ 01946000
*         /*                                                         */ 01947000
*         /***********************************************************/ 01948000
*                                                                  0641 01949000
*                                 ELSE                             0641 01950000
*                                   DO;                            0641 01951000
         B     @RC00635                                            0641 01952000
@RF00635 DS    0H                                                  0642 01953000
*                                     RSCRVL = ADDR(RCDCRAVL);     0642 01954000
*                                                                  0642 01955000
         L     @04,RSGRABCU(,REG6)                                 0642 01956000
         L     @04,GRABCURR(,@04)                                  0642 01957000
         LA    @04,RCDCRAVL+8(,@04)                                0642 01958000
         ST    @04,RSCRVL(,REG6)                                   0642 01959000
*                                     /* CALL TO MODULE IDCRS05 FOR PRO 01960000
*EDURE SCNRLST                                                       */ 01961000
*                                     CALL IDCRS5SR('V','A',RSENTPT,RSC 01962000
*VL);                                                              0643 01963000
*                                                                  0643 01964000
         LA    @04,@CC00833                                        0643 01965000
         ST    @04,@AL00001                                        0643 01966000
         LA    @04,@CC00813                                        0643 01967000
         ST    @04,@AL00001+4                                      0643 01968000
         LA    @04,RSENTPT(,REG6)                                  0643 01969000
         ST    @04,@AL00001+8                                      0643 01970000
         LA    @04,RSCRVL(,REG6)                                   0643 01971000
         ST    @04,@AL00001+12                                     0643 01972000
         L     @15,@CV03539                                        0643 01973000
         LA    @01,@AL00001                                        0643 01974000
         BALR  @14,@15                                             0643 01975000
*         /***********************************************************/ 01976000
*         /*                                                         */ 01977000
*         /*    IF RECORD BELONGS TO A RESET CRA, MARK IT AS         */ 01978000
*         /*    AVAILABLE AND PLACE IT ON THE AVAILABLE CHAIN.       */ 01979000
*         /*                                                         */ 01980000
*         /***********************************************************/ 01981000
*                                                                  0644 01982000
*                                     IF RSENTPT ^= 0              0644 01983000
*                                       THEN                       0644 01984000
         L     @04,RSENTPT(,REG6)                                  0644 01985000
         LTR   @04,@04                                             0644 01986000
         BZ    @RF00644                                            0644 01987000
*                                         DO;                      0645 01988000
*                                           RSWDLCAT = ON;         0646 01989000
         L     @04,RSGRABCU(,REG6)                                 0646 01990000
         L     @04,GRABCURR(,@04)                                  0646 01991000
         OI    RSWDLCAT(@04),B'01000000'                           0646 01992000
*                                           RSAVAILN = RSAVAILN + 1;    01993000
         LA    @15,1                                               0647 01994000
         AL    @15,RSAVAILN(,REG6)                                 0647 01995000
         ST    @15,RSAVAILN(,REG6)                                 0647 01996000
*                                           RSWCHPTR = RSAVAIL;    0648 01997000
         L     @15,RSAVAIL(,REG6)                                  0648 01998000
         ST    @15,RSWCHPTR(,@04)                                  0648 01999000
*                                           RSAVAIL = RSCURCI;     0649 02000000
         L     @04,RSCURCI(,REG6)                                  0649 02001000
         ST    @04,RSAVAIL(,REG6)                                  0649 02002000
*                                         END;                     0650 02003000
*                                                                  0650 02004000
*                                   END;                           0651 02005000
*                                                                  0651 02006000
@RF00644 DS    0H                                                  0652 02007000
*                             END COPYGOK;                         0652 02008000
*                                                                  0652 02009000
@RC00635 DS    0H                                                  0653 02010000
*         /***********************************************************/ 02011000
*         /*                                                         */ 02012000
*         /*    RECORD IS NOW FORMATTED IN WORKFILE BUFFER. WRITE    */ 02013000
*         /*    RECORD TO WORKFILE VIA COPYADD.                      */ 02014000
*         /*                                                         */ 02015000
*         /***********************************************************/ 02016000
*                                                                  0653 02017000
*                         CALL COPYADD;                            0653 02018000
*                                                                  0653 02019000
@RC00620 BAL   @14,COPYADD                                         0653 02020000
*                       END COPYFMT;                               0654 02021000
*                                                                  0654 02022000
*         /***********************************************************/ 02023000
*         /*                                                         */ 02024000
*         /*  PROCESS UNFORMATTED RECORDS.                           */ 02025000
*         /*                                                         */ 02026000
*         /***********************************************************/ 02027000
*                                                                  0655 02028000
*                     ELSE                                         0655 02029000
*COPYUFMT:              DO;                                        0655 02030000
*                                                                  0655 02031000
         B     @RC00599                                            0655 02032000
@RF00599 DS    0H                                                  0655 02033000
COPYUFMT DS    0H                                                  0656 02034000
*         /***********************************************************/ 02035000
*         /*                                                         */ 02036000
*         /*    SET CURRENT GRAB POINTER TO WORKFILE GRABS.          */ 02037000
*         /*    SET UP DUMMY FREE RECORD IN WORKFILE BUFFER.         */ 02038000
*         /*                                                         */ 02039000
*         /***********************************************************/ 02040000
*                                                                  0656 02041000
*                         RSGRABCU = ADDR(GRABSWF);                0656 02042000
         L     @04,RSIOTBL(,REG6)                                  0656 02043000
         ST    @04,RSGRABCU(,REG6)                                 0656 02044000
*                         WFBUF1(1:256) = ''B;                     0657 02045000
         L     @15,RSWFBP1(,REG6)                                  0657 02046000
         XC    WFBUF1(256,@15),WFBUF1(@15)                         0657 02047000
*                         WFBUF1(257:CELEN) = ''B;                 0658 02048000
         XC    WFBUF1+256(249,@15),WFBUF1+256(@15)                 0658 02049000
*                         RCDID = FREEID;                          0659 02050000
*                                                                  0659 02051000
         L     @04,GRABCURR(,@04)                                  0659 02052000
         LA    @15,8                                               0659 02053000
         ALR   @15,@04                                             0659 02054000
         MVI   RCDID(@15),C'F'                                     0659 02055000
*         /***********************************************************/ 02056000
*         /*                                                         */ 02057000
*         /*    WRITE A DUMMY FREE RECORD TO THE WORKFILE FOR        */ 02058000
*         /*    EACH UNFORMATTED CATALOG RECORD.                     */ 02059000
*         /*                                                         */ 02060000
*         /***********************************************************/ 02061000
*                                                                  0660 02062000
*                                                                  0660 02063000
*         /***********************************************************/ 02064000
*         /*                                                         */ 02065000
*         /*    SET CONTROL INTERVAL NUMBER OF RECORD TO CURRENT CI. */ 02066000
*         /*                                                         */ 02067000
*         /***********************************************************/ 02068000
*                                                                  0660 02069000
*                         RCDCINO = RSCURCI;                       0660 02070000
*                                                                  0660 02071000
         L     @14,RSCURCI(,REG6)                                  0660 02072000
         STCM  @14,7,RCDCINO(@15)                                  0660 02073000
*         /***********************************************************/ 02074000
*         /*                                                         */ 02075000
*         /*    MUST SAVE SEVERAL RECORDS AT THE END OF THE EXTENT   */ 02076000
*         /*    FOR USE BY CATALOG EOV. MARK THESE DUMMY RECORDS     */ 02077000
*         /*    AS INVALID.                                          */ 02078000
*         /*                                                         */ 02079000
*         /***********************************************************/ 02080000
*                                                                  0661 02081000
*                         IF RSCURCI => RSCAFUCI                   0661 02082000
*                           THEN                                   0661 02083000
         C     @14,RSCAFUCI(,REG6)                                 0661 02084000
         BL    @RF00661                                            0661 02085000
*                             DO;                                  0662 02086000
*                               RSWFLD = ''B;                      0663 02087000
         XC    RSWFLD(10,@04),RSWFLD(@04)                          0663 02088000
*                               RSWINVCI = ON;                     0664 02089000
         OI    RSWINVCI(@04),B'10000000'                           0664 02090000
*                             END;                                 0665 02091000
*                                                                  0665 02092000
*         /***********************************************************/ 02093000
*         /*                                                         */ 02094000
*         /*    MARK NON-EOV RECORDS FOR UPDATE CATALOG AND PLACE    */ 02095000
*         /*    ON THE AVAILABLE CHAIN.                              */ 02096000
*         /*                                                         */ 02097000
*         /***********************************************************/ 02098000
*                                                                  0666 02099000
*                           ELSE                                   0666 02100000
*                             DO;                                  0666 02101000
         B     @RC00661                                            0666 02102000
@RF00661 DS    0H                                                  0667 02103000
*                               RSWFLD = ''B;                      0667 02104000
         L     @04,RSGRABCU(,REG6)                                 0667 02105000
         L     @04,GRABCURR(,@04)                                  0667 02106000
         XC    RSWFLD(10,@04),RSWFLD(@04)                          0667 02107000
*                               RSWUPCAT = ON;                     0668 02108000
         OI    RSWUPCAT(@04),B'00100000'                           0668 02109000
*                               RSWCHPTR = RSAVAIL;                0669 02110000
         L     @15,RSAVAIL(,REG6)                                  0669 02111000
         ST    @15,RSWCHPTR(,@04)                                  0669 02112000
*                               RSAVAIL = RSCURCI;                 0670 02113000
         L     @04,RSCURCI(,REG6)                                  0670 02114000
         ST    @04,RSAVAIL(,REG6)                                  0670 02115000
*                               RSAVAILN = RSAVAILN + 1;           0671 02116000
         LA    @04,1                                               0671 02117000
         AL    @04,RSAVAILN(,REG6)                                 0671 02118000
         ST    @04,RSAVAILN(,REG6)                                 0671 02119000
*                             END;                                 0672 02120000
*                                                                  0672 02121000
*         /***********************************************************/ 02122000
*         /*                                                         */ 02123000
*         /*    RECORD IS NOW FORMATTED IN WORKFILE BUFFER. WRITE    */ 02124000
*         /*    RECORD TO WORKFILE VIA COPYADD.                      */ 02125000
*         /*                                                         */ 02126000
*         /***********************************************************/ 02127000
*                                                                  0673 02128000
*                         CALL COPYADD;                            0673 02129000
*                                                                  0673 02130000
@RC00661 BAL   @14,COPYADD                                         0673 02131000
*                       END COPYUFMT;                              0674 02132000
*                                                                  0674 02133000
*               END COPYLP3;                                       0675 02134000
*                                                                  0675 02135000
@RC00599 LA    @04,1                                               0675 02136000
         AL    @04,RSCURCI(,REG6)                                  0675 02137000
@DE00598 ST    @04,RSCURCI(,REG6)                                  0675 02138000
         C     @04,RSXCIEND(,REG6)                                 0675 02139000
         BNH   @DL00598                                            0675 02140000
*           END COPYLKR;                                           0676 02141000
*                                                                  0676 02142000
*         END COPYLP1;                                             0677 02143000
*                                                                  0677 02144000
@RF00596 LA    @04,1                                               0677 02145000
         AH    @04,RSIDX(,REG6)                                    0677 02146000
         STH   @04,RSIDX(,REG6)                                    0677 02147000
         C     @04,@CF01850                                        0677 02148000
         BNH   @DL00582                                            0677 02149000
@DC00582 DS    0H                                                  0678 02150000
*         /***********************************************************/ 02151000
*         /*                                                         */ 02152000
*         /*  INITIAL LOAD OF WORKFILE COMPLETE. IF WORKFILE IS      */ 02153000
*         /*  OPEN FOR CREATE MODE, THEN CLOSE IT AND SET WORKFILE   */ 02154000
*         /*  CREATED FLAG, OTHERWISE LEAVE IT OPEN                  */ 02155000
*         /*                                                         */ 02156000
*         /***********************************************************/ 02157000
*                                                                  0678 02158000
*         IF RSWFCREA = OFF                                        0678 02159000
*           THEN                                                   0678 02160000
         TM    RSWFCREA(REG6),B'00100000'                          0678 02161000
         BNZ   @RF00678                                            0678 02162000
*             DO;                                                  0679 02163000
*                                                                  0679 02164000
*         /***********************************************************/ 02165000
*         /*                                                         */ 02166000
*         /*    CLOSE THE WORKFILE VIA DSCLOSE.                      */ 02167000
*         /*                                                         */ 02168000
*         /***********************************************************/ 02169000
*                                                                  0680 02170000
*               /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSCLOSE      */ 02171000
*               CALL IDCRS6DC('W');                                0680 02172000
*                                                                  0680 02173000
         L     @15,@CV03542                                        0680 02174000
         LA    @01,@AL00680                                        0680 02175000
         BALR  @14,@15                                             0680 02176000
*               RESPECIFY RTNREG RSTD;                             0681 02177000
*               TESTRC = RTNREG;                                   0682 02178000
         STH   RTNREG,TESTRC(,REG6)                                0682 02179000
*               RESPECIFY RTNREG UNRSTD;                           0683 02180000
*                                                                  0683 02181000
*         /***********************************************************/ 02182000
*         /*                                                         */ 02183000
*         /*    IF CLOSE FAILED, CALL CKERR TO TERMINATE. OTHERWISE  */ 02184000
*         /*    SET WORKFILE CREATED FLAG ON.                        */ 02185000
*         /*                                                         */ 02186000
*         /***********************************************************/ 02187000
*                                                                  0684 02188000
*               IF TESTRC ^= 0                                     0684 02189000
*                 THEN                                             0684 02190000
*                                                                  0684 02191000
*                                                                  0684 02192000
         LH    @04,TESTRC(,REG6)                                   0684 02193000
         LTR   @04,@04                                             0684 02194000
         BZ    @RF00684                                            0684 02195000
*                   DO;                                            0685 02196000
*                   /*CALL CKERR*/                                 0686 02197000
*                     RSCKERR = RSCKERR && RSCKERR;                0686 02198000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0686 02199000
*                     RSCKERN = RSE079;                            0687 02200000
         MVC   RSCKERN(2,REG6),@CH01046                            0687 02201000
*                     RSCKTERM = 'TERM';                           0688 02202000
*                                                                  0688 02203000
         MVC   RSCKTERM(4,REG6),@CC03543                           0688 02204000
*                   /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR    */ 02205000
*                   CALL CKERR;                                    0689 02206000
         L     @15,@CV03544                                        0689 02207000
         BALR  @14,@15                                             0689 02208000
*                   END;                                           0690 02209000
*                                                                  0690 02210000
*                 ELSE                                             0691 02211000
*                   RSWFCREA = ON;                                 0691 02212000
*                                                                  0691 02213000
         B     @RC00684                                            0691 02214000
@RF00684 OI    RSWFCREA(REG6),B'00100000'                          0691 02215000
*             END;                                                 0692 02216000
*                                                                  0692 02217000
*         /***********************************************************/ 02218000
*         /*                                                         */ 02219000
*         /*  WORKFILE WAS PREVIOUSLY LOADED. MARK ALL RECORDS       */ 02220000
*         /*  WHICH WERE MERGED FROM CRAS IN FIRST PASS AND NOT      */ 02221000
*         /*  RELOADED FROM CATALOG IN SECOND PASS AS INVALID.       */ 02222000
*         /*  POSITION TO THE NEXT RELATIVE RECORD AND READ          */ 02223000
*         /*  AND UPDATE SEQUENTIALLY.                               */ 02224000
*         /*                                                         */ 02225000
*         /***********************************************************/ 02226000
*                                                                  0693 02227000
*           ELSE                                                   0693 02228000
*             DO;                                                  0693 02229000
         B     @RC00678                                            0693 02230000
@RF00678 DS    0H                                                  0694 02231000
*               RSGRABCU = ADDR(GRABSWF);                          0694 02232000
         L     @04,RSIOTBL(,REG6)                                  0694 02233000
         ST    @04,RSGRABCU(,REG6)                                 0694 02234000
*               GRABAFLS = ''B;                                    0695 02235000
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       0695 02236000
*               RABRCDA = RSCURRN;                                 0696 02237000
         L     @04,GRABCURR(,@04)                                  0696 02238000
         L     @15,RSCURRN(,REG6)                                  0696 02239000
         ST    @15,RABRCDA(,@04)                                   0696 02240000
*               RABRRN = ON;                                       0697 02241000
*                                                                  0697 02242000
*                                                                  0697 02243000
         OI    RABRRN(@04),B'00010000'                             0697 02244000
*               DO;                                                0698 02245000
*                 RSRTYPE = ''B;                                   0699 02246000
         MVI   RSRTYPE(REG6),X'00'                                 0699 02247000
*                 RSRPOS = ON;      /* POSRCD  */                  0700 02248000
         OI    RSRPOS(REG6),B'00010000'                            0700 02249000
*                 RSRDS = ''B;                                     0701 02250000
         NI    RSRDS(REG6),B'00011111'                             0701 02251000
*                 RSRWF = ON;       /* WORKFILE  */                0702 02252000
*                 RSRDIR = OFF;     /* SEQUENTIAL  */              0703 02253000
*                 RSRKEY = ON;      /* KEY  */                     0704 02254000
*                                                                  0704 02255000
         OI    RSRWF(REG6),B'10010000'                             0704 02256000
         NI    RSRDIR(REG6),B'11111011'                            0704 02257000
*               /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT      */ 02258000
*               CALL RECMGMT;                                      0705 02259000
         L     @15,@CV03498                                        0705 02260000
         BALR  @14,@15                                             0705 02261000
*                 RFY RTNREG RSTD;                                 0706 02262000
*                 TESTRC = RTNREG;                                 0707 02263000
         STH   RTNREG,TESTRC(,REG6)                                0707 02264000
*                 RFY RTNREG UNRSTD;                               0708 02265000
*               END;                                               0709 02266000
*                                                                  0709 02267000
*COPYLP4:       DO WHILE(TESTRC ^= RCEOF);                         0710 02268000
*                                                                  0710 02269000
*                                                                  0710 02270000
COPYLP4  B     @DE00710                                            0710 02271000
@DL00710 DS    0H                                                  0711 02272000
*                 DO;                                              0711 02273000
*                   RSRTYPE = ''B;                                 0712 02274000
         MVI   RSRTYPE(REG6),X'00'                                 0712 02275000
*                   RSRGET = ON;      /* GETRCD  */                0713 02276000
         OI    RSRGET(REG6),B'10000000'                            0713 02277000
*                   RSRUPD = ON;      /* UPDATE  */                0714 02278000
         OI    RSRUPD(REG6),B'00001000'                            0714 02279000
*                   RSRDS = ''B;                                   0715 02280000
         NI    RSRDS(REG6),B'00011111'                             0715 02281000
*                   RSRWF = ON;       /* WORKFILE  */              0716 02282000
*                   RSRDIR = OFF;     /* SEQUENTIAL  */            0717 02283000
*                   RSRKEY = ON;      /* KEY  */                   0718 02284000
*                                                                  0718 02285000
         OI    RSRWF(REG6),B'10010000'                             0718 02286000
         NI    RSRDIR(REG6),B'11111011'                            0718 02287000
*                 /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT    */ 02288000
*                 CALL RECMGMT;                                    0719 02289000
         L     @15,@CV03498                                        0719 02290000
         BALR  @14,@15                                             0719 02291000
*                   RFY RTNREG RSTD;                               0720 02292000
*                   TESTRC = RTNREG;                               0721 02293000
         STH   RTNREG,TESTRC(,REG6)                                0721 02294000
*                   RFY RTNREG UNRSTD;                             0722 02295000
*                 END;                                             0723 02296000
*                                                                  0723 02297000
*                 IF TESTRC ^= RCEOF                               0724 02298000
*                   THEN                                           0724 02299000
         LH    @04,TESTRC(,REG6)                                   0724 02300000
         C     @04,@CF00478                                        0724 02301000
         BE    @RF00724                                            0724 02302000
*                     DO;                                          0725 02303000
*                       RSWFLD = ''B;                              0726 02304000
         L     @04,RSGRABCU(,REG6)                                 0726 02305000
         L     @04,GRABCURR(,@04)                                  0726 02306000
         XC    RSWFLD(10,@04),RSWFLD(@04)                          0726 02307000
*                       RSWINVCI = ON;                             0727 02308000
*                                                                  0727 02309000
*                                                                  0727 02310000
         OI    RSWINVCI(@04),B'10000000'                           0727 02311000
*                       DO;                                        0728 02312000
*                         RSRTYPE = ''B;                           0729 02313000
         MVI   RSRTYPE(REG6),X'00'                                 0729 02314000
*                         RSRUPDT = ON;     /* UPDRCD  */          0730 02315000
         OI    RSRUPDT(REG6),B'00100000'                           0730 02316000
*                         RSRUPD = ON;      /* UPDATE  */          0731 02317000
         OI    RSRUPD(REG6),B'00001000'                            0731 02318000
*                         RSRDS = ''B;                             0732 02319000
         NI    RSRDS(REG6),B'00011111'                             0732 02320000
*                         RSRWF = ON;       /* WORKFILE  */        0733 02321000
*                         RSRDIR = OFF;     /* SEQUENTIAL  */      0734 02322000
*                         RSRKEY = ON;      /* KEY  */             0735 02323000
*                                                                  0735 02324000
         OI    RSRWF(REG6),B'10010000'                             0735 02325000
         NI    RSRDIR(REG6),B'11111011'                            0735 02326000
*                       /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT 02327000
*                                                                    */ 02328000
*                       CALL RECMGMT;                              0736 02329000
         L     @15,@CV03498                                        0736 02330000
         BALR  @14,@15                                             0736 02331000
*                         RFY RTNREG RSTD;                         0737 02332000
*                         TESTRC = RTNREG;                         0738 02333000
         STH   RTNREG,TESTRC(,REG6)                                0738 02334000
*                         RFY RTNREG UNRSTD;                       0739 02335000
*                       END;                                       0740 02336000
*                                                                  0740 02337000
*                     END;                                         0741 02338000
*                                                                  0741 02339000
*               END COPYLP4;                                       0742 02340000
*                                                                  0742 02341000
@RF00724 DS    0H                                                  0742 02342000
@DE00710 CLC   TESTRC(2,REG6),@CH00478                             0742 02343000
         BNE   @DL00710                                            0742 02344000
*         /***********************************************************/ 02345000
*         /*                                                         */ 02346000
*         /*  FORCE A PHYSICAL WRITE OF THE LAST RECORD              */ 02347000
*         /*  PUT SEQUENTIALLY TO THE WORKFILE, VIA RECMGMT.         */ 02348000
*         /*                                                         */ 02349000
*         /***********************************************************/ 02350000
*                                                                  0743 02351000
*                                                                  0743 02352000
*               DO;                                                0743 02353000
*                 RSRECREQ = ''B;                                  0744 02354000
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0744 02355000
*                 RSREND = ON;      /* ENDRCD */                   0745 02356000
*                                                                  0745 02357000
         OI    RSREND(REG6),B'00000010'                            0745 02358000
*               /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT      */ 02359000
*               CALL RECMGMT;                                      0746 02360000
         L     @15,@CV03498                                        0746 02361000
         BALR  @14,@15                                             0746 02362000
*                 RFY RTNREG RSTD;                                 0747 02363000
*                 TESTRC = RTNREG;                                 0748 02364000
         STH   RTNREG,TESTRC(,REG6)                                0748 02365000
*                 RFY RTNREG UNRSTD;                               0749 02366000
*               END;                                               0750 02367000
*                                                                  0750 02368000
*               RABRRN = OFF;                                      0751 02369000
*                                                                  0751 02370000
*                                                                  0751 02371000
         L     @04,RSGRABCU(,REG6)                                 0751 02372000
         L     @04,GRABCURR(,@04)                                  0751 02373000
         NI    RABRRN(@04),B'11101111'                             0751 02374000
*             END;                                                 0752 02375000
*                                                                  0752 02376000
*         /***********************************************************/ 02377000
*         /*                                                         */ 02378000
*         /*  PROCESSING COMPLETED. RETURN.                          */ 02379000
*         /*                                                         */ 02380000
*         /***********************************************************/ 02381000
*                                                                  0753 02382000
*                                                                  0753 02383000
*                                                                  0753 02384000
*         IF GDTDBG = NULLPTR                                      0753 02385000
*           THEN;                                                  0753 02386000
@RC00678 L     @04,GDTDBG(,REG5)                                   0753 02387000
         LTR   @04,@04                                             0753 02388000
         BZ    @RT00753                                            0753 02389000
*           ELSE                                                   0755 02390000
*             CALL IDCDB010 (GDTTBL,'RSC2');                       0755 02391000
         ST    REG5,@AL00001                                       0755 02392000
         LA    @04,@CC03547                                        0755 02393000
         ST    @04,@AL00001+4                                      0755 02394000
         MVI   @AL00001+4,X'80'                                    0755 02395000
         L     @15,GDTDBG(,REG5)                                   0755 02396000
         LA    @01,@AL00001                                        0755 02397000
         BALR  @14,@15                                             0755 02398000
*      GENERATE;                                                   0756 02399000
@RT00753 DS    0H                                                  0756 02400000
         B     NAME0047+8  BR AROUND NAME                               02401000
         DS    0F                                                       02402000
NAME0047 DC    CL8'COPYADD'                                             02403000
*COPYADD: PROCEDURE                                                0757 02404000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0757 02405000
*                                                                  0757 02406000
         B     @PB00005                                            0757 02407000
COPYADD  DS    0H                                                  0758 02408000
*      GENERATE REFS(RS01RG08, REG6);                              0758 02409000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          02410000
         LR    @15,@13  OLD SAVE AREA                                   02411000
         LA    @13,72(@13)  NEW SAVE AREA                               02412000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     02413000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        02414000
         MVC   0(4,@15),NAME0047  PROCNAME TO REGSAVE                   02415000
*/********************************************************************/ 02416000
*/*                                                                  */ 02417000
*/*  WRITE WORKFILE RECORD VIA RECMGMT. IF WORKFILE RECORD TO BE     */ 02418000
*/*  WRITTEN ALREADY EXISTS,     UPDATE THE RECORD, OTHERWISE ADD    */ 02419000
*/*  THE RECORD. SET GRABS FLAG TO ADD RECORD IF NO RECORD FOUND     */ 02420000
*/*  ERROR ENCOUNTERED TRYING TO GET THE RECORD FOR UPDATE.          */ 02421000
*/*                                                                  */ 02422000
*/********************************************************************/ 02423000
*                                                                  0759 02424000
*                                                                  0759 02425000
*         /***********************************************************/ 02426000
*         /*                                                         */ 02427000
*         /*  CLEAR GRABS FLAGS.                                     */ 02428000
*         /*                                                         */ 02429000
*         /***********************************************************/ 02430000
*                                                                  0759 02431000
*         GRABAFLS = ''B;                                          0759 02432000
*                                                                  0759 02433000
         L     @04,RSGRABCU(,REG6)                                 0759 02434000
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       0759 02435000
*         /***********************************************************/ 02436000
*         /*                                                         */ 02437000
*         /*  WORKFILE RECORD DOES NOT EXIST. ADD IT.                */ 02438000
*         /*                                                         */ 02439000
*         /***********************************************************/ 02440000
*                                                                  0760 02441000
*         IF RSCURRN > RSWFHURR                                    0760 02442000
*           THEN                                                   0760 02443000
*                                                                  0760 02444000
*                                                                  0760 02445000
         L     @04,RSCURRN(,REG6)                                  0760 02446000
         C     @04,RSWFHURR(,REG6)                                 0760 02447000
         BNH   @RF00760                                            0760 02448000
*             DO;                                                  0761 02449000
*               RSRTYPE = ''B;                                     0762 02450000
         MVI   RSRTYPE(REG6),X'00'                                 0762 02451000
*               RSRADD = ON;      /* ADDRCD  */                    0763 02452000
         OI    RSRADD(REG6),B'01000000'                            0763 02453000
*               RSRUPD = OFF;     /* NO UPDATE  */                 0764 02454000
         NI    RSRUPD(REG6),B'11110111'                            0764 02455000
*               RSRDS = ''B;                                       0765 02456000
         NI    RSRDS(REG6),B'00011111'                             0765 02457000
*               RSRWF = ON;       /* WORKFILE  */                  0766 02458000
*               RSRDIR = OFF;     /* SEQUENTIAL  */                0767 02459000
*               RSRKEY = ON;      /* KEY  */                       0768 02460000
*                                                                  0768 02461000
         OI    RSRWF(REG6),B'10010000'                             0768 02462000
         NI    RSRDIR(REG6),B'11111011'                            0768 02463000
*             /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT        */ 02464000
*             CALL RECMGMT;                                        0769 02465000
         L     @15,@CV03498                                        0769 02466000
         BALR  @14,@15                                             0769 02467000
*               RFY RTNREG RSTD;                                   0770 02468000
*               TESTRC = RTNREG;                                   0771 02469000
         STH   RTNREG,TESTRC(,REG6)                                0771 02470000
*               RFY RTNREG UNRSTD;                                 0772 02471000
*             END;                                                 0773 02472000
*                                                                  0773 02473000
*         /***********************************************************/ 02474000
*         /*                                                         */ 02475000
*         /*  WORKFILE RECORD MAY ALREADY EXIST. UPDATE IT OR        */ 02476000
*         /*  ADD IT IF NO RECORD FOUND.                             */ 02477000
*         /*                                                         */ 02478000
*         /***********************************************************/ 02479000
*                                                                  0774 02480000
*           ELSE                                                   0774 02481000
*             DO;                                                  0774 02482000
         B     @RC00760                                            0774 02483000
@RF00760 DS    0H                                                  0775 02484000
*               GRABSNRA = ON;                                     0775 02485000
*               GRABSEFN = ON;                                     0776 02486000
         L     @04,RSGRABCU(,REG6)                                 0776 02487000
         OI    GRABSNRA(@04),B'01100000'                           0776 02488000
*               RABRCDA = RSCURRN;                                 0777 02489000
         L     @04,GRABCURR(,@04)                                  0777 02490000
         L     @15,RSCURRN(,REG6)                                  0777 02491000
         ST    @15,RABRCDA(,@04)                                   0777 02492000
*               RABRRN = ON;                                       0778 02493000
*                                                                  0778 02494000
*                                                                  0778 02495000
         OI    RABRRN(@04),B'00010000'                             0778 02496000
*               DO;                                                0779 02497000
*                 RSRTYPE = ''B;                                   0780 02498000
         MVI   RSRTYPE(REG6),X'00'                                 0780 02499000
*                 RSRUPDT = ON;     /* UPDRCD  */                  0781 02500000
         OI    RSRUPDT(REG6),B'00100000'                           0781 02501000
*                 RSRUPD = ON;      /* UPDATE  */                  0782 02502000
         OI    RSRUPD(REG6),B'00001000'                            0782 02503000
*                 RSRDS = ''B;                                     0783 02504000
         NI    RSRDS(REG6),B'00011111'                             0783 02505000
*                 RSRWF = ON;       /* WORKFILE  */                0784 02506000
*                 RSRDIR = ON;      /* DIRECT  */                  0785 02507000
*                 RSRKEY = ON;      /* KEY  */                     0786 02508000
*                                                                  0786 02509000
         OI    RSRWF(REG6),B'10010100'                             0786 02510000
*               /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT      */ 02511000
*               CALL RECMGMT;                                      0787 02512000
         L     @15,@CV03498                                        0787 02513000
         BALR  @14,@15                                             0787 02514000
*                 RFY RTNREG RSTD;                                 0788 02515000
*                 TESTRC = RTNREG;                                 0789 02516000
         STH   RTNREG,TESTRC(,REG6)                                0789 02517000
*                 RFY RTNREG UNRSTD;                               0790 02518000
*               END;                                               0791 02519000
*                                                                  0791 02520000
*               GRABAFLS = ''B;                                    0792 02521000
         L     @04,RSGRABCU(,REG6)                                 0792 02522000
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       0792 02523000
*               RABRRN = OFF;                                      0793 02524000
         L     @04,GRABCURR(,@04)                                  0793 02525000
         NI    RABRRN(@04),B'11101111'                             0793 02526000
*             END;                                                 0794 02527000
*                                                                  0794 02528000
*         /***********************************************************/ 02529000
*         /*                                                         */ 02530000
*         /*  INCREMENT CURRENT RELATIVE RECORD NUMBER               */ 02531000
*         /*                                                         */ 02532000
*         /***********************************************************/ 02533000
*                                                                  0795 02534000
*         RSCURRN = RSCURRN + 1;                                   0795 02535000
*                                                                  0795 02536000
@RC00760 LA    @04,1                                               0795 02537000
         AL    @04,RSCURRN(,REG6)                                  0795 02538000
         ST    @04,RSCURRN(,REG6)                                  0795 02539000
*         /***********************************************************/ 02540000
*         /*                                                         */ 02541000
*         /*  PROCESSING COMPLETED. RETURN.                          */ 02542000
*         /*                                                         */ 02543000
*         /***********************************************************/ 02544000
*                                                                  0796 02545000
* CALL EXIT;  /*TERMINATE*/                                        0796 02546000
         BAL   @14,EXIT                                            0796 02547000
* END COPYADD; /*END OF PROCEDURE*/                                0797 02548000
*                                                                  0797 02549000
@EL00005 DS    0H                                                  0797 02550000
@EF00005 DS    0H                                                  0797 02551000
@ER00005 BR    @14                                                 0797 02552000
@PB00005 DS    0H                                                  0798 02553000
* CALL EXIT;  /*TERMINATE*/                                        0798 02554000
         BAL   @14,EXIT                                            0798 02555000
* END COPYCAT; /*END OF PROCEDURE*/                                0799 02556000
@EL00004 DS    0H                                                  0799 02557000
@EF00004 DS    0H                                                  0799 02558000
@ER00004 BR    @14                                                 0799 02559000
@PB00004 DS    0H                                                  0800 02560000
*/********************************************************************/ 02561000
*/*                                                                  */ 02562000
*/* PROCEDURE NAME - INIT                                            */ 02563000
*/*                                                                  */ 02564000
*/* FUNCTION - INITIALIZE WORKAREAS AND TABLES.                      */ 02565000
*/*            OPEN, VALIDITY CHECK, RESERVE AND VERIFY THE CATALOG. */ 02566000
*/*            DEFINE AND OPEN THE WORKFILE.                         */ 02567000
*/*            ALLOCATE ALL CRA VOLUMES SPECIFIED FOR RESET.         */ 02568000
*/*                                                                  */ 02569000
*/* INPUT -    NONE                                                  */ 02570000
*/*                                                                  */ 02571000
*/* OUTPUT -   NONE                                                  */ 02572000
*/*                                                                  */ 02573000
*/* EXIT, NORMAL - RETURN TO CALLER                                  */ 02574000
*/* EXIT, ERROR - TO CKERR TO TERMINATE                              */ 02575000
*/*                                                                  */ 02576000
*/********************************************************************/ 02577000
*      GENERATE;                                                   0800 02578000
         DS    0F                                                       02579000
NAME0054 DC    CL8'INIT'                                                02580000
*INIT: PROCEDURE                                                   0801 02581000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0801 02582000
*                                                                  0801 02583000
         B     @PB00006                                            0801 02584000
INIT     DS    0H                                                  0802 02585000
*      GENERATE REFS(RS01RG08, REG6);                              0802 02586000
*                                                                  0802 02587000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          02588000
         LR    @15,@13  OLD SAVE AREA                                   02589000
         LA    @13,72(@13)  NEW SAVE AREA                               02590000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     02591000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        02592000
         MVC   0(4,@15),NAME0054  PROCNAME TO REGSAVE                   02593000
*         /***********************************************************/ 02594000
*         /*                                                         */ 02595000
*         /*  UCATLG DATA DECLARATIONS.                              */ 02596000
*         /*                                                         */ 02597000
*         /***********************************************************/ 02598000
*                                                                  0803 02599000
*         DCL INITDSN   CHAR(*) BASED(CTGFLPT(1));                 0803 02600000
*                                      /*CATALOG DATA SET NAME       */ 02601000
*         DCL INITVLSR  CHAR(*) BASED(CTGFLPT(1));                 0804 02602000
*                                      /*CATALOG VOLSER              */ 02603000
*         DCL INITTS    CHAR(*) BASED(CTGFLPT(1));                 0805 02604000
*                                      /*CATALOG TIMESTAMP           */ 02605000
*         DCL INITACB   PTR(31) BASED(CTGFLPT(1));                 0806 02606000
*                                      /*CATALOG ACB                 */ 02607000
*         DCL INITATR1  CHAR(1) BASED(CTGFLPT(1));                 0807 02608000
*                                      /*DATA ATTRIBUTES             */ 02609000
*         DCL INITWACB  PTR(31) BASED(CTGFLPT(1));                 0808 02610000
*                                      /*WORKFILE CATALOG ACB PTR    */ 02611000
*         DCL RCCAT     FIXED(15) CONSTANT(4);                     0809 02612000
*                                      /*UCATLG RC - CATLG NOT ACCESS*/ 02613000
*                                                                  0810 02614000
*         /***********************************************************/ 02615000
*         /*                                                         */ 02616000
*         /*  UIOINFO RETURN AREA HEADER                             */ 02617000
*         /*                                                         */ 02618000
*         /***********************************************************/ 02619000
*                                                                  0810 02620000
*         DCL 1 UINFHDR BASED(RSUIRPT) BDY(HWORD),                 0810 02621000
*               2 UINFTLN FIXED(15),  /*LENGTH OF RETURN AREA        */ 02622000
*               2 UINFRLN FIXED(15);  /*LENGTH OF DATA RETURNED      */ 02623000
*                                                                  0810 02624000
*         RFY IFGACB BASED(RSCATACB);                              0811 02625000
*         RFY RESVOL BASED(RSENTPT);                               0812 02626000
*         RFY CRAVL BASED(RSINCVPT);                               0813 02627000
*         RFY CRADV BASED(RSINDVPT);                               0814 02628000
*         RFY CRADN BASED(RSINDNPT);                               0815 02629000
*         OLDERID2 = NEWERID2;                                     0816 02630000
         L     @04,GDTTR2(,REG5)                                   0816 02631000
         MVC   @TS00001(95),NEWERID2(@04)                          0816 02632000
         MVC   OLDERID2(95,@04),@TS00001                           0816 02633000
*         NEWID2 = 'RSIN';                                         0817 02634000
*                                                                  0817 02635000
         MVC   NEWID2(4,@04),@CC03569                              0817 02636000
*         /***********************************************************/ 02637000
*         /*                                                         */ 02638000
*         /*  OBTAIN STORAGE FOR THE RECORD ACCESS BLOCKS (RABS)     */ 02639000
*         /*                                                         */ 02640000
*         /***********************************************************/ 02641000
*                                                                  0818 02642000
*         RSUGLEN = DIM(RABS) * LENGTH(RABS);                      0818 02643000
*                                                                  0818 02644000
         MVC   RSUGLEN(4,REG6),@CF03735                            0818 02645000
*         CALL IDCSAGP0 (GDTTBL,RSUGLEN,RSRABWA,POOL1,SETZERO);    0819 02646000
*                                                                  0819 02647000
         ST    REG5,@AL00001                                       0819 02648000
         LA    @04,RSUGLEN(,REG6)                                  0819 02649000
         ST    @04,@AL00001+4                                      0819 02650000
         LA    @04,RSRABWA(,REG6)                                  0819 02651000
         ST    @04,@AL00001+8                                      0819 02652000
         LA    @04,@CC00900                                        0819 02653000
         ST    @04,@AL00001+12                                     0819 02654000
         LA    @04,SETZERO                                         0819 02655000
         ST    @04,@AL00001+16                                     0819 02656000
         MVI   @AL00001+16,X'80'                                   0819 02657000
         L     @15,GDTGPL(,REG5)                                   0819 02658000
         LA    @01,@AL00001                                        0819 02659000
         BALR  @14,@15                                             0819 02660000
*         RESPECIFY RTNREG RSTD;                                   0820 02661000
*         TESTRC = RTNREG;                                         0821 02662000
         STH   RTNREG,TESTRC(,REG6)                                0821 02663000
*         RESPECIFY RTNREG UNRSTD;                                 0822 02664000
*                                                                  0822 02665000
*         /***********************************************************/ 02666000
*         /*                                                         */ 02667000
*         /*    IF STORAGE WAS NOT AVAILABLE, CALL CKERR TO          */ 02668000
*         /*    TERMINATE.                                           */ 02669000
*         /*                                                         */ 02670000
*         /***********************************************************/ 02671000
*                                                                  0823 02672000
*         IF TESTRC ^= 0                                           0823 02673000
*           THEN                                                   0823 02674000
*                                                                  0823 02675000
*                                                                  0823 02676000
         LH    @04,TESTRC(,REG6)                                   0823 02677000
         LTR   @04,@04                                             0823 02678000
         BZ    @RF00823                                            0823 02679000
*             DO;                                                  0824 02680000
*             /*CALL CKERR*/                                       0825 02681000
*               RSCKERR = RSCKERR && RSCKERR;                      0825 02682000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0825 02683000
*               RSCKERN = RSE099;                                  0826 02684000
         MVC   RSCKERN(2,REG6),@CH01083                            0826 02685000
*               RSCKTERM = 'TERM';                                 0827 02686000
*                                                                  0827 02687000
         MVC   RSCKTERM(4,REG6),@CC03543                           0827 02688000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 02689000
*             CALL CKERR;                                          0828 02690000
         L     @15,@CV03544                                        0828 02691000
         BALR  @14,@15                                             0828 02692000
*             END;                                                 0829 02693000
*                                                                  0829 02694000
*         /***********************************************************/ 02695000
*         /*                                                         */ 02696000
*         /*  OBTAIN STORAGE FOR RECORD MANAGEMENT AND U-MACRO       */ 02697000
*         /*  WORKAREA                                               */ 02698000
*         /*                                                         */ 02699000
*         /***********************************************************/ 02700000
*                                                                  0830 02701000
*         RSUGLEN = LENGTH(RECIOWA);                               0830 02702000
*                                                                  0830 02703000
@RF00823 MVC   RSUGLEN(4,REG6),@CF03736                            0830 02704000
*         CALL IDCSAGP0 (GDTTBL,RSUGLEN,RSIOTBL,POOL1,SETZERO);    0831 02705000
*                                                                  0831 02706000
         ST    REG5,@AL00001                                       0831 02707000
         LA    @04,RSUGLEN(,REG6)                                  0831 02708000
         ST    @04,@AL00001+4                                      0831 02709000
         LA    @04,RSIOTBL(,REG6)                                  0831 02710000
         ST    @04,@AL00001+8                                      0831 02711000
         LA    @04,@CC00900                                        0831 02712000
         ST    @04,@AL00001+12                                     0831 02713000
         LA    @04,SETZERO                                         0831 02714000
         ST    @04,@AL00001+16                                     0831 02715000
         MVI   @AL00001+16,X'80'                                   0831 02716000
         L     @15,GDTGPL(,REG5)                                   0831 02717000
         LA    @01,@AL00001                                        0831 02718000
         BALR  @14,@15                                             0831 02719000
*         RESPECIFY RTNREG RSTD;                                   0832 02720000
*         TESTRC = RTNREG;                                         0833 02721000
         STH   RTNREG,TESTRC(,REG6)                                0833 02722000
*         RESPECIFY RTNREG UNRSTD;                                 0834 02723000
*                                                                  0834 02724000
*         /***********************************************************/ 02725000
*         /*                                                         */ 02726000
*         /*    IF STORAGE WAS NOT AVAILABLE, CALL CKERR TO          */ 02727000
*         /*    TERMINATE.                                           */ 02728000
*         /*                                                         */ 02729000
*         /***********************************************************/ 02730000
*                                                                  0835 02731000
*         IF TESTRC ^= 0                                           0835 02732000
*           THEN                                                   0835 02733000
*                                                                  0835 02734000
*                                                                  0835 02735000
         LH    @04,TESTRC(,REG6)                                   0835 02736000
         LTR   @04,@04                                             0835 02737000
         BZ    @RF00835                                            0835 02738000
*             DO;                                                  0836 02739000
*             /*CALL CKERR*/                                       0837 02740000
*               RSCKERR = RSCKERR && RSCKERR;                      0837 02741000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0837 02742000
*               RSCKERN = RSE099;                                  0838 02743000
         MVC   RSCKERN(2,REG6),@CH01083                            0838 02744000
*               RSCKTERM = 'TERM';                                 0839 02745000
*                                                                  0839 02746000
         MVC   RSCKTERM(4,REG6),@CC03543                           0839 02747000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 02748000
*             CALL CKERR;                                          0840 02749000
         L     @15,@CV03544                                        0840 02750000
         BALR  @14,@15                                             0840 02751000
*             END;                                                 0841 02752000
*                                                                  0841 02753000
*         /***********************************************************/ 02754000
*         /*                                                         */ 02755000
*         /*  OBTAIN STORAGE FOR THE CATALOG MANAGEMENT WORKAREA     */ 02756000
*         /*                                                         */ 02757000
*         /***********************************************************/ 02758000
*                                                                  0842 02759000
*         RSUGLEN = LENGTH(CTGPL) + DIM(RSFPL) * LENGTH(CTGFIELD)  0842 02760000
*               + DIM(RSFPL) * (LENGTH(CTGFL) + LENGTH(CTGFLDAT)); 0842 02761000
*                                                                  0842 02762000
@RF00835 MVC   RSUGLEN(4,REG6),@CF03738                            0842 02763000
*         CALL IDCSAGP0 (GDTTBL,RSUGLEN,CTGPLPTR,POOL1,SETZERO);   0843 02764000
*                                                                  0843 02765000
         ST    REG5,@AL00001                                       0843 02766000
         LA    @04,RSUGLEN(,REG6)                                  0843 02767000
         ST    @04,@AL00001+4                                      0843 02768000
         LA    @04,CTGPLPTR(,REG6)                                 0843 02769000
         ST    @04,@AL00001+8                                      0843 02770000
         LA    @04,@CC00900                                        0843 02771000
         ST    @04,@AL00001+12                                     0843 02772000
         LA    @04,SETZERO                                         0843 02773000
         ST    @04,@AL00001+16                                     0843 02774000
         MVI   @AL00001+16,X'80'                                   0843 02775000
         L     @15,GDTGPL(,REG5)                                   0843 02776000
         LA    @01,@AL00001                                        0843 02777000
         BALR  @14,@15                                             0843 02778000
*         RESPECIFY RTNREG RSTD;                                   0844 02779000
*         TESTRC = RTNREG;                                         0845 02780000
         STH   RTNREG,TESTRC(,REG6)                                0845 02781000
*         RESPECIFY RTNREG UNRSTD;                                 0846 02782000
*                                                                  0846 02783000
*         /***********************************************************/ 02784000
*         /*                                                         */ 02785000
*         /*    IF STORAGE WAS NOT AVAILABLE, CALL CKERR TO          */ 02786000
*         /*    TERMINATE.                                           */ 02787000
*         /*                                                         */ 02788000
*         /***********************************************************/ 02789000
*                                                                  0847 02790000
*         IF TESTRC ^= 0                                           0847 02791000
*           THEN                                                   0847 02792000
*                                                                  0847 02793000
*                                                                  0847 02794000
         LH    @04,TESTRC(,REG6)                                   0847 02795000
         LTR   @04,@04                                             0847 02796000
         BZ    @RF00847                                            0847 02797000
*             DO;                                                  0848 02798000
*             /*CALL CKERR*/                                       0849 02799000
*               RSCKERR = RSCKERR && RSCKERR;                      0849 02800000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0849 02801000
*               RSCKERN = RSE099;                                  0850 02802000
         MVC   RSCKERN(2,REG6),@CH01083                            0850 02803000
*               RSCKTERM = 'TERM';                                 0851 02804000
*                                                                  0851 02805000
         MVC   RSCKTERM(4,REG6),@CC03543                           0851 02806000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 02807000
*             CALL CKERR;                                          0852 02808000
         L     @15,@CV03544                                        0852 02809000
         BALR  @14,@15                                             0852 02810000
*             END;                                                 0853 02811000
*                                                                  0853 02812000
*         /***********************************************************/ 02813000
*         /*                                                         */ 02814000
*         /*  SET UP FPL POINTERS.                                   */ 02815000
*         /*                                                         */ 02816000
*         /***********************************************************/ 02817000
*                                                                  0854 02818000
*         RSFPL(1) = CTGPLPTR + LENGTH(CTGPL)                      0854 02819000
*                 + DIM(RSFPL) * LENGTH(CTGFIELD);                 0854 02820000
*                                                                  0854 02821000
@RF00847 LA    @04,48                                              0854 02822000
         AL    @04,CTGPLPTR(,REG6)                                 0854 02823000
         ST    @04,RSFPL(,REG6)                                    0854 02824000
*INITLP1:                                                          0855 02825000
*         DO RSIDX = 2 TO DIM(RSFPL);                              0855 02826000
*                                                                  0855 02827000
INITLP1  LA    @04,2                                               0855 02828000
         STH   @04,RSIDX(,REG6)                                    0855 02829000
@DL00855 DS    0H                                                  0856 02830000
*           RSFPL(RSIDX) = RSFPL(RSIDX -1) + LENGTH(CTGFL)         0856 02831000
*                        + LENGTH(CTGFLDAT);                       0856 02832000
*                                                                  0856 02833000
         LH    @04,RSIDX(,REG6)                                    0856 02834000
         SLA   @04,2                                               0856 02835000
         LA    @15,24                                              0856 02836000
         AL    @15,RSFPL-8(@04,REG6)                               0856 02837000
         ST    @15,RSFPL-4(@04,REG6)                               0856 02838000
*         END INITLP1;                                             0857 02839000
*                                                                  0857 02840000
         LA    @04,1                                               0857 02841000
         AH    @04,RSIDX(,REG6)                                    0857 02842000
         STH   @04,RSIDX(,REG6)                                    0857 02843000
         C     @04,@CF00287                                        0857 02844000
         BNH   @DL00855                                            0857 02845000
*         /***********************************************************/ 02846000
*         /*                                                         */ 02847000
*         /*  SAVE FDT INFORMATION IN THE MAIN WORKAREA.             */ 02848000
*         /*                                                         */ 02849000
*         /***********************************************************/ 02850000
*                                                                  0858 02851000
*                                                                  0858 02852000
*         /***********************************************************/ 02853000
*         /*                                                         */ 02854000
*         /*    SAVE CATALOG DSNAME,DDNAME AND PASSWORD.             */ 02855000
*         /*                                                         */ 02856000
*         /***********************************************************/ 02857000
*                                                                  0858 02858000
*         RSCATDSN = CATNMVAL(1:CATNMLEN);                         0858 02859000
         MVI   RSCATDSN+1(REG6),C' '                               0858 02860000
         MVC   RSCATDSN+2(42,REG6),RSCATDSN+1(REG6)                0858 02861000
         L     @04,@PC00001+4                                      0858 02862000
         L     @04,FDTPTR+4(,@04)                                  0858 02863000
         SLR   @15,@15                                             0858 02864000
         IC    @15,CATNMLEN(,@04)                                  0858 02865000
         BCTR  @15,0                                               0858 02866000
         EX    @15,@SM03785                                        0858 02867000
*         RSCADS = ADDR(RSCATDSN);                                 0859 02868000
*                                                                  0859 02869000
         LA    @15,RSCATDSN(,REG6)                                 0859 02870000
         ST    @15,RSCADS(,REG6)                                   0859 02871000
*         IF CATNMPLN ^= 0                                         0860 02872000
*           THEN                                                   0860 02873000
         CLI   CATNMPLN(@04),0                                     0860 02874000
         BE    @RF00860                                            0860 02875000
*             DO;                                                  0861 02876000
*               RSCATPS = CATNMPAS(1:CATNMPLN);                    0862 02877000
         MVI   RSCATPS+1(REG6),C' '                                0862 02878000
         MVC   RSCATPS+2(6,REG6),RSCATPS+1(REG6)                   0862 02879000
         SLR   @15,@15                                             0862 02880000
         IC    @15,CATNMPLN(,@04)                                  0862 02881000
         BCTR  @15,0                                               0862 02882000
         EX    @15,@SM03787                                        0862 02883000
*               RSCAPAS = ADDR(RSCATPS);                           0863 02884000
         LA    @04,RSCATPS(,REG6)                                  0863 02885000
         ST    @04,RSCAPAS(,REG6)                                  0863 02886000
*             END;                                                 0864 02887000
*                                                                  0864 02888000
*         RSCADD = ADDR(RSCATDDN);                                 0865 02889000
@RF00860 LA    @04,RSCATDDN(,REG6)                                 0865 02890000
         ST    @04,RSCADD(,REG6)                                   0865 02891000
*         IF ADDR(CATDN) ^= 0                                      0866 02892000
*           THEN                                                   0866 02893000
         L     @04,@PC00001+4                                      0866 02894000
         L     @04,FDTPTR+8(,@04)                                  0866 02895000
         LTR   @04,@04                                             0866 02896000
         BZ    @RF00866                                            0866 02897000
*             RSCATDDN = CATDNVAL(1:CATDNLEN);                     0867 02898000
*                                                                  0867 02899000
         MVI   RSCATDDN+1(REG6),C' '                               0867 02900000
         MVC   RSCATDDN+2(6,REG6),RSCATDDN+1(REG6)                 0867 02901000
         SLR   @15,@15                                             0867 02902000
         IC    @15,CATDNLEN(,@04)                                  0867 02903000
         BCTR  @15,0                                               0867 02904000
         EX    @15,@SM03789                                        0867 02905000
*         /***********************************************************/ 02906000
*         /*                                                         */ 02907000
*         /*    IF THE MASTER PASSWORD WAS SPECIFIED, SAVE IT.       */ 02908000
*         /*                                                         */ 02909000
*         /***********************************************************/ 02910000
*                                                                  0868 02911000
*         IF ADDR(MRPW) ^= 0                                       0868 02912000
*           THEN                                                   0868 02913000
@RF00866 L     @04,@PC00001+4                                      0868 02914000
         L     @04,FDTPTR+12(,@04)                                 0868 02915000
         LTR   @04,@04                                             0868 02916000
         BZ    @RF00868                                            0868 02917000
*             DO;                                                  0869 02918000
*               RSMRPS = MRPWVAL(1:MRPWLEN);                       0870 02919000
         MVI   RSMRPS+1(REG6),C' '                                 0870 02920000
         MVC   RSMRPS+2(6,REG6),RSMRPS+1(REG6)                     0870 02921000
         SLR   @15,@15                                             0870 02922000
         IC    @15,MRPWLEN(,@04)                                   0870 02923000
         BCTR  @15,0                                               0870 02924000
         EX    @15,@SM03791                                        0870 02925000
*               RSMRPAS = ADDR(RSMRPS);                            0871 02926000
         LA    @04,RSMRPS(,REG6)                                   0871 02927000
         ST    @04,RSMRPAS(,REG6)                                  0871 02928000
*             END;                                                 0872 02929000
*                                                                  0872 02930000
*         /***********************************************************/ 02931000
*         /*                                                         */ 02932000
*         /*    IF WORKFILE PARAMETER SPECIFIED, SAVE DDNAME AND     */ 02933000
*         /*    PASSWORD.                                            */ 02934000
*         /*                                                         */ 02935000
*         /***********************************************************/ 02936000
*                                                                  0873 02937000
*         IF ADDR(WFDN) ^= 0                                       0873 02938000
*           THEN                                                   0873 02939000
@RF00868 L     @04,@PC00001+4                                      0873 02940000
         L     @15,FDTPTR+16(,@04)                                 0873 02941000
         LTR   @15,@15                                             0873 02942000
         BZ    @RF00873                                            0873 02943000
*             DO;                                                  0874 02944000
*               RSWFDDNM = WFILEVAL(1:WFILELEN);                   0875 02945000
         MVI   RSWFDDNM+1(REG6),C' '                               0875 02946000
         MVC   RSWFDDNM+2(6,REG6),RSWFDDNM+1(REG6)                 0875 02947000
         L     @04,FDTPTR+60(,@04)                                 0875 02948000
         SLR   @15,@15                                             0875 02949000
         IC    @15,WFILELEN(,@04)                                  0875 02950000
         BCTR  @15,0                                               0875 02951000
         EX    @15,@SM03793                                        0875 02952000
*               IF WFILEPLN ^= 0                                   0876 02953000
*                 THEN                                             0876 02954000
         CLI   WFILEPLN(@04),0                                     0876 02955000
         BE    @RF00876                                            0876 02956000
*                   DO;                                            0877 02957000
*                     RSWFPS = WFILEPAS(1:WFILEPLN);               0878 02958000
         MVI   RSWFPS+1(REG6),C' '                                 0878 02959000
         MVC   RSWFPS+2(6,REG6),RSWFPS+1(REG6)                     0878 02960000
         SLR   @15,@15                                             0878 02961000
         IC    @15,WFILEPLN(,@04)                                  0878 02962000
         BCTR  @15,0                                               0878 02963000
         EX    @15,@SM03795                                        0878 02964000
*                     RSWFPAS = ADDR(RSWFPS);                      0879 02965000
         LA    @04,RSWFPS(,REG6)                                   0879 02966000
         ST    @04,RSWFPAS(,REG6)                                  0879 02967000
*                   END;                                           0880 02968000
*                                                                  0880 02969000
*             END;                                                 0881 02970000
*                                                                  0881 02971000
*         /***********************************************************/ 02972000
*         /*                                                         */ 02973000
*         /*    IF WORKFILE PARAMETER NOT SPECIFIED, USE DEFAULT     */ 02974000
*         /*    DDNAME OF IDCUT1                                     */ 02975000
*         /*                                                         */ 02976000
*         /***********************************************************/ 02977000
*                                                                  0882 02978000
*           ELSE                                                   0882 02979000
*             RSWFDDNM = IDCUT1;                                   0882 02980000
*                                                                  0882 02981000
         B     @RC00873                                            0882 02982000
@RF00873 MVC   RSWFDDNM(8,REG6),@CC00777                           0882 02983000
*         RSWFDD = ADDR(RSWFDDNM);                                 0883 02984000
*                                                                  0883 02985000
@RC00873 LA    @04,RSWFDDNM(,REG6)                                 0883 02986000
         ST    @04,RSWFDD(,REG6)                                   0883 02987000
*         /***********************************************************/ 02988000
*         /*                                                         */ 02989000
*         /*    IF WORKCAT PARAMETER SPECIFIED, SAVE DSNAME AND      */ 02990000
*         /*    PASSWORD.                                            */ 02991000
*         /*                                                         */ 02992000
*         /***********************************************************/ 02993000
*                                                                  0884 02994000
*         IF ADDR(WCAT) ^= 0                                       0884 02995000
*           THEN                                                   0884 02996000
         L     @04,@PC00001+4                                      0884 02997000
         L     @04,FDTPTR+20(,@04)                                 0884 02998000
         LTR   @04,@04                                             0884 02999000
         BZ    @RF00884                                            0884 03000000
*             DO;                                                  0885 03001000
*               RSWCATNM = WCATVAL(1:WCATLEN);                     0886 03002000
         MVI   RSWCATNM+1(REG6),C' '                               0886 03003000
         MVC   RSWCATNM+2(42,REG6),RSWCATNM+1(REG6)                0886 03004000
         SLR   @15,@15                                             0886 03005000
         IC    @15,WCATLEN(,@04)                                   0886 03006000
         BCTR  @15,0                                               0886 03007000
         EX    @15,@SM03797                                        0886 03008000
*               RSWCDS = ADDR(RSWCATNM);                           0887 03009000
         LA    @15,RSWCATNM(,REG6)                                 0887 03010000
         ST    @15,RSWCDS(,REG6)                                   0887 03011000
*               IF WCATPLN ^= 0                                    0888 03012000
*                 THEN                                             0888 03013000
         CLI   WCATPLN(@04),0                                      0888 03014000
         BE    @RF00888                                            0888 03015000
*                   DO;                                            0889 03016000
*                     RSWCATPS = WCATPAS(1:WCATPLN);               0890 03017000
         MVI   RSWCATPS+1(REG6),C' '                               0890 03018000
         MVC   RSWCATPS+2(6,REG6),RSWCATPS+1(REG6)                 0890 03019000
         SLR   @15,@15                                             0890 03020000
         IC    @15,WCATPLN(,@04)                                   0890 03021000
         BCTR  @15,0                                               0890 03022000
         EX    @15,@SM03799                                        0890 03023000
*                     RSWCPAS = ADDR(RSWCATPS);                    0891 03024000
         LA    @04,RSWCATPS(,REG6)                                 0891 03025000
         ST    @04,RSWCPAS(,REG6)                                  0891 03026000
*                   END;                                           0892 03027000
*                                                                  0892 03028000
*             END;                                                 0893 03029000
*                                                                  0893 03030000
@RF00888 DS    0H                                                  0894 03031000
*         /***********************************************************/ 03032000
*         /*                                                         */ 03033000
*         /*    SAVE IGNORE OR NOIGNORE OPTION.                      */ 03034000
*         /*                                                         */ 03035000
*         /***********************************************************/ 03036000
*                                                                  0894 03037000
*         IF ADDR(IGN) ^= 0                                        0894 03038000
*           THEN                                                   0894 03039000
@RF00884 L     @04,@PC00001+4                                      0894 03040000
         L     @04,FDTPTR+24(,@04)                                 0894 03041000
         LTR   @04,@04                                             0894 03042000
         BZ    @RF00894                                            0894 03043000
*             RSIGNR = ON;                                         0895 03044000
*                                                                  0895 03045000
         OI    RSIGNR(REG6),B'00000001'                            0895 03046000
*         /***********************************************************/ 03047000
*         /*                                                         */ 03048000
*         /*  INITIALIZE GRAB CONTROL BLOCKS.                        */ 03049000
*         /*                                                         */ 03050000
*         /***********************************************************/ 03051000
*                                                                  0896 03052000
*         RSIDX = 1;                                               0896 03053000
*                                                                  0896 03054000
@RF00894 MVC   RSIDX(2,REG6),@CH00219                              0896 03055000
*         /***********************************************************/ 03056000
*         /*                                                         */ 03057000
*         /*    CATALOG GRABS                                        */ 03058000
*         /*                                                         */ 03059000
*         /***********************************************************/ 03060000
*                                                                  0897 03061000
*         RSGRABCU = ADDR(GRABSCA);                                0897 03062000
         L     @04,RSIOTBL(,REG6)                                  0897 03063000
         LA    @04,GRABSCA(,@04)                                   0897 03064000
         ST    @04,RSGRABCU(,REG6)                                 0897 03065000
*         GRABSN = 2;                                              0898 03066000
*                                                                  0898 03067000
         MVI   GRABSN(@04),X'02'                                   0898 03068000
*INITLP2: DO RSIDX1 = 1 TO GRABSN;                                 0899 03069000
*                                                                  0899 03070000
INITLP2  LA    @04,1                                               0899 03071000
         B     @DE00899                                            0899 03072000
@DL00899 DS    0H                                                  0900 03073000
*           RABARRAY(RSIDX1) = ADDR(RABS(RSIDX));                  0900 03074000
         LH    @04,RSIDX1(,REG6)                                   0900 03075000
         SLA   @04,2                                               0900 03076000
         L     @01,RSGRABCU(,REG6)                                 0900 03077000
         LH    @15,RSIDX(,REG6)                                    0900 03078000
         LR    @14,@15                                             0900 03079000
         MH    @14,@CH03734                                        0900 03080000
         L     @03,RSRABWA(,REG6)                                  0900 03081000
         AL    @03,@CF03802                                        0900 03082000
         LA    @00,RABS(@14,@03)                                   0900 03083000
         ST    @00,RABARRAY-4(@04,@01)                             0900 03084000
*           RSIDX = RSIDX + 1;                                     0901 03085000
*                                                                  0901 03086000
         AL    @15,@CF00219                                        0901 03087000
         STH   @15,RSIDX(,REG6)                                    0901 03088000
*         END INITLP2;                                             0902 03089000
         LA    @04,1                                               0902 03090000
         AH    @04,RSIDX1(,REG6)                                   0902 03091000
@DE00899 STH   @04,RSIDX1(,REG6)                                   0902 03092000
         L     @01,RSGRABCU(,REG6)                                 0902 03093000
         SLR   @00,@00                                             0902 03094000
         IC    @00,GRABSN(,@01)                                    0902 03095000
         CR    @04,@00                                             0902 03096000
         BNH   @DL00899                                            0902 03097000
*         GRABRABE = GRABRAB1;         /*EXT/MODIFY BUFFER           */ 03098000
*                                                                  0903 03099000
         L     @04,RSGRABCU(,REG6)                                 0903 03100000
         L     @15,GRABRAB1(,@04)                                  0903 03101000
         ST    @15,GRABRABE(,@04)                                  0903 03102000
*         /***********************************************************/ 03103000
*         /*                                                         */ 03104000
*         /*    CATALOG RECOVERY AREA GRABS                          */ 03105000
*         /*                                                         */ 03106000
*         /***********************************************************/ 03107000
*                                                                  0904 03108000
*         RSGRABCU = ADDR(GRABSCR);                                0904 03109000
         L     @04,RSIOTBL(,REG6)                                  0904 03110000
         LA    @04,GRABSCR(,@04)                                   0904 03111000
         ST    @04,RSGRABCU(,REG6)                                 0904 03112000
*         GRABSN = 2;                                              0905 03113000
*                                                                  0905 03114000
         MVI   GRABSN(@04),X'02'                                   0905 03115000
*INITLP3: DO RSIDX1 = 1 TO GRABSN;                                 0906 03116000
*                                                                  0906 03117000
INITLP3  LA    @04,1                                               0906 03118000
         B     @DE00906                                            0906 03119000
@DL00906 DS    0H                                                  0907 03120000
*           RABARRAY(RSIDX1) = ADDR(RABS(RSIDX));                  0907 03121000
         LH    @04,RSIDX1(,REG6)                                   0907 03122000
         SLA   @04,2                                               0907 03123000
         L     @01,RSGRABCU(,REG6)                                 0907 03124000
         LH    @15,RSIDX(,REG6)                                    0907 03125000
         LR    @14,@15                                             0907 03126000
         MH    @14,@CH03734                                        0907 03127000
         L     @03,RSRABWA(,REG6)                                  0907 03128000
         AL    @03,@CF03802                                        0907 03129000
         LA    @00,RABS(@14,@03)                                   0907 03130000
         ST    @00,RABARRAY-4(@04,@01)                             0907 03131000
*           RSIDX = RSIDX + 1;                                     0908 03132000
*                                                                  0908 03133000
         AL    @15,@CF00219                                        0908 03134000
         STH   @15,RSIDX(,REG6)                                    0908 03135000
*         END INITLP3;                                             0909 03136000
         LA    @04,1                                               0909 03137000
         AH    @04,RSIDX1(,REG6)                                   0909 03138000
@DE00906 STH   @04,RSIDX1(,REG6)                                   0909 03139000
         L     @01,RSGRABCU(,REG6)                                 0909 03140000
         SLR   @00,@00                                             0909 03141000
         IC    @00,GRABSN(,@01)                                    0909 03142000
         CR    @04,@00                                             0909 03143000
         BNH   @DL00906                                            0909 03144000
*         GRABRABE = GRABRAB1;         /*EXTRACT/MODIFY BUFFER       */ 03145000
*                                                                  0910 03146000
         L     @04,RSGRABCU(,REG6)                                 0910 03147000
         L     @15,GRABRAB1(,@04)                                  0910 03148000
         ST    @15,GRABRABE(,@04)                                  0910 03149000
*         /***********************************************************/ 03150000
*         /*                                                         */ 03151000
*         /*    WORKFILE GRABS                                        * 03152000
*         /*                                                         */ 03153000
*         /***********************************************************/ 03154000
*                                                                  0911 03155000
*         RSGRABCU = ADDR(GRABSWF);                                0911 03156000
         L     @04,RSIOTBL(,REG6)                                  0911 03157000
         ST    @04,RSGRABCU(,REG6)                                 0911 03158000
*         GRABSN = 6;                                              0912 03159000
*                                                                  0912 03160000
         MVI   GRABSN(@04),X'06'                                   0912 03161000
*INITLP4: DO RSIDX1 = 1 TO GRABSN;                                 0913 03162000
*                                                                  0913 03163000
INITLP4  LA    @04,1                                               0913 03164000
         B     @DE00913                                            0913 03165000
@DL00913 DS    0H                                                  0914 03166000
*           RABARRAY(RSIDX1) = ADDR(RABS(RSIDX));                  0914 03167000
         LH    @04,RSIDX1(,REG6)                                   0914 03168000
         SLA   @04,2                                               0914 03169000
         L     @01,RSGRABCU(,REG6)                                 0914 03170000
         LH    @15,RSIDX(,REG6)                                    0914 03171000
         LR    @14,@15                                             0914 03172000
         MH    @14,@CH03734                                        0914 03173000
         L     @03,RSRABWA(,REG6)                                  0914 03174000
         AL    @03,@CF03802                                        0914 03175000
         LA    @00,RABS(@14,@03)                                   0914 03176000
         ST    @00,RABARRAY-4(@04,@01)                             0914 03177000
*           RSIDX = RSIDX + 1;                                     0915 03178000
*                                                                  0915 03179000
         AL    @15,@CF00219                                        0915 03180000
         STH   @15,RSIDX(,REG6)                                    0915 03181000
*         END INITLP4;                                             0916 03182000
         LA    @04,1                                               0916 03183000
         AH    @04,RSIDX1(,REG6)                                   0916 03184000
@DE00913 STH   @04,RSIDX1(,REG6)                                   0916 03185000
         L     @01,RSGRABCU(,REG6)                                 0916 03186000
         SLR   @00,@00                                             0916 03187000
         IC    @00,GRABSN(,@01)                                    0916 03188000
         CR    @04,@00                                             0916 03189000
         BNH   @DL00913                                            0916 03190000
*         GRABRABE = RABARRAY(GRABSN); /*EXT/MOD BUFFER              */ 03191000
*                                                                  0917 03192000
         L     @04,RSGRABCU(,REG6)                                 0917 03193000
         SLR   @15,@15                                             0917 03194000
         IC    @15,GRABSN(,@04)                                    0917 03195000
         SLA   @15,2                                               0917 03196000
         L     @15,RABARRAY-4(@15,@04)                             0917 03197000
         ST    @15,GRABRABE(,@04)                                  0917 03198000
*         /***********************************************************/ 03199000
*         /*                                                         */ 03200000
*         /*  INITIALIZE CPL-FPLS FOR UCATLG LOCATE REQUESTS         */ 03201000
*         /*                                                         */ 03202000
*         /***********************************************************/ 03203000
*                                                                  0918 03204000
*         CTGFUNC = CTGLOC;                                        0918 03205000
         L     @04,CTGPLPTR(,REG6)                                 0918 03206000
         NI    CTGFUNC(@04),B'00111111'                            0918 03207000
         OI    CTGFUNC(@04),B'00100000'                            0918 03208000
*         CTGAM0 = ON;                                             0919 03209000
         OI    CTGAM0(@04),B'00000001'                             0919 03210000
*         CTGNAME = OFF;                                           0920 03211000
*         CTGCNAME = ON;                                           0921 03212000
         OI    CTGCNAME(@04),B'00000010'                           0921 03213000
         NI    CTGNAME(@04),B'11111011'                            0921 03214000
*         CTGWKA = ADDR(UCATWA);                                   0922 03215000
         L     @15,RSIOTBL(,REG6)                                  0922 03216000
         LA    @14,UCATWA(,@15)                                    0922 03217000
         ST    @14,CTGWKA(,@04)                                    0922 03218000
*         UCATWTLN = LENGTH(UCATWA);                               0923 03219000
         MVC   UCATWTLN(2,@15),@CH03739                            0923 03220000
*         CTGPSWD = RSMRPAS;                                       0924 03221000
         L     @15,RSMRPAS(,REG6)                                  0924 03222000
         ST    @15,CTGPSWD(,@04)                                   0924 03223000
*         CTGENT = ADDR(RSUCCINO);                                 0925 03224000
*                                                                  0925 03225000
         LA    @15,RSUCCINO(,REG6)                                 0925 03226000
         ST    @15,CTGENT(,@04)                                    0925 03227000
*INITLP5: DO RSIDX = 1 TO DIM(RSFPL);                              0926 03228000
*                                                                  0926 03229000
INITLP5  LA    @04,1                                               0926 03230000
         STH   @04,RSIDX(,REG6)                                    0926 03231000
@DL00926 DS    0H                                                  0927 03232000
*           CTGFLPTR = RSFPL(RSIDX);                               0927 03233000
         LH    @04,RSIDX(,REG6)                                    0927 03234000
         SLA   @04,2                                               0927 03235000
         L     @15,RSFPL-4(@04,REG6)                               0927 03236000
         ST    @15,CTGFLPTR(,REG6)                                 0927 03237000
*           CTGFLDNO = 1;                                          0928 03238000
         MVI   CTGFLDNO(@15),X'01'                                 0928 03239000
*           CTGFIELD(RSIDX) = CTGFLPTR;                            0929 03240000
*                                                                  0929 03241000
         L     @01,CTGPLPTR(,REG6)                                 0929 03242000
         ST    @15,CTGFIELD-4(@04,@01)                             0929 03243000
*         END INITLP5;                                             0930 03244000
*                                                                  0930 03245000
         LA    @04,1                                               0930 03246000
         AH    @04,RSIDX(,REG6)                                    0930 03247000
         STH   @04,RSIDX(,REG6)                                    0930 03248000
         C     @04,@CF00287                                        0930 03249000
         BNH   @DL00926                                            0930 03250000
*         /***********************************************************/ 03251000
*         /*                                                         */ 03252000
*         /*  OPEN THE CATALOG VIA DSOPEN. IF THE CATALOG DDNAME     */ 03253000
*         /*  WAS SUPPLIED IN THE FDT, USE IT TO OPEN THE DATA SET,  */ 03254000
*         /*  OTHERWISE, DYNAMICALLY ALLOCATE THE DATA SET VIA       */ 03255000
*         /*  THE DSNAME.                                            */ 03256000
*         /*                                                         */ 03257000
*         /***********************************************************/ 03258000
*                                                                  0931 03259000
*         IF ADDR(CATDN) ^= 0                                      0931 03260000
*           THEN                                                   0931 03261000
         SLR   @04,@04                                             0931 03262000
         L     @15,@PC00001+4                                      0931 03263000
         C     @04,FDTPTR+8(,@15)                                  0931 03264000
         BE    @RF00931                                            0931 03265000
*             RSCADS = NULLPTR;                                    0932 03266000
*                                                                  0932 03267000
         ST    @04,RSCADS(,REG6)                                   0932 03268000
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSOPEN             */ 03269000
*         CALL IDCRS6DO('O','C','U',RSCADD,RSCADS,RSCAPAS);        0933 03270000
*                                                                  0933 03271000
@RF00931 LA    @04,@CC03581                                        0933 03272000
         ST    @04,@AL00001                                        0933 03273000
         LA    @04,@CC00805                                        0933 03274000
         ST    @04,@AL00001+4                                      0933 03275000
         LA    @04,@CC00817                                        0933 03276000
         ST    @04,@AL00001+8                                      0933 03277000
         LA    @04,RSCADD(,REG6)                                   0933 03278000
         ST    @04,@AL00001+12                                     0933 03279000
         LA    @04,RSCADS(,REG6)                                   0933 03280000
         ST    @04,@AL00001+16                                     0933 03281000
         LA    @04,RSCAPAS(,REG6)                                  0933 03282000
         ST    @04,@AL00001+20                                     0933 03283000
         L     @15,@CV03580                                        0933 03284000
         LA    @01,@AL00001                                        0933 03285000
         BALR  @14,@15                                             0933 03286000
*         RESPECIFY RTNREG RSTD;                                   0934 03287000
*         TESTRC = RTNREG;                                         0935 03288000
         STH   RTNREG,TESTRC(,REG6)                                0935 03289000
*         RESPECIFY RTNREG UNRSTD;                                 0936 03290000
*                                                                  0936 03291000
*         /***********************************************************/ 03292000
*         /*                                                         */ 03293000
*         /*    IF OPEN FAILED, CALL CKERR TO TERMINATE              */ 03294000
*         /*                                                         */ 03295000
*         /***********************************************************/ 03296000
*                                                                  0937 03297000
*         IF TESTRC ^= 0                                           0937 03298000
*           THEN                                                   0937 03299000
*                                                                  0937 03300000
*                                                                  0937 03301000
         LH    @04,TESTRC(,REG6)                                   0937 03302000
         LTR   @04,@04                                             0937 03303000
         BZ    @RF00937                                            0937 03304000
*             DO;                                                  0938 03305000
*             /*CALL CKERR*/                                       0939 03306000
*               RSCKERR = RSCKERR && RSCKERR;                      0939 03307000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0939 03308000
*               RSCKERN = RSE001;                                  0940 03309000
         MVC   RSCKERN(2,REG6),@CH00219                            0940 03310000
*               RSCKTERM = 'TERM';                                 0941 03311000
*                                                                  0941 03312000
         MVC   RSCKTERM(4,REG6),@CC03543                           0941 03313000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 03314000
*             CALL CKERR;                                          0942 03315000
         L     @15,@CV03544                                        0942 03316000
         BALR  @14,@15                                             0942 03317000
*             END;                                                 0943 03318000
*                                                                  0943 03319000
*         /***********************************************************/ 03320000
*         /*                                                         */ 03321000
*         /*  GET CATALOG DATA SET NAME VIA UIOINFO.                 */ 03322000
*         /*                                                         */ 03323000
*         /***********************************************************/ 03324000
*                                                                  0944 03325000
*         IOINFOPT = ''B;                                          0944 03326000
@RF00937 LA    @04,700                                             0944 03327000
         ALR   @04,REG6                                            0944 03328000
         MVI   IOINFOPT(@04),X'00'                                 0944 03329000
*         IOINFDSN = ON;                                           0945 03330000
         OI    IOINFDSN(@04),B'00100000'                           0945 03331000
*         RSUIRPT = 0;                                             0946 03332000
*                                                                  0946 03333000
         SLR   @15,@15                                             0946 03334000
         ST    @15,RSUIRPT(,REG6)                                  0946 03335000
*         CALL IDCIOSI0 (GDTTBL,IOINFOPT,RSUIRPT,RSCATDDN,POOL3);  0947 03336000
*                                                                  0947 03337000
         ST    REG5,@AL00001                                       0947 03338000
         ST    @04,@AL00001+4                                      0947 03339000
         LA    @04,RSUIRPT(,REG6)                                  0947 03340000
         ST    @04,@AL00001+8                                      0947 03341000
         LA    @04,RSCATDDN(,REG6)                                 0947 03342000
         ST    @04,@AL00001+12                                     0947 03343000
         LA    @04,@CC00904                                        0947 03344000
         ST    @04,@AL00001+16                                     0947 03345000
         MVI   @AL00001+16,X'80'                                   0947 03346000
         L     @15,GDTIFO(,REG5)                                   0947 03347000
         LA    @01,@AL00001                                        0947 03348000
         BALR  @14,@15                                             0947 03349000
*         RESPECIFY RTNREG RSTD;                                   0948 03350000
*         TESTRC = RTNREG;                                         0949 03351000
         STH   RTNREG,TESTRC(,REG6)                                0949 03352000
*         RESPECIFY RTNREG UNRSTD;                                 0950 03353000
*                                                                  0950 03354000
*         /***********************************************************/ 03355000
*         /*                                                         */ 03356000
*         /*    IF UIOINFO FAILED, CALL CKERR TO TERMINATE.          */ 03357000
*         /*                                                         */ 03358000
*         /***********************************************************/ 03359000
*                                                                  0951 03360000
*         IF TESTRC ^= 0                                           0951 03361000
*           THEN                                                   0951 03362000
*                                                                  0951 03363000
*                                                                  0951 03364000
         LH    @04,TESTRC(,REG6)                                   0951 03365000
         LTR   @04,@04                                             0951 03366000
         BZ    @RF00951                                            0951 03367000
*             DO;                                                  0952 03368000
*             /*CALL CKERR*/                                       0953 03369000
*               RSCKERR = RSCKERR && RSCKERR;                      0953 03370000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0953 03371000
*               RSCKERN = RSE002;                                  0954 03372000
         MVC   RSCKERN(2,REG6),@CH00157                            0954 03373000
*               RSCKTERM = 'TERM';                                 0955 03374000
*                                                                  0955 03375000
         MVC   RSCKTERM(4,REG6),@CC03543                           0955 03376000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 03377000
*             CALL CKERR;                                          0956 03378000
         L     @15,@CV03544                                        0956 03379000
         BALR  @14,@15                                             0956 03380000
*             END;                                                 0957 03381000
*                                                                  0957 03382000
*                                                                  0957 03383000
*         /***********************************************************/ 03384000
*         /*                                                         */ 03385000
*         /*    EXTRACT CATALOG DATA SET NAME RETURNED BY            */ 03386000
*         /*    UIOINFO AND SAVE IN MAIN WORKAREA.                   */ 03387000
*         /*                                                         */ 03388000
*         /***********************************************************/ 03389000
*                                                                  0958 03390000
*         RSUIRPT = RSUIRPT + UIOHDR;                              0958 03391000
@RF00951 LA    @04,4                                               0958 03392000
         AL    @04,RSUIRPT(,REG6)                                  0958 03393000
         ST    @04,RSUIRPT(,REG6)                                  0958 03394000
*         RSCATDSN = UIODNM;                                       0959 03395000
         MVC   RSCATDSN(44,REG6),UIODNM(@04)                       0959 03396000
*         RSCADS = ADDR(RSCATDSN);                                 0960 03397000
*                                                                  0960 03398000
         LA    @04,RSCATDSN(,REG6)                                 0960 03399000
         ST    @04,RSCADS(,REG6)                                   0960 03400000
*         /***********************************************************/ 03401000
*         /*                                                         */ 03402000
*         /*    FREE UIOINFO STORAGE.                                */ 03403000
*         /*                                                         */ 03404000
*         /***********************************************************/ 03405000
*                                                                  0961 03406000
*         CALL IDCSAFP0 (GDTTBL,POOL3);                            0961 03407000
*                                                                  0961 03408000
         ST    REG5,@AL00001                                       0961 03409000
         LA    @04,@CC00904                                        0961 03410000
         ST    @04,@AL00001+4                                      0961 03411000
         MVI   @AL00001+4,X'80'                                    0961 03412000
         L     @15,GDTFPL(,REG5)                                   0961 03413000
         LA    @01,@AL00001                                        0961 03414000
         BALR  @14,@15                                             0961 03415000
*         /***********************************************************/ 03416000
*         /*                                                         */ 03417000
*         /*  OBTAIN REAL CATALOG DATA SET NAME VIA UCATLG LOCATE.   */ 03418000
*         /*                                                         */ 03419000
*         /***********************************************************/ 03420000
*                                                                  0962 03421000
*         /***********************************************************/ 03422000
*         /*                                                         */ 03423000
*         /*    COMPLETE CPL-FPL FOR UCATLG CALL.                    */ 03424000
*         /*                                                         */ 03425000
*         /***********************************************************/ 03426000
*                                                                  0962 03427000
*         CTGCAT = RSCADS;                                         0962 03428000
         L     @04,CTGPLPTR(,REG6)                                 0962 03429000
         L     @15,RSCADS(,REG6)                                   0962 03430000
         ST    @15,CTGCAT(,@04)                                    0962 03431000
*         RSUCCINO = CLUSCI;                                       0963 03432000
         MVC   RSUCCINO(3,REG6),@CF00157+1                         0963 03433000
*         CTGTYPE = CTGTCL;                                        0964 03434000
         MVI   CTGTYPE(@04),C'C'                                   0964 03435000
*         CTGNOFLD = 1;                                            0965 03436000
*                                                                  0965 03437000
         MVI   CTGNOFLD(@04),X'01'                                 0965 03438000
*         CTGFLPTR = CTGFIELD(1);                                  0966 03439000
         L     @04,CTGFIELD(,@04)                                  0966 03440000
         ST    @04,CTGFLPTR(,REG6)                                 0966 03441000
*         CTGFLDNM = ADDR(ENTNAME);                                0967 03442000
*                                                                  0967 03443000
         LA    @15,@CC01088                                        0967 03444000
         ST    @15,CTGFLDNM(,@04)                                  0967 03445000
*         /***********************************************************/ 03446000
*         /*                                                         */ 03447000
*         /*    ISSUE LOCATE REQUEST VIA UCATLG.                     */ 03448000
*         /*                                                         */ 03449000
*         /***********************************************************/ 03450000
*                                                                  0968 03451000
*         CALL IDCSACA0 (GDTTBL,CTGPLPTR);                         0968 03452000
*                                                                  0968 03453000
         ST    REG5,@AL00001                                       0968 03454000
         LA    @04,CTGPLPTR(,REG6)                                 0968 03455000
         ST    @04,@AL00001+4                                      0968 03456000
         L     @15,GDTCAT(,REG5)                                   0968 03457000
         LA    @01,@AL00001                                        0968 03458000
         BALR  @14,@15                                             0968 03459000
*         RESPECIFY RTNREG RSTD;                                   0969 03460000
*         TESTRC = RTNREG;                                         0970 03461000
         STH   RTNREG,TESTRC(,REG6)                                0970 03462000
*         RESPECIFY RTNREG UNRSTD;                                 0971 03463000
*                                                                  0971 03464000
*         /***********************************************************/ 03465000
*         /*                                                         */ 03466000
*         /*    FIRST UCATLG SUCCESSFUL.                             */ 03467000
*         /*                                                         */ 03468000
*         /***********************************************************/ 03469000
*                                                                  0972 03470000
*         IF TESTRC = 0                                            0972 03471000
*           THEN                                                   0972 03472000
*                                                                  0972 03473000
         LH    @04,TESTRC(,REG6)                                   0972 03474000
         LTR   @04,@04                                             0972 03475000
         BNZ   @RF00972                                            0972 03476000
*         /***********************************************************/ 03477000
*         /*                                                         */ 03478000
*         /*    SAVE CATALOG DSNAME IN MAIN WORKAREA.                */ 03479000
*         /*                                                         */ 03480000
*         /***********************************************************/ 03481000
*                                                                  0973 03482000
*             RSCATDSN = INITDSN(1:CTGFLNG(1));                    0973 03483000
*                                                                  0973 03484000
         MVI   RSCATDSN+1(REG6),C' '                               0973 03485000
         MVC   RSCATDSN+2(42,REG6),RSCATDSN+1(REG6)                0973 03486000
         L     @04,CTGFLPTR(,REG6)                                 0973 03487000
         L     @15,CTGFLNG(,@04)                                   0973 03488000
         BCTR  @15,0                                               0973 03489000
         L     @04,CTGFLPT(,@04)                                   0973 03490000
         EX    @15,@SM03804                                        0973 03491000
*         /***********************************************************/ 03492000
*         /*                                                         */ 03493000
*         /*  GET CATALOG VOLSER AND TIMESTAMP VIA UCATLG LOCATE.    */ 03494000
*         /*                                                         */ 03495000
*         /***********************************************************/ 03496000
*         IF TESTRC = 0                                            0974 03497000
*           THEN                                                   0974 03498000
@RF00972 LH    @04,TESTRC(,REG6)                                   0974 03499000
         LTR   @04,@04                                             0974 03500000
         BNZ   @RF00974                                            0974 03501000
*INUC2:       DO;                                                  0975 03502000
*                                                                  0975 03503000
INUC2    DS    0H                                                  0976 03504000
*         /***********************************************************/ 03505000
*         /*                                                         */ 03506000
*         /*    COMPLETE CPL-FPLS FOR UCATLG CALL.                   */ 03507000
*         /*                                                         */ 03508000
*         /***********************************************************/ 03509000
*                                                                  0976 03510000
*               RSUCCINO = VOLCI;                                  0976 03511000
         MVC   RSUCCINO(3,REG6),@CF00040+1                         0976 03512000
*               CTGTYPE = CTGTVOL;                                 0977 03513000
         L     @04,CTGPLPTR(,REG6)                                 0977 03514000
         MVI   CTGTYPE(@04),C'V'                                   0977 03515000
*               CTGNOFLD = 2;                                      0978 03516000
*                                                                  0978 03517000
         MVI   CTGNOFLD(@04),X'02'                                 0978 03518000
*               CTGFLPTR = CTGFIELD(1);                            0979 03519000
         L     @15,CTGFIELD(,@04)                                  0979 03520000
         ST    @15,CTGFLPTR(,REG6)                                 0979 03521000
*               CTGFLDNM = ADDR(ENTNAME);                          0980 03522000
*                                                                  0980 03523000
         LA    @14,@CC01088                                        0980 03524000
         ST    @14,CTGFLDNM(,@15)                                  0980 03525000
*               CTGFLPTR = CTGFIELD(2);                            0981 03526000
         L     @04,CTGFIELD+4(,@04)                                0981 03527000
         ST    @04,CTGFLPTR(,REG6)                                 0981 03528000
*               CTGFLDNM = ADDR(VOLTSTMP);                         0982 03529000
*                                                                  0982 03530000
         LA    @15,@CC01092                                        0982 03531000
         ST    @15,CTGFLDNM(,@04)                                  0982 03532000
*         /***********************************************************/ 03533000
*         /*                                                         */ 03534000
*         /*    ISSUE LOCATE REQUEST VIA UCATLG.                     */ 03535000
*         /*                                                         */ 03536000
*         /***********************************************************/ 03537000
*                                                                  0983 03538000
*               CALL IDCSACA0 (GDTTBL,CTGPLPTR);                   0983 03539000
*                                                                  0983 03540000
         ST    REG5,@AL00001                                       0983 03541000
         LA    @04,CTGPLPTR(,REG6)                                 0983 03542000
         ST    @04,@AL00001+4                                      0983 03543000
         L     @15,GDTCAT(,REG5)                                   0983 03544000
         LA    @01,@AL00001                                        0983 03545000
         BALR  @14,@15                                             0983 03546000
*               RESPECIFY RTNREG RSTD;                             0984 03547000
*               TESTRC = RTNREG;                                   0985 03548000
         STH   RTNREG,TESTRC(,REG6)                                0985 03549000
*               RESPECIFY RTNREG UNRSTD;                           0986 03550000
*                                                                  0986 03551000
*         /***********************************************************/ 03552000
*         /*                                                         */ 03553000
*         /*    SECOND UCATLG SUCCESSFUL.                            */ 03554000
*         /*                                                         */ 03555000
*         /***********************************************************/ 03556000
*                                                                  0987 03557000
*               IF TESTRC = 0                                      0987 03558000
*                 THEN                                             0987 03559000
         LH    @04,TESTRC(,REG6)                                   0987 03560000
         LTR   @04,@04                                             0987 03561000
         BNZ   @RF00987                                            0987 03562000
*                   DO;                                            0988 03563000
*                     CTGFLPTR = CTGFIELD(1);                      0989 03564000
*                                                                  0989 03565000
         L     @04,CTGPLPTR(,REG6)                                 0989 03566000
         L     @15,CTGFIELD(,@04)                                  0989 03567000
         ST    @15,CTGFLPTR(,REG6)                                 0989 03568000
*         /***********************************************************/ 03569000
*         /*                                                         */ 03570000
*         /*    SAVE CATALOG VOLSER IN LOCAL WORKAREA.               */ 03571000
*         /*                                                         */ 03572000
*         /***********************************************************/ 03573000
*                                                                  0990 03574000
*                     RSINVLSR = INITVLSR(1:CTGFLNG(1));           0990 03575000
*                                                                  0990 03576000
         MVI   RSINVLSR+1(REG6),C' '                               0990 03577000
         MVC   RSINVLSR+2(4,REG6),RSINVLSR+1(REG6)                 0990 03578000
         L     @14,CTGFLNG(,@15)                                   0990 03579000
         BCTR  @14,0                                               0990 03580000
         L     @01,CTGFLPT(,@15)                                   0990 03581000
         EX    @14,@SM03806                                        0990 03582000
*                     CTGFLPTR = CTGFIELD(2);                      0991 03583000
*                                                                  0991 03584000
         L     @04,CTGFIELD+4(,@04)                                0991 03585000
         ST    @04,CTGFLPTR(,REG6)                                 0991 03586000
*         /***********************************************************/ 03587000
*         /*                                                         */ 03588000
*         /*    SAVE TIMESTAMP IN LOCAL WORKAREA.                    */ 03589000
*         /*                                                         */ 03590000
*         /***********************************************************/ 03591000
*                                                                  0992 03592000
*                     RSINTS = INITTS(1:CTGFLNG(1));               0992 03593000
*                                                                  0992 03594000
         MVI   RSINTS+1(REG6),C' '                                 0992 03595000
         MVC   RSINTS+2(6,REG6),RSINTS+1(REG6)                     0992 03596000
         L     @15,CTGFLNG(,@04)                                   0992 03597000
         BCTR  @15,0                                               0992 03598000
         L     @04,CTGFLPT(,@04)                                   0992 03599000
         EX    @15,@SM03808                                        0992 03600000
*                 END;                                             0993 03601000
*                                                                  0993 03602000
*             END INUC2;                                           0994 03603000
*                                                                  0994 03604000
@RF00987 DS    0H                                                  0995 03605000
*         /***********************************************************/ 03606000
*         /*                                                         */ 03607000
*         /*     IF EITHER UCATLG FAILED WITH A RETURN CODE          */ 03608000
*         /*     OF 4, THE CATALOG IS INACCESSIBLE AND, HENCE, NOT A */ 03609000
*         /*     CATALOG. ISSUE MESSAGE STATING THAT THE CATALOG     */ 03610000
*         /*     TO BE RESET IS NOT A RECOVERABLE CATALOG.           */ 03611000
*         /*                                                         */ 03612000
*         /***********************************************************/ 03613000
*                                                                  0995 03614000
*         IF TESTRC = RCCAT                                        0995 03615000
*           THEN                                                   0995 03616000
*                                                                  0995 03617000
@RF00974 CLC   TESTRC(2,REG6),@CH00046                             0995 03618000
         BNE   @RF00995                                            0995 03619000
*             DO;                                                  0996 03620000
*             /*CALL CKERR*/                                       0997 03621000
*               RSCKERR = RSCKERR && RSCKERR;                      0997 03622000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0997 03623000
*               RSCKERN = RSE003;                                  0998 03624000
         MVC   RSCKERN(2,REG6),@CH00166                            0998 03625000
*               RSCKTERM = 'TERM';                                 0999 03626000
*                                                                  0999 03627000
         MVC   RSCKTERM(4,REG6),@CC03543                           0999 03628000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 03629000
*             CALL CKERR;                                          1000 03630000
         L     @15,@CV03544                                        1000 03631000
         BALR  @14,@15                                             1000 03632000
*             END;                                                 1001 03633000
*                                                                  1001 03634000
*         /***********************************************************/ 03635000
*         /*                                                         */ 03636000
*         /*    IF EITHER UCATLG FAILED, CALL CKERR TO TERMINATE.    */ 03637000
*         /*                                                         */ 03638000
*         /***********************************************************/ 03639000
*                                                                  1002 03640000
*         IF TESTRC ^= 0                                           1002 03641000
*           THEN                                                   1002 03642000
@RF00995 LH    @04,TESTRC(,REG6)                                   1002 03643000
         LTR   @04,@04                                             1002 03644000
         BZ    @RF01002                                            1002 03645000
*             DO;                                                  1003 03646000
*               RSCATRC = TESTRC;                                  1004 03647000
*                                                                  1004 03648000
*                                                                  1004 03649000
         STH   @04,RSCATRC(,REG6)                                  1004 03650000
*               DO;                                                1005 03651000
*               /*CALL CKERR*/                                     1006 03652000
*                 RSCKERR = RSCKERR && RSCKERR;                    1006 03653000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1006 03654000
*                 RSCKERN = RSE035;                                1007 03655000
         MVC   RSCKERN(2,REG6),@CH00853                            1007 03656000
*                 RSCKTERM = 'RETURN';                             1008 03657000
*                                                                  1008 03658000
         MVC   RSCKTERM(4,REG6),@CC03584                           1008 03659000
*               /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR        */ 03660000
*               CALL CKERR;                                        1009 03661000
         L     @15,@CV03544                                        1009 03662000
         BALR  @14,@15                                             1009 03663000
*               END;                                               1010 03664000
*                                                                  1010 03665000
*                                                                  1010 03666000
*               DO;                                                1011 03667000
*               /*CALL CKERR*/                                     1012 03668000
*                 RSCKERR = RSCKERR && RSCKERR;                    1012 03669000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1012 03670000
*                 RSCKERN = RSE017;                                1013 03671000
         MVC   RSCKERN(2,REG6),@CH00930                            1013 03672000
*                 RSCKTERM = 'TERM';                               1014 03673000
*                                                                  1014 03674000
         MVC   RSCKTERM(4,REG6),@CC03543                           1014 03675000
*               /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR        */ 03676000
*               CALL CKERR;                                        1015 03677000
         L     @15,@CV03544                                        1015 03678000
         BALR  @14,@15                                             1015 03679000
*               END;                                               1016 03680000
*                                                                  1016 03681000
*             END;                                                 1017 03682000
*                                                                  1017 03683000
*         /***********************************************************/ 03684000
*         /*                                                         */ 03685000
*         /*    BOTH UCATLG CALLS WERE SUCCESSFUL. CALL CKERR TO     */ 03686000
*         /*    PRINT INFORMATIONAL MESSAGE.                         */ 03687000
*         /*                                                         */ 03688000
*         /***********************************************************/ 03689000
*                                                                  1018 03690000
*                                                                  1018 03691000
*         DO;                                                      1018 03692000
@RF01002 DS    0H                                                  1019 03693000
*         /*CALL CKERR*/                                           1019 03694000
*           RSCKERR = RSCKERR && RSCKERR;                          1019 03695000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1019 03696000
*           RSCKERN = RSE009;                                      1020 03697000
         MVC   RSCKERN(2,REG6),@CH00040                            1020 03698000
*           RSCKTERM = 'RETU';                                     1021 03699000
         MVC   RSCKTERM(4,REG6),@CC03585                           1021 03700000
*           RSCKMVAR(1) = ADDR(RSCATDSN);                          1022 03701000
         LA    @04,RSCATDSN(,REG6)                                 1022 03702000
         ST    @04,RSCKMVAR(,REG6)                                 1022 03703000
*           RSCKMVAR(2) = ADDR(RSINVLSR);                          1023 03704000
         LA    @04,RSINVLSR(,REG6)                                 1023 03705000
         ST    @04,RSCKMVAR+4(,REG6)                               1023 03706000
*           RSCKMVAR(3) = ADDR(RSINTS);                            1024 03707000
*                                                                  1024 03708000
         LA    @04,RSINTS(,REG6)                                   1024 03709000
         ST    @04,RSCKMVAR+8(,REG6)                               1024 03710000
*         /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR              */ 03711000
*         CALL CKERR;                                              1025 03712000
         L     @15,@CV03544                                        1025 03713000
         BALR  @14,@15                                             1025 03714000
*         END;                                                     1026 03715000
*                                                                  1026 03716000
*         /***********************************************************/ 03717000
*         /*                                                         */ 03718000
*         /*  GET CATALOG ACB AND DATA ATTRIBUTES VIA UCATLG LOCATE  */ 03719000
*         /*                                                         */ 03720000
*         /***********************************************************/ 03721000
*                                                                  1027 03722000
*         /***********************************************************/ 03723000
*         /*                                                         */ 03724000
*         /*    COMPLETE CPL-FPLS FOR UCATLG REQUEST.                */ 03725000
*         /*                                                         */ 03726000
*         /***********************************************************/ 03727000
*                                                                  1027 03728000
*         RSUCCINO = DATACI;                                       1027 03729000
         SLR   @04,@04                                             1027 03730000
         STCM  @04,7,RSUCCINO(REG6)                                1027 03731000
*         CTGTYPE = CTGTDATA;                                      1028 03732000
         L     @04,CTGPLPTR(,REG6)                                 1028 03733000
         MVI   CTGTYPE(@04),C'D'                                   1028 03734000
*         CTGNOFLD = 2;                                            1029 03735000
*                                                                  1029 03736000
         MVI   CTGNOFLD(@04),X'02'                                 1029 03737000
*         CTGFLPTR = CTGFIELD(1);                                  1030 03738000
         L     @15,CTGFIELD(,@04)                                  1030 03739000
         ST    @15,CTGFLPTR(,REG6)                                 1030 03740000
*         CTGFLDNM = ADDR(CATACB);                                 1031 03741000
*                                                                  1031 03742000
         LA    @14,@CC01094                                        1031 03743000
         ST    @14,CTGFLDNM(,@15)                                  1031 03744000
*         CTGFLPTR = CTGFIELD(2);                                  1032 03745000
         L     @04,CTGFIELD+4(,@04)                                1032 03746000
         ST    @04,CTGFLPTR(,REG6)                                 1032 03747000
*         CTGFLDNM = ADDR(ATTR1);                                  1033 03748000
*                                                                  1033 03749000
         LA    @15,@CC01096                                        1033 03750000
         ST    @15,CTGFLDNM(,@04)                                  1033 03751000
*         /***********************************************************/ 03752000
*         /*                                                         */ 03753000
*         /*    ISSUE UCATLG LOCATE REQUEST.                         */ 03754000
*         /*                                                         */ 03755000
*         /***********************************************************/ 03756000
*                                                                  1034 03757000
*         CALL IDCSACA0 (GDTTBL,CTGPLPTR);                         1034 03758000
*                                                                  1034 03759000
         ST    REG5,@AL00001                                       1034 03760000
         LA    @04,CTGPLPTR(,REG6)                                 1034 03761000
         ST    @04,@AL00001+4                                      1034 03762000
         L     @15,GDTCAT(,REG5)                                   1034 03763000
         LA    @01,@AL00001                                        1034 03764000
         BALR  @14,@15                                             1034 03765000
*         RESPECIFY RTNREG RSTD;                                   1035 03766000
*         TESTRC = RTNREG;                                         1036 03767000
         STH   RTNREG,TESTRC(,REG6)                                1036 03768000
*         RESPECIFY RTNREG UNRSTD;                                 1037 03769000
*                                                                  1037 03770000
*         /***********************************************************/ 03771000
*         /*                                                         */ 03772000
*         /*    IF UCATLG FAILED, CALL CKERR TO TERMINATE.           */ 03773000
*         /*                                                         */ 03774000
*         /***********************************************************/ 03775000
*                                                                  1038 03776000
*         IF TESTRC ^= 0                                           1038 03777000
*           THEN                                                   1038 03778000
*                                                                  1038 03779000
*                                                                  1038 03780000
         LH    @04,TESTRC(,REG6)                                   1038 03781000
         LTR   @04,@04                                             1038 03782000
         BZ    @RF01038                                            1038 03783000
*             DO;                                                  1039 03784000
*             /*CALL CKERR*/                                       1040 03785000
*               RSCKERR = RSCKERR && RSCKERR;                      1040 03786000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1040 03787000
*               RSCKERN = RSE017;                                  1041 03788000
         MVC   RSCKERN(2,REG6),@CH00930                            1041 03789000
*               RSCKTERM = 'TERM';                                 1042 03790000
*                                                                  1042 03791000
         MVC   RSCKTERM(4,REG6),@CC03543                           1042 03792000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 03793000
*             CALL CKERR;                                          1043 03794000
         L     @15,@CV03544                                        1043 03795000
         BALR  @14,@15                                             1043 03796000
*             END;                                                 1044 03797000
*                                                                  1044 03798000
*         /***********************************************************/ 03799000
*         /*                                                         */ 03800000
*         /*  UCATLG SUCCESSFUL.                                     */ 03801000
*         /*                                                         */ 03802000
*         /***********************************************************/ 03803000
*                                                                  1045 03804000
*         CTGFLPTR = CTGFIELD(1);                                  1045 03805000
*                                                                  1045 03806000
@RF01038 L     @04,CTGPLPTR(,REG6)                                 1045 03807000
         L     @15,CTGFIELD(,@04)                                  1045 03808000
         ST    @15,CTGFLPTR(,REG6)                                 1045 03809000
*         /***********************************************************/ 03810000
*         /*                                                         */ 03811000
*         /*    SAVE CATALOG ACB IN MAIN WORKAREA.                   */ 03812000
*         /*                                                         */ 03813000
*         /***********************************************************/ 03814000
*                                                                  1046 03815000
*         RSCATACB = INITACB;                                      1046 03816000
*                                                                  1046 03817000
         L     @01,CTGFLPT(,@15)                                   1046 03818000
         L     @15,INITACB(,@01)                                   1046 03819000
         ST    @15,RSCATACB(,REG6)                                 1046 03820000
*         CTGFLPTR = CTGFIELD(2);                                  1047 03821000
*                                                                  1047 03822000
         L     @04,CTGFIELD+4(,@04)                                1047 03823000
         ST    @04,CTGFLPTR(,REG6)                                 1047 03824000
*         /***********************************************************/ 03825000
*         /*                                                         */ 03826000
*         /*    SAVE DATA SET ATTRIBUTES IN LOCAL WORKAREA.          */ 03827000
*         /*                                                         */ 03828000
*         /***********************************************************/ 03829000
*                                                                  1048 03830000
*         RSINATR1 = INITATR1;                                     1048 03831000
*                                                                  1048 03832000
         L     @04,CTGFLPT(,@04)                                   1048 03833000
         MVC   RSINATR1(1,REG6),INITATR1(@04)                      1048 03834000
*         /***********************************************************/ 03835000
*         /*                                                         */ 03836000
*         /*  IF CATALOG IS NOT RECOVERABLE, CALL CKERR TO           */ 03837000
*         /*  TERMINATE.                                             */ 03838000
*         /*                                                         */ 03839000
*         /***********************************************************/ 03840000
*                                                                  1049 03841000
*         IF RSINRCV = OFF                                         1049 03842000
*           THEN                                                   1049 03843000
*                                                                  1049 03844000
*                                                                  1049 03845000
         TM    RSINRCV(REG6),B'00001000'                           1049 03846000
         BNZ   @RF01049                                            1049 03847000
*             DO;                                                  1050 03848000
*             /*CALL CKERR*/                                       1051 03849000
*               RSCKERR = RSCKERR && RSCKERR;                      1051 03850000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1051 03851000
*               RSCKERN = RSE003;                                  1052 03852000
         MVC   RSCKERN(2,REG6),@CH00166                            1052 03853000
*               RSCKTERM = 'TERM';                                 1053 03854000
*                                                                  1053 03855000
         MVC   RSCKTERM(4,REG6),@CC03543                           1053 03856000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 03857000
*             CALL CKERR;                                          1054 03858000
         L     @15,@CV03544                                        1054 03859000
         BALR  @14,@15                                             1054 03860000
*             END;                                                 1055 03861000
*                                                                  1055 03862000
*         /***********************************************************/ 03863000
*         /*                                                         */ 03864000
*         /*  IF CATALOG IS THE SYSTEM MASTER CATALOG, CALL CKERR    */ 03865000
*         /*  TO TERMINATE.                                          */ 03866000
*         /*                                                         */ 03867000
*         /***********************************************************/ 03868000
*                                                                  1056 03869000
*         CBSPTR = CVTCBSP;                                        1056 03870000
*                                                                  1056 03871000
@RF01049 L     @04,CVTPTR                                          1056 03872000
         L     @04,CVTCBSP(,@04)                                   1056 03873000
         ST    @04,CBSPTR(,REG6)                                   1056 03874000
*         IF CBSACB = RSCATACB                                     1057 03875000
*           THEN                                                   1057 03876000
*                                                                  1057 03877000
*                                                                  1057 03878000
         CLC   CBSACB(4,@04),RSCATACB(REG6)                        1057 03879000
         BNE   @RF01057                                            1057 03880000
*             DO;                                                  1058 03881000
*             /*CALL CKERR*/                                       1059 03882000
*               RSCKERR = RSCKERR && RSCKERR;                      1059 03883000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1059 03884000
*               RSCKERN = RSE004;                                  1060 03885000
         MVC   RSCKERN(2,REG6),@CH00046                            1060 03886000
*               RSCKTERM = 'TERM';                                 1061 03887000
*                                                                  1061 03888000
         MVC   RSCKTERM(4,REG6),@CC03543                           1061 03889000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 03890000
*             CALL CKERR;                                          1062 03891000
         L     @15,@CV03544                                        1062 03892000
         BALR  @14,@15                                             1062 03893000
*             END;                                                 1063 03894000
*                                                                  1063 03895000
*         /***********************************************************/ 03896000
*         /*                                                         */ 03897000
*         /*  ENSURE EXCLUSIVE USE OF THE CATALOG                    */ 03898000
*         /*                                                         */ 03899000
*         /***********************************************************/ 03900000
*                                                                  1064 03901000
*                                                                  1064 03902000
*         /***********************************************************/ 03903000
*         /*                                                         */ 03904000
*         /*    OBTAIN CATALOG UCB ADDRESS VIA USYSINFO              */ 03905000
*         /*                                                         */ 03906000
*         /***********************************************************/ 03907000
*                                                                  1064 03908000
*         RSINUAP = ADDR(UCBAREA);                                 1064 03909000
*                                                                  1064 03910000
@RF01057 L     @04,RSIOTBL(,REG6)                                  1064 03911000
         LA    @04,UCBAREA(,@04)                                   1064 03912000
         ST    @04,RSINUAP(,REG6)                                  1064 03913000
*         CALL IDCSASI0 (GDTTBL,UNIT,RSINUAP,RSCATDDN);            1065 03914000
*                                                                  1065 03915000
         ST    REG5,@AL00001                                       1065 03916000
         LA    @04,UNIT                                            1065 03917000
         ST    @04,@AL00001+4                                      1065 03918000
         LA    @04,RSINUAP(,REG6)                                  1065 03919000
         ST    @04,@AL00001+8                                      1065 03920000
         LA    @04,RSCATDDN(,REG6)                                 1065 03921000
         ST    @04,@AL00001+12                                     1065 03922000
         MVI   @AL00001+12,X'80'                                   1065 03923000
         L     @15,GDTSFO(,REG5)                                   1065 03924000
         LA    @01,@AL00001                                        1065 03925000
         BALR  @14,@15                                             1065 03926000
*         RESPECIFY RTNREG RSTD;                                   1066 03927000
*         TESTRC = RTNREG;                                         1067 03928000
         STH   RTNREG,TESTRC(,REG6)                                1067 03929000
*         RESPECIFY RTNREG UNRSTD;                                 1068 03930000
*                                                                  1068 03931000
*         /***********************************************************/ 03932000
*         /*                                                         */ 03933000
*         /*    IF USYSINFO FAILED, CALL CKERR TO TERMINATE.         */ 03934000
*         /*                                                         */ 03935000
*         /***********************************************************/ 03936000
*                                                                  1069 03937000
*         IF TESTRC ^= 0                                           1069 03938000
*           THEN                                                   1069 03939000
*                                                                  1069 03940000
*                                                                  1069 03941000
         LH    @04,TESTRC(,REG6)                                   1069 03942000
         LTR   @04,@04                                             1069 03943000
         BZ    @RF01069                                            1069 03944000
*             DO;                                                  1070 03945000
*             /*CALL CKERR*/                                       1071 03946000
*               RSCKERR = RSCKERR && RSCKERR;                      1071 03947000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1071 03948000
*               RSCKERN = RSE006;                                  1072 03949000
         MVC   RSCKERN(2,REG6),@CH00160                            1072 03950000
*               RSCKTERM = 'TERM';                                 1073 03951000
*                                                                  1073 03952000
         MVC   RSCKTERM(4,REG6),@CC03543                           1073 03953000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 03954000
*             CALL CKERR;                                          1074 03955000
         L     @15,@CV03544                                        1074 03956000
         BALR  @14,@15                                             1074 03957000
*             END;                                                 1075 03958000
*                                                                  1075 03959000
*         /***********************************************************/ 03960000
*         /*                                                         */ 03961000
*         /*    SAVE CATALOG UCB ADDRESS RETURNED BY USYSINFO        */ 03962000
*         /*    IN MAIN WORKAREA                                     */ 03963000
*         /*                                                         */ 03964000
*         /***********************************************************/ 03965000
*                                                                  1076 03966000
*         RSCATUCB = RSINUAP -> UNITUCB;                           1076 03967000
*                                                                  1076 03968000
@RF01069 L     @04,RSINUAP(,REG6)                                  1076 03969000
         L     @04,UNITUCB(,@04)                                   1076 03970000
         ST    @04,RSCATUCB(,REG6)                                 1076 03971000
*         /***********************************************************/ 03972000
*         /*                                                         */ 03973000
*         /*    RESERVE CATALOG VIA URESERVE.                        */ 03974000
*         /*                                                         */ 03975000
*         /***********************************************************/ 03976000
*                                                                  1077 03977000
*         RSCAMAJN = SYSTEM;                                       1077 03978000
         L     @04,RSIOTBL(,REG6)                                  1077 03979000
         MVC   RSCAMAJN(8,@04),@CC00781                            1077 03980000
*         RSCAMIND = RSCATDSN;                                     1078 03981000
         MVC   RSCAMIND(44,@04),RSCATDSN(REG6)                     1078 03982000
*         IF RSCAMIND (21) = ' '                                   1079 03983000
*           THEN                                                   1079 03984000
         CLI   RSCAMIND+20(@04),C' '                               1079 03985000
         BNE   @RF01079                                            1079 03986000
*             RSCAMINL = 20;                                       1080 03987000
         MVI   RSCAMINL(@04),X'14'                                 1080 03988000
*           ELSE                                                   1081 03989000
*             RSCAMINL = LENGTH(RSCAMIND);                         1081 03990000
*                                                                  1081 03991000
         B     @RC01079                                            1081 03992000
@RF01079 L     @04,RSIOTBL(,REG6)                                  1081 03993000
         MVI   RSCAMINL(@04),X'2C'                                 1081 03994000
*         CALL IDCSARV0 (GDTTBL,EXCL,WAIT,RSCATUCB,RSCAMAJN,RSCAMINN);  03995000
*                                                                  1082 03996000
@RC01079 ST    REG5,@AL00001                                       1082 03997000
         LA    @04,EXCL                                            1082 03998000
         ST    @04,@AL00001+4                                      1082 03999000
         LA    @04,WAIT                                            1082 04000000
         ST    @04,@AL00001+8                                      1082 04001000
         LA    @04,RSCATUCB(,REG6)                                 1082 04002000
         ST    @04,@AL00001+12                                     1082 04003000
         L     @04,RSIOTBL(,REG6)                                  1082 04004000
         LA    @15,RSCAMAJN(,@04)                                  1082 04005000
         ST    @15,@AL00001+16                                     1082 04006000
         LA    @04,RSCAMINN(,@04)                                  1082 04007000
         ST    @04,@AL00001+20                                     1082 04008000
         MVI   @AL00001+20,X'80'                                   1082 04009000
         L     @15,GDTRSV(,REG5)                                   1082 04010000
         LA    @01,@AL00001                                        1082 04011000
         BALR  @14,@15                                             1082 04012000
*         RESPECIFY RTNREG RSTD;                                   1083 04013000
*         TESTRC = RTNREG;                                         1084 04014000
         STH   RTNREG,TESTRC(,REG6)                                1084 04015000
*         RESPECIFY RTNREG UNRSTD;                                 1085 04016000
*                                                                  1085 04017000
*         /***********************************************************/ 04018000
*         /*                                                         */ 04019000
*         /*    IF RESERVE FAILED, CALL CKERR TO TERMINATE.          */ 04020000
*         /*                                                         */ 04021000
*         /***********************************************************/ 04022000
*                                                                  1086 04023000
*         IF TESTRC ^= 0                                           1086 04024000
*           THEN                                                   1086 04025000
*                                                                  1086 04026000
*                                                                  1086 04027000
         LH    @04,TESTRC(,REG6)                                   1086 04028000
         LTR   @04,@04                                             1086 04029000
         BZ    @RF01086                                            1086 04030000
*             DO;                                                  1087 04031000
*             /*CALL CKERR*/                                       1088 04032000
*               RSCKERR = RSCKERR && RSCKERR;                      1088 04033000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1088 04034000
*               RSCKERN = RSE007;                                  1089 04035000
         MVC   RSCKERN(2,REG6),@CH00036                            1089 04036000
*               RSCKTERM = 'TERM';                                 1090 04037000
*                                                                  1090 04038000
         MVC   RSCKTERM(4,REG6),@CC03543                           1090 04039000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 04040000
*             CALL CKERR;                                          1091 04041000
         L     @15,@CV03544                                        1091 04042000
         BALR  @14,@15                                             1091 04043000
*             END;                                                 1092 04044000
*                                                                  1092 04045000
*         /***********************************************************/ 04046000
*         /*                                                         */ 04047000
*         /*  SET CATALOG RESERVED AUDIT FLAG ON.                    */ 04048000
*         /*                                                         */ 04049000
*         /***********************************************************/ 04050000
*                                                                  1093 04051000
*         RSCARES = ON;                                            1093 04052000
*                                                                  1093 04053000
@RF01086 OI    RSCARES(REG6),B'00000010'                           1093 04054000
*         /***********************************************************/ 04055000
*         /*                                                         */ 04056000
*         /*  IF CATALOG IN USE BY ANOTHER TASK, CALL CKERR          */ 04057000
*         /*  TO TERMINATE.                                          */ 04058000
*         /*                                                         */ 04059000
*         /***********************************************************/ 04060000
*                                                                  1094 04061000
*         CAXWAPTR = ACBUAPTR;                                     1094 04062000
*                                                                  1094 04063000
         L     @04,RSCATACB(,REG6)                                 1094 04064000
         L     @04,ACBUAPTR(,@04)                                  1094 04065000
         ST    @04,CAXWAPTR(,REG6)                                 1094 04066000
*         IF CAXACT ^= 1                                           1095 04067000
*           THEN                                                   1095 04068000
*                                                                  1095 04069000
*                                                                  1095 04070000
         CLI   CAXACT(@04),1                                       1095 04071000
         BE    @RF01095                                            1095 04072000
*             DO;                                                  1096 04073000
*             /*CALL CKERR*/                                       1097 04074000
*               RSCKERR = RSCKERR && RSCKERR;                      1097 04075000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1097 04076000
*               RSCKERN = RSE008;                                  1098 04077000
         MVC   RSCKERN(2,REG6),@CH00035                            1098 04078000
*               RSCKTERM = 'TERM';                                 1099 04079000
*                                                                  1099 04080000
         MVC   RSCKTERM(4,REG6),@CC03543                           1099 04081000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 04082000
*             CALL CKERR;                                          1100 04083000
         L     @15,@CV03544                                        1100 04084000
         BALR  @14,@15                                             1100 04085000
*             END;                                                 1101 04086000
*                                                                  1101 04087000
*         /***********************************************************/ 04088000
*         /*                                                         */ 04089000
*         /*  VERIFY THE CATALOG VIA DSOPEN                          */ 04090000
*         /*                                                         */ 04091000
*         /***********************************************************/ 04092000
*                                                                  1102 04093000
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSOPEN             */ 04094000
*         CALL IDCRS6DO('V','C');                                  1102 04095000
*                                                                  1102 04096000
@RF01095 L     @15,@CV03580                                        1102 04097000
         LA    @01,@AL01102                                        1102 04098000
         BALR  @14,@15                                             1102 04099000
*         /***********************************************************/ 04100000
*         /*                                                         */ 04101000
*         /*  OBTAIN STORAGE FOR CIXLT TABLE.                        */ 04102000
*         /*                                                         */ 04103000
*         /***********************************************************/ 04104000
*                                                                  1103 04105000
*         RSUGLEN = LENGTH(RSXCIXLT);                              1103 04106000
*                                                                  1103 04107000
         MVC   RSUGLEN(4,REG6),@CF03741                            1103 04108000
*         CALL IDCSAGP0 (GDTTBL,RSUGLEN,RSCIXLTA,POOL1,SETZERO);   1104 04109000
*                                                                  1104 04110000
         ST    REG5,@AL00001                                       1104 04111000
         LA    @04,RSUGLEN(,REG6)                                  1104 04112000
         ST    @04,@AL00001+4                                      1104 04113000
         LA    @04,RSCIXLTA(,REG6)                                 1104 04114000
         ST    @04,@AL00001+8                                      1104 04115000
         LA    @04,@CC00900                                        1104 04116000
         ST    @04,@AL00001+12                                     1104 04117000
         LA    @04,SETZERO                                         1104 04118000
         ST    @04,@AL00001+16                                     1104 04119000
         MVI   @AL00001+16,X'80'                                   1104 04120000
         L     @15,GDTGPL(,REG5)                                   1104 04121000
         LA    @01,@AL00001                                        1104 04122000
         BALR  @14,@15                                             1104 04123000
*         RESPECIFY RTNREG RSTD;                                   1105 04124000
*         TESTRC = RTNREG;                                         1106 04125000
         STH   RTNREG,TESTRC(,REG6)                                1106 04126000
*         RESPECIFY RTNREG UNRSTD;                                 1107 04127000
*                                                                  1107 04128000
*         /***********************************************************/ 04129000
*         /*                                                         */ 04130000
*         /*    IF STORAGE NOT AVAILABLE, CALL CKERR TO TERMINATE.   */ 04131000
*         /*                                                         */ 04132000
*         /***********************************************************/ 04133000
*                                                                  1108 04134000
*         IF TESTRC ^= 0                                           1108 04135000
*           THEN                                                   1108 04136000
*                                                                  1108 04137000
*                                                                  1108 04138000
         LH    @04,TESTRC(,REG6)                                   1108 04139000
         LTR   @04,@04                                             1108 04140000
         BZ    @RF01108                                            1108 04141000
*             DO;                                                  1109 04142000
*             /*CALL CKERR*/                                       1110 04143000
*               RSCKERR = RSCKERR && RSCKERR;                      1110 04144000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1110 04145000
*               RSCKERN = RSE099;                                  1111 04146000
         MVC   RSCKERN(2,REG6),@CH01083                            1111 04147000
*               RSCKTERM = 'TERM';                                 1112 04148000
*                                                                  1112 04149000
         MVC   RSCKTERM(4,REG6),@CC03543                           1112 04150000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 04151000
*             CALL CKERR;                                          1113 04152000
         L     @15,@CV03544                                        1113 04153000
         BALR  @14,@15                                             1113 04154000
*             END;                                                 1114 04155000
*                                                                  1114 04156000
*          RSXCIID = 'CIXL';             /*CIXLT TABLE ID            */ 04157000
*                                                                  1115 04158000
@RF01108 L     @04,RSCIXLTA(,REG6)                                 1115 04159000
         MVC   RSXCIID(4,@04),@CC03587                             1115 04160000
*         /***********************************************************/ 04161000
*         /*                                                         */ 04162000
*         /*  DEFINE THE WORKFILE.                                   */ 04163000
*         /*                                                         */ 04164000
*         /***********************************************************/ 04165000
*                                                                  1116 04166000
*                                                                  1116 04167000
*         /***********************************************************/ 04168000
*         /*                                                         */ 04169000
*         /*   GET THE CATALOG DATA LKR VGO                          */ 04170000
*         /*                                                         */ 04171000
*         /***********************************************************/ 04172000
*                                                                  1116 04173000
*         RSGRABCU = ADDR(GRABSCA);                                1116 04174000
         L     @04,RSIOTBL(,REG6)                                  1116 04175000
         LA    @04,GRABSCA(,@04)                                   1116 04176000
         ST    @04,RSGRABCU(,REG6)                                 1116 04177000
*         GRABCURR = GRABRAB1;                                     1117 04178000
         L     @15,GRABRAB1(,@04)                                  1117 04179000
         ST    @15,GRABCURR(,@04)                                  1117 04180000
*         RABRCDA = LKRDATCI;                                      1118 04181000
*                                                                  1118 04182000
         MVC   RABRCDA(4,@15),@CF00287                             1118 04183000
*         DO;                                                      1119 04184000
*           RSRTYPE = ''B;                                         1120 04185000
         MVI   RSRTYPE(REG6),X'00'                                 1120 04186000
*           RSRGET = ON;      /* GETRCD  */                        1121 04187000
         OI    RSRGET(REG6),B'10000000'                            1121 04188000
*           RSRUPD = OFF;     /* NO UPDATE  */                     1122 04189000
         NI    RSRUPD(REG6),B'11110111'                            1122 04190000
*           RSRDS = ''B;                                           1123 04191000
         NI    RSRDS(REG6),B'00011111'                             1123 04192000
*           RSRCAT = ON;      /* CATALOG  */                       1124 04193000
*           RSRDIR = ON;      /* DIRECT  */                        1125 04194000
*           RSRKEY = OFF;     /* CNV  */                           1126 04195000
*                                                                  1126 04196000
         OI    RSRCAT(REG6),B'01000100'                            1126 04197000
         NI    RSRKEY(REG6),B'11101111'                            1126 04198000
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */ 04199000
*         CALL RECMGMT;                                            1127 04200000
         L     @15,@CV03498                                        1127 04201000
         BALR  @14,@15                                             1127 04202000
*           RFY RTNREG RSTD;                                       1128 04203000
*           TESTRC = RTNREG;                                       1129 04204000
         STH   RTNREG,TESTRC(,REG6)                                1129 04205000
*           RFY RTNREG UNRSTD;                                     1130 04206000
*         END;                                                     1131 04207000
*                                                                  1131 04208000
*         /***********************************************************/ 04209000
*         /*                                                         */ 04210000
*         /*   GET THE NUMBER OF RECORDS PER TRACK FOR THE CATALOG   */ 04211000
*         /*                                                         */ 04212000
*         /***********************************************************/ 04213000
*                                                                  1132 04214000
*         /* CALL TO MODULE IDCRS03 FOR PROCEDURE CATRCDSU           */ 04215000
*         CALL CATRCDSU;                                           1132 04216000
         L     @15,@CV03499                                        1132 04217000
         BALR  @14,@15                                             1132 04218000
*         RSCPE6 = RSCPE3;             /*VGO IS FIRST GO             */ 04219000
         L     @04,RSCPE3(,REG6)                                   1133 04220000
         ST    @04,RSCPE6(,REG6)                                   1133 04221000
*         RSNOBLKT = NOBLKTRK;                                     1134 04222000
*                                                                  1134 04223000
         MVC   RSNOBLKT(2,REG6),NOBLKTRK(@04)                      1134 04224000
*         /***********************************************************/ 04225000
*         /*                                                         */ 04226000
*         /*    GET THE CATALOG DATA RECORD VIA RECMGMT.             */ 04227000
*         /*                                                         */ 04228000
*         /***********************************************************/ 04229000
*                                                                  1135 04230000
*         RSGRABCU = ADDR(GRABSCA);                                1135 04231000
         L     @04,RSIOTBL(,REG6)                                  1135 04232000
         LA    @04,GRABSCA(,@04)                                   1135 04233000
         ST    @04,RSGRABCU(,REG6)                                 1135 04234000
*         GRABCURR = GRABRAB1;                                     1136 04235000
         L     @15,GRABRAB1(,@04)                                  1136 04236000
         ST    @15,GRABCURR(,@04)                                  1136 04237000
*         RABRCDA = DATACI;                                        1137 04238000
*                                                                  1137 04239000
*                                                                  1137 04240000
         SLR   @04,@04                                             1137 04241000
         ST    @04,RABRCDA(,@15)                                   1137 04242000
*         DO;                                                      1138 04243000
*           RSRTYPE = ''B;                                         1139 04244000
         MVI   RSRTYPE(REG6),X'00'                                 1139 04245000
*           RSRGET = ON;      /* GETRCD  */                        1140 04246000
         OI    RSRGET(REG6),B'10000000'                            1140 04247000
*           RSRUPD = OFF;     /* NO UPDATE  */                     1141 04248000
         NI    RSRUPD(REG6),B'11110111'                            1141 04249000
*           RSRDS = ''B;                                           1142 04250000
         NI    RSRDS(REG6),B'00011111'                             1142 04251000
*           RSRCAT = ON;      /* CATALOG  */                       1143 04252000
*           RSRDIR = ON;      /* DIRECT  */                        1144 04253000
*           RSRKEY = OFF;     /* CNV  */                           1145 04254000
*                                                                  1145 04255000
         OI    RSRCAT(REG6),B'01000100'                            1145 04256000
         NI    RSRKEY(REG6),B'11101111'                            1145 04257000
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */ 04258000
*         CALL RECMGMT;                                            1146 04259000
         L     @15,@CV03498                                        1146 04260000
         BALR  @14,@15                                             1146 04261000
*           RFY RTNREG RSTD;                                       1147 04262000
*           TESTRC = RTNREG;                                       1148 04263000
         STH   RTNREG,TESTRC(,REG6)                                1148 04264000
*           RFY RTNREG UNRSTD;                                     1149 04265000
*         END;                                                     1150 04266000
*                                                                  1150 04267000
*         /***********************************************************/ 04268000
*         /*                                                         */ 04269000
*         /*    SAVE THE HIGH ALLOCATED DATA CI                      */ 04270000
*         /*                                                         */ 04271000
*         /***********************************************************/ 04272000
*                                                                  1151 04273000
*         RSCAHALC = CHIA/CILEN;                                   1151 04274000
*                                                                  1151 04275000
         L     @04,RSGRABCU(,REG6)                                 1151 04276000
         LA    @15,8                                               1151 04277000
         AL    @15,GRABCURR(,@04)                                  1151 04278000
         ICM   @04,15,CHIA(@15)                                    1151 04279000
         LR    @14,@04                                             1151 04280000
         SRL   @14,9                                               1151 04281000
         ST    @14,RSCAHALC(,REG6)                                 1151 04282000
*         /***********************************************************/ 04283000
*         /*                                                         */ 04284000
*         /*    COMPUTE THE PRIMARY AND SECONDARY ALLOCATION UNITS   */ 04285000
*         /*    FOR THE WORKFILE.                                    */ 04286000
*         /*                                                         */ 04287000
*         /***********************************************************/ 04288000
*                                                                  1152 04289000
*         RSCATSCN = CSEC * RSNOBLKT;                              1152 04290000
         SLR   @14,@14                                             1152 04291000
         ICM   @14,7,CSEC(@15)                                     1152 04292000
         MH    @14,RSNOBLKT(,REG6)                                 1152 04293000
         ST    @14,RSCATSCN(,REG6)                                 1152 04294000
*         RSWFPRIM = CHIA/CILEN + RSCATSCN;                        1153 04295000
         SRL   @04,9                                               1153 04296000
         ALR   @04,@14                                             1153 04297000
         ST    @04,RSWFPRIM(,REG6)                                 1153 04298000
*         RSWFSCND = (MAXCINO * 2 - RSWFPRIM + 125)/126;           1154 04299000
*                                                                  1154 04300000
         L     @00,MAXCINO                                         1154 04301000
         ALR   @00,@00                                             1154 04302000
         SLR   @00,@04                                             1154 04303000
         AL    @00,@CF03588                                        1154 04304000
         SRDA  @00,32                                              1154 04305000
         D     @00,@CF03589                                        1154 04306000
         ST    @01,RSWFSCND(,REG6)                                 1154 04307000
*         /***********************************************************/ 04308000
*         /*                                                         */ 04309000
*         /*    DEFINE THE WORKFILE VIA WFDEF.                       */ 04310000
*         /*                                                         */ 04311000
*         /***********************************************************/ 04312000
*                                                                  1155 04313000
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE WFDEF              */ 04314000
*         CALL WFDEF;                                              1155 04315000
*                                                                  1155 04316000
         L     @15,@CV03590                                        1155 04317000
         BALR  @14,@15                                             1155 04318000
*         /***********************************************************/ 04319000
*         /*                                                         */ 04320000
*         /*  OBTAIN THE ACB ADDRESS OF THE CATALOG IN WHICH THE     */ 04321000
*         /*  WORKFILE WAS DEFINED VIA UCATLG LOCATE.                */ 04322000
*         /*                                                         */ 04323000
*         /***********************************************************/ 04324000
*                                                                  1156 04325000
*                                                                  1156 04326000
*         /***********************************************************/ 04327000
*         /*                                                         */ 04328000
*         /*    COMPLETE CPL-FPL FOR UCATLG REQUEST.                 */ 04329000
*         /*                                                         */ 04330000
*         /***********************************************************/ 04331000
*                                                                  1156 04332000
*         CTGNAME = ON;                                            1156 04333000
*         CTGCNAME = ON;                                           1157 04334000
         L     @04,CTGPLPTR(,REG6)                                 1157 04335000
         OI    CTGNAME(@04),B'00000110'                            1157 04336000
*         CTGENT = RSWFDS;                                         1158 04337000
         L     @15,RSWFDS(,REG6)                                   1158 04338000
         ST    @15,CTGENT(,@04)                                    1158 04339000
*         CTGCAT = 0;                                              1159 04340000
*                                                                  1159 04341000
         SLR   @15,@15                                             1159 04342000
         ST    @15,CTGCAT(,@04)                                    1159 04343000
*         CTGFLPTR = CTGFIELD(1);                                  1160 04344000
         L     @04,CTGFIELD(,@04)                                  1160 04345000
         ST    @04,CTGFLPTR(,REG6)                                 1160 04346000
*         CTGFLDNM = ADDR(CATACB);                                 1161 04347000
*                                                                  1161 04348000
         LA    @15,@CC01094                                        1161 04349000
         ST    @15,CTGFLDNM(,@04)                                  1161 04350000
*         /***********************************************************/ 04351000
*         /*                                                         */ 04352000
*         /*    ISSUE UCATLG                                         */ 04353000
*         /*                                                         */ 04354000
*         /***********************************************************/ 04355000
*                                                                  1162 04356000
*         CALL IDCSACA0 (GDTTBL,CTGPLPTR);                         1162 04357000
*                                                                  1162 04358000
         ST    REG5,@AL00001                                       1162 04359000
         LA    @04,CTGPLPTR(,REG6)                                 1162 04360000
         ST    @04,@AL00001+4                                      1162 04361000
         L     @15,GDTCAT(,REG5)                                   1162 04362000
         LA    @01,@AL00001                                        1162 04363000
         BALR  @14,@15                                             1162 04364000
*         RESPECIFY RTNREG RSTD;                                   1163 04365000
*         TESTRC = RTNREG;                                         1164 04366000
         STH   RTNREG,TESTRC(,REG6)                                1164 04367000
*         RESPECIFY RTNREG UNRSTD;                                 1165 04368000
*                                                                  1165 04369000
*         /***********************************************************/ 04370000
*         /*                                                         */ 04371000
*         /*    IF UCATLG FAILED, CALL CKERR TO TERMINATE.           */ 04372000
*         /*                                                         */ 04373000
*         /***********************************************************/ 04374000
*                                                                  1166 04375000
*         IF TESTRC ^= 0                                           1166 04376000
*           THEN                                                   1166 04377000
         LH    @04,TESTRC(,REG6)                                   1166 04378000
         LTR   @04,@04                                             1166 04379000
         BZ    @RF01166                                            1166 04380000
*             DO;                                                  1167 04381000
*               RSCATRC = TESTRC;                                  1168 04382000
*                                                                  1168 04383000
*                                                                  1168 04384000
         STH   @04,RSCATRC(,REG6)                                  1168 04385000
*               DO;                                                1169 04386000
*               /*CALL CKERR*/                                     1170 04387000
*                 RSCKERR = RSCKERR && RSCKERR;                    1170 04388000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1170 04389000
*                 RSCKERN = RSE035;                                1171 04390000
         MVC   RSCKERN(2,REG6),@CH00853                            1171 04391000
*                 RSCKTERM = 'RETU';                               1172 04392000
*                                                                  1172 04393000
         MVC   RSCKTERM(4,REG6),@CC03585                           1172 04394000
*               /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR        */ 04395000
*               CALL CKERR;                                        1173 04396000
         L     @15,@CV03544                                        1173 04397000
         BALR  @14,@15                                             1173 04398000
*               END;                                               1174 04399000
*                                                                  1174 04400000
*                                                                  1174 04401000
*               DO;                                                1175 04402000
*               /*CALL CKERR*/                                     1176 04403000
*                 RSCKERR = RSCKERR && RSCKERR;                    1176 04404000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1176 04405000
*                 RSCKERN = RSE017;                                1177 04406000
         MVC   RSCKERN(2,REG6),@CH00930                            1177 04407000
*                 RSCKTERM = 'TERM';                               1178 04408000
*                                                                  1178 04409000
         MVC   RSCKTERM(4,REG6),@CC03543                           1178 04410000
*               /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR        */ 04411000
*               CALL CKERR;                                        1179 04412000
         L     @15,@CV03544                                        1179 04413000
         BALR  @14,@15                                             1179 04414000
*               END;                                               1180 04415000
*                                                                  1180 04416000
*             END;                                                 1181 04417000
*                                                                  1181 04418000
*         /***********************************************************/ 04419000
*         /*                                                         */ 04420000
*         /*    UCATLG SUCCESSFUL.                                   */ 04421000
*         /*                                                         */ 04422000
*         /***********************************************************/ 04423000
*                                                                  1182 04424000
*         /***********************************************************/ 04425000
*         /*                                                         */ 04426000
*         /*    SAVE WORKFILE CATALOG ACB ADDRESS IN LOCAL           */ 04427000
*         /*    WORKAREA.                                            */ 04428000
*         /*                                                         */ 04429000
*         /***********************************************************/ 04430000
*                                                                  1182 04431000
*         RSINWACB = INITWACB;                                     1182 04432000
*                                                                  1182 04433000
@RF01166 L     @04,CTGFLPTR(,REG6)                                 1182 04434000
         L     @04,CTGFLPT(,@04)                                   1182 04435000
         L     @04,INITWACB(,@04)                                  1182 04436000
         ST    @04,RSINWACB(,REG6)                                 1182 04437000
*         /***********************************************************/ 04438000
*         /*                                                         */ 04439000
*         /*  IF WORKFILE WAS DEFINED IN THE RESET CATALOG,          */ 04440000
*         /*  CALL CKERR TO TERMINATE.                               */ 04441000
*         /*                                                         */ 04442000
*         /***********************************************************/ 04443000
*                                                                  1183 04444000
*         IF RSINWACB = RSCATACB                                   1183 04445000
*           THEN                                                   1183 04446000
*                                                                  1183 04447000
*                                                                  1183 04448000
         C     @04,RSCATACB(,REG6)                                 1183 04449000
         BNE   @RF01183                                            1183 04450000
*             DO;                                                  1184 04451000
*             /*CALL CKERR*/                                       1185 04452000
*               RSCKERR = RSCKERR && RSCKERR;                      1185 04453000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1185 04454000
*               RSCKERN = RSE013;                                  1186 04455000
         MVC   RSCKERN(2,REG6),@CH00633                            1186 04456000
*               RSCKTERM = 'TERM';                                 1187 04457000
*                                                                  1187 04458000
         MVC   RSCKTERM(4,REG6),@CC03543                           1187 04459000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 04460000
*             CALL CKERR;                                          1188 04461000
         L     @15,@CV03544                                        1188 04462000
         BALR  @14,@15                                             1188 04463000
*             END;                                                 1189 04464000
*                                                                  1189 04465000
*         /***********************************************************/ 04466000
*         /*                                                         */ 04467000
*         /*  SET HIGHEST FORMATTED RELATIVE RECORD NUMBER IN        */ 04468000
*         /*  WORKFILE TO 0.                                         */ 04469000
*         /*                                                         */ 04470000
*         /***********************************************************/ 04471000
*                                                                  1190 04472000
*         RSWFHURR = 0;                                            1190 04473000
*                                                                  1190 04474000
@RF01183 SLR   @04,@04                                             1190 04475000
         ST    @04,RSWFHURR(,REG6)                                 1190 04476000
*         /***********************************************************/ 04477000
*         /*                                                         */ 04478000
*         /*  OPEN THE WORKFILE VIA DSOPEN.                          */ 04479000
*         /*                                                         */ 04480000
*         /***********************************************************/ 04481000
*                                                                  1191 04482000
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSOPEN             */ 04483000
*         CALL IDCRS6DO('O','W','O',RSWFDD,NULLPTR,RSWFPAS);       1191 04484000
*                                                                  1191 04485000
         MVC   @AL00001(20),@AL01191                               1191 04486000
         LA    @04,RSWFDD(,REG6)                                   1191 04487000
         ST    @04,@AL00001+12                                     1191 04488000
         LA    @04,RSWFPAS(,REG6)                                  1191 04489000
         ST    @04,@AL00001+20                                     1191 04490000
         L     @15,@CV03580                                        1191 04491000
         LA    @01,@AL00001                                        1191 04492000
         BALR  @14,@15                                             1191 04493000
*         RESPECIFY RTNREG RSTD;                                   1192 04494000
*         TESTRC = RTNREG;                                         1193 04495000
         STH   RTNREG,TESTRC(,REG6)                                1193 04496000
*         RESPECIFY RTNREG UNRSTD;                                 1194 04497000
*                                                                  1194 04498000
*         /***********************************************************/ 04499000
*         /*                                                         */ 04500000
*         /*    IF OPEN FAILED, CALL CKERR TO TERMINATE.             */ 04501000
*         /*                                                         */ 04502000
*         /***********************************************************/ 04503000
*                                                                  1195 04504000
*         IF TESTRC ^= 0                                           1195 04505000
*           THEN                                                   1195 04506000
*                                                                  1195 04507000
*                                                                  1195 04508000
         LH    @04,TESTRC(,REG6)                                   1195 04509000
         LTR   @04,@04                                             1195 04510000
         BZ    @RF01195                                            1195 04511000
*             DO;                                                  1196 04512000
*             /*CALL CKERR*/                                       1197 04513000
*               RSCKERR = RSCKERR && RSCKERR;                      1197 04514000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1197 04515000
*               RSCKERN = RSE015;                                  1198 04516000
         MVC   RSCKERN(2,REG6),@CH00229                            1198 04517000
*               RSCKTERM = 'TERM';                                 1199 04518000
*                                                                  1199 04519000
         MVC   RSCKTERM(4,REG6),@CC03543                           1199 04520000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 04521000
*             CALL CKERR;                                          1200 04522000
         L     @15,@CV03544                                        1200 04523000
         BALR  @14,@15                                             1200 04524000
*             END;                                                 1201 04525000
*                                                                  1201 04526000
*         /***********************************************************/ 04527000
*         /*                                                         */ 04528000
*         /*  BUILD RESET VOLSER LIST (RESVOL) FROM FDT INPUT.       */ 04529000
*         /*                                                         */ 04530000
*         /***********************************************************/ 04531000
*                                                                  1202 04532000
*         RSVOLALL = 0;                                            1202 04533000
@RF01195 SLR   @04,@04                                             1202 04534000
         ST    @04,RSVOLALL(,REG6)                                 1202 04535000
*         RSENTPT = ADDR(RSVOLENT);                                1203 04536000
         L     @01,RSIOTBL(,REG6)                                  1203 04537000
         LA    @15,RSVOLENT(,@01)                                  1203 04538000
         ST    @15,RSENTPT(,REG6)                                  1203 04539000
*         RSINDDPT = ADDR(RESVLDDN);                               1204 04540000
*                                                                  1204 04541000
         LA    @15,RESVLDDN(,@15)                                  1204 04542000
         ST    @15,RSINDDPT(,REG6)                                 1204 04543000
*         /***********************************************************/ 04544000
*         /*                                                         */ 04545000
*         /*  CRAVOLS PARAMETER SPECIFIED. BUILD RESVOL ALL ENTRIES. */ 04546000
*         /*  DYNAMICALLY ALLOCATE EACH CRA VOLUME.                  */ 04547000
*         /*                                                         */ 04548000
*         /***********************************************************/ 04549000
*                                                                  1205 04550000
*         IF CVOLCNT ^= 0                                          1205 04551000
*           THEN                                                   1205 04552000
         L     @15,@PC00001+4                                      1205 04553000
         LA    @15,FDTPTR+48(,@15)                                 1205 04554000
         C     @04,CVOLCNT(,@15)                                   1205 04555000
         BE    @RF01205                                            1205 04556000
*INITCV:      DO;                                                  1206 04557000
*                                                                  1206 04558000
INITCV   DS    0H                                                  1207 04559000
*         /***********************************************************/ 04560000
*         /*                                                         */ 04561000
*         /*    INITIALIZE SYSALLDA DEVTYPE LIST.                    */ 04562000
*         /*                                                         */ 04563000
*         /***********************************************************/ 04564000
*                                                                  1207 04565000
*               RSINDVLL = LENGTH(SYSALLDA);                       1207 04566000
         MVI   RSINDVLL(REG6),X'08'                                1207 04567000
*               RSINDVLV = SYSALLDA;                               1208 04568000
*                                                                  1208 04569000
         MVC   RSINDVLV(8,REG6),@CC00779                           1208 04570000
*         /***********************************************************/ 04571000
*         /*                                                         */ 04572000
*         /*    PROCESS CRAVOL LIST ENTRIES.                         */ 04573000
*         /*                                                         */ 04574000
*         /***********************************************************/ 04575000
*                                                                  1209 04576000
*INITLP6:       DO RSIDX = 1 TO CVOLCNT;                           1209 04577000
*                                                                  1209 04578000
INITLP6  LA    @04,1                                               1209 04579000
         B     @DE01209                                            1209 04580000
@DL01209 DS    0H                                                  1210 04581000
*                 RESVOL = ''B;                                    1210 04582000
         L     @04,RSENTPT(,REG6)                                  1210 04583000
         XC    RESVOL(92,@04),RESVOL(@04)                          1210 04584000
*                 RSINCVPT = CRAVLPTR(RSIDX);                      1211 04585000
         LH    @15,RSIDX(,REG6)                                    1211 04586000
         SLA   @15,2                                               1211 04587000
         L     @14,@PC00001+4                                      1211 04588000
         L     @01,FDTPTR+52(,@14)                                 1211 04589000
         AL    @01,@CF03777                                        1211 04590000
         L     @03,CRAVLPTR(@15,@01)                               1211 04591000
         ST    @03,RSINCVPT(,REG6)                                 1211 04592000
*                 RSINDVPT = CRADVPTR(RSIDX);                      1212 04593000
*                                                                  1212 04594000
         L     @01,FDTPTR+56(,@14)                                 1212 04595000
         AL    @01,@CF03777                                        1212 04596000
         L     @02,CRADVPTR(@15,@01)                               1212 04597000
         ST    @02,RSINDVPT(,REG6)                                 1212 04598000
*         /***********************************************************/ 04599000
*         /*                                                         */ 04600000
*         /*    SAVE VOLSER IN RESVOL ENTRY.                         */ 04601000
*         /*                                                         */ 04602000
*         /***********************************************************/ 04603000
*                                                                  1213 04604000
*                 RESVLSER = CRAVLVAL(1:CRAVLLEN);                 1213 04605000
*                                                                  1213 04606000
         MVI   RESVLSER+1(@04),C' '                                1213 04607000
         MVC   RESVLSER+2(4,@04),RESVLSER+1(@04)                   1213 04608000
         SLR   @02,@02                                             1213 04609000
         IC    @02,CRAVLLEN(,@03)                                  1213 04610000
         BCTR  @02,0                                               1213 04611000
         EX    @02,@SM03810                                        1213 04612000
*         /***********************************************************/ 04613000
*         /*                                                         */ 04614000
*         /*    SEARCH RESVOL FOR THIS CRA VOLSER VIA SCNRLST. IF    */ 04615000
*         /*    IT WAS SPECIFIED TWICE, THAN CALL CKERR TO TERMINATE.*/ 04616000
*         /*                                                         */ 04617000
*         /***********************************************************/ 04618000
*                                                                  1214 04619000
*                 RSCRVL = ADDR(RESVLSER);                         1214 04620000
*                                                                  1214 04621000
         LA    @04,RESVLSER(,@04)                                  1214 04622000
         ST    @04,RSCRVL(,REG6)                                   1214 04623000
*                 /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRLST    */ 04624000
*                 CALL IDCRS5SR('V','B',RSVTBENT,RSCRVL);          1215 04625000
*                                                                  1215 04626000
         LA    @04,@CC00833                                        1215 04627000
         ST    @04,@AL00001                                        1215 04628000
         LA    @04,@CC00815                                        1215 04629000
         ST    @04,@AL00001+4                                      1215 04630000
         LA    @04,RSVTBENT(,REG6)                                 1215 04631000
         ST    @04,@AL00001+8                                      1215 04632000
         LA    @04,RSCRVL(,REG6)                                   1215 04633000
         ST    @04,@AL00001+12                                     1215 04634000
         L     @15,@CV03539                                        1215 04635000
         LA    @01,@AL00001                                        1215 04636000
         BALR  @14,@15                                             1215 04637000
*                 RESPECIFY RTNREG RSTD;                           1216 04638000
*                 TESTRC = RTNREG;                                 1217 04639000
         STH   RTNREG,TESTRC(,REG6)                                1217 04640000
*                 RESPECIFY RTNREG UNRSTD;                         1218 04641000
*                                                                  1218 04642000
*                 IF RSVTBENT ^= 0                                 1219 04643000
*                   THEN                                           1219 04644000
*                                                                  1219 04645000
*                                                                  1219 04646000
         L     @04,RSVTBENT(,REG6)                                 1219 04647000
         LTR   @04,@04                                             1219 04648000
         BZ    @RF01219                                            1219 04649000
*                     DO;                                          1220 04650000
*                     /*CALL CKERR*/                               1221 04651000
*                       RSCKERR = RSCKERR && RSCKERR;              1221 04652000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1221 04653000
*                       RSCKERN = RSE040;                          1222 04654000
         MVC   RSCKERN(2,REG6),@CH00972                            1222 04655000
*                       RSCKTERM = 'TERM';                         1223 04656000
         MVC   RSCKTERM(4,REG6),@CC03543                           1223 04657000
*                       RSCKMVAR(1) = ADDR(RESVLSER);              1224 04658000
*                                                                  1224 04659000
         L     @04,RSENTPT(,REG6)                                  1224 04660000
         LA    @04,RESVLSER(,@04)                                  1224 04661000
         ST    @04,RSCKMVAR(,REG6)                                 1224 04662000
*                     /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR  */ 04663000
*                     CALL CKERR;                                  1225 04664000
         L     @15,@CV03544                                        1225 04665000
         BALR  @14,@15                                             1225 04666000
*                     END;                                         1226 04667000
*                                                                  1226 04668000
*         /***********************************************************/ 04669000
*         /*                                                         */ 04670000
*         /*    IF DEVTYPE SPECIFIED, USE IT FOR ALLOCATION.         */ 04671000
*         /*    OTHERWISE, USE SYSALLDA FOR DEVTYPE.                 */ 04672000
*         /*                                                         */ 04673000
*         /***********************************************************/ 04674000
*                                                                  1227 04675000
*                 IF RSINDVPT = 0                                  1227 04676000
*                   THEN                                           1227 04677000
@RF01219 L     @04,RSINDVPT(,REG6)                                 1227 04678000
         LTR   @04,@04                                             1227 04679000
         BNZ   @RF01227                                            1227 04680000
*                     RSINDVPT = ADDR(RSINDVL);                    1228 04681000
*                                                                  1228 04682000
         LA    @04,RSINDVL(,REG6)                                  1228 04683000
         ST    @04,RSINDVPT(,REG6)                                 1228 04684000
*         /***********************************************************/ 04685000
*         /*                                                         */ 04686000
*         /*    DYNAMICALLY ALLOCATE CRA VOLUME VIA CRAMNT.          */ 04687000
*         /*    DDNAME WILL BE RETURNED IN RESVOL ENTRY.             */ 04688000
*         /*                                                         */ 04689000
*         /***********************************************************/ 04690000
*                                                                  1229 04691000
*                 /* CALL TO MODULE IDCRS06 FOR PROCEDURE CRAMNT     */ 04692000
*                 CALL IDCRS6CM(RSINCVPT,RSINDVPT,RSINDDPT);       1229 04693000
*                                                                  1229 04694000
@RF01227 LA    @04,RSINCVPT(,REG6)                                 1229 04695000
         ST    @04,@AL00001                                        1229 04696000
         LA    @04,RSINDVPT(,REG6)                                 1229 04697000
         ST    @04,@AL00001+4                                      1229 04698000
         LA    @04,RSINDDPT(,REG6)                                 1229 04699000
         ST    @04,@AL00001+8                                      1229 04700000
         L     @15,@CV03595                                        1229 04701000
         LA    @01,@AL00001                                        1229 04702000
         BALR  @14,@15                                             1229 04703000
*                 RESPECIFY RTNREG RSTD;                           1230 04704000
*                 TESTRC = RTNREG;                                 1231 04705000
         STH   RTNREG,TESTRC(,REG6)                                1231 04706000
*                 RESPECIFY RTNREG UNRSTD;                         1232 04707000
*                                                                  1232 04708000
*         /***********************************************************/ 04709000
*         /*                                                         */ 04710000
*         /*    IF DYNAMIC ALLOCATION FAILED, CALL CKERR TO          */ 04711000
*         /*    TERMINATE.                                           */ 04712000
*         /*                                                         */ 04713000
*         /***********************************************************/ 04714000
*                                                                  1233 04715000
*                 IF TESTRC ^= 0                                   1233 04716000
*                   THEN                                           1233 04717000
*                                                                  1233 04718000
*                                                                  1233 04719000
         LH    @04,TESTRC(,REG6)                                   1233 04720000
         LTR   @04,@04                                             1233 04721000
         BZ    @RF01233                                            1233 04722000
*                     DO;                                          1234 04723000
*                     /*CALL CKERR*/                               1235 04724000
*                       RSCKERR = RSCKERR && RSCKERR;              1235 04725000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1235 04726000
*                       RSCKERN = RSE016;                          1236 04727000
         MVC   RSCKERN(2,REG6),@CH00478                            1236 04728000
*                       RSCKTERM = 'TERM';                         1237 04729000
*                                                                  1237 04730000
         MVC   RSCKTERM(4,REG6),@CC03543                           1237 04731000
*                     /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR  */ 04732000
*                     CALL CKERR;                                  1238 04733000
         L     @15,@CV03544                                        1238 04734000
         BALR  @14,@15                                             1238 04735000
*                     END;                                         1239 04736000
*                                                                  1239 04737000
*         /***********************************************************/ 04738000
*         /*                                                         */ 04739000
*         /*    SET CRA VOLUME ALLOCATED FLAG IN RESVOL ENTRY.       */ 04740000
*         /*                                                         */ 04741000
*         /***********************************************************/ 04742000
*                                                                  1240 04743000
*                 RESVLMNT = ON;                                   1240 04744000
*                                                                  1240 04745000
@RF01233 L     @04,RSENTPT(,REG6)                                  1240 04746000
         OI    RESVLMNT(@04),B'10000000'                           1240 04747000
*         /***********************************************************/ 04748000
*         /*                                                         */ 04749000
*         /*    IF THIS IS THE LAST VOLUME IN THE LIST, SET          */ 04750000
*         /*    LAST ALL FLAG IN RESVOL ENTRY.                       */ 04751000
*         /*                                                         */ 04752000
*         /***********************************************************/ 04753000
*                                                                  1241 04754000
*                 IF RSIDX = CVOLCNT                               1241 04755000
*                   THEN                                           1241 04756000
         L     @15,@PC00001+4                                      1241 04757000
         LA    @15,FDTPTR+48(,@15)                                 1241 04758000
         LH    @14,RSIDX(,REG6)                                    1241 04759000
         C     @14,CVOLCNT(,@15)                                   1241 04760000
         BNE   @RF01241                                            1241 04761000
*                     RESVLALE = ON;                               1242 04762000
*                                                                  1242 04763000
         OI    RESVLALE(@04),B'01000000'                           1242 04764000
*         /***********************************************************/ 04765000
*         /*                                                         */ 04766000
*         /*    ADD ENTRY TO RESVOL VIA BLDRLST.                     */ 04767000
*         /*                                                         */ 04768000
*         /***********************************************************/ 04769000
*                                                                  1243 04770000
*                 /* CALL TO MODULE IDCRS05 FOR PROCEDURE BLDRLST    */ 04771000
*                 CALL IDCRS5BR(RSENTPT);                          1243 04772000
*                                                                  1243 04773000
@RF01241 LA    @04,RSENTPT(,REG6)                                  1243 04774000
         ST    @04,@AL00001                                        1243 04775000
         L     @15,@CV03596                                        1243 04776000
         LA    @01,@AL00001                                        1243 04777000
         BALR  @14,@15                                             1243 04778000
*               END INITLP6;                                       1244 04779000
*                                                                  1244 04780000
         LA    @04,1                                               1244 04781000
         AH    @04,RSIDX(,REG6)                                    1244 04782000
@DE01209 STH   @04,RSIDX(,REG6)                                    1244 04783000
         L     @15,@PC00001+4                                      1244 04784000
         LA    @15,FDTPTR+48(,@15)                                 1244 04785000
         C     @04,CVOLCNT(,@15)                                   1244 04786000
         BNH   @DL01209                                            1244 04787000
*             END INITCV;                                          1245 04788000
*                                                                  1245 04789000
*         /***********************************************************/ 04790000
*         /*                                                         */ 04791000
*         /*  CRAFILES PARAMETER SPECIFIED. BUILD RESVOL ALL ENTRIES */ 04792000
*         /*  THEN RESVOL NONE ENTRIES.                              */ 04793000
*         /*                                                         */ 04794000
*         /***********************************************************/ 04795000
*                                                                  1246 04796000
*         IF CFILECNT ^= 0                                         1246 04797000
*           THEN                                                   1246 04798000
@RF01205 L     @04,@PC00001+4                                      1246 04799000
         LA    @04,FDTPTR+32(,@04)                                 1246 04800000
         L     @04,CFILECNT(,@04)                                  1246 04801000
         LTR   @04,@04                                             1246 04802000
         BZ    @RF01246                                            1246 04803000
*INITCF:      DO;                                                  1247 04804000
*                                                                  1247 04805000
INITCF   DS    0H                                                  1248 04806000
*         /***********************************************************/ 04807000
*         /*                                                         */ 04808000
*         /*  SET UP FOR UIOINFO VOLUME REQUESTS.                    */ 04809000
*         /*                                                         */ 04810000
*         /***********************************************************/ 04811000
*                                                                  1248 04812000
*               IOINFOPT = ''B;                                    1248 04813000
         LA    @04,700                                             1248 04814000
         ALR   @04,REG6                                            1248 04815000
         MVI   IOINFOPT(@04),X'00'                                 1248 04816000
*               IOINFVOL = ON;                                     1249 04817000
         OI    IOINFVOL(@04),B'01000000'                           1249 04818000
*               RSINSVVL = ''B;                                    1250 04819000
*                                                                  1250 04820000
         XC    RSINSVVL(6,REG6),RSINSVVL(REG6)                     1250 04821000
*         /***********************************************************/ 04822000
*         /*                                                         */ 04823000
*         /*    OBTAIN STORAGE FOR UIOINFO RETURN AREA.              */ 04824000
*         /*                                                         */ 04825000
*         /***********************************************************/ 04826000
*                                                                  1251 04827000
*               RSUGLEN = LENGTH(UIOVOL) + UIOHDR;                 1251 04828000
*                                                                  1251 04829000
         MVC   RSUGLEN(4,REG6),@CF00968                            1251 04830000
*               CALL IDCSAGP0 (GDTTBL,RSUGLEN,RSUIRPT,POOL3);      1252 04831000
*                                                                  1252 04832000
         ST    REG5,@AL00001                                       1252 04833000
         LA    @04,RSUGLEN(,REG6)                                  1252 04834000
         ST    @04,@AL00001+4                                      1252 04835000
         LA    @04,RSUIRPT(,REG6)                                  1252 04836000
         ST    @04,@AL00001+8                                      1252 04837000
         LA    @04,@CC00904                                        1252 04838000
         ST    @04,@AL00001+12                                     1252 04839000
         MVI   @AL00001+12,X'80'                                   1252 04840000
         L     @15,GDTGPL(,REG5)                                   1252 04841000
         LA    @01,@AL00001                                        1252 04842000
         BALR  @14,@15                                             1252 04843000
*               RESPECIFY RTNREG RSTD;                             1253 04844000
*               TESTRC = RTNREG;                                   1254 04845000
         STH   RTNREG,TESTRC(,REG6)                                1254 04846000
*               RESPECIFY RTNREG UNRSTD;                           1255 04847000
*                                                                  1255 04848000
*         /***********************************************************/ 04849000
*         /*                                                         */ 04850000
*         /*    IF STORAGE NOT AVAILABLE, CALL CKERR TO TERMINATE.   */ 04851000
*         /*                                                         */ 04852000
*         /***********************************************************/ 04853000
*                                                                  1256 04854000
*               IF TESTRC ^= 0                                     1256 04855000
*                 THEN                                             1256 04856000
*                                                                  1256 04857000
*                                                                  1256 04858000
         LH    @04,TESTRC(,REG6)                                   1256 04859000
         LTR   @04,@04                                             1256 04860000
         BZ    @RF01256                                            1256 04861000
*                   DO;                                            1257 04862000
*                   /*CALL CKERR*/                                 1258 04863000
*                     RSCKERR = RSCKERR && RSCKERR;                1258 04864000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1258 04865000
*                     RSCKERN = RSE099;                            1259 04866000
         MVC   RSCKERN(2,REG6),@CH01083                            1259 04867000
*                     RSCKTERM = 'TERM';                           1260 04868000
*                                                                  1260 04869000
         MVC   RSCKTERM(4,REG6),@CC03543                           1260 04870000
*                   /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR    */ 04871000
*                   CALL CKERR;                                    1261 04872000
         L     @15,@CV03544                                        1261 04873000
         BALR  @14,@15                                             1261 04874000
*                   END;                                           1262 04875000
*                                                                  1262 04876000
*         /***********************************************************/ 04877000
*         /*                                                         */ 04878000
*         /*    SET LENGTH OF RETURN AREA IN RETURN AREA HEADER      */ 04879000
*         /*                                                         */ 04880000
*         /***********************************************************/ 04881000
*                                                                  1263 04882000
*         UINFTLN = RSUGLEN;                                       1263 04883000
*                                                                  1263 04884000
@RF01256 L     @04,RSUIRPT(,REG6)                                  1263 04885000
         L     @15,RSUGLEN(,REG6)                                  1263 04886000
         STH   @15,UINFTLN(,@04)                                   1263 04887000
*         /***********************************************************/ 04888000
*         /*                                                         */ 04889000
*         /*    SCAN FOR ALL ENTRIES, THEN NONE ENTRIES.             */ 04890000
*         /*                                                         */ 04891000
*         /***********************************************************/ 04892000
*                                                                  1264 04893000
*               RSINALL = ON;                                      1264 04894000
*                                                                  1264 04895000
         OI    RSINALL(REG6),B'10000000'                           1264 04896000
*INITLP7:       DO RSIDX = 1 TO 2;                                 1265 04897000
*                                                                  1265 04898000
INITLP7  LA    @04,1                                               1265 04899000
         STH   @04,RSIDX(,REG6)                                    1265 04900000
@DL01265 DS    0H                                                  1266 04901000
*         /***********************************************************/ 04902000
*         /*                                                         */ 04903000
*         /*    PROCESS CRAFILES LIST ENTRIES.                       */ 04904000
*         /*                                                         */ 04905000
*         /***********************************************************/ 04906000
*                                                                  1266 04907000
*INITLP8:         DO RSIDX1 = 1 TO CFILECNT;                       1266 04908000
INITLP8  LA    @04,1                                               1266 04909000
         B     @DE01266                                            1266 04910000
@DL01266 DS    0H                                                  1267 04911000
*                   IF (NONEPTR(RSIDX1) ^= NULLPTR & RSINALL = OFF)     04912000
*                     | (NONEPTR(RSIDX1) = NULLPTR & RSINALL = ON) 1267 04913000
*                     THEN                                         1267 04914000
         LH    @04,RSIDX1(,REG6)                                   1267 04915000
         SLA   @04,2                                               1267 04916000
         L     @15,@PC00001+4                                      1267 04917000
         L     @01,FDTPTR+44(,@15)                                 1267 04918000
         AL    @01,@CF03777                                        1267 04919000
         L     @04,NONEPTR(@04,@01)                                1267 04920000
         LTR   @04,@04                                             1267 04921000
         BZ    @GL00002                                            1267 04922000
         TM    RSINALL(REG6),B'10000000'                           1267 04923000
         BZ    @RT01267                                            1267 04924000
@GL00002 LH    @04,RSIDX1(,REG6)                                   1267 04925000
         SLA   @04,2                                               1267 04926000
         L     @15,@PC00001+4                                      1267 04927000
         L     @01,FDTPTR+44(,@15)                                 1267 04928000
         AL    @01,@CF03777                                        1267 04929000
         L     @04,NONEPTR(@04,@01)                                1267 04930000
         LTR   @04,@04                                             1267 04931000
         BNZ   @RF01267                                            1267 04932000
         TM    RSINALL(REG6),B'10000000'                           1267 04933000
         BNO   @RF01267                                            1267 04934000
@RT01267 DS    0H                                                  1268 04935000
*                       DO;                                        1268 04936000
*                                                                  1268 04937000
*         /***********************************************************/ 04938000
*         /*                                                         */ 04939000
*         /*    PLACE DDNAME IN RESVOL ENTRY.                        */ 04940000
*         /*                                                         */ 04941000
*         /***********************************************************/ 04942000
*                                                                  1269 04943000
*                         RSINDNPT = CRADNPTR(RSIDX1);             1269 04944000
         LH    @04,RSIDX1(,REG6)                                   1269 04945000
         SLA   @04,2                                               1269 04946000
         L     @15,@PC00001+4                                      1269 04947000
         L     @01,FDTPTR+36(,@15)                                 1269 04948000
         AL    @01,@CF03777                                        1269 04949000
         L     @04,CRADNPTR(@04,@01)                               1269 04950000
         ST    @04,RSINDNPT(,REG6)                                 1269 04951000
*                         RESVOL = ''B;                            1270 04952000
         L     @15,RSENTPT(,REG6)                                  1270 04953000
         XC    RESVOL(92,@15),RESVOL(@15)                          1270 04954000
*                         RESVLDDN = CRADNVAL(1:CRADNLEN);         1271 04955000
*                                                                  1271 04956000
         MVI   RESVLDDN+1(@15),C' '                                1271 04957000
         MVC   RESVLDDN+2(6,@15),RESVLDDN+1(@15)                   1271 04958000
         SLR   @14,@14                                             1271 04959000
         IC    @14,CRADNLEN(,@04)                                  1271 04960000
         BCTR  @14,0                                               1271 04961000
         EX    @14,@SM03812                                        1271 04962000
*         /***********************************************************/ 04963000
*         /*                                                         */ 04964000
*         /*    GET VOLSER VIA UIOINFO.                              */ 04965000
*         /*                                                         */ 04966000
*         /***********************************************************/ 04967000
*                                                                  1272 04968000
*                         CALL IDCIOSI0 (GDTTBL,IOINFOPT,RSUIRPT,  1272 04969000
*                                  RESVLDDN);                      1272 04970000
*                                                                  1272 04971000
         ST    REG5,@AL00001                                       1272 04972000
         LA    @04,IOINFOPT+700(,REG6)                             1272 04973000
         ST    @04,@AL00001+4                                      1272 04974000
         LA    @04,RSUIRPT(,REG6)                                  1272 04975000
         ST    @04,@AL00001+8                                      1272 04976000
         LA    @04,RESVLDDN(,@15)                                  1272 04977000
         ST    @04,@AL00001+12                                     1272 04978000
         MVI   @AL00001+12,X'80'                                   1272 04979000
         L     @15,GDTIFO(,REG5)                                   1272 04980000
         LA    @01,@AL00001                                        1272 04981000
         BALR  @14,@15                                             1272 04982000
*                         RESPECIFY RTNREG RSTD;                   1273 04983000
*                         TESTRC = RTNREG;                         1274 04984000
         STH   RTNREG,TESTRC(,REG6)                                1274 04985000
*                         RESPECIFY RTNREG UNRSTD;                 1275 04986000
*                                                                  1275 04987000
*         /***********************************************************/ 04988000
*         /*                                                         */ 04989000
*         /*    IF UIOINFO FAILED, CALL CKERR TO TERMINATE.          */ 04990000
*         /*                                                         */ 04991000
*         /***********************************************************/ 04992000
*                                                                  1276 04993000
*                         IF TESTRC ^= 0                           1276 04994000
*                           THEN                                   1276 04995000
*                                                                  1276 04996000
*                                                                  1276 04997000
         LH    @04,TESTRC(,REG6)                                   1276 04998000
         LTR   @04,@04                                             1276 04999000
         BZ    @RF01276                                            1276 05000000
*                             DO;                                  1277 05001000
*                             /*CALL CKERR*/                       1278 05002000
*                               RSCKERR = RSCKERR && RSCKERR;      1278 05003000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1278 05004000
*                               RSCKERN = RSE002;                  1279 05005000
         MVC   RSCKERN(2,REG6),@CH00157                            1279 05006000
*                               RSCKTERM = 'TERM';                 1280 05007000
*                                                                  1280 05008000
         MVC   RSCKTERM(4,REG6),@CC03543                           1280 05009000
*                             /* CALL TO MODULE IDCRS05 FOR PROCEDURE C 05010000
*ERR                                                                 */ 05011000
*                             CALL CKERR;                          1281 05012000
         L     @15,@CV03544                                        1281 05013000
         BALR  @14,@15                                             1281 05014000
*                             END;                                 1282 05015000
*                                                                  1282 05016000
*         /***********************************************************/ 05017000
*         /*                                                         */ 05018000
*         /*    EXTRACT VOLSER AND SAVE IN RESVOL ENTRY.             */ 05019000
*         /*                                                         */ 05020000
*         /***********************************************************/ 05021000
*                                                                  1283 05022000
*                         RSUIRPT = RSUIRPT + UIOHDR;              1283 05023000
@RF01276 LA    @04,4                                               1283 05024000
         AL    @04,RSUIRPT(,REG6)                                  1283 05025000
         ST    @04,RSUIRPT(,REG6)                                  1283 05026000
*                         RESVLSER = UIOVLS(1:LENGTH(RESVLSER));   1284 05027000
*                                                                  1284 05028000
         L     @15,RSENTPT(,REG6)                                  1284 05029000
         MVC   RESVLSER(6,@15),UIOVLS(@04)                         1284 05030000
*         /***********************************************************/ 05031000
*         /*                                                         */ 05032000
*         /*    SEARCH RESVOL FOR THIS CRA VOLSER VIA SCNRLST. IF    */ 05033000
*         /*    IT WAS SPECIFIED TWICE, THAN CALL CKERR TO TERMINATE.*/ 05034000
*         /*                                                         */ 05035000
*         /***********************************************************/ 05036000
*                                                                  1285 05037000
*                         RSCRVL = ADDR(RESVLSER);                 1285 05038000
*                                                                  1285 05039000
         LA    @04,RESVLSER(,@15)                                  1285 05040000
         ST    @04,RSCRVL(,REG6)                                   1285 05041000
*                         /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRL 05042000
*T                                                                   */ 05043000
*                         CALL IDCRS5SR('V','B',RSVTBENT,RSCRVL);  1286 05044000
*                                                                  1286 05045000
         LA    @04,@CC00833                                        1286 05046000
         ST    @04,@AL00001                                        1286 05047000
         LA    @04,@CC00815                                        1286 05048000
         ST    @04,@AL00001+4                                      1286 05049000
         LA    @04,RSVTBENT(,REG6)                                 1286 05050000
         ST    @04,@AL00001+8                                      1286 05051000
         LA    @04,RSCRVL(,REG6)                                   1286 05052000
         ST    @04,@AL00001+12                                     1286 05053000
         L     @15,@CV03539                                        1286 05054000
         LA    @01,@AL00001                                        1286 05055000
         BALR  @14,@15                                             1286 05056000
*                         RESPECIFY RTNREG RSTD;                   1287 05057000
*                         TESTRC = RTNREG;                         1288 05058000
         STH   RTNREG,TESTRC(,REG6)                                1288 05059000
*                         RESPECIFY RTNREG UNRSTD;                 1289 05060000
*                                                                  1289 05061000
*                         IF RSVTBENT ^= 0                         1290 05062000
*                           THEN                                   1290 05063000
*                                                                  1290 05064000
*                                                                  1290 05065000
         L     @04,RSVTBENT(,REG6)                                 1290 05066000
         LTR   @04,@04                                             1290 05067000
         BZ    @RF01290                                            1290 05068000
*                             DO;                                  1291 05069000
*                             /*CALL CKERR*/                       1292 05070000
*                               RSCKERR = RSCKERR && RSCKERR;      1292 05071000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1292 05072000
*                               RSCKERN = RSE040;                  1293 05073000
         MVC   RSCKERN(2,REG6),@CH00972                            1293 05074000
*                               RSCKTERM = 'TERM';                 1294 05075000
         MVC   RSCKTERM(4,REG6),@CC03543                           1294 05076000
*                               RSCKMVAR(1) = ADDR(RESVLSER);      1295 05077000
*                                                                  1295 05078000
         L     @04,RSENTPT(,REG6)                                  1295 05079000
         LA    @04,RESVLSER(,@04)                                  1295 05080000
         ST    @04,RSCKMVAR(,REG6)                                 1295 05081000
*                             /* CALL TO MODULE IDCRS05 FOR PROCEDURE C 05082000
*ERR                                                                 */ 05083000
*                             CALL CKERR;                          1296 05084000
         L     @15,@CV03544                                        1296 05085000
         BALR  @14,@15                                             1296 05086000
*                             END;                                 1297 05087000
*                                                                  1297 05088000
*         /***********************************************************/ 05089000
*         /*                                                         */ 05090000
*         /*    ADD ENTRY TO RESVOL VIA BLDRLST.                     */ 05091000
*         /*                                                         */ 05092000
*         /***********************************************************/ 05093000
*                                                                  1298 05094000
*                         /* CALL TO MODULE IDCRS05 FOR PROCEDURE BLDRL 05095000
*T                                                                   */ 05096000
*                         CALL IDCRS5BR(RSENTPT);                  1298 05097000
*                                                                  1298 05098000
@RF01290 LA    @04,RSENTPT(,REG6)                                  1298 05099000
         ST    @04,@AL00001                                        1298 05100000
         L     @15,@CV03596                                        1298 05101000
         LA    @01,@AL00001                                        1298 05102000
         BALR  @14,@15                                             1298 05103000
*         /***********************************************************/ 05104000
*         /*                                                         */ 05105000
*         /*    SAVE VOLSER IN CASE IT IS LAST ALL                   */ 05106000
*         /*                                                         */ 05107000
*         /***********************************************************/ 05108000
*                                                                  1299 05109000
*                         IF RSINALL = ON                          1299 05110000
*                           THEN                                   1299 05111000
         TM    RSINALL(REG6),B'10000000'                           1299 05112000
         BNO   @RF01299                                            1299 05113000
*                             RSINSVVL = RESVLSER;                 1300 05114000
*                                                                  1300 05115000
         L     @04,RSENTPT(,REG6)                                  1300 05116000
         MVC   RSINSVVL(6,REG6),RESVLSER(@04)                      1300 05117000
*         /***********************************************************/ 05118000
*         /*                                                         */ 05119000
*         /*    POINT TO BEGINNING OF UIOINFO WORKAREA               */ 05120000
*         /*                                                         */ 05121000
*         /***********************************************************/ 05122000
*                                                                  1301 05123000
*                         RSUIRPT = RSUIRPT - UIOHDR;              1301 05124000
*                                                                  1301 05125000
@RF01299 L     @04,RSUIRPT(,REG6)                                  1301 05126000
         SL    @04,@CF00046                                        1301 05127000
         ST    @04,RSUIRPT(,REG6)                                  1301 05128000
*                       END;                                       1302 05129000
*                                                                  1302 05130000
*                     END INITLP8;                                 1303 05131000
*                                                                  1303 05132000
@RF01267 LA    @04,1                                               1303 05133000
         AH    @04,RSIDX1(,REG6)                                   1303 05134000
@DE01266 STH   @04,RSIDX1(,REG6)                                   1303 05135000
         L     @15,@PC00001+4                                      1303 05136000
         LA    @15,FDTPTR+32(,@15)                                 1303 05137000
         C     @04,CFILECNT(,@15)                                  1303 05138000
         BNH   @DL01266                                            1303 05139000
*         /***********************************************************/ 05140000
*         /*                                                         */ 05141000
*         /*    ALL SCAN DONE. SET LAST ALL INDICATOR AND            */ 05142000
*         /*    PREPARE FOR NONE SCAN.                               */ 05143000
*         /*                                                         */ 05144000
*         /***********************************************************/ 05145000
*                                                                  1304 05146000
*                     IF RSINALL = ON                              1304 05147000
*                       THEN                                       1304 05148000
         TM    RSINALL(REG6),B'10000000'                           1304 05149000
         BNO   @RF01304                                            1304 05150000
*                         DO;                                      1305 05151000
*                           RSINALL = OFF;                         1306 05152000
*                                                                  1306 05153000
         NI    RSINALL(REG6),B'01111111'                           1306 05154000
*         /***********************************************************/ 05155000
*         /*                                                         */ 05156000
*         /*    FIND LAST ALL VOLSER ENTRY VIA SCNRLST.              */ 05157000
*         /*                                                         */ 05158000
*         /***********************************************************/ 05159000
*                                                                  1307 05160000
*                           RSCRVL = ADDR(RSINSVVL);               1307 05161000
*                                                                  1307 05162000
         LA    @04,RSINSVVL(,REG6)                                 1307 05163000
         ST    @04,RSCRVL(,REG6)                                   1307 05164000
*                           /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCN 05165000
*LST                                                                 */ 05166000
*                           CALL IDCRS5SR('V','B',RSVTBENT,RSCRVL);     05167000
*                                                                  1308 05168000
         LA    @04,@CC00833                                        1308 05169000
         ST    @04,@AL00001                                        1308 05170000
         LA    @04,@CC00815                                        1308 05171000
         ST    @04,@AL00001+4                                      1308 05172000
         LA    @04,RSVTBENT(,REG6)                                 1308 05173000
         ST    @04,@AL00001+8                                      1308 05174000
         LA    @04,RSCRVL(,REG6)                                   1308 05175000
         ST    @04,@AL00001+12                                     1308 05176000
         L     @15,@CV03539                                        1308 05177000
         LA    @01,@AL00001                                        1308 05178000
         BALR  @14,@15                                             1308 05179000
*         /***********************************************************/ 05180000
*         /*                                                         */ 05181000
*         /*    IF NONE OF THE CRA FILES WAS SPECIFIED FOR           */ 05182000
*         /*    RESET (ALL), THEN CALL CKERR TO TERMINATE.           */ 05183000
*         /*                                                         */ 05184000
*         /***********************************************************/ 05185000
*                                                                  1309 05186000
*                           IF RSVTBENT = 0                        1309 05187000
*                             THEN                                 1309 05188000
*                                                                  1309 05189000
*                                                                  1309 05190000
         L     @04,RSVTBENT(,REG6)                                 1309 05191000
         LTR   @04,@04                                             1309 05192000
         BNZ   @RF01309                                            1309 05193000
*                               DO;                                1310 05194000
*                               /*CALL CKERR*/                     1311 05195000
*                                 RSCKERR = RSCKERR && RSCKERR;    1311 05196000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1311 05197000
*                                 RSCKERN = RSE024;                1312 05198000
         MVC   RSCKERN(2,REG6),@CH00309                            1312 05199000
*                                 RSCKTERM = 'TERM';               1313 05200000
*                                                                  1313 05201000
         MVC   RSCKTERM(4,REG6),@CC03543                           1313 05202000
*                               /* CALL TO MODULE IDCRS05 FOR PROCEDURE 05203000
*CKERR                                                               */ 05204000
*                               CALL CKERR;                        1314 05205000
         L     @15,@CV03544                                        1314 05206000
         BALR  @14,@15                                             1314 05207000
*                               END;                               1315 05208000
*                                                                  1315 05209000
*                           RSVTBENT -> RESVLALE = ON;             1316 05210000
*                                                                  1316 05211000
@RF01309 L     @04,RSVTBENT(,REG6)                                 1316 05212000
         OI    RESVLALE(@04),B'01000000'                           1316 05213000
*                         END;                                     1317 05214000
*                                                                  1317 05215000
*               END INITLP7;                                       1318 05216000
*                                                                  1318 05217000
@RF01304 LA    @04,1                                               1318 05218000
         AH    @04,RSIDX(,REG6)                                    1318 05219000
         STH   @04,RSIDX(,REG6)                                    1318 05220000
         C     @04,@CF00157                                        1318 05221000
         BNH   @DL01265                                            1318 05222000
*         /***********************************************************/ 05223000
*         /*                                                         */ 05224000
*         /*    FREE STORAGE OBTAINED FOR UIOINFO.                   */ 05225000
*         /*                                                         */ 05226000
*         /***********************************************************/ 05227000
*                                                                  1319 05228000
*               CALL IDCSAFP0 (GDTTBL,POOL3);                      1319 05229000
*                                                                  1319 05230000
         ST    REG5,@AL00001                                       1319 05231000
         LA    @04,@CC00904                                        1319 05232000
         ST    @04,@AL00001+4                                      1319 05233000
         MVI   @AL00001+4,X'80'                                    1319 05234000
         L     @15,GDTFPL(,REG5)                                   1319 05235000
         LA    @01,@AL00001                                        1319 05236000
         BALR  @14,@15                                             1319 05237000
*             END INITCF;                                          1320 05238000
*                                                                  1320 05239000
*         /***********************************************************/ 05240000
*         /*                                                         */ 05241000
*         /*  IF THE CRA FOR THE RESET CATALOG VOLUME WAS SPECIFIED  */ 05242000
*         /*  AS ONE OF THE RESET CRAS, REORDER IT AS FIRST ENTRY    */ 05243000
*         /*  IN RESVOL. IF IT IS ALREADY FIRST, NO REORDERING IS    */ 05244000
*         /*  NECESSARY.                                             */ 05245000
*         /*                                                         */ 05246000
*         /***********************************************************/ 05247000
*                                                                  1321 05248000
*         RSENTPT = RSVOLALL;                                      1321 05249000
@RF01246 L     @04,RSVOLALL(,REG6)                                 1321 05250000
         ST    @04,RSENTPT(,REG6)                                  1321 05251000
*         IF RESVLSER ^= RSINVLSR                                  1322 05252000
*           THEN                                                   1322 05253000
         CLC   RESVLSER(6,@04),RSINVLSR(REG6)                      1322 05254000
         BE    @RF01322                                            1322 05255000
*             DO;                                                  1323 05256000
*                                                                  1323 05257000
*         /***********************************************************/ 05258000
*         /*                                                         */ 05259000
*         /*    SCAN RESVOL FOR CATALOG VOLSER ENTRY VIA SCNRLST.    */ 05260000
*         /*                                                         */ 05261000
*         /***********************************************************/ 05262000
*                                                                  1324 05263000
*               RSCRVL = ADDR(RSINVLSR);                           1324 05264000
*                                                                  1324 05265000
         LA    @04,RSINVLSR(,REG6)                                 1324 05266000
         ST    @04,RSCRVL(,REG6)                                   1324 05267000
*               /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRLST      */ 05268000
*               CALL IDCRS5SR('V','A',RSENTPT,RSCRVL);             1325 05269000
*                                                                  1325 05270000
         LA    @04,@CC00833                                        1325 05271000
         ST    @04,@AL00001                                        1325 05272000
         LA    @04,@CC00813                                        1325 05273000
         ST    @04,@AL00001+4                                      1325 05274000
         LA    @04,RSENTPT(,REG6)                                  1325 05275000
         ST    @04,@AL00001+8                                      1325 05276000
         LA    @04,RSCRVL(,REG6)                                   1325 05277000
         ST    @04,@AL00001+12                                     1325 05278000
         L     @15,@CV03539                                        1325 05279000
         LA    @01,@AL00001                                        1325 05280000
         BALR  @14,@15                                             1325 05281000
*         /***********************************************************/ 05282000
*         /*                                                         */ 05283000
*         /*    IF ENTRY FOUND, REORDER IT AS FIRST ENTRY.           */ 05284000
*         /*                                                         */ 05285000
*         /***********************************************************/ 05286000
*                                                                  1326 05287000
*               IF RSENTPT ^= 0                                    1326 05288000
*                 THEN                                             1326 05289000
         L     @04,RSENTPT(,REG6)                                  1326 05290000
         LTR   @04,@04                                             1326 05291000
         BZ    @RF01326                                            1326 05292000
*                   DO;                                            1327 05293000
*                     RSSVENT(5:LENGTH(RESVOL)) =                  1328 05294000
*                         RSVOLALL -> RESVOL(5:LENGTH(RESVOL));    1328 05295000
         L     @15,RSVOLALL(,REG6)                                 1328 05296000
         MVC   RSSVENT+4(88,REG6),RESVOL+4(@15)                    1328 05297000
*                     RSVOLALL -> RESVOL(5:LENGTH(RESVOL)) =       1329 05298000
*                         RESVOL(5:LENGTH(RESVOL));                1329 05299000
         MVC   RESVOL+4(88,@15),RESVOL+4(@04)                      1329 05300000
*                     RESVOL(5:LENGTH(RESVOL)) =                   1330 05301000
*                         RSSVENT(5:LENGTH(RESVOL));               1330 05302000
*                                                                  1330 05303000
         MVC   RESVOL+4(88,@04),RSSVENT+4(REG6)                    1330 05304000
*         /***********************************************************/ 05305000
*         /*                                                         */ 05306000
*         /*    TRANSFER LAST ENTRY AND LAST ALL ENTRY FLAGS         */ 05307000
*         /*                                                         */ 05308000
*         /***********************************************************/ 05309000
*                                                                  1331 05310000
*                     IF RSVOLALL -> RESVLLAS = ON                 1331 05311000
*                       THEN                                       1331 05312000
         TM    RESVLLAS(@15),B'00100000'                           1331 05313000
         BNO   @RF01331                                            1331 05314000
*                         DO;                                      1332 05315000
*                           RSVOLALL -> RESVLLAS = OFF;            1333 05316000
         NI    RESVLLAS(@15),B'11011111'                           1333 05317000
*                           RESVLLAS = ON;                         1334 05318000
         OI    RESVLLAS(@04),B'00100000'                           1334 05319000
*                         END;                                     1335 05320000
*                                                                  1335 05321000
*                     IF RSVOLALL -> RESVLALE = ON                 1336 05322000
*                       THEN                                       1336 05323000
@RF01331 L     @04,RSVOLALL(,REG6)                                 1336 05324000
         TM    RESVLALE(@04),B'01000000'                           1336 05325000
         BNO   @RF01336                                            1336 05326000
*                         DO;                                      1337 05327000
*                           RSVOLALL -> RESVLALE = OFF;            1338 05328000
         NI    RESVLALE(@04),B'10111111'                           1338 05329000
*                           RESVLALE = ON;                         1339 05330000
         L     @04,RSENTPT(,REG6)                                  1339 05331000
         OI    RESVLALE(@04),B'01000000'                           1339 05332000
*                         END;                                     1340 05333000
*                                                                  1340 05334000
*                   END;                                           1341 05335000
*                                                                  1341 05336000
@RF01336 DS    0H                                                  1342 05337000
*             END;                                                 1342 05338000
*                                                                  1342 05339000
@RF01326 DS    0H                                                  1343 05340000
*         /***********************************************************/ 05341000
*         /*                                                         */ 05342000
*         /*  BUILD CIXLT TABLE VIA CATINIT.                         */ 05343000
*         /*                                                         */ 05344000
*         /***********************************************************/ 05345000
*                                                                  1343 05346000
*         CALL CATINIT;                                            1343 05347000
*                                                                  1343 05348000
@RF01322 BAL   @14,CATINIT                                         1343 05349000
*         /***********************************************************/ 05350000
*         /*                                                         */ 05351000
*         /*  PROCESSING COMPLETED. RETURN.                          */ 05352000
*         /*                                                         */ 05353000
*         /***********************************************************/ 05354000
*                                                                  1344 05355000
*                                                                  1344 05356000
*                                                                  1344 05357000
*         IF GDTDBG = NULLPTR                                      1344 05358000
*           THEN;                                                  1344 05359000
         L     @04,GDTDBG(,REG5)                                   1344 05360000
         LTR   @04,@04                                             1344 05361000
         BZ    @RT01344                                            1344 05362000
*           ELSE                                                   1346 05363000
*             CALL IDCDB010 (GDTTBL,'RSI1');                       1346 05364000
*                                                                  1346 05365000
         ST    REG5,@AL00001                                       1346 05366000
         LA    @04,@CC03603                                        1346 05367000
         ST    @04,@AL00001+4                                      1346 05368000
         MVI   @AL00001+4,X'80'                                    1346 05369000
         L     @15,GDTDBG(,REG5)                                   1346 05370000
         LA    @01,@AL00001                                        1346 05371000
         BALR  @14,@15                                             1346 05372000
* CALL EXIT;  /*TERMINATE*/                                        1347 05373000
@RT01344 BAL   @14,EXIT                                            1347 05374000
* END INIT; /*END OF PROCEDURE*/                                   1348 05375000
@EL00006 DS    0H                                                  1348 05376000
@EF00006 DS    0H                                                  1348 05377000
@ER00006 BR    @14                                                 1348 05378000
@PB00006 DS    0H                                                  1349 05379000
*/********************************************************************/ 05380000
*/*                                                                  */ 05381000
*/* PROCEDURE NAME - MERGECRA                                        */ 05382000
*/*                                                                  */ 05383000
*/* FUNCTION - MERGE EACH RESET CRA INTO THE WORKFILE.               */ 05384000
*/*                                                                  */ 05385000
*/* INPUT -    NONE                                                  */ 05386000
*/*                                                                  */ 05387000
*/* OUTPUT -   NONE                                                  */ 05388000
*/*                                                                  */ 05389000
*/* EXIT, NORMAL - RETURN TO CALLER                                  */ 05390000
*/* EXIT, ERROR - TO CKERR TO TERMINATE                              */ 05391000
*/*                                                                  */ 05392000
*/********************************************************************/ 05393000
*      GENERATE;                                                   1349 05394000
         DS    0F                                                       05395000
NAME0126 DC    CL8'MERGECRA'                                            05396000
*MERGECRA: PROCEDURE                                               1350 05397000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1350 05398000
*                                                                  1350 05399000
         B     @PB00007                                            1350 05400000
MERGECRA DS    0H                                                  1351 05401000
*      GENERATE REFS(RS01RG08, REG6);                              1351 05402000
*                                                                  1351 05403000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          05404000
         LR    @15,@13  OLD SAVE AREA                                   05405000
         LA    @13,72(@13)  NEW SAVE AREA                               05406000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     05407000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        05408000
         MVC   0(4,@15),NAME0126  PROCNAME TO REGSAVE                   05409000
*         RFY RESVOL BASED(RSENTPT);                               1352 05410000
*                                                                  1352 05411000
*         OLDERID2 = NEWERID2;                                     1353 05412000
         L     @04,GDTTR2(,REG5)                                   1353 05413000
         MVC   @TS00001(95),NEWERID2(@04)                          1353 05414000
         MVC   OLDERID2(95,@04),@TS00001                           1353 05415000
*         NEWID2 = 'RSME';                                         1354 05416000
*                                                                  1354 05417000
         MVC   NEWID2(4,@04),@CC03608                              1354 05418000
*         /***********************************************************/ 05419000
*         /*                                                         */ 05420000
*         /*  OPEN THE WORKFILE VIA DSOPEN.                          */ 05421000
*         /*                                                         */ 05422000
*         /***********************************************************/ 05423000
*                                                                  1355 05424000
*         IF RSWFOPN = OFF                                         1355 05425000
*           THEN                                                   1355 05426000
         TM    RSWFOPN(REG6),B'01000000'                           1355 05427000
         BNZ   @RF01355                                            1355 05428000
*             DO;                                                  1356 05429000
*                                                                  1356 05430000
*               /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSOPEN       */ 05431000
*               CALL IDCRS6DO('O','W','U',RSWFDD,NULLPTR,RSWFPAS); 1357 05432000
*                                                                  1357 05433000
         MVC   @AL00001(20),@AL01357                               1357 05434000
         LA    @04,RSWFDD(,REG6)                                   1357 05435000
         ST    @04,@AL00001+12                                     1357 05436000
         LA    @04,RSWFPAS(,REG6)                                  1357 05437000
         ST    @04,@AL00001+20                                     1357 05438000
         L     @15,@CV03580                                        1357 05439000
         LA    @01,@AL00001                                        1357 05440000
         BALR  @14,@15                                             1357 05441000
*               RESPECIFY RTNREG RSTD;                             1358 05442000
*               TESTRC = RTNREG;                                   1359 05443000
         STH   RTNREG,TESTRC(,REG6)                                1359 05444000
*               RESPECIFY RTNREG UNRSTD;                           1360 05445000
*                                                                  1360 05446000
*                                                                  1360 05447000
*         /***********************************************************/ 05448000
*         /*                                                         */ 05449000
*         /*    IF OPEN FAILED, CALL CKERR TO TERMINATE.             */ 05450000
*         /*                                                         */ 05451000
*         /***********************************************************/ 05452000
*                                                                  1361 05453000
*               IF TESTRC ^= 0                                     1361 05454000
*                 THEN                                             1361 05455000
*                                                                  1361 05456000
*                                                                  1361 05457000
         LH    @04,TESTRC(,REG6)                                   1361 05458000
         LTR   @04,@04                                             1361 05459000
         BZ    @RF01361                                            1361 05460000
*                   DO;                                            1362 05461000
*                   /*CALL CKERR*/                                 1363 05462000
*                     RSCKERR = RSCKERR && RSCKERR;                1363 05463000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1363 05464000
*                     RSCKERN = RSE015;                            1364 05465000
         MVC   RSCKERN(2,REG6),@CH00229                            1364 05466000
*                     RSCKTERM = 'TERM';                           1365 05467000
*                                                                  1365 05468000
         MVC   RSCKTERM(4,REG6),@CC03543                           1365 05469000
*                   /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR    */ 05470000
*                   CALL CKERR;                                    1366 05471000
         L     @15,@CV03544                                        1366 05472000
         BALR  @14,@15                                             1366 05473000
*                   END;                                           1367 05474000
*                                                                  1367 05475000
*             END;                                                 1368 05476000
*                                                                  1368 05477000
@RF01361 DS    0H                                                  1369 05478000
*         /***********************************************************/ 05479000
*         /*                                                         */ 05480000
*         /*  INITIALIZE REASSIGN COUNT AND TERMINATE AT END FLAG.   */ 05481000
*         /*                                                         */ 05482000
*         /***********************************************************/ 05483000
*                                                                  1369 05484000
*         RSREASSN = 0;                                            1369 05485000
@RF01355 SLR   @04,@04                                             1369 05486000
         ST    @04,RSREASSN(,REG6)                                 1369 05487000
*         RSMETRM  = OFF;                                          1370 05488000
*                                                                  1370 05489000
         NI    RSMETRM(REG6),B'10111111'                           1370 05490000
*         /***********************************************************/ 05491000
*         /*                                                         */ 05492000
*         /*  PROCESS RESET CRAS VIA ALL PORTION OF RESVOL.          */ 05493000
*         /*                                                         */ 05494000
*         /***********************************************************/ 05495000
*                                                                  1371 05496000
*         RSENTPT = ADDR(RSVOLENT);                                1371 05497000
*                                                                  1371 05498000
         L     @04,RSIOTBL(,REG6)                                  1371 05499000
         LA    @04,RSVOLENT(,@04)                                  1371 05500000
         ST    @04,RSENTPT(,REG6)                                  1371 05501000
*MERGLP1: DO UNTIL (RSENTPT = 0);                                  1372 05502000
*                                                                  1372 05503000
MERGLP1  DS    0H                                                  1372 05504000
@DL01372 DS    0H                                                  1373 05505000
*         /***********************************************************/ 05506000
*         /*                                                         */ 05507000
*         /*    CALL SCNRLST TO RETURN NEXT RESVOL ALL ENTRY.        */ 05508000
*         /*                                                         */ 05509000
*         /***********************************************************/ 05510000
*                                                                  1373 05511000
*           /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRLST          */ 05512000
*           CALL IDCRS5SR('N','A',RSENTPT,NULLPTR);                1373 05513000
*                                                                  1373 05514000
         MVC   @AL00001(16),@AL01373                               1373 05515000
         LA    @04,RSENTPT(,REG6)                                  1373 05516000
         ST    @04,@AL00001+8                                      1373 05517000
         L     @15,@CV03539                                        1373 05518000
         LA    @01,@AL00001                                        1373 05519000
         BALR  @14,@15                                             1373 05520000
*         /***********************************************************/ 05521000
*         /*                                                         */ 05522000
*         /*  PROCESS THIS CRA.                                      */ 05523000
*         /*                                                         */ 05524000
*         /***********************************************************/ 05525000
*                                                                  1374 05526000
*           IF RSENTPT ^= 0                                        1374 05527000
*             THEN                                                 1374 05528000
         L     @04,RSENTPT(,REG6)                                  1374 05529000
         LTR   @04,@04                                             1374 05530000
         BZ    @RF01374                                            1374 05531000
*MERGIT:        DO;                                                1375 05532000
*                                                                  1375 05533000
MERGIT   DS    0H                                                  1376 05534000
*         /***********************************************************/ 05535000
*         /*                                                         */ 05536000
*         /*    INITIALIZE OPEN AND BYPASS FLAGS.                    */ 05537000
*         /*                                                         */ 05538000
*         /***********************************************************/ 05539000
*                                                                  1376 05540000
*                 RSMEOP = OFF;                                    1376 05541000
*                 RSMEBYV = OFF;                                   1377 05542000
*                                                                  1377 05543000
         NI    RSMEOP(REG6),B'11001111'                            1377 05544000
*         /***********************************************************/ 05545000
*         /*                                                         */ 05546000
*         /*    OPEN AND VERIFY THE CRA VIA DSOPEN.                  */ 05547000
*         /*                                                         */ 05548000
*         /***********************************************************/ 05549000
*                                                                  1378 05550000
*                 RSCRADD = ADDR(RESVLDDN);                        1378 05551000
*                                                                  1378 05552000
         L     @04,RSENTPT(,REG6)                                  1378 05553000
         LA    @04,RESVLDDN(,@04)                                  1378 05554000
         ST    @04,RSCRADD(,REG6)                                  1378 05555000
*                 /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSOPEN     */ 05556000
*                 CALL IDCRS6DO('B','R','U',RSCRADD,NULLPTR,RSMRPAS);   05557000
*                                                                  1379 05558000
         MVC   @AL00001(20),@AL01379                               1379 05559000
         LA    @04,RSCRADD(,REG6)                                  1379 05560000
         ST    @04,@AL00001+12                                     1379 05561000
         LA    @04,RSMRPAS(,REG6)                                  1379 05562000
         ST    @04,@AL00001+20                                     1379 05563000
         L     @15,@CV03580                                        1379 05564000
         LA    @01,@AL00001                                        1379 05565000
         BALR  @14,@15                                             1379 05566000
*                 RESPECIFY RTNREG RSTD;                           1380 05567000
*                 TESTRC = RTNREG;                                 1381 05568000
         STH   RTNREG,TESTRC(,REG6)                                1381 05569000
*                 RESPECIFY RTNREG UNRSTD;                         1382 05570000
*                                                                  1382 05571000
*         /***********************************************************/ 05572000
*         /*                                                         */ 05573000
*         /*    IF OPEN FAILED, SET TERMINATE AT END FLAG            */ 05574000
*         /*    AND BYPASS VOLCHK FLAG, AND DO NOT MERGE THIS CRA.   */ 05575000
*         /*    IF OPEN SUCCESSFUL, SET CRA OPEN FLAG.               */ 05576000
*         /*    IGNORE VERIFY FAILURE.                               */ 05577000
*         /*                                                         */ 05578000
*         /***********************************************************/ 05579000
*                                                                  1383 05580000
*                 IF TESTRC = RCUERR1                              1383 05581000
*                   THEN                                           1383 05582000
         LH    @04,TESTRC(,REG6)                                   1383 05583000
         C     @04,@CF00046                                        1383 05584000
         BNE   @RF01383                                            1383 05585000
*                     DO;                                          1384 05586000
*                       RSMETRM = ON;                              1385 05587000
*                       RSMEBYV = ON;                              1386 05588000
         OI    RSMETRM(REG6),B'01010000'                           1386 05589000
*                     END;                                         1387 05590000
*                                                                  1387 05591000
*         /***********************************************************/ 05592000
*         /*                                                         */ 05593000
*         /*    OPEN OF CRA WAS SUCCESSFUL.                          */ 05594000
*         /*                                                         */ 05595000
*         /***********************************************************/ 05596000
*                                                                  1388 05597000
*                   ELSE                                           1388 05598000
*MERGCOP:             DO;                                          1388 05599000
*                                                                  1388 05600000
         B     @RC01383                                            1388 05601000
@RF01383 DS    0H                                                  1388 05602000
MERGCOP  DS    0H                                                  1389 05603000
*         /***********************************************************/ 05604000
*         /*                                                         */ 05605000
*         /*    SET CRA OPENED FLAG.                                 */ 05606000
*         /*                                                         */ 05607000
*         /***********************************************************/ 05608000
*                                                                  1389 05609000
*                       RSMEOP = ON;                               1389 05610000
*                                                                  1389 05611000
         OI    RSMEOP(REG6),B'00100000'                            1389 05612000
*         /***********************************************************/ 05613000
*         /*                                                         */ 05614000
*         /*    READ THE CRA CLUSTER RECORD VIA RECMGMT.             */ 05615000
*         /*                                                         */ 05616000
*         /***********************************************************/ 05617000
*                                                                  1390 05618000
*                       RSGRABCU = ADDR(GRABSCR);                  1390 05619000
         L     @04,RSIOTBL(,REG6)                                  1390 05620000
         LA    @04,GRABSCR(,@04)                                   1390 05621000
         ST    @04,RSGRABCU(,REG6)                                 1390 05622000
*                       GRABCURR = GRABRAB1;                       1391 05623000
         L     @15,GRABRAB1(,@04)                                  1391 05624000
         ST    @15,GRABCURR(,@04)                                  1391 05625000
*                       GRABAFLS = ''B;                            1392 05626000
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       1392 05627000
*                       GRABSIOT = ON;                             1393 05628000
         OI    GRABSIOT(@04),B'00000100'                           1393 05629000
*                       RABRCDA = CLUSCI;                          1394 05630000
*                                                                  1394 05631000
*                                                                  1394 05632000
         MVC   RABRCDA(4,@15),@CF00157                             1394 05633000
*                       DO;                                        1395 05634000
*                         RSRTYPE = ''B;                           1396 05635000
         MVI   RSRTYPE(REG6),X'00'                                 1396 05636000
*                         RSRGET = ON;      /* GETRCD  */          1397 05637000
         OI    RSRGET(REG6),B'10000000'                            1397 05638000
*                         RSRUPD = OFF;     /* NO UPDATE  */       1398 05639000
         NI    RSRUPD(REG6),B'11110111'                            1398 05640000
*                         RSRDS = ''B;                             1399 05641000
         NI    RSRDS(REG6),B'00011111'                             1399 05642000
*                         RSRCRA = ON;      /* CRA  */             1400 05643000
*                         RSRDIR = ON;      /* DIRECT  */          1401 05644000
*                         RSRKEY = OFF;     /* CNV  */             1402 05645000
*                                                                  1402 05646000
         OI    RSRCRA(REG6),B'00100100'                            1402 05647000
         NI    RSRKEY(REG6),B'11101111'                            1402 05648000
*                       /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT 05649000
*                                                                    */ 05650000
*                       CALL RECMGMT;                              1403 05651000
         L     @15,@CV03498                                        1403 05652000
         BALR  @14,@15                                             1403 05653000
*                         RFY RTNREG RSTD;                         1404 05654000
*                         TESTRC = RTNREG;                         1405 05655000
         STH   RTNREG,TESTRC(,REG6)                                1405 05656000
*                         RFY RTNREG UNRSTD;                       1406 05657000
*                       END;                                       1407 05658000
*                                                                  1407 05659000
*         /***********************************************************/ 05660000
*         /*                                                         */ 05661000
*         /*    IF THE ENTRY NAME IN THE CLUSTER RECORD DOES NOT     */ 05662000
*         /*    MATCH THE RESET CATALOG NAME, THEN CALL CKERR TO     */ 05663000
*         /*    PRINT A MESSAGE. SET TERMINATE AT END FLAG AND       */ 05664000
*         /*    BYPASS VOLCHK FLAG, AND DO NOT MERGE THIS CRA.       */ 05665000
*         /*                                                         */ 05666000
*         /***********************************************************/ 05667000
*                                                                  1408 05668000
*                       IF CNAME ^= RSCATDSN                       1408 05669000
*                         THEN                                     1408 05670000
         L     @04,RSGRABCU(,REG6)                                 1408 05671000
         L     @04,GRABCURR(,@04)                                  1408 05672000
         CLC   CNAME+8(44,@04),RSCATDSN(REG6)                      1408 05673000
         BE    @RF01408                                            1408 05674000
*                           DO;                                    1409 05675000
*                                                                  1409 05676000
*                                                                  1409 05677000
*                             DO;                                  1410 05678000
*                             /*CALL CKERR*/                       1411 05679000
*                               RSCKERR = RSCKERR && RSCKERR;      1411 05680000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1411 05681000
*                               RSCKERN = RSE078;                  1412 05682000
         MVC   RSCKERN(2,REG6),@CH01044                            1412 05683000
*                               RSCKTERM = 'RETU';                 1413 05684000
         MVC   RSCKTERM(4,REG6),@CC03585                           1413 05685000
*                               RSCKMVAR(1) = ADDR(RESVLSER);      1414 05686000
*                                                                  1414 05687000
         L     @04,RSENTPT(,REG6)                                  1414 05688000
         LA    @04,RESVLSER(,@04)                                  1414 05689000
         ST    @04,RSCKMVAR(,REG6)                                 1414 05690000
*                             /* CALL TO MODULE IDCRS05 FOR PROCEDURE C 05691000
*ERR                                                                 */ 05692000
*                             CALL CKERR;                          1415 05693000
         L     @15,@CV03544                                        1415 05694000
         BALR  @14,@15                                             1415 05695000
*                             END;                                 1416 05696000
*                                                                  1416 05697000
*                             RSMETRM = ON;                        1417 05698000
*                             RSMEBYV = ON;                        1418 05699000
         OI    RSMETRM(REG6),B'01010000'                           1418 05700000
*                           END;                                   1419 05701000
*                                                                  1419 05702000
*         /***********************************************************/ 05703000
*         /*                                                         */ 05704000
*         /*  MERGE CRA RECORDS TO WORKFILE VIA PROCCRA.             */ 05705000
*         /*                                                         */ 05706000
*         /***********************************************************/ 05707000
*                                                                  1420 05708000
*                         ELSE                                     1420 05709000
*                                                                  1420 05710000
*                           CALL PROCCRA;                          1420 05711000
*                                                                  1420 05712000
         B     @RC01408                                            1420 05713000
@RF01408 BAL   @14,PROCCRA                                         1420 05714000
*                     END MERGCOP;                                 1421 05715000
*                                                                  1421 05716000
@RC01408 DS    0H                                                  1422 05717000
*         /***********************************************************/ 05718000
*         /*                                                         */ 05719000
*         /*  CLOSE THE CRA VIA DSCLOSE.                             */ 05720000
*         /*                                                         */ 05721000
*         /***********************************************************/ 05722000
*                                                                  1422 05723000
*               IF RSMEOP = ON                                     1422 05724000
*                 THEN                                             1422 05725000
@RC01383 TM    RSMEOP(REG6),B'00100000'                            1422 05726000
         BNO   @RF01422                                            1422 05727000
*MERGCCL:           DO;                                            1423 05728000
MERGCCL  DS    0H                                                  1424 05729000
*                     RSMEOP = OFF;                                1424 05730000
*                                                                  1424 05731000
         NI    RSMEOP(REG6),B'11011111'                            1424 05732000
*                     /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSCLOSE*/ 05733000
*                     CALL IDCRS6DC('R');                          1425 05734000
*                                                                  1425 05735000
         L     @15,@CV03542                                        1425 05736000
         LA    @01,@AL01425                                        1425 05737000
         BALR  @14,@15                                             1425 05738000
*                     RESPECIFY RTNREG RSTD;                       1426 05739000
*                     TESTRC = RTNREG;                             1427 05740000
         STH   RTNREG,TESTRC(,REG6)                                1427 05741000
*                     RESPECIFY RTNREG UNRSTD;                     1428 05742000
*                                                                  1428 05743000
*         /***********************************************************/ 05744000
*         /*                                                         */ 05745000
*         /*    IF CLOSE FAILED, SET TERMINATE AT END FLAG AND       */ 05746000
*         /*    BYPASS VOLCHK FLAG.                                  */ 05747000
*         /*                                                         */ 05748000
*         /***********************************************************/ 05749000
*                                                                  1429 05750000
*                     IF TESTRC ^= 0                               1429 05751000
*                       THEN                                       1429 05752000
         LH    @04,TESTRC(,REG6)                                   1429 05753000
         LTR   @04,@04                                             1429 05754000
         BZ    @RF01429                                            1429 05755000
*                         DO;                                      1430 05756000
*                           RSMETRM = ON;                          1431 05757000
*                           RSMEBYV = ON;                          1432 05758000
         OI    RSMETRM(REG6),B'01010000'                           1432 05759000
*                         END;                                     1433 05760000
*                                                                  1433 05761000
*                   END MERGCCL;                                   1434 05762000
*                                                                  1434 05763000
@RF01429 DS    0H                                                  1435 05764000
*         /***********************************************************/ 05765000
*         /*                                                         */ 05766000
*         /*  IF CRA WAS PROCESSED SUCCESSFULLY, PERFORM VOLUME      */ 05767000
*         /*  CONSISTENCY CHECK VIA VOLCHK.                          */ 05768000
*         /*                                                         */ 05769000
*         /***********************************************************/ 05770000
*                                                                  1435 05771000
*               IF RSMEBYV = OFF                                   1435 05772000
*                 THEN                                             1435 05773000
*                                                                  1435 05774000
@RF01422 TM    RSMEBYV(REG6),B'00010000'                           1435 05775000
         BNZ   @RF01435                                            1435 05776000
*                   /* CALL TO MODULE IDCRS03 FOR PROCEDURE VOLCHK   */ 05777000
*                   CALL VOLCHK;                                   1436 05778000
*                                                                  1436 05779000
         L     @15,@CV03619                                        1436 05780000
         BALR  @14,@15                                             1436 05781000
*                 ELSE                                             1437 05782000
*                   RSMEBYV = OFF;                                 1437 05783000
*                                                                  1437 05784000
         B     @RC01435                                            1437 05785000
@RF01435 NI    RSMEBYV(REG6),B'11101111'                           1437 05786000
*               END MERGIT;                                        1438 05787000
*                                                                  1438 05788000
@RC01435 DS    0H                                                  1439 05789000
*         END MERGLP1;                                             1439 05790000
*                                                                  1439 05791000
@RF01374 DS    0H                                                  1439 05792000
@DE01372 L     @04,RSENTPT(,REG6)                                  1439 05793000
         LTR   @04,@04                                             1439 05794000
         BNZ   @DL01372                                            1439 05795000
*         /***********************************************************/ 05796000
*         /*                                                         */ 05797000
*         /*  ALL RESET CRAS HAVE BEEN PROCESSED.                    */ 05798000
*         /*  IF TERMINATE AT END FLAG WAS SET DUE TO AN ERROR IN    */ 05799000
*         /*  PROCESSING ONE OR MORE CRAS, THEN CALL CKERR TO        */ 05800000
*         /*  TERMINATE.                                             */ 05801000
*         /*                                                         */ 05802000
*         /***********************************************************/ 05803000
*                                                                  1440 05804000
*         IF RSMETRM = ON                                          1440 05805000
*           THEN                                                   1440 05806000
*                                                                  1440 05807000
*                                                                  1440 05808000
         TM    RSMETRM(REG6),B'01000000'                           1440 05809000
         BNO   @RF01440                                            1440 05810000
*             DO;                                                  1441 05811000
*             /*CALL CKERR*/                                       1442 05812000
*               RSCKERR = RSCKERR && RSCKERR;                      1442 05813000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1442 05814000
*               RSCKERN = RSE076;                                  1443 05815000
         MVC   RSCKERN(2,REG6),@CH01040                            1443 05816000
*               RSCKTERM = 'TERM';                                 1444 05817000
*                                                                  1444 05818000
         MVC   RSCKTERM(4,REG6),@CC03543                           1444 05819000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 05820000
*             CALL CKERR;                                          1445 05821000
         L     @15,@CV03544                                        1445 05822000
         BALR  @14,@15                                             1445 05823000
*             END;                                                 1446 05824000
*                                                                  1446 05825000
*         /***********************************************************/ 05826000
*         /*                                                         */ 05827000
*         /*  PROCESSING COMPLETED. RETURN.                          */ 05828000
*         /*                                                         */ 05829000
*         /***********************************************************/ 05830000
*                                                                  1447 05831000
*                                                                  1447 05832000
*                                                                  1447 05833000
*         IF GDTDBG = NULLPTR                                      1447 05834000
*           THEN;                                                  1447 05835000
@RF01440 L     @04,GDTDBG(,REG5)                                   1447 05836000
         LTR   @04,@04                                             1447 05837000
         BZ    @RT01447                                            1447 05838000
*           ELSE                                                   1449 05839000
*             CALL IDCDB010 (GDTTBL,'RSM1');                       1449 05840000
*                                                                  1449 05841000
         ST    REG5,@AL00001                                       1449 05842000
         LA    @04,@CC03620                                        1449 05843000
         ST    @04,@AL00001+4                                      1449 05844000
         MVI   @AL00001+4,X'80'                                    1449 05845000
         L     @15,GDTDBG(,REG5)                                   1449 05846000
         LA    @01,@AL00001                                        1449 05847000
         BALR  @14,@15                                             1449 05848000
* CALL EXIT;  /*TERMINATE*/                                        1450 05849000
@RT01447 BAL   @14,EXIT                                            1450 05850000
* END MERGECRA; /*END OF PROCEDURE*/                               1451 05851000
@EL00007 DS    0H                                                  1451 05852000
@EF00007 DS    0H                                                  1451 05853000
@ER00007 BR    @14                                                 1451 05854000
@PB00007 DS    0H                                                  1452 05855000
*/********************************************************************/ 05856000
*/*                                                                  */ 05857000
*/* PROCEDURE NAME - PROCCRA                                         */ 05858000
*/*                                                                  */ 05859000
*/* FUNCTION - MERGE THE RECORDS OF A RESET CRA INTO THE WORKFILE.   */ 05860000
*/*                                                                  */ 05861000
*/* INPUT -    NONE                                                  */ 05862000
*/*                                                                  */ 05863000
*/* OUTPUT -   VOLSERTB IS UPDATED.                                  */ 05864000
*/*            AVAILABLE COUNT IS UPDATED.                           */ 05865000
*/*                                                                  */ 05866000
*/* EXIT, NORMAL - RETURN TO CALLER                                  */ 05867000
*/* EXIT, ERROR - TO CKERR TO TERMINATE                              */ 05868000
*/*                                                                  */ 05869000
*/********************************************************************/ 05870000
*      GENERATE;                                                   1452 05871000
         DS    0F                                                       05872000
NAME0143 DC    CL8'PROCCRA'                                             05873000
*PROCCRA: PROCEDURE                                                1453 05874000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1453 05875000
*                                                                  1453 05876000
         B     @PB00008                                            1453 05877000
PROCCRA  DS    0H                                                  1454 05878000
*      GENERATE REFS(RS01RG08, REG6);                              1454 05879000
*                                                                  1454 05880000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          05881000
         LR    @15,@13  OLD SAVE AREA                                   05882000
         LA    @13,72(@13)  NEW SAVE AREA                               05883000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     05884000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        05885000
         MVC   0(4,@15),NAME0143  PROCNAME TO REGSAVE                   05886000
*         /***********************************************************/ 05887000
*         /*                                                         */ 05888000
*         /*  EXTENTS RETURNED BY FINDALL                            */ 05889000
*         /*                                                         */ 05890000
*         /***********************************************************/ 05891000
*                                                                  1455 05892000
*         DCL FNDEXTS CHAR(*) BASED(RSFATTNN);                     1455 05893000
*                                                                  1455 05894000
*         RFY RESVOL BASED(RSENTPT);                               1456 05895000
*         RFY CCR BASED(RSCRBP1);                                  1457 05896000
*         RFY VOLSERTB BASED(RSVTBENT);                            1458 05897000
*                                                                  1458 05898000
*         OLDERID2 = NEWERID2;                                     1459 05899000
         L     @04,GDTTR2(,REG5)                                   1459 05900000
         MVC   @TS00001(95),NEWERID2(@04)                          1459 05901000
         MVC   OLDERID2(95,@04),@TS00001                           1459 05902000
*         NEWID2 = 'RSPR';                                         1460 05903000
*                                                                  1460 05904000
         MVC   NEWID2(4,@04),@CC03628                              1460 05905000
*         /***********************************************************/ 05906000
*         /*                                                         */ 05907000
*         /*  INITIALIZATION. SET RAB AND BUFFER POINTERS FOR        */ 05908000
*         /*  WORKFILE AND CATALOG RECOVERY AREA.                    */ 05909000
*         /*  SET CATALOG GRAB FLAG TO TERMINATE ON I/O ERROR.       */ 05910000
*         /*                                                         */ 05911000
*         /***********************************************************/ 05912000
*                                                                  1461 05913000
*         RSGRABCU = ADDR(GRABSWF);                                1461 05914000
         L     @04,RSIOTBL(,REG6)                                  1461 05915000
         ST    @04,RSGRABCU(,REG6)                                 1461 05916000
*         GRABCURR = GRABRAB1;                                     1462 05917000
         L     @15,GRABRAB1(,@04)                                  1462 05918000
         ST    @15,GRABCURR(,@04)                                  1462 05919000
*         GRABAFLS = ''B;                                          1463 05920000
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       1463 05921000
*         GRABSIOT = ON;                                           1464 05922000
         OI    GRABSIOT(@04),B'00000100'                           1464 05923000
*         RSWFBP1 = ADDR(RABBUF);                                  1465 05924000
*                                                                  1465 05925000
         LA    @15,RABBUF(,@15)                                    1465 05926000
         ST    @15,RSWFBP1(,REG6)                                  1465 05927000
*         GRABCURR = GRABRAB2;                                     1466 05928000
         L     @15,GRABRAB2(,@04)                                  1466 05929000
         ST    @15,GRABCURR(,@04)                                  1466 05930000
*         RSWFBP2 = ADDR(RABBUF);                                  1467 05931000
*                                                                  1467 05932000
         LA    @15,RABBUF(,@15)                                    1467 05933000
         ST    @15,RSWFBP2(,REG6)                                  1467 05934000
*         RSGRABCU = ADDR(GRABSCR);                                1468 05935000
         LA    @04,GRABSCR(,@04)                                   1468 05936000
         ST    @04,RSGRABCU(,REG6)                                 1468 05937000
*         GRABCURR = GRABRAB1;                                     1469 05938000
         L     @15,GRABRAB1(,@04)                                  1469 05939000
         ST    @15,GRABCURR(,@04)                                  1469 05940000
*         RSCRBP1 = ADDR(RABBUF);                                  1470 05941000
*                                                                  1470 05942000
         LA    @04,RABBUF(,@15)                                    1470 05943000
         ST    @04,RSCRBP1(,REG6)                                  1470 05944000
*         /***********************************************************/ 05945000
*         /*                                                         */ 05946000
*         /*  EXTRACT LAST CONTROL INTERVAL IN THE CRA FROM THE      */ 05947000
*         /*  CCR RECORD.                                            */ 05948000
*         /*                                                         */ 05949000
*         /***********************************************************/ 05950000
*                                                                  1471 05951000
*         /***********************************************************/ 05952000
*         /*                                                         */ 05953000
*         /*    READ CCR RECORD VIA RECMGMT.                         */ 05954000
*         /*                                                         */ 05955000
*         /***********************************************************/ 05956000
*                                                                  1471 05957000
*         RABRCDA = CCRCI;                                         1471 05958000
*                                                                  1471 05959000
*                                                                  1471 05960000
         MVC   RABRCDA(4,@15),@CF00166                             1471 05961000
*         DO;                                                      1472 05962000
*           RSRTYPE = ''B;                                         1473 05963000
         MVI   RSRTYPE(REG6),X'00'                                 1473 05964000
*           RSRGET = ON;      /* GETRCD  */                        1474 05965000
         OI    RSRGET(REG6),B'10000000'                            1474 05966000
*           RSRUPD = OFF;     /* NO UPDATE  */                     1475 05967000
         NI    RSRUPD(REG6),B'11110111'                            1475 05968000
*           RSRDS = ''B;                                           1476 05969000
         NI    RSRDS(REG6),B'00011111'                             1476 05970000
*           RSRCRA = ON;      /* CRA  */                           1477 05971000
*           RSRDIR = ON;      /* DIRECT  */                        1478 05972000
*           RSRKEY = OFF;     /* CNV  */                           1479 05973000
*                                                                  1479 05974000
         OI    RSRCRA(REG6),B'00100100'                            1479 05975000
         NI    RSRKEY(REG6),B'11101111'                            1479 05976000
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */ 05977000
*         CALL RECMGMT;                                            1480 05978000
         L     @15,@CV03498                                        1480 05979000
         BALR  @14,@15                                             1480 05980000
*           RFY RTNREG RSTD;                                       1481 05981000
*           TESTRC = RTNREG;                                       1482 05982000
         STH   RTNREG,TESTRC(,REG6)                                1482 05983000
*           RFY RTNREG UNRSTD;                                     1483 05984000
*         END;                                                     1484 05985000
*                                                                  1484 05986000
*         /***********************************************************/ 05987000
*         /*                                                         */ 05988000
*         /*    IF NEXT UNFORMATTED CI IS 0, THEN SET LAST CI AS     */ 05989000
*         /*    HIGH ALLOCATED CI, OTHERWISE SET LAST CI AS NEXT     */ 05990000
*         /*    UNFORMATTED FREE CI MINUS ONE.                       */ 05991000
*         /*                                                         */ 05992000
*         /***********************************************************/ 05993000
*                                                                  1485 05994000
*         IF CCRNFCI = 0                                           1485 05995000
*           THEN                                                   1485 05996000
         L     @04,RSCRBP1(,REG6)                                  1485 05997000
         ICM   @15,7,CCRNFCI(@04)                                  1485 05998000
         BNZ   @RF01485                                            1485 05999000
*             RSCREND = CCRHACI;                                   1486 06000000
         SLR   @15,@15                                             1486 06001000
         ICM   @15,7,CCRHACI(@04)                                  1486 06002000
         ST    @15,RSCREND(,REG6)                                  1486 06003000
*           ELSE                                                   1487 06004000
*             RSCREND = CCRNFCI - 1;                               1487 06005000
*                                                                  1487 06006000
*                                                                  1487 06007000
         B     @RC01485                                            1487 06008000
@RF01485 L     @04,RSCRBP1(,REG6)                                  1487 06009000
         SLR   @15,@15                                             1487 06010000
         ICM   @15,7,CCRNFCI(@04)                                  1487 06011000
         BCTR  @15,0                                               1487 06012000
         ST    @15,RSCREND(,REG6)                                  1487 06013000
*         /***********************************************************/ 06014000
*         /*                                                         */ 06015000
*         /*  SET CRA GRAB FLAGS FOR SPECIAL I/O ERROR HANDLING.     */ 06016000
*         /*                                                         */ 06017000
*         /***********************************************************/ 06018000
*                                                                  1488 06019000
*         GRABAFLS = ''B;                                          1488 06020000
@RC01485 L     @04,RSGRABCU(,REG6)                                 1488 06021000
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       1488 06022000
*         GRABSIOI = ON;                                           1489 06023000
*                                                                  1489 06024000
         OI    GRABSIOI(@04),B'00010000'                           1489 06025000
*         /***********************************************************/ 06026000
*         /*                                                         */ 06027000
*         /*  PROCESS EACH CRA RECORD FROM VOLUME RECORD TO LAST CI. */ 06028000
*         /*                                                         */ 06029000
*         /***********************************************************/ 06030000
*                                                                  1490 06031000
*PROLP1:  DO RSCURCI = VOLCI TO RSCREND;                           1490 06032000
*                                                                  1490 06033000
PROLP1   LA    @04,9                                               1490 06034000
         B     @DE01490                                            1490 06035000
@DL01490 DS    0H                                                  1491 06036000
*         /***********************************************************/ 06037000
*         /*                                                         */ 06038000
*         /*    READ THE CRA RECORD VIA RECMGMT.                     */ 06039000
*         /*                                                         */ 06040000
*         /***********************************************************/ 06041000
*                                                                  1491 06042000
*           RSGRABCU = ADDR(GRABSCR);                              1491 06043000
         L     @04,RSIOTBL(,REG6)                                  1491 06044000
         LA    @04,GRABSCR(,@04)                                   1491 06045000
         ST    @04,RSGRABCU(,REG6)                                 1491 06046000
*           RABRCDA = RSCURCI;                                     1492 06047000
*                                                                  1492 06048000
*                                                                  1492 06049000
         L     @04,GRABCURR(,@04)                                  1492 06050000
         L     @15,RSCURCI(,REG6)                                  1492 06051000
         ST    @15,RABRCDA(,@04)                                   1492 06052000
*           DO;                                                    1493 06053000
*             RSRTYPE = ''B;                                       1494 06054000
         MVI   RSRTYPE(REG6),X'00'                                 1494 06055000
*             RSRGET = ON;      /* GETRCD  */                      1495 06056000
         OI    RSRGET(REG6),B'10000000'                            1495 06057000
*             RSRUPD = OFF;     /* NO UPDATE  */                   1496 06058000
         NI    RSRUPD(REG6),B'11110111'                            1496 06059000
*             RSRDS = ''B;                                         1497 06060000
         NI    RSRDS(REG6),B'00011111'                             1497 06061000
*             RSRCRA = ON;      /* CRA  */                         1498 06062000
*             RSRDIR = ON;      /* DIRECT  */                      1499 06063000
*             RSRKEY = OFF;     /* CNV  */                         1500 06064000
*                                                                  1500 06065000
         OI    RSRCRA(REG6),B'00100100'                            1500 06066000
         NI    RSRKEY(REG6),B'11101111'                            1500 06067000
*           /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT          */ 06068000
*           CALL RECMGMT;                                          1501 06069000
         L     @15,@CV03498                                        1501 06070000
         BALR  @14,@15                                             1501 06071000
*             RFY RTNREG RSTD;                                     1502 06072000
*             TESTRC = RTNREG;                                     1503 06073000
         STH   RTNREG,TESTRC(,REG6)                                1503 06074000
*             RFY RTNREG UNRSTD;                                   1504 06075000
*           END;                                                   1505 06076000
*                                                                  1505 06077000
*         /***********************************************************/ 06078000
*         /*                                                         */ 06079000
*         /*    VOLUME RECORD (CI 9). ADD/UPDATE VOLSERTB ENTRY.     */ 06080000
*         /*                                                         */ 06081000
*         /***********************************************************/ 06082000
*                                                                  1506 06083000
*           IF RSCURCI = VOLCI                                     1506 06084000
*             THEN                                                 1506 06085000
         CLC   RSCURCI(4,REG6),@CF00040                            1506 06086000
         BNE   @RF01506                                            1506 06087000
*PROVOL:        DO;                                                1507 06088000
*                                                                  1507 06089000
PROVOL   DS    0H                                                  1508 06090000
*         /***********************************************************/ 06091000
*         /*                                                         */ 06092000
*         /*    SCAN VOLSERTB FOR CRA VOLSER VIA SCNVLST.            */ 06093000
*         /*                                                         */ 06094000
*         /***********************************************************/ 06095000
*                                                                  1508 06096000
*                 RSCRVL = ADDR(RESVLSER);                         1508 06097000
*                                                                  1508 06098000
         L     @04,RSENTPT(,REG6)                                  1508 06099000
         LA    @04,RESVLSER(,@04)                                  1508 06100000
         ST    @04,RSCRVL(,REG6)                                   1508 06101000
*                 /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNVLST    */ 06102000
*                 CALL IDCRS5SV(RSVTBENT,RSCRVL);                  1509 06103000
*                                                                  1509 06104000
         LA    @04,RSVTBENT(,REG6)                                 1509 06105000
         ST    @04,@AL00001                                        1509 06106000
         LA    @04,RSCRVL(,REG6)                                   1509 06107000
         ST    @04,@AL00001+4                                      1509 06108000
         L     @15,@CV03633                                        1509 06109000
         LA    @01,@AL00001                                        1509 06110000
         BALR  @14,@15                                             1509 06111000
*         /***********************************************************/ 06112000
*         /*                                                         */ 06113000
*         /*    NOT A VALID VOLUME RECORD. SET INVALID VOLUME RECORD */ 06114000
*         /*    FLAGS. SET BYPASS VOLCHK FLAG.                       */ 06115000
*         /*                                                         */ 06116000
*         /***********************************************************/ 06117000
*                                                                  1510 06118000
*                 IF RCDID ^= VOLID | RABIOIGN = ON                1510 06119000
*                   THEN                                           1510 06120000
         L     @04,RSGRABCU(,REG6)                                 1510 06121000
         L     @04,GRABCURR(,@04)                                  1510 06122000
         CLI   RCDID+8(@04),C'V'                                   1510 06123000
         BNE   @RT01510                                            1510 06124000
         TM    RABIOIGN(@04),B'00000100'                           1510 06125000
         BNO   @RF01510                                            1510 06126000
@RT01510 DS    0H                                                  1511 06127000
*                     DO;                                          1511 06128000
*                       RSBADVOL = ON;                             1512 06129000
         OI    RSBADVOL(REG6),B'00000010'                          1512 06130000
*                       RESVLBAD = ON;                             1513 06131000
         L     @04,RSENTPT(,REG6)                                  1513 06132000
         OI    RESVLBAD(@04),B'00010000'                           1513 06133000
*                       RSMEBYV = ON;                              1514 06134000
         OI    RSMEBYV(REG6),B'00010000'                           1514 06135000
*                     END;                                         1515 06136000
*                                                                  1515 06137000
*         /***********************************************************/ 06138000
*         /*                                                         */ 06139000
*         /*    VOLSERTB ENTRY FOUND. UPDATE IT FROM CRA VOLUME      */ 06140000
*         /*    RECORD INFORMATION.                                  */ 06141000
*         /*                                                         */ 06142000
*         /***********************************************************/ 06143000
*                                                                  1516 06144000
*                 IF RSVTBENT ^= 0                                 1516 06145000
*                   THEN                                           1516 06146000
@RF01510 L     @04,RSVTBENT(,REG6)                                 1516 06147000
         LTR   @04,@04                                             1516 06148000
         BZ    @RF01516                                            1516 06149000
*                     DO;                                          1517 06150000
*                                                                  1517 06151000
*         /***********************************************************/ 06152000
*         /*                                                         */ 06153000
*         /*    INVALID VOLUME RECORD. INVALIDATE VOLSERTB ENTRY.    */ 06154000
*         /*                                                         */ 06155000
*         /***********************************************************/ 06156000
*                                                                  1518 06157000
*                       IF RESVLBAD = ON                           1518 06158000
*                         THEN                                     1518 06159000
         L     @01,RSENTPT(,REG6)                                  1518 06160000
         TM    RESVLBAD(@01),B'00010000'                           1518 06161000
         BNO   @RF01518                                            1518 06162000
*                           DO;                                    1519 06163000
*                             VOLSRSER = ''B;                      1520 06164000
         XC    VOLSRSER(6,@04),VOLSRSER(@04)                       1520 06165000
*                             VOLSRTS = ''B;                       1521 06166000
         XC    VOLSRTS(8,@04),VOLSRTS(@04)                         1521 06167000
*                           END;                                   1522 06168000
*                                                                  1522 06169000
*         /***********************************************************/ 06170000
*         /*                                                         */ 06171000
*         /*    VALID VOLUME RECORD. UPDATE VOLSERTB ENTRY.          */ 06172000
*         /*                                                         */ 06173000
*         /***********************************************************/ 06174000
*                                                                  1523 06175000
*                         ELSE                                     1523 06176000
*                           DO;                                    1523 06177000
         B     @RC01518                                            1523 06178000
@RF01518 DS    0H                                                  1524 06179000
*                             VOLSRCI = RCDCINO;                   1524 06180000
         L     @04,RSVTBENT(,REG6)                                 1524 06181000
         L     @01,RSGRABCU(,REG6)                                 1524 06182000
         L     @15,GRABCURR(,@01)                                  1524 06183000
         LA    @14,8                                               1524 06184000
         ALR   @14,@15                                             1524 06185000
         L     @03,RCDCINO-1(,@14)                                 1524 06186000
         LA    @03,0(,@03)                                         1524 06187000
         ST    @03,VOLSRCI(,@04)                                   1524 06188000
*                             VOLSRTS = COWNID;                    1525 06189000
         MVC   VOLSRTS(8,@04),COWNID(@14)                          1525 06190000
*                             VOLSRNTK = RTNOTRKS;                 1526 06191000
         MVC   VOLSRNTK(2,@04),RTNOTRKS(@15)                       1526 06192000
*                           END;                                   1527 06193000
*                                                                  1527 06194000
*                     END;                                         1528 06195000
*                                                                  1528 06196000
@RC01518 DS    0H                                                  1529 06197000
*         /***********************************************************/ 06198000
*         /*                                                         */ 06199000
*         /*    VOLSERTB ENTRY NOT FOUND.                            */ 06200000
*         /*    IF VOLUME RECORD IS VALID, BUILD AN ENTRY FOR        */ 06201000
*         /*    THIS CRA VOLUME RECORD AND ADD IT TO VOLSERTB        */ 06202000
*         /*    VIA BLDVLST.                                         */ 06203000
*         /*                                                         */ 06204000
*         /***********************************************************/ 06205000
*                                                                  1529 06206000
*                 IF RSVTBENT = 0                                  1529 06207000
*                   THEN                                           1529 06208000
@RF01516 L     @04,RSVTBENT(,REG6)                                 1529 06209000
         LTR   @04,@04                                             1529 06210000
         BNZ   @RF01529                                            1529 06211000
*                     DO;                                          1530 06212000
*                       RSVTBENT = ADDR(RSVOLENT);                 1531 06213000
         L     @04,RSIOTBL(,REG6)                                  1531 06214000
         LA    @04,RSVOLENT(,@04)                                  1531 06215000
         ST    @04,RSVTBENT(,REG6)                                 1531 06216000
*                       VOLSERTB = ''B;                            1532 06217000
         XC    VOLSERTB(28,@04),VOLSERTB(@04)                      1532 06218000
*                       IF RESVLBAD = OFF                          1533 06219000
*                         THEN                                     1533 06220000
         L     @15,RSENTPT(,REG6)                                  1533 06221000
         TM    RESVLBAD(@15),B'00010000'                           1533 06222000
         BNZ   @RF01533                                            1533 06223000
*                           DO;                                    1534 06224000
*                             VOLSRCI = RCDCINO;                   1535 06225000
         L     @01,RSGRABCU(,REG6)                                 1535 06226000
         L     @14,GRABCURR(,@01)                                  1535 06227000
         LA    @03,8                                               1535 06228000
         ALR   @03,@14                                             1535 06229000
         L     @02,RCDCINO-1(,@03)                                 1535 06230000
         LA    @02,0(,@02)                                         1535 06231000
         ST    @02,VOLSRCI(,@04)                                   1535 06232000
*                             VOLSRTS = COWNID;                    1536 06233000
         MVC   VOLSRTS(8,@04),COWNID(@03)                          1536 06234000
*                             VOLSRSER = RESVLSER;                 1537 06235000
         MVC   VOLSRSER(6,@04),RESVLSER(@15)                       1537 06236000
*                             VOLSRNTK = RTNOTRKS;                 1538 06237000
*                                                                  1538 06238000
         MVC   VOLSRNTK(2,@04),RTNOTRKS(@14)                       1538 06239000
*                             /* CALL TO MODULE IDCRS05 FOR PROCEDURE B 06240000
*DVLST                                                               */ 06241000
*                             CALL IDCRS5BV(RSVTBENT);             1539 06242000
*                                                                  1539 06243000
         LA    @04,RSVTBENT(,REG6)                                 1539 06244000
         ST    @04,@AL00001                                        1539 06245000
         L     @15,@CV03538                                        1539 06246000
         LA    @01,@AL00001                                        1539 06247000
         BALR  @14,@15                                             1539 06248000
*                           END;                                   1540 06249000
*                                                                  1540 06250000
*                     END;                                         1541 06251000
*                                                                  1541 06252000
@RF01533 DS    0H                                                  1542 06253000
*         /***********************************************************/ 06254000
*         /*                                                         */ 06255000
*         /*    CALL CKERR TO PRINT INFORMATIONAL MESSAGE.           */ 06256000
*         /*                                                         */ 06257000
*         /***********************************************************/ 06258000
*                                                                  1542 06259000
*                 IF RSCAEOV = OFF & RSCREOV = OFF         /*@ZA18274*/ 06260000
*                   THEN                                           1542 06261000
*                                                                  1542 06262000
@RF01529 TM    RSCAEOV(REG6),B'01000010'                           1542 06263000
         BNZ   @RF01542                                            1542 06264000
*                     DO;                                          1543 06265000
*                     /*CALL CKERR*/                               1544 06266000
*                       RSCKERR = RSCKERR && RSCKERR;              1544 06267000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1544 06268000
*                       RSCKERN = RSE080;                          1545 06269000
         MVC   RSCKERN(2,REG6),@CH01048                            1545 06270000
*                       RSCKTERM = 'RETU';                         1546 06271000
         MVC   RSCKTERM(4,REG6),@CC03585                           1546 06272000
*                       RSCKMVAR(1) = ADDR(RESVLSER);              1547 06273000
         L     @04,RSENTPT(,REG6)                                  1547 06274000
         LA    @04,RESVLSER(,@04)                                  1547 06275000
         ST    @04,RSCKMVAR(,REG6)                                 1547 06276000
*                       RSCKMVAR(2) = ADDR(VOLSRTS);               1548 06277000
*                                                                  1548 06278000
         L     @04,RSVTBENT(,REG6)                                 1548 06279000
         LA    @04,VOLSRTS(,@04)                                   1548 06280000
         ST    @04,RSCKMVAR+4(,REG6)                               1548 06281000
*                     /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR  */ 06282000
*                     CALL CKERR;                                  1549 06283000
         L     @15,@CV03544                                        1549 06284000
         BALR  @14,@15                                             1549 06285000
*                     END;                                         1550 06286000
*                                                                  1550 06287000
*                                                                  1550 06288000
*               END PROVOL;                                        1551 06289000
*                                                                  1551 06290000
@RF01542 DS    0H                                                  1552 06291000
*         /***********************************************************/ 06292000
*         /*                                                         */ 06293000
*         /*    RECORD WAS NOT RETRIEVED DUE TO AN I/O ERROR,        */ 06294000
*         /*    RECORD HAS A CIN GREATER THAN THE MAXIMUM CIN,       */ 06295000
*         /*    RECORD IS A FREE RECORD, OR RECORD IS A BAD VOLUME   */ 06296000
*         /*    RECORD. DO NOT MERGE RECORD TO WORKFILE.             */ 06297000
*         /*                                                         */ 06298000
*         /***********************************************************/ 06299000
*                                                                  1552 06300000
*           IF RABIOIGN = ON | RCDID = FREEID |                    1552 06301000
*            (RSCURCI = VOLCI & RESVLBAD = ON) | RCDCINO > MAXCINO 1552 06302000
*             THEN                                                 1552 06303000
@RF01506 L     @04,RSGRABCU(,REG6)                                 1552 06304000
         L     @04,GRABCURR(,@04)                                  1552 06305000
         TM    RABIOIGN(@04),B'00000100'                           1552 06306000
         BO    @RT01552                                            1552 06307000
         CLI   RCDID+8(@04),C'F'                                   1552 06308000
         BE    @RT01552                                            1552 06309000
         CLC   RSCURCI(4,REG6),@CF00040                            1552 06310000
         BNE   @GL00006                                            1552 06311000
         L     @04,RSENTPT(,REG6)                                  1552 06312000
         TM    RESVLBAD(@04),B'00010000'                           1552 06313000
         BO    @RT01552                                            1552 06314000
@GL00006 L     @04,RSGRABCU(,REG6)                                 1552 06315000
         L     @04,GRABCURR(,@04)                                  1552 06316000
         L     @04,RCDCINO+7(,@04)                                 1552 06317000
         LA    @04,0(,@04)                                         1552 06318000
         C     @04,MAXCINO                                         1552 06319000
         BNH   @RF01552                                            1552 06320000
@RT01552 DS    0H                                                  1553 06321000
*               RABIOIGN = OFF;                                    1553 06322000
*                                                                  1553 06323000
         L     @04,RSGRABCU(,REG6)                                 1553 06324000
         L     @04,GRABCURR(,@04)                                  1553 06325000
         NI    RABIOIGN(@04),B'11111011'                           1553 06326000
*         /***********************************************************/ 06327000
*         /*                                                         */ 06328000
*         /*    RECORD WAS RETRIEVED AND IS NOT A FREE RECORD        */ 06329000
*         /*    OR A BAD VOLUME RECORD. COPY IT TO THE WORKFILE.     */ 06330000
*         /*                                                         */ 06331000
*         /***********************************************************/ 06332000
*                                                                  1554 06333000
*             ELSE                                                 1554 06334000
*PROMRG:        DO;                                                1554 06335000
*                                                                  1554 06336000
         B     @RC01552                                            1554 06337000
@RF01552 DS    0H                                                  1554 06338000
PROMRG   DS    0H                                                  1555 06339000
*         /***********************************************************/ 06340000
*         /*                                                         */ 06341000
*         /*  SET CURRENT GRAB POINTER FOR WORKFILE GRABS.           */ 06342000
*         /*  SET GRAB FLAGS FOR SPECIAL CI TO RRN TRANSLATION       */ 06343000
*         /*  PROCESSING AND FOR SPECIAL NO RECORD FOUND PROCESSING. */ 06344000
*         /*  RETRIEVE WORKFILE CATALOG CI RECORD.                   */ 06345000
*         /*                                                         */ 06346000
*         /***********************************************************/ 06347000
*                                                                  1555 06348000
*                 RSGRABCU = ADDR(GRABSWF);                        1555 06349000
         L     @04,RSIOTBL(,REG6)                                  1555 06350000
         ST    @04,RSGRABCU(,REG6)                                 1555 06351000
*                 GRABAFLS = ''B;                                  1556 06352000
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       1556 06353000
*                 GRABSFXT = ON;                                   1557 06354000
*                 GRABSNRA = ON;                                   1558 06355000
*                 GRABSEFN = ON;                                   1559 06356000
         OI    GRABSFXT(@04),B'11100000'                           1559 06357000
*                 GRABCURR = GRABRAB1;                             1560 06358000
         L     @15,GRABRAB1(,@04)                                  1560 06359000
         ST    @15,GRABCURR(,@04)                                  1560 06360000
*                 RABRCDA =                                        1561 06361000
*                   ADDR(ADDR(GRABSCR) -> GRABCURR -> RABBUF)      1561 06362000
*                     -> RCDCINO;                                  1561 06363000
*                                                                  1561 06364000
         L     @04,GRABCURR+80(,@04)                               1561 06365000
         L     @04,RCDCINO+7(,@04)                                 1561 06366000
         LA    @04,0(,@04)                                         1561 06367000
         ST    @04,RABRCDA(,@15)                                   1561 06368000
*         /***********************************************************/ 06369000
*         /*                                                         */ 06370000
*         /*    READ WORKFILE RECORD VIA RECMGMT.                    */ 06371000
*         /*                                                         */ 06372000
*         /***********************************************************/ 06373000
*                                                                  1562 06374000
*                                                                  1562 06375000
*                 DO;                                              1562 06376000
*                   RSRTYPE = ''B;                                 1563 06377000
         MVI   RSRTYPE(REG6),X'00'                                 1563 06378000
*                   RSRGET = ON;      /* GETRCD  */                1564 06379000
         OI    RSRGET(REG6),B'10000000'                            1564 06380000
*                   RSRUPD = ON;      /* UPDATE  */                1565 06381000
         OI    RSRUPD(REG6),B'00001000'                            1565 06382000
*                   RSRDS = ''B;                                   1566 06383000
         NI    RSRDS(REG6),B'00011111'                             1566 06384000
*                   RSRWF = ON;       /* WORKFILE  */              1567 06385000
*                   RSRDIR = ON;      /* DIRECT  */                1568 06386000
*                   RSRKEY = ON;      /* KEY  */                   1569 06387000
*                                                                  1569 06388000
         OI    RSRWF(REG6),B'10010100'                             1569 06389000
*                 /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT    */ 06390000
*                 CALL RECMGMT;                                    1570 06391000
         L     @15,@CV03498                                        1570 06392000
         BALR  @14,@15                                             1570 06393000
*                   RFY RTNREG RSTD;                               1571 06394000
*                   TESTRC = RTNREG;                               1572 06395000
         STH   RTNREG,TESTRC(,REG6)                                1572 06396000
*                   RFY RTNREG UNRSTD;                             1573 06397000
*                 END;                                             1574 06398000
*                                                                  1574 06399000
*         /***********************************************************/ 06400000
*         /*                                                         */ 06401000
*         /*    IF RECORD WAS NOT FOUND, MARK IT AS INVALID.         */ 06402000
*         /*                                                         */ 06403000
*         /***********************************************************/ 06404000
*                                                                  1575 06405000
*               IF RABADD = ON                                     1575 06406000
*                 THEN                                             1575 06407000
         L     @04,RSGRABCU(,REG6)                                 1575 06408000
         L     @04,GRABCURR(,@04)                                  1575 06409000
         TM    RABADD(@04),B'00100000'                             1575 06410000
         BNO   @RF01575                                            1575 06411000
*                   RSWINVCI = ON;                                 1576 06412000
*                                                                  1576 06413000
         OI    RSWINVCI(@04),B'10000000'                           1576 06414000
*         /***********************************************************/ 06415000
*         /*                                                         */ 06416000
*         /*    ENSURE THAT CRA CI IS CORRECT.                       */ 06417000
*         /*                                                         */ 06418000
*         /***********************************************************/ 06419000
*                                                                  1577 06420000
*                 RSGRABCU = ADDR(GRABSCR);                        1577 06421000
@RF01575 L     @04,RSIOTBL(,REG6)                                  1577 06422000
         LA    @04,GRABSCR(,@04)                                   1577 06423000
         ST    @04,RSGRABCU(,REG6)                                 1577 06424000
*                 IF RCDCRACI ^= RABRCDA                           1578 06425000
*                   THEN                                           1578 06426000
         L     @04,GRABCURR(,@04)                                  1578 06427000
         LA    @15,8                                               1578 06428000
         ALR   @15,@04                                             1578 06429000
         L     @04,RABRCDA(,@04)                                   1578 06430000
         SLR   @14,@14                                             1578 06431000
         ICM   @14,7,RCDCRACI(@15)                                 1578 06432000
         CR    @04,@14                                             1578 06433000
         BE    @RF01578                                            1578 06434000
*                     DO;                                          1579 06435000
*                       RCDCRACI = RABRCDA;                        1580 06436000
*                                                                  1580 06437000
         STCM  @04,7,RCDCRACI(@15)                                 1580 06438000
*                       /* CALL TO MODULE IDCRS05 FOR PROCEDURE ADDUPCR 06439000
*                                                                    */ 06440000
*                       CALL ADDUPCR;                              1581 06441000
*                                                                  1581 06442000
         L     @15,@CV03636                                        1581 06443000
         BALR  @14,@15                                             1581 06444000
*                     END;                                         1582 06445000
*                                                                  1582 06446000
*                                                                  1582 06447000
*         /***********************************************************/ 06448000
*         /*                                                         */ 06449000
*         /*    WORKFILE CATALOG CI RECORD HAS ALREADY BEEN          */ 06450000
*         /*    REPLACED FROM A CRA OR IS NOT AVAILABLE FOR          */ 06451000
*         /*    REPLACEMENT.                                         */ 06452000
*         /*                                                         */ 06453000
*         /***********************************************************/ 06454000
*                                                                  1583 06455000
*                 RSGRABCU = ADDR(GRABSWF);                        1583 06456000
@RF01578 L     @04,RSIOTBL(,REG6)                                  1583 06457000
         ST    @04,RSGRABCU(,REG6)                                 1583 06458000
*                 IF RSWFCRA = ON | (RSWINVCI = OFF &              1584 06459000
*                    RCDID ^= FREEID & RSWDLCAT = OFF)             1584 06460000
*                   THEN                                           1584 06461000
         L     @04,GRABCURR(,@04)                                  1584 06462000
         TM    RSWFCRA(@04),B'10000000'                            1584 06463000
         BO    @RT01584                                            1584 06464000
         TM    RSWINVCI(@04),B'10000000'                           1584 06465000
         BNZ   @RF01584                                            1584 06466000
         CLI   RCDID+8(@04),C'F'                                   1584 06467000
         BE    @RF01584                                            1584 06468000
         TM    RSWDLCAT(@04),B'01000000'                           1584 06469000
         BNZ   @RF01584                                            1584 06470000
@RT01584 DS    0H                                                  1585 06471000
*PRODUP:              DO;                                          1585 06472000
*                                                                  1585 06473000
PRODUP   DS    0H                                                  1586 06474000
*         /***********************************************************/ 06475000
*         /*                                                         */ 06476000
*         /*    PROCESS DUPLICATE RECORD. SET CURRENT WORKFILE       */ 06477000
*         /*    RAB POINTER TO OVERFLOW RAB.                         */ 06478000
*         /*                                                         */ 06479000
*         /***********************************************************/ 06480000
*                                                                  1586 06481000
*                       GRABCURR = GRABRAB2;                       1586 06482000
*                                                                  1586 06483000
         L     @04,RSGRABCU(,REG6)                                 1586 06484000
         L     @15,GRABRAB2(,@04)                                  1586 06485000
         ST    @15,GRABCURR(,@04)                                  1586 06486000
*         /***********************************************************/ 06487000
*         /*                                                         */ 06488000
*         /*    ASSIGN AN OVERFLOW RELATIVE RECORD NUMBER.           */ 06489000
*         /*                                                         */ 06490000
*         /***********************************************************/ 06491000
*                                                                  1587 06492000
*                       RABRCDA = RSWFNEXT;                        1587 06493000
         L     @14,RSWFNEXT(,REG6)                                 1587 06494000
         ST    @14,RABRCDA(,@15)                                   1587 06495000
*                       RABRRN = ON;                               1588 06496000
         OI    RABRRN(@15),B'00010000'                             1588 06497000
*                       RSWFNEXT = RSWFNEXT + 1;                   1589 06498000
*                                                                  1589 06499000
         AL    @14,@CF00219                                        1589 06500000
         ST    @14,RSWFNEXT(,REG6)                                 1589 06501000
*         /***********************************************************/ 06502000
*         /*                                                         */ 06503000
*         /*    MOVE THE CRA RECORD TO THE WORKFILE OVERFLOW         */ 06504000
*         /*    BUFFER.                                              */ 06505000
*         /*                                                         */ 06506000
*         /***********************************************************/ 06507000
*                                                                  1590 06508000
*                       WFBUF2(1:256) = CRBUF1(1:256);             1590 06509000
         L     @14,RSWFBP2(,REG6)                                  1590 06510000
         L     @03,RSCRBP1(,REG6)                                  1590 06511000
         MVC   WFBUF2(256,@14),CRBUF1(@03)                         1590 06512000
*                       WFBUF2(257:CELEN) = CRBUF1(257:CELEN);     1591 06513000
*                                                                  1591 06514000
         MVC   WFBUF2+256(249,@14),CRBUF1+256(@03)                 1591 06515000
*         /***********************************************************/ 06516000
*         /*                                                         */ 06517000
*         /*    SET REPLACED FROM CRA FLAG AND SAVE DUPLICATE        */ 06518000
*         /*    CHAIN POINTER IN WORKFILE OVERFLOW PROCESSING AREA.  */ 06519000
*         /*                                                         */ 06520000
*         /***********************************************************/ 06521000
*                                                                  1592 06522000
*                       RSWFLD = ''B;                              1592 06523000
         XC    RSWFLD(10,@15),RSWFLD(@15)                          1592 06524000
*                       RSWFCRA = ON;                              1593 06525000
         OI    RSWFCRA(@15),B'10000000'                            1593 06526000
*                       IF GRABRAB1 -> RSWDUPTR ^= 0               1594 06527000
*                         THEN                                     1594 06528000
         L     @04,GRABRAB1(,@04)                                  1594 06529000
         L     @04,RSWDUPTR(,@04)                                  1594 06530000
         LTR   @04,@04                                             1594 06531000
         BZ    @RF01594                                            1594 06532000
*                           DO;                                    1595 06533000
*                             RSWDUPTR = GRABRAB1 -> RSWDUPTR;     1596 06534000
         ST    @04,RSWDUPTR(,@15)                                  1596 06535000
*                             RSWDUPRR = ON;                       1597 06536000
         OI    RSWDUPRR(@15),B'01000000'                           1597 06537000
*                           END;                                   1598 06538000
*                                                                  1598 06539000
*         /***********************************************************/ 06540000
*         /*                                                 @ZA18274*/ 06541000
*         /*    IF RECORD SHOULD BE MOVED FROM OLD CATALOG'S @ZA18274*/ 06542000
*         /*     CRA TO NEW CATALOG'S CRA, THEN SET MOVE TO  @ZA18274*/ 06543000
*         /*     NEW CRA FLAG AND INCREMENT COUNT OF RECORDS @ZA18274*/ 06544000
*         /*     TO BE MOVED.                                @ZA18274*/ 06545000
*         /*                                                 @ZA18274*/ 06546000
*         /***********************************************************/ 06547000
*                                                                  1599 06548000
*                       RSGRABCU = ADDR(GRABSCR);          /*@ZA18274*/ 06549000
@RF01594 L     @04,RSIOTBL(,REG6)                                  1599 06550000
         LA    @04,GRABSCR(,@04)                                   1599 06551000
         ST    @04,RSGRABCU(,REG6)                                 1599 06552000
*                       IF (RCDID = NVID | RCDID = GDGID |         1600 06553000
*                           RCDID = UCATID | RCDID = ALIASID)      1600 06554000
*                            & (RCDCRAVL ^= RSINVLSR)              1600 06555000
*                         THEN DO;                         /*@ZA18274*/ 06556000
         LA    @15,8                                               1600 06557000
         AL    @15,GRABCURR(,@04)                                  1600 06558000
         CLI   RCDID(@15),C'A'                                     1600 06559000
         BE    @GL00013                                            1600 06560000
         CLI   RCDID(@15),C'B'                                     1600 06561000
         BE    @GL00013                                            1600 06562000
         CLI   RCDID(@15),C'U'                                     1600 06563000
         BE    @GL00013                                            1600 06564000
         CLI   RCDID(@15),C'X'                                     1600 06565000
         BNE   @RF01600                                            1600 06566000
@GL00013 L     @04,RSGRABCU(,REG6)                                 1600 06567000
         L     @04,GRABCURR(,@04)                                  1600 06568000
         CLC   RCDCRAVL+8(6,@04),RSINVLSR(REG6)                    1600 06569000
         BE    @RF01600                                            1600 06570000
*                           RSGRABCU = ADDR(GRABSWF);      /*@ZA18274*/ 06571000
         L     @04,RSIOTBL(,REG6)                                  1602 06572000
         ST    @04,RSGRABCU(,REG6)                                 1602 06573000
*                           RSWCHRA = ON;                  /*@ZA18274*/ 06574000
         L     @04,GRABCURR(,@04)                                  1603 06575000
         OI    RSWCHRA(@04),B'00000010'                            1603 06576000
*                           RSCHCRAN = RSCHCRAN + 1;       /*@ZA18274*/ 06577000
         LA    @04,1                                               1604 06578000
         AL    @04,RSCHCRAN(,REG6)                                 1604 06579000
         ST    @04,RSCHCRAN(,REG6)                                 1604 06580000
*                         END;                             /*@ZA18274*/ 06581000
*                       RSGRABCU = ADDR(GRABSWF);          /*@ZA18274*/ 06582000
*                                                                  1606 06583000
@RF01600 L     @04,RSIOTBL(,REG6)                                  1606 06584000
         ST    @04,RSGRABCU(,REG6)                                 1606 06585000
*         /***********************************************************/ 06586000
*         /*                                                         */ 06587000
*         /*    PLACE OVERFLOW RECORD ON THE REASSIGN CHAIN.         */ 06588000
*         /*                                                         */ 06589000
*         /***********************************************************/ 06590000
*                                                                  1607 06591000
*                       RSWCHPTR = RSREASS;                        1607 06592000
         L     @04,GRABCURR(,@04)                                  1607 06593000
         L     @15,RSREASS(,REG6)                                  1607 06594000
         ST    @15,RSWCHPTR(,@04)                                  1607 06595000
*                       IF RSREARR = ON                            1608 06596000
*                         THEN                                     1608 06597000
         TM    RSREARR(REG6),B'10000000'                           1608 06598000
         BNO   @RF01608                                            1608 06599000
*                           RSWCHNRR = ON;                         1609 06600000
         OI    RSWCHNRR(@04),B'00000100'                           1609 06601000
*                       RSREASS = RABRCDA;                         1610 06602000
@RF01608 L     @04,RSGRABCU(,REG6)                                 1610 06603000
         L     @01,GRABCURR(,@04)                                  1610 06604000
         L     @15,RABRCDA(,@01)                                   1610 06605000
         ST    @15,RSREASS(,REG6)                                  1610 06606000
*                       RSREASSN = RSREASSN + 1;                   1611 06607000
         LA    @15,1                                               1611 06608000
         AL    @15,RSREASSN(,REG6)                                 1611 06609000
         ST    @15,RSREASSN(,REG6)                                 1611 06610000
*                       RSREARR = ON;                              1612 06611000
*                                                                  1612 06612000
         OI    RSREARR(REG6),B'10000000'                           1612 06613000
*         /***********************************************************/ 06614000
*         /*                                                         */ 06615000
*         /*    WRITE OVERFLOW RECORD TO WORKFILE VIA RECMGMT.       */ 06616000
*         /*                                                         */ 06617000
*         /***********************************************************/ 06618000
*                                                                  1613 06619000
*                       GRABAFLS = ''B;                            1613 06620000
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       1613 06621000
*                       GRABSNRA = ON;                             1614 06622000
*                       GRABSEFN = ON;                             1615 06623000
*                                                                  1615 06624000
*                                                                  1615 06625000
         OI    GRABSNRA(@04),B'01100000'                           1615 06626000
*                       DO;                                        1616 06627000
*                         RSRTYPE = ''B;                           1617 06628000
         MVI   RSRTYPE(REG6),X'00'                                 1617 06629000
*                         RSRUPDT = ON;     /* UPDRCD  */          1618 06630000
         OI    RSRUPDT(REG6),B'00100000'                           1618 06631000
*                         RSRUPD = ON;      /* UPDATE  */          1619 06632000
         OI    RSRUPD(REG6),B'00001000'                            1619 06633000
*                         RSRDS = ''B;                             1620 06634000
         NI    RSRDS(REG6),B'00011111'                             1620 06635000
*                         RSRWF = ON;       /* WORKFILE  */        1621 06636000
*                         RSRDIR = ON;      /* DIRECT  */          1622 06637000
*                         RSRKEY = ON;      /* KEY  */             1623 06638000
*                                                                  1623 06639000
         OI    RSRWF(REG6),B'10010100'                             1623 06640000
*                       /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT 06641000
*                                                                    */ 06642000
*                       CALL RECMGMT;                              1624 06643000
         L     @15,@CV03498                                        1624 06644000
         BALR  @14,@15                                             1624 06645000
*                         RFY RTNREG RSTD;                         1625 06646000
*                         TESTRC = RTNREG;                         1626 06647000
         STH   RTNREG,TESTRC(,REG6)                                1626 06648000
*                         RFY RTNREG UNRSTD;                       1627 06649000
*                       END;                                       1628 06650000
*                                                                  1628 06651000
*                       GRABAFLS = ''B;                            1629 06652000
         L     @04,RSGRABCU(,REG6)                                 1629 06653000
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       1629 06654000
*                       RABRRN = OFF;                              1630 06655000
*                                                                  1630 06656000
         L     @01,GRABCURR(,@04)                                  1630 06657000
         NI    RABRRN(@01),B'11101111'                             1630 06658000
*         /***********************************************************/ 06659000
*         /*                                                         */ 06660000
*         /*    SET CURRENT WORKFILE RAB POINTER TO WORKFILE         */ 06661000
*         /*    CATALOG CI RAB.                                      */ 06662000
*         /*    SET DUPLICATE EXISTS FLAG AND DUPLICATE CHAIN        */ 06663000
*         /*    POINTER IN WORKFILE CATALOG CI RECORD.               */ 06664000
*         /*                                                         */ 06665000
*         /***********************************************************/ 06666000
*                                                                  1631 06667000
*                       GRABCURR = GRABRAB1;                       1631 06668000
         L     @15,GRABRAB1(,@04)                                  1631 06669000
         ST    @15,GRABCURR(,@04)                                  1631 06670000
*                       RSWDUPCI = ON;                             1632 06671000
         OI    RSWDUPCI(@15),B'00000001'                           1632 06672000
*                       RSWDUPRR = ON;                             1633 06673000
         OI    RSWDUPRR(@15),B'01000000'                           1633 06674000
*                       RSWDUPTR = GRABRAB2 -> RABRCDA;            1634 06675000
*                                                                  1634 06676000
         L     @04,GRABRAB2(,@04)                                  1634 06677000
         L     @04,RABRCDA(,@04)                                   1634 06678000
         ST    @04,RSWDUPTR(,@15)                                  1634 06679000
*                     END PRODUP;                                  1635 06680000
*                                                                  1635 06681000
*         /***********************************************************/ 06682000
*         /*                                                         */ 06683000
*         /*  WORKFILE CATALOG CI RECORD IS AVAILABLE FOR            */ 06684000
*         /*  REPLACEMENT.                                           */ 06685000
*         /*                                                         */ 06686000
*         /***********************************************************/ 06687000
*                                                                  1636 06688000
*                   ELSE                                           1636 06689000
*PRONDUP:             DO;                                          1636 06690000
*                                                                  1636 06691000
         B     @RC01584                                            1636 06692000
@RF01584 DS    0H                                                  1636 06693000
PRONDUP  DS    0H                                                  1637 06694000
*         /***********************************************************/ 06695000
*         /*                                                         */ 06696000
*         /*    MOVE CRA RECORD TO WORKFILE CATALOG CI BUFFER.       */ 06697000
*         /*    SET REPLACED FROM CRA FLAG IN WORKFILE CATALOG CI    */ 06698000
*         /*    PROCESSING FIELD.                                    */ 06699000
*         /*                                                         */ 06700000
*         /***********************************************************/ 06701000
*                                                                  1637 06702000
*                       WFBUF1(1:256) = CRBUF1(1:256);             1637 06703000
         L     @04,RSWFBP1(,REG6)                                  1637 06704000
         L     @15,RSCRBP1(,REG6)                                  1637 06705000
         MVC   WFBUF1(256,@04),CRBUF1(@15)                         1637 06706000
*                       WFBUF1(257:CELEN) = CRBUF1(257:CELEN);     1638 06707000
         MVC   WFBUF1+256(249,@04),CRBUF1+256(@15)                 1638 06708000
*                       RSWFCRA = ON;                              1639 06709000
*                       RSWDLCAT = OFF;                            1640 06710000
*                                                                  1640 06711000
         L     @04,RSGRABCU(,REG6)                                 1640 06712000
         L     @04,GRABCURR(,@04)                                  1640 06713000
         OI    RSWFCRA(@04),B'10000000'                            1640 06714000
         NI    RSWDLCAT(@04),B'10111111'                           1640 06715000
*         /***********************************************************/ 06716000
*         /*                                                 @ZA18274*/ 06717000
*         /*    IF RECORD SHOULD BE MOVED FROM OLD CATALOG'S @ZA18274*/ 06718000
*         /*     CRA TO NEW CATALOG'S CRA, THEN SET MOVE TO  @ZA18274*/ 06719000
*         /*     NEW CRA FLAG AND INCREMENT COUNT OF RECORDS @ZA18274*/ 06720000
*         /*     TO BE MOVED.                                @ZA18274*/ 06721000
*         /*                                                 @ZA18274*/ 06722000
*         /***********************************************************/ 06723000
*                                                                  1641 06724000
*                       RSGRABCU = ADDR(GRABSCR);          /*@ZA18274*/ 06725000
         L     @04,RSIOTBL(,REG6)                                  1641 06726000
         LA    @04,GRABSCR(,@04)                                   1641 06727000
         ST    @04,RSGRABCU(,REG6)                                 1641 06728000
*                       IF (RCDID = NVID | RCDID = GDGID |         1642 06729000
*                           RCDID = UCATID | RCDID = ALIASID)      1642 06730000
*                            & (RCDCRAVL ^= RSINVLSR)              1642 06731000
*                         THEN DO;                         /*@ZA18274*/ 06732000
         LA    @15,8                                               1642 06733000
         AL    @15,GRABCURR(,@04)                                  1642 06734000
         CLI   RCDID(@15),C'A'                                     1642 06735000
         BE    @GL00017                                            1642 06736000
         CLI   RCDID(@15),C'B'                                     1642 06737000
         BE    @GL00017                                            1642 06738000
         CLI   RCDID(@15),C'U'                                     1642 06739000
         BE    @GL00017                                            1642 06740000
         CLI   RCDID(@15),C'X'                                     1642 06741000
         BNE   @RF01642                                            1642 06742000
@GL00017 L     @04,RSGRABCU(,REG6)                                 1642 06743000
         L     @04,GRABCURR(,@04)                                  1642 06744000
         CLC   RCDCRAVL+8(6,@04),RSINVLSR(REG6)                    1642 06745000
         BE    @RF01642                                            1642 06746000
*                           RSGRABCU = ADDR(GRABSWF);      /*@ZA18274*/ 06747000
         L     @04,RSIOTBL(,REG6)                                  1644 06748000
         ST    @04,RSGRABCU(,REG6)                                 1644 06749000
*                           RSWCHRA = ON;                  /*@ZA18274*/ 06750000
         L     @04,GRABCURR(,@04)                                  1645 06751000
         OI    RSWCHRA(@04),B'00000010'                            1645 06752000
*                           RSCHCRAN = RSCHCRAN + 1;       /*@ZA18274*/ 06753000
         LA    @04,1                                               1646 06754000
         AL    @04,RSCHCRAN(,REG6)                                 1646 06755000
         ST    @04,RSCHCRAN(,REG6)                                 1646 06756000
*                         END;                             /*@ZA18274*/ 06757000
*                       RSGRABCU = ADDR(GRABSWF);          /*@ZA18274*/ 06758000
*                                                                  1648 06759000
@RF01642 L     @04,RSIOTBL(,REG6)                                  1648 06760000
         ST    @04,RSGRABCU(,REG6)                                 1648 06761000
*         /***********************************************************/ 06762000
*         /*                                                         */ 06763000
*         /*    REPLACE INVALID WORKFILE RECORD.                     */ 06764000
*         /*                                                         */ 06765000
*         /***********************************************************/ 06766000
*                                                                  1649 06767000
*                       IF RSWINVCI = ON                           1649 06768000
*                         THEN                                     1649 06769000
         L     @04,GRABCURR(,@04)                                  1649 06770000
         TM    RSWINVCI(@04),B'10000000'                           1649 06771000
         BNO   @RF01649                                            1649 06772000
*PROINV:                    DO;                                    1650 06773000
*                                                                  1650 06774000
PROINV   DS    0H                                                  1651 06775000
*         /***********************************************************/ 06776000
*         /*                                                         */ 06777000
*         /*    PLACE RECORD ON REASSIGN CHAIN.                      */ 06778000
*         /*                                                         */ 06779000
*         /***********************************************************/ 06780000
*                                                                  1651 06781000
*                             RSWCHPTR = RSREASS;                  1651 06782000
         L     @04,RSGRABCU(,REG6)                                 1651 06783000
         L     @04,GRABCURR(,@04)                                  1651 06784000
         L     @15,RSREASS(,REG6)                                  1651 06785000
         ST    @15,RSWCHPTR(,@04)                                  1651 06786000
*                             IF RSREARR = ON                      1652 06787000
*                               THEN                               1652 06788000
         TM    RSREARR(REG6),B'10000000'                           1652 06789000
         BNO   @RF01652                                            1652 06790000
*                                 RSWCHNRR = ON;                   1653 06791000
         OI    RSWCHNRR(@04),B'00000100'                           1653 06792000
*                               ELSE                               1654 06793000
*                                 RSWCHNRR = OFF;                  1654 06794000
         B     @RC01652                                            1654 06795000
@RF01652 L     @04,RSGRABCU(,REG6)                                 1654 06796000
         L     @04,GRABCURR(,@04)                                  1654 06797000
         NI    RSWCHNRR(@04),B'11111011'                           1654 06798000
*                             RSREARR = OFF;                       1655 06799000
@RC01652 NI    RSREARR(REG6),B'01111111'                           1655 06800000
*                             RSREASS = RCDCINO;                   1656 06801000
         L     @04,RSGRABCU(,REG6)                                 1656 06802000
         L     @04,GRABCURR(,@04)                                  1656 06803000
         L     @04,RCDCINO+7(,@04)                                 1656 06804000
         LA    @04,0(,@04)                                         1656 06805000
         ST    @04,RSREASS(,REG6)                                  1656 06806000
*                             RSREASSN = RSREASSN + 1;             1657 06807000
*                                                                  1657 06808000
         LA    @04,1                                               1657 06809000
         AL    @04,RSREASSN(,REG6)                                 1657 06810000
         ST    @04,RSREASSN(,REG6)                                 1657 06811000
*                           END PROINV;                            1658 06812000
*                                                                  1658 06813000
*         /***********************************************************/ 06814000
*         /*                                                         */ 06815000
*         /*  REPLACE AVAILABLE WORKFILE RECORD. RECORD IS FREE      */ 06816000
*         /*  OR BELONGS TO A CRA TO BE RESET.                       */ 06817000
*         /*                                                         */ 06818000
*         /***********************************************************/ 06819000
*                                                                  1659 06820000
*                         ELSE                                     1659 06821000
*PROAVL:                    DO;                                    1659 06822000
*                                                                  1659 06823000
         B     @RC01649                                            1659 06824000
@RF01649 DS    0H                                                  1659 06825000
PROAVL   DS    0H                                                  1660 06826000
*         /***********************************************************/ 06827000
*         /*                                                         */ 06828000
*         /*    DECREMENT AVAILABLE COUNT AND SET UPDATE CATALOG     */ 06829000
*         /*    FLAG IN WORKFILE CATALOG CI PROCESSING FIELD.        */ 06830000
*         /*                                                         */ 06831000
*         /***********************************************************/ 06832000
*                                                                  1660 06833000
*                             RSAVAILN = RSAVAILN - 1;             1660 06834000
         L     @04,RSAVAILN(,REG6)                                 1660 06835000
         BCTR  @04,0                                               1660 06836000
         ST    @04,RSAVAILN(,REG6)                                 1660 06837000
*                             RSWUPCAT = ON;                       1661 06838000
*                                                                  1661 06839000
         L     @04,RSGRABCU(,REG6)                                 1661 06840000
         L     @04,GRABCURR(,@04)                                  1661 06841000
         OI    RSWUPCAT(@04),B'00100000'                           1661 06842000
*                           END PROAVL;                            1662 06843000
*                                                                  1662 06844000
*                     END PRONDUP;                                 1663 06845000
*                                                                  1663 06846000
@RC01649 DS    0H                                                  1664 06847000
*         /***********************************************************/ 06848000
*         /*                                                         */ 06849000
*         /*  ADD/UPDATE WORKFILE CATALOG CI RECORD VIA RECMGMT.     */ 06850000
*         /*                                                         */ 06851000
*         /***********************************************************/ 06852000
*                                                                  1664 06853000
*               IF RABADD = ON                                     1664 06854000
*                 THEN                                             1664 06855000
@RC01584 L     @04,RSGRABCU(,REG6)                                 1664 06856000
         L     @04,GRABCURR(,@04)                                  1664 06857000
         TM    RABADD(@04),B'00100000'                             1664 06858000
         BNO   @RF01664                                            1664 06859000
*                   DO;                                            1665 06860000
*                     RABADD = OFF;                                1666 06861000
*                                                                  1666 06862000
*                                                                  1666 06863000
         NI    RABADD(@04),B'11011111'                             1666 06864000
*                     DO;                                          1667 06865000
*                       RSRTYPE = ''B;                             1668 06866000
         MVI   RSRTYPE(REG6),X'00'                                 1668 06867000
*                       RSRADD = ON;      /* ADDRCD  */            1669 06868000
         OI    RSRADD(REG6),B'01000000'                            1669 06869000
*                       RSRUPD = OFF;     /* NO UPDATE  */         1670 06870000
         NI    RSRUPD(REG6),B'11110111'                            1670 06871000
*                       RSRDS = ''B;                               1671 06872000
         NI    RSRDS(REG6),B'00011111'                             1671 06873000
*                       RSRWF = ON;       /* WORKFILE  */          1672 06874000
*                       RSRDIR = ON;      /* DIRECT  */            1673 06875000
*                       RSRKEY = ON;      /* KEY  */               1674 06876000
*                                                                  1674 06877000
         OI    RSRWF(REG6),B'10010100'                             1674 06878000
*                     /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT*/ 06879000
*                     CALL RECMGMT;                                1675 06880000
         L     @15,@CV03498                                        1675 06881000
         BALR  @14,@15                                             1675 06882000
*                       RFY RTNREG RSTD;                           1676 06883000
*                       TESTRC = RTNREG;                           1677 06884000
         STH   RTNREG,TESTRC(,REG6)                                1677 06885000
*                       RFY RTNREG UNRSTD;                         1678 06886000
*                     END;                                         1679 06887000
*                                                                  1679 06888000
*                   END;                                           1680 06889000
*                 ELSE                                             1681 06890000
*                                                                  1681 06891000
*                                                                  1681 06892000
*                   DO;                                            1681 06893000
         B     @RC01664                                            1681 06894000
@RF01664 DS    0H                                                  1682 06895000
*                     RSRTYPE = ''B;                               1682 06896000
         MVI   RSRTYPE(REG6),X'00'                                 1682 06897000
*                     RSRUPDT = ON;     /* UPDRCD  */              1683 06898000
         OI    RSRUPDT(REG6),B'00100000'                           1683 06899000
*                     RSRUPD = ON;      /* UPDATE  */              1684 06900000
         OI    RSRUPD(REG6),B'00001000'                            1684 06901000
*                     RSRDS = ''B;                                 1685 06902000
         NI    RSRDS(REG6),B'00011111'                             1685 06903000
*                     RSRWF = ON;       /* WORKFILE  */            1686 06904000
*                     RSRDIR = ON;      /* DIRECT  */              1687 06905000
*                     RSRKEY = ON;      /* KEY  */                 1688 06906000
*                                                                  1688 06907000
         OI    RSRWF(REG6),B'10010100'                             1688 06908000
*                   /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT  */ 06909000
*                   CALL RECMGMT;                                  1689 06910000
         L     @15,@CV03498                                        1689 06911000
         BALR  @14,@15                                             1689 06912000
*                     RFY RTNREG RSTD;                             1690 06913000
*                     TESTRC = RTNREG;                             1691 06914000
         STH   RTNREG,TESTRC(,REG6)                                1691 06915000
*                     RFY RTNREG UNRSTD;                           1692 06916000
*                   END;                                           1693 06917000
*                                                                  1693 06918000
*               END PROMRG;                                        1694 06919000
*                                                                  1694 06920000
@RC01664 DS    0H                                                  1695 06921000
*         END PROLP1;                                              1695 06922000
*                                                                  1695 06923000
@RC01552 LA    @04,1                                               1695 06924000
         AL    @04,RSCURCI(,REG6)                                  1695 06925000
@DE01490 ST    @04,RSCURCI(,REG6)                                  1695 06926000
         C     @04,RSCREND(,REG6)                                  1695 06927000
         BNH   @DL01490                                            1695 06928000
*         /***********************************************************/ 06929000
*         /*                                                         */ 06930000
*         /*  EXTRACT CRA EXTENT INFORMATION.                        */ 06931000
*         /*                                                         */ 06932000
*         /***********************************************************/ 06933000
*                                                                  1696 06934000
*         /***********************************************************/ 06935000
*         /*                                                         */ 06936000
*         /*    READ CRA DATA RECORD VIA RECMGMT.                    */ 06937000
*         /*                                                         */ 06938000
*         /***********************************************************/ 06939000
*                                                                  1696 06940000
*         RSGRABCU = ADDR(GRABSCR);                                1696 06941000
         L     @04,RSIOTBL(,REG6)                                  1696 06942000
         LA    @04,GRABSCR(,@04)                                   1696 06943000
         ST    @04,RSGRABCU(,REG6)                                 1696 06944000
*         RABRCDA = DATACI;                                        1697 06945000
*                                                                  1697 06946000
*                                                                  1697 06947000
         L     @04,GRABCURR(,@04)                                  1697 06948000
         SLR   @15,@15                                             1697 06949000
         ST    @15,RABRCDA(,@04)                                   1697 06950000
*         DO;                                                      1698 06951000
*           RSRTYPE = ''B;                                         1699 06952000
         MVI   RSRTYPE(REG6),X'00'                                 1699 06953000
*           RSRGET = ON;      /* GETRCD  */                        1700 06954000
         OI    RSRGET(REG6),B'10000000'                            1700 06955000
*           RSRUPD = OFF;     /* NO UPDATE  */                     1701 06956000
         NI    RSRUPD(REG6),B'11110111'                            1701 06957000
*           RSRDS = ''B;                                           1702 06958000
         NI    RSRDS(REG6),B'00011111'                             1702 06959000
*           RSRCRA = ON;      /* CRA  */                           1703 06960000
*           RSRDIR = ON;      /* DIRECT  */                        1704 06961000
*           RSRKEY = OFF;     /* CNV  */                           1705 06962000
*                                                                  1705 06963000
         OI    RSRCRA(REG6),B'00100100'                            1705 06964000
         NI    RSRKEY(REG6),B'11101111'                            1705 06965000
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */ 06966000
*         CALL RECMGMT;                                            1706 06967000
         L     @15,@CV03498                                        1706 06968000
         BALR  @14,@15                                             1706 06969000
*           RFY RTNREG RSTD;                                       1707 06970000
*           TESTRC = RTNREG;                                       1708 06971000
         STH   RTNREG,TESTRC(,REG6)                                1708 06972000
*           RFY RTNREG UNRSTD;                                     1709 06973000
*         END;                                                     1710 06974000
*                                                                  1710 06975000
*         /***********************************************************/ 06976000
*         /*                                                         */ 06977000
*         /*    EXTRACT CRA EXTENTS VIA FINDALL AND SAVE IN RESVOL.  */ 06978000
*         /*                                                         */ 06979000
*         /***********************************************************/ 06980000
*                                                                  1711 06981000
*                                                                  1711 06982000
*         DO;                                                      1711 06983000
*           GRABBB = GRABCURR;                                     1712 06984000
         L     @04,RSGRABCU(,REG6)                                 1712 06985000
         L     @15,GRABCURR(,@04)                                  1712 06986000
         ST    @15,GRABBB(,@04)                                    1712 06987000
*           RSWGCODE = GCVOLGO;        /*SPECIFY GROUP CODE          */ 06988000
         MVI   RSWGCODE(REG6),X'03'                                1713 06989000
*           RSWFONE = OFF;             /*FIND ALL OCCURRENCES        */ 06990000
         NI    RSWFONE(REG6),B'01111111'                           1714 06991000
*           /* CALL THE FIND SUBROUTINE */                         1715 06992000
*                                                                  1715 06993000
*         /* CALL TO MODULE IDCRS04 FOR PROCEDURE FIND               */ 06994000
*         CALL FIND;                                               1715 06995000
         L     @15,@CV03645                                        1715 06996000
         BALR  @14,@15                                             1715 06997000
*         END;                                                     1716 06998000
*                                                                  1716 06999000
*         RESVLNEX = RSFCNTTN;                                     1717 07000000
         L     @04,RSENTPT(,REG6)                                  1717 07001000
         L     @15,RSWASNVT(,REG6)                                 1717 07002000
         LH    @14,RSFCNTTN(,@15)                                  1717 07003000
         STH   @14,RESVLNEX(,@04)                                  1717 07004000
*         RESVLEXT(1:RSFCNTTN*4) = FNDEXTS(1:RSFCNTTN*4);          1718 07005000
         SLA   @14,2                                               1718 07006000
         BCTR  @14,0                                               1718 07007000
         L     @01,RSFATTNN(,@15)                                  1718 07008000
         EX    @14,@SM03817                                        1718 07009000
*         RSFENTLN = 0;                                            1719 07010000
*                                                                  1719 07011000
         MVI   RSFENTLN(@15),X'00'                                 1719 07012000
*         /***********************************************************/ 07013000
*         /*                                                         */ 07014000
*         /*  PROCESSING COMPLETED. RETURN.                          */ 07015000
*         /*                                                         */ 07016000
*         /***********************************************************/ 07017000
*                                                                  1720 07018000
*                                                                  1720 07019000
*                                                                  1720 07020000
*         IF GDTDBG = NULLPTR                                      1720 07021000
*           THEN;                                                  1720 07022000
         L     @04,GDTDBG(,REG5)                                   1720 07023000
         LTR   @04,@04                                             1720 07024000
         BZ    @RT01720                                            1720 07025000
*           ELSE                                                   1722 07026000
*             CALL IDCDB010 (GDTTBL,'RSP1');                       1722 07027000
*                                                                  1722 07028000
         ST    REG5,@AL00001                                       1722 07029000
         LA    @04,@CC03646                                        1722 07030000
         ST    @04,@AL00001+4                                      1722 07031000
         MVI   @AL00001+4,X'80'                                    1722 07032000
         L     @15,GDTDBG(,REG5)                                   1722 07033000
         LA    @01,@AL00001                                        1722 07034000
         BALR  @14,@15                                             1722 07035000
*         RFY CCR;                                                 1723 07036000
*                                                                  1723 07037000
@RT01720 DS    0H                                                  1724 07038000
* CALL EXIT;  /*TERMINATE*/                                        1724 07039000
         BAL   @14,EXIT                                            1724 07040000
* END PROCCRA; /*END OF PROCEDURE*/                                1725 07041000
@EL00008 DS    0H                                                  1725 07042000
@EF00008 DS    0H                                                  1725 07043000
@ER00008 BR    @14                                                 1725 07044000
@PB00008 DS    0H                                                  1726 07045000
*        /************************************************************/ 07046000
*        /*                                                          */ 07047000
*        /* PROCEDURE NAME - REASSIGN                                */ 07048000
*        /*                                                          */ 07049000
*        /* FUNCTION - THIS PROCEDURE ASSIGNS NEW CI NUMBERS TO THE  */ 07050000
*        /*            RECORDS ON THE REASSIGN CHAIN. RECORDS ARE    */ 07051000
*        /*            ON THE REASSIGN CHAIN BECAUSE THEY CONTAIN    */ 07052000
*        /*            INVALID OR DUPLICATE CI NUMBERS WHEN COMPARED */ 07053000
*        /*            TO THE WORK FILE(RECOVERABLE CATALOG) AFTER   */ 07054000
*        /*            COPYCAT AND MERGE CRA. THE NEW CI NUMBERS ARE */ 07055000
*        /*            THOSE CI(SLOT)NUMBERS IN THE WORKFILE WHICH   */ 07056000
*        /*            ARE FREE AFTER THE CRA'S HAVE BEEN MERGED AND */ 07057000
*        /*            ARE FOUND ON THE AVAILABLE CHAIN. SINCE       */ 07058000
*        /*            DIFFERENT LEVELS OF THE CATALOG AND CRA       */ 07059000
*        /*            VOLUMES MAY BE RESET, RECORDS FROM THE CRA MAY*/ 07060000
*        /*            BE TARGETED FOR THE SAME CI AS ONE THAT EXISTS*/ 07061000
*        /*            IN THE CATALOG AND CONTAINS A RECORD FROM     */ 07062000
*        /*            A DIFFERENT CRA. THIS CREATES A DUPLICATE     */ 07063000
*        /*            REQUEST FOR THE SAME CI NUMBER. WHEN THE      */ 07064000
*        /*            DUPLICATE IS REASSIGNED, THE DUPLICATE CHAIN  */ 07065000
*        /*            POINTER WHICH ASSOCIATES THIS RECORD WITH     */ 07066000
*        /*            IT'S ORIGINAL CI NUMBER MUST BE UPDATED TO    */ 07067000
*        /*            POINT TO THE NEWLY ASSIGNED LOCATION.         */ 07068000
*        /*                THIS PROCEDURE USES TWO OF THE AVAILABLE  */ 07069000
*        /*            RAB CONTROL BLOCKS. ASSOCIATED WITH EACH RAB  */ 07070000
*        /*            IS A BUFFER AREA AND A PROCESSING FIELD.      */ 07071000
*        /*                                                          */ 07072000
*        /* INPUT -    MAIN WORKAREA,WORKFILE PROCESSING  FIELD,     */ 07073000
*        /*            WORKFILE,WORK BUFFERS,GRAB AND RAB CONTROL    */ 07074000
*        /*            BLOCKS                                        */ 07075000
*        /*                                                          */ 07076000
*        /* OUTPUT -   WORKFILE IS UPDATED WITH RESIGNABLE           */ 07077000
*        /*            RECORDS.                                      */ 07078000
*        /*                                                          */ 07079000
*        /************************************************************/ 07080000
*      GENERATE;                                                   1726 07081000
         DS    0F                                                       07082000
NAME0167 DC    CL8'REASSIGN'                                            07083000
*REASSIGN: PROCEDURE                                               1727 07084000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1727 07085000
*                                                                  1727 07086000
         B     @PB00009                                            1727 07087000
REASSIGN DS    0H                                                  1728 07088000
*      GENERATE REFS(RS01RG08, REG6);                              1728 07089000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          07090000
         LR    @15,@13  OLD SAVE AREA                                   07091000
         LA    @13,72(@13)  NEW SAVE AREA                               07092000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     07093000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        07094000
         MVC   0(4,@15),NAME0167  PROCNAME TO REGSAVE                   07095000
*        OLDERID2 = NEWERID2;                                      1729 07096000
         L     @04,GDTTR2(,REG5)                                   1729 07097000
         MVC   @TS00001(95),NEWERID2(@04)                          1729 07098000
         MVC   OLDERID2(95,@04),@TS00001                           1729 07099000
*        NEWID2 = 'RSRE';                                          1730 07100000
*                                                                  1730 07101000
         MVC   NEWID2(4,@04),@CC03650                              1730 07102000
*        /************************************************************/ 07103000
*        /*                                                          */ 07104000
*        /* ADDRESSABILITY AND INITIALIZATION                        */ 07105000
*        /*                                                          */ 07106000
*        /************************************************************/ 07107000
*                                                                  1731 07108000
*        RSGRABCU = ADDR(GRABSWF);     /* DEFAULT POINTER TO WF GRAB */ 07109000
         L     @04,RSIOTBL(,REG6)                                  1731 07110000
         ST    @04,RSGRABCU(,REG6)                                 1731 07111000
*        GRABAFLS = OFF;               /* SET GRAB I/O ERR FLAGS OFF */ 07112000
         MVI   GRABAFLS+1(@04),X'00'                               1732 07113000
         MVI   GRABAFLS(@04),B'00000000'                           1732 07114000
*        RSRENEXT = RSREASS;           /* SET NEXT REASSIGN RECORD   */ 07115000
         L     @04,RSREASS(,REG6)                                  1733 07116000
         ST    @04,RSRENEXT(,REG6)                                 1733 07117000
*                                      /* RRN = 1ST RRN              */ 07118000
*        RSRENRR = OFF;                                            1734 07119000
         NI    RSRENRR(REG6),B'10111111'                           1734 07120000
*        IF RSREARR = ON THEN          /* IF THE 1ST RECORD HAS RRN  */ 07121000
         TM    RSREARR(REG6),B'10000000'                           1735 07122000
         BNO   @RF01735                                            1735 07123000
*          RSRENRR = ON;               /* SET NEXT REC TO RRN/NOT CI */ 07124000
         OI    RSRENRR(REG6),B'01000000'                           1736 07125000
*          RSWFBP1 = ADDR (GRABRAB1 -> RABBUF);                    1737 07126000
@RF01735 L     @04,RSGRABCU(,REG6)                                 1737 07127000
         L     @01,GRABRAB1(,@04)                                  1737 07128000
         LA    @15,RABBUF(,@01)                                    1737 07129000
         ST    @15,RSWFBP1(,REG6)                                  1737 07130000
*          RSWFBP2 = ADDR (GRABRAB2 -> RABBUF);                    1738 07131000
*                                                                  1738 07132000
         L     @04,GRABRAB2(,@04)                                  1738 07133000
         LA    @04,RABBUF(,@04)                                    1738 07134000
         ST    @04,RSWFBP2(,REG6)                                  1738 07135000
*        /************************************************************/ 07136000
*        /*                                                          */ 07137000
*        /* SEQUENTIALLY READ EACH RECORD ON THE REASSIGN CHAIN      */ 07138000
*        /* UNTIL ALL RECORDS HAVE BEEN READ AND REASSIGNED.         */ 07139000
*        /*                                                          */ 07140000
*        /************************************************************/ 07141000
*                                                                  1739 07142000
*REASSNLP:                                                         1739 07143000
*        DO  WHILE(RSRENEXT ^=0);                                  1739 07144000
REASSNLP B     @DE01739                                            1739 07145000
@DL01739 DS    0H                                                  1740 07146000
*          GRABCURR = GRABRAB1;        /* DEFAULT BUFFER1            */ 07147000
         L     @04,RSGRABCU(,REG6)                                 1740 07148000
         L     @15,GRABRAB1(,@04)                                  1740 07149000
         ST    @15,GRABCURR(,@04)                                  1740 07150000
*          RABRRN = OFF;               /* SET RAB1 FLAG TO CI        */ 07151000
         NI    RABRRN(@15),B'11101111'                             1741 07152000
*          GRABRAB2 -> RABRRN = OFF;   /* SET RAB2 FLAG TO CI        */ 07153000
         L     @04,GRABRAB2(,@04)                                  1742 07154000
         NI    RABRRN(@04),B'11101111'                             1742 07155000
*          RABRCDA = RSRENEXT;         /* SET THE CIN/RRN            */ 07156000
         L     @04,RSRENEXT(,REG6)                                 1743 07157000
         ST    @04,RABRCDA(,@15)                                   1743 07158000
*          IF RSRENRR = ON THEN        /* IF THE RECORD HAS RRN SET  */ 07159000
         TM    RSRENRR(REG6),B'01000000'                           1744 07160000
         BNO   @RF01744                                            1744 07161000
*            RABRRN = ON;              /* GRAB FLAG TO RRN/NOT CI    */ 07162000
*                                                                  1745 07163000
         OI    RABRRN(@15),B'00010000'                             1745 07164000
*          /**********************************************************/ 07165000
*          /*                                                        */ 07166000
*          /* GET THE NEXT RECORD FROM THE REASSIGN CHAIN AND USE    */ 07167000
*          /* IT'S CHAIN POINTER TO POINT TO THE NEXT RECORD.        */ 07168000
*          /*                                                        */ 07169000
*          /**********************************************************/ 07170000
*                                                                  1746 07171000
*                                                                  1746 07172000
*          DO;                                                     1746 07173000
@RF01744 DS    0H                                                  1747 07174000
*            RSRTYPE = ''B;                                        1747 07175000
         MVI   RSRTYPE(REG6),X'00'                                 1747 07176000
*            RSRGET = ON;      /* GETRCD  */                       1748 07177000
         OI    RSRGET(REG6),B'10000000'                            1748 07178000
*            RSRUPD = ON;      /* UPDATE  */                       1749 07179000
         OI    RSRUPD(REG6),B'00001000'                            1749 07180000
*            RSRDS = ''B;                                          1750 07181000
         NI    RSRDS(REG6),B'00011111'                             1750 07182000
*            RSRWF = ON;       /* WORKFILE  */                     1751 07183000
*            RSRDIR = ON;      /* DIRECT  */                       1752 07184000
*            RSRKEY = ON;      /* KEY  */                          1753 07185000
*                                                                  1753 07186000
         OI    RSRWF(REG6),B'10010100'                             1753 07187000
*          /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT           */ 07188000
*          CALL RECMGMT;                                           1754 07189000
         L     @15,@CV03498                                        1754 07190000
         BALR  @14,@15                                             1754 07191000
*            RFY RTNREG RSTD;                                      1755 07192000
*            TESTRC = RTNREG;                                      1756 07193000
         STH   RTNREG,TESTRC(,REG6)                                1756 07194000
*            RFY RTNREG UNRSTD;                                    1757 07195000
*          END;                                                    1758 07196000
*                                                                  1758 07197000
*          RSRENEXT = RSWCHPTR;        /* SET NEXT REASSIGN RRN FROM */ 07198000
         L     @04,RSGRABCU(,REG6)                                 1759 07199000
         L     @04,GRABCURR(,@04)                                  1759 07200000
         L     @15,RSWCHPTR(,@04)                                  1759 07201000
         ST    @15,RSRENEXT(,REG6)                                 1759 07202000
*                                      /* THE CHAIN POINTER          */ 07203000
*          RSRENRR = OFF;                                          1760 07204000
         NI    RSRENRR(REG6),B'10111111'                           1760 07205000
*          IF RSWCHNRR = ON THEN       /* IF CHAIN POINTER IS RRN    */ 07206000
         TM    RSWCHNRR(@04),B'00000100'                           1761 07207000
         BNO   @RF01761                                            1761 07208000
*            RSRENRR = ON;             /* SET THE RAB FLAG TO RRN    */ 07209000
         OI    RSRENRR(REG6),B'01000000'                           1762 07210000
*          REASSW1 = OFF;              /* SET THE AVAILABLE SWITCH   */ 07211000
@RF01761 NI    REASSW1(REG6),B'01111111'                           1763 07212000
*          RSAVNEXT = RSAVAIL;         /* SET NEXT AVAIL CIN=1ST CIN */ 07213000
         L     @04,RSAVAIL(,REG6)                                  1764 07214000
         ST    @04,RSAVNEXT(,REG6)                                 1764 07215000
*                                                                  1765 07216000
*          /**********************************************************/ 07217000
*          /*                                                        */ 07218000
*          /* SEARCH THE VALID SECTION OF THE WORK FILE FOR AN       */ 07219000
*          /* RRN SLOT(CI NUMBER) THAT IS AVAILABLE.                 */ 07220000
*          /*                                                        */ 07221000
*          /**********************************************************/ 07222000
*                                                                  1765 07223000
*REASAVLP:  DO UNTIL REASSW1 = ON;                                 1765 07224000
REASAVLP DS    0H                                                  1765 07225000
@DL01765 DS    0H                                                  1766 07226000
*            GRABCURR = GRABRAB2;      /* DEFAULT BUFFER2            */ 07227000
         L     @04,RSGRABCU(,REG6)                                 1766 07228000
         L     @15,GRABRAB2(,@04)                                  1766 07229000
         ST    @15,GRABCURR(,@04)                                  1766 07230000
*            RABRCDA = RSAVNEXT;       /* SET THE CIN/RRN            */ 07231000
*                                                                  1767 07232000
*                                                                  1767 07233000
         L     @04,RSAVNEXT(,REG6)                                 1767 07234000
         ST    @04,RABRCDA(,@15)                                   1767 07235000
*            /********************************************************/ 07236000
*            /*                                                      */ 07237000
*            /* GET THE NEXT POSSIBLY AVAILABLE RECORD IN THE VALID  */ 07238000
*            /* WORK SECTION OF THE FILE AND USE IT'S CHAIN POINTER  */ 07239000
*            /* TO POINT TO THE NEXT AVAILABLE RECORD.               */ 07240000
*            /*                                                      */ 07241000
*            /********************************************************/ 07242000
*                                                                  1768 07243000
*                                                                  1768 07244000
*            DO;                                                   1768 07245000
*              RSRTYPE = ''B;                                      1769 07246000
         MVI   RSRTYPE(REG6),X'00'                                 1769 07247000
*              RSRGET = ON;      /* GETRCD  */                     1770 07248000
         OI    RSRGET(REG6),B'10000000'                            1770 07249000
*              RSRUPD = ON;      /* UPDATE  */                     1771 07250000
         OI    RSRUPD(REG6),B'00001000'                            1771 07251000
*              RSRDS = ''B;                                        1772 07252000
         NI    RSRDS(REG6),B'00011111'                             1772 07253000
*              RSRWF = ON;       /* WORKFILE  */                   1773 07254000
*              RSRDIR = ON;      /* DIRECT  */                     1774 07255000
*              RSRKEY = ON;      /* KEY  */                        1775 07256000
*                                                                  1775 07257000
         OI    RSRWF(REG6),B'10010100'                             1775 07258000
*            /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT         */ 07259000
*            CALL RECMGMT;                                         1776 07260000
         L     @15,@CV03498                                        1776 07261000
         BALR  @14,@15                                             1776 07262000
*              RFY RTNREG RSTD;                                    1777 07263000
*              TESTRC = RTNREG;                                    1778 07264000
         STH   RTNREG,TESTRC(,REG6)                                1778 07265000
*              RFY RTNREG UNRSTD;                                  1779 07266000
*            END;                                                  1780 07267000
*                                                                  1780 07268000
*            RSAVNEXT = RSWCHPTR;      /* SET THE NEXT AVAILABLE CIN */ 07269000
         L     @04,RSGRABCU(,REG6)                                 1781 07270000
         L     @04,GRABCURR(,@04)                                  1781 07271000
         L     @15,RSWCHPTR(,@04)                                  1781 07272000
         ST    @15,RSAVNEXT(,REG6)                                 1781 07273000
*                                      /* FROM THE CHAIN POINTER     */ 07274000
*                                                                  1782 07275000
*            /********************************************************/ 07276000
*            /*                                                      */ 07277000
*            /* IF THE RECORD IS NOT AVAILABLE FREE THE RECORD       */ 07278000
*            /* AND GET THE NEXT POSSIBLE AVAILABLE RECORD ON THE    */ 07279000
*            /* AVAILABLE CHAIN.                                     */ 07280000
*            /*                                                      */ 07281000
*            /********************************************************/ 07282000
*                                                                  1782 07283000
*            IF RSWFCRA = OFF THEN     /* IF THE RECORD IS NOT FROM  */ 07284000
         TM    RSWFCRA(@04),B'10000000'                            1782 07285000
         BNZ   @RF01782                                            1782 07286000
*              REASSW1 = ON;           /* A CRA THE SLOT IS AVAILABLE*/ 07287000
         OI    REASSW1(REG6),B'10000000'                           1783 07288000
*            ELSE                                                  1784 07289000
*                                                                  1784 07290000
*                                                                  1784 07291000
*              DO;                                                 1784 07292000
         B     @RC01782                                            1784 07293000
@RF01782 DS    0H                                                  1785 07294000
*                RSRTYPE = ''B;                                    1785 07295000
         MVI   RSRTYPE(REG6),X'00'                                 1785 07296000
*                RSRFREE = ON;     /* FREERCD  */                  1786 07297000
         OI    RSRFREE(REG6),B'00000001'                           1786 07298000
*                RSRUPD = ON;      /* UPDATE  */                   1787 07299000
         OI    RSRUPD(REG6),B'00001000'                            1787 07300000
*                RSRDS = ''B;                                      1788 07301000
         NI    RSRDS(REG6),B'00011111'                             1788 07302000
*                RSRWF = ON;       /* WORKFILE  */                 1789 07303000
*                RSRDIR = ON;      /* DIRECT  */                   1790 07304000
*                RSRKEY = ON;      /* KEY  */                      1791 07305000
*                                                                  1791 07306000
         OI    RSRWF(REG6),B'10010100'                             1791 07307000
*              /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT       */ 07308000
*              CALL RECMGMT;                                       1792 07309000
         L     @15,@CV03498                                        1792 07310000
         BALR  @14,@15                                             1792 07311000
*                RFY RTNREG RSTD;                                  1793 07312000
*                TESTRC = RTNREG;                                  1794 07313000
         STH   RTNREG,TESTRC(,REG6)                                1794 07314000
*                RFY RTNREG UNRSTD;                                1795 07315000
*              END;                                                1796 07316000
*                                                                  1796 07317000
*          END REASAVLP;                                           1797 07318000
@RC01782 DS    0H                                                  1797 07319000
@DE01765 TM    REASSW1(REG6),B'10000000'                           1797 07320000
         BNO   @DL01765                                            1797 07321000
*          /**********************************************************/ 07322000
*          /*                                                        */ 07323000
*          /* SET THE 'DUPLICATE CI POINTER' AND THE 'RRN FLAG'      */ 07324000
*          /* WHICH ARE IN PROCESSING FIELD ONE TO THE VALUE WHICH   */ 07325000
*          /* IS IN PROCESSING FIELD TWO. MOVE THE RECORD FROM THE   */ 07326000
*          /* REASSIGN RECORD BUFFER1 TO THE AVAILABLE RECORD        */ 07327000
*          /* BUFFER2.                                               */ 07328000
*          /*                                                        */ 07329000
*          /**********************************************************/ 07330000
*                                                                  1798 07331000
*          RSWDUPTR = GRABRAB1 -> RSWDUPTR;                        1798 07332000
         L     @04,RSGRABCU(,REG6)                                 1798 07333000
         L     @15,GRABCURR(,@04)                                  1798 07334000
         L     @04,GRABRAB1(,@04)                                  1798 07335000
         L     @14,RSWDUPTR(,@04)                                  1798 07336000
         ST    @14,RSWDUPTR(,@15)                                  1798 07337000
*          RSWDUPRR = OFF;                                 /*@ZA18273*/ 07338000
         NI    RSWDUPRR(@15),B'10111111'                           1799 07339000
*          IF GRABRAB1 -> RSWDUPRR = ON THEN                       1800 07340000
         TM    RSWDUPRR(@04),B'01000000'                           1800 07341000
         BNO   @RF01800                                            1800 07342000
*            RSWDUPRR = ON;      /* TRANSFER DUP INDICATOR   @ZA18273*/ 07343000
         OI    RSWDUPRR(@15),B'01000000'                           1801 07344000
*          WFBUF2(1:256) = WFBUF1(1:256);                          1802 07345000
@RF01800 L     @04,RSWFBP2(,REG6)                                  1802 07346000
         L     @15,RSWFBP1(,REG6)                                  1802 07347000
         MVC   WFBUF2(256,@04),WFBUF1(@15)                         1802 07348000
*          WFBUF2(257:CELEN) = WFBUF1(257:CELEN);                  1803 07349000
*                                                                  1803 07350000
         MVC   WFBUF2+256(249,@04),WFBUF1+256(@15)                 1803 07351000
*          /**********************************************************/ 07352000
*          /*                                                        */ 07353000
*          /* INDICATE IN THE CRA THAT THE RECORD IS REASSIGNED      */ 07354000
*          /*                                                        */ 07355000
*          /**********************************************************/ 07356000
*                                                                  1804 07357000
*          RSWFCRA = ON;               /* SET RECORD FROM CRA FLAG   */ 07358000
*          RSWUPCAT = ON;              /* SET UPDATE CAT FLAG        */ 07359000
*          RSWDLCAT = OFF;                                         1806 07360000
         L     @04,RSGRABCU(,REG6)                                 1806 07361000
         L     @01,GRABCURR(,@04)                                  1806 07362000
         OI    RSWFCRA(@01),B'10100000'                            1806 07363000
         NI    RSWDLCAT(@01),B'10111111'                           1806 07364000
*          GRABCURR = GRABRAB2;                                    1807 07365000
*                                                                  1807 07366000
         L     @15,GRABRAB2(,@04)                                  1807 07367000
         ST    @15,GRABCURR(,@04)                                  1807 07368000
*          /* CALL TO MODULE IDCRS05 FOR PROCEDURE ADDUPCR           */ 07369000
*          CALL ADDUPCR;                                           1808 07370000
*                                                                  1808 07371000
         L     @15,@CV03636                                        1808 07372000
         BALR  @14,@15                                             1808 07373000
*          /**********************************************************/ 07374000
*          /*                                                        */ 07375000
*          /* PUT THE REASSIGNED RECORD IN THE AVAILABLE SLOT IN     */ 07376000
*          /* THE WORK FILE                                          */ 07377000
*          /*                                                        */ 07378000
*          /**********************************************************/ 07379000
*                                                                  1809 07380000
*          IF GRABRAB1 -> RSWCHRA = ON THEN                        1809 07381000
         L     @04,RSGRABCU(,REG6)                                 1809 07382000
         L     @01,GRABRAB1(,@04)                                  1809 07383000
         TM    RSWCHRA(@01),B'00000010'                            1809 07384000
         BNO   @RF01809                                            1809 07385000
*            RSWCHRA = ON;             /* TRANSFER MOVE FLAG @ZA18274*/ 07386000
         L     @04,GRABCURR(,@04)                                  1810 07387000
         OI    RSWCHRA(@04),B'00000010'                            1810 07388000
*          RSWRASCI = ON;              /* SET REASSIGNED CI FLAG     */ 07389000
*                                                                  1811 07390000
*                                                                  1811 07391000
@RF01809 L     @04,RSGRABCU(,REG6)                                 1811 07392000
         L     @04,GRABCURR(,@04)                                  1811 07393000
         OI    RSWRASCI(@04),B'00000100'                           1811 07394000
*          DO;                                                     1812 07395000
*            RSRTYPE = ''B;                                        1813 07396000
         MVI   RSRTYPE(REG6),X'00'                                 1813 07397000
*            RSRUPDT = ON;     /* UPDRCD  */                       1814 07398000
         OI    RSRUPDT(REG6),B'00100000'                           1814 07399000
*            RSRUPD = ON;      /* UPDATE  */                       1815 07400000
         OI    RSRUPD(REG6),B'00001000'                            1815 07401000
*            RSRDS = ''B;                                          1816 07402000
         NI    RSRDS(REG6),B'00011111'                             1816 07403000
*            RSRWF = ON;       /* WORKFILE  */                     1817 07404000
*            RSRDIR = ON;      /* DIRECT  */                       1818 07405000
*            RSRKEY = ON;      /* KEY  */                          1819 07406000
*                                                                  1819 07407000
         OI    RSRWF(REG6),B'10010100'                             1819 07408000
*          /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT           */ 07409000
*          CALL RECMGMT;                                           1820 07410000
         L     @15,@CV03498                                        1820 07411000
         BALR  @14,@15                                             1820 07412000
*            RFY RTNREG RSTD;                                      1821 07413000
*            TESTRC = RTNREG;                                      1822 07414000
         STH   RTNREG,TESTRC(,REG6)                                1822 07415000
*            RFY RTNREG UNRSTD;                                    1823 07416000
*          END;                                                    1824 07417000
*                                                                  1824 07418000
*          /**********************************************************/ 07419000
*          /*                                                        */ 07420000
*          /* IF THE RECORD WAS ON THE REASSIGN CHAIN BECAUSE IT     */ 07421000
*          /* WAS A DUPLICATE, SEARCH THE DUPLICATE CHAIN FOR A      */ 07422000
*          /* RECORD THAT HAS A POINTER WHICH POINTS TO THE RRN OF   */ 07423000
*          /* THE RECORD JUST REASSIGNED. THEN SET THE DUPLICATE     */ 07424000
*          /* POINTER OF THE DUPLICATE RECORD JUST FOUND EQUAL TO    */ 07425000
*          /* THE CI NUMBER OF THE NEWLY REASSIGNED RECORD. IF THE   */ 07426000
*          /* RECORD WAS INVALID THERE IS NO NEED TO SEARCH THE      */ 07427000
*          /* DUPLICATE CHAIN AND THE DUPLICATE POINTER IS UPDATED   */ 07428000
*          /* DIRECTLY.                                              */ 07429000
*          /**********************************************************/ 07430000
*                                                                  1825 07431000
*          GRABCURR = GRABRAB1;        /* DEFAULT BUFFER1            */ 07432000
         L     @04,RSGRABCU(,REG6)                                 1825 07433000
         L     @15,GRABRAB1(,@04)                                  1825 07434000
         ST    @15,GRABCURR(,@04)                                  1825 07435000
*          IF RSWINVCI = OFF THEN      /* IS RECORD INVALID OR DUP   */ 07436000
*                                                                  1826 07437000
         TM    RSWINVCI(@15),B'10000000'                           1826 07438000
         BNZ   @RF01826                                            1826 07439000
*          /**********************************************************/ 07440000
*          /*                                                        */ 07441000
*          /* SETUP TO SEARCH THE DUPLICATE CHAIN                    */ 07442000
*          /*                                                        */ 07443000
*          /**********************************************************/ 07444000
*                                                                  1827 07445000
*            DO;                                                   1827 07446000
*                                                                  1827 07447000
*                DO;                                               1828 07448000
*                  RSRTYPE = ''B;                                  1829 07449000
         MVI   RSRTYPE(REG6),X'00'                                 1829 07450000
*                  RSRFREE = ON;     /* FREERCD  */                1830 07451000
         OI    RSRFREE(REG6),B'00000001'                           1830 07452000
*                  RSRUPD = ON;      /* UPDATE  */                 1831 07453000
         OI    RSRUPD(REG6),B'00001000'                            1831 07454000
*                  RSRDS = ''B;                                    1832 07455000
         NI    RSRDS(REG6),B'00011111'                             1832 07456000
*                  RSRWF = ON;       /* WORKFILE  */               1833 07457000
*                  RSRDIR = ON;      /* DIRECT  */                 1834 07458000
*                  RSRKEY = ON;      /* KEY  */                    1835 07459000
*                                                                  1835 07460000
         OI    RSRWF(REG6),B'10010100'                             1835 07461000
*                /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT     */ 07462000
*                CALL RECMGMT;                                     1836 07463000
         L     @15,@CV03498                                        1836 07464000
         BALR  @14,@15                                             1836 07465000
*                  RFY RTNREG RSTD;                                1837 07466000
*                  TESTRC = RTNREG;                                1838 07467000
         STH   RTNREG,TESTRC(,REG6)                                1838 07468000
*                  RFY RTNREG UNRSTD;                              1839 07469000
*                END;                                              1840 07470000
*              REASSW2 = OFF;          /* SET FOUND SWITCH           */ 07471000
         NI    REASSW2(REG6),B'10111111'                           1841 07472000
*              RSCMRR = RABRCDA;       /* SET RRN OF REASSIGNED REC  */ 07473000
         L     @04,RSGRABCU(,REG6)                                 1842 07474000
         L     @04,GRABCURR(,@04)                                  1842 07475000
         L     @15,RABRCDA(,@04)                                   1842 07476000
         ST    @15,RSCMRR(,REG6)                                   1842 07477000
*              RSDUPNXT = RCDCINO;     /* SET 1ST CI NUMBER          */ 07478000
         L     @04,RCDCINO+7(,@04)                                 1843 07479000
         LA    @04,0(,@04)                                         1843 07480000
         ST    @04,RSDUPNXT(,REG6)                                 1843 07481000
*              RSDUPNRR = OFF;                                     1844 07482000
         NI    RSDUPNRR(REG6),B'11011111'                          1844 07483000
*            /********************************************************/ 07484000
*            /*                                                      */ 07485000
*            /* SEARCH THE DUPLICATE CHAIN FOR THE RECORD THAT       */ 07486000
*            /* POINTS TO THE RRN OF THE RECORD WHICH WAS REASSIGNED */ 07487000
*            /*                                                      */ 07488000
*            /********************************************************/ 07489000
*                                                                  1845 07490000
*REASDULP:     DO  UNTIL REASSW2 = ON;                             1845 07491000
REASDULP DS    0H                                                  1845 07492000
@DL01845 DS    0H                                                  1846 07493000
*                RABRCDA = RSDUPNXT;   /* SET CIN/RRN                */ 07494000
         L     @04,RSGRABCU(,REG6)                                 1846 07495000
         L     @04,GRABCURR(,@04)                                  1846 07496000
         L     @15,RSDUPNXT(,REG6)                                 1846 07497000
         ST    @15,RABRCDA(,@04)                                   1846 07498000
*                RABRRN = OFF;                                     1847 07499000
         NI    RABRRN(@04),B'11101111'                             1847 07500000
*                IF RSDUPNRR = ON THEN /* NEXT PTR IS RRN NOT CI     */ 07501000
         TM    RSDUPNRR(REG6),B'00100000'                          1848 07502000
         BNO   @RF01848                                            1848 07503000
*                  RABRRN = ON;                                    1849 07504000
*                                                                  1849 07505000
         OI    RABRRN(@04),B'00010000'                             1849 07506000
*                /****************************************************/ 07507000
*                /*                                                  */ 07508000
*                /* READ THE RECORD ON THE DUPLICATE CHAIN AND FREE  */ 07509000
*                /* THE RECORD IF IT DOES NOT HAVE THE CORRECT       */ 07510000
*                /* POINTER.                                         */ 07511000
*                /****************************************************/ 07512000
*                                                                  1850 07513000
*                                                                  1850 07514000
*                DO;                                               1850 07515000
@RF01848 DS    0H                                                  1851 07516000
*                  RSRTYPE = ''B;                                  1851 07517000
         MVI   RSRTYPE(REG6),X'00'                                 1851 07518000
*                  RSRGET = ON;      /* GETRCD  */                 1852 07519000
         OI    RSRGET(REG6),B'10000000'                            1852 07520000
*                  RSRUPD = ON;      /* UPDATE  */                 1853 07521000
         OI    RSRUPD(REG6),B'00001000'                            1853 07522000
*                  RSRDS = ''B;                                    1854 07523000
         NI    RSRDS(REG6),B'00011111'                             1854 07524000
*                  RSRWF = ON;       /* WORKFILE  */               1855 07525000
*                  RSRDIR = ON;      /* DIRECT  */                 1856 07526000
*                  RSRKEY = ON;      /* KEY  */                    1857 07527000
*                                                                  1857 07528000
         OI    RSRWF(REG6),B'10010100'                             1857 07529000
*                /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT     */ 07530000
*                CALL RECMGMT;                                     1858 07531000
         L     @15,@CV03498                                        1858 07532000
         BALR  @14,@15                                             1858 07533000
*                  RFY RTNREG RSTD;                                1859 07534000
*                  TESTRC = RTNREG;                                1860 07535000
         STH   RTNREG,TESTRC(,REG6)                                1860 07536000
*                  RFY RTNREG UNRSTD;                              1861 07537000
*                END;                                              1862 07538000
*                                                                  1862 07539000
*                RSDUPNXT = RSWDUPTR;  /* NEXT DUP FROM CHAIN PTR    */ 07540000
         L     @04,RSGRABCU(,REG6)                                 1863 07541000
         L     @04,GRABCURR(,@04)                                  1863 07542000
         L     @15,RSWDUPTR(,@04)                                  1863 07543000
         ST    @15,RSDUPNXT(,REG6)                                 1863 07544000
*                IF RSWDUPRR = ON THEN /* DUP PTR IS RRN NOT CI      */ 07545000
         TM    RSWDUPRR(@04),B'01000000'                           1864 07546000
         BNO   @RF01864                                            1864 07547000
*                  DO;                                             1865 07548000
*                    RSDUPNRR = ON;    /* SET FLAG TO RRN            */ 07549000
         OI    RSDUPNRR(REG6),B'00100000'                          1866 07550000
*                    IF RSCMRR = RSWDUPTR THEN                     1867 07551000
         C     @15,RSCMRR(,REG6)                                   1867 07552000
         BNE   @RF01867                                            1867 07553000
*                                      /* RRN OF DUPLICATE EQUALS THE*/ 07554000
*                                      /* RRN OF THE REASSIGNED REC  */ 07555000
*                      REASSW2 = ON;                               1868 07556000
         OI    REASSW2(REG6),B'01000000'                           1868 07557000
*                    ELSE                                          1869 07558000
*                                                                  1869 07559000
*                                                                  1869 07560000
*                      DO;                                         1869 07561000
         B     @RC01867                                            1869 07562000
@RF01867 DS    0H                                                  1870 07563000
*                        RSRTYPE = ''B;                            1870 07564000
         MVI   RSRTYPE(REG6),X'00'                                 1870 07565000
*                        RSRFREE = ON;     /* FREERCD  */          1871 07566000
         OI    RSRFREE(REG6),B'00000001'                           1871 07567000
*                        RSRUPD = ON;      /* UPDATE  */           1872 07568000
         OI    RSRUPD(REG6),B'00001000'                            1872 07569000
*                        RSRDS = ''B;                              1873 07570000
         NI    RSRDS(REG6),B'00011111'                             1873 07571000
*                        RSRWF = ON;       /* WORKFILE  */         1874 07572000
*                        RSRDIR = ON;      /* DIRECT  */           1875 07573000
*                        RSRKEY = ON;      /* KEY  */              1876 07574000
*                                                                  1876 07575000
         OI    RSRWF(REG6),B'10010100'                             1876 07576000
*                      /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT  07577000
*                                                                    */ 07578000
*                      CALL RECMGMT;                               1877 07579000
         L     @15,@CV03498                                        1877 07580000
         BALR  @14,@15                                             1877 07581000
*                        RFY RTNREG RSTD;                          1878 07582000
*                        TESTRC = RTNREG;                          1879 07583000
         STH   RTNREG,TESTRC(,REG6)                                1879 07584000
*                        RFY RTNREG UNRSTD;                        1880 07585000
*                      END;                                        1881 07586000
*                                                                  1881 07587000
*                  END;                                            1882 07588000
*                ELSE                                              1883 07589000
*                                                                  1883 07590000
*                                                                  1883 07591000
*                  DO;                                             1883 07592000
         B     @RC01864                                            1883 07593000
@RF01864 DS    0H                                                  1884 07594000
*                    RSRTYPE = ''B;                                1884 07595000
         MVI   RSRTYPE(REG6),X'00'                                 1884 07596000
*                    RSRFREE = ON;     /* FREERCD  */              1885 07597000
         OI    RSRFREE(REG6),B'00000001'                           1885 07598000
*                    RSRUPD = ON;      /* UPDATE  */               1886 07599000
         OI    RSRUPD(REG6),B'00001000'                            1886 07600000
*                    RSRDS = ''B;                                  1887 07601000
         NI    RSRDS(REG6),B'00011111'                             1887 07602000
*                    RSRWF = ON;       /* WORKFILE  */             1888 07603000
*                    RSRDIR = ON;      /* DIRECT  */               1889 07604000
*                    RSRKEY = ON;      /* KEY  */                  1890 07605000
*                                                                  1890 07606000
         OI    RSRWF(REG6),B'10010100'                             1890 07607000
*                  /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT   */ 07608000
*                  CALL RECMGMT;                                   1891 07609000
         L     @15,@CV03498                                        1891 07610000
         BALR  @14,@15                                             1891 07611000
*                    RFY RTNREG RSTD;                              1892 07612000
*                    TESTRC = RTNREG;                              1893 07613000
         STH   RTNREG,TESTRC(,REG6)                                1893 07614000
*                    RFY RTNREG UNRSTD;                            1894 07615000
*                  END;                                            1895 07616000
*                                                                  1895 07617000
*              END REASDULP;                                       1896 07618000
*                                                                  1896 07619000
@RC01864 DS    0H                                                  1896 07620000
@DE01845 TM    REASSW2(REG6),B'01000000'                           1896 07621000
         BNO   @DL01845                                            1896 07622000
*              /******************************************************/ 07623000
*              /*                                                    */ 07624000
*              /* UPDATE DUPLICATE POINTER OF THE DUPLICATE RECORD   */ 07625000
*              /* TO POINT TO THE CI OF THE NEWLY REASSIGN RECORD    */ 07626000
*              /*                                                    */ 07627000
*              /******************************************************/ 07628000
*                                                                  1897 07629000
*            END;                                                  1897 07630000
*          RSWDUPTR = GRABRAB2 -> RABRCDA;                         1898 07631000
@RF01826 L     @04,RSGRABCU(,REG6)                                 1898 07632000
         L     @15,GRABCURR(,@04)                                  1898 07633000
         L     @04,GRABRAB2(,@04)                                  1898 07634000
         L     @04,RABRCDA(,@04)                                   1898 07635000
         ST    @04,RSWDUPTR(,@15)                                  1898 07636000
*                                      /* SET DUPLICATE CI PTR TO    */ 07637000
*                                      /* THE CI OF THE REASSIGN     */ 07638000
*          RSWDUPRR = OFF;             /* PTR IS CI NOT RRN          */ 07639000
*                                                                  1899 07640000
         NI    RSWDUPRR(@15),B'10111111'                           1899 07641000
*          /**********************************************************/ 07642000
*          /*                                                        */ 07643000
*          /* POINT THE DUPLICATE CHAIN RECORD TO THE                */ 07644000
*          /* REASSIGNED CI                                          */ 07645000
*          /**********************************************************/ 07646000
*                                                                  1900 07647000
*                                                                  1900 07648000
*          DO;                                                     1900 07649000
*            RSRTYPE = ''B;                                        1901 07650000
         MVI   RSRTYPE(REG6),X'00'                                 1901 07651000
*            RSRUPDT = ON;     /* UPDRCD  */                       1902 07652000
         OI    RSRUPDT(REG6),B'00100000'                           1902 07653000
*            RSRUPD = ON;      /* UPDATE  */                       1903 07654000
         OI    RSRUPD(REG6),B'00001000'                            1903 07655000
*            RSRDS = ''B;                                          1904 07656000
         NI    RSRDS(REG6),B'00011111'                             1904 07657000
*            RSRWF = ON;       /* WORKFILE  */                     1905 07658000
*            RSRDIR = ON;      /* DIRECT  */                       1906 07659000
*            RSRKEY = ON;      /* KEY  */                          1907 07660000
*                                                                  1907 07661000
         OI    RSRWF(REG6),B'10010100'                             1907 07662000
*          /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT           */ 07663000
*          CALL RECMGMT;                                           1908 07664000
         L     @15,@CV03498                                        1908 07665000
         BALR  @14,@15                                             1908 07666000
*            RFY RTNREG RSTD;                                      1909 07667000
*            TESTRC = RTNREG;                                      1910 07668000
         STH   RTNREG,TESTRC(,REG6)                                1910 07669000
*            RFY RTNREG UNRSTD;                                    1911 07670000
*          END;                                                    1912 07671000
*        END REASSNLP;                                             1913 07672000
*                                                                  1913 07673000
@DE01739 SLR   @04,@04                                             1913 07674000
         C     @04,RSRENEXT(,REG6)                                 1913 07675000
         BNE   @DL01739                                            1913 07676000
*          /**********************************************************/ 07677000
*          /*                                                        */ 07678000
*          /* PROCESSING DONE. SET REASSIGN DONE FLAG.               */ 07679000
*          /**********************************************************/ 07680000
*                                                                  1914 07681000
*        RSREASND = ON;                                            1914 07682000
*                                                                  1914 07683000
*                                                                  1914 07684000
*                                                                  1914 07685000
         OI    RSREASND(REG6),B'00000100'                          1914 07686000
*        IF GDTDBG = NULLPTR                                       1915 07687000
*          THEN;                                                   1915 07688000
         C     @04,GDTDBG(,REG5)                                   1915 07689000
         BE    @RT01915                                            1915 07690000
*          ELSE                                                    1917 07691000
*            CALL IDCDB010 (GDTTBL,'RSR1');                        1917 07692000
*                                                                  1917 07693000
         ST    REG5,@AL00001                                       1917 07694000
         LA    @04,@CC03657                                        1917 07695000
         ST    @04,@AL00001+4                                      1917 07696000
         MVI   @AL00001+4,X'80'                                    1917 07697000
         L     @15,GDTDBG(,REG5)                                   1917 07698000
         LA    @01,@AL00001                                        1917 07699000
         BALR  @14,@15                                             1917 07700000
*   CALL EXIT;  /*TERMINATE*/                                      1918 07701000
@RT01915 BAL   @14,EXIT                                            1918 07702000
*   END REASSIGN; /*END OF PROCEDURE*/                             1919 07703000
@EL00009 DS    0H                                                  1919 07704000
@EF00009 DS    0H                                                  1919 07705000
@ER00009 BR    @14                                                 1919 07706000
@PB00009 DS    0H                                                  1920 07707000
*/********************************************************************/ 07708000
*/*                                                                  */ 07709000
*/* PROCEDURE NAME - UPDCAT                                          */ 07710000
*/*                                                                  */ 07711000
*/* FUNCTION - UPDATE THE CATALOG FROM THE WORKFILE                  */ 07712000
*/*                                                                  */ 07713000
*/* INPUT -    NONE                                                  */ 07714000
*/*                                                                  */ 07715000
*/* OUTPUT -   RECORDS ARE ADDED TO AND DELETED FROM THE CATALOG     */ 07716000
*/*                                                                  */ 07717000
*/* EXIT, NORMAL - RETURN TO CALLER                                  */ 07718000
*/* EXIT, ERROR - TO CKERR TO TERMINATE                              */ 07719000
*/*                                                                  */ 07720000
*/********************************************************************/ 07721000
*      GENERATE;                                                   1920 07722000
         DS    0F                                                       07723000
NAME0189 DC    CL8'UPDCAT'                                              07724000
*UPDCAT: PROCEDURE                                                 1921 07725000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1921 07726000
*                                                                  1921 07727000
         B     @PB00010                                            1921 07728000
UPDCAT   DS    0H                                                  1922 07729000
*      GENERATE REFS(RS01RG08, REG6);                              1922 07730000
*                                                                  1922 07731000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          07732000
         LR    @15,@13  OLD SAVE AREA                                   07733000
         LA    @13,72(@13)  NEW SAVE AREA                               07734000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     07735000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        07736000
         MVC   0(4,@15),NAME0189  PROCNAME TO REGSAVE                   07737000
*         /***********************************************************/ 07738000
*         /*                                                         */ 07739000
*         /*  CATALOG FREE RECORD NEXT FREE CI                       */ 07740000
*         /*                                                         */ 07741000
*         /***********************************************************/ 07742000
*                                                                  1923 07743000
*         DCL RSUPENTF PTR(24) DEF(RCDSIZ);                        1923 07744000
*                                                                  1923 07745000
*         RFY RESVOL BASED(RSENTPT);                               1924 07746000
*                                                                  1924 07747000
*         OLDERID2 = NEWERID2;                                     1925 07748000
         L     @04,GDTTR2(,REG5)                                   1925 07749000
         MVC   @TS00001(95),NEWERID2(@04)                          1925 07750000
         MVC   OLDERID2(95,@04),@TS00001                           1925 07751000
*         NEWID2 = 'RSUP';                                         1926 07752000
*                                                                  1926 07753000
         MVC   NEWID2(4,@04),@CC03663                              1926 07754000
*         /***********************************************************/ 07755000
*         /*                                                         */ 07756000
*         /*  IF ANY VOLUME RECORDS WERE INVALID, CALL CKERR TO      */ 07757000
*         /*  PRINT MESSAGE(S)                                       */ 07758000
*         /*                                                         */ 07759000
*         /***********************************************************/ 07760000
*                                                                  1927 07761000
*         IF RSBADVOL = ON                                         1927 07762000
*           THEN                                                   1927 07763000
         TM    RSBADVOL(REG6),B'00000010'                          1927 07764000
         BNO   @RF01927                                            1927 07765000
*UPCTBVL:     DO;                                                  1928 07766000
*                                                                  1928 07767000
UPCTBVL  DS    0H                                                  1929 07768000
*         /***********************************************************/ 07769000
*         /*                                                         */ 07770000
*         /*    OBTAIN EACH RESVOL ENTRY VIA SCNRLST.                */ 07771000
*         /*                                                         */ 07772000
*         /***********************************************************/ 07773000
*                                                                  1929 07774000
*               RSENTPT = ADDR(RSVOLENT);                          1929 07775000
*                                                                  1929 07776000
         L     @04,RSIOTBL(,REG6)                                  1929 07777000
         LA    @04,RSVOLENT(,@04)                                  1929 07778000
         ST    @04,RSENTPT(,REG6)                                  1929 07779000
*UPCTLP0:       DO UNTIL(RSENTPT = 0);                             1930 07780000
*                                                                  1930 07781000
UPCTLP0  DS    0H                                                  1930 07782000
@DL01930 DS    0H                                                  1931 07783000
*                 /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRLST    */ 07784000
*                 CALL IDCRS5SR('N','B',RSENTPT,NULLPTR);          1931 07785000
*                                                                  1931 07786000
*                                                                  1931 07787000
         MVC   @AL00001(16),@AL01931                               1931 07788000
         LA    @04,RSENTPT(,REG6)                                  1931 07789000
         ST    @04,@AL00001+8                                      1931 07790000
         L     @15,@CV03539                                        1931 07791000
         LA    @01,@AL00001                                        1931 07792000
         BALR  @14,@15                                             1931 07793000
*         /***********************************************************/ 07794000
*         /*                                                         */ 07795000
*         /*    THE VOLUME RECORD FOR THIS CRA VOLUME IS INVALID.    */ 07796000
*         /*    CALL CKERR TO PRINT MESSAGE.                         */ 07797000
*         /*                                                         */ 07798000
*         /***********************************************************/ 07799000
*                                                                  1932 07800000
*                 IF RSENTPT ^= 0 & RESVLBAD = ON                  1932 07801000
*                   THEN                                           1932 07802000
*                                                                  1932 07803000
         L     @04,RSENTPT(,REG6)                                  1932 07804000
         LTR   @04,@04                                             1932 07805000
         BZ    @RF01932                                            1932 07806000
         TM    RESVLBAD(@04),B'00010000'                           1932 07807000
         BNO   @RF01932                                            1932 07808000
*                     DO;                                          1933 07809000
*                     /*CALL CKERR*/                               1934 07810000
*                       RSCKERR = RSCKERR && RSCKERR;              1934 07811000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1934 07812000
*                       RSCKERN = RSE047;                          1935 07813000
         MVC   RSCKERN(2,REG6),@CH00752                            1935 07814000
*                       RSCKTERM = 'RETU';                         1936 07815000
         MVC   RSCKTERM(4,REG6),@CC03585                           1936 07816000
*                       RSCKMVAR(1) = ADDR(RESVLSER);              1937 07817000
*                                                                  1937 07818000
         LA    @04,RESVLSER(,@04)                                  1937 07819000
         ST    @04,RSCKMVAR(,REG6)                                 1937 07820000
*                     /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR  */ 07821000
*                     CALL CKERR;                                  1938 07822000
         L     @15,@CV03544                                        1938 07823000
         BALR  @14,@15                                             1938 07824000
*                     END;                                         1939 07825000
*                                                                  1939 07826000
*               END UPCTLP0;                                       1940 07827000
*                                                                  1940 07828000
@RF01932 DS    0H                                                  1940 07829000
@DE01930 L     @04,RSENTPT(,REG6)                                  1940 07830000
         LTR   @04,@04                                             1940 07831000
         BNZ   @DL01930                                            1940 07832000
*         /***********************************************************/ 07833000
*         /*                                                         */ 07834000
*         /*    IF NOIGNORE PARAMETER SPECIFIED, CALL CKERR TO       */ 07835000
*         /*    TERMINATE.                                           */ 07836000
*         /*                                                         */ 07837000
*         /***********************************************************/ 07838000
*                                                                  1941 07839000
*               IF RSIGNR = OFF                                    1941 07840000
*                 THEN                                             1941 07841000
*                                                                  1941 07842000
*                                                                  1941 07843000
         TM    RSIGNR(REG6),B'00000001'                            1941 07844000
         BNZ   @RF01941                                            1941 07845000
*                   DO;                                            1942 07846000
*                   /*CALL CKERR*/                                 1943 07847000
*                     RSCKERR = RSCKERR && RSCKERR;                1943 07848000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1943 07849000
*                     RSCKERN = RSE048;                            1944 07850000
         MVC   RSCKERN(2,REG6),@CH00986                            1944 07851000
*                     RSCKTERM = 'TERM';                           1945 07852000
*                                                                  1945 07853000
         MVC   RSCKTERM(4,REG6),@CC03543                           1945 07854000
*                   /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR    */ 07855000
*                   CALL CKERR;                                    1946 07856000
         L     @15,@CV03544                                        1946 07857000
         BALR  @14,@15                                             1946 07858000
*                   END;                                           1947 07859000
*                                                                  1947 07860000
*             END UPCTBVL;                                         1948 07861000
*                                                                  1948 07862000
@RF01941 DS    0H                                                  1949 07863000
*         /***********************************************************/ 07864000
*         /*                                                         */ 07865000
*         /*  IF ANY OF THE CRAS REQUIRED FOR UPDATE WAS             */ 07866000
*         /*  UNAVAILABLE, CALL CKERR TO TERMINATE.                  */ 07867000
*         /*                                                         */ 07868000
*         /***********************************************************/ 07869000
*                                                                  1949 07870000
*         IF RSCRAUA = ON                                          1949 07871000
*           THEN                                                   1949 07872000
*                                                                  1949 07873000
*                                                                  1949 07874000
@RF01927 TM    RSCRAUA(REG6),B'00010000'                           1949 07875000
         BNO   @RF01949                                            1949 07876000
*             DO;                                                  1950 07877000
*             /*CALL CKERR*/                                       1951 07878000
*               RSCKERR = RSCKERR && RSCKERR;                      1951 07879000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1951 07880000
*               RSCKERN = RSE039;                                  1952 07881000
         MVC   RSCKERN(2,REG6),@CH00970                            1952 07882000
*               RSCKTERM = 'TERM';                                 1953 07883000
*                                                                  1953 07884000
         MVC   RSCKTERM(4,REG6),@CC03543                           1953 07885000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 07886000
*             CALL CKERR;                                          1954 07887000
         L     @15,@CV03544                                        1954 07888000
         BALR  @14,@15                                             1954 07889000
*             END;                                                 1955 07890000
*                                                                  1955 07891000
*         /***********************************************************/ 07892000
*         /*                                                 @ZA18274*/ 07893000
*         /*  IF RECORDS ARE TO BE MOVED FROM THE OLD        @ZA18274*/ 07894000
*         /*  CATALOG'S CRA TO THE NEW CATALOG'S CRA, THEN   @ZA18274*/ 07895000
*         /*  OPEN THE NEW CATALOG'S CRA FOR UPDATE.         @ZA18274*/ 07896000
*         /*  USE THE DDNAME FROM THE RESVOL ENTRY IF        @ZA18274*/ 07897000
*         /*  FOUND, OTHERWISE USE THE CATALOG DDNAME.       @ZA18274*/ 07898000
*         /***********************************************************/ 07899000
*                                                                  1956 07900000
*         IF RSCHCRAN ^= 0 THEN DO;                        /*@ZA18274*/ 07901000
@RF01949 L     @04,RSCHCRAN(,REG6)                                 1956 07902000
         LTR   @04,@04                                             1956 07903000
         BZ    @RF01956                                            1956 07904000
*           RSCRVL = ADDR(RSINVLSR);                       /*@ZA18274*/ 07905000
         LA    @04,RSINVLSR(,REG6)                                 1958 07906000
         ST    @04,RSCRVL(,REG6)                                   1958 07907000
*           /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRLST          */ 07908000
*           CALL IDCRS5SR('V','B',RSENTPT,RSCRVL);      /*@ZA18274*/    07909000
         LA    @04,@CC00833                                        1959 07910000
         ST    @04,@AL00001                                        1959 07911000
         LA    @04,@CC00815                                        1959 07912000
         ST    @04,@AL00001+4                                      1959 07913000
         LA    @04,RSENTPT(,REG6)                                  1959 07914000
         ST    @04,@AL00001+8                                      1959 07915000
         LA    @04,RSCRVL(,REG6)                                   1959 07916000
         ST    @04,@AL00001+12                                     1959 07917000
         L     @15,@CV03539                                        1959 07918000
         LA    @01,@AL00001                                        1959 07919000
         BALR  @14,@15                                             1959 07920000
*           IF RSENTPT = 0 THEN RSCRADD = RSCADD;          /*@ZA18274*/ 07921000
         L     @04,RSENTPT(,REG6)                                  1960 07922000
         LTR   @04,@04                                             1960 07923000
         BNZ   @RF01960                                            1960 07924000
         L     @04,RSCADD(,REG6)                                   1961 07925000
         ST    @04,RSCRADD(,REG6)                                  1961 07926000
*           ELSE RSCRADD = ADDR(RESVLDDN);                 /*@ZA18274*/ 07927000
         B     @RC01960                                            1962 07928000
@RF01960 L     @04,RSENTPT(,REG6)                                  1962 07929000
         LA    @04,RESVLDDN(,@04)                                  1962 07930000
         ST    @04,RSCRADD(,REG6)                                  1962 07931000
*           /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSOPEN           */ 07932000
*           CALL IDCRS6DO('B','R','U',RSCRADD,NULLPTR,RSMRPAS);    1963 07933000
@RC01960 MVC   @AL00001(20),@AL01963                               1963 07934000
         LA    @04,RSCRADD(,REG6)                                  1963 07935000
         ST    @04,@AL00001+12                                     1963 07936000
         LA    @04,RSMRPAS(,REG6)                                  1963 07937000
         ST    @04,@AL00001+20                                     1963 07938000
         L     @15,@CV03580                                        1963 07939000
         LA    @01,@AL00001                                        1963 07940000
         BALR  @14,@15                                             1963 07941000
*           RESPECIFY RTNREG RSTD;                                 1964 07942000
*           TESTRC = RTNREG;                                       1965 07943000
         STH   RTNREG,TESTRC(,REG6)                                1965 07944000
*           RESPECIFY RTNREG UNRSTD;                       /*@ZA18274*/ 07945000
*           IF TESTRC = RCUERR1 THEN                               1967 07946000
         LH    @04,TESTRC(,REG6)                                   1967 07947000
         C     @04,@CF00046                                        1967 07948000
         BNE   @RF01967                                            1967 07949000
*                                     DO;                          1968 07950000
*                                     /*CALL CKERR*/               1969 07951000
*                                       RSCKERR = RSCKERR && RSCKERR;   07952000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1969 07953000
*                                       RSCKERN = RSE079;          1970 07954000
         MVC   RSCKERN(2,REG6),@CH01046                            1970 07955000
*                                       RSCKTERM = 'TERM';         1971 07956000
*                                                                  1971 07957000
         MVC   RSCKTERM(4,REG6),@CC03543                           1971 07958000
*                                     /* CALL TO MODULE IDCRS05 FOR PRO 07959000
*EDURE CKERR                                                         */ 07960000
*                                     CALL CKERR;                  1972 07961000
         L     @15,@CV03544                                        1972 07962000
         BALR  @14,@15                                             1972 07963000
*                                     END;                         1973 07964000
*                                                                  1973 07965000
*         /***********************************************************/ 07966000
*         /*                                                 @ZA18274*/ 07967000
*         /*  PRINT MESSAGE INDICATING RECORDS MOVED. READ   @ZA18274*/ 07968000
*         /*  CCR AND VOLUME RECORDS AND SAVE NEEDED INFO.   @ZA18274*/ 07969000
*         /*                                                 @ZA18274*/ 07970000
*         /***********************************************************/ 07971000
*                                                                  1974 07972000
*                                                                  1974 07973000
*           DO;                                                    1974 07974000
@RF01967 DS    0H                                                  1975 07975000
*           /*CALL CKERR*/                                         1975 07976000
*             RSCKERR = RSCKERR && RSCKERR;                        1975 07977000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1975 07978000
*             RSCKERN = RSE046;                                    1976 07979000
         MVC   RSCKERN(2,REG6),@CH00983                            1976 07980000
*             RSCKTERM = 'RETURN';                                 1977 07981000
*                                                                  1977 07982000
         MVC   RSCKTERM(4,REG6),@CC03584                           1977 07983000
*           /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR            */ 07984000
*           CALL CKERR;                                            1978 07985000
         L     @15,@CV03544                                        1978 07986000
         BALR  @14,@15                                             1978 07987000
*           END;                     /*@ZA18274*/                  1979 07988000
*           RSGRABCU = ADDR(GRABSCR);                      /*@ZA18274*/ 07989000
         L     @04,RSIOTBL(,REG6)                                  1980 07990000
         LA    @04,GRABSCR(,@04)                                   1980 07991000
         ST    @04,RSGRABCU(,REG6)                                 1980 07992000
*           GRABCURR = GRABRAB2;                           /*@ZA18274*/ 07993000
         L     @15,GRABRAB2(,@04)                                  1981 07994000
         ST    @15,GRABCURR(,@04)                                  1981 07995000
*           GRABAFLS = ''B;                                /*@ZA18274*/ 07996000
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       1982 07997000
*           GRABSIOT = ON;                                 /*@ZA18274*/ 07998000
         OI    GRABSIOT(@04),B'00000100'                           1983 07999000
*           RABRCDA = CCRCI;                               /*@ZA18274*/ 08000000
*                                                                  1984 08001000
         MVC   RABRCDA(4,@15),@CF00166                             1984 08002000
*           DO;                                                    1985 08003000
*             RSRTYPE = ''B;                                       1986 08004000
         MVI   RSRTYPE(REG6),X'00'                                 1986 08005000
*             RSRGET = ON;      /* GETRCD  */                      1987 08006000
         OI    RSRGET(REG6),B'10000000'                            1987 08007000
*             RSRUPD = ON;      /* UPDATE  */                      1988 08008000
         OI    RSRUPD(REG6),B'00001000'                            1988 08009000
*             RSRDS = ''B;                                         1989 08010000
         NI    RSRDS(REG6),B'00011111'                             1989 08011000
*             RSRCRA = ON;      /* CRA  */                         1990 08012000
*             RSRDIR = ON;      /* DIRECT  */                      1991 08013000
*             RSRKEY = OFF;     /* CNV  */                         1992 08014000
*                                                                  1992 08015000
         OI    RSRCRA(REG6),B'00100100'                            1992 08016000
         NI    RSRKEY(REG6),B'11101111'                            1992 08017000
*           /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT          */ 08018000
*           CALL RECMGMT;                                          1993 08019000
         L     @15,@CV03498                                        1993 08020000
         BALR  @14,@15                                             1993 08021000
*             RFY RTNREG RSTD;                                     1994 08022000
*             TESTRC = RTNREG;                                     1995 08023000
         STH   RTNREG,TESTRC(,REG6)                                1995 08024000
*             RFY RTNREG UNRSTD;                                   1996 08025000
*           END;              /*@ZA18274*/                         1997 08026000
*           GRABCURR = GRABRAB1;                           /*@ZA18274*/ 08027000
         L     @04,RSGRABCU(,REG6)                                 1998 08028000
         L     @15,GRABRAB1(,@04)                                  1998 08029000
         ST    @15,GRABCURR(,@04)                                  1998 08030000
*           RABRCDA = VOLCI;                               /*@ZA18274*/ 08031000
*                                                                  1999 08032000
         MVC   RABRCDA(4,@15),@CF00040                             1999 08033000
*           DO;                                                    2000 08034000
*             RSRTYPE = ''B;                                       2001 08035000
         MVI   RSRTYPE(REG6),X'00'                                 2001 08036000
*             RSRGET = ON;      /* GETRCD  */                      2002 08037000
         OI    RSRGET(REG6),B'10000000'                            2002 08038000
*             RSRUPD = OFF;     /* NO UPDATE  */                   2003 08039000
         NI    RSRUPD(REG6),B'11110111'                            2003 08040000
*             RSRDS = ''B;                                         2004 08041000
         NI    RSRDS(REG6),B'00011111'                             2004 08042000
*             RSRCRA = ON;      /* CRA  */                         2005 08043000
*             RSRDIR = ON;      /* DIRECT  */                      2006 08044000
*             RSRKEY = OFF;     /* CNV  */                         2007 08045000
*                                                                  2007 08046000
         OI    RSRCRA(REG6),B'00100100'                            2007 08047000
         NI    RSRKEY(REG6),B'11101111'                            2007 08048000
*           /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT          */ 08049000
*           CALL RECMGMT;                                          2008 08050000
         L     @15,@CV03498                                        2008 08051000
         BALR  @14,@15                                             2008 08052000
*             RFY RTNREG RSTD;                                     2009 08053000
*             TESTRC = RTNREG;                                     2010 08054000
         STH   RTNREG,TESTRC(,REG6)                                2010 08055000
*             RFY RTNREG UNRSTD;                                   2011 08056000
*           END;              /*@ZA18274*/                         2012 08057000
*           RSNCVLSR = RCDCRAVL;                           /*@ZA18274*/ 08058000
         L     @04,RSGRABCU(,REG6)                                 2013 08059000
         LA    @15,8                                               2013 08060000
         AL    @15,GRABCURR(,@04)                                  2013 08061000
         MVC   RSNCVLSR(6,REG6),RCDCRAVL(@15)                      2013 08062000
*           RSNCDEVT = RCDCRADT;                           /*@ZA18274*/ 08063000
         MVC   RSNCDEVT(4,REG6),RCDCRADT(@15)                      2014 08064000
*           RSNCTS   = RCDRACTS;                           /*@ZA18274*/ 08065000
         MVC   RSNCTS(4,REG6),RCDRACTS(@15)                        2015 08066000
*         END;                                             /*@ZA18274*/ 08067000
*                                                          /*@ZA18274*/ 08068000
*                                                                  2017 08069000
*         /***********************************************************/ 08070000
*         /*                                                         */ 08071000
*         /*  SET RECMGMT BUFFER POINTERS FOR WORKFILE AND           */ 08072000
*         /*  CATALOG.                                               */ 08073000
*         /*                                                         */ 08074000
*         /***********************************************************/ 08075000
*                                                                  2017 08076000
*         RSGRABCU = ADDR(GRABSCA);                                2017 08077000
@RF01956 L     @04,RSIOTBL(,REG6)                                  2017 08078000
         LA    @15,GRABSCA(,@04)                                   2017 08079000
         ST    @15,RSGRABCU(,REG6)                                 2017 08080000
*         GRABCURR = GRABRAB1;                                     2018 08081000
         L     @14,GRABRAB1(,@15)                                  2018 08082000
         ST    @14,GRABCURR(,@15)                                  2018 08083000
*         RSCABLP1 = ADDR(RABBUF);                                 2019 08084000
*                                                                  2019 08085000
         LA    @15,RABBUF(,@14)                                    2019 08086000
         ST    @15,RSCABLP1(,REG6)                                 2019 08087000
*         RSGRABCU = ADDR(GRABSWF);                                2020 08088000
         ST    @04,RSGRABCU(,REG6)                                 2020 08089000
*         GRABCURR = GRABRAB1;                                     2021 08090000
         L     @15,GRABRAB1(,@04)                                  2021 08091000
         ST    @15,GRABCURR(,@04)                                  2021 08092000
*         RSWFBP1 = ADDR(RABBUF);                                  2022 08093000
         LA    @15,RABBUF(,@15)                                    2022 08094000
         ST    @15,RSWFBP1(,REG6)                                  2022 08095000
*         GRABAFLS = ''B;                                          2023 08096000
*                                                                  2023 08097000
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       2023 08098000
*         /***********************************************************/ 08099000
*         /*                                                         */ 08100000
*         /*    INITIALIZE DELETED FREE COUNT AND FIRST              */ 08101000
*         /*                                                         */ 08102000
*         /***********************************************************/ 08103000
*                                                                  2024 08104000
*         RSAVAIL = 0;                                             2024 08105000
         SLR   @04,@04                                             2024 08106000
         ST    @04,RSAVAIL(,REG6)                                  2024 08107000
*         RSAVAILN = 0;                                            2025 08108000
*                                                                  2025 08109000
         ST    @04,RSAVAILN(,REG6)                                 2025 08110000
*         /***********************************************************/ 08111000
*         /*                                                         */ 08112000
*         /*  PROCESS CURRENT CATALOG EXTENTS IN WORKFILE.           */ 08113000
*         /*                                                         */ 08114000
*         /***********************************************************/ 08115000
*                                                                  2026 08116000
*UPCTLP1: DO RSIDX = 1 TO DIM(RSXCIENT)                            2026 08117000
*             WHILE (RSXCIBEG(RSIDX) < RSCAFUCI);                  2026 08118000
*                                                                  2026 08119000
UPCTLP1  LA    @04,1                                               2026 08120000
         STH   @04,RSIDX(,REG6)                                    2026 08121000
@DL02026 LH    @04,RSIDX(,REG6)                                    2026 08122000
         SLA   @04,4                                               2026 08123000
         L     @15,RSCIXLTA(,REG6)                                 2026 08124000
         LA    @01,0(@04,@15)                                      2026 08125000
         AL    @01,@CF03776                                        2026 08126000
         L     @14,RSXCIBEG-8(,@01)                                2026 08127000
         C     @14,RSCAFUCI(,REG6)                                 2026 08128000
         BNL   @DC02026                                            2026 08129000
*         /***********************************************************/ 08130000
*         /*                                                         */ 08131000
*         /*  PROCESS LOW KEY RANGE EXTENTS IN WORKFILE. HIGH KEY    */ 08132000
*         /*  RANGE EXTENTS ARE IGNORED.                             */ 08133000
*         /*                                                         */ 08134000
*         /***********************************************************/ 08135000
*                                                                  2027 08136000
*           IF RSXCIRNG(RSIDX) = OFF                               2027 08137000
*             THEN                                                 2027 08138000
         ALR   @15,@04                                             2027 08139000
         TM    RSXCIRNG-16(@15),B'10000000'                        2027 08140000
         BNZ   @RF02027                                            2027 08141000
*UPCTLKR:       DO;                                                2028 08142000
*                                                                  2028 08143000
UPCTLKR  DS    0H                                                  2029 08144000
*         /***********************************************************/ 08145000
*         /*                                                         */ 08146000
*         /*    COMPUTE ENDING CI AND RRN FOR THIS EXTENT.           */ 08147000
*         /*                                                         */ 08148000
*         /***********************************************************/ 08149000
*                                                                  2029 08150000
*                 RSXCIEND = RSXCIBEG(RSIDX) + RSXCILN(RSIDX) - 1; 2029 08151000
*                                                                  2029 08152000
         LH    @04,RSIDX(,REG6)                                    2029 08153000
         SLA   @04,4                                               2029 08154000
         L     @15,RSCIXLTA(,REG6)                                 2029 08155000
         LA    @01,0(@04,@15)                                      2029 08156000
         AL    @01,@CF03776                                        2029 08157000
         L     @14,RSXCIBEG-8(,@01)                                2029 08158000
         AL    @15,@CF03777                                        2029 08159000
         AL    @14,RSXCILN-12(@04,@15)                             2029 08160000
         BCTR  @14,0                                               2029 08161000
         ST    @14,RSXCIEND(,REG6)                                 2029 08162000
*         /***********************************************************/ 08163000
*         /*                                                         */ 08164000
*         /*    IF FIRST UNFORMATTED CI IS IN THIS EXTENT,           */ 08165000
*         /*    PROCESS UP TO LAST FORMATTED RECORD.                 */ 08166000
*         /*                                                         */ 08167000
*         /***********************************************************/ 08168000
*                                                                  2030 08169000
*                 IF RSXCIEND => RSCAFUCI                          2030 08170000
*                   THEN                                           2030 08171000
         L     @04,RSCAFUCI(,REG6)                                 2030 08172000
         CR    @14,@04                                             2030 08173000
         BL    @RF02030                                            2030 08174000
*                     RSXCIEND = RSCAFUCI - 1;                     2031 08175000
*                                                                  2031 08176000
         BCTR  @04,0                                               2031 08177000
         ST    @04,RSXCIEND(,REG6)                                 2031 08178000
*                 RSXRREND = RSXCIEND + RSXCIREL(RSIDX);           2032 08179000
*                                                                  2032 08180000
@RF02030 LH    @04,RSIDX(,REG6)                                    2032 08181000
         SLA   @04,4                                               2032 08182000
         L     @15,RSCIXLTA(,REG6)                                 2032 08183000
         L     @14,RSXCIREL-16(@04,@15)                            2032 08184000
         L     @03,RSXCIEND(,REG6)                                 2032 08185000
         ALR   @03,@14                                             2032 08186000
         ST    @03,RSXRREND(,REG6)                                 2032 08187000
*         /***********************************************************/ 08188000
*         /*                                                         */ 08189000
*         /*    POSITION TO FIRST RECORD IN WORKFILE FOR THIS        */ 08190000
*         /*    EXTENT VIA RECMGMT.                                  */ 08191000
*         /*                                                         */ 08192000
*         /***********************************************************/ 08193000
*                                                                  2033 08194000
*                 RSGRABCU = ADDR(GRABSWF);                        2033 08195000
         L     @03,RSIOTBL(,REG6)                                  2033 08196000
         ST    @03,RSGRABCU(,REG6)                                 2033 08197000
*                 RABRCDA = RSXCIBEG(RSIDX) + RSXCIREL(RSIDX);     2034 08198000
         L     @02,GRABCURR(,@03)                                  2034 08199000
         AL    @15,@CF03776                                        2034 08200000
         AL    @14,RSXCIBEG-8(@04,@15)                             2034 08201000
         ST    @14,RABRCDA(,@02)                                   2034 08202000
*                 RABRRN = ON;                                     2035 08203000
         OI    RABRRN(@02),B'00010000'                             2035 08204000
*                 GRABAFLS = ''B;                                  2036 08205000
*                                                                  2036 08206000
*                                                                  2036 08207000
         XC    GRABAFLS(2,@03),GRABAFLS(@03)                       2036 08208000
*                 DO;                                              2037 08209000
*                   RSRTYPE = ''B;                                 2038 08210000
         MVI   RSRTYPE(REG6),X'00'                                 2038 08211000
*                   RSRPOS = ON;      /* POSRCD  */                2039 08212000
         OI    RSRPOS(REG6),B'00010000'                            2039 08213000
*                   RSRDS = ''B;                                   2040 08214000
         NI    RSRDS(REG6),B'00011111'                             2040 08215000
*                   RSRWF = ON;       /* WORKFILE  */              2041 08216000
*                   RSRDIR = OFF;     /* SEQUENTIAL  */            2042 08217000
*                   RSRKEY = ON;      /* KEY  */                   2043 08218000
*                                                                  2043 08219000
         OI    RSRWF(REG6),B'10010000'                             2043 08220000
         NI    RSRDIR(REG6),B'11111011'                            2043 08221000
*                 /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT    */ 08222000
*                 CALL RECMGMT;                                    2044 08223000
         L     @15,@CV03498                                        2044 08224000
         BALR  @14,@15                                             2044 08225000
*                   RFY RTNREG RSTD;                               2045 08226000
*                   TESTRC = RTNREG;                               2046 08227000
         STH   RTNREG,TESTRC(,REG6)                                2046 08228000
*                   RFY RTNREG UNRSTD;                             2047 08229000
*                 END;                                             2048 08230000
*                                                                  2048 08231000
*         /***********************************************************/ 08232000
*         /*                                                         */ 08233000
*         /*    PROCESS VALID LOW KEY RANGE RECORDS FROM WORKFILE    */ 08234000
*         /*                                                         */ 08235000
*         /***********************************************************/ 08236000
*                                                                  2049 08237000
*UPCTLP2:         DO UNTIL (RABRCDA = RSXRREND);                   2049 08238000
*                                                                  2049 08239000
UPCTLP2  DS    0H                                                  2049 08240000
@DL02049 DS    0H                                                  2050 08241000
*                 RSUCTWWF = OFF;                                  2050 08242000
*                                                                  2050 08243000
         NI    RSUCTWWF(REG6),B'11111101'                          2050 08244000
*         /***********************************************************/ 08245000
*         /*                                                         */ 08246000
*         /*    READ WORKFILE LKR RECORD VIA RECMGMT.                */ 08247000
*         /*                                                         */ 08248000
*         /***********************************************************/ 08249000
*                                                                  2051 08250000
*                   RSGRABCU = ADDR(GRABSWF);                      2051 08251000
*                                                                  2051 08252000
*                                                                  2051 08253000
         L     @04,RSIOTBL(,REG6)                                  2051 08254000
         ST    @04,RSGRABCU(,REG6)                                 2051 08255000
*                   DO;                                            2052 08256000
*                     RSRTYPE = ''B;                               2053 08257000
         MVI   RSRTYPE(REG6),X'00'                                 2053 08258000
*                     RSRGET = ON;      /* GETRCD  */              2054 08259000
         OI    RSRGET(REG6),B'10000000'                            2054 08260000
*                     RSRUPD = ON;      /* UPDATE  */              2055 08261000
         OI    RSRUPD(REG6),B'00001000'                            2055 08262000
*                     RSRDS = ''B;                                 2056 08263000
         NI    RSRDS(REG6),B'00011111'                             2056 08264000
*                     RSRWF = ON;       /* WORKFILE  */            2057 08265000
*                     RSRDIR = OFF;     /* SEQUENTIAL  */          2058 08266000
*                     RSRKEY = ON;      /* KEY  */                 2059 08267000
*                                                                  2059 08268000
         OI    RSRWF(REG6),B'10010000'                             2059 08269000
         NI    RSRDIR(REG6),B'11111011'                            2059 08270000
*                   /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT  */ 08271000
*                   CALL RECMGMT;                                  2060 08272000
         L     @15,@CV03498                                        2060 08273000
         BALR  @14,@15                                             2060 08274000
*                     RFY RTNREG RSTD;                             2061 08275000
*                     TESTRC = RTNREG;                             2062 08276000
         STH   RTNREG,TESTRC(,REG6)                                2062 08277000
*                     RFY RTNREG UNRSTD;                           2063 08278000
*                   END;                                           2064 08279000
*                                                                  2064 08280000
*                   RESPECIFY RTNREG RSTD;                         2065 08281000
*                   TESTRC = RTNREG;                               2066 08282000
         STH   RTNREG,TESTRC(,REG6)                                2066 08283000
*                   RESPECIFY RTNREG UNRSTD;                       2067 08284000
*                                                                  2067 08285000
*         /***********************************************************/ 08286000
*         /*                                                         */ 08287000
*         /*    IF END OF FILE WAS REACHED IN WORKFILE, CALL         */ 08288000
*         /*    CKERR TO TERMINATE.                                  */ 08289000
*         /*                                                         */ 08290000
*         /***********************************************************/ 08291000
*                                                                  2068 08292000
*                   IF TESTRC = RCEOF                              2068 08293000
*                     THEN                                         2068 08294000
*                                                                  2068 08295000
*                                                                  2068 08296000
         LH    @04,TESTRC(,REG6)                                   2068 08297000
         C     @04,@CF00478                                        2068 08298000
         BNE   @RF02068                                            2068 08299000
*                       DO;                                        2069 08300000
*                       /*CALL CKERR*/                             2070 08301000
*                         RSCKERR = RSCKERR && RSCKERR;            2070 08302000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2070 08303000
*                         RSCKERN = RSE100;                        2071 08304000
         MVC   RSCKERN(2,REG6),@CH00151                            2071 08305000
*                         RSCKTERM = 'TERM';                       2072 08306000
*                                                                  2072 08307000
         MVC   RSCKTERM(4,REG6),@CC03543                           2072 08308000
*                       /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR*/ 08309000
*                       CALL CKERR;                                2073 08310000
         L     @15,@CV03544                                        2073 08311000
         BALR  @14,@15                                             2073 08312000
*                       END;                                       2074 08313000
*                                                                  2074 08314000
*         /***********************************************************/ 08315000
*         /*                                                         */ 08316000
*         /*    IF CI IN WORKFILE RECORD IS NOT CORRECT, UPDATE IT.  */ 08317000
*         /*                                                         */ 08318000
*         /***********************************************************/ 08319000
*                                                                  2075 08320000
*                   RSCURCI = RABRCDA - RSXCIREL(RSIDX);           2075 08321000
@RF02068 L     @04,RSGRABCU(,REG6)                                 2075 08322000
         L     @04,GRABCURR(,@04)                                  2075 08323000
         LH    @15,RSIDX(,REG6)                                    2075 08324000
         SLA   @15,4                                               2075 08325000
         L     @01,RSCIXLTA(,REG6)                                 2075 08326000
         L     @14,RABRCDA(,@04)                                   2075 08327000
         SL    @14,RSXCIREL-16(@15,@01)                            2075 08328000
         ST    @14,RSCURCI(,REG6)                                  2075 08329000
*                   IF RSCURCI ^= RCDCINO                          2076 08330000
*                     THEN                                         2076 08331000
         AL    @04,@CF00035                                        2076 08332000
         L     @15,RCDCINO-1(,@04)                                 2076 08333000
         LA    @15,0(,@15)                                         2076 08334000
         CR    @14,@15                                             2076 08335000
         BE    @RF02076                                            2076 08336000
*                       DO;                                        2077 08337000
*                         RCDCINO = RSCURCI;                       2078 08338000
         STCM  @14,7,RCDCINO(@04)                                  2078 08339000
*                         RSUCTWWF = ON;                           2079 08340000
         OI    RSUCTWWF(REG6),B'00000010'                          2079 08341000
*                       END;                                       2080 08342000
*                                                                  2080 08343000
*         /***********************************************************/ 08344000
*         /*                                                         */ 08345000
*         /*    RECORD MUST BE UPDATED IN THE CATALOG.               */ 08346000
*         /*                                                         */ 08347000
*         /***********************************************************/ 08348000
*                                                                  2081 08349000
*                   IF (RSWUPCAT = ON & RSWINVCI = OFF) |          2081 08350000
*                       RSWDLCAT = ON |                            2081 08351000
*                       RCDID = FREEID                             2081 08352000
*                     THEN                                         2081 08353000
@RF02076 L     @04,RSGRABCU(,REG6)                                 2081 08354000
         L     @04,GRABCURR(,@04)                                  2081 08355000
         TM    RSWUPCAT(@04),B'00100000'                           2081 08356000
         BNO   @GL00023                                            2081 08357000
         TM    RSWINVCI(@04),B'10000000'                           2081 08358000
         BZ    @RT02081                                            2081 08359000
@GL00023 L     @04,RSGRABCU(,REG6)                                 2081 08360000
         L     @04,GRABCURR(,@04)                                  2081 08361000
         TM    RSWDLCAT(@04),B'01000000'                           2081 08362000
         BO    @RT02081                                            2081 08363000
         CLI   RCDID+8(@04),C'F'                                   2081 08364000
         BNE   @RF02081                                            2081 08365000
@RT02081 DS    0H                                                  2082 08366000
*UPCTRP:                DO;                                        2082 08367000
*                                                                  2082 08368000
UPCTRP   DS    0H                                                  2083 08369000
*                         RSGRABCU = ADDR(GRABSCA);                2083 08370000
         L     @04,RSIOTBL(,REG6)                                  2083 08371000
         LA    @15,GRABSCA(,@04)                                   2083 08372000
         ST    @15,RSGRABCU(,REG6)                                 2083 08373000
*                         GRABCURR = GRABRAB1;                     2084 08374000
         L     @14,GRABRAB1(,@15)                                  2084 08375000
         ST    @14,GRABCURR(,@15)                                  2084 08376000
*                         GRABAFLS = ''B;                          2085 08377000
         XC    GRABAFLS(2,@15),GRABAFLS(@15)                       2085 08378000
*                         RABRCDA =                                2086 08379000
*                            ADDR(ADDR(GRABSWF) -> GRABCURR ->     2086 08380000
*                             RABBUF) -> RCDCINO;                  2086 08381000
*                                                                  2086 08382000
         L     @04,GRABCURR(,@04)                                  2086 08383000
         L     @04,RCDCINO+7(,@04)                                 2086 08384000
         LA    @04,0(,@04)                                         2086 08385000
         ST    @04,RABRCDA(,@14)                                   2086 08386000
*         /***********************************************************/ 08387000
*         /*                                                         */ 08388000
*         /*    THE CATALOG RECORD DOES NOT EXIST, OR IF IT DOES     */ 08389000
*         /*    EXIST, IT DOES NOT HAVE A TRUE NAME. THEREFORE DO    */ 08390000
*         /*    NOT READ THE CATALOG RECORD. SET RABADD ON AND       */ 08391000
*         /*    CLEAR THE CATALOG BUFFER. SET THE RDF,CIDF FIELDS.   */ 08392000
*         /*                                                         */ 08393000
*         /***********************************************************/ 08394000
*                                                                  2087 08395000
*                         IF RSCURCI => RSCANFCI                   2087 08396000
*                           THEN                                   2087 08397000
         L     @04,RSCURCI(,REG6)                                  2087 08398000
         C     @04,RSCANFCI(,REG6)                                 2087 08399000
         BL    @RF02087                                            2087 08400000
*                             DO;                                  2088 08401000
*                               RABADD = ON;                       2089 08402000
         OI    RABADD(@14),B'00100000'                             2089 08403000
*                               CABUFL1(1:256) = ''B;              2090 08404000
         L     @04,RSCABLP1(,REG6)                                 2090 08405000
         XC    CABUFL1(256,@04),CABUFL1(@04)                       2090 08406000
*                               CABUFL1(257:505) = ''B;            2091 08407000
         XC    CABUFL1+256(249,@04),CABUFL1+256(@04)               2091 08408000
*                               CABUFL1(506:CILEN) = RDFCIDF;      2092 08409000
         MVC   CABUFL1+505(7,@04),RDFCIDF                          2092 08410000
*                             END;                                 2093 08411000
*                                                                  2093 08412000
*         /***********************************************************/ 08413000
*         /*                                                         */ 08414000
*         /*    READ THE CATALOG LKR RECORD VIA RECMGMT.             */ 08415000
*         /*                                                         */ 08416000
*         /***********************************************************/ 08417000
*                                                                  2094 08418000
*                           ELSE                                   2094 08419000
*                                                                  2094 08420000
*                                                                  2094 08421000
*                             DO;                                  2094 08422000
         B     @RC02087                                            2094 08423000
@RF02087 DS    0H                                                  2095 08424000
*                               RSRTYPE = ''B;                     2095 08425000
         MVI   RSRTYPE(REG6),X'00'                                 2095 08426000
*                               RSRGET = ON;      /* GETRCD  */    2096 08427000
         OI    RSRGET(REG6),B'10000000'                            2096 08428000
*                               RSRUPD = ON;      /* UPDATE  */    2097 08429000
         OI    RSRUPD(REG6),B'00001000'                            2097 08430000
*                               RSRDS = ''B;                       2098 08431000
         NI    RSRDS(REG6),B'00011111'                             2098 08432000
*                               RSRCAT = ON;      /* CATALOG  */   2099 08433000
*                               RSRDIR = ON;      /* DIRECT  */    2100 08434000
*                               RSRKEY = OFF;     /* CNV  */       2101 08435000
*                                                                  2101 08436000
         OI    RSRCAT(REG6),B'01000100'                            2101 08437000
         NI    RSRKEY(REG6),B'11101111'                            2101 08438000
*                             /* CALL TO MODULE IDCRS06 FOR PROCEDURE R 08439000
*CMGMT                                                               */ 08440000
*                             CALL RECMGMT;                        2102 08441000
         L     @15,@CV03498                                        2102 08442000
         BALR  @14,@15                                             2102 08443000
*                               RFY RTNREG RSTD;                   2103 08444000
*                               TESTRC = RTNREG;                   2104 08445000
         STH   RTNREG,TESTRC(,REG6)                                2104 08446000
*                               RFY RTNREG UNRSTD;                 2105 08447000
*                             END;                                 2106 08448000
*                                                                  2106 08449000
*         /***********************************************************/ 08450000
*         /*                                                         */ 08451000
*         /*    ASSOCIATION NOT CHECKED FOR RECORD.                  */ 08452000
*         /*                                                         */ 08453000
*         /***********************************************************/ 08454000
*                                                                  2107 08455000
*                         RSGRABCU = ADDR(GRABSWF);                2107 08456000
@RC02087 L     @04,RSIOTBL(,REG6)                                  2107 08457000
         ST    @04,RSGRABCU(,REG6)                                 2107 08458000
*                         IF (RSWFCRA = ON & RSWASSCK = OFF) |     2108 08459000
*                            RSWDLCAT = ON                         2108 08460000
*                           THEN                                   2108 08461000
         L     @04,GRABCURR(,@04)                                  2108 08462000
         TM    RSWFCRA(@04),B'10000000'                            2108 08463000
         BNO   @GL00025                                            2108 08464000
         TM    RSWASSCK(@04),B'00000010'                           2108 08465000
         BZ    @RT02108                                            2108 08466000
@GL00025 L     @04,RSGRABCU(,REG6)                                 2108 08467000
         L     @04,GRABCURR(,@04)                                  2108 08468000
         TM    RSWDLCAT(@04),B'01000000'                           2108 08469000
         BNO   @RF02108                                            2108 08470000
@RT02108 DS    0H                                                  2109 08471000
*                             DO;                                  2109 08472000
*                                                                  2109 08473000
*         /***********************************************************/ 08474000
*         /*                                                         */ 08475000
*         /*    PREPARE FOR UPDATE CRA PROCESSING VIA ADDUPCR.       */ 08476000
*         /*                                                         */ 08477000
*         /***********************************************************/ 08478000
*                                                                  2110 08479000
*                               IF RSWFCRA = ON                    2110 08480000
*                                 THEN                             2110 08481000
*                                                                  2110 08482000
         L     @04,RSGRABCU(,REG6)                                 2110 08483000
         L     @04,GRABCURR(,@04)                                  2110 08484000
         TM    RSWFCRA(@04),B'10000000'                            2110 08485000
         BNO   @RF02110                                            2110 08486000
*                                   /* CALL TO MODULE IDCRS05 FOR PROCE 08487000
*URE ADDUPCR                                                         */ 08488000
*                                   CALL ADDUPCR;                  2111 08489000
*                                                                  2111 08490000
         L     @15,@CV03636                                        2111 08491000
         BALR  @14,@15                                             2111 08492000
*         /***********************************************************/ 08493000
*         /*                                                         */ 08494000
*         /*   INDICATE FREE RECORD                                  */ 08495000
*         /*                                                         */ 08496000
*         /***********************************************************/ 08497000
*                                                                  2112 08498000
*                               RCDID = FREEID;                    2112 08499000
*                                                                  2112 08500000
@RF02110 L     @04,RSGRABCU(,REG6)                                 2112 08501000
         L     @04,GRABCURR(,@04)                                  2112 08502000
         MVI   RCDID+8(@04),C'F'                                   2112 08503000
*                             END;                                 2113 08504000
*                                                                  2113 08505000
*         /***********************************************************/ 08506000
*         /*                                                         */ 08507000
*         /*  DETERMINE IF CATALOG RECORD HAS A TRUE NAME VIA        */ 08508000
*         /*  ENTNMCK.                                               */ 08509000
*         /*                                                         */ 08510000
*         /***********************************************************/ 08511000
*                                                                  2114 08512000
*                         /* CALL TO MODULE IDCRS05 FOR PROCEDURE ENTNM 08513000
*K                                                                   */ 08514000
*                         CALL IDCRS5EN('C');                      2114 08515000
*                                                                  2114 08516000
@RF02108 L     @15,@CV03677                                        2114 08517000
         LA    @01,@AL02114                                        2114 08518000
         BALR  @14,@15                                             2114 08519000
*                         RESPECIFY RTNREG RSTD;                   2115 08520000
*                         TESTRC = RTNREG;                         2116 08521000
         STH   RTNREG,TESTRC(,REG6)                                2116 08522000
*                         RESPECIFY RTNREG UNRSTD;                 2117 08523000
*                                                                  2117 08524000
*         /***********************************************************/ 08525000
*         /*                                                         */ 08526000
*         /*    SET TRUE NAME OR NO TRUE NAME INDICATOR.             */ 08527000
*         /*                                                         */ 08528000
*         /***********************************************************/ 08529000
*                                                                  2118 08530000
*                         IF TESTRC = 0                            2118 08531000
*                           THEN                                   2118 08532000
         LH    @04,TESTRC(,REG6)                                   2118 08533000
         LTR   @04,@04                                             2118 08534000
         BNZ   @RF02118                                            2118 08535000
*                             DO;                                  2119 08536000
*                                                                  2119 08537000
*         /***********************************************************/ 08538000
*         /*                                                         */ 08539000
*         /*    SAVE TRUE NAME AND CI                                */ 08540000
*         /*                                                         */ 08541000
*         /***********************************************************/ 08542000
*                                                                  2120 08543000
*                               RSGRABCU = ADDR(GRABSCA);          2120 08544000
         L     @04,RSIOTBL(,REG6)                                  2120 08545000
         LA    @04,GRABSCA(,@04)                                   2120 08546000
         ST    @04,RSGRABCU(,REG6)                                 2120 08547000
*                               RSUCCATN = ON;                     2121 08548000
         OI    RSUCCATN(REG6),B'00001000'                          2121 08549000
*                               RSCATTN = CNAME;                   2122 08550000
         LA    @15,8                                               2122 08551000
         AL    @15,GRABCURR(,@04)                                  2122 08552000
         MVC   RSCATTN(44,REG6),CNAME(@15)                         2122 08553000
*                               RSCATNCI = RCDCINO;                2123 08554000
         MVC   RSCATNCI(3,REG6),RCDCINO(@15)                       2123 08555000
*                             END;                                 2124 08556000
*                                                                  2124 08557000
*                           ELSE                                   2125 08558000
*                             RSUCCATN = OFF;                      2125 08559000
*                                                                  2125 08560000
         B     @RC02118                                            2125 08561000
@RF02118 NI    RSUCCATN(REG6),B'11110111'                          2125 08562000
*         /***********************************************************/ 08563000
*         /*                                                         */ 08564000
*         /*  DETERMINE IF WORKFILE RECORD HAS A TRUE NAME VIA        * 08565000
*         /*  ENTNMCK.                                               */ 08566000
*         /*                                                         */ 08567000
*         /***********************************************************/ 08568000
*                                                                  2126 08569000
*                         /* CALL TO MODULE IDCRS05 FOR PROCEDURE ENTNM 08570000
*K                                                                   */ 08571000
*                         CALL IDCRS5EN('W');                      2126 08572000
*                                                                  2126 08573000
@RC02118 L     @15,@CV03677                                        2126 08574000
         LA    @01,@AL02126                                        2126 08575000
         BALR  @14,@15                                             2126 08576000
*                         RESPECIFY RTNREG RSTD;                   2127 08577000
*                         TESTRC = RTNREG;                         2128 08578000
         STH   RTNREG,TESTRC(,REG6)                                2128 08579000
*                         RESPECIFY RTNREG UNRSTD;                 2129 08580000
*                                                                  2129 08581000
*         /***********************************************************/ 08582000
*         /*                                                         */ 08583000
*         /*    SET TRUE NAME OR NO TRUE NAME INDICATOR.             */ 08584000
*         /*                                                         */ 08585000
*         /***********************************************************/ 08586000
*                                                                  2130 08587000
*                         IF TESTRC = 0                            2130 08588000
*                           THEN                                   2130 08589000
         LH    @04,TESTRC(,REG6)                                   2130 08590000
         LTR   @04,@04                                             2130 08591000
         BNZ   @RF02130                                            2130 08592000
*                             RSUCWFTN = ON;                       2131 08593000
         OI    RSUCWFTN(REG6),B'00000100'                          2131 08594000
*                           ELSE                                   2132 08595000
*                             RSUCWFTN = OFF;                      2132 08596000
*                                                                  2132 08597000
         B     @RC02130                                            2132 08598000
@RF02130 NI    RSUCWFTN(REG6),B'11111011'                          2132 08599000
*         /***********************************************************/ 08600000
*         /*                                                         */ 08601000
*         /*    FORMAT A FREE RECORD IN THE CATALOG LKR BUFFER.      */ 08602000
*         /*                                                         */ 08603000
*         /***********************************************************/ 08604000
*                                                                  2133 08605000
*                         RSGRABCU = ADDR(GRABSWF);                2133 08606000
@RC02130 L     @04,RSIOTBL(,REG6)                                  2133 08607000
         ST    @04,RSGRABCU(,REG6)                                 2133 08608000
*                         IF RCDID = FREEID                        2134 08609000
*                           THEN                                   2134 08610000
         LA    @15,8                                               2134 08611000
         L     @14,GRABCURR(,@04)                                  2134 08612000
         ALR   @14,@15                                             2134 08613000
         CLI   RCDID(@14),C'F'                                     2134 08614000
         BNE   @RF02134                                            2134 08615000
*                             DO;                                  2135 08616000
*                                                                  2135 08617000
*         /***********************************************************/ 08618000
*         /*                                                         */ 08619000
*         /*    FORMAT A FREE RECORD                                 */ 08620000
*         /*                                                         */ 08621000
*         /***********************************************************/ 08622000
*                                                                  2136 08623000
*                               CABUFL1(1:256) = ''B;              2136 08624000
         L     @14,RSCABLP1(,REG6)                                 2136 08625000
         XC    CABUFL1(256,@14),CABUFL1(@14)                       2136 08626000
*                               CABUFL1(257:CELEN) = ''B;          2137 08627000
         XC    CABUFL1+256(249,@14),CABUFL1+256(@14)               2137 08628000
*                               RSGRABCU = ADDR(GRABSCA);          2138 08629000
         LA    @04,GRABSCA(,@04)                                   2138 08630000
         ST    @04,RSGRABCU(,REG6)                                 2138 08631000
*                               RCDID = FREEID;                    2139 08632000
         AL    @15,GRABCURR(,@04)                                  2139 08633000
         MVI   RCDID(@15),C'F'                                     2139 08634000
*                               RCDCINO = RSCURCI;                 2140 08635000
         L     @04,RSCURCI(,REG6)                                  2140 08636000
         STCM  @04,7,RCDCINO(@15)                                  2140 08637000
*                               RSUPENTF = RSAVAIL;                2141 08638000
*                                                                  2141 08639000
         MVC   RSUPENTF(3,@15),RSAVAIL+1(REG6)                     2141 08640000
*         /***********************************************************/ 08641000
*         /*                                                         */ 08642000
*         /*    UPDATE DELETED FREE COUNT AND FIRST FREE             */ 08643000
*         /*                                                         */ 08644000
*         /***********************************************************/ 08645000
*                                                                  2142 08646000
*                               RSAVAIL = RSCURCI;                 2142 08647000
         ST    @04,RSAVAIL(,REG6)                                  2142 08648000
*                               RSAVAILN = RSAVAILN + 1;           2143 08649000
         LA    @04,1                                               2143 08650000
         AL    @04,RSAVAILN(,REG6)                                 2143 08651000
         ST    @04,RSAVAILN(,REG6)                                 2143 08652000
*                             END;                                 2144 08653000
*                                                                  2144 08654000
*         /***********************************************************/ 08655000
*         /*                                                         */ 08656000
*         /*    MOVE WORKFILE RECORD TO CATALOG LKR BUFFER           */ 08657000
*         /*                                                         */ 08658000
*         /***********************************************************/ 08659000
*                                                                  2145 08660000
*                           ELSE                                   2145 08661000
*                             DO;                                  2145 08662000
         B     @RC02134                                            2145 08663000
@RF02134 DS    0H                                                  2146 08664000
*                               CABUFL1(1:256) = WFBUF1(1:256);    2146 08665000
         L     @04,RSCABLP1(,REG6)                                 2146 08666000
         L     @15,RSWFBP1(,REG6)                                  2146 08667000
         MVC   CABUFL1(256,@04),WFBUF1(@15)                        2146 08668000
*                               CABUFL1(257:CELEN) = WFBUF1(257:CELEN); 08669000
         MVC   CABUFL1+256(249,@04),WFBUF1+256(@15)                2147 08670000
*                             END;                                 2148 08671000
*                                                                  2148 08672000
*         /***********************************************************/ 08673000
*         /*                                                 @ZA18274*/ 08674000
*         /*    IF THE MOVE TO NEW CRA INDICATOR IS ON,      @ZA18274*/ 08675000
*         /*    FIND THE NEXT AVAILABLE CI IN THE NEW        @ZA18274*/ 08676000
*         /*    CATALOG'S CRA AND WRITE THE CRA RECORD WITH  @ZA18274*/ 08677000
*         /*    UPDATE CRA INFORMATION TO THAT CI IN THE     @ZA18274*/ 08678000
*         /*    CRA. UPDATE THE CRA INFORMATION IN THE       @ZA18274*/ 08679000
*         /*    CATALOG BUFFER, ALSO, AND MAKE THE RECORD    @ZA18274*/ 08680000
*         /*    IN THE WORKFILE A 'FREE' RECORD.             @ZA18274*/ 08681000
*         /*                                                 @ZA18274*/ 08682000
*         /***********************************************************/ 08683000
*                                                                  2149 08684000
*                         RSGRABCU = ADDR(GRABSWF);        /*@ZA18274*/ 08685000
@RC02134 L     @04,RSIOTBL(,REG6)                                  2149 08686000
         ST    @04,RSGRABCU(,REG6)                                 2149 08687000
*                         IF RSWCHRA = ON & RCDID ^= FREEID        2150 08688000
*                           THEN DO;                       /*@ZA18274*/ 08689000
         L     @15,GRABCURR(,@04)                                  2150 08690000
         TM    RSWCHRA(@15),B'00000010'                            2150 08691000
         BNO   @RF02150                                            2150 08692000
         LA    @14,8                                               2150 08693000
         LR    @03,@15                                             2150 08694000
         ALR   @03,@14                                             2150 08695000
         CLI   RCDID(@03),C'F'                                     2150 08696000
         BE    @RF02150                                            2150 08697000
*                           RSWUPCRA = ON;                 /*@ZA18274*/ 08698000
         OI    RSWUPCRA(@15),B'00010000'                           2152 08699000
*                           RCDID = FREEID;                /*@ZA18274*/ 08700000
         MVI   RCDID(@03),C'F'                                     2153 08701000
*                           RSGRABCU = ADDR(GRABSCA);      /*@ZA18274*/ 08702000
         LA    @15,GRABSCA(,@04)                                   2154 08703000
         ST    @15,RSGRABCU(,REG6)                                 2154 08704000
*                           RCDCRAVL = RSNCVLSR;           /*@ZA18274*/ 08705000
         L     @15,GRABCURR(,@15)                                  2155 08706000
         ALR   @15,@14                                             2155 08707000
         MVC   RCDCRAVL(6,@15),RSNCVLSR(REG6)                      2155 08708000
*                           RCDCRADT = RSNCDEVT;           /*@ZA18274*/ 08709000
         MVC   RCDCRADT(4,@15),RSNCDEVT(REG6)                      2156 08710000
*                           RCDRACTS = RSNCTS;             /*@ZA18274*/ 08711000
         MVC   RCDRACTS(4,@15),RSNCTS(REG6)                        2157 08712000
*                           RFY CCR BASED(RSCRBP1);        /*@ZA18274*/ 08713000
*                           RSGRABCU = ADDR(GRABSCR);      /*@ZA18274*/ 08714000
         LA    @15,GRABSCR(,@04)                                   2159 08715000
         ST    @15,RSGRABCU(,REG6)                                 2159 08716000
*                           GRABCURR = GRABRAB2;           /*@ZA18274*/ 08717000
         L     @03,GRABRAB2(,@15)                                  2160 08718000
         ST    @03,GRABCURR(,@15)                                  2160 08719000
*                           RSCRBP1 = ADDR(RABBUF);        /*@ZA18274*/ 08720000
         LA    @03,RABBUF(,@03)                                    2161 08721000
         ST    @03,RSCRBP1(,REG6)                                  2161 08722000
*                           GRABCURR = GRABRAB1;           /*@ZA18274*/ 08723000
         L     @02,GRABRAB1(,@15)                                  2162 08724000
         ST    @02,GRABCURR(,@15)                                  2162 08725000
*                           IF CCRCDCI ^= 0 THEN DO;       /*@ZA18274*/ 08726000
         ICM   @15,7,CCRCDCI(@03)                                  2163 08727000
         BZ    @RF02163                                            2163 08728000
*                             ADDR(ADDR(GRABSCA) -> GRABCURR -> RABBUF) 08729000
*                              -> RCDCRACI = CCRFDCI;      /*@ZA18274*/ 08730000
         AL    @14,GRABCURR+40(,@04)                               2165 08731000
         SLR   @04,@04                                             2165 08732000
         ICM   @04,7,CCRFDCI(@03)                                  2165 08733000
         STCM  @04,7,RCDCRACI(@14)                                 2165 08734000
*                             RABRCDA = CCRFDCI;           /*@ZA18274*/ 08735000
*                                                                  2166 08736000
         ST    @04,RABRCDA(,@02)                                   2166 08737000
*                             DO;                                  2167 08738000
*                               RSRTYPE = ''B;                     2168 08739000
         MVI   RSRTYPE(REG6),X'00'                                 2168 08740000
*                               RSRGET = ON;      /* GETRCD  */    2169 08741000
         OI    RSRGET(REG6),B'10000000'                            2169 08742000
*                               RSRUPD = ON;      /* UPDATE  */    2170 08743000
         OI    RSRUPD(REG6),B'00001000'                            2170 08744000
*                               RSRDS = ''B;                       2171 08745000
         NI    RSRDS(REG6),B'00011111'                             2171 08746000
*                               RSRCRA = ON;      /* CRA  */       2172 08747000
*                               RSRDIR = ON;      /* DIRECT  */    2173 08748000
*                               RSRKEY = OFF;     /* CNV  */       2174 08749000
*                                                                  2174 08750000
         OI    RSRCRA(REG6),B'00100100'                            2174 08751000
         NI    RSRKEY(REG6),B'11101111'                            2174 08752000
*                             /* CALL TO MODULE IDCRS06 FOR PROCEDURE R 08753000
*CMGMT                                                               */ 08754000
*                             CALL RECMGMT;                        2175 08755000
         L     @15,@CV03498                                        2175 08756000
         BALR  @14,@15                                             2175 08757000
*                               RFY RTNREG RSTD;                   2176 08758000
*                               TESTRC = RTNREG;                   2177 08759000
         STH   RTNREG,TESTRC(,REG6)                                2177 08760000
*                               RFY RTNREG UNRSTD;                 2178 08761000
*                             END;                                 2179 08762000
*                             CCRFDCI = RSUPENTF;          /*@ZA18274*/ 08763000
         L     @04,RSCRBP1(,REG6)                                  2180 08764000
         L     @01,RSGRABCU(,REG6)                                 2180 08765000
         L     @01,GRABCURR(,@01)                                  2180 08766000
         MVC   CCRFDCI(3,@04),RSUPENTF+8(@01)                      2180 08767000
*                             CCRCDCI = CCRCDCI - 1;       /*@ZA18274*/ 08768000
         SLR   @15,@15                                             2181 08769000
         ICM   @15,7,CCRCDCI(@04)                                  2181 08770000
         BCTR  @15,0                                               2181 08771000
         STCM  @15,7,CCRCDCI(@04)                                  2181 08772000
*                           END;                           /*@ZA18274*/ 08773000
*                           ELSE DO;                       /*@ZA18274*/ 08774000
         B     @RC02163                                            2183 08775000
@RF02163 DS    0H                                                  2184 08776000
*                             ADDR(ADDR(GRABSCA) -> GRABCURR -> RABBUF) 08777000
*                              -> RCDCRACI = CCRNFCI;      /*@ZA18274*/ 08778000
         L     @04,RSIOTBL(,REG6)                                  2184 08779000
         L     @04,GRABCURR+40(,@04)                               2184 08780000
         L     @15,RSCRBP1(,REG6)                                  2184 08781000
         SLR   @14,@14                                             2184 08782000
         ICM   @14,7,CCRNFCI(@15)                                  2184 08783000
         STCM  @14,7,RCDCRACI+8(@04)                               2184 08784000
*                             RABRCDA = CCRNFCI;           /*@ZA18274*/ 08785000
         L     @04,RSGRABCU(,REG6)                                 2185 08786000
         L     @04,GRABCURR(,@04)                                  2185 08787000
         ST    @14,RABRCDA(,@04)                                   2185 08788000
*                             CCRNFCI = CCRNFCI + 1;       /*@ZA18274*/ 08789000
         AL    @14,@CF00219                                        2186 08790000
         STCM  @14,7,CCRNFCI(@15)                                  2186 08791000
*                             RABADD = ON;                 /*@ZA18274*/ 08792000
         OI    RABADD(@04),B'00100000'                             2187 08793000
*                           END;                           /*@ZA18274*/ 08794000
*                           RFY CCR;                       /*@ZA18274*/ 08795000
@RC02163 DS    0H                                                  2190 08796000
*                           RSCRBP1 = ADDR(RABBUF);        /*@ZA18274*/ 08797000
         L     @04,RSGRABCU(,REG6)                                 2190 08798000
         L     @04,GRABCURR(,@04)                                  2190 08799000
         LA    @15,RABBUF(,@04)                                    2190 08800000
         ST    @15,RSCRBP1(,REG6)                                  2190 08801000
*                           CRBUF1(1:256) = CABUFL1(1:256);/*@ZA18274*/ 08802000
         L     @14,RSCABLP1(,REG6)                                 2191 08803000
         MVC   CRBUF1(256,@15),CABUFL1(@14)                        2191 08804000
*                           CRBUF1(257:CELEN) =                    2192 08805000
*                            CABUFL1(257:CELEN);           /*@ZA18274*/ 08806000
         MVC   CRBUF1+256(249,@15),CABUFL1+256(@14)                2192 08807000
*                           IF RABADD = ON THEN DO;                2193 08808000
         TM    RABADD(@04),B'00100000'                             2193 08809000
         BNO   @RF02193                                            2193 08810000
*                             CRBUF1(CELEN+1:CILEN) =              2195 08811000
*                               CABUFL1(CELEN+1:CILEN);    /*@ZA18274*/ 08812000
*                                                                  2195 08813000
         MVC   CRBUF1+505(7,@15),CABUFL1+505(@14)                  2195 08814000
*                             DO;                                  2196 08815000
*                               RSRTYPE = ''B;                     2197 08816000
         MVI   RSRTYPE(REG6),X'00'                                 2197 08817000
*                               RSRADD = ON;      /* ADDRCD  */    2198 08818000
         OI    RSRADD(REG6),B'01000000'                            2198 08819000
*                               RSRUPD = OFF;     /* NO UPDATE  */ 2199 08820000
         NI    RSRUPD(REG6),B'11110111'                            2199 08821000
*                               RSRDS = ''B;                       2200 08822000
         NI    RSRDS(REG6),B'00011111'                             2200 08823000
*                               RSRCRA = ON;      /* CRA  */       2201 08824000
*                               RSRDIR = ON;      /* DIRECT  */    2202 08825000
*                               RSRKEY = OFF;     /* CNV  */       2203 08826000
*                                                                  2203 08827000
         OI    RSRCRA(REG6),B'00100100'                            2203 08828000
         NI    RSRKEY(REG6),B'11101111'                            2203 08829000
*                             /* CALL TO MODULE IDCRS06 FOR PROCEDURE R 08830000
*CMGMT                                                               */ 08831000
*                             CALL RECMGMT;                        2204 08832000
         L     @15,@CV03498                                        2204 08833000
         BALR  @14,@15                                             2204 08834000
*                               RFY RTNREG RSTD;                   2205 08835000
*                               TESTRC = RTNREG;                   2206 08836000
         STH   RTNREG,TESTRC(,REG6)                                2206 08837000
*                               RFY RTNREG UNRSTD;                 2207 08838000
*                             END;     /*@ZA18274*/                2208 08839000
*                             RABADD = OFF;                /*@ZA18274*/ 08840000
         L     @04,RSGRABCU(,REG6)                                 2209 08841000
         L     @04,GRABCURR(,@04)                                  2209 08842000
         NI    RABADD(@04),B'11011111'                             2209 08843000
*                           END;                           /*@ZA18274*/ 08844000
*                           ELSE                                   2211 08845000
*                                                                  2211 08846000
*                             DO;                                  2211 08847000
         B     @RC02193                                            2211 08848000
@RF02193 DS    0H                                                  2212 08849000
*                               RSRTYPE = ''B;                     2212 08850000
         MVI   RSRTYPE(REG6),X'00'                                 2212 08851000
*                               RSRUPDT = ON;     /* UPDRCD  */    2213 08852000
         OI    RSRUPDT(REG6),B'00100000'                           2213 08853000
*                               RSRUPD = ON;      /* UPDATE  */    2214 08854000
         OI    RSRUPD(REG6),B'00001000'                            2214 08855000
*                               RSRDS = ''B;                       2215 08856000
         NI    RSRDS(REG6),B'00011111'                             2215 08857000
*                               RSRCRA = ON;      /* CRA  */       2216 08858000
*                               RSRDIR = ON;      /* DIRECT  */    2217 08859000
*                               RSRKEY = OFF;     /* CNV  */       2218 08860000
*                                                                  2218 08861000
         OI    RSRCRA(REG6),B'00100100'                            2218 08862000
         NI    RSRKEY(REG6),B'11101111'                            2218 08863000
*                             /* CALL TO MODULE IDCRS06 FOR PROCEDURE R 08864000
*CMGMT                                                               */ 08865000
*                             CALL RECMGMT;                        2219 08866000
         L     @15,@CV03498                                        2219 08867000
         BALR  @14,@15                                             2219 08868000
*                               RFY RTNREG RSTD;                   2220 08869000
*                               TESTRC = RTNREG;                   2221 08870000
         STH   RTNREG,TESTRC(,REG6)                                2221 08871000
*                               RFY RTNREG UNRSTD;                 2222 08872000
*                             END;     /*@ZA18274*/                2223 08873000
*                         END;                             /*@ZA18274*/ 08874000
*                                                                  2224 08875000
@RC02193 DS    0H                                                  2225 08876000
*         /***********************************************************/ 08877000
*         /*                                                         */ 08878000
*         /*    WRITE CATALOG LKR RECORD VIA RECMGMT.                */ 08879000
*         /*                                                         */ 08880000
*         /***********************************************************/ 08881000
*                                                                  2225 08882000
*                         RSGRABCU = ADDR(GRABSCA);                2225 08883000
*                                                                  2225 08884000
@RF02150 L     @04,RSIOTBL(,REG6)                                  2225 08885000
         LA    @04,GRABSCA(,@04)                                   2225 08886000
         ST    @04,RSGRABCU(,REG6)                                 2225 08887000
*         /***********************************************************/ 08888000
*         /*                                                         */ 08889000
*         /*    ATTEMPT TO ADD RECORD TO CATALOG BY KEY. SET GRABS   */ 08890000
*         /*    FLAG FOR SPECIAL DUPLICATE KEY PROCESSING.           */ 08891000
*         /*                                                         */ 08892000
*         /***********************************************************/ 08893000
*                                                                  2226 08894000
*                         IF RABADD = ON                           2226 08895000
*                           THEN                                   2226 08896000
         L     @01,GRABCURR(,@04)                                  2226 08897000
         TM    RABADD(@01),B'00100000'                             2226 08898000
         BNO   @RF02226                                            2226 08899000
*                             DO;                                  2227 08900000
*                               GRABSDUP = ON;                     2228 08901000
*                                                                  2228 08902000
*                                                                  2228 08903000
         OI    GRABSDUP(@04),B'00000001'                           2228 08904000
*                               DO;                                2229 08905000
*                                 RSRTYPE = ''B;                   2230 08906000
         MVI   RSRTYPE(REG6),X'00'                                 2230 08907000
*                                 RSRADD = ON;      /* ADDRCD  */  2231 08908000
         OI    RSRADD(REG6),B'01000000'                            2231 08909000
*                                 RSRUPD = OFF;     /* NO UPDATE  */    08910000
         NI    RSRUPD(REG6),B'11110111'                            2232 08911000
*                                 RSRDS = ''B;                     2233 08912000
         NI    RSRDS(REG6),B'00011111'                             2233 08913000
*                                 RSRCAT = ON;      /* CATALOG  */ 2234 08914000
*                                 RSRDIR = OFF;     /* SEQUENTIAL  */   08915000
*                                 RSRKEY = ON;      /* KEY  */     2236 08916000
*                                                                  2236 08917000
         OI    RSRCAT(REG6),B'01010000'                            2236 08918000
         NI    RSRDIR(REG6),B'11111011'                            2236 08919000
*                               /* CALL TO MODULE IDCRS06 FOR PROCEDURE 08920000
*RECMGMT                                                             */ 08921000
*                               CALL RECMGMT;                      2237 08922000
         L     @15,@CV03498                                        2237 08923000
         BALR  @14,@15                                             2237 08924000
*                                 RFY RTNREG RSTD;                 2238 08925000
*                                 TESTRC = RTNREG;                 2239 08926000
         STH   RTNREG,TESTRC(,REG6)                                2239 08927000
*                                 RFY RTNREG UNRSTD;               2240 08928000
*                               END;                               2241 08929000
*                                                                  2241 08930000
*         /***********************************************************/ 08931000
*         /*                                                         */ 08932000
*         /*    IF RECORD WAS A DUPLICATE, UPDATE IT BY CI           */ 08933000
*         /*                                                         */ 08934000
*         /***********************************************************/ 08935000
*                                                                  2242 08936000
*                               IF RABDUP = ON                     2242 08937000
*                                 THEN                             2242 08938000
         L     @04,RSGRABCU(,REG6)                                 2242 08939000
         L     @04,GRABCURR(,@04)                                  2242 08940000
         TM    RABDUP(@04),B'00000001'                             2242 08941000
         BNO   @RF02242                                            2242 08942000
*                                   DO;                            2243 08943000
*                                     RABDUP = OFF;                2244 08944000
*                                     RABADD = OFF;                2245 08945000
         NI    RABDUP(@04),B'11011110'                             2245 08946000
*                                   END;                           2246 08947000
*                               GRABSDUP = OFF;                    2247 08948000
@RF02242 L     @04,RSGRABCU(,REG6)                                 2247 08949000
         NI    GRABSDUP(@04),B'11111110'                           2247 08950000
*                             END;                                 2248 08951000
*                                                                  2248 08952000
*         /***********************************************************/ 08953000
*         /*                                                         */ 08954000
*         /*    UPDATE RECORD IN CATALOG BY CI                       */ 08955000
*         /*                                                         */ 08956000
*         /***********************************************************/ 08957000
*                                                                  2249 08958000
*                         IF RABADD = OFF                          2249 08959000
*                           THEN                                   2249 08960000
*                                                                  2249 08961000
*                                                                  2249 08962000
@RF02226 L     @04,RSGRABCU(,REG6)                                 2249 08963000
         L     @04,GRABCURR(,@04)                                  2249 08964000
         TM    RABADD(@04),B'00100000'                             2249 08965000
         BNZ   @RF02249                                            2249 08966000
*                             DO;                                  2250 08967000
*                               RSRTYPE = ''B;                     2251 08968000
         MVI   RSRTYPE(REG6),X'00'                                 2251 08969000
*                               RSRUPDT = ON;     /* UPDRCD  */    2252 08970000
         OI    RSRUPDT(REG6),B'00100000'                           2252 08971000
*                               RSRUPD = ON;      /* UPDATE  */    2253 08972000
         OI    RSRUPD(REG6),B'00001000'                            2253 08973000
*                               RSRDS = ''B;                       2254 08974000
         NI    RSRDS(REG6),B'00011111'                             2254 08975000
*                               RSRCAT = ON;      /* CATALOG  */   2255 08976000
*                               RSRDIR = ON;      /* DIRECT  */    2256 08977000
*                               RSRKEY = OFF;     /* CNV  */       2257 08978000
*                                                                  2257 08979000
         OI    RSRCAT(REG6),B'01000100'                            2257 08980000
         NI    RSRKEY(REG6),B'11101111'                            2257 08981000
*                             /* CALL TO MODULE IDCRS06 FOR PROCEDURE R 08982000
*CMGMT                                                               */ 08983000
*                             CALL RECMGMT;                        2258 08984000
         L     @15,@CV03498                                        2258 08985000
         BALR  @14,@15                                             2258 08986000
*                               RFY RTNREG RSTD;                   2259 08987000
*                               TESTRC = RTNREG;                   2260 08988000
         STH   RTNREG,TESTRC(,REG6)                                2260 08989000
*                               RFY RTNREG UNRSTD;                 2261 08990000
*                             END;                                 2262 08991000
*                                                                  2262 08992000
*                         RABADD = OFF;                            2263 08993000
*                                                                  2263 08994000
@RF02249 L     @04,RSGRABCU(,REG6)                                 2263 08995000
         L     @04,GRABCURR(,@04)                                  2263 08996000
         NI    RABADD(@04),B'11011111'                             2263 08997000
*         /***********************************************************/ 08998000
*         /*                                                         */ 08999000
*         /*    CHECK FOR NECESSITY OF DELETING AND/OR ADDING        */ 09000000
*         /*    A TRUE NAME TO THE CATALOG FOR THIS RECORD.          */ 09001000
*         /*                                                         */ 09002000
*         /***********************************************************/ 09003000
*                                                                  2264 09004000
*                         RSUCATN = OFF;                           2264 09005000
*                         RSUCDTN = OFF;                           2265 09006000
         NI    RSUCATN(REG6),B'11110011'                           2265 09007000
*                         RSGRABCU =ADDR(GRABSWF);                 2266 09008000
*                                                                  2266 09009000
         L     @04,RSIOTBL(,REG6)                                  2266 09010000
         ST    @04,RSGRABCU(,REG6)                                 2266 09011000
*         /***********************************************************/ 09012000
*         /*                                                         */ 09013000
*         /*    IF WORKFILE RECORD HAS A TRUE NAME AND CATALOG       */ 09014000
*         /*    RECORD DOES NOT, THEN SET ADD TRUE NAME FLAG.        */ 09015000
*         /*                                                         */ 09016000
*         /***********************************************************/ 09017000
*                                                                  2267 09018000
*                         IF RSUCCATN = OFF & RSUCWFTN = ON        2267 09019000
*                           THEN                                   2267 09020000
         TM    RSUCWFTN(REG6),B'00000100'                          2267 09021000
         BNO   @RF02267                                            2267 09022000
         TM    RSUCCATN(REG6),B'00001000'                          2267 09023000
         BNZ   @RF02267                                            2267 09024000
*                             RSUCATN = ON;                        2268 09025000
*                                                                  2268 09026000
         OI    RSUCATN(REG6),B'00001000'                           2268 09027000
*         /***********************************************************/ 09028000
*         /*                                                         */ 09029000
*         /*    IF CATALOG RECORD HAS A TRUE NAME AND WORKFILE       */ 09030000
*         /*    RECORD DOES NOT, THEN SET DELETE TRUE NAME FLAG.     */ 09031000
*         /*                                                         */ 09032000
*         /***********************************************************/ 09033000
*                                                                  2269 09034000
*                         IF RSUCCATN = ON & RSUCWFTN = OFF        2269 09035000
*                           THEN                                   2269 09036000
@RF02267 TM    RSUCCATN(REG6),B'00001000'                          2269 09037000
         BNO   @RF02269                                            2269 09038000
         TM    RSUCWFTN(REG6),B'00000100'                          2269 09039000
         BNZ   @RF02269                                            2269 09040000
*                             RSUCDTN = ON;                        2270 09041000
*                                                                  2270 09042000
         OI    RSUCDTN(REG6),B'00000100'                           2270 09043000
*         /***********************************************************/ 09044000
*         /*                                                         */ 09045000
*         /*    IF CATALOG AND WORKFILE RECORDS HAVE DIFFERENT       */ 09046000
*         /*    TRUE NAMES, THEN SET DELETE TRUE NAME FLAG AND       */ 09047000
*         /*    ADD TRUE NAME FLAG.                                  */ 09048000
*         /*                                                         */ 09049000
*         /***********************************************************/ 09050000
*                                                                  2271 09051000
*                         IF RSUCCATN = ON & RSUCWFTN = ON &       2271 09052000
*                             RSCATTN ^= CNAME                     2271 09053000
*                           THEN                                   2271 09054000
@RF02269 TM    RSUCCATN(REG6),B'00001100'                          2271 09055000
         BNO   @RF02271                                            2271 09056000
         L     @04,RSGRABCU(,REG6)                                 2271 09057000
         L     @04,GRABCURR(,@04)                                  2271 09058000
         CLC   RSCATTN(44,REG6),CNAME+8(@04)                       2271 09059000
         BE    @RF02271                                            2271 09060000
*                             DO;                                  2272 09061000
*                               RSUCDTN = ON;                      2273 09062000
*                               RSUCATN = ON;                      2274 09063000
         OI    RSUCDTN(REG6),B'00001100'                           2274 09064000
*                             END;                                 2275 09065000
*                                                                  2275 09066000
*         /***********************************************************/ 09067000
*         /*                                                         */ 09068000
*         /*    DELETE CATALOG RECORD TRUE NAME FROM CATALOG         */ 09069000
*         /*    VIA DELTN.                                           */ 09070000
*         /*                                                         */ 09071000
*         /***********************************************************/ 09072000
*                                                                  2276 09073000
*                         IF RSUCDTN = ON                          2276 09074000
*                           THEN                                   2276 09075000
*                                                                  2276 09076000
@RF02271 TM    RSUCDTN(REG6),B'00000100'                           2276 09077000
         BNO   @RF02276                                            2276 09078000
*                             /* CALL TO MODULE IDCRS05 FOR PROCEDURE D 09079000
*LTN                                                                 */ 09080000
*                             CALL DELTN;                          2277 09081000
*                                                                  2277 09082000
         L     @15,@CV03679                                        2277 09083000
         BALR  @14,@15                                             2277 09084000
*         /***********************************************************/ 09085000
*         /*                                                         */ 09086000
*         /*    ATTEMPT TO ADD WORKFILE RECORD TURE NAME TO          */ 09087000
*         /*    CATALOG VIA ADDTN.                                   */ 09088000
*         /*                                                         */ 09089000
*         /***********************************************************/ 09090000
*                                                                  2278 09091000
*                         IF RSUCATN = ON                          2278 09092000
*                           THEN                                   2278 09093000
@RF02276 TM    RSUCATN(REG6),B'00001000'                           2278 09094000
         BNO   @RF02278                                            2278 09095000
*                             DO;                                  2279 09096000
*                                                                  2279 09097000
*                               /* CALL TO MODULE IDCRS05 FOR PROCEDURE 09098000
*ADDTN                                                               */ 09099000
*                               CALL ADDTN;                        2280 09100000
*                                                                  2280 09101000
         L     @15,@CV03680                                        2280 09102000
         BALR  @14,@15                                             2280 09103000
*                               RESPECIFY RTNREG RSTD;             2281 09104000
*                               TESTRC = RTNREG;                   2282 09105000
         STH   RTNREG,TESTRC(,REG6)                                2282 09106000
*                               RESPECIFY RTNREG UNRSTD;           2283 09107000
*                                                                  2283 09108000
*         /***********************************************************/ 09109000
*         /*                                                         */ 09110000
*         /*    IF TRUE NAME IS A DUPLICATE, PLACE IT ON THE         */ 09111000
*         /*    ADD TRUE NAME CHAIN.                                 */ 09112000
*         /*                                                         */ 09113000
*         /***********************************************************/ 09114000
*                                                                  2284 09115000
*                               IF TESTRC = RCDUP                  2284 09116000
*                                 THEN                             2284 09117000
         LH    @04,TESTRC(,REG6)                                   2284 09118000
         C     @04,@CF00046                                        2284 09119000
         BNE   @RF02284                                            2284 09120000
*                                   DO;                            2285 09121000
*                                     RSWDUPTR = RSTNCHN;          2286 09122000
         L     @04,RSGRABCU(,REG6)                                 2286 09123000
         L     @04,GRABCURR(,@04)                                  2286 09124000
         L     @15,RSTNCHN(,REG6)                                  2286 09125000
         ST    @15,RSWDUPTR(,@04)                                  2286 09126000
*                                     RSTNCHN = RCDCINO;           2287 09127000
         L     @04,RCDCINO+7(,@04)                                 2287 09128000
         LA    @04,0(,@04)                                         2287 09129000
         ST    @04,RSTNCHN(,REG6)                                  2287 09130000
*                                     RSUCTWWF = ON;               2288 09131000
         OI    RSUCTWWF(REG6),B'00000010'                          2288 09132000
*                                   END;                           2289 09133000
*                                                                  2289 09134000
*                             END;                                 2290 09135000
*                                                                  2290 09136000
@RF02284 DS    0H                                                  2291 09137000
*         /***********************************************************/ 09138000
*         /*                                                         */ 09139000
*         /*    IF RECORD IS TO BE UPDATED IN ITS CRA, PLACE IT ON   */ 09140000
*         /*    ITS CRA'S UPDATE CHAIN VIA CRAUPCHN.                 */ 09141000
*         /*                                                         */ 09142000
*         /***********************************************************/ 09143000
*                                                                  2291 09144000
*                         IF RSWUPCRA = ON                         2291 09145000
*                           THEN                                   2291 09146000
@RF02278 L     @04,RSGRABCU(,REG6)                                 2291 09147000
         L     @04,GRABCURR(,@04)                                  2291 09148000
         TM    RSWUPCRA(@04),B'00010000'                           2291 09149000
         BNO   @RF02291                                            2291 09150000
*                             DO;                                  2292 09151000
*                                                                  2292 09152000
*                               /* CALL TO MODULE IDCRS05 FOR PROCEDURE 09153000
*CRAUPCHN                                                            */ 09154000
*                               CALL CRAUPCHN;                     2293 09155000
*                                                                  2293 09156000
         L     @15,@CV03681                                        2293 09157000
         BALR  @14,@15                                             2293 09158000
*                               RSUCTWWF = ON;                     2294 09159000
         OI    RSUCTWWF(REG6),B'00000010'                          2294 09160000
*                             END;                                 2295 09161000
*                                                                  2295 09162000
*                       END UPCTRP;                                2296 09163000
*                                                                  2296 09164000
@RF02291 DS    0H                                                  2297 09165000
*         /***********************************************************/ 09166000
*         /*                                                         */ 09167000
*         /*  WORKFILE RECORD WAS MODIFIED. WRITE RECORD TO WORKFILE */ 09168000
*         /*  VIA RECMGMT.                                           */ 09169000
*         /*                                                         */ 09170000
*         /***********************************************************/ 09171000
*                                                                  2297 09172000
*                   IF RSUCTWWF = ON                               2297 09173000
*                     THEN                                         2297 09174000
*                                                                  2297 09175000
*                                                                  2297 09176000
*                                                                  2297 09177000
@RF02081 TM    RSUCTWWF(REG6),B'00000010'                          2297 09178000
         BNO   @RF02297                                            2297 09179000
*                           DO;                                    2298 09180000
*                             RSRTYPE = ''B;                       2299 09181000
         MVI   RSRTYPE(REG6),X'00'                                 2299 09182000
*                             RSRUPDT = ON;     /* UPDRCD  */      2300 09183000
         OI    RSRUPDT(REG6),B'00100000'                           2300 09184000
*                             RSRUPD = ON;      /* UPDATE  */      2301 09185000
         OI    RSRUPD(REG6),B'00001000'                            2301 09186000
*                             RSRDS = ''B;                         2302 09187000
         NI    RSRDS(REG6),B'00011111'                             2302 09188000
*                             RSRWF = ON;       /* WORKFILE  */    2303 09189000
*                             RSRDIR = OFF;     /* SEQUENTIAL  */  2304 09190000
*                             RSRKEY = ON;      /* KEY  */         2305 09191000
*                                                                  2305 09192000
         OI    RSRWF(REG6),B'10010000'                             2305 09193000
         NI    RSRDIR(REG6),B'11111011'                            2305 09194000
*                           /* CALL TO MODULE IDCRS06 FOR PROCEDURE REC 09195000
*GMT                                                                 */ 09196000
*                           CALL RECMGMT;                          2306 09197000
         L     @15,@CV03498                                        2306 09198000
         BALR  @14,@15                                             2306 09199000
*                             RFY RTNREG RSTD;                     2307 09200000
*                             TESTRC = RTNREG;                     2308 09201000
         STH   RTNREG,TESTRC(,REG6)                                2308 09202000
*                             RFY RTNREG UNRSTD;                   2309 09203000
*                           END;                                   2310 09204000
*                                                                  2310 09205000
*                 END UPCTLP2;                                     2311 09206000
*                                                                  2311 09207000
@RF02297 DS    0H                                                  2311 09208000
@DE02049 L     @04,RSGRABCU(,REG6)                                 2311 09209000
         L     @04,GRABCURR(,@04)                                  2311 09210000
         CLC   RABRCDA(4,@04),RSXRREND(REG6)                       2311 09211000
         BNE   @DL02049                                            2311 09212000
*               END UPCTLKR;                                       2312 09213000
*                                                                  2312 09214000
*         END UPCTLP1;                                             2313 09215000
*                                                                  2313 09216000
@RF02027 LA    @04,1                                               2313 09217000
         AH    @04,RSIDX(,REG6)                                    2313 09218000
         STH   @04,RSIDX(,REG6)                                    2313 09219000
         C     @04,@CF01850                                        2313 09220000
         BNH   @DL02026                                            2313 09221000
@DC02026 DS    0H                                                  2314 09222000
*         /***********************************************************/ 09223000
*         /*                                                         */ 09224000
*         /*  FORCE A PHYSICAL WRITE OF THE LAST RECORD              */ 09225000
*         /*  PUT SEQUENTIALLY TO THE WORKFILE, VIA RECMGMT.         */ 09226000
*         /*                                                         */ 09227000
*         /***********************************************************/ 09228000
*                                                                  2314 09229000
*                                                                  2314 09230000
*         DO;                                                      2314 09231000
*           RSRECREQ = ''B;                                        2315 09232000
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     2315 09233000
*           RSREND = ON;      /* ENDRCD */                         2316 09234000
*                                                                  2316 09235000
         OI    RSREND(REG6),B'00000010'                            2316 09236000
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */ 09237000
*         CALL RECMGMT;                                            2317 09238000
         L     @15,@CV03498                                        2317 09239000
         BALR  @14,@15                                             2317 09240000
*           RFY RTNREG RSTD;                                       2318 09241000
*           TESTRC = RTNREG;                                       2319 09242000
         STH   RTNREG,TESTRC(,REG6)                                2319 09243000
*           RFY RTNREG UNRSTD;                                     2320 09244000
*         END;                                                     2321 09245000
*                                                                  2321 09246000
*         /***********************************************************/ 09247000
*         /*                                                         */ 09248000
*         /*  CIXLT PROCESSING COMPLETED. ADD WORKFILE RECORD        */ 09249000
*         /*  TRUE NAMES ON TRUE NAME CHAIN TO CATALOG.              */ 09250000
*         /*                                                         */ 09251000
*         /***********************************************************/ 09252000
*                                                                  2322 09253000
*         RSTNNXT = RSTNCHN;                                       2322 09254000
*                                                                  2322 09255000
         L     @04,RSTNCHN(,REG6)                                  2322 09256000
         ST    @04,RSTNNXT(,REG6)                                  2322 09257000
*UPCTLP3: DO WHILE (RSTNNXT ^= 0);                                 2323 09258000
*                                                                  2323 09259000
UPCTLP3  B     @DE02323                                            2323 09260000
@DL02323 DS    0H                                                  2324 09261000
*         /***********************************************************/ 09262000
*         /*                                                         */ 09263000
*         /*    READ WORKFILE RECORD ON TRUE NAME CHAIN VIA RECMGMT. */ 09264000
*         /*                                                         */ 09265000
*         /***********************************************************/ 09266000
*                                                                  2324 09267000
*           RSGRABCU = ADDR(GRABSWF);                              2324 09268000
         L     @04,RSIOTBL(,REG6)                                  2324 09269000
         ST    @04,RSGRABCU(,REG6)                                 2324 09270000
*           RABRCDA = RSTNNXT;                                     2325 09271000
         L     @04,GRABCURR(,@04)                                  2325 09272000
         L     @15,RSTNNXT(,REG6)                                  2325 09273000
         ST    @15,RABRCDA(,@04)                                   2325 09274000
*           RABRRN = OFF;                                          2326 09275000
*                                                                  2326 09276000
*                                                                  2326 09277000
         NI    RABRRN(@04),B'11101111'                             2326 09278000
*           DO;                                                    2327 09279000
*             RSRTYPE = ''B;                                       2328 09280000
         MVI   RSRTYPE(REG6),X'00'                                 2328 09281000
*             RSRGET = ON;      /* GETRCD  */                      2329 09282000
         OI    RSRGET(REG6),B'10000000'                            2329 09283000
*             RSRUPD = ON;      /* UPDATE  */                      2330 09284000
         OI    RSRUPD(REG6),B'00001000'                            2330 09285000
*             RSRDS = ''B;                                         2331 09286000
         NI    RSRDS(REG6),B'00011111'                             2331 09287000
*             RSRWF = ON;       /* WORKFILE  */                    2332 09288000
*             RSRDIR = ON;      /* DIRECT  */                      2333 09289000
*             RSRKEY = ON;      /* KEY  */                         2334 09290000
*                                                                  2334 09291000
         OI    RSRWF(REG6),B'10010100'                             2334 09292000
*           /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT          */ 09293000
*           CALL RECMGMT;                                          2335 09294000
         L     @15,@CV03498                                        2335 09295000
         BALR  @14,@15                                             2335 09296000
*             RFY RTNREG RSTD;                                     2336 09297000
*             TESTRC = RTNREG;                                     2337 09298000
         STH   RTNREG,TESTRC(,REG6)                                2337 09299000
*             RFY RTNREG UNRSTD;                                   2338 09300000
*           END;                                                   2339 09301000
*                                                                  2339 09302000
*           RSTNNXT = RSWDUPTR;                                    2340 09303000
*                                                                  2340 09304000
         L     @04,RSGRABCU(,REG6)                                 2340 09305000
         L     @04,GRABCURR(,@04)                                  2340 09306000
         L     @04,RSWDUPTR(,@04)                                  2340 09307000
         ST    @04,RSTNNXT(,REG6)                                  2340 09308000
*         /***********************************************************/ 09309000
*         /*                                                         */ 09310000
*         /*    ATTEMPT TO ADD WORKFILE TRUE NAME TO CATALOG         */ 09311000
*         /*    VIA ADDTN.                                           */ 09312000
*         /*                                                         */ 09313000
*         /***********************************************************/ 09314000
*                                                                  2341 09315000
*           /* CALL TO MODULE IDCRS05 FOR PROCEDURE ADDTN            */ 09316000
*           CALL ADDTN;                                            2341 09317000
*                                                                  2341 09318000
         L     @15,@CV03680                                        2341 09319000
         BALR  @14,@15                                             2341 09320000
*           RESPECIFY RTNREG RSTD;                                 2342 09321000
*           TESTRC = RTNREG;                                       2343 09322000
         STH   RTNREG,TESTRC(,REG6)                                2343 09323000
*           RESPECIFY RTNREG UNRSTD;                               2344 09324000
*                                                                  2344 09325000
*         /***********************************************************/ 09326000
*         /*                                                         */ 09327000
*         /*    IF TRUE NAME IS A DUPLICATE, RENAME IT VIA RENAMEP.  */ 09328000
*         /*                                                         */ 09329000
*         /***********************************************************/ 09330000
*                                                                  2345 09331000
*           IF TESTRC = RCDUP                                      2345 09332000
*             THEN                                                 2345 09333000
*                                                                  2345 09334000
         LH    @04,TESTRC(,REG6)                                   2345 09335000
         C     @04,@CF00046                                        2345 09336000
         BNE   @RF02345                                            2345 09337000
*               /* CALL TO MODULE IDCRS07 FOR PROCEDURE RENAMEP      */ 09338000
*               CALL RENAMEP;                                      2346 09339000
*                                                                  2346 09340000
         L     @15,@CV03684                                        2346 09341000
         BALR  @14,@15                                             2346 09342000
*         /***********************************************************/ 09343000
*         /*                                                         */ 09344000
*         /*  ORIGINAL TRUE NAME ADDED. WORKFILE RECORD DOES NOT     */ 09345000
*         /*  HAVE TO BE UPDATED, SO FREE IT.                        */ 09346000
*         /*                                                         */ 09347000
*         /***********************************************************/ 09348000
*                                                                  2347 09349000
*             ELSE                                                 2347 09350000
*                                                                  2347 09351000
*                                                                  2347 09352000
*               DO;                                                2347 09353000
         B     @RC02345                                            2347 09354000
@RF02345 DS    0H                                                  2348 09355000
*                 RSRTYPE = ''B;                                   2348 09356000
         MVI   RSRTYPE(REG6),X'00'                                 2348 09357000
*                 RSRFREE = ON;     /* FREERCD  */                 2349 09358000
         OI    RSRFREE(REG6),B'00000001'                           2349 09359000
*                 RSRUPD = ON;      /* UPDATE  */                  2350 09360000
         OI    RSRUPD(REG6),B'00001000'                            2350 09361000
*                 RSRDS = ''B;                                     2351 09362000
         NI    RSRDS(REG6),B'00011111'                             2351 09363000
*                 RSRWF = ON;       /* WORKFILE  */                2352 09364000
*                 RSRDIR = ON;      /* DIRECT  */                  2353 09365000
*                 RSRKEY = ON;      /* KEY  */                     2354 09366000
*                                                                  2354 09367000
         OI    RSRWF(REG6),B'10010100'                             2354 09368000
*               /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT      */ 09369000
*               CALL RECMGMT;                                      2355 09370000
         L     @15,@CV03498                                        2355 09371000
         BALR  @14,@15                                             2355 09372000
*                 RFY RTNREG RSTD;                                 2356 09373000
*                 TESTRC = RTNREG;                                 2357 09374000
         STH   RTNREG,TESTRC(,REG6)                                2357 09375000
*                 RFY RTNREG UNRSTD;                               2358 09376000
*               END;                                               2359 09377000
*                                                                  2359 09378000
*         END UPCTLP3;                                             2360 09379000
*                                                                  2360 09380000
@RC02345 DS    0H                                                  2360 09381000
@DE02323 L     @04,RSTNNXT(,REG6)                                  2360 09382000
         LTR   @04,@04                                             2360 09383000
         BNZ   @DL02323                                            2360 09384000
*         /***********************************************************/ 09385000
*         /*                                                         */ 09386000
*         /*  UPDATE CATALOG CCR RECORD.                             */ 09387000
*         /*                                                         */ 09388000
*         /***********************************************************/ 09389000
*                                                                  2361 09390000
*         RSGRABCU = ADDR(GRABSCA);                                2361 09391000
         L     @04,RSIOTBL(,REG6)                                  2361 09392000
         LA    @04,GRABSCA(,@04)                                   2361 09393000
         ST    @04,RSGRABCU(,REG6)                                 2361 09394000
*         GRABCURR = GRABRAB1;                                     2362 09395000
*                                                                  2362 09396000
         L     @15,GRABRAB1(,@04)                                  2362 09397000
         ST    @15,GRABCURR(,@04)                                  2362 09398000
*         /***********************************************************/ 09399000
*         /*                                                         */ 09400000
*         /*    GET CATALOG CCR RECORD VIA RECMGMT.                  */ 09401000
*         /*                                                         */ 09402000
*         /***********************************************************/ 09403000
*                                                                  2363 09404000
*         RABRCDA = CCRCI;                                         2363 09405000
*                                                                  2363 09406000
*                                                                  2363 09407000
         MVC   RABRCDA(4,@15),@CF00166                             2363 09408000
*         DO;                                                      2364 09409000
*           RSRTYPE = ''B;                                         2365 09410000
         MVI   RSRTYPE(REG6),X'00'                                 2365 09411000
*           RSRGET = ON;      /* GETRCD  */                        2366 09412000
         OI    RSRGET(REG6),B'10000000'                            2366 09413000
*           RSRUPD = ON;      /* UPDATE  */                        2367 09414000
         OI    RSRUPD(REG6),B'00001000'                            2367 09415000
*           RSRDS = ''B;                                           2368 09416000
         NI    RSRDS(REG6),B'00011111'                             2368 09417000
*           RSRCAT = ON;      /* CATALOG  */                       2369 09418000
*           RSRDIR = ON;      /* DIRECT  */                        2370 09419000
*           RSRKEY = OFF;     /* CNV  */                           2371 09420000
*                                                                  2371 09421000
         OI    RSRCAT(REG6),B'01000100'                            2371 09422000
         NI    RSRKEY(REG6),B'11101111'                            2371 09423000
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */ 09424000
*         CALL RECMGMT;                                            2372 09425000
         L     @15,@CV03498                                        2372 09426000
         BALR  @14,@15                                             2372 09427000
*           RFY RTNREG RSTD;                                       2373 09428000
*           TESTRC = RTNREG;                                       2374 09429000
         STH   RTNREG,TESTRC(,REG6)                                2374 09430000
*           RFY RTNREG UNRSTD;                                     2375 09431000
*         END;                                                     2376 09432000
*                                                                  2376 09433000
*         /***********************************************************/ 09434000
*         /*                                                         */ 09435000
*         /*    UPDATE CATALOG CCR RECORD FIELDS                     */ 09436000
*         /*                                                         */ 09437000
*         /***********************************************************/ 09438000
*                                                                  2377 09439000
*         CCRNFCI = RSCAFUCI;                                      2377 09440000
         L     @04,RSGRABCU(,REG6)                                 2377 09441000
         LA    @15,8                                               2377 09442000
         AL    @15,GRABCURR(,@04)                                  2377 09443000
         MVC   CCRNFCI(3,@15),RSCAFUCI+1(REG6)                     2377 09444000
*         CCRCDCI = RSAVAILN;                                      2378 09445000
         MVC   CCRCDCI(3,@15),RSAVAILN+1(REG6)                     2378 09446000
*         CCRFDCI = RSAVAIL;                                       2379 09447000
*                                                                  2379 09448000
         MVC   CCRFDCI(3,@15),RSAVAIL+1(REG6)                      2379 09449000
*         /***********************************************************/ 09450000
*         /*                                                         */ 09451000
*         /*    UPDATE HIGH RBAS IN CATALOG CCR RECORD VIA UPDCCR.   */ 09452000
*         /*                                                         */ 09453000
*         /***********************************************************/ 09454000
*                                                                  2380 09455000
*         /* CALL TO MODULE IDCRS07 FOR PROCEDURE UPDCCR             */ 09456000
*         CALL UPDCCR;                                             2380 09457000
*                                                                  2380 09458000
         L     @15,@CV03685                                        2380 09459000
         BALR  @14,@15                                             2380 09460000
*         /***********************************************************/ 09461000
*         /*                                                         */ 09462000
*         /*    WRITE CCR RECORD TO CATALOG VIA RECMGMT.             */ 09463000
*         /*                                                         */ 09464000
*         /***********************************************************/ 09465000
*                                                                  2381 09466000
*                                                                  2381 09467000
*         DO;                                                      2381 09468000
*           RSRTYPE = ''B;                                         2382 09469000
         MVI   RSRTYPE(REG6),X'00'                                 2382 09470000
*           RSRUPDT = ON;     /* UPDRCD  */                        2383 09471000
         OI    RSRUPDT(REG6),B'00100000'                           2383 09472000
*           RSRUPD = ON;      /* UPDATE  */                        2384 09473000
         OI    RSRUPD(REG6),B'00001000'                            2384 09474000
*           RSRDS = ''B;                                           2385 09475000
         NI    RSRDS(REG6),B'00011111'                             2385 09476000
*           RSRCAT = ON;      /* CATALOG  */                       2386 09477000
*           RSRDIR = ON;      /* DIRECT  */                        2387 09478000
*           RSRKEY = OFF;     /* CNV  */                           2388 09479000
*                                                                  2388 09480000
         OI    RSRCAT(REG6),B'01000100'                            2388 09481000
         NI    RSRKEY(REG6),B'11101111'                            2388 09482000
*         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT            */ 09483000
*         CALL RECMGMT;                                            2389 09484000
         L     @15,@CV03498                                        2389 09485000
         BALR  @14,@15                                             2389 09486000
*           RFY RTNREG RSTD;                                       2390 09487000
*           TESTRC = RTNREG;                                       2391 09488000
         STH   RTNREG,TESTRC(,REG6)                                2391 09489000
*           RFY RTNREG UNRSTD;                                     2392 09490000
*         END;                                                     2393 09491000
*                                                                  2393 09492000
*         /***********************************************************/ 09493000
*         /*                                                         */ 09494000
*         /*  FORCE A READ OF THE CCR RECORD BY CATALOG MANAGEMENT   */ 09495000
*         /*  VIA FRCRCCR.                                           */ 09496000
*         /*                                                         */ 09497000
*         /***********************************************************/ 09498000
*                                                                  2394 09499000
*         /* CALL TO MODULE IDCRS07 FOR PROCEDURE FRCRCCR            */ 09500000
*         CALL FRCRCCR;                                            2394 09501000
*                                                                  2394 09502000
         L     @15,@CV03686                                        2394 09503000
         BALR  @14,@15                                             2394 09504000
*         /***********************************************************/ 09505000
*         /*                                                 @ZA18274*/ 09506000
*         /*  IF RECORDS WERE MOVED TO THE NEW CATALOG'S CRA,@ZA18274*/ 09507000
*         /*  UPDATE THE CCR RECORD AND CLOSE THE CRA.       @ZA18274*/ 09508000
*         /*                                                 @ZA18274*/ 09509000
*         /***********************************************************/ 09510000
*                                                                  2395 09511000
*         IF RSCHCRAN ^= 0 THEN DO;                        /*@ZA18274*/ 09512000
         L     @04,RSCHCRAN(,REG6)                                 2395 09513000
         LTR   @04,@04                                             2395 09514000
         BZ    @RF02395                                            2395 09515000
*           RSGRABCU = ADDR(GRABSCR);                      /*@ZA18274*/ 09516000
         L     @04,RSIOTBL(,REG6)                                  2397 09517000
         LA    @04,GRABSCR(,@04)                                   2397 09518000
         ST    @04,RSGRABCU(,REG6)                                 2397 09519000
*           GRABCURR = GRABRAB2;                           /*@ZA18274*/ 09520000
         L     @15,GRABRAB2(,@04)                                  2398 09521000
         ST    @15,GRABCURR(,@04)                                  2398 09522000
*           RABRCDA = CCRCI;                               /*@ZA18274*/ 09523000
*                                                                  2399 09524000
         MVC   RABRCDA(4,@15),@CF00166                             2399 09525000
*           DO;                                                    2400 09526000
*             RSRTYPE = ''B;                                       2401 09527000
         MVI   RSRTYPE(REG6),X'00'                                 2401 09528000
*             RSRUPDT = ON;     /* UPDRCD  */                      2402 09529000
         OI    RSRUPDT(REG6),B'00100000'                           2402 09530000
*             RSRUPD = ON;      /* UPDATE  */                      2403 09531000
         OI    RSRUPD(REG6),B'00001000'                            2403 09532000
*             RSRDS = ''B;                                         2404 09533000
         NI    RSRDS(REG6),B'00011111'                             2404 09534000
*             RSRCRA = ON;      /* CRA  */                         2405 09535000
*             RSRDIR = ON;      /* DIRECT  */                      2406 09536000
*             RSRKEY = OFF;     /* CNV  */                         2407 09537000
*                                                                  2407 09538000
         OI    RSRCRA(REG6),B'00100100'                            2407 09539000
         NI    RSRKEY(REG6),B'11101111'                            2407 09540000
*           /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT          */ 09541000
*           CALL RECMGMT;                                          2408 09542000
         L     @15,@CV03498                                        2408 09543000
         BALR  @14,@15                                             2408 09544000
*             RFY RTNREG RSTD;                                     2409 09545000
*             TESTRC = RTNREG;                                     2410 09546000
         STH   RTNREG,TESTRC(,REG6)                                2410 09547000
*             RFY RTNREG UNRSTD;                                   2411 09548000
*           END;                       /*@ZA18274*/                2412 09549000
*           /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSCLOSE          */ 09550000
*           CALL IDCRS6DC('R');                         /*@ZA18274*/    09551000
         L     @15,@CV03542                                        2413 09552000
         LA    @01,@AL02413                                        2413 09553000
         BALR  @14,@15                                             2413 09554000
*         END;                                             /*@ZA18274*/ 09555000
*                                                                  2414 09556000
*         /***********************************************************/ 09557000
*         /*                                                         */ 09558000
*         /*  CATALOG HAS BEEN RESET. CALL CKERR TO PRINT            */ 09559000
*         /*  INFORMATIONAL MESSAGE.                                 */ 09560000
*         /*                                                         */ 09561000
*         /***********************************************************/ 09562000
*                                                                  2415 09563000
*                                                                  2415 09564000
*         DO;                                                      2415 09565000
@RF02395 DS    0H                                                  2416 09566000
*         /*CALL CKERR*/                                           2416 09567000
*           RSCKERR = RSCKERR && RSCKERR;                          2416 09568000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2416 09569000
*           RSCKERN = RSE062;                                      2417 09570000
         MVC   RSCKERN(2,REG6),@CH01013                            2417 09571000
*           RSCKTERM = 'RETU';                                     2418 09572000
         MVC   RSCKTERM(4,REG6),@CC03585                           2418 09573000
*           RSCKMVAR(1) = ADDR(RSCATDSN);                          2419 09574000
*                                                                  2419 09575000
         LA    @04,RSCATDSN(,REG6)                                 2419 09576000
         ST    @04,RSCKMVAR(,REG6)                                 2419 09577000
*         /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR              */ 09578000
*         CALL CKERR;                                              2420 09579000
         L     @15,@CV03544                                        2420 09580000
         BALR  @14,@15                                             2420 09581000
*         END;                                                     2421 09582000
*                                                                  2421 09583000
*         /***********************************************************/ 09584000
*         /*                                                         */ 09585000
*         /*  PROCESSING COMPLETED. RETURN.                          */ 09586000
*         /*                                                         */ 09587000
*         /***********************************************************/ 09588000
*                                                                  2422 09589000
*                                                                  2422 09590000
*                                                                  2422 09591000
*         IF GDTDBG = NULLPTR                                      2422 09592000
*           THEN;                                                  2422 09593000
         L     @04,GDTDBG(,REG5)                                   2422 09594000
         LTR   @04,@04                                             2422 09595000
         BZ    @RT02422                                            2422 09596000
*           ELSE                                                   2424 09597000
*             CALL IDCDB010 (GDTTBL,'RSU1');                       2424 09598000
*                                                                  2424 09599000
         ST    REG5,@AL00001                                       2424 09600000
         LA    @04,@CC03687                                        2424 09601000
         ST    @04,@AL00001+4                                      2424 09602000
         MVI   @AL00001+4,X'80'                                    2424 09603000
         L     @15,GDTDBG(,REG5)                                   2424 09604000
         LA    @01,@AL00001                                        2424 09605000
         BALR  @14,@15                                             2424 09606000
* CALL EXIT;  /*TERMINATE*/                                        2425 09607000
@RT02422 BAL   @14,EXIT                                            2425 09608000
* END UPDCAT; /*END OF PROCEDURE*/                                 2426 09609000
@EL00010 DS    0H                                                  2426 09610000
@EF00010 DS    0H                                                  2426 09611000
@ER00010 BR    @14                                                 2426 09612000
@PB00010 DS    0H                                                  2427 09613000
*/********************************************************************/ 09614000
*/*                                                                  */ 09615000
*/* PROCEDURE NAME - UPDCRA                                          */ 09616000
*/*                                                                  */ 09617000
*/* FUNCTION - UPDATE CATALOG RECOVERY AREAS FROM THE WORKFILE       */ 09618000
*/*                                                                  */ 09619000
*/* INPUT    - NONE                                                  */ 09620000
*/*                                                                  */ 09621000
*/* OUTPUT -   RECORDS ARE UPDATED IN CRAS                           */ 09622000
*/*                                                                  */ 09623000
*/* EXIT, NORMAL - RETURN TO CALLER                                  */ 09624000
*/* EXIT, ERROR - TO CKERR TO TERMINATE                              */ 09625000
*/*                                                                  */ 09626000
*/********************************************************************/ 09627000
*      GENERATE;                                                   2427 09628000
         DS    0F                                                       09629000
NAME0254 DC    CL8'UPDCRA'                                              09630000
*UPDCRA: PROCEDURE                                                 2428 09631000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               2428 09632000
*                                                                  2428 09633000
         B     @PB00011                                            2428 09634000
UPDCRA   DS    0H                                                  2429 09635000
*      GENERATE REFS(RS01RG08, REG6);                              2429 09636000
*                                                                  2429 09637000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          09638000
         LR    @15,@13  OLD SAVE AREA                                   09639000
         LA    @13,72(@13)  NEW SAVE AREA                               09640000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     09641000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        09642000
         MVC   0(4,@15),NAME0254  PROCNAME TO REGSAVE                   09643000
*         /***********************************************************/ 09644000
*         /*                                                         */ 09645000
*         /*  CRA FREE RECORD NEXT FREE CI                           */ 09646000
*         /*                                                         */ 09647000
*         /***********************************************************/ 09648000
*                                                                  2430 09649000
*         DCL RSUCENTF PTR(24) DEF(RCDSIZ);                        2430 09650000
*                                                                  2430 09651000
*         RFY RESVOL BASED(RSENTPT);                               2431 09652000
*                                                                  2431 09653000
*         OLDERID2 = NEWERID2;                                     2432 09654000
         L     @04,GDTTR2(,REG5)                                   2432 09655000
         MVC   @TS00001(95),NEWERID2(@04)                          2432 09656000
         MVC   OLDERID2(95,@04),@TS00001                           2432 09657000
*         NEWID2 = 'RSUC';                                         2433 09658000
*                                                                  2433 09659000
         MVC   NEWID2(4,@04),@CC03693                              2433 09660000
*         /***********************************************************/ 09661000
*         /*                                                         */ 09662000
*         /*  INITIALIZE RECMGMT BUFFER POINTERS AND CONTROL BLOCKS. */ 09663000
*         /*                                                         */ 09664000
*         /***********************************************************/ 09665000
*                                                                  2434 09666000
*         RSGRABCU = ADDR(GRABSWF);                                2434 09667000
         L     @04,RSIOTBL(,REG6)                                  2434 09668000
         ST    @04,RSGRABCU(,REG6)                                 2434 09669000
*         GRABCURR = GRABRAB1;                                     2435 09670000
         L     @15,GRABRAB1(,@04)                                  2435 09671000
         ST    @15,GRABCURR(,@04)                                  2435 09672000
*         RSWFBP1 =ADDR(RABBUF);                                   2436 09673000
         LA    @14,RABBUF(,@15)                                    2436 09674000
         ST    @14,RSWFBP1(,REG6)                                  2436 09675000
*         GRABAFLS = ''B;                                          2437 09676000
         XC    GRABAFLS(2,@04),GRABAFLS(@04)                       2437 09677000
*         RABRRN = OFF;                                            2438 09678000
*                                                                  2438 09679000
         NI    RABRRN(@15),B'11101111'                             2438 09680000
*         RSGRABCU = ADDR(GRABSCR);                                2439 09681000
         LA    @15,GRABSCR(,@04)                                   2439 09682000
         ST    @15,RSGRABCU(,REG6)                                 2439 09683000
*         GRABCURR = GRABRAB1;                                     2440 09684000
         L     @14,GRABRAB1(,@15)                                  2440 09685000
         ST    @14,GRABCURR(,@15)                                  2440 09686000
*         RSCRBP1 = ADDR(RABBUF);                                  2441 09687000
         LA    @14,RABBUF(,@14)                                    2441 09688000
         ST    @14,RSCRBP1(,REG6)                                  2441 09689000
*         GRABAFLS = ''B;                                          2442 09690000
*                                                                  2442 09691000
         XC    GRABAFLS(2,@15),GRABAFLS(@15)                       2442 09692000
*         /***********************************************************/ 09693000
*         /*                                                         */ 09694000
*         /*  PROCESS RESET CRAS VIA RESVOL TABLE.                   */ 09695000
*         /*                                                         */ 09696000
*         /***********************************************************/ 09697000
*                                                                  2443 09698000
*         RSMETRM = OFF;                                           2443 09699000
         NI    RSMETRM(REG6),B'10111111'                           2443 09700000
*         RSENTPT = ADDR(RSVOLENT);                                2444 09701000
*                                                                  2444 09702000
         LA    @04,RSVOLENT(,@04)                                  2444 09703000
         ST    @04,RSENTPT(,REG6)                                  2444 09704000
*UPCRLP1: DO UNTIL (RSENTPT = 0);                                  2445 09705000
*                                                                  2445 09706000
UPCRLP1  DS    0H                                                  2445 09707000
@DL02445 DS    0H                                                  2446 09708000
*         /***********************************************************/ 09709000
*         /*                                                         */ 09710000
*         /*    OBTAIN NEXT ENTRY IN RESVOL VIA SCNRLST.             */ 09711000
*         /*                                                         */ 09712000
*         /***********************************************************/ 09713000
*                                                                  2446 09714000
*         /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRLST            */ 09715000
*         CALL IDCRS5SR('N','B',RSENTPT,NULLPTR);                  2446 09716000
*                                                                  2446 09717000
         MVC   @AL00001(16),@AL02446                               2446 09718000
         LA    @04,RSENTPT(,REG6)                                  2446 09719000
         ST    @04,@AL00001+8                                      2446 09720000
         L     @15,@CV03539                                        2446 09721000
         LA    @01,@AL00001                                        2446 09722000
         BALR  @14,@15                                             2446 09723000
*         /***********************************************************/ 09724000
*         /*                                                         */ 09725000
*         /*    THIS CRA IS TO BE UPDATED.                           */ 09726000
*         /*                                                         */ 09727000
*         /***********************************************************/ 09728000
*                                                                  2447 09729000
*           IF RSENTPT ^= 0 & RESVLUPD ^= 0                        2447 09730000
*             THEN                                                 2447 09731000
         SLR   @04,@04                                             2447 09732000
         L     @15,RSENTPT(,REG6)                                  2447 09733000
         CR    @15,@04                                             2447 09734000
         BE    @RF02447                                            2447 09735000
         C     @04,RESVLUPD(,@15)                                  2447 09736000
         BE    @RF02447                                            2447 09737000
*UPCRUP:        DO;                                                2448 09738000
UPCRUP   DS    0H                                                  2449 09739000
*                 RSMEOP = OFF;                                    2449 09740000
*                 RSUCCCR = OFF;                                   2450 09741000
*                                                                  2450 09742000
         NI    RSMEOP(REG6),B'11011110'                            2450 09743000
*         /***********************************************************/ 09744000
*         /*                                                         */ 09745000
*         /*    OPEN AND VERIFY THE CRA VIA DSOPEN                   */ 09746000
*         /*                                                         */ 09747000
*         /***********************************************************/ 09748000
*                                                                  2451 09749000
*                 RSCRADD = ADDR(RESVLDDN);                        2451 09750000
*                                                                  2451 09751000
         L     @04,RSENTPT(,REG6)                                  2451 09752000
         LA    @04,RESVLDDN(,@04)                                  2451 09753000
         ST    @04,RSCRADD(,REG6)                                  2451 09754000
*                 /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSOPEN     */ 09755000
*                 CALL IDCRS6DO('B','R','U',RSCRADD,NULLPTR,RSMRPAS);   09756000
*                                                                  2452 09757000
         MVC   @AL00001(20),@AL02452                               2452 09758000
         LA    @04,RSCRADD(,REG6)                                  2452 09759000
         ST    @04,@AL00001+12                                     2452 09760000
         LA    @04,RSMRPAS(,REG6)                                  2452 09761000
         ST    @04,@AL00001+20                                     2452 09762000
         L     @15,@CV03580                                        2452 09763000
         LA    @01,@AL00001                                        2452 09764000
         BALR  @14,@15                                             2452 09765000
*                 RESPECIFY RTNREG RSTD;                           2453 09766000
*                 TESTRC = RTNREG;                                 2454 09767000
         STH   RTNREG,TESTRC(,REG6)                                2454 09768000
*                 RESPECIFY RTNREG UNRSTD;                         2455 09769000
*                                                                  2455 09770000
*         /***********************************************************/ 09771000
*         /*                                                         */ 09772000
*         /*    IF OPEN FAILED, SET TERMINATE AT END FLAG            */ 09773000
*         /*    AND DO NOT UPDATE THIS CRA. IF OPEN WAS SUCCESSFUL,  */ 09774000
*         /*    SET CRA OPEN FLAG.                                   */ 09775000
*         /*    IGNORE VERIFY FAILURE.                               */ 09776000
*         /*                                                         */ 09777000
*         /***********************************************************/ 09778000
*                                                                  2456 09779000
*                 IF TESTRC = RCUERR1                              2456 09780000
*                   THEN                                           2456 09781000
         LH    @04,TESTRC(,REG6)                                   2456 09782000
         C     @04,@CF00046                                        2456 09783000
         BNE   @RF02456                                            2456 09784000
*                     RSMETRM = ON;                                2457 09785000
*                                                                  2457 09786000
         OI    RSMETRM(REG6),B'01000000'                           2457 09787000
*         /***********************************************************/ 09788000
*         /*                                                         */ 09789000
*         /*    OPEN OF CRA WAS SUCCESSFUL.                          */ 09790000
*         /*                                                         */ 09791000
*         /***********************************************************/ 09792000
*                                                                  2458 09793000
*                   ELSE                                           2458 09794000
*UPCROP:              DO;                                          2458 09795000
         B     @RC02456                                            2458 09796000
@RF02456 DS    0H                                                  2458 09797000
UPCROP   DS    0H                                                  2459 09798000
*                       RSMEOP = ON;                               2459 09799000
*                                                                  2459 09800000
         OI    RSMEOP(REG6),B'00100000'                            2459 09801000
*         /***********************************************************/ 09802000
*         /*                                                 @ZA18274*/ 09803000
*         /*    IF THERE ARE F1DSCBS TO RENAME THEN CALL     @ZA18274*/ 09804000
*         /*    PROCEDURE TO RENAME F1DSCBS FOR THIS CRA,    @ZA18274*/ 09805000
*         /*    IF ANY                                       @ZA18274*/ 09806000
*         /*                                                 @ZA18274*/ 09807000
*         /***********************************************************/ 09808000
*                                                                  2460 09809000
*                       IF RSF1RNAM ^= 0                           2460 09810000
*                         THEN  /* CALL TO MODULE IDCRS07 FOR PROCEDURE 09811000
*RENAMEF                                                             */ 09812000
         L     @04,RSF1RNAM(,REG6)                                 2460 09813000
         LTR   @04,@04                                             2460 09814000
         BZ    @RF02460                                            2460 09815000
*                               CALL RENAMEF;           /*@ZA18274*/    09816000
*                                                                  2461 09817000
         L     @15,@CV03700                                        2461 09818000
         BALR  @14,@15                                             2461 09819000
*         /***********************************************************/ 09820000
*         /*                                                         */ 09821000
*         /*    READ EACH WORKFILE RECORD ON THE CRA UPDATE CHAIN.   */ 09822000
*         /*                                                         */ 09823000
*         /***********************************************************/ 09824000
*                                                                  2462 09825000
*                       RSUCNXT = RESVLUPD;                        2462 09826000
*                                                                  2462 09827000
@RF02460 L     @04,RSENTPT(,REG6)                                  2462 09828000
         L     @04,RESVLUPD(,@04)                                  2462 09829000
         ST    @04,RSUCNXT(,REG6)                                  2462 09830000
*UPCRLP2:               DO WHILE (RSUCNXT ^= 0);                   2463 09831000
*                                                                  2463 09832000
UPCRLP2  B     @DE02463                                            2463 09833000
@DL02463 DS    0H                                                  2464 09834000
*         /***********************************************************/ 09835000
*         /*                                                         */ 09836000
*         /*    GET WORKFILE RECORD VIA RECMGMT.                     */ 09837000
*         /*                                                         */ 09838000
*         /***********************************************************/ 09839000
*                                                                  2464 09840000
*                         RSGRABCU = ADDR(GRABSWF);                2464 09841000
         L     @04,RSIOTBL(,REG6)                                  2464 09842000
         ST    @04,RSGRABCU(,REG6)                                 2464 09843000
*                         RABRCDA = RSUCNXT;                       2465 09844000
*                                                                  2465 09845000
*                                                                  2465 09846000
         L     @04,GRABCURR(,@04)                                  2465 09847000
         L     @15,RSUCNXT(,REG6)                                  2465 09848000
         ST    @15,RABRCDA(,@04)                                   2465 09849000
*                         DO;                                      2466 09850000
*                           RSRTYPE = ''B;                         2467 09851000
         MVI   RSRTYPE(REG6),X'00'                                 2467 09852000
*                           RSRGET = ON;      /* GETRCD  */        2468 09853000
         OI    RSRGET(REG6),B'10000000'                            2468 09854000
*                           RSRUPD = OFF;     /* NO UPDATE  */     2469 09855000
         NI    RSRUPD(REG6),B'11110111'                            2469 09856000
*                           RSRDS = ''B;                           2470 09857000
         NI    RSRDS(REG6),B'00011111'                             2470 09858000
*                           RSRWF = ON;       /* WORKFILE  */      2471 09859000
*                           RSRDIR = ON;      /* DIRECT  */        2472 09860000
*                           RSRKEY = ON;      /* KEY  */           2473 09861000
*                                                                  2473 09862000
         OI    RSRWF(REG6),B'10010100'                             2473 09863000
*                         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMG 09864000
*T                                                                   */ 09865000
*                         CALL RECMGMT;                            2474 09866000
         L     @15,@CV03498                                        2474 09867000
         BALR  @14,@15                                             2474 09868000
*                           RFY RTNREG RSTD;                       2475 09869000
*                           TESTRC = RTNREG;                       2476 09870000
         STH   RTNREG,TESTRC(,REG6)                                2476 09871000
*                           RFY RTNREG UNRSTD;                     2477 09872000
*                         END;                                     2478 09873000
*                                                                  2478 09874000
*                         RSUCNXT = RSWCHPTR;                      2479 09875000
*                                                                  2479 09876000
         L     @04,RSGRABCU(,REG6)                                 2479 09877000
         L     @04,GRABCURR(,@04)                                  2479 09878000
         L     @15,RSWCHPTR(,@04)                                  2479 09879000
         ST    @15,RSUCNXT(,REG6)                                  2479 09880000
*         /***********************************************************/ 09881000
*         /*                                                         */ 09882000
*         /*    FREE RECORD. PLACE ON CCR FREE RECORD CHAIN.         */ 09883000
*         /*                                                         */ 09884000
*         /***********************************************************/ 09885000
*                                                                  2480 09886000
*                         IF RCDID = FREEID                        2480 09887000
*                           THEN                                   2480 09888000
         CLI   RCDID+8(@04),C'F'                                   2480 09889000
         BNE   @RF02480                                            2480 09890000
*UPCRFRE:                     DO;                                  2481 09891000
*                                                                  2481 09892000
UPCRFRE  DS    0H                                                  2482 09893000
*                               RSGRABCU = ADDR(GRABSCR);          2482 09894000
         L     @04,RSIOTBL(,REG6)                                  2482 09895000
         LA    @04,GRABSCR(,@04)                                   2482 09896000
         ST    @04,RSGRABCU(,REG6)                                 2482 09897000
*                               GRABCURR = GRABRAB2;               2483 09898000
*                                                                  2483 09899000
         L     @15,GRABRAB2(,@04)                                  2483 09900000
         ST    @15,GRABCURR(,@04)                                  2483 09901000
*                               RFY CATRCD BASED(ADDR(ADDR(GRABSCR)     09902000
*                                   -> GRABRAB1 -> RABBUF));       2484 09903000
*                               RFY CCR BASED(ADDR(ADDR(GRABSCR)   2485 09904000
*                                   -> GRABRAB2 -> RABBUF));       2485 09905000
*                                                                  2485 09906000
*         /***********************************************************/ 09907000
*         /*                                                         */ 09908000
*         /*    IF CCR RECORD HAS NOT BEEN READ, GET IT VIA RECMGMT. */ 09909000
*         /*                                                         */ 09910000
*         /***********************************************************/ 09911000
*                                                                  2486 09912000
*                               IF RSUCCCR = OFF                   2486 09913000
*                                 THEN                             2486 09914000
         TM    RSUCCCR(REG6),B'00000001'                           2486 09915000
         BNZ   @RF02486                                            2486 09916000
*                                   DO;                            2487 09917000
*                                     RABRCDA = CCRCI;             2488 09918000
*                                                                  2488 09919000
*                                                                  2488 09920000
         MVC   RABRCDA(4,@15),@CF00166                             2488 09921000
*                                     DO;                          2489 09922000
*                                       RSRTYPE = ''B;             2490 09923000
         MVI   RSRTYPE(REG6),X'00'                                 2490 09924000
*                                       RSRGET = ON;      /* GETRCD  */ 09925000
         OI    RSRGET(REG6),B'10000000'                            2491 09926000
*                                       RSRUPD = ON;      /* UPDATE  */ 09927000
         OI    RSRUPD(REG6),B'00001000'                            2492 09928000
*                                       RSRDS = ''B;               2493 09929000
         NI    RSRDS(REG6),B'00011111'                             2493 09930000
*                                       RSRCRA = ON;      /* CRA  */    09931000
*                                       RSRDIR = ON;      /* DIRECT  */ 09932000
*                                       RSRKEY = OFF;     /* CNV  */    09933000
*                                                                  2496 09934000
         OI    RSRCRA(REG6),B'00100100'                            2496 09935000
         NI    RSRKEY(REG6),B'11101111'                            2496 09936000
*                                     /* CALL TO MODULE IDCRS06 FOR PRO 09937000
*EDURE RECMGMT                                                       */ 09938000
*                                     CALL RECMGMT;                2497 09939000
         L     @15,@CV03498                                        2497 09940000
         BALR  @14,@15                                             2497 09941000
*                                       RFY RTNREG RSTD;           2498 09942000
*                                       TESTRC = RTNREG;           2499 09943000
         STH   RTNREG,TESTRC(,REG6)                                2499 09944000
*                                       RFY RTNREG UNRSTD;         2500 09945000
*                                     END;                         2501 09946000
*                                                                  2501 09947000
*                                   END;                           2502 09948000
*                                                                  2502 09949000
*         /***********************************************************/ 09950000
*         /*                                                         */ 09951000
*         /*    PLACE RECORD ON CRA CCR FREE CHAIN.                  */ 09952000
*         /*                                                         */ 09953000
*         /***********************************************************/ 09954000
*                                                                  2503 09955000
*                               CRBUF1(1:256) = ''B;               2503 09956000
@RF02486 L     @04,RSCRBP1(,REG6)                                  2503 09957000
         XC    CRBUF1(256,@04),CRBUF1(@04)                         2503 09958000
*                               CRBUF1(257:CELEN) = ''B;           2504 09959000
         XC    CRBUF1+256(249,@04),CRBUF1+256(@04)                 2504 09960000
*                               RCDID = FREEID;                    2505 09961000
         LA    @04,8                                               2505 09962000
         L     @15,RSIOTBL(,REG6)                                  2505 09963000
         LA    @14,80                                              2505 09964000
         ALR   @14,@15                                             2505 09965000
         L     @03,GRABRAB1(,@14)                                  2505 09966000
         ALR   @03,@04                                             2505 09967000
         MVI   RCDID(@03),C'F'                                     2505 09968000
*                               RSUCENTF = CCRFDCI;                2506 09969000
         L     @02,GRABRAB2(,@14)                                  2506 09970000
         ALR   @02,@04                                             2506 09971000
         MVC   RSUCENTF(3,@03),CCRFDCI(@02)                        2506 09972000
*                               RCDCINO = ADDR(ADDR(GRABSWF) ->    2507 09973000
*                                 GRABCURR -> RABBUF) -> RCDCRACI; 2507 09974000
         AL    @04,GRABCURR(,@15)                                  2507 09975000
         MVC   RCDCINO(3,@03),RCDCRACI(@04)                        2507 09976000
*                               CCRFDCI = RCDCINO;                 2508 09977000
         MVC   CCRFDCI(3,@02),RCDCINO(@03)                         2508 09978000
*                               CCRCDCI = CCRCDCI + 1;             2509 09979000
         LA    @04,1                                               2509 09980000
         SLR   @03,@03                                             2509 09981000
         ICM   @03,7,CCRCDCI(@02)                                  2509 09982000
         ALR   @04,@03                                             2509 09983000
         STCM  @04,7,CCRCDCI(@02)                                  2509 09984000
*                               RSUCCCR = ON;                      2510 09985000
*                                                                  2510 09986000
         OI    RSUCCCR(REG6),B'00000001'                           2510 09987000
*                             END UPCRFRE;                         2511 09988000
*                                                                  2511 09989000
*         /***********************************************************/ 09990000
*         /*                                                         */ 09991000
*         /*    NOT A FREE RECORD. MOVE RECORD TO CRA BUFFER.        */ 09992000
*         /*                                                         */ 09993000
*         /***********************************************************/ 09994000
*                                                                  2512 09995000
*                           ELSE                                   2512 09996000
*                             DO;                                  2512 09997000
         B     @RC02480                                            2512 09998000
@RF02480 DS    0H                                                  2513 09999000
*                               CRBUF1(1:256) = WFBUF1(1:256);     2513 10000000
         L     @04,RSCRBP1(,REG6)                                  2513 10001000
         L     @15,RSWFBP1(,REG6)                                  2513 10002000
         MVC   CRBUF1(256,@04),WFBUF1(@15)                         2513 10003000
*                               CRBUF1(257:CELEN) = WFBUF1(257:CELEN);  10004000
         MVC   CRBUF1+256(249,@04),WFBUF1+256(@15)                 2514 10005000
*                             END;                                 2515 10006000
*                                                                  2515 10007000
*         /***********************************************************/ 10008000
*         /*                                                         */ 10009000
*         /*    UPDATE CRA RECORD VIA RECMGMT.                       */ 10010000
*         /*                                                         */ 10011000
*         /***********************************************************/ 10012000
*                                                                  2516 10013000
*                         RSGRABCU = ADDR(GRABSCR);                2516 10014000
@RC02480 L     @04,RSIOTBL(,REG6)                                  2516 10015000
         LA    @15,GRABSCR(,@04)                                   2516 10016000
         ST    @15,RSGRABCU(,REG6)                                 2516 10017000
*                         GRABCURR = GRABRAB1;                     2517 10018000
         L     @14,GRABRAB1(,@15)                                  2517 10019000
         ST    @14,GRABCURR(,@15)                                  2517 10020000
*                         IF RCDID = FREEID                        2518 10021000
*                           THEN                                   2518 10022000
         LA    @15,8                                               2518 10023000
         AL    @15,GRABRAB1+80(,@04)                               2518 10024000
         CLI   RCDID(@15),C'F'                                     2518 10025000
         BNE   @RF02518                                            2518 10026000
*                             RABRCDA = RCDCINO;                   2519 10027000
         L     @04,RCDCINO-1(,@15)                                 2519 10028000
         LA    @04,0(,@04)                                         2519 10029000
         ST    @04,RABRCDA(,@14)                                   2519 10030000
*                           ELSE                                   2520 10031000
*                             RABRCDA = RCDCRACI;                  2520 10032000
*                                                                  2520 10033000
*                                                                  2520 10034000
         B     @RC02518                                            2520 10035000
@RF02518 L     @04,RSGRABCU(,REG6)                                 2520 10036000
         L     @04,GRABCURR(,@04)                                  2520 10037000
         L     @01,RSIOTBL(,REG6)                                  2520 10038000
         L     @01,GRABRAB1+80(,@01)                               2520 10039000
         SLR   @00,@00                                             2520 10040000
         ICM   @00,7,RCDCRACI+8(@01)                               2520 10041000
         ST    @00,RABRCDA(,@04)                                   2520 10042000
*                         DO;                                      2521 10043000
@RC02518 DS    0H                                                  2522 10044000
*                           RSRTYPE = ''B;                         2522 10045000
         MVI   RSRTYPE(REG6),X'00'                                 2522 10046000
*                           RSRUPDT = ON;     /* UPDRCD  */        2523 10047000
         OI    RSRUPDT(REG6),B'00100000'                           2523 10048000
*                           RSRUPD = ON;      /* UPDATE  */        2524 10049000
         OI    RSRUPD(REG6),B'00001000'                            2524 10050000
*                           RSRDS = ''B;                           2525 10051000
         NI    RSRDS(REG6),B'00011111'                             2525 10052000
*                           RSRCRA = ON;      /* CRA  */           2526 10053000
*                           RSRDIR = ON;      /* DIRECT  */        2527 10054000
*                           RSRKEY = OFF;     /* CNV  */           2528 10055000
*                                                                  2528 10056000
         OI    RSRCRA(REG6),B'00100100'                            2528 10057000
         NI    RSRKEY(REG6),B'11101111'                            2528 10058000
*                         /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMG 10059000
*T                                                                   */ 10060000
*                         CALL RECMGMT;                            2529 10061000
         L     @15,@CV03498                                        2529 10062000
         BALR  @14,@15                                             2529 10063000
*                           RFY RTNREG RSTD;                       2530 10064000
*                           TESTRC = RTNREG;                       2531 10065000
         STH   RTNREG,TESTRC(,REG6)                                2531 10066000
*                           RFY RTNREG UNRSTD;                     2532 10067000
*                         END;                                     2533 10068000
*                                                                  2533 10069000
*                       END UPCRLP2;                               2534 10070000
*                                                                  2534 10071000
@DE02463 L     @04,RSUCNXT(,REG6)                                  2534 10072000
         LTR   @04,@04                                             2534 10073000
         BNZ   @DL02463                                            2534 10074000
*                       RFY CCR;                                   2535 10075000
*                       RFY CATRCD;                                2536 10076000
*                                                                  2536 10077000
*         /***********************************************************/ 10078000
*         /*                                                         */ 10079000
*         /*  CRA UPDATE CHAIN PROCESSING COMPLETE. UPDATE THE CRA   */ 10080000
*         /*  CCR RECORD.                                            */ 10081000
*         /*                                                         */ 10082000
*         /***********************************************************/ 10083000
*                                                                  2537 10084000
*                       RSGRABCU = ADDR(GRABSCR);                  2537 10085000
         L     @04,RSIOTBL(,REG6)                                  2537 10086000
         LA    @04,GRABSCR(,@04)                                   2537 10087000
         ST    @04,RSGRABCU(,REG6)                                 2537 10088000
*                       GRABCURR = GRABRAB2;                       2538 10089000
         L     @15,GRABRAB2(,@04)                                  2538 10090000
         ST    @15,GRABCURR(,@04)                                  2538 10091000
*                       RABRCDA = CCRCI;                           2539 10092000
*                                                                  2539 10093000
         MVC   RABRCDA(4,@15),@CF00166                             2539 10094000
*         /***********************************************************/ 10095000
*         /*                                                         */ 10096000
*         /*    IF CCR RECORD HAS NOT BEEN READ, GET IT VIA RECMGMT  */ 10097000
*         /*                                                         */ 10098000
*         /***********************************************************/ 10099000
*                                                                  2540 10100000
*                       IF RSUCCCR = OFF                           2540 10101000
*                         THEN                                     2540 10102000
*                                                                  2540 10103000
*                                                                  2540 10104000
         TM    RSUCCCR(REG6),B'00000001'                           2540 10105000
         BNZ   @RF02540                                            2540 10106000
*                           DO;                                    2541 10107000
*                             RSRTYPE = ''B;                       2542 10108000
         MVI   RSRTYPE(REG6),X'00'                                 2542 10109000
*                             RSRGET = ON;      /* GETRCD  */      2543 10110000
         OI    RSRGET(REG6),B'10000000'                            2543 10111000
*                             RSRUPD = ON;      /* UPDATE  */      2544 10112000
         OI    RSRUPD(REG6),B'00001000'                            2544 10113000
*                             RSRDS = ''B;                         2545 10114000
         NI    RSRDS(REG6),B'00011111'                             2545 10115000
*                             RSRCRA = ON;      /* CRA  */         2546 10116000
*                             RSRDIR = ON;      /* DIRECT  */      2547 10117000
*                             RSRKEY = OFF;     /* CNV  */         2548 10118000
*                                                                  2548 10119000
         OI    RSRCRA(REG6),B'00100100'                            2548 10120000
         NI    RSRKEY(REG6),B'11101111'                            2548 10121000
*                           /* CALL TO MODULE IDCRS06 FOR PROCEDURE REC 10122000
*GMT                                                                 */ 10123000
*                           CALL RECMGMT;                          2549 10124000
         L     @15,@CV03498                                        2549 10125000
         BALR  @14,@15                                             2549 10126000
*                             RFY RTNREG RSTD;                     2550 10127000
*                             TESTRC = RTNREG;                     2551 10128000
         STH   RTNREG,TESTRC(,REG6)                                2551 10129000
*                             RFY RTNREG UNRSTD;                   2552 10130000
*                           END;                                   2553 10131000
*                                                                  2553 10132000
*         /***********************************************************/ 10133000
*         /*                                                         */ 10134000
*         /*    WRITE THE CRA CCR RECORD VIA RECMGMT.                */ 10135000
*         /*                                                         */ 10136000
*         /***********************************************************/ 10137000
*                                                                  2554 10138000
*                                                                  2554 10139000
*                       DO;                                        2554 10140000
@RF02540 DS    0H                                                  2555 10141000
*                         RSRTYPE = ''B;                           2555 10142000
         MVI   RSRTYPE(REG6),X'00'                                 2555 10143000
*                         RSRUPDT = ON;     /* UPDRCD  */          2556 10144000
         OI    RSRUPDT(REG6),B'00100000'                           2556 10145000
*                         RSRUPD = ON;      /* UPDATE  */          2557 10146000
         OI    RSRUPD(REG6),B'00001000'                            2557 10147000
*                         RSRDS = ''B;                             2558 10148000
         NI    RSRDS(REG6),B'00011111'                             2558 10149000
*                         RSRCRA = ON;      /* CRA  */             2559 10150000
*                         RSRDIR = ON;      /* DIRECT  */          2560 10151000
*                         RSRKEY = OFF;     /* CNV  */             2561 10152000
*                                                                  2561 10153000
         OI    RSRCRA(REG6),B'00100100'                            2561 10154000
         NI    RSRKEY(REG6),B'11101111'                            2561 10155000
*                       /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT 10156000
*                                                                    */ 10157000
*                       CALL RECMGMT;                              2562 10158000
         L     @15,@CV03498                                        2562 10159000
         BALR  @14,@15                                             2562 10160000
*                         RFY RTNREG RSTD;                         2563 10161000
*                         TESTRC = RTNREG;                         2564 10162000
         STH   RTNREG,TESTRC(,REG6)                                2564 10163000
*                         RFY RTNREG UNRSTD;                       2565 10164000
*                       END;                                       2566 10165000
*                                                                  2566 10166000
*                     END UPCROP;                                  2567 10167000
*                                                                  2567 10168000
*         /***********************************************************/ 10169000
*         /*                                                         */ 10170000
*         /*  CLOSE THE CRA VIA DSCLOSE.                             */ 10171000
*         /*                                                         */ 10172000
*         /***********************************************************/ 10173000
*                                                                  2568 10174000
*                 IF RSMEOP = ON                                   2568 10175000
*                   THEN                                           2568 10176000
@RC02456 TM    RSMEOP(REG6),B'00100000'                            2568 10177000
         BNO   @RF02568                                            2568 10178000
*                     DO;                                          2569 10179000
*                                                                  2569 10180000
*                       /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSCLOSE 10181000
*                                                                    */ 10182000
*                       CALL IDCRS6DC('R');                        2570 10183000
*                                                                  2570 10184000
         L     @15,@CV03542                                        2570 10185000
         LA    @01,@AL02570                                        2570 10186000
         BALR  @14,@15                                             2570 10187000
*                       RESPECIFY RTNREG RSTD;                     2571 10188000
*                       TESTRC = RTNREG;                           2572 10189000
         STH   RTNREG,TESTRC(,REG6)                                2572 10190000
*                       RESPECIFY RTNREG UNRSTD;                   2573 10191000
*                                                                  2573 10192000
*         /***********************************************************/ 10193000
*         /*                                                         */ 10194000
*         /*    IF CLOSE FAILED, SET TERMINATE AT END FLAG.          */ 10195000
*         /*                                                         */ 10196000
*         /***********************************************************/ 10197000
*                                                                  2574 10198000
*                       IF TESTRC ^= 0                             2574 10199000
*                         THEN                                     2574 10200000
         LH    @04,TESTRC(,REG6)                                   2574 10201000
         LTR   @04,@04                                             2574 10202000
         BZ    @RF02574                                            2574 10203000
*                           RSMETRM = ON;                          2575 10204000
*                                                                  2575 10205000
         OI    RSMETRM(REG6),B'01000000'                           2575 10206000
*                     END;                                         2576 10207000
*                                                                  2576 10208000
@RF02574 DS    0H                                                  2577 10209000
*               END UPCRUP;                                        2577 10210000
*                                                                  2577 10211000
@RF02568 DS    0H                                                  2578 10212000
*         END UPCRLP1;                                             2578 10213000
*                                                                  2578 10214000
@RF02447 DS    0H                                                  2578 10215000
@DE02445 L     @04,RSENTPT(,REG6)                                  2578 10216000
         LTR   @04,@04                                             2578 10217000
         BNZ   @DL02445                                            2578 10218000
*         /***********************************************************/ 10219000
*         /*                                                         */ 10220000
*         /*  ALL CRAS HAVE BEEN PROCESSED. IF TERMINATE AT END      */ 10221000
*         /*  FLAG WAS SET DUE TO AN ERROR IN PROCESSING ONE OR      */ 10222000
*         /*  CRAS, THE CALL CKERR TO TERMINATE.                     */ 10223000
*         /*                                                         */ 10224000
*         /***********************************************************/ 10225000
*                                                                  2579 10226000
*         IF RSMETRM = ON                                          2579 10227000
*           THEN                                                   2579 10228000
*                                                                  2579 10229000
*                                                                  2579 10230000
         TM    RSMETRM(REG6),B'01000000'                           2579 10231000
         BNO   @RF02579                                            2579 10232000
*             DO;                                                  2580 10233000
*             /*CALL CKERR*/                                       2581 10234000
*               RSCKERR = RSCKERR && RSCKERR;                      2581 10235000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2581 10236000
*               RSCKERN = RSE064;                                  2582 10237000
         MVC   RSCKERN(2,REG6),@CH00750                            2582 10238000
*               RSCKTERM = 'TERM';                                 2583 10239000
*                                                                  2583 10240000
         MVC   RSCKTERM(4,REG6),@CC03543                           2583 10241000
*             /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR          */ 10242000
*             CALL CKERR;                                          2584 10243000
         L     @15,@CV03544                                        2584 10244000
         BALR  @14,@15                                             2584 10245000
*             END;                                                 2585 10246000
*                                                                  2585 10247000
*         /***********************************************************/ 10248000
*         /*                                                         */ 10249000
*         /*  PROCESSING COMPLETED. RETURN.                          */ 10250000
*         /*                                                         */ 10251000
*         /***********************************************************/ 10252000
*                                                                  2586 10253000
*                                                                  2586 10254000
*                                                                  2586 10255000
*         IF GDTDBG = NULLPTR                                      2586 10256000
*           THEN;                                                  2586 10257000
@RF02579 L     @04,GDTDBG(,REG5)                                   2586 10258000
         LTR   @04,@04                                             2586 10259000
         BZ    @RT02586                                            2586 10260000
*           ELSE                                                   2588 10261000
*             CALL IDCDB010 (GDTTBL,'RSU2');                       2588 10262000
*                                                                  2588 10263000
         ST    REG5,@AL00001                                       2588 10264000
         LA    @04,@CC03711                                        2588 10265000
         ST    @04,@AL00001+4                                      2588 10266000
         MVI   @AL00001+4,X'80'                                    2588 10267000
         L     @15,GDTDBG(,REG5)                                   2588 10268000
         LA    @01,@AL00001                                        2588 10269000
         BALR  @14,@15                                             2588 10270000
* CALL EXIT;  /*TERMINATE*/                                        2589 10271000
@RT02586 BAL   @14,EXIT                                            2589 10272000
* END UPDCRA; /*END OF PROCEDURE*/                                 2590 10273000
@EL00011 DS    0H                                                  2590 10274000
@EF00011 DS    0H                                                  2590 10275000
@ER00011 BR    @14                                                 2590 10276000
@PB00011 DS    0H                                                  2591 10277000
*/********************************************************************/ 10278000
*/*                                                                  */ 10279000
*/* PROCEDURE NAME - WRAPUP                                          */ 10280000
*/*                                                                  */ 10281000
*/* FUNCTION - COMPLETE NORMAL PROCESSING FOR RESETCAT               */ 10282000
*/*                                                                  */ 10283000
*/* INPUT -    NONE                                                  */ 10284000
*/*                                                                  */ 10285000
*/* OUTPUT -   NONE                                                  */ 10286000
*/*                                                                  */ 10287000
*/* EXIT, NORMAL - RETURN TO SYSTEM                                  */ 10288000
*/*                                                                  */ 10289000
*/********************************************************************/ 10290000
*      GENERATE;                                                   2591 10291000
         DS    0F                                                       10292000
NAME0273 DC    CL8'WRAPUP'                                              10293000
*WRAPUP: PROCEDURE                                                 2592 10294000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               2592 10295000
*                                                                  2592 10296000
         B     @PB00012                                            2592 10297000
WRAPUP   DS    0H                                                  2593 10298000
*      GENERATE REFS(RS01RG08, REG6);                              2593 10299000
*                                                                  2593 10300000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          10301000
         LR    @15,@13  OLD SAVE AREA                                   10302000
         LA    @13,72(@13)  NEW SAVE AREA                               10303000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     10304000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        10305000
         ENTRY WRAPUP  ENTRY POINT                                      10306000
         LM    @08,@12,RS01RG08(REG6)  PRIME BASE AND DATA REGS         10307000
         MVC   0(4,@15),NAME0273  PROCNAME TO REGSAVE                   10308000
*         OLDERID2 = NEWERID2;                                     2594 10309000
         L     @04,GDTTR2(,REG5)                                   2594 10310000
         MVC   @TS00001(95),NEWERID2(@04)                          2594 10311000
         MVC   OLDERID2(95,@04),@TS00001                           2594 10312000
*         NEWID2 = 'RSWR';                                         2595 10313000
*                                                                  2595 10314000
         MVC   NEWID2(4,@04),@CC03715                              2595 10315000
*         /***********************************************************/ 10316000
*         /*                                                         */ 10317000
*         /*  FREE RESOURCES VIA CLEANUP IF NOT RECURSIVE TERMINATION*/ 10318000
*         /*                                                         */ 10319000
*         /***********************************************************/ 10320000
*                                                                  2596 10321000
*         IF RSTERM = OFF THEN                                     2596 10322000
         TM    RSTERM(REG6),B'00000100'                            2596 10323000
         BNZ   @RF02596                                            2596 10324000
*           CALL CLEANUP;                                          2597 10325000
*                                                                  2597 10326000
         BAL   @14,CLEANUP                                         2597 10327000
*         /***********************************************************/ 10328000
*         /*                                                         */ 10329000
*         /*  PRINT PROCESSING COMPLETED MESSAGE VIA CKERR.          */ 10330000
*         /*                                                         */ 10331000
*         /***********************************************************/ 10332000
*                                                                  2598 10333000
*                                                                  2598 10334000
*         DO;                                                      2598 10335000
@RF02596 DS    0H                                                  2599 10336000
*         /*CALL CKERR*/                                           2599 10337000
*           RSCKERR = RSCKERR && RSCKERR;                          2599 10338000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2599 10339000
*           RSCKERN = RSE084;                                      2600 10340000
         MVC   RSCKERN(2,REG6),@CH01056                            2600 10341000
*           RSCKTERM = 'RETU';                                     2601 10342000
         MVC   RSCKTERM(4,REG6),@CC03585                           2601 10343000
*           RSCKMVAR(1) = ADDR(LASTCC);                            2602 10344000
*                                                                  2602 10345000
         L     @04,RSLASTCC(,REG6)                                 2602 10346000
         ST    @04,RSCKMVAR(,REG6)                                 2602 10347000
*         /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR              */ 10348000
*         CALL CKERR;                                              2603 10349000
         L     @15,@CV03544                                        2603 10350000
         BALR  @14,@15                                             2603 10351000
*         END;                                                     2604 10352000
*                                                                  2604 10353000
*         /***********************************************************/ 10354000
*         /*                                                         */ 10355000
*         /*  RETURN TO SYSTEM VIA UEPIL                             */ 10356000
*         /*     NOTE *** REG 13 MUST POINT TO 1ST BYTE OF DYNAMIC   */ 10357000
*         /*              STORAGE FOR THIS MODULE FOR UEPIL          */ 10358000
*         /*                                                         */ 10359000
*         /***********************************************************/ 10360000
*                                                                  2605 10361000
*         REG13 = REG8;                                            2605 10362000
         LR    REG13,REG8                                          2605 10363000
*         CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                      2606 10364000
*                                                                  2606 10365000
         ST    REG5,@AL00001                                       2606 10366000
         LA    @04,MODID                                           2606 10367000
         ST    @04,@AL00001+4                                      2606 10368000
         L     @04,RSLASTCC(,REG6)                                 2606 10369000
         ST    @04,@AL00001+8                                      2606 10370000
         MVI   @AL00001+8,X'80'                                    2606 10371000
         L     @15,GDTEPL(,REG5)                                   2606 10372000
         LA    @01,@AL00001                                        2606 10373000
         BALR  @14,@15                                             2606 10374000
* CALL EXIT;  /*TERMINATE*/                                        2607 10375000
         BAL   @14,EXIT                                            2607 10376000
* END WRAPUP; /*END OF PROCEDURE*/                                 2608 10377000
@EL00012 DS    0H                                                  2608 10378000
@EF00012 DS    0H                                                  2608 10379000
@ER00012 BR    @14                                                 2608 10380000
@PB00012 DS    0H                                                  2609 10381000
*/********************************************************************/ 10382000
*/*                                                                  */ 10383000
*/* PROCEDURE NAME - CLEANUP                                         */ 10384000
*/*                                                                  */ 10385000
*/* FUNCTION - ENSURE THAT ALL RESOURCES OBTAINED BY RESETCAT        */ 10386000
*/*            ARE FREED BEFORE TERMINATION.                         */ 10387000
*/*                                                                  */ 10388000
*/* INPUT -    NONE                                                  */ 10389000
*/*                                                                  */ 10390000
*/* OUTPUT -   NONE                                                  */ 10391000
*/*                                                                  */ 10392000
*/* EXIT, NORMAL - RETURN TO CALLER                                  */ 10393000
*/*                                                                  */ 10394000
*/********************************************************************/ 10395000
*      GENERATE;                                                   2609 10396000
         DS    0F                                                       10397000
NAME0279 DC    CL8'CLEANUP'                                             10398000
*CLEANUP: PROCEDURE                                                2610 10399000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               2610 10400000
*                                                                  2610 10401000
         B     @PB00013                                            2610 10402000
CLEANUP  DS    0H                                                  2611 10403000
*      GENERATE REFS(RS01RG08, REG6);                              2611 10404000
*                                                                  2611 10405000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          10406000
         LR    @15,@13  OLD SAVE AREA                                   10407000
         LA    @13,72(@13)  NEW SAVE AREA                               10408000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     10409000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        10410000
         MVC   0(4,@15),NAME0279  PROCNAME TO REGSAVE                   10411000
*         RFY RESVOL BASED(RSSUBENP);                              2612 10412000
*                                                                  2612 10413000
*         OLDERID2 = NEWERID2;                                     2613 10414000
         L     @04,GDTTR2(,REG5)                                   2613 10415000
         MVC   @TS00001(95),NEWERID2(@04)                          2613 10416000
         MVC   OLDERID2(95,@04),@TS00001                           2613 10417000
*         NEWID2 = 'RSCL';                                         2614 10418000
         MVC   NEWID2(4,@04),@CC03721                              2614 10419000
*         IF GDTDBG = NULLPTR                                      2615 10420000
*           THEN;                                                  2615 10421000
         L     @04,GDTDBG(,REG5)                                   2615 10422000
         LTR   @04,@04                                             2615 10423000
         BZ    @RT02615                                            2615 10424000
*           ELSE                                                   2617 10425000
*             CALL IDCDB010(GDTTBL,'RSC3');                        2617 10426000
*                                                                  2617 10427000
         ST    REG5,@AL00001                                       2617 10428000
         LA    @04,@CC03722                                        2617 10429000
         ST    @04,@AL00001+4                                      2617 10430000
         MVI   @AL00001+4,X'80'                                    2617 10431000
         L     @15,GDTDBG(,REG5)                                   2617 10432000
         LA    @01,@AL00001                                        2617 10433000
         BALR  @14,@15                                             2617 10434000
*         /***********************************************************/ 10435000
*         /*                                                         */ 10436000
*         /*  CLOSE DATA SETS                                        */ 10437000
*         /*                                                         */ 10438000
*         /***********************************************************/ 10439000
*                                                                  2618 10440000
*                                                                  2618 10441000
*         /***********************************************************/ 10442000
*         /*                                                         */ 10443000
*         /*    CATALOG RECOVERY AREA. CLOSE VIA DSCLOSE.            */ 10444000
*         /*                                                         */ 10445000
*         /***********************************************************/ 10446000
*                                                                  2618 10447000
*         IF RSCROPN = ON                                          2618 10448000
*           THEN                                                   2618 10449000
*                                                                  2618 10450000
@RT02615 TM    RSCROPN(REG6),B'00100000'                           2618 10451000
         BNO   @RF02618                                            2618 10452000
*             /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSCLOSE        */ 10453000
*             CALL IDCRS6DC('R');                                  2619 10454000
*                                                                  2619 10455000
         L     @15,@CV03542                                        2619 10456000
         LA    @01,@AL02619                                        2619 10457000
         BALR  @14,@15                                             2619 10458000
*         /***********************************************************/ 10459000
*         /*                                                         */ 10460000
*         /*    CATALOG. CLOSE VIA DSCLOSE.                          */ 10461000
*         /*                                                         */ 10462000
*         /***********************************************************/ 10463000
*                                                                  2620 10464000
*         IF RSCAOPN = ON                                          2620 10465000
*           THEN                                                   2620 10466000
*                                                                  2620 10467000
@RF02618 TM    RSCAOPN(REG6),B'00010000'                           2620 10468000
         BNO   @RF02620                                            2620 10469000
*             /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSCLOSE        */ 10470000
*             CALL IDCRS6DC('C');                                  2621 10471000
*                                                                  2621 10472000
         L     @15,@CV03542                                        2621 10473000
         LA    @01,@AL02621                                        2621 10474000
         BALR  @14,@15                                             2621 10475000
*         /***********************************************************/ 10476000
*         /*                                                         */ 10477000
*         /*    WORKFILE. CLOSE VIA DSCLOSE.                         */ 10478000
*         /*                                                         */ 10479000
*         /***********************************************************/ 10480000
*                                                                  2622 10481000
*         IF RSWFOPN = ON                                          2622 10482000
*           THEN                                                   2622 10483000
*                                                                  2622 10484000
@RF02620 TM    RSWFOPN(REG6),B'01000000'                           2622 10485000
         BNO   @RF02622                                            2622 10486000
*             /* CALL TO MODULE IDCRS06 FOR PROCEDURE DSCLOSE        */ 10487000
*             CALL IDCRS6DC('W');                                  2623 10488000
*                                                                  2623 10489000
         L     @15,@CV03542                                        2623 10490000
         LA    @01,@AL02623                                        2623 10491000
         BALR  @14,@15                                             2623 10492000
*         /***********************************************************/ 10493000
*         /*                                                         */ 10494000
*         /*  VTOC. CLOSE VIA UCLOSE.                                */ 10495000
*         /*                                                         */ 10496000
*         /***********************************************************/ 10497000
*                                                                  2624 10498000
*         IF RSVTOPN = ON                                          2624 10499000
*           THEN                                                   2624 10500000
@RF02622 TM    RSVTOPN(REG6),B'00001000'                           2624 10501000
         BNO   @RF02624                                            2624 10502000
*             DO;                                                  2625 10503000
*               IOCSPTR = RSVTIOCS;                                2626 10504000
*                                                                  2626 10505000
         L     @04,RSVTIOCS(,REG6)                                 2626 10506000
         ST    @04,IOCSPTR(,REG6)                                  2626 10507000
*               CALL IDCIOCL0 (GDTTBL,IOCSPTR);                    2627 10508000
*                                                                  2627 10509000
         ST    REG5,@AL00001                                       2627 10510000
         LA    @04,IOCSPTR(,REG6)                                  2627 10511000
         ST    @04,@AL00001+4                                      2627 10512000
         MVI   @AL00001+4,X'80'                                    2627 10513000
         L     @15,GDTCLS(,REG5)                                   2627 10514000
         LA    @01,@AL00001                                        2627 10515000
         BALR  @14,@15                                             2627 10516000
*             END;                                                 2628 10517000
*                                                                  2628 10518000
*         /***********************************************************/ 10519000
*         /*                                                         */ 10520000
*         /*  RELEASE CATALOG VIA UDEQ                               */ 10521000
*         /*                                                         */ 10522000
*         /***********************************************************/ 10523000
*                                                                  2629 10524000
*         IF RSCARES = ON                                          2629 10525000
*           THEN                                                   2629 10526000
*                                                                  2629 10527000
@RF02624 TM    RSCARES(REG6),B'00000010'                           2629 10528000
         BNO   @RF02629                                            2629 10529000
*             CALL IDCSADQ0 (GDTTBL,RSCAMAJN,RSCAMINN);            2630 10530000
*                                                                  2630 10531000
         ST    REG5,@AL00001                                       2630 10532000
         L     @04,RSIOTBL(,REG6)                                  2630 10533000
         LA    @15,RSCAMAJN(,@04)                                  2630 10534000
         ST    @15,@AL00001+4                                      2630 10535000
         LA    @04,RSCAMINN(,@04)                                  2630 10536000
         ST    @04,@AL00001+8                                      2630 10537000
         MVI   @AL00001+8,X'80'                                    2630 10538000
         L     @15,GDTDEQ(,REG5)                                   2630 10539000
         LA    @01,@AL00001                                        2630 10540000
         BALR  @14,@15                                             2630 10541000
*         /***********************************************************/ 10542000
*         /*                                                         */ 10543000
*         /*  DELETE THE WORKFILE VIA WFDEL                          */ 10544000
*         /*                                                         */ 10545000
*         /***********************************************************/ 10546000
*                                                                  2631 10547000
*         IF RSWFDEF = ON                                          2631 10548000
*           THEN                                                   2631 10549000
*                                                                  2631 10550000
@RF02629 TM    RSWFDEF(REG6),B'10000000'                           2631 10551000
         BNO   @RF02631                                            2631 10552000
*             /* CALL TO MODULE IDCRS06 FOR PROCEDURE WFDEL          */ 10553000
*             CALL WFDEL;                                          2632 10554000
*                                                                  2632 10555000
         L     @15,@CV03723                                        2632 10556000
         BALR  @14,@15                                             2632 10557000
*         /***********************************************************/ 10558000
*         /*                                                         */ 10559000
*         /*  DEALLOCATE THE CRA VOLUMES.                            */ 10560000
*         /*                                                         */ 10561000
*         /***********************************************************/ 10562000
*                                                                  2633 10563000
*         IF RSALLC = ON                                           2633 10564000
*           THEN                                                   2633 10565000
@RF02631 TM    RSALLC(REG6),B'00001000'                            2633 10566000
         BNO   @RF02633                                            2633 10567000
*CLNDAL:      DO;                                                  2634 10568000
*                                                                  2634 10569000
CLNDAL   DS    0H                                                  2635 10570000
*         /***********************************************************/ 10571000
*         /*                                                         */ 10572000
*         /*    PROCESS EACH CRA ENTRY IN RESVOL                     */ 10573000
*         /*                                                         */ 10574000
*         /***********************************************************/ 10575000
*                                                                  2635 10576000
*               RSSRNSCN = OFF;                                    2635 10577000
         NI    RSSRNSCN(REG6),B'10111111'                          2635 10578000
*               RSSUBENP = ADDR(RSVOLENT);                         2636 10579000
*                                                                  2636 10580000
         L     @04,RSIOTBL(,REG6)                                  2636 10581000
         LA    @04,RSVOLENT(,@04)                                  2636 10582000
         ST    @04,RSSUBENP(,REG6)                                 2636 10583000
*CLNLP1:        DO UNTIL (RSSUBENP = 0);                           2637 10584000
*                                                                  2637 10585000
CLNLP1   DS    0H                                                  2637 10586000
@DL02637 DS    0H                                                  2638 10587000
*         /***********************************************************/ 10588000
*         /*                                                         */ 10589000
*         /*    GET CRA RESVOL ENTRY VIA SCNRLST                     */ 10590000
*         /*                                                         */ 10591000
*         /***********************************************************/ 10592000
*                                                                  2638 10593000
*               /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRLST      */ 10594000
*               CALL IDCRS5SR('N','B',RSSUBENP,NULLPTR);           2638 10595000
*                                                                  2638 10596000
         MVC   @AL00001(16),@AL02638                               2638 10597000
         LA    @04,RSSUBENP(,REG6)                                 2638 10598000
         ST    @04,@AL00001+8                                      2638 10599000
         L     @15,@CV03539                                        2638 10600000
         LA    @01,@AL00001                                        2638 10601000
         BALR  @14,@15                                             2638 10602000
*         /***********************************************************/ 10603000
*         /*                                                         */ 10604000
*         /*    CRA VOLUME WAS ALLOCATED.                            */ 10605000
*         /*                                                         */ 10606000
*         /***********************************************************/ 10607000
*                                                                  2639 10608000
*               IF RSSUBENP ^= 0 & RESVLMNT = ON                   2639 10609000
*                 THEN                                             2639 10610000
         L     @04,RSSUBENP(,REG6)                                 2639 10611000
         LTR   @04,@04                                             2639 10612000
         BZ    @RF02639                                            2639 10613000
         TM    RESVLMNT(@04),B'10000000'                           2639 10614000
         BNO   @RF02639                                            2639 10615000
*                   DO;                                            2640 10616000
*                                                                  2640 10617000
*         /***********************************************************/ 10618000
*         /*                                                         */ 10619000
*         /*    DEALLOCATE CRA VOLUME VIA CRADMNT                    */ 10620000
*         /*                                                         */ 10621000
*         /***********************************************************/ 10622000
*                                                                  2641 10623000
*                     RSCRADD = ADDR(RESVLDDN);                    2641 10624000
*                                                                  2641 10625000
         LA    @04,RESVLDDN(,@04)                                  2641 10626000
         ST    @04,RSCRADD(,REG6)                                  2641 10627000
*                     /* CALL TO MODULE IDCRS06 FOR PROCEDURE CRADMNT*/ 10628000
*                     CALL IDCRS6CD(RSCRADD);                      2642 10629000
*                                                                  2642 10630000
         LA    @04,RSCRADD(,REG6)                                  2642 10631000
         ST    @04,@AL00001                                        2642 10632000
         L     @15,@CV03728                                        2642 10633000
         LA    @01,@AL00001                                        2642 10634000
         BALR  @14,@15                                             2642 10635000
*                   END;                                           2643 10636000
*                                                                  2643 10637000
*               END CLNLP1;                                        2644 10638000
*                                                                  2644 10639000
@RF02639 DS    0H                                                  2644 10640000
@DE02637 L     @04,RSSUBENP(,REG6)                                 2644 10641000
         LTR   @04,@04                                             2644 10642000
         BNZ   @DL02637                                            2644 10643000
*             END CLNDAL;                                          2645 10644000
*                                                                  2645 10645000
*         /***********************************************************/ 10646000
*         /*                                                         */ 10647000
*         /*  FREE STORAGE VIA UFPOOL                                */ 10648000
*         /*                                                         */ 10649000
*         /***********************************************************/ 10650000
*                                                                  2646 10651000
*         CALL IDCSAFP0 (GDTTBL,POOL1,ALL);                        2646 10652000
*                                                                  2646 10653000
@RF02633 MVC   @AL00001+4(8),@AL02646                              2646 10654000
         ST    REG5,@AL00001                                       2646 10655000
         L     @15,GDTFPL(,REG5)                                   2646 10656000
         LA    @01,@AL00001                                        2646 10657000
         BALR  @14,@15                                             2646 10658000
*         /***********************************************************/ 10659000
*         /*                                                         */ 10660000
*         /*  PROCESSING COMPLETED. RETURN.                          */ 10661000
*         /*                                                         */ 10662000
*         /***********************************************************/ 10663000
*                                                                  2647 10664000
*                                                                  2647 10665000
* CALL EXIT;  /*TERMINATE*/                                        2647 10666000
         BAL   @14,EXIT                                            2647 10667000
* END CLEANUP; /*END OF PROCEDURE*/                                2648 10668000
*                                                                  2648 10669000
@EL00013 DS    0H                                                  2648 10670000
@EF00013 DS    0H                                                  2648 10671000
@ER00013 BR    @14                                                 2648 10672000
@PB00013 DS    0H                                                  2649 10673000
*      GENERATE;                                                   2649 10674000
         DS    0F                                                       10675000
         DC    CL8'EXIT'                                                10676000
*EXIT: PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                       2650 10677000
*                                                                  2650 10678000
         B     @PB00014                                            2650 10679000
EXIT     DS    0H                                                  2651 10680000
*        GEN(L     @13,4(,@13)); /*RESTORE CALLER'S REG SAVE*/     2651 10681000
         L     @13,4(,@13)                                              10682000
*        GEN(LM    @14,@12,12(@13));  /*RESTORE REGS*/             2652 10683000
         LM    @14,@12,12(@13)                                          10684000
*        GEN(MVI   12(@13),255);  /*MARK END OF SAVE LIST*/        2653 10685000
         MVI   12(@13),255                                              10686000
*        GEN(BR    14);  /*RETURN*/                                2654 10687000
         BR    14                                                       10688000
*END EXIT;  /*END OF PROC EXIT*/                                   2655 10689000
*                                                                  2655 10690000
@EL00014 DS    0H                                                  2655 10691000
@EF00014 DS    0H                                                  2655 10692000
@ER00014 BR    @14                                                 2655 10693000
*END IDCRS01   /*END OF MODULE*/                                   2656 10694000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 10695000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 10696000
*/*%INCLUDE SYSLIB  (IDCDF64 )                                        * 10697000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 10698000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 10699000
*/*%INCLUDE SYSLIB  (IDCCSRS )                                        * 10700000
*/*%INCLUDE SYSLIB  (AMSDF05 )                                        * 10701000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        * 10702000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        * 10703000
*/*%INCLUDE SYSLIB  (IEZCTGFV)                                        * 10704000
*/*%INCLUDE SYSLIB  (CVT     )                                        * 10705000
*/*%INCLUDE SYSLIB  (AMCBS   )                                        * 10706000
*/*%INCLUDE SYSLIB  (IGGCAXWA)                                        * 10707000
*/*%INCLUDE SYSLIB  (IFGACB  )                                        * 10708000
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        * 10709000
*;                                                                 2656 10710000
@EL00001 L     @13,4(,@13)                                         2656 10711000
@EF00001 L     @00,@SIZDATD                                        2656 10712000
         LR    @01,@08                                             2656 10713000
         FREEMAIN R,LV=(0),A=(1)                                        10714000
@ER00001 LM    @14,@12,12(@13)                                     2656 10715000
         BR    @14                                                 2656 10716000
@DATA    DS    0H                                                       10717000
@CH00160 DC    H'6'                                                     10718000
@CH00036 DC    H'7'                                                     10719000
@CH00037 DC    H'12'                                                    10720000
@CH00633 DC    H'13'                                                    10721000
@CH00229 DC    H'15'                                                    10722000
@CH00930 DC    H'17'                                                    10723000
@CH00309 DC    H'24'                                                    10724000
@CH00853 DC    H'35'                                                    10725000
@CH00970 DC    H'39'                                                    10726000
@CH00972 DC    H'40'                                                    10727000
@CH00983 DC    H'46'                                                    10728000
@CH00752 DC    H'47'                                                    10729000
@CH00986 DC    H'48'                                                    10730000
@CH01013 DC    H'62'                                                    10731000
@CH00750 DC    H'64'                                                    10732000
@CH01040 DC    H'76'                                                    10733000
@CH01044 DC    H'78'                                                    10734000
@CH01046 DC    H'79'                                                    10735000
@CH01048 DC    H'80'                                                    10736000
@CH01056 DC    H'84'                                                    10737000
@CH01083 DC    H'99'                                                    10738000
@CH00151 DC    H'100'                                                   10739000
@CH03739 DC    H'104'                                                   10740000
@CH03734 DC    H'532'                                                   10741000
@SM03785 MVC   RSCATDSN(0,REG6),CATNMVAL(@04)                           10742000
@SM03787 MVC   RSCATPS(0,REG6),CATNMPAS(@04)                            10743000
@SM03789 MVC   RSCATDDN(0,REG6),CATDNVAL(@04)                           10744000
@SM03791 MVC   RSMRPS(0,REG6),MRPWVAL(@04)                              10745000
@SM03793 MVC   RSWFDDNM(0,REG6),WFILEVAL(@04)                           10746000
@SM03795 MVC   RSWFPS(0,REG6),WFILEPAS(@04)                             10747000
@SM03797 MVC   RSWCATNM(0,REG6),WCATVAL(@04)                            10748000
@SM03799 MVC   RSWCATPS(0,REG6),WCATPAS(@04)                            10749000
@SM03804 MVC   RSCATDSN(0,REG6),INITDSN(@04)                            10750000
@SM03806 MVC   RSINVLSR(0,REG6),INITVLSR(@01)                           10751000
@SM03808 MVC   RSINTS(0,REG6),INITTS(@04)                               10752000
@SM03810 MVC   RESVLSER(0,@04),CRAVLVAL(@03)                            10753000
@SM03812 MVC   RESVLDDN(0,@15),CRADNVAL(@04)                            10754000
@SM03817 MVC   RESVLEXT(0,@04),FNDEXTS(@01)                             10755000
         DS    0F                                                       10756000
@AL01102 DC    A(@CC00833)             LIST WITH   2 ARGUMENT(S)        10757000
         DC    A(@CC00805)                                              10758000
@AL01191 DC    A(@CC03581)             LIST WITH   5 ARGUMENT(S)        10759000
         DC    A(@CC00831)                                              10760000
         DC    A(@CC03581)                                              10761000
         DC    A(@CC00823)                                              10762000
         DC    A(@CF00119)                                              10763000
@AL01357 DC    A(@CC03581)             LIST WITH   5 ARGUMENT(S)        10764000
         DC    A(@CC00831)                                              10765000
         DC    A(@CC00817)                                              10766000
         DC    A(@CC00805)                                              10767000
         DC    A(@CF00119)                                              10768000
@AL01373 DC    A(@CC03611)             LIST WITH   4 ARGUMENT(S)        10769000
         DC    A(@CC00813)                                              10770000
         DC    A(@CC00823)                                              10771000
         DC    A(@CF00119)                                              10772000
@AL01379 EQU   *                       LIST WITH   5 ARGUMENT(S)        10773000
@AL01963 EQU   *                       LIST WITH   5 ARGUMENT(S)        10774000
@AL02452 DC    A(@CC00815)             LIST WITH   5 ARGUMENT(S)        10775000
@AL01425 EQU   *                       LIST WITH   1 ARGUMENT(S)        10776000
@AL02413 EQU   *                       LIST WITH   1 ARGUMENT(S)        10777000
@AL02570 EQU   *                       LIST WITH   1 ARGUMENT(S)        10778000
@AL02619 DC    A(@CC00823)             LIST WITH   1 ARGUMENT(S)        10779000
         DC    A(@CC00817)                                              10780000
@AL00680 EQU   *                       LIST WITH   1 ARGUMENT(S)        10781000
@AL02126 EQU   *                       LIST WITH   1 ARGUMENT(S)        10782000
@AL02623 DC    A(@CC00831)             LIST WITH   1 ARGUMENT(S)        10783000
         DC    A(@CF00119)                                              10784000
@AL01931 EQU   *                       LIST WITH   4 ARGUMENT(S)        10785000
@AL02446 EQU   *                       LIST WITH   4 ARGUMENT(S)        10786000
@AL02638 DC    A(@CC03611)             LIST WITH   4 ARGUMENT(S)        10787000
         DC    A(@CC00815)                                              10788000
@AL02114 EQU   *                       LIST WITH   1 ARGUMENT(S)        10789000
@AL02621 DC    A(@CC00805)             LIST WITH   1 ARGUMENT(S)        10790000
         DC    A(@CF00119)                                              10791000
@AL02646 DC    A(@CC00900)             LIST WITH   2 ARGUMENT(S)        10792000
         DC    AL1(X'80')                                               10793000
         DC    AL3(ALL)                                                 10794000
@DATD    DSECT                                                          10795000
         DS    0F                                                       10796000
@SA00001 DS    18F                                                      10797000
@PC00001 DS    3F                                                       10798000
@AL00001 DS    6A                                                       10799000
@TF00001 DS    F                                                        10800000
IDCRS01  CSECT                                                          10801000
         DS    0F                                                       10802000
@CF00119 DC    F'0'                                                     10803000
@CF00219 DC    F'1'                                                     10804000
@CH00219 EQU   @CF00219+2                                               10805000
@CF00157 DC    F'2'                                                     10806000
@CH00157 EQU   @CF00157+2                                               10807000
@CF00166 DC    F'3'                                                     10808000
@CH00166 EQU   @CF00166+2                                               10809000
@CF00046 DC    F'4'                                                     10810000
@CH00046 EQU   @CF00046+2                                               10811000
@CF00287 DC    F'5'                                                     10812000
@CF00035 DC    F'8'                                                     10813000
@CH00035 EQU   @CF00035+2                                               10814000
@CF00040 DC    F'9'                                                     10815000
@CH00040 EQU   @CF00040+2                                               10816000
@CF00478 DC    F'16'                                                    10817000
@CH00478 EQU   @CF00478+2                                               10818000
@CF00968 DC    F'38'                                                    10819000
@CF03733 DC    F'111'                                                   10820000
@CF03588 DC    F'125'                                                   10821000
@CF03589 DC    F'126'                                                   10822000
@CF01850 DC    F'127'                                                   10823000
@CH01850 EQU   @CF01850+2                                               10824000
@CF03738 DC    F'168'                                                   10825000
@CF00745 DC    F'512'                                                   10826000
@CF03736 DC    F'1490'                                                  10827000
@CF03741 DC    F'2040'                                                  10828000
@CF03735 DC    F'5320'                                                  10829000
@CF03802 DC    F'-532'                                                  10830000
@CF03776 DC    F'-8'                                                    10831000
@CF03777 DC    F'-4'                                                    10832000
@CF00734 DC    XL4'E4E5F004'                                            10833000
@CF00736 DC    XL4'E4E5F003'                                            10834000
@CF00738 DC    XL4'E4E5F00F'                                            10835000
@DATD    DSECT                                                          10836000
         DS    0D                                                       10837000
@TS00001 DS    CL95                                                     10838000
         DS    CL1                                                      10839000
RSREGSAV DS    CL1800                                                   10840000
         ORG   RSREGSAV                                                 10841000
RSREGS   DS    25CL72                                                   10842000
         ORG   RSREGSAV+1800                                            10843000
RS2      DS    CL100                                                    10844000
RS3      DS    CL32                                                     10845000
RS5      DS    CL16                                                     10846000
RSLAST   DS    CL2160                                                   10847000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                10848000
@ENDDATD EQU   *                                                        10849000
IDCRS01  CSECT                                                          10850000
         DS    0F                                                       10851000
@SIZDATD DC    AL1(0)                                                   10852000
         DC    AL3(@ENDDATD-@DATD)                                      10853000
@CV03434 DC    V(IDCRS02)                                               10854000
@CV03435 DC    V(IDCRS03)                                               10855000
@CV03436 DC    V(IDCRS04)                                               10856000
@CV03437 DC    V(IDCRS05)                                               10857000
@CV03438 DC    V(IDCRS06)                                               10858000
@CV03439 DC    V(IDCRS07)                                               10859000
@CV03481 DC    V(ENSURECI)                                              10860000
@CV03483 DC    V(ASSOC)                                                 10861000
@CV03498 DC    V(RECMGMT)                                               10862000
@CV03499 DC    V(CATRCDSU)                                              10863000
@CV03538 DC    V(IDCRS5BV)                                              10864000
@CV03539 DC    V(IDCRS5SR)                                              10865000
@CV03542 DC    V(IDCRS6DC)                                              10866000
@CV03544 DC    V(CKERR)                                                 10867000
@CV03580 DC    V(IDCRS6DO)                                              10868000
@CV03590 DC    V(WFDEF)                                                 10869000
@CV03595 DC    V(IDCRS6CM)                                              10870000
@CV03596 DC    V(IDCRS5BR)                                              10871000
@CV03619 DC    V(VOLCHK)                                                10872000
@CV03633 DC    V(IDCRS5SV)                                              10873000
@CV03636 DC    V(ADDUPCR)                                               10874000
@CV03645 DC    V(FIND)                                                  10875000
@CV03677 DC    V(IDCRS5EN)                                              10876000
@CV03679 DC    V(DELTN)                                                 10877000
@CV03680 DC    V(ADDTN)                                                 10878000
@CV03681 DC    V(CRAUPCHN)                                              10879000
@CV03684 DC    V(RENAMEP)                                               10880000
@CV03685 DC    V(UPDCCR)                                                10881000
@CV03686 DC    V(FRCRCCR)                                               10882000
@CV03700 DC    V(RENAMEF)                                               10883000
@CV03723 DC    V(WFDEL)                                                 10884000
@CV03728 DC    V(IDCRS6CD)                                              10885000
         DS    0D                                                       10886000
MAXCINO  DC    XL4'3FFFFF'                                              10887000
@CC00777 DC    C'IDCUT1  '                                              10888000
@CC00779 DC    C'SYSALLDA'                                              10889000
@CC00781 DC    C'SYSIGGV2'                                              10890000
@CC01088 DC    C'ENTNAME '                                              10891000
@CC01092 DC    C'VOLTSTMP'                                              10892000
@CC01094 DC    C'CATACB  '                                              10893000
@CC01096 DC    C'ATTR1   '                                              10894000
@CC03584 DC    C'RETURN'                                                10895000
@CC00900 DC    C'RS01'                                                  10896000
@CC00902 DC    C'RS02'                                                  10897000
@CC00904 DC    C'RS03'                                                  10898000
@CC03474 DC    C'RSWA'                                                  10899000
@CC03487 DC    C'RS00'                                                  10900000
@CC03496 DC    C'RSCI'                                                  10901000
@CC03515 DC    C'RSC1'                                                  10902000
@CC03521 DC    C'RSCO'                                                  10903000
@CC03543 DC    C'TERM'                                                  10904000
@CC03547 DC    C'RSC2'                                                  10905000
@CC03569 DC    C'RSIN'                                                  10906000
@CC03585 EQU   @CC03584                                                 10907000
@CC03587 DC    C'CIXL'                                                  10908000
@CC03603 DC    C'RSI1'                                                  10909000
@CC03608 DC    C'RSME'                                                  10910000
@CC03620 DC    C'RSM1'                                                  10911000
@CC03628 DC    C'RSPR'                                                  10912000
@CC03646 DC    C'RSP1'                                                  10913000
@CC03650 DC    C'RSRE'                                                  10914000
@CC03657 DC    C'RSR1'                                                  10915000
@CC03663 DC    C'RSUP'                                                  10916000
@CC03687 DC    C'RSU1'                                                  10917000
@CC03693 DC    C'RSUC'                                                  10918000
@CC03711 DC    C'RSU2'                                                  10919000
@CC03715 DC    C'RSWR'                                                  10920000
@CC03721 DC    C'RSCL'                                                  10921000
@CC03722 DC    C'RSC3'                                                  10922000
@CC00805 EQU   @CC01094                                                 10923000
@CC00813 EQU   @CC01096                                                 10924000
@CC00815 DC    C'B'                                                     10925000
@CC00817 DC    C'U'                                                     10926000
@CC00823 EQU   @CC03584                                                 10927000
@CC00831 DC    C'W'                                                     10928000
@CC00833 EQU   @CC01092                                                 10929000
@CC03581 DC    C'O'                                                     10930000
@CC03611 DC    C'N'                                                     10931000
ALL      DC    CL3'ALL'                                                 10932000
FORMAT   DC    CL4'FORM'                                                10933000
HSECOND  DC    CL4'HSEC'                                                10934000
CLOCK    DC    CL4'KLOK'                                                10935000
SETZERO  DC    CL4'ZERO'                                                10936000
SETBLANK DC    CL4'BLNK'                                                10937000
NOSET    DC    CL4'NSET'                                                10938000
OVERRIDE DC    CL4'OVRD'                                                10939000
ACQUIRE  DC    CL8'ACQUIRE '                                            10940000
RELINQ   DC    CL8'RELINQ  '                                            10941000
MOUNT    DC    CL8'MOUNT   '                                            10942000
DEMOUNT  DC    CL8'DEMOUNT '                                            10943000
DEFINE   DC    CL8'DEFINE  '                                            10944000
MOVE     DC    CL8'MOVE    '                                            10945000
TRACEQ   DC    CL8'TRACEQ  '                                            10946000
COPYTABL DC    CL8'COPYTABL'                                            10947000
COPYCRTG DC    CL8'COPYCRTG'                                            10948000
COPYVOL  DC    CL8'COPYVOL '                                            10949000
VVIC     DC    CL8'VVIC    '                                            10950000
TUNE     DC    CL8'TUNE    '                                            10951000
NAMES    DC    CL4'NAME'                                                10952000
UNIT     DC    CL4'UNIT'                                                10953000
SHR      DC    CL4'SHR '                                                10954000
EXCL     DC    CL4'EXCL'                                                10955000
NOWAIT   DC    CL4'NWAI'                                                10956000
WAIT     DC    CL4'WAIT'                                                10957000
TNTYPES  DC    CL11'CDIAXBVUMGR'                                        10958000
MAXEXPDT DC    X'99999F'                                                10959000
DUMMYNM  DC    X'FFFFFFFFFFFFFFFF'                                      10960000
RDFCIDF  DC    X'0001F901F90000'                                        10961000
PACKF    DC    X'0F'                                                    10962000
DSCB1ID  DC    X'F1'                                                    10963000
VOLUNUSE DC    X'0000'                                                  10964000
NULLDIG  DC    X'00'                                                    10965000
BADVOLSW DC    X'00'                                                    10966000
FMT3NULL DC    X'0000000000'                                            10967000
DS4DSNM  DS    CL44                                                     10968000
         ORG   DS4DSNM                                                  10969000
@NM00040 DC    44X'04'                                                  10970000
         ORG   DS4DSNM+44                                               10971000
MODID    DC    CL4'RS01'                                                10972000
         DS    CL2                                                      10973000
PATCH    DS    CL800                                                    10974000
         ORG   PATCH                                                    10975000
@NM00216 DC    CL32'PATCH 800 BYTES LAST USED 000000'                   10976000
@NM00217 DC    768X'00'                                                 10977000
         ORG   PATCH+800                                                10978000
TRTBLE   DC    CL1'0'                                                   10979000
         DC    CL1'1'                                                   10980000
         DC    CL1'2'                                                   10981000
         DC    CL1'3'                                                   10982000
         DC    CL1'4'                                                   10983000
         DC    CL1'5'                                                   10984000
         DC    CL1'6'                                                   10985000
         DC    CL1'7'                                                   10986000
         DC    CL1'8'                                                   10987000
         DC    CL1'9'                                                   10988000
         DC    CL1'A'                                                   10989000
         DC    CL1'B'                                                   10990000
         DC    CL1'C'                                                   10991000
         DC    CL1'D'                                                   10992000
         DC    CL1'E'                                                   10993000
         DC    CL1'F'                                                   10994000
DEFNMTAB DC    CL8'DSETCRDT'                                            10995000
         DC    CL8'DSETEXDT'                                            10996000
         DC    CL8'PASSWALL'                                            10997000
         DC    CL8'AMDSBCAT'                                            10998000
         DC    CL8'DSATTR'                                              10999000
         DC    CL8'LRECL'                                               11000000
         DC    CL8'SPACPARM'                                            11001000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       11002000
@01      EQU   01                                                       11003000
@02      EQU   02                                                       11004000
@03      EQU   03                                                       11005000
@04      EQU   04                                                       11006000
@05      EQU   05                                                       11007000
@06      EQU   06                                                       11008000
@07      EQU   07                                                       11009000
@08      EQU   08                                                       11010000
@09      EQU   09                                                       11011000
@10      EQU   10                                                       11012000
@11      EQU   11                                                       11013000
@12      EQU   12                                                       11014000
@13      EQU   13                                                       11015000
@14      EQU   14                                                       11016000
@15      EQU   15                                                       11017000
RTNREG   EQU   @15                                                      11018000
REG2     EQU   @02                                                      11019000
REG3     EQU   @03                                                      11020000
REG4     EQU   @04                                                      11021000
REG5     EQU   @05                                                      11022000
REG6     EQU   @06                                                      11023000
REG8     EQU   @08                                                      11024000
REG13    EQU   @13                                                      11025000
REG15    EQU   @15                                                      11026000
REG0     EQU   @00                                                      11027000
REG1     EQU   @01                                                      11028000
REG10    EQU   @10                                                      11029000
REG11    EQU   @11                                                      11030000
REG12    EQU   @12                                                      11031000
REG14    EQU   @14                                                      11032000
REG7     EQU   @07                                                      11033000
REG9     EQU   @09                                                      11034000
CVTPTR   EQU   16                                                       11035000
GDTTBL   EQU   0                                                        11036000
GDTTR1   EQU   GDTTBL+8                                                 11037000
GDTTR2   EQU   GDTTBL+12                                                11038000
GDTIOH   EQU   GDTTBL+36                                                11039000
GDTDBG   EQU   GDTTBL+40                                                11040000
GDTSTC   EQU   GDTTBL+44                                                11041000
GDTPRT   EQU   GDTTBL+48                                                11042000
GDTESS   EQU   GDTTBL+52                                                11043000
GDTESA   EQU   GDTTBL+56                                                11044000
GDTRST   EQU   GDTTBL+60                                                11045000
GDTRES   EQU   GDTTBL+64                                                11046000
GDTCAL   EQU   GDTTBL+68                                                11047000
GDTGSP   EQU   GDTTBL+72                                                11048000
GDTFSP   EQU   GDTTBL+76                                                11049000
GDTGPL   EQU   GDTTBL+80                                                11050000
GDTFPL   EQU   GDTTBL+84                                                11051000
GDTLOD   EQU   GDTTBL+88                                                11052000
GDTDEL   EQU   GDTTBL+92                                                11053000
GDTPRL   EQU   GDTTBL+96                                                11054000
GDTEPL   EQU   GDTTBL+100                                               11055000
GDTTIM   EQU   GDTTBL+104                                               11056000
GDTIIO   EQU   GDTTBL+108                                               11057000
GDTTIO   EQU   GDTTBL+112                                               11058000
GDTOPN   EQU   GDTTBL+124                                               11059000
GDTCLS   EQU   GDTTBL+128                                               11060000
GDTGET   EQU   GDTTBL+132                                               11061000
GDTPUT   EQU   GDTTBL+136                                               11062000
GDTPOS   EQU   GDTTBL+140                                               11063000
GDTCPY   EQU   GDTTBL+144                                               11064000
GDTCAT   EQU   GDTTBL+148                                               11065000
GDTSNP   EQU   GDTTBL+164                                               11066000
GDTVFY   EQU   GDTTBL+172                                               11067000
GDTECT   EQU   GDTTBL+188                                               11068000
GDTUID   EQU   GDTTBL+192                                               11069000
GDTPMT   EQU   GDTTBL+196                                               11070000
GDTCIR   EQU   GDTTBL+200                                               11071000
GDTLNK   EQU   GDTTBL+204                                               11072000
GDTALC   EQU   GDTTBL+208                                               11073000
GDTDLC   EQU   GDTTBL+212                                               11074000
GDTQAL   EQU   GDTTBL+216                                               11075000
GDTSTW   EQU   GDTTBL+220                                               11076000
GDTSSC   EQU   GDTTBL+224                                               11077000
GDTENQ   EQU   GDTTBL+228                                               11078000
GDTRSV   EQU   GDTTBL+232                                               11079000
GDTDEQ   EQU   GDTTBL+236                                               11080000
GDTSFO   EQU   GDTTBL+240                                               11081000
GDTWTO   EQU   GDTTBL+244                                               11082000
GDTSCR   EQU   GDTTBL+248                                               11083000
GDTUNT   EQU   GDTTBL+252                                               11084000
GDTRCT   EQU   GDTTBL+256                                               11085000
GDTIFO   EQU   GDTTBL+260                                               11086000
GDTEXP   EQU   GDTTBL+264                                               11087000
GDTSTA   EQU   GDTTBL+268                                               11088000
GDTERR   EQU   GDTTBL+272                                               11089000
GDTUNC   EQU   GDTTBL+276                                               11090000
GDTLOC   EQU   GDTTBL+280                                               11091000
IDCSAEP0 EQU   0                                                        11092000
IDCSAGP0 EQU   0                                                        11093000
IDCSAFP0 EQU   0                                                        11094000
IDCSACA0 EQU   0                                                        11095000
IDCSARV0 EQU   0                                                        11096000
IDCSADQ0 EQU   0                                                        11097000
IDCSASI0 EQU   0                                                        11098000
TRACE1   EQU   0                                                        11099000
OLDERID1 EQU   TRACE1                                                   11100000
TRACE2   EQU   0                                                        11101000
OLDERID2 EQU   TRACE2                                                   11102000
NEWID2   EQU   TRACE2+95                                                11103000
NEWERID2 EQU   5                                                        11104000
CIRAGL   EQU   0                                                        11105000
CIRTYPE  EQU   CIRAGL                                                   11106000
ALLAGL   EQU   0                                                        11107000
ALLSTS   EQU   ALLAGL+24                                                11108000
ALLDSP   EQU   ALLAGL+25                                                11109000
ALLORG   EQU   ALLAGL+26                                                11110000
ALLOPT   EQU   ALLAGL+28                                                11111000
UNITABL  EQU   0                                                        11112000
UNITUCB  EQU   UNITABL                                                  11113000
UNITADR  EQU   UNITABL+4                                                11114000
@NM00010 EQU   UNITADR                                                  11115000
UNITSTAT EQU   UNITABL+6                                                11116000
IDCIOCL0 EQU   0                                                        11117000
IDCIOSI0 EQU   0                                                        11118000
IOCSTR   EQU   0                                                        11119000
IOCDSO   EQU   IOCSTR+16                                                11120000
IOCRFM   EQU   IOCSTR+17                                                11121000
IOCMAC   EQU   IOCSTR+18                                                11122000
IOCMAC2  EQU   IOCSTR+19                                                11123000
IOCCHP   EQU   IOCSTR+20                                                11124000
IOCMSG   EQU   IOCSTR+21                                                11125000
IOCRBA   EQU   IOCSTR+40                                                11126000
IOCTTR   EQU   IOCRBA                                                   11127000
IOCMEM   EQU   IOCSTR+44                                                11128000
IOCNWM   EQU   IOCSTR+48                                                11129000
IOCREL   EQU   IOCSTR+60                                                11130000
IOCEXT   EQU   IOCSTR+64                                                11131000
OPNAGL   EQU   0                                                        11132000
OPNOPT   EQU   OPNAGL                                                   11133000
OPNRFM   EQU   OPNAGL+1                                                 11134000
OPNTYP   EQU   OPNAGL+2                                                 11135000
OPNMOD   EQU   OPNAGL+3                                                 11136000
OPNDEV   EQU   OPNAGL+24                                                11137000
OPNDSO   EQU   OPNAGL+41                                                11138000
OPNOPT2  EQU   OPNAGL+42                                                11139000
IOINFOPT EQU   0                                                        11140000
IOINFVOL EQU   IOINFOPT                                                 11141000
IOINFDSN EQU   IOINFOPT                                                 11142000
UVOLLIST EQU   0                                                        11143000
UVOLENT  EQU   UVOLLIST+2                                               11144000
AMSTP011 EQU   0                                                        11145000
DARGLIST EQU   0                                                        11146000
DARGDBP  EQU   DARGLIST                                                 11147000
DARGSTID EQU   DARGLIST+8                                               11148000
DARGILP  EQU   DARGLIST+12                                              11149000
DARGARY  EQU   DARGLIST+20                                              11150000
DARGINS  EQU   DARGARY                                                  11151000
DARGINL  EQU   DARGARY+2                                                11152000
FMTLIST  EQU   0                                                        11153000
FMTFLGS  EQU   FMTLIST                                                  11154000
FMTSPF   EQU   FMTLIST+2                                                11155000
FMTRFNO  EQU   FMTSPF                                                   11156000
FMTILEN  EQU   FMTRFNO                                                  11157000
FMTIOFF  EQU   FMTLIST+4                                                11158000
FMTTRBC  EQU   FMTIOFF                                                  11159000
FMTSTO   EQU   FMTTRBC                                                  11160000
FMTOCOL  EQU   FMTLIST+6                                                11161000
FMTCNVF  EQU   FMTLIST+10                                               11162000
ERCNVTAB EQU   0                                                        11163000
ERTYPE   EQU   ERCNVTAB                                                 11164000
EROPER   EQU   ERCNVTAB+1                                               11165000
EROSOPER EQU   ERCNVTAB+2                                               11166000
ERCATRC  EQU   ERCNVTAB+16                                              11167000
ERCPLPT  EQU   ERCNVTAB+20                                              11168000
IDCDB010 EQU   0                                                        11169000
DMPITM   EQU   0                                                        11170000
DMPARY   EQU   0                                                        11171000
CATNM    EQU   0                                                        11172000
CATNMPLN EQU   CATNM                                                    11173000
CATNMPAS EQU   CATNM+1                                                  11174000
CATNMFLG EQU   CATNM+10                                                 11175000
CATNMLEN EQU   CATNM+20                                                 11176000
CATNMVAL EQU   CATNM+21                                                 11177000
CATDN    EQU   0                                                        11178000
CATDNLEN EQU   CATDN                                                    11179000
CATDNVAL EQU   CATDN+1                                                  11180000
MRPW     EQU   0                                                        11181000
MRPWLEN  EQU   MRPW                                                     11182000
MRPWVAL  EQU   MRPW+1                                                   11183000
WFDN     EQU   0                                                        11184000
WCAT     EQU   0                                                        11185000
WCATPLN  EQU   WCAT                                                     11186000
WCATPAS  EQU   WCAT+1                                                   11187000
WCATFLG  EQU   WCAT+10                                                  11188000
WCATLEN  EQU   WCAT+20                                                  11189000
WCATVAL  EQU   WCAT+21                                                  11190000
IGN      EQU   0                                                        11191000
CFILECNT EQU   0                                                        11192000
CRADNPTR EQU   0                                                        11193000
CRADN    EQU   0                                                        11194000
CRADNLEN EQU   CRADN                                                    11195000
CRADNVAL EQU   CRADN+1                                                  11196000
NONEPTR  EQU   0                                                        11197000
CVOLCNT  EQU   0                                                        11198000
CRAVLPTR EQU   0                                                        11199000
CRAVL    EQU   0                                                        11200000
CRAVLLEN EQU   CRAVL                                                    11201000
CRAVLVAL EQU   CRAVL+1                                                  11202000
CRADVPTR EQU   0                                                        11203000
CRADV    EQU   0                                                        11204000
WFILE    EQU   0                                                        11205000
WFILEPLN EQU   WFILE                                                    11206000
WFILEPAS EQU   WFILE+1                                                  11207000
WFILELEN EQU   WFILE+9                                                  11208000
WFILEVAL EQU   WFILE+10                                                 11209000
IODATA   EQU   0                                                        11210000
IODSID   EQU   IODATA+16                                                11211000
IOCSEX   EQU   0                                                        11212000
IOCRPL   EQU   IOCSEX+4                                                 11213000
IOCXAD   EQU   IOCSEX+16                                                11214000
IOCXPM   EQU   IOCSEX+20                                                11215000
IOCFLG   EQU   IOCSEX+32                                                11216000
IOCDEV   EQU   IOCSEX+33                                                11217000
IOCINF   EQU   IOCSEX+34                                                11218000
IOCMOD   EQU   IOCSEX+35                                                11219000
IOCDLM   EQU   IOCSEX+36                                                11220000
IOCRCV   EQU   IOCSEX+44                                                11221000
CATIEXT  EQU   0                                                        11222000
CATILRBA EQU   CATIEXT+12                                               11223000
CATIHRBA EQU   CATIEXT+16                                               11224000
VOLSERTB EQU   0                                                        11225000
VOLSRCI  EQU   VOLSERTB+4                                               11226000
VOLSRFLG EQU   VOLSERTB+8                                               11227000
VOLSRNTK EQU   VOLSERTB+12                                              11228000
VOLSRSER EQU   VOLSERTB+14                                              11229000
VOLSRTS  EQU   VOLSERTB+20                                              11230000
RESVOL   EQU   0                                                        11231000
RESVLUPD EQU   RESVOL+4                                                 11232000
RESVLFLG EQU   RESVOL+8                                                 11233000
RESVLMNT EQU   RESVLFLG                                                 11234000
RESVLALE EQU   RESVLFLG                                                 11235000
RESVLLAS EQU   RESVLFLG                                                 11236000
RESVLBAD EQU   RESVLFLG                                                 11237000
RESVLNEX EQU   RESVOL+10                                                11238000
RESVLSER EQU   RESVOL+14                                                11239000
RESVLDDN EQU   RESVOL+20                                                11240000
RESVLEXT EQU   RESVOL+28                                                11241000
RSF1RNTB EQU   0                                                        11242000
RSWORK   EQU   0                                                        11243000
RSA      EQU   RSWORK                                                   11244000
RSAVAIL  EQU   RSWORK+8                                                 11245000
RSCABHP1 EQU   RSWORK+12                                                11246000
RSCABLP1 EQU   RSWORK+16                                                11247000
RSCADD   EQU   RSWORK+20                                                11248000
RSCADS   EQU   RSWORK+24                                                11249000
RSCAFUCI EQU   RSWORK+28                                                11250000
RSCAHACI EQU   RSWORK+32                                                11251000
RSCAHALC EQU   RSWORK+36                                                11252000
RSCANFCI EQU   RSWORK+44                                                11253000
RSCPE1   EQU   RSWORK+68                                                11254000
RSCPE2   EQU   RSWORK+72                                                11255000
RSCPE3   EQU   RSWORK+76                                                11256000
RSCPE5   EQU   RSWORK+84                                                11257000
RSCPE6   EQU   RSWORK+88                                                11258000
RSCPE7   EQU   RSWORK+92                                                11259000
RSCRVL   EQU   RSWORK+104                                               11260000
RSGCITS  EQU   RSWORK+108                                               11261000
RSGCITC  EQU   RSGCITS+8                                                11262000
@NM00045 EQU   RSGCITS+20                                               11263000
RSGDITS  EQU   RSWORK+136                                               11264000
RSGDITC  EQU   RSGDITS+8                                                11265000
@NM00048 EQU   RSGDITS+20                                               11266000
RSPSTACK EQU   RSWORK+164                                               11267000
RSPTWKC  EQU   RSPSTACK+8                                               11268000
RSTAB    EQU   RSWORK+192                                               11269000
RSTANCHR EQU   RSTAB                                                    11270000
@NM00053 EQU   RSTAB+8                                                  11271000
@NM00055 EQU   RSTAB+12                                                 11272000
RSXXREGS EQU   RSWORK+212                                               11273000
RS01REGS EQU   RSXXREGS                                                 11274000
RS01RG08 EQU   RS01REGS                                                 11275000
RS01RG09 EQU   RS01REGS+4                                               11276000
RS02REGS EQU   RSXXREGS+20                                              11277000
RS02RG08 EQU   RS02REGS                                                 11278000
RS03REGS EQU   RSXXREGS+40                                              11279000
RS03RG08 EQU   RS03REGS                                                 11280000
RS04REGS EQU   RSXXREGS+60                                              11281000
RS04RG08 EQU   RS04REGS                                                 11282000
RS05REGS EQU   RSXXREGS+80                                              11283000
RS05RG08 EQU   RS05REGS                                                 11284000
RS06REGS EQU   RSXXREGS+100                                             11285000
RS06RG08 EQU   RS06REGS                                                 11286000
RS07REGS EQU   RSXXREGS+120                                             11287000
RS07RG08 EQU   RS07REGS                                                 11288000
RSAVAILN EQU   RSWORK+352                                               11289000
RSAVNEXT EQU   RSWORK+356                                               11290000
RSCMRR   EQU   RSWORK+364                                               11291000
RSCANFCN EQU   RSWORK+368                                               11292000
RSCRBP1  EQU   RSWORK+372                                               11293000
RSCREND  EQU   RSWORK+376                                               11294000
RSCURCI  EQU   RSWORK+380                                               11295000
RSCURRN  EQU   RSWORK+384                                               11296000
RSFDT    EQU   RSWORK+388                                               11297000
RSFPL    EQU   RSWORK+392                                               11298000
RSIOTBL  EQU   RSWORK+412                                               11299000
RSRABWA  EQU   RSWORK+416                                               11300000
RSWFPRIM EQU   RSWORK+420                                               11301000
RSWFSCND EQU   RSWORK+424                                               11302000
RSGRABCU EQU   RSWORK+428                                               11303000
RSRMBP   EQU   RSWORK+432                                               11304000
RSWFBP1  EQU   RSWORK+436                                               11305000
RSWFBP2  EQU   RSWORK+440                                               11306000
RSWFNEXT EQU   RSWORK+444                                               11307000
RSWFHURR EQU   RSWORK+448                                               11308000
RSVOLALL EQU   RSWORK+452                                               11309000
RSVOLLST EQU   RSWORK+460                                               11310000
RSREASSN EQU   RSWORK+468                                               11311000
RSREASS  EQU   RSWORK+472                                               11312000
RSTNCHN  EQU   RSWORK+476                                               11313000
RSENTPT  EQU   RSWORK+484                                               11314000
RSXCIEND EQU   RSWORK+496                                               11315000
RSXRREND EQU   RSWORK+500                                               11316000
RSGDT    EQU   RSWORK+504                                               11317000
RSMRPAS  EQU   RSWORK+508                                               11318000
RSWCDS   EQU   RSWORK+512                                               11319000
RSWCPAS  EQU   RSWORK+516                                               11320000
RSWFDD   EQU   RSWORK+520                                               11321000
RSWFPAS  EQU   RSWORK+524                                               11322000
RSWFDS   EQU   RSWORK+528                                               11323000
RSVTBENT EQU   RSWORK+532                                               11324000
RSVTIOCS EQU   RSWORK+536                                               11325000
RSRENEXT EQU   RSWORK+552                                               11326000
RSDUPNXT EQU   RSWORK+556                                               11327000
RSTNNXT  EQU   RSWORK+560                                               11328000
RSUCNXT  EQU   RSWORK+564                                               11329000
CAXWAPTR EQU   RSWORK+568                                               11330000
CBSPTR   EQU   RSWORK+572                                               11331000
CTGPLPTR EQU   RSWORK+576                                               11332000
CTGFLPTR EQU   RSWORK+580                                               11333000
RSCAPAS  EQU   RSWORK+588                                               11334000
RSCATACB EQU   RSWORK+592                                               11335000
RSCATUCB EQU   RSWORK+596                                               11336000
RSCIXLTA EQU   RSWORK+600                                               11337000
RSCRADD  EQU   RSWORK+608                                               11338000
RSUIRPT  EQU   RSWORK+612                                               11339000
RSUGLEN  EQU   RSWORK+616                                               11340000
RSSUBENP EQU   RSWORK+632                                               11341000
RSCATSCN EQU   RSWORK+644                                               11342000
RSCIREMC EQU   RSWORK+648                                               11343000
RSF1RNAM EQU   RSWORK+652                                               11344000
RSF1RNCU EQU   RSWORK+656                                               11345000
RSCHCRAN EQU   RSWORK+660                                               11346000
RSORVLLS EQU   RSWORK+668                                               11347000
RSIDX    EQU   RSWORK+686                                               11348000
RSIDX1   EQU   RSWORK+688                                               11349000
RSNOBLKT EQU   RSWORK+694                                               11350000
RSUCCINO EQU   RSWORK+697                                               11351000
RSUIOPT  EQU   RSWORK+700                                               11352000
RSCATDDN EQU   RSWORK+701                                               11353000
RSCATDSN EQU   RSWORK+709                                               11354000
RSCATPS  EQU   RSWORK+753                                               11355000
RSCATTN  EQU   RSWORK+761                                               11356000
RSCATNCI EQU   RSWORK+805                                               11357000
RSMRPS   EQU   RSWORK+814                                               11358000
RSWFDDNM EQU   RSWORK+822                                               11359000
RSWCATNM EQU   RSWORK+905                                               11360000
RSWCATPS EQU   RSWORK+949                                               11361000
RSWFPS   EQU   RSWORK+957                                               11362000
RSNEWCAT EQU   RSWORK+965                                               11363000
RSNCVLSR EQU   RSNEWCAT                                                 11364000
RSNCDEVT EQU   RSNEWCAT+6                                               11365000
RSNCTS   EQU   RSNEWCAT+10                                              11366000
RSFLAGSN EQU   RSWORK+979                                               11367000
RSFLAGN1 EQU   RSFLAGSN                                                 11368000
RSWFDEF  EQU   RSFLAGN1                                                 11369000
RSWFOPN  EQU   RSFLAGN1                                                 11370000
RSCROPN  EQU   RSFLAGN1                                                 11371000
RSCAOPN  EQU   RSFLAGN1                                                 11372000
RSVTOPN  EQU   RSFLAGN1                                                 11373000
RSREASND EQU   RSFLAGN1                                                 11374000
RSCARES  EQU   RSFLAGN1                                                 11375000
RSIGNR   EQU   RSFLAGN1                                                 11376000
RSFLAGN2 EQU   RSFLAGSN+1                                               11377000
RSENUFCI EQU   RSFLAGN2                                                 11378000
RSCAEOV  EQU   RSFLAGN2                                                 11379000
RSWFCREA EQU   RSFLAGN2                                                 11380000
RSCRAUA  EQU   RSFLAGN2                                                 11381000
RSALLC   EQU   RSFLAGN2                                                 11382000
RSTERM   EQU   RSFLAGN2                                                 11383000
RSCREOV  EQU   RSFLAGN2                                                 11384000
RSFLAGSI EQU   RSWORK+981                                               11385000
RSFLAGI1 EQU   RSFLAGSI                                                 11386000
RSREARR  EQU   RSFLAGI1                                                 11387000
RSRENRR  EQU   RSFLAGI1                                                 11388000
RSDUPNRR EQU   RSFLAGI1                                                 11389000
RSFLAGI2 EQU   RSFLAGSI+1                                               11390000
RSMETRM  EQU   RSFLAGI2                                                 11391000
RSMEOP   EQU   RSFLAGI2                                                 11392000
RSMEBYV  EQU   RSFLAGI2                                                 11393000
RSUCCATN EQU   RSFLAGI2                                                 11394000
RSUCWFTN EQU   RSFLAGI2                                                 11395000
RSUCTWWF EQU   RSFLAGI2                                                 11396000
RSUCCCR  EQU   RSFLAGI2                                                 11397000
RSSRNSCN EQU   RSFLAGI2+1                                               11398000
RSUCATN  EQU   RSFLAGI2+1                                               11399000
RSUCDTN  EQU   RSFLAGI2+1                                               11400000
RSBADVOL EQU   RSFLAGI2+1                                               11401000
RSRECREQ EQU   RSWORK+984                                               11402000
RSRTYPE  EQU   RSRECREQ                                                 11403000
RSRGET   EQU   RSRTYPE                                                  11404000
RSRADD   EQU   RSRTYPE                                                  11405000
RSRUPDT  EQU   RSRTYPE                                                  11406000
RSRPOS   EQU   RSRTYPE                                                  11407000
RSRTERM  EQU   RSRTYPE                                                  11408000
RSRFREE  EQU   RSRTYPE                                                  11409000
RSROPT   EQU   RSRECREQ+1                                               11410000
RSRDS    EQU   RSROPT                                                   11411000
RSRWF    EQU   RSRDS                                                    11412000
RSRCAT   EQU   RSRDS                                                    11413000
RSRCRA   EQU   RSRDS                                                    11414000
RSRBY    EQU   RSROPT                                                   11415000
RSRKEY   EQU   RSRBY                                                    11416000
RSRFOR   EQU   RSROPT                                                   11417000
RSRUPD   EQU   RSRFOR                                                   11418000
RSRUSE   EQU   RSROPT                                                   11419000
RSRDIR   EQU   RSRUSE                                                   11420000
RSREND   EQU   RSROPT                                                   11421000
RSASSOC  EQU   RSWORK+988                                               11422000
RSASSTBL EQU   RSASSOC                                                  11423000
RSASSFLG EQU   RSASSOC+16                                               11424000
RSASSFL1 EQU   RSASSFLG                                                 11425000
RSGDG    EQU   RSASSOC+20                                               11426000
RSGDGTB  EQU   RSGDG                                                    11427000
RSPROCVL EQU   RSWORK+1064                                              11428000
RSMAPS   EQU   RSPROCVL                                                 11429000
RSSBMAP  EQU   RSMAPS+8                                                 11430000
RSPCBMAP EQU   RSMAPS+12                                                11431000
RSMAPAD  EQU   RSPROCVL+20                                              11432000
RSPVSNT  EQU   RSPROCVL+48                                              11433000
RSPVTTNN EQU   RSPROCVL+68                                              11434000
@NM00062 EQU   RSPROCVL+84                                              11435000
RSPVSETB EQU   @NM00062                                                 11436000
RSPVFLG1 EQU   @NM00062+1                                               11437000
RSPVFLG2 EQU   @NM00062+2                                               11438000
RSEOVWA  EQU   RSWORK+1152                                              11439000
@NM00065 EQU   RSEOVWA+8                                                11440000
@NM00067 EQU   RSEOVWA+12                                               11441000
RSEOVFLG EQU   @NM00067+1                                               11442000
RSGETVIA EQU   RSWORK+1168                                              11443000
RSVIACRA EQU   RSGETVIA                                                 11444000
@NM00072 EQU   RSGETVIA+12                                              11445000
RSVIAFLG EQU   @NM00072                                                 11446000
@NM00074 EQU   RSGETVIA+16                                              11447000
RSREASW  EQU   RSWORK+1188                                              11448000
REASSW1  EQU   RSREASW                                                  11449000
REASSW2  EQU   RSREASW                                                  11450000
RSCKERR  EQU   RSWORK+1192                                              11451000
RSCKERN  EQU   RSCKERR                                                  11452000
RSCKTERM EQU   RSCKERR+4                                                11453000
RSCKMVAR EQU   RSCKERR+8                                                11454000
RSCKERRW EQU   RSWORK+1240                                              11455000
RSLASTCC EQU   RSCKERRW                                                 11456000
RSCKTIME EQU   RSCKERRW+8                                               11457000
RSCATRC  EQU   RSCKERRW+42                                              11458000
RSCKFLAG EQU   RSCKERRW+50                                              11459000
RSCIWA   EQU   RSWORK+1292                                              11460000
RSCIEXPT EQU   RSCIWA                                                   11461000
RSCIEXCU EQU   RSCIWA+4                                                 11462000
RSCINXCI EQU   RSCIWA+8                                                 11463000
RSCILCI  EQU   RSCIWA+12                                                11464000
RSCIRMEN EQU   RSCIWA+16                                                11465000
RSCIDFCI EQU   RSCIWA+20                                                11466000
RSCIEXT  EQU   RSCIWA+24                                                11467000
RSCISVLK EQU   RSCIWA+44                                                11468000
RSINWA   EQU   RSWORK+1340                                              11469000
RSINUAP  EQU   RSINWA                                                   11470000
RSINWACB EQU   RSINWA+4                                                 11471000
RSINCVPT EQU   RSINWA+8                                                 11472000
RSINDVPT EQU   RSINWA+12                                                11473000
RSINDNPT EQU   RSINWA+16                                                11474000
RSINDDPT EQU   RSINWA+20                                                11475000
RSINDVL  EQU   RSINWA+24                                                11476000
RSINDVLL EQU   RSINDVL                                                  11477000
RSINDVLV EQU   RSINDVL+1                                                11478000
RSINSVVL EQU   RSINWA+33                                                11479000
RSINVLSR EQU   RSINWA+39                                                11480000
RSINTS   EQU   RSINWA+45                                                11481000
RSINATR1 EQU   RSINWA+53                                                11482000
RSINRCV  EQU   RSINATR1                                                 11483000
RSINFLGS EQU   RSINWA+54                                                11484000
RSINALL  EQU   RSINFLGS                                                 11485000
RSSVENT  EQU   RSINWA+55                                                11486000
RSRNWA   EQU   RSWORK+1488                                              11487000
RSRNPLST EQU   RSRNWA                                                   11488000
RSRNFLGS EQU   RSRNWA+46                                                11489000
RSRNVL   EQU   RSRNWA+99                                                11490000
RSRNUL   EQU   RSRNWA+106                                               11491000
RSRWORK  EQU   RSWORK+1604                                              11492000
RSRFLGS  EQU   RSRWORK+64                                               11493000
RSWFWA   EQU   RSWORK+1672                                              11494000
RSADWA   EQU   RSWORK+1724                                              11495000
RSADVL   EQU   RSADWA+32                                                11496000
RSADUL   EQU   RSADWA+39                                                11497000
RSCRWA   EQU   RSWORK+1772                                              11498000
RSGENWRK EQU   RSWORK+1780                                              11499000
RSGENDTE EQU   RSGENWRK+12                                              11500000
RSVOLWA  EQU   RSWORK+1796                                              11501000
RSVF1TS  EQU   RSVOLWA+52                                               11502000
RSVF1EXT EQU   RSVOLWA+75                                               11503000
RSVFLAGS EQU   RSVOLWA+140                                              11504000
RSDF00W  EQU   RSWORK+1940                                              11505000
LISTSCAN EQU   RSDF00W+4                                                11506000
IOCSPTR  EQU   RSDF00W+8                                                11507000
OPNPTR   EQU   RSDF00W+12                                               11508000
DDSTRU   EQU   RSDF00W+16                                               11509000
FSADDR   EQU   RSDF00W+20                                               11510000
ERCNVADR EQU   RSDF00W+24                                               11511000
DMPINDEX EQU   RSDF00W+28                                               11512000
TESTRC   EQU   RSDF00W+34                                               11513000
RSCNVTCC EQU   RSWORK+1980                                              11514000
RSCCHHP  EQU   RSCNVTCC+4                                               11515000
RSTTNN   EQU   RSCNVTCC+8                                               11516000
RSCNVTCF EQU   RSCNVTCC+12                                              11517000
RSCNVTF1 EQU   RSCNVTCF                                                 11518000
RSWFNDWA EQU   RSWORK+1996                                              11519000
RSWASNVT EQU   RSWFNDWA+4                                               11520000
RSWSNFLG EQU   RSWFNDWA+8                                               11521000
RSWFONE  EQU   RSWSNFLG                                                 11522000
RSWGCODE EQU   RSWFNDWA+9                                               11523000
RSGENMWA EQU   RSWORK+2052                                              11524000
RSGENAM  EQU   RSGENMWA+9                                               11525000
RSGDATE  EQU   RSGENAM+21                                               11526000
RSGTIME  EQU   RSGENAM+26                                               11527000
RSCDSDWA EQU   RSWORK+2108                                              11528000
RSCDSDIN EQU   RSCDSDWA                                                 11529000
RSCDSDW  EQU   RSCDSDWA+16                                              11530000
RSMARKUN EQU   RSWORK+2144                                              11531000
RSCSWA   EQU   RSWORK+2152                                              11532000
LASTCC   EQU   0                                                        11533000
GRAB     EQU   0                                                        11534000
GRABFLGS EQU   GRAB                                                     11535000
GRABAFLS EQU   GRABFLGS+1                                               11536000
GRABAFL1 EQU   GRABAFLS                                                 11537000
GRABSFXT EQU   GRABAFL1                                                 11538000
GRABSNRA EQU   GRABAFL1                                                 11539000
GRABSEFN EQU   GRABAFL1                                                 11540000
GRABSIOI EQU   GRABAFL1                                                 11541000
GRABSIOF EQU   GRABAFL1                                                 11542000
GRABSIOT EQU   GRABAFL1                                                 11543000
GRABSDUP EQU   GRABAFL1                                                 11544000
GRABAFL2 EQU   GRABAFLS+1                                               11545000
GRABSN   EQU   GRAB+3                                                   11546000
GRABBB   EQU   GRAB+4                                                   11547000
GRABRABE EQU   GRAB+8                                                   11548000
GRABCURR EQU   GRAB+12                                                  11549000
GRABRABS EQU   GRAB+16                                                  11550000
GRABRAB1 EQU   GRABRABS                                                 11551000
GRABRAB2 EQU   GRABRABS+4                                               11552000
RSRAB    EQU   0                                                        11553000
RABFLGS  EQU   RSRAB                                                    11554000
RABFLG1  EQU   RABFLGS                                                  11555000
RABADD   EQU   RABFLG1                                                  11556000
RABRRN   EQU   RABFLG1                                                  11557000
RABIOIGN EQU   RABFLG1                                                  11558000
RABDUP   EQU   RABFLG1                                                  11559000
RABRCDA  EQU   RSRAB+4                                                  11560000
RABBUF   EQU   RSRAB+8                                                  11561000
RABPROC  EQU   RSRAB+520                                                11562000
RMB      EQU   0                                                        11563000
RMBCTL   EQU   RMB                                                      11564000
RMBFLAGS EQU   RMBCTL+8                                                 11565000
RSXCIXLT EQU   0                                                        11566000
RSXCIID  EQU   RSXCIXLT                                                 11567000
RSXCIENT EQU   RSXCIXLT+8                                               11568000
RSXCIBEG EQU   RSXCIENT                                                 11569000
RSXCILN  EQU   RSXCIENT+4                                               11570000
RSXCIFLG EQU   RSXCIENT+8                                               11571000
RSXCIFL1 EQU   RSXCIFLG                                                 11572000
RSXCIRNG EQU   RSXCIFL1                                                 11573000
RSXCIREL EQU   RSXCIENT+12                                              11574000
UIODSN   EQU   0                                                        11575000
UIODNM   EQU   UIODSN+4                                                 11576000
UIOVOL   EQU   0                                                        11577000
UIOVLS   EQU   UIOVOL+4                                                 11578000
RECIOWA  EQU   0                                                        11579000
GRABSWF  EQU   RECIOWA                                                  11580000
GRABSCA  EQU   RECIOWA+40                                               11581000
GRABSCR  EQU   RECIOWA+80                                               11582000
RSVUENT  EQU   RECIOWA+664                                              11583000
RSVOLENT EQU   RECIOWA+692                                              11584000
ALLUL    EQU   RECIOWA+784                                              11585000
ALLVL    EQU   RECIOWA+796                                              11586000
RSCAMAJN EQU   RECIOWA+808                                              11587000
RSCAMINN EQU   RECIOWA+816                                              11588000
RSCAMINL EQU   RSCAMINN                                                 11589000
RSCAMIND EQU   RSCAMINN+1                                               11590000
UCBAREA  EQU   RECIOWA+861                                              11591000
UCATWA   EQU   RECIOWA+874                                              11592000
UCATWTLN EQU   UCATWA                                                   11593000
RABS     EQU   0                                                        11594000
WFBUF1   EQU   0                                                        11595000
WFBUF2   EQU   0                                                        11596000
CRBUF1   EQU   0                                                        11597000
CABUFL1  EQU   0                                                        11598000
RSCNCCHH EQU   0                                                        11599000
TASSENT  EQU   0                                                        11600000
TASSFL1  EQU   TASSENT+1                                                11601000
TASSO    EQU   0                                                        11602000
TABANCHR EQU   0                                                        11603000
TABC     EQU   TABANCHR+8                                               11604000
@NM00102 EQU   TABANCHR+20                                              11605000
TABHEAD  EQU   0                                                        11606000
THEAD    EQU   TABHEAD                                                  11607000
PTWORK   EQU   0                                                        11608000
PTYPEDTA EQU   PTWORK+12                                                11609000
PTGCIT   EQU   PTYPEDTA                                                 11610000
@NM00104 EQU   PTGCIT                                                   11611000
@NM00106 EQU   PTGCIT+4                                                 11612000
@NM00108 EQU   PTGCIT+8                                                 11613000
PTCITCUR EQU   PTGCIT+12                                                11614000
PTGDIT   EQU   PTYPEDTA+24                                              11615000
@NM00110 EQU   PTGDIT                                                   11616000
@NM00112 EQU   PTGDIT+4                                                 11617000
@NM00114 EQU   PTGDIT+8                                                 11618000
PTDITCUR EQU   PTGDIT+12                                                11619000
PTASSO   EQU   PTYPEDTA+48                                              11620000
PTASSCUR EQU   PTASSO+4                                                 11621000
PTASSOEA EQU   PTASSO+8                                                 11622000
PTASSOE1 EQU   PTASSO+12                                                11623000
PTASSOE  EQU   PTASSOE1                                                 11624000
PTASSEXP EQU   PTASSO+52                                                11625000
PTINDX   EQU   PTYPEDTA+104                                             11626000
PTVERDI  EQU   PTYPEDTA+120                                             11627000
PTVALL   EQU   PTVERDI                                                  11628000
PTVDI    EQU   PTVALL                                                   11629000
PTXALIAS EQU   PTYPEDTA+152                                             11630000
PTXFLAGS EQU   PTXALIAS+30                                              11631000
PTXFLAG1 EQU   PTXFLAGS                                                 11632000
PTFLAGS  EQU   PTYPEDTA+190                                             11633000
PTF1     EQU   PTFLAGS                                                  11634000
PTF2     EQU   PTFLAGS+1                                                11635000
PTLOC    EQU   PTWORK+204                                               11636000
@NM00120 EQU   PTLOC                                                    11637000
@NM00122 EQU   PTLOC+12                                                 11638000
PTLDITFB EQU   PTLOC+18                                                 11639000
PTASOE   EQU   0                                                        11640000
GCITS    EQU   0                                                        11641000
CITABE   EQU   0                                                        11642000
CITFLA   EQU   CITABE                                                   11643000
@NM00127 EQU   CITABE+4                                                 11644000
@NM00128 EQU   CITABE+8                                                 11645000
@NM00129 EQU   CITABE+12                                                11646000
@NM00131 EQU   CITABE+16                                                11647000
GDITS    EQU   0                                                        11648000
DITABE   EQU   0                                                        11649000
DITFA    EQU   DITABE                                                   11650000
DITFLB   EQU   DITABE+1                                                 11651000
@NM00140 EQU   DITABE+4                                                 11652000
DITSN    EQU   @NM00140                                                 11653000
DITVSN   EQU   DITSN                                                    11654000
@NM00143 EQU   DITABE+8                                                 11655000
GDGLDS   EQU   0                                                        11656000
GDGLHEAD EQU   GDGLDS                                                   11657000
GDGFLG   EQU   GDGLHEAD+30                                              11658000
GDGLENTS EQU   GDGLDS+32                                                11659000
GDGENT   EQU   GDGLENTS                                                 11660000
RSFSNVT  EQU   0                                                        11661000
RSFLAGS  EQU   RSFSNVT+1                                                11662000
RSFENTLN EQU   RSFSNVT+3                                                11663000
RSFAENT  EQU   RSFSNVT+8                                                11664000
RSFCNTTN EQU   RSFSNVT+12                                               11665000
RSFATTNN EQU   RSFSNVT+16                                               11666000
SNTAB    EQU   0                                                        11667000
SNFIXED  EQU   SNTAB                                                    11668000
SNFLAG   EQU   SNFIXED                                                  11669000
SNENTRY  EQU   SNTAB+24                                                 11670000
SNVDATA  EQU   SNENTRY                                                  11671000
SSPHDFLG EQU   SNVDATA+8                                                11672000
SSPEXTNT EQU   SNVDATA+10                                               11673000
SNASSOC  EQU   0                                                        11674000
SNGLEV   EQU   SNASSOC+28                                               11675000
SNVGO    EQU   0                                                        11676000
SITYPEXT EQU   SNVGO+34                                                 11677000
SNEXTENT EQU   SNVGO+43                                                 11678000
SNVSBM   EQU   0                                                        11679000
SNDSDIR  EQU   0                                                        11680000
SDSIDFLG EQU   SNDSDIR+24                                               11681000
SNTTNN   EQU   0                                                        11682000
CATGOPT  EQU   0                                                        11683000
CATGOCI  EQU   CATGOPT                                                  11684000
CATGOFLG EQU   CATGOCI                                                  11685000
CATGOGC1 EQU   CATGOPT+3                                                11686000
CATGOSEQ EQU   CATGOPT+4                                                11687000
CATRCD   EQU   0                                                        11688000
RCDCINO  EQU   CATRCD+1                                                 11689000
RCDCRAVL EQU   CATRCD+5                                                 11690000
RCDCRACI EQU   CATRCD+11                                                11691000
RCDCRADT EQU   CATRCD+14                                                11692000
RCDRACTS EQU   CATRCD+18                                                11693000
RCDID    EQU   CATRCD+44                                                11694000
RCDSIZ   EQU   CATRCD+45                                                11695000
REPCNTRL EQU   0                                                        11696000
EXTRCDPT EQU   REPCNTRL                                                 11697000
VARFIELD EQU   0                                                        11698000
VARLEN   EQU   VARFIELD                                                 11699000
CNTRLINF EQU   0                                                        11700000
LENFIX   EQU   CNTRLINF+1                                               11701000
CTGRBASE EQU   0                                                        11702000
CNAME    EQU   CTGRBASE+49                                              11703000
COWNID   EQU   CTGRBASE+93                                              11704000
CATTR    EQU   CTGRBASE+107                                             11705000
CATTR1   EQU   CATTR                                                    11706000
CATTR2   EQU   CATTR+1                                                  11707000
COPEN    EQU   CTGRBASE+109                                             11708000
CSPACPRM EQU   CTGRBASE+114                                             11709000
CSEC     EQU   CSPACPRM+3                                               11710000
CHIA     EQU   CTGRBASE+125                                             11711000
CCR      EQU   0                                                        11712000
CCRHACI  EQU   CCR+45                                                   11713000
CCRNFCI  EQU   CCR+48                                                   11714000
CCRCDCI  EQU   CCR+51                                                   11715000
CCRFDCI  EQU   CCR+54                                                   11716000
ASGO     EQU   0                                                        11717000
ASG1     EQU   ASGO+2                                                   11718000
ASG2     EQU   ASGO+6                                                   11719000
ASGOGDG  EQU   0                                                        11720000
DSDIR    EQU   0                                                        11721000
SPACEPRM EQU   0                                                        11722000
SPCOPTNS EQU   SPACEPRM+6                                               11723000
RGATTRFL EQU   0                                                        11724000
RGATTR1  EQU   RGATTRFL                                                 11725000
RGATTSG1 EQU   RGATTRFL+1                                               11726000
VOLGO    EQU   0                                                        11727000
NOBLKTRK EQU   VOLGO+32                                                 11728000
GDGRCD   EQU   0                                                        11729000
GENLVLS  EQU   0                                                        11730000
CTGPL    EQU   0                                                        11731000
CTGOPTN1 EQU   CTGPL                                                    11732000
CTGNAME  EQU   CTGOPTN1                                                 11733000
CTGCNAME EQU   CTGOPTN1                                                 11734000
CTGOPTN2 EQU   CTGPL+1                                                  11735000
CTGEXT   EQU   CTGOPTN2                                                 11736000
CTGERASE EQU   CTGOPTN2                                                 11737000
CTGSMF   EQU   CTGERASE                                                 11738000
CTGREL   EQU   CTGSMF                                                   11739000
CTGPURG  EQU   CTGOPTN2                                                 11740000
CTGVMNT  EQU   CTGPURG                                                  11741000
CTGRCATN EQU   CTGVMNT                                                  11742000
CTGGTNXT EQU   CTGOPTN2                                                 11743000
CTGOPTN3 EQU   CTGPL+2                                                  11744000
CTGFUNC  EQU   CTGOPTN3                                                 11745000
CTGAM0   EQU   CTGOPTN3                                                 11746000
CTGOPTN4 EQU   CTGPL+3                                                  11747000
CTGENT   EQU   CTGPL+4                                                  11748000
CTGFVT   EQU   CTGENT                                                   11749000
CTGCAT   EQU   CTGPL+8                                                  11750000
CTGWKA   EQU   CTGPL+12                                                 11751000
CTGDSORG EQU   CTGPL+16                                                 11752000
CTGTYPE  EQU   CTGPL+18                                                 11753000
CTGNOFLD EQU   CTGPL+19                                                 11754000
CTGDDNM  EQU   CTGPL+20                                                 11755000
CTGNEWNM EQU   CTGDDNM                                                  11756000
CTGFBFLG EQU   CTGNEWNM+2                                               11757000
CTGJSCB  EQU   CTGPL+24                                                 11758000
CTGPSWD  EQU   CTGJSCB                                                  11759000
CTGFIELD EQU   CTGPL+28                                                 11760000
CTGFL    EQU   0                                                        11761000
CTGFLDNO EQU   CTGFL                                                    11762000
CTGFLDRE EQU   CTGFL+3                                                  11763000
CTGFLDNM EQU   CTGFL+8                                                  11764000
CTGFLDAT EQU   CTGFL+16                                                 11765000
CTGFLNG  EQU   CTGFLDAT                                                 11766000
CTGFLPT  EQU   CTGFLDAT+4                                               11767000
CTGFV    EQU   0                                                        11768000
CTGFVPRO EQU   CTGFV+1                                                  11769000
CTGFVSPC EQU   CTGFV+52                                                 11770000
CTGFVAMD EQU   CTGFV+56                                                 11771000
CTGFVLMT EQU   CTGFV+72                                                 11772000
CTGFVGAT EQU   CTGFV+76                                                 11773000
CVTMAP   EQU   0                                                        11774000
CVTDAR   EQU   CVTMAP+72                                                11775000
CVTFLGS1 EQU   CVTDAR                                                   11776000
CVTDCB   EQU   CVTMAP+116                                               11777000
CVTIERLC EQU   CVTMAP+144                                               11778000
CVTOPTA  EQU   CVTMAP+182                                               11779000
CVTOPTB  EQU   CVTMAP+183                                               11780000
CVTGTF   EQU   CVTMAP+236                                               11781000
CVTGTFST EQU   CVTGTF                                                   11782000
CVTGTFS  EQU   CVTGTFST                                                 11783000
CVTSTATE EQU   CVTGTFST                                                 11784000
CVTTMODE EQU   CVTGTFST                                                 11785000
CVTFORM  EQU   CVTGTFST                                                 11786000
CVTAQAVT EQU   CVTMAP+240                                               11787000
CVTTCMFG EQU   CVTAQAVT                                                 11788000
CVTVOLM2 EQU   CVTMAP+244                                               11789000
CVTTATA  EQU   CVTVOLM2                                                 11790000
CVTTSKS  EQU   CVTTATA                                                  11791000
CVTVOLF2 EQU   CVTTSKS                                                  11792000
CVTTAT   EQU   CVTTATA+1                                                11793000
CVTATER  EQU   CVTMAP+248                                               11794000
CVTEXT1  EQU   CVTMAP+252                                               11795000
CVTCBSP  EQU   CVTMAP+256                                               11796000
CVTPURG  EQU   CVTMAP+260                                               11797000
CVTQMSG  EQU   CVTMAP+268                                               11798000
CVTDMSR  EQU   CVTMAP+272                                               11799000
CVTRSV37 EQU   CVTDMSR                                                  11800000
CVTDMSRF EQU   CVTRSV37                                                 11801000
CVTERPV  EQU   CVTMAP+316                                               11802000
CVTINTLA EQU   CVTMAP+320                                               11803000
CVTAPF   EQU   CVTMAP+324                                               11804000
CVTEXT2  EQU   CVTMAP+328                                               11805000
CVTHJES  EQU   CVTMAP+332                                               11806000
CVTPGSIA EQU   CVTMAP+348                                               11807000
CVTA1F1  EQU   CVTMAP+356                                               11808000
CVTSYSK  EQU   CVTMAP+357                                               11809000
CVTVOLM1 EQU   CVTMAP+380                                               11810000
CVTVOLF1 EQU   CVTVOLM1                                                 11811000
CVTATMCT EQU   CVTMAP+388                                               11812000
CVTXTNT1 EQU   0                                                        11813000
CVTXTNT2 EQU   0                                                        11814000
CVTDSSV  EQU   CVTXTNT2                                                 11815000
CVTFLGBT EQU   CVTXTNT2+5                                               11816000
CVTQID   EQU   CVTXTNT2+24                                              11817000
CVTRV400 EQU   CVTXTNT2+52                                              11818000
CVTRV409 EQU   CVTXTNT2+53                                              11819000
CVTATCVT EQU   CVTXTNT2+64                                              11820000
CVTRV429 EQU   CVTXTNT2+84                                              11821000
CVTRV438 EQU   CVTXTNT2+85                                              11822000
CVTRV457 EQU   CVTXTNT2+112                                             11823000
CVTRV466 EQU   CVTXTNT2+113                                             11824000
CVTFIX   EQU   0                                                        11825000
CVTRELNO EQU   CVTFIX+252                                               11826000
AMCBS    EQU   0                                                        11827000
CBSACB   EQU   AMCBS+8                                                  11828000
CBSCMP   EQU   AMCBS+16                                                 11829000
CBSVSRT  EQU   AMCBS+32                                                 11830000
IGGCAXWA EQU   0                                                        11831000
CAXFLGS  EQU   IGGCAXWA+8                                               11832000
CAXFLG2  EQU   IGGCAXWA+9                                               11833000
CAXFLG3  EQU   IGGCAXWA+10                                              11834000
CAXACT   EQU   IGGCAXWA+11                                              11835000
CAXCCR   EQU   IGGCAXWA+32                                              11836000
CAXCNAM  EQU   IGGCAXWA+52                                              11837000
CAXOPLST EQU   IGGCAXWA+96                                              11838000
COPTS    EQU   CAXOPLST                                                 11839000
IFGACB   EQU   0                                                        11840000
ACBCOMN  EQU   IFGACB                                                   11841000
ACBLENG  EQU   ACBCOMN+2                                                11842000
ACBLENG2 EQU   ACBLENG                                                  11843000
ACBAMBL  EQU   ACBCOMN+4                                                11844000
ACBJWA   EQU   ACBAMBL                                                  11845000
ACBMACRF EQU   ACBCOMN+12                                               11846000
ACBMACR1 EQU   ACBMACRF                                                 11847000
ACBADR   EQU   ACBMACR1                                                 11848000
ACBCNV   EQU   ACBMACR1                                                 11849000
ACBMACR2 EQU   ACBMACRF+1                                               11850000
ACBBUFPL EQU   ACBCOMN+20                                               11851000
ACBMACR3 EQU   ACBBUFPL                                                 11852000
ACBRECFM EQU   ACBCOMN+24                                               11853000
ACBCCTYP EQU   ACBCOMN+25                                               11854000
ACBOPT   EQU   ACBCOMN+26                                               11855000
ACBDSORG EQU   ACBOPT                                                   11856000
ACBCROPS EQU   ACBDSORG                                                 11857000
ACBDVIND EQU   ACBDSORG                                                 11858000
ACBEXLST EQU   ACBCOMN+36                                               11859000
ACBDDNM  EQU   ACBCOMN+40                                               11860000
ACBAMETH EQU   ACBDDNM+3                                                11861000
ACBOFLGS EQU   ACBCOMN+48                                               11862000
ACBEXFG  EQU   ACBOFLGS                                                 11863000
ACBIOSFG EQU   ACBOFLGS                                                 11864000
ACBINFLG EQU   ACBCOMN+50                                               11865000
ACBVVIC  EQU   ACBINFLG                                                 11866000
ACBUJFCB EQU   ACBCOMN+52                                               11867000
ACBBLKSZ EQU   ACBCOMN+60                                               11868000
ACBUAPTR EQU   ACBCOMN+64                                               11869000
IDAAMDSB EQU   0                                                        11870000
AMDATTR  EQU   IDAAMDSB+1                                               11871000
AMDNEST  EQU   IDAAMDSB+4                                               11872000
AMDHLRBA EQU   IDAAMDSB+28                                              11873000
AMDSSRBA EQU   IDAAMDSB+32                                              11874000
AMDATTR3 EQU   IDAAMDSB+40                                              11875000
AMDSTAT  EQU   IDAAMDSB+48                                              11876000
AREGSAVE EQU   0                                                        11877000
RSREGMOD EQU   AREGSAVE                                                 11878000
RSREGB   EQU   AREGSAVE+4                                               11879000
RSREGF   EQU   AREGSAVE+8                                               11880000
INITDSN  EQU   0                                                        11881000
INITVLSR EQU   0                                                        11882000
INITTS   EQU   0                                                        11883000
INITACB  EQU   0                                                        11884000
INITATR1 EQU   0                                                        11885000
INITWACB EQU   0                                                        11886000
UINFHDR  EQU   0                                                        11887000
UINFTLN  EQU   UINFHDR                                                  11888000
FNDEXTS  EQU   0                                                        11889000
ALLP     EQU   0                                                        11890000
ALLPPTR  EQU   0                                                        11891000
AMSTP041 EQU   0                                                        11892000
AMSTP042 EQU   0                                                        11893000
AMSTP043 EQU   0                                                        11894000
AMSTP044 EQU   0                                                        11895000
BMAP     EQU   0                                                        11896000
CABUFH1  EQU   0                                                        11897000
CAT      EQU   0                                                        11898000
CATSN    EQU   0                                                        11899000
CFILE    EQU   0                                                        11900000
CIN      EQU   0                                                        11901000
CVOL     EQU   0                                                        11902000
DMPTRM   EQU   0                                                        11903000
IDCIOCO0 EQU   0                                                        11904000
IDCIOGT0 EQU   0                                                        11905000
IDCIOIT0 EQU   0                                                        11906000
IDCIOOP0 EQU   0                                                        11907000
IDCIOPO0 EQU   0                                                        11908000
IDCIOPT0 EQU   0                                                        11909000
IDCIOST0 EQU   0                                                        11910000
IDCIOTM0 EQU   0                                                        11911000
IDCIOVY0 EQU   0                                                        11912000
IDCIO050 EQU   0                                                        11913000
IDCSAAL0 EQU   0                                                        11914000
IDCSACL0 EQU   0                                                        11915000
IDCSACR0 EQU   0                                                        11916000
IDCSADE0 EQU   0                                                        11917000
IDCSADL0 EQU   0                                                        11918000
IDCSAFS0 EQU   0                                                        11919000
IDCSAGS0 EQU   0                                                        11920000
IDCSAID0 EQU   0                                                        11921000
IDCSALC0 EQU   0                                                        11922000
IDCSALD0 EQU   0                                                        11923000
IDCSALK0 EQU   0                                                        11924000
IDCSANQ0 EQU   0                                                        11925000
IDCSAPR0 EQU   0                                                        11926000
IDCSAPT0 EQU   0                                                        11927000
IDCSAQL0 EQU   0                                                        11928000
IDCSARC0 EQU   0                                                        11929000
IDCSASC0 EQU   0                                                        11930000
IDCSASN0 EQU   0                                                        11931000
IDCSASS0 EQU   0                                                        11932000
IDCSAST0 EQU   0                                                        11933000
IDCSATI0 EQU   0                                                        11934000
IDCSAUC0 EQU   0                                                        11935000
IDCSAWO0 EQU   0                                                        11936000
IDCSA060 EQU   0                                                        11937000
IDCST010 EQU   0                                                        11938000
IDCTPER0 EQU   0                                                        11939000
LISTTEST EQU   0                                                        11940000
NEWERID1 EQU   5                                                        11941000
NIGN     EQU   0                                                        11942000
NONE     EQU   0                                                        11943000
PTASSEX  EQU   0                                                        11944000
GDTTBLX  EQU   0                                                        11945000
FDTTBL   EQU   0                                                        11946000
FDTPTR   EQU   FDTTBL+8                                                 11947000
ALASTCC  EQU   0                                                        11948000
RSWFLD   EQU   RABPROC                                                  11949000
RSWCHPTR EQU   RSWFLD                                                   11950000
RSWDUPTR EQU   RSWFLD+4                                                 11951000
RSWFKG1  EQU   RSWFLD+8                                                 11952000
RSWFCRA  EQU   RSWFKG1                                                  11953000
RSWDLCAT EQU   RSWFKG1                                                  11954000
RSWUPCAT EQU   RSWFKG1                                                  11955000
RSWUPCRA EQU   RSWFKG1                                                  11956000
RSWRASCI EQU   RSWFKG1                                                  11957000
RSWASSCK EQU   RSWFKG1                                                  11958000
RSWDUPCI EQU   RSWFKG1                                                  11959000
RSWFLG2  EQU   RSWFLD+9                                                 11960000
RSWINVCI EQU   RSWFLG2                                                  11961000
RSWDUPRR EQU   RSWFLG2                                                  11962000
RSWCHNRR EQU   RSWFLG2                                                  11963000
RSWCHRA  EQU   RSWFLG2                                                  11964000
RABARRAY EQU   GRABRABS                                                 11965000
@NM00165 EQU   CATTR1                                                   11966000
CCATTR   EQU   @NM00165                                                 11967000
@NM00166 EQU   CCATTR                                                   11968000
@NM00168 EQU   CATTR1                                                   11969000
CRGATTR  EQU   @NM00168                                                 11970000
CUPG     EQU   CRGATTR                                                  11971000
DEVCHARS EQU   RABBUF+101                                               11972000
@NM00177 EQU   DEVCHARS                                                 11973000
RTDEVUCB EQU   @NM00177                                                 11974000
RTNOTRKS EQU   @NM00177+10                                              11975000
RTBOKAB  EQU   @NM00177+14                                              11976000
RTDVFLGS EQU   @NM00177+17                                              11977000
@NM00191 EQU   CTGDDNM                                                  11978000
CTGPROB  EQU   @NM00191                                                 11979000
CTGREASN EQU   CTGPROB+2                                                11980000
CVTS01   EQU   CVTPGSIA                                                 11981000
CVTLPDIA EQU   CVTS01+12                                                11982000
CVTDIRST EQU   CVTLPDIA                                                 11983000
CVTSLIDA EQU   CVTS01+24                                                11984000
CVTCTLFG EQU   CVTS01+50                                                11985000
CVTRV210 EQU   CVTS01+424                                               11986000
CVTRV219 EQU   CVTS01+425                                               11987000
CVTRV228 EQU   CVTS01+426                                               11988000
CVTRV237 EQU   CVTS01+427                                               11989000
CVTMFRTR EQU   CVTS01+452                                               11990000
CVTRV262 EQU   CVTS01+468                                               11991000
CVTRV271 EQU   CVTS01+469                                               11992000
CVTRV280 EQU   CVTS01+470                                               11993000
CVTRV289 EQU   CVTS01+471                                               11994000
CVTGSDA  EQU   CVTS01+600                                               11995000
RSUPENTF EQU   RCDSIZ                                                   11996000
RSUCENTF EQU   RCDSIZ                                                   11997000
BMAPARRY EQU   RSMAPS                                                   11998000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    11999000
CVTRV628 EQU   CVTS01+728                                               12000000
CVTRV627 EQU   CVTS01+724                                               12001000
CVTRV626 EQU   CVTS01+720                                               12002000
CVTRV625 EQU   CVTS01+716                                               12003000
CVTRV624 EQU   CVTS01+712                                               12004000
CVTRV623 EQU   CVTS01+708                                               12005000
CVTRV622 EQU   CVTS01+704                                               12006000
CVTRV621 EQU   CVTS01+700                                               12007000
CVTIHASU EQU   CVTS01+696                                               12008000
CVTRV619 EQU   CVTS01+692                                               12009000
CVTRV618 EQU   CVTS01+688                                               12010000
CVTRV617 EQU   CVTS01+684                                               12011000
CVTRV616 EQU   CVTS01+680                                               12012000
CVTRV615 EQU   CVTS01+676                                               12013000
CVTRV614 EQU   CVTS01+672                                               12014000
CVTRV613 EQU   CVTS01+668                                               12015000
CVTTCASP EQU   CVTS01+664                                               12016000
CVT0PT03 EQU   CVTS01+660                                               12017000
CVT0PT0E EQU   CVTS01+656                                               12018000
CVTRV609 EQU   CVTS01+652                                               12019000
CVTCGK   EQU   CVTS01+648                                               12020000
CVTRAC   EQU   CVTS01+644                                               12021000
CVTRV606 EQU   CVTS01+640                                               12022000
CVTRV605 EQU   CVTS01+636                                               12023000
CVTRV604 EQU   CVTS01+632                                               12024000
CVTEFF02 EQU   CVTS01+628                                               12025000
CVTCBBR  EQU   CVTS01+624                                               12026000
CVTSSCR  EQU   CVTS01+620                                               12027000
CVTEVENT EQU   CVTS01+616                                               12028000
CVTCRCA  EQU   CVTS01+612                                               12029000
CVTTPIO  EQU   CVTS01+608                                               12030000
CVTADV   EQU   CVTS01+604                                               12031000
CVTGSDAB EQU   CVTGSDA                                                  12032000
CVTQV3   EQU   CVTS01+596                                               12033000
CVTQV2   EQU   CVTS01+592                                               12034000
CVTQV1   EQU   CVTS01+588                                               12035000
CVTRPT   EQU   CVTS01+584                                               12036000
CVTSSRB  EQU   CVTS01+580                                               12037000
CVTCSDRL EQU   CVTS01+576                                               12038000
CVTEXP1  EQU   CVTS01+572                                               12039000
CVTRMPMT EQU   CVTS01+568                                               12040000
CVTRMPTT EQU   CVTS01+564                                               12041000
CVTVPSA  EQU   CVTS01+560                                               12042000
CVTVSTOP EQU   CVTS01+556                                               12043000
CVTGTFR8 EQU   CVTS01+552                                               12044000
CVTQUIT  EQU   CVTS01+548                                               12045000
CVTVACR  EQU   CVTS01+544                                               12046000
CVTWTCB  EQU   CVTS01+540                                               12047000
CVTSTPRS EQU   CVTS01+536                                               12048000
CVT0PT02 EQU   CVTS01+532                                               12049000
CVTDARCM EQU   CVTS01+528                                               12050000
CVTIRECM EQU   CVTS01+524                                               12051000
CVTJRECM EQU   CVTS01+520                                               12052000
CVTVEMS0 EQU   CVTS01+516                                               12053000
CVTSPFRR EQU   CVTS01+512                                               12054000
CVTRLSTG EQU   CVTS01+508                                               12055000
CVT0TC0A EQU   CVTS01+504                                               12056000
CVTGMBR  EQU   CVTS01+500                                               12057000
CVTLFRM  EQU   CVTS01+496                                               12058000
CVTRMBR  EQU   CVTS01+492                                               12059000
CVTVIOP  EQU   CVTS01+488                                               12060000
CVTRV307 EQU   CVTS01+486                                               12061000
CVTRV306 EQU   CVTS01+484                                               12062000
CVTRV305 EQU   CVTS01+482                                               12063000
CVTRV304 EQU   CVTS01+480                                               12064000
CVTRV303 EQU   CVTS01+478                                               12065000
CVTRV302 EQU   CVTS01+476                                               12066000
CVTTRCA  EQU   CVTS01+472                                               12067000
CVTRV297 EQU   CVTRV289                                                 12068000
CVTRV296 EQU   CVTRV289                                                 12069000
CVTRV295 EQU   CVTRV289                                                 12070000
CVTRV294 EQU   CVTRV289                                                 12071000
CVTRV293 EQU   CVTRV289                                                 12072000
CVTRV292 EQU   CVTRV289                                                 12073000
CVTRV291 EQU   CVTRV289                                                 12074000
CVTRV290 EQU   CVTRV289                                                 12075000
CVTRV288 EQU   CVTRV280                                                 12076000
CVTRV287 EQU   CVTRV280                                                 12077000
CVTRV286 EQU   CVTRV280                                                 12078000
CVTRV285 EQU   CVTRV280                                                 12079000
CVTRV284 EQU   CVTRV280                                                 12080000
CVTRV283 EQU   CVTRV280                                                 12081000
CVTRV282 EQU   CVTRV280                                                 12082000
CVTRV281 EQU   CVTRV280                                                 12083000
CVTRV279 EQU   CVTRV271                                                 12084000
CVTRV278 EQU   CVTRV271                                                 12085000
CVTRV277 EQU   CVTRV271                                                 12086000
CVTRV276 EQU   CVTRV271                                                 12087000
CVTRV275 EQU   CVTRV271                                                 12088000
CVTRV274 EQU   CVTRV271                                                 12089000
CVTRV273 EQU   CVTRV271                                                 12090000
CVTRV272 EQU   CVTRV271                                                 12091000
CVTRV270 EQU   CVTRV262                                                 12092000
CVTRV269 EQU   CVTRV262                                                 12093000
CVTRV268 EQU   CVTRV262                                                 12094000
CVTRV267 EQU   CVTRV262                                                 12095000
CVTRV266 EQU   CVTRV262                                                 12096000
CVTRV265 EQU   CVTRV262                                                 12097000
CVTRV264 EQU   CVTRV262                                                 12098000
CVTRV263 EQU   CVTRV262                                                 12099000
CVTVFP   EQU   CVTS01+464                                               12100000
CVTVSI   EQU   CVTS01+460                                               12101000
CVTVPSIB EQU   CVTS01+456                                               12102000
CVTMFACT EQU   CVTMFRTR                                                 12103000
CVTMFCTL EQU   CVTS01+448                                               12104000
CVTPVBP  EQU   CVTS01+444                                               12105000
CVTPWI   EQU   CVTS01+440                                               12106000
CVTRV254 EQU   CVTS01+438                                               12107000
CVTRV253 EQU   CVTS01+436                                               12108000
CVTRV252 EQU   CVTS01+434                                               12109000
CVTRV251 EQU   CVTS01+433                                               12110000
CVTRV250 EQU   CVTS01+432                                               12111000
CVTRV249 EQU   CVTS01+431                                               12112000
CVTRV248 EQU   CVTS01+430                                               12113000
CVTRV247 EQU   CVTS01+429                                               12114000
CVTRV246 EQU   CVTS01+428                                               12115000
CVTRV245 EQU   CVTRV237                                                 12116000
CVTRV244 EQU   CVTRV237                                                 12117000
CVTRV243 EQU   CVTRV237                                                 12118000
CVTRV242 EQU   CVTRV237                                                 12119000
CVTRV241 EQU   CVTRV237                                                 12120000
CVTRV240 EQU   CVTRV237                                                 12121000
CVTRV239 EQU   CVTRV237                                                 12122000
CVTRV238 EQU   CVTRV237                                                 12123000
CVTRV236 EQU   CVTRV228                                                 12124000
CVTRV235 EQU   CVTRV228                                                 12125000
CVTRV234 EQU   CVTRV228                                                 12126000
CVTRV233 EQU   CVTRV228                                                 12127000
CVTRV232 EQU   CVTRV228                                                 12128000
CVTRV231 EQU   CVTRV228                                                 12129000
CVTRV230 EQU   CVTRV228                                                 12130000
CVTRV229 EQU   CVTRV228                                                 12131000
CVTRV227 EQU   CVTRV219                                                 12132000
CVTRV226 EQU   CVTRV219                                                 12133000
CVTRV225 EQU   CVTRV219                                                 12134000
CVTRV224 EQU   CVTRV219                                                 12135000
CVTRV223 EQU   CVTRV219                                                 12136000
CVTRV222 EQU   CVTRV219                                                 12137000
CVTRV221 EQU   CVTRV219                                                 12138000
CVTRV220 EQU   CVTRV219                                                 12139000
CVTRV218 EQU   CVTRV210                                                 12140000
CVTRV217 EQU   CVTRV210                                                 12141000
CVTRV216 EQU   CVTRV210                                                 12142000
CVTRV215 EQU   CVTRV210                                                 12143000
CVTRV214 EQU   CVTRV210                                                 12144000
CVTRV213 EQU   CVTRV210                                                 12145000
CVTRV212 EQU   CVTRV210                                                 12146000
CVTRV211 EQU   CVTRV210                                                 12147000
CVTLCCAT EQU   CVTS01+420                                               12148000
CVTPCCAT EQU   CVTS01+416                                               12149000
CVTIPCRP EQU   CVTS01+412                                               12150000
CVTIPCRI EQU   CVTS01+408                                               12151000
CVTIPCDS EQU   CVTS01+404                                               12152000
CVTAIDVT EQU   CVTS01+400                                               12153000
CVTSSAP  EQU   CVTS01+396                                               12154000
CVTEHCIR EQU   CVTS01+392                                               12155000
CVTEHDEF EQU   CVTS01+388                                               12156000
CVTDAIR  EQU   CVTS01+384                                               12157000
CVTPERFM EQU   CVTS01+380                                               12158000
CVT044R2 EQU   CVTS01+376                                               12159000
CVTFETCH EQU   CVTS01+372                                               12160000
CVTRSTWD EQU   CVTS01+368                                               12161000
CVTSPOST EQU   CVTS01+364                                               12162000
CVTIOBP  EQU   CVTS01+360                                               12163000
CVTASMVT EQU   CVTS01+356                                               12164000
CVTRECRQ EQU   CVTS01+352                                               12165000
CVTWSAC  EQU   CVTS01+348                                               12166000
CVTRV149 EQU   CVTS01+344                                               12167000
CVTWSAL  EQU   CVTS01+340                                               12168000
CVTSPSA  EQU   CVTS01+336                                               12169000
CVTGLMN  EQU   CVTS01+332                                               12170000
CVTVEAC0 EQU   CVTS01+328                                               12171000
CVT062R1 EQU   CVTS01+324                                               12172000
CVTRPOST EQU   CVTS01+320                                               12173000
CVTDQIQE EQU   CVTS01+316                                               12174000
CVTCSD   EQU   CVTS01+312                                               12175000
CVTLKRMA EQU   CVTS01+308                                               12176000
CVTRSPIE EQU   CVTS01+304                                               12177000
CVTRENQ  EQU   CVTS01+300                                               12178000
CVTLQCB  EQU   CVTS01+296                                               12179000
CVTFQCB  EQU   CVTS01+292                                               12180000
CVTQCS01 EQU   CVTS01+288                                               12181000
CVTAPFT  EQU   CVTS01+284                                               12182000
CVTPARRL EQU   CVTS01+280                                               12183000
CVTVWAIT EQU   CVTS01+276                                               12184000
CVTGSPL  EQU   CVTS01+272                                               12185000
CVTLSMQ  EQU   CVTS01+268                                               12186000
CVTGSMQ  EQU   CVTS01+264                                               12187000
CVTEXPRO EQU   CVTS01+260                                               12188000
CVTOPCTP EQU   CVTS01+256                                               12189000
CVTSIC   EQU   CVTS01+252                                               12190000
CVTTPIOS EQU   CVTS01+248                                               12191000
CVTRTMS  EQU   CVTS01+244                                               12192000
CVTSDBF  EQU   CVTS01+240                                               12193000
CVTSCBP  EQU   CVTS01+236                                               12194000
CVTSDMP  EQU   CVTS01+232                                               12195000
CVTSV60  EQU   CVTS01+228                                               12196000
CVTRTMCT EQU   CVTS01+224                                               12197000
CVTASCBL EQU   CVTS01+220                                               12198000
CVTASCBH EQU   CVTS01+216                                               12199000
CVTGDA   EQU   CVTS01+212                                               12200000
CVTASVT  EQU   CVTS01+208                                               12201000
CVTVVMDI EQU   CVTS01+204                                               12202000
CVTAQTOP EQU   CVTS01+200                                               12203000
CVTIOSCS EQU   CVTS01+196                                               12204000
CVTSDRM  EQU   CVTS01+192                                               12205000
CVTOPTE  EQU   CVTS01+188                                               12206000
CVTSTXU  EQU   CVTS01+184                                               12207000
CVTQUIS  EQU   CVTS01+180                                               12208000
CVTPARS  EQU   CVTS01+176                                               12209000
CVTS1EE  EQU   CVTS01+172                                               12210000
CVTFRAS  EQU   CVTS01+168                                               12211000
CVTQSAS  EQU   CVTS01+164                                               12212000
CVTCRAS  EQU   CVTS01+160                                               12213000
CVTCRMN  EQU   CVTS01+156                                               12214000
CVTDELCP EQU   CVTS01+152                                               12215000
CVTFRECL EQU   CVTS01+148                                               12216000
CVTGETCL EQU   CVTS01+144                                               12217000
CVTBLDCP EQU   CVTS01+140                                               12218000
CVTAUTHL EQU   CVTS01+136                                               12219000
CVTSCAN  EQU   CVTS01+132                                               12220000
CVTRV144 EQU   CVTS01+130                                               12221000
CVTMAXMP EQU   CVTS01+128                                               12222000
CVTSTCK  EQU   CVTS01+124                                               12223000
CVTRV139 EQU   CVTS01+123                                               12224000
CVTDSSAC EQU   CVTS01+122                                               12225000
CVTRV513 EQU   CVTS01+121                                               12226000
CVTIOSPL EQU   CVTS01+120                                               12227000
CVTPTGT  EQU   CVTS01+116                                               12228000
CVTCSPIE EQU   CVTS01+112                                               12229000
CVTSMFEX EQU   CVTS01+108                                               12230000
CVTOLT0A EQU   CVTS01+104                                               12231000
CVTSRBRT EQU   CVTS01+100                                               12232000
CVTPUTL  EQU   CVTS01+96                                                12233000
CVTASCRL EQU   CVTS01+92                                                12234000
CVTASCRF EQU   CVTS01+88                                                12235000
CVTRV326 EQU   CVTS01+84                                                12236000
CVTRV325 EQU   CVTS01+80                                                12237000
CVTRV324 EQU   CVTS01+76                                                12238000
CVT0VL01 EQU   CVTS01+72                                                12239000
CVTSHRVM EQU   CVTS01+68                                                12240000
CVTRV332 EQU   CVTS01+64                                                12241000
CVTTAS   EQU   CVTS01+60                                                12242000
CVTRSCN  EQU   CVTS01+56                                                12243000
CVTTRAC2 EQU   CVTS01+54                                                12244000
CVTTRACE EQU   CVTS01+52                                                12245000
CVTAPG   EQU   CVTS01+51                                                12246000
CVTSDTRC EQU   CVTCTLFG                                                 12247000
CVTGTRCE EQU   CVTCTLFG                                                 12248000
CVTNOMP  EQU   CVTCTLFG                                                 12249000
CVTRSV79 EQU   CVTCTLFG                                                 12250000
CVTDSTAT EQU   CVTCTLFG                                                 12251000
CVTRSV78 EQU   CVTCTLFG                                                 12252000
CVTRV333 EQU   CVTCTLFG                                                 12253000
CVTRV323 EQU   CVTCTLFG                                                 12254000
CVTSPVLK EQU   CVTS01+49                                                12255000
CVTRSV77 EQU   CVTS01+48                                                12256000
CVTRV331 EQU   CVTS01+44                                                12257000
CVTRV330 EQU   CVTS01+40                                                12258000
CVTRV329 EQU   CVTS01+36                                                12259000
CVTRV328 EQU   CVTS01+32                                                12260000
CVTRV322 EQU   CVTS01+28                                                12261000
CVTSLID  EQU   CVTSLIDA+1                                               12262000
CVTSYLK  EQU   CVTSLIDA                                                 12263000
CVTRV321 EQU   CVTS01+20                                                12264000
CVTRV320 EQU   CVTS01+16                                                12265000
CVTLPDIR EQU   CVTLPDIA+1                                               12266000
CVTRSV69 EQU   CVTDIRST                                                 12267000
CVTRSV68 EQU   CVTDIRST                                                 12268000
CVTRSV67 EQU   CVTDIRST                                                 12269000
CVTRSV66 EQU   CVTDIRST                                                 12270000
CVTRSV65 EQU   CVTDIRST                                                 12271000
CVTRSV64 EQU   CVTDIRST                                                 12272000
CVTRSV63 EQU   CVTDIRST                                                 12273000
CVTDICOM EQU   CVTDIRST                                                 12274000
CVTPVTP  EQU   CVTS01+8                                                 12275000
CVTLPDSR EQU   CVTS01+4                                                 12276000
CVTGETL  EQU   CVTS01                                                   12277000
CTGREAS2 EQU   CTGREASN+1                                               12278000
CTGREAS1 EQU   CTGREASN                                                 12279000
CTGMODID EQU   CTGPROB                                                  12280000
RTTOLFCT EQU   @NM00177+18                                              12281000
RTTOLFLG EQU   RTDVFLGS                                                 12282000
@NM00180 EQU   RTDVFLGS                                                 12283000
RTKABFLG EQU   RTDVFLGS                                                 12284000
@NM00179 EQU   RTDVFLGS                                                 12285000
RTBONK   EQU   @NM00177+16                                              12286000
RTBOKLB  EQU   RTBOKAB+1                                                12287000
RTBOKNLB EQU   RTBOKAB                                                  12288000
RTTRKSIZ EQU   @NM00177+12                                              12289000
RTNOCYLS EQU   @NM00177+8                                               12290000
RTMXDBLK EQU   @NM00177+4                                               12291000
RTCLSTYP EQU   RTDEVUCB+2                                               12292000
@NM00178 EQU   RTDEVUCB                                                 12293000
@NM00169 EQU   CRGATTR                                                  12294000
CUPD     EQU   CUPG                                                     12295000
CPGSP    EQU   @NM00166                                                 12296000
@NM00167 EQU   @NM00166                                                 12297000
@NM00094 EQU   RSWFLG2                                                  12298000
RSWDSDIR EQU   RSWFLG2                                                  12299000
RSWUPCCH EQU   RSWFLG2                                                  12300000
RSWDICHK EQU   RSWFLG2                                                  12301000
@NM00093 EQU   RSWFKG1                                                  12302000
FDTVERB  EQU   FDTTBL                                                   12303000
UINFRLN  EQU   UINFHDR+2                                                12304000
RSREG12  EQU   AREGSAVE+68                                              12305000
RSREG11  EQU   AREGSAVE+64                                              12306000
RSREG10  EQU   AREGSAVE+60                                              12307000
RSREG09  EQU   AREGSAVE+56                                              12308000
RSREG08  EQU   AREGSAVE+52                                              12309000
RSREG07  EQU   AREGSAVE+48                                              12310000
RSREG06  EQU   AREGSAVE+44                                              12311000
RSREG05  EQU   AREGSAVE+40                                              12312000
RSREG04  EQU   AREGSAVE+36                                              12313000
RSREG03  EQU   AREGSAVE+32                                              12314000
RSREG02  EQU   AREGSAVE+28                                              12315000
RSREG01  EQU   AREGSAVE+24                                              12316000
RSREG00  EQU   AREGSAVE+20                                              12317000
RSREG15  EQU   AREGSAVE+16                                              12318000
RSREG14  EQU   AREGSAVE+12                                              12319000
AMDEXCP  EQU   AMDSTAT+44                                               12320000
AMDNCAS  EQU   AMDSTAT+40                                               12321000
AMDNCIS  EQU   AMDSTAT+36                                               12322000
AMDASPA  EQU   AMDSTAT+32                                               12323000
AMDRETR  EQU   AMDSTAT+28                                               12324000
AMDUPR   EQU   AMDSTAT+24                                               12325000
AMDIREC  EQU   AMDSTAT+20                                               12326000
AMDDELR  EQU   AMDSTAT+16                                               12327000
AMDNLR   EQU   AMDSTAT+12                                               12328000
AMDNEXT  EQU   AMDSTAT+10                                               12329000
AMDNIL   EQU   AMDSTAT+8                                                12330000
AMDSTSP  EQU   AMDSTAT                                                  12331000
@NM00215 EQU   IDAAMDSB+41                                              12332000
@NM00214 EQU   AMDATTR3                                                 12333000
AMDLM    EQU   AMDATTR3                                                 12334000
AMDWAIT  EQU   AMDATTR3                                                 12335000
AMDBIND  EQU   AMDATTR3                                                 12336000
AMDFAULT EQU   AMDATTR3                                                 12337000
AMDUNQ   EQU   AMDATTR3                                                 12338000
AMDPARDB EQU   IDAAMDSB+36                                              12339000
AMDMAXRR EQU   AMDSSRBA                                                 12340000
AMDNSLOT EQU   AMDHLRBA                                                 12341000
AMDLRECL EQU   IDAAMDSB+24                                              12342000
AMDCINV  EQU   IDAAMDSB+20                                              12343000
AMDFSCI  EQU   IDAAMDSB+16                                              12344000
AMDFSCA  EQU   IDAAMDSB+14                                              12345000
AMDCIPCA EQU   IDAAMDSB+12                                              12346000
AMDPCTCI EQU   IDAAMDSB+11                                              12347000
AMDPCTCA EQU   IDAAMDSB+10                                              12348000
AMDKEYLN EQU   IDAAMDSB+8                                               12349000
AMDRKP   EQU   IDAAMDSB+6                                               12350000
AMDAXRKP EQU   AMDNEST                                                  12351000
AMDLEN   EQU   IDAAMDSB+2                                               12352000
AMDSPAN  EQU   AMDATTR                                                  12353000
AMDRRDS  EQU   AMDATTR                                                  12354000
AMDRANGE EQU   AMDATTR                                                  12355000
AMDORDER EQU   AMDATTR                                                  12356000
AMDREPL  EQU   AMDATTR                                                  12357000
AMDSDT   EQU   AMDATTR                                                  12358000
AMDWCK   EQU   AMDATTR                                                  12359000
AMDDST   EQU   AMDATTR                                                  12360000
AMDSBID  EQU   IDAAMDSB                                                 12361000
ACBAPID  EQU   ACBCOMN+72                                               12362000
ACBCBMWA EQU   ACBCOMN+68                                               12363000
ACBLRECL EQU   ACBCOMN+62                                               12364000
ACBMSGLN EQU   ACBBLKSZ                                                 12365000
ACBBUFSP EQU   ACBCOMN+56                                               12366000
@NM00213 EQU   ACBUJFCB+1                                               12367000
ACBOPTN  EQU   ACBUJFCB                                                 12368000
@NM00212 EQU   ACBINFLG+1                                               12369000
ACBBYPSS EQU   ACBINFLG                                                 12370000
ACBSDS   EQU   ACBVVIC                                                  12371000
ACBUCRA  EQU   ACBINFLG                                                 12372000
ACBSCRA  EQU   ACBINFLG                                                 12373000
ACBCAT   EQU   ACBINFLG                                                 12374000
ACBIJRQE EQU   ACBINFLG                                                 12375000
ACBJEPS  EQU   ACBINFLG                                                 12376000
@NM00211 EQU   ACBINFLG                                                 12377000
ACBERFLG EQU   ACBCOMN+49                                               12378000
ACBBUSY  EQU   ACBIOSFG                                                 12379000
ACBLOCK  EQU   ACBEXFG                                                  12380000
@NM00210 EQU   ACBOFLGS                                                 12381000
ACBDSERR EQU   ACBOFLGS                                                 12382000
ACBOPEN  EQU   ACBOFLGS                                                 12383000
ACBEOV   EQU   ACBOFLGS                                                 12384000
@NM00209 EQU   ACBOFLGS                                                 12385000
ACBDEB   EQU   ACBDDNM+5                                                12386000
ACBERFL  EQU   ACBDDNM+4                                                12387000
ACBAM    EQU   ACBAMETH                                                 12388000
ACBINFL  EQU   ACBDDNM+2                                                12389000
ACBTIOT  EQU   ACBDDNM                                                  12390000
ACBUEL   EQU   ACBEXLST                                                 12391000
ACBPASSW EQU   ACBCOMN+32                                               12392000
ACBMSGAR EQU   ACBCOMN+28                                               12393000
@NM00208 EQU   ACBDSORG+1                                               12394000
ACBDORGA EQU   ACBDSORG+1                                               12395000
@NM00207 EQU   ACBDSORG                                                 12396000
ACBOPTJ  EQU   ACBDVIND                                                 12397000
ACBCRNRE EQU   ACBCROPS                                                 12398000
ACBCRNCK EQU   ACBCROPS                                                 12399000
ACBASA   EQU   ACBCCTYP                                                 12400000
@NM00206 EQU   ACBCCTYP                                                 12401000
ACBTRCID EQU   ACBCCTYP                                                 12402000
@NM00205 EQU   ACBRECFM                                                 12403000
ACBRECAF EQU   ACBRECFM                                                 12404000
ACBJBUF  EQU   ACBBUFPL+2                                               12405000
ACBMACR4 EQU   ACBBUFPL+1                                               12406000
@NM00204 EQU   ACBMACR3                                                 12407000
ACBNCFX  EQU   ACBMACR3                                                 12408000
ACBSIS   EQU   ACBMACR3                                                 12409000
ACBDFR   EQU   ACBMACR3                                                 12410000
ACBICI   EQU   ACBMACR3                                                 12411000
ACBGSR   EQU   ACBMACR3                                                 12412000
ACBLSR   EQU   ACBMACR3                                                 12413000
@NM00203 EQU   ACBMACR3                                                 12414000
ACBBUFNI EQU   ACBCOMN+18                                               12415000
ACBBUFND EQU   ACBCOMN+16                                               12416000
ACBSTRNO EQU   ACBCOMN+15                                               12417000
ACBBSTNO EQU   ACBCOMN+14                                               12418000
ACBAIX   EQU   ACBMACR2                                                 12419000
ACBDSN   EQU   ACBMACR2                                                 12420000
ACBRST   EQU   ACBMACR2                                                 12421000
ACBLOGON EQU   ACBMACR2                                                 12422000
ACBSKP   EQU   ACBMACR2                                                 12423000
@NM00202 EQU   ACBMACR2                                                 12424000
ACBUBF   EQU   ACBMACR1                                                 12425000
ACBOUT   EQU   ACBMACR1                                                 12426000
ACBIN    EQU   ACBMACR1                                                 12427000
ACBDIR   EQU   ACBMACR1                                                 12428000
ACBSEQ   EQU   ACBMACR1                                                 12429000
ACBBLK   EQU   ACBCNV                                                   12430000
ACBADD   EQU   ACBADR                                                   12431000
ACBKEY   EQU   ACBMACR1                                                 12432000
ACBINRTN EQU   ACBCOMN+8                                                12433000
ACBIBCT  EQU   ACBJWA                                                   12434000
ACBLEN2  EQU   ACBLENG2                                                 12435000
ACBSTYP  EQU   ACBCOMN+1                                                12436000
ACBID    EQU   ACBCOMN                                                  12437000
CAXCRACB EQU   IGGCAXWA+112                                             12438000
CAXJDE   EQU   IGGCAXWA+108                                             12439000
CAXCCA   EQU   IGGCAXWA+104                                             12440000
CAXOPEWA EQU   IGGCAXWA+100                                             12441000
COPACB   EQU   CAXOPLST+1                                               12442000
@NM00201 EQU   COPTS                                                    12443000
CENLST   EQU   COPTS                                                    12444000
@NM00200 EQU   CAXCNAM+22                                               12445000
CAXRADDN EQU   CAXCNAM+14                                               12446000
CAXRATEP EQU   CAXCNAM+10                                               12447000
CAXRACTS EQU   CAXCNAM+6                                                12448000
CAXVOLID EQU   CAXCNAM                                                  12449000
CAXRPL   EQU   IGGCAXWA+48                                              12450000
CAXRPLCT EQU   IGGCAXWA+46                                              12451000
CAXASID  EQU   IGGCAXWA+44                                              12452000
CAXFDCI  EQU   CAXCCR+9                                                 12453000
CAXCDCI  EQU   CAXCCR+6                                                 12454000
CAXNFCI  EQU   CAXCCR+3                                                 12455000
CAXHACI  EQU   CAXCCR                                                   12456000
CAXUCB   EQU   IGGCAXWA+28                                              12457000
CAXACB   EQU   IGGCAXWA+24                                              12458000
CAXDRWP  EQU   IGGCAXWA+20                                              12459000
CAXSCHWA EQU   IGGCAXWA+16                                              12460000
CAXATIOT EQU   IGGCAXWA+12                                              12461000
@NM00199 EQU   CAXFLG3                                                  12462000
CAXF3B6  EQU   CAXFLG3                                                  12463000
CAXF3B5  EQU   CAXFLG3                                                  12464000
@NM00198 EQU   CAXFLG3                                                  12465000
CAXF3ANE EQU   CAXFLG3                                                  12466000
CAXF3AT  EQU   CAXFLG3                                                  12467000
CAXF2VTU EQU   CAXFLG2                                                  12468000
CAXF2REC EQU   CAXFLG2                                                  12469000
CAXF2CA  EQU   CAXFLG2                                                  12470000
CAXF2CLR EQU   CAXFLG2                                                  12471000
CAXF2IOE EQU   CAXFLG2                                                  12472000
CAXF2NCR EQU   CAXFLG2                                                  12473000
CAXF2NDD EQU   CAXFLG2                                                  12474000
CAXF2DT  EQU   CAXFLG2                                                  12475000
CAXSCR   EQU   CAXFLGS                                                  12476000
CAXCMR   EQU   CAXFLGS                                                  12477000
CAXMCT   EQU   CAXFLGS                                                  12478000
CAXCMP   EQU   CAXFLGS                                                  12479000
CAXEOV   EQU   CAXFLGS                                                  12480000
CAXCLS   EQU   CAXFLGS                                                  12481000
CAXOPN   EQU   CAXFLGS                                                  12482000
CAXBLD   EQU   CAXFLGS                                                  12483000
CAXCHN   EQU   IGGCAXWA+4                                               12484000
@NM00197 EQU   IGGCAXWA+1                                               12485000
CAXID    EQU   IGGCAXWA                                                 12486000
CBSVPTR  EQU   CBSVSRT+4                                                12487000
CBSVUSE  EQU   CBSVSRT                                                  12488000
CBSCRTCB EQU   AMCBS+28                                                 12489000
CBSCRACA EQU   AMCBS+24                                                 12490000
CBSCAXCN EQU   AMCBS+20                                                 12491000
CBSMCUCB EQU   CBSCMP                                                   12492000
CBSCBP   EQU   AMCBS+12                                                 12493000
CBSMCSTA EQU   AMCBS+4                                                  12494000
CBSSIZ   EQU   AMCBS+2                                                  12495000
CBSID    EQU   AMCBS                                                    12496000
CVTLEVL  EQU   CVTRELNO+2                                               12497000
CVTNUMB  EQU   CVTRELNO                                                 12498000
CVTMDL   EQU   CVTFIX+250                                               12499000
@NM00196 EQU   CVTFIX+248                                               12500000
@NM00195 EQU   CVTFIX                                                   12501000
CVTRV482 EQU   CVTXTNT2+128                                             12502000
CVTRV481 EQU   CVTXTNT2+124                                             12503000
CVTRV480 EQU   CVTXTNT2+120                                             12504000
CVTRV479 EQU   CVTXTNT2+118                                             12505000
CVTRV478 EQU   CVTXTNT2+117                                             12506000
CVTRV477 EQU   CVTXTNT2+116                                             12507000
CVTRV476 EQU   CVTXTNT2+115                                             12508000
CVTRV475 EQU   CVTXTNT2+114                                             12509000
CVTRV474 EQU   CVTRV466                                                 12510000
CVTRV473 EQU   CVTRV466                                                 12511000
CVTRV472 EQU   CVTRV466                                                 12512000
CVTRV471 EQU   CVTRV466                                                 12513000
CVTRV470 EQU   CVTRV466                                                 12514000
CVTRV469 EQU   CVTRV466                                                 12515000
CVTRV468 EQU   CVTRV466                                                 12516000
CVTRV467 EQU   CVTRV466                                                 12517000
CVTRV465 EQU   CVTRV457                                                 12518000
CVTRV464 EQU   CVTRV457                                                 12519000
CVTRV463 EQU   CVTRV457                                                 12520000
CVTRV462 EQU   CVTRV457                                                 12521000
CVTRV461 EQU   CVTRV457                                                 12522000
CVTRV460 EQU   CVTRV457                                                 12523000
CVTRV459 EQU   CVTRV457                                                 12524000
CVTRV458 EQU   CVTRV457                                                 12525000
CVTRV456 EQU   CVTXTNT2+108                                             12526000
CVTRV455 EQU   CVTXTNT2+104                                             12527000
CVTRV454 EQU   CVTXTNT2+100                                             12528000
CVTRV453 EQU   CVTXTNT2+96                                              12529000
CVTRV452 EQU   CVTXTNT2+94                                              12530000
CVTRV451 EQU   CVTXTNT2+92                                              12531000
CVTRV450 EQU   CVTXTNT2+90                                              12532000
CVTRV449 EQU   CVTXTNT2+88                                              12533000
CVTRV448 EQU   CVTXTNT2+87                                              12534000
CVTRV447 EQU   CVTXTNT2+86                                              12535000
CVTRV446 EQU   CVTRV438                                                 12536000
CVTRV445 EQU   CVTRV438                                                 12537000
CVTRV444 EQU   CVTRV438                                                 12538000
CVTRV443 EQU   CVTRV438                                                 12539000
CVTRV442 EQU   CVTRV438                                                 12540000
CVTRV441 EQU   CVTRV438                                                 12541000
CVTRV440 EQU   CVTRV438                                                 12542000
CVTRV439 EQU   CVTRV438                                                 12543000
CVTRV437 EQU   CVTRV429                                                 12544000
CVTRV436 EQU   CVTRV429                                                 12545000
CVTRV435 EQU   CVTRV429                                                 12546000
CVTRV434 EQU   CVTRV429                                                 12547000
CVTRV433 EQU   CVTRV429                                                 12548000
CVTRV432 EQU   CVTRV429                                                 12549000
CVTRV431 EQU   CVTRV429                                                 12550000
CVTRV430 EQU   CVTRV429                                                 12551000
CVTRV428 EQU   CVTXTNT2+80                                              12552000
CVTRV427 EQU   CVTXTNT2+76                                              12553000
CVTRV426 EQU   CVTXTNT2+72                                              12554000
CVTRV425 EQU   CVTXTNT2+68                                              12555000
CVTATACT EQU   CVTATCVT                                                 12556000
CVTRV423 EQU   CVTXTNT2+62                                              12557000
CVTRV422 EQU   CVTXTNT2+60                                              12558000
CVTRV421 EQU   CVTXTNT2+58                                              12559000
CVTRV420 EQU   CVTXTNT2+56                                              12560000
CVTRV419 EQU   CVTXTNT2+55                                              12561000
CVTRV418 EQU   CVTXTNT2+54                                              12562000
CVTRV417 EQU   CVTRV409                                                 12563000
CVTRV416 EQU   CVTRV409                                                 12564000
CVTRV415 EQU   CVTRV409                                                 12565000
CVTRV414 EQU   CVTRV409                                                 12566000
CVTRV413 EQU   CVTRV409                                                 12567000
CVTRV412 EQU   CVTRV409                                                 12568000
CVTRV411 EQU   CVTRV409                                                 12569000
CVTRV410 EQU   CVTRV409                                                 12570000
CVTRV408 EQU   CVTRV400                                                 12571000
CVTRV407 EQU   CVTRV400                                                 12572000
CVTRV406 EQU   CVTRV400                                                 12573000
CVTRV405 EQU   CVTRV400                                                 12574000
CVTRV404 EQU   CVTRV400                                                 12575000
CVTRV403 EQU   CVTRV400                                                 12576000
CVTRV402 EQU   CVTRV400                                                 12577000
CVTRV401 EQU   CVTRV400                                                 12578000
CVTICB   EQU   CVTXTNT2+48                                              12579000
CVTSKTA  EQU   CVTXTNT2+44                                              12580000
CVTRSV99 EQU   CVTXTNT2+40                                              12581000
CVTRSV98 EQU   CVTXTNT2+36                                              12582000
CVTRSV97 EQU   CVTXTNT2+34                                              12583000
CVTRSV96 EQU   CVTXTNT2+32                                              12584000
CVTOLTEP EQU   CVTXTNT2+28                                              12585000
CVTQIDA  EQU   CVTQID+1                                                 12586000
CVTRSV95 EQU   CVTQID                                                   12587000
CVTRSV94 EQU   CVTXTNT2+20                                              12588000
CVTRSV93 EQU   CVTXTNT2+16                                              12589000
CVTRSV92 EQU   CVTXTNT2+12                                              12590000
CVTDEBVR EQU   CVTXTNT2+8                                               12591000
CVTRSV91 EQU   CVTXTNT2+6                                               12592000
CVTRSV9H EQU   CVTFLGBT                                                 12593000
CVTRSV9G EQU   CVTFLGBT                                                 12594000
CVTRSV9F EQU   CVTFLGBT                                                 12595000
CVTRSV9E EQU   CVTFLGBT                                                 12596000
CVTRSV9D EQU   CVTFLGBT                                                 12597000
CVTRSV9C EQU   CVTFLGBT                                                 12598000
CVTVME   EQU   CVTFLGBT                                                 12599000
CVTNPE   EQU   CVTFLGBT                                                 12600000
CVTNUCLS EQU   CVTXTNT2+4                                               12601000
CVTDSSVA EQU   CVTDSSV+1                                                12602000
CVTRSV89 EQU   CVTDSSV                                                  12603000
CVTRSV88 EQU   CVTXTNT1+8                                               12604000
CVTRSV87 EQU   CVTXTNT1+4                                               12605000
CVTFACHN EQU   CVTXTNT1                                                 12606000
CVTRV488 EQU   CVTMAP+412                                               12607000
CVTRV487 EQU   CVTMAP+408                                               12608000
CVTRV486 EQU   CVTMAP+404                                               12609000
CVTRV485 EQU   CVTMAP+400                                               12610000
CVTACTAP EQU   CVTMAP+396                                               12611000
CVTAUTH  EQU   CVTMAP+392                                               12612000
CVTATMCA EQU   CVTATMCT+1                                               12613000
CVTATMST EQU   CVTATMCT                                                 12614000
CVTRSV61 EQU   CVTMAP+384                                               12615000
CVTVOLT1 EQU   CVTVOLM1+1                                               12616000
CVTVOLI1 EQU   CVTVOLF1                                                 12617000
CVTSTOA  EQU   CVTMAP+376                                               12618000
CVTRSV58 EQU   CVTMAP+374                                               12619000
CVTRSV57 EQU   CVTMAP+372                                               12620000
CVTDDCE  EQU   CVTMAP+368                                               12621000
CVTPNWFR EQU   CVTMAP+364                                               12622000
CVTSMF   EQU   CVTMAP+360                                               12623000
CVTSULK  EQU   CVTMAP+358                                               12624000
CVTSLKO  EQU   CVTSYSK                                                  12625000
CVTSLKP  EQU   CVTSYSK                                                  12626000
CVTSLKQ  EQU   CVTSYSK                                                  12627000
CVTSLKR  EQU   CVTSYSK                                                  12628000
CVTRSV56 EQU   CVTSYSK                                                  12629000
CVTRSV55 EQU   CVTSYSK                                                  12630000
CVTRSV54 EQU   CVTSYSK                                                  12631000
CVTRSV53 EQU   CVTSYSK                                                  12632000
CVTRSV52 EQU   CVTA1F1                                                  12633000
CVTRSV51 EQU   CVTA1F1                                                  12634000
CVTRSV50 EQU   CVTA1F1                                                  12635000
CVTRSV49 EQU   CVTA1F1                                                  12636000
CVTRSV48 EQU   CVTA1F1                                                  12637000
CVTRSV47 EQU   CVTA1F1                                                  12638000
CVTSRSW  EQU   CVTA1F1                                                  12639000
CVTPFSW  EQU   CVTA1F1                                                  12640000
CVTPCVT  EQU   CVTMAP+352                                               12641000
CVTRSV46 EQU   CVTMAP+344                                               12642000
CVTRSV45 EQU   CVTMAP+340                                               12643000
CVTRSV44 EQU   CVTMAP+338                                               12644000
CVTRSV43 EQU   CVTMAP+336                                               12645000
CVTHJESA EQU   CVTHJES+1                                                12646000
CVTRSV42 EQU   CVTHJES                                                  12647000
CVTEXT2A EQU   CVTEXT2+1                                                12648000
CVTRSV41 EQU   CVTEXT2                                                  12649000
CVTAPFA  EQU   CVTAPF+1                                                 12650000
CVTRSV40 EQU   CVTAPF                                                   12651000
CVTRV518 EQU   CVTINTLA                                                 12652000
CVTRV517 EQU   CVTERPV                                                  12653000
CVTEORM  EQU   CVTMAP+312                                               12654000
CVTMCHPR EQU   CVTMAP+308                                               12655000
CVTTZ    EQU   CVTMAP+304                                               12656000
CVTJEPS  EQU   CVTMAP+300                                               12657000
CVTJESCT EQU   CVTMAP+296                                               12658000
CVTMODE  EQU   CVTMAP+292                                               12659000
CVTPTRV  EQU   CVTMAP+288                                               12660000
CVTREAL  EQU   CVTMAP+284                                               12661000
CVTRSV39 EQU   CVTMAP+280                                               12662000
CVTRSV38 EQU   CVTMAP+276                                               12663000
CVTDMSRA EQU   CVTDMSR+1                                                12664000
CVTRV634 EQU   CVTDMSRF                                                 12665000
CVTRV633 EQU   CVTDMSRF                                                 12666000
CVTRV632 EQU   CVTDMSRF                                                 12667000
CVTRV631 EQU   CVTDMSRF                                                 12668000
CVTRV630 EQU   CVTDMSRF                                                 12669000
CVTRV629 EQU   CVTDMSRF                                                 12670000
CVTUDUMP EQU   CVTDMSRF                                                 12671000
CVTSDUMP EQU   CVTDMSRF                                                 12672000
CVTQMSGA EQU   CVTQMSG+1                                                12673000
CVTRSV36 EQU   CVTQMSG                                                  12674000
CVTAMFF  EQU   CVTMAP+264                                               12675000
CVTPURGA EQU   CVTPURG+1                                                12676000
CVTRSV35 EQU   CVTPURG                                                  12677000
CVTATERA EQU   CVTATER+1                                                12678000
CVTSYST  EQU   CVTATER                                                  12679000
CVTVOLT2 EQU   CVTTAT                                                   12680000
CVTVOLI2 EQU   CVTVOLF2                                                 12681000
CVTAQAVB EQU   CVTAQAVT+1                                               12682000
CVTRSV34 EQU   CVTTCMFG                                                 12683000
CVTRSV33 EQU   CVTTCMFG                                                 12684000
CVTRSV32 EQU   CVTTCMFG                                                 12685000
CVTRSV31 EQU   CVTTCMFG                                                 12686000
CVTRSV30 EQU   CVTTCMFG                                                 12687000
CVTRSV29 EQU   CVTTCMFG                                                 12688000
CVTRSV28 EQU   CVTTCMFG                                                 12689000
CVTTCRDY EQU   CVTTCMFG                                                 12690000
CVTGTFA  EQU   CVTGTF+1                                                 12691000
CVTRSV27 EQU   CVTGTFST                                                 12692000
CVTRNIO  EQU   CVTGTFST                                                 12693000
CVTUSR   EQU   CVTGTFST                                                 12694000
CVTRV318 EQU   CVTFORM                                                  12695000
CVTRV317 EQU   CVTTMODE                                                 12696000
CVTRV316 EQU   CVTSTATE                                                 12697000
CVTRV315 EQU   CVTGTFS                                                  12698000
CVTGTFAV EQU   CVTGTFS                                                  12699000
CVT0SCR1 EQU   CVTMAP+232                                               12700000
CVTRV515 EQU   CVTMAP+228                                               12701000
CVTRMS   EQU   CVTMAP+224                                               12702000
CVTPATCH EQU   CVTMAP+220                                               12703000
CVTTSCE  EQU   CVTMAP+216                                               12704000
CVTLNKSC EQU   CVTMAP+214                                               12705000
CVTQABST EQU   CVTMAP+212                                               12706000
CVTMDLDS EQU   CVTMAP+208                                               12707000
CVTUSER  EQU   CVTMAP+204                                               12708000
CVTABEND EQU   CVTMAP+200                                               12709000
CVTSMCA  EQU   CVTMAP+196                                               12710000
CVTRSV18 EQU   CVTMAP+192                                               12711000
CVTQLPAQ EQU   CVTMAP+188                                               12712000
CVTQCDSR EQU   CVTMAP+184                                               12713000
CVTRSV17 EQU   CVTOPTB                                                  12714000
CVTRSV16 EQU   CVTOPTB                                                  12715000
CVTFP    EQU   CVTOPTB                                                  12716000
CVTAPTHR EQU   CVTOPTB                                                  12717000
CVTNLOG  EQU   CVTOPTB                                                  12718000
CVTTOD   EQU   CVTOPTB                                                  12719000
CVTCTIMS EQU   CVTOPTB                                                  12720000
CVTPROT  EQU   CVTOPTB                                                  12721000
CVTXPFP  EQU   CVTOPTA                                                  12722000
CVTASCII EQU   CVTOPTA                                                  12723000
CVTRSV13 EQU   CVTOPTA                                                  12724000
CVTRSV12 EQU   CVTOPTA                                                  12725000
CVTNIP   EQU   CVTOPTA                                                  12726000
CVTDDR   EQU   CVTOPTA                                                  12727000
CVTAPR   EQU   CVTOPTA                                                  12728000
CVTCCH   EQU   CVTOPTA                                                  12729000
CVTSNCTR EQU   CVTMAP+180                                               12730000
CVTQMWR  EQU   CVTMAP+176                                               12731000
CVTQOCR  EQU   CVTMAP+172                                               12732000
CVT1EF00 EQU   CVTMAP+168                                               12733000
CVTMZ00  EQU   CVTMAP+164                                               12734000
CVTHEAD  EQU   CVTMAP+160                                               12735000
CVTRSV11 EQU   CVTMAP+156                                               12736000
CVT0PT01 EQU   CVTMAP+152                                               12737000
CVTMSER  EQU   CVTMAP+148                                               12738000
CVTRV516 EQU   CVTIERLC                                                 12739000
CVTILCH  EQU   CVTMAP+140                                               12740000
CVT0DS   EQU   CVTMAP+136                                               12741000
CVTFBOSV EQU   CVTMAP+132                                               12742000
CVTNUCB  EQU   CVTMAP+128                                               12743000
CVTIXAVL EQU   CVTMAP+124                                               12744000
CVTIOQET EQU   CVTMAP+120                                               12745000
CVTDCBA  EQU   CVTMAP+117                                               12746000
CVTMVS2  EQU   CVTDCB                                                   12747000
CVT6DAT  EQU   CVTDCB                                                   12748000
CVT4MPS  EQU   CVTDCB                                                   12749000
CVTRSV09 EQU   CVTDCB                                                   12750000
CVT4MS1  EQU   CVTDCB                                                   12751000
CVT2SPS  EQU   CVTDCB                                                   12752000
CVT1SSS  EQU   CVTDCB                                                   12753000
CVTRSV08 EQU   CVTDCB                                                   12754000
CVTSTB   EQU   CVTMAP+112                                               12755000
CVTQTD00 EQU   CVTMAP+108                                               12756000
CVTQTE00 EQU   CVTMAP+104                                               12757000
CVTCUCB  EQU   CVTMAP+100                                               12758000
CVTSJQ   EQU   CVTMAP+96                                                12759000
CVTPBLDL EQU   CVTMAP+92                                                12760000
CVTTPC   EQU   CVTMAP+88                                                12761000
CVTSVDCB EQU   CVTMAP+84                                                12762000
CVTBRET  EQU   CVTMAP+82                                                12763000
CVTEXIT  EQU   CVTMAP+80                                                12764000
CVT0FN00 EQU   CVTMAP+76                                                12765000
CVTDARA  EQU   CVTDAR+1                                                 12766000
CVTRSV07 EQU   CVTFLGS1                                                 12767000
CVTRSV06 EQU   CVTFLGS1                                                 12768000
CVTRSV05 EQU   CVTFLGS1                                                 12769000
CVTRSV04 EQU   CVTFLGS1                                                 12770000
CVTRSV03 EQU   CVTFLGS1                                                 12771000
CVTRSV02 EQU   CVTFLGS1                                                 12772000
CVTRSV01 EQU   CVTFLGS1                                                 12773000
CVTDMPLK EQU   CVTFLGS1                                                 12774000
CVTXITP  EQU   CVTMAP+68                                                12775000
CVTZDTAB EQU   CVTMAP+64                                                12776000
CVTMSLT  EQU   CVTMAP+60                                                12777000
CVTDATE  EQU   CVTMAP+56                                                12778000
CVTBTERM EQU   CVTMAP+52                                                12779000
CVTSYSAD EQU   CVTMAP+48                                                12780000
CVTXTLER EQU   CVTMAP+44                                                12781000
CVTILK2  EQU   CVTMAP+40                                                12782000
CVTILK1  EQU   CVTMAP+36                                                12783000
CVTPRLTV EQU   CVTMAP+32                                                12784000
CVTPCNVT EQU   CVTMAP+28                                                12785000
CVT0VL00 EQU   CVTMAP+24                                                12786000
CVTXAPG  EQU   CVTMAP+20                                                12787000
CVTBUF   EQU   CVTMAP+16                                                12788000
CVTJOB   EQU   CVTMAP+12                                                12789000
CVTLINK  EQU   CVTMAP+8                                                 12790000
CVT0EF00 EQU   CVTMAP+4                                                 12791000
CVTTCBP  EQU   CVTMAP                                                   12792000
CVT      EQU   CVTMAP                                                   12793000
CTGFVWKA EQU   CTGFV+88                                                 12794000
CTGFVPWD EQU   CTGFV+84                                                 12795000
CTGFVNAM EQU   CTGFV+80                                                 12796000
CTGFVUPG EQU   CTGFVGAT                                                 12797000
CTGFVEXT EQU   CTGFVLMT                                                 12798000
CTGFVLRS EQU   CTGFV+68                                                 12799000
CTGFVBUF EQU   CTGFV+64                                                 12800000
CTGFVATR EQU   CTGFV+60                                                 12801000
CTGFVFSN EQU   CTGFVAMD                                                 12802000
CTGFVTTR EQU   CTGFVSPC                                                 12803000
CTGFVDVT EQU   CTGFV+48                                                 12804000
CTGFVRNG EQU   CTGFV+44                                                 12805000
CTGFVVLT EQU   CTGFV+40                                                 12806000
CTGFVCRE EQU   CTGFV+36                                                 12807000
CTGFVEXP EQU   CTGFV+32                                                 12808000
CTGFVOWN EQU   CTGFV+28                                                 12809000
CTGFVSTY EQU   CTGFV+24                                                 12810000
CTGFVENT EQU   CTGFV+20                                                 12811000
CTGFVIND EQU   CTGFV+16                                                 12812000
CTGFVVCH EQU   CTGFV+12                                                 12813000
CTGFVICH EQU   CTGFV+8                                                  12814000
CTGFVDCH EQU   CTGFV+4                                                  12815000
@NM00194 EQU   CTGFV+3                                                  12816000
CTGFVELM EQU   CTGFV+2                                                  12817000
@NM00193 EQU   CTGFVPRO                                                 12818000
CTGFVDRC EQU   CTGFVPRO                                                 12819000
CTGFVNDC EQU   CTGFVPRO                                                 12820000
CTGFVRVL EQU   CTGFVPRO                                                 12821000
CTGFVAVL EQU   CTGFVPRO                                                 12822000
CTGFVTYP EQU   CTGFV                                                    12823000
CTGFLCHN EQU   CTGFL+12                                                 12824000
CTGFLDWA EQU   CTGFL+4                                                  12825000
CTGFLDTS EQU   CTGFLDRE                                                 12826000
@NM00192 EQU   CTGFLDRE                                                 12827000
CTGFLDGC EQU   CTGFL+2                                                  12828000
CTGFLDCD EQU   CTGFL+1                                                  12829000
@NM00190 EQU   CTGFBFLG                                                 12830000
CTGNGDSN EQU   CTGFBFLG                                                 12831000
CTGGDGB  EQU   CTGFBFLG                                                 12832000
CTGKEEP  EQU   CTGFBFLG                                                 12833000
CTGPAR   EQU   CTGFBFLG                                                 12834000
CTGFDBK  EQU   CTGNEWNM                                                 12835000
@NM00189 EQU   CTGDSORG                                                 12836000
CTGOPTNS EQU   CTGDSORG                                                 12837000
CTGCVOL  EQU   CTGCAT                                                   12838000
@NM00188 EQU   CTGOPTN4                                                 12839000
CTGBYPMT EQU   CTGOPTN4                                                 12840000
@NM00187 EQU   CTGOPTN4                                                 12841000
CTGNPROF EQU   CTGOPTN4                                                 12842000
CTGDOCAT EQU   CTGOPTN4                                                 12843000
CTGLBASE EQU   CTGOPTN4                                                 12844000
CTGNUM   EQU   CTGOPTN3                                                 12845000
CTGSRH   EQU   CTGOPTN3                                                 12846000
CTGGDGL  EQU   CTGOPTN3                                                 12847000
CTGSUPLT EQU   CTGOPTN3                                                 12848000
@NM00186 EQU   CTGOPTN2                                                 12849000
CTGSCR   EQU   CTGOPTN2                                                 12850000
CTGOVRID EQU   CTGOPTN2                                                 12851000
CTGDISC  EQU   CTGOPTN2                                                 12852000
CTGUCRAX EQU   CTGGTNXT                                                 12853000
CTGSWAP  EQU   CTGRCATN                                                 12854000
CTGGTALL EQU   CTGREL                                                   12855000
CTGNSVS  EQU   CTGEXT                                                   12856000
CTGGENLD EQU   CTGOPTN1                                                 12857000
CTGREAD  EQU   CTGOPTN1                                                 12858000
CTGUPD   EQU   CTGOPTN1                                                 12859000
CTGCI    EQU   CTGOPTN1                                                 12860000
CTGMAST  EQU   CTGOPTN1                                                 12861000
CTGBYPSS EQU   CTGOPTN1                                                 12862000
GDGLVL   EQU   GENLVLS+2                                                12863000
@NM00185 EQU   GENLVLS                                                  12864000
@NM00184 EQU   GDGRCD+108                                               12865000
GDGLIMIT EQU   GDGRCD+107                                               12866000
@NM00183 EQU   GDGRCD                                                   12867000
@NM00182 EQU   VOLGO+34                                                 12868000
@NM00181 EQU   VOLGO                                                    12869000
@NM00176 EQU   RGATTSG1                                                 12870000
RGATSUP1 EQU   RGATTSG1                                                 12871000
@NM00175 EQU   RGATTR1                                                  12872000
RGATTUPG EQU   RGATTR1                                                  12873000
SPCROUND EQU   SPCOPTNS                                                 12874000
SPCALXRQ EQU   SPCOPTNS                                                 12875000
SPCMXIGR EQU   SPCOPTNS                                                 12876000
SPCCNTIG EQU   SPCOPTNS                                                 12877000
@NM00174 EQU   SPCOPTNS                                                 12878000
SPCRQTYP EQU   SPCOPTNS                                                 12879000
SPCSECDQ EQU   SPACEPRM+3                                               12880000
SPCPRIMQ EQU   SPACEPRM                                                 12881000
DSSUMTT  EQU   DSDIR+9                                                  12882000
DSCRETS  EQU   DSDIR+5                                                  12883000
DSIDNO   EQU   DSDIR+2                                                  12884000
@NM00173 EQU   DSDIR                                                    12885000
ASGDGLVL EQU   ASGOGDG+6                                                12886000
@NM00172 EQU   ASGOGDG+2                                                12887000
@NM00171 EQU   ASGOGDG                                                  12888000
ASCI2    EQU   ASG2+1                                                   12889000
ASTYPE2  EQU   ASG2                                                     12890000
ASCI     EQU   ASG1+1                                                   12891000
ASTYPE   EQU   ASG1                                                     12892000
@NM00170 EQU   ASGO                                                     12893000
CCRRBAS  EQU   CCR+57                                                   12894000
CCRID    EQU   CCR+44                                                   12895000
CCRKEY   EQU   CCR                                                      12896000
CEXT     EQU   CTGRBASE+135                                             12897000
CDOSUINF EQU   CTGRBASE+133                                             12898000
CLRECL   EQU   CTGRBASE+129                                             12899000
CHIU     EQU   CTGRBASE+121                                             12900000
CSORT    EQU   CSPACPRM+6                                               12901000
CPRIM    EQU   CSPACPRM                                                 12902000
CBUF     EQU   CTGRBASE+110                                             12903000
@NM00164 EQU   COPEN                                                    12904000
COPENDS  EQU   COPEN                                                    12905000
CNUS     EQU   CATTR2                                                   12906000
@NM00163 EQU   CATTR2                                                   12907000
CATTRSSH EQU   CATTR2                                                   12908000
CATTRISH EQU   CATTR2                                                   12909000
CTRKOV   EQU   CATTR1                                                   12910000
CTEMP    EQU   CATTR1                                                   12911000
CINHIB   EQU   CATTR1                                                   12912000
CRECOV   EQU   CATTR1                                                   12913000
CERASE   EQU   CATTR1                                                   12914000
CREUSE   EQU   CATTR1                                                   12915000
CUNIQ    EQU   CATTR1                                                   12916000
CSP      EQU   CATTR1                                                   12917000
CEXP     EQU   CTGRBASE+104                                             12918000
CCRE     EQU   CTGRBASE+101                                             12919000
@NM00162 EQU   CTGRBASE                                                 12920000
CNTVAR   EQU   CNTRLINF                                                 12921000
VARINFO  EQU   VARFIELD+2                                               12922000
REPGOPT  EQU   REPCNTRL+6                                               12923000
REPCNT   EQU   REPCNTRL+5                                               12924000
@NM00161 EQU   EXTRCDPT+3                                               12925000
EXTGOCI  EQU   EXTRCDPT                                                 12926000
NREPLF   EQU   CATRCD+48                                                12927000
NREPCV   EQU   CATRCD+47                                                12928000
@NM00160 EQU   CATRCD+26                                                12929000
RCDDICTS EQU   CATRCD+22                                                12930000
RCDRELID EQU   CATRCD+4                                                 12931000
RCDKEYTY EQU   CATRCD                                                   12932000
CATGOGC  EQU   CATGOGC1                                                 12933000
CATGODEL EQU   CATGOGC1                                                 12934000
CATGOEXT EQU   CATGOGC1                                                 12935000
CATGODSP EQU   CATGOCI+1                                                12936000
@NM00159 EQU   CATGOFLG                                                 12937000
SNNN     EQU   SNTTNN+2                                                 12938000
SNTT     EQU   SNTTNN                                                   12939000
SDSSUMTT EQU   SNDSDIR+32                                               12940000
SDSCRETS EQU   SNDSDIR+28                                               12941000
SDSIDNO  EQU   SNDSDIR+25                                               12942000
@NM00158 EQU   SDSIDFLG                                                 12943000
SDSEXT   EQU   SDSIDFLG                                                 12944000
@NM00157 EQU   SNDSDIR                                                  12945000
SNLBM    EQU   SNVSBM+28                                                12946000
SNABM    EQU   SNVSBM+24                                                12947000
@NM00156 EQU   SNVSBM                                                   12948000
@NM00155 EQU   SNEXTENT+16                                              12949000
@NM00154 EQU   SNEXTENT+12                                              12950000
NTR      EQU   SNEXTENT+10                                              12951000
@NM00153 EQU   SNEXTENT+8                                               12952000
@NM00152 EQU   SNEXTENT+6                                               12953000
SHH      EQU   SNEXTENT+4                                               12954000
SCC      EQU   SNEXTENT+2                                               12955000
SS       EQU   SNEXTENT                                                 12956000
SNEXTI   EQU   SNVGO+42                                                 12957000
SNTTNNMC EQU   SNVGO+41                                                 12958000
SNTTNNC  EQU   SNVGO+40                                                 12959000
SNTTNNX  EQU   SNVGO+39                                                 12960000
SNVGOSS  EQU   SNVGO+37                                                 12961000
SDSDIRSN EQU   SNVGO+35                                                 12962000
SNSSWD   EQU   SITYPEXT                                                 12963000
SNVOLSER EQU   SNVGO+28                                                 12964000
SNDEVTYP EQU   SNVGO+24                                                 12965000
@NM00151 EQU   SNVGO                                                    12966000
SNNAME2  EQU   SNGLEV+1                                                 12967000
SNTYPE2  EQU   SNGLEV                                                   12968000
SNNAME   EQU   SNASSOC+25                                               12969000
SNTYPE   EQU   SNASSOC+24                                               12970000
@NM00150 EQU   SNASSOC                                                  12971000
SSPEXTNN EQU   SSPEXTNT                                                 12972000
SNODSPXT EQU   SNVDATA+9                                                12973000
SNVSPCAT EQU   SSPHDFLG                                                 12974000
@NM00149 EQU   SSPHDFLG                                                 12975000
SNVSPUNQ EQU   SSPHDFLG                                                 12976000
SDSCBTS  EQU   SNVDATA                                                  12977000
SNVGOEL  EQU   SNFIXED+20                                               12978000
SNEGOP   EQU   SNFIXED+16                                               12979000
SNECI    EQU   SNFIXED+13                                               12980000
SNAGOP   EQU   SNFIXED+11                                               12981000
SNACI    EQU   SNFIXED+8                                                12982000
SNGOP    EQU   SNFIXED+6                                                12983000
SNCI     EQU   SNFIXED+3                                                12984000
SNSN     EQU   SNFIXED+1                                                12985000
@NM00148 EQU   SNFLAG                                                   12986000
SNFINC   EQU   SNFLAG                                                   12987000
SNFMOD   EQU   SNFLAG                                                   12988000
SNFPROC  EQU   SNFLAG                                                   12989000
SNFALT   EQU   SNFLAG                                                   12990000
SNFDEL   EQU   SNFLAG                                                   12991000
SNFUSE   EQU   SNFLAG                                                   12992000
RSFCILST EQU   RSFSNVT+28                                               12993000
RSFCADR  EQU   RSFSNVT+24                                               12994000
RSFABMAP EQU   RSFSNVT+20                                               12995000
RSFLENBM EQU   RSFSNVT+14                                               12996000
RSFCNDX  EQU   RSFSNVT+6                                                12997000
RSFHNDX  EQU   RSFSNVT+4                                                12998000
RSFGCODE EQU   RSFSNVT+2                                                12999000
@NM00147 EQU   RSFLAGS                                                  13000000
RSFINVTY EQU   RSFLAGS                                                  13001000
RSFNRF   EQU   RSFLAGS                                                  13002000
@NM00146 EQU   RSFSNVT                                                  13003000
GDGLVLT  EQU   GDGENT                                                   13004000
@NM00145 EQU   GDGFLG                                                   13005000
GDGWRAP  EQU   GDGFLG                                                   13006000
GDGPAK   EQU   GDGLHEAD+22                                              13007000
GDGMVL   EQU   GDGLHEAD+20                                              13008000
GDGFRE   EQU   GDGLHEAD+18                                              13009000
GDGFRS   EQU   GDGLHEAD+16                                              13010000
GDGTOE   EQU   GDGLHEAD+14                                              13011000
GDGTOS   EQU   GDGLHEAD+12                                              13012000
GDGPLEV  EQU   GDGLHEAD+10                                              13013000
GDGVALB  EQU   GDGLHEAD+8                                               13014000
GDGCNT   EQU   GDGLHEAD+6                                               13015000
GDGLMT   EQU   GDGLHEAD+4                                               13016000
GDGVAL   EQU   GDGLHEAD                                                 13017000
DITDGML  EQU   DITABE+12                                                13018000
DITCITAB EQU   @NM00143+1                                               13019000
@NM00144 EQU   @NM00143                                                 13020000
@NM00142 EQU   @NM00140+2                                               13021000
DITOSN   EQU   DITVSN+1                                                 13022000
@NM00141 EQU   DITVSN                                                   13023000
DITOFS   EQU   DITABE+2                                                 13024000
DITFB256 EQU   DITFLB                                                   13025000
@NM00139 EQU   DITFLB                                                   13026000
DITFBDGO EQU   DITFLB                                                   13027000
@NM00138 EQU   DITFLB                                                   13028000
DITFBAS2 EQU   DITFLB                                                   13029000
DITFBAS1 EQU   DITFLB                                                   13030000
DITFBGOE EQU   DITFLB                                                   13031000
DITFBHEP EQU   DITFLB                                                   13032000
@NM00137 EQU   DITFA                                                    13033000
@NM00136 EQU   DITFA                                                    13034000
@NM00135 EQU   DITFA                                                    13035000
@NM00134 EQU   DITFA                                                    13036000
DITFADEL EQU   DITFA                                                    13037000
DITFARAS EQU   DITFA                                                    13038000
DITFAVER EQU   DITFA                                                    13039000
@NM00133 EQU   DITFA                                                    13040000
GDIENTRY EQU   GDITS+12                                                 13041000
GDITHEAD EQU   GDITS                                                    13042000
CITEXTBA EQU   @NM00131+1                                               13043000
@NM00132 EQU   @NM00131                                                 13044000
CITEXTCH EQU   @NM00129+1                                               13045000
@NM00130 EQU   @NM00129                                                 13046000
CITDITAB EQU   @NM00128+1                                               13047000
CITDICNT EQU   @NM00128                                                 13048000
CITRCIN  EQU   @NM00127+1                                               13049000
CITTYPE  EQU   @NM00127                                                 13050000
CITCIN   EQU   CITABE+1                                                 13051000
CITFADGO EQU   CITFLA                                                   13052000
CITFAINV EQU   CITFLA                                                   13053000
CITFASCA EQU   CITFLA                                                   13054000
CITFAGOE EQU   CITFLA                                                   13055000
CITFAHEP EQU   CITFLA                                                   13056000
CITFARAS EQU   CITFLA                                                   13057000
CITFAVER EQU   CITFLA                                                   13058000
@NM00126 EQU   CITFLA                                                   13059000
CITABENT EQU   GCITS+12                                                 13060000
GCITHEAD EQU   GCITS                                                    13061000
PTASCIT1 EQU   PTASOE+4                                                 13062000
PTASDIT1 EQU   PTASOE                                                   13063000
PTLDITID EQU   PTLOC+19                                                 13064000
@NM00125 EQU   PTLDITFB                                                 13065000
PTLFBDGO EQU   PTLDITFB                                                 13066000
@NM00124 EQU   PTLDITFB                                                 13067000
PTLFBAS2 EQU   PTLDITFB                                                 13068000
PTLFBAS1 EQU   PTLDITFB                                                 13069000
PTLFBGOE EQU   PTLDITFB                                                 13070000
PTLFBHEP EQU   PTLDITFB                                                 13071000
PTLSN    EQU   PTLOC+16                                                 13072000
PTLNDIT  EQU   @NM00122+1                                               13073000
@NM00123 EQU   @NM00122                                                 13074000
PTLCDIT  EQU   PTLOC+8                                                  13075000
PTLCCIT  EQU   PTLOC+4                                                  13076000
PTLBCITX EQU   @NM00120+1                                               13077000
@NM00121 EQU   @NM00120                                                 13078000
@NM00119 EQU   PTF2                                                     13079000
PTF2KSDS EQU   PTF2                                                     13080000
PTF1ENDA EQU   PTF1                                                     13081000
PTF1ENDG EQU   PTF1                                                     13082000
PTF1END  EQU   PTF1                                                     13083000
PTF1CKVL EQU   PTF1                                                     13084000
PTF1DELT EQU   PTF1                                                     13085000
PTF1OK   EQU   PTF1                                                     13086000
PTF1HIT2 EQU   PTF1                                                     13087000
PTF1HIT  EQU   PTF1                                                     13088000
PTCRAVL  EQU   PTYPEDTA+184                                             13089000
@NM00118 EQU   PTXFLAGS+1                                               13090000
@NM00117 EQU   PTXFLAG1                                                 13091000
PTXEXIST EQU   PTXFLAG1                                                 13092000
PTXEND   EQU   PTXFLAG1                                                 13093000
PTXX2C   EQU   PTXALIAS+28                                              13094000
PTXX1C   EQU   PTXALIAS+26                                              13095000
PTXX0C   EQU   PTXALIAS+24                                              13096000
PTXCITX1 EQU   PTXALIAS+20                                              13097000
PTXX1X0D EQU   PTXALIAS+16                                              13098000
PTXX1X2D EQU   PTXALIAS+12                                              13099000
PTXX1AUD EQU   PTXALIAS+8                                               13100000
PTXX0X1D EQU   PTXALIAS+4                                               13101000
PTXUX1D  EQU   PTXALIAS                                                 13102000
PTVDSSNT EQU   PTVERDI+28                                               13103000
@NM00116 EQU   PTVERDI+26                                               13104000
PTVCNT   EQU   PTVERDI+24                                               13105000
PTVDIASS EQU   PTVDI+8                                                  13106000
PTVDISNT EQU   PTVDI+4                                                  13107000
PTVDICIT EQU   PTVDI                                                    13108000
PTBASE   EQU   PTYPEDTA+116                                             13109000
PTINDX5  EQU   PTINDX+10                                                13110000
PTINDX4  EQU   PTINDX+8                                                 13111000
PTINDXV  EQU   PTINDX+6                                                 13112000
PTINDX3  EQU   PTINDX+4                                                 13113000
PTINDX2  EQU   PTINDX+2                                                 13114000
PTINDX1  EQU   PTINDX                                                   13115000
PTASSCIT EQU   PTASSOE+4                                                13116000
PTASSDIT EQU   PTASSOE                                                  13117000
PTASSOC  EQU   PTASSO                                                   13118000
PTDITWK  EQU   PTGDIT+20                                                13119000
PTDITF   EQU   PTGDIT+16                                                13120000
PTDITNC  EQU   @NM00114+1                                               13121000
@NM00115 EQU   @NM00114                                                 13122000
PTDITL   EQU   @NM00112+1                                               13123000
@NM00113 EQU   @NM00112                                                 13124000
PTDITI   EQU   @NM00110+1                                               13125000
@NM00111 EQU   @NM00110                                                 13126000
PTCITWK  EQU   PTGCIT+20                                                13127000
PTCITF   EQU   PTGCIT+16                                                13128000
PTCITNC  EQU   @NM00108+1                                               13129000
@NM00109 EQU   @NM00108                                                 13130000
PTCITL   EQU   @NM00106+1                                               13131000
@NM00107 EQU   @NM00106                                                 13132000
PTCITI   EQU   @NM00104+1                                               13133000
@NM00105 EQU   @NM00104                                                 13134000
PTHEAD   EQU   PTWORK                                                   13135000
TENTRY   EQU   TABHEAD+12                                               13136000
TABCURR  EQU   THEAD+10                                                 13137000
TABMAXT  EQU   THEAD+8                                                  13138000
TABFORW  EQU   THEAD+4                                                  13139000
TABBACKW EQU   THEAD                                                    13140000
TABUG    EQU   TABANCHR+24                                              13141000
TABNU    EQU   @NM00102+1                                               13142000
@NM00103 EQU   @NM00102                                                 13143000
TABEN    EQU   TABANCHR+18                                              13144000
@NM00101 EQU   TABANCHR+16                                              13145000
TABSIZ   EQU   TABANCHR+12                                              13146000
TABL     EQU   TABANCHR+4                                               13147000
TABF     EQU   TABANCHR                                                 13148000
TASSEN   EQU   TASSO+4                                                  13149000
TASSNENT EQU   TASSO+2                                                  13150000
@NM00100 EQU   TASSO+1                                                  13151000
TASSID   EQU   TASSO                                                    13152000
TASSRAB  EQU   TASSENT+2                                                13153000
@NM00099 EQU   TASSFL1                                                  13154000
TASSSET  EQU   TASSFL1                                                  13155000
TASSIS   EQU   TASSFL1                                                  13156000
TASSVER  EQU   TASSFL1                                                  13157000
TASSSCAN EQU   TASSFL1                                                  13158000
TASSREAD EQU   TASSFL1                                                  13159000
TASSTYPE EQU   TASSENT                                                  13160000
RSCNHH2  EQU   RSCNCCHH+6                                               13161000
RSCNCC2  EQU   RSCNCCHH+4                                               13162000
RSCNHH1  EQU   RSCNCCHH+2                                               13163000
RSCNCC1  EQU   RSCNCCHH                                                 13164000
RECPTRCD EQU   RECIOWA+978                                              13165000
UCATWRET EQU   UCATWA+4                                                 13166000
UCATWRLN EQU   UCATWA+2                                                 13167000
RSSCRLST EQU   RECIOWA+872                                              13168000
ALLVLSR  EQU   ALLVL+4                                                  13169000
ALLVLLN  EQU   ALLVL+2                                                  13170000
ALLVLC   EQU   ALLVL                                                    13171000
ALLULNM  EQU   ALLUL+4                                                  13172000
ALLULLN  EQU   ALLUL+2                                                  13173000
ALLULC   EQU   ALLUL                                                    13174000
RSALLAGL EQU   RECIOWA+632                                              13175000
RSOPNAGL EQU   RECIOWA+248                                              13176000
CATHRMB  EQU   RECIOWA+192                                              13177000
CATLRMB  EQU   RECIOWA+180                                              13178000
CRARMB   EQU   RECIOWA+168                                              13179000
WFSRMB   EQU   RECIOWA+156                                              13180000
WFDRMB   EQU   RECIOWA+120                                              13181000
UIOVLN   EQU   UIOVOL+2                                                 13182000
UIOVID   EQU   UIOVOL                                                   13183000
UIODLN   EQU   UIODSN+2                                                 13184000
UIODID   EQU   UIODSN                                                   13185000
@NM00098 EQU   RSXCIFL1                                                 13186000
@NM00097 EQU   RSXCIXLT+4                                               13187000
RMBKEYA  EQU   RMB+12                                                   13188000
@NM00096 EQU   RMBFLAGS                                                 13189000
RMBGETU  EQU   RMBFLAGS                                                 13190000
RMBKEQ   EQU   RMBFLAGS                                                 13191000
RMBKEY   EQU   RMBFLAGS                                                 13192000
RMBUPD   EQU   RMBFLAGS                                                 13193000
RMBDIR   EQU   RMBFLAGS                                                 13194000
RMBSEQ   EQU   RMBFLAGS                                                 13195000
RMBARG   EQU   RMBCTL+4                                                 13196000
RMBRPL   EQU   RMBCTL                                                   13197000
@NM00095 EQU   RSRAB+530                                                13198000
RABFLG4  EQU   RABFLGS+3                                                13199000
RABFLG3  EQU   RABFLGS+2                                                13200000
RABFLG2  EQU   RABFLGS+1                                                13201000
RABNRF   EQU   RABFLG1                                                  13202000
RABKEY   EQU   RABFLG1                                                  13203000
RABUPD   EQU   RABFLG1                                                  13204000
RABINUSE EQU   RABFLG1                                                  13205000
GRABRAB6 EQU   GRABRABS+20                                              13206000
GRABRAB5 EQU   GRABRABS+16                                              13207000
GRABRAB4 EQU   GRABRABS+12                                              13208000
GRABRAB3 EQU   GRABRABS+8                                               13209000
GRABSNRF EQU   GRABAFL2                                                 13210000
GRABSNRN EQU   GRABAFL1                                                 13211000
GRABFLG1 EQU   GRABFLGS                                                 13212000
@NM00092 EQU   RSCSWA+6                                                 13213000
RSCSFCN  EQU   RSCSWA+4                                                 13214000
RSCSFAE  EQU   RSCSWA                                                   13215000
@NM00091 EQU   RSMARKUN+6                                               13216000
RSMA3FCN EQU   RSMARKUN+4                                               13217000
RSMA3FAE EQU   RSMARKUN                                                 13218000
@NM00090 EQU   RSCDSDW+18                                               13219000
RSCDINDX EQU   RSCDSDW+16                                               13220000
RSCDSUMT EQU   RSCDSDW+12                                               13221000
RSCD8FCN EQU   RSCDSDW+10                                               13222000
RSCD3FCN EQU   RSCDSDW+8                                                13223000
RSCD8FAE EQU   RSCDSDW+4                                                13224000
RSCD3FAE EQU   RSCDSDW                                                  13225000
RSCDDIR  EQU   RSCDSDIN+12                                              13226000
RSCDVOLR EQU   RSCDSDIN+8                                               13227000
RSCDSNT3 EQU   RSCDSDIN+4                                               13228000
RSCDSNT8 EQU   RSCDSDIN                                                 13229000
RSGTMEB  EQU   RSGTIME+11                                               13230000
RSGDELM2 EQU   RSGTIME+9                                                13231000
@NM00089 EQU   RSGTIME+2                                                13232000
RSGDELM1 EQU   RSGTIME                                                  13233000
RSGDAY   EQU   RSGDATE+2                                                13234000
RSGYEAR  EQU   RSGDATE                                                  13235000
RSGFIXID EQU   RSGENAM+8                                                13236000
RSGTMEA  EQU   RSGENAM+1                                                13237000
RSGDELM  EQU   RSGENAM                                                  13238000
RSGUNPK  EQU   RSGENMWA                                                 13239000
RSFCPE7  EQU   RSWFNDWA+52                                              13240000
RSFCPE6  EQU   RSWFNDWA+48                                              13241000
RSFCPE5  EQU   RSWFNDWA+44                                              13242000
RSFCPE4  EQU   RSWFNDWA+40                                              13243000
RSFCPE3  EQU   RSWFNDWA+36                                              13244000
RSFCPE2  EQU   RSWFNDWA+32                                              13245000
RSFCPE1  EQU   RSWFNDWA+28                                              13246000
@NM00088 EQU   RSWFNDWA+26                                              13247000
RSWFBMLN EQU   RSWFNDWA+24                                              13248000
RSWFBMAP EQU   RSWFNDWA+20                                              13249000
RSWFBUF  EQU   RSWFNDWA+16                                              13250000
RSWFCIN  EQU   RSWFNDWA+13                                              13251000
RSWFRCSN EQU   RSWFNDWA+12                                              13252000
RSWSEQNR EQU   RSWFNDWA+10                                              13253000
@NM00087 EQU   RSWSNFLG                                                 13254000
RSWFIRST EQU   RSWSNFLG                                                 13255000
RSWAFINF EQU   RSWFNDWA                                                 13256000
@NM00086 EQU   RSCNVTCF+1                                               13257000
@NM00085 EQU   RSCNVTF1                                                 13258000
RSCFINN  EQU   RSCNVTF1                                                 13259000
RSNN     EQU   RSTTNN+2                                                 13260000
RSTT     EQU   RSTTNN                                                   13261000
RSCIOCS  EQU   RSCNVTCC                                                 13262000
LISTLN   EQU   RSDF00W+36                                               13263000
SETRC    EQU   RSDF00W+32                                               13264000
LISTPTR  EQU   RSDF00W                                                  13265000
RSVF4TT  EQU   RSVOLWA+142                                              13266000
@NM00084 EQU   RSVOLWA+141                                              13267000
@NM00083 EQU   RSVFLAGS                                                 13268000
RSVWFUPD EQU   RSVFLAGS                                                 13269000
RSVREPOS EQU   RSVFLAGS                                                 13270000
RSVGTEOF EQU   RSVFLAGS                                                 13271000
RSVEXTS  EQU   RSVOLWA+139                                              13272000
RSVF1TTN EQU   RSVF1EXT                                                 13273000
RSVF1CTS EQU   RSVOLWA+67                                               13274000
RSVF1PAD EQU   RSVF1TS+14                                               13275000
RSVF1TS2 EQU   RSVF1TS+7                                                13276000
RSVF1TS1 EQU   RSVF1TS                                                  13277000
RSVSVTTR EQU   RSVOLWA+48                                               13278000
RSVSCRNM EQU   RSVOLWA+4                                                13279000
RSVSCRPT EQU   RSVOLWA                                                  13280000
RSGENDT  EQU   RSGENDTE+1                                               13281000
@NM00082 EQU   RSGENDTE                                                 13282000
RSGENTME EQU   RSGENWRK+4                                               13283000
RSGENTPT EQU   RSGENWRK                                                 13284000
RSCRGRBP EQU   RSCRWA+4                                                 13285000
RSCRENTP EQU   RSCRWA                                                   13286000
@NM00081 EQU   RSADUL+10                                                13287000
RSADSTP  EQU   RSADUL+10                                                13288000
RSADFLGS EQU   RSADUL+9                                                 13289000
RSADULNM EQU   RSADUL+1                                                 13290000
RSADULC  EQU   RSADUL                                                   13291000
RSADVLSR EQU   RSADVL+1                                                 13292000
RSADVLC  EQU   RSADVL                                                   13293000
RSADDDNP EQU   RSADWA+28                                                13294000
RSADULP  EQU   RSADWA+24                                                13295000
RSADVLP  EQU   RSADWA+20                                                13296000
RSADENP  EQU   RSADWA+16                                                13297000
RSADVSRP EQU   RSADWA+12                                                13298000
RSADGRBP EQU   RSADWA+8                                                 13299000
RSADDDN  EQU   RSADWA                                                   13300000
RSWFAMDP EQU   RSWFWA+48                                                13301000
RSWFLR   EQU   RSWFWA+44                                                13302000
RSWFDFAR EQU   RSWFWA+40                                                13303000
RSWFFPLP EQU   RSWFWA+12                                                13304000
RSWFFVTP EQU   RSWFWA+4                                                 13305000
RSWFSVCP EQU   RSWFWA                                                   13306000
@NM00080 EQU   RSRWORK+65                                               13307000
RSRSKPSW EQU   RSRFLGS                                                  13308000
RSRXSW   EQU   RSRFLGS                                                  13309000
RSRXTRY  EQU   RSRFLGS                                                  13310000
RSROKSW  EQU   RSRFLGS                                                  13311000
RSRX     EQU   RSRWORK+63                                               13312000
RSRIXNO  EQU   RSRWORK+62                                               13313000
RSRU     EQU   RSRWORK+61                                               13314000
RSRI     EQU   RSRWORK+60                                               13315000
RSRLG    EQU   RSRWORK+59                                               13316000
RSRLU    EQU   RSRWORK+58                                               13317000
RSRSVFLG EQU   RSRWORK+48                                               13318000
RSMSGCI  EQU   RSRWORK+45                                               13319000
RSMSGRC  EQU   RSRWORK+42                                               13320000
RSRRLN   EQU   RSRWORK+40                                               13321000
RSRRCPY  EQU   RSRWORK+38                                               13322000
RSRWFRN  EQU   RSRWORK+36                                               13323000
RSRCATRN EQU   RSRWORK+34                                               13324000
RSRCRARN EQU   RSRWORK+32                                               13325000
RSRXLFND EQU   RSRWORK+28                                               13326000
RSRXLSV  EQU   RSRWORK+24                                               13327000
RSRRPL   EQU   RSRWORK+20                                               13328000
RSRSVARG EQU   RSRWORK+16                                               13329000
RSRFAD   EQU   RSRWORK+12                                               13330000
RSRDAD   EQU   RSRWORK+8                                                13331000
RSRRC    EQU   RSRWORK+4                                                13332000
RSRGRBPT EQU   RSRWORK                                                  13333000
RSRNULNM EQU   RSRNUL+1                                                 13334000
RSRNULC  EQU   RSRNUL                                                   13335000
RSRNVLSR EQU   RSRNVL+1                                                 13336000
RSRNVLC  EQU   RSRNVL                                                   13337000
RSRNDDNM EQU   RSRNWA+91                                                13338000
RSRNOLDN EQU   RSRNWA+47                                                13339000
RSRNNOF1 EQU   RSRNFLGS                                                 13340000
RSRNVDUP EQU   RSRNFLGS                                                 13341000
RSRNSTP  EQU   RSRNFLGS                                                 13342000
RSRNFAIL EQU   RSRNFLGS                                                 13343000
RSRNRCRS EQU   RSRNFLGS                                                 13344000
RSRNEVC  EQU   RSRNWA+44                                                13345000
RSRNEVP  EQU   RSRNWA+40                                                13346000
RSRNULP  EQU   RSRNWA+36                                                13347000
RSRNVLP  EQU   RSRNWA+32                                                13348000
RSRNVSPT EQU   RSRNWA+28                                                13349000
RSRNDDPT EQU   RSRNWA+24                                                13350000
RSRNVLPT EQU   RSRNWA+20                                                13351000
RSRNGRBP EQU   RSRNWA+16                                                13352000
RSRNPVLS EQU   RSRNPLST+12                                              13353000
RSRNPNDS EQU   RSRNPLST+8                                               13354000
RSRNPODS EQU   RSRNPLST+4                                               13355000
RSRNPFLG EQU   RSRNPLST                                                 13356000
@NM00079 EQU   RSINATR1                                                 13357000
@NM00078 EQU   RSINATR1                                                 13358000
@NM00077 EQU   RSCKFLAG                                                 13359000
RSCKTSW  EQU   RSCKFLAG                                                 13360000
RSCKIDX3 EQU   RSCKERRW+48                                              13361000
RSCKIDX2 EQU   RSCKERRW+46                                              13362000
RSCKIDX1 EQU   RSCKERRW+44                                              13363000
RSOURCC  EQU   RSCKERRW+40                                              13364000
RSCKMDTB EQU   RSCKTIME+20                                              13365000
RSCKMDY  EQU   RSCKTIME+14                                              13366000
RSCKHMS  EQU   RSCKTIME+8                                               13367000
RSCKPDAY EQU   RSCKTIME+4                                               13368000
RSCKDAYS EQU   RSCKTIME                                                 13369000
RSCKTPTR EQU   RSCKERRW+4                                               13370000
RSCKERNO EQU   RSCKERR+2                                                13371000
@NM00076 EQU   RSREASW                                                  13372000
@NM00075 EQU   @NM00074+3                                               13373000
RSVIAGRB EQU   @NM00074                                                 13374000
RSVIACIN EQU   @NM00072+1                                               13375000
@NM00073 EQU   RSVIAFLG                                                 13376000
RSVIARRN EQU   RSVIAFLG                                                 13377000
RSVIAUPD EQU   RSVIAFLG                                                 13378000
RSVIAIS  EQU   RSVIAFLG                                                 13379000
RSVIAFND EQU   RSVIAFLG                                                 13380000
RSVIADUP EQU   RSVIAFLG                                                 13381000
RSVIAFCR EQU   RSVIAFLG                                                 13382000
@NM00071 EQU   RSGETVIA+8                                               13383000
RSVIAIDX EQU   RSGETVIA+6                                               13384000
@NM00070 EQU   RSVIACRA+4                                               13385000
RSVIADSC EQU   RSVIACRA                                                 13386000
@NM00069 EQU   @NM00067+3                                               13387000
RSEOVERR EQU   @NM00067+2                                               13388000
@NM00068 EQU   RSEOVFLG                                                 13389000
RSEOVPHY EQU   RSEOVFLG                                                 13390000
RSEOVLOG EQU   RSEOVFLG                                                 13391000
RSEOVEND EQU   RSEOVFLG                                                 13392000
RSEOVFND EQU   RSEOVFLG                                                 13393000
RSEOVXIO EQU   @NM00067                                                 13394000
RSCATARG EQU   @NM00065+1                                               13395000
@NM00066 EQU   @NM00065                                                 13396000
RSCATRPL EQU   RSEOVWA+4                                                13397000
RSEOVRAB EQU   RSEOVWA                                                  13398000
RSPVFLG3 EQU   @NM00062+3                                               13399000
@NM00064 EQU   RSPVFLG2                                                 13400000
RSBDVOLS EQU   RSPVFLG2                                                 13401000
RSRETSPC EQU   RSPVFLG2                                                 13402000
RSSETERR EQU   RSPVFLG2                                                 13403000
RSSERROR EQU   RSPVFLG2                                                 13404000
RSPERROR EQU   RSPVFLG2                                                 13405000
RSVLCATE EQU   RSPVFLG2                                                 13406000
RSMUNUS  EQU   RSPVFLG2                                                 13407000
RSCK1TO1 EQU   RSPVFLG1                                                 13408000
RSCKBERR EQU   RSPVFLG1                                                 13409000
RSPVRSC  EQU   RSPVFLG1                                                 13410000
RSPVRPC  EQU   RSPVFLG1                                                 13411000
RSPVNRP  EQU   RSPVFLG1                                                 13412000
RSPVDELT EQU   RSPVFLG1                                                 13413000
RSPVRVOL EQU   RSPVFLG1                                                 13414000
RSCHKCON EQU   RSPVFLG1                                                 13415000
@NM00063 EQU   RSPVSETB                                                 13416000
RSST1TO1 EQU   RSPVSETB                                                 13417000
RSPVCLBM EQU   RSPVSETB                                                 13418000
RSSETMAP EQU   RSPVSETB                                                 13419000
RSSETCRA EQU   RSPVSETB                                                 13420000
@NM00061 EQU   RSPVTTNN+15                                              13421000
RSMASK   EQU   RSPVTTNN+14                                              13422000
RSPVKNEX EQU   RSPVTTNN+12                                              13423000
RSPVNN   EQU   RSPVTTNN+10                                              13424000
RSBITPOS EQU   RSPVTTNN+8                                               13425000
RSPVTNEX EQU   RSPVTTNN+6                                               13426000
RSPVNEXT EQU   RSPVTTNN+4                                               13427000
RSSETTT  EQU   RSPVTTNN                                                 13428000
RSPVSNT8 EQU   RSPVSNT+16                                               13429000
RSPVSNT6 EQU   RSPVSNT+12                                               13430000
RSPVSNT5 EQU   RSPVSNT+8                                                13431000
RSPVSNT3 EQU   RSPVSNT+4                                                13432000
RSPVSNTC EQU   RSPVSNT                                                  13433000
TMPSZ    EQU   RSPROCVL+44                                              13434000
RSMAPSIZ EQU   RSPROCVL+40                                              13435000
RSFROMAP EQU   RSMAPAD+16                                               13436000
RSTOMAP  EQU   RSMAPAD+12                                               13437000
RSSTBMAP EQU   RSMAPAD+8                                                13438000
RSCKBMAP EQU   RSMAPAD+4                                                13439000
RSTGBMAP EQU   RSMAPAD                                                  13440000
RSSCBMAP EQU   RSMAPS+16                                                13441000
RSCRBMAP EQU   RSPCBMAP                                                 13442000
RSCABMAP EQU   RSSBMAP                                                  13443000
RSPBMAP  EQU   RSMAPS+4                                                 13444000
RSWKBMAP EQU   RSMAPS                                                   13445000
RSGDGNM  EQU   RSGDG+10                                                 13446000
RSGDGLN  EQU   RSGDG+8                                                  13447000
RSGDGLL  EQU   RSGDG+4                                                  13448000
@NM00060 EQU   RSASSFLG+1                                               13449000
@NM00059 EQU   RSASSFL1                                                 13450000
RSASDSDI EQU   RSASSFL1                                                 13451000
RSASSEPA EQU   RSASSFL1                                                 13452000
RSASSPAS EQU   RSASSOC+14                                               13453000
RSASSEXT EQU   RSASSOC+12                                               13454000
RSASSEND EQU   RSASSOC+8                                                13455000
RSASSCIN EQU   RSASSOC+4                                                13456000
RSRCHK   EQU   RSROPT                                                   13457000
RSRINIT  EQU   RSRTYPE                                                  13458000
RSRDEL   EQU   RSRTYPE                                                  13459000
@NM00058 EQU   RSFLAGI2+1                                               13460000
RSHAVECR EQU   RSFLAGI2+1                                               13461000
RSFDELET EQU   RSFLAGI2+1                                               13462000
RSOPDYN  EQU   RSFLAGI2+1                                               13463000
RSCCVFND EQU   RSFLAGI2                                                 13464000
@NM00057 EQU   RSFLAGI1                                                 13465000
RSCREXC  EQU   RSFLAGN2                                                 13466000
RSDFVLSR EQU   RSWORK+875                                               13467000
RSDFVLCT EQU   RSWORK+874                                               13468000
RSWFDSN  EQU   RSWORK+830                                               13469000
RSCATVLS EQU   RSWORK+808                                               13470000
RSIDX3   EQU   RSWORK+692                                               13471000
RSIDX2   EQU   RSWORK+690                                               13472000
RSCAFUCN EQU   RSWORK+684                                               13473000
RSGOPLEN EQU   RSWORK+682                                               13474000
RSORSTAT EQU   RSORVLLS+12                                              13475000
RSORNVOL EQU   RSORVLLS+6                                               13476000
RSORNDEV EQU   RSORVLLS+2                                               13477000
RSORVLCT EQU   RSORVLLS                                                 13478000
RSCRAVLN EQU   RSWORK+664                                               13479000
RSSUBSSZ EQU   RSWORK+640                                               13480000
RSSUBSTP EQU   RSWORK+636                                               13481000
RSSUBGRP EQU   RSWORK+628                                               13482000
RSSUBRC  EQU   RSWORK+624                                               13483000
RSPROCRC EQU   RSWORK+620                                               13484000
RSCIXLTB EQU   RSWORK+604                                               13485000
CTGFVPTR EQU   RSWORK+584                                               13486000
RSECPA   EQU   RSWORK+548                                               13487000
RSECBF1  EQU   RSWORK+544                                               13488000
RSWFIOCS EQU   RSWORK+540                                               13489000
RSENTNXT EQU   RSWORK+492                                               13490000
RSENTFBK EQU   RSWORK+488                                               13491000
RSENTST  EQU   RSWORK+480                                               13492000
RSVOLLUS EQU   RSWORK+464                                               13493000
RSRESLUS EQU   RSWORK+456                                               13494000
RSCACDE  EQU   RSWORK+360                                               13495000
RS07RG12 EQU   RS07REGS+16                                              13496000
RS07RG11 EQU   RS07REGS+12                                              13497000
RS07RG10 EQU   RS07REGS+8                                               13498000
RS07RG09 EQU   RS07REGS+4                                               13499000
RS06RG12 EQU   RS06REGS+16                                              13500000
RS06RG11 EQU   RS06REGS+12                                              13501000
RS06RG10 EQU   RS06REGS+8                                               13502000
RS06RG09 EQU   RS06REGS+4                                               13503000
RS05RG12 EQU   RS05REGS+16                                              13504000
RS05RG11 EQU   RS05REGS+12                                              13505000
RS05RG10 EQU   RS05REGS+8                                               13506000
RS05RG09 EQU   RS05REGS+4                                               13507000
RS04RG12 EQU   RS04REGS+16                                              13508000
RS04RG11 EQU   RS04REGS+12                                              13509000
RS04RG10 EQU   RS04REGS+8                                               13510000
RS04RG09 EQU   RS04REGS+4                                               13511000
RS03RG12 EQU   RS03REGS+16                                              13512000
RS03RG11 EQU   RS03REGS+12                                              13513000
RS03RG10 EQU   RS03REGS+8                                               13514000
RS03RG09 EQU   RS03REGS+4                                               13515000
RS02RG12 EQU   RS02REGS+16                                              13516000
RS02RG11 EQU   RS02REGS+12                                              13517000
RS02RG10 EQU   RS02REGS+8                                               13518000
RS02RG09 EQU   RS02REGS+4                                               13519000
RS01RG12 EQU   RS01REGS+16                                              13520000
RS01RG11 EQU   RS01REGS+12                                              13521000
RS01RG10 EQU   RS01REGS+8                                               13522000
RSTABAD  EQU   RSTAB+16                                                 13523000
RSTWKIX  EQU   @NM00055+1                                               13524000
@NM00056 EQU   @NM00055                                                 13525000
RSTENTIX EQU   @NM00053+1                                               13526000
@NM00054 EQU   @NM00053                                                 13527000
RSTENTAD EQU   RSTAB+4                                                  13528000
RSPTWKUG EQU   RSPSTACK+24                                              13529000
@NM00052 EQU   RSPSTACK+20                                              13530000
@NM00051 EQU   RSPSTACK+18                                              13531000
@NM00050 EQU   RSPSTACK+16                                              13532000
RSPTWKLN EQU   RSPSTACK+12                                              13533000
RSPTWKL  EQU   RSPSTACK+4                                               13534000
RSPTWKF  EQU   RSPSTACK                                                 13535000
RSGDITUG EQU   RSGDITS+24                                               13536000
RSGDITNU EQU   @NM00048+1                                               13537000
@NM00049 EQU   @NM00048                                                 13538000
RSGDITEN EQU   RSGDITS+18                                               13539000
@NM00047 EQU   RSGDITS+16                                               13540000
RSGDITLN EQU   RSGDITS+12                                               13541000
RSGDITL  EQU   RSGDITS+4                                                13542000
RSGDITF  EQU   RSGDITS                                                  13543000
RSGCITUG EQU   RSGCITS+24                                               13544000
RSGCITNU EQU   @NM00045+1                                               13545000
@NM00046 EQU   @NM00045                                                 13546000
RSGCITEN EQU   RSGCITS+18                                               13547000
@NM00044 EQU   RSGCITS+16                                               13548000
RSGCITLN EQU   RSGCITS+12                                               13549000
RSGCITL  EQU   RSGCITS+4                                                13550000
RSGCITF  EQU   RSGCITS                                                  13551000
RSCRIOCS EQU   RSWORK+100                                               13552000
RSCPE8   EQU   RSWORK+96                                                13553000
RSCPE4   EQU   RSWORK+80                                                13554000
RSCITDUM EQU   RSWORK+48                                                13555000
RSCAIOCS EQU   RSWORK+40                                                13556000
RSALLAGP EQU   RSWORK+4                                                 13557000
RSF1RNNM EQU   RSF1RNTB+14                                              13558000
RSF1RNDV EQU   RSF1RNTB+10                                              13559000
RSF1RNVL EQU   RSF1RNTB+4                                               13560000
RSF1RNNX EQU   RSF1RNTB                                                 13561000
@NM00043 EQU   RESVOL+12                                                13562000
@NM00042 EQU   RESVLFLG                                                 13563000
RESVLNXT EQU   RESVOL                                                   13564000
VOLSRLAS EQU   VOLSRFLG                                                 13565000
VOLSRNXT EQU   VOLSERTB                                                 13566000
@NM00041 EQU   CATIEXT                                                  13567000
@NM00039 EQU   IOCRCV                                                   13568000
IOCRCVRA EQU   IOCRCV                                                   13569000
IOCRCVXM EQU   IOCRCV                                                   13570000
IOCVLN   EQU   IOCSEX+42                                                13571000
IOCDNM   EQU   IOCSEX+40                                                13572000
IOCDDN   EQU   IOCDLM                                                   13573000
IOCMODEX EQU   IOCMOD                                                   13574000
IOCMODRP EQU   IOCMOD                                                   13575000
IOCMODXM EQU   IOCMOD                                                   13576000
IOCMODUB EQU   IOCMOD                                                   13577000
IOCMODRG EQU   IOCMOD                                                   13578000
IOCMODDY EQU   IOCMOD                                                   13579000
IOCMODRR EQU   IOCMOD                                                   13580000
IOCMODPD EQU   IOCMOD                                                   13581000
IOCINFR1 EQU   IOCINF                                                   13582000
IOCINFCT EQU   IOCINF                                                   13583000
IOCINFDO EQU   IOCINF                                                   13584000
IOCINFAC EQU   IOCINF                                                   13585000
IOCINFQX EQU   IOCINF                                                   13586000
IOCINFND EQU   IOCINF                                                   13587000
IOCINFAE EQU   IOCINF                                                   13588000
IOCINFPT EQU   IOCINF                                                   13589000
@NM00038 EQU   IOCDEV                                                   13590000
IOCDEVUR EQU   IOCDEV                                                   13591000
IOCDEVMT EQU   IOCDEV                                                   13592000
IOCDEVDA EQU   IOCDEV                                                   13593000
@NM00037 EQU   IOCFLG                                                   13594000
IOCFLGSP EQU   IOCFLG                                                   13595000
IOCFLGOE EQU   IOCFLG                                                   13596000
IOCFLGOP EQU   IOCFLG                                                   13597000
IOCFLGIO EQU   IOCFLG                                                   13598000
IOCFLGEF EQU   IOCFLG                                                   13599000
IOCFLGDF EQU   IOCFLG                                                   13600000
IOCFLGEX EQU   IOCFLG                                                   13601000
IOCSID   EQU   IOCSEX+28                                                13602000
IOCNIO   EQU   IOCSEX+24                                                13603000
@NM00036 EQU   IOCXPM+2                                                 13604000
IOCEXL   EQU   IOCXPM                                                   13605000
IOCEXA   EQU   IOCXAD                                                   13606000
IOCWKA   EQU   IOCSEX+12                                                13607000
IOCLRP   EQU   IOCSEX+10                                                13608000
IOCCBL   EQU   IOCSEX+8                                                 13609000
IOCDEC   EQU   IOCRPL                                                   13610000
IOCCBA   EQU   IOCSEX                                                   13611000
@NM00035 EQU   IODATA+64                                                13612000
IODAEI   EQU   IODATA+60                                                13613000
@NM00034 EQU   IODATA+56                                                13614000
IODIOX   EQU   IODATA+52                                                13615000
IODOCS   EQU   IODATA+48                                                13616000
IODICS   EQU   IODATA+44                                                13617000
IODOSO   EQU   IODATA+40                                                13618000
IODOSS   EQU   IODATA+36                                                13619000
IODEOD   EQU   IODATA+32                                                13620000
@NM00033 EQU   IODATA+30                                                13621000
@NM00032 EQU   IODATA+28                                                13622000
IODOEV   EQU   IODATA+24                                                13623000
IODIEV   EQU   IODATA+20                                                13624000
IODINC   EQU   IODSID+2                                                 13625000
IODMID   EQU   IODSID                                                   13626000
IODXTN   EQU   IODATA+12                                                13627000
IODADD   EQU   IODATA+8                                                 13628000
IODMSG   EQU   IODATA+4                                                 13629000
IODIOC   EQU   IODATA                                                   13630000
CRADVVAL EQU   CRADV+1                                                  13631000
CRADVLEN EQU   CRADV                                                    13632000
WCATMEM  EQU   WCAT+12                                                  13633000
WCATMLN  EQU   WCAT+11                                                  13634000
WCATFUQ  EQU   WCATFLG                                                  13635000
WCATPOS  EQU   WCAT+9                                                   13636000
CATNMMEM EQU   CATNM+12                                                 13637000
CATNMMLN EQU   CATNM+11                                                 13638000
CATNMFUQ EQU   CATNMFLG                                                 13639000
CATNMPOS EQU   CATNM+9                                                  13640000
@NM00031 EQU   DMPARY+15                                                13641000
DMPARYTP EQU   DMPARY+14                                                13642000
DMPARYEX EQU   DMPARY+12                                                13643000
DMPARYIC EQU   DMPARY+10                                                13644000
DMPARYSZ EQU   DMPARY+8                                                 13645000
DMPARYNM EQU   DMPARY                                                   13646000
@NM00030 EQU   DMPITM+15                                                13647000
DMPITMTP EQU   DMPITM+14                                                13648000
DMPITMLN EQU   DMPITM+12                                                13649000
DMPITMPT EQU   DMPITM+8                                                 13650000
DMPITMNM EQU   DMPITM                                                   13651000
@NM00029 EQU   ERCNVTAB+24                                              13652000
ERDARBPT EQU   ERCPLPT                                                  13653000
ERDYNRC  EQU   ERCATRC                                                  13654000
ERDSNM   EQU   ERCNVTAB+12                                              13655000
@NM00028 EQU   ERCNVTAB+4                                               13656000
@NM00027 EQU   ERCNVTAB+3                                               13657000
@NM00026 EQU   EROSOPER                                                 13658000
EROSUCDX EQU   EROSOPER                                                 13659000
EROSCATL EQU   EROSOPER                                                 13660000
@NM00025 EQU   EROPER                                                   13661000
ERCATAL  EQU   EROPER                                                   13662000
ERCATDL  EQU   EROPER                                                   13663000
ERCATDE  EQU   EROPER                                                   13664000
ERCATLC  EQU   EROPER                                                   13665000
@NM00024 EQU   ERTYPE                                                   13666000
ERDYNAL  EQU   ERTYPE                                                   13667000
EROSCAT  EQU   ERTYPE                                                   13668000
ERCATLG  EQU   ERTYPE                                                   13669000
@NM00023 EQU   FMTCNVF+1                                                13670000
FMTAR    EQU   FMTCNVF+1                                                13671000
FMTBS    EQU   FMTCNVF+1                                                13672000
FMTSS    EQU   FMTCNVF+1                                                13673000
FMTAL    EQU   FMTCNVF+1                                                13674000
FMTZS    EQU   FMTCNVF+1                                                13675000
@NM00022 EQU   FMTCNVF                                                  13676000
FMTPU    EQU   FMTCNVF                                                  13677000
FMTBD    EQU   FMTCNVF                                                  13678000
FMTBHD   EQU   FMTCNVF                                                  13679000
FMTBHA   EQU   FMTCNVF                                                  13680000
FMTBH    EQU   FMTCNVF                                                  13681000
FMTOLEN  EQU   FMTLIST+8                                                13682000
FMTRIO   EQU   FMTOCOL                                                  13683000
FMTSPT   EQU   FMTSTO                                                   13684000
FMTSTL   EQU   FMTILEN                                                  13685000
@NM00021 EQU   FMTFLGS+1                                                13686000
FMTSMSG  EQU   FMTFLGS+1                                                13687000
FMTHDF   EQU   FMTFLGS                                                  13688000
FMTDFF   EQU   FMTFLGS                                                  13689000
FMTSTF   EQU   FMTFLGS                                                  13690000
FMTREPF  EQU   FMTFLGS                                                  13691000
FMTBDF   EQU   FMTFLGS                                                  13692000
FMTIDF   EQU   FMTFLGS                                                  13693000
FMTSCF   EQU   FMTFLGS                                                  13694000
FMTEOLF  EQU   FMTFLGS                                                  13695000
DARGDTM  EQU   DARGARY+4                                                13696000
DARGPCT  EQU   DARGINL                                                  13697000
DARGREP  EQU   DARGINS                                                  13698000
@NM00020 EQU   DARGLIST+19                                              13699000
DARGIND  EQU   DARGLIST+18                                              13700000
DARGRETL EQU   DARGLIST+16                                              13701000
DARGCNT  EQU   DARGLIST+14                                              13702000
DARGSENT EQU   DARGSTID+3                                               13703000
DARGSMOD EQU   DARGSTID                                                 13704000
DARGRETP EQU   DARGLIST+4                                               13705000
UVOLVOL  EQU   UVOLENT+4                                                13706000
UVOLDEV  EQU   UVOLENT                                                  13707000
UVOLCNT  EQU   UVOLLIST                                                 13708000
@NM00019 EQU   IOINFOPT                                                 13709000
IOINFLUB EQU   IOINFOPT                                                 13710000
IOINFTMS EQU   IOINFOPT                                                 13711000
IOINFSUP EQU   IOINFOPT                                                 13712000
IOINFDVT EQU   IOINFOPT                                                 13713000
OPNVOL   EQU   OPNAGL+44                                                13714000
OPNSTRNO EQU   OPNAGL+43                                                13715000
@NM00018 EQU   OPNOPT2                                                  13716000
OPNOPTJM EQU   OPNOPT2                                                  13717000
OPNOPTNM EQU   OPNOPT2                                                  13718000
OPNOPTAS EQU   OPNOPT2                                                  13719000
@NM00017 EQU   OPNDSO                                                   13720000
OPNDSOPO EQU   OPNDSO                                                   13721000
OPNDSOIS EQU   OPNDSO                                                   13722000
OPNDSOPS EQU   OPNDSO                                                   13723000
OPNDSOAM EQU   OPNDSO                                                   13724000
OPNKYL   EQU   OPNAGL+40                                                13725000
OPNBLK   EQU   OPNAGL+36                                                13726000
OPNREC   EQU   OPNAGL+32                                                13727000
OPNDEVIX EQU   OPNDEV+4                                                 13728000
OPNDEVDT EQU   OPNDEV                                                   13729000
OPNCBP   EQU   OPNAGL+20                                                13730000
OPNDSN   EQU   OPNAGL+16                                                13731000
OPNPWA   EQU   OPNAGL+12                                                13732000
OPNDDN   EQU   OPNAGL+8                                                 13733000
OPNIOC   EQU   OPNAGL+4                                                 13734000
OPNMODRP EQU   OPNMOD                                                   13735000
OPNMODUB EQU   OPNMOD                                                   13736000
OPNMODRS EQU   OPNMOD                                                   13737000
OPNMODAX EQU   OPNMOD                                                   13738000
OPNMODRR EQU   OPNMOD                                                   13739000
OPNMODRC EQU   OPNMOD                                                   13740000
OPNMODAC EQU   OPNMOD                                                   13741000
OPNMODPD EQU   OPNMOD                                                   13742000
OPNTYPSY EQU   OPNTYP                                                   13743000
OPNTYPRV EQU   OPNTYP                                                   13744000
OPNTYPEX EQU   OPNTYP                                                   13745000
OPNTYPRA EQU   OPNTYP                                                   13746000
OPNTYPXM EQU   OPNTYP                                                   13747000
OPNTYPCI EQU   OPNTYP                                                   13748000
OPNTYPSO EQU   OPNTYP                                                   13749000
OPNTYPSI EQU   OPNTYP                                                   13750000
@NM00016 EQU   OPNRFM                                                   13751000
OPNRFMBK EQU   OPNRFM                                                   13752000
OPNRFMSF EQU   OPNRFM                                                   13753000
OPNRFMUN EQU   OPNRFM                                                   13754000
OPNRFMVR EQU   OPNRFM                                                   13755000
OPNRFMFX EQU   OPNRFM                                                   13756000
OPNOPTSK EQU   OPNOPT                                                   13757000
OPNOPTDR EQU   OPNOPT                                                   13758000
OPNOPTCR EQU   OPNOPT                                                   13759000
OPNOPTKS EQU   OPNOPT                                                   13760000
OPNOPTBK EQU   OPNOPT                                                   13761000
OPNOPTUP EQU   OPNOPT                                                   13762000
OPNOPTOT EQU   OPNOPT                                                   13763000
OPNOPTIN EQU   OPNOPT                                                   13764000
IOCTSML  EQU   IOCREL+2                                                 13765000
IOCTPML  EQU   IOCREL                                                   13766000
IOCWORK  EQU   IOCSTR+56                                                13767000
IOCRRN   EQU   IOCSTR+52                                                13768000
IOCPNM   EQU   IOCNWM+2                                                 13769000
IOCPTL   EQU   IOCNWM                                                   13770000
IOCKYA   EQU   IOCMEM                                                   13771000
IOCVRC   EQU   IOCTTR                                                   13772000
IOCCBP   EQU   IOCSTR+36                                                13773000
IOCDSN   EQU   IOCSTR+32                                                13774000
IOCHURBA EQU   IOCSTR+28                                                13775000
IOCVOLSR EQU   IOCSTR+22                                                13776000
@NM00015 EQU   IOCMSG                                                   13777000
IOCMSGSM EQU   IOCMSG                                                   13778000
IOCMSGAE EQU   IOCMSG                                                   13779000
IOCMSGCE EQU   IOCMSG                                                   13780000
IOCMSGOE EQU   IOCMSG                                                   13781000
IOCMSGOP EQU   IOCMSG                                                   13782000
IOCCHPKG EQU   IOCMSG                                                   13783000
IOCCHPKE EQU   IOCMSG                                                   13784000
IOCCHPNU EQU   IOCCHP                                                   13785000
IOCCHPUP EQU   IOCCHP                                                   13786000
IOCCHPBK EQU   IOCCHP                                                   13787000
IOCCHPCR EQU   IOCCHP                                                   13788000
IOCCHPKS EQU   IOCCHP                                                   13789000
IOCCHPSK EQU   IOCCHP                                                   13790000
IOCCHPDR EQU   IOCCHP                                                   13791000
IOCCHPSQ EQU   IOCCHP                                                   13792000
IOCMACNT EQU   IOCMAC2                                                  13793000
IOCMACER EQU   IOCMAC2                                                  13794000
IOCMACPA EQU   IOCMAC2                                                  13795000
IOCMACEN EQU   IOCMAC2                                                  13796000
IOCMACCP EQU   IOCMAC2                                                  13797000
IOCMACRR EQU   IOCMAC2                                                  13798000
IOCMACAS EQU   IOCMAC2                                                  13799000
IOCMACSK EQU   IOCMAC2                                                  13800000
@NM00014 EQU   IOCMAC                                                   13801000
IOCMACCC EQU   IOCMAC                                                   13802000
IOCMACDR EQU   IOCMAC                                                   13803000
IOCMACBK EQU   IOCMAC                                                   13804000
IOCMACCR EQU   IOCMAC                                                   13805000
IOCMACUP EQU   IOCMAC                                                   13806000
IOCMACOT EQU   IOCMAC                                                   13807000
IOCMACIN EQU   IOCMAC                                                   13808000
@NM00013 EQU   IOCRFM                                                   13809000
IOCRFMBK EQU   IOCRFM                                                   13810000
IOCRFMSF EQU   IOCRFM                                                   13811000
IOCRFMUN EQU   IOCRFM                                                   13812000
IOCRFMVR EQU   IOCRFM                                                   13813000
IOCRFMFX EQU   IOCRFM                                                   13814000
@NM00012 EQU   IOCDSO                                                   13815000
IOCDSOPO EQU   IOCDSO                                                   13816000
IOCDSOIS EQU   IOCDSO                                                   13817000
IOCDSOPS EQU   IOCDSO                                                   13818000
IOCDSOAM EQU   IOCDSO                                                   13819000
IOCRKP   EQU   IOCSTR+13                                                13820000
IOCKYL   EQU   IOCSTR+12                                                13821000
IOCTRN   EQU   IOCSTR+8                                                 13822000
IOCDLN   EQU   IOCSTR+4                                                 13823000
IOCDAD   EQU   IOCSTR                                                   13824000
UNITVTOC EQU   UNITABL+7                                                13825000
@NM00011 EQU   UNITSTAT                                                 13826000
UNITUSHR EQU   UNITSTAT                                                 13827000
UNITXSHR EQU   UNITSTAT                                                 13828000
UNITISHR EQU   UNITSTAT                                                 13829000
UNITUA   EQU   @NM00010+1                                               13830000
UNITCHA  EQU   @NM00010                                                 13831000
ALLUNCNT EQU   ALLAGL+30                                                13832000
ALLVLCNT EQU   ALLAGL+29                                                13833000
@NM00009 EQU   ALLOPT                                                   13834000
ALLOPTUN EQU   ALLOPT                                                   13835000
ALLOPTPV EQU   ALLOPT                                                   13836000
ALLOPTDS EQU   ALLOPT                                                   13837000
ALLOPTVL EQU   ALLOPT                                                   13838000
@NM00008 EQU   ALLORG+1                                                 13839000
ALLORGVS EQU   ALLORG+1                                                 13840000
@NM00007 EQU   ALLORG+1                                                 13841000
ALLORGGS EQU   ALLORG+1                                                 13842000
ALLORGUN EQU   ALLORG                                                   13843000
ALLORGPO EQU   ALLORG                                                   13844000
ALLORGMQ EQU   ALLORG                                                   13845000
ALLORGCQ EQU   ALLORG                                                   13846000
ALLORGCX EQU   ALLORG                                                   13847000
ALLORGDA EQU   ALLORG                                                   13848000
ALLORGPS EQU   ALLORG                                                   13849000
ALLORGIS EQU   ALLORG                                                   13850000
ALLDSPUN EQU   ALLDSP                                                   13851000
ALLDSPCG EQU   ALLDSP                                                   13852000
ALLDSPDE EQU   ALLDSP                                                   13853000
ALLDSPKP EQU   ALLDSP                                                   13854000
@NM00006 EQU   ALLDSP                                                   13855000
ALLSTSOD EQU   ALLSTS                                                   13856000
ALLSTSMD EQU   ALLSTS                                                   13857000
ALLSTSNW EQU   ALLSTS                                                   13858000
ALLSTSSR EQU   ALLSTS                                                   13859000
@NM00005 EQU   ALLSTS                                                   13860000
ALLPWD   EQU   ALLAGL+20                                                13861000
ALLVLP   EQU   ALLAGL+16                                                13862000
ALLULP   EQU   ALLAGL+12                                                13863000
ALLDDN   EQU   ALLAGL+4                                                 13864000
ALLDSN   EQU   ALLAGL                                                   13865000
CIRPID   EQU   CIRAGL+28                                                13866000
CIRPWD   EQU   CIRAGL+24                                                13867000
CIRCAT   EQU   CIRAGL+20                                                13868000
CIRWKP   EQU   CIRAGL+16                                                13869000
CIRTLR   EQU   CIRAGL+12                                                13870000
CIRHDR   EQU   CIRAGL+8                                                 13871000
CIRTLN   EQU   CIRAGL+6                                                 13872000
CIRHLN   EQU   CIRAGL+4                                                 13873000
@NM00004 EQU   CIRAGL+1                                                 13874000
@NM00003 EQU   CIRTYPE                                                  13875000
CIRTYPAQ EQU   CIRTYPE                                                  13876000
CIRTYP1Q EQU   CIRTYPE                                                  13877000
NEWID1   EQU   TRACE1+95                                                13878000
CALLID   EQU   OLDERID1+90                                              13879000
@NM00002 EQU   OLDERID1                                                 13880000
GDTPSB   EQU   GDTTBL+184                                               13881000
GDTUPT   EQU   GDTTBL+180                                               13882000
GDTCMB   EQU   GDTTBL+176                                               13883000
GDTSPR   EQU   GDTTBL+168                                               13884000
@NM00001 EQU   GDTTBL+160                                               13885000
GDTABH   EQU   GDTTBL+156                                               13886000
GDTABT   EQU   GDTTBL+152                                               13887000
GDTTOH   EQU   GDTTBL+120                                               13888000
GDTRIP   EQU   GDTTBL+116                                               13889000
GDTSAH   EQU   GDTTBL+32                                                13890000
GDTTPH   EQU   GDTTBL+28                                                13891000
GDTRIH   EQU   GDTTBL+24                                                13892000
GDTSTH   EQU   GDTTBL+20                                                13893000
GDTDBH   EQU   GDTTBL+16                                                13894000
GDTPRM   EQU   GDTTBL+4                                                 13895000
GDTHDR   EQU   GDTTBL                                                   13896000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      13897000
@RC00471 EQU   @RC00468                                                 13898000
@RF00487 EQU   @RC00468                                                 13899000
@RC00684 EQU   @RC00678                                                 13900000
@RF00876 EQU   @RC00873                                                 13901000
@RC01867 EQU   @RC01864                                                 13902000
@PB00014 EQU   @EL00001                                                 13903000
@ENDDATA EQU   *                                                        13904000
         END   IDCRS01,(C'PLS2300',0701,77115)                          13905000
